From |kry|ov @end|ng |rom d|@root@org  Thu Aug  1 18:06:28 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Thu, 1 Aug 2024 19:06:28 +0300
Subject: [R] 
 Difference between stats.steps() and MuMIn.dredge() to select
 best fit model
In-Reply-To: <ff2e607efd2c1093cfa0f6c42a37df3e@posteo.de>
References: <ff2e607efd2c1093cfa0f6c42a37df3e@posteo.de>
Message-ID: <20240801190628.5a34acb5@arachnoid>

? Wed, 31 Jul 2024 11:56:55 +0000
c.buhtz at posteo.jp ?????:

> step() explore the model space with a step wise approach.
> And dredge() try out all possible combinations of the variables.
>
> But isn't that the same? I might have a mental block on this.
> 
> Which model (formula) would dredge() "test" that step() wouldn't?`

Suppose that the predictors a, b, c, d, e, f are arranged in the
descending order of contribution to the model.

Consider a forward stepwise algorithm that is asked to choose three
variables.

It starts by testing a, b, c, d, e, f, and chooses a.

It continues by testing a + b, a + c, a + d, a + e, a + f, and chooses
a + b.

It continues by testing a + b + c, a + b + d, a + b + e, a + b + f, and
chooses a + b + c.

By being greedy, it doesn't consider, for example, the model d + e + f,
because for that it would have to pick d before a.

A greedy algorithm for K variables out N tests N + (N-1) + ... +
(N-K+1) = N*K - K(K-1)/2 models. An exhaustive search would have to test
choose(N,K) = N!/(N-K)!/K! models.

-- 
Best regards,
Ivan


From phii m@iii@g oii phiiipsmith@c@  Thu Aug  1 20:01:56 2024
From: phii m@iii@g oii phiiipsmith@c@ (phii m@iii@g oii phiiipsmith@c@)
Date: Thu, 01 Aug 2024 14:01:56 -0400
Subject: [R] R facets including two kinds of charts
Message-ID: <6b69af2baaeeaf7679053b7b9430ef08@philipsmith.ca>

I am asking for help with a ggplot2 program that has facets. There are 
actually 100 facets in my program, but in the example below I have 
limited the number to 3. There are two kinds of charts among the facets. 
One kind is a simple line plot with all of the y-values greater than 
zero. The facet for "A" in my example below is this kind. The other kind 
is a line plot combined with a bar chart with some of the y-values being 
positive and others negative. The facets for "B" and "C" in my example 
are this kind.

The facets for "B" and "C" look the way I want them to. However the 
facet for "A" has a scale on the y-axis that starts at zero, whereas I 
would like the minimum value on this scale to be non-zero, chosen by 
ggplot2 to be closer to the minimum value of y for that particular 
facet.

My example may not be the most efficient way to achieve this, but it 
works except for one aspect. Chart A, for which I do not wish to show a 
zero line, does indeed not show a zero line but it nevertheless chooses 
a scale for the y-axis that has a minimum value of zero. How can I 
adjust the code so that it chooses a minimum value on the y-axis that is 
non-zero and closer to the minimum actual y-value (as would be the case 
for a simple line chart alone, without any facets)?

library(ggplot2)
library(dplyr)

df <- data.frame(
   date=c(1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6),
   
nm=c("A","B","C","A","B","C","A","B","C","A","B","C","A","B","C","A","B","C"),
   val0=c(NA,-5,4,NA,-3,3,NA,2,4,NA,3,3,NA,3,1,NA,-3,-4),
   val1=c(NA,-3,6,NA,-1,4,NA,5,5,NA,7,2,NA,4,3,NA,-2,-2),
   val2=c(50,NA,NA,53,NA,NA,62,NA,NA,56,NA,NA,54,NA,NA,61,NA,NA),
   zline=c(NA,0,0,NA,0,0,NA,0,0,NA,0,0,NA,0,0,NA,0,0)
)

ggplot(df)+
   geom_col(aes(x=date,y=val0),na.rm=TRUE,fill="white")+
   geom_line(aes(x=date,y=val1))+
   geom_line(aes(x=date,y=val2))+
   geom_hline(aes(yintercept=zline),na.rm=TRUE)+
   facet_wrap(~nm,scales="free_y")

Thank you for your assistance.

Philip


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Aug  1 21:08:07 2024
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 1 Aug 2024 20:08:07 +0100
Subject: [R] R facets including two kinds of charts
In-Reply-To: <6b69af2baaeeaf7679053b7b9430ef08@philipsmith.ca>
References: <6b69af2baaeeaf7679053b7b9430ef08@philipsmith.ca>
Message-ID: <88456aba-8474-44be-af47-287305301f7e@sapo.pt>

?s 19:01 de 01/08/2024, phil at philipsmith.ca escreveu:
> I am asking for help with a ggplot2 program that has facets. There are 
> actually 100 facets in my program, but in the example below I have 
> limited the number to 3. There are two kinds of charts among the facets. 
> One kind is a simple line plot with all of the y-values greater than 
> zero. The facet for "A" in my example below is this kind. The other kind 
> is a line plot combined with a bar chart with some of the y-values being 
> positive and others negative. The facets for "B" and "C" in my example 
> are this kind.
> 
> The facets for "B" and "C" look the way I want them to. However the 
> facet for "A" has a scale on the y-axis that starts at zero, whereas I 
> would like the minimum value on this scale to be non-zero, chosen by 
> ggplot2 to be closer to the minimum value of y for that particular facet.
> 
> My example may not be the most efficient way to achieve this, but it 
> works except for one aspect. Chart A, for which I do not wish to show a 
> zero line, does indeed not show a zero line but it nevertheless chooses 
> a scale for the y-axis that has a minimum value of zero. How can I 
> adjust the code so that it chooses a minimum value on the y-axis that is 
> non-zero and closer to the minimum actual y-value (as would be the case 
> for a simple line chart alone, without any facets)?
> 
> library(ggplot2)
> library(dplyr)
> 
> df <- data.frame(
>  ? date=c(1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6),
> nm=c("A","B","C","A","B","C","A","B","C","A","B","C","A","B","C","A","B","C"),
>  ? val0=c(NA,-5,4,NA,-3,3,NA,2,4,NA,3,3,NA,3,1,NA,-3,-4),
>  ? val1=c(NA,-3,6,NA,-1,4,NA,5,5,NA,7,2,NA,4,3,NA,-2,-2),
>  ? val2=c(50,NA,NA,53,NA,NA,62,NA,NA,56,NA,NA,54,NA,NA,61,NA,NA),
>  ? zline=c(NA,0,0,NA,0,0,NA,0,0,NA,0,0,NA,0,0,NA,0,0)
> )
> 
> ggplot(df)+
>  ? geom_col(aes(x=date,y=val0),na.rm=TRUE,fill="white")+
>  ? geom_line(aes(x=date,y=val1))+
>  ? geom_line(aes(x=date,y=val2))+
>  ? geom_hline(aes(yintercept=zline),na.rm=TRUE)+
>  ? facet_wrap(~nm,scales="free_y")
> 
> Thank you for your assistance.
> 
> Philip
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Try to remove

scales="free_y"

from facet_wrap(). With scales="free_y" each facet will have its own y 
limits, given by the data plotted in each of them. If you want a global 
y limits, don't use it.

Hope this helps,

Rui Barradas




-- 
Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.
www.avg.com


From phii m@iii@g oii phiiipsmith@c@  Thu Aug  1 21:10:35 2024
From: phii m@iii@g oii phiiipsmith@c@ (phii m@iii@g oii phiiipsmith@c@)
Date: Thu, 01 Aug 2024 15:10:35 -0400
Subject: [R] R facets including two kinds of charts
In-Reply-To: <88456aba-8474-44be-af47-287305301f7e@sapo.pt>
References: <6b69af2baaeeaf7679053b7b9430ef08@philipsmith.ca>
 <88456aba-8474-44be-af47-287305301f7e@sapo.pt>
Message-ID: <5818e5e4b18a77b959a8ca3b23ef393d@philipsmith.ca>

Thanks for the suggestion, but this does not give me what I want. Each 
chart needs its own unique scale on the y-axis.

Philip


On 2024-08-01 15:08, Rui Barradas wrote:
> ?s 19:01 de 01/08/2024, phil at philipsmith.ca escreveu:
>> I am asking for help with a ggplot2 program that has facets. There are 
>> actually 100 facets in my program, but in the example below I have 
>> limited the number to 3. There are two kinds of charts among the 
>> facets. One kind is a simple line plot with all of the y-values 
>> greater than zero. The facet for "A" in my example below is this kind. 
>> The other kind is a line plot combined with a bar chart with some of 
>> the y-values being positive and others negative. The facets for "B" 
>> and "C" in my example are this kind.
>> 
>> The facets for "B" and "C" look the way I want them to. However the 
>> facet for "A" has a scale on the y-axis that starts at zero, whereas I 
>> would like the minimum value on this scale to be non-zero, chosen by 
>> ggplot2 to be closer to the minimum value of y for that particular 
>> facet.
>> 
>> My example may not be the most efficient way to achieve this, but it 
>> works except for one aspect. Chart A, for which I do not wish to show 
>> a zero line, does indeed not show a zero line but it nevertheless 
>> chooses a scale for the y-axis that has a minimum value of zero. How 
>> can I adjust the code so that it chooses a minimum value on the y-axis 
>> that is non-zero and closer to the minimum actual y-value (as would be 
>> the case for a simple line chart alone, without any facets)?
>> 
>> library(ggplot2)
>> library(dplyr)
>> 
>> df <- data.frame(
>>  ? date=c(1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6),
>> nm=c("A","B","C","A","B","C","A","B","C","A","B","C","A","B","C","A","B","C"),
>>  ? val0=c(NA,-5,4,NA,-3,3,NA,2,4,NA,3,3,NA,3,1,NA,-3,-4),
>>  ? val1=c(NA,-3,6,NA,-1,4,NA,5,5,NA,7,2,NA,4,3,NA,-2,-2),
>>  ? val2=c(50,NA,NA,53,NA,NA,62,NA,NA,56,NA,NA,54,NA,NA,61,NA,NA),
>>  ? zline=c(NA,0,0,NA,0,0,NA,0,0,NA,0,0,NA,0,0,NA,0,0)
>> )
>> 
>> ggplot(df)+
>>  ? geom_col(aes(x=date,y=val0),na.rm=TRUE,fill="white")+
>>  ? geom_line(aes(x=date,y=val1))+
>>  ? geom_line(aes(x=date,y=val2))+
>>  ? geom_hline(aes(yintercept=zline),na.rm=TRUE)+
>>  ? facet_wrap(~nm,scales="free_y")
>> 
>> Thank you for your assistance.
>> 
>> Philip
>> 
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> Hello,
> 
> Try to remove
> 
> scales="free_y"
> 
> from facet_wrap(). With scales="free_y" each facet will have its own y 
> limits, given by the data plotted in each of them. If you want a global 
> y limits, don't use it.
> 
> Hope this helps,
> 
> Rui Barradas


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Aug  1 21:44:57 2024
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 1 Aug 2024 20:44:57 +0100
Subject: [R] R facets including two kinds of charts
In-Reply-To: <5818e5e4b18a77b959a8ca3b23ef393d@philipsmith.ca>
References: <6b69af2baaeeaf7679053b7b9430ef08@philipsmith.ca>
 <88456aba-8474-44be-af47-287305301f7e@sapo.pt>
 <5818e5e4b18a77b959a8ca3b23ef393d@philipsmith.ca>
Message-ID: <47681136-52d9-443a-96a4-9a24df56484f@sapo.pt>

Hello,

I hadn't understood the problem, sorry.
The problem are the bar plots, ggplot is plotting one in the "A" facet. 
And since there is nothing to plot, the bars start at 0.

A hack is to plot facet "A" separately and then combine the plots with 
one of several ways to combine ggplot plots. Below is an example with 
cowplot::plot_grid


library(ggplot2)
library(dplyr)
library(cowplot)

p1 <- df %>%
   filter(nm == "A") %>%
   ggplot(aes(x = date)) +
   geom_line(aes(y = val2)) +
   facet_wrap(~ nm, scales = "free_y") +
   theme(plot.margin = unit(c(0.2, 0, 0.1, 0), "cm"))

p2 <- df %>%
   filter(nm != "A") %>%
   ggplot(aes(x = date)) +
   geom_col(aes(y = val0), na.rm = TRUE, fill = "white") +
   geom_line(aes(y = val1)) +
   ylab("") +
   facet_wrap(~ nm, scales = "free_y")

plot_grid(p1, p2, rel_widths = c(1, 2))


Hope this helps,

Rui Barradas



?s 20:10 de 01/08/2024, phil at philipsmith.ca escreveu:
> Thanks for the suggestion, but this does not give me what I want. Each 
> chart needs its own unique scale on the y-axis.
> 
> Philip
> 
> 
> On 2024-08-01 15:08, Rui Barradas wrote:
>> ?s 19:01 de 01/08/2024, phil at philipsmith.ca escreveu:
>>> I am asking for help with a ggplot2 program that has facets. There 
>>> are actually 100 facets in my program, but in the example below I 
>>> have limited the number to 3. There are two kinds of charts among the 
>>> facets. One kind is a simple line plot with all of the y-values 
>>> greater than zero. The facet for "A" in my example below is this 
>>> kind. The other kind is a line plot combined with a bar chart with 
>>> some of the y-values being positive and others negative. The facets 
>>> for "B" and "C" in my example are this kind.
>>>
>>> The facets for "B" and "C" look the way I want them to. However the 
>>> facet for "A" has a scale on the y-axis that starts at zero, whereas 
>>> I would like the minimum value on this scale to be non-zero, chosen 
>>> by ggplot2 to be closer to the minimum value of y for that particular 
>>> facet.
>>>
>>> My example may not be the most efficient way to achieve this, but it 
>>> works except for one aspect. Chart A, for which I do not wish to show 
>>> a zero line, does indeed not show a zero line but it nevertheless 
>>> chooses a scale for the y-axis that has a minimum value of zero. How 
>>> can I adjust the code so that it chooses a minimum value on the 
>>> y-axis that is non-zero and closer to the minimum actual y-value (as 
>>> would be the case for a simple line chart alone, without any facets)?
>>>
>>> library(ggplot2)
>>> library(dplyr)
>>>
>>> df <- data.frame(
>>> ?? date=c(1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6),
>>> nm=c("A","B","C","A","B","C","A","B","C","A","B","C","A","B","C","A","B","C"),
>>> ?? val0=c(NA,-5,4,NA,-3,3,NA,2,4,NA,3,3,NA,3,1,NA,-3,-4),
>>> ?? val1=c(NA,-3,6,NA,-1,4,NA,5,5,NA,7,2,NA,4,3,NA,-2,-2),
>>> ?? val2=c(50,NA,NA,53,NA,NA,62,NA,NA,56,NA,NA,54,NA,NA,61,NA,NA),
>>> ?? zline=c(NA,0,0,NA,0,0,NA,0,0,NA,0,0,NA,0,0,NA,0,0)
>>> )
>>>
>>> ggplot(df)+
>>> ?? geom_col(aes(x=date,y=val0),na.rm=TRUE,fill="white")+
>>> ?? geom_line(aes(x=date,y=val1))+
>>> ?? geom_line(aes(x=date,y=val2))+
>>> ?? geom_hline(aes(yintercept=zline),na.rm=TRUE)+
>>> ?? facet_wrap(~nm,scales="free_y")
>>>
>>> Thank you for your assistance.
>>>
>>> Philip
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide 
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>> Hello,
>>
>> Try to remove
>>
>> scales="free_y"
>>
>> from facet_wrap(). With scales="free_y" each facet will have its own y 
>> limits, given by the data plotted in each of them. If you want a 
>> global y limits, don't use it.
>>
>> Hope this helps,
>>
>> Rui Barradas


-- 
Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.
www.avg.com


From phii m@iii@g oii phiiipsmith@c@  Thu Aug  1 22:03:29 2024
From: phii m@iii@g oii phiiipsmith@c@ (phii m@iii@g oii phiiipsmith@c@)
Date: Thu, 01 Aug 2024 16:03:29 -0400
Subject: [R] R facets including two kinds of charts
In-Reply-To: <47681136-52d9-443a-96a4-9a24df56484f@sapo.pt>
References: <6b69af2baaeeaf7679053b7b9430ef08@philipsmith.ca>
 <88456aba-8474-44be-af47-287305301f7e@sapo.pt>
 <5818e5e4b18a77b959a8ca3b23ef393d@philipsmith.ca>
 <47681136-52d9-443a-96a4-9a24df56484f@sapo.pt>
Message-ID: <3a617832a1bd07c8079021ebd4adb101@philipsmith.ca>

Thank you. That approach could work and I might use it, but a 
complication is that the 100 facets must be in a specified order and 
that order mixes charts of type A and B/C in an unsystematic way. I 
suppose I could write two functions, use them to create all the plots 
and then join them together with cowplot. Or perhaps I could use 
patchwork, with which I am more familiar. I was of course hoping this 
could just be done with facets.

Incidentally this used to work fine with facets (I post the results on 
the web periodically. See 
http://www.philipsmith.ca/Canadian_macroeconomic_indicators/) but 
something must have changed in one of the packages (I'm guessing) and 
that approach suddenly stopped working.

Philip


On 2024-08-01 15:44, Rui Barradas wrote:
> Hello,
> 
> I hadn't understood the problem, sorry.
> The problem are the bar plots, ggplot is plotting one in the "A" facet. 
> And since there is nothing to plot, the bars start at 0.
> 
> A hack is to plot facet "A" separately and then combine the plots with 
> one of several ways to combine ggplot plots. Below is an example with 
> cowplot::plot_grid
> 
> 
> library(ggplot2)
> library(dplyr)
> library(cowplot)
> 
> p1 <- df %>%
>   filter(nm == "A") %>%
>   ggplot(aes(x = date)) +
>   geom_line(aes(y = val2)) +
>   facet_wrap(~ nm, scales = "free_y") +
>   theme(plot.margin = unit(c(0.2, 0, 0.1, 0), "cm"))
> 
> p2 <- df %>%
>   filter(nm != "A") %>%
>   ggplot(aes(x = date)) +
>   geom_col(aes(y = val0), na.rm = TRUE, fill = "white") +
>   geom_line(aes(y = val1)) +
>   ylab("") +
>   facet_wrap(~ nm, scales = "free_y")
> 
> plot_grid(p1, p2, rel_widths = c(1, 2))
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> 
> 
> ?s 20:10 de 01/08/2024, phil at philipsmith.ca escreveu:
>> Thanks for the suggestion, but this does not give me what I want. Each 
>> chart needs its own unique scale on the y-axis.
>> 
>> Philip
>> 
>> 
>> On 2024-08-01 15:08, Rui Barradas wrote:
>>> ?s 19:01 de 01/08/2024, phil at philipsmith.ca escreveu:
>>>> I am asking for help with a ggplot2 program that has facets. There 
>>>> are actually 100 facets in my program, but in the example below I 
>>>> have limited the number to 3. There are two kinds of charts among 
>>>> the facets. One kind is a simple line plot with all of the y-values 
>>>> greater than zero. The facet for "A" in my example below is this 
>>>> kind. The other kind is a line plot combined with a bar chart with 
>>>> some of the y-values being positive and others negative. The facets 
>>>> for "B" and "C" in my example are this kind.
>>>> 
>>>> The facets for "B" and "C" look the way I want them to. However the 
>>>> facet for "A" has a scale on the y-axis that starts at zero, whereas 
>>>> I would like the minimum value on this scale to be non-zero, chosen 
>>>> by ggplot2 to be closer to the minimum value of y for that 
>>>> particular facet.
>>>> 
>>>> My example may not be the most efficient way to achieve this, but it 
>>>> works except for one aspect. Chart A, for which I do not wish to 
>>>> show a zero line, does indeed not show a zero line but it 
>>>> nevertheless chooses a scale for the y-axis that has a minimum value 
>>>> of zero. How can I adjust the code so that it chooses a minimum 
>>>> value on the y-axis that is non-zero and closer to the minimum 
>>>> actual y-value (as would be the case for a simple line chart alone, 
>>>> without any facets)?
>>>> 
>>>> library(ggplot2)
>>>> library(dplyr)
>>>> 
>>>> df <- data.frame(
>>>> ?? date=c(1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6),
>>>> nm=c("A","B","C","A","B","C","A","B","C","A","B","C","A","B","C","A","B","C"),
>>>> ?? val0=c(NA,-5,4,NA,-3,3,NA,2,4,NA,3,3,NA,3,1,NA,-3,-4),
>>>> ?? val1=c(NA,-3,6,NA,-1,4,NA,5,5,NA,7,2,NA,4,3,NA,-2,-2),
>>>> ?? val2=c(50,NA,NA,53,NA,NA,62,NA,NA,56,NA,NA,54,NA,NA,61,NA,NA),
>>>> ?? zline=c(NA,0,0,NA,0,0,NA,0,0,NA,0,0,NA,0,0,NA,0,0)
>>>> )
>>>> 
>>>> ggplot(df)+
>>>> ?? geom_col(aes(x=date,y=val0),na.rm=TRUE,fill="white")+
>>>> ?? geom_line(aes(x=date,y=val1))+
>>>> ?? geom_line(aes(x=date,y=val2))+
>>>> ?? geom_hline(aes(yintercept=zline),na.rm=TRUE)+
>>>> ?? facet_wrap(~nm,scales="free_y")
>>>> 
>>>> Thank you for your assistance.
>>>> 
>>>> Philip
>>>> 
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide 
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>> Hello,
>>> 
>>> Try to remove
>>> 
>>> scales="free_y"
>>> 
>>> from facet_wrap(). With scales="free_y" each facet will have its own 
>>> y limits, given by the data plotted in each of them. If you want a 
>>> global y limits, don't use it.
>>> 
>>> Hope this helps,
>>> 
>>> Rui Barradas


From @tyen @end|ng |rom ntu@edu@tw  Fri Aug  2 03:10:53 2024
From: @tyen @end|ng |rom ntu@edu@tw (Steven Yen)
Date: Fri, 2 Aug 2024 09:10:53 +0800
Subject: [R] grep
Message-ID: <8be3d2f5-b15c-4477-880f-2118bfae7897@ntu.edu.tw>

Good Morning. Below I like statement like

j<-grep(".r\\b",colnames(mydata),value=TRUE); j

with the \\b option which I read long time ago which Ive found useful.

Are there more or these options, other than ? grep? Thanks.

dstat is just my own descriptive routine.

 > x
 ?[1] "age"????????? "sleep"??????? "primary"????? "middle"
 ?[5] "high"???????? "somewhath"??? "veryh"??????? "somewhatm"
 ?[9] "verym"??????? "somewhatc"??? "veryc"??????? "somewhatl"
[13] "veryl"??????? "village"????? "married"????? "social"
[17] "agricultural" "communist"??? "minority"???? "religious"
 > colnames(mydata)
 ?[1] "depression"???? "sleep"????????? "female" "village"
 ?[5] "agricultural"?? "married"??????? "communist" "minority"
 ?[9] "religious"????? "social"???????? "no" "primary"
[13] "middle"???????? "high"?????????? "veryh" "somewhath"
[17] "notveryh"?????? "verym"????????? "somewhatm" "notverym"
[21] "veryc"????????? "somewhatc"????? "notveryc" "veryl"
[25] "somewhatl"????? "notveryl"?????? "age" "village.r"
[29] "married.r"????? "social.r"?????? "agricultural.r" "communist.r"
[33] "minority.r"???? "religious.r"??? "male.r" "education.r"
 > j<-grep(".r\\b",colnames(mydata),value=TRUE); j
[1] "village.r"????? "married.r"????? "social.r" "agricultural.r"
[5] "communist.r"??? "minority.r"???? "religious.r" "male.r"
[9] "education.r"
 > j<-c(x,j); j
 ?[1] "age"??????????? "sleep"????????? "primary" "middle"
 ?[5] "high"?????????? "somewhath"????? "veryh" "somewhatm"
 ?[9] "verym"????????? "somewhatc"????? "veryc" "somewhatl"
[13] "veryl"????????? "village"??????? "married" "social"
[17] "agricultural"?? "communist"????? "minority" "religious"
[21] "village.r"????? "married.r"????? "social.r" "agricultural.r"
[25] "communist.r"??? "minority.r"???? "religious.r" "male.r"
[29] "education.r"
 > data<-mydata[j]
 > cbind(
+?? dstat(subset(data,male.r==1))[,1:2],
+?? dstat(subset(data,male.r==0))[,1:2]
+ )
Sample statistics (Weighted =? FALSE )

Sample statistics (Weighted =? FALSE )

 ??????????????? Mean Std.dev? Mean Std.dev
age??????????? 6.279?? 0.841 6.055?? 0.813
sleep????????? 6.483?? 1.804 6.087?? 2.045
primary??????? 0.452?? 0.498 0.408?? 0.491
middle???????? 0.287?? 0.453 0.176?? 0.381
high?????????? 0.171?? 0.377 0.082?? 0.275
somewhath????? 0.522?? 0.500 0.447?? 0.497
veryh????????? 0.254?? 0.435 0.250?? 0.433
somewhatm????? 0.419?? 0.493 0.460?? 0.498
verym????????? 0.544?? 0.498 0.411?? 0.492
somewhatc????? 0.376?? 0.484 0.346?? 0.476
veryc????????? 0.593?? 0.491 0.615?? 0.487
somewhatl????? 0.544?? 0.498 0.504?? 0.500
veryl????????? 0.390?? 0.488 0.389?? 0.487
village??????? 0.757?? 0.429 0.752?? 0.432
married??????? 0.936?? 0.245 0.906?? 0.291
social???????? 0.538?? 0.499 0.528?? 0.499
agricultural?? 0.780?? 0.414 0.826?? 0.379
communist????? 0.178?? 0.383 0.038?? 0.190
minority?????? 0.071?? 0.256 0.081?? 0.273
religious????? 0.088?? 0.284 0.102?? 0.302
village.r????? 0.243?? 0.429 0.248?? 0.432
married.r????? 0.064?? 0.245 0.094?? 0.291
social.r?????? 0.462?? 0.499 0.472?? 0.499
agricultural.r 0.220?? 0.414 0.174?? 0.379
communist.r??? 0.822?? 0.383 0.962?? 0.190
minority.r???? 0.929?? 0.256 0.919?? 0.273
religious.r??? 0.912?? 0.284 0.898?? 0.302
male.r???????? 1.000?? 0.000 0.000?? 0.000
education.r??? 0.090?? 0.286 0.334?? 0.472
 >


From |kw@|mmo @end|ng |rom gm@||@com  Fri Aug  2 03:40:27 2024
From: |kw@|mmo @end|ng |rom gm@||@com (Iris Simmons)
Date: Thu, 1 Aug 2024 21:40:27 -0400
Subject: [R] grep
In-Reply-To: <8be3d2f5-b15c-4477-880f-2118bfae7897@ntu.edu.tw>
References: <8be3d2f5-b15c-4477-880f-2118bfae7897@ntu.edu.tw>
Message-ID: <CADNULg_p7AwzR=nXeZ_r2SXOeREX4JP_Bq0xOVTd=UqQYzsHzQ@mail.gmail.com>

You can find more by reading through ?regex as well as Perl documentation
(which you can find online).

On Thu, Aug 1, 2024, 21:11 Steven Yen <styen at ntu.edu.tw> wrote:

> Good Morning. Below I like statement like
>
> j<-grep(".r\\b",colnames(mydata),value=TRUE); j
>
> with the \\b option which I read long time ago which Ive found useful.
>
> Are there more or these options, other than ? grep? Thanks.
>
> dstat is just my own descriptive routine.
>
>  > x
>   [1] "age"          "sleep"        "primary"      "middle"
>   [5] "high"         "somewhath"    "veryh"        "somewhatm"
>   [9] "verym"        "somewhatc"    "veryc"        "somewhatl"
> [13] "veryl"        "village"      "married"      "social"
> [17] "agricultural" "communist"    "minority"     "religious"
>  > colnames(mydata)
>   [1] "depression"     "sleep"          "female" "village"
>   [5] "agricultural"   "married"        "communist" "minority"
>   [9] "religious"      "social"         "no" "primary"
> [13] "middle"         "high"           "veryh" "somewhath"
> [17] "notveryh"       "verym"          "somewhatm" "notverym"
> [21] "veryc"          "somewhatc"      "notveryc" "veryl"
> [25] "somewhatl"      "notveryl"       "age" "village.r"
> [29] "married.r"      "social.r"       "agricultural.r" "communist.r"
> [33] "minority.r"     "religious.r"    "male.r" "education.r"
>  > j<-grep(".r\\b",colnames(mydata),value=TRUE); j
> [1] "village.r"      "married.r"      "social.r" "agricultural.r"
> [5] "communist.r"    "minority.r"     "religious.r" "male.r"
> [9] "education.r"
>  > j<-c(x,j); j
>   [1] "age"            "sleep"          "primary" "middle"
>   [5] "high"           "somewhath"      "veryh" "somewhatm"
>   [9] "verym"          "somewhatc"      "veryc" "somewhatl"
> [13] "veryl"          "village"        "married" "social"
> [17] "agricultural"   "communist"      "minority" "religious"
> [21] "village.r"      "married.r"      "social.r" "agricultural.r"
> [25] "communist.r"    "minority.r"     "religious.r" "male.r"
> [29] "education.r"
>  > data<-mydata[j]
>  > cbind(
> +   dstat(subset(data,male.r==1))[,1:2],
> +   dstat(subset(data,male.r==0))[,1:2]
> + )
> Sample statistics (Weighted =  FALSE )
>
> Sample statistics (Weighted =  FALSE )
>
>                  Mean Std.dev  Mean Std.dev
> age            6.279   0.841 6.055   0.813
> sleep          6.483   1.804 6.087   2.045
> primary        0.452   0.498 0.408   0.491
> middle         0.287   0.453 0.176   0.381
> high           0.171   0.377 0.082   0.275
> somewhath      0.522   0.500 0.447   0.497
> veryh          0.254   0.435 0.250   0.433
> somewhatm      0.419   0.493 0.460   0.498
> verym          0.544   0.498 0.411   0.492
> somewhatc      0.376   0.484 0.346   0.476
> veryc          0.593   0.491 0.615   0.487
> somewhatl      0.544   0.498 0.504   0.500
> veryl          0.390   0.488 0.389   0.487
> village        0.757   0.429 0.752   0.432
> married        0.936   0.245 0.906   0.291
> social         0.538   0.499 0.528   0.499
> agricultural   0.780   0.414 0.826   0.379
> communist      0.178   0.383 0.038   0.190
> minority       0.071   0.256 0.081   0.273
> religious      0.088   0.284 0.102   0.302
> village.r      0.243   0.429 0.248   0.432
> married.r      0.064   0.245 0.094   0.291
> social.r       0.462   0.499 0.472   0.499
> agricultural.r 0.220   0.414 0.174   0.379
> communist.r    0.822   0.383 0.962   0.190
> minority.r     0.929   0.256 0.919   0.273
> religious.r    0.912   0.284 0.898   0.302
> male.r         1.000   0.000 0.000   0.000
> education.r    0.090   0.286 0.334   0.472
>  >
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Fri Aug  2 06:28:50 2024
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Fri, 2 Aug 2024 05:28:50 +0100
Subject: [R] grep
In-Reply-To: <8be3d2f5-b15c-4477-880f-2118bfae7897@ntu.edu.tw>
References: <8be3d2f5-b15c-4477-880f-2118bfae7897@ntu.edu.tw>
Message-ID: <774d24ec-d361-43af-941e-afce99fce6e9@sapo.pt>

?s 02:10 de 02/08/2024, Steven Yen escreveu:
> Good Morning. Below I like statement like
> 
> j<-grep(".r\\b",colnames(mydata),value=TRUE); j
> 
> with the \\b option which I read long time ago which Ive found useful.
> 
> Are there more or these options, other than ? grep? Thanks.
> 
> dstat is just my own descriptive routine.
> 
>  > x
>  ?[1] "age"????????? "sleep"??????? "primary"????? "middle"
>  ?[5] "high"???????? "somewhath"??? "veryh"??????? "somewhatm"
>  ?[9] "verym"??????? "somewhatc"??? "veryc"??????? "somewhatl"
> [13] "veryl"??????? "village"????? "married"????? "social"
> [17] "agricultural" "communist"??? "minority"???? "religious"
>  > colnames(mydata)
>  ?[1] "depression"???? "sleep"????????? "female" "village"
>  ?[5] "agricultural"?? "married"??????? "communist" "minority"
>  ?[9] "religious"????? "social"???????? "no" "primary"
> [13] "middle"???????? "high"?????????? "veryh" "somewhath"
> [17] "notveryh"?????? "verym"????????? "somewhatm" "notverym"
> [21] "veryc"????????? "somewhatc"????? "notveryc" "veryl"
> [25] "somewhatl"????? "notveryl"?????? "age" "village.r"
> [29] "married.r"????? "social.r"?????? "agricultural.r" "communist.r"
> [33] "minority.r"???? "religious.r"??? "male.r" "education.r"
>  > j<-grep(".r\\b",colnames(mydata),value=TRUE); j
> [1] "village.r"????? "married.r"????? "social.r" "agricultural.r"
> [5] "communist.r"??? "minority.r"???? "religious.r" "male.r"
> [9] "education.r"
>  > j<-c(x,j); j
>  ?[1] "age"??????????? "sleep"????????? "primary" "middle"
>  ?[5] "high"?????????? "somewhath"????? "veryh" "somewhatm"
>  ?[9] "verym"????????? "somewhatc"????? "veryc" "somewhatl"
> [13] "veryl"????????? "village"??????? "married" "social"
> [17] "agricultural"?? "communist"????? "minority" "religious"
> [21] "village.r"????? "married.r"????? "social.r" "agricultural.r"
> [25] "communist.r"??? "minority.r"???? "religious.r" "male.r"
> [29] "education.r"
>  > data<-mydata[j]
>  > cbind(
> +?? dstat(subset(data,male.r==1))[,1:2],
> +?? dstat(subset(data,male.r==0))[,1:2]
> + )
> Sample statistics (Weighted =? FALSE )
> 
> Sample statistics (Weighted =? FALSE )
> 
>  ??????????????? Mean Std.dev? Mean Std.dev
> age??????????? 6.279?? 0.841 6.055?? 0.813
> sleep????????? 6.483?? 1.804 6.087?? 2.045
> primary??????? 0.452?? 0.498 0.408?? 0.491
> middle???????? 0.287?? 0.453 0.176?? 0.381
> high?????????? 0.171?? 0.377 0.082?? 0.275
> somewhath????? 0.522?? 0.500 0.447?? 0.497
> veryh????????? 0.254?? 0.435 0.250?? 0.433
> somewhatm????? 0.419?? 0.493 0.460?? 0.498
> verym????????? 0.544?? 0.498 0.411?? 0.492
> somewhatc????? 0.376?? 0.484 0.346?? 0.476
> veryc????????? 0.593?? 0.491 0.615?? 0.487
> somewhatl????? 0.544?? 0.498 0.504?? 0.500
> veryl????????? 0.390?? 0.488 0.389?? 0.487
> village??????? 0.757?? 0.429 0.752?? 0.432
> married??????? 0.936?? 0.245 0.906?? 0.291
> social???????? 0.538?? 0.499 0.528?? 0.499
> agricultural?? 0.780?? 0.414 0.826?? 0.379
> communist????? 0.178?? 0.383 0.038?? 0.190
> minority?????? 0.071?? 0.256 0.081?? 0.273
> religious????? 0.088?? 0.284 0.102?? 0.302
> village.r????? 0.243?? 0.429 0.248?? 0.432
> married.r????? 0.064?? 0.245 0.094?? 0.291
> social.r?????? 0.462?? 0.499 0.472?? 0.499
> agricultural.r 0.220?? 0.414 0.174?? 0.379
> communist.r??? 0.822?? 0.383 0.962?? 0.190
> minority.r???? 0.929?? 0.256 0.919?? 0.273
> religious.r??? 0.912?? 0.284 0.898?? 0.302
> male.r???????? 1.000?? 0.000 0.000?? 0.000
> education.r??? 0.090?? 0.286 0.334?? 0.472
>  >
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

The metacharacters reference is the documentation ?regex.
If you want to know whether there are more metacharacters similar to \b,
there are \< and \>. low are examples of using them instead of \b.

Also, the pattern '.r' does not match a period followed by an 'r', the 
period matches any character ('.'). To match a literal period you must 
escape it. The correct regex is '\\.r'.



x <- c("age", "sleep", "primary", "middle", "high", "somewhath", "veryh",
        "somewhatm", "verym", "somewhatc", "veryc", "somewhatl", "veryl",
        "village", "married", "social", "agricultural", "communist",
        "minority", "religious")
colnms <- c("depression", "sleep", "female", "village", "agricultural",
             "married", "communist", "minority", "religious", "social", 
"no",
             "primary", "middle", "high", "veryh", "somewhath", "notveryh",
             "verym", "somewhatm", "notverym", "veryc", "somewhatc", 
"notveryc",
             "veryl", "somewhatl", "notveryl", "age", "village.r", 
"married.r",
             "social.r", "agricultural.r", "communist.r", "minority.r", 
"religious.r",
             "male.r", "education.r")

grep("\\.r\\b", colnms, value = TRUE)
#> [1] "village.r"      "married.r"      "social.r"       "agricultural.r"
#> [5] "communist.r"    "minority.r"     "religious.r"    "male.r"
#> [9] "education.r"
# the same as above
# \\> matches the empty string at the end of a word,
# \\b matches the empty string at both ends of a word
grep("\\.r\\>", colnms, value = TRUE)
#> [1] "village.r"      "married.r"      "social.r"       "agricultural.r"
#> [5] "communist.r"    "minority.r"     "religious.r"    "male.r"
#> [9] "education.r"

# 4 col names have a 'm' and end in '.r' therefore 4 matches
grep("m.*\\.r\\>", colnms, value = TRUE)
#> [1] "married.r"   "communist.r" "minority.r"  "male.r"
# only the strings starting with 'm'
grep("\\bm.*\\.r\\b", colnms, value = TRUE)
#> [1] "married.r"  "minority.r" "male.r"
grep("\\<m.*\\.r\\>", colnms, value = TRUE)
#> [1] "married.r"  "minority.r" "male.r"


Hope this helps,

Rui Barradas


-- 
Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.
www.avg.com


From @tyen @end|ng |rom ntu@edu@tw  Fri Aug  2 08:32:49 2024
From: @tyen @end|ng |rom ntu@edu@tw (Steven Yen)
Date: Fri, 2 Aug 2024 14:32:49 +0800
Subject: [R] grep
In-Reply-To: <774d24ec-d361-43af-941e-afce99fce6e9@sapo.pt>
References: <8be3d2f5-b15c-4477-880f-2118bfae7897@ntu.edu.tw>
 <774d24ec-d361-43af-941e-afce99fce6e9@sapo.pt>
Message-ID: <e8766b05-28de-4857-bd9a-6d85384ec486@ntu.edu.tw>

Thanks!

On 8/2/2024 12:28 PM, Rui Barradas wrote:
> ?s 02:10 de 02/08/2024, Steven Yen escreveu:
>> Good Morning. Below I like statement like
>>
>> j<-grep(".r\\b",colnames(mydata),value=TRUE); j
>>
>> with the \\b option which I read long time ago which Ive found useful.
>>
>> Are there more or these options, other than ? grep? Thanks.
>>
>> dstat is just my own descriptive routine.
>>
>> ?> x
>> ??[1] "age"????????? "sleep"??????? "primary"????? "middle"
>> ??[5] "high"???????? "somewhath"??? "veryh"??????? "somewhatm"
>> ??[9] "verym"??????? "somewhatc"??? "veryc"??????? "somewhatl"
>> [13] "veryl"??????? "village"????? "married"????? "social"
>> [17] "agricultural" "communist"??? "minority"???? "religious"
>> ?> colnames(mydata)
>> ??[1] "depression"???? "sleep"????????? "female" "village"
>> ??[5] "agricultural"?? "married"??????? "communist" "minority"
>> ??[9] "religious"????? "social"???????? "no" "primary"
>> [13] "middle"???????? "high"?????????? "veryh" "somewhath"
>> [17] "notveryh"?????? "verym"????????? "somewhatm" "notverym"
>> [21] "veryc"????????? "somewhatc"????? "notveryc" "veryl"
>> [25] "somewhatl"????? "notveryl"?????? "age" "village.r"
>> [29] "married.r"????? "social.r"?????? "agricultural.r" "communist.r"
>> [33] "minority.r"???? "religious.r"??? "male.r" "education.r"
>> ?> j<-grep(".r\\b",colnames(mydata),value=TRUE); j
>> [1] "village.r"????? "married.r"????? "social.r" "agricultural.r"
>> [5] "communist.r"??? "minority.r"???? "religious.r" "male.r"
>> [9] "education.r"
>> ?> j<-c(x,j); j
>> ??[1] "age"??????????? "sleep"????????? "primary" "middle"
>> ??[5] "high"?????????? "somewhath"????? "veryh" "somewhatm"
>> ??[9] "verym"????????? "somewhatc"????? "veryc" "somewhatl"
>> [13] "veryl"????????? "village"??????? "married" "social"
>> [17] "agricultural"?? "communist"????? "minority" "religious"
>> [21] "village.r"????? "married.r"????? "social.r" "agricultural.r"
>> [25] "communist.r"??? "minority.r"???? "religious.r" "male.r"
>> [29] "education.r"
>> ?> data<-mydata[j]
>> ?> cbind(
>> +?? dstat(subset(data,male.r==1))[,1:2],
>> +?? dstat(subset(data,male.r==0))[,1:2]
>> + )
>> Sample statistics (Weighted =? FALSE )
>>
>> Sample statistics (Weighted =? FALSE )
>>
>> ???????????????? Mean Std.dev? Mean Std.dev
>> age??????????? 6.279?? 0.841 6.055?? 0.813
>> sleep????????? 6.483?? 1.804 6.087?? 2.045
>> primary??????? 0.452?? 0.498 0.408?? 0.491
>> middle???????? 0.287?? 0.453 0.176?? 0.381
>> high?????????? 0.171?? 0.377 0.082?? 0.275
>> somewhath????? 0.522?? 0.500 0.447?? 0.497
>> veryh????????? 0.254?? 0.435 0.250?? 0.433
>> somewhatm????? 0.419?? 0.493 0.460?? 0.498
>> verym????????? 0.544?? 0.498 0.411?? 0.492
>> somewhatc????? 0.376?? 0.484 0.346?? 0.476
>> veryc????????? 0.593?? 0.491 0.615?? 0.487
>> somewhatl????? 0.544?? 0.498 0.504?? 0.500
>> veryl????????? 0.390?? 0.488 0.389?? 0.487
>> village??????? 0.757?? 0.429 0.752?? 0.432
>> married??????? 0.936?? 0.245 0.906?? 0.291
>> social???????? 0.538?? 0.499 0.528?? 0.499
>> agricultural?? 0.780?? 0.414 0.826?? 0.379
>> communist????? 0.178?? 0.383 0.038?? 0.190
>> minority?????? 0.071?? 0.256 0.081?? 0.273
>> religious????? 0.088?? 0.284 0.102?? 0.302
>> village.r????? 0.243?? 0.429 0.248?? 0.432
>> married.r????? 0.064?? 0.245 0.094?? 0.291
>> social.r?????? 0.462?? 0.499 0.472?? 0.499
>> agricultural.r 0.220?? 0.414 0.174?? 0.379
>> communist.r??? 0.822?? 0.383 0.962?? 0.190
>> minority.r???? 0.929?? 0.256 0.919?? 0.273
>> religious.r??? 0.912?? 0.284 0.898?? 0.302
>> male.r???????? 1.000?? 0.000 0.000?? 0.000
>> education.r??? 0.090?? 0.286 0.334?? 0.472
>> ?>
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> Hello,
>
> The metacharacters reference is the documentation ?regex.
> If you want to know whether there are more metacharacters similar to \b,
> there are \< and \>. low are examples of using them instead of \b.
>
> Also, the pattern '.r' does not match a period followed by an 'r', the 
> period matches any character ('.'). To match a literal period you must 
> escape it. The correct regex is '\\.r'.
>
>
>
> x <- c("age", "sleep", "primary", "middle", "high", "somewhath", "veryh",
> ?????? "somewhatm", "verym", "somewhatc", "veryc", "somewhatl", "veryl",
> ?????? "village", "married", "social", "agricultural", "communist",
> ?????? "minority", "religious")
> colnms <- c("depression", "sleep", "female", "village", "agricultural",
> ??????????? "married", "communist", "minority", "religious", "social", 
> "no",
> ??????????? "primary", "middle", "high", "veryh", "somewhath", 
> "notveryh",
> ??????????? "verym", "somewhatm", "notverym", "veryc", "somewhatc", 
> "notveryc",
> ??????????? "veryl", "somewhatl", "notveryl", "age", "village.r", 
> "married.r",
> ??????????? "social.r", "agricultural.r", "communist.r", "minority.r", 
> "religious.r",
> ??????????? "male.r", "education.r")
>
> grep("\\.r\\b", colnms, value = TRUE)
> #> [1] "village.r"????? "married.r"????? "social.r" "agricultural.r"
> #> [5] "communist.r"??? "minority.r"???? "religious.r" "male.r"
> #> [9] "education.r"
> # the same as above
> # \\> matches the empty string at the end of a word,
> # \\b matches the empty string at both ends of a word
> grep("\\.r\\>", colnms, value = TRUE)
> #> [1] "village.r"????? "married.r"????? "social.r" "agricultural.r"
> #> [5] "communist.r"??? "minority.r"???? "religious.r" "male.r"
> #> [9] "education.r"
>
> # 4 col names have a 'm' and end in '.r' therefore 4 matches
> grep("m.*\\.r\\>", colnms, value = TRUE)
> #> [1] "married.r"?? "communist.r" "minority.r"? "male.r"
> # only the strings starting with 'm'
> grep("\\bm.*\\.r\\b", colnms, value = TRUE)
> #> [1] "married.r"? "minority.r" "male.r"
> grep("\\<m.*\\.r\\>", colnms, value = TRUE)
> #> [1] "married.r"? "minority.r" "male.r"
>
>
> Hope this helps,
>
> Rui Barradas
>
>


From ro||turner @end|ng |rom po@teo@net  Mon Aug  5 03:05:29 2024
From: ro||turner @end|ng |rom po@teo@net (Rolf Turner)
Date: Mon,  5 Aug 2024 01:05:29 +0000
Subject: [R] Checking something.
Message-ID: <20240805130529.5e61df36@elderly-dell>


Apologies for the noise.

R.T.

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Stats. Dep't. (secretaries) phone:
         +64-9-373-7599 ext. 89622
Home phone: +64-9-480-4619


From rcurze| @end|ng |rom gm@||@com  Mon Aug  5 23:09:10 2024
From: rcurze| @end|ng |rom gm@||@com (Rosana Curzel)
Date: Mon, 5 Aug 2024 18:09:10 -0300
Subject: [R] An error message with the command fm<-1m (Version 4.4.1. p. 80,
 An introduction to R)
Message-ID: <CAK7f2VN41vY+rKyyiyo4OrVZTWYmo8rKMXmft5ObLEcA26NzVw@mail.gmail.com>

Dear all,

I am introducing in R and I had a problem in the beginning. Please, you can
see an error message below: (Maybe I am in error. If so, sorry for that).
Thank You so much!

[1] "R"
> x<-rnorm(50)
> y<-rnorm(x)
> plot(x,y)
> ls()
[1] "x" "y"
> rm(x,y)
> x<-1:20 Make x=(1,2,...,20).
Erro: unexpected symbol em "x<-1:20 Make"
> x<-1:20
> w<-1+sqrt(x)/2
> dummy<-data.frame(x=x, y=x+rnorm(x)*w)
> dummy
    x          y
1   1  1.5870188
2   2 -0.1337255
3   3  2.1804598
4   4  5.9208727
5   5  4.8860564
6   6  6.5736696
7   7  5.5894932
8   8  5.1181831
9   9 12.2127547
10 10 11.2671459
11 11 10.6736019
12 12  9.5145623
13 13  9.7410161
14 14 11.4136781
15 15 14.6617839
16 16 16.0676884
17 17 13.0879981
18 18 17.4291520
19 19 22.3425584
20 20 23.2160390
> fm<-1m(y~x,data=dummy)
Erro: unexpected symbol em "fm<-1m"
> fm<- 1m(y~x,data=dummy)
Erro: unexpected symbol em "fm<- 1m"
> fm<-1m(y ~ x, data=dummy)
Erro: unexpected symbol em "fm<-1m"
> fm<-1m(y~x,data=dummy)
Erro: unexpected symbol em "fm<-1m"
> fm<-1m(y~x,data=dummy)
Erro: unexpected symbol em "fm<-1m"
>



-- 
Rosana Curzel

	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Tue Aug  6 10:27:20 2024
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Tue, 6 Aug 2024 11:27:20 +0300
Subject: [R] 
 An error message with the command fm<-1m (Version 4.4.1. p. 80,
 An introduction to R)
In-Reply-To: <CAK7f2VN41vY+rKyyiyo4OrVZTWYmo8rKMXmft5ObLEcA26NzVw@mail.gmail.com>
References: <CAK7f2VN41vY+rKyyiyo4OrVZTWYmo8rKMXmft5ObLEcA26NzVw@mail.gmail.com>
Message-ID: <CAGgJW777GVz6Jn3n+Yv13SF60PBx+uvt+SqgV52RdAciNvR-Ew@mail.gmail.com>

The function is lm(), not 1m().
lm stands for "linear model" (the first letter of each word)


On Tue, Aug 6, 2024 at 11:22?AM Rosana Curzel <rcurzel at gmail.com> wrote:

> Dear all,
>
> I am introducing in R and I had a problem in the beginning. Please, you can
> see an error message below: (Maybe I am in error. If so, sorry for that).
> Thank You so much!
>
> [1] "R"
> > x<-rnorm(50)
> > y<-rnorm(x)
> > plot(x,y)
> > ls()
> [1] "x" "y"
> > rm(x,y)
> > x<-1:20 Make x=(1,2,...,20).
> Erro: unexpected symbol em "x<-1:20 Make"
> > x<-1:20
> > w<-1+sqrt(x)/2
> > dummy<-data.frame(x=x, y=x+rnorm(x)*w)
> > dummy
>     x          y
> 1   1  1.5870188
> 2   2 -0.1337255
> 3   3  2.1804598
> 4   4  5.9208727
> 5   5  4.8860564
> 6   6  6.5736696
> 7   7  5.5894932
> 8   8  5.1181831
> 9   9 12.2127547
> 10 10 11.2671459
> 11 11 10.6736019
> 12 12  9.5145623
> 13 13  9.7410161
> 14 14 11.4136781
> 15 15 14.6617839
> 16 16 16.0676884
> 17 17 13.0879981
> 18 18 17.4291520
> 19 19 22.3425584
> 20 20 23.2160390
> > fm<-1m(y~x,data=dummy)
> Erro: unexpected symbol em "fm<-1m"
> > fm<- 1m(y~x,data=dummy)
> Erro: unexpected symbol em "fm<- 1m"
> > fm<-1m(y ~ x, data=dummy)
> Erro: unexpected symbol em "fm<-1m"
> > fm<-1m(y~x,data=dummy)
> Erro: unexpected symbol em "fm<-1m"
> > fm<-1m(y~x,data=dummy)
> Erro: unexpected symbol em "fm<-1m"
> >
>
>
>
> --
> Rosana Curzel
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From JH@rm@e @end|ng |rom roku@com  Tue Aug  6 16:27:14 2024
From: JH@rm@e @end|ng |rom roku@com (Jorgen Harmse)
Date: Tue, 6 Aug 2024 14:27:14 +0000
Subject: [R] An error message with the command fm<-1m
In-Reply-To: <mailman.371733.1.1722938402.46628.r-help@r-project.org>
References: <mailman.371733.1.1722938402.46628.r-help@r-project.org>
Message-ID: <BL0PR01MB4434FF0AFAC6D8B4198EF567DCBF2@BL0PR01MB4434.prod.exchangelabs.com>

> The function is lm(), not 1m().

Eric Berger is correct (except for the extra parentheses), but it is worth pointing out that variable names do not begin with digits. (You can use backticks, assign, & other features to create such names (e.g. to write the Orwellian assignment `2 + 2` <- 5L), but they are non-standard and you need special syntax to use them.) Maybe the font makes some characters hard to distinguish, but a vertical line at the start of a standard name must be lower-case 'l' or upper-case 'I', not '1' or a pipe symbol. A circle or oval must be 'o' or 'O', not the digit '0'. (Digits after the first character are standard.)

Regards,
Jorgen Harmse.



	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Tue Aug  6 16:30:51 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 6 Aug 2024 07:30:51 -0700
Subject: [R] 
 An error message with the command fm<-1m (Version 4.4.1. p. 80,
 An introduction to R)
In-Reply-To: <CAGgJW777GVz6Jn3n+Yv13SF60PBx+uvt+SqgV52RdAciNvR-Ew@mail.gmail.com>
References: <CAK7f2VN41vY+rKyyiyo4OrVZTWYmo8rKMXmft5ObLEcA26NzVw@mail.gmail.com>
 <CAGgJW777GVz6Jn3n+Yv13SF60PBx+uvt+SqgV52RdAciNvR-Ew@mail.gmail.com>
Message-ID: <CAGxFJbSEVSKmq_JXq8yYy0p4SqYnaHeJgcb0dheRQxAWtmwZYQ@mail.gmail.com>

Rosana:
As you say you are just beginning in R, it is probably worth adding
that you should first take some time to learn basic R rules, one of
which is that "legal" (i.e. syntactically valid) names in R cannot
start with a number. See ?make.names for a brief  discussion or an R
tutorial -- as usual, there are many good ones on the internet.

-- Bert

On Tue, Aug 6, 2024 at 1:28?AM Eric Berger <ericjberger at gmail.com> wrote:
>
> The function is lm(), not 1m().
> lm stands for "linear model" (the first letter of each word)
>
>
> On Tue, Aug 6, 2024 at 11:22?AM Rosana Curzel <rcurzel at gmail.com> wrote:
>
> > Dear all,
> >
> > I am introducing in R and I had a problem in the beginning. Please, you can
> > see an error message below: (Maybe I am in error. If so, sorry for that).
> > Thank You so much!
> >
> > [1] "R"
> > > x<-rnorm(50)
> > > y<-rnorm(x)
> > > plot(x,y)
> > > ls()
> > [1] "x" "y"
> > > rm(x,y)
> > > x<-1:20 Make x=(1,2,...,20).
> > Erro: unexpected symbol em "x<-1:20 Make"
> > > x<-1:20
> > > w<-1+sqrt(x)/2
> > > dummy<-data.frame(x=x, y=x+rnorm(x)*w)
> > > dummy
> >     x          y
> > 1   1  1.5870188
> > 2   2 -0.1337255
> > 3   3  2.1804598
> > 4   4  5.9208727
> > 5   5  4.8860564
> > 6   6  6.5736696
> > 7   7  5.5894932
> > 8   8  5.1181831
> > 9   9 12.2127547
> > 10 10 11.2671459
> > 11 11 10.6736019
> > 12 12  9.5145623
> > 13 13  9.7410161
> > 14 14 11.4136781
> > 15 15 14.6617839
> > 16 16 16.0676884
> > 17 17 13.0879981
> > 18 18 17.4291520
> > 19 19 22.3425584
> > 20 20 23.2160390
> > > fm<-1m(y~x,data=dummy)
> > Erro: unexpected symbol em "fm<-1m"
> > > fm<- 1m(y~x,data=dummy)
> > Erro: unexpected symbol em "fm<- 1m"
> > > fm<-1m(y ~ x, data=dummy)
> > Erro: unexpected symbol em "fm<-1m"
> > > fm<-1m(y~x,data=dummy)
> > Erro: unexpected symbol em "fm<-1m"
> > > fm<-1m(y~x,data=dummy)
> > Erro: unexpected symbol em "fm<-1m"
> > >
> >
> >
> >
> > --
> > Rosana Curzel
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From br|@n@m|th199312 @end|ng |rom gm@||@com  Wed Aug  7 12:06:36 2024
From: br|@n@m|th199312 @end|ng |rom gm@||@com (Brian Smith)
Date: Wed, 7 Aug 2024 15:36:36 +0530
Subject: [R] Manually calculating values from aov() result
Message-ID: <CAHUBDY9+TyGtz7UWCzgtPVeiXHjms468DqX57BNxx6ucYn+OZw@mail.gmail.com>

Hi,

I have performed ANOVA as below

dat = data.frame(
'A' = c(-0.3960025, -0.3492880, -1.5893792, -1.4579074, -4.9214873,
-0.8575018, -2.5551363, -0.9366557, -1.4307489, -0.3943704),
'B' = c(2,1,2,2,1,2,2,2,2,2),
'C' = c(0,1,1,1,1,1,1,0,1,1))

summary(aov(A ~ B * C, dat))

However now I also tried to calculate SSE for factor C

Mean = sapply(split(dat, dat$C), function(x) mean(x$A))
N = sapply(split(dat, dat$C), function(x) dim(x)[1])

N[1] * (Mean[1] - mean(dat$A))^2 + N[2] * (Mean[2] - mean(dat$A))^2
#1.691

But in ANOVA table the sum-square for C is reported as 0.77.

Could you please help how exactly this C = 0.77 is obtained from aov()


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Aug  7 13:30:54 2024
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 7 Aug 2024 07:30:54 -0400
Subject: [R] Manually calculating values from aov() result
In-Reply-To: <CAHUBDY9+TyGtz7UWCzgtPVeiXHjms468DqX57BNxx6ucYn+OZw@mail.gmail.com>
References: <CAHUBDY9+TyGtz7UWCzgtPVeiXHjms468DqX57BNxx6ucYn+OZw@mail.gmail.com>
Message-ID: <a1e03df9-d75d-4d71-88a1-072d91fffdb2@gmail.com>

On 2024-08-07 6:06 a.m., Brian Smith wrote:
> Hi,
> 
> I have performed ANOVA as below
> 
> dat = data.frame(
> 'A' = c(-0.3960025, -0.3492880, -1.5893792, -1.4579074, -4.9214873,
> -0.8575018, -2.5551363, -0.9366557, -1.4307489, -0.3943704),
> 'B' = c(2,1,2,2,1,2,2,2,2,2),
> 'C' = c(0,1,1,1,1,1,1,0,1,1))
> 
> summary(aov(A ~ B * C, dat))
> 
> However now I also tried to calculate SSE for factor C
> 
> Mean = sapply(split(dat, dat$C), function(x) mean(x$A))
> N = sapply(split(dat, dat$C), function(x) dim(x)[1])
> 
> N[1] * (Mean[1] - mean(dat$A))^2 + N[2] * (Mean[2] - mean(dat$A))^2
> #1.691
> 
> But in ANOVA table the sum-square for C is reported as 0.77.
> 
> Could you please help how exactly this C = 0.77 is obtained from aov()

Your design isn't balanced, so there are several ways to calculate the 
SS for C.  What you have calculated looks like the "Type I SS" in SAS 
notation, if I remember correctly, assuming that C enters the model 
before B.  That's not what R uses; I think it is Type II SS.

For some details about this, see 
https://mcfromnz.wordpress.com/2011/03/02/anova-type-iiiiii-ss-explained/


From br|@n@m|th199312 @end|ng |rom gm@||@com  Wed Aug  7 14:27:48 2024
From: br|@n@m|th199312 @end|ng |rom gm@||@com (Brian Smith)
Date: Wed, 7 Aug 2024 17:57:48 +0530
Subject: [R] Manually calculating values from aov() result
In-Reply-To: <a1e03df9-d75d-4d71-88a1-072d91fffdb2@gmail.com>
References: <CAHUBDY9+TyGtz7UWCzgtPVeiXHjms468DqX57BNxx6ucYn+OZw@mail.gmail.com>
 <a1e03df9-d75d-4d71-88a1-072d91fffdb2@gmail.com>
Message-ID: <CAHUBDY8=qaoFx9Bk3V-7Sj=ssBX9eK-53q2cd+Dab2a35wS_qg@mail.gmail.com>

Hi,

Thanks for this information. Is there any way to force R to use Type-1
SS? I think most textbooks use this only.

Thanks and regards,

On Wed, 7 Aug 2024 at 17:00, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>
> On 2024-08-07 6:06 a.m., Brian Smith wrote:
> > Hi,
> >
> > I have performed ANOVA as below
> >
> > dat = data.frame(
> > 'A' = c(-0.3960025, -0.3492880, -1.5893792, -1.4579074, -4.9214873,
> > -0.8575018, -2.5551363, -0.9366557, -1.4307489, -0.3943704),
> > 'B' = c(2,1,2,2,1,2,2,2,2,2),
> > 'C' = c(0,1,1,1,1,1,1,0,1,1))
> >
> > summary(aov(A ~ B * C, dat))
> >
> > However now I also tried to calculate SSE for factor C
> >
> > Mean = sapply(split(dat, dat$C), function(x) mean(x$A))
> > N = sapply(split(dat, dat$C), function(x) dim(x)[1])
> >
> > N[1] * (Mean[1] - mean(dat$A))^2 + N[2] * (Mean[2] - mean(dat$A))^2
> > #1.691
> >
> > But in ANOVA table the sum-square for C is reported as 0.77.
> >
> > Could you please help how exactly this C = 0.77 is obtained from aov()
>
> Your design isn't balanced, so there are several ways to calculate the
> SS for C.  What you have calculated looks like the "Type I SS" in SAS
> notation, if I remember correctly, assuming that C enters the model
> before B.  That's not what R uses; I think it is Type II SS.
>
> For some details about this, see
> https://mcfromnz.wordpress.com/2011/03/02/anova-type-iiiiii-ss-explained/
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Aug  7 14:50:39 2024
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 7 Aug 2024 08:50:39 -0400
Subject: [R] Manually calculating values from aov() result
In-Reply-To: <CAHUBDY8=qaoFx9Bk3V-7Sj=ssBX9eK-53q2cd+Dab2a35wS_qg@mail.gmail.com>
References: <CAHUBDY9+TyGtz7UWCzgtPVeiXHjms468DqX57BNxx6ucYn+OZw@mail.gmail.com>
 <a1e03df9-d75d-4d71-88a1-072d91fffdb2@gmail.com>
 <CAHUBDY8=qaoFx9Bk3V-7Sj=ssBX9eK-53q2cd+Dab2a35wS_qg@mail.gmail.com>
Message-ID: <b003450f-6f40-43c8-8440-39fd25ae24ff@gmail.com>

Sure, summary(aov(A ~ C, dat)) will give it to you.

Duncan Murdoch

On 2024-08-07 8:27 a.m., Brian Smith wrote:
> Hi,
> 
> Thanks for this information. Is there any way to force R to use Type-1
> SS? I think most textbooks use this only.
> 
> Thanks and regards,
> 
> On Wed, 7 Aug 2024 at 17:00, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>
>> On 2024-08-07 6:06 a.m., Brian Smith wrote:
>>> Hi,
>>>
>>> I have performed ANOVA as below
>>>
>>> dat = data.frame(
>>> 'A' = c(-0.3960025, -0.3492880, -1.5893792, -1.4579074, -4.9214873,
>>> -0.8575018, -2.5551363, -0.9366557, -1.4307489, -0.3943704),
>>> 'B' = c(2,1,2,2,1,2,2,2,2,2),
>>> 'C' = c(0,1,1,1,1,1,1,0,1,1))
>>>
>>> summary(aov(A ~ B * C, dat))
>>>
>>> However now I also tried to calculate SSE for factor C
>>>
>>> Mean = sapply(split(dat, dat$C), function(x) mean(x$A))
>>> N = sapply(split(dat, dat$C), function(x) dim(x)[1])
>>>
>>> N[1] * (Mean[1] - mean(dat$A))^2 + N[2] * (Mean[2] - mean(dat$A))^2
>>> #1.691
>>>
>>> But in ANOVA table the sum-square for C is reported as 0.77.
>>>
>>> Could you please help how exactly this C = 0.77 is obtained from aov()
>>
>> Your design isn't balanced, so there are several ways to calculate the
>> SS for C.  What you have calculated looks like the "Type I SS" in SAS
>> notation, if I remember correctly, assuming that C enters the model
>> before B.  That's not what R uses; I think it is Type II SS.
>>
>> For some details about this, see
>> https://mcfromnz.wordpress.com/2011/03/02/anova-type-iiiiii-ss-explained/
>>


From tebert @end|ng |rom u||@edu  Wed Aug  7 15:09:28 2024
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Wed, 7 Aug 2024 13:09:28 +0000
Subject: [R] Manually calculating values from aov() result
In-Reply-To: <CAHUBDY8=qaoFx9Bk3V-7Sj=ssBX9eK-53q2cd+Dab2a35wS_qg@mail.gmail.com>
References: <CAHUBDY9+TyGtz7UWCzgtPVeiXHjms468DqX57BNxx6ucYn+OZw@mail.gmail.com>
 <a1e03df9-d75d-4d71-88a1-072d91fffdb2@gmail.com>
 <CAHUBDY8=qaoFx9Bk3V-7Sj=ssBX9eK-53q2cd+Dab2a35wS_qg@mail.gmail.com>
Message-ID: <CH3PR22MB451413843DF345EEB9AAAAA2CFB82@CH3PR22MB4514.namprd22.prod.outlook.com>

In proc glm, SAS will give both type I and type III sums of squares. You can get type II if you ask. Other procedures in SAS have different output as defaults.

Introductory textbooks may only cover type I SS. It is easy to calculate and gets the idea across. In application one of the problems is that a researcher could reanalyze the data to get an outcome of their choice because the order in which variables appear in the model influences their type I SS.
A + B + A*B + C + A*C + B*C + A*B*C
B + C + A + A*B + A*C + B*C + A*B*C

Each variable (or interaction) can have a different type I SS and that can change the perception of which elements of the model are significant or not. Type III SS will give the same SS values for either model.

Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Brian Smith
Sent: Wednesday, August 7, 2024 8:28 AM
To: Duncan Murdoch <murdoch.duncan at gmail.com>
Cc: r-help at r-project.org
Subject: Re: [R] Manually calculating values from aov() result

[External Email]

Hi,

Thanks for this information. Is there any way to force R to use Type-1 SS? I think most textbooks use this only.

Thanks and regards,

On Wed, 7 Aug 2024 at 17:00, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>
> On 2024-08-07 6:06 a.m., Brian Smith wrote:
> > Hi,
> >
> > I have performed ANOVA as below
> >
> > dat = data.frame(
> > 'A' = c(-0.3960025, -0.3492880, -1.5893792, -1.4579074, -4.9214873,
> > -0.8575018, -2.5551363, -0.9366557, -1.4307489, -0.3943704), 'B' =
> > c(2,1,2,2,1,2,2,2,2,2), 'C' = c(0,1,1,1,1,1,1,0,1,1))
> >
> > summary(aov(A ~ B * C, dat))
> >
> > However now I also tried to calculate SSE for factor C
> >
> > Mean = sapply(split(dat, dat$C), function(x) mean(x$A)) N =
> > sapply(split(dat, dat$C), function(x) dim(x)[1])
> >
> > N[1] * (Mean[1] - mean(dat$A))^2 + N[2] * (Mean[2] - mean(dat$A))^2
> > #1.691
> >
> > But in ANOVA table the sum-square for C is reported as 0.77.
> >
> > Could you please help how exactly this C = 0.77 is obtained from
> > aov()
>
> Your design isn't balanced, so there are several ways to calculate the
> SS for C.  What you have calculated looks like the "Type I SS" in SAS
> notation, if I remember correctly, assuming that C enters the model
> before B.  That's not what R uses; I think it is Type II SS.
>
> For some details about this, see
> https://mcfr/
> omnz.wordpress.com%2F2011%2F03%2F02%2Fanova-type-iiiiii-ss-explained%2
> F&data=05%7C02%7Ctebert%40ufl.edu%7C21219670c5d541da503d08dcb6dc6c08%7
> C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638586305046428793%7CUnkno
> wn%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiL
> CJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=HIGCrSH46P%2B1Y0cXUAfZ7DMCCORvtWaiRGC
> crokr4Rs%3D&reserved=0
>

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.r-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From j|ox @end|ng |rom mcm@@ter@c@  Wed Aug  7 15:58:38 2024
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Wed, 7 Aug 2024 09:58:38 -0400
Subject: [R] Manually calculating values from aov() result
In-Reply-To: <CAHUBDY8=qaoFx9Bk3V-7Sj=ssBX9eK-53q2cd+Dab2a35wS_qg@mail.gmail.com>
References: <CAHUBDY9+TyGtz7UWCzgtPVeiXHjms468DqX57BNxx6ucYn+OZw@mail.gmail.com>
 <a1e03df9-d75d-4d71-88a1-072d91fffdb2@gmail.com>
 <CAHUBDY8=qaoFx9Bk3V-7Sj=ssBX9eK-53q2cd+Dab2a35wS_qg@mail.gmail.com>
Message-ID: <46c97bcb-6dc4-4d0c-aba0-01f8522460e4@mcmaster.ca>

Dear Brian,

As Duncan mentioned, the terms type-I, II, and III sums of squares 
originated in SAS. The type-II and III SSs computed by the Anova() 
function in the car package take a different computational approach than 
in SAS, but in almost all cases produce the same results. (I slightly 
regret using the "type-*" terminology for car::Anova() because of the 
lack of exact correspondence to SAS.) The standard R anova() function 
computes type-I (sequential) SSs.

The focus, however, shouldn't be on the SSs, or how they're computed, 
but on the hypotheses that are tested. Briefly, the hypotheses for 
type-I tests assume that all terms later in the sequence are 0 in the 
population; type-II tests assume that interactions to which main effects 
are marginal (and higher-order interactions to which lower-order 
interactions are marginal) are 0. Type-III tests don't, e.g., assume 
that interactions to which a main effect are marginal are 0 in testing 
the main effect, which represents an average over levels of the 
factor(s) with which the factor in the main effect interact. The 
description of the hypotheses for type-III tests is even more complex if 
there are covariates. In my opinion, researchers are usually interested 
in the hypotheses for type-II tests.

These matters are described in detail, for example, in my applied 
regression text <https://www.john-fox.ca/AppliedRegression/index.html>.

I hope this helps,
  John

-- 
John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://www.john-fox.ca/
--
On 2024-08-07 8:27 a.m., Brian Smith wrote:
> [You don't often get email from briansmith199312 at gmail.com. Learn why this is important at https://aka.ms/LearnAboutSenderIdentification ]
> 
> Caution: External email.
> 
> 
> Hi,
> 
> Thanks for this information. Is there any way to force R to use Type-1
> SS? I think most textbooks use this only.
> 
> Thanks and regards,
> 
> On Wed, 7 Aug 2024 at 17:00, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>
>> On 2024-08-07 6:06 a.m., Brian Smith wrote:
>>> Hi,
>>>
>>> I have performed ANOVA as below
>>>
>>> dat = data.frame(
>>> 'A' = c(-0.3960025, -0.3492880, -1.5893792, -1.4579074, -4.9214873,
>>> -0.8575018, -2.5551363, -0.9366557, -1.4307489, -0.3943704),
>>> 'B' = c(2,1,2,2,1,2,2,2,2,2),
>>> 'C' = c(0,1,1,1,1,1,1,0,1,1))
>>>
>>> summary(aov(A ~ B * C, dat))
>>>
>>> However now I also tried to calculate SSE for factor C
>>>
>>> Mean = sapply(split(dat, dat$C), function(x) mean(x$A))
>>> N = sapply(split(dat, dat$C), function(x) dim(x)[1])
>>>
>>> N[1] * (Mean[1] - mean(dat$A))^2 + N[2] * (Mean[2] - mean(dat$A))^2
>>> #1.691
>>>
>>> But in ANOVA table the sum-square for C is reported as 0.77.
>>>
>>> Could you please help how exactly this C = 0.77 is obtained from aov()
>>
>> Your design isn't balanced, so there are several ways to calculate the
>> SS for C.  What you have calculated looks like the "Type I SS" in SAS
>> notation, if I remember correctly, assuming that C enters the model
>> before B.  That's not what R uses; I think it is Type II SS.
>>
>> For some details about this, see
>> https://mcfromnz.wordpress.com/2011/03/02/anova-type-iiiiii-ss-explained/
>>
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ro||turner @end|ng |rom po@teo@net  Thu Aug  8 01:24:48 2024
From: ro||turner @end|ng |rom po@teo@net (Rolf Turner)
Date: Wed,  7 Aug 2024 23:24:48 +0000
Subject: [R] Manually calculating values from aov() result
In-Reply-To: <46c97bcb-6dc4-4d0c-aba0-01f8522460e4@mcmaster.ca>
References: <CAHUBDY9+TyGtz7UWCzgtPVeiXHjms468DqX57BNxx6ucYn+OZw@mail.gmail.com>
 <a1e03df9-d75d-4d71-88a1-072d91fffdb2@gmail.com>
 <CAHUBDY8=qaoFx9Bk3V-7Sj=ssBX9eK-53q2cd+Dab2a35wS_qg@mail.gmail.com>
 <46c97bcb-6dc4-4d0c-aba0-01f8522460e4@mcmaster.ca>
Message-ID: <20240808112448.26210ab6@elderly-dell>


On Wed, 7 Aug 2024 09:58:38 -0400
John Fox <jfox at mcmaster.ca> wrote:

> Dear Brian,
> 
> As Duncan mentioned, the terms type-I, II, and III sums of squares 
> originated in SAS. ...

<SNIP>

> The focus, however, shouldn't be on the SSs, or how they're computed, 
> but on the hypotheses that are tested.

<SNIP>

The last point is focussed on in:

    https://www.stats.ox.ac.uk/pub/MASS3/Exegeses.pdf

I don't agree with everything that Prof. Venables says, but "Exegeses"
is *well* worth a read.

cheers,

Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Stats. Dep't. (secretaries) phone:
         +64-9-373-7599 ext. 89622
Home phone: +64-9-480-4619


From @nupty@g| @end|ng |rom gm@||@com  Thu Aug  8 09:13:23 2024
From: @nupty@g| @end|ng |rom gm@||@com (Anupam Tyagi)
Date: Thu, 8 Aug 2024 12:43:23 +0530
Subject: [R] WDI package commands timing out and not working
Message-ID: <CAFL9eun-6HWgw1LQ1xia0vS+wqb+xe4oC7irr=GogVi0U45v8A@mail.gmail.com>

There is some problem getting data with the WDI package. It gets data from
World Development Indicators and other databases of The World Bank. I let
the code run for several minutes and nothing happens. Sometimes it gives a
time out message. I ran the same code last year and it worked. Any idea
what the problem is and how to fix it?

> dat1EU = WDI(indicator = c('NY.ADJ.NNAT.GN.ZS', 'NY.GNS.ICTR.GN.ZS'), country = c('EU'), start=1977, end=2020)


> dat1OED = WDI(indicator = c('NY.ADJ.NNAT.GN.ZS', 'NY.GNS.ICTR.GN.ZS'), country = c('OED'), start=1977, end=2020)Warning message:
In open.connection(con, "rb") :
  URL 'https://api.worldbank.org/v2/en/country/OED/indicator/NY.ADJ.NNAT.GN.ZS?format=json&date=1977:2020&per_page=32500&page=1':
Timeout of 60 seconds was reached


The following  command works and gives the correct output.

> WDIsearch('savings')


-- 
Anupam.

	[[alternative HTML version deleted]]


From @tyen @end|ng |rom ntu@edu@tw  Fri Aug  9 05:44:38 2024
From: @tyen @end|ng |rom ntu@edu@tw (Steven Yen)
Date: Fri, 9 Aug 2024 11:44:38 +0800
Subject: [R] If loop
Message-ID: <b6ce61b0-91e1-4f2c-b7b5-6d8298ae54a1@ntu.edu.tw>

Can someone help me with the if loop below? In the subroutine, I 
initialize all of (joint12,marg1,marg2,cond12,cond21) as FALSE, and call 
with only one of them being TRUE:

,...,joint12=FALSE,marg1=FALSE,marg2=FALSE,cond12=FALSE,cond21=FALSE,,,,

joint12 seems to always kick in, even though I call with, e.g., marg1 
being TRUE and everything else being FALSE. My attempts with if... else 
if were not useful. Please help. Thanks.

v1<-cprob(z1,x1,a,b,mu1,mu2,rho,j+1,k+1)
 ??? v0<-cprob(z0,x0,a,b,mu1,mu2,rho,j+1,k+1)

 ?? ...

 ??? me1<-me0<-NULL
 ??? if(joint12) {me1<-cbind(me1,v1$p12); me0<-cbind(me0,v0$p12)}
 ??? if(marg1)?? {me1<-cbind(me1,v1$p1); me0<-cbind(me0,v0$p1)}
 ??? if(marg2)?? {me1<-cbind(me1,v1$p2); me0<-cbind(me0,v0$p2)}
 ??? if(cond12)? {me1<-cbind(me1,v1$pc12); me0<-cbind(me0,v0$pc12)}
 ??? if(cond21)? {me1<-cbind(me1,v1$pc21); me0<-cbind(me0,v0$pc21)}
 ??? ...

 ? labels<-NULL
 ? if(joint12) labels<-c(labels,lab.p12)
 ? if(marg1)?? labels<-c(labels,lab.p1)
 ? if(marg2)?? labels<-c(labels,lab.p2)
 ? if(cond12)? labels<-c(labels,lab.pc12)
 ? if(cond21)? labels<-c(labels,lab.pc21)


From @tyen @end|ng |rom ntu@edu@tw  Fri Aug  9 06:33:09 2024
From: @tyen @end|ng |rom ntu@edu@tw (Steven Yen)
Date: Fri, 9 Aug 2024 12:33:09 +0800
Subject: [R] If loop
In-Reply-To: <b6ce61b0-91e1-4f2c-b7b5-6d8298ae54a1@ntu.edu.tw>
References: <b6ce61b0-91e1-4f2c-b7b5-6d8298ae54a1@ntu.edu.tw>
Message-ID: <b0ac4755-70a9-4819-b64f-1388010a68e3@ntu.edu.tw>

The following (using if else) did not help. Seemed like joint12 always 
kicked in.

 ??? me1<-me0<-NULL.
 ??? if(joint12){
 ????? {me1<-cbind(me1,v1$p12);? me0<-cbind(me0,v0$p12)}
 ??? } else if(marg1) {
 ????? {me1<-cbind(me1,v1$p1);?? me0<-cbind(me0,v0$p1)}
 ??? } else if(marg2) {
 ????? {me1<-cbind(me1,v1$p2);?? me0<-cbind(me0,v0$p2)}
 ??? } else if(cond12){
 ????? {me1<-cbind(me1,v1$pc12); me0<-cbind(me0,v0$pc12)}
 ??? } else {
 ????? {me1<-cbind(me1,v1$pc21); me0<-cbind(me0,v0$pc21)}
 ??? }

...

 ? labels<-NULL
 ? if(joint12){
 ??? labels<-c(labels,lab.p12)
 ? } else if(marg1) {
 ??? labels<-c(labels,lab.p1)
 ? } else if(marg2) {
 ??? labels<-c(labels,lab.p2)
 ? } else if(cond12){
 ??? labels<-c(labels,lab.pc12)
 ? } else {
 ??? labels<-c(labels,lab.pc21)
 ? }


On 8/9/2024 11:44 AM, Steven Yen wrote:
> Can someone help me with the if loop below? In the subroutine, I 
> initialize all of (joint12,marg1,marg2,cond12,cond21) as FALSE, and 
> call with only one of them being TRUE:
>
> ,...,joint12=FALSE,marg1=FALSE,marg2=FALSE,cond12=FALSE,cond21=FALSE,,,,
>
> joint12 seems to always kick in, even though I call with, e.g., marg1 
> being TRUE and everything else being FALSE. My attempts with if... 
> else if were not useful. Please help. Thanks.
>
> v1<-cprob(z1,x1,a,b,mu1,mu2,rho,j+1,k+1)
> ??? v0<-cprob(z0,x0,a,b,mu1,mu2,rho,j+1,k+1)
>
> ?? ...
>
> ??? me1<-me0<-NULL
> ??? if(joint12) {me1<-cbind(me1,v1$p12); me0<-cbind(me0,v0$p12)}
> ??? if(marg1)?? {me1<-cbind(me1,v1$p1); me0<-cbind(me0,v0$p1)}
> ??? if(marg2)?? {me1<-cbind(me1,v1$p2); me0<-cbind(me0,v0$p2)}
> ??? if(cond12)? {me1<-cbind(me1,v1$pc12); me0<-cbind(me0,v0$pc12)}
> ??? if(cond21)? {me1<-cbind(me1,v1$pc21); me0<-cbind(me0,v0$pc21)}
> ??? ...
>
> ? labels<-NULL
> ? if(joint12) labels<-c(labels,lab.p12)
> ? if(marg1)?? labels<-c(labels,lab.p1)
> ? if(marg2)?? labels<-c(labels,lab.p2)
> ? if(cond12)? labels<-c(labels,lab.pc12)
> ? if(cond21)? labels<-c(labels,lab.pc21)
>


From bgunter@4567 @end|ng |rom gm@||@com  Fri Aug  9 06:38:44 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 8 Aug 2024 21:38:44 -0700
Subject: [R] If loop
In-Reply-To: <b6ce61b0-91e1-4f2c-b7b5-6d8298ae54a1@ntu.edu.tw>
References: <b6ce61b0-91e1-4f2c-b7b5-6d8298ae54a1@ntu.edu.tw>
Message-ID: <CAGxFJbRpDSZiZ7UJokb2T2GAvGzw9xgZ=isaJ6fErVTSzsk_qA@mail.gmail.com>

1. I think to get useful help you will have to provide a small
reproducible example. In any case, I was not able to figure out your
problem from what you provided (perhaps others may).

2. R is a (mostly) functional language. It does not have "subroutines" .

Cheers,
Bert

On Thu, Aug 8, 2024 at 8:45?PM Steven Yen <styen at ntu.edu.tw> wrote:
>
> Can someone help me with the if loop below? In the subroutine, I
> initialize all of (joint12,marg1,marg2,cond12,cond21) as FALSE, and call
> with only one of them being TRUE:
>
> ,...,joint12=FALSE,marg1=FALSE,marg2=FALSE,cond12=FALSE,cond21=FALSE,,,,
>
> joint12 seems to always kick in, even though I call with, e.g., marg1
> being TRUE and everything else being FALSE. My attempts with if... else
> if were not useful. Please help. Thanks.
>
> v1<-cprob(z1,x1,a,b,mu1,mu2,rho,j+1,k+1)
>      v0<-cprob(z0,x0,a,b,mu1,mu2,rho,j+1,k+1)
>
>     ...
>
>      me1<-me0<-NULL
>      if(joint12) {me1<-cbind(me1,v1$p12); me0<-cbind(me0,v0$p12)}
>      if(marg1)   {me1<-cbind(me1,v1$p1); me0<-cbind(me0,v0$p1)}
>      if(marg2)   {me1<-cbind(me1,v1$p2); me0<-cbind(me0,v0$p2)}
>      if(cond12)  {me1<-cbind(me1,v1$pc12); me0<-cbind(me0,v0$pc12)}
>      if(cond21)  {me1<-cbind(me1,v1$pc21); me0<-cbind(me0,v0$pc21)}
>      ...
>
>    labels<-NULL
>    if(joint12) labels<-c(labels,lab.p12)
>    if(marg1)   labels<-c(labels,lab.p1)
>    if(marg2)   labels<-c(labels,lab.p2)
>    if(cond12)  labels<-c(labels,lab.pc12)
>    if(cond21)  labels<-c(labels,lab.pc21)
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Fri Aug  9 06:49:20 2024
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Fri, 9 Aug 2024 05:49:20 +0100
Subject: [R] If loop
In-Reply-To: <b0ac4755-70a9-4819-b64f-1388010a68e3@ntu.edu.tw>
References: <b6ce61b0-91e1-4f2c-b7b5-6d8298ae54a1@ntu.edu.tw>
 <b0ac4755-70a9-4819-b64f-1388010a68e3@ntu.edu.tw>
Message-ID: <7d9e2da9-c7c6-4a76-ac4c-ebead1aadce8@sapo.pt>

?s 05:33 de 09/08/2024, Steven Yen escreveu:
> The following (using if else) did not help. Seemed like joint12 always 
> kicked in.
> 
>  ??? me1<-me0<-NULL.
>  ??? if(joint12){
>  ????? {me1<-cbind(me1,v1$p12);? me0<-cbind(me0,v0$p12)}
>  ??? } else if(marg1) {
>  ????? {me1<-cbind(me1,v1$p1);?? me0<-cbind(me0,v0$p1)}
>  ??? } else if(marg2) {
>  ????? {me1<-cbind(me1,v1$p2);?? me0<-cbind(me0,v0$p2)}
>  ??? } else if(cond12){
>  ????? {me1<-cbind(me1,v1$pc12); me0<-cbind(me0,v0$pc12)}
>  ??? } else {
>  ????? {me1<-cbind(me1,v1$pc21); me0<-cbind(me0,v0$pc21)}
>  ??? }
> 
> ...
> 
>  ? labels<-NULL
>  ? if(joint12){
>  ??? labels<-c(labels,lab.p12)
>  ? } else if(marg1) {
>  ??? labels<-c(labels,lab.p1)
>  ? } else if(marg2) {
>  ??? labels<-c(labels,lab.p2)
>  ? } else if(cond12){
>  ??? labels<-c(labels,lab.pc12)
>  ? } else {
>  ??? labels<-c(labels,lab.pc21)
>  ? }
> 
> 
> On 8/9/2024 11:44 AM, Steven Yen wrote:
>> Can someone help me with the if loop below? In the subroutine, I 
>> initialize all of (joint12,marg1,marg2,cond12,cond21) as FALSE, and 
>> call with only one of them being TRUE:
>>
>> ,...,joint12=FALSE,marg1=FALSE,marg2=FALSE,cond12=FALSE,cond21=FALSE,,,,
>>
>> joint12 seems to always kick in, even though I call with, e.g., marg1 
>> being TRUE and everything else being FALSE. My attempts with if... 
>> else if were not useful. Please help. Thanks.
>>
>> v1<-cprob(z1,x1,a,b,mu1,mu2,rho,j+1,k+1)
>> ??? v0<-cprob(z0,x0,a,b,mu1,mu2,rho,j+1,k+1)
>>
>> ?? ...
>>
>> ??? me1<-me0<-NULL
>> ??? if(joint12) {me1<-cbind(me1,v1$p12); me0<-cbind(me0,v0$p12)}
>> ??? if(marg1)?? {me1<-cbind(me1,v1$p1); me0<-cbind(me0,v0$p1)}
>> ??? if(marg2)?? {me1<-cbind(me1,v1$p2); me0<-cbind(me0,v0$p2)}
>> ??? if(cond12)? {me1<-cbind(me1,v1$pc12); me0<-cbind(me0,v0$pc12)}
>> ??? if(cond21)? {me1<-cbind(me1,v1$pc21); me0<-cbind(me0,v0$pc21)}
>> ??? ...
>>
>> ? labels<-NULL
>> ? if(joint12) labels<-c(labels,lab.p12)
>> ? if(marg1)?? labels<-c(labels,lab.p1)
>> ? if(marg2)?? labels<-c(labels,lab.p2)
>> ? if(cond12)? labels<-c(labels,lab.pc12)
>> ? if(cond21)? labels<-c(labels,lab.pc21)
>>
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

What you are saying is hardly (not) possible.

If you ever call that code with joint12 set to TRUE, do you reset to 
FALSE afterwards?

Can you give a small working example with code and data showing this 
behavior?

Hope this helps,

Rui Barradas


-- 
Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.
www.avg.com


From po|c1410 @end|ng |rom gm@||@com  Fri Aug  9 08:35:08 2024
From: po|c1410 @end|ng |rom gm@||@com (CALUM POLWART)
Date: Fri, 9 Aug 2024 07:35:08 +0100
Subject: [R] If loop
In-Reply-To: <b6ce61b0-91e1-4f2c-b7b5-6d8298ae54a1@ntu.edu.tw>
References: <b6ce61b0-91e1-4f2c-b7b5-6d8298ae54a1@ntu.edu.tw>
Message-ID: <CA+etgPmNBAXj3PLcWqYmTr+-0k3naNdojqEOJ1TnWc21e4S13g@mail.gmail.com>

Is something wrong in the initialisation part that we don't see?

joint12 <- marg1 <-F

marg1 <-T

if (joint12) {
  print ("joint 12")
  cat (joint12)
}

if (marg1) {
  print("marg 1")
  cat(marg1)
}

Would probably be my diagnostic approach

On Fri, 9 Aug 2024, 04:45 Steven Yen, <styen at ntu.edu.tw> wrote:

> Can someone help me with the if loop below? In the subroutine, I
> initialize all of (joint12,marg1,marg2,cond12,cond21) as FALSE, and call
> with only one of them being TRUE:
>
> ,...,joint12=FALSE,marg1=FALSE,marg2=FALSE,cond12=FALSE,cond21=FALSE,,,,
>
> joint12 seems to always kick in, even though I call with, e.g., marg1
> being TRUE and everything else being FALSE. My attempts with if... else
> if were not useful. Please help. Thanks.
>
> v1<-cprob(z1,x1,a,b,mu1,mu2,rho,j+1,k+1)
>      v0<-cprob(z0,x0,a,b,mu1,mu2,rho,j+1,k+1)
>
>     ...
>
>      me1<-me0<-NULL
>      if(joint12) {me1<-cbind(me1,v1$p12); me0<-cbind(me0,v0$p12)}
>      if(marg1)   {me1<-cbind(me1,v1$p1); me0<-cbind(me0,v0$p1)}
>      if(marg2)   {me1<-cbind(me1,v1$p2); me0<-cbind(me0,v0$p2)}
>      if(cond12)  {me1<-cbind(me1,v1$pc12); me0<-cbind(me0,v0$pc12)}
>      if(cond21)  {me1<-cbind(me1,v1$pc21); me0<-cbind(me0,v0$pc21)}
>      ...
>
>    labels<-NULL
>    if(joint12) labels<-c(labels,lab.p12)
>    if(marg1)   labels<-c(labels,lab.p1)
>    if(marg2)   labels<-c(labels,lab.p2)
>    if(cond12)  labels<-c(labels,lab.pc12)
>    if(cond21)  labels<-c(labels,lab.pc21)
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @tyen @end|ng |rom ntu@edu@tw  Fri Aug  9 10:03:11 2024
From: @tyen @end|ng |rom ntu@edu@tw (Steven Yen)
Date: Fri, 9 Aug 2024 16:03:11 +0800
Subject: [R] If loop
In-Reply-To: <CA+etgPmNBAXj3PLcWqYmTr+-0k3naNdojqEOJ1TnWc21e4S13g@mail.gmail.com>
References: <b6ce61b0-91e1-4f2c-b7b5-6d8298ae54a1@ntu.edu.tw>
 <CA+etgPmNBAXj3PLcWqYmTr+-0k3naNdojqEOJ1TnWc21e4S13g@mail.gmail.com>
Message-ID: <23d8f633-b229-4aba-bd6c-5ac2c09220f1@ntu.edu.tw>

Thanks. Hmm. The loop is doing what it is supposed to do.

 > try1<-function(joint12=FALSE,marg1=FALSE,marg2=FALSE,
+??????????????? cond12=FALSE,cond21=FALSE){
+ # ***************************************************
+ # Testing if loop
+ # ***************************************************
+ if(joint12){
+?? {print ("joint12"); cat(joint12,"\n")}
+?? {print ("marg1"); cat(marg1,"\n")}
+ } else if (marg1) {
+?? {print ("marg1"); cat(marg1,"\n")}
+?? {print ("joint12"); cat(joint12)}
+ } else if (marg2) {
+?? {print ("marg2"); cat(marg2)}
+ } else if (cond12) {
+?? {print ("cond12"); cat(cond12)}
+ } else {
+?? {print ("cond21"); cat(cond21)}
+ }}
 > try1(joint12=TRUE)
[1] "joint12"
TRUE
[1] "marg1"
FALSE
 > try1(marg1=TRUE)
[1] "marg1"
TRUE
[1] "joint12"
FALSE
 > try1(marg2=TRUE)
[1] "marg2"
TRUE
 > try1(cond12=TRUE)
[1] "cond12"
TRUE
 > try1(cond21=TRUE)
[1] "cond21"
TRUE
 >

On 8/9/2024 2:35 PM, CALUM POLWART wrote:
>
> Is something wrong in the initialisation part that we don't see?
>
> joint12 <- marg1 <-F
>
> marg1 <-T
>
> if (joint12) {
> ? print ("joint 12")
> ? cat (joint12)
> }
>
> if (marg1) {
> ? print("marg 1")
> ? cat(marg1)
> }
>
> Would probably be my diagnostic approach
>
>
> On Fri, 9 Aug 2024, 04:45 Steven Yen, <styen at ntu.edu.tw> wrote:
>
>     Can someone help me with the if loop below? In the subroutine, I
>     initialize all of (joint12,marg1,marg2,cond12,cond21) as FALSE,
>     and call
>     with only one of them being TRUE:
>
>     ,...,joint12=FALSE,marg1=FALSE,marg2=FALSE,cond12=FALSE,cond21=FALSE,,,,
>
>     joint12 seems to always kick in, even though I call with, e.g., marg1
>     being TRUE and everything else being FALSE. My attempts with if...
>     else
>     if were not useful. Please help. Thanks.
>
>     v1<-cprob(z1,x1,a,b,mu1,mu2,rho,j+1,k+1)
>     ???? v0<-cprob(z0,x0,a,b,mu1,mu2,rho,j+1,k+1)
>
>     ??? ...
>
>     ???? me1<-me0<-NULL
>     ???? if(joint12) {me1<-cbind(me1,v1$p12); me0<-cbind(me0,v0$p12)}
>     ???? if(marg1)?? {me1<-cbind(me1,v1$p1); me0<-cbind(me0,v0$p1)}
>     ???? if(marg2)?? {me1<-cbind(me1,v1$p2); me0<-cbind(me0,v0$p2)}
>     ???? if(cond12)? {me1<-cbind(me1,v1$pc12); me0<-cbind(me0,v0$pc12)}
>     ???? if(cond21)? {me1<-cbind(me1,v1$pc21); me0<-cbind(me0,v0$pc21)}
>     ???? ...
>
>     ?? labels<-NULL
>     ?? if(joint12) labels<-c(labels,lab.p12)
>     ?? if(marg1)?? labels<-c(labels,lab.p1)
>     ?? if(marg2)?? labels<-c(labels,lab.p2)
>     ?? if(cond12)? labels<-c(labels,lab.pc12)
>     ?? if(cond21)? labels<-c(labels,lab.pc21)
>
>     ______________________________________________
>     R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>     https://stat.ethz.ch/mailman/listinfo/r-help
>     PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>     and provide commented, minimal, self-contained, reproducible code.
>
	[[alternative HTML version deleted]]


From po|c1410 @end|ng |rom gm@||@com  Fri Aug  9 10:45:47 2024
From: po|c1410 @end|ng |rom gm@||@com (CALUM POLWART)
Date: Fri, 9 Aug 2024 09:45:47 +0100
Subject: [R] If loop
In-Reply-To: <23d8f633-b229-4aba-bd6c-5ac2c09220f1@ntu.edu.tw>
References: <b6ce61b0-91e1-4f2c-b7b5-6d8298ae54a1@ntu.edu.tw>
 <CA+etgPmNBAXj3PLcWqYmTr+-0k3naNdojqEOJ1TnWc21e4S13g@mail.gmail.com>
 <23d8f633-b229-4aba-bd6c-5ac2c09220f1@ntu.edu.tw>
Message-ID: <CA+etgPkQvRHtNG3nAdCfMOubzX3uvPhpT9TNUD33LoKp79MH5w@mail.gmail.com>

OK. The fact it's in a function is making things clearer.

Are you trying to update the values of an object from within the function,
and have them available outside the function. I don't speak functional
programming articulately enough but basically

v <- 1

funA <- function() {
v <- v+1
}

funA()
cat (v)

# 1

You either return the v from the function so

funB <- function() {
v <- v+1
return (v)
}

v <- funB()
cat (v)
#2

Or use <<- assignment I think.  (I usually return, but return can only
return one object and I think you want two or more

v <- 1
funC <- function() {
v <<- v+1
}

funC()
cat (v)
#2

On Fri, 9 Aug 2024, 09:03 Steven Yen, <styen at ntu.edu.tw> wrote:

> Thanks. Hmm. The loop is doing what it is supposed to do.
>
> > try1<-function(joint12=FALSE,marg1=FALSE,marg2=FALSE,
> +                cond12=FALSE,cond21=FALSE){
> + # ***************************************************
> + # Testing if loop
> + # ***************************************************
> + if(joint12){
> +   {print ("joint12"); cat(joint12,"\n")}
> +   {print ("marg1"); cat(marg1,"\n")}
> + } else if (marg1) {
> +   {print ("marg1"); cat(marg1,"\n")}
> +   {print ("joint12"); cat(joint12)}
> + } else if (marg2) {
> +   {print ("marg2"); cat(marg2)}
> + } else if (cond12) {
> +   {print ("cond12"); cat(cond12)}
> + } else {
> +   {print ("cond21"); cat(cond21)}
> + }}
> > try1(joint12=TRUE)
> [1] "joint12"
> TRUE
> [1] "marg1"
> FALSE
> > try1(marg1=TRUE)
> [1] "marg1"
> TRUE
> [1] "joint12"
> FALSE
> > try1(marg2=TRUE)
> [1] "marg2"
> TRUE
> > try1(cond12=TRUE)
> [1] "cond12"
> TRUE
> > try1(cond21=TRUE)
> [1] "cond21"
> TRUE
> >
> On 8/9/2024 2:35 PM, CALUM POLWART wrote:
>
> Is something wrong in the initialisation part that we don't see?
>
> joint12 <- marg1 <-F
>
> marg1 <-T
>
> if (joint12) {
>   print ("joint 12")
>   cat (joint12)
> }
>
> if (marg1) {
>   print("marg 1")
>   cat(marg1)
> }
>
> Would probably be my diagnostic approach
>
> On Fri, 9 Aug 2024, 04:45 Steven Yen, <styen at ntu.edu.tw> wrote:
>
>> Can someone help me with the if loop below? In the subroutine, I
>> initialize all of (joint12,marg1,marg2,cond12,cond21) as FALSE, and call
>> with only one of them being TRUE:
>>
>> ,...,joint12=FALSE,marg1=FALSE,marg2=FALSE,cond12=FALSE,cond21=FALSE,,,,
>>
>> joint12 seems to always kick in, even though I call with, e.g., marg1
>> being TRUE and everything else being FALSE. My attempts with if... else
>> if were not useful. Please help. Thanks.
>>
>> v1<-cprob(z1,x1,a,b,mu1,mu2,rho,j+1,k+1)
>>      v0<-cprob(z0,x0,a,b,mu1,mu2,rho,j+1,k+1)
>>
>>     ...
>>
>>      me1<-me0<-NULL
>>      if(joint12) {me1<-cbind(me1,v1$p12); me0<-cbind(me0,v0$p12)}
>>      if(marg1)   {me1<-cbind(me1,v1$p1); me0<-cbind(me0,v0$p1)}
>>      if(marg2)   {me1<-cbind(me1,v1$p2); me0<-cbind(me0,v0$p2)}
>>      if(cond12)  {me1<-cbind(me1,v1$pc12); me0<-cbind(me0,v0$pc12)}
>>      if(cond21)  {me1<-cbind(me1,v1$pc21); me0<-cbind(me0,v0$pc21)}
>>      ...
>>
>>    labels<-NULL
>>    if(joint12) labels<-c(labels,lab.p12)
>>    if(marg1)   labels<-c(labels,lab.p1)
>>    if(marg2)   labels<-c(labels,lab.p2)
>>    if(cond12)  labels<-c(labels,lab.pc12)
>>    if(cond21)  labels<-c(labels,lab.pc21)
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Fri Aug  9 12:21:07 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 9 Aug 2024 03:21:07 -0700
Subject: [R] If loop
In-Reply-To: <CA+etgPkQvRHtNG3nAdCfMOubzX3uvPhpT9TNUD33LoKp79MH5w@mail.gmail.com>
References: <b6ce61b0-91e1-4f2c-b7b5-6d8298ae54a1@ntu.edu.tw>
 <CA+etgPmNBAXj3PLcWqYmTr+-0k3naNdojqEOJ1TnWc21e4S13g@mail.gmail.com>
 <23d8f633-b229-4aba-bd6c-5ac2c09220f1@ntu.edu.tw>
 <CA+etgPkQvRHtNG3nAdCfMOubzX3uvPhpT9TNUD33LoKp79MH5w@mail.gmail.com>
Message-ID: <CAGxFJbT5idGPtiLO9qRBjN7e7SCC1yuuG7rR2asvVMFcWE_x8A@mail.gmail.com>

"Or use <<- assignment I think.  (I usually return, but return can only
return one object and I think you want two or more"

You can return any number of objects by putting them in a list and
returning the list.
Use of "<<-" is rarely a good idea in R.

-- Bert

On Fri, Aug 9, 2024 at 1:53?AM CALUM POLWART <polc1410 at gmail.com> wrote:
>
> OK. The fact it's in a function is making things clearer.
>
> Are you trying to update the values of an object from within the function,
> and have them available outside the function. I don't speak functional
> programming articulately enough but basically
>
> v <- 1
>
> funA <- function() {
> v <- v+1
> }
>
> funA()
> cat (v)
>
> # 1
>
> You either return the v from the function so
>
> funB <- function() {
> v <- v+1
> return (v)
> }
>
> v <- funB()
> cat (v)
> #2
>
> Or use <<- assignment I think.  (I usually return, but return can only
> return one object and I think you want two or more
>
> v <- 1
> funC <- function() {
> v <<- v+1
> }
>
> funC()
> cat (v)
> #2
>
> On Fri, 9 Aug 2024, 09:03 Steven Yen, <styen at ntu.edu.tw> wrote:
>
> > Thanks. Hmm. The loop is doing what it is supposed to do.
> >
> > > try1<-function(joint12=FALSE,marg1=FALSE,marg2=FALSE,
> > +                cond12=FALSE,cond21=FALSE){
> > + # ***************************************************
> > + # Testing if loop
> > + # ***************************************************
> > + if(joint12){
> > +   {print ("joint12"); cat(joint12,"\n")}
> > +   {print ("marg1"); cat(marg1,"\n")}
> > + } else if (marg1) {
> > +   {print ("marg1"); cat(marg1,"\n")}
> > +   {print ("joint12"); cat(joint12)}
> > + } else if (marg2) {
> > +   {print ("marg2"); cat(marg2)}
> > + } else if (cond12) {
> > +   {print ("cond12"); cat(cond12)}
> > + } else {
> > +   {print ("cond21"); cat(cond21)}
> > + }}
> > > try1(joint12=TRUE)
> > [1] "joint12"
> > TRUE
> > [1] "marg1"
> > FALSE
> > > try1(marg1=TRUE)
> > [1] "marg1"
> > TRUE
> > [1] "joint12"
> > FALSE
> > > try1(marg2=TRUE)
> > [1] "marg2"
> > TRUE
> > > try1(cond12=TRUE)
> > [1] "cond12"
> > TRUE
> > > try1(cond21=TRUE)
> > [1] "cond21"
> > TRUE
> > >
> > On 8/9/2024 2:35 PM, CALUM POLWART wrote:
> >
> > Is something wrong in the initialisation part that we don't see?
> >
> > joint12 <- marg1 <-F
> >
> > marg1 <-T
> >
> > if (joint12) {
> >   print ("joint 12")
> >   cat (joint12)
> > }
> >
> > if (marg1) {
> >   print("marg 1")
> >   cat(marg1)
> > }
> >
> > Would probably be my diagnostic approach
> >
> > On Fri, 9 Aug 2024, 04:45 Steven Yen, <styen at ntu.edu.tw> wrote:
> >
> >> Can someone help me with the if loop below? In the subroutine, I
> >> initialize all of (joint12,marg1,marg2,cond12,cond21) as FALSE, and call
> >> with only one of them being TRUE:
> >>
> >> ,...,joint12=FALSE,marg1=FALSE,marg2=FALSE,cond12=FALSE,cond21=FALSE,,,,
> >>
> >> joint12 seems to always kick in, even though I call with, e.g., marg1
> >> being TRUE and everything else being FALSE. My attempts with if... else
> >> if were not useful. Please help. Thanks.
> >>
> >> v1<-cprob(z1,x1,a,b,mu1,mu2,rho,j+1,k+1)
> >>      v0<-cprob(z0,x0,a,b,mu1,mu2,rho,j+1,k+1)
> >>
> >>     ...
> >>
> >>      me1<-me0<-NULL
> >>      if(joint12) {me1<-cbind(me1,v1$p12); me0<-cbind(me0,v0$p12)}
> >>      if(marg1)   {me1<-cbind(me1,v1$p1); me0<-cbind(me0,v0$p1)}
> >>      if(marg2)   {me1<-cbind(me1,v1$p2); me0<-cbind(me0,v0$p2)}
> >>      if(cond12)  {me1<-cbind(me1,v1$pc12); me0<-cbind(me0,v0$pc12)}
> >>      if(cond21)  {me1<-cbind(me1,v1$pc21); me0<-cbind(me0,v0$pc21)}
> >>      ...
> >>
> >>    labels<-NULL
> >>    if(joint12) labels<-c(labels,lab.p12)
> >>    if(marg1)   labels<-c(labels,lab.p1)
> >>    if(marg2)   labels<-c(labels,lab.p2)
> >>    if(cond12)  labels<-c(labels,lab.pc12)
> >>    if(cond21)  labels<-c(labels,lab.pc21)
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> >> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >>
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @tyen @end|ng |rom ntu@edu@tw  Fri Aug  9 12:31:11 2024
From: @tyen @end|ng |rom ntu@edu@tw (Steven Yen)
Date: Fri, 9 Aug 2024 18:31:11 +0800
Subject: [R] If loop
In-Reply-To: <CAGxFJbT5idGPtiLO9qRBjN7e7SCC1yuuG7rR2asvVMFcWE_x8A@mail.gmail.com>
References: <b6ce61b0-91e1-4f2c-b7b5-6d8298ae54a1@ntu.edu.tw>
 <CA+etgPmNBAXj3PLcWqYmTr+-0k3naNdojqEOJ1TnWc21e4S13g@mail.gmail.com>
 <23d8f633-b229-4aba-bd6c-5ac2c09220f1@ntu.edu.tw>
 <CA+etgPkQvRHtNG3nAdCfMOubzX3uvPhpT9TNUD33LoKp79MH5w@mail.gmail.com>
 <CAGxFJbT5idGPtiLO9qRBjN7e7SCC1yuuG7rR2asvVMFcWE_x8A@mail.gmail.com>
Message-ID: <8c14b9a0-03a1-46e2-93a9-8df9b61aaedc@ntu.edu.tw>

Thanks. Hmm, I like the idea of returning a list. I occasionally use 
?invisible? and am still trying to figure out its difference with return.

Where do I read about <<- assignment?

On 8/9/2024 6:21 PM, Bert Gunter wrote:
> "Or use <<- assignment I think.  (I usually return, but return can only
> return one object and I think you want two or more"
>
> You can return any number of objects by putting them in a list and
> returning the list.
> Use of "<<-" is rarely a good idea in R.
>
> -- Bert
>
> On Fri, Aug 9, 2024 at 1:53?AM CALUM POLWART<polc1410 at gmail.com>  wrote:
>> OK. The fact it's in a function is making things clearer.
>>
>> Are you trying to update the values of an object from within the function,
>> and have them available outside the function. I don't speak functional
>> programming articulately enough but basically
>>
>> v <- 1
>>
>> funA <- function() {
>> v <- v+1
>> }
>>
>> funA()
>> cat (v)
>>
>> # 1
>>
>> You either return the v from the function so
>>
>> funB <- function() {
>> v <- v+1
>> return (v)
>> }
>>
>> v <- funB()
>> cat (v)
>> #2
>>
>> Or use <<- assignment I think.  (I usually return, but return can only
>> return one object and I think you want two or more
>>
>> v <- 1
>> funC <- function() {
>> v <<- v+1
>> }
>>
>> funC()
>> cat (v)
>> #2
>>
>> On Fri, 9 Aug 2024, 09:03 Steven Yen,<styen at ntu.edu.tw>  wrote:
>>
>>> Thanks. Hmm. The loop is doing what it is supposed to do.
>>>
>>>> try1<-function(joint12=FALSE,marg1=FALSE,marg2=FALSE,
>>> +                cond12=FALSE,cond21=FALSE){
>>> + # ***************************************************
>>> + # Testing if loop
>>> + # ***************************************************
>>> + if(joint12){
>>> +   {print ("joint12"); cat(joint12,"\n")}
>>> +   {print ("marg1"); cat(marg1,"\n")}
>>> + } else if (marg1) {
>>> +   {print ("marg1"); cat(marg1,"\n")}
>>> +   {print ("joint12"); cat(joint12)}
>>> + } else if (marg2) {
>>> +   {print ("marg2"); cat(marg2)}
>>> + } else if (cond12) {
>>> +   {print ("cond12"); cat(cond12)}
>>> + } else {
>>> +   {print ("cond21"); cat(cond21)}
>>> + }}
>>>> try1(joint12=TRUE)
>>> [1] "joint12"
>>> TRUE
>>> [1] "marg1"
>>> FALSE
>>>> try1(marg1=TRUE)
>>> [1] "marg1"
>>> TRUE
>>> [1] "joint12"
>>> FALSE
>>>> try1(marg2=TRUE)
>>> [1] "marg2"
>>> TRUE
>>>> try1(cond12=TRUE)
>>> [1] "cond12"
>>> TRUE
>>>> try1(cond21=TRUE)
>>> [1] "cond21"
>>> TRUE
>>> On 8/9/2024 2:35 PM, CALUM POLWART wrote:
>>>
>>> Is something wrong in the initialisation part that we don't see?
>>>
>>> joint12 <- marg1 <-F
>>>
>>> marg1 <-T
>>>
>>> if (joint12) {
>>>    print ("joint 12")
>>>    cat (joint12)
>>> }
>>>
>>> if (marg1) {
>>>    print("marg 1")
>>>    cat(marg1)
>>> }
>>>
>>> Would probably be my diagnostic approach
>>>
>>> On Fri, 9 Aug 2024, 04:45 Steven Yen,<styen at ntu.edu.tw>  wrote:
>>>
>>>> Can someone help me with the if loop below? In the subroutine, I
>>>> initialize all of (joint12,marg1,marg2,cond12,cond21) as FALSE, and call
>>>> with only one of them being TRUE:
>>>>
>>>> ,...,joint12=FALSE,marg1=FALSE,marg2=FALSE,cond12=FALSE,cond21=FALSE,,,,
>>>>
>>>> joint12 seems to always kick in, even though I call with, e.g., marg1
>>>> being TRUE and everything else being FALSE. My attempts with if... else
>>>> if were not useful. Please help. Thanks.
>>>>
>>>> v1<-cprob(z1,x1,a,b,mu1,mu2,rho,j+1,k+1)
>>>>       v0<-cprob(z0,x0,a,b,mu1,mu2,rho,j+1,k+1)
>>>>
>>>>      ...
>>>>
>>>>       me1<-me0<-NULL
>>>>       if(joint12) {me1<-cbind(me1,v1$p12); me0<-cbind(me0,v0$p12)}
>>>>       if(marg1)   {me1<-cbind(me1,v1$p1); me0<-cbind(me0,v0$p1)}
>>>>       if(marg2)   {me1<-cbind(me1,v1$p2); me0<-cbind(me0,v0$p2)}
>>>>       if(cond12)  {me1<-cbind(me1,v1$pc12); me0<-cbind(me0,v0$pc12)}
>>>>       if(cond21)  {me1<-cbind(me1,v1$pc21); me0<-cbind(me0,v0$pc21)}
>>>>       ...
>>>>
>>>>     labels<-NULL
>>>>     if(joint12) labels<-c(labels,lab.p12)
>>>>     if(marg1)   labels<-c(labels,lab.p1)
>>>>     if(marg2)   labels<-c(labels,lab.p2)
>>>>     if(cond12)  labels<-c(labels,lab.pc12)
>>>>     if(cond21)  labels<-c(labels,lab.pc21)
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org  mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org  mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guidehttp://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Aug  9 13:36:10 2024
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 9 Aug 2024 07:36:10 -0400
Subject: [R] If loop
In-Reply-To: <CAGxFJbT5idGPtiLO9qRBjN7e7SCC1yuuG7rR2asvVMFcWE_x8A@mail.gmail.com>
References: <b6ce61b0-91e1-4f2c-b7b5-6d8298ae54a1@ntu.edu.tw>
 <CA+etgPmNBAXj3PLcWqYmTr+-0k3naNdojqEOJ1TnWc21e4S13g@mail.gmail.com>
 <23d8f633-b229-4aba-bd6c-5ac2c09220f1@ntu.edu.tw>
 <CA+etgPkQvRHtNG3nAdCfMOubzX3uvPhpT9TNUD33LoKp79MH5w@mail.gmail.com>
 <CAGxFJbT5idGPtiLO9qRBjN7e7SCC1yuuG7rR2asvVMFcWE_x8A@mail.gmail.com>
Message-ID: <8dae1851-8516-45b0-99b1-4de8c52e1c89@gmail.com>

On 2024-08-09 6:21 a.m., Bert Gunter wrote:
> "Or use <<- assignment I think.  (I usually return, but return can only
> return one object and I think you want two or more"
> 
> You can return any number of objects by putting them in a list and
> returning the list.
> Use of "<<-" is rarely a good idea in R.

Proper use of "<<-" is often a good idea.  This wouldn't be what I'd 
call proper use.  The example in section 10.7 of the Intro manual is a 
good use.

It would be a positive change to the language if the target of the 
assignment was required to be an existing variable in a parent environment.

Duncan Murdoch


> 
> -- Bert
> 
> On Fri, Aug 9, 2024 at 1:53?AM CALUM POLWART <polc1410 at gmail.com> wrote:
>>
>> OK. The fact it's in a function is making things clearer.
>>
>> Are you trying to update the values of an object from within the function,
>> and have them available outside the function. I don't speak functional
>> programming articulately enough but basically
>>
>> v <- 1
>>
>> funA <- function() {
>> v <- v+1
>> }
>>
>> funA()
>> cat (v)
>>
>> # 1
>>
>> You either return the v from the function so
>>
>> funB <- function() {
>> v <- v+1
>> return (v)
>> }
>>
>> v <- funB()
>> cat (v)
>> #2
>>
>> Or use <<- assignment I think.  (I usually return, but return can only
>> return one object and I think you want two or more
>>
>> v <- 1
>> funC <- function() {
>> v <<- v+1
>> }
>>
>> funC()
>> cat (v)
>> #2
>>
>> On Fri, 9 Aug 2024, 09:03 Steven Yen, <styen at ntu.edu.tw> wrote:
>>
>>> Thanks. Hmm. The loop is doing what it is supposed to do.
>>>
>>>> try1<-function(joint12=FALSE,marg1=FALSE,marg2=FALSE,
>>> +                cond12=FALSE,cond21=FALSE){
>>> + # ***************************************************
>>> + # Testing if loop
>>> + # ***************************************************
>>> + if(joint12){
>>> +   {print ("joint12"); cat(joint12,"\n")}
>>> +   {print ("marg1"); cat(marg1,"\n")}
>>> + } else if (marg1) {
>>> +   {print ("marg1"); cat(marg1,"\n")}
>>> +   {print ("joint12"); cat(joint12)}
>>> + } else if (marg2) {
>>> +   {print ("marg2"); cat(marg2)}
>>> + } else if (cond12) {
>>> +   {print ("cond12"); cat(cond12)}
>>> + } else {
>>> +   {print ("cond21"); cat(cond21)}
>>> + }}
>>>> try1(joint12=TRUE)
>>> [1] "joint12"
>>> TRUE
>>> [1] "marg1"
>>> FALSE
>>>> try1(marg1=TRUE)
>>> [1] "marg1"
>>> TRUE
>>> [1] "joint12"
>>> FALSE
>>>> try1(marg2=TRUE)
>>> [1] "marg2"
>>> TRUE
>>>> try1(cond12=TRUE)
>>> [1] "cond12"
>>> TRUE
>>>> try1(cond21=TRUE)
>>> [1] "cond21"
>>> TRUE
>>>>
>>> On 8/9/2024 2:35 PM, CALUM POLWART wrote:
>>>
>>> Is something wrong in the initialisation part that we don't see?
>>>
>>> joint12 <- marg1 <-F
>>>
>>> marg1 <-T
>>>
>>> if (joint12) {
>>>    print ("joint 12")
>>>    cat (joint12)
>>> }
>>>
>>> if (marg1) {
>>>    print("marg 1")
>>>    cat(marg1)
>>> }
>>>
>>> Would probably be my diagnostic approach
>>>
>>> On Fri, 9 Aug 2024, 04:45 Steven Yen, <styen at ntu.edu.tw> wrote:
>>>
>>>> Can someone help me with the if loop below? In the subroutine, I
>>>> initialize all of (joint12,marg1,marg2,cond12,cond21) as FALSE, and call
>>>> with only one of them being TRUE:
>>>>
>>>> ,...,joint12=FALSE,marg1=FALSE,marg2=FALSE,cond12=FALSE,cond21=FALSE,,,,
>>>>
>>>> joint12 seems to always kick in, even though I call with, e.g., marg1
>>>> being TRUE and everything else being FALSE. My attempts with if... else
>>>> if were not useful. Please help. Thanks.
>>>>
>>>> v1<-cprob(z1,x1,a,b,mu1,mu2,rho,j+1,k+1)
>>>>       v0<-cprob(z0,x0,a,b,mu1,mu2,rho,j+1,k+1)
>>>>
>>>>      ...
>>>>
>>>>       me1<-me0<-NULL
>>>>       if(joint12) {me1<-cbind(me1,v1$p12); me0<-cbind(me0,v0$p12)}
>>>>       if(marg1)   {me1<-cbind(me1,v1$p1); me0<-cbind(me0,v0$p1)}
>>>>       if(marg2)   {me1<-cbind(me1,v1$p2); me0<-cbind(me0,v0$p2)}
>>>>       if(cond12)  {me1<-cbind(me1,v1$pc12); me0<-cbind(me0,v0$pc12)}
>>>>       if(cond21)  {me1<-cbind(me1,v1$pc21); me0<-cbind(me0,v0$pc21)}
>>>>       ...
>>>>
>>>>     labels<-NULL
>>>>     if(joint12) labels<-c(labels,lab.p12)
>>>>     if(marg1)   labels<-c(labels,lab.p1)
>>>>     if(marg2)   labels<-c(labels,lab.p2)
>>>>     if(cond12)  labels<-c(labels,lab.pc12)
>>>>     if(cond21)  labels<-c(labels,lab.pc21)
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>>
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From po|c1410 @end|ng |rom gm@||@com  Fri Aug  9 13:43:46 2024
From: po|c1410 @end|ng |rom gm@||@com (CALUM POLWART)
Date: Fri, 9 Aug 2024 12:43:46 +0100
Subject: [R] If loop
In-Reply-To: <CAGxFJbT5idGPtiLO9qRBjN7e7SCC1yuuG7rR2asvVMFcWE_x8A@mail.gmail.com>
References: <b6ce61b0-91e1-4f2c-b7b5-6d8298ae54a1@ntu.edu.tw>
 <CA+etgPmNBAXj3PLcWqYmTr+-0k3naNdojqEOJ1TnWc21e4S13g@mail.gmail.com>
 <23d8f633-b229-4aba-bd6c-5ac2c09220f1@ntu.edu.tw>
 <CA+etgPkQvRHtNG3nAdCfMOubzX3uvPhpT9TNUD33LoKp79MH5w@mail.gmail.com>
 <CAGxFJbT5idGPtiLO9qRBjN7e7SCC1yuuG7rR2asvVMFcWE_x8A@mail.gmail.com>
Message-ID: <CA+etgPnr19Ks5KuYAeDuhZkgzJCNYpDT06v6NjUEqJXCRmbH_A@mail.gmail.com>

Oh I thought that was just my experience of it !! So didn't want to slate
it too much!!

Yes, I nearly said "without making it an object of objects". I guess it
depends what they want to do with those objects in the end.

Usually if I want a function to manipulate two things I create two
functions.

On Fri, 9 Aug 2024, 11:21 Bert Gunter, <bgunter.4567 at gmail.com> wrote:

> "Or use <<- assignment I think.  (I usually return, but return can only
> return one object and I think you want two or more"
>
> You can return any number of objects by putting them in a list and
> returning the list.
> Use of "<<-" is rarely a good idea in R.
>
> -- Bert
>
> On Fri, Aug 9, 2024 at 1:53?AM CALUM POLWART <polc1410 at gmail.com> wrote:
> >
> > OK. The fact it's in a function is making things clearer.
> >
> > Are you trying to update the values of an object from within the
> function,
> > and have them available outside the function. I don't speak functional
> > programming articulately enough but basically
> >
> > v <- 1
> >
> > funA <- function() {
> > v <- v+1
> > }
> >
> > funA()
> > cat (v)
> >
> > # 1
> >
> > You either return the v from the function so
> >
> > funB <- function() {
> > v <- v+1
> > return (v)
> > }
> >
> > v <- funB()
> > cat (v)
> > #2
> >
> > Or use <<- assignment I think.  (I usually return, but return can only
> > return one object and I think you want two or more
> >
> > v <- 1
> > funC <- function() {
> > v <<- v+1
> > }
> >
> > funC()
> > cat (v)
> > #2
> >
> > On Fri, 9 Aug 2024, 09:03 Steven Yen, <styen at ntu.edu.tw> wrote:
> >
> > > Thanks. Hmm. The loop is doing what it is supposed to do.
> > >
> > > > try1<-function(joint12=FALSE,marg1=FALSE,marg2=FALSE,
> > > +                cond12=FALSE,cond21=FALSE){
> > > + # ***************************************************
> > > + # Testing if loop
> > > + # ***************************************************
> > > + if(joint12){
> > > +   {print ("joint12"); cat(joint12,"\n")}
> > > +   {print ("marg1"); cat(marg1,"\n")}
> > > + } else if (marg1) {
> > > +   {print ("marg1"); cat(marg1,"\n")}
> > > +   {print ("joint12"); cat(joint12)}
> > > + } else if (marg2) {
> > > +   {print ("marg2"); cat(marg2)}
> > > + } else if (cond12) {
> > > +   {print ("cond12"); cat(cond12)}
> > > + } else {
> > > +   {print ("cond21"); cat(cond21)}
> > > + }}
> > > > try1(joint12=TRUE)
> > > [1] "joint12"
> > > TRUE
> > > [1] "marg1"
> > > FALSE
> > > > try1(marg1=TRUE)
> > > [1] "marg1"
> > > TRUE
> > > [1] "joint12"
> > > FALSE
> > > > try1(marg2=TRUE)
> > > [1] "marg2"
> > > TRUE
> > > > try1(cond12=TRUE)
> > > [1] "cond12"
> > > TRUE
> > > > try1(cond21=TRUE)
> > > [1] "cond21"
> > > TRUE
> > > >
> > > On 8/9/2024 2:35 PM, CALUM POLWART wrote:
> > >
> > > Is something wrong in the initialisation part that we don't see?
> > >
> > > joint12 <- marg1 <-F
> > >
> > > marg1 <-T
> > >
> > > if (joint12) {
> > >   print ("joint 12")
> > >   cat (joint12)
> > > }
> > >
> > > if (marg1) {
> > >   print("marg 1")
> > >   cat(marg1)
> > > }
> > >
> > > Would probably be my diagnostic approach
> > >
> > > On Fri, 9 Aug 2024, 04:45 Steven Yen, <styen at ntu.edu.tw> wrote:
> > >
> > >> Can someone help me with the if loop below? In the subroutine, I
> > >> initialize all of (joint12,marg1,marg2,cond12,cond21) as FALSE, and
> call
> > >> with only one of them being TRUE:
> > >>
> > >>
> ,...,joint12=FALSE,marg1=FALSE,marg2=FALSE,cond12=FALSE,cond21=FALSE,,,,
> > >>
> > >> joint12 seems to always kick in, even though I call with, e.g., marg1
> > >> being TRUE and everything else being FALSE. My attempts with if...
> else
> > >> if were not useful. Please help. Thanks.
> > >>
> > >> v1<-cprob(z1,x1,a,b,mu1,mu2,rho,j+1,k+1)
> > >>      v0<-cprob(z0,x0,a,b,mu1,mu2,rho,j+1,k+1)
> > >>
> > >>     ...
> > >>
> > >>      me1<-me0<-NULL
> > >>      if(joint12) {me1<-cbind(me1,v1$p12); me0<-cbind(me0,v0$p12)}
> > >>      if(marg1)   {me1<-cbind(me1,v1$p1); me0<-cbind(me0,v0$p1)}
> > >>      if(marg2)   {me1<-cbind(me1,v1$p2); me0<-cbind(me0,v0$p2)}
> > >>      if(cond12)  {me1<-cbind(me1,v1$pc12); me0<-cbind(me0,v0$pc12)}
> > >>      if(cond21)  {me1<-cbind(me1,v1$pc21); me0<-cbind(me0,v0$pc21)}
> > >>      ...
> > >>
> > >>    labels<-NULL
> > >>    if(joint12) labels<-c(labels,lab.p12)
> > >>    if(marg1)   labels<-c(labels,lab.p1)
> > >>    if(marg2)   labels<-c(labels,lab.p2)
> > >>    if(cond12)  labels<-c(labels,lab.pc12)
> > >>    if(cond21)  labels<-c(labels,lab.pc21)
> > >>
> > >> ______________________________________________
> > >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > >> https://stat.ethz.ch/mailman/listinfo/r-help
> > >> PLEASE do read the posting guide
> > >> http://www.R-project.org/posting-guide.html
> > >> and provide commented, minimal, self-contained, reproducible code.
> > >>
> > >
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Fri Aug  9 14:23:58 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Fri, 9 Aug 2024 15:23:58 +0300
Subject: [R] WDI package commands timing out and not working
In-Reply-To: <CAFL9eun-6HWgw1LQ1xia0vS+wqb+xe4oC7irr=GogVi0U45v8A@mail.gmail.com>
References: <CAFL9eun-6HWgw1LQ1xia0vS+wqb+xe4oC7irr=GogVi0U45v8A@mail.gmail.com>
Message-ID: <20240809152358.4c56c457@arachnoid>

? Thu, 8 Aug 2024 12:43:23 +0530
Anupam Tyagi <anuptyagi at gmail.com> ?????:

> In open.connection(con, "rb") :
>   URL
> 'https://api.worldbank.org/v2/en/country/OED/indicator/NY.ADJ.NNAT.GN.ZS?format=json&date=1977:2020&per_page=32500&page=1':
> Timeout of 60 seconds was reached

If you try to open the link in the browser, does it work? How long does
it take to download? Try increasing options(timeout=...) to a larger
time (in seconds).

I see there is Cloudflare sitting in front of the API, but it's
relatively non-aggressive. I could only get it to deny my request by
accessing it through Tor.

-- 
Best regards,
Ivan


From @nupty@g| @end|ng |rom gm@||@com  Fri Aug  9 15:00:05 2024
From: @nupty@g| @end|ng |rom gm@||@com (Anupam Tyagi)
Date: Fri, 9 Aug 2024 18:30:05 +0530
Subject: [R] WDI package commands timing out and not working
In-Reply-To: <20240809152358.4c56c457@arachnoid>
References: <CAFL9eun-6HWgw1LQ1xia0vS+wqb+xe4oC7irr=GogVi0U45v8A@mail.gmail.com>
 <20240809152358.4c56c457@arachnoid>
Message-ID: <CAFL9eunAHzAMiWYiSSXntQCUG8gjbwJ=JsxT89rJXxvMRoVecQ@mail.gmail.com>

In the browser the link downloads immediately, in less than a second. I let
the command run in R for five minutes, using R Studio. Nothing happened.

On Fri, 9 Aug 2024 at 17:54, Ivan Krylov <ikrylov at disroot.org> wrote:

> ? Thu, 8 Aug 2024 12:43:23 +0530
> Anupam Tyagi <anuptyagi at gmail.com> ?????:
>
> > In open.connection(con, "rb") :
> >   URL
> > '
> https://api.worldbank.org/v2/en/country/OED/indicator/NY.ADJ.NNAT.GN.ZS?format=json&date=1977:2020&per_page=32500&page=1
> ':
> > Timeout of 60 seconds was reached
>
> If you try to open the link in the browser, does it work? How long does
> it take to download? Try increasing options(timeout=...) to a larger
> time (in seconds).
>
> I see there is Cloudflare sitting in front of the API, but it's
> relatively non-aggressive. I could only get it to deny my request by
> accessing it through Tor.
>
> --
> Best regards,
> Ivan
>


-- 
Anupam.

	[[alternative HTML version deleted]]


From @nupty@g| @end|ng |rom gm@||@com  Fri Aug  9 15:04:56 2024
From: @nupty@g| @end|ng |rom gm@||@com (Anupam Tyagi)
Date: Fri, 9 Aug 2024 18:34:56 +0530
Subject: [R] WDI package commands timing out and not working
In-Reply-To: <CAFL9eunAHzAMiWYiSSXntQCUG8gjbwJ=JsxT89rJXxvMRoVecQ@mail.gmail.com>
References: <CAFL9eun-6HWgw1LQ1xia0vS+wqb+xe4oC7irr=GogVi0U45v8A@mail.gmail.com>
 <20240809152358.4c56c457@arachnoid>
 <CAFL9eunAHzAMiWYiSSXntQCUG8gjbwJ=JsxT89rJXxvMRoVecQ@mail.gmail.com>
Message-ID: <CAFL9eungZ7a5VZCEyug=xw=+PiHn3zCHVEHoo_j6h31tKyj+bg@mail.gmail.com>

I tried running the same command on my home computer, and it downloaded in
less than 30 seconds. So, it seems the problem is with internet connection
at work. Thanks, Ivan.

On Fri, 9 Aug 2024 at 18:30, Anupam Tyagi <anuptyagi at gmail.com> wrote:

> In the browser the link downloads immediately, in less than a second. I
> let the command run in R for five minutes, using R Studio. Nothing happened.
>
> On Fri, 9 Aug 2024 at 17:54, Ivan Krylov <ikrylov at disroot.org> wrote:
>
>> ? Thu, 8 Aug 2024 12:43:23 +0530
>> Anupam Tyagi <anuptyagi at gmail.com> ?????:
>>
>> > In open.connection(con, "rb") :
>> >   URL
>> > '
>> https://api.worldbank.org/v2/en/country/OED/indicator/NY.ADJ.NNAT.GN.ZS?format=json&date=1977:2020&per_page=32500&page=1
>> ':
>> > Timeout of 60 seconds was reached
>>
>> If you try to open the link in the browser, does it work? How long does
>> it take to download? Try increasing options(timeout=...) to a larger
>> time (in seconds).
>>
>> I see there is Cloudflare sitting in front of the API, but it's
>> relatively non-aggressive. I could only get it to deny my request by
>> accessing it through Tor.
>>
>> --
>> Best regards,
>> Ivan
>>
>
>
> --
> Anupam.
>
>

-- 
Anupam.

	[[alternative HTML version deleted]]


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Fri Aug  9 15:08:39 2024
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Fri, 9 Aug 2024 15:08:39 +0200
Subject: [R] WDI package commands timing out and not working
In-Reply-To: <20240809152358.4c56c457@arachnoid>
References: <CAFL9eun-6HWgw1LQ1xia0vS+wqb+xe4oC7irr=GogVi0U45v8A@mail.gmail.com>
 <20240809152358.4c56c457@arachnoid>
Message-ID: <26294.5335.483728.210282@stat.math.ethz.ch>

>>>>> Ivan Krylov via R-help 
>>>>>     on Fri, 9 Aug 2024 15:23:58 +0300 writes:

    > ? Thu, 8 Aug 2024 12:43:23 +0530
    > Anupam Tyagi <anuptyagi at gmail.com> ?????:

    >> In open.connection(con, "rb") :
    >> URL
    >> 'https://api.worldbank.org/v2/en/country/OED/indicator/NY.ADJ.NNAT.GN.ZS?format=json&date=1977:2020&per_page=32500&page=1':
    >> Timeout of 60 seconds was reached

    > If you try to open the link in the browser, does it work? How long does
    > it take to download? Try increasing options(timeout=...) to a larger
    > time (in seconds).

    > I see there is Cloudflare sitting in front of the API, but it's
    > relatively non-aggressive. I could only get it to deny my request by
    > accessing it through Tor.
;-\

In R  (but *not* inside RStudio), I see {from Zurich, Switzerland},

  > require(WDI)
  Loading required package: WDI
  > system.time(dat1EU <- 
      WDI(indicator = c('NY.ADJ.NNAT.GN.ZS', 'NY.GNS.ICTR.GN.ZS'), country = c('EU'), start=1977, end=2020))

     user  system elapsed 
    0.466   0.028   5.828 
  > 
  > str(dat1EU)
  'data.frame':	44 obs. of  6 variables:
   $ country          : chr  "European Union" "European Union" "European Union" "European Union" ...
   $ iso2c            : chr  "EU" "EU" "EU" "EU" ...
   $ iso3c            : chr  "EUU" "EUU" "EUU" "EUU" ...
   $ year             : int  1977 1978 1979 1980 1981 1982 1983 1984 1985 1986 ...
   $ NY.ADJ.NNAT.GN.ZS: num  9.13 9.57 9.36 7.83 5.67 ...
    ..- attr(*, "label")= chr "Adjusted savings: net national savings (% of GNI)"
   $ NY.GNS.ICTR.GN.ZS: num  23 23.4 23.2 22.3 20.8 ...
    ..- attr(*, "label")= chr "Gross savings (% of GNI)"
  > 

which seems pretty nice, similar to Ivan's experience

    > -- 
    > Best regards,
    > Ivan

    > ______________________________________________
    > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
    > https://stat.ethz.ch/mailman/listinfo/r-help
    > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
    > and provide commented, minimal, self-contained, reproducible code.


From @nupty@g| @end|ng |rom gm@||@com  Fri Aug  9 16:55:51 2024
From: @nupty@g| @end|ng |rom gm@||@com (Anupam Tyagi)
Date: Fri, 9 Aug 2024 20:25:51 +0530
Subject: [R] WDI package commands timing out and not working
In-Reply-To: <26294.5335.483728.210282@stat.math.ethz.ch>
References: <CAFL9eun-6HWgw1LQ1xia0vS+wqb+xe4oC7irr=GogVi0U45v8A@mail.gmail.com>
 <20240809152358.4c56c457@arachnoid>
 <26294.5335.483728.210282@stat.math.ethz.ch>
Message-ID: <CAFL9eu=t7-SUX=VJcjT8No5wx6bKJgy866p=qUsjg75ZzpbzQQ@mail.gmail.com>

Thanks, Martin. I am trying this in Bengaluru, India, using R-studio. I
tried downloading a single variable. It happened fast, in less than 5
seconds. I tried downloading six variables, it took much longer, but less
than a minute. Tried eight variables and it did not download even in five
minutes. My internet speed is well above 40Mbps. This should not take that
long. It seems the process timed out. Please see below for some messages
from the system. I am using the latest version of WDI. I installed it
recently. I checked in the browser using the URL provided in the warning
messages:  The World Bank web API gave me the indicator in less than a
second.

> system.time(dat3IN <- WDI(indicator = c('NY.ADJ.NNAT.GN.ZS','NY.GNS.ICTR.GN.ZS','NY.ADJ.DCO2.GN.ZS','NY.ADJ.DNGY.GN.ZS', 'NY.ADJ.DFOR.GN.ZS', 'NY.ADJ.DPEM.GN.ZS', 'NY.ADJ.DMIN.GN.ZS', 'NY.ADJ.DRES.GN.ZS'), country = c('IN'), start=1960))   user  system elapsed
   0.14    0.01  328.65 Warning messages:
1: In open.connection(con, "rb") :
  URL 'https://api.worldbank.org/v2/en/country/IN/indicator/NY.ADJ.NNAT.GN.ZS?format=json&date=1960:2029&per_page=32500&page=10':
Timeout of 60 seconds was reached
2: In open.connection(con, "rb") :
  URL 'https://api.worldbank.org/v2/en/country/IN/indicator/NY.GNS.ICTR.GN.ZS?format=json&date=1960:2029&per_page=32500&page=1':
Timeout of 60 seconds was reached
3: In open.connection(con, "rb") :
  URL 'https://api.worldbank.org/v2/en/country/IN/indicator/NY.GNS.ICTR.GN.ZS?format=json&date=1960:2029&per_page=32500&page=4':
Timeout of 60 seconds was reached
4: In WDI(indicator = c("NY.ADJ.NNAT.GN.ZS", "NY.GNS.ICTR.GN.ZS",
"NY.ADJ.DCO2.GN.ZS",  :
  The following indicators could not be downloaded: NY.GNS.ICTR.GN.ZS.

Please make sure that you are running the latest version of the `WDI`
package, and that the arguments you are using in the `WDI()` function
are valid.

Sometimes, downloads will suddenly stop working, even if nothing has
changed in the R code of the WDI package. ("The same WDI package
version worked yesterday!") In those cases, the problem is almost
certainly related to the World Bank servers or to your internet
connection.

You can check if the World Bank web API is currently serving the
indicator(s) of interest by typing a URL of this form in your web
browser:
https://api.worldbank.org/v2/en/country/all/indicator/NY.GNS.ICTR.GN.ZS?format=json&date=:&per_page=32500&page=1



On Fri, 9 Aug 2024 at 18:38, Martin Maechler <maechler at stat.math.ethz.ch>
wrote:

> >>>>> Ivan Krylov via R-help
> >>>>>     on Fri, 9 Aug 2024 15:23:58 +0300 writes:
>
>     > ? Thu, 8 Aug 2024 12:43:23 +0530
>     > Anupam Tyagi <anuptyagi at gmail.com> ?????:
>
>     >> In open.connection(con, "rb") :
>     >> URL
>     >> '
> https://api.worldbank.org/v2/en/country/OED/indicator/NY.ADJ.NNAT.GN.ZS?format=json&date=1977:2020&per_page=32500&page=1
> ':
>     >> Timeout of 60 seconds was reached
>
>     > If you try to open the link in the browser, does it work? How long
> does
>     > it take to download? Try increasing options(timeout=...) to a larger
>     > time (in seconds).
>
>     > I see there is Cloudflare sitting in front of the API, but it's
>     > relatively non-aggressive. I could only get it to deny my request by
>     > accessing it through Tor.
> ;-\
>
> In R  (but *not* inside RStudio), I see {from Zurich, Switzerland},
>
>   > require(WDI)
>   Loading required package: WDI
>   > system.time(dat1EU <-
>       WDI(indicator = c('NY.ADJ.NNAT.GN.ZS', 'NY.GNS.ICTR.GN.ZS'), country
> = c('EU'), start=1977, end=2020))
>
>      user  system elapsed
>     0.466   0.028   5.828
>   >
>   > str(dat1EU)
>   'data.frame': 44 obs. of  6 variables:
>    $ country          : chr  "European Union" "European Union" "European
> Union" "European Union" ...
>    $ iso2c            : chr  "EU" "EU" "EU" "EU" ...
>    $ iso3c            : chr  "EUU" "EUU" "EUU" "EUU" ...
>    $ year             : int  1977 1978 1979 1980 1981 1982 1983 1984 1985
> 1986 ...
>    $ NY.ADJ.NNAT.GN.ZS: num  9.13 9.57 9.36 7.83 5.67 ...
>     ..- attr(*, "label")= chr "Adjusted savings: net national savings (%
> of GNI)"
>    $ NY.GNS.ICTR.GN.ZS: num  23 23.4 23.2 22.3 20.8 ...
>     ..- attr(*, "label")= chr "Gross savings (% of GNI)"
>   >
>
> which seems pretty nice, similar to Ivan's experience
>
>     > --
>     > Best regards,
>     > Ivan
>
>     > ______________________________________________
>     > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>     > https://stat.ethz.ch/mailman/listinfo/r-help
>     > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
>     > and provide commented, minimal, self-contained, reproducible code.
>


-- 
Anupam.

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Fri Aug  9 18:46:01 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Fri, 9 Aug 2024 19:46:01 +0300
Subject: [R] WDI package commands timing out and not working
In-Reply-To: <CAFL9eu=t7-SUX=VJcjT8No5wx6bKJgy866p=qUsjg75ZzpbzQQ@mail.gmail.com>
References: <CAFL9eun-6HWgw1LQ1xia0vS+wqb+xe4oC7irr=GogVi0U45v8A@mail.gmail.com>
 <20240809152358.4c56c457@arachnoid>
 <26294.5335.483728.210282@stat.math.ethz.ch>
 <CAFL9eu=t7-SUX=VJcjT8No5wx6bKJgy866p=qUsjg75ZzpbzQQ@mail.gmail.com>
Message-ID: <20240809194601.7a6f3bd1@arachnoid>

? Fri, 9 Aug 2024 20:25:51 +0530
Anupam Tyagi <anuptyagi at gmail.com> ?????:

> I am trying this in Bengaluru, India, using R-studio. I tried
> downloading a single variable. It happened fast, in less than 5
> seconds. I tried downloading six variables, it took much longer, but
> less than a minute. Tried eight variables and it did not download
> even in five minutes.

> I checked in the browser using the URL provided in the warning
> messages:  The World Bank web API gave me the indicator in less than
> a second.

I think that the fact that this initially works from R but then only
works in the browser is clear evidence of Cloudflare "protecting" the
World Bank API from you trying to use it in an automated manner. That
this mostly defeats the purpose of an API was probably lost on people
who set it up.

In theory, this should be reported to the people who operate the API.
There seems to be a support form at
<https://datahelpdesk.worldbank.org/knowledgebase/topics/125589-developer-information>.
I don't have a lot of confidence in them fixing anything as a result
of such a request.

Try to cache all access to the API. Consider getting a proxy in a
country less discriminated against by Cloudflare. Maybe petition the
WDI maintainer to export a function that parses a JSON file manually
downloaded with a browser?

-- 
Best regards,
Ivan


From ycd|ng @end|ng |rom coh@org  Sat Aug 10 01:50:00 2024
From: ycd|ng @end|ng |rom coh@org (Yuan Chun Ding)
Date: Fri, 9 Aug 2024 23:50:00 +0000
Subject: [R] a fast way to do my job
Message-ID: <MN2PR02MB691185ED67AD413C46A0AAEED4BA2@MN2PR02MB6911.namprd02.prod.outlook.com>

Dear R users,

I am running the following code below,  the gem751be.rpkm is a dataframe with dim of 751 samples by 35164 variables,  73 phenotypic variables in the furst to 73rd column and 35091 genomic variables or genes in the 74th to 35164th columns.  What I need to do is to calculate the residuals for each gene using the simple linear regression model of genelist[i] ~ purity2;

The following code is running,  it takes long time, but I have an expensive ThinkStation window computer.
Can you provide a fast way to do it?

Thank you,

Ding

---------------------------------------------------------------------------------


gem751be.rpkm <-merge(gem751be10, as.data.frame(t(rna849.fpkm2)),
+                           by.x="id2",by.y=0)
>   row.names(gem751be.rpkm)<-gem751be.rpkm$id3
>   colnames(gem751be.rpkm)<-gsub(colnames(gem751be.rpkm),pattern="-",replacement="_")
>   genelist <- gem751be.rpkm %>% dplyr::select(74:35164)
>   residuals <- NULL
>   for (i in 1:length(genelist)) {
+     #i=1
+     formula <- reformulate("purity2", response=names(genelist)[i])
+     model <- lm(formula, data = gem751be.rpkm)
+     resi <- as.data.frame(residuals(model))
+     colnames(resi)[1]<-names(genelist)[i]
+     resi <-as.data.frame(t(resi))
+     residuals <- rbind(residuals, resi)
+   }



----------------------------------------------------------------------
------------------------------------------------------------
-SECURITY/CONFIDENTIALITY WARNING-  

This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to receive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)
------------------------------------------------------------

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Sat Aug 10 03:30:54 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 9 Aug 2024 18:30:54 -0700
Subject: [R] a fast way to do my job
In-Reply-To: <MN2PR02MB691185ED67AD413C46A0AAEED4BA2@MN2PR02MB6911.namprd02.prod.outlook.com>
References: <MN2PR02MB691185ED67AD413C46A0AAEED4BA2@MN2PR02MB6911.namprd02.prod.outlook.com>
Message-ID: <CAGxFJbRj=GP4QP4L9npjcS9zwRB7t-1vib03fqicNW2dE-wQZQ@mail.gmail.com>

See ?lm.fit.
I must be missing something, because:

results <- sapply(74:35164, \(i) residuals(lm.fit(purity2,
gem751be.rpkm[, i] )))

would give you a 751 x 35091 matrix of the residuals from each of the
regressions.
I assume it will be considerably faster than all the overhead you are
carrying in your current code, but of course you'll have to try it and
see. ... Assuming that I have interpreted your request correctly.
Ignore if not.

Cheers,
Bert

On Fri, Aug 9, 2024 at 4:50?PM Yuan Chun Ding via R-help
<r-help at r-project.org> wrote:
>
> Dear R users,
>
> I am running the following code below,  the gem751be.rpkm is a dataframe with dim of 751 samples by 35164 variables,  73 phenotypic variables in the furst to 73rd column and 35091 genomic variables or genes in the 74th to 35164th columns.  What I need to do is to calculate the residuals for each gene using the simple linear regression model of genelist[i] ~ purity2;
>
> The following code is running,  it takes long time, but I have an expensive ThinkStation window computer.
> Can you provide a fast way to do it?
>
> Thank you,
>
> Ding
>
> ---------------------------------------------------------------------------------
>
>
> gem751be.rpkm <-merge(gem751be10, as.data.frame(t(rna849.fpkm2)),
> +                           by.x="id2",by.y=0)
> >   row.names(gem751be.rpkm)<-gem751be.rpkm$id3
> >   colnames(gem751be.rpkm)<-gsub(colnames(gem751be.rpkm),pattern="-",replacement="_")
> >   genelist <- gem751be.rpkm %>% dplyr::select(74:35164)
> >   residuals <- NULL
> >   for (i in 1:length(genelist)) {
> +     #i=1
> +     formula <- reformulate("purity2", response=names(genelist)[i])
> +     model <- lm(formula, data = gem751be.rpkm)
> +     resi <- as.data.frame(residuals(model))
> +     colnames(resi)[1]<-names(genelist)[i]
> +     resi <-as.data.frame(t(resi))
> +     residuals <- rbind(residuals, resi)
> +   }
>
>
>
> ----------------------------------------------------------------------
> ------------------------------------------------------------
> -SECURITY/CONFIDENTIALITY WARNING-
>
> This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to rec
>  eive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)
> ------------------------------------------------------------
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bbo|ker @end|ng |rom gm@||@com  Sat Aug 10 03:38:22 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Fri, 9 Aug 2024 21:38:22 -0400
Subject: [R] a fast way to do my job
In-Reply-To: <CAGxFJbRj=GP4QP4L9npjcS9zwRB7t-1vib03fqicNW2dE-wQZQ@mail.gmail.com>
References: <MN2PR02MB691185ED67AD413C46A0AAEED4BA2@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CAGxFJbRj=GP4QP4L9npjcS9zwRB7t-1vib03fqicNW2dE-wQZQ@mail.gmail.com>
Message-ID: <CABghstS_rwq41mudBsFyEML2RrWmKi1thhHi5D81pqVyqaDPSw@mail.gmail.com>

You can also fit a linear model with a matrix-valued response
variable, which should be even faster (not sure off the top of my head
how to get the residuals and reshape them to the dimensions you want)

On Fri, Aug 9, 2024 at 9:31?PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> See ?lm.fit.
> I must be missing something, because:
>
> results <- sapply(74:35164, \(i) residuals(lm.fit(purity2,
> gem751be.rpkm[, i] )))
>
> would give you a 751 x 35091 matrix of the residuals from each of the
> regressions.
> I assume it will be considerably faster than all the overhead you are
> carrying in your current code, but of course you'll have to try it and
> see. ... Assuming that I have interpreted your request correctly.
> Ignore if not.
>
> Cheers,
> Bert
>
> On Fri, Aug 9, 2024 at 4:50?PM Yuan Chun Ding via R-help
> <r-help at r-project.org> wrote:
> >
> > Dear R users,
> >
> > I am running the following code below,  the gem751be.rpkm is a dataframe with dim of 751 samples by 35164 variables,  73 phenotypic variables in the furst to 73rd column and 35091 genomic variables or genes in the 74th to 35164th columns.  What I need to do is to calculate the residuals for each gene using the simple linear regression model of genelist[i] ~ purity2;
> >
> > The following code is running,  it takes long time, but I have an expensive ThinkStation window computer.
> > Can you provide a fast way to do it?
> >
> > Thank you,
> >
> > Ding
> >
> > ---------------------------------------------------------------------------------
> >
> >
> > gem751be.rpkm <-merge(gem751be10, as.data.frame(t(rna849.fpkm2)),
> > +                           by.x="id2",by.y=0)
> > >   row.names(gem751be.rpkm)<-gem751be.rpkm$id3
> > >   colnames(gem751be.rpkm)<-gsub(colnames(gem751be.rpkm),pattern="-",replacement="_")
> > >   genelist <- gem751be.rpkm %>% dplyr::select(74:35164)
> > >   residuals <- NULL
> > >   for (i in 1:length(genelist)) {
> > +     #i=1
> > +     formula <- reformulate("purity2", response=names(genelist)[i])
> > +     model <- lm(formula, data = gem751be.rpkm)
> > +     resi <- as.data.frame(residuals(model))
> > +     colnames(resi)[1]<-names(genelist)[i]
> > +     resi <-as.data.frame(t(resi))
> > +     residuals <- rbind(residuals, resi)
> > +   }
> >
> >
> >
> > ----------------------------------------------------------------------
> > ------------------------------------------------------------
> > -SECURITY/CONFIDENTIALITY WARNING-
> >
> > This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to rec
> >  eive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)
> > ------------------------------------------------------------
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Sat Aug 10 04:10:43 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 9 Aug 2024 19:10:43 -0700
Subject: [R] a fast way to do my job
In-Reply-To: <CABghstS_rwq41mudBsFyEML2RrWmKi1thhHi5D81pqVyqaDPSw@mail.gmail.com>
References: <MN2PR02MB691185ED67AD413C46A0AAEED4BA2@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CAGxFJbRj=GP4QP4L9npjcS9zwRB7t-1vib03fqicNW2dE-wQZQ@mail.gmail.com>
 <CABghstS_rwq41mudBsFyEML2RrWmKi1thhHi5D81pqVyqaDPSw@mail.gmail.com>
Message-ID: <CAGxFJbTbdt+QaNX8i4P_X-bir0Td-6Rn=jm5ryB6XrK_CoA0Hw@mail.gmail.com>

Better idea, Ben!

It would work as you might expect it to to produce the same results as
the above:

##first make sure your regressor is a matrix:
pur2 <- matrix(purity2, ncol =1)
## convert the data frame variables into a matrix
dat <- as.matrix(gem751be.rpkm[ , 74:35164])
##then
result <- residuals(lm.fit( x= pur2, y = dat))

Cheers,
Bert

On Fri, Aug 9, 2024 at 6:38?PM Ben Bolker <bbolker at gmail.com> wrote:
>
> You can also fit a linear model with a matrix-valued response
> variable, which should be even faster (not sure off the top of my head
> how to get the residuals and reshape them to the dimensions you want)
>
> On Fri, Aug 9, 2024 at 9:31?PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >
> > See ?lm.fit.
> > I must be missing something, because:
> >
> > results <- sapply(74:35164, \(i) residuals(lm.fit(purity2,
> > gem751be.rpkm[, i] )))
> >
> > would give you a 751 x 35091 matrix of the residuals from each of the
> > regressions.
> > I assume it will be considerably faster than all the overhead you are
> > carrying in your current code, but of course you'll have to try it and
> > see. ... Assuming that I have interpreted your request correctly.
> > Ignore if not.
> >
> > Cheers,
> > Bert
> >
> > On Fri, Aug 9, 2024 at 4:50?PM Yuan Chun Ding via R-help
> > <r-help at r-project.org> wrote:
> > >
> > > Dear R users,
> > >
> > > I am running the following code below,  the gem751be.rpkm is a dataframe with dim of 751 samples by 35164 variables,  73 phenotypic variables in the furst to 73rd column and 35091 genomic variables or genes in the 74th to 35164th columns.  What I need to do is to calculate the residuals for each gene using the simple linear regression model of genelist[i] ~ purity2;
> > >
> > > The following code is running,  it takes long time, but I have an expensive ThinkStation window computer.
> > > Can you provide a fast way to do it?
> > >
> > > Thank you,
> > >
> > > Ding
> > >
> > > ---------------------------------------------------------------------------------
> > >
> > >
> > > gem751be.rpkm <-merge(gem751be10, as.data.frame(t(rna849.fpkm2)),
> > > +                           by.x="id2",by.y=0)
> > > >   row.names(gem751be.rpkm)<-gem751be.rpkm$id3
> > > >   colnames(gem751be.rpkm)<-gsub(colnames(gem751be.rpkm),pattern="-",replacement="_")
> > > >   genelist <- gem751be.rpkm %>% dplyr::select(74:35164)
> > > >   residuals <- NULL
> > > >   for (i in 1:length(genelist)) {
> > > +     #i=1
> > > +     formula <- reformulate("purity2", response=names(genelist)[i])
> > > +     model <- lm(formula, data = gem751be.rpkm)
> > > +     resi <- as.data.frame(residuals(model))
> > > +     colnames(resi)[1]<-names(genelist)[i]
> > > +     resi <-as.data.frame(t(resi))
> > > +     residuals <- rbind(residuals, resi)
> > > +   }
> > >
> > >
> > >
> > > ----------------------------------------------------------------------
> > > ------------------------------------------------------------
> > > -SECURITY/CONFIDENTIALITY WARNING-
> > >
> > > This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to rec
> > >  eive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)
> > > ------------------------------------------------------------
> > >
> > >         [[alternative HTML version deleted]]
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.


From @@m@gregory @end|ng |rom |c|oud@com  Fri Aug  9 11:20:56 2024
From: @@m@gregory @end|ng |rom |c|oud@com (martin gregory)
Date: Fri, 9 Aug 2024 11:20:56 +0200
Subject: [R] If loop
In-Reply-To: <CA+etgPkQvRHtNG3nAdCfMOubzX3uvPhpT9TNUD33LoKp79MH5w@mail.gmail.com>
References: <b6ce61b0-91e1-4f2c-b7b5-6d8298ae54a1@ntu.edu.tw>
 <CA+etgPmNBAXj3PLcWqYmTr+-0k3naNdojqEOJ1TnWc21e4S13g@mail.gmail.com>
 <23d8f633-b229-4aba-bd6c-5ac2c09220f1@ntu.edu.tw>
 <CA+etgPkQvRHtNG3nAdCfMOubzX3uvPhpT9TNUD33LoKp79MH5w@mail.gmail.com>
Message-ID: <A0A34437-3840-45C3-B11A-B9A1696A79F5@icloud.com>


> On 9. Aug 2024, at 10:45, CALUM POLWART <polc1410 at gmail.com> wrote:
> 
> Or use <<- assignment I think.  (I usually return, but return can only
> return one object and I think you want two or more
> 

One can return multiple objects by putting them in a list and returning the list.

Martin


From @nupty@g| @end|ng |rom gm@||@com  Sat Aug 10 15:47:21 2024
From: @nupty@g| @end|ng |rom gm@||@com (Anupam Tyagi)
Date: Sat, 10 Aug 2024 19:17:21 +0530
Subject: [R] WDI package commands timing out and not working
In-Reply-To: <20240809194601.7a6f3bd1@arachnoid>
References: <CAFL9eun-6HWgw1LQ1xia0vS+wqb+xe4oC7irr=GogVi0U45v8A@mail.gmail.com>
 <20240809152358.4c56c457@arachnoid>
 <26294.5335.483728.210282@stat.math.ethz.ch>
 <CAFL9eu=t7-SUX=VJcjT8No5wx6bKJgy866p=qUsjg75ZzpbzQQ@mail.gmail.com>
 <20240809194601.7a6f3bd1@arachnoid>
Message-ID: <CAFL9eumBqr7Mn7A5gARM4ZgGFVnAFtMuEet-SjLP8gDFdQpy9w@mail.gmail.com>

Thanks, Ivan. I will fill out the support form at the World Bank.

On Fri, 9 Aug 2024 at 22:16, Ivan Krylov <ikrylov at disroot.org> wrote:

> ? Fri, 9 Aug 2024 20:25:51 +0530
> Anupam Tyagi <anuptyagi at gmail.com> ?????:
>
> > I am trying this in Bengaluru, India, using R-studio. I tried
> > downloading a single variable. It happened fast, in less than 5
> > seconds. I tried downloading six variables, it took much longer, but
> > less than a minute. Tried eight variables and it did not download
> > even in five minutes.
>
> > I checked in the browser using the URL provided in the warning
> > messages:  The World Bank web API gave me the indicator in less than
> > a second.
>
> I think that the fact that this initially works from R but then only
> works in the browser is clear evidence of Cloudflare "protecting" the
> World Bank API from you trying to use it in an automated manner. That
> this mostly defeats the purpose of an API was probably lost on people
> who set it up.
>
> In theory, this should be reported to the people who operate the API.
> There seems to be a support form at
> <
> https://datahelpdesk.worldbank.org/knowledgebase/topics/125589-developer-information
> >.
> I don't have a lot of confidence in them fixing anything as a result
> of such a request.
>
> Try to cache all access to the API. Consider getting a proxy in a
> country less discriminated against by Cloudflare. Maybe petition the
> WDI maintainer to export a function that parses a JSON file manually
> downloaded with a browser?
>
> --
> Best regards,
> Ivan
>


-- 
Anupam.

	[[alternative HTML version deleted]]


From ycd|ng @end|ng |rom coh@org  Sat Aug 10 21:29:47 2024
From: ycd|ng @end|ng |rom coh@org (Yuan Chun Ding)
Date: Sat, 10 Aug 2024 19:29:47 +0000
Subject: [R] a fast way to do my job
In-Reply-To: <CAGxFJbTbdt+QaNX8i4P_X-bir0Td-6Rn=jm5ryB6XrK_CoA0Hw@mail.gmail.com>
References: <MN2PR02MB691185ED67AD413C46A0AAEED4BA2@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CAGxFJbRj=GP4QP4L9npjcS9zwRB7t-1vib03fqicNW2dE-wQZQ@mail.gmail.com>
 <CABghstS_rwq41mudBsFyEML2RrWmKi1thhHi5D81pqVyqaDPSw@mail.gmail.com>
 <CAGxFJbTbdt+QaNX8i4P_X-bir0Td-6Rn=jm5ryB6XrK_CoA0Hw@mail.gmail.com>
Message-ID: <MN2PR02MB6911508EC9B0040C41044C86D4BB2@MN2PR02MB6911.namprd02.prod.outlook.com>

HI Bert and Ben,

Yes, running lm.fit using the matrix format is much faster. I read a couple of online comments why it is faster.

However, the residual values for three tested variables or genes from lm function and lm.fit function are different, with Pearson correlation of 0.55, 0.89, and 0.99.

I have not found the reason.

Thanks,

Ding

From: Bert Gunter <bgunter.4567 at gmail.com>
Sent: Friday, August 9, 2024 7:11 PM
To: Ben Bolker <bbolker at gmail.com>
Cc: Yuan Chun Ding <ycding at coh.org>; r-help at r-project.org
Subject: Re: [R] a fast way to do my job

Better idea, Ben! It would work as you might expect it to to produce the same results as the above: ##first make sure your regressor is a matrix: pur2 <- matrix(purity2, ncol =1) ## convert the data frame variables into a matrix dat <-


Better idea, Ben!



It would work as you might expect it to to produce the same results as

the above:



##first make sure your regressor is a matrix:

pur2 <- matrix(purity2, ncol =1)

## convert the data frame variables into a matrix

dat <- as.matrix(gem751be.rpkm[ , 74:35164])

##then

result <- residuals(lm.fit( x= pur2, y = dat))



Cheers,

Bert



On Fri, Aug 9, 2024 at 6:38?PM Ben Bolker <bbolker at gmail.com<mailto:bbolker at gmail.com>> wrote:

>

> You can also fit a linear model with a matrix-valued response

> variable, which should be even faster (not sure off the top of my head

> how to get the residuals and reshape them to the dimensions you want)

>

> On Fri, Aug 9, 2024 at 9:31?PM Bert Gunter <bgunter.4567 at gmail.com<mailto:bgunter.4567 at gmail.com>> wrote:

> >

> > See ?lm.fit.

> > I must be missing something, because:

> >

> > results <- sapply(74:35164, \(i) residuals(lm.fit(purity2,

> > gem751be.rpkm[, i] )))

> >

> > would give you a 751 x 35091 matrix of the residuals from each of the

> > regressions.

> > I assume it will be considerably faster than all the overhead you are

> > carrying in your current code, but of course you'll have to try it and

> > see. ... Assuming that I have interpreted your request correctly.

> > Ignore if not.

> >

> > Cheers,

> > Bert

> >

> > On Fri, Aug 9, 2024 at 4:50?PM Yuan Chun Ding via R-help

> > <r-help at r-project.org<mailto:r-help at r-project.org>> wrote:

> > >

> > > Dear R users,

> > >

> > > I am running the following code below,  the gem751be.rpkm is a dataframe with dim of 751 samples by 35164 variables,  73 phenotypic variables in the furst to 73rd column and 35091 genomic variables or genes in the 74th to 35164th columns.  What I need to do is to calculate the residuals for each gene using the simple linear regression model of genelist[i] ~ purity2;

> > >

> > > The following code is running,  it takes long time, but I have an expensive ThinkStation window computer.

> > > Can you provide a fast way to do it?

> > >

> > > Thank you,

> > >

> > > Ding

> > >

> > > ---------------------------------------------------------------------------------

> > >

> > >

> > > gem751be.rpkm <-merge(gem751be10, as.data.frame(t(rna849.fpkm2)),

> > > +                           by.x="id2",by.y=0)

> > > >   row.names(gem751be.rpkm)<-gem751be.rpkm$id3

> > > >   colnames(gem751be.rpkm)<-gsub(colnames(gem751be.rpkm),pattern="-",replacement="_")

> > > >   genelist <- gem751be.rpkm %>% dplyr::select(74:35164)

> > > >   residuals <- NULL

> > > >   for (i in 1:length(genelist)) {

> > > +     #i=1

> > > +     formula <- reformulate("purity2", response=names(genelist)[i])

> > > +     model <- lm(formula, data = gem751be.rpkm)

> > > +     resi <- as.data.frame(residuals(model))

> > > +     colnames(resi)[1]<-names(genelist)[i]

> > > +     resi <-as.data.frame(t(resi))

> > > +     residuals <- rbind(residuals, resi)

> > > +   }

> > >

> > >

> > >

> > > ----------------------------------------------------------------------

> > > ------------------------------------------------------------

> > > -SECURITY/CONFIDENTIALITY WARNING-

> > >

> > > This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to rec

> > >  eive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)

> > > ------------------------------------------------------------

> > >

> > >         [[alternative HTML version deleted]]

> > >

> > > ______________________________________________

> > > R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see

> > > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$>

> > > PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$<https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$>

> > > and provide commented, minimal, self-contained, reproducible code.

> >

> > ______________________________________________

> > R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see

> > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$>

> > PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$<https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$>

> > and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Sat Aug 10 21:59:33 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 10 Aug 2024 12:59:33 -0700
Subject: [R] a fast way to do my job
In-Reply-To: <MN2PR02MB6911508EC9B0040C41044C86D4BB2@MN2PR02MB6911.namprd02.prod.outlook.com>
References: <MN2PR02MB691185ED67AD413C46A0AAEED4BA2@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CAGxFJbRj=GP4QP4L9npjcS9zwRB7t-1vib03fqicNW2dE-wQZQ@mail.gmail.com>
 <CABghstS_rwq41mudBsFyEML2RrWmKi1thhHi5D81pqVyqaDPSw@mail.gmail.com>
 <CAGxFJbTbdt+QaNX8i4P_X-bir0Td-6Rn=jm5ryB6XrK_CoA0Hw@mail.gmail.com>
 <MN2PR02MB6911508EC9B0040C41044C86D4BB2@MN2PR02MB6911.namprd02.prod.outlook.com>
Message-ID: <CAGxFJbQE_0-PLDoZG_+xRqk4dM6tno-yxkndS_MPyCto-t=+bQ@mail.gmail.com>

Probably because you inadvertently ran different models. Without your code,
I haven't a clue.

On Sat, Aug 10, 2024, 12:29 Yuan Chun Ding <ycding at coh.org> wrote:

> HI Bert and Ben,
>
>
>
> Yes, running lm.fit using the matrix format is much faster. I read a
> couple of online comments why it is faster.
>
>
>
> However, the residual values for three tested variables or genes from lm
> function and lm.fit function are different, with Pearson correlation of
> 0.55, 0.89, and 0.99.
>
>
>
> I have not found the reason.
>
>
>
> Thanks,
>
>
> Ding
>
>
>
> *From:* Bert Gunter <bgunter.4567 at gmail.com>
> *Sent:* Friday, August 9, 2024 7:11 PM
> *To:* Ben Bolker <bbolker at gmail.com>
> *Cc:* Yuan Chun Ding <ycding at coh.org>; r-help at r-project.org
> *Subject:* Re: [R] a fast way to do my job
>
>
>
> Better idea, Ben! It would work as you might expect it to to produce the
> same results as the above: ##first make sure your regressor is a matrix:
> pur2 <- matrix(purity2, ncol =1) ## convert the data frame variables into a
> matrix dat <-
>
> Better idea, Ben!
>
>
>
> It would work as you might expect it to to produce the same results as
>
> the above:
>
>
>
> ##first make sure your regressor is a matrix:
>
> pur2 <- matrix(purity2, ncol =1)
>
> ## convert the data frame variables into a matrix
>
> dat <- as.matrix(gem751be.rpkm[ , 74:35164])
>
> ##then
>
> result <- residuals(lm.fit( x= pur2, y = dat))
>
>
>
> Cheers,
>
> Bert
>
>
>
> On Fri, Aug 9, 2024 at 6:38?PM Ben Bolker <bbolker at gmail.com> wrote:
>
> >
>
> > You can also fit a linear model with a matrix-valued response
>
> > variable, which should be even faster (not sure off the top of my head
>
> > how to get the residuals and reshape them to the dimensions you want)
>
> >
>
> > On Fri, Aug 9, 2024 at 9:31?PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> > >
>
> > > See ?lm.fit.
>
> > > I must be missing something, because:
>
> > >
>
> > > results <- sapply(74:35164, \(i) residuals(lm.fit(purity2,
>
> > > gem751be.rpkm[, i] )))
>
> > >
>
> > > would give you a 751 x 35091 matrix of the residuals from each of the
>
> > > regressions.
>
> > > I assume it will be considerably faster than all the overhead you are
>
> > > carrying in your current code, but of course you'll have to try it and
>
> > > see. ... Assuming that I have interpreted your request correctly.
>
> > > Ignore if not.
>
> > >
>
> > > Cheers,
>
> > > Bert
>
> > >
>
> > > On Fri, Aug 9, 2024 at 4:50?PM Yuan Chun Ding via R-help
>
> > > <r-help at r-project.org> wrote:
>
> > > >
>
> > > > Dear R users,
>
> > > >
>
> > > > I am running the following code below,  the gem751be.rpkm is a dataframe with dim of 751 samples by 35164 variables,  73 phenotypic variables in the furst to 73rd column and 35091 genomic variables or genes in the 74th to 35164th columns.  What I need to do is to calculate the residuals for each gene using the simple linear regression model of genelist[i] ~ purity2;
>
> > > >
>
> > > > The following code is running,  it takes long time, but I have an expensive ThinkStation window computer.
>
> > > > Can you provide a fast way to do it?
>
> > > >
>
> > > > Thank you,
>
> > > >
>
> > > > Ding
>
> > > >
>
> > > > ---------------------------------------------------------------------------------
>
> > > >
>
> > > >
>
> > > > gem751be.rpkm <-merge(gem751be10, as.data.frame(t(rna849.fpkm2)),
>
> > > > +                           by.x="id2",by.y=0)
>
> > > > >   row.names(gem751be.rpkm)<-gem751be.rpkm$id3
>
> > > > >   colnames(gem751be.rpkm)<-gsub(colnames(gem751be.rpkm),pattern="-",replacement="_")
>
> > > > >   genelist <- gem751be.rpkm %>% dplyr::select(74:35164)
>
> > > > >   residuals <- NULL
>
> > > > >   for (i in 1:length(genelist)) {
>
> > > > +     #i=1
>
> > > > +     formula <- reformulate("purity2", response=names(genelist)[i])
>
> > > > +     model <- lm(formula, data = gem751be.rpkm)
>
> > > > +     resi <- as.data.frame(residuals(model))
>
> > > > +     colnames(resi)[1]<-names(genelist)[i]
>
> > > > +     resi <-as.data.frame(t(resi))
>
> > > > +     residuals <- rbind(residuals, resi)
>
> > > > +   }
>
> > > >
>
> > > >
>
> > > >
>
> > > > ----------------------------------------------------------------------
>
> > > > ------------------------------------------------------------
>
> > > > -SECURITY/CONFIDENTIALITY WARNING-
>
> > > >
>
> > > > This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to rec
>
> > > >  eive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)
>
> > > > ------------------------------------------------------------
>
> > > >
>
> > > >         [[alternative HTML version deleted]]
>
> > > >
>
> > > > ______________________________________________
>
> > > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>
> > > > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$ <https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$>
>
> > > > PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$ <https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$>
>
> > > > and provide commented, minimal, self-contained, reproducible code.
>
> > >
>
> > > ______________________________________________
>
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>
> > > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$ <https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$>
>
> > > PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$ <https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$>
>
> > > and provide commented, minimal, self-contained, reproducible code.
>
>

	[[alternative HTML version deleted]]


From ycd|ng @end|ng |rom coh@org  Sat Aug 10 22:01:12 2024
From: ycd|ng @end|ng |rom coh@org (Yuan Chun Ding)
Date: Sat, 10 Aug 2024 20:01:12 +0000
Subject: [R] a fast way to do my job
In-Reply-To: <MN2PR02MB6911508EC9B0040C41044C86D4BB2@MN2PR02MB6911.namprd02.prod.outlook.com>
References: <MN2PR02MB691185ED67AD413C46A0AAEED4BA2@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CAGxFJbRj=GP4QP4L9npjcS9zwRB7t-1vib03fqicNW2dE-wQZQ@mail.gmail.com>
 <CABghstS_rwq41mudBsFyEML2RrWmKi1thhHi5D81pqVyqaDPSw@mail.gmail.com>
 <CAGxFJbTbdt+QaNX8i4P_X-bir0Td-6Rn=jm5ryB6XrK_CoA0Hw@mail.gmail.com>
 <MN2PR02MB6911508EC9B0040C41044C86D4BB2@MN2PR02MB6911.namprd02.prod.outlook.com>
Message-ID: <MN2PR02MB691150859EDFB8E2DB98B5F2D4BB2@MN2PR02MB6911.namprd02.prod.outlook.com>

Hi Bert and Ben,

Thanks a lot for your suggestion!!.

About the different residuals between lm function and lm.fit,  from online search,  lt seems like that I need to add an intercept in the design matrix x;

pur2 <- matrix(gem751be.rpkm$purity2, ncol =1)
  pur2.1 <- cbind(1,gem751be.rpkm$purity2)

then running result2 <- residuals(lm.fit( x= pur2.1, y = dat));
now I am thinking whether an intercept is required or not.

Ding
From: R-help <r-help-bounces at r-project.org> On Behalf Of Yuan Chun Ding via R-help
Sent: Saturday, August 10, 2024 12:30 PM
To: Bert Gunter <bgunter.4567 at gmail.com>; Ben Bolker <bbolker at gmail.com>
Cc: r-help at r-project.org
Subject: Re: [R] a fast way to do my job

HI Bert and Ben, Yes, running lm.?fit using the matrix format is much faster. I read a couple of online comments why it is faster. However, the residual values for three tested variables or genes from lm function and lm.?fit function are different,


HI Bert and Ben,



Yes, running lm.fit using the matrix format is much faster. I read a couple of online comments why it is faster.



However, the residual values for three tested variables or genes from lm function and lm.fit function are different, with Pearson correlation of 0.55, 0.89, and 0.99.



I have not found the reason.



Thanks,



Ding



From: Bert Gunter <bgunter.4567 at gmail.com<mailto:bgunter.4567 at gmail.com>>

Sent: Friday, August 9, 2024 7:11 PM

To: Ben Bolker <bbolker at gmail.com<mailto:bbolker at gmail.com>>

Cc: Yuan Chun Ding <ycding at coh.org<mailto:ycding at coh.org>>; r-help at r-project.org<mailto:r-help at r-project.org>

Subject: Re: [R] a fast way to do my job



Better idea, Ben! It would work as you might expect it to to produce the same results as the above: ##first make sure your regressor is a matrix: pur2 <- matrix(purity2, ncol =1) ## convert the data frame variables into a matrix dat <-





Better idea, Ben!







It would work as you might expect it to to produce the same results as



the above:







##first make sure your regressor is a matrix:



pur2 <- matrix(purity2, ncol =1)



## convert the data frame variables into a matrix



dat <- as.matrix(gem751be.rpkm[ , 74:35164])



##then



result <- residuals(lm.fit( x= pur2, y = dat))







Cheers,



Bert







On Fri, Aug 9, 2024 at 6:38?PM Ben Bolker <bbolker at gmail.com<mailto:bbolker at gmail.com<mailto:bbolker at gmail.com%3cmailto:bbolker at gmail.com>>> wrote:



>



> You can also fit a linear model with a matrix-valued response



> variable, which should be even faster (not sure off the top of my head



> how to get the residuals and reshape them to the dimensions you want)



>



> On Fri, Aug 9, 2024 at 9:31?PM Bert Gunter <bgunter.4567 at gmail.com<mailto:bgunter.4567 at gmail.com<mailto:bgunter.4567 at gmail.com%3cmailto:bgunter.4567 at gmail.com>>> wrote:



> >



> > See ?lm.fit.



> > I must be missing something, because:



> >



> > results <- sapply(74:35164, \(i) residuals(lm.fit(purity2,



> > gem751be.rpkm[, i] )))



> >



> > would give you a 751 x 35091 matrix of the residuals from each of the



> > regressions.



> > I assume it will be considerably faster than all the overhead you are



> > carrying in your current code, but of course you'll have to try it and



> > see. ... Assuming that I have interpreted your request correctly.



> > Ignore if not.



> >



> > Cheers,



> > Bert



> >



> > On Fri, Aug 9, 2024 at 4:50?PM Yuan Chun Ding via R-help



> > <r-help at r-project.org<mailto:r-help at r-project.org<mailto:r-help at r-project.org%3cmailto:r-help at r-project.org>>> wrote:



> > >



> > > Dear R users,



> > >



> > > I am running the following code below,  the gem751be.rpkm is a dataframe with dim of 751 samples by 35164 variables,  73 phenotypic variables in the furst to 73rd column and 35091 genomic variables or genes in the 74th to 35164th columns.  What I need to do is to calculate the residuals for each gene using the simple linear regression model of genelist[i] ~ purity2;



> > >



> > > The following code is running,  it takes long time, but I have an expensive ThinkStation window computer.



> > > Can you provide a fast way to do it?



> > >



> > > Thank you,



> > >



> > > Ding



> > >



> > > ---------------------------------------------------------------------------------



> > >



> > >



> > > gem751be.rpkm <-merge(gem751be10, as.data.frame(t(rna849.fpkm2)),



> > > +                           by.x="id2",by.y=0)



> > > >   row.names(gem751be.rpkm)<-gem751be.rpkm$id3



> > > >   colnames(gem751be.rpkm)<-gsub(colnames(gem751be.rpkm),pattern="-",replacement="_")



> > > >   genelist <- gem751be.rpkm %>% dplyr::select(74:35164)



> > > >   residuals <- NULL



> > > >   for (i in 1:length(genelist)) {



> > > +     #i=1



> > > +     formula <- reformulate("purity2", response=names(genelist)[i])



> > > +     model <- lm(formula, data = gem751be.rpkm)



> > > +     resi <- as.data.frame(residuals(model))



> > > +     colnames(resi)[1]<-names(genelist)[i]



> > > +     resi <-as.data.frame(t(resi))



> > > +     residuals <- rbind(residuals, resi)



> > > +   }



> > >



> > >



> > >



> > > ----------------------------------------------------------------------



> > > ------------------------------------------------------------



> > > -SECURITY/CONFIDENTIALITY WARNING-



> > >



> > > This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to rec



> > >  eive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)



> > > ------------------------------------------------------------



> > >



> > >         [[alternative HTML version deleted]]



> > >



> > > ______________________________________________



> > > R-help at r-project.org<mailto:R-help at r-project.org<mailto:R-help at r-project.org%3cmailto:R-help at r-project.org>> mailing list -- To UNSUBSCRIBE and more, see



> > > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$><https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3chttps:/urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3e%3e>

 <https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3chttps:/urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3e%3e>

><https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3chttps:/urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3e%3e>> > PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$<https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$><https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3chttps:/urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3e%3e>

 <https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3chttps:/urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3e%3e>

><https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3chttps:/urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3e%3e>> > and provide commented, minimal, self-contained, reproducible code.



> >



> > ______________________________________________



> > R-help at r-project.org<mailto:R-help at r-project.org<mailto:R-help at r-project.org%3cmailto:R-help at r-project.org>> mailing list -- To UNSUBSCRIBE and more, see



> > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$><https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3chttps:/urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3e%3e>

 <https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3chttps:/urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3e%3e>

><https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3chttps:/urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3e%3e>> PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$<https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$><https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3chttps:/urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3e%3e>

 <https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3chttps:/urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3e%3e>

><https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3chttps:/urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3e%3e>> and provide commented, minimal, self-contained, reproducible code.



               [[alternative HTML version deleted]]



______________________________________________

R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see

https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qqGp8uiTt4Nzt-4q2_z-dVpb3v8sQFbRq5O7Nok73NE3PTvgaktKByzXHf3KUh9X0Z4OaDMB0o_GD0c$<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qqGp8uiTt4Nzt-4q2_z-dVpb3v8sQFbRq5O7Nok73NE3PTvgaktKByzXHf3KUh9X0Z4OaDMB0o_GD0c$>

PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qqGp8uiTt4Nzt-4q2_z-dVpb3v8sQFbRq5O7Nok73NE3PTvgaktKByzXHf3KUh9X0Z4OaDMBoUteypM$<https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qqGp8uiTt4Nzt-4q2_z-dVpb3v8sQFbRq5O7Nok73NE3PTvgaktKByzXHf3KUh9X0Z4OaDMBoUteypM$>

and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Sat Aug 10 22:02:51 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 10 Aug 2024 13:02:51 -0700
Subject: [R] a fast way to do my job
In-Reply-To: <CAGxFJbQE_0-PLDoZG_+xRqk4dM6tno-yxkndS_MPyCto-t=+bQ@mail.gmail.com>
References: <MN2PR02MB691185ED67AD413C46A0AAEED4BA2@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CAGxFJbRj=GP4QP4L9npjcS9zwRB7t-1vib03fqicNW2dE-wQZQ@mail.gmail.com>
 <CABghstS_rwq41mudBsFyEML2RrWmKi1thhHi5D81pqVyqaDPSw@mail.gmail.com>
 <CAGxFJbTbdt+QaNX8i4P_X-bir0Td-6Rn=jm5ryB6XrK_CoA0Hw@mail.gmail.com>
 <MN2PR02MB6911508EC9B0040C41044C86D4BB2@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CAGxFJbQE_0-PLDoZG_+xRqk4dM6tno-yxkndS_MPyCto-t=+bQ@mail.gmail.com>
Message-ID: <CAGxFJbRXzQC2r5s4+o21q86SzVX_PN_0m8Pbvq6xhEjE1Gc8Sw@mail.gmail.com>

Is it because I failed to to add a column of ones for an intercept to
the x matrix? TRhat would be my bad.

-- Bert


On Sat, Aug 10, 2024 at 12:59?PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> Probably because you inadvertently ran different models. Without your code, I haven't a clue.
>
>
> On Sat, Aug 10, 2024, 12:29 Yuan Chun Ding <ycding at coh.org> wrote:
>>
>> HI Bert and Ben,
>>
>>
>>
>> Yes, running lm.fit using the matrix format is much faster. I read a couple of online comments why it is faster.
>>
>>
>>
>> However, the residual values for three tested variables or genes from lm function and lm.fit function are different, with Pearson correlation of 0.55, 0.89, and 0.99.
>>
>>
>>
>> I have not found the reason.
>>
>>
>>
>> Thanks,
>>
>>
>> Ding
>>
>>
>>
>> From: Bert Gunter <bgunter.4567 at gmail.com>
>> Sent: Friday, August 9, 2024 7:11 PM
>> To: Ben Bolker <bbolker at gmail.com>
>> Cc: Yuan Chun Ding <ycding at coh.org>; r-help at r-project.org
>> Subject: Re: [R] a fast way to do my job
>>
>>
>>
>> Better idea, Ben! It would work as you might expect it to to produce the same results as the above: ##first make sure your regressor is a matrix: pur2 <- matrix(purity2, ncol =1) ## convert the data frame variables into a matrix dat <-
>>
>> Better idea, Ben!
>>
>>
>>
>> It would work as you might expect it to to produce the same results as
>>
>> the above:
>>
>>
>>
>> ##first make sure your regressor is a matrix:
>>
>> pur2 <- matrix(purity2, ncol =1)
>>
>> ## convert the data frame variables into a matrix
>>
>> dat <- as.matrix(gem751be.rpkm[ , 74:35164])
>>
>> ##then
>>
>> result <- residuals(lm.fit( x= pur2, y = dat))
>>
>>
>>
>> Cheers,
>>
>> Bert
>>
>>
>>
>> On Fri, Aug 9, 2024 at 6:38?PM Ben Bolker <bbolker at gmail.com> wrote:
>>
>> >
>>
>> > You can also fit a linear model with a matrix-valued response
>>
>> > variable, which should be even faster (not sure off the top of my head
>>
>> > how to get the residuals and reshape them to the dimensions you want)
>>
>> >
>>
>> > On Fri, Aug 9, 2024 at 9:31?PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>>
>> > >
>>
>> > > See ?lm.fit.
>>
>> > > I must be missing something, because:
>>
>> > >
>>
>> > > results <- sapply(74:35164, \(i) residuals(lm.fit(purity2,
>>
>> > > gem751be.rpkm[, i] )))
>>
>> > >
>>
>> > > would give you a 751 x 35091 matrix of the residuals from each of the
>>
>> > > regressions.
>>
>> > > I assume it will be considerably faster than all the overhead you are
>>
>> > > carrying in your current code, but of course you'll have to try it and
>>
>> > > see. ... Assuming that I have interpreted your request correctly.
>>
>> > > Ignore if not.
>>
>> > >
>>
>> > > Cheers,
>>
>> > > Bert
>>
>> > >
>>
>> > > On Fri, Aug 9, 2024 at 4:50?PM Yuan Chun Ding via R-help
>>
>> > > <r-help at r-project.org> wrote:
>>
>> > > >
>>
>> > > > Dear R users,
>>
>> > > >
>>
>> > > > I am running the following code below,  the gem751be.rpkm is a dataframe with dim of 751 samples by 35164 variables,  73 phenotypic variables in the furst to 73rd column and 35091 genomic variables or genes in the 74th to 35164th columns.  What I need to do is to calculate the residuals for each gene using the simple linear regression model of genelist[i] ~ purity2;
>>
>> > > >
>>
>> > > > The following code is running,  it takes long time, but I have an expensive ThinkStation window computer.
>>
>> > > > Can you provide a fast way to do it?
>>
>> > > >
>>
>> > > > Thank you,
>>
>> > > >
>>
>> > > > Ding
>>
>> > > >
>>
>> > > > ---------------------------------------------------------------------------------
>>
>> > > >
>>
>> > > >
>>
>> > > > gem751be.rpkm <-merge(gem751be10, as.data.frame(t(rna849.fpkm2)),
>>
>> > > > +                           by.x="id2",by.y=0)
>>
>> > > > >   row.names(gem751be.rpkm)<-gem751be.rpkm$id3
>>
>> > > > >   colnames(gem751be.rpkm)<-gsub(colnames(gem751be.rpkm),pattern="-",replacement="_")
>>
>> > > > >   genelist <- gem751be.rpkm %>% dplyr::select(74:35164)
>>
>> > > > >   residuals <- NULL
>>
>> > > > >   for (i in 1:length(genelist)) {
>>
>> > > > +     #i=1
>>
>> > > > +     formula <- reformulate("purity2", response=names(genelist)[i])
>>
>> > > > +     model <- lm(formula, data = gem751be.rpkm)
>>
>> > > > +     resi <- as.data.frame(residuals(model))
>>
>> > > > +     colnames(resi)[1]<-names(genelist)[i]
>>
>> > > > +     resi <-as.data.frame(t(resi))
>>
>> > > > +     residuals <- rbind(residuals, resi)
>>
>> > > > +   }
>>
>> > > >
>>
>> > > >
>>
>> > > >
>>
>> > > > ----------------------------------------------------------------------
>>
>> > > > ------------------------------------------------------------
>>
>> > > > -SECURITY/CONFIDENTIALITY WARNING-
>>
>> > > >
>>
>> > > > This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to rec
>>
>> > > >  eive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)
>>
>> > > > ------------------------------------------------------------
>>
>> > > >
>>
>> > > >         [[alternative HTML version deleted]]
>>
>> > > >
>>
>> > > > ______________________________________________
>>
>> > > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>
>> > > > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$
>>
>> > > > PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$
>>
>> > > > and provide commented, minimal, self-contained, reproducible code.
>>
>> > >
>>
>> > > ______________________________________________
>>
>> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>
>> > > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$
>>
>> > > PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$
>>
>> > > and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Sat Aug 10 22:06:26 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 10 Aug 2024 13:06:26 -0700
Subject: [R] a fast way to do my job
In-Reply-To: <CAGxFJbRXzQC2r5s4+o21q86SzVX_PN_0m8Pbvq6xhEjE1Gc8Sw@mail.gmail.com>
References: <MN2PR02MB691185ED67AD413C46A0AAEED4BA2@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CAGxFJbRj=GP4QP4L9npjcS9zwRB7t-1vib03fqicNW2dE-wQZQ@mail.gmail.com>
 <CABghstS_rwq41mudBsFyEML2RrWmKi1thhHi5D81pqVyqaDPSw@mail.gmail.com>
 <CAGxFJbTbdt+QaNX8i4P_X-bir0Td-6Rn=jm5ryB6XrK_CoA0Hw@mail.gmail.com>
 <MN2PR02MB6911508EC9B0040C41044C86D4BB2@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CAGxFJbQE_0-PLDoZG_+xRqk4dM6tno-yxkndS_MPyCto-t=+bQ@mail.gmail.com>
 <CAGxFJbRXzQC2r5s4+o21q86SzVX_PN_0m8Pbvq6xhEjE1Gc8Sw@mail.gmail.com>
Message-ID: <CAGxFJbToq5aVdDwro7MyxYMBWLPEoALOQTw2BPuedy+Fe+X=Jg@mail.gmail.com>

Ah, messages crossed.
A no-intercept model **assumes** the straight line fit must pass
through the origin. Unless there is a strong justification for such an
assumption, you should include an intercept.

-- Bert

On Sat, Aug 10, 2024 at 1:02?PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> Is it because I failed to to add a column of ones for an intercept to
> the x matrix? TRhat would be my bad.
>
> -- Bert
>
>
> On Sat, Aug 10, 2024 at 12:59?PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >
> > Probably because you inadvertently ran different models. Without your code, I haven't a clue.
> >
> >
> > On Sat, Aug 10, 2024, 12:29 Yuan Chun Ding <ycding at coh.org> wrote:
> >>
> >> HI Bert and Ben,
> >>
> >>
> >>
> >> Yes, running lm.fit using the matrix format is much faster. I read a couple of online comments why it is faster.
> >>
> >>
> >>
> >> However, the residual values for three tested variables or genes from lm function and lm.fit function are different, with Pearson correlation of 0.55, 0.89, and 0.99.
> >>
> >>
> >>
> >> I have not found the reason.
> >>
> >>
> >>
> >> Thanks,
> >>
> >>
> >> Ding
> >>
> >>
> >>
> >> From: Bert Gunter <bgunter.4567 at gmail.com>
> >> Sent: Friday, August 9, 2024 7:11 PM
> >> To: Ben Bolker <bbolker at gmail.com>
> >> Cc: Yuan Chun Ding <ycding at coh.org>; r-help at r-project.org
> >> Subject: Re: [R] a fast way to do my job
> >>
> >>
> >>
> >> Better idea, Ben! It would work as you might expect it to to produce the same results as the above: ##first make sure your regressor is a matrix: pur2 <- matrix(purity2, ncol =1) ## convert the data frame variables into a matrix dat <-
> >>
> >> Better idea, Ben!
> >>
> >>
> >>
> >> It would work as you might expect it to to produce the same results as
> >>
> >> the above:
> >>
> >>
> >>
> >> ##first make sure your regressor is a matrix:
> >>
> >> pur2 <- matrix(purity2, ncol =1)
> >>
> >> ## convert the data frame variables into a matrix
> >>
> >> dat <- as.matrix(gem751be.rpkm[ , 74:35164])
> >>
> >> ##then
> >>
> >> result <- residuals(lm.fit( x= pur2, y = dat))
> >>
> >>
> >>
> >> Cheers,
> >>
> >> Bert
> >>
> >>
> >>
> >> On Fri, Aug 9, 2024 at 6:38?PM Ben Bolker <bbolker at gmail.com> wrote:
> >>
> >> >
> >>
> >> > You can also fit a linear model with a matrix-valued response
> >>
> >> > variable, which should be even faster (not sure off the top of my head
> >>
> >> > how to get the residuals and reshape them to the dimensions you want)
> >>
> >> >
> >>
> >> > On Fri, Aug 9, 2024 at 9:31?PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >>
> >> > >
> >>
> >> > > See ?lm.fit.
> >>
> >> > > I must be missing something, because:
> >>
> >> > >
> >>
> >> > > results <- sapply(74:35164, \(i) residuals(lm.fit(purity2,
> >>
> >> > > gem751be.rpkm[, i] )))
> >>
> >> > >
> >>
> >> > > would give you a 751 x 35091 matrix of the residuals from each of the
> >>
> >> > > regressions.
> >>
> >> > > I assume it will be considerably faster than all the overhead you are
> >>
> >> > > carrying in your current code, but of course you'll have to try it and
> >>
> >> > > see. ... Assuming that I have interpreted your request correctly.
> >>
> >> > > Ignore if not.
> >>
> >> > >
> >>
> >> > > Cheers,
> >>
> >> > > Bert
> >>
> >> > >
> >>
> >> > > On Fri, Aug 9, 2024 at 4:50?PM Yuan Chun Ding via R-help
> >>
> >> > > <r-help at r-project.org> wrote:
> >>
> >> > > >
> >>
> >> > > > Dear R users,
> >>
> >> > > >
> >>
> >> > > > I am running the following code below,  the gem751be.rpkm is a dataframe with dim of 751 samples by 35164 variables,  73 phenotypic variables in the furst to 73rd column and 35091 genomic variables or genes in the 74th to 35164th columns.  What I need to do is to calculate the residuals for each gene using the simple linear regression model of genelist[i] ~ purity2;
> >>
> >> > > >
> >>
> >> > > > The following code is running,  it takes long time, but I have an expensive ThinkStation window computer.
> >>
> >> > > > Can you provide a fast way to do it?
> >>
> >> > > >
> >>
> >> > > > Thank you,
> >>
> >> > > >
> >>
> >> > > > Ding
> >>
> >> > > >
> >>
> >> > > > ---------------------------------------------------------------------------------
> >>
> >> > > >
> >>
> >> > > >
> >>
> >> > > > gem751be.rpkm <-merge(gem751be10, as.data.frame(t(rna849.fpkm2)),
> >>
> >> > > > +                           by.x="id2",by.y=0)
> >>
> >> > > > >   row.names(gem751be.rpkm)<-gem751be.rpkm$id3
> >>
> >> > > > >   colnames(gem751be.rpkm)<-gsub(colnames(gem751be.rpkm),pattern="-",replacement="_")
> >>
> >> > > > >   genelist <- gem751be.rpkm %>% dplyr::select(74:35164)
> >>
> >> > > > >   residuals <- NULL
> >>
> >> > > > >   for (i in 1:length(genelist)) {
> >>
> >> > > > +     #i=1
> >>
> >> > > > +     formula <- reformulate("purity2", response=names(genelist)[i])
> >>
> >> > > > +     model <- lm(formula, data = gem751be.rpkm)
> >>
> >> > > > +     resi <- as.data.frame(residuals(model))
> >>
> >> > > > +     colnames(resi)[1]<-names(genelist)[i]
> >>
> >> > > > +     resi <-as.data.frame(t(resi))
> >>
> >> > > > +     residuals <- rbind(residuals, resi)
> >>
> >> > > > +   }
> >>
> >> > > >
> >>
> >> > > >
> >>
> >> > > >
> >>
> >> > > > ----------------------------------------------------------------------
> >>
> >> > > > ------------------------------------------------------------
> >>
> >> > > > -SECURITY/CONFIDENTIALITY WARNING-
> >>
> >> > > >
> >>
> >> > > > This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to rec
> >>
> >> > > >  eive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)
> >>
> >> > > > ------------------------------------------------------------
> >>
> >> > > >
> >>
> >> > > >         [[alternative HTML version deleted]]
> >>
> >> > > >
> >>
> >> > > > ______________________________________________
> >>
> >> > > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>
> >> > > > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$
> >>
> >> > > > PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$
> >>
> >> > > > and provide commented, minimal, self-contained, reproducible code.
> >>
> >> > >
> >>
> >> > > ______________________________________________
> >>
> >> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>
> >> > > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$
> >>
> >> > > PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$
> >>
> >> > > and provide commented, minimal, self-contained, reproducible code.


From ycd|ng @end|ng |rom coh@org  Sat Aug 10 22:06:33 2024
From: ycd|ng @end|ng |rom coh@org (Yuan Chun Ding)
Date: Sat, 10 Aug 2024 20:06:33 +0000
Subject: [R] a fast way to do my job
In-Reply-To: <CAGxFJbQE_0-PLDoZG_+xRqk4dM6tno-yxkndS_MPyCto-t=+bQ@mail.gmail.com>
References: <MN2PR02MB691185ED67AD413C46A0AAEED4BA2@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CAGxFJbRj=GP4QP4L9npjcS9zwRB7t-1vib03fqicNW2dE-wQZQ@mail.gmail.com>
 <CABghstS_rwq41mudBsFyEML2RrWmKi1thhHi5D81pqVyqaDPSw@mail.gmail.com>
 <CAGxFJbTbdt+QaNX8i4P_X-bir0Td-6Rn=jm5ryB6XrK_CoA0Hw@mail.gmail.com>
 <MN2PR02MB6911508EC9B0040C41044C86D4BB2@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CAGxFJbQE_0-PLDoZG_+xRqk4dM6tno-yxkndS_MPyCto-t=+bQ@mail.gmail.com>
Message-ID: <MN2PR02MB69110F8DE678018C2A02834CD4BB2@MN2PR02MB6911.namprd02.prod.outlook.com>

after add intercept, all residuals are the same from lm or lm.fit.

Ding

From: Bert Gunter <bgunter.4567 at gmail.com>
Sent: Saturday, August 10, 2024 1:00 PM
To: Yuan Chun Ding <ycding at coh.org>
Cc: Ben Bolker <bbolker at gmail.com>; r-help at r-project.org
Subject: Re: [R] a fast way to do my job

Probably because you inadvertently ran different models. Without your code, I haven't a clue. On Sat, Aug 10, 2024, 12:?29 Yuan Chun Ding <ycding@?coh.?org> wrote: HI Bert and Ben, Yes, running lm.?fit using the matrix format is much faster.?


Probably because you inadvertently ran different models. Without your code, I haven't a clue.

On Sat, Aug 10, 2024, 12:29 Yuan Chun Ding <ycding at coh.org<mailto:ycding at coh.org>> wrote:
HI Bert and Ben,

Yes, running lm.fit using the matrix format is much faster. I read a couple of online comments why it is faster.

However, the residual values for three tested variables or genes from lm function and lm.fit function are different, with Pearson correlation of 0.55, 0.89, and 0.99.

I have not found the reason.

Thanks,

Ding

From: Bert Gunter <bgunter.4567 at gmail.com<mailto:bgunter.4567 at gmail.com>>
Sent: Friday, August 9, 2024 7:11 PM
To: Ben Bolker <bbolker at gmail.com<mailto:bbolker at gmail.com>>
Cc: Yuan Chun Ding <ycding at coh.org<mailto:ycding at coh.org>>; r-help at r-project.org<mailto:r-help at r-project.org>
Subject: Re: [R] a fast way to do my job

Better idea, Ben! It would work as you might expect it to to produce the same results as the above: ##first make sure your regressor is a matrix: pur2 <- matrix(purity2, ncol =1) ## convert the data frame variables into a matrix dat <-

Better idea, Ben!



It would work as you might expect it to to produce the same results as

the above:



##first make sure your regressor is a matrix:

pur2 <- matrix(purity2, ncol =1)

## convert the data frame variables into a matrix

dat <- as.matrix(gem751be.rpkm[ , 74:35164])

##then

result <- residuals(lm.fit( x= pur2, y = dat))



Cheers,

Bert



On Fri, Aug 9, 2024 at 6:38?PM Ben Bolker <bbolker at gmail.com<mailto:bbolker at gmail.com>> wrote:

>

> You can also fit a linear model with a matrix-valued response

> variable, which should be even faster (not sure off the top of my head

> how to get the residuals and reshape them to the dimensions you want)

>

> On Fri, Aug 9, 2024 at 9:31?PM Bert Gunter <bgunter.4567 at gmail.com<mailto:bgunter.4567 at gmail.com>> wrote:

> >

> > See ?lm.fit.

> > I must be missing something, because:

> >

> > results <- sapply(74:35164, \(i) residuals(lm.fit(purity2,

> > gem751be.rpkm[, i] )))

> >

> > would give you a 751 x 35091 matrix of the residuals from each of the

> > regressions.

> > I assume it will be considerably faster than all the overhead you are

> > carrying in your current code, but of course you'll have to try it and

> > see. ... Assuming that I have interpreted your request correctly.

> > Ignore if not.

> >

> > Cheers,

> > Bert

> >

> > On Fri, Aug 9, 2024 at 4:50?PM Yuan Chun Ding via R-help

> > <r-help at r-project.org<mailto:r-help at r-project.org>> wrote:

> > >

> > > Dear R users,

> > >

> > > I am running the following code below,  the gem751be.rpkm is a dataframe with dim of 751 samples by 35164 variables,  73 phenotypic variables in the furst to 73rd column and 35091 genomic variables or genes in the 74th to 35164th columns.  What I need to do is to calculate the residuals for each gene using the simple linear regression model of genelist[i] ~ purity2;

> > >

> > > The following code is running,  it takes long time, but I have an expensive ThinkStation window computer.

> > > Can you provide a fast way to do it?

> > >

> > > Thank you,

> > >

> > > Ding

> > >

> > > ---------------------------------------------------------------------------------

> > >

> > >

> > > gem751be.rpkm <-merge(gem751be10, as.data.frame(t(rna849.fpkm2)),

> > > +                           by.x="id2",by.y=0)

> > > >   row.names(gem751be.rpkm)<-gem751be.rpkm$id3

> > > >   colnames(gem751be.rpkm)<-gsub(colnames(gem751be.rpkm),pattern="-",replacement="_")

> > > >   genelist <- gem751be.rpkm %>% dplyr::select(74:35164)

> > > >   residuals <- NULL

> > > >   for (i in 1:length(genelist)) {

> > > +     #i=1

> > > +     formula <- reformulate("purity2", response=names(genelist)[i])

> > > +     model <- lm(formula, data = gem751be.rpkm)

> > > +     resi <- as.data.frame(residuals(model))

> > > +     colnames(resi)[1]<-names(genelist)[i]

> > > +     resi <-as.data.frame(t(resi))

> > > +     residuals <- rbind(residuals, resi)

> > > +   }

> > >

> > >

> > >

> > > ----------------------------------------------------------------------

> > > ------------------------------------------------------------

> > > -SECURITY/CONFIDENTIALITY WARNING-

> > >

> > > This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to rec

> > >  eive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)

> > > ------------------------------------------------------------

> > >

> > >         [[alternative HTML version deleted]]

> > >

> > > ______________________________________________

> > > R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see

> > > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$>

> > > PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$<https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$>

> > > and provide commented, minimal, self-contained, reproducible code.

> >

> > ______________________________________________

> > R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see

> > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$>

> > PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$<https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$>

> > and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From ycd|ng @end|ng |rom coh@org  Sat Aug 10 22:08:47 2024
From: ycd|ng @end|ng |rom coh@org (Yuan Chun Ding)
Date: Sat, 10 Aug 2024 20:08:47 +0000
Subject: [R] a fast way to do my job
In-Reply-To: <CAGxFJbToq5aVdDwro7MyxYMBWLPEoALOQTw2BPuedy+Fe+X=Jg@mail.gmail.com>
References: <MN2PR02MB691185ED67AD413C46A0AAEED4BA2@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CAGxFJbRj=GP4QP4L9npjcS9zwRB7t-1vib03fqicNW2dE-wQZQ@mail.gmail.com>
 <CABghstS_rwq41mudBsFyEML2RrWmKi1thhHi5D81pqVyqaDPSw@mail.gmail.com>
 <CAGxFJbTbdt+QaNX8i4P_X-bir0Td-6Rn=jm5ryB6XrK_CoA0Hw@mail.gmail.com>
 <MN2PR02MB6911508EC9B0040C41044C86D4BB2@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CAGxFJbQE_0-PLDoZG_+xRqk4dM6tno-yxkndS_MPyCto-t=+bQ@mail.gmail.com>
 <CAGxFJbRXzQC2r5s4+o21q86SzVX_PN_0m8Pbvq6xhEjE1Gc8Sw@mail.gmail.com>
 <CAGxFJbToq5aVdDwro7MyxYMBWLPEoALOQTw2BPuedy+Fe+X=Jg@mail.gmail.com>
Message-ID: <MN2PR02MB6911AF5C92CB10CEDD2839B5D4BB2@MN2PR02MB6911.namprd02.prod.outlook.com>

You are right.  I also just thought about that, no intercept is not applicable to my case.

Ding

From: Bert Gunter <bgunter.4567 at gmail.com>
Sent: Saturday, August 10, 2024 1:06 PM
To: Yuan Chun Ding <ycding at coh.org>
Cc: Ben Bolker <bbolker at gmail.com>; r-help at r-project.org
Subject: Re: [R] a fast way to do my job

Ah, messages crossed. A no-intercept model **assumes** the straight line fit must pass through the origin. Unless there is a strong justification for such an assumption, you should include an intercept. -- Bert On Sat, Aug 10, 2024 at 1:?02 PM


Ah, messages crossed.

A no-intercept model **assumes** the straight line fit must pass

through the origin. Unless there is a strong justification for such an

assumption, you should include an intercept.



-- Bert



On Sat, Aug 10, 2024 at 1:02?PM Bert Gunter <bgunter.4567 at gmail.com<mailto:bgunter.4567 at gmail.com>> wrote:

>

> Is it because I failed to to add a column of ones for an intercept to

> the x matrix? TRhat would be my bad.

>

> -- Bert

>

>

> On Sat, Aug 10, 2024 at 12:59?PM Bert Gunter <bgunter.4567 at gmail.com<mailto:bgunter.4567 at gmail.com>> wrote:

> >

> > Probably because you inadvertently ran different models. Without your code, I haven't a clue.

> >

> >

> > On Sat, Aug 10, 2024, 12:29 Yuan Chun Ding <ycding at coh.org<mailto:ycding at coh.org>> wrote:

> >>

> >> HI Bert and Ben,

> >>

> >>

> >>

> >> Yes, running lm.fit using the matrix format is much faster. I read a couple of online comments why it is faster.

> >>

> >>

> >>

> >> However, the residual values for three tested variables or genes from lm function and lm.fit function are different, with Pearson correlation of 0.55, 0.89, and 0.99.

> >>

> >>

> >>

> >> I have not found the reason.

> >>

> >>

> >>

> >> Thanks,

> >>

> >>

> >> Ding

> >>

> >>

> >>

> >> From: Bert Gunter <bgunter.4567 at gmail.com<mailto:bgunter.4567 at gmail.com>>

> >> Sent: Friday, August 9, 2024 7:11 PM

> >> To: Ben Bolker <bbolker at gmail.com<mailto:bbolker at gmail.com>>

> >> Cc: Yuan Chun Ding <ycding at coh.org<mailto:ycding at coh.org>>; r-help at r-project.org<mailto:r-help at r-project.org>

> >> Subject: Re: [R] a fast way to do my job

> >>

> >>

> >>

> >> Better idea, Ben! It would work as you might expect it to to produce the same results as the above: ##first make sure your regressor is a matrix: pur2 <- matrix(purity2, ncol =1) ## convert the data frame variables into a matrix dat <-

> >>

> >> Better idea, Ben!

> >>

> >>

> >>

> >> It would work as you might expect it to to produce the same results as

> >>

> >> the above:

> >>

> >>

> >>

> >> ##first make sure your regressor is a matrix:

> >>

> >> pur2 <- matrix(purity2, ncol =1)

> >>

> >> ## convert the data frame variables into a matrix

> >>

> >> dat <- as.matrix(gem751be.rpkm[ , 74:35164])

> >>

> >> ##then

> >>

> >> result <- residuals(lm.fit( x= pur2, y = dat))

> >>

> >>

> >>

> >> Cheers,

> >>

> >> Bert

> >>

> >>

> >>

> >> On Fri, Aug 9, 2024 at 6:38?PM Ben Bolker <bbolker at gmail.com<mailto:bbolker at gmail.com>> wrote:

> >>

> >> >

> >>

> >> > You can also fit a linear model with a matrix-valued response

> >>

> >> > variable, which should be even faster (not sure off the top of my head

> >>

> >> > how to get the residuals and reshape them to the dimensions you want)

> >>

> >> >

> >>

> >> > On Fri, Aug 9, 2024 at 9:31?PM Bert Gunter <bgunter.4567 at gmail.com<mailto:bgunter.4567 at gmail.com>> wrote:

> >>

> >> > >

> >>

> >> > > See ?lm.fit.

> >>

> >> > > I must be missing something, because:

> >>

> >> > >

> >>

> >> > > results <- sapply(74:35164, \(i) residuals(lm.fit(purity2,

> >>

> >> > > gem751be.rpkm[, i] )))

> >>

> >> > >

> >>

> >> > > would give you a 751 x 35091 matrix of the residuals from each of the

> >>

> >> > > regressions.

> >>

> >> > > I assume it will be considerably faster than all the overhead you are

> >>

> >> > > carrying in your current code, but of course you'll have to try it and

> >>

> >> > > see. ... Assuming that I have interpreted your request correctly.

> >>

> >> > > Ignore if not.

> >>

> >> > >

> >>

> >> > > Cheers,

> >>

> >> > > Bert

> >>

> >> > >

> >>

> >> > > On Fri, Aug 9, 2024 at 4:50?PM Yuan Chun Ding via R-help

> >>

> >> > > <r-help at r-project.org<mailto:r-help at r-project.org>> wrote:

> >>

> >> > > >

> >>

> >> > > > Dear R users,

> >>

> >> > > >

> >>

> >> > > > I am running the following code below,  the gem751be.rpkm is a dataframe with dim of 751 samples by 35164 variables,  73 phenotypic variables in the furst to 73rd column and 35091 genomic variables or genes in the 74th to 35164th columns.  What I need to do is to calculate the residuals for each gene using the simple linear regression model of genelist[i] ~ purity2;

> >>

> >> > > >

> >>

> >> > > > The following code is running,  it takes long time, but I have an expensive ThinkStation window computer.

> >>

> >> > > > Can you provide a fast way to do it?

> >>

> >> > > >

> >>

> >> > > > Thank you,

> >>

> >> > > >

> >>

> >> > > > Ding

> >>

> >> > > >

> >>

> >> > > > ---------------------------------------------------------------------------------

> >>

> >> > > >

> >>

> >> > > >

> >>

> >> > > > gem751be.rpkm <-merge(gem751be10, as.data.frame(t(rna849.fpkm2)),

> >>

> >> > > > +                           by.x="id2",by.y=0)

> >>

> >> > > > >   row.names(gem751be.rpkm)<-gem751be.rpkm$id3

> >>

> >> > > > >   colnames(gem751be.rpkm)<-gsub(colnames(gem751be.rpkm),pattern="-",replacement="_")

> >>

> >> > > > >   genelist <- gem751be.rpkm %>% dplyr::select(74:35164)

> >>

> >> > > > >   residuals <- NULL

> >>

> >> > > > >   for (i in 1:length(genelist)) {

> >>

> >> > > > +     #i=1

> >>

> >> > > > +     formula <- reformulate("purity2", response=names(genelist)[i])

> >>

> >> > > > +     model <- lm(formula, data = gem751be.rpkm)

> >>

> >> > > > +     resi <- as.data.frame(residuals(model))

> >>

> >> > > > +     colnames(resi)[1]<-names(genelist)[i]

> >>

> >> > > > +     resi <-as.data.frame(t(resi))

> >>

> >> > > > +     residuals <- rbind(residuals, resi)

> >>

> >> > > > +   }

> >>

> >> > > >

> >>

> >> > > >

> >>

> >> > > >

> >>

> >> > > > ----------------------------------------------------------------------

> >>

> >> > > > ------------------------------------------------------------

> >>

> >> > > > -SECURITY/CONFIDENTIALITY WARNING-

> >>

> >> > > >

> >>

> >> > > > This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to rec

> >>

> >> > > >  eive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)

> >>

> >> > > > ------------------------------------------------------------

> >>

> >> > > >

> >>

> >> > > >         [[alternative HTML version deleted]]

> >>

> >> > > >

> >>

> >> > > > ______________________________________________

> >>

> >> > > > R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see

> >>

> >> > > > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3e>

><https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3e>>>

> >> > > > PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$<https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3e>

><https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3e>>>

> >> > > > and provide commented, minimal, self-contained, reproducible code.

> >>

> >> > >

> >>

> >> > > ______________________________________________

> >>

> >> > > R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see

> >>

> >> > > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3e>

><https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3e>>>

> >> > > PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$<https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3e>

><https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3e>>>

> >> > > and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Aug 10 23:02:37 2024
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 10 Aug 2024 22:02:37 +0100
Subject: [R] a fast way to do my job
In-Reply-To: <MN2PR02MB6911AF5C92CB10CEDD2839B5D4BB2@MN2PR02MB6911.namprd02.prod.outlook.com>
References: <MN2PR02MB691185ED67AD413C46A0AAEED4BA2@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CAGxFJbRj=GP4QP4L9npjcS9zwRB7t-1vib03fqicNW2dE-wQZQ@mail.gmail.com>
 <CABghstS_rwq41mudBsFyEML2RrWmKi1thhHi5D81pqVyqaDPSw@mail.gmail.com>
 <CAGxFJbTbdt+QaNX8i4P_X-bir0Td-6Rn=jm5ryB6XrK_CoA0Hw@mail.gmail.com>
 <MN2PR02MB6911508EC9B0040C41044C86D4BB2@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CAGxFJbQE_0-PLDoZG_+xRqk4dM6tno-yxkndS_MPyCto-t=+bQ@mail.gmail.com>
 <CAGxFJbRXzQC2r5s4+o21q86SzVX_PN_0m8Pbvq6xhEjE1Gc8Sw@mail.gmail.com>
 <CAGxFJbToq5aVdDwro7MyxYMBWLPEoALOQTw2BPuedy+Fe+X=Jg@mail.gmail.com>
 <MN2PR02MB6911AF5C92CB10CEDD2839B5D4BB2@MN2PR02MB6911.namprd02.prod.outlook.com>
Message-ID: <3683a5e2-365d-484e-8c71-0188443cca41@sapo.pt>

Hello,

.lm.fit is an order of magnitude faster than lm.fit but the Description 
section warns on its use, see the examples in help("lm.fit").

Hope this helps,

Rui Barradas

?s 21:08 de 10/08/2024, Yuan Chun Ding via R-help escreveu:
> You are right.  I also just thought about that, no intercept is not applicable to my case.
> 
> Ding
> 
> From: Bert Gunter <bgunter.4567 at gmail.com>
> Sent: Saturday, August 10, 2024 1:06 PM
> To: Yuan Chun Ding <ycding at coh.org>
> Cc: Ben Bolker <bbolker at gmail.com>; r-help at r-project.org
> Subject: Re: [R] a fast way to do my job
> 
> Ah, messages crossed. A no-intercept model **assumes** the straight line fit must pass through the origin. Unless there is a strong justification for such an assumption, you should include an intercept. -- Bert On Sat, Aug 10, 2024 at 1:?02 PM
> 
> 
> Ah, messages crossed.
> 
> A no-intercept model **assumes** the straight line fit must pass
> 
> through the origin. Unless there is a strong justification for such an
> 
> assumption, you should include an intercept.
> 
> 
> 
> -- Bert
> 
> 
> 
> On Sat, Aug 10, 2024 at 1:02?PM Bert Gunter <bgunter.4567 at gmail.com<mailto:bgunter.4567 at gmail.com>> wrote:
> 
>>
> 
>> Is it because I failed to to add a column of ones for an intercept to
> 
>> the x matrix? TRhat would be my bad.
> 
>>
> 
>> -- Bert
> 
>>
> 
>>
> 
>> On Sat, Aug 10, 2024 at 12:59?PM Bert Gunter <bgunter.4567 at gmail.com<mailto:bgunter.4567 at gmail.com>> wrote:
> 
>>>
> 
>>> Probably because you inadvertently ran different models. Without your code, I haven't a clue.
> 
>>>
> 
>>>
> 
>>> On Sat, Aug 10, 2024, 12:29 Yuan Chun Ding <ycding at coh.org<mailto:ycding at coh.org>> wrote:
> 
>>>>
> 
>>>> HI Bert and Ben,
> 
>>>>
> 
>>>>
> 
>>>>
> 
>>>> Yes, running lm.fit using the matrix format is much faster. I read a couple of online comments why it is faster.
> 
>>>>
> 
>>>>
> 
>>>>
> 
>>>> However, the residual values for three tested variables or genes from lm function and lm.fit function are different, with Pearson correlation of 0.55, 0.89, and 0.99.
> 
>>>>
> 
>>>>
> 
>>>>
> 
>>>> I have not found the reason.
> 
>>>>
> 
>>>>
> 
>>>>
> 
>>>> Thanks,
> 
>>>>
> 
>>>>
> 
>>>> Ding
> 
>>>>
> 
>>>>
> 
>>>>
> 
>>>> From: Bert Gunter <bgunter.4567 at gmail.com<mailto:bgunter.4567 at gmail.com>>
> 
>>>> Sent: Friday, August 9, 2024 7:11 PM
> 
>>>> To: Ben Bolker <bbolker at gmail.com<mailto:bbolker at gmail.com>>
> 
>>>> Cc: Yuan Chun Ding <ycding at coh.org<mailto:ycding at coh.org>>; r-help at r-project.org<mailto:r-help at r-project.org>
> 
>>>> Subject: Re: [R] a fast way to do my job
> 
>>>>
> 
>>>>
> 
>>>>
> 
>>>> Better idea, Ben! It would work as you might expect it to to produce the same results as the above: ##first make sure your regressor is a matrix: pur2 <- matrix(purity2, ncol =1) ## convert the data frame variables into a matrix dat <-
> 
>>>>
> 
>>>> Better idea, Ben!
> 
>>>>
> 
>>>>
> 
>>>>
> 
>>>> It would work as you might expect it to to produce the same results as
> 
>>>>
> 
>>>> the above:
> 
>>>>
> 
>>>>
> 
>>>>
> 
>>>> ##first make sure your regressor is a matrix:
> 
>>>>
> 
>>>> pur2 <- matrix(purity2, ncol =1)
> 
>>>>
> 
>>>> ## convert the data frame variables into a matrix
> 
>>>>
> 
>>>> dat <- as.matrix(gem751be.rpkm[ , 74:35164])
> 
>>>>
> 
>>>> ##then
> 
>>>>
> 
>>>> result <- residuals(lm.fit( x= pur2, y = dat))
> 
>>>>
> 
>>>>
> 
>>>>
> 
>>>> Cheers,
> 
>>>>
> 
>>>> Bert
> 
>>>>
> 
>>>>
> 
>>>>
> 
>>>> On Fri, Aug 9, 2024 at 6:38?PM Ben Bolker <bbolker at gmail.com<mailto:bbolker at gmail.com>> wrote:
> 
>>>>
> 
>>>>>
> 
>>>>
> 
>>>>> You can also fit a linear model with a matrix-valued response
> 
>>>>
> 
>>>>> variable, which should be even faster (not sure off the top of my head
> 
>>>>
> 
>>>>> how to get the residuals and reshape them to the dimensions you want)
> 
>>>>
> 
>>>>>
> 
>>>>
> 
>>>>> On Fri, Aug 9, 2024 at 9:31?PM Bert Gunter <bgunter.4567 at gmail.com<mailto:bgunter.4567 at gmail.com>> wrote:
> 
>>>>
> 
>>>>>>
> 
>>>>
> 
>>>>>> See ?lm.fit.
> 
>>>>
> 
>>>>>> I must be missing something, because:
> 
>>>>
> 
>>>>>>
> 
>>>>
> 
>>>>>> results <- sapply(74:35164, \(i) residuals(lm.fit(purity2,
> 
>>>>
> 
>>>>>> gem751be.rpkm[, i] )))
> 
>>>>
> 
>>>>>>
> 
>>>>
> 
>>>>>> would give you a 751 x 35091 matrix of the residuals from each of the
> 
>>>>
> 
>>>>>> regressions.
> 
>>>>
> 
>>>>>> I assume it will be considerably faster than all the overhead you are
> 
>>>>
> 
>>>>>> carrying in your current code, but of course you'll have to try it and
> 
>>>>
> 
>>>>>> see. ... Assuming that I have interpreted your request correctly.
> 
>>>>
> 
>>>>>> Ignore if not.
> 
>>>>
> 
>>>>>>
> 
>>>>
> 
>>>>>> Cheers,
> 
>>>>
> 
>>>>>> Bert
> 
>>>>
> 
>>>>>>
> 
>>>>
> 
>>>>>> On Fri, Aug 9, 2024 at 4:50?PM Yuan Chun Ding via R-help
> 
>>>>
> 
>>>>>> <r-help at r-project.org<mailto:r-help at r-project.org>> wrote:
> 
>>>>
> 
>>>>>>>
> 
>>>>
> 
>>>>>>> Dear R users,
> 
>>>>
> 
>>>>>>>
> 
>>>>
> 
>>>>>>> I am running the following code below,  the gem751be.rpkm is a dataframe with dim of 751 samples by 35164 variables,  73 phenotypic variables in the furst to 73rd column and 35091 genomic variables or genes in the 74th to 35164th columns.  What I need to do is to calculate the residuals for each gene using the simple linear regression model of genelist[i] ~ purity2;
> 
>>>>
> 
>>>>>>>
> 
>>>>
> 
>>>>>>> The following code is running,  it takes long time, but I have an expensive ThinkStation window computer.
> 
>>>>
> 
>>>>>>> Can you provide a fast way to do it?
> 
>>>>
> 
>>>>>>>
> 
>>>>
> 
>>>>>>> Thank you,
> 
>>>>
> 
>>>>>>>
> 
>>>>
> 
>>>>>>> Ding
> 
>>>>
> 
>>>>>>>
> 
>>>>
> 
>>>>>>> ---------------------------------------------------------------------------------
> 
>>>>
> 
>>>>>>>
> 
>>>>
> 
>>>>>>>
> 
>>>>
> 
>>>>>>> gem751be.rpkm <-merge(gem751be10, as.data.frame(t(rna849.fpkm2)),
> 
>>>>
> 
>>>>>>> +                           by.x="id2",by.y=0)
> 
>>>>
> 
>>>>>>>>    row.names(gem751be.rpkm)<-gem751be.rpkm$id3
> 
>>>>
> 
>>>>>>>>    colnames(gem751be.rpkm)<-gsub(colnames(gem751be.rpkm),pattern="-",replacement="_")
> 
>>>>
> 
>>>>>>>>    genelist <- gem751be.rpkm %>% dplyr::select(74:35164)
> 
>>>>
> 
>>>>>>>>    residuals <- NULL
> 
>>>>
> 
>>>>>>>>    for (i in 1:length(genelist)) {
> 
>>>>
> 
>>>>>>> +     #i=1
> 
>>>>
> 
>>>>>>> +     formula <- reformulate("purity2", response=names(genelist)[i])
> 
>>>>
> 
>>>>>>> +     model <- lm(formula, data = gem751be.rpkm)
> 
>>>>
> 
>>>>>>> +     resi <- as.data.frame(residuals(model))
> 
>>>>
> 
>>>>>>> +     colnames(resi)[1]<-names(genelist)[i]
> 
>>>>
> 
>>>>>>> +     resi <-as.data.frame(t(resi))
> 
>>>>
> 
>>>>>>> +     residuals <- rbind(residuals, resi)
> 
>>>>
> 
>>>>>>> +   }
> 
>>>>
> 
>>>>>>>
> 
>>>>
> 
>>>>>>>
> 
>>>>
> 
>>>>>>>
> 
>>>>
> 
>>>>>>> ----------------------------------------------------------------------
> 
>>>>
> 
>>>>>>> ------------------------------------------------------------
> 
>>>>
> 
>>>>>>> -SECURITY/CONFIDENTIALITY WARNING-
> 
>>>>
> 
>>>>>>>
> 
>>>>
> 
>>>>>>> This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to rec
> 
>>>>
> 
>>>>>>>   eive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)
> 
>>>>
> 
>>>>>>> ------------------------------------------------------------
> 
>>>>
> 
>>>>>>>
> 
>>>>
> 
>>>>>>>          [[alternative HTML version deleted]]
> 
>>>>
> 
>>>>>>>
> 
>>>>
> 
>>>>>>> ______________________________________________
> 
>>>>
> 
>>>>>>> R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
> 
>>>>
> 
>>>>>>> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3e>
> 
>> <https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3e>>>
> 
>>>>>>> PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$<https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3e>
> 
>> <https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3e>>>
> 
>>>>>>> and provide commented, minimal, self-contained, reproducible code.
> 
>>>>
> 
>>>>>>
> 
>>>>
> 
>>>>>> ______________________________________________
> 
>>>>
> 
>>>>>> R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
> 
>>>>
> 
>>>>>> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3e>
> 
>> <https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX72PW30DQ$%3e>>>
> 
>>>>>> PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$<https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3e>
> 
>> <https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qcJ4z-vlMNzsa8XCsJUcuPOz8Vt12zsV_XaWpqXsyUYJBTlcNRonFPr7w7Ql3xqcDnZ9ZYC8JX66rfmKvA$%3e>>>
> 
>>>>>> and provide commented, minimal, self-contained, reproducible code.
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.
www.avg.com

From @tyen @end|ng |rom ntu@edu@tw  Sun Aug 11 10:51:00 2024
From: @tyen @end|ng |rom ntu@edu@tw (Steven Yen)
Date: Sun, 11 Aug 2024 16:51:00 +0800
Subject: [R] Printing
Message-ID: <e6f8cd2c-5dd5-426b-8e24-30b736ea359a@ntu.edu.tw>

Hi

In the following codes, I had to choose between printing (= TRUE) or 
deliver something for grab (ei, vi). Is there a way to get both--that 
is, to print and also have ei and vi for grab? Thanks.

Steven

...

out<-round(as.data.frame(cbind(ap,se,t,p)),digits)
out<-cbind(out,sig)
out<-out[!grepl(colnames(zx)[1],rownames(out)),]
if(printing){
cat("\nAPPs of bivariate ordered probit probabilities",
 ??? "\nWritten by Steven T. Yen (Last update: 08.11.24)",
 ??? "\ny1.level=",???? y1.level,
 ??? "? y2.level=",???? y2.level,
 ??? "\njoint12 =",???? joint12,
 ??? "\nmarg1 =",?????? marg1,
 ??? "\nmarg2 =",?????? marg2,
 ??? "\ncond12 =",????? cond12,
 ??? "\ncond21 =",????? cond21,
 ??? "\nCovariance matrix:",vb.method,
 ??? "\nWeighted =",??????? weighted,
 ??? "\nAt means =",??????? mean,
 ??? "\nProb x 100 =",????? times100,
 ??? "\ntesting ="????? ,?? testing,
 ??? "\nuse_bb_and_vbb = ",use_bb_and_vbb,
 ??? "\nsample size =",???? length(y1),"\n")
if (!resampling) cat("\nSEs by delta method","\n")
if? (resampling) cat("\nSEs K-R resampling with",ndraws,"draws\n")
return(out)
} else {
invisible(list("ei"=ap,"vi"=vap))


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sun Aug 11 16:09:43 2024
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sun, 11 Aug 2024 15:09:43 +0100
Subject: [R] Printing
In-Reply-To: <e6f8cd2c-5dd5-426b-8e24-30b736ea359a@ntu.edu.tw>
References: <e6f8cd2c-5dd5-426b-8e24-30b736ea359a@ntu.edu.tw>
Message-ID: <4c806af4-f89c-44a0-8ca7-db234f8f6512@sapo.pt>

?s 09:51 de 11/08/2024, Steven Yen escreveu:
> Hi
> 
> In the following codes, I had to choose between printing (= TRUE) or 
> deliver something for grab (ei, vi). Is there a way to get both--that 
> is, to print and also have ei and vi for grab? Thanks.
> 
> Steven
> 
> ...
> 
> out<-round(as.data.frame(cbind(ap,se,t,p)),digits)
> out<-cbind(out,sig)
> out<-out[!grepl(colnames(zx)[1],rownames(out)),]
> if(printing){
> cat("\nAPPs of bivariate ordered probit probabilities",
>  ??? "\nWritten by Steven T. Yen (Last update: 08.11.24)",
>  ??? "\ny1.level=",???? y1.level,
>  ??? "? y2.level=",???? y2.level,
>  ??? "\njoint12 =",???? joint12,
>  ??? "\nmarg1 =",?????? marg1,
>  ??? "\nmarg2 =",?????? marg2,
>  ??? "\ncond12 =",????? cond12,
>  ??? "\ncond21 =",????? cond21,
>  ??? "\nCovariance matrix:",vb.method,
>  ??? "\nWeighted =",??????? weighted,
>  ??? "\nAt means =",??????? mean,
>  ??? "\nProb x 100 =",????? times100,
>  ??? "\ntesting ="????? ,?? testing,
>  ??? "\nuse_bb_and_vbb = ",use_bb_and_vbb,
>  ??? "\nsample size =",???? length(y1),"\n")
> if (!resampling) cat("\nSEs by delta method","\n")
> if? (resampling) cat("\nSEs K-R resampling with",ndraws,"draws\n")
> return(out)
> } else {
> invisible(list("ei"=ap,"vi"=vap))
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

Hello,

Maybe change the end of the code to return a bigger list.


ll <- list(out = out, ei = ap, vi = vap)
return(ll)
} else {
invisible(list("ei"=ap,"vi"=vap))


Hope this helps,

Rui Barradas



-- 
Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.
www.avg.com


From @tyen @end|ng |rom ntu@edu@tw  Sun Aug 11 16:36:08 2024
From: @tyen @end|ng |rom ntu@edu@tw (Steven Yen)
Date: Sun, 11 Aug 2024 22:36:08 +0800
Subject: [R] Printing
In-Reply-To: <4c806af4-f89c-44a0-8ca7-db234f8f6512@sapo.pt>
References: <e6f8cd2c-5dd5-426b-8e24-30b736ea359a@ntu.edu.tw>
 <4c806af4-f89c-44a0-8ca7-db234f8f6512@sapo.pt>
Message-ID: <fd536a0d-e030-4f64-8775-c624a743ad19@ntu.edu.tw>

Thanks. Will try it.

Have not tried it but I think the following may work:

out$results<-NULL

out$results$ei<-ap

out$results$vi<-vap

All I need is printing by returning out (unless I turn it off). And, 
retrieve ap and vap as needed as shown above. Guess I need to read more 
about invisible.

On 8/11/2024 10:09 PM, Rui Barradas wrote:
> ?s 09:51 de 11/08/2024, Steven Yen escreveu:
>> Hi
>>
>> In the following codes, I had to choose between printing (= TRUE) or 
>> deliver something for grab (ei, vi). Is there a way to get both--that 
>> is, to print and also have ei and vi for grab? Thanks.
>>
>> Steven
>>
>> ...
>>
>> out<-round(as.data.frame(cbind(ap,se,t,p)),digits)
>> out<-cbind(out,sig)
>> out<-out[!grepl(colnames(zx)[1],rownames(out)),]
>> if(printing){
>> cat("\nAPPs of bivariate ordered probit probabilities",
>> ???? "\nWritten by Steven T. Yen (Last update: 08.11.24)",
>> ???? "\ny1.level=",???? y1.level,
>> ???? "? y2.level=",???? y2.level,
>> ???? "\njoint12 =",???? joint12,
>> ???? "\nmarg1 =",?????? marg1,
>> ???? "\nmarg2 =",?????? marg2,
>> ???? "\ncond12 =",????? cond12,
>> ???? "\ncond21 =",????? cond21,
>> ???? "\nCovariance matrix:",vb.method,
>> ???? "\nWeighted =",??????? weighted,
>> ???? "\nAt means =",??????? mean,
>> ???? "\nProb x 100 =",????? times100,
>> ???? "\ntesting ="????? ,?? testing,
>> ???? "\nuse_bb_and_vbb = ",use_bb_and_vbb,
>> ???? "\nsample size =",???? length(y1),"\n")
>> if (!resampling) cat("\nSEs by delta method","\n")
>> if? (resampling) cat("\nSEs K-R resampling with",ndraws,"draws\n")
>> return(out)
>> } else {
>> invisible(list("ei"=ap,"vi"=vap))
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
> Hello,
>
> Maybe change the end of the code to return a bigger list.
>
>
> ll <- list(out = out, ei = ap, vi = vap)
> return(ll)
> } else {
> invisible(list("ei"=ap,"vi"=vap))
>
>
> Hope this helps,
>
> Rui Barradas
>
>
>


From |kry|ov @end|ng |rom d|@root@org  Sun Aug 11 16:52:44 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Sun, 11 Aug 2024 17:52:44 +0300
Subject: [R] Printing
In-Reply-To: <fd536a0d-e030-4f64-8775-c624a743ad19@ntu.edu.tw>
References: <e6f8cd2c-5dd5-426b-8e24-30b736ea359a@ntu.edu.tw>
 <4c806af4-f89c-44a0-8ca7-db234f8f6512@sapo.pt>
 <fd536a0d-e030-4f64-8775-c624a743ad19@ntu.edu.tw>
Message-ID: <20240811175244.31c24fbe@trisector>

? Sun, 11 Aug 2024 22:36:08 +0800
Steven Yen <styen at ntu.edu.tw> ?????:

> All I need is printing by returning out (unless I turn it off). And, 
> retrieve ap and vap as needed as shown above. Guess I need to read
> more about invisible.

Perhaps you could print(out) instead of returning it in the if
(printing) branch? Then you would be able to always
return(invisible(list("ei"=ap,"vi"=vap))), whether printing is TRUE or
not.

-- 
Best regards,
Ivan


From bgunter@4567 @end|ng |rom gm@||@com  Sun Aug 11 16:57:54 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sun, 11 Aug 2024 07:57:54 -0700
Subject: [R] Printing
In-Reply-To: <fd536a0d-e030-4f64-8775-c624a743ad19@ntu.edu.tw>
References: <e6f8cd2c-5dd5-426b-8e24-30b736ea359a@ntu.edu.tw>
 <4c806af4-f89c-44a0-8ca7-db234f8f6512@sapo.pt>
 <fd536a0d-e030-4f64-8775-c624a743ad19@ntu.edu.tw>
Message-ID: <CAGxFJbSiZJrLP2EhUzSah3jfWhMH3Hvxoha-dzkBLjyts1FgsQ@mail.gmail.com>

Just for reference, R's "preferred" way to handle printing is to
create "classed" objects from a function that produces all the
necessary information and have an appropriate "print" method, i.e.
function, for that class to print it. R has several class object
systems that can do this, including the basic S3 system. Spend some
time with an R tutorial or two to learn more, as it's clear from your
query that your R knowledge would benefit from such effort (though I
suppose all of us could say the same).

Cheers, Bert

On Sun, Aug 11, 2024 at 7:43?AM Steven Yen <styen at ntu.edu.tw> wrote:
>
> Thanks. Will try it.
>
> Have not tried it but I think the following may work:
>
> out$results<-NULL
>
> out$results$ei<-ap
>
> out$results$vi<-vap
>
> All I need is printing by returning out (unless I turn it off). And,
> retrieve ap and vap as needed as shown above. Guess I need to read more
> about invisible.
>
> On 8/11/2024 10:09 PM, Rui Barradas wrote:
> > ?s 09:51 de 11/08/2024, Steven Yen escreveu:
> >> Hi
> >>
> >> In the following codes, I had to choose between printing (= TRUE) or
> >> deliver something for grab (ei, vi). Is there a way to get both--that
> >> is, to print and also have ei and vi for grab? Thanks.
> >>
> >> Steven
> >>
> >> ...
> >>
> >> out<-round(as.data.frame(cbind(ap,se,t,p)),digits)
> >> out<-cbind(out,sig)
> >> out<-out[!grepl(colnames(zx)[1],rownames(out)),]
> >> if(printing){
> >> cat("\nAPPs of bivariate ordered probit probabilities",
> >>      "\nWritten by Steven T. Yen (Last update: 08.11.24)",
> >>      "\ny1.level=",     y1.level,
> >>      "  y2.level=",     y2.level,
> >>      "\njoint12 =",     joint12,
> >>      "\nmarg1 =",       marg1,
> >>      "\nmarg2 =",       marg2,
> >>      "\ncond12 =",      cond12,
> >>      "\ncond21 =",      cond21,
> >>      "\nCovariance matrix:",vb.method,
> >>      "\nWeighted =",        weighted,
> >>      "\nAt means =",        mean,
> >>      "\nProb x 100 =",      times100,
> >>      "\ntesting ="      ,   testing,
> >>      "\nuse_bb_and_vbb = ",use_bb_and_vbb,
> >>      "\nsample size =",     length(y1),"\n")
> >> if (!resampling) cat("\nSEs by delta method","\n")
> >> if  (resampling) cat("\nSEs K-R resampling with",ndraws,"draws\n")
> >> return(out)
> >> } else {
> >> invisible(list("ei"=ap,"vi"=vap))
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> >> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >
> > Hello,
> >
> > Maybe change the end of the code to return a bigger list.
> >
> >
> > ll <- list(out = out, ei = ap, vi = vap)
> > return(ll)
> > } else {
> > invisible(list("ei"=ap,"vi"=vap))
> >
> >
> > Hope this helps,
> >
> > Rui Barradas
> >
> >
> >
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sun Aug 11 17:59:59 2024
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sun, 11 Aug 2024 16:59:59 +0100
Subject: [R] Printing
In-Reply-To: <fd536a0d-e030-4f64-8775-c624a743ad19@ntu.edu.tw>
References: <e6f8cd2c-5dd5-426b-8e24-30b736ea359a@ntu.edu.tw>
 <4c806af4-f89c-44a0-8ca7-db234f8f6512@sapo.pt>
 <fd536a0d-e030-4f64-8775-c624a743ad19@ntu.edu.tw>
Message-ID: <8d87f633-de7b-4723-9085-d0ef0ab5fba8@sapo.pt>

?s 15:36 de 11/08/2024, Steven Yen escreveu:
> Thanks. Will try it.
> 
> Have not tried it but I think the following may work:
> 
> out$results<-NULL
> 
> out$results$ei<-ap
> 
> out$results$vi<-vap
> 
> All I need is printing by returning out (unless I turn it off). And, 
> retrieve ap and vap as needed as shown above. Guess I need to read more 
> about invisible.
> 
> On 8/11/2024 10:09 PM, Rui Barradas wrote:
>> ?s 09:51 de 11/08/2024, Steven Yen escreveu:
>>> Hi
>>>
>>> In the following codes, I had to choose between printing (= TRUE) or 
>>> deliver something for grab (ei, vi). Is there a way to get both--that 
>>> is, to print and also have ei and vi for grab? Thanks.
>>>
>>> Steven
>>>
>>> ...
>>>
>>> out<-round(as.data.frame(cbind(ap,se,t,p)),digits)
>>> out<-cbind(out,sig)
>>> out<-out[!grepl(colnames(zx)[1],rownames(out)),]
>>> if(printing){
>>> cat("\nAPPs of bivariate ordered probit probabilities",
>>> ???? "\nWritten by Steven T. Yen (Last update: 08.11.24)",
>>> ???? "\ny1.level=",???? y1.level,
>>> ???? "? y2.level=",???? y2.level,
>>> ???? "\njoint12 =",???? joint12,
>>> ???? "\nmarg1 =",?????? marg1,
>>> ???? "\nmarg2 =",?????? marg2,
>>> ???? "\ncond12 =",????? cond12,
>>> ???? "\ncond21 =",????? cond21,
>>> ???? "\nCovariance matrix:",vb.method,
>>> ???? "\nWeighted =",??????? weighted,
>>> ???? "\nAt means =",??????? mean,
>>> ???? "\nProb x 100 =",????? times100,
>>> ???? "\ntesting ="????? ,?? testing,
>>> ???? "\nuse_bb_and_vbb = ",use_bb_and_vbb,
>>> ???? "\nsample size =",???? length(y1),"\n")
>>> if (!resampling) cat("\nSEs by delta method","\n")
>>> if? (resampling) cat("\nSEs K-R resampling with",ndraws,"draws\n")
>>> return(out)
>>> } else {
>>> invisible(list("ei"=ap,"vi"=vap))
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide 
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> Hello,
>>
>> Maybe change the end of the code to return a bigger list.
>>
>>
>> ll <- list(out = out, ei = ap, vi = vap)
>> return(ll)
>> } else {
>> invisible(list("ei"=ap,"vi"=vap))
>>
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>>
>>
Hello,

Use descriptive names, print the data frame in the function and return a 
list invisibly.

Also,
1) Why create a data.frame with rounded numbers? I never do this. To 
round numbers is a matter of results display and in the case of df's 
should be left to the print.data.frame method. Always return the numbers 
as they are. See comment below.
2) And never, ever code the creation of a df as

as.data.frame(cbind(.))

If the vectors are a mix of numeric and character they will all be 
coerced to the least common denominator, all vectors will become of 
class character.



# don't do this
df <- round(as.data.frame(cbind(ap, se, t, p)), digits)
df <- cbind(df, sig)

# do this instead
df <- data.frame(ap, se, t, p, sig)

df <- df[!grepl(colnames(zx)[1],rownames(df)), ]

out <- NULL
if(printing){
   #
   [...rest of code...]
   #
   out$data <- df
   cat("data:\n")
   print(out$data)
}
out$results <- list(ei = ap, vi = vap)
invisible(out)



Hope this helps,

Rui Barradas


-- 
Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.
www.avg.com


From sibyiie@stoeckii m@iii@g oii gmx@ch  Sun Aug 11 18:10:12 2024
From: sibyiie@stoeckii m@iii@g oii gmx@ch (sibyiie@stoeckii m@iii@g oii gmx@ch)
Date: Sun, 11 Aug 2024 18:10:12 +0200
Subject: [R] geom_smooth with sd
Message-ID: <00da01daec08$f2781360$d7683a20$@gmx.ch>

Dear community

 

Using after_stat() I was able to visualise ggplot with standard deviations
instead of a confidence interval as seen in the R help.

 

p1<-ggplot(data = MS1, aes(x= Jahr, y= QI_A,color=Bio, linetype=Bio)) + 

                geom_smooth(aes(fill=Bio,
ymax=after_stat(y+se*sqrt(length(y))), ymin=after_stat(y-se*sqrt(y))) ,
method = "lm" , formula = y ~ x + I(x^2),linewidth=1) +

                theme(panel.background = element_blank())+

                theme(axis.line = element_line(colour = "black"))+

  theme(axis.text=element_text(size=18))+

  theme(axis.title=element_text(size=20))+

                ylab("Anteil BFF an LN [%]") +xlab("Jahr")+

  scale_color_manual(values=c("red","darkgreen"), labels=c("?LN", "BIO"))+

  scale_fill_manual(values=c("red","darkgreen"), labels= c("?LN", "BIO"))+

                theme(legend.title = element_blank())+

  theme(legend.text=element_text(size=20))+

  scale_linetype_manual(values=c("dashed", "solid"), labels=c("?LN", "BIO"))

p1<-p1 + expand_limits(y=c(0, 30))

 

When comparing the plots to the simple statistics the standard deviation do
not match. I assume it is because of the na.rm=TRUE which does not match
length(y) in the  after_stat code. However I was not able to adapt the code
using NA values?

 

Simple statistics

> mean(MS2020[MS2020$Bio=="1",]$QI_A, na.rm=TRUE)

[1] 26.81225

> sd(MS2020[MS2020$Bio=="1",]$QI_A, na.rm=TRUE)

[1] 21.12419

> mean(MS2020[MS2020$Bio=="0",]$QI_A, na.rm=TRUE)

[1] 15.86196

> sd(MS2020[MS2020$Bio=="0",]$QI_A, na.rm=TRUE)

[1] 15.00405

 

Kind regards

Sibylle


	[[alternative HTML version deleted]]


From er|nm@hodge@@ @end|ng |rom gm@||@com  Sun Aug 11 18:30:08 2024
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Sun, 11 Aug 2024 10:30:08 -0600
Subject: [R] geom_smooth with sd
In-Reply-To: <00da01daec08$f2781360$d7683a20$@gmx.ch>
References: <00da01daec08$f2781360$d7683a20$@gmx.ch>
Message-ID: <CACxE24koJwoTpWCfK-jjM7SgS3C4FhNKYEBWEXcV6vvmXJrz0A@mail.gmail.com>

Hi!

This is probably completely off base, but your ymin and y max setup lines
are different.  One uses sqrt(y), while the second uses sqrt(length(y)).

Could that play a part, please?

Thank you


Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com


On Sun, Aug 11, 2024 at 10:10?AM SIBYLLE ST?CKLI via R-help <
r-help at r-project.org> wrote:

> Dear community
>
>
>
> Using after_stat() I was able to visualise ggplot with standard deviations
> instead of a confidence interval as seen in the R help.
>
>
>
> p1<-ggplot(data = MS1, aes(x= Jahr, y= QI_A,color=Bio, linetype=Bio)) +
>
>                 geom_smooth(aes(fill=Bio,
> ymax=after_stat(y+se*sqrt(length(y))), ymin=after_stat(y-se*sqrt(y))) ,
> method = "lm" , formula = y ~ x + I(x^2),linewidth=1) +
>
>                 theme(panel.background = element_blank())+
>
>                 theme(axis.line = element_line(colour = "black"))+
>
>   theme(axis.text=element_text(size=18))+
>
>   theme(axis.title=element_text(size=20))+
>
>                 ylab("Anteil BFF an LN [%]") +xlab("Jahr")+
>
>   scale_color_manual(values=c("red","darkgreen"), labels=c("?LN", "BIO"))+
>
>   scale_fill_manual(values=c("red","darkgreen"), labels= c("?LN", "BIO"))+
>
>                 theme(legend.title = element_blank())+
>
>   theme(legend.text=element_text(size=20))+
>
>   scale_linetype_manual(values=c("dashed", "solid"), labels=c("?LN",
> "BIO"))
>
> p1<-p1 + expand_limits(y=c(0, 30))
>
>
>
> When comparing the plots to the simple statistics the standard deviation do
> not match. I assume it is because of the na.rm=TRUE which does not match
> length(y) in the  after_stat code. However I was not able to adapt the code
> using NA values?
>
>
>
> Simple statistics
>
> > mean(MS2020[MS2020$Bio=="1",]$QI_A, na.rm=TRUE)
>
> [1] 26.81225
>
> > sd(MS2020[MS2020$Bio=="1",]$QI_A, na.rm=TRUE)
>
> [1] 21.12419
>
> > mean(MS2020[MS2020$Bio=="0",]$QI_A, na.rm=TRUE)
>
> [1] 15.86196
>
> > sd(MS2020[MS2020$Bio=="0",]$QI_A, na.rm=TRUE)
>
> [1] 15.00405
>
>
>
> Kind regards
>
> Sibylle
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From sibyiie@stoeckii m@iii@g oii gmx@ch  Sun Aug 11 18:40:43 2024
From: sibyiie@stoeckii m@iii@g oii gmx@ch (sibyiie@stoeckii m@iii@g oii gmx@ch)
Date: Sun, 11 Aug 2024 18:40:43 +0200
Subject: [R] geom_smooth with sd
In-Reply-To: <CACxE24koJwoTpWCfK-jjM7SgS3C4FhNKYEBWEXcV6vvmXJrz0A@mail.gmail.com>
References: <00da01daec08$f2781360$d7683a20$@gmx.ch>
 <CACxE24koJwoTpWCfK-jjM7SgS3C4FhNKYEBWEXcV6vvmXJrz0A@mail.gmail.com>
Message-ID: <010001daec0d$35946aa0$a0bd3fe0$@gmx.ch>

Thanks Erin

 

Quite relevant. Yes now +sd and -sd are the same values. However they are about +/- 5 and not the values received by the simple code here. I still think it is as the length of y differs.

 

Simple statistics

> mean(MS2020[MS2020$Bio=="1",]$QI_A, na.rm=TRUE)

[1] 26.81225

> sd(MS2020[MS2020$Bio=="1",]$QI_A, na.rm=TRUE)

[1] 21.12419

> mean(MS2020[MS2020$Bio=="0",]$QI_A, na.rm=TRUE)

[1] 15.86196

> sd(MS2020[MS2020$Bio=="0",]$QI_A, na.rm=TRUE)

[1] 15.00405



Kind regards

Sibylle 

 

 

 

From: Erin Hodgess <erinm.hodgess at gmail.com> 
Sent: Sunday, August 11, 2024 6:30 PM
To: sibylle.stoeckli at gmx.ch
Cc: R-help at r-project.org
Subject: Re: [R] geom_smooth with sd

 

Hi!

 

This is probably completely off base, but your ymin and y max setup lines are different.  One uses sqrt(y), while the second uses sqrt(length(y)).

 

Could that play a part, please?

 

Thank you






Erin Hodgess, PhD

mailto: erinm.hodgess at gmail.com <mailto:erinm.hodgess at gmail.com> 

 

 

On Sun, Aug 11, 2024 at 10:10?AM SIBYLLE ST?CKLI via R-help <r-help at r-project.org <mailto:r-help at r-project.org> > wrote:

Dear community



Using after_stat() I was able to visualise ggplot with standard deviations
instead of a confidence interval as seen in the R help.



p1<-ggplot(data = MS1, aes(x= Jahr, y= QI_A,color=Bio, linetype=Bio)) + 

                geom_smooth(aes(fill=Bio,
ymax=after_stat(y+se*sqrt(length(y))), ymin=after_stat(y-se*sqrt(y))) ,
method = "lm" , formula = y ~ x + I(x^2),linewidth=1) +

                theme(panel.background = element_blank())+

                theme(axis.line = element_line(colour = "black"))+

  theme(axis.text=element_text(size=18))+

  theme(axis.title=element_text(size=20))+

                ylab("Anteil BFF an LN [%]") +xlab("Jahr")+

  scale_color_manual(values=c("red","darkgreen"), labels=c("?LN", "BIO"))+

  scale_fill_manual(values=c("red","darkgreen"), labels= c("?LN", "BIO"))+

                theme(legend.title = element_blank())+

  theme(legend.text=element_text(size=20))+

  scale_linetype_manual(values=c("dashed", "solid"), labels=c("?LN", "BIO"))

p1<-p1 + expand_limits(y=c(0, 30))



When comparing the plots to the simple statistics the standard deviation do
not match. I assume it is because of the na.rm=TRUE which does not match
length(y) in the  after_stat code. However I was not able to adapt the code
using NA values?



Simple statistics

> mean(MS2020[MS2020$Bio=="1",]$QI_A, na.rm=TRUE)

[1] 26.81225

> sd(MS2020[MS2020$Bio=="1",]$QI_A, na.rm=TRUE)

[1] 21.12419

> mean(MS2020[MS2020$Bio=="0",]$QI_A, na.rm=TRUE)

[1] 15.86196

> sd(MS2020[MS2020$Bio=="0",]$QI_A, na.rm=TRUE)

[1] 15.00405



Kind regards

Sibylle


        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org <mailto:R-help at r-project.org>  mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


	[[alternative HTML version deleted]]


From er|nm@hodge@@ @end|ng |rom gm@||@com  Mon Aug 12 22:11:32 2024
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Mon, 12 Aug 2024 14:11:32 -0600
Subject: [R] Determining the Correct Help List
Message-ID: <CACxE24no3Ct=Ebm2=qAVb27TEE9btCwDeHXkQfCOizVLw1QrhA@mail.gmail.com>

Hello everyone:

I have a few questions about using rgl, lattice, and latticeExtra.

I was searching for the correct list to post these to.

I saw r-sig-gR, but that seems to be more directed to graphical models
rather than graphing.

Any suggestions much appreciated.

Sincerely,
Erin

Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Mon Aug 12 22:15:31 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 12 Aug 2024 13:15:31 -0700
Subject: [R] Determining the Correct Help List
In-Reply-To: <CACxE24no3Ct=Ebm2=qAVb27TEE9btCwDeHXkQfCOizVLw1QrhA@mail.gmail.com>
References: <CACxE24no3Ct=Ebm2=qAVb27TEE9btCwDeHXkQfCOizVLw1QrhA@mail.gmail.com>
Message-ID: <CAGxFJbSRk9MoyrkALM1sQjUo1O2fA6O8u7LJU4am_68D_XfA5Q@mail.gmail.com>

As lattice is a core R package, I'd say right here, R-Help.

-- Bert

On Mon, Aug 12, 2024 at 1:07?PM Erin Hodgess <erinm.hodgess at gmail.com> wrote:
>
> Hello everyone:
>
> I have a few questions about using rgl, lattice, and latticeExtra.
>
> I was searching for the correct list to post these to.
>
> I saw r-sig-gR, but that seems to be more directed to graphical models
> rather than graphing.
>
> Any suggestions much appreciated.
>
> Sincerely,
> Erin
>
> Erin Hodgess, PhD
> mailto: erinm.hodgess at gmail.com
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bbo|ker @end|ng |rom gm@||@com  Mon Aug 12 22:20:55 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Mon, 12 Aug 2024 16:20:55 -0400
Subject: [R] Determining the Correct Help List
In-Reply-To: <CAGxFJbSRk9MoyrkALM1sQjUo1O2fA6O8u7LJU4am_68D_XfA5Q@mail.gmail.com>
References: <CACxE24no3Ct=Ebm2=qAVb27TEE9btCwDeHXkQfCOizVLw1QrhA@mail.gmail.com>
 <CAGxFJbSRk9MoyrkALM1sQjUo1O2fA6O8u7LJU4am_68D_XfA5Q@mail.gmail.com>
Message-ID: <7e37c76d-9926-4bd9-9e31-f2504df0f02c@gmail.com>

   And the author & maintainer of rgl is pretty active here too ...

On 2024-08-12 4:15 p.m., Bert Gunter wrote:
> As lattice is a core R package, I'd say right here, R-Help.
> 
> -- Bert
> 
> On Mon, Aug 12, 2024 at 1:07?PM Erin Hodgess <erinm.hodgess at gmail.com> wrote:
>>
>> Hello everyone:
>>
>> I have a few questions about using rgl, lattice, and latticeExtra.
>>
>> I was searching for the correct list to post these to.
>>
>> I saw r-sig-gR, but that seems to be more directed to graphical models
>> rather than graphing.
>>
>> Any suggestions much appreciated.
>>
>> Sincerely,
>> Erin
>>
>> Erin Hodgess, PhD
>> mailto: erinm.hodgess at gmail.com
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Aug 13 00:02:10 2024
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 12 Aug 2024 18:02:10 -0400
Subject: [R] Determining the Correct Help List
In-Reply-To: <CACxE24no3Ct=Ebm2=qAVb27TEE9btCwDeHXkQfCOizVLw1QrhA@mail.gmail.com>
References: <CACxE24no3Ct=Ebm2=qAVb27TEE9btCwDeHXkQfCOizVLw1QrhA@mail.gmail.com>
Message-ID: <71197548-2c03-4552-9d38-079dd7805a0a@gmail.com>

rgl is probably not appropriate on any of the R mailing lists.  You
could post as an issue on its Github page, or as a question on
StackOverflow.

Duncan Murdoch


From er|nm@hodge@@ @end|ng |rom gm@||@com  Tue Aug 13 00:57:08 2024
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Mon, 12 Aug 2024 16:57:08 -0600
Subject: [R] Determining the Correct Help List
In-Reply-To: <71197548-2c03-4552-9d38-079dd7805a0a@gmail.com>
References: <CACxE24no3Ct=Ebm2=qAVb27TEE9btCwDeHXkQfCOizVLw1QrhA@mail.gmail.com>
 <71197548-2c03-4552-9d38-079dd7805a0a@gmail.com>
Message-ID: <CACxE24kruBP9CaeT49eZO0Oo5fj+yfw7EBoYtT6bhVseFQh6Mg@mail.gmail.com>

Great, thank you for your help.

Sincerely,
Erin

Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com


On Mon, Aug 12, 2024 at 4:09?PM Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> rgl is probably not appropriate on any of the R mailing lists.  You
> could post as an issue on its Github page, or as a question on
> StackOverflow.
>
> Duncan Murdoch
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From |zm|r||g @end|ng |rom m@||@n|h@gov  Thu Aug 15 20:39:45 2024
From: |zm|r||g @end|ng |rom m@||@n|h@gov (Izmirlian, Grant (NIH/NCI) [E])
Date: Thu, 15 Aug 2024 18:39:45 +0000
Subject: [R] Very strange behavior of 'rep'
Message-ID: <SA0PR09MB6955F205F5AA3AAE5A9E4AB2E5802@SA0PR09MB6955.namprd09.prod.outlook.com>

\n<<SEND AS PLAIN TEXT!>>\n\n \n<<
This is very weird. I was running a swarm job on the cluster and it bombed
only for n.per.grp=108, not for the other values. Even though
n.per.grp*n.tt is 540, so that the length of the call to 'rep'
should be 1080, I'm getting a vector of length 1078.
    n.per.grp <- 108
    n.tt <- 5
    n.per.grp*n.tt
    length(rep(0:1, each=n.per.grp*n.tt))
    length(rep(0:1, each=108*5))
>> \n<<Grant Izmirlian grant.izmirlian at nih dot gov>>\n\n\n\n
--please do not edit the information below--

R Version:
 platform = x86_64-pc-linux-gnu
 arch = x86_64
 os = linux-gnu
 system = x86_64, linux-gnu
 status =
 major = 4
 minor = 4.1
 year = 2024
 month = 06
 day = 14
 svn rev = 86737
 language = R
 version.string = R version 4.4.1 (2024-06-14)
 nickname = Race for Your Life

Locale:
 LC_CTYPE=C.UTF-8;LC_NUMERIC=C;LC_TIME=C.UTF-8;LC_COLLATE=C.UTF-8;LC_MONETARY=C.UTF-8;LC_MESSAGES=C.UTF-8;LC_PAPER=C.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=C.UTF-8;LC_IDENTIFICATION=C

Search Path:
 .GlobalEnv, package:lme4, package:Matrix, package:stats,
 package:graphics, package:grDevices, package:utils, package:datasets,
 package:showtext, package:showtextdb, package:sysfonts,
 package:methods, Autoloads, package:base

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Aug 15 20:51:56 2024
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 15 Aug 2024 19:51:56 +0100
Subject: [R] Very strange behavior of 'rep'
In-Reply-To: <SA0PR09MB6955F205F5AA3AAE5A9E4AB2E5802@SA0PR09MB6955.namprd09.prod.outlook.com>
References: <SA0PR09MB6955F205F5AA3AAE5A9E4AB2E5802@SA0PR09MB6955.namprd09.prod.outlook.com>
Message-ID: <fe8bd4c9-e3f0-44c4-a528-838c823419ba@sapo.pt>

?s 19:39 de 15/08/2024, Izmirlian, Grant (NIH/NCI) [E] via R-help escreveu:
> \n<<SEND AS PLAIN TEXT!>>\n\n \n<<
> This is very weird. I was running a swarm job on the cluster and it bombed
> only for n.per.grp=108, not for the other values. Even though
> n.per.grp*n.tt is 540, so that the length of the call to 'rep'
> should be 1080, I'm getting a vector of length 1078.
>      n.per.grp <- 108
>      n.tt <- 5
>      n.per.grp*n.tt
>      length(rep(0:1, each=n.per.grp*n.tt))
>      length(rep(0:1, each=108*5))
>>> \n<<Grant Izmirlian grant.izmirlian at nih dot gov>>\n\n\n\n
> --please do not edit the information below--
> 
> R Version:
>   platform = x86_64-pc-linux-gnu
>   arch = x86_64
>   os = linux-gnu
>   system = x86_64, linux-gnu
>   status =
>   major = 4
>   minor = 4.1
>   year = 2024
>   month = 06
>   day = 14
>   svn rev = 86737
>   language = R
>   version.string = R version 4.4.1 (2024-06-14)
>   nickname = Race for Your Life
> 
> Locale:
>   LC_CTYPE=C.UTF-8;LC_NUMERIC=C;LC_TIME=C.UTF-8;LC_COLLATE=C.UTF-8;LC_MONETARY=C.UTF-8;LC_MESSAGES=C.UTF-8;LC_PAPER=C.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=C.UTF-8;LC_IDENTIFICATION=C
> 
> Search Path:
>   .GlobalEnv, package:lme4, package:Matrix, package:stats,
>   package:graphics, package:grDevices, package:utils, package:datasets,
>   package:showtext, package:showtextdb, package:sysfonts,
>   package:methods, Autoloads, package:base
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

I cannot reproduce this behavior.



n.per.grp <- 108
n.tt <- 5
n.per.grp*n.tt
#> [1] 540
length(rep(0:1, each = n.per.grp*n.tt))
#> [1] 1080
length(rep(0:1, each = 108*5))
#> [1] 1080



But my version of R and my OS are different.
(I don't see how the error in the OP can be related to R version or OS.)



R.version
#>                _
#> platform       x86_64-w64-mingw32
#> arch           x86_64
#> os             mingw32
#> crt            ucrt
#> system         x86_64, mingw32
#> status
#> major          4
#> minor          4.1
#> year           2024
#> month          06
#> day            14
#> svn rev        86737
#> language       R
#> version.string R version 4.4.1 (2024-06-14 ucrt)
#> nickname       Race for Your Life



Hope this helps,

Rui Barradas


-- 
Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.
www.avg.com


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Aug 15 20:59:51 2024
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 15 Aug 2024 14:59:51 -0400
Subject: [R] Very strange behavior of 'rep'
In-Reply-To: <SA0PR09MB6955F205F5AA3AAE5A9E4AB2E5802@SA0PR09MB6955.namprd09.prod.outlook.com>
References: <SA0PR09MB6955F205F5AA3AAE5A9E4AB2E5802@SA0PR09MB6955.namprd09.prod.outlook.com>
Message-ID: <7b1ab81b-fd8b-460b-8085-438de6db8279@gmail.com>

I also can't reproduce this.  I'd guess that one of your values of 
n.per.grp or n.tt only prints as the values you showed, but is actually 
a little smaller.  For example,

n.per.grp <- 108 - 1.e-14
n.per.grp
#> [1] 108
n.tt <- 5
n.per.grp*n.tt
#> [1] 540
length(rep(0:1, each=n.per.grp*n.tt))
#> [1] 1078

Duncan Murdoch


<sup>Created on 2024-08-15 with [reprex 
v2.1.1](https://reprex.tidyverse.org)</sup>

On 2024-08-15 2:39 p.m., Izmirlian, Grant (NIH/NCI) [E] via R-help wrote:
> \n<<SEND AS PLAIN TEXT!>>\n\n \n<<
> This is very weird. I was running a swarm job on the cluster and it bombed
> only for n.per.grp=108, not for the other values. Even though
> n.per.grp*n.tt is 540, so that the length of the call to 'rep'
> should be 1080, I'm getting a vector of length 1078.
>      n.per.grp <- 108
>      n.tt <- 5
>      n.per.grp*n.tt
>      length(rep(0:1, each=n.per.grp*n.tt))
>      length(rep(0:1, each=108*5))
>>> \n<<Grant Izmirlian grant.izmirlian at nih dot gov>>\n\n\n\n
> --please do not edit the information below--
> 
> R Version:
>   platform = x86_64-pc-linux-gnu
>   arch = x86_64
>   os = linux-gnu
>   system = x86_64, linux-gnu
>   status =
>   major = 4
>   minor = 4.1
>   year = 2024
>   month = 06
>   day = 14
>   svn rev = 86737
>   language = R
>   version.string = R version 4.4.1 (2024-06-14)
>   nickname = Race for Your Life
> 
> Locale:
>   LC_CTYPE=C.UTF-8;LC_NUMERIC=C;LC_TIME=C.UTF-8;LC_COLLATE=C.UTF-8;LC_MONETARY=C.UTF-8;LC_MESSAGES=C.UTF-8;LC_PAPER=C.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=C.UTF-8;LC_IDENTIFICATION=C
> 
> Search Path:
>   .GlobalEnv, package:lme4, package:Matrix, package:stats,
>   package:graphics, package:grDevices, package:utils, package:datasets,
>   package:showtext, package:showtextdb, package:sysfonts,
>   package:methods, Autoloads, package:base
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From |zm|r||g @end|ng |rom m@||@n|h@gov  Thu Aug 15 21:00:32 2024
From: |zm|r||g @end|ng |rom m@||@n|h@gov (Izmirlian, Grant (NIH/NCI) [E])
Date: Thu, 15 Aug 2024 19:00:32 +0000
Subject: [R] [EXTERNAL] Re:  Very strange behavior of 'rep'
In-Reply-To: <fe8bd4c9-e3f0-44c4-a528-838c823419ba@sapo.pt>
References: <SA0PR09MB6955F205F5AA3AAE5A9E4AB2E5802@SA0PR09MB6955.namprd09.prod.outlook.com>
 <fe8bd4c9-e3f0-44c4-a528-838c823419ba@sapo.pt>
Message-ID: <SA0PR09MB69553D28027A131BB6B8544BE5802@SA0PR09MB6955.namprd09.prod.outlook.com>

Ok ? to be fair, it looks like I need to load everything and reproduce exactly as its occuring. I suspect its a weird memory hole in one of the loaded packages.

Here ? this should do it.


"%,%" <- paste0

"factorial.design" <-
function(...)
{
  m <- match.call()
  cc <- m
  cc[[1]] <- as.name("c")
  arg.vals <- eval(cc, sys.parent())
  n.args <- length(arg.vals)

  n.l <- 0
  n.r <- n.args-1
  fwd.cpd <- c(1, cumprod(arg.vals))
  rev.cpd <- c(cumprod(arg.vals[n.args:2])[(n.args-1):1],1)
  "%,%" <- paste0
  main.call <- as.call(expression(cbind))
  for(k in 1:n.args)
  {
      arg.k <- eval(m[[1+k]], sys.parent())
      rep.call <- as.call(expression(rep))
      rep.call$x <- 1:arg.k
      if(n.l>0) rep.call$times <- fwd.cpd[k]
      if(n.r>0) rep.call$each <- rev.cpd[k]
      main.call[["x" %,% k]] <- rep.call
      n.l <- n.l + 1
      n.r <- n.r - 1
  }
  eval(main.call)
}

add.zeros <-
function(x,B)
{
    do.one <- function(x,B)
    {
      delta <- floor(logb(B, 10)) - floor(logb(x, 10))
      z <- ""
      if(delta > 0) z <- paste(rep("0", delta), collapse="")
      z%,%x
    }
    if(length(x)==1) ans <- do.one(x,B)
    if(length(x)>1) ans <- sapply(x, FUN=do.one, B=B)
    ans
}

library(lme4)

rho.ICC <- 0.5
s2.b <- 0.5*rho.ICC/(1-rho.ICC)
s2.e <- 0.5
delta <- 0.27

n.per.grp.lst <- (264/2*(1-450/9900*(5:0)))

## I will different values of 'h' and at these contrasts as well as flat
## I want to compare the AUC approach with just the test of the main effects constant arm coefficient

tt.seq <- c(0,3,6,12,18)
n.tt <- length(tt.seq)
cntr <- c(0.5,1,1,1,0.5)


## (delta1 + 2*delta2 + 2*delta3 + 2*delta4 + delta5)/2 = 0.27
## delta1 + 2*delta2 + 2*delta3 + 2*delta4 + delta5 = 2*0.27
## (delta1 + 2*delta2 + 2*delta3 + 2*delta4 + delta5)/8 = 2*0.27/8 = 0.27/4

H <- 0.08+0.005*(0:6)
shapes <- list(INC= (-floor(n.tt/2)):floor(n.tt/2),
               DEC= floor(n.tt/2):(-floor(n.tt/2)),
               FLT= rep(0,n.tt),
               PLT= c(-floor(n.tt/2):0,rep(floor(n.tt/2)+1, n.tt-floor(n.tt/2)-1)))
trnds <- names(shapes)

delta0.j <- rep(5, n.tt)

n.n.lst <- length(n.per.grp.lst)
n.trnds <- length(trnds)
n.H <- length(H)

## We're swarming over conditions. It works like this. This is the
## full list of conditions as a factorial design list. You have to
## determine the total number of conditions and then set up that many
## directories in the swarm folder
conds <- factorial.design(n.n.lst, n.trnds, n.H)

## currently with n.n.lst=6, n.trnds=4, n.H=7 that gives
## length(conds)=6x4x7=168

## then one copy of this file sits in each of the subdirectories.
## Parameters for this run are determined by getting the subdirectory
## number and then pulling the parameter indices from that element
## in the factorial design.
node <- 29

n.per.grp <- n.per.grp.lst[conds[node, 1]]
trnd <- trnds[conds[node, 2]]
h <- H[conds[node, 3]]

delta.j <- delta + h*shapes[[trnd]]

## covariates:
ID.i <- c(outer(rep(1:n.per.grp,each=n.tt),c(0,n.per.grp),FUN="+"))
arm.i <- rep(0:1, each=n.per.grp*n.tt)

length(arm.i)

________________________________
From: Rui Barradas <ruipbarradas at sapo.pt>
Sent: Thursday, August 15, 2024 2:51 PM
To: Izmirlian, Grant (NIH/NCI) [E] <izmirlig at mail.nih.gov>; r-help at r-project.org <r-help at r-project.org>
Subject: [EXTERNAL] Re: [R] Very strange behavior of 'rep'

?s 19:39 de 15/08/2024, Izmirlian, Grant (NIH/NCI) [E] via R-help escreveu:
> \n<<SEND AS PLAIN TEXT!>>\n\n \n<<
> This is very weird. I was running a swarm job on the cluster and it bombed
> only for n.per.grp=108, not for the other values. Even though
> n.per.grp*n.tt is 540, so that the length of the call to 'rep'
> should be 1080, I'm getting a vector of length 1078.
>      n.per.grp <- 108
>      n.tt <- 5
>      n.per.grp*n.tt
>      length(rep(0:1, each=n.per.grp*n.tt))
>      length(rep(0:1, each=108*5))
>>> \n<<Grant Izmirlian grant.izmirlian at nih dot gov>>\n\n\n\n
> --please do not edit the information below--
>
> R Version:
>   platform = x86_64-pc-linux-gnu
>   arch = x86_64
>   os = linux-gnu
>   system = x86_64, linux-gnu
>   status =
>   major = 4
>   minor = 4.1
>   year = 2024
>   month = 06
>   day = 14
>   svn rev = 86737
>   language = R
>   version.string = R version 4.4.1 (2024-06-14)
>   nickname = Race for Your Life
>
> Locale:
>   LC_CTYPE=C.UTF-8;LC_NUMERIC=C;LC_TIME=C.UTF-8;LC_COLLATE=C.UTF-8;LC_MONETARY=C.UTF-8;LC_MESSAGES=C.UTF-8;LC_PAPER=C.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=C.UTF-8;LC_IDENTIFICATION=C
>
> Search Path:
>   .GlobalEnv, package:lme4, package:Matrix, package:stats,
>   package:graphics, package:grDevices, package:utils, package:datasets,
>   package:showtext, package:showtextdb, package:sysfonts,
>   package:methods, Autoloads, package:base
>
>       [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&data=05%7C02%7Cizmirlig%40mail.nih.gov%7C4e8285dc4d984018750208dcbd5b9586%7C14b77578977342d58507251ca2dc2b06%7C0%7C0%7C638593448252923470%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=ERmJnji4cVBWI36ESgUcMPY5E52l%2FTrb%2BF4s%2F1gGSVg%3D&reserved=0<https://stat.ethz.ch/mailman/listinfo/r-help>
> PLEASE do read the posting guide https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&data=05%7C02%7Cizmirlig%40mail.nih.gov%7C4e8285dc4d984018750208dcbd5b9586%7C14b77578977342d58507251ca2dc2b06%7C0%7C0%7C638593448252932192%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=UXsJuXSKTRbYPwcPnTwKQeARyE6AksBsXwNq4NICJGw%3D&reserved=0<http://www.r-project.org/posting-guide.html>
> and provide commented, minimal, self-contained, reproducible code.
Hello,

I cannot reproduce this behavior.



n.per.grp <- 108
n.tt <- 5
n.per.grp*n.tt
#> [1] 540
length(rep(0:1, each = n.per.grp*n.tt))
#> [1] 1080
length(rep(0:1, each = 108*5))
#> [1] 1080



But my version of R and my OS are different.
(I don't see how the error in the OP can be related to R version or OS.)



R.version
#>                _
#> platform       x86_64-w64-mingw32
#> arch           x86_64
#> os             mingw32
#> crt            ucrt
#> system         x86_64, mingw32
#> status
#> major          4
#> minor          4.1
#> year           2024
#> month          06
#> day            14
#> svn rev        86737
#> language       R
#> version.string R version 4.4.1 (2024-06-14 ucrt)
#> nickname       Race for Your Life



Hope this helps,

Rui Barradas


--
Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.
https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.avg.com%2F&data=05%7C02%7Cizmirlig%40mail.nih.gov%7C4e8285dc4d984018750208dcbd5b9586%7C14b77578977342d58507251ca2dc2b06%7C0%7C0%7C638593448252937455%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=wlmoS3S2xNYFV9E%2FlVjvKw1XGhSQjx3KoQjgOBwNp4I%3D&reserved=0<http://www.avg.com/>
CAUTION: This email originated from outside of the organization. Do not click links or open attachments unless you recognize the sender and are confident the content is safe.


	[[alternative HTML version deleted]]


From sibyiie@stoeckii m@iii@g oii gmx@ch  Thu Aug 15 11:50:53 2024
From: sibyiie@stoeckii m@iii@g oii gmx@ch (sibyiie@stoeckii m@iii@g oii gmx@ch)
Date: Thu, 15 Aug 2024 11:50:53 +0200
Subject: [R] geom_boxplot nocht=TRUE
Message-ID: <009501daeef8$9e95abc0$dbc10340$@gmx.ch>

Dear community

 

I tried to run my ggplot() +geom_boxplot() code using nocht=TRUE, but probably my term noch=TRUE is at the wrong position?

 

Error:

Error in `geom_boxplot()`:

! Problem while converting geom to grob.

? Error occurred in the 1st layer.

Caused by error in `ans[ypos] <- rep(yes, length.out = len)[ypos]`:

! replacement has length zero

Run `rlang::last_trace()` to see where the error occurred.

Warning message:

In rep(yes, length.out = len) : 'x' is NULL so the result will be NULL

> rlang::last_trace()

<error/rlang_error>

Error in `geom_boxplot()`:

! Problem while converting geom to grob.

? Error occurred in the 1st layer.

Caused by error in `ans[ypos] <- rep(yes, length.out = len)[ypos]`:

! replacement has length zero

---

Backtrace:

     ?

  1. ??base (local) `<fn>`(x)

  2. ??ggplot2:::print.ggplot(x)

  3.   ??ggplot2::ggplot_gtable(data)

  4.   ??ggplot2:::ggplot_gtable.ggplot_built(data)

  5.     ??ggplot2:::by_layer(...)

  6.       ??rlang::try_fetch(...)

  7.       ? ??base::tryCatch(...)

  8.       ? ? ??base (local) tryCatchList(expr, classes, parentenv, handlers)

  9.       ? ?   ??base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])

10.       ? ?     ??base (local) doTryCatch(return(expr), name, parentenv, handler)

11.       ? ??base::withCallingHandlers(...)

12.       ??ggplot2 (local) f(l = layers[[i]], d = data[[i]])

13.         ??l$draw_geom(d, layout)

14.           ??ggplot2 (local) draw_geom(..., self = self)

15.             ??self$geom$draw_layer(...)

16.               ??ggplot2 (local) draw_layer(..., self = self)

17.                 ??base::lapply(...)

18.                   ??ggplot2 (local) FUN(X[[i]], ...)

19.                     ??rlang::inject(self$draw_panel(data, panel_params, coord, !!!params))

20.                     ??self$draw_panel(...)

21.                       ??ggplot2 (local) draw_panel(..., self = self)

22.                         ??base::lapply(...)

23.                           ??ggplot2 (local) FUN(X[[i]], ...)

24.                             ??self$draw_group(group, panel_params, coord, ...)

25.                               ??ggplot2 (local) draw_group(..., self = self)

26.                                 ??ggplot2:::data_frame0(...)

27.                                 ? ??vctrs::data_frame(..., .name_repair = "minimal")

28.                                 ?   ??rlang::list2(...)

29.                                 ??base::ifelse(notch, data$notchlower, NA)

Run rlang::last_trace(drop = FALSE) to see 5 hidden frames.

 

 

 

 

Code:

 

MS1<- MS %>% filter(QI_A!="NA") %>% droplevels()

MS1$Jahr<-as.factor(MS1$Jahr)

 

MS1s <- MS1 %>%

  group_by(MS1$Jahr, MS1$Bio) %>%

  summarise(

    y0 = quantile(QI_A, 0.05),

    y25 = quantile(QI_A, 0.25),

    y50 = mean(QI_A),

    y75 = quantile(QI_A, 0.75),

    y100 = quantile(QI_A, 0.95))

 

MS1s

colnames(MS1s)[1]<-"Jahr"

colnames(MS1s)[2]<-"Bio"

MS1s

 

p1<-ggplot(MS1s, aes(Jahr,  fill = as.factor(Bio))) +

  geom_boxplot(

    aes(ymin = y0, lower = y25, middle = y50, upper = y75, ymax = y100),

    stat = "identity", notch=TRUE

  ) +

  theme(panel.background = element_blank())+

  theme(axis.line = element_line(colour = "black"))+

  theme(axis.text=element_text(size=18))+

  theme(axis.title=element_text(size=20))+

  ylab("Anteil BFF an LN [%]") +xlab("Jahr")+

  scale_color_manual(values=c("red","darkgreen"), labels=c("?LN", "BIO"))+

  scale_fill_manual(values=c("red","darkgreen"), labels= c("?LN", "BIO"))+

  theme(legend.title = element_blank())+

  theme(legend.text=element_text(size=20))

p1<-p1 + expand_limits(y=c(0, 80))

p1

 


	[[alternative HTML version deleted]]


From sibyiie@stoeckii m@iii@g oii gmx@ch  Thu Aug 15 15:14:06 2024
From: sibyiie@stoeckii m@iii@g oii gmx@ch (sibyiie@stoeckii m@iii@g oii gmx@ch)
Date: Thu, 15 Aug 2024 15:14:06 +0200
Subject: [R] allequal diff
Message-ID: <00f301daef15$02421d90$06c658b0$@gmx.ch>

Dear community



Similar to the example of the rdocumentation, my idea is to use all.equal
and to print the difference.

https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/all.equal



> d45 <- pi*(1/4 + 1:10)

> stopifnot(

+     all.equal(tan(d45), rep(1, 10)))          # TRUE, but

> all      (tan(d45) == rep(1, 10))         # FALSE, since not exactly

[1] FALSE

> all.equal(tan(d45), rep(1, 10), tolerance = 0)  # to see difference

[1] "Mean relative difference: 1.29526e-15"

>



Unfortunately, I just get "FALSE" not the difference.

> r2_resampled <- resample(r2, r1)

> compareRaster(r1, r2_resampled)

[1] TRUE

> # Compare rasters

> result <- all.equal(r1, r2_resampled)

Warning message:

In compareRaster(target, current, ..., values = values, stopiffalse =
stopiffalse,  :

  not all objects have the same values

> print(result)

[1] FALSE

>



Kind regards

Sibylle


	[[alternative HTML version deleted]]


From |zm|r||g @end|ng |rom m@||@n|h@gov  Thu Aug 15 22:32:33 2024
From: |zm|r||g @end|ng |rom m@||@n|h@gov (Izmirlian, Grant (NIH/NCI) [E])
Date: Thu, 15 Aug 2024 20:32:33 +0000
Subject: [R] [EXTERNAL] Re:  Very strange behavior of 'rep'
In-Reply-To: <7b1ab81b-fd8b-460b-8085-438de6db8279@gmail.com>
References: <SA0PR09MB6955F205F5AA3AAE5A9E4AB2E5802@SA0PR09MB6955.namprd09.prod.outlook.com>
 <7b1ab81b-fd8b-460b-8085-438de6db8279@gmail.com>
Message-ID: <SA0PR09MB6955116A8C97BE8E679DE8B2E5802@SA0PR09MB6955.namprd09.prod.outlook.com>

Its where n.per.grp is first calculated. I rounded. Gosh do I feel stupid. Thanks to all who weighed in.
Best Regards,
Grant Izmirlian

________________________________
From: Duncan Murdoch <murdoch.duncan at gmail.com>
Sent: Thursday, August 15, 2024 2:59 PM
To: Izmirlian, Grant (NIH/NCI) [E] <izmirlig at mail.nih.gov>; r-help at r-project.org <r-help at r-project.org>
Subject: [EXTERNAL] Re: [R] Very strange behavior of 'rep'

I also can't reproduce this.  I'd guess that one of your values of
n.per.grp or n.tt only prints as the values you showed, but is actually
a little smaller.  For example,

n.per.grp <- 108 - 1.e-14
n.per.grp
#> [1] 108
n.tt <- 5
n.per.grp*n.tt
#> [1] 540
length(rep(0:1, each=n.per.grp*n.tt))
#> [1] 1078

Duncan Murdoch


<sup>Created on 2024-08-15 with [reprex
v2.1.1](https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Freprex.tidyverse.org%2F&data=05%7C02%7Cizmirlig%40mail.nih.gov%7C39d45a0a10d54c446ce808dcbd5c7518%7C14b77578977342d58507251ca2dc2b06%7C0%7C0%7C638593452006022388%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=ZZDiaJt2vEAejBTdsfyxaFtwYs8WBWgeIXVzUvN4%2BHI%3D&reserved=0)</sup<https://reprex.tidyverse.org/>>

On 2024-08-15 2:39 p.m., Izmirlian, Grant (NIH/NCI) [E] via R-help wrote:
> \n<<SEND AS PLAIN TEXT!>>\n\n \n<<
> This is very weird. I was running a swarm job on the cluster and it bombed
> only for n.per.grp=108, not for the other values. Even though
> n.per.grp*n.tt is 540, so that the length of the call to 'rep'
> should be 1080, I'm getting a vector of length 1078.
>      n.per.grp <- 108
>      n.tt <- 5
>      n.per.grp*n.tt
>      length(rep(0:1, each=n.per.grp*n.tt))
>      length(rep(0:1, each=108*5))
>>> \n<<Grant Izmirlian grant.izmirlian at nih dot gov>>\n\n\n\n
> --please do not edit the information below--
>
> R Version:
>   platform = x86_64-pc-linux-gnu
>   arch = x86_64
>   os = linux-gnu
>   system = x86_64, linux-gnu
>   status =
>   major = 4
>   minor = 4.1
>   year = 2024
>   month = 06
>   day = 14
>   svn rev = 86737
>   language = R
>   version.string = R version 4.4.1 (2024-06-14)
>   nickname = Race for Your Life
>
> Locale:
>   LC_CTYPE=C.UTF-8;LC_NUMERIC=C;LC_TIME=C.UTF-8;LC_COLLATE=C.UTF-8;LC_MONETARY=C.UTF-8;LC_MESSAGES=C.UTF-8;LC_PAPER=C.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=C.UTF-8;LC_IDENTIFICATION=C
>
> Search Path:
>   .GlobalEnv, package:lme4, package:Matrix, package:stats,
>   package:graphics, package:grDevices, package:utils, package:datasets,
>   package:showtext, package:showtextdb, package:sysfonts,
>   package:methods, Autoloads, package:base
>
>       [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&data=05%7C02%7Cizmirlig%40mail.nih.gov%7C39d45a0a10d54c446ce808dcbd5c7518%7C14b77578977342d58507251ca2dc2b06%7C0%7C0%7C638593452006031043%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=LTp63hQ5fGXMg1K3QmkjLq1NRVQv22v7JH5AIn8AFWA%3D&reserved=0<https://stat.ethz.ch/mailman/listinfo/r-help>
> PLEASE do read the posting guide https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&data=05%7C02%7Cizmirlig%40mail.nih.gov%7C39d45a0a10d54c446ce808dcbd5c7518%7C14b77578977342d58507251ca2dc2b06%7C0%7C0%7C638593452006035637%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=OHU65ku0vmIiRInCbI7ep0QDRO5Xytat61CtBkYYMCM%3D&reserved=0<http://www.r-project.org/posting-guide.html>
> and provide commented, minimal, self-contained, reproducible code.

CAUTION: This email originated from outside of the organization. Do not click links or open attachments unless you recognize the sender and are confident the content is safe.


	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Fri Aug 16 01:06:27 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Thu, 15 Aug 2024 19:06:27 -0400
Subject: [R] allequal diff
In-Reply-To: <00f301daef15$02421d90$06c658b0$@gmx.ch>
References: <00f301daef15$02421d90$06c658b0$@gmx.ch>
Message-ID: <71c8c7ca-88fb-4cb8-a2ce-1bf032932b00@gmail.com>


   Digging into the code for raster::compareRaster():

library(raster)
r <- raster(ncol=3, nrow=3)
values(r) <- 1:ncell(r)
r2 <- r
values(r2) <- c(1:8,10)
all.equal(getValues(r), getValues(r2), tolerance = 0)
[1] "Mean relative difference: 0.1111111"

    compareRaster has fancier machinery internally for doing the 
comparison for large rasters a block at a time if everything can't fit 
in memory at the same time ...




On 2024-08-15 9:14 a.m., SIBYLLE ST?CKLI via R-help wrote:
> Dear community
> 
> 
> 
> Similar to the example of the rdocumentation, my idea is to use all.equal
> and to print the difference.
> 
> https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/all.equal
> 
> 
> 
>> d45 <- pi*(1/4 + 1:10)
> 
>> stopifnot(
> 
> +     all.equal(tan(d45), rep(1, 10)))          # TRUE, but
> 
>> all      (tan(d45) == rep(1, 10))         # FALSE, since not exactly
> 
> [1] FALSE
> 
>> all.equal(tan(d45), rep(1, 10), tolerance = 0)  # to see difference
> 
> [1] "Mean relative difference: 1.29526e-15"
> 
>>
> 
> 
> 
> Unfortunately, I just get "FALSE" not the difference.
> 
>> r2_resampled <- resample(r2, r1)
> 
>> compareRaster(r1, r2_resampled)
> 
> [1] TRUE
> 
>> # Compare rasters
> 
>> result <- all.equal(r1, r2_resampled)
> 
> Warning message:
> 
> In compareRaster(target, current, ..., values = values, stopiffalse =
> stopiffalse,  :
> 
>    not all objects have the same values
> 
>> print(result)
> 
> [1] FALSE
> 
>>
> 
> 
> 
> Kind regards
> 
> Sibylle
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From sibyiie@stoeckii m@iii@g oii gmx@ch  Fri Aug 16 07:19:38 2024
From: sibyiie@stoeckii m@iii@g oii gmx@ch (sibyiie@stoeckii m@iii@g oii gmx@ch)
Date: Fri, 16 Aug 2024 07:19:38 +0200
Subject: [R] allequal diff
In-Reply-To: <71c8c7ca-88fb-4cb8-a2ce-1bf032932b00@gmail.com>
References: <00f301daef15$02421d90$06c658b0$@gmx.ch>
 <71c8c7ca-88fb-4cb8-a2ce-1bf032932b00@gmail.com>
Message-ID: <013e01daef9b$e4363ca0$aca2b5e0$@gmx.ch>

Dear Ben

 

Many thanks.

I see that a second challenge are NA values. Is it possible to consider na.rm=TRUE?

 

> r2_resampled <- resample(r2, r1)

> compareRaster(r1, r2_resampled)

[1] TRUE

> 

> all.equal(getValues(r1), getValues(r2_resampled), tolerance = 0)

[1] "'is.NA' value mismatch: 9544032 in current 66532795 in target"

 

Kind regards

Sibylle 

 

 

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Ben Bolker
Sent: Friday, August 16, 2024 1:06 AM
To: r-help at r-project.org
Subject: Re: [R] allequal diff

 

 

   Digging into the code for raster::compareRaster():

 

library(raster)

r <- raster(ncol=3, nrow=3)

values(r) <- 1:ncell(r)

r2 <- r

values(r2) <- c(1:8,10)

all.equal(getValues(r), getValues(r2), tolerance = 0) [1] "Mean relative difference: 0.1111111"

 

    compareRaster has fancier machinery internally for doing the comparison for large rasters a block at a time if everything can't fit in memory at the same time ...

 

 

 

 

On 2024-08-15 9:14 a.m., SIBYLLE ST?CKLI via R-help wrote:

> Dear community

> 

> 

> 

> Similar to the example of the rdocumentation, my idea is to use 

> all.equal and to print the difference.

> 

>  <https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/all> https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/all

> .equal

> 

> 

> 

>> d45 <- pi*(1/4 + 1:10)

> 

>> stopifnot(

> 

> +     all.equal(tan(d45), rep(1, 10)))          # TRUE, but

> 

>> all      (tan(d45) == rep(1, 10))         # FALSE, since not exactly

> 

> [1] FALSE

> 

>> all.equal(tan(d45), rep(1, 10), tolerance = 0)  # to see difference

> 

> [1] "Mean relative difference: 1.29526e-15"

> 

>> 

> 

> 

> 

> Unfortunately, I just get "FALSE" not the difference.

> 

>> r2_resampled <- resample(r2, r1)

> 

>> compareRaster(r1, r2_resampled)

> 

> [1] TRUE

> 

>> # Compare rasters

> 

>> result <- all.equal(r1, r2_resampled)

> 

> Warning message:

> 

> In compareRaster(target, current, ..., values = values, stopiffalse = 

> stopiffalse,  :

> 

>    not all objects have the same values

> 

>> print(result)

> 

> [1] FALSE

> 

>> 

> 

> 

> 

> Kind regards

> 

> Sibylle

> 

> 

>             [[alternative HTML version deleted]]

> 

> ______________________________________________

>  <mailto:R-help at r-project.org> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 

>  <https://stat.ethz.ch/mailman/listinfo/r-help> https://stat.ethz.ch/mailman/listinfo/r-help

> PLEASE do read the posting guide 

>  <http://www.R-project.org/posting-guide.html> http://www.R-project.org/posting-guide.html

> and provide commented, minimal, self-contained, reproducible code.

 

--

Dr. Benjamin Bolker

Professor, Mathematics & Statistics and Biology, McMaster University Director, School of Computational Science and Engineering  > E-mail is sent at my convenience; I don't expect replies outside of working hours.

 

______________________________________________

 <mailto:R-help at r-project.org> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see  <https://stat.ethz.ch/mailman/listinfo/r-help> https://stat.ethz.ch/mailman/listinfo/r-help

PLEASE do read the posting guide  <http://www.R-project.org/posting-guide.html> http://www.R-project.org/posting-guide.html

and provide commented, minimal, self-contained, reproducible code.


	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Fri Aug 16 09:28:26 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Fri, 16 Aug 2024 10:28:26 +0300
Subject: [R] allequal diff
In-Reply-To: <013e01daef9b$e4363ca0$aca2b5e0$@gmx.ch>
References: <00f301daef15$02421d90$06c658b0$@gmx.ch>
 <71c8c7ca-88fb-4cb8-a2ce-1bf032932b00@gmail.com>
 <013e01daef9b$e4363ca0$aca2b5e0$@gmx.ch>
Message-ID: <20240816102826.084fd808@Tarkus>

? Fri, 16 Aug 2024 07:19:38 +0200
SIBYLLE ST?CKLI via R-help <r-help at r-project.org> ?????:

> Is it possible to consider na.rm=TRUE?

> > all.equal(getValues(r1), getValues(r2_resampled), tolerance = 0)  
> 
> [1] "'is.NA' value mismatch: 9544032 in current 66532795 in target"

Use is.na() on getValues() outputs, combine the two masks using the |
operator to get a mask of values that are missing in either raster,
then negate the mask to choose the non-missing values:

all.equal(getValues(r1)[!mask], getValues(r2)[!mask])

-- 
Best regards,
Ivan


From sibyiie@stoeckii m@iii@g oii gmx@ch  Fri Aug 16 10:35:35 2024
From: sibyiie@stoeckii m@iii@g oii gmx@ch (sibyiie@stoeckii m@iii@g oii gmx@ch)
Date: Fri, 16 Aug 2024 10:35:35 +0200
Subject: [R] allequal diff
In-Reply-To: <20240816102826.084fd808@Tarkus>
References: <00f301daef15$02421d90$06c658b0$@gmx.ch>	<71c8c7ca-88fb-4cb8-a2ce-1bf032932b00@gmail.com>	<013e01daef9b$e4363ca0$aca2b5e0$@gmx.ch>
 <20240816102826.084fd808@Tarkus>
Message-ID: <000a01daefb7$43eb5200$cbc1f600$@gmx.ch>

Many thanks Ivan


Use is.na() on getValues() outputs, combine the two masks using the | operator to get a mask of values that are missing in either raster, then negate the mask to choose the non-missing values:

all.equal(getValues(r1)[!mask], getValues(r2)[!mask])

--> what do you mean by use is.na() in getValues(). So I need to call getValues a second time? I suppose you mean to first prepare a mask using is.na without getValues and then in the second step your code?

Kind regards
Sibylle

-----Original Message-----
From: Ivan Krylov <ikrylov at disroot.org> 
Sent: Friday, August 16, 2024 9:28 AM
To: SIBYLLE ST?CKLI via R-help <r-help at r-project.org>
Cc: sibylle.stoeckli at gmx.ch
Subject: Re: [R] allequal diff

? Fri, 16 Aug 2024 07:19:38 +0200
SIBYLLE ST?CKLI via R-help <r-help at r-project.org> ?????:

> Is it possible to consider na.rm=TRUE?

> > all.equal(getValues(r1), getValues(r2_resampled), tolerance = 0)
> 
> [1] "'is.NA' value mismatch: 9544032 in current 66532795 in target"

Use is.na() on getValues() outputs, combine the two masks using the | operator to get a mask of values that are missing in either raster, then negate the mask to choose the non-missing values:

all.equal(getValues(r1)[!mask], getValues(r2)[!mask])

--
Best regards,
Ivan


From |kry|ov @end|ng |rom d|@root@org  Fri Aug 16 10:50:44 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Fri, 16 Aug 2024 11:50:44 +0300
Subject: [R] allequal diff
In-Reply-To: <000a01daefb7$43eb5200$cbc1f600$@gmx.ch>
References: <00f301daef15$02421d90$06c658b0$@gmx.ch>
 <71c8c7ca-88fb-4cb8-a2ce-1bf032932b00@gmail.com>
 <013e01daef9b$e4363ca0$aca2b5e0$@gmx.ch>
 <20240816102826.084fd808@Tarkus>
 <000a01daefb7$43eb5200$cbc1f600$@gmx.ch>
Message-ID: <20240816115044.29208433@Tarkus>

? Fri, 16 Aug 2024 10:35:35 +0200
<sibylle.stoeckli at gmx.ch> ?????:

> what do you mean by use is.na() in getValues(). So I need to call
> getValues a second time?

Not necessarily, but it's one of the options. I was thinking along the
lines of:

values1 <- getValues(r1)
mask1 <- is.na(values1)
# Do the same for r2
# Combine the masks
all.equal(values1[!combined_mask], values2[!combined_mask])

Unlike compareRaster(), this assumes that the coordinate grid of r1 and
r2 is already the same and that only some of the values may differ.

> I suppose you mean to first prepare a mask using is.na without
> getValues and then in the second step your code?  

'raster' documentation says that is.na() works on raster objects, so it
should work.

Even if it didn't work, since you already access the underlying data
using getValues() and then compare the resulting vectors using
all.equal(), using is.na(getValues(...)) should definitely work.

-- 
Best regards,
Ivan


From sibyiie@stoeckii m@iii@g oii gmx@ch  Fri Aug 16 11:03:44 2024
From: sibyiie@stoeckii m@iii@g oii gmx@ch (sibyiie@stoeckii m@iii@g oii gmx@ch)
Date: Fri, 16 Aug 2024 11:03:44 +0200
Subject: [R] allequal diff
In-Reply-To: <000a01daefb7$43eb5200$cbc1f600$@gmx.ch>
References: <00f301daef15$02421d90$06c658b0$@gmx.ch>	<71c8c7ca-88fb-4cb8-a2ce-1bf032932b00@gmail.com>	<013e01daef9b$e4363ca0$aca2b5e0$@gmx.ch>
 <20240816102826.084fd808@Tarkus> <000a01daefb7$43eb5200$cbc1f600$@gmx.ch>
Message-ID: <000c01daefbb$32653fb0$972fbf10$@gmx.ch>

Here my idea including the error:

 

> m1=r1[r1="NA",]

> m2=r2_resampled[r2_resampled="NA",]

> 

> 

> all.equal(getValues(r1)[!m1], getValues(r2_resampled)[!m2])

[1] "Numeric: lengths (80706867, 65806339) differ"

 

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of SIBYLLE ST?CKLI via R-help
Sent: Friday, August 16, 2024 10:36 AM
To: 'Ivan Krylov' <ikrylov at disroot.org>; 'SIBYLLE ST?CKLI via R-help' <r-help at r-project.org>
Subject: Re: [R] allequal diff

 

Many thanks Ivan

 

 

Use is.na() on getValues() outputs, combine the two masks using the | operator to get a mask of values that are missing in either raster, then negate the mask to choose the non-missing values:

 

all.equal(getValues(r1)[!mask], getValues(r2)[!mask])

 

--> what do you mean by use is.na() in getValues(). So I need to call getValues a second time? I suppose you mean to first prepare a mask using is.na without getValues and then in the second step your code?

 

Kind regards

Sibylle

 

-----Original Message-----

From: Ivan Krylov < <mailto:ikrylov at disroot.org> ikrylov at disroot.org>

Sent: Friday, August 16, 2024 9:28 AM

To: SIBYLLE ST?CKLI via R-help < <mailto:r-help at r-project.org> r-help at r-project.org>

Cc:  <mailto:sibylle.stoeckli at gmx.ch> sibylle.stoeckli at gmx.ch

Subject: Re: [R] allequal diff

 

? Fri, 16 Aug 2024 07:19:38 +0200

SIBYLLE ST?CKLI via R-help < <mailto:r-help at r-project.org> r-help at r-project.org> ?????:

 

> Is it possible to consider na.rm=TRUE?

 

> > all.equal(getValues(r1), getValues(r2_resampled), tolerance = 0)

> 

> [1] "'is.NA' value mismatch: 9544032 in current 66532795 in target"

 

Use is.na() on getValues() outputs, combine the two masks using the | operator to get a mask of values that are missing in either raster, then negate the mask to choose the non-missing values:

 

all.equal(getValues(r1)[!mask], getValues(r2)[!mask])

 

--

Best regards,

Ivan

 

______________________________________________

 <mailto:R-help at r-project.org> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see  <https://stat.ethz.ch/mailman/listinfo/r-help> https://stat.ethz.ch/mailman/listinfo/r-help

PLEASE do read the posting guide  <http://www.R-project.org/posting-guide.html> http://www.R-project.org/posting-guide.html

and provide commented, minimal, self-contained, reproducible code.


	[[alternative HTML version deleted]]


From sibyiie@stoeckii m@iii@g oii gmx@ch  Fri Aug 16 11:32:58 2024
From: sibyiie@stoeckii m@iii@g oii gmx@ch (sibyiie@stoeckii m@iii@g oii gmx@ch)
Date: Fri, 16 Aug 2024 11:32:58 +0200
Subject: [R] allequal diff
In-Reply-To: <20240816115044.29208433@Tarkus>
References: <00f301daef15$02421d90$06c658b0$@gmx.ch>	<71c8c7ca-88fb-4cb8-a2ce-1bf032932b00@gmail.com>	<013e01daef9b$e4363ca0$aca2b5e0$@gmx.ch>	<20240816102826.084fd808@Tarkus>	<000a01daefb7$43eb5200$cbc1f600$@gmx.ch>
 <20240816115044.29208433@Tarkus>
Message-ID: <001b01daefbf$4823aae0$d86b00a0$@gmx.ch>

Cool thanks

# values and mask r1
r1 <- getValues(r1)
mask1 <- is.na(r1)
# Do the same for r2
r2 <- getValues(r2_resampled)
mask2 <- is.na(r2)

# Combine the masks
all.equal(r1[!(mask1 & mask2)], r2[!(mask1 & mask2)])


output
> all.equal(r1[!(mask1 & mask2)], r2[!(mask1 & mask2)])
[1] "'is.NA' value mismatch: 389 in current 56989152 in target"

--> so there is just a mismatch in NA not in the xy pixels, right?

Sibylle 



-----Original Message-----
From: Ivan Krylov <ikrylov at disroot.org> 
Sent: Friday, August 16, 2024 10:51 AM
To: sibylle.stoeckli at gmx.ch
Cc: 'SIBYLLE ST?CKLI via R-help' <r-help at r-project.org>
Subject: Re: [R] allequal diff

? Fri, 16 Aug 2024 10:35:35 +0200
<sibylle.stoeckli at gmx.ch> ?????:

> what do you mean by use is.na() in getValues(). So I need to call 
> getValues a second time?

Not necessarily, but it's one of the options. I was thinking along the lines of:

values1 <- getValues(r1)
mask1 <- is.na(values1)
# Do the same for r2
# Combine the masks
all.equal(values1[!combined_mask], values2[!combined_mask])

Unlike compareRaster(), this assumes that the coordinate grid of r1 and
r2 is already the same and that only some of the values may differ.

> I suppose you mean to first prepare a mask using is.na without 
> getValues and then in the second step your code?

'raster' documentation says that is.na() works on raster objects, so it should work.

Even if it didn't work, since you already access the underlying data using getValues() and then compare the resulting vectors using all.equal(), using is.na(getValues(...)) should definitely work.

--
Best regards,
Ivan


From |kry|ov @end|ng |rom d|@root@org  Fri Aug 16 11:45:24 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Fri, 16 Aug 2024 12:45:24 +0300
Subject: [R] allequal diff
In-Reply-To: <001b01daefbf$4823aae0$d86b00a0$@gmx.ch>
References: <00f301daef15$02421d90$06c658b0$@gmx.ch>
 <71c8c7ca-88fb-4cb8-a2ce-1bf032932b00@gmail.com>
 <013e01daef9b$e4363ca0$aca2b5e0$@gmx.ch>
 <20240816102826.084fd808@Tarkus>
 <000a01daefb7$43eb5200$cbc1f600$@gmx.ch>
 <20240816115044.29208433@Tarkus>
 <001b01daefbf$4823aae0$d86b00a0$@gmx.ch>
Message-ID: <20240816124524.4c73593b@Tarkus>

? Fri, 16 Aug 2024 11:32:58 +0200
<sibylle.stoeckli at gmx.ch> ?????:

> # values and mask r1
> r1 <- getValues(r1)
> mask1 <- is.na(r1)
> # Do the same for r2
> r2 <- getValues(r2_resampled)
> mask2 <- is.na(r2)
> 
> # Combine the masks
> all.equal(r1[!(mask1 & mask2)], r2[!(mask1 & mask2)])

Let's consider a more tangible example:

# The vectors `x` and `y` start out equal
x <- y <- 1:10
# But then their different elements are made missing
x[c(1,3,4)] <- NA
y[c(3,8)] <- NA

Now, `is.na(x) & is.na(y)` gives the third element as the only element
missing in both x and y:

mask1 <- is.na(x)
mask2 <- is.na(y)
all.equal( # not the comparison you are looking for
 x[!(mask1 & mask2)], # still two more elements missing
 y[!(mask1 & mask2)]  # still one more element missing
)

If you want to ignore all missing elements, you should combine the
masks using the element-wise "or" operation ("missing in x and/or y"),
not the element-wise "and" operation ("missing in both x and y at the
same time"):

mask1 & mask2 # drops element 3
# [1] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
mask1 | mask2 # drops elements 1, 3, 4, 8
# [1]  TRUE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE

-- 
Best regards,
Ivan


From |@go@g|ne @end|ng |rom @jd@e@  Fri Aug 16 13:46:13 2024
From: |@go@g|ne @end|ng |rom @jd@e@ (=?iso-8859-1?Q?Iago_Gin=E9_V=E1zquez?=)
Date: Fri, 16 Aug 2024 11:46:13 +0000
Subject: [R] Is there some place where I can check a changelog / NEWS for
 the grid package?
Message-ID: <VI0PR02MB10493F23C33D115D0F54A62E794812@VI0PR02MB10493.eurprd02.prod.outlook.com>

Hi all,

On one hand, I wanted to ask if there is some place where I can check a changelog / NEWS for the grid package, as it is not on CRAN. And in that case, where can I find it?

On the other hand, I wanted to ask you for tutorials to start understanding the grid package or what other recommendations you have of introductions to that package (and their extensions...)

Best regards,

Iago








	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Fri Aug 16 14:05:29 2024
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Fri, 16 Aug 2024 14:05:29 +0200
Subject: [R] 
 Is there some place where I can check a changelog / NEWS for
 the grid package?
In-Reply-To: <VI0PR02MB10493F23C33D115D0F54A62E794812@VI0PR02MB10493.eurprd02.prod.outlook.com>
References: <VI0PR02MB10493F23C33D115D0F54A62E794812@VI0PR02MB10493.eurprd02.prod.outlook.com>
Message-ID: <be938ab0-9226-49c7-87b7-f02e011cef49@statistik.tu-dortmund.de>



On 16.08.2024 13:46, Iago Gin? V?zquez wrote:
> Hi all,
> 
> On one hand, I wanted to ask if there is some place where I can check a changelog / NEWS for the grid package, as it is not on CRAN. And in that case, where can I find it?

Grid is part of R, hence you can look at R's NEWS, e.g. at

<https://cran.r-project.org/doc/manuals/r-devel/NEWS.html>

or directly in the svn commit messages at the svn server

svn.r-project.org/R/trunk/





> On the other hand, I wanted to ask you for tutorials to start understanding the grid package or what other recommendations you have of introductions to that package (and their extensions...)

Paul MUrrell wrote some papers and a book, but there are also the 
vignettes, type

vignette(package="grid")


to get an overview.


Best,
Uwe Ligges


> Best regards,
> 
> Iago
> 
> 
> 
> 
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

From sibyiie@stoeckii m@iii@g oii gmx@ch  Fri Aug 16 15:24:39 2024
From: sibyiie@stoeckii m@iii@g oii gmx@ch (sibyiie@stoeckii m@iii@g oii gmx@ch)
Date: Fri, 16 Aug 2024 15:24:39 +0200
Subject: [R] boxplot notch
Message-ID: <008701daefdf$a59dd220$f0d97660$@gmx.ch>

Dear community

 

I tried the following code using geom_boxplot() and notch=TRUE. Does anyone
know if the command ?notch=TRUE? is at the wrong place in my special code
construct?

 

Without notch=TRUE the code provides the planned ggplot.

 

Kind regards

Sibylle

 

Code:

 

MS1<- MS %>% filter(QI_A!="NA") %>% droplevels()

MS1$Jahr<-as.factor(MS1$Jahr)

 

MS1s <- MS1 %>%

  group_by(MS1$Jahr, MS1$Bio) %>%

  summarise(

    y0 = quantile(QI_A, 0.05),

    y25 = quantile(QI_A, 0.25),

    y50 = mean(QI_A),

    y75 = quantile(QI_A, 0.75),

    y100 = quantile(QI_A, 0.95))

 

MS1s

colnames(MS1s)[1]<-"Jahr"

colnames(MS1s)[2]<-"Bio"

MS1s

 

p1<-ggplot(MS1s, aes(Jahr,  fill = as.factor(Bio))) +

  geom_boxplot(

    aes(ymin = y0, lower = y25, middle = y50, upper = y75, ymax = y100),

    stat = "identity", notch=TRUE

  ) +

  theme(panel.background = element_blank())+

  theme(axis.line = element_line(colour = "black"))+

  theme(axis.text=element_text(size=18))+

  theme(axis.title=element_text(size=20))+

  ylab("Anteil BFF an LN [%]") +xlab("Jahr")+

  scale_color_manual(values=c("red","darkgreen"), labels=c("?LN", "BIO"))+

  scale_fill_manual(values=c("red","darkgreen"), labels= c("?LN", "BIO"))+

  theme(legend.title = element_blank())+

  theme(legend.text=element_text(size=20))

p1<-p1 + expand_limits(y=c(0, 80))

p1


	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Fri Aug 16 15:30:03 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Fri, 16 Aug 2024 09:30:03 -0400
Subject: [R] boxplot notch
In-Reply-To: <008701daefdf$a59dd220$f0d97660$@gmx.ch>
References: <008701daefdf$a59dd220$f0d97660$@gmx.ch>
Message-ID: <cd230c4e-9b59-44f8-9920-ed0844f28e66@gmail.com>

   I don't see anything obviously wrong here. There may be something 
subtle, but we probably won't be able to help without a reproducible 
example ...

On 2024-08-16 9:24 a.m., SIBYLLE ST?CKLI via R-help wrote:
> Dear community
> 
>   
> 
> I tried the following code using geom_boxplot() and notch=TRUE. Does anyone
> know if the command ?notch=TRUE? is at the wrong place in my special code
> construct?
> 
>   
> 
> Without notch=TRUE the code provides the planned ggplot.
> 
>   
> 
> Kind regards
> 
> Sibylle
> 
>   
> 
> Code:
> 
>   
> 
> MS1<- MS %>% filter(QI_A!="NA") %>% droplevels()
> 
> MS1$Jahr<-as.factor(MS1$Jahr)
> 
>   
> 
> MS1s <- MS1 %>%
> 
>    group_by(MS1$Jahr, MS1$Bio) %>%
> 
>    summarise(
> 
>      y0 = quantile(QI_A, 0.05),
> 
>      y25 = quantile(QI_A, 0.25),
> 
>      y50 = mean(QI_A),
> 
>      y75 = quantile(QI_A, 0.75),
> 
>      y100 = quantile(QI_A, 0.95))
> 
>   
> 
> MS1s
> 
> colnames(MS1s)[1]<-"Jahr"
> 
> colnames(MS1s)[2]<-"Bio"
> 
> MS1s
> 
>   
> 
> p1<-ggplot(MS1s, aes(Jahr,  fill = as.factor(Bio))) +
> 
>    geom_boxplot(
> 
>      aes(ymin = y0, lower = y25, middle = y50, upper = y75, ymax = y100),
> 
>      stat = "identity", notch=TRUE
> 
>    ) +
> 
>    theme(panel.background = element_blank())+
> 
>    theme(axis.line = element_line(colour = "black"))+
> 
>    theme(axis.text=element_text(size=18))+
> 
>    theme(axis.title=element_text(size=20))+
> 
>    ylab("Anteil BFF an LN [%]") +xlab("Jahr")+
> 
>    scale_color_manual(values=c("red","darkgreen"), labels=c("?LN", "BIO"))+
> 
>    scale_fill_manual(values=c("red","darkgreen"), labels= c("?LN", "BIO"))+
> 
>    theme(legend.title = element_blank())+
> 
>    theme(legend.text=element_text(size=20))
> 
> p1<-p1 + expand_limits(y=c(0, 80))
> 
> p1
> 
> 
> 	[[alternative HTML version deleted]]
> 
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From sibyiie@stoeckii m@iii@g oii gmx@ch  Fri Aug 16 17:51:11 2024
From: sibyiie@stoeckii m@iii@g oii gmx@ch (sibyiie@stoeckii m@iii@g oii gmx@ch)
Date: Fri, 16 Aug 2024 17:51:11 +0200
Subject: [R] boxplot notch
In-Reply-To: <cd230c4e-9b59-44f8-9920-ed0844f28e66@gmail.com>
References: <008701daefdf$a59dd220$f0d97660$@gmx.ch>
 <cd230c4e-9b59-44f8-9920-ed0844f28e66@gmail.com>
Message-ID: <001f01daeff4$1e4862d0$5ad92870$@gmx.ch>

Thanks Ben,

Here the reproducible example.
It works without notch=TRUE, but provides an error with notch=TURE

Error in `geom_boxplot()`:
! Problem while converting geom to grob.
? Error occurred in the 1st layer.
Caused by error in `ans[ypos] <- rep(yes, length.out = len)[ypos]`:
! replacement has length zero
Run `rlang::last_trace()` to see where the error occurred.
Warning message:
In rep(yes, length.out = len) : 'x' is NULL so the result will be NULL


Data
Farm_ID	Jahr	Bio	QI_A
1	2015	1	9.5
2	2018	1	15.7
3	2020	1	21.5
1	2015	1	50.5
2	2018	1	12.9
3	2020	1	11.2
1	2015	1	30.6
2	2018	1	28.7
3	2020	1	29.8
1	2015	1	30.1
2	2018	1	NA
3	2020	1	16.9
1	2015	0	6.5
2	2018	0	7.9
3	2020	0	10.2
1	2015	0	11.2
2	2018	0	18.5
3	2020	0	29.5
1	2015	0	25.1
2	2018	0	16.1
3	2020	0	15.9
1	2015	0	10.1
2	2018	0	8.4
3	2020	0	3.5
1	2015	0	NA
2	2018	0	NA
3	2020	0	3.5


Code
setwd("C:/Users/Sibylle St?ckli/Desktop/")
#.libPaths()
getwd()  

#libraries laden
library("ggplot2")
library("gridExtra")  
library(scales)
library(nlme)
library(arm)
library(blmeco)
library(stats)  
library(dplyr)
library(ggpubr)
library(patchwork)
library(plotrix)
library(tidyverse)
library(dplyr)

#read data
MS = read.delim("Test1.txt", na.strings="NA")
names(MS)

MS$Jahr<-as.numeric(MS$Jahr)
MS$Bio<-as.factor(MS$Bio)
str(MS)

##### boxplot BFF QI

MS1<- MS %>% filter(QI_A!="NA") %>% droplevels()
MS1$Jahr<-as.factor(MS1$Jahr)

MS1s <- MS1 %>%
  group_by(MS1$Jahr, MS1$Bio) %>%
  summarise(
    y0 = quantile(QI_A, 0.05),
    y25 = quantile(QI_A, 0.25),
    y50 = mean(QI_A),
    y75 = quantile(QI_A, 0.75),
    y100 = quantile(QI_A, 0.95))

MS1s
colnames(MS1s)[1]<-"Jahr"
colnames(MS1s)[2]<-"Bio"
MS1s

p1<-ggplot(MS1s, aes(Jahr,  fill = as.factor(Bio))) +
  geom_boxplot(
    aes(ymin = y0, lower = y25, middle = y50, upper = y75, ymax = y100),
    stat = "identity", notch=TRUE
  ) +
  theme(panel.background = element_blank())+
  theme(axis.line = element_line(colour = "black"))+
  theme(axis.text=element_text(size=18))+
  theme(axis.title=element_text(size=20))+
  ylab("Anteil BFF an LN [%]") +xlab("Jahr")+
  scale_color_manual(values=c("red","darkgreen"), labels=c("?LN", "BIO"))+
  scale_fill_manual(values=c("red","darkgreen"), labels= c("?LN", "BIO"))+
  theme(legend.title = element_blank())+
  theme(legend.text=element_text(size=20))
p1<-p1 + expand_limits(y=c(0, 80))
p1

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Ben Bolker
Sent: Friday, August 16, 2024 3:30 PM
To: r-help at r-project.org
Subject: Re: [R] boxplot notch

   I don't see anything obviously wrong here. There may be something subtle, but we probably won't be able to help without a reproducible example ...

On 2024-08-16 9:24 a.m., SIBYLLE ST?CKLI via R-help wrote:
> Dear community
> 
>   
> 
> I tried the following code using geom_boxplot() and notch=TRUE. Does 
> anyone know if the command  notch=TRUE  is at the wrong place in my 
> special code construct?
> 
>   
> 
> Without notch=TRUE the code provides the planned ggplot.
> 
>   
> 
> Kind regards
> 
> Sibylle
> 
>   
> 
> Code:
> 
>   
> 
> MS1<- MS %>% filter(QI_A!="NA") %>% droplevels()
> 
> MS1$Jahr<-as.factor(MS1$Jahr)
> 
>   
> 
> MS1s <- MS1 %>%
> 
>    group_by(MS1$Jahr, MS1$Bio) %>%
> 
>    summarise(
> 
>      y0 = quantile(QI_A, 0.05),
> 
>      y25 = quantile(QI_A, 0.25),
> 
>      y50 = mean(QI_A),
> 
>      y75 = quantile(QI_A, 0.75),
> 
>      y100 = quantile(QI_A, 0.95))
> 
>   
> 
> MS1s
> 
> colnames(MS1s)[1]<-"Jahr"
> 
> colnames(MS1s)[2]<-"Bio"
> 
> MS1s
> 
>   
> 
> p1<-ggplot(MS1s, aes(Jahr,  fill = as.factor(Bio))) +
> 
>    geom_boxplot(
> 
>      aes(ymin = y0, lower = y25, middle = y50, upper = y75, ymax = 
> y100),
> 
>      stat = "identity", notch=TRUE
> 
>    ) +
> 
>    theme(panel.background = element_blank())+
> 
>    theme(axis.line = element_line(colour = "black"))+
> 
>    theme(axis.text=element_text(size=18))+
> 
>    theme(axis.title=element_text(size=20))+
> 
>    ylab("Anteil BFF an LN [%]") +xlab("Jahr")+
> 
>    scale_color_manual(values=c("red","darkgreen"), labels=c(" LN", 
> "BIO"))+
> 
>    scale_fill_manual(values=c("red","darkgreen"), labels= c(" LN", 
> "BIO"))+
> 
>    theme(legend.title = element_blank())+
> 
>    theme(legend.text=element_text(size=20))
> 
> p1<-p1 + expand_limits(y=c(0, 80))
> 
> p1
> 
> 
> 	[[alternative HTML version deleted]]
> 
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

--
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University Director, School of Computational Science and Engineering  > E-mail is sent at my convenience; I don't expect replies outside of working hours.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Fri Aug 16 18:11:20 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 16 Aug 2024 09:11:20 -0700
Subject: [R] boxplot notch
In-Reply-To: <001f01daeff4$1e4862d0$5ad92870$@gmx.ch>
References: <008701daefdf$a59dd220$f0d97660$@gmx.ch>
 <cd230c4e-9b59-44f8-9920-ed0844f28e66@gmail.com>
 <001f01daeff4$1e4862d0$5ad92870$@gmx.ch>
Message-ID: <CAGxFJbQ-eNrfDNnD8zfwTNCjZ4V3ULE6YkFQaroZ872ohRykUg@mail.gmail.com>

Probably should be:
rep("yes", length.out = len)[ypos]

as yes is probably a nonexistent variable.

But I didn't examine your code in detail, so just ignore if I'm wrong.

-- Bert

On Fri, Aug 16, 2024 at 8:51?AM SIBYLLE ST?CKLI via R-help
<r-help at r-project.org> wrote:
>
> Thanks Ben,
>
> Here the reproducible example.
> It works without notch=TRUE, but provides an error with notch=TURE
>
> Error in `geom_boxplot()`:
> ! Problem while converting geom to grob.
> ? Error occurred in the 1st layer.
> Caused by error in `ans[ypos] <- rep(yes, length.out = len)[ypos]`:
> ! replacement has length zero
> Run `rlang::last_trace()` to see where the error occurred.
> Warning message:
> In rep(yes, length.out = len) : 'x' is NULL so the result will be NULL
>
>
> Data
> Farm_ID Jahr    Bio     QI_A
> 1       2015    1       9.5
> 2       2018    1       15.7
> 3       2020    1       21.5
> 1       2015    1       50.5
> 2       2018    1       12.9
> 3       2020    1       11.2
> 1       2015    1       30.6
> 2       2018    1       28.7
> 3       2020    1       29.8
> 1       2015    1       30.1
> 2       2018    1       NA
> 3       2020    1       16.9
> 1       2015    0       6.5
> 2       2018    0       7.9
> 3       2020    0       10.2
> 1       2015    0       11.2
> 2       2018    0       18.5
> 3       2020    0       29.5
> 1       2015    0       25.1
> 2       2018    0       16.1
> 3       2020    0       15.9
> 1       2015    0       10.1
> 2       2018    0       8.4
> 3       2020    0       3.5
> 1       2015    0       NA
> 2       2018    0       NA
> 3       2020    0       3.5
>
>
> Code
> setwd("C:/Users/Sibylle St?ckli/Desktop/")
> #.libPaths()
> getwd()
>
> #libraries laden
> library("ggplot2")
> library("gridExtra")
> library(scales)
> library(nlme)
> library(arm)
> library(blmeco)
> library(stats)
> library(dplyr)
> library(ggpubr)
> library(patchwork)
> library(plotrix)
> library(tidyverse)
> library(dplyr)
>
> #read data
> MS = read.delim("Test1.txt", na.strings="NA")
> names(MS)
>
> MS$Jahr<-as.numeric(MS$Jahr)
> MS$Bio<-as.factor(MS$Bio)
> str(MS)
>
> ##### boxplot BFF QI
>
> MS1<- MS %>% filter(QI_A!="NA") %>% droplevels()
> MS1$Jahr<-as.factor(MS1$Jahr)
>
> MS1s <- MS1 %>%
>   group_by(MS1$Jahr, MS1$Bio) %>%
>   summarise(
>     y0 = quantile(QI_A, 0.05),
>     y25 = quantile(QI_A, 0.25),
>     y50 = mean(QI_A),
>     y75 = quantile(QI_A, 0.75),
>     y100 = quantile(QI_A, 0.95))
>
> MS1s
> colnames(MS1s)[1]<-"Jahr"
> colnames(MS1s)[2]<-"Bio"
> MS1s
>
> p1<-ggplot(MS1s, aes(Jahr,  fill = as.factor(Bio))) +
>   geom_boxplot(
>     aes(ymin = y0, lower = y25, middle = y50, upper = y75, ymax = y100),
>     stat = "identity", notch=TRUE
>   ) +
>   theme(panel.background = element_blank())+
>   theme(axis.line = element_line(colour = "black"))+
>   theme(axis.text=element_text(size=18))+
>   theme(axis.title=element_text(size=20))+
>   ylab("Anteil BFF an LN [%]") +xlab("Jahr")+
>   scale_color_manual(values=c("red","darkgreen"), labels=c("?LN", "BIO"))+
>   scale_fill_manual(values=c("red","darkgreen"), labels= c("?LN", "BIO"))+
>   theme(legend.title = element_blank())+
>   theme(legend.text=element_text(size=20))
> p1<-p1 + expand_limits(y=c(0, 80))
> p1
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Ben Bolker
> Sent: Friday, August 16, 2024 3:30 PM
> To: r-help at r-project.org
> Subject: Re: [R] boxplot notch
>
>    I don't see anything obviously wrong here. There may be something subtle, but we probably won't be able to help without a reproducible example ...
>
> On 2024-08-16 9:24 a.m., SIBYLLE ST?CKLI via R-help wrote:
> > Dear community
> >
> >
> >
> > I tried the following code using geom_boxplot() and notch=TRUE. Does
> > anyone know if the command  notch=TRUE  is at the wrong place in my
> > special code construct?
> >
> >
> >
> > Without notch=TRUE the code provides the planned ggplot.
> >
> >
> >
> > Kind regards
> >
> > Sibylle
> >
> >
> >
> > Code:
> >
> >
> >
> > MS1<- MS %>% filter(QI_A!="NA") %>% droplevels()
> >
> > MS1$Jahr<-as.factor(MS1$Jahr)
> >
> >
> >
> > MS1s <- MS1 %>%
> >
> >    group_by(MS1$Jahr, MS1$Bio) %>%
> >
> >    summarise(
> >
> >      y0 = quantile(QI_A, 0.05),
> >
> >      y25 = quantile(QI_A, 0.25),
> >
> >      y50 = mean(QI_A),
> >
> >      y75 = quantile(QI_A, 0.75),
> >
> >      y100 = quantile(QI_A, 0.95))
> >
> >
> >
> > MS1s
> >
> > colnames(MS1s)[1]<-"Jahr"
> >
> > colnames(MS1s)[2]<-"Bio"
> >
> > MS1s
> >
> >
> >
> > p1<-ggplot(MS1s, aes(Jahr,  fill = as.factor(Bio))) +
> >
> >    geom_boxplot(
> >
> >      aes(ymin = y0, lower = y25, middle = y50, upper = y75, ymax =
> > y100),
> >
> >      stat = "identity", notch=TRUE
> >
> >    ) +
> >
> >    theme(panel.background = element_blank())+
> >
> >    theme(axis.line = element_line(colour = "black"))+
> >
> >    theme(axis.text=element_text(size=18))+
> >
> >    theme(axis.title=element_text(size=20))+
> >
> >    ylab("Anteil BFF an LN [%]") +xlab("Jahr")+
> >
> >    scale_color_manual(values=c("red","darkgreen"), labels=c(" LN",
> > "BIO"))+
> >
> >    scale_fill_manual(values=c("red","darkgreen"), labels= c(" LN",
> > "BIO"))+
> >
> >    theme(legend.title = element_blank())+
> >
> >    theme(legend.text=element_text(size=20))
> >
> > p1<-p1 + expand_limits(y=c(0, 80))
> >
> > p1
> >
> >
> >       [[alternative HTML version deleted]]
> >
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> --
> Dr. Benjamin Bolker
> Professor, Mathematics & Statistics and Biology, McMaster University Director, School of Computational Science and Engineering  > E-mail is sent at my convenience; I don't expect replies outside of working hours.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From chr|@ho|d @end|ng |rom p@yctc@org  Fri Aug 16 18:20:28 2024
From: chr|@ho|d @end|ng |rom p@yctc@org (Chris Evans)
Date: Fri, 16 Aug 2024 18:20:28 +0200
Subject: [R] boxplot notch
In-Reply-To: <001f01daeff4$1e4862d0$5ad92870$@gmx.ch>
References: <008701daefdf$a59dd220$f0d97660$@gmx.ch>
 <cd230c4e-9b59-44f8-9920-ed0844f28e66@gmail.com>
 <001f01daeff4$1e4862d0$5ad92870$@gmx.ch>
Message-ID: <7cfbffbf-ba30-4160-b864-a788b6bdf950@psyctc.org>

That's not really a reprex Sibylle.? I did try to use it to see if I 
could work out what you were trying to do and help but there is so much 
in there that I suspect is distraction from the notch issue and its 
error message.

Please can you give us something stripped of all unecessary things and 
tell us what you want?

Something like data that we can read as a tribble() or from a dput() of 
your data and then only the packages you actually need for the plot (I 
think tidyverse alone might do) and then a ggplot() call stripped right 
down to what you need and a clear explanation of what you are trying to 
do in the geom_boxplot() call and how it uses the summarised data tibble.

It may even be that if you do that, you will find what's causing the 
problem!? (I speak from bitter experience!!)

Very best (all),

Chris

On 16/08/2024 17:51, SIBYLLE ST?CKLI via R-help wrote:
> Farm_ID	Jahr	Bio	QI_A
> 1	2015	1	9.5
> 2	2018	1	15.7
> 3	2020	1	21.5
> 1	2015	1	50.5
> 2	2018	1	12.9
> 3	2020	1	11.2
> 1	2015	1	30.6
> 2	2018	1	28.7
> 3	2020	1	29.8
> 1	2015	1	30.1
> 2	2018	1	NA
> 3	2020	1	16.9
> 1	2015	0	6.5
> 2	2018	0	7.9
> 3	2020	0	10.2
> 1	2015	0	11.2
> 2	2018	0	18.5
> 3	2020	0	29.5
> 1	2015	0	25.1
> 2	2018	0	16.1
> 3	2020	0	15.9
> 1	2015	0	10.1
> 2	2018	0	8.4
> 3	2020	0	3.5
> 1	2015	0	NA
> 2	2018	0	NA
> 3	2020	0	3.5
>
>
> Code
> setwd("C:/Users/Sibylle St?ckli/Desktop/")
> #.libPaths()
> getwd()
>
> #libraries laden
> library("ggplot2")
> library("gridExtra")
> library(scales)
> library(nlme)
> library(arm)
> library(blmeco)
> library(stats)
> library(dplyr)
> library(ggpubr)
> library(patchwork)
> library(plotrix)
> library(tidyverse)
> library(dplyr)
>
> #read data
> MS = read.delim("Test1.txt", na.strings="NA")
> names(MS)
>
> MS$Jahr<-as.numeric(MS$Jahr)
> MS$Bio<-as.factor(MS$Bio)
> str(MS)
>
> ##### boxplot BFF QI
>
> MS1<- MS %>% filter(QI_A!="NA") %>% droplevels()
> MS1$Jahr<-as.factor(MS1$Jahr)
>
> MS1s <- MS1 %>%
>    group_by(MS1$Jahr, MS1$Bio) %>%
>    summarise(
>      y0 = quantile(QI_A, 0.05),
>      y25 = quantile(QI_A, 0.25),
>      y50 = mean(QI_A),
>      y75 = quantile(QI_A, 0.75),
>      y100 = quantile(QI_A, 0.95))
>
> MS1s
> colnames(MS1s)[1]<-"Jahr"
> colnames(MS1s)[2]<-"Bio"
> MS1s
>
> p1<-ggplot(MS1s, aes(Jahr,  fill = as.factor(Bio))) +
>    geom_boxplot(
>      aes(ymin = y0, lower = y25, middle = y50, upper = y75, ymax = y100),
>      stat = "identity", notch=TRUE
>    ) +
>    theme(panel.background = element_blank())+
>    theme(axis.line = element_line(colour = "black"))+
>    theme(axis.text=element_text(size=18))+
>    theme(axis.title=element_text(size=20))+
>    ylab("Anteil BFF an LN [%]") +xlab("Jahr")+
>    scale_color_manual(values=c("red","darkgreen"), labels=c("?LN", "BIO"))+
>    scale_fill_manual(values=c("red","darkgreen"), labels= c("?LN", "BIO"))+
>    theme(legend.title = element_blank())+
>    theme(legend.text=element_text(size=20))
> p1<-p1 + expand_limits(y=c(0, 80))
> p1
-- 
Chris Evans (he/him)
Visiting Professor, UDLA, Quito, Ecuador & Honorary Professor, 
University of Roehampton, London, UK.
Work web site: https://www.psyctc.org/psyctc/
CORE site: http://www.coresystemtrust.org.uk/
Personal site: https://www.psyctc.org/pelerinage2016/
Emeetings (Thursdays): 
https://www.psyctc.org/psyctc/booking-meetings-with-me/
(Beware: French time, generally an hour ahead of UK)
<https://ombook.psyctc.org/book>
	[[alternative HTML version deleted]]


From po|c1410 @end|ng |rom gm@||@com  Fri Aug 16 18:33:28 2024
From: po|c1410 @end|ng |rom gm@||@com (CALUM POLWART)
Date: Fri, 16 Aug 2024 17:33:28 +0100
Subject: [R] boxplot notch
In-Reply-To: <7cfbffbf-ba30-4160-b864-a788b6bdf950@psyctc.org>
References: <008701daefdf$a59dd220$f0d97660$@gmx.ch>
 <cd230c4e-9b59-44f8-9920-ed0844f28e66@gmail.com>
 <001f01daeff4$1e4862d0$5ad92870$@gmx.ch>
 <7cfbffbf-ba30-4160-b864-a788b6bdf950@psyctc.org>
Message-ID: <CA+etgP=b97EdY5-abBA3V9CtRM19=GGv=J8b+jgxBi_JP8sPiQ@mail.gmail.com>

Unless I'm missing the point, you are sending the summary data MS1s to the
plot.  Is that not a VERY unusual way to do it. Let box plot do the
summary? Otherwise what do you want the notches to show?

On Fri, 16 Aug 2024, 17:21 Chris Evans via R-help, <r-help at r-project.org>
wrote:

> That's not really a reprex Sibylle.  I did try to use it to see if I
> could work out what you were trying to do and help but there is so much
> in there that I suspect is distraction from the notch issue and its
> error message.
>
> Please can you give us something stripped of all unecessary things and
> tell us what you want?
>
> Something like data that we can read as a tribble() or from a dput() of
> your data and then only the packages you actually need for the plot (I
> think tidyverse alone might do) and then a ggplot() call stripped right
> down to what you need and a clear explanation of what you are trying to
> do in the geom_boxplot() call and how it uses the summarised data tibble.
>
> It may even be that if you do that, you will find what's causing the
> problem!  (I speak from bitter experience!!)
>
> Very best (all),
>
> Chris
>
> On 16/08/2024 17:51, SIBYLLE ST?CKLI via R-help wrote:
> > Farm_ID       Jahr    Bio     QI_A
> > 1     2015    1       9.5
> > 2     2018    1       15.7
> > 3     2020    1       21.5
> > 1     2015    1       50.5
> > 2     2018    1       12.9
> > 3     2020    1       11.2
> > 1     2015    1       30.6
> > 2     2018    1       28.7
> > 3     2020    1       29.8
> > 1     2015    1       30.1
> > 2     2018    1       NA
> > 3     2020    1       16.9
> > 1     2015    0       6.5
> > 2     2018    0       7.9
> > 3     2020    0       10.2
> > 1     2015    0       11.2
> > 2     2018    0       18.5
> > 3     2020    0       29.5
> > 1     2015    0       25.1
> > 2     2018    0       16.1
> > 3     2020    0       15.9
> > 1     2015    0       10.1
> > 2     2018    0       8.4
> > 3     2020    0       3.5
> > 1     2015    0       NA
> > 2     2018    0       NA
> > 3     2020    0       3.5
> >
> >
> > Code
> > setwd("C:/Users/Sibylle St?ckli/Desktop/")
> > #.libPaths()
> > getwd()
> >
> > #libraries laden
> > library("ggplot2")
> > library("gridExtra")
> > library(scales)
> > library(nlme)
> > library(arm)
> > library(blmeco)
> > library(stats)
> > library(dplyr)
> > library(ggpubr)
> > library(patchwork)
> > library(plotrix)
> > library(tidyverse)
> > library(dplyr)
> >
> > #read data
> > MS = read.delim("Test1.txt", na.strings="NA")
> > names(MS)
> >
> > MS$Jahr<-as.numeric(MS$Jahr)
> > MS$Bio<-as.factor(MS$Bio)
> > str(MS)
> >
> > ##### boxplot BFF QI
> >
> > MS1<- MS %>% filter(QI_A!="NA") %>% droplevels()
> > MS1$Jahr<-as.factor(MS1$Jahr)
> >
> > MS1s <- MS1 %>%
> >    group_by(MS1$Jahr, MS1$Bio) %>%
> >    summarise(
> >      y0 = quantile(QI_A, 0.05),
> >      y25 = quantile(QI_A, 0.25),
> >      y50 = mean(QI_A),
> >      y75 = quantile(QI_A, 0.75),
> >      y100 = quantile(QI_A, 0.95))
> >
> > MS1s
> > colnames(MS1s)[1]<-"Jahr"
> > colnames(MS1s)[2]<-"Bio"
> > MS1s
> >
> > p1<-ggplot(MS1s, aes(Jahr,  fill = as.factor(Bio))) +
> >    geom_boxplot(
> >      aes(ymin = y0, lower = y25, middle = y50, upper = y75, ymax = y100),
> >      stat = "identity", notch=TRUE
> >    ) +
> >    theme(panel.background = element_blank())+
> >    theme(axis.line = element_line(colour = "black"))+
> >    theme(axis.text=element_text(size=18))+
> >    theme(axis.title=element_text(size=20))+
> >    ylab("Anteil BFF an LN [%]") +xlab("Jahr")+
> >    scale_color_manual(values=c("red","darkgreen"), labels=c("?LN",
> "BIO"))+
> >    scale_fill_manual(values=c("red","darkgreen"), labels= c("?LN",
> "BIO"))+
> >    theme(legend.title = element_blank())+
> >    theme(legend.text=element_text(size=20))
> > p1<-p1 + expand_limits(y=c(0, 80))
> > p1
> --
> Chris Evans (he/him)
> Visiting Professor, UDLA, Quito, Ecuador & Honorary Professor,
> University of Roehampton, London, UK.
> Work web site: https://www.psyctc.org/psyctc/
> CORE site: http://www.coresystemtrust.org.uk/
> Personal site: https://www.psyctc.org/pelerinage2016/
> Emeetings (Thursdays):
> https://www.psyctc.org/psyctc/booking-meetings-with-me/
> (Beware: French time, generally an hour ahead of UK)
> <https://ombook.psyctc.org/book>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From N|co|@@@SIMON @end|ng |rom @p-hm@|r  Sat Aug 17 12:21:57 2024
From: N|co|@@@SIMON @end|ng |rom @p-hm@|r (SIMON Nicolas)
Date: Sat, 17 Aug 2024 10:21:57 +0000
Subject: [R] Terminating a cmd windows from R
Message-ID: <A28E29E8-98EE-4FD5-86F6-635D887B2E46@ap-hm.fr>

I would like to stop a dos shell windows following the cmd (execute) command. Is there a way to do that from R?


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Aug 17 13:31:27 2024
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 17 Aug 2024 07:31:27 -0400
Subject: [R] Terminating a cmd windows from R
In-Reply-To: <A28E29E8-98EE-4FD5-86F6-635D887B2E46@ap-hm.fr>
References: <A28E29E8-98EE-4FD5-86F6-635D887B2E46@ap-hm.fr>
Message-ID: <59f238ed-3e51-4f54-b4cb-028240206960@gmail.com>

On 2024-08-17 6:21 a.m., SIMON Nicolas via R-help wrote:
> I would like to stop a dos shell windows following the cmd (execute) command. Is there a way to do that from R?

I think you need to give more detail on what you are trying to do.  In 
Windows, "cmd" is supposed to open a shell window.   Could you show us 
an example of what you are doing?

Duncan Murdoch


From po|c1410 @end|ng |rom gm@||@com  Sat Aug 17 13:43:32 2024
From: po|c1410 @end|ng |rom gm@||@com (CALUM POLWART)
Date: Sat, 17 Aug 2024 12:43:32 +0100
Subject: [R] Terminating a cmd windows from R
In-Reply-To: <59f238ed-3e51-4f54-b4cb-028240206960@gmail.com>
References: <A28E29E8-98EE-4FD5-86F6-635D887B2E46@ap-hm.fr>
 <59f238ed-3e51-4f54-b4cb-028240206960@gmail.com>
Message-ID: <CA+etgPnovWe39FZZT8oLDeBzeSZSkCHdZmmQ0n1n-X7j8Kx8hQ@mail.gmail.com>

cmd
taskkill /PID 1234

Will kill process 1234 if you know it id

So shell.exec can likely do this for you

On Sat, 17 Aug 2024, 12:31 Duncan Murdoch, <murdoch.duncan at gmail.com> wrote:

> On 2024-08-17 6:21 a.m., SIMON Nicolas via R-help wrote:
> > I would like to stop a dos shell windows following the cmd (execute)
> command. Is there a way to do that from R?
>
> I think you need to give more detail on what you are trying to do.  In
> Windows, "cmd" is supposed to open a shell window.   Could you show us
> an example of what you are doing?
>
> Duncan Murdoch
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From N|co|@@@SIMON @end|ng |rom @p-hm@|r  Sat Aug 17 13:47:30 2024
From: N|co|@@@SIMON @end|ng |rom @p-hm@|r (SIMON Nicolas)
Date: Sat, 17 Aug 2024 11:47:30 +0000
Subject: [R] Terminating a cmd windows from R
In-Reply-To: <59f238ed-3e51-4f54-b4cb-028240206960@gmail.com>
References: <A28E29E8-98EE-4FD5-86F6-635D887B2E46@ap-hm.fr>,
 <59f238ed-3e51-4f54-b4cb-028240206960@gmail.com>
Message-ID: <042E0932-273A-47D8-9DCC-C0E299DF6578@ap-hm.fr>

I execute a program using a batch file from R.
The program may have infinite computation. So I need to be avle to stop it.

nm_log <- "c:/nm74g64/run/nmfe74"
nmi    <- "202"
nmrun <- paste0("cmd.exe /k ",nm_log,".bat ",nmi,".ctl ",nmi,".lst")
# run
system(nmrun, invisible = F, show.output.on.console = T, wait = T)



Le 17 ao?t 2024 ? 13:31, Duncan Murdoch <murdoch.duncan at gmail.com> a ?crit :

?
On 2024-08-17 6:?21 a.?m.?, SIMON Nicolas via R-help wrote: > I would like to stop a dos shell windows following the cmd (execute) command. Is there a way to do that from R? I think you need to give more detail on what you are trying to do.?


On 2024-08-17 6:21 a.m., SIMON Nicolas via R-help wrote:
> I would like to stop a dos shell windows following the cmd (execute) command. Is there a way to do that from R?

I think you need to give more detail on what you are trying to do.  In
Windows, "cmd" is supposed to open a shell window.   Could you show us
an example of what you are doing?

Duncan Murdoch


From |kry|ov @end|ng |rom d|@root@org  Sat Aug 17 16:07:25 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Sat, 17 Aug 2024 17:07:25 +0300
Subject: [R] Terminating a cmd windows from R
In-Reply-To: <042E0932-273A-47D8-9DCC-C0E299DF6578@ap-hm.fr>
References: <A28E29E8-98EE-4FD5-86F6-635D887B2E46@ap-hm.fr>
 <59f238ed-3e51-4f54-b4cb-028240206960@gmail.com>
 <042E0932-273A-47D8-9DCC-C0E299DF6578@ap-hm.fr>
Message-ID: <20240817170725.418ed3d5@trisector>

? Sat, 17 Aug 2024 11:47:30 +0000
SIMON Nicolas via R-help <r-help at r-project.org> ?????:

> nmrun <- paste0("cmd.exe /k ",nm_log,".bat ",nmi,".ctl ",nmi,".lst")

You are using the /k option that instructs cmd.exe to keep the command
prompt open. Does the batch file contain an explicit "exit" to ensure
that cmd.exe terminates?

> system(nmrun, invisible = F, show.output.on.console = T, wait = T)

With wait = TRUE, it should be possible to interrupt the process by
pressing Ctrl+C in the cmd.exe window, but R itself will not be running
your commands until system() returns (or is interrupted, terminating
the process). You can specify a timeout for a foreground process using
the 'timeout' argument of the system() function.

If you'd like to manage a background process, consider the 'processx'
CRAN package: https://cran.r-project.org/package=processx

-- 
Tr?s cordialement,
Ivan


From N|co|@@@SIMON @end|ng |rom @p-hm@|r  Sat Aug 17 18:44:21 2024
From: N|co|@@@SIMON @end|ng |rom @p-hm@|r (SIMON Nicolas)
Date: Sat, 17 Aug 2024 16:44:21 +0000
Subject: [R] Terminating a cmd windows from R
In-Reply-To: <20240817170725.418ed3d5@trisector>
References: <A28E29E8-98EE-4FD5-86F6-635D887B2E46@ap-hm.fr>
 <59f238ed-3e51-4f54-b4cb-028240206960@gmail.com>
 <042E0932-273A-47D8-9DCC-C0E299DF6578@ap-hm.fr>,
 <20240817170725.418ed3d5@trisector>
Message-ID: <2D1DC7CA-BFBB-4522-AA33-C2B717F80F7B@ap-hm.fr>

Many thanks for your help.
I will consider the processx package.

Best regards
Nicolas


Le 17 ao?t 2024 ? 16:07, Ivan Krylov <ikrylov at disroot.org> a ?crit :

?
? Sat, 17 Aug 2024 11:?47:?30 +0000 SIMON Nicolas via R-help <r-help@?r-project.?org> ?????: > nmrun <- paste0("cmd.?exe /k ",nm_log,".?bat ",nmi,".?ctl ",nmi,".?lst") You are using the /k option that instructs cmd.?exe to keep the command


? Sat, 17 Aug 2024 11:47:30 +0000
SIMON Nicolas via R-help <r-help at r-project.org> ?????:

> nmrun <- paste0("cmd.exe /k ",nm_log,".bat ",nmi,".ctl ",nmi,".lst")

You are using the /k option that instructs cmd.exe to keep the command
prompt open. Does the batch file contain an explicit "exit" to ensure
that cmd.exe terminates?

> system(nmrun, invisible = F, show.output.on.console = T, wait = T)

With wait = TRUE, it should be possible to interrupt the process by
pressing Ctrl+C in the cmd.exe window, but R itself will not be running
your commands until system() returns (or is interrupted, terminating
the process). You can specify a timeout for a foreground process using
the 'timeout' argument of the system() function.

If you'd like to manage a background process, consider the 'processx'
CRAN package: https://urldefense.com/v3/__https://cran.r-project.org/package=processx__;!!JQ5agg!YxmSgAHp4UgpqrHOlG1PHD6BvfvG1NC92n14SwHd7xlxN3PkMlbOrtc2Kw67JPntISAjxOic-ZZA0kEDop7N_A$

--
Tr?s cordialement,
Ivan


From sibyiie@stoeckii m@iii@g oii gmx@ch  Sun Aug 18 20:00:01 2024
From: sibyiie@stoeckii m@iii@g oii gmx@ch (sibyiie@stoeckii m@iii@g oii gmx@ch)
Date: Sun, 18 Aug 2024 20:00:01 +0200
Subject: [R] allequal diff
In-Reply-To: <20240816124524.4c73593b@Tarkus>
References: <00f301daef15$02421d90$06c658b0$@gmx.ch>	<71c8c7ca-88fb-4cb8-a2ce-1bf032932b00@gmail.com>	<013e01daef9b$e4363ca0$aca2b5e0$@gmx.ch>	<20240816102826.084fd808@Tarkus>	<000a01daefb7$43eb5200$cbc1f600$@gmx.ch>	<20240816115044.29208433@Tarkus>	<001b01daefbf$4823aae0$d86b00a0$@gmx.ch>
 <20240816124524.4c73593b@Tarkus>
Message-ID: <009601daf198$7292b070$57b81150$@gmx.ch>

Dear Ivan 

Thanks a lot for this very nice example.

Is it true that all.equal just compares y values?
Based on this help here I think so and the value I got is the difference for the y-values.
https://www.statology.org/all-equal-function-r/

However, here I see x and y testing?
https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/all.equal
I am actually interested in the x values (x-y coordinates). Test if x-y coordinates of both 25-m-pixel rasters are the same. Ther may be a small shift or differences in the number of decimal places.

Kind regards
Sibylle



-----Original Message-----
From: Ivan Krylov <ikrylov at disroot.org> 
Sent: Friday, August 16, 2024 11:45 AM
To: sibylle.stoeckli at gmx.ch
Cc: 'SIBYLLE ST?CKLI via R-help' <r-help at r-project.org>
Subject: Re: [R] allequal diff

? Fri, 16 Aug 2024 11:32:58 +0200
<sibylle.stoeckli at gmx.ch> ?????:

> # values and mask r1
> r1 <- getValues(r1)
> mask1 <- is.na(r1)
> # Do the same for r2
> r2 <- getValues(r2_resampled)
> mask2 <- is.na(r2)
> 
> # Combine the masks
> all.equal(r1[!(mask1 & mask2)], r2[!(mask1 & mask2)])

Let's consider a more tangible example:

# The vectors `x` and `y` start out equal x <- y <- 1:10 # But then their different elements are made missing x[c(1,3,4)] <- NA y[c(3,8)] <- NA

Now, `is.na(x) & is.na(y)` gives the third element as the only element missing in both x and y:

mask1 <- is.na(x)
mask2 <- is.na(y)
all.equal( # not the comparison you are looking for
 x[!(mask1 & mask2)], # still two more elements missing
 y[!(mask1 & mask2)]  # still one more element missing
)

If you want to ignore all missing elements, you should combine the masks using the element-wise "or" operation ("missing in x and/or y"), not the element-wise "and" operation ("missing in both x and y at the same time"):

mask1 & mask2 # drops element 3
# [1] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
mask1 | mask2 # drops elements 1, 3, 4, 8 # [1]  TRUE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE

--
Best regards,
Ivan


From bbo|ker @end|ng |rom gm@||@com  Sun Aug 18 20:29:57 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 18 Aug 2024 14:29:57 -0400
Subject: [R] allequal diff
In-Reply-To: <009601daf198$7292b070$57b81150$@gmx.ch>
References: <00f301daef15$02421d90$06c658b0$@gmx.ch>
 <71c8c7ca-88fb-4cb8-a2ce-1bf032932b00@gmail.com>
 <013e01daef9b$e4363ca0$aca2b5e0$@gmx.ch> <20240816102826.084fd808@Tarkus>
 <000a01daefb7$43eb5200$cbc1f600$@gmx.ch> <20240816115044.29208433@Tarkus>
 <001b01daefbf$4823aae0$d86b00a0$@gmx.ch> <20240816124524.4c73593b@Tarkus>
 <009601daf198$7292b070$57b81150$@gmx.ch>
Message-ID: <64d6edb1-78a3-477f-b9da-c7b66815ec5e@gmail.com>

 ? To do this, I think you'll have to compare the extent (using the 
extent() function) and/or number of rows and columns and/or resolution 
of the two rasters. (Print the source code of compareRasters() and dig 
through it to see what's being compared ...)

On 8/18/24 14:00, SIBYLLE ST?CKLI via R-help wrote:
> Dear Ivan
>
> Thanks a lot for this very nice example.
>
> Is it true that all.equal just compares y values?
> Based on this help here I think so and the value I got is the difference for the y-values.
> https://www.statology.org/all-equal-function-r/
>
> However, here I see x and y testing?
> https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/all.equal
> I am actually interested in the x values (x-y coordinates). Test if x-y coordinates of both 25-m-pixel rasters are the same. Ther may be a small shift or differences in the number of decimal places.
>
> Kind regards
> Sibylle
>
>
>
> -----Original Message-----
> From: Ivan Krylov <ikrylov at disroot.org>
> Sent: Friday, August 16, 2024 11:45 AM
> To: sibylle.stoeckli at gmx.ch
> Cc: 'SIBYLLE ST?CKLI via R-help' <r-help at r-project.org>
> Subject: Re: [R] allequal diff
>
> ? Fri, 16 Aug 2024 11:32:58 +0200
> <sibylle.stoeckli at gmx.ch> ?????:
>
>> # values and mask r1
>> r1 <- getValues(r1)
>> mask1 <- is.na(r1)
>> # Do the same for r2
>> r2 <- getValues(r2_resampled)
>> mask2 <- is.na(r2)
>>
>> # Combine the masks
>> all.equal(r1[!(mask1 & mask2)], r2[!(mask1 & mask2)])
> Let's consider a more tangible example:
>
> # The vectors `x` and `y` start out equal x <- y <- 1:10 # But then their different elements are made missing x[c(1,3,4)] <- NA y[c(3,8)] <- NA
>
> Now, `is.na(x) & is.na(y)` gives the third element as the only element missing in both x and y:
>
> mask1 <- is.na(x)
> mask2 <- is.na(y)
> all.equal( # not the comparison you are looking for
>   x[!(mask1 & mask2)], # still two more elements missing
>   y[!(mask1 & mask2)]  # still one more element missing
> )
>
> If you want to ignore all missing elements, you should combine the masks using the element-wise "or" operation ("missing in x and/or y"), not the element-wise "and" operation ("missing in both x and y at the same time"):
>
> mask1 & mask2 # drops element 3
> # [1] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
> mask1 | mask2 # drops elements 1, 3, 4, 8 # [1]  TRUE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE
>
> --
> Best regards,
> Ivan
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Sun Aug 18 20:40:15 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sun, 18 Aug 2024 11:40:15 -0700
Subject: [R] allequal diff
In-Reply-To: <009601daf198$7292b070$57b81150$@gmx.ch>
References: <00f301daef15$02421d90$06c658b0$@gmx.ch>
 <71c8c7ca-88fb-4cb8-a2ce-1bf032932b00@gmail.com>
 <013e01daef9b$e4363ca0$aca2b5e0$@gmx.ch> <20240816102826.084fd808@Tarkus>
 <000a01daefb7$43eb5200$cbc1f600$@gmx.ch> <20240816115044.29208433@Tarkus>
 <001b01daefbf$4823aae0$d86b00a0$@gmx.ch> <20240816124524.4c73593b@Tarkus>
 <009601daf198$7292b070$57b81150$@gmx.ch>
Message-ID: <CAGxFJbReUa+5imMCfZLS9z__+hyt4qXxfO-FAm8qnYcSvuma6w@mail.gmail.com>

"Is it true that all.equal just compares y values?"

The following may be a bit more than you may have wanted, but I hope
it is nevertheless useful.

The first place you should go to for questions like this is the Help
system, not here, i.e.
?all.equal

When you do this, you will find that all.equal() is a so-called S3
generic function, which, among other things, means that it works
differently (i.e. "dispatches") depending on its (usually) first
argument. So, for example, if the first argument is of (S3) class
"numeric", it will call the default method, all.equal.default(); if
it's a function, it will call all.equal.function().  Help for
all.equal's basic methods is found in the single all.equal (base) Help
page. However, for non-base R packages, there may be other different
methods provided for classed objects, e.g. perhaps of class "raster"
that would be found by ?all.equal.raster . Or maybe not, if the class
"inherits" from another class, such as "matrix" (Warning: I am
completely unfamiliar with the raster package, so these specifics are
very likely wrong).

To sort this sort of thing out, It would probably be useful for you to
find a tutorial on R's S3 class  system (which is really a form of
multiple dispatch) and spend some time with it. There are many good
ones out there. This S3 system is widely used within R and many
packages, so doing this sort of homework now should serve you well in
your future R journey.

All IMO obviously.

Cheers,
Bert


On Sun, Aug 18, 2024 at 11:00?AM SIBYLLE ST?CKLI via R-help
<r-help at r-project.org> wrote:
>
> Dear Ivan
>
> Thanks a lot for this very nice example.
>
> Is it true that all.equal just compares y values?
> Based on this help here I think so and the value I got is the difference for the y-values.
> https://www.statology.org/all-equal-function-r/
>
> However, here I see x and y testing?
> https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/all.equal
> I am actually interested in the x values (x-y coordinates). Test if x-y coordinates of both 25-m-pixel rasters are the same. Ther may be a small shift or differences in the number of decimal places.
>
> Kind regards
> Sibylle
>
>
>
> -----Original Message-----
> From: Ivan Krylov <ikrylov at disroot.org>
> Sent: Friday, August 16, 2024 11:45 AM
> To: sibylle.stoeckli at gmx.ch
> Cc: 'SIBYLLE ST?CKLI via R-help' <r-help at r-project.org>
> Subject: Re: [R] allequal diff
>
> ? Fri, 16 Aug 2024 11:32:58 +0200
> <sibylle.stoeckli at gmx.ch> ?????:
>
> > # values and mask r1
> > r1 <- getValues(r1)
> > mask1 <- is.na(r1)
> > # Do the same for r2
> > r2 <- getValues(r2_resampled)
> > mask2 <- is.na(r2)
> >
> > # Combine the masks
> > all.equal(r1[!(mask1 & mask2)], r2[!(mask1 & mask2)])
>
> Let's consider a more tangible example:
>
> # The vectors `x` and `y` start out equal x <- y <- 1:10 # But then their different elements are made missing x[c(1,3,4)] <- NA y[c(3,8)] <- NA
>
> Now, `is.na(x) & is.na(y)` gives the third element as the only element missing in both x and y:
>
> mask1 <- is.na(x)
> mask2 <- is.na(y)
> all.equal( # not the comparison you are looking for
>  x[!(mask1 & mask2)], # still two more elements missing
>  y[!(mask1 & mask2)]  # still one more element missing
> )
>
> If you want to ignore all missing elements, you should combine the masks using the element-wise "or" operation ("missing in x and/or y"), not the element-wise "and" operation ("missing in both x and y at the same time"):
>
> mask1 & mask2 # drops element 3
> # [1] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
> mask1 | mask2 # drops elements 1, 3, 4, 8 # [1]  TRUE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE
>
> --
> Best regards,
> Ivan
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bbo|ker @end|ng |rom gm@||@com  Sun Aug 18 20:44:42 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 18 Aug 2024 14:44:42 -0400
Subject: [R] allequal diff
In-Reply-To: <CAGxFJbReUa+5imMCfZLS9z__+hyt4qXxfO-FAm8qnYcSvuma6w@mail.gmail.com>
References: <00f301daef15$02421d90$06c658b0$@gmx.ch>
 <71c8c7ca-88fb-4cb8-a2ce-1bf032932b00@gmail.com>
 <013e01daef9b$e4363ca0$aca2b5e0$@gmx.ch> <20240816102826.084fd808@Tarkus>
 <000a01daefb7$43eb5200$cbc1f600$@gmx.ch> <20240816115044.29208433@Tarkus>
 <001b01daefbf$4823aae0$d86b00a0$@gmx.ch> <20240816124524.4c73593b@Tarkus>
 <009601daf198$7292b070$57b81150$@gmx.ch>
 <CAGxFJbReUa+5imMCfZLS9z__+hyt4qXxfO-FAm8qnYcSvuma6w@mail.gmail.com>
Message-ID: <8848865f-96a2-4fac-a34c-d948964e8a71@gmail.com>

 ?? The OP's original problem is that the all.equal method for raster 
objects (raster:::all.equal.raster), which is a wrapper around the 
compareRaster() function, compares a bunch of different properties of 
rasters (extent, resolution, values, etc.) and only returns a single 
overall logical (TRUE/FALSE) value. OP wanted to see the magnitude of 
the difference (as you could get for more typical all.equal methods by 
using tolerance=0), but in order to do that one has to dig into the code 
of compareRaster() and pull out code to make the particular comparisons 
one wants by applying all.equal to specific components of the raster (it 
would be nice if there were a built-in way to get this information, but 
I don't know of one)

On 8/18/24 14:40, Bert Gunter wrote:
> "Is it true that all.equal just compares y values?"
>
> The following may be a bit more than you may have wanted, but I hope
> it is nevertheless useful.
>
> The first place you should go to for questions like this is the Help
> system, not here, i.e.
> ?all.equal
>
> When you do this, you will find that all.equal() is a so-called S3
> generic function, which, among other things, means that it works
> differently (i.e. "dispatches") depending on its (usually) first
> argument. So, for example, if the first argument is of (S3) class
> "numeric", it will call the default method, all.equal.default(); if
> it's a function, it will call all.equal.function().  Help for
> all.equal's basic methods is found in the single all.equal (base) Help
> page. However, for non-base R packages, there may be other different
> methods provided for classed objects, e.g. perhaps of class "raster"
> that would be found by ?all.equal.raster . Or maybe not, if the class
> "inherits" from another class, such as "matrix" (Warning: I am
> completely unfamiliar with the raster package, so these specifics are
> very likely wrong).
>
> To sort this sort of thing out, It would probably be useful for you to
> find a tutorial on R's S3 class  system (which is really a form of
> multiple dispatch) and spend some time with it. There are many good
> ones out there. This S3 system is widely used within R and many
> packages, so doing this sort of homework now should serve you well in
> your future R journey.
>
> All IMO obviously.
>
> Cheers,
> Bert
>
>
> On Sun, Aug 18, 2024 at 11:00?AM SIBYLLE ST?CKLI via R-help
> <r-help at r-project.org> wrote:
>> Dear Ivan
>>
>> Thanks a lot for this very nice example.
>>
>> Is it true that all.equal just compares y values?
>> Based on this help here I think so and the value I got is the difference for the y-values.
>> https://www.statology.org/all-equal-function-r/
>>
>> However, here I see x and y testing?
>> https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/all.equal
>> I am actually interested in the x values (x-y coordinates). Test if x-y coordinates of both 25-m-pixel rasters are the same. Ther may be a small shift or differences in the number of decimal places.
>>
>> Kind regards
>> Sibylle
>>
>>
>>
>> -----Original Message-----
>> From: Ivan Krylov <ikrylov at disroot.org>
>> Sent: Friday, August 16, 2024 11:45 AM
>> To: sibylle.stoeckli at gmx.ch
>> Cc: 'SIBYLLE ST?CKLI via R-help' <r-help at r-project.org>
>> Subject: Re: [R] allequal diff
>>
>> ? Fri, 16 Aug 2024 11:32:58 +0200
>> <sibylle.stoeckli at gmx.ch> ?????:
>>
>>> # values and mask r1
>>> r1 <- getValues(r1)
>>> mask1 <- is.na(r1)
>>> # Do the same for r2
>>> r2 <- getValues(r2_resampled)
>>> mask2 <- is.na(r2)
>>>
>>> # Combine the masks
>>> all.equal(r1[!(mask1 & mask2)], r2[!(mask1 & mask2)])
>> Let's consider a more tangible example:
>>
>> # The vectors `x` and `y` start out equal x <- y <- 1:10 # But then their different elements are made missing x[c(1,3,4)] <- NA y[c(3,8)] <- NA
>>
>> Now, `is.na(x) & is.na(y)` gives the third element as the only element missing in both x and y:
>>
>> mask1 <- is.na(x)
>> mask2 <- is.na(y)
>> all.equal( # not the comparison you are looking for
>>   x[!(mask1 & mask2)], # still two more elements missing
>>   y[!(mask1 & mask2)]  # still one more element missing
>> )
>>
>> If you want to ignore all missing elements, you should combine the masks using the element-wise "or" operation ("missing in x and/or y"), not the element-wise "and" operation ("missing in both x and y at the same time"):
>>
>> mask1 & mask2 # drops element 3
>> # [1] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
>> mask1 | mask2 # drops elements 1, 3, 4, 8 # [1]  TRUE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE
>>
>> --
>> Best regards,
>> Ivan
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Sun Aug 18 20:47:46 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sun, 18 Aug 2024 11:47:46 -0700
Subject: [R] allequal diff
In-Reply-To: <CAGxFJbReUa+5imMCfZLS9z__+hyt4qXxfO-FAm8qnYcSvuma6w@mail.gmail.com>
References: <00f301daef15$02421d90$06c658b0$@gmx.ch>
 <71c8c7ca-88fb-4cb8-a2ce-1bf032932b00@gmail.com>
 <013e01daef9b$e4363ca0$aca2b5e0$@gmx.ch> <20240816102826.084fd808@Tarkus>
 <000a01daefb7$43eb5200$cbc1f600$@gmx.ch> <20240816115044.29208433@Tarkus>
 <001b01daefbf$4823aae0$d86b00a0$@gmx.ch> <20240816124524.4c73593b@Tarkus>
 <009601daf198$7292b070$57b81150$@gmx.ch>
 <CAGxFJbReUa+5imMCfZLS9z__+hyt4qXxfO-FAm8qnYcSvuma6w@mail.gmail.com>
Message-ID: <CAGxFJbSkrS0uVcRHkCOTomRtd3w9kQCjEXzt9aY+ikzQ2b3brQ@mail.gmail.com>

I should have added:

There are actually several class systems in R, and the raster package
may use one of the others or none.  But you should still look for help
for functionality first in the Help system.
See ?help for details and authoritative information on how to use the
Help system.

-- Bert

On Sun, Aug 18, 2024 at 11:40?AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> "Is it true that all.equal just compares y values?"
>
> The following may be a bit more than you may have wanted, but I hope
> it is nevertheless useful.
>
> The first place you should go to for questions like this is the Help
> system, not here, i.e.
> ?all.equal
>
> When you do this, you will find that all.equal() is a so-called S3
> generic function, which, among other things, means that it works
> differently (i.e. "dispatches") depending on its (usually) first
> argument. So, for example, if the first argument is of (S3) class
> "numeric", it will call the default method, all.equal.default(); if
> it's a function, it will call all.equal.function().  Help for
> all.equal's basic methods is found in the single all.equal (base) Help
> page. However, for non-base R packages, there may be other different
> methods provided for classed objects, e.g. perhaps of class "raster"
> that would be found by ?all.equal.raster . Or maybe not, if the class
> "inherits" from another class, such as "matrix" (Warning: I am
> completely unfamiliar with the raster package, so these specifics are
> very likely wrong).
>
> To sort this sort of thing out, It would probably be useful for you to
> find a tutorial on R's S3 class  system (which is really a form of
> multiple dispatch) and spend some time with it. There are many good
> ones out there. This S3 system is widely used within R and many
> packages, so doing this sort of homework now should serve you well in
> your future R journey.
>
> All IMO obviously.
>
> Cheers,
> Bert
>
>
> On Sun, Aug 18, 2024 at 11:00?AM SIBYLLE ST?CKLI via R-help
> <r-help at r-project.org> wrote:
> >
> > Dear Ivan
> >
> > Thanks a lot for this very nice example.
> >
> > Is it true that all.equal just compares y values?
> > Based on this help here I think so and the value I got is the difference for the y-values.
> > https://www.statology.org/all-equal-function-r/
> >
> > However, here I see x and y testing?
> > https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/all.equal
> > I am actually interested in the x values (x-y coordinates). Test if x-y coordinates of both 25-m-pixel rasters are the same. Ther may be a small shift or differences in the number of decimal places.
> >
> > Kind regards
> > Sibylle
> >
> >
> >
> > -----Original Message-----
> > From: Ivan Krylov <ikrylov at disroot.org>
> > Sent: Friday, August 16, 2024 11:45 AM
> > To: sibylle.stoeckli at gmx.ch
> > Cc: 'SIBYLLE ST?CKLI via R-help' <r-help at r-project.org>
> > Subject: Re: [R] allequal diff
> >
> > ? Fri, 16 Aug 2024 11:32:58 +0200
> > <sibylle.stoeckli at gmx.ch> ?????:
> >
> > > # values and mask r1
> > > r1 <- getValues(r1)
> > > mask1 <- is.na(r1)
> > > # Do the same for r2
> > > r2 <- getValues(r2_resampled)
> > > mask2 <- is.na(r2)
> > >
> > > # Combine the masks
> > > all.equal(r1[!(mask1 & mask2)], r2[!(mask1 & mask2)])
> >
> > Let's consider a more tangible example:
> >
> > # The vectors `x` and `y` start out equal x <- y <- 1:10 # But then their different elements are made missing x[c(1,3,4)] <- NA y[c(3,8)] <- NA
> >
> > Now, `is.na(x) & is.na(y)` gives the third element as the only element missing in both x and y:
> >
> > mask1 <- is.na(x)
> > mask2 <- is.na(y)
> > all.equal( # not the comparison you are looking for
> >  x[!(mask1 & mask2)], # still two more elements missing
> >  y[!(mask1 & mask2)]  # still one more element missing
> > )
> >
> > If you want to ignore all missing elements, you should combine the masks using the element-wise "or" operation ("missing in x and/or y"), not the element-wise "and" operation ("missing in both x and y at the same time"):
> >
> > mask1 & mask2 # drops element 3
> > # [1] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
> > mask1 | mask2 # drops elements 1, 3, 4, 8 # [1]  TRUE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE
> >
> > --
> > Best regards,
> > Ivan
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.


From p@u| @end|ng |rom @t@t@@uck|@nd@@c@nz  Sun Aug 18 22:44:36 2024
From: p@u| @end|ng |rom @t@t@@uck|@nd@@c@nz (Paul Murrell)
Date: Mon, 19 Aug 2024 08:44:36 +1200
Subject: [R] 
 Is there some place where I can check a changelog / NEWS for
 the grid package?
In-Reply-To: <be938ab0-9226-49c7-87b7-f02e011cef49@statistik.tu-dortmund.de>
References: <VI0PR02MB10493F23C33D115D0F54A62E794812@VI0PR02MB10493.eurprd02.prod.outlook.com>
 <be938ab0-9226-49c7-87b7-f02e011cef49@statistik.tu-dortmund.de>
Message-ID: <8fe6f92a-ea47-4390-b4fe-d65bc3f64ba0@stat.auckland.ac.nz>

Hi

On 17/08/2024 12:05 am, Uwe Ligges wrote:
> 
> 
> On 16.08.2024 13:46, Iago Gin? V?zquez wrote:
>> Hi all,
>>
>> On one hand, I wanted to ask if there is some place where I can check 
>> a changelog / NEWS for the grid package, as it is not on CRAN. And in 
>> that case, where can I find it?
> 
> Grid is part of R, hence you can look at R's NEWS, e.g. at
> 
> <https://cran.r-project.org/doc/manuals/r-devel/NEWS.html>
> 
> or directly in the svn commit messages at the svn server
> 
> svn.r-project.org/R/trunk/

NOTE that some changes to grid that do not warrant NEWS items may be in
src/library/grid/inst/doc/changes.txt

> 
> 
> 
> 
>> On the other hand, I wanted to ask you for tutorials to start 
>> understanding the grid package or what other recommendations you have 
>> of introductions to that package (and their extensions...)
> 
> Paul MUrrell wrote some papers and a book, but there are also the 
> vignettes, type
> 
> vignette(package="grid")
> 
> 
> to get an overview.
> 

This chapter from the first edition of the "R Graphics" book may be old 
but should mostly still be true ...

https://www.stat.auckland.ac.nz/~paul/RGraphics/chapter5.pdf

Paul

> Best,
> Uwe Ligges
> 
> 
>> Best regards,
>>
>> Iago
>>
>>
>>
>>
>>
>>
>>
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Dr Paul Murrell
Te Kura Tatauranga | Department of Statistics
Waipapa Taumata Rau | The University of Auckland
Private Bag 92019, Auckland, New Zealand
64 9 3737599 x85392
paul at stat.auckland.ac.nz
www.stat.auckland.ac.nz/~paul/


From bgunter@4567 @end|ng |rom gm@||@com  Sun Aug 18 23:20:58 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sun, 18 Aug 2024 14:20:58 -0700
Subject: [R] allequal diff
In-Reply-To: <8848865f-96a2-4fac-a34c-d948964e8a71@gmail.com>
References: <00f301daef15$02421d90$06c658b0$@gmx.ch>
 <71c8c7ca-88fb-4cb8-a2ce-1bf032932b00@gmail.com>
 <013e01daef9b$e4363ca0$aca2b5e0$@gmx.ch> <20240816102826.084fd808@Tarkus>
 <000a01daefb7$43eb5200$cbc1f600$@gmx.ch> <20240816115044.29208433@Tarkus>
 <001b01daefbf$4823aae0$d86b00a0$@gmx.ch> <20240816124524.4c73593b@Tarkus>
 <009601daf198$7292b070$57b81150$@gmx.ch>
 <CAGxFJbReUa+5imMCfZLS9z__+hyt4qXxfO-FAm8qnYcSvuma6w@mail.gmail.com>
 <8848865f-96a2-4fac-a34c-d948964e8a71@gmail.com>
Message-ID: <CAGxFJbTFjRnwYV0B3MuKAOyW3GOj0xfAfr_ks+_wAkHWRDV5gw@mail.gmail.com>

Ah...I see.

Perhaps, then, the maintainer should be contacted, as the desired
functionality seems similar to that provided in other all.equal
methods. I realize that this may often not elicit a (prompt) response.

-- Bert


On Sun, Aug 18, 2024 at 11:50?AM Ben Bolker <bbolker at gmail.com> wrote:
>
>     The OP's original problem is that the all.equal method for raster
> objects (raster:::all.equal.raster), which is a wrapper around the
> compareRaster() function, compares a bunch of different properties of
> rasters (extent, resolution, values, etc.) and only returns a single
> overall logical (TRUE/FALSE) value. OP wanted to see the magnitude of
> the difference (as you could get for more typical all.equal methods by
> using tolerance=0), but in order to do that one has to dig into the code
> of compareRaster() and pull out code to make the particular comparisons
> one wants by applying all.equal to specific components of the raster (it
> would be nice if there were a built-in way to get this information, but
> I don't know of one)
>
> On 8/18/24 14:40, Bert Gunter wrote:
> > "Is it true that all.equal just compares y values?"
> >
> > The following may be a bit more than you may have wanted, but I hope
> > it is nevertheless useful.
> >
> > The first place you should go to for questions like this is the Help
> > system, not here, i.e.
> > ?all.equal
> >
> > When you do this, you will find that all.equal() is a so-called S3
> > generic function, which, among other things, means that it works
> > differently (i.e. "dispatches") depending on its (usually) first
> > argument. So, for example, if the first argument is of (S3) class
> > "numeric", it will call the default method, all.equal.default(); if
> > it's a function, it will call all.equal.function().  Help for
> > all.equal's basic methods is found in the single all.equal (base) Help
> > page. However, for non-base R packages, there may be other different
> > methods provided for classed objects, e.g. perhaps of class "raster"
> > that would be found by ?all.equal.raster . Or maybe not, if the class
> > "inherits" from another class, such as "matrix" (Warning: I am
> > completely unfamiliar with the raster package, so these specifics are
> > very likely wrong).
> >
> > To sort this sort of thing out, It would probably be useful for you to
> > find a tutorial on R's S3 class  system (which is really a form of
> > multiple dispatch) and spend some time with it. There are many good
> > ones out there. This S3 system is widely used within R and many
> > packages, so doing this sort of homework now should serve you well in
> > your future R journey.
> >
> > All IMO obviously.
> >
> > Cheers,
> > Bert
> >
> >
> > On Sun, Aug 18, 2024 at 11:00?AM SIBYLLE ST?CKLI via R-help
> > <r-help at r-project.org> wrote:
> >> Dear Ivan
> >>
> >> Thanks a lot for this very nice example.
> >>
> >> Is it true that all.equal just compares y values?
> >> Based on this help here I think so and the value I got is the difference for the y-values.
> >> https://www.statology.org/all-equal-function-r/
> >>
> >> However, here I see x and y testing?
> >> https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/all.equal
> >> I am actually interested in the x values (x-y coordinates). Test if x-y coordinates of both 25-m-pixel rasters are the same. Ther may be a small shift or differences in the number of decimal places.
> >>
> >> Kind regards
> >> Sibylle
> >>
> >>
> >>
> >> -----Original Message-----
> >> From: Ivan Krylov <ikrylov at disroot.org>
> >> Sent: Friday, August 16, 2024 11:45 AM
> >> To: sibylle.stoeckli at gmx.ch
> >> Cc: 'SIBYLLE ST?CKLI via R-help' <r-help at r-project.org>
> >> Subject: Re: [R] allequal diff
> >>
> >> ? Fri, 16 Aug 2024 11:32:58 +0200
> >> <sibylle.stoeckli at gmx.ch> ?????:
> >>
> >>> # values and mask r1
> >>> r1 <- getValues(r1)
> >>> mask1 <- is.na(r1)
> >>> # Do the same for r2
> >>> r2 <- getValues(r2_resampled)
> >>> mask2 <- is.na(r2)
> >>>
> >>> # Combine the masks
> >>> all.equal(r1[!(mask1 & mask2)], r2[!(mask1 & mask2)])
> >> Let's consider a more tangible example:
> >>
> >> # The vectors `x` and `y` start out equal x <- y <- 1:10 # But then their different elements are made missing x[c(1,3,4)] <- NA y[c(3,8)] <- NA
> >>
> >> Now, `is.na(x) & is.na(y)` gives the third element as the only element missing in both x and y:
> >>
> >> mask1 <- is.na(x)
> >> mask2 <- is.na(y)
> >> all.equal( # not the comparison you are looking for
> >>   x[!(mask1 & mask2)], # still two more elements missing
> >>   y[!(mask1 & mask2)]  # still one more element missing
> >> )
> >>
> >> If you want to ignore all missing elements, you should combine the masks using the element-wise "or" operation ("missing in x and/or y"), not the element-wise "and" operation ("missing in both x and y at the same time"):
> >>
> >> mask1 & mask2 # drops element 3
> >> # [1] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
> >> mask1 | mask2 # drops elements 1, 3, 4, 8 # [1]  TRUE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE
> >>
> >> --
> >> Best regards,
> >> Ivan
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


