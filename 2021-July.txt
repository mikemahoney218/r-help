From jerem|eju@te @end|ng |rom gm@||@com  Thu Jul  1 10:06:00 2021
From: jerem|eju@te @end|ng |rom gm@||@com (Jeremie Juste)
Date: Thu, 01 Jul 2021 10:06:00 +0200
Subject: [R] Unexpected date format coercion
Message-ID: <87h7hexxuf.fsf@gmail.com>

Hello,

I have been surprised when converting a character string to a date with the following
format,

in R 4.1.0 (linux debian 10)

as.Date("20-12-2020","%Y-%m-%d")
[1] "20-12-20"

in R 4.0.5 (window 10)

as.Date("20-12-2020","%Y-%m-%d")
[1] "0020-12-20"


Here I was expecting a blunt and sharp NA, am I missing something?

Best regards,
Jeremie


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Thu Jul  1 10:21:06 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Thu, 1 Jul 2021 10:21:06 +0200
Subject: [R] Unexpected date format coercion
In-Reply-To: <87h7hexxuf.fsf@gmail.com>
References: <87h7hexxuf.fsf@gmail.com>
Message-ID: <a24a2311-8c50-add8-cf6f-dd8e0f66d9c6@statistik.tu-dortmund.de>



On 01.07.2021 10:06, Jeremie Juste wrote:
> Hello,
> 
> I have been surprised when converting a character string to a date with the following
> format,
> 
> in R 4.1.0 (linux debian 10)
> 
> as.Date("20-12-2020","%Y-%m-%d")
> [1] "20-12-20"
> 
> in R 4.0.5 (window 10)
> 
> as.Date("20-12-2020","%Y-%m-%d")
> [1] "0020-12-20"

Yes, it is rather strange to specify "2020" as the day and "20" as the 
4digits year, so different implementations may print the year in 2 or 4 
digits. What you want is actually

as.Date("20-12-2020","%d-%m-%Y")


Best,
Uwe Ligges






> 
> 
> Here I was expecting a blunt and sharp NA, am I missing something?
> 
> Best regards,
> Jeremie
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From drj|m|emon @end|ng |rom gm@||@com  Thu Jul  1 10:22:38 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Thu, 1 Jul 2021 18:22:38 +1000
Subject: [R] Unexpected date format coercion
In-Reply-To: <87h7hexxuf.fsf@gmail.com>
References: <87h7hexxuf.fsf@gmail.com>
Message-ID: <CA+8X3fWNW3jxQ5BBtdwKFx6v=L94W8PXKE1Ndqcn_T-ijjmFKA@mail.gmail.com>

Hi Jeremie,
Try:

as.Date("20-12-2020","%y-%m-%d")
[1] "2020-12-20"

Jim

On Thu, Jul 1, 2021 at 6:16 PM Jeremie Juste <jeremiejuste at gmail.com> wrote:
>
> Hello,
>
> I have been surprised when converting a character string to a date with the following
> format,
>
> in R 4.1.0 (linux debian 10)
>
> as.Date("20-12-2020","%Y-%m-%d")
> [1] "20-12-20"
>
> in R 4.0.5 (window 10)
>
> as.Date("20-12-2020","%Y-%m-%d")
> [1] "0020-12-20"
>
>
> Here I was expecting a blunt and sharp NA, am I missing something?
>
> Best regards,
> Jeremie
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From petr@p|k@| @end|ng |rom prechez@@cz  Thu Jul  1 10:25:03 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Thu, 1 Jul 2021 08:25:03 +0000
Subject: [R] Unexpected date format coercion
In-Reply-To: <87h7hexxuf.fsf@gmail.com>
References: <87h7hexxuf.fsf@gmail.com>
Message-ID: <dd9a943fea704f73b7e9994e9cffa1b5@SRVEXCHCM1302.precheza.cz>

Hm.

Seems to me, that both your codes are wrong but printing in Linux is
different from Windows.

With
as.Date("20-12-2020","%Y-%m-%d")
you say that 20 is year (actually year 20) and 2020 is day and only first
two values are taken (but with some valueas result is NA)

I can confirm 4.0.3 in Windows behaves this way too.
> as.Date("20-12-2020","%Y-%m-%d")
[1] "0020-12-20"

Cheers
Petr


> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Jeremie Juste
> Sent: Thursday, July 1, 2021 10:06 AM
> To: r-help <r-help at r-project.org>
> Subject: [R] Unexpected date format coercion
> 
> Hello,
> 
> I have been surprised when converting a character string to a date with
the
> following format,
> 
> in R 4.1.0 (linux debian 10)
> 
> as.Date("20-12-2020","%Y-%m-%d")
> [1] "20-12-20"
> 
> in R 4.0.5 (window 10)
> 
> as.Date("20-12-2020","%Y-%m-%d")
> [1] "0020-12-20"
> 
> 
> Here I was expecting a blunt and sharp NA, am I missing something?
> 
> Best regards,
> Jeremie
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

From jerem|eju@te @end|ng |rom gm@||@com  Thu Jul  1 11:00:03 2021
From: jerem|eju@te @end|ng |rom gm@||@com (Jeremie Juste)
Date: Thu, 01 Jul 2021 11:00:03 +0200
Subject: [R] Unexpected date format coercion
In-Reply-To: <dd9a943fea704f73b7e9994e9cffa1b5@SRVEXCHCM1302.precheza.cz>
 (PIKAL Petr's message of "Thu, 1 Jul 2021 08:25:03 +0000")
References: <87h7hexxuf.fsf@gmail.com>
 <dd9a943fea704f73b7e9994e9cffa1b5@SRVEXCHCM1302.precheza.cz>
Message-ID: <87a6n6xvcc.fsf@gmail.com>

Hello 

On Thursday,  1 Jul 2021 at 08:25, PIKAL Petr wrote:
> Hm.
>
> Seems to me, that both your codes are wrong but printing in Linux is
> different from Windows.
>
> With
> as.Date("20-12-2020","%Y-%m-%d")
> you say that 20 is year (actually year 20) and 2020 is day and only first
> two values are taken (but with some valueas result is NA)
>
> I can confirm 4.0.3 in Windows behaves this way too.
>> as.Date("20-12-2020","%Y-%m-%d")
> [1] "0020-12-20"

Many thanks for confirming this.


On Thursday,  1 Jul 2021 at 18:22, Jim Lemon wrote:
> Hi Jeremie,
> Try:
>
> as.Date("20-12-2020","%y-%m-%d")
> [1] "2020-12-20"

Thanks for this info. I'm looking for something that produce NA if the
date is not exactly in the specified format so that it can be
corrected. I was relying on the format parameter of the date for that.

The issue is that there can be so many variations in date format that for the time
being I still find it easier to delegate the correction to the user. A
particular nasty case is when there are multiple date format in the same
column.


Best regards,
Jeremie


From drj|m|emon @end|ng |rom gm@||@com  Thu Jul  1 11:17:09 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Thu, 1 Jul 2021 19:17:09 +1000
Subject: [R] Bibliometix Package Question
In-Reply-To: <QB1PR01MB28840252F4B7F57DDF5ED0C682019@QB1PR01MB2884.CANPRD01.PROD.OUTLOOK.COM>
References: <QB1PR01MB28840252F4B7F57DDF5ED0C682019@QB1PR01MB2884.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <CA+8X3fWjORDSjgFh--TpJOCL33CAjVgDjqbQO4VF5gyi7f8-4A@mail.gmail.com>

Hi Adrianna,
I can see why you may be confused about the input file to create the
dataframe for bibliometrix. Looking at the 'convert2db' function, it
seems to shuffle the various formats to a common order used by other
functions. The help page describes that order. I would look at the
sample file 'scientometrics' as it seems to be a plain text file. If
you set up your CSV file in that format, it should be read by the
convert2df function with the default 'plaintext' format argument.

Jim

On Thu, Jul 1, 2021 at 6:06 PM Perryman, Adrianna
<Adrianna.Perryman at uhnresearch.ca> wrote:
>
> Hello,
>
> My name is Adrianna, I am a student researcher at the University Health Network in Toronto. I am working on a bibliometric analysis and would like to use R. My search involves five databases: MEDLINE (Ovid), AJOL, EMBASE, African Medicus Index and Web of Science. We expect to gather thousands of results based on our search and we have to undergo a cleaning processes to remove duplicates and exclude any articles that do not fit our inclusion criteria.  Given the codes for running the bibliometric analysis I am inquiring whether it is possible to upload a csv or excel file after cleaning the data to then run the analysis?
>
> If you have any other tips, please let me know the help is greatly appreciated.
>
> I look forward to hearing back from you.
>
> Thank you again!
>
> Best,
>
> Adrianna Perryman
>
> This e-mail may contain confidential and/or privileged information for the sole use of the intended recipient.
> Any review or distribution by anyone other than the person for whom it was originally intended is strictly prohibited.
> If you have received this e-mail in error, please contact the sender and delete all copies.
> Opinions, conclusions or other information contained in this e-mail may not be that of the organization.
>
> If you feel you have received an email from UHN of a commercial nature and would like to be removed from the sender's mailing list please do one of the following:
> (1) Follow any unsubscribe process the sender has included in their email
> (2) Where no unsubscribe process has been included, reply to the sender and type "unsubscribe" in the subject line. If you require additional information please go to our UHN Newsletters and Mailing Lists page.
> Please note that we are unable to automatically unsubscribe individuals from all UHN mailing lists.
>
>
> Patient Consent for Email:
>
> UHN patients may provide their consent to communicate with UHN about their care using email. All electronic communication carries some risk. Please visit our website here<https://www.uhn.ca/PatientsFamilies/Patient_Safety_Advocacy/Privacy/Documents/Email_consent_and_safety.pdf> to learn about the risks of electronic communication and how to protect your privacy. You may withdraw your consent to receive emails from UHN at any time. Please contact your care provider, if you do not wish to receive emails from UHN.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From petr@p|k@| @end|ng |rom prechez@@cz  Thu Jul  1 12:28:43 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Thu, 1 Jul 2021 10:28:43 +0000
Subject: [R] Unexpected date format coercion
In-Reply-To: <87a6n6xvcc.fsf@gmail.com>
References: <87h7hexxuf.fsf@gmail.com>
 <dd9a943fea704f73b7e9994e9cffa1b5@SRVEXCHCM1302.precheza.cz>
 <87a6n6xvcc.fsf@gmail.com>
Message-ID: <b12b1526e7bb451985d139483bbfd8cf@SRVEXCHCM1302.precheza.cz>

Hi

Maybe you could inspect

parse_date_time {lubridate}	R Documentation

from package lubridate.

Or see answers here

https://stackoverflow.com/questions/25463523/how-to-convert-variable-with-mixed-date-formats-to-one-format

Cheers
Petr

> -----Original Message-----
> From: Jeremie Juste <jeremiejuste at gmail.com>
> Sent: Thursday, July 1, 2021 11:00 AM
> To: PIKAL Petr <petr.pikal at precheza.cz>
> Cc: r-help <r-help at r-project.org>
> Subject: Re: [R] Unexpected date format coercion
>
> Hello
>
> On Thursday,  1 Jul 2021 at 08:25, PIKAL Petr wrote:
> > Hm.
> >
> > Seems to me, that both your codes are wrong but printing in Linux is
> > different from Windows.
> >
> > With
> > as.Date("20-12-2020","%Y-%m-%d")
> > you say that 20 is year (actually year 20) and 2020 is day and only
> > first two values are taken (but with some valueas result is NA)
> >
> > I can confirm 4.0.3 in Windows behaves this way too.
> >> as.Date("20-12-2020","%Y-%m-%d")
> > [1] "0020-12-20"
>
> Many thanks for confirming this.
>
>
> On Thursday,  1 Jul 2021 at 18:22, Jim Lemon wrote:
> > Hi Jeremie,
> > Try:
> >
> > as.Date("20-12-2020","%y-%m-%d")
> > [1] "2020-12-20"
>
> Thanks for this info. I'm looking for something that produce NA if the date 
> is
> not exactly in the specified format so that it can be corrected. I was 
> relying on
> the format parameter of the date for that.
>
> The issue is that there can be so many variations in date format that for 
> the
> time being I still find it easier to delegate the correction to the user. A
> particular nasty case is when there are multiple date format in the same
> column.
>
>
> Best regards,
> Jeremie


From e@ @end|ng |rom enr|co@chum@nn@net  Thu Jul  1 12:46:08 2021
From: e@ @end|ng |rom enr|co@chum@nn@net (Enrico Schumann)
Date: Thu, 01 Jul 2021 12:46:08 +0200
Subject: [R] Unexpected date format coercion
In-Reply-To: <87a6n6xvcc.fsf@gmail.com> (Jeremie Juste's message of "Thu, 01
 Jul 2021 11:00:03 +0200")
References: <87h7hexxuf.fsf@gmail.com>
 <dd9a943fea704f73b7e9994e9cffa1b5@SRVEXCHCM1302.precheza.cz>
 <87a6n6xvcc.fsf@gmail.com>
Message-ID: <87tules45r.fsf@enricoschumann.net>

On Thu, 01 Jul 2021, Jeremie Juste writes:

> Hello 
>
> On Thursday,  1 Jul 2021 at 08:25, PIKAL Petr wrote:
>> Hm.
>>
>> Seems to me, that both your codes are wrong but printing in Linux is
>> different from Windows.
>>
>> With
>> as.Date("20-12-2020","%Y-%m-%d")
>> you say that 20 is year (actually year 20) and 2020 is day and only first
>> two values are taken (but with some valueas result is NA)
>>
>> I can confirm 4.0.3 in Windows behaves this way too.
>>> as.Date("20-12-2020","%Y-%m-%d")
>> [1] "0020-12-20"
>
> Many thanks for confirming this.
>
>
> On Thursday,  1 Jul 2021 at 18:22, Jim Lemon wrote:
>> Hi Jeremie,
>> Try:
>>
>> as.Date("20-12-2020","%y-%m-%d")
>> [1] "2020-12-20"
>
> Thanks for this info. I'm looking for something that produce NA if the
> date is not exactly in the specified format so that it can be
> corrected. I was relying on the format parameter of the date for that.
>
> The issue is that there can be so many variations in date format that for the time
> being I still find it easier to delegate the correction to the user. A
> particular nasty case is when there are multiple date format in the same
> column.
>
>
> Best regards,
> Jeremie
>

You could explicitly test whether the specified format
is as expcected, perhaps with a regex such as

    s <- c("2020-01-20", "20-12-2020")
    grepl("^[0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9]$", s)

and/or by checking the components of the dates:

    valid_Date <- function(s) {
        tmp <- strsplit(s, "[-]")
    
        year <- as.numeric(sapply(tmp, `[[`, 1))
        valid.year <- year < 2500 & year > 1800
    
        month <- as.numeric(sapply(tmp, `[[`, 2))
        valid.month <- month >= 0 & month <= 12
    
        day <- as.numeric(sapply(tmp, `[[`, 3))
        valid.day <- day >= 1 & day <= 31
    
        ans <- as.Date(s)
        ans[!(valid.year & valid.month & valid.day)] <- NA
        ans    
    }



-- 
Enrico Schumann
Lucerne, Switzerland
http://enricoschumann.net


From t@v|b@r @end|ng |rom gm@||@com  Thu Jul  1 16:36:06 2021
From: t@v|b@r @end|ng |rom gm@||@com (Micha Silver)
Date: Thu, 1 Jul 2021 17:36:06 +0300
Subject: [R] concatenating columns in data.frame
Message-ID: <e0a0d23f-c4a6-540c-be31-90ba894dba11@gmail.com>

I need to create a new data.frame column as a concatenation of existing 
character columns. But the number and name of the columns to concatenate 
needs to be passed in dynamically. The code below does what I want, but 
seems very clumsy. Any suggestions how to improve?


df = data.frame("A"=sample(letters, 10), "B"=sample(letters, 10), 
"C"=sample(letters,10), "D"=sample(letters, 10))

# Which columns to concat:

use_columns = c("D", "B")


UpdateCombo = function(df, use_columns) {
 ??? use_df = df[, use_columns]
 ??? combo_list = lapply(1:nrow(use_df), function(r) {
 ??? r_combo = paste(use_df[r,], collapse="_")
 ??? return(data.frame("Combo" = r_combo))
 ??? })
 ??? combo = do.call(rbind, combo_list)

 ??? names(combo) = "Combo"

 ??? return(combo)

}


combo_col = UpdateCombo(df, use_columns)

df_combo = do.call(cbind, list(df, combo_col))


Thanks


-- 
Micha Silver
Ben Gurion Univ.
Sde Boker, Remote Sensing Lab
cell: +972-523-665918


From er|cjberger @end|ng |rom gm@||@com  Thu Jul  1 17:30:45 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Thu, 1 Jul 2021 18:30:45 +0300
Subject: [R] concatenating columns in data.frame
In-Reply-To: <e0a0d23f-c4a6-540c-be31-90ba894dba11@gmail.com>
References: <e0a0d23f-c4a6-540c-be31-90ba894dba11@gmail.com>
Message-ID: <CAGgJW74mVhJvaQSxChuSHi8wMwjRVoYxSw6KCsPA4cL1hqR=xQ@mail.gmail.com>

You can do the same steps but without so much intermediate saving to
shorten it

f <- function(x) {
  do.call(rbind,lapply(1:nrow(x),
                       function(r) {paste(x[r,], collapse="_")}))
}

df_combo <- cbind(df,Combo=f(df[,c(4,2)]))

HTH,
Eric


On Thu, Jul 1, 2021 at 5:37 PM Micha Silver <tsvibar at gmail.com> wrote:

> I need to create a new data.frame column as a concatenation of existing
> character columns. But the number and name of the columns to concatenate
> needs to be passed in dynamically. The code below does what I want, but
> seems very clumsy. Any suggestions how to improve?
>
>
> df = data.frame("A"=sample(letters, 10), "B"=sample(letters, 10),
> "C"=sample(letters,10), "D"=sample(letters, 10))
>
> # Which columns to concat:
>
> use_columns = c("D", "B")
>
>
> UpdateCombo = function(df, use_columns) {
>      use_df = df[, use_columns]
>      combo_list = lapply(1:nrow(use_df), function(r) {
>      r_combo = paste(use_df[r,], collapse="_")
>      return(data.frame("Combo" = r_combo))
>      })
>      combo = do.call(rbind, combo_list)
>
>      names(combo) = "Combo"
>
>      return(combo)
>
> }
>
>
> combo_col = UpdateCombo(df, use_columns)
>
> df_combo = do.call(cbind, list(df, combo_col))
>
>
> Thanks
>
>
> --
> Micha Silver
> Ben Gurion Univ.
> Sde Boker, Remote Sensing Lab
> cell: +972-523-665918
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ccberry @end|ng |rom he@|th@uc@d@edu  Thu Jul  1 20:02:38 2021
From: ccberry @end|ng |rom he@|th@uc@d@edu (Berry, Charles)
Date: Thu, 1 Jul 2021 18:02:38 +0000
Subject: [R] concatenating columns in data.frame
In-Reply-To: <e0a0d23f-c4a6-540c-be31-90ba894dba11@gmail.com>
References: <e0a0d23f-c4a6-540c-be31-90ba894dba11@gmail.com>
Message-ID: <2C4F38E3-0317-4D9E-ABA8-5AA2F6AE6219@health.ucsd.edu>



> On Jul 1, 2021, at 7:36 AM, Micha Silver <tsvibar at gmail.com> wrote:
> 
> I need to create a new data.frame column as a concatenation of existing character columns. But the number and name of the columns to concatenate needs to be passed in dynamically. The code below does what I want, but seems very clumsy. Any suggestions how to improve?
> 
> 
> df = data.frame("A"=sample(letters, 10), "B"=sample(letters, 10), "C"=sample(letters,10), "D"=sample(letters, 10))
> 
> # Which columns to concat:
> 
> use_columns = c("D", "B")
> 
> 
> UpdateCombo = function(df, use_columns) {
>     use_df = df[, use_columns]
>     combo_list = lapply(1:nrow(use_df), function(r) {
>     r_combo = paste(use_df[r,], collapse="_")
>     return(data.frame("Combo" = r_combo))
>     })
>     combo = do.call(rbind, combo_list)
> 
>     names(combo) = "Combo"
> 
>     return(combo)
> 
> }
> 
> 
> combo_col = UpdateCombo(df, use_columns)
> 
> df_combo = do.call(cbind, list(df, combo_col))
> 
> 


I'd do this:


UpdateCombo <-
  function(df, use_columns){
    pasteUnder <- function(...) paste(..., sep="_")
    do.call(pasteUnder, df[, use_columns])
  }

df_combo <- cbind(df, Combo=UpdateCombo(df, use_columns))

HTH,
Chuck


From bgunter@4567 @end|ng |rom gm@||@com  Thu Jul  1 20:24:59 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 1 Jul 2021 11:24:59 -0700
Subject: [R] concatenating columns in data.frame
In-Reply-To: <e0a0d23f-c4a6-540c-be31-90ba894dba11@gmail.com>
References: <e0a0d23f-c4a6-540c-be31-90ba894dba11@gmail.com>
Message-ID: <CAGxFJbS1axyb3DLTXXhsV6+BK-rUfOH5-=7Vt8Vz47MyNVr0cA@mail.gmail.com>

Why not simply:

## reprex
set.seed(123)
df = data.frame("A"=sample(letters, 10), "B"=sample(letters, 10),
                "C"=sample(letters,10), "D"=sample(letters, 10))
df
use_columns = c("D", "B")

## one liner
df$combo_col <- do.call(paste,c(df[,use_columns], sep = "_"))
df

In case you are wondering, this works because by definition *a date
frame **is** a list*, so the concatenation is list concatenation.


Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Thu, Jul 1, 2021 at 7:37 AM Micha Silver <tsvibar at gmail.com> wrote:
>
> I need to create a new data.frame column as a concatenation of existing
> character columns. But the number and name of the columns to concatenate
> needs to be passed in dynamically. The code below does what I want, but
> seems very clumsy. Any suggestions how to improve?
>
>
> df = data.frame("A"=sample(letters, 10), "B"=sample(letters, 10),
> "C"=sample(letters,10), "D"=sample(letters, 10))
>
> # Which columns to concat:
>
> use_columns = c("D", "B")
>
>
> UpdateCombo = function(df, use_columns) {
>      use_df = df[, use_columns]
>      combo_list = lapply(1:nrow(use_df), function(r) {
>      r_combo = paste(use_df[r,], collapse="_")
>      return(data.frame("Combo" = r_combo))
>      })
>      combo = do.call(rbind, combo_list)
>
>      names(combo) = "Combo"
>
>      return(combo)
>
> }
>
>
> combo_col = UpdateCombo(df, use_columns)
>
> df_combo = do.call(cbind, list(df, combo_col))
>
>
> Thanks
>
>
> --
> Micha Silver
> Ben Gurion Univ.
> Sde Boker, Remote Sensing Lab
> cell: +972-523-665918
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ccberry @end|ng |rom he@|th@uc@d@edu  Thu Jul  1 21:15:19 2021
From: ccberry @end|ng |rom he@|th@uc@d@edu (Berry, Charles)
Date: Thu, 1 Jul 2021 19:15:19 +0000
Subject: [R] concatenating columns in data.frame
In-Reply-To: <CAGxFJbS1axyb3DLTXXhsV6+BK-rUfOH5-=7Vt8Vz47MyNVr0cA@mail.gmail.com>
References: <e0a0d23f-c4a6-540c-be31-90ba894dba11@gmail.com>
 <CAGxFJbS1axyb3DLTXXhsV6+BK-rUfOH5-=7Vt8Vz47MyNVr0cA@mail.gmail.com>
Message-ID: <3E1A7175-80E4-4E61-A74B-5CB092F6F114@health.ucsd.edu>



> On Jul 1, 2021, at 11:24 AM, Bert Gunter <bgunter.4567 at gmail.com> wrote:
> 
> Why not simply:
> 
> ## reprex
> set.seed(123)
> df = data.frame("A"=sample(letters, 10), "B"=sample(letters, 10),
>                "C"=sample(letters,10), "D"=sample(letters, 10))
> df
> use_columns = c("D", "B")
> 
> ## one liner
> df$combo_col <- do.call(paste,c(df[,use_columns], sep = "_"))
> df
> 
> In case you are wondering, this works because by definition *a date
> frame **is** a list*, so the concatenation is list concatenation.
> 

Why not? 

Because I erroneously thought that there is a "data.frame' method for `c` and that this would cause a problem.

But I was wrong, so your solution wins.

Best,
Chuck

From er|cjberger @end|ng |rom gm@||@com  Thu Jul  1 21:29:44 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Thu, 1 Jul 2021 22:29:44 +0300
Subject: [R] concatenating columns in data.frame
In-Reply-To: <3E1A7175-80E4-4E61-A74B-5CB092F6F114@health.ucsd.edu>
References: <e0a0d23f-c4a6-540c-be31-90ba894dba11@gmail.com>
 <CAGxFJbS1axyb3DLTXXhsV6+BK-rUfOH5-=7Vt8Vz47MyNVr0cA@mail.gmail.com>
 <3E1A7175-80E4-4E61-A74B-5CB092F6F114@health.ucsd.edu>
Message-ID: <CAGgJW77tMEumNTSMuZ1EwxfR2-f_1qw52Kdo=1J_osgBSZuKHw@mail.gmail.com>

Lovely one-liner Bert. Chapeau

On Thu, Jul 1, 2021 at 10:16 PM Berry, Charles <ccberry at health.ucsd.edu>
wrote:

>
>
> > On Jul 1, 2021, at 11:24 AM, Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >
> > Why not simply:
> >
> > ## reprex
> > set.seed(123)
> > df = data.frame("A"=sample(letters, 10), "B"=sample(letters, 10),
> >                "C"=sample(letters,10), "D"=sample(letters, 10))
> > df
> > use_columns = c("D", "B")
> >
> > ## one liner
> > df$combo_col <- do.call(paste,c(df[,use_columns], sep = "_"))
> > df
> >
> > In case you are wondering, this works because by definition *a date
> > frame **is** a list*, so the concatenation is list concatenation.
> >
>
> Why not?
>
> Because I erroneously thought that there is a "data.frame' method for `c`
> and that this would cause a problem.
>
> But I was wrong, so your solution wins.
>
> Best,
> Chuck
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From y@ngk@|9999 @end|ng |rom y@hoo@com  Fri Jul  2 00:36:46 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Thu, 1 Jul 2021 22:36:46 +0000 (UTC)
Subject: [R] get data frame using DBI package
References: <603069184.1753441.1625179006705.ref@mail.yahoo.com>
Message-ID: <603069184.1753441.1625179006705@mail.yahoo.com>

Hi List,I use odbc to connect a MSSQL server. When I run the script of "res <- dbSendQuery(con, "SELECT * FROM BIODBX.MECCUNIQUE2")", the res is "Formal class OdbcResult".?Can someone help me to modify the code to get a data frame?Thanks,Kai
	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Jul  2 00:49:31 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 01 Jul 2021 15:49:31 -0700
Subject: [R] get data frame using DBI package
In-Reply-To: <603069184.1753441.1625179006705@mail.yahoo.com>
References: <603069184.1753441.1625179006705.ref@mail.yahoo.com>
 <603069184.1753441.1625179006705@mail.yahoo.com>
Message-ID: <15820779-B515-4413-B6E8-D1506BFE0803@dcn.davis.ca.us>

Please make the effort to post plain text email... formatted email gets stripped and what remains is often garbled.

Most people use dbGetQuery... but reading the help page accessible via ?dbSendQuery should clarify how it should be used.

On July 1, 2021 3:36:46 PM PDT, Kai Yang via R-help <r-help at r-project.org> wrote:
>Hi List,I use odbc to connect a MSSQL server. When I run the script of
>"res <- dbSendQuery(con, "SELECT * FROM BIODBX.MECCUNIQUE2")", the res
>is "Formal class OdbcResult".?Can someone help me to modify the code to
>get a data frame?Thanks,Kai
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From j@p@rk4 @end|ng |rom u|c@edu  Fri Jul  2 02:35:09 2021
From: j@p@rk4 @end|ng |rom u|c@edu (Sparks, John)
Date: Fri, 2 Jul 2021 00:35:09 +0000
Subject: [R] List  / Matrix to Data Frame
Message-ID: <CH2PR13MB3640B172896B6B89B1A65431FA1F9@CH2PR13MB3640.namprd13.prod.outlook.com>

Hi R-Helpers,

I am taking it upon myself to delve into the world of lists for R.  In no small part because I appear to have discovered a source of data for an exceptionally good price but that delivers much of that data in json format.

So over the last day or so I managed to fight the list processing tools to a draw and get a list that has only selected elements (actually it ends up in matrix form).  But when I try to convert that to a data frame I can't get it to a form that is workable.

I have visited some pages about converting a matrix to a data frame but they result in highly redundant and inelegant data.

I am thinking that someone who works with lists and matrices knows how to do this quite easily and would be willing to provide a solution.

The reproducible example is shown below.  Just to be explicit, what I am trying to get to is something along the lines of a data frame like this.

Date              netIncome      Gross Profit
2020-09-30 57411000000 104956000000
2019-09-30 55256000000   98392000000

.....

The closest I get is a matrix that looks like this

> wanted
            2020-09-30        2019-09-30       2018-09-30        2017-09-30       2016-09-30       2015-09-30       2014-09-30
date        "2020-09-30"      "2019-09-30"     "2018-09-30"      "2017-09-30"     "2016-09-30"     "2015-09-30"     "2014-09-30"
netIncome   "57411000000.00"  "55256000000.00" "59531000000.00"  "48351000000.00" "45687000000.00" "53394000000.00" "39510000000.00"
grossProfit "104956000000.00" "98392000000.00" "101839000000.00" "88186000000.00" "84263000000.00" "93626000000.00" "70537000000.00"

Code for example

library(jsonlite)
test <- jsonlite::fromJSON("https://eodhistoricaldata.com/api/fundamentals/AAPL.US?api_token=OeAFFmMliFG5orCUuwAKQ8l4WWFQ67YX")

hist<-test[[13]]
ISY<-hist$Income_Statement$yearly
wanted<-sapply(ISY, "[", j = c("date","netIncome","grossProfit"))


Your guidance would be much appreciated.

--John J. Sparks, Ph.D.

	[[alternative HTML version deleted]]


From w||||@mwdun|@p @end|ng |rom gm@||@com  Fri Jul  2 03:01:27 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Thu, 1 Jul 2021 18:01:27 -0700
Subject: [R] List / Matrix to Data Frame
In-Reply-To: <CH2PR13MB3640B172896B6B89B1A65431FA1F9@CH2PR13MB3640.namprd13.prod.outlook.com>
References: <CH2PR13MB3640B172896B6B89B1A65431FA1F9@CH2PR13MB3640.namprd13.prod.outlook.com>
Message-ID: <CAHqSRuQ=8YmMece_4-qoQc6vxcrhx9Q6Wiv_M1drF79fGjwmWg@mail.gmail.com>

Does this do what you want?

> df <- data.frame(check.names=FALSE,
lapply(c(Date="date",netIncome="netIncome",`Gross Profit`="grossProfit"),
function(nm)vapply(ISY, "[[", nm, FUN.VALUE=NA_character_)))
> str(df)
'data.frame':   36 obs. of  3 variables:
 $ Date        : chr  "2020-09-30" "2019-09-30" "2018-09-30" "2017-09-30"
...
 $ netIncome   : chr  "57411000000.00" "55256000000.00" "59531000000.00"
"48351000000.00" ...
 $ Gross Profit: chr  "104956000000.00" "98392000000.00" "101839000000.00"
"88186000000.00" ...
> df$Date <- as.Date(df$Date)
> df$netIncome <- as.numeric(df$netIncome)
> df$`Gross Profit` <- as.numeric(df$`Gross Profit`)
> str(df)
'data.frame':   36 obs. of  3 variables:
 $ Date        : Date, format: "2020-09-30" "2019-09-30" "2018-09-30"
"2017-09-30" ...
 $ netIncome   : num  5.74e+10 5.53e+10 5.95e+10 4.84e+10 4.57e+10 ...
 $ Gross Profit: num  1.05e+11 9.84e+10 1.02e+11 8.82e+10 8.43e+10 ...
> with(df, plot(Date, netIncome))

On Thu, Jul 1, 2021 at 5:35 PM Sparks, John <jspark4 at uic.edu> wrote:

> Hi R-Helpers,
>
> I am taking it upon myself to delve into the world of lists for R.  In no
> small part because I appear to have discovered a source of data for an
> exceptionally good price but that delivers much of that data in json format.
>
> So over the last day or so I managed to fight the list processing tools to
> a draw and get a list that has only selected elements (actually it ends up
> in matrix form).  But when I try to convert that to a data frame I can't
> get it to a form that is workable.
>
> I have visited some pages about converting a matrix to a data frame but
> they result in highly redundant and inelegant data.
>
> I am thinking that someone who works with lists and matrices knows how to
> do this quite easily and would be willing to provide a solution.
>
> The reproducible example is shown below.  Just to be explicit, what I am
> trying to get to is something along the lines of a data frame like this.
>
> Date              netIncome      Gross Profit
> 2020-09-30 57411000000 104956000000
> 2019-09-30 55256000000   98392000000
>
> .....
>
> The closest I get is a matrix that looks like this
>
> > wanted
>             2020-09-30        2019-09-30       2018-09-30
> 2017-09-30       2016-09-30       2015-09-30       2014-09-30
> date        "2020-09-30"      "2019-09-30"     "2018-09-30"
> "2017-09-30"     "2016-09-30"     "2015-09-30"     "2014-09-30"
> netIncome   "57411000000.00"  "55256000000.00" "59531000000.00"
> "48351000000.00" "45687000000.00" "53394000000.00" "39510000000.00"
> grossProfit "104956000000.00" "98392000000.00" "101839000000.00"
> "88186000000.00" "84263000000.00" "93626000000.00" "70537000000.00"
>
> Code for example
>
> library(jsonlite)
> test <- jsonlite::fromJSON("
> https://eodhistoricaldata.com/api/fundamentals/AAPL.US?api_token=OeAFFmMliFG5orCUuwAKQ8l4WWFQ67YX
> ")
>
> hist<-test[[13]]
> ISY<-hist$Income_Statement$yearly
> wanted<-sapply(ISY, "[", j = c("date","netIncome","grossProfit"))
>
>
> Your guidance would be much appreciated.
>
> --John J. Sparks, Ph.D.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @v|gro@@ @end|ng |rom ver|zon@net  Fri Jul  2 05:41:06 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Thu, 1 Jul 2021 23:41:06 -0400
Subject: [R] concatenating columns in data.frame
References: <e0a0d23f-c4a6-540c-be31-90ba894dba11@gmail.com> 
Message-ID: <056701d76ef4$173342f0$4599c8d0$@verizon.net>

Micha,

Others have provided ways in standard R so I will contribute a somewhat odd solution using the dplyr and related packages in the tidyverse including a sample data.frame/tibble I made. It requires newer versions of R and other  packages as it uses some fairly esoteric features including "the big bang" and the new ":=" operator and more.

You can use your own data with whatever columns you need, of course.

The goal is to have umpteen columns in the data that you want to add an additional columns to an existing tibble that is the result of concatenating the rowwise contents of a dynamically supplied vector of column names in quotes. First we need something to work with so here is a sample:

#--start
# load required packages, or a bunch at once!
library(tidyverse)

# Pick how many rows you want. For a demo, 3 is plenty N <- 3

# Make a sample tibble with N rows and the following 4 columns mydf <- tibble(alpha = 1:N, 
               beta=letters[1:N],
               gamma = N:1,
               delta = month.abb[1:N])

# show the original tibble
print(mydf)
#--end

In flat text mode, here is the output:

> print(mydf)
# A tibble: 3 x 4
alpha beta  gamma delta
<int> <chr> <int> <chr>
  1     1 a         3 Jan  
2     2 b         2 Feb  
3     3 c         1 Mar

Now I want to make a function that is used instead of the mutate verb. I made a weird one-liner that is a tad hard to explain so first let me mention the requirements.

It will take a first argument that is a tibble and in a pipeline this would be passed invisibly.
The second required argument is a vector or list containing the names of the columns as strings. A column can be re-used multiple times.
The third optional argument is what to name the new column with a default if omitted.
The fourth optional argument allows you to choose a different separator than "" if you wish.

The function should be usable in a pipeline on both sides so it should also return the input tibble with an extra column to the output.

Here is the function:

my_mutate <- function(df, columns, colnew="concatenated", sep=""){
  df %>%
    mutate( "{colnew}" := paste(!!!rlang::syms(columns), sep = sep )) }

Yes, the above can be done inline as a long one-liner:

my_mutate <- function(df, columns, colnew="concatenated", sep="") mutate(df, "{colnew}" := paste(!!!rlang::syms(columns), sep = sep ))

Here are examples of it running:


> choices <- c("beta", "delta", "alpha", "delta") mydf %>% 
> my_mutate(choices, "me2")
# A tibble: 3 x 5
alpha beta  gamma delta me2     
<int> <chr> <int> <chr> <chr>   
  1     1 a         3 Jan   aJan1Jan
2     2 b         2 Feb   bFeb2Feb
3     3 c         1 Mar   cMar3Mar
> mydf %>% my_mutate(choices, "me2",":")
# A tibble: 3 x 5
alpha beta  gamma delta me2        
<int> <chr> <int> <chr> <chr>      
  1     1 a         3 Jan   a:Jan:1:Jan
2     2 b         2 Feb   b:Feb:2:Feb
3     3 c         1 Mar   c:Mar:3:Mar
> mydf %>% my_mutate(c("beta", "beta", "gamma", "gamma", "delta", 
> "alpha"))
# A tibble: 3 x 5
alpha beta  gamma delta concatenated
<int> <chr> <int> <chr> <chr>       
  1     1 a         3 Jan   aa33Jan1    
2     2 b         2 Feb   bb22Feb2    
3     3 c         1 Mar   cc11Mar3    
> mydf %>% my_mutate(list("beta", "beta", "gamma", "gamma", "delta", 
> "alpha"))
# A tibble: 3 x 5
alpha beta  gamma delta concatenated
<int> <chr> <int> <chr> <chr>       
  1     1 a         3 Jan   aa33Jan1    
2     2 b         2 Feb   bb22Feb2    
3     3 c         1 Mar   cc11Mar3    
> mydf %>% my_mutate(columns=list("alpha", "beta", "gamma", "delta", 
> "gamma", "beta", "alpha"),
                     +                    sep="/*/",
                     +                    colnew="NewRandomNAME"
                     +                    )
# A tibble: 3 x 5
alpha beta  gamma delta NewRandomNAME              
<int> <chr> <int> <chr> <chr>                      
  1     1 a         3 Jan   1/*/a/*/3/*/Jan/*/3/*/a/*/1
2     2 b         2 Feb   2/*/b/*/2/*/Feb/*/2/*/b/*/2
3     3 c         1 Mar   3/*/c/*/1/*/Mar/*/1/*/c/*/3

Does this meet your normal need? Just to show it works in a pipeline, here is a variant:

mydf %>%
  tail(2) %>%
  my_mutate(c("beta", "beta"), "betabeta") %>%
  print() %>%
  my_mutate(list("alpha", "betabeta", "gamma"),
            "buildson", 
            "&")

The above only keeps the last two lines of the tibble, makes a double copy of "beta" under a new name, prints the intermediate result, continues to make another concatenation using the variable created earlier then prints the result:

Here is the run:

> mydf %>%
  +   tail(2) %>%
  +   my_mutate(c("beta", "beta"), "betabeta") %>%
  +   print() %>%
  +   my_mutate(list("alpha", "betabeta", "gamma"),
                +             "buildson", 
                +             "&")
# A tibble: 2 x 5
alpha beta  gamma delta betabeta
<int> <chr> <int> <chr> <chr>   
  1     2 b         2 Feb   bb      
2     3 c         1 Mar   cc      
# A tibble: 2 x 6
alpha beta  gamma delta betabeta buildson
<int> <chr> <int> <chr> <chr>    <chr>   
  1     2 b         2 Feb   bb       2&bb&2  
2     3 c         1 Mar   cc       3&cc&1  

As to how the darn function works, that was a learning experience for me to build using features I have not had occasion to use. If anyone remains interested, read on. 

The following needs newish features:

	"{colnew}" := SOMETHING

The colon-equals operator in newer R/dplyr can be sort of used in an odd way that allows the name of the variable to be in quotes and in brackets akin to the way glue() does it. The variable colnew is evaluated and substituted so the name used for the column is now dynamic.

The function does a paste using this:

	!!!rlang::syms(columns)

The problem is paste() wants multiple arguments and we have a single argument that is either a vector or another kind of vector called a list. The trick is to convert the vector into symbols then use "!!!" to convert something like 'c("alpha", "beta", "gamma")' into something more like ' "alpha", "beta", "gamma" ' so that paste sees them as multiple arguments to concatenate in vector fashion.

And, the function is not polished but I am sure you can all see some of what is needed like checking the arguments for validity, including not having a name for the new column that clashes with existing column names, doing something sane if no columns to concatenate are offered and so on.

Just showing a different approach. The base R methods are fine.

- Avi

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Micha Silver
Sent: Thursday, July 1, 2021 10:36 AM
To: R-help at r-project.org
Subject: [R] concatenating columns in data.frame

I need to create a new data.frame column as a concatenation of existing character columns. But the number and name of the columns to concatenate needs to be passed in dynamically. The code below does what I want, but seems very clumsy. Any suggestions how to improve?


df = data.frame("A"=sample(letters, 10), "B"=sample(letters, 10), "C"=sample(letters,10), "D"=sample(letters, 10))

# Which columns to concat:

use_columns = c("D", "B")


UpdateCombo = function(df, use_columns) {
     use_df = df[, use_columns]
     combo_list = lapply(1:nrow(use_df), function(r) {
     r_combo = paste(use_df[r,], collapse="_")
     return(data.frame("Combo" = r_combo))
     })
     combo = do.call(rbind, combo_list)

     names(combo) = "Combo"

     return(combo)

}


combo_col = UpdateCombo(df, use_columns)

df_combo = do.call(cbind, list(df, combo_col))


Thanks


--
Micha Silver
Ben Gurion Univ.
Sde Boker, Remote Sensing Lab
cell: +972-523-665918

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From @v|gro@@ @end|ng |rom ver|zon@net  Fri Jul  2 06:14:56 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Fri, 2 Jul 2021 00:14:56 -0400
Subject: [R] List / Matrix to Data Frame
In-Reply-To: <CAHqSRuQ=8YmMece_4-qoQc6vxcrhx9Q6Wiv_M1drF79fGjwmWg@mail.gmail.com>
References: <CH2PR13MB3640B172896B6B89B1A65431FA1F9@CH2PR13MB3640.namprd13.prod.outlook.com>
 <CAHqSRuQ=8YmMece_4-qoQc6vxcrhx9Q6Wiv_M1drF79fGjwmWg@mail.gmail.com>
Message-ID: <059b01d76ef8$d0cc3e70$7264bb50$@verizon.net>

Bill,

A Matrix can only contain one kind of data. I ran your code after modifying
it to be proper and took a transpose to get it risght-side up:

t(wanted)
date         netIncome        grossProfit      
2020-09-30 "2020-09-30" "57411000000.00" "104956000000.00"
2019-09-30 "2019-09-30" "55256000000.00" "98392000000.00" 
2018-09-30 "2018-09-30" "59531000000.00" "101839000000.00"
2017-09-30 "2017-09-30" "48351000000.00" "88186000000.00"

That looks better, I think.

So I did this:

wanted <- t(wanted)

It has rownames and colnames and you can make it a data frame easily enough:

mydf <- data.frame(wanted)

But the columns are all character strings, so CONVERT them as you wish:

> mydf
date      netIncome     grossProfit
2020-09-30 2020-09-30 57411000000.00 104956000000.00
2019-09-30 2019-09-30 55256000000.00  98392000000.00
2018-09-30 2018-09-30 59531000000.00 101839000000.00

Your numbers are quite large and may or may not be meant to be integers:

> mydf$netIncome <- as.numeric(mydf$netIncome)
> mydf$grossProfit <- as.numeric(mydf$grossProfit)
> head(mydf)
date  netIncome grossProfit
2020-09-30 2020-09-30 5.7411e+10 1.04956e+11
2019-09-30 2019-09-30 5.5256e+10 9.83920e+10
2018-09-30 2018-09-30 5.9531e+10 1.01839e+11
2017-09-30 2017-09-30 4.8351e+10 8.81860e+10
2016-09-30 2016-09-30 4.5687e+10 8.42630e+10
2015-09-30 2015-09-30 5.3394e+10 9.36260e+10

The first entries may have something wrong as they become NA when I make
them integers.

The date column is the same as the rownames and is not in a normal vector
format. It shows as a list and you may want to convert it to one of several
formats R supports for dates or a more normal character string. 

So here is how I made it a character string:

> mydf <- as.data.frame(wanted)
> mydf$date <- as.character(mydf$date)
> mydf$netIncome <- as.numeric(mydf$netIncome)
> mydf$grossProfit <- as.numeric(mydf$grossProfit)
> head(mydf)
date  netIncome grossProfit
2020-09-30 2020-09-30 5.7411e+10 1.04956e+11
2019-09-30 2019-09-30 5.5256e+10 9.83920e+10
2018-09-30 2018-09-30 5.9531e+10 1.01839e+11
2017-09-30 2017-09-30 4.8351e+10 8.81860e+10
2016-09-30 2016-09-30 4.5687e+10 8.42630e+10
2015-09-30 2015-09-30 5.3394e+10 9.36260e+10

If you want a DATE, it can now be converted again using one of many methods.

Just FYI, numbers that big and rounded might work just as well measured in
millions as in what I did to grossProfit:

> mydf$grossProfit <- as.integer(mydf$grossProfit/1000000)
> mydf$netIncome <- as.integer(mydf$netIncome/1000000)
> head(mydf)
date netIncome grossProfit
2020-09-30 2020-09-30     57411      104956
2019-09-30 2019-09-30     55256       98392
2018-09-30 2018-09-30     59531      101839
2017-09-30 2017-09-30     48351       88186
2016-09-30 2016-09-30     45687       84263
2015-09-30 2015-09-30     53394       93626

Some of the numbers are negative though.

If rownames are not needed:

> rownames(mydf) <- NULL
> head(mydf)
date netIncome grossProfit
1 2020-09-30     57411      104956
2 2019-09-30     55256       98392
3 2018-09-30     59531      101839
4 2017-09-30     48351       88186
5 2016-09-30     45687       84263
6 2015-09-30     53394       93626

It may be easier to work with this, but again, if you need the dates to be
real dates, as in graphing.

Hope that helps. 





-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Bill Dunlap
Sent: Thursday, July 1, 2021 9:01 PM
To: Sparks, John <jspark4 at uic.edu>
Cc: r-help at r-project.org
Subject: Re: [R] List / Matrix to Data Frame

Does this do what you want?

> df <- data.frame(check.names=FALSE,
lapply(c(Date="date",netIncome="netIncome",`Gross Profit`="grossProfit"),
function(nm)vapply(ISY, "[[", nm, FUN.VALUE=NA_character_)))
> str(df)
'data.frame':   36 obs. of  3 variables:
 $ Date        : chr  "2020-09-30" "2019-09-30" "2018-09-30" "2017-09-30"
...
 $ netIncome   : chr  "57411000000.00" "55256000000.00" "59531000000.00"
"48351000000.00" ...
 $ Gross Profit: chr  "104956000000.00" "98392000000.00" "101839000000.00"
"88186000000.00" ...
> df$Date <- as.Date(df$Date)
> df$netIncome <- as.numeric(df$netIncome) df$`Gross Profit` <- 
> as.numeric(df$`Gross Profit`)
> str(df)
'data.frame':   36 obs. of  3 variables:
 $ Date        : Date, format: "2020-09-30" "2019-09-30" "2018-09-30"
"2017-09-30" ...
 $ netIncome   : num  5.74e+10 5.53e+10 5.95e+10 4.84e+10 4.57e+10 ...
 $ Gross Profit: num  1.05e+11 9.84e+10 1.02e+11 8.82e+10 8.43e+10 ...
> with(df, plot(Date, netIncome))

On Thu, Jul 1, 2021 at 5:35 PM Sparks, John <jspark4 at uic.edu> wrote:

> Hi R-Helpers,
>
> I am taking it upon myself to delve into the world of lists for R.  In 
> no small part because I appear to have discovered a source of data for 
> an exceptionally good price but that delivers much of that data in json
format.
>
> So over the last day or so I managed to fight the list processing 
> tools to a draw and get a list that has only selected elements 
> (actually it ends up in matrix form).  But when I try to convert that 
> to a data frame I can't get it to a form that is workable.
>
> I have visited some pages about converting a matrix to a data frame 
> but they result in highly redundant and inelegant data.
>
> I am thinking that someone who works with lists and matrices knows how 
> to do this quite easily and would be willing to provide a solution.
>
> The reproducible example is shown below.  Just to be explicit, what I 
> am trying to get to is something along the lines of a data frame like
this.
>
> Date              netIncome      Gross Profit
> 2020-09-30 57411000000 104956000000
> 2019-09-30 55256000000   98392000000
>
> .....
>
> The closest I get is a matrix that looks like this
>
> > wanted
>             2020-09-30        2019-09-30       2018-09-30
> 2017-09-30       2016-09-30       2015-09-30       2014-09-30
> date        "2020-09-30"      "2019-09-30"     "2018-09-30"
> "2017-09-30"     "2016-09-30"     "2015-09-30"     "2014-09-30"
> netIncome   "57411000000.00"  "55256000000.00" "59531000000.00"
> "48351000000.00" "45687000000.00" "53394000000.00" "39510000000.00"
> grossProfit "104956000000.00" "98392000000.00" "101839000000.00"
> "88186000000.00" "84263000000.00" "93626000000.00" "70537000000.00"
>
> Code for example
>
> library(jsonlite)
> test <- jsonlite::fromJSON("
> https://eodhistoricaldata.com/api/fundamentals/AAPL.US?api_token=OeAFF
> mMliFG5orCUuwAKQ8l4WWFQ67YX
> ")
>
> hist<-test[[13]]
> ISY<-hist$Income_Statement$yearly
> wanted<-sapply(ISY, "[", j = c("date","netIncome","grossProfit"))
>
>
> Your guidance would be much appreciated.
>
> --John J. Sparks, Ph.D.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Jul  2 07:03:14 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 01 Jul 2021 22:03:14 -0700
Subject: [R] concatenating columns in data.frame
In-Reply-To: <056701d76ef4$173342f0$4599c8d0$@verizon.net>
References: <e0a0d23f-c4a6-540c-be31-90ba894dba11@gmail.com>
 <056701d76ef4$173342f0$4599c8d0$@verizon.net>
Message-ID: <8AE9E4D9-722C-4993-98E7-0FA2AF2F9AA3@dcn.davis.ca.us>

I use parts of the tidyverse frequently, but this post is the best argument I can imagine for learning base R techniques.

On July 1, 2021 8:41:06 PM PDT, Avi Gross via R-help <r-help at r-project.org> wrote:
>Micha,
>
>Others have provided ways in standard R so I will contribute a somewhat
>odd solution using the dplyr and related packages in the tidyverse
>including a sample data.frame/tibble I made. It requires newer versions
>of R and other  packages as it uses some fairly esoteric features
>including "the big bang" and the new ":=" operator and more.
>
>You can use your own data with whatever columns you need, of course.
>
>The goal is to have umpteen columns in the data that you want to add an
>additional columns to an existing tibble that is the result of
>concatenating the rowwise contents of a dynamically supplied vector of
>column names in quotes. First we need something to work with so here is
>a sample:
>
>#--start
># load required packages, or a bunch at once!
>library(tidyverse)
>
># Pick how many rows you want. For a demo, 3 is plenty N <- 3
>
># Make a sample tibble with N rows and the following 4 columns mydf <-
>tibble(alpha = 1:N, 
>               beta=letters[1:N],
>               gamma = N:1,
>               delta = month.abb[1:N])
>
># show the original tibble
>print(mydf)
>#--end
>
>In flat text mode, here is the output:
>
>> print(mydf)
># A tibble: 3 x 4
>alpha beta  gamma delta
><int> <chr> <int> <chr>
>  1     1 a         3 Jan  
>2     2 b         2 Feb  
>3     3 c         1 Mar
>
>Now I want to make a function that is used instead of the mutate verb.
>I made a weird one-liner that is a tad hard to explain so first let me
>mention the requirements.
>
>It will take a first argument that is a tibble and in a pipeline this
>would be passed invisibly.
>The second required argument is a vector or list containing the names
>of the columns as strings. A column can be re-used multiple times.
>The third optional argument is what to name the new column with a
>default if omitted.
>The fourth optional argument allows you to choose a different separator
>than "" if you wish.
>
>The function should be usable in a pipeline on both sides so it should
>also return the input tibble with an extra column to the output.
>
>Here is the function:
>
>my_mutate <- function(df, columns, colnew="concatenated", sep=""){
>  df %>%
>    mutate( "{colnew}" := paste(!!!rlang::syms(columns), sep = sep )) }
>
>Yes, the above can be done inline as a long one-liner:
>
>my_mutate <- function(df, columns, colnew="concatenated", sep="")
>mutate(df, "{colnew}" := paste(!!!rlang::syms(columns), sep = sep ))
>
>Here are examples of it running:
>
>
>> choices <- c("beta", "delta", "alpha", "delta") mydf %>% 
>> my_mutate(choices, "me2")
># A tibble: 3 x 5
>alpha beta  gamma delta me2     
><int> <chr> <int> <chr> <chr>   
>  1     1 a         3 Jan   aJan1Jan
>2     2 b         2 Feb   bFeb2Feb
>3     3 c         1 Mar   cMar3Mar
>> mydf %>% my_mutate(choices, "me2",":")
># A tibble: 3 x 5
>alpha beta  gamma delta me2        
><int> <chr> <int> <chr> <chr>      
>  1     1 a         3 Jan   a:Jan:1:Jan
>2     2 b         2 Feb   b:Feb:2:Feb
>3     3 c         1 Mar   c:Mar:3:Mar
>> mydf %>% my_mutate(c("beta", "beta", "gamma", "gamma", "delta", 
>> "alpha"))
># A tibble: 3 x 5
>alpha beta  gamma delta concatenated
><int> <chr> <int> <chr> <chr>       
>  1     1 a         3 Jan   aa33Jan1    
>2     2 b         2 Feb   bb22Feb2    
>3     3 c         1 Mar   cc11Mar3    
>> mydf %>% my_mutate(list("beta", "beta", "gamma", "gamma", "delta", 
>> "alpha"))
># A tibble: 3 x 5
>alpha beta  gamma delta concatenated
><int> <chr> <int> <chr> <chr>       
>  1     1 a         3 Jan   aa33Jan1    
>2     2 b         2 Feb   bb22Feb2    
>3     3 c         1 Mar   cc11Mar3    
>> mydf %>% my_mutate(columns=list("alpha", "beta", "gamma", "delta", 
>> "gamma", "beta", "alpha"),
>                     +                    sep="/*/",
>                     +                    colnew="NewRandomNAME"
>                     +                    )
># A tibble: 3 x 5
>alpha beta  gamma delta NewRandomNAME              
><int> <chr> <int> <chr> <chr>                      
>  1     1 a         3 Jan   1/*/a/*/3/*/Jan/*/3/*/a/*/1
>2     2 b         2 Feb   2/*/b/*/2/*/Feb/*/2/*/b/*/2
>3     3 c         1 Mar   3/*/c/*/1/*/Mar/*/1/*/c/*/3
>
>Does this meet your normal need? Just to show it works in a pipeline,
>here is a variant:
>
>mydf %>%
>  tail(2) %>%
>  my_mutate(c("beta", "beta"), "betabeta") %>%
>  print() %>%
>  my_mutate(list("alpha", "betabeta", "gamma"),
>            "buildson", 
>            "&")
>
>The above only keeps the last two lines of the tibble, makes a double
>copy of "beta" under a new name, prints the intermediate result,
>continues to make another concatenation using the variable created
>earlier then prints the result:
>
>Here is the run:
>
>> mydf %>%
>  +   tail(2) %>%
>  +   my_mutate(c("beta", "beta"), "betabeta") %>%
>  +   print() %>%
>  +   my_mutate(list("alpha", "betabeta", "gamma"),
>                +             "buildson", 
>                +             "&")
># A tibble: 2 x 5
>alpha beta  gamma delta betabeta
><int> <chr> <int> <chr> <chr>   
>  1     2 b         2 Feb   bb      
>2     3 c         1 Mar   cc      
># A tibble: 2 x 6
>alpha beta  gamma delta betabeta buildson
><int> <chr> <int> <chr> <chr>    <chr>   
>  1     2 b         2 Feb   bb       2&bb&2  
>2     3 c         1 Mar   cc       3&cc&1  
>
>As to how the darn function works, that was a learning experience for
>me to build using features I have not had occasion to use. If anyone
>remains interested, read on. 
>
>The following needs newish features:
>
>	"{colnew}" := SOMETHING
>
>The colon-equals operator in newer R/dplyr can be sort of used in an
>odd way that allows the name of the variable to be in quotes and in
>brackets akin to the way glue() does it. The variable colnew is
>evaluated and substituted so the name used for the column is now
>dynamic.
>
>The function does a paste using this:
>
>	!!!rlang::syms(columns)
>
>The problem is paste() wants multiple arguments and we have a single
>argument that is either a vector or another kind of vector called a
>list. The trick is to convert the vector into symbols then use "!!!" to
>convert something like 'c("alpha", "beta", "gamma")' into something
>more like ' "alpha", "beta", "gamma" ' so that paste sees them as
>multiple arguments to concatenate in vector fashion.
>
>And, the function is not polished but I am sure you can all see some of
>what is needed like checking the arguments for validity, including not
>having a name for the new column that clashes with existing column
>names, doing something sane if no columns to concatenate are offered
>and so on.
>
>Just showing a different approach. The base R methods are fine.
>
>- Avi
>
>-----Original Message-----
>From: R-help <r-help-bounces at r-project.org> On Behalf Of Micha Silver
>Sent: Thursday, July 1, 2021 10:36 AM
>To: R-help at r-project.org
>Subject: [R] concatenating columns in data.frame
>
>I need to create a new data.frame column as a concatenation of existing
>character columns. But the number and name of the columns to
>concatenate needs to be passed in dynamically. The code below does what
>I want, but seems very clumsy. Any suggestions how to improve?
>
>
>df = data.frame("A"=sample(letters, 10), "B"=sample(letters, 10),
>"C"=sample(letters,10), "D"=sample(letters, 10))
>
># Which columns to concat:
>
>use_columns = c("D", "B")
>
>
>UpdateCombo = function(df, use_columns) {
>     use_df = df[, use_columns]
>     combo_list = lapply(1:nrow(use_df), function(r) {
>     r_combo = paste(use_df[r,], collapse="_")
>     return(data.frame("Combo" = r_combo))
>     })
>     combo = do.call(rbind, combo_list)
>
>     names(combo) = "Combo"
>
>     return(combo)
>
>}
>
>
>combo_col = UpdateCombo(df, use_columns)
>
>df_combo = do.call(cbind, list(df, combo_col))
>
>
>Thanks
>
>
>--
>Micha Silver
>Ben Gurion Univ.
>Sde Boker, Remote Sensing Lab
>cell: +972-523-665918
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From y@ngk@|9999 @end|ng |rom y@hoo@com  Fri Jul  2 20:28:56 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Fri, 2 Jul 2021 18:28:56 +0000 (UTC)
Subject: [R] R function question
References: <195864393.1896755.1625250536437.ref@mail.yahoo.com>
Message-ID: <195864393.1896755.1625250536437@mail.yahoo.com>

Hello List,I need to generate summary report for many tables (>200 tables). For each table, I can use the script to generate repost:
res <- dbGetQuery(con, "SELECT * FROM BIODBX.MECCUNIQUE2")view(dfSummary(res), file = "W:/project/_Joe.B/MSSQL/try/summarytools.BIODBX.MECCUNIQUE2.html")rm(res)
BIODBX.MECCUNIQUE2 is the name of table.
I have all of tables' name in a data frame. So, I'm trying to write a function to do this:
summ <- function(Tabname){? res <- dbGetQuery(con, "SELECT * FROM Tabname")? view(dfSummary(res), file = "W:/project/_Joe.B/MSSQL/try/summarytools.Tabname.html")? rm(res)}
for (i in dbtable$Tot_table){? Tabname <- as.character(sqldf(sprintf("SELECT Tot_table FROM dbtable", i)))? summ(Tabname)}
1. I created? a function summ, the argument is Tabname. I put the Tabname in the function. I hope it can be replaced one by one2. the table dbtable contents all tables' name (>200 rows), the field name is Tot_table3. I want use "for" to establish a loop, which can automatic generate a summary report for each table
but I got error message below:?Error: nanodbc/nanodbc.cpp:1655: 42000: [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'Tabname'.? [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared.?<SQL> 'SELECT * FROM Tabname'?10. stop(structure(list(message = "nanodbc/nanodbc.cpp:1655: 42000: [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'Tabname'.? [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. \n<SQL> 'SELECT * FROM Tabname'",?? ? call = NULL, cppstack = NULL), class = c("odbc::odbc_error",?"C++Error", "error", "condition")))?9.new_result(connection at ptr, statement, immediate)?8.OdbcResult(connection = conn, statement = statement, params = params,? ? ?immediate = immediate)?7..local(conn, statement, ...)?6.dbSendQuery(conn, statement, params = params, ...)?5.dbSendQuery(conn, statement, params = params, ...)?4..local(conn, statement, ...)?3.dbGetQuery(con, "SELECT * FROM Tabname")?2.dbGetQuery(con, "SELECT * FROM Tabname")?1.summ(Tabname)?
it seems the tables' name is not successfully pass into query. can someone give me an instruction for this?
many thanks,Kai

	[[alternative HTML version deleted]]


From y@ngk@|9999 @end|ng |rom y@hoo@com  Fri Jul  2 20:36:43 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Fri, 2 Jul 2021 18:36:43 +0000 (UTC)
Subject: [R] R Function question, (repost to fix the messy work format)
References: <779214286.1955402.1625251003343.ref@mail.yahoo.com>
Message-ID: <779214286.1955402.1625251003343@mail.yahoo.com>

Hello List,

The previous post look massy. I repost my question. Sorry,


I need to generate summary report for many tables (>200 tables). For each table, I can use the script to generate report:
res <- dbGetQuery(con, "SELECT * FROM BIODBX.MECCUNIQUE2")
view(dfSummary(res), file = "W:/project/_Joe.B/MSSQL/try/summarytools.BIODBX.MECCUNIQUE2.html")
rm(res)
BIODBX.MECCUNIQUE2 is the name of table.

I have all of tables' name in a data frame. So, I'm trying to write a function to do this:
summ <- function(Tabname){
? res <- dbGetQuery(con, "SELECT * FROM Tabname")
? view(dfSummary(res), file = "W:/project/_Joe.B/MSSQL/try/summarytools.Tabname.html")
? rm(res)
}
for (i in dbtable$Tot_table)
{
? Tabname <- as.character(sqldf(sprintf("SELECT Tot_table FROM dbtable", i)))
? summ(Tabname)
}

1. I created? a function summ, the argument is Tabname. I put the Tabname in the function. I hope it can be replaced one by one
2. the table dbtable contents all tables' name (>200 rows), the field name is Tot_table
3. I want use "for" to establish a loop, which can automatic generate a summary report for each table

but I got error message below:
?Error: nanodbc/nanodbc.cpp:1655: 42000: [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'Tabname'.??
[Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared.?

<SQL> 'SELECT * FROM Tabname'?
10. stop(structure(list(message = "nanodbc/nanodbc.cpp:1655: 42000: [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid?
object name 'Tabname'.? [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. \n<SQL>?
'SELECT * FROM Tabname'",?
? ? call = NULL, cppstack = NULL), class = c("odbc::odbc_error",?
"C++Error", "error", "condition")))?
9.new_result(connection at ptr, statement, immediate)?
8.OdbcResult(connection = conn, statement = statement, params = params,? ? ?immediate = immediate)?
7..local(conn, statement, ...)?
6.dbSendQuery(conn, statement, params = params, ...)?
5.dbSendQuery(conn, statement, params = params, ...)?
4..local(conn, statement, ...)?
3.dbGetQuery(con, "SELECT * FROM Tabname")?
2.dbGetQuery(con, "SELECT * FROM Tabname")?
1.summ(Tabname)?

it seems the tables' name is not successfully pass into query. can someone give me an instruction for this?
many thanks,
Kai


	[[alternative HTML version deleted]]


From j@p@rk4 @end|ng |rom u|c@edu  Fri Jul  2 20:48:38 2021
From: j@p@rk4 @end|ng |rom u|c@edu (Sparks, John)
Date: Fri, 2 Jul 2021 18:48:38 +0000
Subject: [R] List / Matrix to Data Frame
In-Reply-To: <CAHqSRuQ=8YmMece_4-qoQc6vxcrhx9Q6Wiv_M1drF79fGjwmWg@mail.gmail.com>
References: <CH2PR13MB3640B172896B6B89B1A65431FA1F9@CH2PR13MB3640.namprd13.prod.outlook.com>,
 <CAHqSRuQ=8YmMece_4-qoQc6vxcrhx9Q6Wiv_M1drF79fGjwmWg@mail.gmail.com>
Message-ID: <CH2PR13MB36401AC7B9D8876E760462A4FA1F9@CH2PR13MB3640.namprd13.prod.outlook.com>

Works like a charm.

Thanks so much.

--John Sparks

________________________________
From: Bill Dunlap <williamwdunlap at gmail.com>
Sent: Thursday, July 1, 2021 8:01 PM
To: Sparks, John <jspark4 at uic.edu>
Cc: r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] List / Matrix to Data Frame

Does this do what you want?

> df <- data.frame(check.names=FALSE, lapply(c(Date="date",netIncome="netIncome",`Gross Profit`="grossProfit"), function(nm)vapply(ISY, "[[", nm, FUN.VALUE=NA_character_)))
> str(df)
'data.frame':   36 obs. of  3 variables:
 $ Date        : chr  "2020-09-30" "2019-09-30" "2018-09-30" "2017-09-30" ...
 $ netIncome   : chr  "57411000000.00" "55256000000.00" "59531000000.00" "48351000000.00" ...
 $ Gross Profit: chr  "104956000000.00" "98392000000.00" "101839000000.00" "88186000000.00" ...
> df$Date <- as.Date(df$Date)
> df$netIncome <- as.numeric(df$netIncome)
> df$`Gross Profit` <- as.numeric(df$`Gross Profit`)
> str(df)
'data.frame':   36 obs. of  3 variables:
 $ Date        : Date, format: "2020-09-30" "2019-09-30" "2018-09-30" "2017-09-30" ...
 $ netIncome   : num  5.74e+10 5.53e+10 5.95e+10 4.84e+10 4.57e+10 ...
 $ Gross Profit: num  1.05e+11 9.84e+10 1.02e+11 8.82e+10 8.43e+10 ...
> with(df, plot(Date, netIncome))

On Thu, Jul 1, 2021 at 5:35 PM Sparks, John <jspark4 at uic.edu<mailto:jspark4 at uic.edu>> wrote:
Hi R-Helpers,

I am taking it upon myself to delve into the world of lists for R.  In no small part because I appear to have discovered a source of data for an exceptionally good price but that delivers much of that data in json format.

So over the last day or so I managed to fight the list processing tools to a draw and get a list that has only selected elements (actually it ends up in matrix form).  But when I try to convert that to a data frame I can't get it to a form that is workable.

I have visited some pages about converting a matrix to a data frame but they result in highly redundant and inelegant data.

I am thinking that someone who works with lists and matrices knows how to do this quite easily and would be willing to provide a solution.

The reproducible example is shown below.  Just to be explicit, what I am trying to get to is something along the lines of a data frame like this.

Date              netIncome      Gross Profit
2020-09-30 57411000000 104956000000
2019-09-30 55256000000   98392000000

.....

The closest I get is a matrix that looks like this

> wanted
            2020-09-30        2019-09-30       2018-09-30        2017-09-30       2016-09-30       2015-09-30       2014-09-30
date        "2020-09-30"      "2019-09-30"     "2018-09-30"      "2017-09-30"     "2016-09-30"     "2015-09-30"     "2014-09-30"
netIncome   "57411000000.00"  "55256000000.00" "59531000000.00"  "48351000000.00" "45687000000.00" "53394000000.00" "39510000000.00"
grossProfit "104956000000.00" "98392000000.00" "101839000000.00" "88186000000.00" "84263000000.00" "93626000000.00" "70537000000.00"

Code for example

library(jsonlite)
test <- jsonlite::fromJSON("https://eodhistoricaldata.com/api/fundamentals/AAPL.US?api_token=OeAFFmMliFG5orCUuwAKQ8l4WWFQ67YX<https://nam04.safelinks.protection.outlook.com/?url=https%3A%2F%2Feodhistoricaldata.com%2Fapi%2Ffundamentals%2FAAPL.US%3Fapi_token%3DOeAFFmMliFG5orCUuwAKQ8l4WWFQ67YX&data=04%7C01%7Cjspark4%40uic.edu%7Cec30a41cf9b14db3eb5208d93cf4f33d%7Ce202cd477a564baa99e3e3b71a7c77dd%7C0%7C0%7C637607847614944186%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=p8vaGeaCWVDbL9yCiOcHvJVRa%2Bb1OsxN3A0xRtD3uc8%3D&reserved=0>")

hist<-test[[13]]
ISY<-hist$Income_Statement$yearly
wanted<-sapply(ISY, "[", j = c("date","netIncome","grossProfit"))


Your guidance would be much appreciated.

--John J. Sparks, Ph.D.

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help<https://nam04.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&data=04%7C01%7Cjspark4%40uic.edu%7Cec30a41cf9b14db3eb5208d93cf4f33d%7Ce202cd477a564baa99e3e3b71a7c77dd%7C0%7C0%7C637607847614954146%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=fMhmQ4dY8zovN6bevG0NJ%2Fjw4rEFQzafDwBIehAtOpI%3D&reserved=0>
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html<https://nam04.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&data=04%7C01%7Cjspark4%40uic.edu%7Cec30a41cf9b14db3eb5208d93cf4f33d%7Ce202cd477a564baa99e3e3b71a7c77dd%7C0%7C0%7C637607847614954146%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=anMcffYjEXffR%2F0yw86LDcEQ%2BvRTHsIuGDc%2BCU6ISm8%3D&reserved=0>
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Fri Jul  2 21:05:43 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Fri, 2 Jul 2021 22:05:43 +0300
Subject: [R] R Function question, (repost to fix the messy work format)
In-Reply-To: <779214286.1955402.1625251003343@mail.yahoo.com>
References: <779214286.1955402.1625251003343.ref@mail.yahoo.com>
 <779214286.1955402.1625251003343@mail.yahoo.com>
Message-ID: <CAGgJW773SRbVAz3O3GkiAZSzO7TTeGJRVS6XSJu+qFpTHeZo_Q@mail.gmail.com>

Modify the summ() function to start like this

summ <- function(Tabname){
   query <- sprintf(" SELECT * FROM %s",Tabname)
  res <- dbGetQuery(con, query)

etc

HTH,
Eric

On Fri, Jul 2, 2021 at 9:39 PM Kai Yang via R-help <r-help at r-project.org>
wrote:

> Hello List,
>
> The previous post look massy. I repost my question. Sorry,
>
>
> I need to generate summary report for many tables (>200 tables). For each
> table, I can use the script to generate report:
> res <- dbGetQuery(con, "SELECT * FROM BIODBX.MECCUNIQUE2")
> view(dfSummary(res), file =
> "W:/project/_Joe.B/MSSQL/try/summarytools.BIODBX.MECCUNIQUE2.html")
> rm(res)
> BIODBX.MECCUNIQUE2 is the name of table.
>
> I have all of tables' name in a data frame. So, I'm trying to write a
> function to do this:
> summ <- function(Tabname){
>   res <- dbGetQuery(con, "SELECT * FROM Tabname")
>   view(dfSummary(res), file =
> "W:/project/_Joe.B/MSSQL/try/summarytools.Tabname.html")
>   rm(res)
> }
> for (i in dbtable$Tot_table)
> {
>   Tabname <- as.character(sqldf(sprintf("SELECT Tot_table FROM dbtable",
> i)))
>   summ(Tabname)
> }
>
> 1. I created  a function summ, the argument is Tabname. I put the Tabname
> in the function. I hope it can be replaced one by one
> 2. the table dbtable contents all tables' name (>200 rows), the field name
> is Tot_table
> 3. I want use "for" to establish a loop, which can automatic generate a
> summary report for each table
>
> but I got error message below:
>  Error: nanodbc/nanodbc.cpp:1655: 42000: [Microsoft][ODBC Driver 17 for
> SQL Server][SQL Server]Invalid object name 'Tabname'.
> [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could
> not be prepared.
>
> <SQL> 'SELECT * FROM Tabname'
> 10. stop(structure(list(message = "nanodbc/nanodbc.cpp:1655: 42000:
> [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid
> object name 'Tabname'.  [Microsoft][ODBC Driver 17 for SQL Server][SQL
> Server]Statement(s) could not be prepared. \n<SQL>
> 'SELECT * FROM Tabname'",
>     call = NULL, cppstack = NULL), class = c("odbc::odbc_error",
> "C++Error", "error", "condition")))
> 9.new_result(connection at ptr, statement, immediate)
> 8.OdbcResult(connection = conn, statement = statement, params = params,
>  immediate = immediate)
> 7..local(conn, statement, ...)
> 6.dbSendQuery(conn, statement, params = params, ...)
> 5.dbSendQuery(conn, statement, params = params, ...)
> 4..local(conn, statement, ...)
> 3.dbGetQuery(con, "SELECT * FROM Tabname")
> 2.dbGetQuery(con, "SELECT * FROM Tabname")
> 1.summ(Tabname)
>
> it seems the tables' name is not successfully pass into query. can someone
> give me an instruction for this?
> many thanks,
> Kai
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From y@ngk@|9999 @end|ng |rom y@hoo@com  Fri Jul  2 21:20:46 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Fri, 2 Jul 2021 19:20:46 +0000 (UTC)
Subject: [R] R Function question, (repost to fix the messy work format)
In-Reply-To: <CAGgJW773SRbVAz3O3GkiAZSzO7TTeGJRVS6XSJu+qFpTHeZo_Q@mail.gmail.com>
References: <779214286.1955402.1625251003343.ref@mail.yahoo.com>
 <779214286.1955402.1625251003343@mail.yahoo.com>
 <CAGgJW773SRbVAz3O3GkiAZSzO7TTeGJRVS6XSJu+qFpTHeZo_Q@mail.gmail.com>
Message-ID: <2100728260.1911397.1625253646228@mail.yahoo.com>

 Hello Eric,
Following your suggestion, I modified the code as:
summ <- function(Tabname){
? query <- sprintf(" SELECT * FROM %s",Tabname)
? res <- dbGetQuery(con, query)
? view(dfSummary(res), file = "W:/project/_Joe.B/MSSQL/try/summarytools.Tabname.html")
? rm(res)
}

for (i in dbtable$Tot_table)
{
? Tabname <- as.character(sqldf(sprintf("SELECT Tot_table FROM dbtable", i)))
? summ(Tabname)
}
after submitted the work, I got the error message below:

?Error: nanodbc/nanodbc.cpp:1655: 42000: [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'c'.? [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared.?<SQL> ' SELECT * FROM c("BIODBX.MECCUNIQUE2", "BIODBX.QDATA_HTML_DUMMY", "BIODBX.SET_ITEMS", "BIODBX.SET_NAMES", "dbo.sysdiagrams", "GEMD.ASSAY_DEFINITIONS", "GEMD.ASSAY_DISCRETE_VALUES", "GEMD.ASSAY_QUESTIONS", "GEMD.ASSAY_RUNS", "GEMD.BIODBX_DATABASE_SEED", "GEMD.BIODBX_USER_SEEDS", "GEMD.BIODBX_USERS", "GEMD.DATA_ENTRY_PAGES", "GEMD.DISC_SESSION_QID", "GEMD.DISC_SESSION_STATUS", "GEMD.DISC_SESSION_TYPE", "GEMD.DISCREPANCIES", "GEMD.DISCREPANCY_QUERY_TEMP", "GEMD.DISCRETE_VALUES", "GEMD.ENTERED_DATA_ENTRY_PAGES", "GEMD.ENTRY_GROUPS",?"GEMD.ExportSampleListNames", "GEMD.FORM_STATUS_BY_SUBJECT", "GEMD.GEMD_CODELIST_GROUPS", "GEMD.GEMD_CODELIST_VALUES", "GEMD.GEMD_LOT_DEFINITIONS", "GEMD.GEMD_SAMPLES", "GEMD.GEMD_STUDIES", "GEMD.MECCUNIQUE", "GEMD.MECCUNIQUE2", "GEMD.MISSING_DI?

One more question,? in the code of "view(dfSummary(res), file = "W:/project/_Joe.B/MSSQL/try/summarytools.Tabname.html")",
can Tabname part be replacted automatic also??
Thank you,
Kai    On Friday, July 2, 2021, 12:06:12 PM PDT, Eric Berger <ericjberger at gmail.com> wrote:  
 
 Modify the summ() function to start like this?
summ <- function(Tabname){? ?query <- sprintf("SELECT * FROM?%s",Tabname)
? res <- dbGetQuery(con, query)
?
etc
HTH,Eric
On Fri, Jul 2, 2021 at 9:39 PM Kai Yang via R-help <r-help at r-project.org> wrote:

Hello List,

The previous post look massy. I repost my question. Sorry,


I need to generate summary report for many tables (>200 tables). For each table, I can use the script to generate report:
res <- dbGetQuery(con, "SELECT * FROM BIODBX.MECCUNIQUE2")
view(dfSummary(res), file = "W:/project/_Joe.B/MSSQL/try/summarytools.BIODBX.MECCUNIQUE2.html")
rm(res)
BIODBX.MECCUNIQUE2 is the name of table.

I have all of tables' name in a data frame. So, I'm trying to write a function to do this:
summ <- function(Tabname){
? res <- dbGetQuery(con, "SELECT * FROM Tabname")
? view(dfSummary(res), file = "W:/project/_Joe.B/MSSQL/try/summarytools.Tabname.html")
? rm(res)
}
for (i in dbtable$Tot_table)
{
? Tabname <- as.character(sqldf(sprintf("SELECT Tot_table FROM dbtable", i)))
? summ(Tabname)
}

1. I created? a function summ, the argument is Tabname. I put the Tabname in the function. I hope it can be replaced one by one
2. the table dbtable contents all tables' name (>200 rows), the field name is Tot_table
3. I want use "for" to establish a loop, which can automatic generate a summary report for each table

but I got error message below:
?Error: nanodbc/nanodbc.cpp:1655: 42000: [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'Tabname'.??
[Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared.?

<SQL> 'SELECT * FROM Tabname'?
10. stop(structure(list(message = "nanodbc/nanodbc.cpp:1655: 42000: [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid?
object name 'Tabname'.? [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. \n<SQL>?
'SELECT * FROM Tabname'",?
? ? call = NULL, cppstack = NULL), class = c("odbc::odbc_error",?
"C++Error", "error", "condition")))?
9.new_result(connection at ptr, statement, immediate)?
8.OdbcResult(connection = conn, statement = statement, params = params,? ? ?immediate = immediate)?
7..local(conn, statement, ...)?
6.dbSendQuery(conn, statement, params = params, ...)?
5.dbSendQuery(conn, statement, params = params, ...)?
4..local(conn, statement, ...)?
3.dbGetQuery(con, "SELECT * FROM Tabname")?
2.dbGetQuery(con, "SELECT * FROM Tabname")?
1.summ(Tabname)?

it seems the tables' name is not successfully pass into query. can someone give me an instruction for this?
many thanks,
Kai


? ? ? ? [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

  
	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Fri Jul  2 21:30:46 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Fri, 2 Jul 2021 22:30:46 +0300
Subject: [R] R Function question, (repost to fix the messy work format)
In-Reply-To: <2100728260.1911397.1625253646228@mail.yahoo.com>
References: <779214286.1955402.1625251003343.ref@mail.yahoo.com>
 <779214286.1955402.1625251003343@mail.yahoo.com>
 <CAGgJW773SRbVAz3O3GkiAZSzO7TTeGJRVS6XSJu+qFpTHeZo_Q@mail.gmail.com>
 <2100728260.1911397.1625253646228@mail.yahoo.com>
Message-ID: <CAGgJW74PPihHBFQpoLKKiEA=kOmXbv2Un3SXJCYaCt-Kj7oEKQ@mail.gmail.com>

Hard for me to tell without more details but it looks like the following
has several bugs

for (i in dbtable$Tot_table)
{
  Tabname <- as.character(sqldf(sprintf("SELECT Tot_table FROM dbtable",
i)))
  summ(Tabname)
}

Your sprintf() statement seems to use 'i' but actually does not.
You probably want to rewrite/rearrange this code. More like

x <- sqldf("SELECT Tot_table FROM dbtable")
for ( Tabname in x )
summ(Tabname)

no doubt this is wrong but put a browser() call after the x <- sqldf(...)
line and inspect x and go from there




On Fri, Jul 2, 2021 at 10:20 PM Kai Yang <yangkai9999 at yahoo.com> wrote:

> Hello Eric,
>
> Following your suggestion, I modified the code as:
>
> summ <- function(Tabname){
>
>   query <- sprintf(" SELECT * FROM %s",Tabname)
>
>   res <- dbGetQuery(con, query)
>
>   view(dfSummary(res), file =
> "W:/project/_Joe.B/MSSQL/try/summarytools.Tabname.html")
>
>   rm(res)
>
> }
>
>
> for (i in dbtable$Tot_table)
>
> {
>
>   Tabname <- as.character(sqldf(sprintf("SELECT Tot_table FROM dbtable",
> i)))
>
>   summ(Tabname)
>
> }
>
> after submitted the work, I got the error message below:
>
>
>  Error: nanodbc/nanodbc.cpp:1655: 42000: [Microsoft][ODBC Driver 17 for
> SQL Server][SQL Server]Invalid object name 'c'.  [Microsoft][ODBC Driver 17
> for SQL Server][SQL Server]Statement(s) could not be prepared.
> <SQL> ' SELECT * FROM c("BIODBX.MECCUNIQUE2", "BIODBX.QDATA_HTML_DUMMY",
> "BIODBX.SET_ITEMS", "BIODBX.SET_NAMES", "dbo.sysdiagrams",
> "GEMD.ASSAY_DEFINITIONS", "GEMD.ASSAY_DISCRETE_VALUES",
> "GEMD.ASSAY_QUESTIONS", "GEMD.ASSAY_RUNS", "GEMD.BIODBX_DATABASE_SEED",
> "GEMD.BIODBX_USER_SEEDS", "GEMD.BIODBX_USERS", "GEMD.DATA_ENTRY_PAGES",
> "GEMD.DISC_SESSION_QID", "GEMD.DISC_SESSION_STATUS",
> "GEMD.DISC_SESSION_TYPE", "GEMD.DISCREPANCIES",
> "GEMD.DISCREPANCY_QUERY_TEMP", "GEMD.DISCRETE_VALUES",
> "GEMD.ENTERED_DATA_ENTRY_PAGES", "GEMD.ENTRY_GROUPS",
> "GEMD.ExportSampleListNames", "GEMD.FORM_STATUS_BY_SUBJECT",
> "GEMD.GEMD_CODELIST_GROUPS", "GEMD.GEMD_CODELIST_VALUES",
> "GEMD.GEMD_LOT_DEFINITIONS", "GEMD.GEMD_SAMPLES", "GEMD.GEMD_STUDIES",
> "GEMD.MECCUNIQUE", "GEMD.MECCUNIQUE2", "GEMD.MISSING_DI
>
>
> One more question,  in the code of "*view(dfSummary(res), file =
> "W:/project/_Joe.B/MSSQL/try/summarytools.Tabname.html")*",
>
> can Tabname part be replacted automatic also?
>
> Thank you,
>
> Kai
> On Friday, July 2, 2021, 12:06:12 PM PDT, Eric Berger <
> ericjberger at gmail.com> wrote:
>
>
> Modify the summ() function to start like this
>
> summ <- function(Tabname){
>    query <- sprintf(" SELECT * FROM %s",Tabname)
>   res <- dbGetQuery(con, query)
>
> etc
>
> HTH,
> Eric
>
> On Fri, Jul 2, 2021 at 9:39 PM Kai Yang via R-help <r-help at r-project.org>
> wrote:
>
> Hello List,
>
> The previous post look massy. I repost my question. Sorry,
>
>
> I need to generate summary report for many tables (>200 tables). For each
> table, I can use the script to generate report:
> res <- dbGetQuery(con, "SELECT * FROM BIODBX.MECCUNIQUE2")
> view(dfSummary(res), file =
> "W:/project/_Joe.B/MSSQL/try/summarytools.BIODBX.MECCUNIQUE2.html")
> rm(res)
> BIODBX.MECCUNIQUE2 is the name of table.
>
> I have all of tables' name in a data frame. So, I'm trying to write a
> function to do this:
> summ <- function(Tabname){
>   res <- dbGetQuery(con, "SELECT * FROM Tabname")
>   view(dfSummary(res), file =
> "W:/project/_Joe.B/MSSQL/try/summarytools.Tabname.html")
>   rm(res)
> }
> for (i in dbtable$Tot_table)
> {
>   Tabname <- as.character(sqldf(sprintf("SELECT Tot_table FROM dbtable",
> i)))
>   summ(Tabname)
> }
>
> 1. I created  a function summ, the argument is Tabname. I put the Tabname
> in the function. I hope it can be replaced one by one
> 2. the table dbtable contents all tables' name (>200 rows), the field name
> is Tot_table
> 3. I want use "for" to establish a loop, which can automatic generate a
> summary report for each table
>
> but I got error message below:
>  Error: nanodbc/nanodbc.cpp:1655: 42000: [Microsoft][ODBC Driver 17 for
> SQL Server][SQL Server]Invalid object name 'Tabname'.
> [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could
> not be prepared.
>
> <SQL> 'SELECT * FROM Tabname'
> 10. stop(structure(list(message = "nanodbc/nanodbc.cpp:1655: 42000:
> [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid
> object name 'Tabname'.  [Microsoft][ODBC Driver 17 for SQL Server][SQL
> Server]Statement(s) could not be prepared. \n<SQL>
> 'SELECT * FROM Tabname'",
>     call = NULL, cppstack = NULL), class = c("odbc::odbc_error",
> "C++Error", "error", "condition")))
> 9.new_result(connection at ptr, statement, immediate)
> 8.OdbcResult(connection = conn, statement = statement, params = params,
>  immediate = immediate)
> 7..local(conn, statement, ...)
> 6.dbSendQuery(conn, statement, params = params, ...)
> 5.dbSendQuery(conn, statement, params = params, ...)
> 4..local(conn, statement, ...)
> 3.dbGetQuery(con, "SELECT * FROM Tabname")
> 2.dbGetQuery(con, "SELECT * FROM Tabname")
> 1.summ(Tabname)
>
> it seems the tables' name is not successfully pass into query. can someone
> give me an instruction for this?
> many thanks,
> Kai
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
>

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Jul  2 21:37:58 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 02 Jul 2021 12:37:58 -0700
Subject: [R] R Function question, (repost to fix the messy work format)
In-Reply-To: <CAGgJW773SRbVAz3O3GkiAZSzO7TTeGJRVS6XSJu+qFpTHeZo_Q@mail.gmail.com>
References: <779214286.1955402.1625251003343.ref@mail.yahoo.com>
 <779214286.1955402.1625251003343@mail.yahoo.com>
 <CAGgJW773SRbVAz3O3GkiAZSzO7TTeGJRVS6XSJu+qFpTHeZo_Q@mail.gmail.com>
Message-ID: <C4F59115-DD65-452F-B549-63E41649C7A6@dcn.davis.ca.us>

Not all advice received on the Internet is safe.

https://xkcd.com/327

https://db.rstudio.com/best-practices/run-queries-safely

It is not that much more difficult to do it right.

On July 2, 2021 12:05:43 PM PDT, Eric Berger <ericjberger at gmail.com> wrote:
>Modify the summ() function to start like this
>
>summ <- function(Tabname){
>   query <- sprintf(" SELECT * FROM %s",Tabname)
>  res <- dbGetQuery(con, query)
>
>etc
>
>HTH,
>Eric
>
>On Fri, Jul 2, 2021 at 9:39 PM Kai Yang via R-help
><r-help at r-project.org>
>wrote:
>
>> Hello List,
>>
>> The previous post look massy. I repost my question. Sorry,
>>
>>
>> I need to generate summary report for many tables (>200 tables). For
>each
>> table, I can use the script to generate report:
>> res <- dbGetQuery(con, "SELECT * FROM BIODBX.MECCUNIQUE2")
>> view(dfSummary(res), file =
>> "W:/project/_Joe.B/MSSQL/try/summarytools.BIODBX.MECCUNIQUE2.html")
>> rm(res)
>> BIODBX.MECCUNIQUE2 is the name of table.
>>
>> I have all of tables' name in a data frame. So, I'm trying to write a
>> function to do this:
>> summ <- function(Tabname){
>>   res <- dbGetQuery(con, "SELECT * FROM Tabname")
>>   view(dfSummary(res), file =
>> "W:/project/_Joe.B/MSSQL/try/summarytools.Tabname.html")
>>   rm(res)
>> }
>> for (i in dbtable$Tot_table)
>> {
>>   Tabname <- as.character(sqldf(sprintf("SELECT Tot_table FROM
>dbtable",
>> i)))
>>   summ(Tabname)
>> }
>>
>> 1. I created  a function summ, the argument is Tabname. I put the
>Tabname
>> in the function. I hope it can be replaced one by one
>> 2. the table dbtable contents all tables' name (>200 rows), the field
>name
>> is Tot_table
>> 3. I want use "for" to establish a loop, which can automatic generate
>a
>> summary report for each table
>>
>> but I got error message below:
>>  Error: nanodbc/nanodbc.cpp:1655: 42000: [Microsoft][ODBC Driver 17
>for
>> SQL Server][SQL Server]Invalid object name 'Tabname'.
>> [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s)
>could
>> not be prepared.
>>
>> <SQL> 'SELECT * FROM Tabname'
>> 10. stop(structure(list(message = "nanodbc/nanodbc.cpp:1655: 42000:
>> [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid
>> object name 'Tabname'.  [Microsoft][ODBC Driver 17 for SQL
>Server][SQL
>> Server]Statement(s) could not be prepared. \n<SQL>
>> 'SELECT * FROM Tabname'",
>>     call = NULL, cppstack = NULL), class = c("odbc::odbc_error",
>> "C++Error", "error", "condition")))
>> 9.new_result(connection at ptr, statement, immediate)
>> 8.OdbcResult(connection = conn, statement = statement, params =
>params,
>>  immediate = immediate)
>> 7..local(conn, statement, ...)
>> 6.dbSendQuery(conn, statement, params = params, ...)
>> 5.dbSendQuery(conn, statement, params = params, ...)
>> 4..local(conn, statement, ...)
>> 3.dbGetQuery(con, "SELECT * FROM Tabname")
>> 2.dbGetQuery(con, "SELECT * FROM Tabname")
>> 1.summ(Tabname)
>>
>> it seems the tables' name is not successfully pass into query. can
>someone
>> give me an instruction for this?
>> many thanks,
>> Kai
>>
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From y@ngk@|9999 @end|ng |rom y@hoo@com  Fri Jul  2 21:47:34 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Fri, 2 Jul 2021 19:47:34 +0000 (UTC)
Subject: [R] R Function question, (repost to fix the messy work format)
In-Reply-To: <CAGgJW74PPihHBFQpoLKKiEA=kOmXbv2Un3SXJCYaCt-Kj7oEKQ@mail.gmail.com>
References: <779214286.1955402.1625251003343.ref@mail.yahoo.com>
 <779214286.1955402.1625251003343@mail.yahoo.com>
 <CAGgJW773SRbVAz3O3GkiAZSzO7TTeGJRVS6XSJu+qFpTHeZo_Q@mail.gmail.com>
 <2100728260.1911397.1625253646228@mail.yahoo.com>
 <CAGgJW74PPihHBFQpoLKKiEA=kOmXbv2Un3SXJCYaCt-Kj7oEKQ@mail.gmail.com>
Message-ID: <950206489.795193.1625255254847@mail.yahoo.com>

 Hi Eric,
Thank you spent time to help me for this.

Here is the thing: I was requested to manage a sql server for my group. the server has many schemas and the tables (>200). I use ODBC to connect the server and get the schema name + table name into a data frame.

For each of schema + table on server, I need to run a summary report. So I wrote a summary script like this:

res <- dbGetQuery(con, "SELECT * FROM BIODBX.MECCUNIQUE2")
view(dfSummary(res), file = "W:/project/_Joe.B/MSSQL/try/summarytools.BIODBX.MECCUNIQUE2.html")
rm(res)

the script works well. but I don't want to write 200+ times of the script to summary each table. So, I'm trying to write the function to do this. this is my goal.

First of all, I'm not sure if this is the right way to do the summary report, because I'm a new R user. So please correct me if my idea is doable.

Second, would you please tell me what is "more detail" information do you need?

Thank you,
Kai


    On Friday, July 2, 2021, 12:31:17 PM PDT, Eric Berger <ericjberger at gmail.com> wrote:  
 
 Hard for me to tell without more details but it looks like the following has several bugs
for (i in dbtable$Tot_table){
? Tabname <- as.character(sqldf(sprintf("SELECT Tot_table FROM dbtable", i)))
? summ(Tabname)
}

Your sprintf() statement seems to use?'i' but actually does not.You probably?want to rewrite/rearrange this code. More like
x <-?sqldf("SELECT Tot_table FROM dbtable")for ( Tabname in x )summ(Tabname)
no doubt?this is wrong but put a browser() call after the x <- sqldf(...)line and inspect x and go from there



On Fri, Jul 2, 2021 at 10:20 PM Kai Yang <yangkai9999 at yahoo.com> wrote:

 Hello Eric,
Following your suggestion, I modified the code as:
summ <- function(Tabname){
? query <- sprintf(" SELECT * FROM %s",Tabname)
? res <- dbGetQuery(con, query)
? view(dfSummary(res), file = "W:/project/_Joe.B/MSSQL/try/summarytools.Tabname.html")
? rm(res)
}

for (i in dbtable$Tot_table)
{
? Tabname <- as.character(sqldf(sprintf("SELECT Tot_table FROM dbtable", i)))
? summ(Tabname)
}
after submitted the work, I got the error message below:

?Error: nanodbc/nanodbc.cpp:1655: 42000: [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'c'.? [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared.?<SQL> ' SELECT * FROM c("BIODBX.MECCUNIQUE2", "BIODBX.QDATA_HTML_DUMMY", "BIODBX.SET_ITEMS", "BIODBX.SET_NAMES", "dbo.sysdiagrams", "GEMD.ASSAY_DEFINITIONS", "GEMD.ASSAY_DISCRETE_VALUES", "GEMD.ASSAY_QUESTIONS", "GEMD.ASSAY_RUNS", "GEMD.BIODBX_DATABASE_SEED", "GEMD.BIODBX_USER_SEEDS", "GEMD.BIODBX_USERS", "GEMD.DATA_ENTRY_PAGES", "GEMD.DISC_SESSION_QID", "GEMD.DISC_SESSION_STATUS", "GEMD.DISC_SESSION_TYPE", "GEMD.DISCREPANCIES", "GEMD.DISCREPANCY_QUERY_TEMP", "GEMD.DISCRETE_VALUES", "GEMD.ENTERED_DATA_ENTRY_PAGES", "GEMD.ENTRY_GROUPS",?"GEMD.ExportSampleListNames", "GEMD.FORM_STATUS_BY_SUBJECT", "GEMD.GEMD_CODELIST_GROUPS", "GEMD.GEMD_CODELIST_VALUES", "GEMD.GEMD_LOT_DEFINITIONS", "GEMD.GEMD_SAMPLES", "GEMD.GEMD_STUDIES", "GEMD.MECCUNIQUE", "GEMD.MECCUNIQUE2", "GEMD.MISSING_DI?

One more question,? in the code of "view(dfSummary(res), file = "W:/project/_Joe.B/MSSQL/try/summarytools.Tabname.html")",
can Tabname part be replacted automatic also??
Thank you,
Kai    On Friday, July 2, 2021, 12:06:12 PM PDT, Eric Berger <ericjberger at gmail.com> wrote:  
 
 Modify the summ() function to start like this?
summ <- function(Tabname){? ?query <- sprintf("SELECT * FROM?%s",Tabname)
? res <- dbGetQuery(con, query)
?
etc
HTH,Eric
On Fri, Jul 2, 2021 at 9:39 PM Kai Yang via R-help <r-help at r-project.org> wrote:

Hello List,

The previous post look massy. I repost my question. Sorry,


I need to generate summary report for many tables (>200 tables). For each table, I can use the script to generate report:
res <- dbGetQuery(con, "SELECT * FROM BIODBX.MECCUNIQUE2")
view(dfSummary(res), file = "W:/project/_Joe.B/MSSQL/try/summarytools.BIODBX.MECCUNIQUE2.html")
rm(res)
BIODBX.MECCUNIQUE2 is the name of table.

I have all of tables' name in a data frame. So, I'm trying to write a function to do this:
summ <- function(Tabname){
? res <- dbGetQuery(con, "SELECT * FROM Tabname")
? view(dfSummary(res), file = "W:/project/_Joe.B/MSSQL/try/summarytools.Tabname.html")
? rm(res)
}
for (i in dbtable$Tot_table)
{
? Tabname <- as.character(sqldf(sprintf("SELECT Tot_table FROM dbtable", i)))
? summ(Tabname)
}

1. I created? a function summ, the argument is Tabname. I put the Tabname in the function. I hope it can be replaced one by one
2. the table dbtable contents all tables' name (>200 rows), the field name is Tot_table
3. I want use "for" to establish a loop, which can automatic generate a summary report for each table

but I got error message below:
?Error: nanodbc/nanodbc.cpp:1655: 42000: [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'Tabname'.??
[Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared.?

<SQL> 'SELECT * FROM Tabname'?
10. stop(structure(list(message = "nanodbc/nanodbc.cpp:1655: 42000: [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid?
object name 'Tabname'.? [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. \n<SQL>?
'SELECT * FROM Tabname'",?
? ? call = NULL, cppstack = NULL), class = c("odbc::odbc_error",?
"C++Error", "error", "condition")))?
9.new_result(connection at ptr, statement, immediate)?
8.OdbcResult(connection = conn, statement = statement, params = params,? ? ?immediate = immediate)?
7..local(conn, statement, ...)?
6.dbSendQuery(conn, statement, params = params, ...)?
5.dbSendQuery(conn, statement, params = params, ...)?
4..local(conn, statement, ...)?
3.dbGetQuery(con, "SELECT * FROM Tabname")?
2.dbGetQuery(con, "SELECT * FROM Tabname")?
1.summ(Tabname)?

it seems the tables' name is not successfully pass into query. can someone give me an instruction for this?
many thanks,
Kai


? ? ? ? [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

  
  
	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Fri Jul  2 21:56:44 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Fri, 2 Jul 2021 22:56:44 +0300
Subject: [R] R Function question, (repost to fix the messy work format)
In-Reply-To: <950206489.795193.1625255254847@mail.yahoo.com>
References: <779214286.1955402.1625251003343.ref@mail.yahoo.com>
 <779214286.1955402.1625251003343@mail.yahoo.com>
 <CAGgJW773SRbVAz3O3GkiAZSzO7TTeGJRVS6XSJu+qFpTHeZo_Q@mail.gmail.com>
 <2100728260.1911397.1625253646228@mail.yahoo.com>
 <CAGgJW74PPihHBFQpoLKKiEA=kOmXbv2Un3SXJCYaCt-Kj7oEKQ@mail.gmail.com>
 <950206489.795193.1625255254847@mail.yahoo.com>
Message-ID: <CAGgJW77PBku95k9jUZ50sTwkrFQ-bjogD6mWqY0UBVwp1J2zgw@mail.gmail.com>

Definitely doable and you are on the right path and maybe even close.
The error message you got showed your query as having the wrong info after
the 'FROM'
keyword

<SQL> ' SELECT * FROM c("BIODBX.MECCUNIQUE2", "BIODBX.QDATA_HTML_DUMMY",
"BIODBX.SET_ITEMS", "BIODBX.SET_NAMES", "dbo.sysdiagrams",
"GEMD.ASSAY_DEFINITIONS",

etc

i.e you are passing the full vector of table names and not a single one
(the first being the one specified in your working example)

You have to figure out how to correctly set up your loop on this vector of
table names.
The debugger - browser() - is your friend! Learn how to use it, as I
suggested before.



...



On Fri, Jul 2, 2021 at 10:47 PM Kai Yang <yangkai9999 at yahoo.com> wrote:

> Hi Eric,
>
> Thank you spent time to help me for this.
>
>
> Here is the thing: I was requested to manage a sql server for my group.
> the server has many schemas and the tables (>200). I use ODBC to connect
> the server and get the schema name + table name into a data frame.
>
>
> For each of schema + table on server, I need to run a summary report. So I
> wrote a summary script like this:
>
>
> res <- dbGetQuery(con, "SELECT * FROM BIODBX.MECCUNIQUE2")
>
> view(dfSummary(res), file =
> "W:/project/_Joe.B/MSSQL/try/summarytools.BIODBX.MECCUNIQUE2.html")
>
> rm(res)
>
>
> the script works well. but I don't want to write 200+ times of the script
> to summary each table. So, I'm trying to write the function to do this.
> this is my goal.
>
>
> First of all, I'm not sure if this is the right way to do the summary
> report, because I'm a new R user. So please correct me if my idea is doable.
>
>
> Second, would you please tell me what is "more detail" information do you
> need?
>
>
> Thank you,
>
> Kai
>
>
>
> On Friday, July 2, 2021, 12:31:17 PM PDT, Eric Berger <
> ericjberger at gmail.com> wrote:
>
>
> Hard for me to tell without more details but it looks like the following
> has several bugs
>
> for (i in dbtable$Tot_table)
> {
>   Tabname <- as.character(sqldf(sprintf("SELECT Tot_table FROM dbtable",
> i)))
>   summ(Tabname)
> }
>
> Your sprintf() statement seems to use 'i' but actually does not.
> You probably want to rewrite/rearrange this code. More like
>
> x <- sqldf("SELECT Tot_table FROM dbtable")
> for ( Tabname in x )
> summ(Tabname)
>
> no doubt this is wrong but put a browser() call after the x <- sqldf(...)
> line and inspect x and go from there
>
>
>
>
> On Fri, Jul 2, 2021 at 10:20 PM Kai Yang <yangkai9999 at yahoo.com> wrote:
>
> Hello Eric,
>
> Following your suggestion, I modified the code as:
>
> summ <- function(Tabname){
>
>   query <- sprintf(" SELECT * FROM %s",Tabname)
>
>   res <- dbGetQuery(con, query)
>
>   view(dfSummary(res), file =
> "W:/project/_Joe.B/MSSQL/try/summarytools.Tabname.html")
>
>   rm(res)
>
> }
>
>
> for (i in dbtable$Tot_table)
>
> {
>
>   Tabname <- as.character(sqldf(sprintf("SELECT Tot_table FROM dbtable",
> i)))
>
>   summ(Tabname)
>
> }
>
> after submitted the work, I got the error message below:
>
>
>  Error: nanodbc/nanodbc.cpp:1655: 42000: [Microsoft][ODBC Driver 17 for
> SQL Server][SQL Server]Invalid object name 'c'.  [Microsoft][ODBC Driver 17
> for SQL Server][SQL Server]Statement(s) could not be prepared.
> <SQL> ' SELECT * FROM c("BIODBX.MECCUNIQUE2", "BIODBX.QDATA_HTML_DUMMY",
> "BIODBX.SET_ITEMS", "BIODBX.SET_NAMES", "dbo.sysdiagrams",
> "GEMD.ASSAY_DEFINITIONS", "GEMD.ASSAY_DISCRETE_VALUES",
> "GEMD.ASSAY_QUESTIONS", "GEMD.ASSAY_RUNS", "GEMD.BIODBX_DATABASE_SEED",
> "GEMD.BIODBX_USER_SEEDS", "GEMD.BIODBX_USERS", "GEMD.DATA_ENTRY_PAGES",
> "GEMD.DISC_SESSION_QID", "GEMD.DISC_SESSION_STATUS",
> "GEMD.DISC_SESSION_TYPE", "GEMD.DISCREPANCIES",
> "GEMD.DISCREPANCY_QUERY_TEMP", "GEMD.DISCRETE_VALUES",
> "GEMD.ENTERED_DATA_ENTRY_PAGES", "GEMD.ENTRY_GROUPS",
> "GEMD.ExportSampleListNames", "GEMD.FORM_STATUS_BY_SUBJECT",
> "GEMD.GEMD_CODELIST_GROUPS", "GEMD.GEMD_CODELIST_VALUES",
> "GEMD.GEMD_LOT_DEFINITIONS", "GEMD.GEMD_SAMPLES", "GEMD.GEMD_STUDIES",
> "GEMD.MECCUNIQUE", "GEMD.MECCUNIQUE2", "GEMD.MISSING_DI
>
>
> One more question,  in the code of "*view(dfSummary(res), file =
> "W:/project/_Joe.B/MSSQL/try/summarytools.Tabname.html")*",
>
> can Tabname part be replacted automatic also?
>
> Thank you,
>
> Kai
> On Friday, July 2, 2021, 12:06:12 PM PDT, Eric Berger <
> ericjberger at gmail.com> wrote:
>
>
> Modify the summ() function to start like this
>
> summ <- function(Tabname){
>    query <- sprintf(" SELECT * FROM %s",Tabname)
>   res <- dbGetQuery(con, query)
>
> etc
>
> HTH,
> Eric
>
> On Fri, Jul 2, 2021 at 9:39 PM Kai Yang via R-help <r-help at r-project.org>
> wrote:
>
> Hello List,
>
> The previous post look massy. I repost my question. Sorry,
>
>
> I need to generate summary report for many tables (>200 tables). For each
> table, I can use the script to generate report:
> res <- dbGetQuery(con, "SELECT * FROM BIODBX.MECCUNIQUE2")
> view(dfSummary(res), file =
> "W:/project/_Joe.B/MSSQL/try/summarytools.BIODBX.MECCUNIQUE2.html")
> rm(res)
> BIODBX.MECCUNIQUE2 is the name of table.
>
> I have all of tables' name in a data frame. So, I'm trying to write a
> function to do this:
> summ <- function(Tabname){
>   res <- dbGetQuery(con, "SELECT * FROM Tabname")
>   view(dfSummary(res), file =
> "W:/project/_Joe.B/MSSQL/try/summarytools.Tabname.html")
>   rm(res)
> }
> for (i in dbtable$Tot_table)
> {
>   Tabname <- as.character(sqldf(sprintf("SELECT Tot_table FROM dbtable",
> i)))
>   summ(Tabname)
> }
>
> 1. I created  a function summ, the argument is Tabname. I put the Tabname
> in the function. I hope it can be replaced one by one
> 2. the table dbtable contents all tables' name (>200 rows), the field name
> is Tot_table
> 3. I want use "for" to establish a loop, which can automatic generate a
> summary report for each table
>
> but I got error message below:
>  Error: nanodbc/nanodbc.cpp:1655: 42000: [Microsoft][ODBC Driver 17 for
> SQL Server][SQL Server]Invalid object name 'Tabname'.
> [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could
> not be prepared.
>
> <SQL> 'SELECT * FROM Tabname'
> 10. stop(structure(list(message = "nanodbc/nanodbc.cpp:1655: 42000:
> [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid
> object name 'Tabname'.  [Microsoft][ODBC Driver 17 for SQL Server][SQL
> Server]Statement(s) could not be prepared. \n<SQL>
> 'SELECT * FROM Tabname'",
>     call = NULL, cppstack = NULL), class = c("odbc::odbc_error",
> "C++Error", "error", "condition")))
> 9.new_result(connection at ptr, statement, immediate)
> 8.OdbcResult(connection = conn, statement = statement, params = params,
>  immediate = immediate)
> 7..local(conn, statement, ...)
> 6.dbSendQuery(conn, statement, params = params, ...)
> 5.dbSendQuery(conn, statement, params = params, ...)
> 4..local(conn, statement, ...)
> 3.dbGetQuery(con, "SELECT * FROM Tabname")
> 2.dbGetQuery(con, "SELECT * FROM Tabname")
> 1.summ(Tabname)
>
> it seems the tables' name is not successfully pass into query. can someone
> give me an instruction for this?
> many thanks,
> Kai
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
>

	[[alternative HTML version deleted]]


From @v|gro@@ @end|ng |rom ver|zon@net  Fri Jul  2 22:17:36 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Fri, 2 Jul 2021 16:17:36 -0400
Subject: [R] concatenating columns in data.frame
In-Reply-To: <8AE9E4D9-722C-4993-98E7-0FA2AF2F9AA3@dcn.davis.ca.us>
References: <e0a0d23f-c4a6-540c-be31-90ba894dba11@gmail.com>
 <056701d76ef4$173342f0$4599c8d0$@verizon.net>
 <8AE9E4D9-722C-4993-98E7-0FA2AF2F9AA3@dcn.davis.ca.us>
Message-ID: <010201d76f7f$4c8dcc50$e5a964f0$@verizon.net>

I know what you mean Jeff. Yes I am very familiar with base R techniques. What I had hoped for was to do two things that some of the other methods mentioned do that ended up bringing two data.frames together as part of the solution.

Much of what I used is now standard R. I was looking at the accessory functions now commonly used in dplyr that let you dynamically select which columns to work with like begins_with() to choose. Sadly, they seem to work on a top-level but not easily within a call to something like paste(...) where they are not evaluated in the way I want.

But the odd method I tried can also be used in standard R with a bit of work. You can create a function without using dplyr that takes your df and uses it to concatenate and end with something like:

df$new_col <- do_something(df, selected_cols)

That too adds a column without the need to merge larger structures explicitly..

But your other point is a tad religious in a sense. I happen to prefer learning a core language first then looking at enhancement opportunities. But at some point, if teaching someone new who wants to focus on getting a job done simply but not necessarily repeatedly or in some ideal way, it is best to do things in a way that their mind flows better.

Many things in the tidyverse are redundant with base R or just "fix" inconsistencies like making sure the first argument is always the same. But many add substantially to doing things in a more step-by-step manner.

I do not worship the base language as it first came out or even as it has evolved. I do like to know what choices I have and pick and choose among them as needed. Of course a forum like this is more about base R than otherwise and I acknowledge that. Still, the ":=" operator is now base R. There is a new pipeline operator "|>" in base R. Some ideas, good or otherwise, do get in eventually.

I started doing graphs using base R as in the plot() command. It was adequate but I wanted better. So I learned about Lattice and various packages and eventually ggplot. I can now do things I barely imagined before and am still learning that there is much more I can do with packages underneath much of the magic and also additional packages layered above it, in some sense. So I do not approach that with an either-or mentality either.

Note I am not really talking about just R. I have similar issues with other languages I program in such as Python. None of them were created fully-formed and many had to add huge amounts to adapt to additional wants and needs. Base R for me is often inadequate. But so what?

The task being asked for in this thread in isolation, indeed may not be done any better using packages. However, if it is part of a larger set of tasks that can be pipelined, it may well be and I personally was wondering if there was a way in dplyr. There probably is a much better way than I assembled if I only knew about it, and if not, they may add this kind of indirection in a future release if deemed worthy of doing. I have gone back to programs I did years ago with humungous amounts of code using what I knew then and reducing it drastically now that I can tell a function to select say all my column names that end in .orig and apply a set of functions to them with output going to the base name followed by .mean and .sd and so on. All that can often be done in one or two lines of code where previously I had to do 18 near repetitions of each part and then another and another. That used a limited form of dynamism.

Be that as it may I think the requester has enough info and we can move on.

-----Original Message-----
From: Jeff Newmiller <jdnewmil at dcn.davis.ca.us> 
Sent: Friday, July 2, 2021 1:03 AM
To: Avi Gross <avigross at verizon.net>; Avi Gross via R-help <r-help at r-project.org>; R-help at r-project.org
Subject: Re: [R] concatenating columns in data.frame

I use parts of the tidyverse frequently, but this post is the best argument I can imagine for learning base R techniques.

On July 1, 2021 8:41:06 PM PDT, Avi Gross via R-help <r-help at r-project.org> wrote:
>Micha,
>
>Others have provided ways in standard R so I will contribute a somewhat 
>odd solution using the dplyr and related packages in the tidyverse 
>including a sample data.frame/tibble I made. It requires newer versions 
>of R and other  packages as it uses some fairly esoteric features 
>including "the big bang" and the new ":=" operator and more.
>
>You can use your own data with whatever columns you need, of course.
>
>The goal is to have umpteen columns in the data that you want to add an 
>additional columns to an existing tibble that is the result of 
>concatenating the rowwise contents of a dynamically supplied vector of 
>column names in quotes. First we need something to work with so here is 
>a sample:
>
>#--start
># load required packages, or a bunch at once!
>library(tidyverse)
>
># Pick how many rows you want. For a demo, 3 is plenty N <- 3
>
># Make a sample tibble with N rows and the following 4 columns mydf <- 
>tibble(alpha = 1:N,
>               beta=letters[1:N],
>               gamma = N:1,
>               delta = month.abb[1:N])
>
># show the original tibble
>print(mydf)
>#--end
>
>In flat text mode, here is the output:
>
>> print(mydf)
># A tibble: 3 x 4
>alpha beta  gamma delta
><int> <chr> <int> <chr>
>  1     1 a         3 Jan  
>2     2 b         2 Feb  
>3     3 c         1 Mar
>
>Now I want to make a function that is used instead of the mutate verb.
>I made a weird one-liner that is a tad hard to explain so first let me 
>mention the requirements.
>
>It will take a first argument that is a tibble and in a pipeline this 
>would be passed invisibly.
>The second required argument is a vector or list containing the names 
>of the columns as strings. A column can be re-used multiple times.
>The third optional argument is what to name the new column with a 
>default if omitted.
>The fourth optional argument allows you to choose a different separator 
>than "" if you wish.
>
>The function should be usable in a pipeline on both sides so it should 
>also return the input tibble with an extra column to the output.
>
>Here is the function:
>
>my_mutate <- function(df, columns, colnew="concatenated", sep=""){
>  df %>%
>    mutate( "{colnew}" := paste(!!!rlang::syms(columns), sep = sep )) }
>
>Yes, the above can be done inline as a long one-liner:
>
>my_mutate <- function(df, columns, colnew="concatenated", sep="") 
>mutate(df, "{colnew}" := paste(!!!rlang::syms(columns), sep = sep ))
>
>Here are examples of it running:
>
>
>> choices <- c("beta", "delta", "alpha", "delta") mydf %>% 
>> my_mutate(choices, "me2")
># A tibble: 3 x 5
>alpha beta  gamma delta me2     
><int> <chr> <int> <chr> <chr>   
>  1     1 a         3 Jan   aJan1Jan
>2     2 b         2 Feb   bFeb2Feb
>3     3 c         1 Mar   cMar3Mar
>> mydf %>% my_mutate(choices, "me2",":")
># A tibble: 3 x 5
>alpha beta  gamma delta me2        
><int> <chr> <int> <chr> <chr>      
>  1     1 a         3 Jan   a:Jan:1:Jan
>2     2 b         2 Feb   b:Feb:2:Feb
>3     3 c         1 Mar   c:Mar:3:Mar
>> mydf %>% my_mutate(c("beta", "beta", "gamma", "gamma", "delta",
>> "alpha"))
># A tibble: 3 x 5
>alpha beta  gamma delta concatenated
><int> <chr> <int> <chr> <chr>       
>  1     1 a         3 Jan   aa33Jan1    
>2     2 b         2 Feb   bb22Feb2    
>3     3 c         1 Mar   cc11Mar3    
>> mydf %>% my_mutate(list("beta", "beta", "gamma", "gamma", "delta",
>> "alpha"))
># A tibble: 3 x 5
>alpha beta  gamma delta concatenated
><int> <chr> <int> <chr> <chr>       
>  1     1 a         3 Jan   aa33Jan1    
>2     2 b         2 Feb   bb22Feb2    
>3     3 c         1 Mar   cc11Mar3    
>> mydf %>% my_mutate(columns=list("alpha", "beta", "gamma", "delta", 
>> "gamma", "beta", "alpha"),
>                     +                    sep="/*/",
>                     +                    colnew="NewRandomNAME"
>                     +                    )
># A tibble: 3 x 5
>alpha beta  gamma delta NewRandomNAME              
><int> <chr> <int> <chr> <chr>                      
>  1     1 a         3 Jan   1/*/a/*/3/*/Jan/*/3/*/a/*/1
>2     2 b         2 Feb   2/*/b/*/2/*/Feb/*/2/*/b/*/2
>3     3 c         1 Mar   3/*/c/*/1/*/Mar/*/1/*/c/*/3
>
>Does this meet your normal need? Just to show it works in a pipeline, 
>here is a variant:
>
>mydf %>%
>  tail(2) %>%
>  my_mutate(c("beta", "beta"), "betabeta") %>%
>  print() %>%
>  my_mutate(list("alpha", "betabeta", "gamma"),
>            "buildson", 
>            "&")
>
>The above only keeps the last two lines of the tibble, makes a double 
>copy of "beta" under a new name, prints the intermediate result, 
>continues to make another concatenation using the variable created 
>earlier then prints the result:
>
>Here is the run:
>
>> mydf %>%
>  +   tail(2) %>%
>  +   my_mutate(c("beta", "beta"), "betabeta") %>%
>  +   print() %>%
>  +   my_mutate(list("alpha", "betabeta", "gamma"),
>                +             "buildson", 
>                +             "&")
># A tibble: 2 x 5
>alpha beta  gamma delta betabeta
><int> <chr> <int> <chr> <chr>   
>  1     2 b         2 Feb   bb      
>2     3 c         1 Mar   cc      
># A tibble: 2 x 6
>alpha beta  gamma delta betabeta buildson
><int> <chr> <int> <chr> <chr>    <chr>   
>  1     2 b         2 Feb   bb       2&bb&2  
>2     3 c         1 Mar   cc       3&cc&1  
>
>As to how the darn function works, that was a learning experience for 
>me to build using features I have not had occasion to use. If anyone 
>remains interested, read on.
>
>The following needs newish features:
>
>	"{colnew}" := SOMETHING
>
>The colon-equals operator in newer R/dplyr can be sort of used in an 
>odd way that allows the name of the variable to be in quotes and in 
>brackets akin to the way glue() does it. The variable colnew is 
>evaluated and substituted so the name used for the column is now 
>dynamic.
>
>The function does a paste using this:
>
>	!!!rlang::syms(columns)
>
>The problem is paste() wants multiple arguments and we have a single 
>argument that is either a vector or another kind of vector called a 
>list. The trick is to convert the vector into symbols then use "!!!" to 
>convert something like 'c("alpha", "beta", "gamma")' into something 
>more like ' "alpha", "beta", "gamma" ' so that paste sees them as 
>multiple arguments to concatenate in vector fashion.
>
>And, the function is not polished but I am sure you can all see some of 
>what is needed like checking the arguments for validity, including not 
>having a name for the new column that clashes with existing column 
>names, doing something sane if no columns to concatenate are offered 
>and so on.
>
>Just showing a different approach. The base R methods are fine.
>
>- Avi
>
>-----Original Message-----
>From: R-help <r-help-bounces at r-project.org> On Behalf Of Micha Silver
>Sent: Thursday, July 1, 2021 10:36 AM
>To: R-help at r-project.org
>Subject: [R] concatenating columns in data.frame
>
>I need to create a new data.frame column as a concatenation of existing 
>character columns. But the number and name of the columns to 
>concatenate needs to be passed in dynamically. The code below does what 
>I want, but seems very clumsy. Any suggestions how to improve?
>
>
>df = data.frame("A"=sample(letters, 10), "B"=sample(letters, 10), 
>"C"=sample(letters,10), "D"=sample(letters, 10))
>
># Which columns to concat:
>
>use_columns = c("D", "B")
>
>
>UpdateCombo = function(df, use_columns) {
>     use_df = df[, use_columns]
>     combo_list = lapply(1:nrow(use_df), function(r) {
>     r_combo = paste(use_df[r,], collapse="_")
>     return(data.frame("Combo" = r_combo))
>     })
>     combo = do.call(rbind, combo_list)
>
>     names(combo) = "Combo"
>
>     return(combo)
>
>}
>
>
>combo_col = UpdateCombo(df, use_columns)
>
>df_combo = do.call(cbind, list(df, combo_col))
>
>
>Thanks
>
>
>--
>Micha Silver
>Ben Gurion Univ.
>Sde Boker, Remote Sensing Lab
>cell: +972-523-665918
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

--
Sent from my phone. Please excuse my brevity.


From ycd|ng @end|ng |rom coh@org  Sat Jul  3 00:27:21 2021
From: ycd|ng @end|ng |rom coh@org (Yuan Chun Ding)
Date: Fri, 2 Jul 2021 22:27:21 +0000
Subject: [R] add a variable a data frame  to sequentially count unique rows
Message-ID: <SJ0PR02MB7645A67CD8ACF60FA841FE87D41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>

Hi R users,

In this test file,
test  <- data.frame(group1=c("g1", "g1", "g1", "g2", "g2", "g2", "g2", "g2", "g2"),
                                       group2=c("k1", "a2", "a2", "c5", "n6", "n6", "n6", "m10","m10"),
                                       count= c( 1,     1,    2,   1,     2,   2,     2,    3,    3 ));

I have group 1 and group2 variable and want to add the count variable to sequentially count unique rows defined by group1 and group2.  

I hope to use the following functions in library (tidyverse),  No one worked well.
test %>% group_by(group1, group2) %>% mutate(count = row_number())
test %>% group_by(group1, group2) %>% mutate(count = 1:n())
test %>% group_by(group1, group2) %>% mutate(count = seq_len(n()))
test %>% group_by(group1, group2) %>% mutate(count = seq_along(group1, group2))

Can you help me to make the third column in the test data frame?

Thank you,

Ding

----------------------------------------------------------------------
------------------------------------------------------------
-SECURITY/CONFIDENTIALITY WARNING-  

This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to receive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sat Jul  3 00:35:49 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 02 Jul 2021 15:35:49 -0700
Subject: [R] 
 add a variable a data frame  to sequentially count unique rows
In-Reply-To: <SJ0PR02MB7645A67CD8ACF60FA841FE87D41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
References: <SJ0PR02MB7645A67CD8ACF60FA841FE87D41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
Message-ID: <15641B36-6792-43E8-92E8-255B88FE9A0C@dcn.davis.ca.us>

It is poor analytical design to keep duplicates. If they are not duplicates then there should be a distinguishing additional column. IMO you should re-think your analysis rather than accomplish this short-term goal only to find down the road that this duplication causes future problems.

On July 2, 2021 3:27:21 PM PDT, Yuan Chun Ding <ycding at coh.org> wrote:
>Hi R users,
>
>In this test file,
>test  <- data.frame(group1=c("g1", "g1", "g1", "g2", "g2", "g2", "g2",
>"g2", "g2"),
>       group2=c("k1", "a2", "a2", "c5", "n6", "n6", "n6", "m10","m10"),
>       count= c( 1,     1,    2,   1,     2,   2,     2,    3,    3 ));
>
>I have group 1 and group2 variable and want to add the count variable
>to sequentially count unique rows defined by group1 and group2.  
>
>I hope to use the following functions in library (tidyverse),  No one
>worked well.
>test %>% group_by(group1, group2) %>% mutate(count = row_number())
>test %>% group_by(group1, group2) %>% mutate(count = 1:n())
>test %>% group_by(group1, group2) %>% mutate(count = seq_len(n()))
>test %>% group_by(group1, group2) %>% mutate(count = seq_along(group1,
>group2))
>
>Can you help me to make the third column in the test data frame?
>
>Thank you,
>
>Ding
>
>----------------------------------------------------------------------
>------------------------------------------------------------
>-SECURITY/CONFIDENTIALITY WARNING-  
>
>This message and any attachments are intended solely for the individual
>or entity to which they are addressed. This communication may contain
>information that is privileged, confidential, or exempt from disclosure
>under applicable law (e.g., personal health information, research data,
>financial information). Because this e-mail has been sent without
>encryption, individuals other than the intended recipient may be able
>to view the information, forward it to others or tamper with the
>information without the knowledge or consent of the sender. If you are
>not the intended recipient, or the employee or person responsible for
>delivering the message to the intended recipient, any dissemination,
>distribution or copying of the communication is strictly prohibited. If
>you received the communication in error, please notify the sender
>immediately by replying to this message and deleting the message and
>any accompanying files from your system. If, due to the security risks,
>you do not wish to receive further communications via e-mail, please
>reply to this message and inform the sender that you do not wish to
>receive further e-mail from the sender. (LCP301)
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From ycd|ng @end|ng |rom coh@org  Sat Jul  3 00:42:21 2021
From: ycd|ng @end|ng |rom coh@org (Yuan Chun Ding)
Date: Fri, 2 Jul 2021 22:42:21 +0000
Subject: [R] 
 add a variable a data frame  to sequentially count unique rows
In-Reply-To: <15641B36-6792-43E8-92E8-255B88FE9A0C@dcn.davis.ca.us>
References: <SJ0PR02MB7645A67CD8ACF60FA841FE87D41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
 <15641B36-6792-43E8-92E8-255B88FE9A0C@dcn.davis.ca.us>
Message-ID: <SJ0PR02MB76458700365817A07099E46FD41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>

Hi Jeff,

Thank you for your quick response!!
I made this following summary file, however, I want to add the count number sequentially into the original file, because I have several more columns to explain or annotate the first two columns.

count_test <- test %>% group_by(group1 ) %>%summarise(Number_of_region = n_distinct(group2))


Ding
-----Original Message-----
From: Jeff Newmiller [mailto:jdnewmil at dcn.davis.ca.us] 
Sent: Friday, July 2, 2021 3:36 PM
To: r-help at r-project.org; Yuan Chun Ding <ycding at coh.org>; r-help at r-project.org
Subject: Re: [R] add a variable a data frame to sequentially count unique rows

It is poor analytical design to keep duplicates. If they are not duplicates then there should be a distinguishing additional column. IMO you should re-think your analysis rather than accomplish this short-term goal only to find down the road that this duplication causes future problems.

On July 2, 2021 3:27:21 PM PDT, Yuan Chun Ding <ycding at coh.org> wrote:
>Hi R users,
>
>In this test file,
>test  <- data.frame(group1=c("g1", "g1", "g1", "g2", "g2", "g2", "g2", 
>"g2", "g2"),
>       group2=c("k1", "a2", "a2", "c5", "n6", "n6", "n6", "m10","m10"),
>       count= c( 1,     1,    2,   1,     2,   2,     2,    3,    3 ));
>
>I have group 1 and group2 variable and want to add the count variable 
>to sequentially count unique rows defined by group1 and group2.
>
>I hope to use the following functions in library (tidyverse),  No one 
>worked well.
>test %>% group_by(group1, group2) %>% mutate(count = row_number()) test 
>%>% group_by(group1, group2) %>% mutate(count = 1:n()) test %>% 
>group_by(group1, group2) %>% mutate(count = seq_len(n())) test %>% 
>group_by(group1, group2) %>% mutate(count = seq_along(group1,
>group2))
>
>Can you help me to make the third column in the test data frame?
>
>Thank you,
>
>Ding
>
>----------------------------------------------------------------------
>------------------------------------------------------------
>-SECURITY/CONFIDENTIALITY WARNING-
>
>This message and any attachments are intended solely for the individual 
>or entity to which they are addressed. This communication may contain 
>information that is privileged, confidential, or exempt from disclosure 
>under applicable law (e.g., personal health information, research data, 
>financial information). Because this e-mail has been sent without 
>encryption, individuals other than the intended recipient may be able 
>to view the information, forward it to others or tamper with the 
>information without the knowledge or consent of the sender. If you are 
>not the intended recipient, or the employee or person responsible for 
>delivering the message to the intended recipient, any dissemination, 
>distribution or copying of the communication is strictly prohibited. If 
>you received the communication in error, please notify the sender 
>immediately by replying to this message and deleting the message and 
>any accompanying files from your system. If, due to the security risks, 
>you do not wish to receive further communications via e-mail, please 
>reply to this message and inform the sender that you do not wish to 
>receive further e-mail from the sender. (LCP301)
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-hel
>p__;!!Fou38LsQmgU!6hr10CQQybFHF0rsNtkWtEHa_9iV_iYS8khF0fy8MDanYoQM40_aN
>bjXXLLn$
>PLEASE do read the posting guide
>https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html
>__;!!Fou38LsQmgU!6hr10CQQybFHF0rsNtkWtEHa_9iV_iYS8khF0fy8MDanYoQM40_aNV
>Lja7f2$ and provide commented, minimal, self-contained, reproducible 
>code.

--
Sent from my phone. Please excuse my brevity.

From bgunter@4567 @end|ng |rom gm@||@com  Sat Jul  3 01:35:38 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 2 Jul 2021 16:35:38 -0700
Subject: [R] 
 add a variable a data frame to sequentially count unique rows
In-Reply-To: <SJ0PR02MB7645A67CD8ACF60FA841FE87D41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
References: <SJ0PR02MB7645A67CD8ACF60FA841FE87D41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
Message-ID: <CAGxFJbREoFz-QRFgCNT3zrwkCeUYQAzUGiCkoM-eY2T6MeQS7w@mail.gmail.com>

Your example makes no sense (to me, anyway). Please check it
carefully. Note that the count in rows 2 and 3 increment but the
counts in rows 5-7 or rows 8-9 do not. So your specification seems
inconsistent to me.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Fri, Jul 2, 2021 at 3:27 PM Yuan Chun Ding <ycding at coh.org> wrote:
>
> Hi R users,
>
> In this test file,
> test  <- data.frame(group1=c("g1", "g1", "g1", "g2", "g2", "g2", "g2", "g2", "g2"),
>                                        group2=c("k1", "a2", "a2", "c5", "n6", "n6", "n6", "m10","m10"),
>                                        count= c( 1,     1,    2,   1,     2,   2,     2,    3,    3 ));
>
> I have group 1 and group2 variable and want to add the count variable to sequentially count unique rows defined by group1 and group2.
>
> I hope to use the following functions in library (tidyverse),  No one worked well.
> test %>% group_by(group1, group2) %>% mutate(count = row_number())
> test %>% group_by(group1, group2) %>% mutate(count = 1:n())
> test %>% group_by(group1, group2) %>% mutate(count = seq_len(n()))
> test %>% group_by(group1, group2) %>% mutate(count = seq_along(group1, group2))
>
> Can you help me to make the third column in the test data frame?
>
> Thank you,
>
> Ding
>
> ----------------------------------------------------------------------
> ------------------------------------------------------------
> -SECURITY/CONFIDENTIALITY WARNING-
>
> This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to receive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sat Jul  3 01:51:15 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 2 Jul 2021 16:51:15 -0700 (PDT)
Subject: [R] 
 add a variable a data frame to sequentially count unique rows
In-Reply-To: <SJ0PR02MB76458700365817A07099E46FD41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
References: <SJ0PR02MB7645A67CD8ACF60FA841FE87D41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
 <15641B36-6792-43E8-92E8-255B88FE9A0C@dcn.davis.ca.us>
 <SJ0PR02MB76458700365817A07099E46FD41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
Message-ID: <alpine.BSF.2.00.2107021559570.15131@pedal.dcn.davis.ca.us>

I am not sure I understand... you are referring to files but we are not 
discussing files here. There are "input" and "output" phases yet to be 
dealt with that separate the analysis you do in R from the files 
themselves. We are discussing data frames here.

Regardless, you either have duplicates in your input (faulty data) or you 
do not have duplicates because there are additional distinguishing columns 
that you have not identified. (https://en.wikipedia.org/wiki/Primary_key)

The solution to the problem that you should not have involves making a 
sensible (not faulty) copy of your data, setting up the count column, and 
then joining the faulty data with the sensible data.

Note that the ordering of the result happens to be retained when using 
dplyr::left_join, but is not retained using most other join 
implementations (such as base::merge). There can be significant 
performance gains to be had by giving up on record ordering, which is one 
of the reasons why having a valid primary key can be so important.

library(dplyr)
lookup_df <- (   test
              %>% select( group1, group2 )
              %>% filter( !duplicated( . ) )
              %>% group_by( group1 )
              %>% mutate( count1 = seq.int( n() ) )
              %>% ungroup()
              )
ans <- left_join( test, lookup_df, by = c( "group1", "group2" ) )

  On Fri, 2 Jul 2021, Yuan Chun Ding wrote:

> Hi Jeff,
>
> Thank you for your quick response!!
> I made this following summary file, however, I want to add the count number sequentially into the original file, because I have several more columns to explain or annotate the first two columns.
>
> count_test <- test %>% group_by(group1 ) %>%summarise(Number_of_region = n_distinct(group2))
>
>
> Ding
> -----Original Message-----
> From: Jeff Newmiller [mailto:jdnewmil at dcn.davis.ca.us]
> Sent: Friday, July 2, 2021 3:36 PM
> To: r-help at r-project.org; Yuan Chun Ding <ycding at coh.org>; r-help at r-project.org
> Subject: Re: [R] add a variable a data frame to sequentially count unique rows
>
> It is poor analytical design to keep duplicates. If they are not duplicates then there should be a distinguishing additional column. IMO you should re-think your analysis rather than accomplish this short-term goal only to find down the road that this duplication causes future problems.
>
> On July 2, 2021 3:27:21 PM PDT, Yuan Chun Ding <ycding at coh.org> wrote:
>> Hi R users,
>>
>> In this test file,
>> test  <- data.frame(group1=c("g1", "g1", "g1", "g2", "g2", "g2", "g2",
>> "g2", "g2"),
>>       group2=c("k1", "a2", "a2", "c5", "n6", "n6", "n6", "m10","m10"),
>>       count= c( 1,     1,    2,   1,     2,   2,     2,    3,    3 ));
>>
>> I have group 1 and group2 variable and want to add the count variable
>> to sequentially count unique rows defined by group1 and group2.
>>
>> I hope to use the following functions in library (tidyverse),  No one
>> worked well.
>> test %>% group_by(group1, group2) %>% mutate(count = row_number()) test
>> %>% group_by(group1, group2) %>% mutate(count = 1:n()) test %>%
>> group_by(group1, group2) %>% mutate(count = seq_len(n())) test %>%
>> group_by(group1, group2) %>% mutate(count = seq_along(group1,
>> group2))
>>
>> Can you help me to make the third column in the test data frame?
>>
>> Thank you,
>>
>> Ding
>>
>> ----------------------------------------------------------------------
>> ------------------------------------------------------------
>> -SECURITY/CONFIDENTIALITY WARNING-
>>
>> This message and any attachments are intended solely for the individual
>> or entity to which they are addressed. This communication may contain
>> information that is privileged, confidential, or exempt from disclosure
>> under applicable law (e.g., personal health information, research data,
>> financial information). Because this e-mail has been sent without
>> encryption, individuals other than the intended recipient may be able
>> to view the information, forward it to others or tamper with the
>> information without the knowledge or consent of the sender. If you are
>> not the intended recipient, or the employee or person responsible for
>> delivering the message to the intended recipient, any dissemination,
>> distribution or copying of the communication is strictly prohibited. If
>> you received the communication in error, please notify the sender
>> immediately by replying to this message and deleting the message and
>> any accompanying files from your system. If, due to the security risks,
>> you do not wish to receive further communications via e-mail, please
>> reply to this message and inform the sender that you do not wish to
>> receive further e-mail from the sender. (LCP301)
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-hel
>> p__;!!Fou38LsQmgU!6hr10CQQybFHF0rsNtkWtEHa_9iV_iYS8khF0fy8MDanYoQM40_aN
>> bjXXLLn$
>> PLEASE do read the posting guide
>> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html
>> __;!!Fou38LsQmgU!6hr10CQQybFHF0rsNtkWtEHa_9iV_iYS8khF0fy8MDanYoQM40_aNV
>> Lja7f2$ and provide commented, minimal, self-contained, reproducible
>> code.
>
> --
> Sent from my phone. Please excuse my brevity.
>

---------------------------------------------------------------------------
Jeff Newmiller                        The     .....       .....  Go Live...
DCN:<jdnewmil at dcn.davis.ca.us>        Basics: ##.#.       ##.#.  Live Go...
                                       Live:   OO#.. Dead: OO#..  Playing
Research Engineer (Solar/Batteries            O.O#.       #.O#.  with
/Software/Embedded Controllers)               .OO#.       .OO#.  rocks...1k


From ycd|ng @end|ng |rom coh@org  Sat Jul  3 01:44:35 2021
From: ycd|ng @end|ng |rom coh@org (Yuan Chun Ding)
Date: Fri, 2 Jul 2021 23:44:35 +0000
Subject: [R] 
 add a variable a data frame to sequentially count unique rows
In-Reply-To: <CAGxFJbREoFz-QRFgCNT3zrwkCeUYQAzUGiCkoM-eY2T6MeQS7w@mail.gmail.com>
References: <SJ0PR02MB7645A67CD8ACF60FA841FE87D41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
 <CAGxFJbREoFz-QRFgCNT3zrwkCeUYQAzUGiCkoM-eY2T6MeQS7w@mail.gmail.com>
Message-ID: <SJ0PR02MB7645C19573F96B1CEE17D92ED41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>

Hi Bert,

I am very sorry that I made a mistake for the second count value. The original data are much more complicated, I just made a toy table.


 test  <- data.frame(group1=c("g1", "g1", "g1", "g2", "g2", "g2", "g2", "g2", "g2"),
                                        group2=c("k1", "a2", "a2", "c5", "n6", "n6", "n6", "m10","m10"),
                                         count=   c( 1,       2,        2,       1,      2,   2,     2,    3,    3 ));

I want to get count column.

the summary count is below.
count_test <- test %>% group_by(group1 ) %>%summarise(Number_of_region = n_distinct(group2))

Thank you,

Ding

-----Original Message-----
From: Bert Gunter [mailto:bgunter.4567 at gmail.com] 
Sent: Friday, July 2, 2021 4:36 PM
To: Yuan Chun Ding <ycding at coh.org>
Cc: r-help at r-project.org
Subject: Re: [R] add a variable a data frame to sequentially count unique rows

Your example makes no sense (to me, anyway). Please check it carefully. Note that the count in rows 2 and 3 increment but the counts in rows 5-7 or rows 8-9 do not. So your specification seems inconsistent to me.

Bert Gunter

"The trouble with having an open mind is that people keep coming along and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Fri, Jul 2, 2021 at 3:27 PM Yuan Chun Ding <ycding at coh.org> wrote:
>
> Hi R users,
>
> In this test file,
> test  <- data.frame(group1=c("g1", "g1", "g1", "g2", "g2", "g2", "g2", "g2", "g2"),
>                                         group2=c("k1", "a2", "a2", "c5", "n6", "n6", "n6", "m10","m10"),
>                                           count=   c( 1,       2,        2,       1,      2,   2,     2,    3,    3 ));
>
> I have group 1 and group2 variable and want to add the count variable to sequentially count unique rows defined by group1 and group2.
>
> I hope to use the following functions in library (tidyverse),  No one worked well.
> test %>% group_by(group1, group2) %>% mutate(count = row_number()) 
> test %>% group_by(group1, group2) %>% mutate(count = 1:n()) test %>% 
> group_by(group1, group2) %>% mutate(count = seq_len(n())) test %>% 
> group_by(group1, group2) %>% mutate(count = seq_along(group1, group2))
>
> Can you help me to make the third column in the test data frame?
>
> Thank you,
>
> Ding
>
> ----------------------------------------------------------------------
> ------------------------------------------------------------
> -SECURITY/CONFIDENTIALITY WARNING-
>
> This message and any attachments are intended solely for the 
> individual or entity to which they are addressed. This communication 
> may contain information that is privileged, confidential, or exempt 
> from disclosure under applicable law (e.g., personal health 
> information, research data, financial information). Because this 
> e-mail has been sent without encryption, individuals other than the 
> intended recipient may be able to view the information, forward it to 
> others or tamper with the information without the knowledge or consent 
> of the sender. If you are not the intended recipient, or the employee 
> or person responsible for delivering the message to the intended 
> recipient, any dissemination, distribution or copying of the 
> communication is strictly prohibited. If you received the 
> communication in error, please notify the sender immediately by 
> replying to this message and deleting the message and any accompanying 
> files from your system. If, due to the security risks, you do not wish 
> to receive further communications via e-mail, please reply to this 
> message and inform the sender that you do not wish to receive further 
> e-mail from the sender. (LCP301)
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-he
> lp__;!!Fou38LsQmgU!49KQUSjG8hBMc_vqsnkIV0zOGGrGt0DjnjV167p8sI20Fzx-913
> RxHIHpfjS$ PLEASE do read the posting guide 
> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.htm
> l__;!!Fou38LsQmgU!49KQUSjG8hBMc_vqsnkIV0zOGGrGt0DjnjV167p8sI20Fzx-913R
> xDpiVYEa$ and provide commented, minimal, self-contained, reproducible 
> code.

From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sat Jul  3 01:59:21 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 2 Jul 2021 16:59:21 -0700 (PDT)
Subject: [R] concatenating columns in data.frame
In-Reply-To: <010201d76f7f$4c8dcc50$e5a964f0$@verizon.net>
References: <e0a0d23f-c4a6-540c-be31-90ba894dba11@gmail.com>
 <056701d76ef4$173342f0$4599c8d0$@verizon.net>
 <8AE9E4D9-722C-4993-98E7-0FA2AF2F9AA3@dcn.davis.ca.us>
 <010201d76f7f$4c8dcc50$e5a964f0$@verizon.net>
Message-ID: <alpine.BSF.2.00.2107021652140.15131@pedal.dcn.davis.ca.us>

I am very agnostic about tidyverse/base R. However, the complexity of 
setting up NSE functions is often simply not needed, and I encounter so 
many people who simply disregard base R as being too outdated so that they 
never learn how simple solutions in R can be. The contrast between your 
solution and Bert's was... perhaps informative, but a nuclear bomb where 
an axe was sufficient.

On Fri, 2 Jul 2021, Avi Gross via R-help wrote:

> I know what you mean Jeff. Yes I am very familiar with base R techniques. What I had hoped for was to do two things that some of the other methods mentioned do that ended up bringing two data.frames together as part of the solution.
>
> Much of what I used is now standard R. I was looking at the accessory functions now commonly used in dplyr that let you dynamically select which columns to work with like begins_with() to choose. Sadly, they seem to work on a top-level but not easily within a call to something like paste(...) where they are not evaluated in the way I want.
>
> But the odd method I tried can also be used in standard R with a bit of work. You can create a function without using dplyr that takes your df and uses it to concatenate and end with something like:
>
> df$new_col <- do_something(df, selected_cols)
>
> That too adds a column without the need to merge larger structures explicitly..
>
> But your other point is a tad religious in a sense. I happen to prefer learning a core language first then looking at enhancement opportunities. But at some point, if teaching someone new who wants to focus on getting a job done simply but not necessarily repeatedly or in some ideal way, it is best to do things in a way that their mind flows better.
>
> Many things in the tidyverse are redundant with base R or just "fix" inconsistencies like making sure the first argument is always the same. But many add substantially to doing things in a more step-by-step manner.
>
> I do not worship the base language as it first came out or even as it has evolved. I do like to know what choices I have and pick and choose among them as needed. Of course a forum like this is more about base R than otherwise and I acknowledge that. Still, the ":=" operator is now base R. There is a new pipeline operator "|>" in base R. Some ideas, good or otherwise, do get in eventually.
>
> I started doing graphs using base R as in the plot() command. It was adequate but I wanted better. So I learned about Lattice and various packages and eventually ggplot. I can now do things I barely imagined before and am still learning that there is much more I can do with packages underneath much of the magic and also additional packages layered above it, in some sense. So I do not approach that with an either-or mentality either.
>
> Note I am not really talking about just R. I have similar issues with other languages I program in such as Python. None of them were created fully-formed and many had to add huge amounts to adapt to additional wants and needs. Base R for me is often inadequate. But so what?
>
> The task being asked for in this thread in isolation, indeed may not be done any better using packages. However, if it is part of a larger set of tasks that can be pipelined, it may well be and I personally was wondering if there was a way in dplyr. There probably is a much better way than I assembled if I only knew about it, and if not, they may add this kind of indirection in a future release if deemed worthy of doing. I have gone back to programs I did years ago with humungous amounts of code using what I knew then and reducing it drastically now that I can tell a function to select say all my column names that end in .orig and apply a set of functions to them with output going to the base name followed by .mean and .sd and so on. All that can often be done in one or two lines of code where previously I had to do 18 near repetitions of each part and then another and another. That used a limited form of dynamism.
>
> Be that as it may I think the requester has enough info and we can move on.
>
> -----Original Message-----
> From: Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
> Sent: Friday, July 2, 2021 1:03 AM
> To: Avi Gross <avigross at verizon.net>; Avi Gross via R-help <r-help at r-project.org>; R-help at r-project.org
> Subject: Re: [R] concatenating columns in data.frame
>
> I use parts of the tidyverse frequently, but this post is the best argument I can imagine for learning base R techniques.
>
> On July 1, 2021 8:41:06 PM PDT, Avi Gross via R-help <r-help at r-project.org> wrote:
>> Micha,
>>
>> Others have provided ways in standard R so I will contribute a somewhat
>> odd solution using the dplyr and related packages in the tidyverse
>> including a sample data.frame/tibble I made. It requires newer versions
>> of R and other  packages as it uses some fairly esoteric features
>> including "the big bang" and the new ":=" operator and more.
>>
>> You can use your own data with whatever columns you need, of course.
>>
>> The goal is to have umpteen columns in the data that you want to add an
>> additional columns to an existing tibble that is the result of
>> concatenating the rowwise contents of a dynamically supplied vector of
>> column names in quotes. First we need something to work with so here is
>> a sample:
>>
>> #--start
>> # load required packages, or a bunch at once!
>> library(tidyverse)
>>
>> # Pick how many rows you want. For a demo, 3 is plenty N <- 3
>>
>> # Make a sample tibble with N rows and the following 4 columns mydf <-
>> tibble(alpha = 1:N,
>>               beta=letters[1:N],
>>               gamma = N:1,
>>               delta = month.abb[1:N])
>>
>> # show the original tibble
>> print(mydf)
>> #--end
>>
>> In flat text mode, here is the output:
>>
>>> print(mydf)
>> # A tibble: 3 x 4
>> alpha beta  gamma delta
>> <int> <chr> <int> <chr>
>>  1     1 a         3 Jan
>> 2     2 b         2 Feb
>> 3     3 c         1 Mar
>>
>> Now I want to make a function that is used instead of the mutate verb.
>> I made a weird one-liner that is a tad hard to explain so first let me
>> mention the requirements.
>>
>> It will take a first argument that is a tibble and in a pipeline this
>> would be passed invisibly.
>> The second required argument is a vector or list containing the names
>> of the columns as strings. A column can be re-used multiple times.
>> The third optional argument is what to name the new column with a
>> default if omitted.
>> The fourth optional argument allows you to choose a different separator
>> than "" if you wish.
>>
>> The function should be usable in a pipeline on both sides so it should
>> also return the input tibble with an extra column to the output.
>>
>> Here is the function:
>>
>> my_mutate <- function(df, columns, colnew="concatenated", sep=""){
>>  df %>%
>>    mutate( "{colnew}" := paste(!!!rlang::syms(columns), sep = sep )) }
>>
>> Yes, the above can be done inline as a long one-liner:
>>
>> my_mutate <- function(df, columns, colnew="concatenated", sep="")
>> mutate(df, "{colnew}" := paste(!!!rlang::syms(columns), sep = sep ))
>>
>> Here are examples of it running:
>>
>>
>>> choices <- c("beta", "delta", "alpha", "delta") mydf %>%
>>> my_mutate(choices, "me2")
>> # A tibble: 3 x 5
>> alpha beta  gamma delta me2
>> <int> <chr> <int> <chr> <chr>
>>  1     1 a         3 Jan   aJan1Jan
>> 2     2 b         2 Feb   bFeb2Feb
>> 3     3 c         1 Mar   cMar3Mar
>>> mydf %>% my_mutate(choices, "me2",":")
>> # A tibble: 3 x 5
>> alpha beta  gamma delta me2
>> <int> <chr> <int> <chr> <chr>
>>  1     1 a         3 Jan   a:Jan:1:Jan
>> 2     2 b         2 Feb   b:Feb:2:Feb
>> 3     3 c         1 Mar   c:Mar:3:Mar
>>> mydf %>% my_mutate(c("beta", "beta", "gamma", "gamma", "delta",
>>> "alpha"))
>> # A tibble: 3 x 5
>> alpha beta  gamma delta concatenated
>> <int> <chr> <int> <chr> <chr>
>>  1     1 a         3 Jan   aa33Jan1
>> 2     2 b         2 Feb   bb22Feb2
>> 3     3 c         1 Mar   cc11Mar3
>>> mydf %>% my_mutate(list("beta", "beta", "gamma", "gamma", "delta",
>>> "alpha"))
>> # A tibble: 3 x 5
>> alpha beta  gamma delta concatenated
>> <int> <chr> <int> <chr> <chr>
>>  1     1 a         3 Jan   aa33Jan1
>> 2     2 b         2 Feb   bb22Feb2
>> 3     3 c         1 Mar   cc11Mar3
>>> mydf %>% my_mutate(columns=list("alpha", "beta", "gamma", "delta",
>>> "gamma", "beta", "alpha"),
>>                     +                    sep="/*/",
>>                     +                    colnew="NewRandomNAME"
>>                     +                    )
>> # A tibble: 3 x 5
>> alpha beta  gamma delta NewRandomNAME
>> <int> <chr> <int> <chr> <chr>
>>  1     1 a         3 Jan   1/*/a/*/3/*/Jan/*/3/*/a/*/1
>> 2     2 b         2 Feb   2/*/b/*/2/*/Feb/*/2/*/b/*/2
>> 3     3 c         1 Mar   3/*/c/*/1/*/Mar/*/1/*/c/*/3
>>
>> Does this meet your normal need? Just to show it works in a pipeline,
>> here is a variant:
>>
>> mydf %>%
>>  tail(2) %>%
>>  my_mutate(c("beta", "beta"), "betabeta") %>%
>>  print() %>%
>>  my_mutate(list("alpha", "betabeta", "gamma"),
>>            "buildson",
>>            "&")
>>
>> The above only keeps the last two lines of the tibble, makes a double
>> copy of "beta" under a new name, prints the intermediate result,
>> continues to make another concatenation using the variable created
>> earlier then prints the result:
>>
>> Here is the run:
>>
>>> mydf %>%
>>  +   tail(2) %>%
>>  +   my_mutate(c("beta", "beta"), "betabeta") %>%
>>  +   print() %>%
>>  +   my_mutate(list("alpha", "betabeta", "gamma"),
>>                +             "buildson",
>>                +             "&")
>> # A tibble: 2 x 5
>> alpha beta  gamma delta betabeta
>> <int> <chr> <int> <chr> <chr>
>>  1     2 b         2 Feb   bb
>> 2     3 c         1 Mar   cc
>> # A tibble: 2 x 6
>> alpha beta  gamma delta betabeta buildson
>> <int> <chr> <int> <chr> <chr>    <chr>
>>  1     2 b         2 Feb   bb       2&bb&2
>> 2     3 c         1 Mar   cc       3&cc&1
>>
>> As to how the darn function works, that was a learning experience for
>> me to build using features I have not had occasion to use. If anyone
>> remains interested, read on.
>>
>> The following needs newish features:
>>
>> 	"{colnew}" := SOMETHING
>>
>> The colon-equals operator in newer R/dplyr can be sort of used in an
>> odd way that allows the name of the variable to be in quotes and in
>> brackets akin to the way glue() does it. The variable colnew is
>> evaluated and substituted so the name used for the column is now
>> dynamic.
>>
>> The function does a paste using this:
>>
>> 	!!!rlang::syms(columns)
>>
>> The problem is paste() wants multiple arguments and we have a single
>> argument that is either a vector or another kind of vector called a
>> list. The trick is to convert the vector into symbols then use "!!!" to
>> convert something like 'c("alpha", "beta", "gamma")' into something
>> more like ' "alpha", "beta", "gamma" ' so that paste sees them as
>> multiple arguments to concatenate in vector fashion.
>>
>> And, the function is not polished but I am sure you can all see some of
>> what is needed like checking the arguments for validity, including not
>> having a name for the new column that clashes with existing column
>> names, doing something sane if no columns to concatenate are offered
>> and so on.
>>
>> Just showing a different approach. The base R methods are fine.
>>
>> - Avi
>>
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Micha Silver
>> Sent: Thursday, July 1, 2021 10:36 AM
>> To: R-help at r-project.org
>> Subject: [R] concatenating columns in data.frame
>>
>> I need to create a new data.frame column as a concatenation of existing
>> character columns. But the number and name of the columns to
>> concatenate needs to be passed in dynamically. The code below does what
>> I want, but seems very clumsy. Any suggestions how to improve?
>>
>>
>> df = data.frame("A"=sample(letters, 10), "B"=sample(letters, 10),
>> "C"=sample(letters,10), "D"=sample(letters, 10))
>>
>> # Which columns to concat:
>>
>> use_columns = c("D", "B")
>>
>>
>> UpdateCombo = function(df, use_columns) {
>>     use_df = df[, use_columns]
>>     combo_list = lapply(1:nrow(use_df), function(r) {
>>     r_combo = paste(use_df[r,], collapse="_")
>>     return(data.frame("Combo" = r_combo))
>>     })
>>     combo = do.call(rbind, combo_list)
>>
>>     names(combo) = "Combo"
>>
>>     return(combo)
>>
>> }
>>
>>
>> combo_col = UpdateCombo(df, use_columns)
>>
>> df_combo = do.call(cbind, list(df, combo_col))
>>
>>
>> Thanks
>>
>>
>> --
>> Micha Silver
>> Ben Gurion Univ.
>> Sde Boker, Remote Sensing Lab
>> cell: +972-523-665918
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
> --
> Sent from my phone. Please excuse my brevity.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

---------------------------------------------------------------------------
Jeff Newmiller                        The     .....       .....  Go Live...
DCN:<jdnewmil at dcn.davis.ca.us>        Basics: ##.#.       ##.#.  Live Go...
                                       Live:   OO#.. Dead: OO#..  Playing
Research Engineer (Solar/Batteries            O.O#.       #.O#.  with
/Software/Embedded Controllers)               .OO#.       .OO#.  rocks...1k


From ycd|ng @end|ng |rom coh@org  Sat Jul  3 02:01:58 2021
From: ycd|ng @end|ng |rom coh@org (Yuan Chun Ding)
Date: Sat, 3 Jul 2021 00:01:58 +0000
Subject: [R] 
 add a variable a data frame to sequentially count unique rows
In-Reply-To: <alpine.BSF.2.00.2107021559570.15131@pedal.dcn.davis.ca.us>
References: <SJ0PR02MB7645A67CD8ACF60FA841FE87D41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
 <15641B36-6792-43E8-92E8-255B88FE9A0C@dcn.davis.ca.us>
 <SJ0PR02MB76458700365817A07099E46FD41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
 <alpine.BSF.2.00.2107021559570.15131@pedal.dcn.davis.ca.us>
Message-ID: <SJ0PR02MB76459801D5E3F98E369D9D35D41E9@SJ0PR02MB7645.namprd02.prod.outlook.com>

Hi Jeff,
Your code generated the count what I wanted.    

As I emailed to Bert, yes, I made a mistake when generating the toy table,  the second count value should be 2.
Correct file is 
test  <- data.frame(group1=c("g1", "g1", "g1", "g2", "g2", "g2", "g2", "g2", "g2"),
                    group2=c("k1", "a2", "a2", "c5", "n6", "n6", "n6", "m10","m10"),
                    count=   c(  1,      2,        2,        1,        2,        2,       2,          3,        3 ));
  
I also thought about removing of duplicates first and then doing a merge.  For some reason,  I  thought  one line of code  from tidyverse library could do it .

Thank You,

Ding

-----Original Message-----
From: Jeff Newmiller [mailto:jdnewmil at dcn.davis.ca.us] 
Sent: Friday, July 2, 2021 4:51 PM
To: Yuan Chun Ding <ycding at coh.org>
Cc: r-help at r-project.org; r-help at r-project.org
Subject: RE: [R] add a variable a data frame to sequentially count unique rows

I am not sure I understand... you are referring to files but we are not discussing files here. There are "input" and "output" phases yet to be dealt with that separate the analysis you do in R from the files themselves. We are discussing data frames here.

Regardless, you either have duplicates in your input (faulty data) or you do not have duplicates because there are additional distinguishing columns that you have not identified. (https://urldefense.com/v3/__https://en.wikipedia.org/wiki/Primary_key__;!!Fou38LsQmgU!9delUPpdk-OQmYXQ0xQaFd2NDqykIVLC403VICI0m2ihoIqtK3XP0PTJ7-ev$ )

The solution to the problem that you should not have involves making a sensible (not faulty) copy of your data, setting up the count column, and then joining the faulty data with the sensible data.

Note that the ordering of the result happens to be retained when using dplyr::left_join, but is not retained using most other join implementations (such as base::merge). There can be significant performance gains to be had by giving up on record ordering, which is one of the reasons why having a valid primary key can be so important.

library(dplyr)
lookup_df <- (   test
              %>% select( group1, group2 )
              %>% filter( !duplicated( . ) )
              %>% group_by( group1 )
              %>% mutate( count1 = seq.int( n() ) )
              %>% ungroup()
              )
ans <- left_join( test, lookup_df, by = c( "group1", "group2" ) )

  On Fri, 2 Jul 2021, Yuan Chun Ding wrote:

> Hi Jeff,
>
> Thank you for your quick response!!
> I made this following summary file, however, I want to add the count number sequentially into the original file, because I have several more columns to explain or annotate the first two columns.
>
> count_test <- test %>% group_by(group1 ) %>%summarise(Number_of_region 
> = n_distinct(group2))
>
>
> Ding
> -----Original Message-----
> From: Jeff Newmiller [mailto:jdnewmil at dcn.davis.ca.us]
> Sent: Friday, July 2, 2021 3:36 PM
> To: r-help at r-project.org; Yuan Chun Ding <ycding at coh.org>; 
> r-help at r-project.org
> Subject: Re: [R] add a variable a data frame to sequentially count 
> unique rows
>
> It is poor analytical design to keep duplicates. If they are not duplicates then there should be a distinguishing additional column. IMO you should re-think your analysis rather than accomplish this short-term goal only to find down the road that this duplication causes future problems.
>
> On July 2, 2021 3:27:21 PM PDT, Yuan Chun Ding <ycding at coh.org> wrote:
>> Hi R users,
>>
>> In this test file,
>> test  <- data.frame(group1=c("g1", "g1", "g1", "g2", "g2", "g2", 
>> "g2", "g2", "g2"),
>>       group2=c("k1", "a2", "a2", "c5", "n6", "n6", "n6", "m10","m10"),
>>       count= c( 1,     1,    2,   1,     2,   2,     2,    3,    3 ));
>>
>> I have group 1 and group2 variable and want to add the count variable 
>> to sequentially count unique rows defined by group1 and group2.
>>
>> I hope to use the following functions in library (tidyverse),  No one 
>> worked well.
>> test %>% group_by(group1, group2) %>% mutate(count = row_number()) 
>> test %>% group_by(group1, group2) %>% mutate(count = 1:n()) test %>% 
>> group_by(group1, group2) %>% mutate(count = seq_len(n())) test %>% 
>> group_by(group1, group2) %>% mutate(count = seq_along(group1,
>> group2))
>>
>> Can you help me to make the third column in the test data frame?
>>
>> Thank you,
>>
>> Ding
>>
>> ---------------------------------------------------------------------
>> -
>> ------------------------------------------------------------
>> -SECURITY/CONFIDENTIALITY WARNING-
>>
>> This message and any attachments are intended solely for the 
>> individual or entity to which they are addressed. This communication 
>> may contain information that is privileged, confidential, or exempt 
>> from disclosure under applicable law (e.g., personal health 
>> information, research data, financial information). Because this 
>> e-mail has been sent without encryption, individuals other than the 
>> intended recipient may be able to view the information, forward it to 
>> others or tamper with the information without the knowledge or 
>> consent of the sender. If you are not the intended recipient, or the 
>> employee or person responsible for delivering the message to the 
>> intended recipient, any dissemination, distribution or copying of the 
>> communication is strictly prohibited. If you received the 
>> communication in error, please notify the sender immediately by 
>> replying to this message and deleting the message and any 
>> accompanying files from your system. If, due to the security risks, 
>> you do not wish to receive further communications via e-mail, please 
>> reply to this message and inform the sender that you do not wish to 
>> receive further e-mail from the sender. (LCP301)
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-h
>> el 
>> p__;!!Fou38LsQmgU!6hr10CQQybFHF0rsNtkWtEHa_9iV_iYS8khF0fy8MDanYoQM40_
>> aN
>> bjXXLLn$
>> PLEASE do read the posting guide
>> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.ht
>> ml 
>> __;!!Fou38LsQmgU!6hr10CQQybFHF0rsNtkWtEHa_9iV_iYS8khF0fy8MDanYoQM40_a
>> NV Lja7f2$ and provide commented, minimal, self-contained, 
>> reproducible code.
>
> --
> Sent from my phone. Please excuse my brevity.
>

---------------------------------------------------------------------------
Jeff Newmiller                        The     .....       .....  Go Live...
DCN:<jdnewmil at dcn.davis.ca.us>        Basics: ##.#.       ##.#.  Live Go...
                                       Live:   OO#.. Dead: OO#..  Playing
Research Engineer (Solar/Batteries            O.O#.       #.O#.  with
/Software/Embedded Controllers)               .OO#.       .OO#.  rocks...1k


From @v|gro@@ @end|ng |rom ver|zon@net  Sat Jul  3 02:13:58 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Fri, 2 Jul 2021 20:13:58 -0400
Subject: [R] 
 add a variable a data frame  to sequentially count unique rows
In-Reply-To: <SJ0PR02MB7645A67CD8ACF60FA841FE87D41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
References: <SJ0PR02MB7645A67CD8ACF60FA841FE87D41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
Message-ID: <038301d76fa0$52032fb0$f6098f10$@verizon.net>

Ding,

Just to get you to stop asking, here is a solution I hope works.

In English, if you are asking that ONE instance of a duplicate be marked in
a new column with TRUE or 1 while all remaining ones are marked as FALSE or
2 or whatever, that is easy enough. The method is to use the assistive
function row_number() inside a grouped mutate() and only one item has a row
number of 1 and all others higher.

If I load your test variable (see below) I can add another column I called
count2 fairly easily with this:

test %>% 
  group_by(group1,group2) %>% 
  mutate(count2 = ifelse(row_number()==1, TRUE, FALSE)) %>%
  ungroup()

The output matches your first count variable made by hand:

> test %>% 
  +   group_by(group1,group2) %>% 
  +   mutate(count2 = ifelse(row_number()==1, TRUE, FALSE)) %>%
  +   ungroup()
# A tibble: 9 x 4
group1 group2 count count2
<chr>  <chr>  <dbl> <lgl> 
  1 g1     k1         1 TRUE  
2 g1     a2         1 TRUE  
3 g1     a2         2 FALSE 
4 g2     c5         1 TRUE  
5 g2     n6         2 TRUE  
6 g2     n6         2 FALSE 
7 g2     n6         2 FALSE 
8 g2     m10        3 TRUE  
9 g2     m10        3 FALSE

Now if you actually want to have a count of first and 2nd and third, it is
even easier:

test %>% 
  group_by(group1,group2) %>% 
  mutate(counter = row_number()) %>%
  ungroup()

Unfortunately for you, my version of output suggest you made a mistake on
the last row with g2/n6:

> test %>% 
  +   group_by(group1,group2) %>% 
  +   mutate(counter = row_number()) %>%
  +   ungroup()
# A tibble: 9 x 4
group1 group2 count counter
<chr>  <chr>  <dbl>   <int>
  1 g1     k1         1       1
2 g1     a2         1       1
3 g1     a2         2       2
4 g2     c5         1       1
5 g2     n6         2       1
6 g2     n6         2       2
7 g2     n6         2       3
8 g2     m10        3       1
9 g2     m10        3       2

There are of course other ways to do such things but the above seems simple
enough.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Yuan Chun Ding
Sent: Friday, July 2, 2021 6:27 PM
To: r-help at r-project.org
Subject: [R] add a variable a data frame to sequentially count unique rows

Hi R users,

In this test file,
test  <- data.frame(group1=c("g1", "g1", "g1", "g2", "g2", "g2", "g2", "g2",
"g2"),
                                       group2=c("k1", "a2", "a2", "c5",
"n6", "n6", "n6", "m10","m10"),
                                       count= c( 1,     1,    2,   1,     2,
2,     2,    3,    3 ));

I have group 1 and group2 variable and want to add the count variable to
sequentially count unique rows defined by group1 and group2.  

I hope to use the following functions in library (tidyverse),  No one worked
well.
test %>% group_by(group1, group2) %>% mutate(count = row_number()) test %>%
group_by(group1, group2) %>% mutate(count = 1:n()) test %>% group_by(group1,
group2) %>% mutate(count = seq_len(n())) test %>% group_by(group1, group2)
%>% mutate(count = seq_along(group1, group2))

Can you help me to make the third column in the test data frame?

Thank you,

Ding

----------------------------------------------------------------------
------------------------------------------------------------
-SECURITY/CONFIDENTIALITY WARNING-  

This message and any attachments are intended solely for the individual or
entity to which they are addressed. This communication may contain
information that is privileged, confidential, or exempt from disclosure
under applicable law (e.g., personal health information, research data,
financial information). Because this e-mail has been sent without
encryption, individuals other than the intended recipient may be able to
view the information, forward it to others or tamper with the information
without the knowledge or consent of the sender. If you are not the intended
recipient, or the employee or person responsible for delivering the message
to the intended recipient, any dissemination, distribution or copying of the
communication is strictly prohibited. If you received the communication in
error, please notify the sender immediately by replying to this message and
deleting the message and any accompanying files from your system. If, due to
the security risks, you do not wish to receive further communications via
e-mail, please reply to this message and inform the sender that you do not
wish to receive further e-mail from the sender. (LCP301)

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Sat Jul  3 02:19:25 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 2 Jul 2021 17:19:25 -0700
Subject: [R] 
 add a variable a data frame to sequentially count unique rows
In-Reply-To: <SJ0PR02MB7645C19573F96B1CEE17D92ED41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
References: <SJ0PR02MB7645A67CD8ACF60FA841FE87D41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
 <CAGxFJbREoFz-QRFgCNT3zrwkCeUYQAzUGiCkoM-eY2T6MeQS7w@mail.gmail.com>
 <SJ0PR02MB7645C19573F96B1CEE17D92ED41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
Message-ID: <CAGxFJbSLGbzg9bGM6=10JZtbFcsjNE3t2PhDct4aPCh1zJ2pDw@mail.gmail.com>

Still can't makes sense of it. Shouldn't rows 5-7 have 3 for counts
and rows 8-9 have 2? If not, then I give up trying to figure out what
you mean. Maybe someone wlse can.


Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Fri, Jul 2, 2021 at 4:44 PM Yuan Chun Ding <ycding at coh.org> wrote:
>
> Hi Bert,
>
> I am very sorry that I made a mistake for the second count value. The original data are much more complicated, I just made a toy table.
>
>
>  test  <- data.frame(group1=c("g1", "g1", "g1", "g2", "g2", "g2", "g2", "g2", "g2"),
>                                         group2=c("k1", "a2", "a2", "c5", "n6", "n6", "n6", "m10","m10"),
>                                          count=   c( 1,       2,        2,       1,      2,   2,     2,    3,    3 ));
>
> I want to get count column.
>
> the summary count is below.
> count_test <- test %>% group_by(group1 ) %>%summarise(Number_of_region = n_distinct(group2))
>
> Thank you,
>
> Ding
>
> -----Original Message-----
> From: Bert Gunter [mailto:bgunter.4567 at gmail.com]
> Sent: Friday, July 2, 2021 4:36 PM
> To: Yuan Chun Ding <ycding at coh.org>
> Cc: r-help at r-project.org
> Subject: Re: [R] add a variable a data frame to sequentially count unique rows
>
> Your example makes no sense (to me, anyway). Please check it carefully. Note that the count in rows 2 and 3 increment but the counts in rows 5-7 or rows 8-9 do not. So your specification seems inconsistent to me.
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> On Fri, Jul 2, 2021 at 3:27 PM Yuan Chun Ding <ycding at coh.org> wrote:
> >
> > Hi R users,
> >
> > In this test file,
> > test  <- data.frame(group1=c("g1", "g1", "g1", "g2", "g2", "g2", "g2", "g2", "g2"),
> >                                         group2=c("k1", "a2", "a2", "c5", "n6", "n6", "n6", "m10","m10"),
> >                                           count=   c( 1,       2,        2,       1,      2,   2,     2,    3,    3 ));
> >
> > I have group 1 and group2 variable and want to add the count variable to sequentially count unique rows defined by group1 and group2.
> >
> > I hope to use the following functions in library (tidyverse),  No one worked well.
> > test %>% group_by(group1, group2) %>% mutate(count = row_number())
> > test %>% group_by(group1, group2) %>% mutate(count = 1:n()) test %>%
> > group_by(group1, group2) %>% mutate(count = seq_len(n())) test %>%
> > group_by(group1, group2) %>% mutate(count = seq_along(group1, group2))
> >
> > Can you help me to make the third column in the test data frame?
> >
> > Thank you,
> >
> > Ding
> >
> > ----------------------------------------------------------------------
> > ------------------------------------------------------------
> > -SECURITY/CONFIDENTIALITY WARNING-
> >
> > This message and any attachments are intended solely for the
> > individual or entity to which they are addressed. This communication
> > may contain information that is privileged, confidential, or exempt
> > from disclosure under applicable law (e.g., personal health
> > information, research data, financial information). Because this
> > e-mail has been sent without encryption, individuals other than the
> > intended recipient may be able to view the information, forward it to
> > others or tamper with the information without the knowledge or consent
> > of the sender. If you are not the intended recipient, or the employee
> > or person responsible for delivering the message to the intended
> > recipient, any dissemination, distribution or copying of the
> > communication is strictly prohibited. If you received the
> > communication in error, please notify the sender immediately by
> > replying to this message and deleting the message and any accompanying
> > files from your system. If, due to the security risks, you do not wish
> > to receive further communications via e-mail, please reply to this
> > message and inform the sender that you do not wish to receive further
> > e-mail from the sender. (LCP301)
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-he
> > lp__;!!Fou38LsQmgU!49KQUSjG8hBMc_vqsnkIV0zOGGrGt0DjnjV167p8sI20Fzx-913
> > RxHIHpfjS$ PLEASE do read the posting guide
> > https://urldefense.com/v3/__http://www.R-project.org/posting-guide.htm
> > l__;!!Fou38LsQmgU!49KQUSjG8hBMc_vqsnkIV0zOGGrGt0DjnjV167p8sI20Fzx-913R
> > xDpiVYEa$ and provide commented, minimal, self-contained, reproducible
> > code.


From ycd|ng @end|ng |rom coh@org  Sat Jul  3 02:26:30 2021
From: ycd|ng @end|ng |rom coh@org (Yuan Chun Ding)
Date: Sat, 3 Jul 2021 00:26:30 +0000
Subject: [R] 
 add a variable a data frame  to sequentially count unique rows
In-Reply-To: <038301d76fa0$52032fb0$f6098f10$@verizon.net>
References: <SJ0PR02MB7645A67CD8ACF60FA841FE87D41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
 <038301d76fa0$52032fb0$f6098f10$@verizon.net>
Message-ID: <SJ0PR02MB7645FDC229B1AA98270D9F4BD41E9@SJ0PR02MB7645.namprd02.prod.outlook.com>

Hi Avi,

Thank you for your patient with me!!  

Your code below generated what I want.  
test %>%
  group_by(group1,group2) %>%
  mutate(count2 = ifelse(row_number()==1, TRUE, FALSE)) %>%
  ungroup()

your code reminded me of the SAS first. And last. Function.  I gave up SAS several years ago.

Ding
-----Original Message-----
From: Avi Gross [mailto:avigross at verizon.net] 
Sent: Friday, July 2, 2021 5:14 PM
To: Yuan Chun Ding <ycding at coh.org>; r-help at r-project.org
Subject: RE: [R] add a variable a data frame to sequentially count unique rows

Ding,

Just to get you to stop asking, here is a solution I hope works.

In English, if you are asking that ONE instance of a duplicate be marked in a new column with TRUE or 1 while all remaining ones are marked as FALSE or
2 or whatever, that is easy enough. The method is to use the assistive function row_number() inside a grouped mutate() and only one item has a row number of 1 and all others higher.

If I load your test variable (see below) I can add another column I called
count2 fairly easily with this:

test %>%
  group_by(group1,group2) %>%
  mutate(count2 = ifelse(row_number()==1, TRUE, FALSE)) %>%
  ungroup()

The output matches your first count variable made by hand:

> test %>%
  +   group_by(group1,group2) %>% 
  +   mutate(count2 = ifelse(row_number()==1, TRUE, FALSE)) %>%
  +   ungroup()
# A tibble: 9 x 4
group1 group2 count count2
<chr>  <chr>  <dbl> <lgl> 
  1 g1     k1         1 TRUE  
2 g1     a2         1 TRUE  
3 g1     a2         2 FALSE 
4 g2     c5         1 TRUE  
5 g2     n6         2 TRUE  
6 g2     n6         2 FALSE 
7 g2     n6         2 FALSE 
8 g2     m10        3 TRUE  
9 g2     m10        3 FALSE

Now if you actually want to have a count of first and 2nd and third, it is even easier:

test %>%
  group_by(group1,group2) %>%
  mutate(counter = row_number()) %>%
  ungroup()

Unfortunately for you, my version of output suggest you made a mistake on the last row with g2/n6:

> test %>%
  +   group_by(group1,group2) %>% 
  +   mutate(counter = row_number()) %>%
  +   ungroup()
# A tibble: 9 x 4
group1 group2 count counter
<chr>  <chr>  <dbl>   <int>
  1 g1     k1         1       1
2 g1     a2         1       1
3 g1     a2         2       2
4 g2     c5         1       1
5 g2     n6         2       1
6 g2     n6         2       2
7 g2     n6         2       3
8 g2     m10        3       1
9 g2     m10        3       2

There are of course other ways to do such things but the above seems simple enough.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Yuan Chun Ding
Sent: Friday, July 2, 2021 6:27 PM
To: r-help at r-project.org
Subject: [R] add a variable a data frame to sequentially count unique rows

Hi R users,

In this test file,
test  <- data.frame(group1=c("g1", "g1", "g1", "g2", "g2", "g2", "g2", "g2", "g2"),
                                       group2=c("k1", "a2", "a2", "c5", "n6", "n6", "n6", "m10","m10"),
                                       count= c( 1,     1,    2,   1,     2,
2,     2,    3,    3 ));

I have group 1 and group2 variable and want to add the count variable to sequentially count unique rows defined by group1 and group2.  

I hope to use the following functions in library (tidyverse),  No one worked well.
test %>% group_by(group1, group2) %>% mutate(count = row_number()) test %>% group_by(group1, group2) %>% mutate(count = 1:n()) test %>% group_by(group1,
group2) %>% mutate(count = seq_len(n())) test %>% group_by(group1, group2) %>% mutate(count = seq_along(group1, group2))

Can you help me to make the third column in the test data frame?

Thank you,

Ding

----------------------------------------------------------------------
------------------------------------------------------------
-SECURITY/CONFIDENTIALITY WARNING-  

This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to receive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!8oahzk10S1vIuAsJeWTijBINZz-H8PlRQx2Ud1FA5lkMZ2HOL1GhAw-W1HTb$
PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!8oahzk10S1vIuAsJeWTijBINZz-H8PlRQx2Ud1FA5lkMZ2HOL1GhA58K6_uw$
and provide commented, minimal, self-contained, reproducible code.


From r@turner @end|ng |rom @uck|@nd@@c@nz  Sat Jul  3 04:02:59 2021
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Sat, 3 Jul 2021 14:02:59 +1200
Subject: [R] Plotting the ASCII character set.
Message-ID: <20210703140259.600cb00c@rolf-Latitude-E7470>


I have (used to have?) a function plot_ascii() which would display the
ascii character set in a graphical display.  It simply used text() to
place the symbols on a 16 x 16 grid.  The labels used by text() were
taken from a character vector that I called "all.ascii".  According to
my notes, the entries of this vector were obtained from a posting to
R-help made by the redoubtable Martin Maechler back in 2002.

This function *used* to work!  Now it doesn't.  When I invoke
plot.ascii() I get an error:

> Error in text.default(tmp, labels = all.ascii) : 
>   invalid string in PangoCairo_Text

To give a simple example, just looking at *one* of the characters,
which comes from the string "\260" in my data file:

    a <- "\260"
    plot(0,0,type="n",xlim=c(0,1),ylim=c(0,1),ann=FALSE,axes=FALSE)
    text(0.5,0.5,labels=a)

Same error.  If I type the name a I get "\xb0", which I don't
understand.  Can't get my head around character encoding.

If I do

    plot(0,0,type="n",xlim=c(0,1),ylim=c(0,1),ann=FALSE)
    text(0.5,0.5,labels="\ub0")

then I get the degree symbol plotted; I guess that b0 is the hex
encoding of the degree symbol; apparently 260 is the octal encoding of
this symbol.

Can anyone suggest how I might get my plot_ascii() function working
again?  Basically, it seems to me, the question is:  how do I persuade
R to read in "\260" as "\ub0" rather than "\xb0"?

I hope for enlightenment! :-)

cheers,

Rolf Turner

P.S. My sessionInfo() may be relevant:

R version 4.1.0 (2021-05-18)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.2 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/atlas/libblas.so.3.10.3
LAPACK: /usr/lib/x86_64-linux-gnu/atlas/liblapack.so.3.10.3

locale:
 [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_NZ.UTF-8        LC_COLLATE=en_GB.UTF-8    
 [5] LC_MONETARY=en_NZ.UTF-8    LC_MESSAGES=en_GB.UTF-8   
 [7] LC_PAPER=en_NZ.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_NZ.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] brev_0.0-5

loaded via a namespace (and not attached):
 [1] magrittr_1.5      usethis_2.0.1     devtools_2.4.2    pkgload_1.2.1    
 [5] R6_2.4.1          rlang_0.4.11      mixreg_1.0-1      fastmap_1.0.1    
 [9] tools_4.1.0       pkgbuild_1.2.0    sessioninfo_1.1.1 cli_2.5.0        
[13] withr_2.4.2       ellipsis_0.3.2    remotes_2.4.0     rprojroot_1.3-2  
[17] lifecycle_1.0.0   crayon_1.3.4      processx_3.5.2    purrr_0.3.4      
[21] callr_3.7.0       fs_1.5.0          ps_1.6.0          testthat_3.0.3   
[25] memoise_2.0.0     glue_1.4.0        cachem_1.0.5      compiler_4.1.0   
[29] desc_1.3.0        backports_1.1.6   prettyunits_1.1.1


-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Jul  3 09:28:32 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 3 Jul 2021 08:28:32 +0100
Subject: [R] 
 add a variable a data frame to sequentially count unique rows
In-Reply-To: <SJ0PR02MB7645A67CD8ACF60FA841FE87D41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
References: <SJ0PR02MB7645A67CD8ACF60FA841FE87D41F9@SJ0PR02MB7645.namprd02.prod.outlook.com>
Message-ID: <0ea3cb2b-98ad-ad08-84bf-73769ed05cab@sapo.pt>

Hello,

Either I'm not understanding or isn't this just any of


aggregate(count ~ ., data = test, FUN = length)

test %>% count(group1, group2, name = "Count")


?

Hope this helps,

Rui Barradas

?s 23:27 de 02/07/21, Yuan Chun Ding escreveu:
> Hi R users,
> 
> In this test file,
> test  <- data.frame(group1=c("g1", "g1", "g1", "g2", "g2", "g2", "g2", "g2", "g2"),
>                                         group2=c("k1", "a2", "a2", "c5", "n6", "n6", "n6", "m10","m10"),
>                                         count= c( 1,     1,    2,   1,     2,   2,     2,    3,    3 ));
> 
> I have group 1 and group2 variable and want to add the count variable to sequentially count unique rows defined by group1 and group2.
> 
> I hope to use the following functions in library (tidyverse),  No one worked well.
> test %>% group_by(group1, group2) %>% mutate(count = row_number())
> test %>% group_by(group1, group2) %>% mutate(count = 1:n())
> test %>% group_by(group1, group2) %>% mutate(count = seq_len(n()))
> test %>% group_by(group1, group2) %>% mutate(count = seq_along(group1, group2))
> 
> Can you help me to make the third column in the test data frame?
> 
> Thank you,
> 
> Ding
> 
> ----------------------------------------------------------------------
> ------------------------------------------------------------
> -SECURITY/CONFIDENTIALITY WARNING-
> 
> This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to receive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
> 

From kry|ov@r00t @end|ng |rom gm@||@com  Sat Jul  3 09:40:28 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sat, 3 Jul 2021 09:40:28 +0200
Subject: [R] Plotting the ASCII character set.
In-Reply-To: <20210703140259.600cb00c@rolf-Latitude-E7470>
References: <20210703140259.600cb00c@rolf-Latitude-E7470>
Message-ID: <20210703094028.773b0257@trisector>

Hello Rolf Turner,

On Sat, 3 Jul 2021 14:02:59 +1200
Rolf Turner <r.turner at auckland.ac.nz> wrote:

> Can anyone suggest how I might get my plot_ascii() function working
> again?  Basically, it seems to me, the question is:  how do I persuade
> R to read in "\260" as "\ub0" rather than "\xb0"?

Part of the problem is that the "\xb0" byte is not in ASCII, which
covers only the lower half of possible 8-bit bytes. I guess that the
strings containing bytes with highest bit set used to be interpreted as
Latin-1 on your machine, but now get interpreted as UTF-8, which
changes their meaning (in UTF-8, the highest bit being set indicates
that there will be more bytes to follow, making the string invalid if
there is none).

The good news is, since it's Latin-1, which is natively supported by R,
there are even multiple options:

1. Mark the string as Latin-1 by setting Encoding(a) <- 'latin1' and
let R do the re-encoding if and when Pango asks it for a UTF-8-encoded
string.

2. Decode Latin-1 into the locale encoding by using iconv(a, 'latin1',
'') (or set the third parameter to 'UTF-8', which would give almost the
same result on a machine with a UTF-8 locale). The result is, again, a
string where Encoding(a) matches the truth. Explicitly setting UTF-8
may be preferable on Windows machines running pre-UCRT builds of R
where the locale encoding may not contain all Latin-1 characters, but
that's not a problem for you, as far as I know.

For any encoding other than Latin-1 or UTF-8, option (2) is still valid.

I have verified that your example works on my GNU/Linux system with a
UTF-8 locale if I use either option.

-- 
Best regards,
Ivan


From t@v|b@r @end|ng |rom gm@||@com  Sat Jul  3 13:26:08 2021
From: t@v|b@r @end|ng |rom gm@||@com (Micha Silver)
Date: Sat, 3 Jul 2021 14:26:08 +0300
Subject: [R] concatenating columns in data.frame
In-Reply-To: <alpine.BSF.2.00.2107021652140.15131@pedal.dcn.davis.ca.us>
References: <e0a0d23f-c4a6-540c-be31-90ba894dba11@gmail.com>
 <056701d76ef4$173342f0$4599c8d0$@verizon.net>
 <8AE9E4D9-722C-4993-98E7-0FA2AF2F9AA3@dcn.davis.ca.us>
 <010201d76f7f$4c8dcc50$e5a964f0$@verizon.net>
 <alpine.BSF.2.00.2107021652140.15131@pedal.dcn.davis.ca.us>
Message-ID: <7ac36272-24ae-f60b-9d83-b5a6cca4951b@gmail.com>

Again thanks for carrying on this thread with your additional, 
informative comments, as well as the welcome humor.



On 7/3/21 2:59 AM, Jeff Newmiller wrote:
> I am very agnostic about tidyverse/base R. However, the complexity of 
> setting up NSE functions is often simply not needed, and I encounter 
> so many people who simply disregard base R as being too outdated so 
> that they never learn how simple solutions in R can be. The contrast 
> between your solution and Bert's was... perhaps informative, but a 
> nuclear bomb where an axe was sufficient.
>
> On Fri, 2 Jul 2021, Avi Gross via R-help wrote:
>
>> I know what you mean Jeff. Yes I am very familiar with base R 
>> techniques. What I had hoped for was to do two things that some of 
>> the other methods mentioned do that ended up bringing two data.frames 
>> together as part of the solution.
>>
>> Much of what I used is now standard R. I was looking at the accessory 
>> functions now commonly used in dplyr that let you dynamically select 
>> which columns to work with like begins_with() to choose. Sadly, they 
>> seem to work on a top-level but not easily within a call to something 
>> like paste(...) where they are not evaluated in the way I want.
>>
>> But the odd method I tried can also be used in standard R with a bit 
>> of work. You can create a function without using dplyr that takes 
>> your df and uses it to concatenate and end with something like:
>>
>> df$new_col <- do_something(df, selected_cols)
>>
>> That too adds a column without the need to merge larger structures 
>> explicitly..
>>
>> But your other point is a tad religious in a sense. I happen to 
>> prefer learning a core language first then looking at enhancement 
>> opportunities. But at some point, if teaching someone new who wants 
>> to focus on getting a job done simply but not necessarily repeatedly 
>> or in some ideal way, it is best to do things in a way that their 
>> mind flows better.
>>
>> Many things in the tidyverse are redundant with base R or just "fix" 
>> inconsistencies like making sure the first argument is always the 
>> same. But many add substantially to doing things in a more 
>> step-by-step manner.
>>
>> I do not worship the base language as it first came out or even as it 
>> has evolved. I do like to know what choices I have and pick and 
>> choose among them as needed. Of course a forum like this is more 
>> about base R than otherwise and I acknowledge that. Still, the ":=" 
>> operator is now base R. There is a new pipeline operator "|>" in base 
>> R. Some ideas, good or otherwise, do get in eventually.
>>
>> I started doing graphs using base R as in the plot() command. It was 
>> adequate but I wanted better. So I learned about Lattice and various 
>> packages and eventually ggplot. I can now do things I barely imagined 
>> before and am still learning that there is much more I can do with 
>> packages underneath much of the magic and also additional packages 
>> layered above it, in some sense. So I do not approach that with an 
>> either-or mentality either.
>>
>> Note I am not really talking about just R. I have similar issues with 
>> other languages I program in such as Python. None of them were 
>> created fully-formed and many had to add huge amounts to adapt to 
>> additional wants and needs. Base R for me is often inadequate. But so 
>> what?
>>
>> The task being asked for in this thread in isolation, indeed may not 
>> be done any better using packages. However, if it is part of a larger 
>> set of tasks that can be pipelined, it may well be and I personally 
>> was wondering if there was a way in dplyr. There probably is a much 
>> better way than I assembled if I only knew about it, and if not, they 
>> may add this kind of indirection in a future release if deemed worthy 
>> of doing. I have gone back to programs I did years ago with humungous 
>> amounts of code using what I knew then and reducing it drastically 
>> now that I can tell a function to select say all my column names that 
>> end in .orig and apply a set of functions to them with output going 
>> to the base name followed by .mean and .sd and so on. All that can 
>> often be done in one or two lines of code where previously I had to 
>> do 18 near repetitions of each part and then another and another. 
>> That used a limited form of dynamism.
>>
>> Be that as it may I think the requester has enough info and we can 
>> move on.
>>
>> -----Original Message-----
>> From: Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
>> Sent: Friday, July 2, 2021 1:03 AM
>> To: Avi Gross <avigross at verizon.net>; Avi Gross via R-help 
>> <r-help at r-project.org>; R-help at r-project.org
>> Subject: Re: [R] concatenating columns in data.frame
>>
>> I use parts of the tidyverse frequently, but this post is the best 
>> argument I can imagine for learning base R techniques.
>>
>> On July 1, 2021 8:41:06 PM PDT, Avi Gross via R-help 
>> <r-help at r-project.org> wrote:
>>> Micha,
>>>
>>> Others have provided ways in standard R so I will contribute a somewhat
>>> odd solution using the dplyr and related packages in the tidyverse
>>> including a sample data.frame/tibble I made. It requires newer versions
>>> of R and other? packages as it uses some fairly esoteric features
>>> including "the big bang" and the new ":=" operator and more.
>>>
>>> You can use your own data with whatever columns you need, of course.
>>>
>>> The goal is to have umpteen columns in the data that you want to add an
>>> additional columns to an existing tibble that is the result of
>>> concatenating the rowwise contents of a dynamically supplied vector of
>>> column names in quotes. First we need something to work with so here is
>>> a sample:
>>>
>>> #--start
>>> # load required packages, or a bunch at once!
>>> library(tidyverse)
>>>
>>> # Pick how many rows you want. For a demo, 3 is plenty N <- 3
>>>
>>> # Make a sample tibble with N rows and the following 4 columns mydf <-
>>> tibble(alpha = 1:N,
>>> ????????????? beta=letters[1:N],
>>> ????????????? gamma = N:1,
>>> ????????????? delta = month.abb[1:N])
>>>
>>> # show the original tibble
>>> print(mydf)
>>> #--end
>>>
>>> In flat text mode, here is the output:
>>>
>>>> print(mydf)
>>> # A tibble: 3 x 4
>>> alpha beta? gamma delta
>>> <int> <chr> <int> <chr>
>>> ?1???? 1 a???????? 3 Jan
>>> 2???? 2 b???????? 2 Feb
>>> 3???? 3 c???????? 1 Mar
>>>
>>> Now I want to make a function that is used instead of the mutate verb.
>>> I made a weird one-liner that is a tad hard to explain so first let me
>>> mention the requirements.
>>>
>>> It will take a first argument that is a tibble and in a pipeline this
>>> would be passed invisibly.
>>> The second required argument is a vector or list containing the names
>>> of the columns as strings. A column can be re-used multiple times.
>>> The third optional argument is what to name the new column with a
>>> default if omitted.
>>> The fourth optional argument allows you to choose a different separator
>>> than "" if you wish.
>>>
>>> The function should be usable in a pipeline on both sides so it should
>>> also return the input tibble with an extra column to the output.
>>>
>>> Here is the function:
>>>
>>> my_mutate <- function(df, columns, colnew="concatenated", sep=""){
>>> ?df %>%
>>> ?? mutate( "{colnew}" := paste(!!!rlang::syms(columns), sep = sep )) }
>>>
>>> Yes, the above can be done inline as a long one-liner:
>>>
>>> my_mutate <- function(df, columns, colnew="concatenated", sep="")
>>> mutate(df, "{colnew}" := paste(!!!rlang::syms(columns), sep = sep ))
>>>
>>> Here are examples of it running:
>>>
>>>
>>>> choices <- c("beta", "delta", "alpha", "delta") mydf %>%
>>>> my_mutate(choices, "me2")
>>> # A tibble: 3 x 5
>>> alpha beta? gamma delta me2
>>> <int> <chr> <int> <chr> <chr>
>>> ?1???? 1 a???????? 3 Jan?? aJan1Jan
>>> 2???? 2 b???????? 2 Feb?? bFeb2Feb
>>> 3???? 3 c???????? 1 Mar?? cMar3Mar
>>>> mydf %>% my_mutate(choices, "me2",":")
>>> # A tibble: 3 x 5
>>> alpha beta? gamma delta me2
>>> <int> <chr> <int> <chr> <chr>
>>> ?1???? 1 a???????? 3 Jan?? a:Jan:1:Jan
>>> 2???? 2 b???????? 2 Feb?? b:Feb:2:Feb
>>> 3???? 3 c???????? 1 Mar?? c:Mar:3:Mar
>>>> mydf %>% my_mutate(c("beta", "beta", "gamma", "gamma", "delta",
>>>> "alpha"))
>>> # A tibble: 3 x 5
>>> alpha beta? gamma delta concatenated
>>> <int> <chr> <int> <chr> <chr>
>>> ?1???? 1 a???????? 3 Jan?? aa33Jan1
>>> 2???? 2 b???????? 2 Feb?? bb22Feb2
>>> 3???? 3 c???????? 1 Mar?? cc11Mar3
>>>> mydf %>% my_mutate(list("beta", "beta", "gamma", "gamma", "delta",
>>>> "alpha"))
>>> # A tibble: 3 x 5
>>> alpha beta? gamma delta concatenated
>>> <int> <chr> <int> <chr> <chr>
>>> ?1???? 1 a???????? 3 Jan?? aa33Jan1
>>> 2???? 2 b???????? 2 Feb?? bb22Feb2
>>> 3???? 3 c???????? 1 Mar?? cc11Mar3
>>>> mydf %>% my_mutate(columns=list("alpha", "beta", "gamma", "delta",
>>>> "gamma", "beta", "alpha"),
>>> ??????????????????? +??????????????????? sep="/*/",
>>> ??????????????????? + colnew="NewRandomNAME"
>>> ??????????????????? +??????????????????? )
>>> # A tibble: 3 x 5
>>> alpha beta? gamma delta NewRandomNAME
>>> <int> <chr> <int> <chr> <chr>
>>> ?1???? 1 a???????? 3 Jan?? 1/*/a/*/3/*/Jan/*/3/*/a/*/1
>>> 2???? 2 b???????? 2 Feb?? 2/*/b/*/2/*/Feb/*/2/*/b/*/2
>>> 3???? 3 c???????? 1 Mar?? 3/*/c/*/1/*/Mar/*/1/*/c/*/3
>>>
>>> Does this meet your normal need? Just to show it works in a pipeline,
>>> here is a variant:
>>>
>>> mydf %>%
>>> ?tail(2) %>%
>>> ?my_mutate(c("beta", "beta"), "betabeta") %>%
>>> ?print() %>%
>>> ?my_mutate(list("alpha", "betabeta", "gamma"),
>>> ?????????? "buildson",
>>> ?????????? "&")
>>>
>>> The above only keeps the last two lines of the tibble, makes a double
>>> copy of "beta" under a new name, prints the intermediate result,
>>> continues to make another concatenation using the variable created
>>> earlier then prints the result:
>>>
>>> Here is the run:
>>>
>>>> mydf %>%
>>> ?+?? tail(2) %>%
>>> ?+?? my_mutate(c("beta", "beta"), "betabeta") %>%
>>> ?+?? print() %>%
>>> ?+?? my_mutate(list("alpha", "betabeta", "gamma"),
>>> ?????????????? +???????????? "buildson",
>>> ?????????????? +???????????? "&")
>>> # A tibble: 2 x 5
>>> alpha beta? gamma delta betabeta
>>> <int> <chr> <int> <chr> <chr>
>>> ?1???? 2 b???????? 2 Feb?? bb
>>> 2???? 3 c???????? 1 Mar?? cc
>>> # A tibble: 2 x 6
>>> alpha beta? gamma delta betabeta buildson
>>> <int> <chr> <int> <chr> <chr> <chr>
>>> ?1???? 2 b???????? 2 Feb?? bb?????? 2&bb&2
>>> 2???? 3 c???????? 1 Mar?? cc?????? 3&cc&1
>>>
>>> As to how the darn function works, that was a learning experience for
>>> me to build using features I have not had occasion to use. If anyone
>>> remains interested, read on.
>>>
>>> The following needs newish features:
>>>
>>> ????"{colnew}" := SOMETHING
>>>
>>> The colon-equals operator in newer R/dplyr can be sort of used in an
>>> odd way that allows the name of the variable to be in quotes and in
>>> brackets akin to the way glue() does it. The variable colnew is
>>> evaluated and substituted so the name used for the column is now
>>> dynamic.
>>>
>>> The function does a paste using this:
>>>
>>> ????!!!rlang::syms(columns)
>>>
>>> The problem is paste() wants multiple arguments and we have a single
>>> argument that is either a vector or another kind of vector called a
>>> list. The trick is to convert the vector into symbols then use "!!!" to
>>> convert something like 'c("alpha", "beta", "gamma")' into something
>>> more like ' "alpha", "beta", "gamma" ' so that paste sees them as
>>> multiple arguments to concatenate in vector fashion.
>>>
>>> And, the function is not polished but I am sure you can all see some of
>>> what is needed like checking the arguments for validity, including not
>>> having a name for the new column that clashes with existing column
>>> names, doing something sane if no columns to concatenate are offered
>>> and so on.
>>>
>>> Just showing a different approach. The base R methods are fine.
>>>
>>> - Avi
>>>
>>> -----Original Message-----
>>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Micha Silver
>>> Sent: Thursday, July 1, 2021 10:36 AM
>>> To: R-help at r-project.org
>>> Subject: [R] concatenating columns in data.frame
>>>
>>> I need to create a new data.frame column as a concatenation of existing
>>> character columns. But the number and name of the columns to
>>> concatenate needs to be passed in dynamically. The code below does what
>>> I want, but seems very clumsy. Any suggestions how to improve?
>>>
>>>
>>> df = data.frame("A"=sample(letters, 10), "B"=sample(letters, 10),
>>> "C"=sample(letters,10), "D"=sample(letters, 10))
>>>
>>> # Which columns to concat:
>>>
>>> use_columns = c("D", "B")
>>>
>>>
>>> UpdateCombo = function(df, use_columns) {
>>> ??? use_df = df[, use_columns]
>>> ??? combo_list = lapply(1:nrow(use_df), function(r) {
>>> ??? r_combo = paste(use_df[r,], collapse="_")
>>> ??? return(data.frame("Combo" = r_combo))
>>> ??? })
>>> ??? combo = do.call(rbind, combo_list)
>>>
>>> ??? names(combo) = "Combo"
>>>
>>> ??? return(combo)
>>>
>>> }
>>>
>>>
>>> combo_col = UpdateCombo(df, use_columns)
>>>
>>> df_combo = do.call(cbind, list(df, combo_col))
>>>
>>>
>>> Thanks
>>>
>>>
>>> -- 
>>> Micha Silver
>>> Ben Gurion Univ.
>>> Sde Boker, Remote Sensing Lab
>>> cell: +972-523-665918
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> -- 
>> Sent from my phone. Please excuse my brevity.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>
> --------------------------------------------------------------------------- 
>
> Jeff Newmiller??????????????????????? The???? .....?????? ..... Go 
> Live...
> DCN:<jdnewmil at dcn.davis.ca.us>??????? Basics: ##.#. ##.#.? Live Go...
> ????????????????????????????????????? Live:?? OO#.. Dead: OO#.. Playing
> Research Engineer (Solar/Batteries??????????? O.O#.?????? #.O#. with
> /Software/Embedded Controllers)?????????????? .OO#.?????? .OO#. 
> rocks...1k
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Micha Silver
Ben Gurion Univ.
Sde Boker, Remote Sensing Lab
cell: +972-523-665918


From r@turner @end|ng |rom @uck|@nd@@c@nz  Sun Jul  4 03:59:49 2021
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Sun, 4 Jul 2021 13:59:49 +1200
Subject: [R] Plotting the ASCII character set.
In-Reply-To: <20210703094028.773b0257@trisector>
References: <20210703140259.600cb00c@rolf-Latitude-E7470>
 <20210703094028.773b0257@trisector>
Message-ID: <20210704135949.6ee0ee4a@rolf-Latitude-E7470>


On Sat, 3 Jul 2021 09:40:28 +0200
Ivan Krylov <krylov.r00t at gmail.com> wrote:

> Hello Rolf Turner,
> 
> On Sat, 3 Jul 2021 14:02:59 +1200
> Rolf Turner <r.turner at auckland.ac.nz> wrote:
> 
> > Can anyone suggest how I might get my plot_ascii() function working
> > again?  Basically, it seems to me, the question is:  how do I
> > persuade R to read in "\260" as "\ub0" rather than "\xb0"?
> 
> Part of the problem is that the "\xb0" byte is not in ASCII, which
> covers only the lower half of possible 8-bit bytes. I guess that the
> strings containing bytes with highest bit set used to be interpreted
> as Latin-1 on your machine, but now get interpreted as UTF-8, which
> changes their meaning (in UTF-8, the highest bit being set indicates
> that there will be more bytes to follow, making the string invalid if
> there is none).
> 
> The good news is, since it's Latin-1, which is natively supported by
> R, there are even multiple options:
> 
> 1. Mark the string as Latin-1 by setting Encoding(a) <- 'latin1' and
> let R do the re-encoding if and when Pango asks it for a UTF-8-encoded
> string.
> 
> 2. Decode Latin-1 into the locale encoding by using iconv(a, 'latin1',
> '') (or set the third parameter to 'UTF-8', which would give almost
> the same result on a machine with a UTF-8 locale). The result is,
> again, a string where Encoding(a) matches the truth. Explicitly
> setting UTF-8 may be preferable on Windows machines running pre-UCRT
> builds of R where the locale encoding may not contain all Latin-1
> characters, but that's not a problem for you, as far as I know.
> 
> For any encoding other than Latin-1 or UTF-8, option (2) is still
> valid.
> 
> I have verified that your example works on my GNU/Linux system with a
> UTF-8 locale if I use either option.

Thanks Ivan. That solves most of the problem, but there are still
glitches. I get a plot OK, but a substantial number of the characters
are displayed as a wee rectangle containing a 2 x 2 array of digits
such as

>   0 0
>   8 0

Also note that there is a bit of difference between the results of using
Encoding() and the results of using iconv(). E.g. if I do

a <- "\x80"
b <- iconv(a,"latin1","UTF-8")
Encoding(a) <- "latin1"

then when I type "a" I get the Euro symbol "?", but when I type "b"
I get the string "\u0080".

But that doesn't really matter.  More problematic is the fact that if I
do either

    plot(0,0,type="n",xlim=c(0,1),ylim=c(0,1),ann=FALSE,axes=FALSE)
    text(0.5,0.5,labels=a,cex=6)
or

    plot(0,0,type="n",xlim=c(0,1),ylim=c(0,1),ann=FALSE,axes=FALSE)
    text(0.5,0.5,labels=b,cex=6)

then I get wee rectangle with 0 0 8 0 arranged in a 2 x 2 array inside.
(Setting cex=6 makes it easier for my ageing eyes to see what the
digits are.)

Is there any way that I can get the Euro symbol to display correctly in
such a graphic?

Thanks.

cheers,

Rolf

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From dw|n@em|u@ @end|ng |rom comc@@t@net  Sun Jul  4 07:37:58 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Sat, 3 Jul 2021 22:37:58 -0700
Subject: [R] Plotting the ASCII character set.
In-Reply-To: <20210704135949.6ee0ee4a@rolf-Latitude-E7470>
References: <20210704135949.6ee0ee4a@rolf-Latitude-E7470>
Message-ID: <E7FB16B1-5E6D-4A8E-B661-9372C508CEA8@comcast.net>



Sent from my iPhone

> On Jul 3, 2021, at 7:00 PM, Rolf Turner <r.turner at auckland.ac.nz> wrote:
> 
> ?
>> On Sat, 3 Jul 2021 09:40:28 +0200
>> Ivan Krylov <krylov.r00t at gmail.com> wrote:
>> 
>> Hello Rolf Turner,
>> 
>> On Sat, 3 Jul 2021 14:02:59 +1200
>> Rolf Turner <r.turner at auckland.ac.nz> wrote:
>> 
>>> Can anyone suggest how I might get my plot_ascii() function working
>>> again?  Basically, it seems to me, the question is:  how do I
>>> persuade R to read in "\260" as "\ub0" rather than "\xb0"?
>> 
>> Part of the problem is that the "\xb0" byte is not in ASCII, which
>> covers only the lower half of possible 8-bit bytes. I guess that the
>> strings containing bytes with highest bit set used to be interpreted
>> as Latin-1 on your machine, but now get interpreted as UTF-8, which
>> changes their meaning (in UTF-8, the highest bit being set indicates
>> that there will be more bytes to follow, making the string invalid if
>> there is none).
>> 
>> The good news is, since it's Latin-1, which is natively supported by
>> R, there are even multiple options:
>> 
>> 1. Mark the string as Latin-1 by setting Encoding(a) <- 'latin1' and
>> let R do the re-encoding if and when Pango asks it for a UTF-8-encoded
>> string.
>> 
>> 2. Decode Latin-1 into the locale encoding by using iconv(a, 'latin1',
>> '') (or set the third parameter to 'UTF-8', which would give almost
>> the same result on a machine with a UTF-8 locale). The result is,
>> again, a string where Encoding(a) matches the truth. Explicitly
>> setting UTF-8 may be preferable on Windows machines running pre-UCRT
>> builds of R where the locale encoding may not contain all Latin-1
>> characters, but that's not a problem for you, as far as I know.
>> 
>> For any encoding other than Latin-1 or UTF-8, option (2) is still
>> valid.
>> 
>> I have verified that your example works on my GNU/Linux system with a
>> UTF-8 locale if I use either option.
> 
> Thanks Ivan. That solves most of the problem, but there are still
> glitches. I get a plot OK, but a substantial number of the characters
> are displayed as a wee rectangle containing a 2 x 2 array of digits
> such as
> 
>>  0 0
>>  8 0
> 
> Also note that there is a bit of difference between the results of using
> Encoding() and the results of using iconv(). E.g. if I do
> 
> a <- "\x80"
> b <- iconv(a,"latin1","UTF-8")
> Encoding(a) <- "latin1"
> 
> then when I type "a" I get the Euro symbol "?", but when I type "b"
> I get the string "\u0080".
> 
> But that doesn't really matter.  More problematic is the fact that if I
> do either
> 
>    plot(0,0,type="n",xlim=c(0,1),ylim=c(0,1),ann=FALSE,axes=FALSE)
>    text(0.5,0.5,labels=a,cex=6)
> or
> 
>    plot(0,0,type="n",xlim=c(0,1),ylim=c(0,1),ann=FALSE,axes=FALSE)
>    text(0.5,0.5,labels=b,cex=6)
> 
> then I get wee rectangle with 0 0 8 0 arranged in a 2 x 2 array inside.
> (Setting cex=6 makes it easier for my ageing eyes to see what the
> mAxdigits are.)
> 
> E Is hethere any way that I can get the Euro symbol to display correctly in
> such a graphic?
> 
Pick a font that is supported on your OS that has the desired glyph. 
Also look at the examples in:

?points

? 
David 
> Thanks.
> 
> cheers,
> 
> Rolf
> 
> -- 
> Honorary Research Fellow
> Department of Statistics
> University of Auckland
> Phone: +64-9-373-7599 ext. 88276
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kry|ov@r00t @end|ng |rom gm@||@com  Sun Jul  4 13:01:44 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sun, 4 Jul 2021 13:01:44 +0200
Subject: [R] Plotting the ASCII character set.
In-Reply-To: <20210704135949.6ee0ee4a@rolf-Latitude-E7470>
References: <20210703140259.600cb00c@rolf-Latitude-E7470>
 <20210703094028.773b0257@trisector>
 <20210704135949.6ee0ee4a@rolf-Latitude-E7470>
Message-ID: <20210704130144.4c17debc@trisector>

On Sun, 4 Jul 2021 13:59:49 +1200
Rolf Turner <r.turner at auckland.ac.nz> wrote:

> a substantial number of the characters are displayed as a wee
> rectangle containing a 2 x 2 array of digits such as
> 
> >   0 0
> >   8 0  

Interesting. I didn't pay attention to it at first, but now I see that
a range of code points, U+0080 to U+009F, corresponds to control
characters (also, 0+00A0 is non-breakable space), not anything
printable. Also, Latin-1 doesn't define any meaning for bytes
0x80..0x9f, but here they are decoded to same-valued Unicode code
points. And the actual code point for ? is U+20AC, not even close to
what we're working with.

> Also note that there is a bit of difference between the results of
> using Encoding() and the results of using iconv()

You are right. I didn't know that, but my reading of the function
translateToNative in src/main/sysutils.c suggests that R decodes
strings marked as 'latin1' as Windows-1252 (if it's available for the
system iconv()) and uses the actual Latin-1 as a fallback.

?Encoding does warn that 'latin1' is ambiguous and system-dependent
with regards to bytes 0x80..0x9f, so text() seems to be right to use
Latin-1 and not Windows-1252 when trying to plot byte 0x80 encoded as
CE_LATIN1 as U+0080. Although there's a /* FIXME: allow CP1252? */
comment in src/main/sysutils.c, function reEnc, which is used by text().

> Is there any way that I can get the Euro symbol to display correctly
> in such a graphic?

I think that iconv(a, 'CP1252', '', '\ufffd') should work for you. At
least it seems to work for the ? sign. It does leave the following
bytes undefined, represented as ? U+FFFD REPLACEMENT CHARACTER:

as.raw(which(is.na(
 iconv(sapply(as.raw(1:255), rawToChar), 'CP1252', '')
)))
# [1] 81 8d 8f 90 9d

Not sure what can be done about those. With Latin-1, they would
correspond to unprintable control characters anyway.

-- 
Best regards,
Ivan


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Jul  4 13:15:06 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 4 Jul 2021 07:15:06 -0400
Subject: [R] Plotting the ASCII character set.
In-Reply-To: <20210704135949.6ee0ee4a@rolf-Latitude-E7470>
References: <20210703140259.600cb00c@rolf-Latitude-E7470>
 <20210703094028.773b0257@trisector>
 <20210704135949.6ee0ee4a@rolf-Latitude-E7470>
Message-ID: <166a17cf-1527-f131-710c-4d112e503380@gmail.com>

On 03/07/2021 9:59 p.m., Rolf Turner wrote:

  ... deletia ...

> Also note that there is a bit of difference between the results of using
> Encoding() and the results of using iconv(). E.g. if I do
> 
> a <- "\x80"
> b <- iconv(a,"latin1","UTF-8")
> Encoding(a) <- "latin1"
> 
> then when I type "a" I get the Euro symbol "?", but when I type "b"
> I get the string "\u0080"
> 
> But that doesn't really matter.  More problematic is the fact that if I
> do either
> 
>      plot(0,0,type="n",xlim=c(0,1),ylim=c(0,1),ann=FALSE,axes=FALSE)
>      text(0.5,0.5,labels=a,cex=6)
> or
> 
>      plot(0,0,type="n",xlim=c(0,1),ylim=c(0,1),ann=FALSE,axes=FALSE)
>      text(0.5,0.5,labels=b,cex=6)
> 
> then I get wee rectangle with 0 0 8 0 arranged in a 2 x 2 array inside.
> (Setting cex=6 makes it easier for my ageing eyes to see what the
> digits are.)
> 
> Is there any way that I can get the Euro symbol to display correctly in
> such a graphic?


The problem with the Euro symbol is that it was invented after the first 
8 bit encodings, so it was stuck in later.  If you want it, this seems 
helpful:

 From https://web.stanford.edu/~laurik/fsmbook/faq/utf8.html:

"The proper Unicode code point for ? [this may or may not display 
correctly as the Euro sign in your browser] is decimal 8364 (0x20AC). In 
Windows CP1252 ? has the code 128 (0x80); in ISO-8859-15 (also known as 
Latin-9) the ? code is 164 (0xA4); in Macintosh Roman it is 219 (0xDB)."

So a fairly portable way to display it would be "\u20ac".  That works in 
a plot on my Mac; on other graphics devices it depends on whether the 
glyph is defined, but I'd expect it is fairly widespread.

The "\x80" character varies across 8 bit encodings.  In many of them 
it's a non-printable character, but not on Windows.

Duncan Murdoch


From L@urentRHe|p @end|ng |rom |ree@|r  Mon Jul  5 16:56:05 2021
From: L@urentRHe|p @end|ng |rom |ree@|r (Laurent Rhelp)
Date: Mon, 5 Jul 2021 16:56:05 +0200
Subject: [R] Some difficulties to use the apply command on an array
Message-ID: <c4612b79-068b-4693-04ea-ac6e4a4c4e9e@free.fr>

Dear R-Help,

I have an array x made up of three matrices of 5 rows and 3 columns of 
complex numbers (the complex numbers are not the problem)

## my array
x <- structure(c(5.6196790161893828+0i, 5.7565523942393364+0i, 
8.5242834298729342+0i,
 ????????????? 10.304766710160479+0i, 11.412967010108229+0i, 
-2.6952197604866495-5.7324226520260237e-18i,
 ????????????? -3.8053698833683476-1.5535793240880411i, 
-4.440850591952894-0.21277190153473785i,
 ????????????? -4.9049897326853316+0.22487294128201613i, 
-4.6982778900868931-0.35986943359186585i,
 ????????????? -6.7722948827866034-1.8252881225149525e-16i, 
-5.6864255243941733-0.82149125972147463i,
 ????????????? -2.5321753317962115-3.4309121438578525i, 
0.85377696343414344-4.3720244641138883i,
 ????????????? 6.3363344379954638-2.23654533694011i, 
-2.6952197604866495+5.7324226520260237e-18i,
 ????????????? -3.8053698833683476+1.5535793240880411i, 
-4.440850591952894+0.21277190153473785i,
 ????????????? -4.9049897326853316-0.22487294128201613i, 
-4.6982778900868931+0.35986943359186585i,
 ????????????? 3.1683154084671417+0i, 5.397392162921844+0i, 
8.3085887222115922+0i,
 ????????????? 11.150391891976289+0i, 13.173434845070231+0i, 
3.7978840709983359+5.0735539531499429e-17i,
 ????????????? 3.0599215005995717-2.3669737981128267i, 
0.5951827523696811-3.2116907301709845i,
 ????????????? -1.7735244105472532-3.8366652813316566i, 
-5.0558348297797169-2.6645747173403049i,
 ????????????? -6.7722948827866034+1.8252881225149525e-16i, 
-5.6864255243941733+0.82149125972147463i,
 ????????????? -2.5321753317962115+3.4309121438578525i, 
0.85377696343414344+4.3720244641138883i,
 ????????????? 6.3363344379954638+2.23654533694011i, 
3.7978840709983359-5.0735539531499429e-17i,
 ????????????? 3.0599215005995717+2.3669737981128267i, 
0.5951827523696811+3.2116907301709845i,
 ????????????? -1.7735244105472532+3.8366652813316566i, 
-5.0558348297797169+2.6645747173403049i,
 ????????????? 8.5581082281979697+0i, 8.6908832216086331+0i, 
12.394094469562258+0i,
 ????????????? 16.106350896659897+0i, 19.569513600539693+0i), .Dim = 
c(5L, 3L,
3L))

str(x)
#? cplx [1:5, 1:3, 1:3] 5.62+0i 5.76+0i 8.52+0i ...

The dimensions (i,j,k) of my array are 5, 3, 3. For every value of i, I 
am interested in the squared matrices made up of the j columns for all 
the k indice. For a given value i I have to keep the row i for every k. 
For example if i=1, I am interested by the matrix x[1,,]
##
x[1,,]

##? ??????????? [,1]???????? [,2]???????? [,3]
## [1,]? 5.619679+0i -2.695220+0i -6.772295+0i
## [2,] -2.695220-0i? 3.168315+0i? 3.797884-0i
## [3,] -6.772295-0i? 3.797884+0i? 8.558108+0i

Now, for every value of i, I want to calculate the SVD decomposition and 
get the diagonal matrix created by the singular values. When I set the i 
value it works:
diag( svd(x[1,,])$d )

# [,1]???? [,2]????? [,3]
# [1,] 15.73833 0.000000 0.0000000
# [2,]? 0.00000 1.502771 0.0000000
# [3,]? 0.00000 0.000000 0.1049992


But when I try to do a loop on the i value it doesn't work:

apply(x, c(2,3), FUN = function(x) diag( svd(x)$d ))


# [,1]??????? [,2]??????? [,3]
# [1,] Numeric,361 Numeric,81? Numeric,144
# [2,] Numeric,81? Numeric,400 Numeric,81
# [3,] Numeric,144 Numeric,81? Numeric,900

I do not understand how to do the apply on an array in order to get my 
diagonals matrices. I think that I miss something about the 
understanding of the array object.

Thank you for your help

Laurent




-- 
L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e par le logiciel antivirus Avast.
https://www.avast.com/antivirus


From er|cjberger @end|ng |rom gm@||@com  Mon Jul  5 17:15:16 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Mon, 5 Jul 2021 18:15:16 +0300
Subject: [R] Some difficulties to use the apply command on an array
In-Reply-To: <c4612b79-068b-4693-04ea-ac6e4a4c4e9e@free.fr>
References: <c4612b79-068b-4693-04ea-ac6e4a4c4e9e@free.fr>
Message-ID: <CAGgJW77Pk1WzoXR=_+Y3VLn6UaXGXp2XuvvgN7LEJ_j9qgpktA@mail.gmail.com>

Hi Laurent,
I am not sure how to get apply()  to work but the following uses lapply()
and returns the matrices in a list.

lapply(1:3, FUN = function(i) diag( svd(x[i,,])$d ))

HTH,
Eric

On Mon, Jul 5, 2021 at 5:56 PM Laurent Rhelp <LaurentRHelp at free.fr> wrote:

> Dear R-Help,
>
> I have an array x made up of three matrices of 5 rows and 3 columns of
> complex numbers (the complex numbers are not the problem)
>
> ## my array
> x <- structure(c(5.6196790161893828+0i, 5.7565523942393364+0i,
> 8.5242834298729342+0i,
>                10.304766710160479+0i, 11.412967010108229+0i,
> -2.6952197604866495-5.7324226520260237e-18i,
>                -3.8053698833683476-1.5535793240880411i,
> -4.440850591952894-0.21277190153473785i,
>                -4.9049897326853316+0.22487294128201613i,
> -4.6982778900868931-0.35986943359186585i,
>                -6.7722948827866034-1.8252881225149525e-16i,
> -5.6864255243941733-0.82149125972147463i,
>                -2.5321753317962115-3.4309121438578525i,
> 0.85377696343414344-4.3720244641138883i,
>                6.3363344379954638-2.23654533694011i,
> -2.6952197604866495+5.7324226520260237e-18i,
>                -3.8053698833683476+1.5535793240880411i,
> -4.440850591952894+0.21277190153473785i,
>                -4.9049897326853316-0.22487294128201613i,
> -4.6982778900868931+0.35986943359186585i,
>                3.1683154084671417+0i, 5.397392162921844+0i,
> 8.3085887222115922+0i,
>                11.150391891976289+0i, 13.173434845070231+0i,
> 3.7978840709983359+5.0735539531499429e-17i,
>                3.0599215005995717-2.3669737981128267i,
> 0.5951827523696811-3.2116907301709845i,
>                -1.7735244105472532-3.8366652813316566i,
> -5.0558348297797169-2.6645747173403049i,
>                -6.7722948827866034+1.8252881225149525e-16i,
> -5.6864255243941733+0.82149125972147463i,
>                -2.5321753317962115+3.4309121438578525i,
> 0.85377696343414344+4.3720244641138883i,
>                6.3363344379954638+2.23654533694011i,
> 3.7978840709983359-5.0735539531499429e-17i,
>                3.0599215005995717+2.3669737981128267i,
> 0.5951827523696811+3.2116907301709845i,
>                -1.7735244105472532+3.8366652813316566i,
> -5.0558348297797169+2.6645747173403049i,
>                8.5581082281979697+0i, 8.6908832216086331+0i,
> 12.394094469562258+0i,
>                16.106350896659897+0i, 19.569513600539693+0i), .Dim =
> c(5L, 3L,
> 3L))
>
> str(x)
> #  cplx [1:5, 1:3, 1:3] 5.62+0i 5.76+0i 8.52+0i ...
>
> The dimensions (i,j,k) of my array are 5, 3, 3. For every value of i, I
> am interested in the squared matrices made up of the j columns for all
> the k indice. For a given value i I have to keep the row i for every k.
> For example if i=1, I am interested by the matrix x[1,,]
> ##
> x[1,,]
>
> ##              [,1]         [,2]         [,3]
> ## [1,]  5.619679+0i -2.695220+0i -6.772295+0i
> ## [2,] -2.695220-0i  3.168315+0i  3.797884-0i
> ## [3,] -6.772295-0i  3.797884+0i  8.558108+0i
>
> Now, for every value of i, I want to calculate the SVD decomposition and
> get the diagonal matrix created by the singular values. When I set the i
> value it works:
> diag( svd(x[1,,])$d )
>
> # [,1]     [,2]      [,3]
> # [1,] 15.73833 0.000000 0.0000000
> # [2,]  0.00000 1.502771 0.0000000
> # [3,]  0.00000 0.000000 0.1049992
>
>
> But when I try to do a loop on the i value it doesn't work:
>
> apply(x, c(2,3), FUN = function(x) diag( svd(x)$d ))
>
>
> # [,1]        [,2]        [,3]
> # [1,] Numeric,361 Numeric,81  Numeric,144
> # [2,] Numeric,81  Numeric,400 Numeric,81
> # [3,] Numeric,144 Numeric,81  Numeric,900
>
> I do not understand how to do the apply on an array in order to get my
> diagonals matrices. I think that I miss something about the
> understanding of the array object.
>
> Thank you for your help
>
> Laurent
>
>
>
>
> --
> L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e par le
> logiciel antivirus Avast.
> https://www.avast.com/antivirus
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From L@urentRHe|p @end|ng |rom |ree@|r  Mon Jul  5 17:28:57 2021
From: L@urentRHe|p @end|ng |rom |ree@|r (Laurent Rhelp)
Date: Mon, 5 Jul 2021 17:28:57 +0200
Subject: [R] Some difficulties to use the apply command on an array
In-Reply-To: <CAGgJW77Pk1WzoXR=_+Y3VLn6UaXGXp2XuvvgN7LEJ_j9qgpktA@mail.gmail.com>
References: <c4612b79-068b-4693-04ea-ac6e4a4c4e9e@free.fr>
 <CAGgJW77Pk1WzoXR=_+Y3VLn6UaXGXp2XuvvgN7LEJ_j9qgpktA@mail.gmail.com>
Message-ID: <4ac1b5a6-3bb7-d104-170c-5cd9a468ffba@free.fr>


Thank you very much Eric, I did not think to use lapply.


Le 05/07/2021 ? 17:15, Eric Berger a ?crit?:
> Hi?Laurent,
> I am not sure how to get apply()? to work but the following uses 
> lapply() and returns the matrices in a list.
>
> lapply(1:3, FUN = function(i) diag( svd(x[i,,])$d ))
>
> HTH,
> Eric
>
> On Mon, Jul 5, 2021 at 5:56 PM Laurent Rhelp <LaurentRHelp at free.fr 
> <mailto:LaurentRHelp at free.fr>> wrote:
>
>     Dear R-Help,
>
>     I have an array x made up of three matrices of 5 rows and 3
>     columns of
>     complex numbers (the complex numbers are not the problem)
>
>     ## my array
>     x <- structure(c(5.6196790161893828+0i, 5.7565523942393364+0i,
>     8.5242834298729342+0i,
>     ?????????????? 10.304766710160479+0i, 11.412967010108229+0i,
>     -2.6952197604866495-5.7324226520260237e-18i,
>     ?????????????? -3.8053698833683476-1.5535793240880411i,
>     -4.440850591952894-0.21277190153473785i,
>     ?????????????? -4.9049897326853316+0.22487294128201613i,
>     -4.6982778900868931-0.35986943359186585i,
>     ?????????????? -6.7722948827866034-1.8252881225149525e-16i,
>     -5.6864255243941733-0.82149125972147463i,
>     ?????????????? -2.5321753317962115-3.4309121438578525i,
>     0.85377696343414344-4.3720244641138883i,
>     ?????????????? 6.3363344379954638-2.23654533694011i,
>     -2.6952197604866495+5.7324226520260237e-18i,
>     ?????????????? -3.8053698833683476+1.5535793240880411i,
>     -4.440850591952894+0.21277190153473785i,
>     ?????????????? -4.9049897326853316-0.22487294128201613i,
>     -4.6982778900868931+0.35986943359186585i,
>     ?????????????? 3.1683154084671417+0i, 5.397392162921844+0i,
>     8.3085887222115922+0i,
>     ?????????????? 11.150391891976289+0i, 13.173434845070231+0i,
>     3.7978840709983359+5.0735539531499429e-17i,
>     ?????????????? 3.0599215005995717-2.3669737981128267i,
>     0.5951827523696811-3.2116907301709845i,
>     ?????????????? -1.7735244105472532-3.8366652813316566i,
>     -5.0558348297797169-2.6645747173403049i,
>     ?????????????? -6.7722948827866034+1.8252881225149525e-16i,
>     -5.6864255243941733+0.82149125972147463i,
>     ?????????????? -2.5321753317962115+3.4309121438578525i,
>     0.85377696343414344+4.3720244641138883i,
>     ?????????????? 6.3363344379954638+2.23654533694011i,
>     3.7978840709983359-5.0735539531499429e-17i,
>     ?????????????? 3.0599215005995717+2.3669737981128267i,
>     0.5951827523696811+3.2116907301709845i,
>     ?????????????? -1.7735244105472532+3.8366652813316566i,
>     -5.0558348297797169+2.6645747173403049i,
>     ?????????????? 8.5581082281979697+0i, 8.6908832216086331+0i,
>     12.394094469562258+0i,
>     ?????????????? 16.106350896659897+0i, 19.569513600539693+0i), .Dim =
>     c(5L, 3L,
>     3L))
>
>     str(x)
>     #? cplx [1:5, 1:3, 1:3] 5.62+0i 5.76+0i 8.52+0i ...
>
>     The dimensions (i,j,k) of my array are 5, 3, 3. For every value of
>     i, I
>     am interested in the squared matrices made up of the j columns for
>     all
>     the k indice. For a given value i I have to keep the row i for
>     every k.
>     For example if i=1, I am interested by the matrix x[1,,]
>     ##
>     x[1,,]
>
>     ##? ??????????? [,1]???????? [,2]???????? [,3]
>     ## [1,]? 5.619679+0i -2.695220+0i -6.772295+0i
>     ## [2,] -2.695220-0i? 3.168315+0i? 3.797884-0i
>     ## [3,] -6.772295-0i? 3.797884+0i? 8.558108+0i
>
>     Now, for every value of i, I want to calculate the SVD
>     decomposition and
>     get the diagonal matrix created by the singular values. When I set
>     the i
>     value it works:
>     diag( svd(x[1,,])$d )
>
>     # [,1]???? [,2]????? [,3]
>     # [1,] 15.73833 0.000000 0.0000000
>     # [2,]? 0.00000 1.502771 0.0000000
>     # [3,]? 0.00000 0.000000 0.1049992
>
>
>     But when I try to do a loop on the i value it doesn't work:
>
>     apply(x, c(2,3), FUN = function(x) diag( svd(x)$d ))
>
>
>     # [,1]??????? [,2]??????? [,3]
>     # [1,] Numeric,361 Numeric,81? Numeric,144
>     # [2,] Numeric,81? Numeric,400 Numeric,81
>     # [3,] Numeric,144 Numeric,81? Numeric,900
>
>     I do not understand how to do the apply on an array in order to
>     get my
>     diagonals matrices. I think that I miss something about the
>     understanding of the array object.
>
>     Thank you for your help
>
>     Laurent
>
>
>
>
>     -- 
>     L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e
>     par le logiciel antivirus Avast.
>     https://www.avast.com/antivirus <https://www.avast.com/antivirus>
>
>     ______________________________________________
>     R-help at r-project.org <mailto:R-help at r-project.org> mailing list --
>     To UNSUBSCRIBE and more, see
>     https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>     PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>     and provide commented, minimal, self-contained, reproducible code.
>



-- 
L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e par le logiciel antivirus Avast.
https://www.avast.com/antivirus

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Mon Jul  5 17:31:34 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Mon, 05 Jul 2021 08:31:34 -0700
Subject: [R] Some difficulties to use the apply command on an array
In-Reply-To: <CAGgJW77Pk1WzoXR=_+Y3VLn6UaXGXp2XuvvgN7LEJ_j9qgpktA@mail.gmail.com>
References: <c4612b79-068b-4693-04ea-ac6e4a4c4e9e@free.fr>
 <CAGgJW77Pk1WzoXR=_+Y3VLn6UaXGXp2XuvvgN7LEJ_j9qgpktA@mail.gmail.com>
Message-ID: <B9734C0B-BE78-4424-AED9-E7EB14904C8B@dcn.davis.ca.us>

apply _always_ returns a matrix of vector results. That is, the result of each call to FUN may be a matrix, but a matrix is merely a vector with dimensions that are in this case ignored. So restore the dimensions on the result:

array(apply(x, 1, FUN = function(x) diag( svd(x)$d )), dim=c(3,3,5))


On July 5, 2021 8:15:16 AM PDT, Eric Berger <ericjberger at gmail.com> wrote:
>Hi Laurent,
>I am not sure how to get apply()  to work but the following uses
>lapply()
>and returns the matrices in a list.
>
>lapply(1:3, FUN = function(i) diag( svd(x[i,,])$d ))
>
>HTH,
>Eric
>
>On Mon, Jul 5, 2021 at 5:56 PM Laurent Rhelp <LaurentRHelp at free.fr>
>wrote:
>
>> Dear R-Help,
>>
>> I have an array x made up of three matrices of 5 rows and 3 columns
>of
>> complex numbers (the complex numbers are not the problem)
>>
>> ## my array
>> x <- structure(c(5.6196790161893828+0i, 5.7565523942393364+0i,
>> 8.5242834298729342+0i,
>>                10.304766710160479+0i, 11.412967010108229+0i,
>> -2.6952197604866495-5.7324226520260237e-18i,
>>                -3.8053698833683476-1.5535793240880411i,
>> -4.440850591952894-0.21277190153473785i,
>>                -4.9049897326853316+0.22487294128201613i,
>> -4.6982778900868931-0.35986943359186585i,
>>                -6.7722948827866034-1.8252881225149525e-16i,
>> -5.6864255243941733-0.82149125972147463i,
>>                -2.5321753317962115-3.4309121438578525i,
>> 0.85377696343414344-4.3720244641138883i,
>>                6.3363344379954638-2.23654533694011i,
>> -2.6952197604866495+5.7324226520260237e-18i,
>>                -3.8053698833683476+1.5535793240880411i,
>> -4.440850591952894+0.21277190153473785i,
>>                -4.9049897326853316-0.22487294128201613i,
>> -4.6982778900868931+0.35986943359186585i,
>>                3.1683154084671417+0i, 5.397392162921844+0i,
>> 8.3085887222115922+0i,
>>                11.150391891976289+0i, 13.173434845070231+0i,
>> 3.7978840709983359+5.0735539531499429e-17i,
>>                3.0599215005995717-2.3669737981128267i,
>> 0.5951827523696811-3.2116907301709845i,
>>                -1.7735244105472532-3.8366652813316566i,
>> -5.0558348297797169-2.6645747173403049i,
>>                -6.7722948827866034+1.8252881225149525e-16i,
>> -5.6864255243941733+0.82149125972147463i,
>>                -2.5321753317962115+3.4309121438578525i,
>> 0.85377696343414344+4.3720244641138883i,
>>                6.3363344379954638+2.23654533694011i,
>> 3.7978840709983359-5.0735539531499429e-17i,
>>                3.0599215005995717+2.3669737981128267i,
>> 0.5951827523696811+3.2116907301709845i,
>>                -1.7735244105472532+3.8366652813316566i,
>> -5.0558348297797169+2.6645747173403049i,
>>                8.5581082281979697+0i, 8.6908832216086331+0i,
>> 12.394094469562258+0i,
>>                16.106350896659897+0i, 19.569513600539693+0i), .Dim =
>> c(5L, 3L,
>> 3L))
>>
>> str(x)
>> #  cplx [1:5, 1:3, 1:3] 5.62+0i 5.76+0i 8.52+0i ...
>>
>> The dimensions (i,j,k) of my array are 5, 3, 3. For every value of i,
>I
>> am interested in the squared matrices made up of the j columns for
>all
>> the k indice. For a given value i I have to keep the row i for every
>k.
>> For example if i=1, I am interested by the matrix x[1,,]
>> ##
>> x[1,,]
>>
>> ##              [,1]         [,2]         [,3]
>> ## [1,]  5.619679+0i -2.695220+0i -6.772295+0i
>> ## [2,] -2.695220-0i  3.168315+0i  3.797884-0i
>> ## [3,] -6.772295-0i  3.797884+0i  8.558108+0i
>>
>> Now, for every value of i, I want to calculate the SVD decomposition
>and
>> get the diagonal matrix created by the singular values. When I set
>the i
>> value it works:
>> diag( svd(x[1,,])$d )
>>
>> # [,1]     [,2]      [,3]
>> # [1,] 15.73833 0.000000 0.0000000
>> # [2,]  0.00000 1.502771 0.0000000
>> # [3,]  0.00000 0.000000 0.1049992
>>
>>
>> But when I try to do a loop on the i value it doesn't work:
>>
>> apply(x, c(2,3), FUN = function(x) diag( svd(x)$d ))
>>
>>
>> # [,1]        [,2]        [,3]
>> # [1,] Numeric,361 Numeric,81  Numeric,144
>> # [2,] Numeric,81  Numeric,400 Numeric,81
>> # [3,] Numeric,144 Numeric,81  Numeric,900
>>
>> I do not understand how to do the apply on an array in order to get
>my
>> diagonals matrices. I think that I miss something about the
>> understanding of the array object.
>>
>> Thank you for your help
>>
>> Laurent
>>
>>
>>
>>
>> --
>> L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e par
>le
>> logiciel antivirus Avast.
>> https://www.avast.com/antivirus
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From L@urentRHe|p @end|ng |rom |ree@|r  Mon Jul  5 17:33:57 2021
From: L@urentRHe|p @end|ng |rom |ree@|r (Laurent Rhelp)
Date: Mon, 5 Jul 2021 17:33:57 +0200
Subject: [R] Some difficulties to use the apply command on an array
In-Reply-To: <CAPcHnpRetYC9wRZP4vbXahkmrNs0wT85u7XRpX+SJZgC_2rUtQ@mail.gmail.com>
References: <c4612b79-068b-4693-04ea-ac6e4a4c4e9e@free.fr>
 <CAPcHnpRetYC9wRZP4vbXahkmrNs0wT85u7XRpX+SJZgC_2rUtQ@mail.gmail.com>
Message-ID: <9087bf15-10a3-3b52-7ce5-c1c6d619a15b@free.fr>

Thank you for the explanations. Indeed I made a mistake for the MARGIN 
understanding. But when I use the command I have an error because there 
is no simplify argument in the apply command ?




Le 05/07/2021 ? 17:05, Andrew Simmons a ?crit?:
> Hello,
>
>
> It seems as though you may be using `MARGIN` incorrectly. `MARGIN` is 
> the indices you are looping through, so it should be MARGIN = 1, not 
> MARGIN = c(2, 3). Additionally, you probably want to set argument 
> `simplify` to FALSE. Something?like
>
> apply(x, 1, FUN = function(x) diag( svd(x)$d ), simplify = FALSE)
>
> seems to work well for me. I hope this helps!
>
> On Mon, Jul 5, 2021 at 10:56 AM Laurent Rhelp <LaurentRHelp at free.fr 
> <mailto:LaurentRHelp at free.fr>> wrote:
>
>     Dear R-Help,
>
>     I have an array x made up of three matrices of 5 rows and 3
>     columns of
>     complex numbers (the complex numbers are not the problem)
>
>     ## my array
>     x <- structure(c(5.6196790161893828+0i, 5.7565523942393364+0i,
>     8.5242834298729342+0i,
>     ?????????????? 10.304766710160479+0i, 11.412967010108229+0i,
>     -2.6952197604866495-5.7324226520260237e-18i,
>     ?????????????? -3.8053698833683476-1.5535793240880411i,
>     -4.440850591952894-0.21277190153473785i,
>     ?????????????? -4.9049897326853316+0.22487294128201613i,
>     -4.6982778900868931-0.35986943359186585i,
>     ?????????????? -6.7722948827866034-1.8252881225149525e-16i,
>     -5.6864255243941733-0.82149125972147463i,
>     ?????????????? -2.5321753317962115-3.4309121438578525i,
>     0.85377696343414344-4.3720244641138883i,
>     ?????????????? 6.3363344379954638-2.23654533694011i,
>     -2.6952197604866495+5.7324226520260237e-18i,
>     ?????????????? -3.8053698833683476+1.5535793240880411i,
>     -4.440850591952894+0.21277190153473785i,
>     ?????????????? -4.9049897326853316-0.22487294128201613i,
>     -4.6982778900868931+0.35986943359186585i,
>     ?????????????? 3.1683154084671417+0i, 5.397392162921844+0i,
>     8.3085887222115922+0i,
>     ?????????????? 11.150391891976289+0i, 13.173434845070231+0i,
>     3.7978840709983359+5.0735539531499429e-17i,
>     ?????????????? 3.0599215005995717-2.3669737981128267i,
>     0.5951827523696811-3.2116907301709845i,
>     ?????????????? -1.7735244105472532-3.8366652813316566i,
>     -5.0558348297797169-2.6645747173403049i,
>     ?????????????? -6.7722948827866034+1.8252881225149525e-16i,
>     -5.6864255243941733+0.82149125972147463i,
>     ?????????????? -2.5321753317962115+3.4309121438578525i,
>     0.85377696343414344+4.3720244641138883i,
>     ?????????????? 6.3363344379954638+2.23654533694011i,
>     3.7978840709983359-5.0735539531499429e-17i,
>     ?????????????? 3.0599215005995717+2.3669737981128267i,
>     0.5951827523696811+3.2116907301709845i,
>     ?????????????? -1.7735244105472532+3.8366652813316566i,
>     -5.0558348297797169+2.6645747173403049i,
>     ?????????????? 8.5581082281979697+0i, 8.6908832216086331+0i,
>     12.394094469562258+0i,
>     ?????????????? 16.106350896659897+0i, 19.569513600539693+0i), .Dim =
>     c(5L, 3L,
>     3L))
>
>     str(x)
>     #? cplx [1:5, 1:3, 1:3] 5.62+0i 5.76+0i 8.52+0i ...
>
>     The dimensions (i,j,k) of my array are 5, 3, 3. For every value of
>     i, I
>     am interested in the squared matrices made up of the j columns for
>     all
>     the k indice. For a given value i I have to keep the row i for
>     every k.
>     For example if i=1, I am interested by the matrix x[1,,]
>     ##
>     x[1,,]
>
>     ##? ??????????? [,1]???????? [,2]???????? [,3]
>     ## [1,]? 5.619679+0i -2.695220+0i -6.772295+0i
>     ## [2,] -2.695220-0i? 3.168315+0i? 3.797884-0i
>     ## [3,] -6.772295-0i? 3.797884+0i? 8.558108+0i
>
>     Now, for every value of i, I want to calculate the SVD
>     decomposition and
>     get the diagonal matrix created by the singular values. When I set
>     the i
>     value it works:
>     diag( svd(x[1,,])$d )
>
>     # [,1]???? [,2]????? [,3]
>     # [1,] 15.73833 0.000000 0.0000000
>     # [2,]? 0.00000 1.502771 0.0000000
>     # [3,]? 0.00000 0.000000 0.1049992
>
>
>     But when I try to do a loop on the i value it doesn't work:
>
>     apply(x, c(2,3), FUN = function(x) diag( svd(x)$d ))
>
>
>     # [,1]??????? [,2]??????? [,3]
>     # [1,] Numeric,361 Numeric,81? Numeric,144
>     # [2,] Numeric,81? Numeric,400 Numeric,81
>     # [3,] Numeric,144 Numeric,81? Numeric,900
>
>     I do not understand how to do the apply on an array in order to
>     get my
>     diagonals matrices. I think that I miss something about the
>     understanding of the array object.
>
>     Thank you for your help
>
>     Laurent
>
>
>
>
>     -- 
>     L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e
>     par le logiciel antivirus Avast.
>     https://www.avast.com/antivirus <https://www.avast.com/antivirus>
>
>     ______________________________________________
>     R-help at r-project.org <mailto:R-help at r-project.org> mailing list --
>     To UNSUBSCRIBE and more, see
>     https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>     PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>     and provide commented, minimal, self-contained, reproducible code.
>



-- 
L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e par le logiciel antivirus Avast.
https://www.avast.com/antivirus

	[[alternative HTML version deleted]]


From L@urentRHe|p @end|ng |rom |ree@|r  Mon Jul  5 17:38:23 2021
From: L@urentRHe|p @end|ng |rom |ree@|r (Laurent Rhelp)
Date: Mon, 5 Jul 2021 17:38:23 +0200
Subject: [R] Some difficulties to use the apply command on an array
In-Reply-To: <CAPcHnpRetYC9wRZP4vbXahkmrNs0wT85u7XRpX+SJZgC_2rUtQ@mail.gmail.com>
References: <c4612b79-068b-4693-04ea-ac6e4a4c4e9e@free.fr>
 <CAPcHnpRetYC9wRZP4vbXahkmrNs0wT85u7XRpX+SJZgC_2rUtQ@mail.gmail.com>
Message-ID: <6b193091-d0f2-c5dd-1ed1-3d725884912b@free.fr>

ok, I use the R version 4.0.3
I have to upgrade my version

https://developer.r-project.org/blosxom.cgi/R-devel/NEWS/2021/03/06#n2021-03-06



Le 05/07/2021 ? 17:05, Andrew Simmons a ?crit?:
> Hello,
>
>
> It seems as though you may be using `MARGIN` incorrectly. `MARGIN` is 
> the indices you are looping through, so it should be MARGIN = 1, not 
> MARGIN = c(2, 3). Additionally, you probably want to set argument 
> `simplify` to FALSE. Something?like
>
> apply(x, 1, FUN = function(x) diag( svd(x)$d ), simplify = FALSE)
>
> seems to work well for me. I hope this helps!
>
> On Mon, Jul 5, 2021 at 10:56 AM Laurent Rhelp <LaurentRHelp at free.fr 
> <mailto:LaurentRHelp at free.fr>> wrote:
>
>     Dear R-Help,
>
>     I have an array x made up of three matrices of 5 rows and 3
>     columns of
>     complex numbers (the complex numbers are not the problem)
>
>     ## my array
>     x <- structure(c(5.6196790161893828+0i, 5.7565523942393364+0i,
>     8.5242834298729342+0i,
>     ?????????????? 10.304766710160479+0i, 11.412967010108229+0i,
>     -2.6952197604866495-5.7324226520260237e-18i,
>     ?????????????? -3.8053698833683476-1.5535793240880411i,
>     -4.440850591952894-0.21277190153473785i,
>     ?????????????? -4.9049897326853316+0.22487294128201613i,
>     -4.6982778900868931-0.35986943359186585i,
>     ?????????????? -6.7722948827866034-1.8252881225149525e-16i,
>     -5.6864255243941733-0.82149125972147463i,
>     ?????????????? -2.5321753317962115-3.4309121438578525i,
>     0.85377696343414344-4.3720244641138883i,
>     ?????????????? 6.3363344379954638-2.23654533694011i,
>     -2.6952197604866495+5.7324226520260237e-18i,
>     ?????????????? -3.8053698833683476+1.5535793240880411i,
>     -4.440850591952894+0.21277190153473785i,
>     ?????????????? -4.9049897326853316-0.22487294128201613i,
>     -4.6982778900868931+0.35986943359186585i,
>     ?????????????? 3.1683154084671417+0i, 5.397392162921844+0i,
>     8.3085887222115922+0i,
>     ?????????????? 11.150391891976289+0i, 13.173434845070231+0i,
>     3.7978840709983359+5.0735539531499429e-17i,
>     ?????????????? 3.0599215005995717-2.3669737981128267i,
>     0.5951827523696811-3.2116907301709845i,
>     ?????????????? -1.7735244105472532-3.8366652813316566i,
>     -5.0558348297797169-2.6645747173403049i,
>     ?????????????? -6.7722948827866034+1.8252881225149525e-16i,
>     -5.6864255243941733+0.82149125972147463i,
>     ?????????????? -2.5321753317962115+3.4309121438578525i,
>     0.85377696343414344+4.3720244641138883i,
>     ?????????????? 6.3363344379954638+2.23654533694011i,
>     3.7978840709983359-5.0735539531499429e-17i,
>     ?????????????? 3.0599215005995717+2.3669737981128267i,
>     0.5951827523696811+3.2116907301709845i,
>     ?????????????? -1.7735244105472532+3.8366652813316566i,
>     -5.0558348297797169+2.6645747173403049i,
>     ?????????????? 8.5581082281979697+0i, 8.6908832216086331+0i,
>     12.394094469562258+0i,
>     ?????????????? 16.106350896659897+0i, 19.569513600539693+0i), .Dim =
>     c(5L, 3L,
>     3L))
>
>     str(x)
>     #? cplx [1:5, 1:3, 1:3] 5.62+0i 5.76+0i 8.52+0i ...
>
>     The dimensions (i,j,k) of my array are 5, 3, 3. For every value of
>     i, I
>     am interested in the squared matrices made up of the j columns for
>     all
>     the k indice. For a given value i I have to keep the row i for
>     every k.
>     For example if i=1, I am interested by the matrix x[1,,]
>     ##
>     x[1,,]
>
>     ##? ??????????? [,1]???????? [,2]???????? [,3]
>     ## [1,]? 5.619679+0i -2.695220+0i -6.772295+0i
>     ## [2,] -2.695220-0i? 3.168315+0i? 3.797884-0i
>     ## [3,] -6.772295-0i? 3.797884+0i? 8.558108+0i
>
>     Now, for every value of i, I want to calculate the SVD
>     decomposition and
>     get the diagonal matrix created by the singular values. When I set
>     the i
>     value it works:
>     diag( svd(x[1,,])$d )
>
>     # [,1]???? [,2]????? [,3]
>     # [1,] 15.73833 0.000000 0.0000000
>     # [2,]? 0.00000 1.502771 0.0000000
>     # [3,]? 0.00000 0.000000 0.1049992
>
>
>     But when I try to do a loop on the i value it doesn't work:
>
>     apply(x, c(2,3), FUN = function(x) diag( svd(x)$d ))
>
>
>     # [,1]??????? [,2]??????? [,3]
>     # [1,] Numeric,361 Numeric,81? Numeric,144
>     # [2,] Numeric,81? Numeric,400 Numeric,81
>     # [3,] Numeric,144 Numeric,81? Numeric,900
>
>     I do not understand how to do the apply on an array in order to
>     get my
>     diagonals matrices. I think that I miss something about the
>     understanding of the array object.
>
>     Thank you for your help
>
>     Laurent
>
>
>
>
>     -- 
>     L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e
>     par le logiciel antivirus Avast.
>     https://www.avast.com/antivirus <https://www.avast.com/antivirus>
>
>     ______________________________________________
>     R-help at r-project.org <mailto:R-help at r-project.org> mailing list --
>     To UNSUBSCRIBE and more, see
>     https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>     PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>     and provide commented, minimal, self-contained, reproducible code.
>



-- 
L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e par le logiciel antivirus Avast.
https://www.avast.com/antivirus

	[[alternative HTML version deleted]]


From dw|n@em|u@ @end|ng |rom comc@@t@net  Mon Jul  5 19:03:04 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Mon, 5 Jul 2021 10:03:04 -0700
Subject: [R] Some difficulties to use the apply command on an array
In-Reply-To: <c4612b79-068b-4693-04ea-ac6e4a4c4e9e@free.fr>
References: <c4612b79-068b-4693-04ea-ac6e4a4c4e9e@free.fr>
Message-ID: <CE85FCFB-0DBF-45D8-BEF5-C601007A06C6@comcast.net>



> On Jul 5, 2021, at 7:56 AM, Laurent Rhelp <LaurentRHelp at free.fr> wrote:
> 
> Dear R-Help,
> 
> I have an array x made up of three matrices of 5 rows and 3 columns of complex numbers (the complex numbers are not the problem)
> 
> ## my array
> x <- structure(c(5.6196790161893828+0i, 5.7565523942393364+0i, 8.5242834298729342+0i,
>               10.304766710160479+0i, 11.412967010108229+0i, -2.6952197604866495-5.7324226520260237e-18i,
>               -3.8053698833683476-1.5535793240880411i, -4.440850591952894-0.21277190153473785i,
>               -4.9049897326853316+0.22487294128201613i, -4.6982778900868931-0.35986943359186585i,
>               -6.7722948827866034-1.8252881225149525e-16i, -5.6864255243941733-0.82149125972147463i,
>               -2.5321753317962115-3.4309121438578525i, 0.85377696343414344-4.3720244641138883i,
>               6.3363344379954638-2.23654533694011i, -2.6952197604866495+5.7324226520260237e-18i,
>               -3.8053698833683476+1.5535793240880411i, -4.440850591952894+0.21277190153473785i,
>               -4.9049897326853316-0.22487294128201613i, -4.6982778900868931+0.35986943359186585i,
>               3.1683154084671417+0i, 5.397392162921844+0i, 8.3085887222115922+0i,
>               11.150391891976289+0i, 13.173434845070231+0i, 3.7978840709983359+5.0735539531499429e-17i,
>               3.0599215005995717-2.3669737981128267i, 0.5951827523696811-3.2116907301709845i,
>               -1.7735244105472532-3.8366652813316566i, -5.0558348297797169-2.6645747173403049i,
>               -6.7722948827866034+1.8252881225149525e-16i, -5.6864255243941733+0.82149125972147463i,
>               -2.5321753317962115+3.4309121438578525i, 0.85377696343414344+4.3720244641138883i,
>               6.3363344379954638+2.23654533694011i, 3.7978840709983359-5.0735539531499429e-17i,
>               3.0599215005995717+2.3669737981128267i, 0.5951827523696811+3.2116907301709845i,
>               -1.7735244105472532+3.8366652813316566i, -5.0558348297797169+2.6645747173403049i,
>               8.5581082281979697+0i, 8.6908832216086331+0i, 12.394094469562258+0i,
>               16.106350896659897+0i, 19.569513600539693+0i), .Dim = c(5L, 3L,
> 3L))
> 
> str(x)
> #  cplx [1:5, 1:3, 1:3] 5.62+0i 5.76+0i 8.52+0i ...
> 
> The dimensions (i,j,k) of my array are 5, 3, 3. For every value of i, I am interested in the squared matrices made up of the j columns for all the k indice. For a given value i I have to keep the row i for every k. For example if i=1, I am interested by the matrix x[1,,]
> ##
> x[1,,]
> 
> ##              [,1]         [,2]         [,3]
> ## [1,]  5.619679+0i -2.695220+0i -6.772295+0i
> ## [2,] -2.695220-0i  3.168315+0i  3.797884-0i
> ## [3,] -6.772295-0i  3.797884+0i  8.558108+0i
> 
> Now, for every value of i, I want to calculate the SVD decomposition and get the diagonal matrix created by the singular values. When I set the i value it works:
> diag( svd(x[1,,])$d )
> 
> # [,1]     [,2]      [,3]
> # [1,] 15.73833 0.000000 0.0000000
> # [2,]  0.00000 1.502771 0.0000000
> # [3,]  0.00000 0.000000 0.1049992
> 
> 
> But when I try to do a loop on the i value it doesn't work:
> 
> apply(x, c(2,3), FUN = function(x) diag( svd(x)$d ))
> 

Use a different indexing strategy:

res <- apply(x, 1, FUN = function(x) diag( svd(x)$d ))

The result is flattened but each of the columns in that `res`-object are the entries in a 3x3 matrix. Reform it by:

> dim(res) <- c(3,3,5)
> res
, , 1

         [,1]     [,2]      [,3]
[1,] 15.73833 0.000000 0.0000000
[2,]  0.00000 1.502771 0.0000000
[3,]  0.00000 0.000000 0.1049992

, , 2

        [,1]     [,2]     [,3]
[1,] 16.0011 0.000000 0.000000
[2,]  0.0000 3.357086 0.000000
[3,]  0.0000 0.000000 0.486643

, , 3

         [,1]     [,2]    [,3]
[1,] 16.05269  0.00000 0.00000
[2,]  0.00000 11.49007 0.00000
[3,]  0.00000  0.00000 1.68421

, , 4

         [,1]     [,2]     [,3]
[1,] 19.58508  0.00000 0.000000
[2,]  0.00000 14.83712 0.000000
[3,]  0.00000  0.00000 3.139307

, , 5

         [,1]     [,2]     [,3]
[1,] 26.75931  0.00000 0.000000
[2,]  0.00000 11.81372 0.000000
[3,]  0.00000  0.00000 5.582891


-- 
David

> 
> # [,1]        [,2]        [,3]
> # [1,] Numeric,361 Numeric,81  Numeric,144
> # [2,] Numeric,81  Numeric,400 Numeric,81
> # [3,] Numeric,144 Numeric,81  Numeric,900
> 
> I do not understand how to do the apply on an array in order to get my diagonals matrices. I think that I miss something about the understanding of the array object.
> 
> Thank you for your help
> 
> Laurent
> 
> 
> 
> 
> -- 
> L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e par le logiciel antivirus Avast.
> https://www.avast.com/antivirus
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From L@urentRHe|p @end|ng |rom |ree@|r  Mon Jul  5 21:57:09 2021
From: L@urentRHe|p @end|ng |rom |ree@|r (Laurent Rhelp)
Date: Mon, 5 Jul 2021 21:57:09 +0200
Subject: [R] Some difficulties to use the apply command on an array
In-Reply-To: <B9734C0B-BE78-4424-AED9-E7EB14904C8B@dcn.davis.ca.us>
References: <c4612b79-068b-4693-04ea-ac6e4a4c4e9e@free.fr>
 <CAGgJW77Pk1WzoXR=_+Y3VLn6UaXGXp2XuvvgN7LEJ_j9qgpktA@mail.gmail.com>
 <B9734C0B-BE78-4424-AED9-E7EB14904C8B@dcn.davis.ca.us>
Message-ID: <9c9ff477-f106-a3ca-2b27-49fc3b9bc014@free.fr>

Very interesting
Thank you


Le 05/07/2021 ? 17:31, Jeff Newmiller a ?crit?:
> apply _always_ returns a matrix of vector results. That is, the result of each call to FUN may be a matrix, but a matrix is merely a vector with dimensions that are in this case ignored. So restore the dimensions on the result:
>
> array(apply(x, 1, FUN = function(x) diag( svd(x)$d )), dim=c(3,3,5))
>
>
> On July 5, 2021 8:15:16 AM PDT, Eric Berger <ericjberger at gmail.com> wrote:
>> Hi Laurent,
>> I am not sure how to get apply()  to work but the following uses
>> lapply()
>> and returns the matrices in a list.
>>
>> lapply(1:3, FUN = function(i) diag( svd(x[i,,])$d ))
>>
>> HTH,
>> Eric
>>
>> On Mon, Jul 5, 2021 at 5:56 PM Laurent Rhelp <LaurentRHelp at free.fr>
>> wrote:
>>
>>> Dear R-Help,
>>>
>>> I have an array x made up of three matrices of 5 rows and 3 columns
>> of
>>> complex numbers (the complex numbers are not the problem)
>>>
>>> ## my array
>>> x <- structure(c(5.6196790161893828+0i, 5.7565523942393364+0i,
>>> 8.5242834298729342+0i,
>>>                 10.304766710160479+0i, 11.412967010108229+0i,
>>> -2.6952197604866495-5.7324226520260237e-18i,
>>>                 -3.8053698833683476-1.5535793240880411i,
>>> -4.440850591952894-0.21277190153473785i,
>>>                 -4.9049897326853316+0.22487294128201613i,
>>> -4.6982778900868931-0.35986943359186585i,
>>>                 -6.7722948827866034-1.8252881225149525e-16i,
>>> -5.6864255243941733-0.82149125972147463i,
>>>                 -2.5321753317962115-3.4309121438578525i,
>>> 0.85377696343414344-4.3720244641138883i,
>>>                 6.3363344379954638-2.23654533694011i,
>>> -2.6952197604866495+5.7324226520260237e-18i,
>>>                 -3.8053698833683476+1.5535793240880411i,
>>> -4.440850591952894+0.21277190153473785i,
>>>                 -4.9049897326853316-0.22487294128201613i,
>>> -4.6982778900868931+0.35986943359186585i,
>>>                 3.1683154084671417+0i, 5.397392162921844+0i,
>>> 8.3085887222115922+0i,
>>>                 11.150391891976289+0i, 13.173434845070231+0i,
>>> 3.7978840709983359+5.0735539531499429e-17i,
>>>                 3.0599215005995717-2.3669737981128267i,
>>> 0.5951827523696811-3.2116907301709845i,
>>>                 -1.7735244105472532-3.8366652813316566i,
>>> -5.0558348297797169-2.6645747173403049i,
>>>                 -6.7722948827866034+1.8252881225149525e-16i,
>>> -5.6864255243941733+0.82149125972147463i,
>>>                 -2.5321753317962115+3.4309121438578525i,
>>> 0.85377696343414344+4.3720244641138883i,
>>>                 6.3363344379954638+2.23654533694011i,
>>> 3.7978840709983359-5.0735539531499429e-17i,
>>>                 3.0599215005995717+2.3669737981128267i,
>>> 0.5951827523696811+3.2116907301709845i,
>>>                 -1.7735244105472532+3.8366652813316566i,
>>> -5.0558348297797169+2.6645747173403049i,
>>>                 8.5581082281979697+0i, 8.6908832216086331+0i,
>>> 12.394094469562258+0i,
>>>                 16.106350896659897+0i, 19.569513600539693+0i), .Dim =
>>> c(5L, 3L,
>>> 3L))
>>>
>>> str(x)
>>> #  cplx [1:5, 1:3, 1:3] 5.62+0i 5.76+0i 8.52+0i ...
>>>
>>> The dimensions (i,j,k) of my array are 5, 3, 3. For every value of i,
>> I
>>> am interested in the squared matrices made up of the j columns for
>> all
>>> the k indice. For a given value i I have to keep the row i for every
>> k.
>>> For example if i=1, I am interested by the matrix x[1,,]
>>> ##
>>> x[1,,]
>>>
>>> ##              [,1]         [,2]         [,3]
>>> ## [1,]  5.619679+0i -2.695220+0i -6.772295+0i
>>> ## [2,] -2.695220-0i  3.168315+0i  3.797884-0i
>>> ## [3,] -6.772295-0i  3.797884+0i  8.558108+0i
>>>
>>> Now, for every value of i, I want to calculate the SVD decomposition
>> and
>>> get the diagonal matrix created by the singular values. When I set
>> the i
>>> value it works:
>>> diag( svd(x[1,,])$d )
>>>
>>> # [,1]     [,2]      [,3]
>>> # [1,] 15.73833 0.000000 0.0000000
>>> # [2,]  0.00000 1.502771 0.0000000
>>> # [3,]  0.00000 0.000000 0.1049992
>>>
>>>
>>> But when I try to do a loop on the i value it doesn't work:
>>>
>>> apply(x, c(2,3), FUN = function(x) diag( svd(x)$d ))
>>>
>>>
>>> # [,1]        [,2]        [,3]
>>> # [1,] Numeric,361 Numeric,81  Numeric,144
>>> # [2,] Numeric,81  Numeric,400 Numeric,81
>>> # [3,] Numeric,144 Numeric,81  Numeric,900
>>>
>>> I do not understand how to do the apply on an array in order to get
>> my
>>> diagonals matrices. I think that I miss something about the
>>> understanding of the array object.
>>>
>>> Thank you for your help
>>>
>>> Laurent
>>>
>>>
>>>
>>>
>>> --
>>> L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e par
>> le
>>> logiciel antivirus Avast.
>>> https://www.avast.com/antivirus
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.



-- 
L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e par le logiciel antivirus Avast.
https://www.avast.com/antivirus


From L@urentRHe|p @end|ng |rom |ree@|r  Mon Jul  5 22:04:43 2021
From: L@urentRHe|p @end|ng |rom |ree@|r (Laurent Rhelp)
Date: Mon, 5 Jul 2021 22:04:43 +0200
Subject: [R] Some difficulties to use the apply command on an array
In-Reply-To: <CE85FCFB-0DBF-45D8-BEF5-C601007A06C6@comcast.net>
References: <c4612b79-068b-4693-04ea-ac6e4a4c4e9e@free.fr>
 <CE85FCFB-0DBF-45D8-BEF5-C601007A06C6@comcast.net>
Message-ID: <d08453ca-16ff-fbc4-ba37-41efb82e9971@free.fr>

It is good trick and we have to know that R arrays use the 'column major 
mode' to store the value.
Thank you
Laurent


Le 05/07/2021 ? 19:03, David Winsemius a ?crit?:
>
>> On Jul 5, 2021, at 7:56 AM, Laurent Rhelp <LaurentRHelp at free.fr> wrote:
>>
>> Dear R-Help,
>>
>> I have an array x made up of three matrices of 5 rows and 3 columns of complex numbers (the complex numbers are not the problem)
>>
>> ## my array
>> x <- structure(c(5.6196790161893828+0i, 5.7565523942393364+0i, 8.5242834298729342+0i,
>>                10.304766710160479+0i, 11.412967010108229+0i, -2.6952197604866495-5.7324226520260237e-18i,
>>                -3.8053698833683476-1.5535793240880411i, -4.440850591952894-0.21277190153473785i,
>>                -4.9049897326853316+0.22487294128201613i, -4.6982778900868931-0.35986943359186585i,
>>                -6.7722948827866034-1.8252881225149525e-16i, -5.6864255243941733-0.82149125972147463i,
>>                -2.5321753317962115-3.4309121438578525i, 0.85377696343414344-4.3720244641138883i,
>>                6.3363344379954638-2.23654533694011i, -2.6952197604866495+5.7324226520260237e-18i,
>>                -3.8053698833683476+1.5535793240880411i, -4.440850591952894+0.21277190153473785i,
>>                -4.9049897326853316-0.22487294128201613i, -4.6982778900868931+0.35986943359186585i,
>>                3.1683154084671417+0i, 5.397392162921844+0i, 8.3085887222115922+0i,
>>                11.150391891976289+0i, 13.173434845070231+0i, 3.7978840709983359+5.0735539531499429e-17i,
>>                3.0599215005995717-2.3669737981128267i, 0.5951827523696811-3.2116907301709845i,
>>                -1.7735244105472532-3.8366652813316566i, -5.0558348297797169-2.6645747173403049i,
>>                -6.7722948827866034+1.8252881225149525e-16i, -5.6864255243941733+0.82149125972147463i,
>>                -2.5321753317962115+3.4309121438578525i, 0.85377696343414344+4.3720244641138883i,
>>                6.3363344379954638+2.23654533694011i, 3.7978840709983359-5.0735539531499429e-17i,
>>                3.0599215005995717+2.3669737981128267i, 0.5951827523696811+3.2116907301709845i,
>>                -1.7735244105472532+3.8366652813316566i, -5.0558348297797169+2.6645747173403049i,
>>                8.5581082281979697+0i, 8.6908832216086331+0i, 12.394094469562258+0i,
>>                16.106350896659897+0i, 19.569513600539693+0i), .Dim = c(5L, 3L,
>> 3L))
>>
>> str(x)
>> #  cplx [1:5, 1:3, 1:3] 5.62+0i 5.76+0i 8.52+0i ...
>>
>> The dimensions (i,j,k) of my array are 5, 3, 3. For every value of i, I am interested in the squared matrices made up of the j columns for all the k indice. For a given value i I have to keep the row i for every k. For example if i=1, I am interested by the matrix x[1,,]
>> ##
>> x[1,,]
>>
>> ##              [,1]         [,2]         [,3]
>> ## [1,]  5.619679+0i -2.695220+0i -6.772295+0i
>> ## [2,] -2.695220-0i  3.168315+0i  3.797884-0i
>> ## [3,] -6.772295-0i  3.797884+0i  8.558108+0i
>>
>> Now, for every value of i, I want to calculate the SVD decomposition and get the diagonal matrix created by the singular values. When I set the i value it works:
>> diag( svd(x[1,,])$d )
>>
>> # [,1]     [,2]      [,3]
>> # [1,] 15.73833 0.000000 0.0000000
>> # [2,]  0.00000 1.502771 0.0000000
>> # [3,]  0.00000 0.000000 0.1049992
>>
>>
>> But when I try to do a loop on the i value it doesn't work:
>>
>> apply(x, c(2,3), FUN = function(x) diag( svd(x)$d ))
>>
> Use a different indexing strategy:
>
> res <- apply(x, 1, FUN = function(x) diag( svd(x)$d ))
>
> The result is flattened but each of the columns in that `res`-object are the entries in a 3x3 matrix. Reform it by:
>
>> dim(res) <- c(3,3,5)
>> res
> , , 1
>
>           [,1]     [,2]      [,3]
> [1,] 15.73833 0.000000 0.0000000
> [2,]  0.00000 1.502771 0.0000000
> [3,]  0.00000 0.000000 0.1049992
>
> , , 2
>
>          [,1]     [,2]     [,3]
> [1,] 16.0011 0.000000 0.000000
> [2,]  0.0000 3.357086 0.000000
> [3,]  0.0000 0.000000 0.486643
>
> , , 3
>
>           [,1]     [,2]    [,3]
> [1,] 16.05269  0.00000 0.00000
> [2,]  0.00000 11.49007 0.00000
> [3,]  0.00000  0.00000 1.68421
>
> , , 4
>
>           [,1]     [,2]     [,3]
> [1,] 19.58508  0.00000 0.000000
> [2,]  0.00000 14.83712 0.000000
> [3,]  0.00000  0.00000 3.139307
>
> , , 5
>
>           [,1]     [,2]     [,3]
> [1,] 26.75931  0.00000 0.000000
> [2,]  0.00000 11.81372 0.000000
> [3,]  0.00000  0.00000 5.582891
>
>


-- 
L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e par le logiciel antivirus Avast.
https://www.avast.com/antivirus


From ev@n@cooch @end|ng |rom gm@||@com  Tue Jul  6 15:27:20 2021
From: ev@n@cooch @end|ng |rom gm@||@com (Evan Cooch)
Date: Tue, 6 Jul 2021 09:27:20 -0400
Subject: [R] conditional output of string to file n times...
Message-ID: <651e323f-30de-37ce-dd6d-0ac0889a6848@gmail.com>

Suppose I have a file with the the following structure - call the two 
space-separated fields 'label' and 'count':

ABC 3
DDG 5
ABB 2


What I need to do is parse each line of the file, and then depending on 
the value of count, write out the value of 'label' to a new file, but 
'count' times. In other words, take the preceding, and output

ABC
ABC
ABC
DDG
DDG
DDG
DDG
DDG
ABB
ABB

I was wondering if there was an elegant/simple way to do this? I can do 
this relatively easily in perl, or awk, but am stumped by getting a bit 
of R code to accomplish the same thing.

Many thanks in advance...


From er|cjberger @end|ng |rom gm@||@com  Wed Jul  7 09:53:53 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Wed, 7 Jul 2021 10:53:53 +0300
Subject: [R] conditional output of string to file n times...
In-Reply-To: <651e323f-30de-37ce-dd6d-0ac0889a6848@gmail.com>
References: <651e323f-30de-37ce-dd6d-0ac0889a6848@gmail.com>
Message-ID: <CAGgJW74hWjUceCY5g6CMhMa6rypTUJasATUvUwuUO=Koo2DPuA@mail.gmail.com>

Hi Evan,
I assume you know how to get the data into a data frame (e.g. via read.csv).
Here I will create the example data explicitly, creating a data frame x.

x <- data.frame( label=c("ABC","DDG","ABB"), count=c(3,5,2) )

Then create a character vector with the data as you want it.

y <- unlist(sapply( 1:nrow(x), function(i) rep( x$label[i], x$count[i] ) ))

Finally print it to a file, say 'myfile' (to get one element per line I did
a bit of a trick).

write.table(x=t(t(y)),file="myfile",row.names=FALSE,col.names=FALSE,quote=FALSE)

HTH,
Eric




On Wed, Jul 7, 2021 at 10:15 AM Evan Cooch <evan.cooch at gmail.com> wrote:

> Suppose I have a file with the the following structure - call the two
> space-separated fields 'label' and 'count':
>
> ABC 3
> DDG 5
> ABB 2
>
>
> What I need to do is parse each line of the file, and then depending on
> the value of count, write out the value of 'label' to a new file, but
> 'count' times. In other words, take the preceding, and output
>
> ABC
> ABC
> ABC
> DDG
> DDG
> DDG
> DDG
> DDG
> ABB
> ABB
>
> I was wondering if there was an elegant/simple way to do this? I can do
> this relatively easily in perl, or awk, but am stumped by getting a bit
> of R code to accomplish the same thing.
>
> Many thanks in advance...
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Wed Jul  7 09:57:26 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Wed, 7 Jul 2021 09:57:26 +0200
Subject: [R] conditional output of string to file n times...
In-Reply-To: <651e323f-30de-37ce-dd6d-0ac0889a6848@gmail.com>
References: <651e323f-30de-37ce-dd6d-0ac0889a6848@gmail.com>
Message-ID: <20210707095726.35644369@trisector>

On Tue, 6 Jul 2021 09:27:20 -0400
Evan Cooch <evan.cooch at gmail.com> wrote:

> I was wondering if there was an elegant/simple way to do this?

rep(label, times = count) should give you a character vector with the
answer ready for writeLines().

-- 
Best regards,
Ivan


From er|cjberger @end|ng |rom gm@||@com  Wed Jul  7 10:01:13 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Wed, 7 Jul 2021 11:01:13 +0300
Subject: [R] conditional output of string to file n times...
In-Reply-To: <20210707095726.35644369@trisector>
References: <651e323f-30de-37ce-dd6d-0ac0889a6848@gmail.com>
 <20210707095726.35644369@trisector>
Message-ID: <CAGgJW76cccPFBF7ZTqvwKv-KQAg=TZaKYyg67e0WN+wGvxjAew@mail.gmail.com>

much nicer

On Wed, Jul 7, 2021 at 10:58 AM Ivan Krylov <krylov.r00t at gmail.com> wrote:

> On Tue, 6 Jul 2021 09:27:20 -0400
> Evan Cooch <evan.cooch at gmail.com> wrote:
>
> > I was wondering if there was an elegant/simple way to do this?
>
> rep(label, times = count) should give you a character vector with the
> answer ready for writeLines().
>
> --
> Best regards,
> Ivan
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Jul  7 10:01:58 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 7 Jul 2021 09:01:58 +0100
Subject: [R] conditional output of string to file n times...
In-Reply-To: <651e323f-30de-37ce-dd6d-0ac0889a6848@gmail.com>
References: <651e323f-30de-37ce-dd6d-0ac0889a6848@gmail.com>
Message-ID: <ba016956-6ddf-0857-963a-d982ae9c0501@sapo.pt>

Hello,

Use ?rep.
Since you say you have a file, in the code below I will read the data 
from a connection. Then create the string.


txtfile <- "ABC 3
DDG 5
ABB 2"

tc <- textConnection(txtfile)
df1 <- read.table(tc)
close(tc)

rep(df1[[1]], df1[[2]])
#[1] "ABC" "ABC" "ABC" "DDG" "DDG" "DDG" "DDG" "DDG" "ABB" "ABB"


Hope this helps,

Rui Barradas


?s 14:27 de 06/07/21, Evan Cooch escreveu:
> Suppose I have a file with the the following structure - call the two 
> space-separated fields 'label' and 'count':
> 
> ABC 3
> DDG 5
> ABB 2
> 
> 
> What I need to do is parse each line of the file, and then depending on 
> the value of count, write out the value of 'label' to a new file, but 
> 'count' times. In other words, take the preceding, and output
> 
> ABC
> ABC
> ABC
> DDG
> DDG
> DDG
> DDG
> DDG
> ABB
> ABB
> 
> I was wondering if there was an elegant/simple way to do this? I can do 
> this relatively easily in perl, or awk, but am stumped by getting a bit 
> of R code to accomplish the same thing.
> 
> Many thanks in advance...
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Jul  7 10:07:00 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 7 Jul 2021 09:07:00 +0100
Subject: [R] conditional output of string to file n times...
In-Reply-To: <ba016956-6ddf-0857-963a-d982ae9c0501@sapo.pt>
References: <651e323f-30de-37ce-dd6d-0ac0889a6848@gmail.com>
 <ba016956-6ddf-0857-963a-d982ae9c0501@sapo.pt>
Message-ID: <ac9effb9-3348-2e5f-289a-247d0f9ea086@sapo.pt>

Hello,

Sorry, I forgot the output to file part.


y <- rep(df1[[1]], df1[[2]])
cat(y, file = "~/tmp/rhelp.txt", sep = "\n")


Hope this helps,

Rui Barradas

?s 09:01 de 07/07/21, Rui Barradas escreveu:
> Hello,
> 
> Use ?rep.
> Since you say you have a file, in the code below I will read the data 
> from a connection. Then create the string.
> 
> 
> txtfile <- "ABC 3
> DDG 5
> ABB 2"
> 
> tc <- textConnection(txtfile)
> df1 <- read.table(tc)
> close(tc)
> 
> rep(df1[[1]], df1[[2]])
> #[1] "ABC" "ABC" "ABC" "DDG" "DDG" "DDG" "DDG" "DDG" "ABB" "ABB"
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> 
> ?s 14:27 de 06/07/21, Evan Cooch escreveu:
>> Suppose I have a file with the the following structure - call the two 
>> space-separated fields 'label' and 'count':
>>
>> ABC 3
>> DDG 5
>> ABB 2
>>
>>
>> What I need to do is parse each line of the file, and then depending 
>> on the value of count, write out the value of 'label' to a new file, 
>> but 'count' times. In other words, take the preceding, and output
>>
>> ABC
>> ABC
>> ABC
>> DDG
>> DDG
>> DDG
>> DDG
>> DDG
>> ABB
>> ABB
>>
>> I was wondering if there was an elegant/simple way to do this? I can 
>> do this relatively easily in perl, or awk, but am stumped by getting a 
>> bit of R code to accomplish the same thing.
>>
>> Many thanks in advance...
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From chr|@ho|d @end|ng |rom p@yctc@org  Wed Jul  7 13:10:42 2021
From: chr|@ho|d @end|ng |rom p@yctc@org (Chris Evans)
Date: Wed, 7 Jul 2021 11:10:42 +0000 (UTC)
Subject: [R] conditional output of string to file n times...
In-Reply-To: <ac9effb9-3348-2e5f-289a-247d0f9ea086@sapo.pt>
References: <651e323f-30de-37ce-dd6d-0ac0889a6848@gmail.com>
 <ba016956-6ddf-0857-963a-d982ae9c0501@sapo.pt>
 <ac9effb9-3348-2e5f-289a-247d0f9ea086@sapo.pt>
Message-ID: <942724425.310440.1625656242292.JavaMail.zimbra@psyctc.org>

And just for the fun of it, a tidverse way.  I quite like uncount()

### get the library
library(tidyverse) # or just library(tidyr)

### create data as per nice base R e.g.
x <- data.frame(label = c("ABC","DDG","ABB"), count = c(3,5,2))
### use uncount to ... well, uncount it!
uncount(x, count) -> y
y

# or using tidyverse piping to do the same
x %>%
  uncount(., count) -> y

### and one of many ways to write to a simple file
### make sure you do this in a safe place!
cat(y, file = "safefile.txt", sep = "\n")


Cheers all,

Chris

----- Original Message -----
> From: "Rui Barradas" <ruipbarradas at sapo.pt>
> To: "Evan Cooch" <evan.cooch at gmail.com>, r-help at r-project.org
> Sent: Wednesday, 7 July, 2021 09:07:00
> Subject: Re: [R] conditional output of string to file n times...

> Hello,
> 
> Sorry, I forgot the output to file part.
> 
> 
> y <- rep(df1[[1]], df1[[2]])
> cat(y, file = "~/tmp/rhelp.txt", sep = "\n")
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 09:01 de 07/07/21, Rui Barradas escreveu:
>> Hello,
>> 
>> Use ?rep.
>> Since you say you have a file, in the code below I will read the data
>> from a connection. Then create the string.
>> 
>> 
>> txtfile <- "ABC 3
>> DDG 5
>> ABB 2"
>> 
>> tc <- textConnection(txtfile)
>> df1 <- read.table(tc)
>> close(tc)
>> 
>> rep(df1[[1]], df1[[2]])
>> #[1] "ABC" "ABC" "ABC" "DDG" "DDG" "DDG" "DDG" "DDG" "ABB" "ABB"
>> 
>> 
>> Hope this helps,
>> 
>> Rui Barradas
>> 
>> 
>> ?s 14:27 de 06/07/21, Evan Cooch escreveu:
>>> Suppose I have a file with the the following structure - call the two
>>> space-separated fields 'label' and 'count':
>>>
>>> ABC 3
>>> DDG 5
>>> ABB 2
>>>
>>>
>>> What I need to do is parse each line of the file, and then depending
>>> on the value of count, write out the value of 'label' to a new file,
>>> but 'count' times. In other words, take the preceding, and output
>>>
>>> ABC
>>> ABC
>>> ABC
>>> DDG
>>> DDG
>>> DDG
>>> DDG
>>> DDG
>>> ABB
>>> ABB
>>>
>>> I was wondering if there was an elegant/simple way to do this? I can
>>> do this relatively easily in perl, or awk, but am stumped by getting a
>>> bit of R code to accomplish the same thing.
>>>
>>> Many thanks in advance...
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>> 
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Chris Evans (he/him) <chris at psyctc.org> Visiting Professor, University of Sheffield <chris.evans at sheffield.ac.uk>
I do some consultation work for the University of Roehampton <chris.evans at roehampton.ac.uk> and other places
but <chris at psyctc.org> remains my main Email address.  I have a work web site at:
   https://www.psyctc.org/psyctc/
and a site I manage for CORE and CORE system trust at:
   http://www.coresystemtrust.org.uk/
I have "semigrated" to France, see: 
   https://www.psyctc.org/pelerinage2016/semigrating-to-france/ 
   https://www.psyctc.org/pelerinage2016/register-to-get-updates-from-pelerinage2016/

If you want an Emeeting, I am trying to keep them to Thursdays and my diary is at:
   https://www.psyctc.org/pelerinage2016/ceworkdiary/
Beware: French time, generally an hour ahead of UK.


From @hmede|be|t@gy136 @end|ng |rom gm@||@com  Tue Jul  6 15:16:01 2021
From: @hmede|be|t@gy136 @end|ng |rom gm@||@com (Ahmed Elbeltagi)
Date: Tue, 6 Jul 2021 21:16:01 +0800
Subject: [R] Help in R
Message-ID: <CACGQLPMHhMHWMNBR5bH+21=VyBSfTfVt_pCH7yvjT_d=13+n=g@mail.gmail.com>

 Dear,
I have a problem in the last code in R. I have attached code highlighted
with yellow color, files, and screenshot of error.
Waiting for your kind help.
Regards,
Ahmed

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: rwc.txt
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20210706/7207be44/attachment.txt>

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: wele.txt
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20210706/7207be44/attachment-0001.txt>

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: tag.txt
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20210706/7207be44/attachment-0002.txt>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: Screenshot-Error.png
Type: image/png
Size: 106787 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20210706/7207be44/attachment.png>

From ev@n@cooch @end|ng |rom gm@||@com  Tue Jul  6 16:31:41 2021
From: ev@n@cooch @end|ng |rom gm@||@com (Evan Cooch)
Date: Tue, 6 Jul 2021 10:31:41 -0400
Subject: [R] conditional output of string to file n times...
In-Reply-To: <651e323f-30de-37ce-dd6d-0ac0889a6848@gmail.com>
References: <651e323f-30de-37ce-dd6d-0ac0889a6848@gmail.com>
Message-ID: <189855f3-255a-fc24-24b9-094247d79f85@gmail.com>

Figured it out on my own. Basically, use the replicate command for each 
line of the data.frame, then appending to a file.

On 7/6/2021 9:27 AM, Evan Cooch wrote:
> Suppose I have a file with the the following structure - call the two 
> space-separated fields 'label' and 'count':
>
> ABC 3
> DDG 5
> ABB 2
>
>
> What I need to do is parse each line of the file, and then depending 
> on the value of count, write out the value of 'label' to a new file, 
> but 'count' times. In other words, take the preceding, and output
>
> ABC
> ABC
> ABC
> DDG
> DDG
> DDG
> DDG
> DDG
> ABB
> ABB
>
> I was wondering if there was an elegant/simple way to do this? I can 
> do this relatively easily in perl, or awk, but am stumped by getting a 
> bit of R code to accomplish the same thing.
>
> Many thanks in advance...
>


From @|@y@hz@k@r|@ @end|ng |rom un|m@p@edu@my  Wed Jul  7 07:44:09 2021
From: @|@y@hz@k@r|@ @end|ng |rom un|m@p@edu@my (SITI AISYAH ZAKARIA)
Date: Wed, 7 Jul 2021 13:44:09 +0800
Subject: [R] How to estimate the parameter for many variable?
Message-ID: <CALcx2Bm+Py5Asc7KT+-2x6mW0j5zO6YNKBFktsn4usjjXAz7DQ@mail.gmail.com>

Dear all,

Can I ask something about programming in marginal distribution for spatial
extreme?
I really stuck on my coding to obtain the parameter estimation for
univariate or marginal distribution for new model in spatial extreme.

I want to run my data in order to get the parameter estimation value for 25
stations in one table. But I really didn't get the idea of the correct
coding. Here I attached my coding

x <- data.matrix(Ozone_weekly2)
x
head(gev.fit)[1:4]
ti = matrix(ncol = 3, nrow = 888)
ti[,1] = seq(1, 888, 1)
ti[,2]=sin(2*pi*(ti[,1])/52)
ti[,3]=cos(2*pi*(ti[,1])/52)
for(i in 1:nrow(x))
  + { for(j in 1:ncol(x))
    + {x[i,j] = 1}}

My problem is highlighted in red color.
And if are not hesitate to all. Can someone share with me the procedure,
how can I map my data using spatial extreme.
For example:
After I finish my marginal distribution, what the next procedure. It is I
need to get the spatial independent value.

That's all
Thank you.

-- 





"..Millions of trees are used to make papers, only to be thrown away 
after a couple of minutes reading from them. Our planet is at stake. Please 
be considerate. THINK TWICE BEFORE PRINTING THIS.."

DISCLAIMER:?This email \ and any files transmitte...{{dropped:24}}


From @kw@|mmo @end|ng |rom gm@||@com  Wed Jul  7 16:10:21 2021
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Wed, 7 Jul 2021 10:10:21 -0400
Subject: [R] Help in R
In-Reply-To: <CACGQLPMHhMHWMNBR5bH+21=VyBSfTfVt_pCH7yvjT_d=13+n=g@mail.gmail.com>
References: <CACGQLPMHhMHWMNBR5bH+21=VyBSfTfVt_pCH7yvjT_d=13+n=g@mail.gmail.com>
Message-ID: <CAPcHnpTJT23O248SV1Zm+rf_WJ1wUGMfUnXQRrqQby2g5ct3eQ@mail.gmail.com>

Hello,


I can't provide too much help without knowing which packages `hotspot` and
`levelplot` come from. It might be something as simple as
`as.data.frame(matrixaaaaaa)` instead of `matrixaaaaaa`.

On Wed, Jul 7, 2021 at 10:04 AM Ahmed Elbeltagi <ahmedelbeltagy136 at gmail.com>
wrote:

>  Dear,
> I have a problem in the last code in R. I have attached code highlighted
> with yellow color, files, and screenshot of error.
> Waiting for your kind help.
> Regards,
> Ahmed
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From y@ngk@|9999 @end|ng |rom y@hoo@com  Thu Jul  8 03:27:48 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Thu, 8 Jul 2021 01:27:48 +0000 (UTC)
Subject: [R] problem for strsplit function
References: <1288772030.1763738.1625707668786.ref@mail.yahoo.com>
Message-ID: <1288772030.1763738.1625707668786@mail.yahoo.com>

 Hello List,
I have a? one column data frame to store file name with extension. I want to create new column to keep file name only without extension.
I tried to use strsplit("name1.csv", "\\.")[[1]] to do that, but it just retain the first row only and it is a vector.? how can do this for all of rows and put it into a new column?
thank you,
Kai




	[[alternative HTML version deleted]]


From @kw@|mmo @end|ng |rom gm@||@com  Thu Jul  8 04:45:00 2021
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Wed, 7 Jul 2021 22:45:00 -0400
Subject: [R] problem for strsplit function
In-Reply-To: <1288772030.1763738.1625707668786@mail.yahoo.com>
References: <1288772030.1763738.1625707668786.ref@mail.yahoo.com>
 <1288772030.1763738.1625707668786@mail.yahoo.com>
Message-ID: <CAPcHnpRrOaju5udHERfcwgRjEVtEWmh0FE1w0PBM9cKCA_ZdKQ@mail.gmail.com>

Hello,


I would suggest something like `tools::file_path_sans_ext` instead of
`strsplit` to remove the file extension. This is also vectorized, so you
won't have to use a `sapply` or `vapply` on it. I hope this helps!

On Wed, Jul 7, 2021 at 9:28 PM Kai Yang via R-help <r-help at r-project.org>
wrote:

>  Hello List,
> I have a  one column data frame to store file name with extension. I want
> to create new column to keep file name only without extension.
> I tried to use strsplit("name1.csv", "\\.")[[1]] to do that, but it just
> retain the first row only and it is a vector.  how can do this for all of
> rows and put it into a new column?
> thank you,
> Kai
>
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Thu Jul  8 04:49:10 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 7 Jul 2021 19:49:10 -0700
Subject: [R] problem for strsplit function
In-Reply-To: <1288772030.1763738.1625707668786@mail.yahoo.com>
References: <1288772030.1763738.1625707668786.ref@mail.yahoo.com>
 <1288772030.1763738.1625707668786@mail.yahoo.com>
Message-ID: <CAGxFJbRax+dBYTud=YLoTZ3ZAOGCUGQWmaW75LvTQLhbz5RiYg@mail.gmail.com>

You would need to loop through the list to use strsplit() -- you are
confused about list structure.

Here's a simple way to do it using regex's -- **assuming that there is
only one period in your names that delineates the extension.** If this
is not true, then this **will fail**. This is vectorized and so will
be more efficient than looping.

d <- data.frame (fn = c("name1.csv", "name2.txt"))
d
d$first <- sub("\\..+","",d$fn)
d

Cheers,
Bert

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Wed, Jul 7, 2021 at 6:28 PM Kai Yang via R-help <r-help at r-project.org> wrote:
>
>  Hello List,
> I have a  one column data frame to store file name with extension. I want to create new column to keep file name only without extension.
> I tried to use strsplit("name1.csv", "\\.")[[1]] to do that, but it just retain the first row only and it is a vector.  how can do this for all of rows and put it into a new column?
> thank you,
> Kai
>
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From r@turner @end|ng |rom @uck|@nd@@c@nz  Thu Jul  8 04:58:42 2021
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Thu, 8 Jul 2021 14:58:42 +1200
Subject: [R] problem for strsplit function
In-Reply-To: <1288772030.1763738.1625707668786@mail.yahoo.com>
References: <1288772030.1763738.1625707668786.ref@mail.yahoo.com>
 <1288772030.1763738.1625707668786@mail.yahoo.com>
Message-ID: <20210708145842.18af5eed@rolf-Latitude-E7470>


On Thu, 8 Jul 2021 01:27:48 +0000 (UTC)
Kai Yang via R-help <r-help at r-project.org> wrote:

> Hello List,
> I have a? one column data frame to store file name with extension. I
> want to create new column to keep file name only without extension. I
> tried to use strsplit("name1.csv", "\\.")[[1]] to do that, but it
> just retain the first row only and it is a vector.? how can do this
> for all of rows and put it into a new column? thank you, Kai

Your example is confusing/garbled.  You are applying strsplit() to a
single character string namely "name1.csv".  Your intent presumably is
to apply it to a *vector* (say "v") of file names.

A syntax which would work is

   sapply(strsplit(v,"\\."),function(x){x[1]})

E.g.

    v <- c("clyde.txt","irving.tex","melvin.pdf","fred.csv")
    sapply(strsplit(v,"\\."),function(x){x[1]})

which gives the output

> [1] "clyde"  "irving" "melvin" "fred"

Note that the output of strplit() is a *list* the i-th entry of which
is a vector consisting of the "split" of the i-th entry of the vector
to which strsplit() is applied.  In your example (corrected, so that it
makes sense, by replacing the string "names.csv" by my vector "v") you
get

    strsplit(v,"\\.")[[1]]
    [1] "clyde" "txt" 

the result of splitting "clyde.txt"; you want the first entry of this
result, i.e. "clyde".

My "sapply()" construction produces the first entry of each entry of the
list produced by strsplit().

It is useful to get your thoughts clear, understand what you are doing
and understand what the functions that you are using do.  (Read the
help!)

cheers,

Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Jul  8 05:02:48 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 07 Jul 2021 20:02:48 -0700
Subject: [R] problem for strsplit function
In-Reply-To: <1288772030.1763738.1625707668786@mail.yahoo.com>
References: <1288772030.1763738.1625707668786.ref@mail.yahoo.com>
 <1288772030.1763738.1625707668786@mail.yahoo.com>
Message-ID: <F7085740-6A14-4686-8179-D8DB8536EB11@dcn.davis.ca.us>

sub( "\\.[^.]*$", "", fname )

On July 7, 2021 6:27:48 PM PDT, Kai Yang via R-help <r-help at r-project.org> wrote:
> Hello List,
>I have a? one column data frame to store file name with extension. I
>want to create new column to keep file name only without extension.
>I tried to use strsplit("name1.csv", "\\.")[[1]] to do that, but it
>just retain the first row only and it is a vector.? how can do this for
>all of rows and put it into a new column?
>thank you,
>Kai
>
>
>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From r@turner @end|ng |rom @uck|@nd@@c@nz  Thu Jul  8 07:04:01 2021
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Thu, 8 Jul 2021 17:04:01 +1200
Subject: [R] Plotting the ASCII character set.
In-Reply-To: <166a17cf-1527-f131-710c-4d112e503380@gmail.com>
References: <20210703140259.600cb00c@rolf-Latitude-E7470>
 <20210703094028.773b0257@trisector>
 <20210704135949.6ee0ee4a@rolf-Latitude-E7470>
 <166a17cf-1527-f131-710c-4d112e503380@gmail.com>
Message-ID: <20210708170401.1862f62f@rolf-Latitude-E7470>


Thanks to Ivan Krylov, David Winsemius and Duncan Murdoch for their
informative replies to my cri de coeur.  The most complete answer was
however provided off-list by Andrew Simmons who wrote a new and
carefully structured function plotASCII() to replace my old no-longer
functioning plot_ascii() function.

In the belief that others on the list might well be interested in seeing
Andrew's very elegant solution to my problem, I have attached (with
Andrew's permission) the code for plotASCII() (in the file
"plotASCII.txt").

Note that Andrew, very cautiously, uses syntax such as
"graphics::text(<whatever>) rather than just text(<whatever>).
I guess it never hurts to be cautious.

cheers,

Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: plotASCII.txt
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20210708/ce2b1315/attachment.txt>

From m|n@h@|| @end|ng |rom um|ch@edu  Thu Jul  8 07:36:43 2021
From: m|n@h@|| @end|ng |rom um|ch@edu (Greg Minshall)
Date: Thu, 08 Jul 2021 08:36:43 +0300
Subject: [R] problem for strsplit function
In-Reply-To: Your message of "Wed, 07 Jul 2021 20:02:48 -0700."
 <F7085740-6A14-4686-8179-D8DB8536EB11@dcn.davis.ca.us>
Message-ID: <537799.1625722603@apollo2.minshall.org>

> sub( "\\.[^.]*$", "", fname )

fwiw, i almost always use '[.]' in preference to '\\\\\\\\.', as it
seems to be more likely to get through the various levels of quoting in
different contexts.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Jul  8 07:46:55 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 07 Jul 2021 22:46:55 -0700
Subject: [R] problem for strsplit function
In-Reply-To: <537799.1625722603@apollo2.minshall.org>
References: <537799.1625722603@apollo2.minshall.org>
Message-ID: <C961D4DC-DA03-45FE-BC57-33A3646E1D43@dcn.davis.ca.us>

I trust the escapes to do what they are designed to do. Cat the pattern to the console if you don't.

On July 7, 2021 10:36:43 PM PDT, Greg Minshall <minshall at umich.edu> wrote:
>> sub( "\\.[^.]*$", "", fname )
>
>fwiw, i almost always use '[.]' in preference to '\\\\\\\\.', as it
>seems to be more likely to get through the various levels of quoting in
>different contexts.

-- 
Sent from my phone. Please excuse my brevity.


From drj|m|emon @end|ng |rom gm@||@com  Thu Jul  8 12:08:25 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Thu, 8 Jul 2021 20:08:25 +1000
Subject: [R] How to estimate the parameter for many variable?
In-Reply-To: <CALcx2Bm+Py5Asc7KT+-2x6mW0j5zO6YNKBFktsn4usjjXAz7DQ@mail.gmail.com>
References: <CALcx2Bm+Py5Asc7KT+-2x6mW0j5zO6YNKBFktsn4usjjXAz7DQ@mail.gmail.com>
Message-ID: <CA+8X3fXYdQcDU-L9f2bHUuutrg=c1boAON++dX2_eVPrzBzHwA@mail.gmail.com>

Hi Siti,
I think we need a bit more information to respond helpfully. I have no
idea what "Ozone_weekly2" is and Google is also ignorant. "gev.fit" is
also unknown. The name suggests that it is the output of some
regression or similar. What function produced it, and from what
library? "ti" is known as you have defined it. However, I don't know
what you want to do with it. Finally, as this is a text mailing list,
we don't get any highlighting, so the text to which you refer cannot
be identified. I can see you have a problem, but cannot offer any help
right now.

Jim

On Thu, Jul 8, 2021 at 12:06 AM SITI AISYAH ZAKARIA
<aisyahzakaria at unimap.edu.my> wrote:
>
> Dear all,
>
> Can I ask something about programming in marginal distribution for spatial
> extreme?
> I really stuck on my coding to obtain the parameter estimation for
> univariate or marginal distribution for new model in spatial extreme.
>
> I want to run my data in order to get the parameter estimation value for 25
> stations in one table. But I really didn't get the idea of the correct
> coding. Here I attached my coding
>
> x <- data.matrix(Ozone_weekly2)
> x
> head(gev.fit)[1:4]
> ti = matrix(ncol = 3, nrow = 888)
> ti[,1] = seq(1, 888, 1)
> ti[,2]=sin(2*pi*(ti[,1])/52)
> ti[,3]=cos(2*pi*(ti[,1])/52)
> for(i in 1:nrow(x))
>   + { for(j in 1:ncol(x))
>     + {x[i,j] = 1}}
>
> My problem is highlighted in red color.
> And if are not hesitate to all. Can someone share with me the procedure,
> how can I map my data using spatial extreme.
> For example:
> After I finish my marginal distribution, what the next procedure. It is I
> need to get the spatial independent value.
>
> That's all
> Thank you.
>
> --
>
>
>
>
>
> "..Millions of trees are used to make papers, only to be thrown away
> after a couple of minutes reading from them. Our planet is at stake. Please
> be considerate. THINK TWICE BEFORE PRINTING THIS.."
>
> DISCLAIMER: This email \ and any files transmitte...{{dropped:24}}
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Jul  8 12:40:17 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 8 Jul 2021 11:40:17 +0100
Subject: [R] How to estimate the parameter for many variable?
In-Reply-To: <CA+8X3fXYdQcDU-L9f2bHUuutrg=c1boAON++dX2_eVPrzBzHwA@mail.gmail.com>
References: <CALcx2Bm+Py5Asc7KT+-2x6mW0j5zO6YNKBFktsn4usjjXAz7DQ@mail.gmail.com>
 <CA+8X3fXYdQcDU-L9f2bHUuutrg=c1boAON++dX2_eVPrzBzHwA@mail.gmail.com>
Message-ID: <b2c1d82b-0c0e-f639-fd32-dcafce055ef3@sapo.pt>

Hello,

Also, in the code

x <- data.matrix(Ozone_weekly)

[...omited...]

for(i in 1:nrow(x))
   + { for(j in 1:ncol(x))
     + {x[i,j] = 1}}

not only you rewrite x but the double for loop is equivalent to


x[] <- 1


courtesy R's vectorised behavior. (The square parenthesis are needed to 
keep the dimensions, the matrix form.)
And, I'm not sure but isn't

head(gev.fit)[1:4]

equivalent to

head(gev.fit, n = 4)

?

Like Jim says, we need more information, can you post Ozone_weekly2 and 
the code that produced gev.fit? But in the mean time you can revise your 
code.

Hope this helps,

Rui Barradas


?s 11:08 de 08/07/21, Jim Lemon escreveu:
> Hi Siti,
> I think we need a bit more information to respond helpfully. I have no
> idea what "Ozone_weekly2" is and Google is also ignorant. "gev.fit" is
> also unknown. The name suggests that it is the output of some
> regression or similar. What function produced it, and from what
> library? "ti" is known as you have defined it. However, I don't know
> what you want to do with it. Finally, as this is a text mailing list,
> we don't get any highlighting, so the text to which you refer cannot
> be identified. I can see you have a problem, but cannot offer any help
> right now.
> 
> Jim
> 
> On Thu, Jul 8, 2021 at 12:06 AM SITI AISYAH ZAKARIA
> <aisyahzakaria at unimap.edu.my> wrote:
>>
>> Dear all,
>>
>> Can I ask something about programming in marginal distribution for spatial
>> extreme?
>> I really stuck on my coding to obtain the parameter estimation for
>> univariate or marginal distribution for new model in spatial extreme.
>>
>> I want to run my data in order to get the parameter estimation value for 25
>> stations in one table. But I really didn't get the idea of the correct
>> coding. Here I attached my coding
>>
>> x <- data.matrix(Ozone_weekly2)
>> x
>> head(gev.fit)[1:4]
>> ti = matrix(ncol = 3, nrow = 888)
>> ti[,1] = seq(1, 888, 1)
>> ti[,2]=sin(2*pi*(ti[,1])/52)
>> ti[,3]=cos(2*pi*(ti[,1])/52)
>> for(i in 1:nrow(x))
>>    + { for(j in 1:ncol(x))
>>      + {x[i,j] = 1}}
>>
>> My problem is highlighted in red color.
>> And if are not hesitate to all. Can someone share with me the procedure,
>> how can I map my data using spatial extreme.
>> For example:
>> After I finish my marginal distribution, what the next procedure. It is I
>> need to get the spatial independent value.
>>
>> That's all
>> Thank you.
>>
>> --
>>
>>
>>
>>
>>
>> "..Millions of trees are used to make papers, only to be thrown away
>> after a couple of minutes reading from them. Our planet is at stake. Please
>> be considerate. THINK TWICE BEFORE PRINTING THIS.."
>>
>> DISCLAIMER: This email \ and any files transmitte...{{dropped:24}}
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From y@ngk@|9999 @end|ng |rom y@hoo@com  Thu Jul  8 17:24:25 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Thu, 8 Jul 2021 15:24:25 +0000 (UTC)
Subject: [R] problem for strsplit function
In-Reply-To: <537799.1625722603@apollo2.minshall.org>
References: <F7085740-6A14-4686-8179-D8DB8536EB11@dcn.davis.ca.us>
 <537799.1625722603@apollo2.minshall.org>
Message-ID: <762548966.2994133.1625757865539@mail.yahoo.com>

 Hello all,
I have to learning R from beginning, since my group will get rid of SAS. So, my question may not be very clear for professional R user. I always dealing with column in data frame, not data vector.?
Many thanks to Greg's example. it is very helpful.
one more question, how can I know if the function is for column manipulations or for vector?
Thank you,
Kai
    On Wednesday, July 7, 2021, 10:36:53 PM PDT, Greg Minshall <minshall at umich.edu> wrote:  
 
 > sub( "\\.[^.]*$", "", fname )

fwiw, i almost always use '[.]' in preference to '\\\\\\\\.', as it
seems to be more likely to get through the various levels of quoting in
different contexts.
  
	[[alternative HTML version deleted]]


From |@r@hn@z@t@gh@v| @end|ng |rom gm@||@com  Tue Jul  6 22:52:38 2021
From: |@r@hn@z@t@gh@v| @end|ng |rom gm@||@com (Farrah T)
Date: Tue, 6 Jul 2021 13:52:38 -0700
Subject: [R] MAC version 10
Message-ID: <3C84266E-8355-4817-841A-808F3FFE0487@icloud.com>

Hello, 

I have Mac Version 10 Catalina and I would like to download R on this device for my summer class. I have difficulty to find a right option when I go to the website. May you please kindly share the step by step guidance with me. The screenshot with be great. I downloaded few zip files and yet didn?t know how to follow after that step neither. Looking forward to hearing from your side. 

Best, 
Fararh

From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Thu Jul  8 20:23:51 2021
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Thu, 8 Jul 2021 13:23:51 -0500
Subject: [R] MAC version 10
In-Reply-To: <3C84266E-8355-4817-841A-808F3FFE0487@icloud.com>
References: <3C84266E-8355-4817-841A-808F3FFE0487@icloud.com>
Message-ID: <26d80fc0-a4e8-71a2-359a-c439977a0563@effectivedefense.org>

	  What web site did you go to?  Have you tried:


https://cran.r-project.org/bin/macosx/


	  Then click on "R-4.1.0.pkg".  That should download as normal.  Then 
double click on that, etc.


	  Spencer Graves


On 7/6/21 3:52 PM, Farrah T wrote:
> Hello,
> 
> I have Mac Version 10 Catalina and I would like to download R on this device for my summer class. I have difficulty to find a right option when I go to the website. May you please kindly share the step by step guidance with me. The screenshot with be great. I downloaded few zip files and yet didn?t know how to follow after that step neither. Looking forward to hearing from your side.
> 
> Best,
> Fararh
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From bgunter@4567 @end|ng |rom gm@||@com  Thu Jul  8 20:27:46 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 8 Jul 2021 11:27:46 -0700
Subject: [R] MAC version 10
In-Reply-To: <3C84266E-8355-4817-841A-808F3FFE0487@icloud.com>
References: <3C84266E-8355-4817-841A-808F3FFE0487@icloud.com>
Message-ID: <CAGxFJbRBg4DtJs-f2XWVfLu5t1DFDabOZ7ZyzCBSoOpH5rB6Cw@mail.gmail.com>

If the below is not helpful, post on r-sig-mac rather than here.

You should be able to download and install a precompiled binary (no
zip files to unzip and compile) from here:
https://cran.r-project.org/

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Thu, Jul 8, 2021 at 11:19 AM Farrah T <farahnaz.taghavi at gmail.com> wrote:
>
> Hello,
>
> I have Mac Version 10 Catalina and I would like to download R on this device for my summer class. I have difficulty to find a right option when I go to the website. May you please kindly share the step by step guidance with me. The screenshot with be great. I downloaded few zip files and yet didn?t know how to follow after that step neither. Looking forward to hearing from your side.
>
> Best,
> Fararh
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From jhunter @end|ng |rom |deve|opment@|n|o  Fri Jul  9 00:28:15 2021
From: jhunter @end|ng |rom |deve|opment@|n|o (Jeffrey Hunter)
Date: Thu, 8 Jul 2021 18:28:15 -0400
Subject: [R] MAC version 10
In-Reply-To: <3C84266E-8355-4817-841A-808F3FFE0487@icloud.com>
References: <3C84266E-8355-4817-841A-808F3FFE0487@icloud.com>
Message-ID: <383C7D2A-52A9-42AC-9B3E-B079E547DBF4@idevelopment.info>

Hello:

https://cran.r-project.org/bin/macosx/

Download the R-4.1.0.pkg and install it as you would any macOS app.

~jeff

Jeffrey M. Hunter
Sr. DBA, Mathematics Programmer, Author
jhunter at idevelopment.info

A computer without a Microsoft operating system is like a dog without bricks tied to its head.

God rot Windows and all its ugly, clunky, badly-designed horror.

> On Jul 8, 2021, at 2:19 PM, Farrah T <farahnaz.taghavi at gmail.com> wrote:
> 
> ?Hello, 
> 
> I have Mac Version 10 Catalina and I would like to download R on this device for my summer class. I have difficulty to find a right option when I go to the website. May you please kindly share the step by step guidance with me. The screenshot with be great. I downloaded few zip files and yet didn?t know how to follow after that step neither. Looking forward to hearing from your side. 
> 
> Best, 
> Fararh
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From drj|m|emon @end|ng |rom gm@||@com  Fri Jul  9 08:14:49 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Fri, 9 Jul 2021 16:14:49 +1000
Subject: [R] How to estimate the parameter for many variable?
In-Reply-To: <CALcx2B=MrCSv0J9Jxtibe4U3tUGyiBZiKrpz_FrctpMWbgrE3w@mail.gmail.com>
References: <CALcx2Bm+Py5Asc7KT+-2x6mW0j5zO6YNKBFktsn4usjjXAz7DQ@mail.gmail.com>
 <CA+8X3fXYdQcDU-L9f2bHUuutrg=c1boAON++dX2_eVPrzBzHwA@mail.gmail.com>
 <b2c1d82b-0c0e-f639-fd32-dcafce055ef3@sapo.pt>
 <CALcx2B=MrCSv0J9Jxtibe4U3tUGyiBZiKrpz_FrctpMWbgrE3w@mail.gmail.com>
Message-ID: <CA+8X3fV8Y3Qrd7ZsZvSGE-h_LCMu-3DNDXxjP4-5ebBG7h8v_w@mail.gmail.com>

Hi Siti,
I think some progress has been made. You have a data set with 888 rows
and 19 columns:

ow2<-read.table("Ozone_weekly2.txt",
  header=TRUE)
dim(ow2)
[1] 888  19

The values may be parts per million ozone in the atmosphere. The
columns may represent different measuring locations and my guess is
that rows are times of measurement, perhaps in weeks given the name.
If so, you might have run ismev::gev.fit() on all of the columns,
looking for estimated maxima at each location. Is this at all close to
what you are doing?

Jim

On Fri, Jul 9, 2021 at 9:59 AM SITI AISYAH ZAKARIA
<aisyahzakaria at unimap.edu.my> wrote:
>
> Dear all,
>
> Thank you very much for the feedback.
>
> Sorry for the lack of information about this problem.
>
> Here, I explain again.
>
> I use this package to run my coding.
>
> library(ismev)
> library(mgcv)
> library(nlme)
>
> The purpose of this is I want to get the value of parameter estimation using MLE by applying the GEV distribution.
>
> x <- data.matrix(Ozone_weekly2)                      x refers to my data that consists of 19 variables. I will attach the data together.
> x
> head(gev.fit)[1:4]
> ti = matrix(ncol = 3, nrow = 888)
> ti[,1] = seq(1, 888, 1)
> ti[,2]=sin(2*pi*(ti[,1])/52)
> ti[,3]=cos(2*pi*(ti[,1])/52)
>
> for(i in 1:nrow(x))
>   + { for(j in 1:ncol(x))                            the problem in here, i don't no to create the coding. i target my output will come out in matrix that
>     + {x[i,j] = 1}}                                       show the parameter estimation for 19 variable which have 19 row and 3 column
>                                                               row -- refer to variable (station)  ; column -- refer to parameter estimation for GEV distribution
>
> thank you.
>
> On Thu, 8 Jul 2021 at 18:40, Rui Barradas <ruipbarradas at sapo.pt> wrote:
>>
>> Hello,
>>
>> Also, in the code
>>
>> x <- data.matrix(Ozone_weekly)
>>
>> [...omited...]
>>
>> for(i in 1:nrow(x))
>>    + { for(j in 1:ncol(x))
>>      + {x[i,j] = 1}}
>>
>> not only you rewrite x but the double for loop is equivalent to
>>
>>
>> x[] <- 1
>>
>>
>> courtesy R's vectorised behavior. (The square parenthesis are needed to
>> keep the dimensions, the matrix form.)
>> And, I'm not sure but isn't
>>
>> head(gev.fit)[1:4]
>>
>> equivalent to
>>
>> head(gev.fit, n = 4)
>>
>> ?
>>
>> Like Jim says, we need more information, can you post Ozone_weekly2 and
>> the code that produced gev.fit? But in the mean time you can revise your
>> code.
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>>
>> ?s 11:08 de 08/07/21, Jim Lemon escreveu:
>> > Hi Siti,
>> > I think we need a bit more information to respond helpfully. I have no
>> > idea what "Ozone_weekly2" is and Google is also ignorant. "gev.fit" is
>> > also unknown. The name suggests that it is the output of some
>> > regression or similar. What function produced it, and from what
>> > library? "ti" is known as you have defined it. However, I don't know
>> > what you want to do with it. Finally, as this is a text mailing list,
>> > we don't get any highlighting, so the text to which you refer cannot
>> > be identified. I can see you have a problem, but cannot offer any help
>> > right now.
>> >
>> > Jim
>> >
>> > On Thu, Jul 8, 2021 at 12:06 AM SITI AISYAH ZAKARIA
>> > <aisyahzakaria at unimap.edu.my> wrote:
>> >>
>> >> Dear all,
>> >>
>> >> Can I ask something about programming in marginal distribution for spatial
>> >> extreme?
>> >> I really stuck on my coding to obtain the parameter estimation for
>> >> univariate or marginal distribution for new model in spatial extreme.
>> >>
>> >> I want to run my data in order to get the parameter estimation value for 25
>> >> stations in one table. But I really didn't get the idea of the correct
>> >> coding. Here I attached my coding
>> >>
>> >> x <- data.matrix(Ozone_weekly2)
>> >> x
>> >> head(gev.fit)[1:4]
>> >> ti = matrix(ncol = 3, nrow = 888)
>> >> ti[,1] = seq(1, 888, 1)
>> >> ti[,2]=sin(2*pi*(ti[,1])/52)
>> >> ti[,3]=cos(2*pi*(ti[,1])/52)
>> >> for(i in 1:nrow(x))
>> >>    + { for(j in 1:ncol(x))
>> >>      + {x[i,j] = 1}}
>> >>
>> >> My problem is highlighted in red color.
>> >> And if are not hesitate to all. Can someone share with me the procedure,
>> >> how can I map my data using spatial extreme.
>> >> For example:
>> >> After I finish my marginal distribution, what the next procedure. It is I
>> >> need to get the spatial independent value.
>> >>
>> >> That's all
>> >> Thank you.
>> >>
>> >> --
>> >>
>> >>
>> >>
>> >>
>> >>
>> >> "..Millions of trees are used to make papers, only to be thrown away
>> >> after a couple of minutes reading from them. Our planet is at stake. Please
>> >> be considerate. THINK TWICE BEFORE PRINTING THIS.."
>> >>
>> >> DISCLAIMER: This email \ and any files transmitte...{{dropped:24}}
>> >>
>> >> ______________________________________________
>> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> >> https://stat.ethz.ch/mailman/listinfo/r-help
>> >> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> >> and provide commented, minimal, self-contained, reproducible code.
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>> >
>
>
>
> "..Millions of trees are used to make papers, only to be thrown away after a couple of minutes reading from them. Our planet is at stake. Please be considerate. THINK TWICE BEFORE PRINTING THIS.."
>
> DISCLAIMER: This email and any files transmitted with it are confidential and intended solely for the use of the individual orentity to whom they are addressed. If you have received this email in error please notify the UniMAP's Email Administrator. Please note that any views or opinions presented in this email are solely those of the author and do not necessarily represent those of the university. Finally, the recipient should check this email and any attachments for the presence of viruses.The university accepts no liability for any damage caused by any virus transmitted by this email.
>
> Universiti Malaysia Perlis (UniMAP) | Digital Management & Development Centre (DMDC), Universiti Malaysia Perlis (UniMAP), Pauh Putra Campus, 02600 Arau, Perlis, MALAYSIA | www.unimap.edu.my


From @|@y@hz@k@r|@ @end|ng |rom un|m@p@edu@my  Fri Jul  9 01:59:21 2021
From: @|@y@hz@k@r|@ @end|ng |rom un|m@p@edu@my (SITI AISYAH ZAKARIA)
Date: Fri, 9 Jul 2021 07:59:21 +0800
Subject: [R] How to estimate the parameter for many variable?
In-Reply-To: <b2c1d82b-0c0e-f639-fd32-dcafce055ef3@sapo.pt>
References: <CALcx2Bm+Py5Asc7KT+-2x6mW0j5zO6YNKBFktsn4usjjXAz7DQ@mail.gmail.com>
 <CA+8X3fXYdQcDU-L9f2bHUuutrg=c1boAON++dX2_eVPrzBzHwA@mail.gmail.com>
 <b2c1d82b-0c0e-f639-fd32-dcafce055ef3@sapo.pt>
Message-ID: <CALcx2B=MrCSv0J9Jxtibe4U3tUGyiBZiKrpz_FrctpMWbgrE3w@mail.gmail.com>

Dear all,

Thank you very much for the feedback.

Sorry for the lack of information about this problem.

Here, I explain again.

I use this package to run my coding.

library(ismev)
library(mgcv)
library(nlme)

The purpose of this is I want to get the value of parameter estimation
using MLE by applying the GEV distribution.

x <- data.matrix(Ozone_weekly2)                      x refers to my data
that consists of 19 variables. I will attach the data together.
x
head(gev.fit)[1:4]
ti = matrix(ncol = 3, nrow = 888)
ti[,1] = seq(1, 888, 1)
ti[,2]=sin(2*pi*(ti[,1])/52)
ti[,3]=cos(2*pi*(ti[,1])/52)



*for(i in 1:nrow(x))  + { for(j in 1:ncol(x))
the problem in here, i don't no to create the coding. i target my
output will come out in matrix that     + {x[i,j] = 1}}
                   show the parameter estimation for 19 variable which have
19 row and 3 column*


*                                                              row -- refer
to variable (station)  ; column -- refer to parameter estimation for GEV
distribution*thank you.

On Thu, 8 Jul 2021 at 18:40, Rui Barradas <ruipbarradas at sapo.pt> wrote:

> Hello,
>
> Also, in the code
>
> x <- data.matrix(Ozone_weekly)
>
> [...omited...]
>
> for(i in 1:nrow(x))
>    + { for(j in 1:ncol(x))
>      + {x[i,j] = 1}}
>
> not only you rewrite x but the double for loop is equivalent to
>
>
> x[] <- 1
>
>
> courtesy R's vectorised behavior. (The square parenthesis are needed to
> keep the dimensions, the matrix form.)
> And, I'm not sure but isn't
>
> head(gev.fit)[1:4]
>
> equivalent to
>
> head(gev.fit, n = 4)
>
> ?
>
> Like Jim says, we need more information, can you post Ozone_weekly2 and
> the code that produced gev.fit? But in the mean time you can revise your
> code.
>
> Hope this helps,
>
> Rui Barradas
>
>
> ?s 11:08 de 08/07/21, Jim Lemon escreveu:
> > Hi Siti,
> > I think we need a bit more information to respond helpfully. I have no
> > idea what "Ozone_weekly2" is and Google is also ignorant. "gev.fit" is
> > also unknown. The name suggests that it is the output of some
> > regression or similar. What function produced it, and from what
> > library? "ti" is known as you have defined it. However, I don't know
> > what you want to do with it. Finally, as this is a text mailing list,
> > we don't get any highlighting, so the text to which you refer cannot
> > be identified. I can see you have a problem, but cannot offer any help
> > right now.
> >
> > Jim
> >
> > On Thu, Jul 8, 2021 at 12:06 AM SITI AISYAH ZAKARIA
> > <aisyahzakaria at unimap.edu.my> wrote:
> >>
> >> Dear all,
> >>
> >> Can I ask something about programming in marginal distribution for
> spatial
> >> extreme?
> >> I really stuck on my coding to obtain the parameter estimation for
> >> univariate or marginal distribution for new model in spatial extreme.
> >>
> >> I want to run my data in order to get the parameter estimation value
> for 25
> >> stations in one table. But I really didn't get the idea of the correct
> >> coding. Here I attached my coding
> >>
> >> x <- data.matrix(Ozone_weekly2)
> >> x
> >> head(gev.fit)[1:4]
> >> ti = matrix(ncol = 3, nrow = 888)
> >> ti[,1] = seq(1, 888, 1)
> >> ti[,2]=sin(2*pi*(ti[,1])/52)
> >> ti[,3]=cos(2*pi*(ti[,1])/52)
> >> for(i in 1:nrow(x))
> >>    + { for(j in 1:ncol(x))
> >>      + {x[i,j] = 1}}
> >>
> >> My problem is highlighted in red color.
> >> And if are not hesitate to all. Can someone share with me the procedure,
> >> how can I map my data using spatial extreme.
> >> For example:
> >> After I finish my marginal distribution, what the next procedure. It is
> I
> >> need to get the spatial independent value.
> >>
> >> That's all
> >> Thank you.
> >>
> >> --
> >>
> >>
> >>
> >>
> >>
> >> "..Millions of trees are used to make papers, only to be thrown away
> >> after a couple of minutes reading from them. Our planet is at stake.
> Please
> >> be considerate. THINK TWICE BEFORE PRINTING THIS.."
> >>
> >> DISCLAIMER: This email \ and any files transmitte...{{dropped:24}}
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>

-- 





"..Millions of trees are used to make papers, only to be thrown away 
after a couple of minutes reading from them. Our planet is at stake. Please 
be considerate. THINK TWICE BEFORE PRINTING THIS.."

DISCLAIMER:?This email 
and any files transmitted with it are confidential and intended solely for 
the use of the individual orentity to whom they are addressed. If you have 
received this email in error please notify the UniMAP's Email 
Administrator. Please note that any views or opinions presented in this 
email are solely those of the author and do not necessarily represent those 
of the university. Finally, the recipient should check this email and any 
attachments for the presence of viruses.The university accepts no liability 
for any damage caused by any virus transmitted by this email.

Universiti 
Malaysia Perlis (UniMAP) | Digital Management & Development Centre (DMDC), 
Universiti Malaysia Perlis (UniMAP), Pauh Putra Campus, 02600 Arau, Perlis, 
MALAYSIA |?www.unimap.edu.my <http://www.unimap.edu.my/>

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: Ozone_weekly2.txt
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20210709/1038141e/attachment.txt>

From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Fri Jul  9 08:38:00 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Fri, 9 Jul 2021 07:38:00 +0100
Subject: [R] How to estimate the parameter for many variable?
In-Reply-To: <CALcx2B=MrCSv0J9Jxtibe4U3tUGyiBZiKrpz_FrctpMWbgrE3w@mail.gmail.com>
References: <CALcx2Bm+Py5Asc7KT+-2x6mW0j5zO6YNKBFktsn4usjjXAz7DQ@mail.gmail.com>
 <CA+8X3fXYdQcDU-L9f2bHUuutrg=c1boAON++dX2_eVPrzBzHwA@mail.gmail.com>
 <b2c1d82b-0c0e-f639-fd32-dcafce055ef3@sapo.pt>
 <CALcx2B=MrCSv0J9Jxtibe4U3tUGyiBZiKrpz_FrctpMWbgrE3w@mail.gmail.com>
Message-ID: <5c44967a-2d2e-7dae-d96e-b86dcb772358@sapo.pt>

Hello,

The following lapply one-liner fits a GEV to each column vector, there 
is no need for the double for loop. There's also no need to create a 
data set x.


library(ismev)
library(mgcv)
library(EnvStats)

Ozone_weekly2 <- read.table("~/tmp/Ozone_weekly2.txt", header = TRUE)

# fit a GEV to each column
gev_fit_list <- lapply(Ozone_weekly2, gev.fit, show = FALSE)

# extract the parameters MLE estimates
mle_params <- t(sapply(gev_fit_list, '[[', 'mle'))

# assign column names
colnames(mle_params) <- c("location", "scale", "shape")

# see first few rows
head(mle_params)



The OP doesn't ask for plots but, here they go.


y_vals <- function(x, params){
   loc <- params[1]
   scale <- params[2]
   shape <- params[3]
   EnvStats::dgevd(x, loc, scale, shape)
}
plot_fit <- function(data, vec, verbose = FALSE){
   fit <- gev.fit(data[[vec]], show = verbose)
   x <- sort(data[[vec]])
   hist(x, freq = FALSE)
   lines(x, y_vals(x, params = fit$mle))
}

# seems a good fit
plot_fit(Ozone_weekly2, 1)       # column number
plot_fit(Ozone_weekly2, "CA01")  # col name, equivalent

# the data seems gaussian, not a good fit
plot_fit(Ozone_weekly2, 4)       # column number
plot_fit(Ozone_weekly2, "CA08")  # col name, equivalent



Hope this helps,

Rui Barradas


?s 00:59 de 09/07/21, SITI AISYAH ZAKARIA escreveu:
> Dear all,
> 
> Thank you very?much for the feedback.
> 
> Sorry for the lack of information about this problem.
> 
> Here, I explain?again.
> 
> I use this package to run my coding.
> 
> library(ismev)
> library(mgcv)
> library(nlme)
> 
> The purpose?of this is I want to get the value of parameter estimation 
> using MLE by applying?the GEV distribution.
> 
> x <- data.matrix(Ozone_weekly2)? ? ? ? ? ? ? ? ? ? ? x refers to my data 
> that consists of 19 variables. I will attach the data together.
> x
> head(gev.fit)[1:4]
> ti = matrix(ncol = 3, nrow = 888)
> ti[,1] = seq(1, 888, 1)
> ti[,2]=sin(2*pi*(ti[,1])/52)
> ti[,3]=cos(2*pi*(ti[,1])/52)
> 
> /for(i in 1:nrow(x))
>  ? + { for(j in 1:ncol(x))? ? ? ? ? ? ? ? ? ? ? ? ? ? the problem in 
> here, i don't no to create the coding. i target my output?will come out 
> in matrix that
>  ? ? + {x[i,j] = 1}}? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?show the 
> parameter estimation for 19 variable which have 19 row and 3 column/
> /? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? row -- 
> refer to variable (station)? ; column -- refer to parameter estimation 
> for GEV distribution
> 
> /thank you.
> 
> On Thu, 8 Jul 2021 at 18:40, Rui Barradas <ruipbarradas at sapo.pt 
> <mailto:ruipbarradas at sapo.pt>> wrote:
> 
>     Hello,
> 
>     Also, in the code
> 
>     x <- data.matrix(Ozone_weekly)
> 
>     [...omited...]
> 
>     for(i in 1:nrow(x))
>      ? ?+ { for(j in 1:ncol(x))
>      ? ? ?+ {x[i,j] = 1}}
> 
>     not only you rewrite x but the double for loop is equivalent to
> 
> 
>     x[] <- 1
> 
> 
>     courtesy R's vectorised behavior. (The square parenthesis are needed to
>     keep the dimensions, the matrix form.)
>     And, I'm not sure but isn't
> 
>     head(gev.fit)[1:4]
> 
>     equivalent to
> 
>     head(gev.fit, n = 4)
> 
>     ?
> 
>     Like Jim says, we need more information, can you post Ozone_weekly2 and
>     the code that produced gev.fit? But in the mean time you can revise
>     your
>     code.
> 
>     Hope this helps,
> 
>     Rui Barradas
> 
> 
>     ?s 11:08 de 08/07/21, Jim Lemon escreveu:
>      > Hi Siti,
>      > I think we need a bit more information to respond helpfully. I
>     have no
>      > idea what "Ozone_weekly2" is and Google is also ignorant.
>     "gev.fit" is
>      > also unknown. The name suggests that it is the output of some
>      > regression or similar. What function produced it, and from what
>      > library? "ti" is known as you have defined it. However, I don't know
>      > what you want to do with it. Finally, as this is a text mailing list,
>      > we don't get any highlighting, so the text to which you refer cannot
>      > be identified. I can see you have a problem, but cannot offer any
>     help
>      > right now.
>      >
>      > Jim
>      >
>      > On Thu, Jul 8, 2021 at 12:06 AM SITI AISYAH ZAKARIA
>      > <aisyahzakaria at unimap.edu.my
>     <mailto:aisyahzakaria at unimap.edu.my>> wrote:
>      >>
>      >> Dear all,
>      >>
>      >> Can I ask something about programming in marginal distribution
>     for spatial
>      >> extreme?
>      >> I really stuck on my coding to obtain the parameter estimation for
>      >> univariate or marginal distribution for new model in spatial
>     extreme.
>      >>
>      >> I want to run my data in order to get the parameter estimation
>     value for 25
>      >> stations in one table. But I really didn't get the idea of the
>     correct
>      >> coding. Here I attached my coding
>      >>
>      >> x <- data.matrix(Ozone_weekly2)
>      >> x
>      >> head(gev.fit)[1:4]
>      >> ti = matrix(ncol = 3, nrow = 888)
>      >> ti[,1] = seq(1, 888, 1)
>      >> ti[,2]=sin(2*pi*(ti[,1])/52)
>      >> ti[,3]=cos(2*pi*(ti[,1])/52)
>      >> for(i in 1:nrow(x))
>      >>? ? + { for(j in 1:ncol(x))
>      >>? ? ? + {x[i,j] = 1}}
>      >>
>      >> My problem is highlighted in red color.
>      >> And if are not hesitate to all. Can someone share with me the
>     procedure,
>      >> how can I map my data using spatial extreme.
>      >> For example:
>      >> After I finish my marginal distribution, what the next
>     procedure. It is I
>      >> need to get the spatial independent value.
>      >>
>      >> That's all
>      >> Thank you.
>      >>
>      >> --
>      >>
>      >>
>      >>
>      >>
>      >>
>      >> "..Millions of trees are used to make papers, only to be thrown away
>      >> after a couple of minutes reading from them. Our planet is at
>     stake. Please
>      >> be considerate. THINK TWICE BEFORE PRINTING THIS.."
>      >>
>      >> DISCLAIMER: This email \ and any files transmitte...{{dropped:24}}
>      >>
>      >> ______________________________________________
>      >> R-help at r-project.org <mailto:R-help at r-project.org> mailing list
>     -- To UNSUBSCRIBE and more, see
>      >> https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>      >> PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>      >> and provide commented, minimal, self-contained, reproducible code.
>      >
>      > ______________________________________________
>      > R-help at r-project.org <mailto:R-help at r-project.org> mailing list
>     -- To UNSUBSCRIBE and more, see
>      > https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>      > PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>      > and provide commented, minimal, self-contained, reproducible code.
>      >
> 
> 
> 
> "..Millions of trees are used to make papers, only to be thrown away 
> after a couple of minutes reading from them. Our planet is at stake. 
> Please be considerate. THINK TWICE BEFORE PRINTING THIS.."
> 
> *DISCLAIMER:*?This email and any files transmitted with it are 
> confidential and intended solely for the use of the individual orentity 
> to whom they are addressed. If you have received this email in error 
> please notify the UniMAP's Email Administrator. Please note that any 
> views or opinions presented in this email are solely those of the author 
> and do not necessarily represent those of the university. Finally, the 
> recipient should check this email and any attachments for the presence 
> of viruses.The university accepts no liability for any damage caused by 
> any virus transmitted by this email.
> 
> Universiti Malaysia Perlis (UniMAP) | Digital Management & Development 
> Centre (DMDC), Universiti Malaysia Perlis (UniMAP), Pauh Putra Campus, 
> 02600 Arau, Perlis, MALAYSIA | www.unimap.edu.my <http://www.unimap.edu.my/>
>


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Fri Jul  9 11:18:29 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Fri, 9 Jul 2021 10:18:29 +0100
Subject: [R] How to estimate the parameter for many variable?
In-Reply-To: <CALcx2B=Zz=TxZGk=s=YWbdXdHh8rmaXyEiUmSE7DRou06USy9A@mail.gmail.com>
References: <CALcx2Bm+Py5Asc7KT+-2x6mW0j5zO6YNKBFktsn4usjjXAz7DQ@mail.gmail.com>
 <CA+8X3fXYdQcDU-L9f2bHUuutrg=c1boAON++dX2_eVPrzBzHwA@mail.gmail.com>
 <b2c1d82b-0c0e-f639-fd32-dcafce055ef3@sapo.pt>
 <CALcx2B=MrCSv0J9Jxtibe4U3tUGyiBZiKrpz_FrctpMWbgrE3w@mail.gmail.com>
 <5c44967a-2d2e-7dae-d96e-b86dcb772358@sapo.pt>
 <CALcx2B=Zz=TxZGk=s=YWbdXdHh8rmaXyEiUmSE7DRou06USy9A@mail.gmail.com>
Message-ID: <f010d7e9-664d-0621-a253-791b26f54b5d@sapo.pt>

Hello,

With the condition for the location it can be estimated like the following.


fit_list2 <- gev_fit_list <- lapply(Ozone_weekly2, gev.fit, ydat = ti, 
mul = c(2, 3), show = FALSE)
mle_params2 <- t(sapply(fit_list2, '[[', 'mle'))
# assign column names
colnames(mle_params2) <- c("location", "scale", "shape", "mul2", "mul3")
head(mle_params2)


Hope this helps,

Rui Barradas

?s 09:53 de 09/07/21, SITI AISYAH ZAKARIA escreveu:
> Dear Rui ang Jim,
> 
> Thank you very much.
> 
> Thank you Rui Barradas, I already tried using your coding and I'm 
> grateful I got the answer.
> 
> ok now, I have some condition on the location parameter which is cyclic 
> condition.
> 
> So, I will add another 2 variables for the column.
> 
> and the condition for location is this one.
> 
>  ?ti[,1] = seq(1, 888, 1)
>  ? ti[,2]=sin(2*pi*(ti[,1])/52)
>  ? ti[,3]=cos(2*pi*(ti[,1])/52)
>  ? fit0<-gev.fit(x[,i], ydat = ti, mul=c(2, 3))
> 
> Thank you again.
> 
> On Fri, 9 Jul 2021 at 14:38, Rui Barradas <ruipbarradas at sapo.pt 
> <mailto:ruipbarradas at sapo.pt>> wrote:
> 
>     Hello,
> 
>     The following lapply one-liner fits a GEV to each column vector, there
>     is no need for the double for loop. There's also no need to create a
>     data set x.
> 
> 
>     library(ismev)
>     library(mgcv)
>     library(EnvStats)
> 
>     Ozone_weekly2 <- read.table("~/tmp/Ozone_weekly2.txt", header = TRUE)
> 
>     # fit a GEV to each column
>     gev_fit_list <- lapply(Ozone_weekly2, gev.fit, show = FALSE)
> 
>     # extract the parameters MLE estimates
>     mle_params <- t(sapply(gev_fit_list, '[[', 'mle'))
> 
>     # assign column names
>     colnames(mle_params) <- c("location", "scale", "shape")
> 
>     # see first few rows
>     head(mle_params)
> 
> 
> 
>     The OP doesn't ask for plots but, here they go.
> 
> 
>     y_vals <- function(x, params){
>      ? ?loc <- params[1]
>      ? ?scale <- params[2]
>      ? ?shape <- params[3]
>      ? ?EnvStats::dgevd(x, loc, scale, shape)
>     }
>     plot_fit <- function(data, vec, verbose = FALSE){
>      ? ?fit <- gev.fit(data[[vec]], show = verbose)
>      ? ?x <- sort(data[[vec]])
>      ? ?hist(x, freq = FALSE)
>      ? ?lines(x, y_vals(x, params = fit$mle))
>     }
> 
>     # seems a good fit
>     plot_fit(Ozone_weekly2, 1)? ? ? ?# column number
>     plot_fit(Ozone_weekly2, "CA01")? # col name, equivalent
> 
>     # the data seems gaussian, not a good fit
>     plot_fit(Ozone_weekly2, 4)? ? ? ?# column number
>     plot_fit(Ozone_weekly2, "CA08")? # col name, equivalent
> 
> 
> 
>     Hope this helps,
> 
>     Rui Barradas
> 
> 
>     ?s 00:59 de 09/07/21, SITI AISYAH ZAKARIA escreveu:
>      > Dear all,
>      >
>      > Thank you very?much for the feedback.
>      >
>      > Sorry for the lack of information about this problem.
>      >
>      > Here, I explain?again.
>      >
>      > I use this package to run my coding.
>      >
>      > library(ismev)
>      > library(mgcv)
>      > library(nlme)
>      >
>      > The purpose?of this is I want to get the value of parameter
>     estimation
>      > using MLE by applying?the GEV distribution.
>      >
>      > x <- data.matrix(Ozone_weekly2)? ? ? ? ? ? ? ? ? ? ? x refers to
>     my data
>      > that consists of 19 variables. I will attach the data together.
>      > x
>      > head(gev.fit)[1:4]
>      > ti = matrix(ncol = 3, nrow = 888)
>      > ti[,1] = seq(1, 888, 1)
>      > ti[,2]=sin(2*pi*(ti[,1])/52)
>      > ti[,3]=cos(2*pi*(ti[,1])/52)
>      >
>      > /for(i in 1:nrow(x))
>      >? ? + { for(j in 1:ncol(x))? ? ? ? ? ? ? ? ? ? ? ? ? ? the problem in
>      > here, i don't no to create the coding. i target my output?will
>     come out
>      > in matrix that
>      >? ? ? + {x[i,j] = 1}}? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?show the
>      > parameter estimation for 19 variable which have 19 row and 3 column/
>      > /                                                             
>     row --
>      > refer to variable (station)? ; column -- refer to parameter
>     estimation
>      > for GEV distribution
>      >
>      > /thank you.
>      >
>      > On Thu, 8 Jul 2021 at 18:40, Rui Barradas <ruipbarradas at sapo.pt
>     <mailto:ruipbarradas at sapo.pt>
>      > <mailto:ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>>> wrote:
>      >
>      >? ? ?Hello,
>      >
>      >? ? ?Also, in the code
>      >
>      >? ? ?x <- data.matrix(Ozone_weekly)
>      >
>      >? ? ?[...omited...]
>      >
>      >? ? ?for(i in 1:nrow(x))
>      >? ? ? ? ?+ { for(j in 1:ncol(x))
>      >? ? ? ? ? ?+ {x[i,j] = 1}}
>      >
>      >? ? ?not only you rewrite x but the double for loop is equivalent to
>      >
>      >
>      >? ? ?x[] <- 1
>      >
>      >
>      >? ? ?courtesy R's vectorised behavior. (The square parenthesis are
>     needed to
>      >? ? ?keep the dimensions, the matrix form.)
>      >? ? ?And, I'm not sure but isn't
>      >
>      >? ? ?head(gev.fit)[1:4]
>      >
>      >? ? ?equivalent to
>      >
>      >? ? ?head(gev.fit, n = 4)
>      >
>      >? ? ??
>      >
>      >? ? ?Like Jim says, we need more information, can you post
>     Ozone_weekly2 and
>      >? ? ?the code that produced gev.fit? But in the mean time you can
>     revise
>      >? ? ?your
>      >? ? ?code.
>      >
>      >? ? ?Hope this helps,
>      >
>      >? ? ?Rui Barradas
>      >
>      >
>      >? ? ??s 11:08 de 08/07/21, Jim Lemon escreveu:
>      >? ? ? > Hi Siti,
>      >? ? ? > I think we need a bit more information to respond helpfully. I
>      >? ? ?have no
>      >? ? ? > idea what "Ozone_weekly2" is and Google is also ignorant.
>      >? ? ?"gev.fit" is
>      >? ? ? > also unknown. The name suggests that it is the output of some
>      >? ? ? > regression or similar. What function produced it, and from
>     what
>      >? ? ? > library? "ti" is known as you have defined it. However, I
>     don't know
>      >? ? ? > what you want to do with it. Finally, as this is a text
>     mailing list,
>      >? ? ? > we don't get any highlighting, so the text to which you
>     refer cannot
>      >? ? ? > be identified. I can see you have a problem, but cannot
>     offer any
>      >? ? ?help
>      >? ? ? > right now.
>      >? ? ? >
>      >? ? ? > Jim
>      >? ? ? >
>      >? ? ? > On Thu, Jul 8, 2021 at 12:06 AM SITI AISYAH ZAKARIA
>      >? ? ? > <aisyahzakaria at unimap.edu.my
>     <mailto:aisyahzakaria at unimap.edu.my>
>      >? ? ?<mailto:aisyahzakaria at unimap.edu.my
>     <mailto:aisyahzakaria at unimap.edu.my>>> wrote:
>      >? ? ? >>
>      >? ? ? >> Dear all,
>      >? ? ? >>
>      >? ? ? >> Can I ask something about programming in marginal
>     distribution
>      >? ? ?for spatial
>      >? ? ? >> extreme?
>      >? ? ? >> I really stuck on my coding to obtain the parameter
>     estimation for
>      >? ? ? >> univariate or marginal distribution for new model in spatial
>      >? ? ?extreme.
>      >? ? ? >>
>      >? ? ? >> I want to run my data in order to get the parameter
>     estimation
>      >? ? ?value for 25
>      >? ? ? >> stations in one table. But I really didn't get the idea
>     of the
>      >? ? ?correct
>      >? ? ? >> coding. Here I attached my coding
>      >? ? ? >>
>      >? ? ? >> x <- data.matrix(Ozone_weekly2)
>      >? ? ? >> x
>      >? ? ? >> head(gev.fit)[1:4]
>      >? ? ? >> ti = matrix(ncol = 3, nrow = 888)
>      >? ? ? >> ti[,1] = seq(1, 888, 1)
>      >? ? ? >> ti[,2]=sin(2*pi*(ti[,1])/52)
>      >? ? ? >> ti[,3]=cos(2*pi*(ti[,1])/52)
>      >? ? ? >> for(i in 1:nrow(x))
>      >? ? ? >>? ? + { for(j in 1:ncol(x))
>      >? ? ? >>? ? ? + {x[i,j] = 1}}
>      >? ? ? >>
>      >? ? ? >> My problem is highlighted in red color.
>      >? ? ? >> And if are not hesitate to all. Can someone share with me the
>      >? ? ?procedure,
>      >? ? ? >> how can I map my data using spatial extreme.
>      >? ? ? >> For example:
>      >? ? ? >> After I finish my marginal distribution, what the next
>      >? ? ?procedure. It is I
>      >? ? ? >> need to get the spatial independent value.
>      >? ? ? >>
>      >? ? ? >> That's all
>      >? ? ? >> Thank you.
>      >? ? ? >>
>      >? ? ? >> --
>      >? ? ? >>
>      >? ? ? >>
>      >? ? ? >>
>      >? ? ? >>
>      >? ? ? >>
>      >? ? ? >> "..Millions of trees are used to make papers, only to be
>     thrown away
>      >? ? ? >> after a couple of minutes reading from them. Our planet is at
>      >? ? ?stake. Please
>      >? ? ? >> be considerate. THINK TWICE BEFORE PRINTING THIS.."
>      >? ? ? >>
>      >? ? ? >> DISCLAIMER: This email \ and any files
>     transmitte...{{dropped:24}}
>      >? ? ? >>
>      >? ? ? >> ______________________________________________
>      >? ? ? >> R-help at r-project.org <mailto:R-help at r-project.org>
>     <mailto:R-help at r-project.org <mailto:R-help at r-project.org>> mailing list
>      >? ? ?-- To UNSUBSCRIBE and more, see
>      >? ? ? >> https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>      >? ? ?<https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>>
>      >? ? ? >> PLEASE do read the posting guide
>      > http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>      >? ? ?<http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>>
>      >? ? ? >> and provide commented, minimal, self-contained,
>     reproducible code.
>      >? ? ? >
>      >? ? ? > ______________________________________________
>      >? ? ? > R-help at r-project.org <mailto:R-help at r-project.org>
>     <mailto:R-help at r-project.org <mailto:R-help at r-project.org>> mailing list
>      >? ? ?-- To UNSUBSCRIBE and more, see
>      >? ? ? > https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>      >? ? ?<https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>>
>      >? ? ? > PLEASE do read the posting guide
>      > http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>      >? ? ?<http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>>
>      >? ? ? > and provide commented, minimal, self-contained,
>     reproducible code.
>      >? ? ? >
>      >
>      >
>      >
>      > "..Millions of trees are used to make papers, only to be thrown away
>      > after a couple of minutes reading from them. Our planet is at stake.
>      > Please be considerate. THINK TWICE BEFORE PRINTING THIS.."
>      >
>      > *DISCLAIMER:*?This email and any files transmitted with it are
>      > confidential and intended solely for the use of the individual
>     orentity
>      > to whom they are addressed. If you have received this email in error
>      > please notify the UniMAP's Email Administrator. Please note that any
>      > views or opinions presented in this email are solely those of the
>     author
>      > and do not necessarily represent those of the university.
>     Finally, the
>      > recipient should check this email and any attachments for the
>     presence
>      > of viruses.The university accepts no liability for any damage
>     caused by
>      > any virus transmitted by this email.
>      >
>      > Universiti Malaysia Perlis (UniMAP) | Digital Management &
>     Development
>      > Centre (DMDC), Universiti Malaysia Perlis (UniMAP), Pauh Putra
>     Campus,
>      > 02600 Arau, Perlis, MALAYSIA | www.unimap.edu.my
>     <http://www.unimap.edu.my> <http://www.unimap.edu.my/
>     <http://www.unimap.edu.my/>>
>      >
> 
> 
> 
> "..Millions of trees are used to make papers, only to be thrown away 
> after a couple of minutes reading from them. Our planet is at stake. 
> Please be considerate. THINK TWICE BEFORE PRINTING THIS.."
> 
> *DISCLAIMER:*?This email and any files transmitted with it are 
> confidential and intended solely for the use of the individual orentity 
> to whom they are addressed. If you have received this email in error 
> please notify the UniMAP's Email Administrator. Please note that any 
> views or opinions presented in this email are solely those of the author 
> and do not necessarily represent those of the university. Finally, the 
> recipient should check this email and any attachments for the presence 
> of viruses.The university accepts no liability for any damage caused by 
> any virus transmitted by this email.
> 
> Universiti Malaysia Perlis (UniMAP) | Digital Management & Development 
> Centre (DMDC), Universiti Malaysia Perlis (UniMAP), Pauh Putra Campus, 
> 02600 Arau, Perlis, MALAYSIA | www.unimap.edu.my <http://www.unimap.edu.my/>
>


From @|@y@hz@k@r|@ @end|ng |rom un|m@p@edu@my  Fri Jul  9 10:53:14 2021
From: @|@y@hz@k@r|@ @end|ng |rom un|m@p@edu@my (SITI AISYAH ZAKARIA)
Date: Fri, 9 Jul 2021 16:53:14 +0800
Subject: [R] How to estimate the parameter for many variable?
In-Reply-To: <5c44967a-2d2e-7dae-d96e-b86dcb772358@sapo.pt>
References: <CALcx2Bm+Py5Asc7KT+-2x6mW0j5zO6YNKBFktsn4usjjXAz7DQ@mail.gmail.com>
 <CA+8X3fXYdQcDU-L9f2bHUuutrg=c1boAON++dX2_eVPrzBzHwA@mail.gmail.com>
 <b2c1d82b-0c0e-f639-fd32-dcafce055ef3@sapo.pt>
 <CALcx2B=MrCSv0J9Jxtibe4U3tUGyiBZiKrpz_FrctpMWbgrE3w@mail.gmail.com>
 <5c44967a-2d2e-7dae-d96e-b86dcb772358@sapo.pt>
Message-ID: <CALcx2B=Zz=TxZGk=s=YWbdXdHh8rmaXyEiUmSE7DRou06USy9A@mail.gmail.com>

Dear Rui ang Jim,

Thank you very much.

Thank you Rui Barradas, I already tried using your coding and I'm grateful
I got the answer.

ok now, I have some condition on the location parameter which is cyclic
condition.

So, I will add another 2 variables for the column.

and the condition for location is this one.

 ti[,1] = seq(1, 888, 1)
  ti[,2]=sin(2*pi*(ti[,1])/52)
  ti[,3]=cos(2*pi*(ti[,1])/52)
  fit0<-gev.fit(x[,i], ydat = ti, mul=c(2, 3))

Thank you again.

On Fri, 9 Jul 2021 at 14:38, Rui Barradas <ruipbarradas at sapo.pt> wrote:

> Hello,
>
> The following lapply one-liner fits a GEV to each column vector, there
> is no need for the double for loop. There's also no need to create a
> data set x.
>
>
> library(ismev)
> library(mgcv)
> library(EnvStats)
>
> Ozone_weekly2 <- read.table("~/tmp/Ozone_weekly2.txt", header = TRUE)
>
> # fit a GEV to each column
> gev_fit_list <- lapply(Ozone_weekly2, gev.fit, show = FALSE)
>
> # extract the parameters MLE estimates
> mle_params <- t(sapply(gev_fit_list, '[[', 'mle'))
>
> # assign column names
> colnames(mle_params) <- c("location", "scale", "shape")
>
> # see first few rows
> head(mle_params)
>
>
>
> The OP doesn't ask for plots but, here they go.
>
>
> y_vals <- function(x, params){
>    loc <- params[1]
>    scale <- params[2]
>    shape <- params[3]
>    EnvStats::dgevd(x, loc, scale, shape)
> }
> plot_fit <- function(data, vec, verbose = FALSE){
>    fit <- gev.fit(data[[vec]], show = verbose)
>    x <- sort(data[[vec]])
>    hist(x, freq = FALSE)
>    lines(x, y_vals(x, params = fit$mle))
> }
>
> # seems a good fit
> plot_fit(Ozone_weekly2, 1)       # column number
> plot_fit(Ozone_weekly2, "CA01")  # col name, equivalent
>
> # the data seems gaussian, not a good fit
> plot_fit(Ozone_weekly2, 4)       # column number
> plot_fit(Ozone_weekly2, "CA08")  # col name, equivalent
>
>
>
> Hope this helps,
>
> Rui Barradas
>
>
> ?s 00:59 de 09/07/21, SITI AISYAH ZAKARIA escreveu:
> > Dear all,
> >
> > Thank you very much for the feedback.
> >
> > Sorry for the lack of information about this problem.
> >
> > Here, I explain again.
> >
> > I use this package to run my coding.
> >
> > library(ismev)
> > library(mgcv)
> > library(nlme)
> >
> > The purpose of this is I want to get the value of parameter estimation
> > using MLE by applying the GEV distribution.
> >
> > x <- data.matrix(Ozone_weekly2)                      x refers to my data
> > that consists of 19 variables. I will attach the data together.
> > x
> > head(gev.fit)[1:4]
> > ti = matrix(ncol = 3, nrow = 888)
> > ti[,1] = seq(1, 888, 1)
> > ti[,2]=sin(2*pi*(ti[,1])/52)
> > ti[,3]=cos(2*pi*(ti[,1])/52)
> >
> > /for(i in 1:nrow(x))
> >    + { for(j in 1:ncol(x))                            the problem in
> > here, i don't no to create the coding. i target my output will come out
> > in matrix that
> >      + {x[i,j] = 1}}                                       show the
> > parameter estimation for 19 variable which have 19 row and 3 column/
> > /                                                              row --
> > refer to variable (station)  ; column -- refer to parameter estimation
> > for GEV distribution
> >
> > /thank you.
> >
> > On Thu, 8 Jul 2021 at 18:40, Rui Barradas <ruipbarradas at sapo.pt
> > <mailto:ruipbarradas at sapo.pt>> wrote:
> >
> >     Hello,
> >
> >     Also, in the code
> >
> >     x <- data.matrix(Ozone_weekly)
> >
> >     [...omited...]
> >
> >     for(i in 1:nrow(x))
> >         + { for(j in 1:ncol(x))
> >           + {x[i,j] = 1}}
> >
> >     not only you rewrite x but the double for loop is equivalent to
> >
> >
> >     x[] <- 1
> >
> >
> >     courtesy R's vectorised behavior. (The square parenthesis are needed
> to
> >     keep the dimensions, the matrix form.)
> >     And, I'm not sure but isn't
> >
> >     head(gev.fit)[1:4]
> >
> >     equivalent to
> >
> >     head(gev.fit, n = 4)
> >
> >     ?
> >
> >     Like Jim says, we need more information, can you post Ozone_weekly2
> and
> >     the code that produced gev.fit? But in the mean time you can revise
> >     your
> >     code.
> >
> >     Hope this helps,
> >
> >     Rui Barradas
> >
> >
> >     ?s 11:08 de 08/07/21, Jim Lemon escreveu:
> >      > Hi Siti,
> >      > I think we need a bit more information to respond helpfully. I
> >     have no
> >      > idea what "Ozone_weekly2" is and Google is also ignorant.
> >     "gev.fit" is
> >      > also unknown. The name suggests that it is the output of some
> >      > regression or similar. What function produced it, and from what
> >      > library? "ti" is known as you have defined it. However, I don't
> know
> >      > what you want to do with it. Finally, as this is a text mailing
> list,
> >      > we don't get any highlighting, so the text to which you refer
> cannot
> >      > be identified. I can see you have a problem, but cannot offer any
> >     help
> >      > right now.
> >      >
> >      > Jim
> >      >
> >      > On Thu, Jul 8, 2021 at 12:06 AM SITI AISYAH ZAKARIA
> >      > <aisyahzakaria at unimap.edu.my
> >     <mailto:aisyahzakaria at unimap.edu.my>> wrote:
> >      >>
> >      >> Dear all,
> >      >>
> >      >> Can I ask something about programming in marginal distribution
> >     for spatial
> >      >> extreme?
> >      >> I really stuck on my coding to obtain the parameter estimation
> for
> >      >> univariate or marginal distribution for new model in spatial
> >     extreme.
> >      >>
> >      >> I want to run my data in order to get the parameter estimation
> >     value for 25
> >      >> stations in one table. But I really didn't get the idea of the
> >     correct
> >      >> coding. Here I attached my coding
> >      >>
> >      >> x <- data.matrix(Ozone_weekly2)
> >      >> x
> >      >> head(gev.fit)[1:4]
> >      >> ti = matrix(ncol = 3, nrow = 888)
> >      >> ti[,1] = seq(1, 888, 1)
> >      >> ti[,2]=sin(2*pi*(ti[,1])/52)
> >      >> ti[,3]=cos(2*pi*(ti[,1])/52)
> >      >> for(i in 1:nrow(x))
> >      >>    + { for(j in 1:ncol(x))
> >      >>      + {x[i,j] = 1}}
> >      >>
> >      >> My problem is highlighted in red color.
> >      >> And if are not hesitate to all. Can someone share with me the
> >     procedure,
> >      >> how can I map my data using spatial extreme.
> >      >> For example:
> >      >> After I finish my marginal distribution, what the next
> >     procedure. It is I
> >      >> need to get the spatial independent value.
> >      >>
> >      >> That's all
> >      >> Thank you.
> >      >>
> >      >> --
> >      >>
> >      >>
> >      >>
> >      >>
> >      >>
> >      >> "..Millions of trees are used to make papers, only to be thrown
> away
> >      >> after a couple of minutes reading from them. Our planet is at
> >     stake. Please
> >      >> be considerate. THINK TWICE BEFORE PRINTING THIS.."
> >      >>
> >      >> DISCLAIMER: This email \ and any files
> transmitte...{{dropped:24}}
> >      >>
> >      >> ______________________________________________
> >      >> R-help at r-project.org <mailto:R-help at r-project.org> mailing list
> >     -- To UNSUBSCRIBE and more, see
> >      >> https://stat.ethz.ch/mailman/listinfo/r-help
> >     <https://stat.ethz.ch/mailman/listinfo/r-help>
> >      >> PLEASE do read the posting guide
> >     http://www.R-project.org/posting-guide.html
> >     <http://www.R-project.org/posting-guide.html>
> >      >> and provide commented, minimal, self-contained, reproducible
> code.
> >      >
> >      > ______________________________________________
> >      > R-help at r-project.org <mailto:R-help at r-project.org> mailing list
> >     -- To UNSUBSCRIBE and more, see
> >      > https://stat.ethz.ch/mailman/listinfo/r-help
> >     <https://stat.ethz.ch/mailman/listinfo/r-help>
> >      > PLEASE do read the posting guide
> >     http://www.R-project.org/posting-guide.html
> >     <http://www.R-project.org/posting-guide.html>
> >      > and provide commented, minimal, self-contained, reproducible code.
> >      >
> >
> >
> >
> > "..Millions of trees are used to make papers, only to be thrown away
> > after a couple of minutes reading from them. Our planet is at stake.
> > Please be considerate. THINK TWICE BEFORE PRINTING THIS.."
> >
> > *DISCLAIMER:* This email and any files transmitted with it are
> > confidential and intended solely for the use of the individual orentity
> > to whom they are addressed. If you have received this email in error
> > please notify the UniMAP's Email Administrator. Please note that any
> > views or opinions presented in this email are solely those of the author
> > and do not necessarily represent those of the university. Finally, the
> > recipient should check this email and any attachments for the presence
> > of viruses.The university accepts no liability for any damage caused by
> > any virus transmitted by this email.
> >
> > Universiti Malaysia Perlis (UniMAP) | Digital Management & Development
> > Centre (DMDC), Universiti Malaysia Perlis (UniMAP), Pauh Putra Campus,
> > 02600 Arau, Perlis, MALAYSIA | www.unimap.edu.my <
> http://www.unimap.edu.my/>
> >
>

-- 





"..Millions of trees are used to make papers, only to be thrown away 
after a couple of minutes reading from them. Our planet is at stake. Please 
be considerate. THINK TWICE BEFORE PRINTING THIS.."

DISCLAIMER:?This email \ and any files transmitte...{{dropped:24}}


From L@urentRHe|p @end|ng |rom |ree@|r  Fri Jul  9 19:40:08 2021
From: L@urentRHe|p @end|ng |rom |ree@|r (Laurent Rhelp)
Date: Fri, 9 Jul 2021 19:40:08 +0200
Subject: [R] How to create a matrix from a list without a for loop
Message-ID: <bdb386ff-f370-3a2d-03f2-090c8d6f74dd@free.fr>

Dear R-Help-list,

 ? I have a list init_l containing 16 dataframes and I want to create a 
matrix 4 x 4 from this list with a dataframe in every cell of the 
matrix. I succeeded to do that but my loop is very uggly (cf. below). 
Could somebody help me to write nice R code to do this loop ?

Thank you very much

Laurent


##
## mock data, 16 dataframes in a list
##
init_l <- lapply( seq(1,16) , function(x) {
 ? data.frame( V1 = rnorm(3),
 ????????????? V2 = rnorm(3),
 ????????????? V3 = rnorm(3)
 ??????????? )
})

##
## lists matrix creation with n = 4 columns and n = 4 rows
##
n <- 4
## an example of row to create the matrix with lists in the cells
one_row <- rbind( rep( list(rep(list(1),3)) , n) )
mymat <- do.call( "rbind" , rep( list(one_row) , n) )

##
## The UGGLY loop I would like to improve:
##

## populate the matrix
k <- 1
for( i in 1:n){
 ? for( j in 1:n){
 ??? mymat[i,j][[1]] <- list( init_l[[ k ]] )
 ??? k <- k+1
 ? }
}

colnames(mymat) <- c("X1", "X2", "X3", "X3")
rownames(mymat) <- c("X1", "X2", "X3", "X4")


mymat

# X1???? X2???? X3???? X3
# X1 List,1 List,1 List,1 List,1
# X2 List,1 List,1 List,1 List,1
# X3 List,1 List,1 List,1 List,1
# X4 List,1 List,1 List,1 List,1


#
# verification, it works
#
mymat[2,2]
init_l[[6]]

##
init_l[[6]]

library(tidyverse)
mymat.t <- as.tibble(mymat)
mymat.t
unnest(mymat.t[2,2],cols="X2")[[1]][[1]]

mymat.df <- as.data.frame(mymat)
mymat.df[2,2][[1]][[1]]


thx



-- 
L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e par le logiciel antivirus Avast.
https://www.avast.com/antivirus


From w||||@mwdun|@p @end|ng |rom gm@||@com  Fri Jul  9 19:50:01 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Fri, 9 Jul 2021 10:50:01 -0700
Subject: [R] How to create a matrix from a list without a for loop
In-Reply-To: <bdb386ff-f370-3a2d-03f2-090c8d6f74dd@free.fr>
References: <bdb386ff-f370-3a2d-03f2-090c8d6f74dd@free.fr>
Message-ID: <CAHqSRuTucvoJ15FDTQLjwgNyLGiXdDM6tjtPJi6psrUbGxoy=Q@mail.gmail.com>

Try
   matrix(init_l, nrow=4, ncol=4,
dimnames=list(c("X1","X2","X3","X4"),c("X1","X2","X3","X4")))
It doesn't give exactly what your code does, but your code introduces an
extra level of "list", which you may not want.

-Bill

On Fri, Jul 9, 2021 at 10:40 AM Laurent Rhelp <LaurentRHelp at free.fr> wrote:

> Dear R-Help-list,
>
>    I have a list init_l containing 16 dataframes and I want to create a
> matrix 4 x 4 from this list with a dataframe in every cell of the
> matrix. I succeeded to do that but my loop is very uggly (cf. below).
> Could somebody help me to write nice R code to do this loop ?
>
> Thank you very much
>
> Laurent
>
>
> ##
> ## mock data, 16 dataframes in a list
> ##
> init_l <- lapply( seq(1,16) , function(x) {
>    data.frame( V1 = rnorm(3),
>                V2 = rnorm(3),
>                V3 = rnorm(3)
>              )
> })
>
> ##
> ## lists matrix creation with n = 4 columns and n = 4 rows
> ##
> n <- 4
> ## an example of row to create the matrix with lists in the cells
> one_row <- rbind( rep( list(rep(list(1),3)) , n) )
> mymat <- do.call( "rbind" , rep( list(one_row) , n) )
>
> ##
> ## The UGGLY loop I would like to improve:
> ##
>
> ## populate the matrix
> k <- 1
> for( i in 1:n){
>    for( j in 1:n){
>      mymat[i,j][[1]] <- list( init_l[[ k ]] )
>      k <- k+1
>    }
> }
>
> colnames(mymat) <- c("X1", "X2", "X3", "X3")
> rownames(mymat) <- c("X1", "X2", "X3", "X4")
>
>
> mymat
>
> # X1     X2     X3     X3
> # X1 List,1 List,1 List,1 List,1
> # X2 List,1 List,1 List,1 List,1
> # X3 List,1 List,1 List,1 List,1
> # X4 List,1 List,1 List,1 List,1
>
>
> #
> # verification, it works
> #
> mymat[2,2]
> init_l[[6]]
>
> ##
> init_l[[6]]
>
> library(tidyverse)
> mymat.t <- as.tibble(mymat)
> mymat.t
> unnest(mymat.t[2,2],cols="X2")[[1]][[1]]
>
> mymat.df <- as.data.frame(mymat)
> mymat.df[2,2][[1]][[1]]
>
>
> thx
>
>
>
> --
> L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e par le
> logiciel antivirus Avast.
> https://www.avast.com/antivirus
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From dw|n@em|u@ @end|ng |rom comc@@t@net  Fri Jul  9 19:50:06 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Fri, 9 Jul 2021 10:50:06 -0700
Subject: [R] How to create a matrix from a list without a for loop
In-Reply-To: <bdb386ff-f370-3a2d-03f2-090c8d6f74dd@free.fr>
References: <bdb386ff-f370-3a2d-03f2-090c8d6f74dd@free.fr>
Message-ID: <41f6f03c-b75a-d988-714f-1fc46b9715d8@comcast.net>


On 7/9/21 10:40 AM, Laurent Rhelp wrote:
> Dear R-Help-list,
>
> ? I have a list init_l containing 16 dataframes and I want to create a 
> matrix 4 x 4 from this list with a dataframe in every cell of the 
> matrix. I succeeded to do that but my loop is very uggly (cf. below). 
> Could somebody help me to write nice R code to do this loop ?
>
> Thank you very much
>
> Laurent
>
>
> ##
> ## mock data, 16 dataframes in a list
> ##
> init_l <- lapply( seq(1,16) , function(x) {
> ? data.frame( V1 = rnorm(3),
> ????????????? V2 = rnorm(3),
> ????????????? V3 = rnorm(3)
> ??????????? )
> })
>
> ##
> ## lists matrix creation with n = 4 columns and n = 4 rows
> ##
> n <- 4



Just assign a dimension attribute and you will have your two dimensional 
structure


 > dim(init_l) <- c(n,n)
 > init_l[ 2,2]
[[1]]
 ????????? V1???????? V2???????? V3
1 -1.4103259? 1.9214184 -0.1590919
2? 0.1899490? 0.3842191? 2.4502078
3 -0.4282764 -0.9992190? 1.5384344

 > is.matrix(init_l)
[1] TRUE

-- 

David

> ## an example of row to create the matrix with lists in the cells
> one_row <- rbind( rep( list(rep(list(1),3)) , n) )
> mymat <- do.call( "rbind" , rep( list(one_row) , n) )
>
> ##
> ## The UGGLY loop I would like to improve:
> ##
>
> ## populate the matrix
> k <- 1
> for( i in 1:n){
> ? for( j in 1:n){
> ??? mymat[i,j][[1]] <- list( init_l[[ k ]] )
> ??? k <- k+1
> ? }
> }
>
> colnames(mymat) <- c("X1", "X2", "X3", "X3")
> rownames(mymat) <- c("X1", "X2", "X3", "X4")
>
>
> mymat
>
> # X1???? X2???? X3???? X3
> # X1 List,1 List,1 List,1 List,1
> # X2 List,1 List,1 List,1 List,1
> # X3 List,1 List,1 List,1 List,1
> # X4 List,1 List,1 List,1 List,1
>
>
> #
> # verification, it works
> #
> mymat[2,2]
> init_l[[6]]
>
> ##
> init_l[[6]]
>
> library(tidyverse)
> mymat.t <- as.tibble(mymat)
> mymat.t
> unnest(mymat.t[2,2],cols="X2")[[1]][[1]]
>
> mymat.df <- as.data.frame(mymat)
> mymat.df[2,2][[1]][[1]]
>
>
> thx
>
>
>


From y@ngk@|9999 @end|ng |rom y@hoo@com  Fri Jul  9 20:01:51 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Fri, 9 Jul 2021 18:01:51 +0000 (UTC)
Subject: [R] error message from read.csv in loop
References: <550599640.2967267.1625853711087.ref@mail.yahoo.com>
Message-ID: <550599640.2967267.1625853711087@mail.yahoo.com>

Hello List,
I use for loop to read csv difference file into data frame rr.? The data frame rr will be deleted after a comparison and go to the next csv file.? Below is my code:
for (j in 1:nrow(ora))
{
? mycol? <- ora[j,"fname"]
? mycsv? <- paste0(mycol,".csv'")
? rdcsv? <- noquote(paste0("'w:/project/_Joe.B/Oracle/data/", mycsv))
? rr? ? ?<- read.csv(rdcsv)
}
but when I run this code, I got error message below:
Error in file(file, "rt") : cannot open the connection
In addition: Warning message:
In file(file, "rt") :
? cannot open file ''w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'': No such file or directory

so, I checked the rdcsv and print it out, see below:
[1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DISCRETE_VALUES.csv'
[1] 'w:/project/_Joe.B/Oracle/data/ASSAY_QUESTIONS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/ASSAY_RUNS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/DATA_ENTRY_PAGES.csv'
[1] 'w:/project/_Joe.B/Oracle/data/DISCRETE_VALUES.csv'
[1] 'w:/project/_Joe.B/Oracle/data/ENTRY_GROUPS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_GROUPS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_VALUES.csv'
[1] 'w:/project/_Joe.B/Oracle/data/GEMD_LOT_DEFINITIONS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/GEMD_SAMPLES.csv'
[1] 'w:/project/_Joe.B/Oracle/data/MOLECULAR_WAREHOUSE.csv'
[1] 'w:/project/_Joe.B/Oracle/data/QUESTION_DEFINITIONS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/QUESTION_GROUPS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/RESPONSES.csv'
[1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST.csv'
[1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST_NAMES.csv'
[1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_PLATE_ADDRESSES.csv'
[1] 'w:/project/_Joe.B/Oracle/data/STORAGE_UNITS.csv'
it seems correct. I copy and paste it into a code :
?rr? ? ?<- read.csv( 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv')
and it works fine.
Can someone help me debug where is the problem in my for loop code?
Thanks,
Kai





	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Fri Jul  9 20:15:25 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Fri, 9 Jul 2021 21:15:25 +0300
Subject: [R] error message from read.csv in loop
In-Reply-To: <550599640.2967267.1625853711087@mail.yahoo.com>
References: <550599640.2967267.1625853711087.ref@mail.yahoo.com>
 <550599640.2967267.1625853711087@mail.yahoo.com>
Message-ID: <CAGgJW77KEFwNVKdaex0UD_26dD3dDXta_tptMqMgZKiHU22JNg@mail.gmail.com>

it complained about  ASSAY_DEFINITIONS not about  RESPONDENTS.
Can you try with the ASSAY_DEFINITIONS  file?


On Fri, Jul 9, 2021 at 9:10 PM Kai Yang via R-help <r-help at r-project.org>
wrote:

> Hello List,
> I use for loop to read csv difference file into data frame rr.  The data
> frame rr will be deleted after a comparison and go to the next csv file.
> Below is my code:
> for (j in 1:nrow(ora))
> {
>   mycol  <- ora[j,"fname"]
>   mycsv  <- paste0(mycol,".csv'")
>   rdcsv  <- noquote(paste0("'w:/project/_Joe.B/Oracle/data/", mycsv))
>   rr     <- read.csv(rdcsv)
> }
> but when I run this code, I got error message below:
> Error in file(file, "rt") : cannot open the connection
> In addition: Warning message:
> In file(file, "rt") :
>   cannot open file
> ''w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'': No such file or
> directory
>
> so, I checked the rdcsv and print it out, see below:
> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DISCRETE_VALUES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_QUESTIONS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_RUNS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/DATA_ENTRY_PAGES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/DISCRETE_VALUES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/ENTRY_GROUPS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_GROUPS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_VALUES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_LOT_DEFINITIONS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_SAMPLES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/MOLECULAR_WAREHOUSE.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/QUESTION_DEFINITIONS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/QUESTION_GROUPS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/RESPONSES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST_NAMES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_PLATE_ADDRESSES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/STORAGE_UNITS.csv'
> it seems correct. I copy and paste it into a code :
>  rr     <- read.csv( 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv')
> and it works fine.
> Can someone help me debug where is the problem in my for loop code?
> Thanks,
> Kai
>
>
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From m|n@h@|| @end|ng |rom um|ch@edu  Fri Jul  9 20:56:38 2021
From: m|n@h@|| @end|ng |rom um|ch@edu (Greg Minshall)
Date: Fri, 09 Jul 2021 21:56:38 +0300
Subject: [R] problem for strsplit function
In-Reply-To: Your message of "Thu, 08 Jul 2021 15:24:25 +0000."
 <762548966.2994133.1625757865539@mail.yahoo.com>
Message-ID: <812547.1625856998@apollo2.minshall.org>

Kai,

> one more question, how can I know if the function is for column
> manipulations or for vector?

i still stumble around R code.  but, i'd say the following (and look
forward to being corrected! :):

1.  a column, when extracted from a data frame, *is* a vector.

2.  maybe your question is "is a given function for a vector, or for a
    data frame/matrix/array?".  if so, i think the only way is reading
    the help information (?foo).

3.  sometimes, extracting the column as a vector from a data frame-like
    object might be non-intuitive.  you might find reading ?"[" and
    ?"[.data.frame" useful (as well as ?"[.data.table" if you use that
    package).  also, the str() command can be helpful in understanding
    what is happening.  (the lobstr:: package's sxp() function, as well
    as more verbose .Internal(inspect()) can also give you insight.)

    with the data.table:: package, for example, if "DT" is a data.table
    object, with "x2" as a column, adding or leaving off quotation marks
    for the column name can make all the difference between ending up
    with a vector, or with a (much reduced) data table:
----
> is.vector(DT[, x2])
[1] TRUE
> str(DT[, x2])
 num [1:9] 32 32 32 32 32 32 32 32 32
>
> is.vector(DT[, "x2"])
[1] FALSE
> str(DT[, "x2"])
Classes ?data.table? and 'data.frame':  9 obs. of  1 variable:
 $ x2: num  32 32 32 32 32 32 32 32 32
 - attr(*, ".internal.selfref")=<externalptr>
----

    a second level of indexing may or may not help, mostly depending on
    the use of '[' versus of '[['.  this can sometimes cause confusion
    when you are learning the language.
----
> str(DT[, "x2"][1])
Classes ?data.table? and 'data.frame':  1 obs. of  1 variable:
 $ x2: num 32
 - attr(*, ".internal.selfref")=<externalptr>
> str(DT[, "x2"][[1]])
 num [1:9] 32 32 32 32 32 32 32 32 32
----

    the tibble:: package (used in, e.g., the dplyr:: package) also
    (always?) returns a single column as a non-vector.  again, a
    second indexing with double '[[]]' can produce a vector.
----
> DP <- tibble(DT)
> is.vector(DP[, "x2"])
[1] FALSE
> is.vector(DP[, "x2"][[1]])
[1] TRUE
----

    but, note that a list of lists is also a vector:
> is.vector(list(list(1), list(1,2,3)))
[1] TRUE
> str(list(list(1), list(1,2,3)))
List of 2
 $ :List of 1
  ..$ : num 1
 $ :List of 3
  ..$ : num 1
  ..$ : num 2
  ..$ : num 3

    etc.

hth.  good luck learning!

cheers, Greg


From y@ngk@|9999 @end|ng |rom y@hoo@com  Fri Jul  9 21:24:23 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Fri, 9 Jul 2021 19:24:23 +0000 (UTC)
Subject: [R] error message from read.csv in loop
In-Reply-To: <CA+Mj9gV2PWNGediiKhJt37KYsNJAxUp3=q4KFi8H9SND8YAQvQ@mail.gmail.com>
References: <550599640.2967267.1625853711087.ref@mail.yahoo.com>
 <550599640.2967267.1625853711087@mail.yahoo.com>
 <CA+Mj9gV2PWNGediiKhJt37KYsNJAxUp3=q4KFi8H9SND8YAQvQ@mail.gmail.com>
Message-ID: <1571249797.2635333.1625858663382@mail.yahoo.com>

 Hi Migdonio,
I did try your code:
# Initialize the rr variable as a list.

rr <- as.list(rep(NA, nrow(ora)))


# Run the for-loop to store all the CSVs in rr.

for (j in 1:nrow(ora))

{

? ? ? ? mycol ?<- ora[j,"fname"]

? ? ? ? mycsv ?<- paste0(mycol,".csv")

? ? ? ? rdcsv ?<- noquote(paste0("w:/project/_Joe.B/Oracle/data/", mycsv))

? ? ? ? rr[[j]] ? ? <- read.csv(rdcsv)

}

this code is working, but rr is not a data frame, R said: Large list ( 20 elements .....). how can I use it as a data frame one by one?
Thank you for your help
Kai
    On Friday, July 9, 2021, 11:39:59 AM PDT, Migdonio Gonz?lez <migdonio.gonzalez02 at gmail.com> wrote:  
 
 It seems that your problem is that you are using single quotes inside of the double quotes. This is not necessary. Here is the corrected for-loop:
for (j in 1:nrow(ora))
{
? ? ? ? mycol ?<- ora[j,"fname"]
? ? ? ? mycsv ?<- paste0(mycol,".csv")
? ? ? ? rdcsv ?<- noquote(paste0("w:/project/_Joe.B/Oracle/data/", mycsv))
? ? ? ? rr ? ? <- read.csv(rdcsv)
}
Also note that the rr variable will only store the last CSV, not all CSV. You will need to initialize the rr variable as a list to store all CSVs if that is what you require. Something like this:
# Initialize the rr variable as a list.
rr <- as.list(rep(NA, nrow(ora)))
# Run the for-loop to store all the CSVs in rr.
for (j in 1:nrow(ora))
{
? ? ? ? mycol ?<- ora[j,"fname"]
? ? ? ? mycsv ?<- paste0(mycol,".csv")
? ? ? ? rdcsv ?<- noquote(paste0("w:/project/_Joe.B/Oracle/data/", mycsv))
? ? ? ? rr[[j]] ? ? <- read.csv(rdcsv)
} 

RegardsMigdonio G.

On Fri, Jul 9, 2021 at 1:10 PM Kai Yang via R-help <r-help at r-project.org> wrote:

Hello List,
I use for loop to read csv difference file into data frame rr.? The data frame rr will be deleted after a comparison and go to the next csv file.? Below is my code:
for (j in 1:nrow(ora))
{
? mycol? <- ora[j,"fname"]
? mycsv? <- paste0(mycol,".csv'")
? rdcsv? <- noquote(paste0("'w:/project/_Joe.B/Oracle/data/", mycsv))
? rr? ? ?<- read.csv(rdcsv)
}
but when I run this code, I got error message below:
Error in file(file, "rt") : cannot open the connection
In addition: Warning message:
In file(file, "rt") :
? cannot open file ''w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'': No such file or directory

so, I checked the rdcsv and print it out, see below:
[1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DISCRETE_VALUES.csv'
[1] 'w:/project/_Joe.B/Oracle/data/ASSAY_QUESTIONS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/ASSAY_RUNS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/DATA_ENTRY_PAGES.csv'
[1] 'w:/project/_Joe.B/Oracle/data/DISCRETE_VALUES.csv'
[1] 'w:/project/_Joe.B/Oracle/data/ENTRY_GROUPS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_GROUPS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_VALUES.csv'
[1] 'w:/project/_Joe.B/Oracle/data/GEMD_LOT_DEFINITIONS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/GEMD_SAMPLES.csv'
[1] 'w:/project/_Joe.B/Oracle/data/MOLECULAR_WAREHOUSE.csv'
[1] 'w:/project/_Joe.B/Oracle/data/QUESTION_DEFINITIONS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/QUESTION_GROUPS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv'
[1] 'w:/project/_Joe.B/Oracle/data/RESPONSES.csv'
[1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST.csv'
[1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST_NAMES.csv'
[1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_PLATE_ADDRESSES.csv'
[1] 'w:/project/_Joe.B/Oracle/data/STORAGE_UNITS.csv'
it seems correct. I copy and paste it into a code :
?rr? ? ?<- read.csv( 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv')
and it works fine.
Can someone help me debug where is the problem in my for loop code?
Thanks,
Kai





? ? ? ? [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

  
	[[alternative HTML version deleted]]


From L@urentRHe|p @end|ng |rom |ree@|r  Fri Jul  9 21:33:49 2021
From: L@urentRHe|p @end|ng |rom |ree@|r (Laurent Rhelp)
Date: Fri, 9 Jul 2021 21:33:49 +0200
Subject: [R] How to create a matrix from a list without a for loop
In-Reply-To: <CAHqSRuTucvoJ15FDTQLjwgNyLGiXdDM6tjtPJi6psrUbGxoy=Q@mail.gmail.com>
References: <bdb386ff-f370-3a2d-03f2-090c8d6f74dd@free.fr>
 <CAHqSRuTucvoJ15FDTQLjwgNyLGiXdDM6tjtPJi6psrUbGxoy=Q@mail.gmail.com>
Message-ID: <f9ae3c28-08af-1a24-9d86-39c9d11dbae7@free.fr>


You are right, this extra level disturbed me.
Very impressive this solution, thank you very much.


Le 09/07/2021 ? 19:50, Bill Dunlap a ?crit?:
> Try
> ? ?matrix(init_l, nrow=4, ncol=4, 
> dimnames=list(c("X1","X2","X3","X4"),c("X1","X2","X3","X4")))
> It doesn't give exactly what your code does, but your code introduces 
> an extra level of "list", which you may not want.
>
> -Bill
>
> On Fri, Jul 9, 2021 at 10:40 AM Laurent Rhelp <LaurentRHelp at free.fr 
> <mailto:LaurentRHelp at free.fr>> wrote:
>
>     Dear R-Help-list,
>
>     ?? I have a list init_l containing 16 dataframes and I want to
>     create a
>     matrix 4 x 4 from this list with a dataframe in every cell of the
>     matrix. I succeeded to do that but my loop is very uggly (cf. below).
>     Could somebody help me to write nice R code to do this loop ?
>
>     Thank you very much
>
>     Laurent
>
>
>     ##
>     ## mock data, 16 dataframes in a list
>     ##
>     init_l <- lapply( seq(1,16) , function(x) {
>     ?? data.frame( V1 = rnorm(3),
>     ?????????????? V2 = rnorm(3),
>     ?????????????? V3 = rnorm(3)
>     ???????????? )
>     })
>
>     ##
>     ## lists matrix creation with n = 4 columns and n = 4 rows
>     ##
>     n <- 4
>     ## an example of row to create the matrix with lists in the cells
>     one_row <- rbind( rep( list(rep(list(1),3)) , n) )
>     mymat <- do.call( "rbind" , rep( list(one_row) , n) )
>
>     ##
>     ## The UGGLY loop I would like to improve:
>     ##
>
>     ## populate the matrix
>     k <- 1
>     for( i in 1:n){
>     ?? for( j in 1:n){
>     ???? mymat[i,j][[1]] <- list( init_l[[ k ]] )
>     ???? k <- k+1
>     ?? }
>     }
>
>     colnames(mymat) <- c("X1", "X2", "X3", "X3")
>     rownames(mymat) <- c("X1", "X2", "X3", "X4")
>
>
>     mymat
>
>     # X1???? X2???? X3???? X3
>     # X1 List,1 List,1 List,1 List,1
>     # X2 List,1 List,1 List,1 List,1
>     # X3 List,1 List,1 List,1 List,1
>     # X4 List,1 List,1 List,1 List,1
>
>
>     #
>     # verification, it works
>     #
>     mymat[2,2]
>     init_l[[6]]
>
>     ##
>     init_l[[6]]
>
>     library(tidyverse)
>     mymat.t <- as.tibble(mymat)
>     mymat.t
>     unnest(mymat.t[2,2],cols="X2")[[1]][[1]]
>
>     mymat.df <- as.data.frame(mymat)
>     mymat.df[2,2][[1]][[1]]
>
>
>     thx
>
>
>
>     -- 
>     L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e
>     par le logiciel antivirus Avast.
>     https://www.avast.com/antivirus <https://www.avast.com/antivirus>
>
>     ______________________________________________
>     R-help at r-project.org <mailto:R-help at r-project.org> mailing list --
>     To UNSUBSCRIBE and more, see
>     https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>     PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>     and provide commented, minimal, self-contained, reproducible code.
>



-- 
L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e par le logiciel antivirus Avast.
https://www.avast.com/antivirus

	[[alternative HTML version deleted]]


From L@urentRHe|p @end|ng |rom |ree@|r  Fri Jul  9 21:37:48 2021
From: L@urentRHe|p @end|ng |rom |ree@|r (Laurent Rhelp)
Date: Fri, 9 Jul 2021 21:37:48 +0200
Subject: [R] How to create a matrix from a list without a for loop
In-Reply-To: <41f6f03c-b75a-d988-714f-1fc46b9715d8@comcast.net>
References: <bdb386ff-f370-3a2d-03f2-090c8d6f74dd@free.fr>
 <41f6f03c-b75a-d988-714f-1fc46b9715d8@comcast.net>
Message-ID: <6d034965-be70-4d80-c9c6-7c4ccc6251ee@free.fr>


Very effective solution, I hope I remember that for the nex time.
Thank you


Le 09/07/2021 ? 19:50, David Winsemius a ?crit?:
>
> On 7/9/21 10:40 AM, Laurent Rhelp wrote:
>> Dear R-Help-list,
>>
>> ? I have a list init_l containing 16 dataframes and I want to create 
>> a matrix 4 x 4 from this list with a dataframe in every cell of the 
>> matrix. I succeeded to do that but my loop is very uggly (cf. below). 
>> Could somebody help me to write nice R code to do this loop ?
>>
>> Thank you very much
>>
>> Laurent
>>
>>
>> ##
>> ## mock data, 16 dataframes in a list
>> ##
>> init_l <- lapply( seq(1,16) , function(x) {
>> ? data.frame( V1 = rnorm(3),
>> ????????????? V2 = rnorm(3),
>> ????????????? V3 = rnorm(3)
>> ??????????? )
>> })
>>
>> ##
>> ## lists matrix creation with n = 4 columns and n = 4 rows
>> ##
>> n <- 4
>
>
>
> Just assign a dimension attribute and you will have your two 
> dimensional structure
>
>
> > dim(init_l) <- c(n,n)
> > init_l[ 2,2]
> [[1]]
> ????????? V1???????? V2???????? V3
> 1 -1.4103259? 1.9214184 -0.1590919
> 2? 0.1899490? 0.3842191? 2.4502078
> 3 -0.4282764 -0.9992190? 1.5384344
>
> > is.matrix(init_l)
> [1] TRUE
>


-- 
L'absence de virus dans ce courrier ?lectronique a ?t? v?rifi?e par le logiciel antivirus Avast.
https://www.avast.com/antivirus


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Jul  9 21:48:16 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 9 Jul 2021 15:48:16 -0400
Subject: [R] How to create a matrix from a list without a for loop
In-Reply-To: <6d034965-be70-4d80-c9c6-7c4ccc6251ee@free.fr>
References: <bdb386ff-f370-3a2d-03f2-090c8d6f74dd@free.fr>
 <41f6f03c-b75a-d988-714f-1fc46b9715d8@comcast.net>
 <6d034965-be70-4d80-c9c6-7c4ccc6251ee@free.fr>
Message-ID: <2c79fa67-efaa-bded-0122-18902cf9283c@gmail.com>

On 09/07/2021 3:37 p.m., Laurent Rhelp wrote:
> 
> Very effective solution, I hope I remember that for the nex time.

The key things to remember are that in R a "list" object is a vector 
whose elements are R objects, and that matrices are just vectors with 
dimension attributes.

Those two ideas are each useful for other things, too!

Duncan Murdoch

> Thank you
> 
> 
> Le 09/07/2021 ? 19:50, David Winsemius a ?crit?:
>>
>> On 7/9/21 10:40 AM, Laurent Rhelp wrote:
>>> Dear R-Help-list,
>>>
>>>  ? I have a list init_l containing 16 dataframes and I want to create
>>> a matrix 4 x 4 from this list with a dataframe in every cell of the
>>> matrix. I succeeded to do that but my loop is very uggly (cf. below).
>>> Could somebody help me to write nice R code to do this loop ?
>>>
>>> Thank you very much
>>>
>>> Laurent
>>>
>>>
>>> ##
>>> ## mock data, 16 dataframes in a list
>>> ##
>>> init_l <- lapply( seq(1,16) , function(x) {
>>>  ? data.frame( V1 = rnorm(3),
>>>  ????????????? V2 = rnorm(3),
>>>  ????????????? V3 = rnorm(3)
>>>  ??????????? )
>>> })
>>>
>>> ##
>>> ## lists matrix creation with n = 4 columns and n = 4 rows
>>> ##
>>> n <- 4
>>
>>
>>
>> Just assign a dimension attribute and you will have your two
>> dimensional structure
>>
>>
>>> dim(init_l) <- c(n,n)
>>> init_l[ 2,2]
>> [[1]]
>>  ????????? V1???????? V2???????? V3
>> 1 -1.4103259? 1.9214184 -0.1590919
>> 2? 0.1899490? 0.3842191? 2.4502078
>> 3 -0.4282764 -0.9992190? 1.5384344
>>
>>> is.matrix(init_l)
>> [1] TRUE
>>
> 
>


From bgunter@4567 @end|ng |rom gm@||@com  Fri Jul  9 23:36:19 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 9 Jul 2021 14:36:19 -0700
Subject: [R] problem for strsplit function
In-Reply-To: <812547.1625856998@apollo2.minshall.org>
References: <762548966.2994133.1625757865539@mail.yahoo.com>
 <812547.1625856998@apollo2.minshall.org>
Message-ID: <CAGxFJbTDYcJuuQjWWPsq8nY8BJ1z3X8KeDtUhMvaw_mBe0yh0Q@mail.gmail.com>

"1.  a column, when extracted from a data frame, *is* a vector."
Strictly speaking, this is false; it depends on exactly what is meant
by "extracted." e.g.:

> d <- data.frame(col1 = 1:3, col2 = letters[1:3])
> v1 <- d[,2] ## a vector
> v2 <- d[[2]] ## the same, i.e
> identical(v1,v2)
[1] TRUE
> v3 <- d[2] ## a data.frame
> v1
[1] "a" "b" "c"  ## a character vector
> v3
  col2
1    a
2    b
3    c
> is.vector(v1)
[1] TRUE
> is.vector(v3)
[1] FALSE
> class(v3)  ## data.frame
[1] "data.frame"
## but
> is.list(v3)
[1] TRUE

which is simply explained in ?data.frame (where else?!) by:
"A data frame is a **list** [emphasis added] of variables of the same
number of rows with unique row names, given class "data.frame". If no
variables are included, the row names determine the number of rows."

"2.  maybe your question is "is a given function for a vector, or for a
    data frame/matrix/array?".  if so, i think the only way is reading
    the help information (?foo)."

Indeed! Is this not what the Help system is for?! But note also that
the S3 class system may somewhat blur the issue: foo() may work
appropriately and differently for different (S3) classes of objects. A
detailed explanation of this behavior can be found in appropriate
resources or (more tersely) via ?UseMethod .

"you might find reading ?"[" and  ?"[.data.frame" useful"

Not just 'useful" -- **essential** if you want to work in R, unless
one gets this information via any of the numerous online tutorials,
courses, or books that are available. The Help system is accurate and
authoritative, but terse. I happen to like this mode of documentation,
but others may prefer more extended expositions. I stand by this claim
even if one chooses to use the "Tidyverse", data.table package, or
other alternative frameworks for handling data. Again, others may
disagree, but R is structured around these basics, and imo one remains
ignorant of them at their peril.

Cheers,
Bert


Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Fri, Jul 9, 2021 at 11:57 AM Greg Minshall <minshall at umich.edu> wrote:
>
> Kai,
>
> > one more question, how can I know if the function is for column
> > manipulations or for vector?
>
> i still stumble around R code.  but, i'd say the following (and look
> forward to being corrected! :):
>
> 1.  a column, when extracted from a data frame, *is* a vector.
>
> 2.  maybe your question is "is a given function for a vector, or for a
>     data frame/matrix/array?".  if so, i think the only way is reading
>     the help information (?foo).
>
> 3.  sometimes, extracting the column as a vector from a data frame-like
>     object might be non-intuitive.  you might find reading ?"[" and
>     ?"[.data.frame" useful (as well as ?"[.data.table" if you use that
>     package).  also, the str() command can be helpful in understanding
>     what is happening.  (the lobstr:: package's sxp() function, as well
>     as more verbose .Internal(inspect()) can also give you insight.)
>
>     with the data.table:: package, for example, if "DT" is a data.table
>     object, with "x2" as a column, adding or leaving off quotation marks
>     for the column name can make all the difference between ending up
>     with a vector, or with a (much reduced) data table:
> ----
> > is.vector(DT[, x2])
> [1] TRUE
> > str(DT[, x2])
>  num [1:9] 32 32 32 32 32 32 32 32 32
> >
> > is.vector(DT[, "x2"])
> [1] FALSE
> > str(DT[, "x2"])
> Classes ?data.table? and 'data.frame':  9 obs. of  1 variable:
>  $ x2: num  32 32 32 32 32 32 32 32 32
>  - attr(*, ".internal.selfref")=<externalptr>
> ----
>
>     a second level of indexing may or may not help, mostly depending on
>     the use of '[' versus of '[['.  this can sometimes cause confusion
>     when you are learning the language.
> ----
> > str(DT[, "x2"][1])
> Classes ?data.table? and 'data.frame':  1 obs. of  1 variable:
>  $ x2: num 32
>  - attr(*, ".internal.selfref")=<externalptr>
> > str(DT[, "x2"][[1]])
>  num [1:9] 32 32 32 32 32 32 32 32 32
> ----
>
>     the tibble:: package (used in, e.g., the dplyr:: package) also
>     (always?) returns a single column as a non-vector.  again, a
>     second indexing with double '[[]]' can produce a vector.
> ----
> > DP <- tibble(DT)
> > is.vector(DP[, "x2"])
> [1] FALSE
> > is.vector(DP[, "x2"][[1]])
> [1] TRUE
> ----
>
>     but, note that a list of lists is also a vector:
> > is.vector(list(list(1), list(1,2,3)))
> [1] TRUE
> > str(list(list(1), list(1,2,3)))
> List of 2
>  $ :List of 1
>   ..$ : num 1
>  $ :List of 3
>   ..$ : num 1
>   ..$ : num 2
>   ..$ : num 3
>
>     etc.
>
> hth.  good luck learning!
>
> cheers, Greg
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Jul  9 23:51:16 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 09 Jul 2021 14:51:16 -0700
Subject: [R] problem for strsplit function
In-Reply-To: <CAGxFJbTDYcJuuQjWWPsq8nY8BJ1z3X8KeDtUhMvaw_mBe0yh0Q@mail.gmail.com>
References: <762548966.2994133.1625757865539@mail.yahoo.com>
 <812547.1625856998@apollo2.minshall.org>
 <CAGxFJbTDYcJuuQjWWPsq8nY8BJ1z3X8KeDtUhMvaw_mBe0yh0Q@mail.gmail.com>
Message-ID: <0C608992-5EA0-448A-8DC4-7B2833F7DD4D@dcn.davis.ca.us>

"Strictly speaking", Greg is correct, Bert.

https://cran.r-project.org/doc/manuals/r-release/R-lang.html#List-objects

Lists in R are vectors. What we colloquially refer to as "vectors" are more precisely referred to as "atomic vectors". And without a doubt, this "vector" nature of lists is a key underlying concept that explains why adding a dim attribute creates a matrix that can hold data frames. It is also a stumbling block for programmers from other languages that have things like linked lists.

On July 9, 2021 2:36:19 PM PDT, Bert Gunter <bgunter.4567 at gmail.com> wrote:
>"1.  a column, when extracted from a data frame, *is* a vector."
>Strictly speaking, this is false; it depends on exactly what is meant
>by "extracted." e.g.:
>
>> d <- data.frame(col1 = 1:3, col2 = letters[1:3])
>> v1 <- d[,2] ## a vector
>> v2 <- d[[2]] ## the same, i.e
>> identical(v1,v2)
>[1] TRUE
>> v3 <- d[2] ## a data.frame
>> v1
>[1] "a" "b" "c"  ## a character vector
>> v3
>  col2
>1    a
>2    b
>3    c
>> is.vector(v1)
>[1] TRUE
>> is.vector(v3)
>[1] FALSE
>> class(v3)  ## data.frame
>[1] "data.frame"
>## but
>> is.list(v3)
>[1] TRUE
>
>which is simply explained in ?data.frame (where else?!) by:
>"A data frame is a **list** [emphasis added] of variables of the same
>number of rows with unique row names, given class "data.frame". If no
>variables are included, the row names determine the number of rows."
>
>"2.  maybe your question is "is a given function for a vector, or for a
>    data frame/matrix/array?".  if so, i think the only way is reading
>    the help information (?foo)."
>
>Indeed! Is this not what the Help system is for?! But note also that
>the S3 class system may somewhat blur the issue: foo() may work
>appropriately and differently for different (S3) classes of objects. A
>detailed explanation of this behavior can be found in appropriate
>resources or (more tersely) via ?UseMethod .
>
>"you might find reading ?"[" and  ?"[.data.frame" useful"
>
>Not just 'useful" -- **essential** if you want to work in R, unless
>one gets this information via any of the numerous online tutorials,
>courses, or books that are available. The Help system is accurate and
>authoritative, but terse. I happen to like this mode of documentation,
>but others may prefer more extended expositions. I stand by this claim
>even if one chooses to use the "Tidyverse", data.table package, or
>other alternative frameworks for handling data. Again, others may
>disagree, but R is structured around these basics, and imo one remains
>ignorant of them at their peril.
>
>Cheers,
>Bert
>
>
>Bert Gunter
>
>"The trouble with having an open mind is that people keep coming along
>and sticking things into it."
>-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
>On Fri, Jul 9, 2021 at 11:57 AM Greg Minshall <minshall at umich.edu>
>wrote:
>>
>> Kai,
>>
>> > one more question, how can I know if the function is for column
>> > manipulations or for vector?
>>
>> i still stumble around R code.  but, i'd say the following (and look
>> forward to being corrected! :):
>>
>> 1.  a column, when extracted from a data frame, *is* a vector.
>>
>> 2.  maybe your question is "is a given function for a vector, or for
>a
>>     data frame/matrix/array?".  if so, i think the only way is
>reading
>>     the help information (?foo).
>>
>> 3.  sometimes, extracting the column as a vector from a data
>frame-like
>>     object might be non-intuitive.  you might find reading ?"[" and
>>     ?"[.data.frame" useful (as well as ?"[.data.table" if you use
>that
>>     package).  also, the str() command can be helpful in
>understanding
>>     what is happening.  (the lobstr:: package's sxp() function, as
>well
>>     as more verbose .Internal(inspect()) can also give you insight.)
>>
>>     with the data.table:: package, for example, if "DT" is a
>data.table
>>     object, with "x2" as a column, adding or leaving off quotation
>marks
>>     for the column name can make all the difference between ending up
>>     with a vector, or with a (much reduced) data table:
>> ----
>> > is.vector(DT[, x2])
>> [1] TRUE
>> > str(DT[, x2])
>>  num [1:9] 32 32 32 32 32 32 32 32 32
>> >
>> > is.vector(DT[, "x2"])
>> [1] FALSE
>> > str(DT[, "x2"])
>> Classes ?data.table? and 'data.frame':  9 obs. of  1 variable:
>>  $ x2: num  32 32 32 32 32 32 32 32 32
>>  - attr(*, ".internal.selfref")=<externalptr>
>> ----
>>
>>     a second level of indexing may or may not help, mostly depending
>on
>>     the use of '[' versus of '[['.  this can sometimes cause
>confusion
>>     when you are learning the language.
>> ----
>> > str(DT[, "x2"][1])
>> Classes ?data.table? and 'data.frame':  1 obs. of  1 variable:
>>  $ x2: num 32
>>  - attr(*, ".internal.selfref")=<externalptr>
>> > str(DT[, "x2"][[1]])
>>  num [1:9] 32 32 32 32 32 32 32 32 32
>> ----
>>
>>     the tibble:: package (used in, e.g., the dplyr:: package) also
>>     (always?) returns a single column as a non-vector.  again, a
>>     second indexing with double '[[]]' can produce a vector.
>> ----
>> > DP <- tibble(DT)
>> > is.vector(DP[, "x2"])
>> [1] FALSE
>> > is.vector(DP[, "x2"][[1]])
>> [1] TRUE
>> ----
>>
>>     but, note that a list of lists is also a vector:
>> > is.vector(list(list(1), list(1,2,3)))
>> [1] TRUE
>> > str(list(list(1), list(1,2,3)))
>> List of 2
>>  $ :List of 1
>>   ..$ : num 1
>>  $ :List of 3
>>   ..$ : num 1
>>   ..$ : num 2
>>   ..$ : num 3
>>
>>     etc.
>>
>> hth.  good luck learning!
>>
>> cheers, Greg
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Jul 10 00:05:41 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 9 Jul 2021 18:05:41 -0400
Subject: [R] problem for strsplit function
In-Reply-To: <0C608992-5EA0-448A-8DC4-7B2833F7DD4D@dcn.davis.ca.us>
References: <762548966.2994133.1625757865539@mail.yahoo.com>
 <812547.1625856998@apollo2.minshall.org>
 <CAGxFJbTDYcJuuQjWWPsq8nY8BJ1z3X8KeDtUhMvaw_mBe0yh0Q@mail.gmail.com>
 <0C608992-5EA0-448A-8DC4-7B2833F7DD4D@dcn.davis.ca.us>
Message-ID: <5f6bcd58-23c1-f6ce-7e36-9abd41fd72b8@gmail.com>

On 09/07/2021 5:51 p.m., Jeff Newmiller wrote:
> "Strictly speaking", Greg is correct, Bert.
> 
> https://cran.r-project.org/doc/manuals/r-release/R-lang.html#List-objects
> 
> Lists in R are vectors. What we colloquially refer to as "vectors" are more precisely referred to as "atomic vectors". And without a doubt, this "vector" nature of lists is a key underlying concept that explains why adding a dim attribute creates a matrix that can hold data frames. It is also a stumbling block for programmers from other languages that have things like linked lists.

I would also object to v3 (below) as "extracting" a column from d. 
"d[2]" doesn't extract anything, it "subsets" the data frame, so the 
result is a data frame, not what you get when you extract something from 
a data frame.

People don't realize that "x <- 1:10; y <- x[[3]]" is perfectly legal. 
That extracts the 3rd element (the number 3).  The problem is that R has 
no way to represent a scalar number, only a vector of numbers, so x[[3]] 
gets promoted to a vector containing that number when it is returned and 
assigned to y.

Lists are vectors of R objects, so if x is a list, x[[3]] is something 
that can be returned, and it is different from x[3].

Duncan Murdoch

> 
> On July 9, 2021 2:36:19 PM PDT, Bert Gunter <bgunter.4567 at gmail.com> wrote:
>> "1.  a column, when extracted from a data frame, *is* a vector."
>> Strictly speaking, this is false; it depends on exactly what is meant
>> by "extracted." e.g.:
>>
>>> d <- data.frame(col1 = 1:3, col2 = letters[1:3])
>>> v1 <- d[,2] ## a vector
>>> v2 <- d[[2]] ## the same, i.e
>>> identical(v1,v2)
>> [1] TRUE
>>> v3 <- d[2] ## a data.frame
>>> v1
>> [1] "a" "b" "c"  ## a character vector
>>> v3
>>   col2
>> 1    a
>> 2    b
>> 3    c
>>> is.vector(v1)
>> [1] TRUE
>>> is.vector(v3)
>> [1] FALSE
>>> class(v3)  ## data.frame
>> [1] "data.frame"
>> ## but
>>> is.list(v3)
>> [1] TRUE
>>
>> which is simply explained in ?data.frame (where else?!) by:
>> "A data frame is a **list** [emphasis added] of variables of the same
>> number of rows with unique row names, given class "data.frame". If no
>> variables are included, the row names determine the number of rows."
>>
>> "2.  maybe your question is "is a given function for a vector, or for a
>>     data frame/matrix/array?".  if so, i think the only way is reading
>>     the help information (?foo)."
>>
>> Indeed! Is this not what the Help system is for?! But note also that
>> the S3 class system may somewhat blur the issue: foo() may work
>> appropriately and differently for different (S3) classes of objects. A
>> detailed explanation of this behavior can be found in appropriate
>> resources or (more tersely) via ?UseMethod .
>>
>> "you might find reading ?"[" and  ?"[.data.frame" useful"
>>
>> Not just 'useful" -- **essential** if you want to work in R, unless
>> one gets this information via any of the numerous online tutorials,
>> courses, or books that are available. The Help system is accurate and
>> authoritative, but terse. I happen to like this mode of documentation,
>> but others may prefer more extended expositions. I stand by this claim
>> even if one chooses to use the "Tidyverse", data.table package, or
>> other alternative frameworks for handling data. Again, others may
>> disagree, but R is structured around these basics, and imo one remains
>> ignorant of them at their peril.
>>
>> Cheers,
>> Bert
>>
>>
>> Bert Gunter
>>
>> "The trouble with having an open mind is that people keep coming along
>> and sticking things into it."
>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>
>> On Fri, Jul 9, 2021 at 11:57 AM Greg Minshall <minshall at umich.edu>
>> wrote:
>>>
>>> Kai,
>>>
>>>> one more question, how can I know if the function is for column
>>>> manipulations or for vector?
>>>
>>> i still stumble around R code.  but, i'd say the following (and look
>>> forward to being corrected! :):
>>>
>>> 1.  a column, when extracted from a data frame, *is* a vector.
>>>
>>> 2.  maybe your question is "is a given function for a vector, or for
>> a
>>>      data frame/matrix/array?".  if so, i think the only way is
>> reading
>>>      the help information (?foo).
>>>
>>> 3.  sometimes, extracting the column as a vector from a data
>> frame-like
>>>      object might be non-intuitive.  you might find reading ?"[" and
>>>      ?"[.data.frame" useful (as well as ?"[.data.table" if you use
>> that
>>>      package).  also, the str() command can be helpful in
>> understanding
>>>      what is happening.  (the lobstr:: package's sxp() function, as
>> well
>>>      as more verbose .Internal(inspect()) can also give you insight.)
>>>
>>>      with the data.table:: package, for example, if "DT" is a
>> data.table
>>>      object, with "x2" as a column, adding or leaving off quotation
>> marks
>>>      for the column name can make all the difference between ending up
>>>      with a vector, or with a (much reduced) data table:
>>> ----
>>>> is.vector(DT[, x2])
>>> [1] TRUE
>>>> str(DT[, x2])
>>>   num [1:9] 32 32 32 32 32 32 32 32 32
>>>>
>>>> is.vector(DT[, "x2"])
>>> [1] FALSE
>>>> str(DT[, "x2"])
>>> Classes ?data.table? and 'data.frame':  9 obs. of  1 variable:
>>>   $ x2: num  32 32 32 32 32 32 32 32 32
>>>   - attr(*, ".internal.selfref")=<externalptr>
>>> ----
>>>
>>>      a second level of indexing may or may not help, mostly depending
>> on
>>>      the use of '[' versus of '[['.  this can sometimes cause
>> confusion
>>>      when you are learning the language.
>>> ----
>>>> str(DT[, "x2"][1])
>>> Classes ?data.table? and 'data.frame':  1 obs. of  1 variable:
>>>   $ x2: num 32
>>>   - attr(*, ".internal.selfref")=<externalptr>
>>>> str(DT[, "x2"][[1]])
>>>   num [1:9] 32 32 32 32 32 32 32 32 32
>>> ----
>>>
>>>      the tibble:: package (used in, e.g., the dplyr:: package) also
>>>      (always?) returns a single column as a non-vector.  again, a
>>>      second indexing with double '[[]]' can produce a vector.
>>> ----
>>>> DP <- tibble(DT)
>>>> is.vector(DP[, "x2"])
>>> [1] FALSE
>>>> is.vector(DP[, "x2"][[1]])
>>> [1] TRUE
>>> ----
>>>
>>>      but, note that a list of lists is also a vector:
>>>> is.vector(list(list(1), list(1,2,3)))
>>> [1] TRUE
>>>> str(list(list(1), list(1,2,3)))
>>> List of 2
>>>   $ :List of 1
>>>    ..$ : num 1
>>>   $ :List of 3
>>>    ..$ : num 1
>>>    ..$ : num 2
>>>    ..$ : num 3
>>>
>>>      etc.
>>>
>>> hth.  good luck learning!
>>>
>>> cheers, Greg
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>


From bgunter@4567 @end|ng |rom gm@||@com  Sat Jul 10 00:44:29 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 9 Jul 2021 15:44:29 -0700
Subject: [R] problem for strsplit function
In-Reply-To: <5f6bcd58-23c1-f6ce-7e36-9abd41fd72b8@gmail.com>
References: <762548966.2994133.1625757865539@mail.yahoo.com>
 <812547.1625856998@apollo2.minshall.org>
 <CAGxFJbTDYcJuuQjWWPsq8nY8BJ1z3X8KeDtUhMvaw_mBe0yh0Q@mail.gmail.com>
 <0C608992-5EA0-448A-8DC4-7B2833F7DD4D@dcn.davis.ca.us>
 <5f6bcd58-23c1-f6ce-7e36-9abd41fd72b8@gmail.com>
Message-ID: <CAGxFJbQMzjPsgendwBo+KAiw9pvJfmji+JvyNHthhkoM4Of_Qg@mail.gmail.com>

OK, I stand somewhat chastised.

But my point still is that what you get when you "extract" depends on
how you define "extract." Do note that ?"[" yields a help file titled
"Extract or Replace Parts of an object"; and afaics, the term "subset"
is not explicitly used as Duncan prefers. The relevant part of the
Help file says for "[" for recursive objects says: "Indexing by [ is
similar to atomic vectors and selects a list of the specified
element(s)."  That a data.frame is a list is explicitly stated, as I
noted; that lists are in fact vectors is also explicitly stated (?list
says: "Almost all lists in R internally are Generic Vectors") but then
one is stuck with: a data.frame is a list and therefore a vector, but
is.vector(d3) is FALSE. The explanation is explicit again in
?is.vector ("is.vector returns TRUE if x is a vector of the specified
mode having no attributes other than names. It returns FALSE
otherwise."). But I would say these issues are sufficiently murky that
my warning to be precise is not entirely inappropriate; unfortunately,
I may have made them more so. Sigh....

Cheers,
Bert



Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Fri, Jul 9, 2021 at 3:05 PM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>
> On 09/07/2021 5:51 p.m., Jeff Newmiller wrote:
> > "Strictly speaking", Greg is correct, Bert.
> >
> > https://cran.r-project.org/doc/manuals/r-release/R-lang.html#List-objects
> >
> > Lists in R are vectors. What we colloquially refer to as "vectors" are more precisely referred to as "atomic vectors". And without a doubt, this "vector" nature of lists is a key underlying concept that explains why adding a dim attribute creates a matrix that can hold data frames. It is also a stumbling block for programmers from other languages that have things like linked lists.
>
> I would also object to v3 (below) as "extracting" a column from d.
> "d[2]" doesn't extract anything, it "subsets" the data frame, so the
> result is a data frame, not what you get when you extract something from
> a data frame.
>
> People don't realize that "x <- 1:10; y <- x[[3]]" is perfectly legal.
> That extracts the 3rd element (the number 3).  The problem is that R has
> no way to represent a scalar number, only a vector of numbers, so x[[3]]
> gets promoted to a vector containing that number when it is returned and
> assigned to y.
>
> Lists are vectors of R objects, so if x is a list, x[[3]] is something
> that can be returned, and it is different from x[3].
>
> Duncan Murdoch
>
> >
> > On July 9, 2021 2:36:19 PM PDT, Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >> "1.  a column, when extracted from a data frame, *is* a vector."
> >> Strictly speaking, this is false; it depends on exactly what is meant
> >> by "extracted." e.g.:
> >>
> >>> d <- data.frame(col1 = 1:3, col2 = letters[1:3])
> >>> v1 <- d[,2] ## a vector
> >>> v2 <- d[[2]] ## the same, i.e
> >>> identical(v1,v2)
> >> [1] TRUE
> >>> v3 <- d[2] ## a data.frame
> >>> v1
> >> [1] "a" "b" "c"  ## a character vector
> >>> v3
> >>   col2
> >> 1    a
> >> 2    b
> >> 3    c
> >>> is.vector(v1)
> >> [1] TRUE
> >>> is.vector(v3)
> >> [1] FALSE
> >>> class(v3)  ## data.frame
> >> [1] "data.frame"
> >> ## but
> >>> is.list(v3)
> >> [1] TRUE
> >>
> >> which is simply explained in ?data.frame (where else?!) by:
> >> "A data frame is a **list** [emphasis added] of variables of the same
> >> number of rows with unique row names, given class "data.frame". If no
> >> variables are included, the row names determine the number of rows."
> >>
> >> "2.  maybe your question is "is a given function for a vector, or for a
> >>     data frame/matrix/array?".  if so, i think the only way is reading
> >>     the help information (?foo)."
> >>
> >> Indeed! Is this not what the Help system is for?! But note also that
> >> the S3 class system may somewhat blur the issue: foo() may work
> >> appropriately and differently for different (S3) classes of objects. A
> >> detailed explanation of this behavior can be found in appropriate
> >> resources or (more tersely) via ?UseMethod .
> >>
> >> "you might find reading ?"[" and  ?"[.data.frame" useful"
> >>
> >> Not just 'useful" -- **essential** if you want to work in R, unless
> >> one gets this information via any of the numerous online tutorials,
> >> courses, or books that are available. The Help system is accurate and
> >> authoritative, but terse. I happen to like this mode of documentation,
> >> but others may prefer more extended expositions. I stand by this claim
> >> even if one chooses to use the "Tidyverse", data.table package, or
> >> other alternative frameworks for handling data. Again, others may
> >> disagree, but R is structured around these basics, and imo one remains
> >> ignorant of them at their peril.
> >>
> >> Cheers,
> >> Bert
> >>
> >>
> >> Bert Gunter
> >>
> >> "The trouble with having an open mind is that people keep coming along
> >> and sticking things into it."
> >> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> >>
> >> On Fri, Jul 9, 2021 at 11:57 AM Greg Minshall <minshall at umich.edu>
> >> wrote:
> >>>
> >>> Kai,
> >>>
> >>>> one more question, how can I know if the function is for column
> >>>> manipulations or for vector?
> >>>
> >>> i still stumble around R code.  but, i'd say the following (and look
> >>> forward to being corrected! :):
> >>>
> >>> 1.  a column, when extracted from a data frame, *is* a vector.
> >>>
> >>> 2.  maybe your question is "is a given function for a vector, or for
> >> a
> >>>      data frame/matrix/array?".  if so, i think the only way is
> >> reading
> >>>      the help information (?foo).
> >>>
> >>> 3.  sometimes, extracting the column as a vector from a data
> >> frame-like
> >>>      object might be non-intuitive.  you might find reading ?"[" and
> >>>      ?"[.data.frame" useful (as well as ?"[.data.table" if you use
> >> that
> >>>      package).  also, the str() command can be helpful in
> >> understanding
> >>>      what is happening.  (the lobstr:: package's sxp() function, as
> >> well
> >>>      as more verbose .Internal(inspect()) can also give you insight.)
> >>>
> >>>      with the data.table:: package, for example, if "DT" is a
> >> data.table
> >>>      object, with "x2" as a column, adding or leaving off quotation
> >> marks
> >>>      for the column name can make all the difference between ending up
> >>>      with a vector, or with a (much reduced) data table:
> >>> ----
> >>>> is.vector(DT[, x2])
> >>> [1] TRUE
> >>>> str(DT[, x2])
> >>>   num [1:9] 32 32 32 32 32 32 32 32 32
> >>>>
> >>>> is.vector(DT[, "x2"])
> >>> [1] FALSE
> >>>> str(DT[, "x2"])
> >>> Classes ?data.table? and 'data.frame':  9 obs. of  1 variable:
> >>>   $ x2: num  32 32 32 32 32 32 32 32 32
> >>>   - attr(*, ".internal.selfref")=<externalptr>
> >>> ----
> >>>
> >>>      a second level of indexing may or may not help, mostly depending
> >> on
> >>>      the use of '[' versus of '[['.  this can sometimes cause
> >> confusion
> >>>      when you are learning the language.
> >>> ----
> >>>> str(DT[, "x2"][1])
> >>> Classes ?data.table? and 'data.frame':  1 obs. of  1 variable:
> >>>   $ x2: num 32
> >>>   - attr(*, ".internal.selfref")=<externalptr>
> >>>> str(DT[, "x2"][[1]])
> >>>   num [1:9] 32 32 32 32 32 32 32 32 32
> >>> ----
> >>>
> >>>      the tibble:: package (used in, e.g., the dplyr:: package) also
> >>>      (always?) returns a single column as a non-vector.  again, a
> >>>      second indexing with double '[[]]' can produce a vector.
> >>> ----
> >>>> DP <- tibble(DT)
> >>>> is.vector(DP[, "x2"])
> >>> [1] FALSE
> >>>> is.vector(DP[, "x2"][[1]])
> >>> [1] TRUE
> >>> ----
> >>>
> >>>      but, note that a list of lists is also a vector:
> >>>> is.vector(list(list(1), list(1,2,3)))
> >>> [1] TRUE
> >>>> str(list(list(1), list(1,2,3)))
> >>> List of 2
> >>>   $ :List of 1
> >>>    ..$ : num 1
> >>>   $ :List of 3
> >>>    ..$ : num 1
> >>>    ..$ : num 2
> >>>    ..$ : num 3
> >>>
> >>>      etc.
> >>>
> >>> hth.  good luck learning!
> >>>
> >>> cheers, Greg
> >>>
> >>> ______________________________________________
> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>> PLEASE do read the posting guide
> >> http://www.R-project.org/posting-guide.html
> >>> and provide commented, minimal, self-contained, reproducible code.
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> >> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >
>


From y@ngk@|9999 @end|ng |rom y@hoo@com  Sat Jul 10 00:45:35 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Fri, 9 Jul 2021 22:45:35 +0000 (UTC)
Subject: [R] problem for strsplit function
In-Reply-To: <5f6bcd58-23c1-f6ce-7e36-9abd41fd72b8@gmail.com>
References: <762548966.2994133.1625757865539@mail.yahoo.com>
 <812547.1625856998@apollo2.minshall.org>
 <CAGxFJbTDYcJuuQjWWPsq8nY8BJ1z3X8KeDtUhMvaw_mBe0yh0Q@mail.gmail.com>
 <0C608992-5EA0-448A-8DC4-7B2833F7DD4D@dcn.davis.ca.us>
 <5f6bcd58-23c1-f6ce-7e36-9abd41fd72b8@gmail.com>
Message-ID: <683060686.1903725.1625870735640@mail.yahoo.com>

 Thanks Bert,
I'm reading some books now. But it takes me a while to get familiar R.

Best,
Kai    On Friday, July 9, 2021, 03:06:11 PM PDT, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:  
 
 On 09/07/2021 5:51 p.m., Jeff Newmiller wrote:
> "Strictly speaking", Greg is correct, Bert.
> 
> https://cran.r-project.org/doc/manuals/r-release/R-lang.html#List-objects
> 
> Lists in R are vectors. What we colloquially refer to as "vectors" are more precisely referred to as "atomic vectors". And without a doubt, this "vector" nature of lists is a key underlying concept that explains why adding a dim attribute creates a matrix that can hold data frames. It is also a stumbling block for programmers from other languages that have things like linked lists.

I would also object to v3 (below) as "extracting" a column from d. 
"d[2]" doesn't extract anything, it "subsets" the data frame, so the 
result is a data frame, not what you get when you extract something from 
a data frame.

People don't realize that "x <- 1:10; y <- x[[3]]" is perfectly legal. 
That extracts the 3rd element (the number 3).? The problem is that R has 
no way to represent a scalar number, only a vector of numbers, so x[[3]] 
gets promoted to a vector containing that number when it is returned and 
assigned to y.

Lists are vectors of R objects, so if x is a list, x[[3]] is something 
that can be returned, and it is different from x[3].

Duncan Murdoch

> 
> On July 9, 2021 2:36:19 PM PDT, Bert Gunter <bgunter.4567 at gmail.com> wrote:
>> "1.? a column, when extracted from a data frame, *is* a vector."
>> Strictly speaking, this is false; it depends on exactly what is meant
>> by "extracted." e.g.:
>>
>>> d <- data.frame(col1 = 1:3, col2 = letters[1:3])
>>> v1 <- d[,2] ## a vector
>>> v2 <- d[[2]] ## the same, i.e
>>> identical(v1,v2)
>> [1] TRUE
>>> v3 <- d[2] ## a data.frame
>>> v1
>> [1] "a" "b" "c"? ## a character vector
>>> v3
>>? col2
>> 1? ? a
>> 2? ? b
>> 3? ? c
>>> is.vector(v1)
>> [1] TRUE
>>> is.vector(v3)
>> [1] FALSE
>>> class(v3)? ## data.frame
>> [1] "data.frame"
>> ## but
>>> is.list(v3)
>> [1] TRUE
>>
>> which is simply explained in ?data.frame (where else?!) by:
>> "A data frame is a **list** [emphasis added] of variables of the same
>> number of rows with unique row names, given class "data.frame". If no
>> variables are included, the row names determine the number of rows."
>>
>> "2.? maybe your question is "is a given function for a vector, or for a
>>? ? data frame/matrix/array?".? if so, i think the only way is reading
>>? ? the help information (?foo)."
>>
>> Indeed! Is this not what the Help system is for?! But note also that
>> the S3 class system may somewhat blur the issue: foo() may work
>> appropriately and differently for different (S3) classes of objects. A
>> detailed explanation of this behavior can be found in appropriate
>> resources or (more tersely) via ?UseMethod .
>>
>> "you might find reading ?"[" and? ?"[.data.frame" useful"
>>
>> Not just 'useful" -- **essential** if you want to work in R, unless
>> one gets this information via any of the numerous online tutorials,
>> courses, or books that are available. The Help system is accurate and
>> authoritative, but terse. I happen to like this mode of documentation,
>> but others may prefer more extended expositions. I stand by this claim
>> even if one chooses to use the "Tidyverse", data.table package, or
>> other alternative frameworks for handling data. Again, others may
>> disagree, but R is structured around these basics, and imo one remains
>> ignorant of them at their peril.
>>
>> Cheers,
>> Bert
>>
>>
>> Bert Gunter
>>
>> "The trouble with having an open mind is that people keep coming along
>> and sticking things into it."
>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>
>> On Fri, Jul 9, 2021 at 11:57 AM Greg Minshall <minshall at umich.edu>
>> wrote:
>>>
>>> Kai,
>>>
>>>> one more question, how can I know if the function is for column
>>>> manipulations or for vector?
>>>
>>> i still stumble around R code.? but, i'd say the following (and look
>>> forward to being corrected! :):
>>>
>>> 1.? a column, when extracted from a data frame, *is* a vector.
>>>
>>> 2.? maybe your question is "is a given function for a vector, or for
>> a
>>>? ? ? data frame/matrix/array?".? if so, i think the only way is
>> reading
>>>? ? ? the help information (?foo).
>>>
>>> 3.? sometimes, extracting the column as a vector from a data
>> frame-like
>>>? ? ? object might be non-intuitive.? you might find reading ?"[" and
>>>? ? ? ?"[.data.frame" useful (as well as ?"[.data.table" if you use
>> that
>>>? ? ? package).? also, the str() command can be helpful in
>> understanding
>>>? ? ? what is happening.? (the lobstr:: package's sxp() function, as
>> well
>>>? ? ? as more verbose .Internal(inspect()) can also give you insight.)
>>>
>>>? ? ? with the data.table:: package, for example, if "DT" is a
>> data.table
>>>? ? ? object, with "x2" as a column, adding or leaving off quotation
>> marks
>>>? ? ? for the column name can make all the difference between ending up
>>>? ? ? with a vector, or with a (much reduced) data table:
>>> ----
>>>> is.vector(DT[, x2])
>>> [1] TRUE
>>>> str(DT[, x2])
>>>? num [1:9] 32 32 32 32 32 32 32 32 32
>>>>
>>>> is.vector(DT[, "x2"])
>>> [1] FALSE
>>>> str(DT[, "x2"])
>>> Classes ?data.table? and 'data.frame':? 9 obs. of? 1 variable:
>>>? $ x2: num? 32 32 32 32 32 32 32 32 32
>>>? - attr(*, ".internal.selfref")=<externalptr>
>>> ----
>>>
>>>? ? ? a second level of indexing may or may not help, mostly depending
>> on
>>>? ? ? the use of '[' versus of '[['.? this can sometimes cause
>> confusion
>>>? ? ? when you are learning the language.
>>> ----
>>>> str(DT[, "x2"][1])
>>> Classes ?data.table? and 'data.frame':? 1 obs. of? 1 variable:
>>>? $ x2: num 32
>>>? - attr(*, ".internal.selfref")=<externalptr>
>>>> str(DT[, "x2"][[1]])
>>>? num [1:9] 32 32 32 32 32 32 32 32 32
>>> ----
>>>
>>>? ? ? the tibble:: package (used in, e.g., the dplyr:: package) also
>>>? ? ? (always?) returns a single column as a non-vector.? again, a
>>>? ? ? second indexing with double '[[]]' can produce a vector.
>>> ----
>>>> DP <- tibble(DT)
>>>> is.vector(DP[, "x2"])
>>> [1] FALSE
>>>> is.vector(DP[, "x2"][[1]])
>>> [1] TRUE
>>> ----
>>>
>>>? ? ? but, note that a list of lists is also a vector:
>>>> is.vector(list(list(1), list(1,2,3)))
>>> [1] TRUE
>>>> str(list(list(1), list(1,2,3)))
>>> List of 2
>>>? $ :List of 1
>>>? ? ..$ : num 1
>>>? $ :List of 3
>>>? ? ..$ : num 1
>>>? ? ..$ : num 2
>>>? ? ..$ : num 3
>>>
>>>? ? ? etc.
>>>
>>> hth.? good luck learning!
>>>
>>> cheers, Greg
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.
  
	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Sat Jul 10 00:48:42 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 9 Jul 2021 15:48:42 -0700
Subject: [R] problem for strsplit function
In-Reply-To: <683060686.1903725.1625870735640@mail.yahoo.com>
References: <762548966.2994133.1625757865539@mail.yahoo.com>
 <812547.1625856998@apollo2.minshall.org>
 <CAGxFJbTDYcJuuQjWWPsq8nY8BJ1z3X8KeDtUhMvaw_mBe0yh0Q@mail.gmail.com>
 <0C608992-5EA0-448A-8DC4-7B2833F7DD4D@dcn.davis.ca.us>
 <5f6bcd58-23c1-f6ce-7e36-9abd41fd72b8@gmail.com>
 <683060686.1903725.1625870735640@mail.yahoo.com>
Message-ID: <CAGxFJbS2uEg=bP+vFmoR9Vksnf0aaprOiDhX-DnxzGVkySttQQ@mail.gmail.com>

"But it takes me a while to get familiar R."

Of course. That is true for all of us. Just keep on plugging away and
you'll get it. Probably far better than I before too long.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Fri, Jul 9, 2021 at 3:45 PM Kai Yang <yangkai9999 at yahoo.com> wrote:
>
> Thanks Bert,
>
> I'm reading some books now. But it takes me a while to get familiar R.
>
>
> Best,
>
> Kai
> On Friday, July 9, 2021, 03:06:11 PM PDT, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>
>
> On 09/07/2021 5:51 p.m., Jeff Newmiller wrote:
> > "Strictly speaking", Greg is correct, Bert.
> >
> > https://cran.r-project.org/doc/manuals/r-release/R-lang.html#List-objects
> >
> > Lists in R are vectors. What we colloquially refer to as "vectors" are more precisely referred to as "atomic vectors". And without a doubt, this "vector" nature of lists is a key underlying concept that explains why adding a dim attribute creates a matrix that can hold data frames. It is also a stumbling block for programmers from other languages that have things like linked lists.
>
> I would also object to v3 (below) as "extracting" a column from d.
> "d[2]" doesn't extract anything, it "subsets" the data frame, so the
> result is a data frame, not what you get when you extract something from
> a data frame.
>
> People don't realize that "x <- 1:10; y <- x[[3]]" is perfectly legal.
> That extracts the 3rd element (the number 3).  The problem is that R has
> no way to represent a scalar number, only a vector of numbers, so x[[3]]
> gets promoted to a vector containing that number when it is returned and
> assigned to y.
>
> Lists are vectors of R objects, so if x is a list, x[[3]] is something
> that can be returned, and it is different from x[3].
>
> Duncan Murdoch
>
>
> >
> > On July 9, 2021 2:36:19 PM PDT, Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >> "1.  a column, when extracted from a data frame, *is* a vector."
> >> Strictly speaking, this is false; it depends on exactly what is meant
> >> by "extracted." e.g.:
> >>
> >>> d <- data.frame(col1 = 1:3, col2 = letters[1:3])
> >>> v1 <- d[,2] ## a vector
> >>> v2 <- d[[2]] ## the same, i.e
> >>> identical(v1,v2)
> >> [1] TRUE
> >>> v3 <- d[2] ## a data.frame
> >>> v1
> >> [1] "a" "b" "c"  ## a character vector
> >>> v3
> >>  col2
> >> 1    a
> >> 2    b
> >> 3    c
> >>> is.vector(v1)
> >> [1] TRUE
> >>> is.vector(v3)
> >> [1] FALSE
> >>> class(v3)  ## data.frame
> >> [1] "data.frame"
> >> ## but
> >>> is.list(v3)
> >> [1] TRUE
> >>
> >> which is simply explained in ?data.frame (where else?!) by:
> >> "A data frame is a **list** [emphasis added] of variables of the same
> >> number of rows with unique row names, given class "data.frame". If no
> >> variables are included, the row names determine the number of rows."
> >>
> >> "2.  maybe your question is "is a given function for a vector, or for a
> >>    data frame/matrix/array?".  if so, i think the only way is reading
> >>    the help information (?foo)."
> >>
> >> Indeed! Is this not what the Help system is for?! But note also that
> >> the S3 class system may somewhat blur the issue: foo() may work
> >> appropriately and differently for different (S3) classes of objects. A
> >> detailed explanation of this behavior can be found in appropriate
> >> resources or (more tersely) via ?UseMethod .
> >>
> >> "you might find reading ?"[" and  ?"[.data.frame" useful"
> >>
> >> Not just 'useful" -- **essential** if you want to work in R, unless
> >> one gets this information via any of the numerous online tutorials,
> >> courses, or books that are available. The Help system is accurate and
> >> authoritative, but terse. I happen to like this mode of documentation,
> >> but others may prefer more extended expositions. I stand by this claim
> >> even if one chooses to use the "Tidyverse", data.table package, or
> >> other alternative frameworks for handling data. Again, others may
> >> disagree, but R is structured around these basics, and imo one remains
> >> ignorant of them at their peril.
> >>
> >> Cheers,
> >> Bert
> >>
> >>
> >> Bert Gunter
> >>
> >> "The trouble with having an open mind is that people keep coming along
> >> and sticking things into it."
> >> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> >>
> >> On Fri, Jul 9, 2021 at 11:57 AM Greg Minshall <minshall at umich.edu>
> >> wrote:
> >>>
> >>> Kai,
> >>>
> >>>> one more question, how can I know if the function is for column
> >>>> manipulations or for vector?
> >>>
> >>> i still stumble around R code.  but, i'd say the following (and look
> >>> forward to being corrected! :):
> >>>
> >>> 1.  a column, when extracted from a data frame, *is* a vector.
> >>>
> >>> 2.  maybe your question is "is a given function for a vector, or for
> >> a
> >>>      data frame/matrix/array?".  if so, i think the only way is
> >> reading
> >>>      the help information (?foo).
> >>>
> >>> 3.  sometimes, extracting the column as a vector from a data
> >> frame-like
> >>>      object might be non-intuitive.  you might find reading ?"[" and
> >>>      ?"[.data.frame" useful (as well as ?"[.data.table" if you use
> >> that
> >>>      package).  also, the str() command can be helpful in
> >> understanding
> >>>      what is happening.  (the lobstr:: package's sxp() function, as
> >> well
> >>>      as more verbose .Internal(inspect()) can also give you insight.)
> >>>
> >>>      with the data.table:: package, for example, if "DT" is a
> >> data.table
> >>>      object, with "x2" as a column, adding or leaving off quotation
> >> marks
> >>>      for the column name can make all the difference between ending up
> >>>      with a vector, or with a (much reduced) data table:
> >>> ----
> >>>> is.vector(DT[, x2])
> >>> [1] TRUE
> >>>> str(DT[, x2])
> >>>  num [1:9] 32 32 32 32 32 32 32 32 32
> >>>>
> >>>> is.vector(DT[, "x2"])
> >>> [1] FALSE
> >>>> str(DT[, "x2"])
> >>> Classes ?data.table? and 'data.frame':  9 obs. of  1 variable:
> >>>  $ x2: num  32 32 32 32 32 32 32 32 32
> >>>  - attr(*, ".internal.selfref")=<externalptr>
> >>> ----
> >>>
> >>>      a second level of indexing may or may not help, mostly depending
> >> on
> >>>      the use of '[' versus of '[['.  this can sometimes cause
> >> confusion
> >>>      when you are learning the language.
> >>> ----
> >>>> str(DT[, "x2"][1])
> >>> Classes ?data.table? and 'data.frame':  1 obs. of  1 variable:
> >>>  $ x2: num 32
> >>>  - attr(*, ".internal.selfref")=<externalptr>
> >>>> str(DT[, "x2"][[1]])
> >>>  num [1:9] 32 32 32 32 32 32 32 32 32
> >>> ----
> >>>
> >>>      the tibble:: package (used in, e.g., the dplyr:: package) also
> >>>      (always?) returns a single column as a non-vector.  again, a
> >>>      second indexing with double '[[]]' can produce a vector.
> >>> ----
> >>>> DP <- tibble(DT)
> >>>> is.vector(DP[, "x2"])
> >>> [1] FALSE
> >>>> is.vector(DP[, "x2"][[1]])
> >>> [1] TRUE
> >>> ----
> >>>
> >>>      but, note that a list of lists is also a vector:
> >>>> is.vector(list(list(1), list(1,2,3)))
> >>> [1] TRUE
> >>>> str(list(list(1), list(1,2,3)))
> >>> List of 2
> >>>  $ :List of 1
> >>>    ..$ : num 1
> >>>  $ :List of 3
> >>>    ..$ : num 1
> >>>    ..$ : num 2
> >>>    ..$ : num 3
> >>>
> >>>      etc.
> >>>
> >>> hth.  good luck learning!
> >>>
> >>> cheers, Greg
> >>>
> >>> ______________________________________________
> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>> PLEASE do read the posting guide
> >> http://www.R-project.org/posting-guide.html
> >>> and provide commented, minimal, self-contained, reproducible code.
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> >> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Jul 10 02:16:13 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 9 Jul 2021 20:16:13 -0400
Subject: [R] problem for strsplit function
In-Reply-To: <CAGxFJbQMzjPsgendwBo+KAiw9pvJfmji+JvyNHthhkoM4Of_Qg@mail.gmail.com>
References: <762548966.2994133.1625757865539@mail.yahoo.com>
 <812547.1625856998@apollo2.minshall.org>
 <CAGxFJbTDYcJuuQjWWPsq8nY8BJ1z3X8KeDtUhMvaw_mBe0yh0Q@mail.gmail.com>
 <0C608992-5EA0-448A-8DC4-7B2833F7DD4D@dcn.davis.ca.us>
 <5f6bcd58-23c1-f6ce-7e36-9abd41fd72b8@gmail.com>
 <CAGxFJbQMzjPsgendwBo+KAiw9pvJfmji+JvyNHthhkoM4Of_Qg@mail.gmail.com>
Message-ID: <7df62a55-b555-1a00-fd2e-baebc5dcc305@gmail.com>

On 09/07/2021 6:44 p.m., Bert Gunter wrote:
> OK, I stand somewhat chastised.
> 
> But my point still is that what you get when you "extract" depends on
> how you define "extract." Do note that ?"[" yields a help file titled
> "Extract or Replace Parts of an object"; and afaics, the term "subset"
> is not explicitly used as Duncan prefers.

?"[[" gives you the same page, but I agree:  this part of the 
documentation isn't written very clearly. The "Introduction to R" manual 
uses the terms I used (see section 2.7, "Index vectors; selecting and 
modifying subsets of a data set"), as does the source code (and the R 
Language Definition manual, though it's not as clear as the Intro).

But the point isn't to chastise you, it's to educate you (and the OP). 
Thinking of [] as subsetting is more helpful than thinking of it as 
extraction.  That way the result of x[c(1,2)] makes sense.  It's a 
little bit more of a stretch, but the result of x[[c(1,2)]] also makes 
sense when you think of it as extraction.

Duncan Murdoch

  The relevant part of the
> Help file says for "[" for recursive objects says: "Indexing by [ is
> similar to atomic vectors and selects a list of the specified
> element(s)."  That a data.frame is a list is explicitly stated, as I
> noted; that lists are in fact vectors is also explicitly stated (?list
> says: "Almost all lists in R internally are Generic Vectors") but then
> one is stuck with: a data.frame is a list and therefore a vector, but
> is.vector(d3) is FALSE. The explanation is explicit again in
> ?is.vector ("is.vector returns TRUE if x is a vector of the specified
> mode having no attributes other than names. It returns FALSE
> otherwise."). But I would say these issues are sufficiently murky that
> my warning to be precise is not entirely inappropriate; unfortunately,
> I may have made them more so. Sigh....
> 
> Cheers,
> Bert
> 
> 
> 
> Bert Gunter
> 
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> 
> On Fri, Jul 9, 2021 at 3:05 PM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>
>> On 09/07/2021 5:51 p.m., Jeff Newmiller wrote:
>>> "Strictly speaking", Greg is correct, Bert.
>>>
>>> https://cran.r-project.org/doc/manuals/r-release/R-lang.html#List-objects
>>>
>>> Lists in R are vectors. What we colloquially refer to as "vectors" are more precisely referred to as "atomic vectors". And without a doubt, this "vector" nature of lists is a key underlying concept that explains why adding a dim attribute creates a matrix that can hold data frames. It is also a stumbling block for programmers from other languages that have things like linked lists.
>>
>> I would also object to v3 (below) as "extracting" a column from d.
>> "d[2]" doesn't extract anything, it "subsets" the data frame, so the
>> result is a data frame, not what you get when you extract something from
>> a data frame.
>>
>> People don't realize that "x <- 1:10; y <- x[[3]]" is perfectly legal.
>> That extracts the 3rd element (the number 3).  The problem is that R has
>> no way to represent a scalar number, only a vector of numbers, so x[[3]]
>> gets promoted to a vector containing that number when it is returned and
>> assigned to y.
>>
>> Lists are vectors of R objects, so if x is a list, x[[3]] is something
>> that can be returned, and it is different from x[3].
>>
>> Duncan Murdoch
>>
>>>
>>> On July 9, 2021 2:36:19 PM PDT, Bert Gunter <bgunter.4567 at gmail.com> wrote:
>>>> "1.  a column, when extracted from a data frame, *is* a vector."
>>>> Strictly speaking, this is false; it depends on exactly what is meant
>>>> by "extracted." e.g.:
>>>>
>>>>> d <- data.frame(col1 = 1:3, col2 = letters[1:3])
>>>>> v1 <- d[,2] ## a vector
>>>>> v2 <- d[[2]] ## the same, i.e
>>>>> identical(v1,v2)
>>>> [1] TRUE
>>>>> v3 <- d[2] ## a data.frame
>>>>> v1
>>>> [1] "a" "b" "c"  ## a character vector
>>>>> v3
>>>>    col2
>>>> 1    a
>>>> 2    b
>>>> 3    c
>>>>> is.vector(v1)
>>>> [1] TRUE
>>>>> is.vector(v3)
>>>> [1] FALSE
>>>>> class(v3)  ## data.frame
>>>> [1] "data.frame"
>>>> ## but
>>>>> is.list(v3)
>>>> [1] TRUE
>>>>
>>>> which is simply explained in ?data.frame (where else?!) by:
>>>> "A data frame is a **list** [emphasis added] of variables of the same
>>>> number of rows with unique row names, given class "data.frame". If no
>>>> variables are included, the row names determine the number of rows."
>>>>
>>>> "2.  maybe your question is "is a given function for a vector, or for a
>>>>      data frame/matrix/array?".  if so, i think the only way is reading
>>>>      the help information (?foo)."
>>>>
>>>> Indeed! Is this not what the Help system is for?! But note also that
>>>> the S3 class system may somewhat blur the issue: foo() may work
>>>> appropriately and differently for different (S3) classes of objects. A
>>>> detailed explanation of this behavior can be found in appropriate
>>>> resources or (more tersely) via ?UseMethod .
>>>>
>>>> "you might find reading ?"[" and  ?"[.data.frame" useful"
>>>>
>>>> Not just 'useful" -- **essential** if you want to work in R, unless
>>>> one gets this information via any of the numerous online tutorials,
>>>> courses, or books that are available. The Help system is accurate and
>>>> authoritative, but terse. I happen to like this mode of documentation,
>>>> but others may prefer more extended expositions. I stand by this claim
>>>> even if one chooses to use the "Tidyverse", data.table package, or
>>>> other alternative frameworks for handling data. Again, others may
>>>> disagree, but R is structured around these basics, and imo one remains
>>>> ignorant of them at their peril.
>>>>
>>>> Cheers,
>>>> Bert
>>>>
>>>>
>>>> Bert Gunter
>>>>
>>>> "The trouble with having an open mind is that people keep coming along
>>>> and sticking things into it."
>>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>>>
>>>> On Fri, Jul 9, 2021 at 11:57 AM Greg Minshall <minshall at umich.edu>
>>>> wrote:
>>>>>
>>>>> Kai,
>>>>>
>>>>>> one more question, how can I know if the function is for column
>>>>>> manipulations or for vector?
>>>>>
>>>>> i still stumble around R code.  but, i'd say the following (and look
>>>>> forward to being corrected! :):
>>>>>
>>>>> 1.  a column, when extracted from a data frame, *is* a vector.
>>>>>
>>>>> 2.  maybe your question is "is a given function for a vector, or for
>>>> a
>>>>>       data frame/matrix/array?".  if so, i think the only way is
>>>> reading
>>>>>       the help information (?foo).
>>>>>
>>>>> 3.  sometimes, extracting the column as a vector from a data
>>>> frame-like
>>>>>       object might be non-intuitive.  you might find reading ?"[" and
>>>>>       ?"[.data.frame" useful (as well as ?"[.data.table" if you use
>>>> that
>>>>>       package).  also, the str() command can be helpful in
>>>> understanding
>>>>>       what is happening.  (the lobstr:: package's sxp() function, as
>>>> well
>>>>>       as more verbose .Internal(inspect()) can also give you insight.)
>>>>>
>>>>>       with the data.table:: package, for example, if "DT" is a
>>>> data.table
>>>>>       object, with "x2" as a column, adding or leaving off quotation
>>>> marks
>>>>>       for the column name can make all the difference between ending up
>>>>>       with a vector, or with a (much reduced) data table:
>>>>> ----
>>>>>> is.vector(DT[, x2])
>>>>> [1] TRUE
>>>>>> str(DT[, x2])
>>>>>    num [1:9] 32 32 32 32 32 32 32 32 32
>>>>>>
>>>>>> is.vector(DT[, "x2"])
>>>>> [1] FALSE
>>>>>> str(DT[, "x2"])
>>>>> Classes ?data.table? and 'data.frame':  9 obs. of  1 variable:
>>>>>    $ x2: num  32 32 32 32 32 32 32 32 32
>>>>>    - attr(*, ".internal.selfref")=<externalptr>
>>>>> ----
>>>>>
>>>>>       a second level of indexing may or may not help, mostly depending
>>>> on
>>>>>       the use of '[' versus of '[['.  this can sometimes cause
>>>> confusion
>>>>>       when you are learning the language.
>>>>> ----
>>>>>> str(DT[, "x2"][1])
>>>>> Classes ?data.table? and 'data.frame':  1 obs. of  1 variable:
>>>>>    $ x2: num 32
>>>>>    - attr(*, ".internal.selfref")=<externalptr>
>>>>>> str(DT[, "x2"][[1]])
>>>>>    num [1:9] 32 32 32 32 32 32 32 32 32
>>>>> ----
>>>>>
>>>>>       the tibble:: package (used in, e.g., the dplyr:: package) also
>>>>>       (always?) returns a single column as a non-vector.  again, a
>>>>>       second indexing with double '[[]]' can produce a vector.
>>>>> ----
>>>>>> DP <- tibble(DT)
>>>>>> is.vector(DP[, "x2"])
>>>>> [1] FALSE
>>>>>> is.vector(DP[, "x2"][[1]])
>>>>> [1] TRUE
>>>>> ----
>>>>>
>>>>>       but, note that a list of lists is also a vector:
>>>>>> is.vector(list(list(1), list(1,2,3)))
>>>>> [1] TRUE
>>>>>> str(list(list(1), list(1,2,3)))
>>>>> List of 2
>>>>>    $ :List of 1
>>>>>     ..$ : num 1
>>>>>    $ :List of 3
>>>>>     ..$ : num 1
>>>>>     ..$ : num 2
>>>>>     ..$ : num 3
>>>>>
>>>>>       etc.
>>>>>
>>>>> hth.  good luck learning!
>>>>>
>>>>> cheers, Greg
>>>>>
>>>>> ______________________________________________
>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sat Jul 10 02:31:36 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 09 Jul 2021 17:31:36 -0700
Subject: [R] problem for strsplit function
In-Reply-To: <CAGxFJbQMzjPsgendwBo+KAiw9pvJfmji+JvyNHthhkoM4Of_Qg@mail.gmail.com>
References: <762548966.2994133.1625757865539@mail.yahoo.com>
 <812547.1625856998@apollo2.minshall.org>
 <CAGxFJbTDYcJuuQjWWPsq8nY8BJ1z3X8KeDtUhMvaw_mBe0yh0Q@mail.gmail.com>
 <0C608992-5EA0-448A-8DC4-7B2833F7DD4D@dcn.davis.ca.us>
 <5f6bcd58-23c1-f6ce-7e36-9abd41fd72b8@gmail.com>
 <CAGxFJbQMzjPsgendwBo+KAiw9pvJfmji+JvyNHthhkoM4Of_Qg@mail.gmail.com>
Message-ID: <FB73E808-E433-491D-ACC2-D304843C8B91@dcn.davis.ca.us>

My mental model for the `[` vs `[[` behavior is that `[` indexes multiple results while `[[` indexes only one item. If returning multiple items from a list the result must be a list. For consistency, `[` always returns a list when applied to a list. The double bracket drops the containing list.

The is.vector() behavior is not intuitive to me... I avoid that function, as I think it is more useful to think of lists as vectors than as something "other".

On July 9, 2021 3:44:29 PM PDT, Bert Gunter <bgunter.4567 at gmail.com> wrote:
>OK, I stand somewhat chastised.
>
>But my point still is that what you get when you "extract" depends on
>how you define "extract." Do note that ?"[" yields a help file titled
>"Extract or Replace Parts of an object"; and afaics, the term "subset"
>is not explicitly used as Duncan prefers. The relevant part of the
>Help file says for "[" for recursive objects says: "Indexing by [ is
>similar to atomic vectors and selects a list of the specified
>element(s)."  That a data.frame is a list is explicitly stated, as I
>noted; that lists are in fact vectors is also explicitly stated (?list
>says: "Almost all lists in R internally are Generic Vectors") but then
>one is stuck with: a data.frame is a list and therefore a vector, but
>is.vector(d3) is FALSE. The explanation is explicit again in
>?is.vector ("is.vector returns TRUE if x is a vector of the specified
>mode having no attributes other than names. It returns FALSE
>otherwise."). But I would say these issues are sufficiently murky that
>my warning to be precise is not entirely inappropriate; unfortunately,
>I may have made them more so. Sigh....
>
>Cheers,
>Bert
>
>
>
>Bert Gunter
>
>"The trouble with having an open mind is that people keep coming along
>and sticking things into it."
>-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
>On Fri, Jul 9, 2021 at 3:05 PM Duncan Murdoch
><murdoch.duncan at gmail.com> wrote:
>>
>> On 09/07/2021 5:51 p.m., Jeff Newmiller wrote:
>> > "Strictly speaking", Greg is correct, Bert.
>> >
>> >
>https://cran.r-project.org/doc/manuals/r-release/R-lang.html#List-objects
>> >
>> > Lists in R are vectors. What we colloquially refer to as "vectors"
>are more precisely referred to as "atomic vectors". And without a
>doubt, this "vector" nature of lists is a key underlying concept that
>explains why adding a dim attribute creates a matrix that can hold data
>frames. It is also a stumbling block for programmers from other
>languages that have things like linked lists.
>>
>> I would also object to v3 (below) as "extracting" a column from d.
>> "d[2]" doesn't extract anything, it "subsets" the data frame, so the
>> result is a data frame, not what you get when you extract something
>from
>> a data frame.
>>
>> People don't realize that "x <- 1:10; y <- x[[3]]" is perfectly
>legal.
>> That extracts the 3rd element (the number 3).  The problem is that R
>has
>> no way to represent a scalar number, only a vector of numbers, so
>x[[3]]
>> gets promoted to a vector containing that number when it is returned
>and
>> assigned to y.
>>
>> Lists are vectors of R objects, so if x is a list, x[[3]] is
>something
>> that can be returned, and it is different from x[3].
>>
>> Duncan Murdoch
>>
>> >
>> > On July 9, 2021 2:36:19 PM PDT, Bert Gunter
><bgunter.4567 at gmail.com> wrote:
>> >> "1.  a column, when extracted from a data frame, *is* a vector."
>> >> Strictly speaking, this is false; it depends on exactly what is
>meant
>> >> by "extracted." e.g.:
>> >>
>> >>> d <- data.frame(col1 = 1:3, col2 = letters[1:3])
>> >>> v1 <- d[,2] ## a vector
>> >>> v2 <- d[[2]] ## the same, i.e
>> >>> identical(v1,v2)
>> >> [1] TRUE
>> >>> v3 <- d[2] ## a data.frame
>> >>> v1
>> >> [1] "a" "b" "c"  ## a character vector
>> >>> v3
>> >>   col2
>> >> 1    a
>> >> 2    b
>> >> 3    c
>> >>> is.vector(v1)
>> >> [1] TRUE
>> >>> is.vector(v3)
>> >> [1] FALSE
>> >>> class(v3)  ## data.frame
>> >> [1] "data.frame"
>> >> ## but
>> >>> is.list(v3)
>> >> [1] TRUE
>> >>
>> >> which is simply explained in ?data.frame (where else?!) by:
>> >> "A data frame is a **list** [emphasis added] of variables of the
>same
>> >> number of rows with unique row names, given class "data.frame". If
>no
>> >> variables are included, the row names determine the number of
>rows."
>> >>
>> >> "2.  maybe your question is "is a given function for a vector, or
>for a
>> >>     data frame/matrix/array?".  if so, i think the only way is
>reading
>> >>     the help information (?foo)."
>> >>
>> >> Indeed! Is this not what the Help system is for?! But note also
>that
>> >> the S3 class system may somewhat blur the issue: foo() may work
>> >> appropriately and differently for different (S3) classes of
>objects. A
>> >> detailed explanation of this behavior can be found in appropriate
>> >> resources or (more tersely) via ?UseMethod .
>> >>
>> >> "you might find reading ?"[" and  ?"[.data.frame" useful"
>> >>
>> >> Not just 'useful" -- **essential** if you want to work in R,
>unless
>> >> one gets this information via any of the numerous online
>tutorials,
>> >> courses, or books that are available. The Help system is accurate
>and
>> >> authoritative, but terse. I happen to like this mode of
>documentation,
>> >> but others may prefer more extended expositions. I stand by this
>claim
>> >> even if one chooses to use the "Tidyverse", data.table package, or
>> >> other alternative frameworks for handling data. Again, others may
>> >> disagree, but R is structured around these basics, and imo one
>remains
>> >> ignorant of them at their peril.
>> >>
>> >> Cheers,
>> >> Bert
>> >>
>> >>
>> >> Bert Gunter
>> >>
>> >> "The trouble with having an open mind is that people keep coming
>along
>> >> and sticking things into it."
>> >> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>> >>
>> >> On Fri, Jul 9, 2021 at 11:57 AM Greg Minshall <minshall at umich.edu>
>> >> wrote:
>> >>>
>> >>> Kai,
>> >>>
>> >>>> one more question, how can I know if the function is for column
>> >>>> manipulations or for vector?
>> >>>
>> >>> i still stumble around R code.  but, i'd say the following (and
>look
>> >>> forward to being corrected! :):
>> >>>
>> >>> 1.  a column, when extracted from a data frame, *is* a vector.
>> >>>
>> >>> 2.  maybe your question is "is a given function for a vector, or
>for
>> >> a
>> >>>      data frame/matrix/array?".  if so, i think the only way is
>> >> reading
>> >>>      the help information (?foo).
>> >>>
>> >>> 3.  sometimes, extracting the column as a vector from a data
>> >> frame-like
>> >>>      object might be non-intuitive.  you might find reading ?"["
>and
>> >>>      ?"[.data.frame" useful (as well as ?"[.data.table" if you
>use
>> >> that
>> >>>      package).  also, the str() command can be helpful in
>> >> understanding
>> >>>      what is happening.  (the lobstr:: package's sxp() function,
>as
>> >> well
>> >>>      as more verbose .Internal(inspect()) can also give you
>insight.)
>> >>>
>> >>>      with the data.table:: package, for example, if "DT" is a
>> >> data.table
>> >>>      object, with "x2" as a column, adding or leaving off
>quotation
>> >> marks
>> >>>      for the column name can make all the difference between
>ending up
>> >>>      with a vector, or with a (much reduced) data table:
>> >>> ----
>> >>>> is.vector(DT[, x2])
>> >>> [1] TRUE
>> >>>> str(DT[, x2])
>> >>>   num [1:9] 32 32 32 32 32 32 32 32 32
>> >>>>
>> >>>> is.vector(DT[, "x2"])
>> >>> [1] FALSE
>> >>>> str(DT[, "x2"])
>> >>> Classes ?data.table? and 'data.frame':  9 obs. of  1 variable:
>> >>>   $ x2: num  32 32 32 32 32 32 32 32 32
>> >>>   - attr(*, ".internal.selfref")=<externalptr>
>> >>> ----
>> >>>
>> >>>      a second level of indexing may or may not help, mostly
>depending
>> >> on
>> >>>      the use of '[' versus of '[['.  this can sometimes cause
>> >> confusion
>> >>>      when you are learning the language.
>> >>> ----
>> >>>> str(DT[, "x2"][1])
>> >>> Classes ?data.table? and 'data.frame':  1 obs. of  1 variable:
>> >>>   $ x2: num 32
>> >>>   - attr(*, ".internal.selfref")=<externalptr>
>> >>>> str(DT[, "x2"][[1]])
>> >>>   num [1:9] 32 32 32 32 32 32 32 32 32
>> >>> ----
>> >>>
>> >>>      the tibble:: package (used in, e.g., the dplyr:: package)
>also
>> >>>      (always?) returns a single column as a non-vector.  again, a
>> >>>      second indexing with double '[[]]' can produce a vector.
>> >>> ----
>> >>>> DP <- tibble(DT)
>> >>>> is.vector(DP[, "x2"])
>> >>> [1] FALSE
>> >>>> is.vector(DP[, "x2"][[1]])
>> >>> [1] TRUE
>> >>> ----
>> >>>
>> >>>      but, note that a list of lists is also a vector:
>> >>>> is.vector(list(list(1), list(1,2,3)))
>> >>> [1] TRUE
>> >>>> str(list(list(1), list(1,2,3)))
>> >>> List of 2
>> >>>   $ :List of 1
>> >>>    ..$ : num 1
>> >>>   $ :List of 3
>> >>>    ..$ : num 1
>> >>>    ..$ : num 2
>> >>>    ..$ : num 3
>> >>>
>> >>>      etc.
>> >>>
>> >>> hth.  good luck learning!
>> >>>
>> >>> cheers, Greg
>> >>>
>> >>> ______________________________________________
>> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> >>> https://stat.ethz.ch/mailman/listinfo/r-help
>> >>> PLEASE do read the posting guide
>> >> http://www.R-project.org/posting-guide.html
>> >>> and provide commented, minimal, self-contained, reproducible
>code.
>> >>
>> >> ______________________________________________
>> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> >> https://stat.ethz.ch/mailman/listinfo/r-help
>> >> PLEASE do read the posting guide
>> >> http://www.R-project.org/posting-guide.html
>> >> and provide commented, minimal, self-contained, reproducible code.
>> >
>>

-- 
Sent from my phone. Please excuse my brevity.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sat Jul 10 05:10:57 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 09 Jul 2021 20:10:57 -0700
Subject: [R] problem for strsplit function
In-Reply-To: <7df62a55-b555-1a00-fd2e-baebc5dcc305@gmail.com>
References: <762548966.2994133.1625757865539@mail.yahoo.com>
 <812547.1625856998@apollo2.minshall.org>
 <CAGxFJbTDYcJuuQjWWPsq8nY8BJ1z3X8KeDtUhMvaw_mBe0yh0Q@mail.gmail.com>
 <0C608992-5EA0-448A-8DC4-7B2833F7DD4D@dcn.davis.ca.us>
 <5f6bcd58-23c1-f6ce-7e36-9abd41fd72b8@gmail.com>
 <CAGxFJbQMzjPsgendwBo+KAiw9pvJfmji+JvyNHthhkoM4Of_Qg@mail.gmail.com>
 <7df62a55-b555-1a00-fd2e-baebc5dcc305@gmail.com>
Message-ID: <15693D14-2DE0-4176-9819-B3C5DAE904CA@dcn.davis.ca.us>

A bit too fast there, Duncan... x[[c(1,2)]] is illegal.

On July 9, 2021 5:16:13 PM PDT, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>On 09/07/2021 6:44 p.m., Bert Gunter wrote:
>> OK, I stand somewhat chastised.
>> 
>> But my point still is that what you get when you "extract" depends on
>> how you define "extract." Do note that ?"[" yields a help file titled
>> "Extract or Replace Parts of an object"; and afaics, the term
>"subset"
>> is not explicitly used as Duncan prefers.
>
>?"[[" gives you the same page, but I agree:  this part of the 
>documentation isn't written very clearly. The "Introduction to R"
>manual 
>uses the terms I used (see section 2.7, "Index vectors; selecting and 
>modifying subsets of a data set"), as does the source code (and the R 
>Language Definition manual, though it's not as clear as the Intro).
>
>But the point isn't to chastise you, it's to educate you (and the OP). 
>Thinking of [] as subsetting is more helpful than thinking of it as 
>extraction.  That way the result of x[c(1,2)] makes sense.  It's a 
>little bit more of a stretch, but the result of x[[c(1,2)]] also makes 
>sense when you think of it as extraction.
>
>Duncan Murdoch
>
>  The relevant part of the
>> Help file says for "[" for recursive objects says: "Indexing by [ is
>> similar to atomic vectors and selects a list of the specified
>> element(s)."  That a data.frame is a list is explicitly stated, as I
>> noted; that lists are in fact vectors is also explicitly stated
>(?list
>> says: "Almost all lists in R internally are Generic Vectors") but
>then
>> one is stuck with: a data.frame is a list and therefore a vector, but
>> is.vector(d3) is FALSE. The explanation is explicit again in
>> ?is.vector ("is.vector returns TRUE if x is a vector of the specified
>> mode having no attributes other than names. It returns FALSE
>> otherwise."). But I would say these issues are sufficiently murky
>that
>> my warning to be precise is not entirely inappropriate;
>unfortunately,
>> I may have made them more so. Sigh....
>> 
>> Cheers,
>> Bert
>> 
>> 
>> 
>> Bert Gunter
>> 
>> "The trouble with having an open mind is that people keep coming
>along
>> and sticking things into it."
>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>> 
>> On Fri, Jul 9, 2021 at 3:05 PM Duncan Murdoch
><murdoch.duncan at gmail.com> wrote:
>>>
>>> On 09/07/2021 5:51 p.m., Jeff Newmiller wrote:
>>>> "Strictly speaking", Greg is correct, Bert.
>>>>
>>>>
>https://cran.r-project.org/doc/manuals/r-release/R-lang.html#List-objects
>>>>
>>>> Lists in R are vectors. What we colloquially refer to as "vectors"
>are more precisely referred to as "atomic vectors". And without a
>doubt, this "vector" nature of lists is a key underlying concept that
>explains why adding a dim attribute creates a matrix that can hold data
>frames. It is also a stumbling block for programmers from other
>languages that have things like linked lists.
>>>
>>> I would also object to v3 (below) as "extracting" a column from d.
>>> "d[2]" doesn't extract anything, it "subsets" the data frame, so the
>>> result is a data frame, not what you get when you extract something
>from
>>> a data frame.
>>>
>>> People don't realize that "x <- 1:10; y <- x[[3]]" is perfectly
>legal.
>>> That extracts the 3rd element (the number 3).  The problem is that R
>has
>>> no way to represent a scalar number, only a vector of numbers, so
>x[[3]]
>>> gets promoted to a vector containing that number when it is returned
>and
>>> assigned to y.
>>>
>>> Lists are vectors of R objects, so if x is a list, x[[3]] is
>something
>>> that can be returned, and it is different from x[3].
>>>
>>> Duncan Murdoch
>>>
>>>>
>>>> On July 9, 2021 2:36:19 PM PDT, Bert Gunter
><bgunter.4567 at gmail.com> wrote:
>>>>> "1.  a column, when extracted from a data frame, *is* a vector."
>>>>> Strictly speaking, this is false; it depends on exactly what is
>meant
>>>>> by "extracted." e.g.:
>>>>>
>>>>>> d <- data.frame(col1 = 1:3, col2 = letters[1:3])
>>>>>> v1 <- d[,2] ## a vector
>>>>>> v2 <- d[[2]] ## the same, i.e
>>>>>> identical(v1,v2)
>>>>> [1] TRUE
>>>>>> v3 <- d[2] ## a data.frame
>>>>>> v1
>>>>> [1] "a" "b" "c"  ## a character vector
>>>>>> v3
>>>>>    col2
>>>>> 1    a
>>>>> 2    b
>>>>> 3    c
>>>>>> is.vector(v1)
>>>>> [1] TRUE
>>>>>> is.vector(v3)
>>>>> [1] FALSE
>>>>>> class(v3)  ## data.frame
>>>>> [1] "data.frame"
>>>>> ## but
>>>>>> is.list(v3)
>>>>> [1] TRUE
>>>>>
>>>>> which is simply explained in ?data.frame (where else?!) by:
>>>>> "A data frame is a **list** [emphasis added] of variables of the
>same
>>>>> number of rows with unique row names, given class "data.frame". If
>no
>>>>> variables are included, the row names determine the number of
>rows."
>>>>>
>>>>> "2.  maybe your question is "is a given function for a vector, or
>for a
>>>>>      data frame/matrix/array?".  if so, i think the only way is
>reading
>>>>>      the help information (?foo)."
>>>>>
>>>>> Indeed! Is this not what the Help system is for?! But note also
>that
>>>>> the S3 class system may somewhat blur the issue: foo() may work
>>>>> appropriately and differently for different (S3) classes of
>objects. A
>>>>> detailed explanation of this behavior can be found in appropriate
>>>>> resources or (more tersely) via ?UseMethod .
>>>>>
>>>>> "you might find reading ?"[" and  ?"[.data.frame" useful"
>>>>>
>>>>> Not just 'useful" -- **essential** if you want to work in R,
>unless
>>>>> one gets this information via any of the numerous online
>tutorials,
>>>>> courses, or books that are available. The Help system is accurate
>and
>>>>> authoritative, but terse. I happen to like this mode of
>documentation,
>>>>> but others may prefer more extended expositions. I stand by this
>claim
>>>>> even if one chooses to use the "Tidyverse", data.table package, or
>>>>> other alternative frameworks for handling data. Again, others may
>>>>> disagree, but R is structured around these basics, and imo one
>remains
>>>>> ignorant of them at their peril.
>>>>>
>>>>> Cheers,
>>>>> Bert
>>>>>
>>>>>
>>>>> Bert Gunter
>>>>>
>>>>> "The trouble with having an open mind is that people keep coming
>along
>>>>> and sticking things into it."
>>>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>>>>
>>>>> On Fri, Jul 9, 2021 at 11:57 AM Greg Minshall <minshall at umich.edu>
>>>>> wrote:
>>>>>>
>>>>>> Kai,
>>>>>>
>>>>>>> one more question, how can I know if the function is for column
>>>>>>> manipulations or for vector?
>>>>>>
>>>>>> i still stumble around R code.  but, i'd say the following (and
>look
>>>>>> forward to being corrected! :):
>>>>>>
>>>>>> 1.  a column, when extracted from a data frame, *is* a vector.
>>>>>>
>>>>>> 2.  maybe your question is "is a given function for a vector, or
>for
>>>>> a
>>>>>>       data frame/matrix/array?".  if so, i think the only way is
>>>>> reading
>>>>>>       the help information (?foo).
>>>>>>
>>>>>> 3.  sometimes, extracting the column as a vector from a data
>>>>> frame-like
>>>>>>       object might be non-intuitive.  you might find reading ?"["
>and
>>>>>>       ?"[.data.frame" useful (as well as ?"[.data.table" if you
>use
>>>>> that
>>>>>>       package).  also, the str() command can be helpful in
>>>>> understanding
>>>>>>       what is happening.  (the lobstr:: package's sxp() function,
>as
>>>>> well
>>>>>>       as more verbose .Internal(inspect()) can also give you
>insight.)
>>>>>>
>>>>>>       with the data.table:: package, for example, if "DT" is a
>>>>> data.table
>>>>>>       object, with "x2" as a column, adding or leaving off
>quotation
>>>>> marks
>>>>>>       for the column name can make all the difference between
>ending up
>>>>>>       with a vector, or with a (much reduced) data table:
>>>>>> ----
>>>>>>> is.vector(DT[, x2])
>>>>>> [1] TRUE
>>>>>>> str(DT[, x2])
>>>>>>    num [1:9] 32 32 32 32 32 32 32 32 32
>>>>>>>
>>>>>>> is.vector(DT[, "x2"])
>>>>>> [1] FALSE
>>>>>>> str(DT[, "x2"])
>>>>>> Classes ?data.table? and 'data.frame':  9 obs. of  1 variable:
>>>>>>    $ x2: num  32 32 32 32 32 32 32 32 32
>>>>>>    - attr(*, ".internal.selfref")=<externalptr>
>>>>>> ----
>>>>>>
>>>>>>       a second level of indexing may or may not help, mostly
>depending
>>>>> on
>>>>>>       the use of '[' versus of '[['.  this can sometimes cause
>>>>> confusion
>>>>>>       when you are learning the language.
>>>>>> ----
>>>>>>> str(DT[, "x2"][1])
>>>>>> Classes ?data.table? and 'data.frame':  1 obs. of  1 variable:
>>>>>>    $ x2: num 32
>>>>>>    - attr(*, ".internal.selfref")=<externalptr>
>>>>>>> str(DT[, "x2"][[1]])
>>>>>>    num [1:9] 32 32 32 32 32 32 32 32 32
>>>>>> ----
>>>>>>
>>>>>>       the tibble:: package (used in, e.g., the dplyr:: package)
>also
>>>>>>       (always?) returns a single column as a non-vector.  again,
>a
>>>>>>       second indexing with double '[[]]' can produce a vector.
>>>>>> ----
>>>>>>> DP <- tibble(DT)
>>>>>>> is.vector(DP[, "x2"])
>>>>>> [1] FALSE
>>>>>>> is.vector(DP[, "x2"][[1]])
>>>>>> [1] TRUE
>>>>>> ----
>>>>>>
>>>>>>       but, note that a list of lists is also a vector:
>>>>>>> is.vector(list(list(1), list(1,2,3)))
>>>>>> [1] TRUE
>>>>>>> str(list(list(1), list(1,2,3)))
>>>>>> List of 2
>>>>>>    $ :List of 1
>>>>>>     ..$ : num 1
>>>>>>    $ :List of 3
>>>>>>     ..$ : num 1
>>>>>>     ..$ : num 2
>>>>>>     ..$ : num 3
>>>>>>
>>>>>>       etc.
>>>>>>
>>>>>> hth.  good luck learning!
>>>>>>
>>>>>> cheers, Greg
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>> PLEASE do read the posting guide
>>>>> http://www.R-project.org/posting-guide.html
>>>>>> and provide commented, minimal, self-contained, reproducible
>code.
>>>>>
>>>>> ______________________________________________
>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>> PLEASE do read the posting guide
>>>>> http://www.R-project.org/posting-guide.html
>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>>

-- 
Sent from my phone. Please excuse my brevity.


From r@turner @end|ng |rom @uck|@nd@@c@nz  Sat Jul 10 05:33:11 2021
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Sat, 10 Jul 2021 15:33:11 +1200
Subject: [R] problem for strsplit function
In-Reply-To: <15693D14-2DE0-4176-9819-B3C5DAE904CA@dcn.davis.ca.us>
References: <762548966.2994133.1625757865539@mail.yahoo.com>
 <812547.1625856998@apollo2.minshall.org>
 <CAGxFJbTDYcJuuQjWWPsq8nY8BJ1z3X8KeDtUhMvaw_mBe0yh0Q@mail.gmail.com>
 <0C608992-5EA0-448A-8DC4-7B2833F7DD4D@dcn.davis.ca.us>
 <5f6bcd58-23c1-f6ce-7e36-9abd41fd72b8@gmail.com>
 <CAGxFJbQMzjPsgendwBo+KAiw9pvJfmji+JvyNHthhkoM4Of_Qg@mail.gmail.com>
 <7df62a55-b555-1a00-fd2e-baebc5dcc305@gmail.com>
 <15693D14-2DE0-4176-9819-B3C5DAE904CA@dcn.davis.ca.us>
Message-ID: <20210710153311.0f490721@rolf-Latitude-E7470>


This discussion has developed in such a way that it seems a better
subject line would be "problem for the hairsplit function". :-)

cheers,

Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Jul 10 08:47:40 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 10 Jul 2021 07:47:40 +0100
Subject: [R] error message from read.csv in loop
In-Reply-To: <550599640.2967267.1625853711087@mail.yahoo.com>
References: <550599640.2967267.1625853711087.ref@mail.yahoo.com>
 <550599640.2967267.1625853711087@mail.yahoo.com>
Message-ID: <32be543f-d4a7-d172-81f2-ba853e8ce248@sapo.pt>

Hello,

1. When there are systematic errors, use ?try or, better yet, ?tryCatch.
Something like the code below will create a list of errors and read in 
the data if none occurred.
The code starts by creating an empty list for tryCatch results. It uses 
?file.path instead of noquote/paste0 to assemble the file name and wraps 
tryCatch around read.csv. Then, after the for loop, it gets the wrong 
reads and displays the error messages.
3. I'm assuming that after processing the data file by file you discard 
the data.frame if it's read without problems and move on to the next 
one. It would also be possible to store them all in a list, together 
with the errors.


ok <- vector("list", nrow(ora))
for (j in 1:nrow(ora))
{
 ? mycol? <- ora[j,"fname"]
 ? mycsv? <- paste0(mycol, ".csv'")
 ? rdcsv? <- file.path("w:/project/_Joe.B/Oracle/data", mycsv)
 ? rr <- tryCatch(read.csv(rdcsv), error = function(e) e)
 ? if(inherits(rr, "error"))
 ??? ok[[i]] <- rr
 ? else ok[[i]] <- TRUE
}

i_err <- sapply(ok, inherits, "error")
for(e in ok[i_err]) message(e$message)


2. I'm assuming that you want to process file by file and? if the data 
are read without problems you discard the data.frame after processing it 
and move on to the next file. It is also possible to store them all in a 
list, together with the errors.


fun <- function(j, data = ora, mypath = "w:/project/_Joe.B/Oracle/data")
{
 ? mycol? <- data[j, "fname"]
 ? mycsv? <- paste0(mycol, ".csv")
 ? rdcsv? <- file.path(mypath, mycsv)
 ? tryCatch(read.csv(rdcsv), error = function(e) e)
}

df_list <- lapply(seq_len(nrow(ora)), fun)
i_err <- sapply(df_list, inherits, "error")
df_list[!i_err]? # these are ok

# hypothetical processing strategy
processing_results <- lapply(df_list[!i_err], function(rr) {
 ? # code goes here
 ? # ...etc...
})


Hope this helps,

Rui Barradas



?s 19:01 de 09/07/2021, Kai Yang via R-help escreveu:
> Hello List,
> I use for loop to read csv difference file into data frame rr.? The data frame rr will be deleted after a comparison and go to the next csv file.? Below is my code:
> for (j in 1:nrow(ora))
> {
>  ? mycol? <- ora[j,"fname"]
>  ? mycsv? <- paste0(mycol,".csv'")
>  ? rdcsv? <- noquote(paste0("'w:/project/_Joe.B/Oracle/data/", mycsv))
>  ? rr? ? ?<- read.csv(rdcsv)
> }
> but when I run this code, I got error message below:
> Error in file(file, "rt") : cannot open the connection
> In addition: Warning message:
> In file(file, "rt") :
>  ? cannot open file ''w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'': No such file or directory
>
> so, I checked the rdcsv and print it out, see below:
> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DISCRETE_VALUES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_QUESTIONS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_RUNS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/DATA_ENTRY_PAGES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/DISCRETE_VALUES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/ENTRY_GROUPS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_GROUPS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_VALUES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_LOT_DEFINITIONS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_SAMPLES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/MOLECULAR_WAREHOUSE.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/QUESTION_DEFINITIONS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/QUESTION_GROUPS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/RESPONSES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST_NAMES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_PLATE_ADDRESSES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/STORAGE_UNITS.csv'
> it seems correct. I copy and paste it into a code :
>  ?rr? ? ?<- read.csv( 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv')
> and it works fine.
> Can someone help me debug where is the problem in my for loop code?
> Thanks,
> Kai
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


-- 
Este e-mail foi verificado em termos de v?rus pelo software antiv?rus Avast.
https://www.avast.com/antivirus


From @|@y@hz@k@r|@ @end|ng |rom un|m@p@edu@my  Sat Jul 10 01:30:35 2021
From: @|@y@hz@k@r|@ @end|ng |rom un|m@p@edu@my (SITI AISYAH ZAKARIA)
Date: Sat, 10 Jul 2021 07:30:35 +0800
Subject: [R] How to estimate the parameter for many variable?
In-Reply-To: <f010d7e9-664d-0621-a253-791b26f54b5d@sapo.pt>
References: <CALcx2Bm+Py5Asc7KT+-2x6mW0j5zO6YNKBFktsn4usjjXAz7DQ@mail.gmail.com>
 <CA+8X3fXYdQcDU-L9f2bHUuutrg=c1boAON++dX2_eVPrzBzHwA@mail.gmail.com>
 <b2c1d82b-0c0e-f639-fd32-dcafce055ef3@sapo.pt>
 <CALcx2B=MrCSv0J9Jxtibe4U3tUGyiBZiKrpz_FrctpMWbgrE3w@mail.gmail.com>
 <5c44967a-2d2e-7dae-d96e-b86dcb772358@sapo.pt>
 <CALcx2B=Zz=TxZGk=s=YWbdXdHh8rmaXyEiUmSE7DRou06USy9A@mail.gmail.com>
 <f010d7e9-664d-0621-a253-791b26f54b5d@sapo.pt>
Message-ID: <CALcx2BmvDxSjrj5AoO2yXy40XVNm_+Cjz-+bCHRpd6cF7fSwwA@mail.gmail.com>

Dear Rui and Jim,

Thank you very much for your feedback.

Yes, now I get the output. And after this I will use this output as the
marginal distribution to continue the analysis on spatial extremes.


Thanks again. See you later.

On Fri, 9 Jul 2021 at 17:18, Rui Barradas <ruipbarradas at sapo.pt> wrote:

> Hello,
>
> With the condition for the location it can be estimated like the following.
>
>
> fit_list2 <- gev_fit_list <- lapply(Ozone_weekly2, gev.fit, ydat = ti,
> mul = c(2, 3), show = FALSE)
> mle_params2 <- t(sapply(fit_list2, '[[', 'mle'))
> # assign column names
> colnames(mle_params2) <- c("location", "scale", "shape", "mul2", "mul3")
> head(mle_params2)
>
>
> Hope this helps,
>
> Rui Barradas
>
> ?s 09:53 de 09/07/21, SITI AISYAH ZAKARIA escreveu:
> > Dear Rui ang Jim,
> >
> > Thank you very much.
> >
> > Thank you Rui Barradas, I already tried using your coding and I'm
> > grateful I got the answer.
> >
> > ok now, I have some condition on the location parameter which is cyclic
> > condition.
> >
> > So, I will add another 2 variables for the column.
> >
> > and the condition for location is this one.
> >
> >   ti[,1] = seq(1, 888, 1)
> >    ti[,2]=sin(2*pi*(ti[,1])/52)
> >    ti[,3]=cos(2*pi*(ti[,1])/52)
> >    fit0<-gev.fit(x[,i], ydat = ti, mul=c(2, 3))
> >
> > Thank you again.
> >
> > On Fri, 9 Jul 2021 at 14:38, Rui Barradas <ruipbarradas at sapo.pt
> > <mailto:ruipbarradas at sapo.pt>> wrote:
> >
> >     Hello,
> >
> >     The following lapply one-liner fits a GEV to each column vector,
> there
> >     is no need for the double for loop. There's also no need to create a
> >     data set x.
> >
> >
> >     library(ismev)
> >     library(mgcv)
> >     library(EnvStats)
> >
> >     Ozone_weekly2 <- read.table("~/tmp/Ozone_weekly2.txt", header = TRUE)
> >
> >     # fit a GEV to each column
> >     gev_fit_list <- lapply(Ozone_weekly2, gev.fit, show = FALSE)
> >
> >     # extract the parameters MLE estimates
> >     mle_params <- t(sapply(gev_fit_list, '[[', 'mle'))
> >
> >     # assign column names
> >     colnames(mle_params) <- c("location", "scale", "shape")
> >
> >     # see first few rows
> >     head(mle_params)
> >
> >
> >
> >     The OP doesn't ask for plots but, here they go.
> >
> >
> >     y_vals <- function(x, params){
> >         loc <- params[1]
> >         scale <- params[2]
> >         shape <- params[3]
> >         EnvStats::dgevd(x, loc, scale, shape)
> >     }
> >     plot_fit <- function(data, vec, verbose = FALSE){
> >         fit <- gev.fit(data[[vec]], show = verbose)
> >         x <- sort(data[[vec]])
> >         hist(x, freq = FALSE)
> >         lines(x, y_vals(x, params = fit$mle))
> >     }
> >
> >     # seems a good fit
> >     plot_fit(Ozone_weekly2, 1)       # column number
> >     plot_fit(Ozone_weekly2, "CA01")  # col name, equivalent
> >
> >     # the data seems gaussian, not a good fit
> >     plot_fit(Ozone_weekly2, 4)       # column number
> >     plot_fit(Ozone_weekly2, "CA08")  # col name, equivalent
> >
> >
> >
> >     Hope this helps,
> >
> >     Rui Barradas
> >
> >
> >     ?s 00:59 de 09/07/21, SITI AISYAH ZAKARIA escreveu:
> >      > Dear all,
> >      >
> >      > Thank you very much for the feedback.
> >      >
> >      > Sorry for the lack of information about this problem.
> >      >
> >      > Here, I explain again.
> >      >
> >      > I use this package to run my coding.
> >      >
> >      > library(ismev)
> >      > library(mgcv)
> >      > library(nlme)
> >      >
> >      > The purpose of this is I want to get the value of parameter
> >     estimation
> >      > using MLE by applying the GEV distribution.
> >      >
> >      > x <- data.matrix(Ozone_weekly2)                      x refers to
> >     my data
> >      > that consists of 19 variables. I will attach the data together.
> >      > x
> >      > head(gev.fit)[1:4]
> >      > ti = matrix(ncol = 3, nrow = 888)
> >      > ti[,1] = seq(1, 888, 1)
> >      > ti[,2]=sin(2*pi*(ti[,1])/52)
> >      > ti[,3]=cos(2*pi*(ti[,1])/52)
> >      >
> >      > /for(i in 1:nrow(x))
> >      >    + { for(j in 1:ncol(x))                            the problem
> in
> >      > here, i don't no to create the coding. i target my output will
> >     come out
> >      > in matrix that
> >      >      + {x[i,j] = 1}}                                       show
> the
> >      > parameter estimation for 19 variable which have 19 row and 3
> column/
> >      > /
> >     row --
> >      > refer to variable (station)  ; column -- refer to parameter
> >     estimation
> >      > for GEV distribution
> >      >
> >      > /thank you.
> >      >
> >      > On Thu, 8 Jul 2021 at 18:40, Rui Barradas <ruipbarradas at sapo.pt
> >     <mailto:ruipbarradas at sapo.pt>
> >      > <mailto:ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>>>
> wrote:
> >      >
> >      >     Hello,
> >      >
> >      >     Also, in the code
> >      >
> >      >     x <- data.matrix(Ozone_weekly)
> >      >
> >      >     [...omited...]
> >      >
> >      >     for(i in 1:nrow(x))
> >      >         + { for(j in 1:ncol(x))
> >      >           + {x[i,j] = 1}}
> >      >
> >      >     not only you rewrite x but the double for loop is equivalent
> to
> >      >
> >      >
> >      >     x[] <- 1
> >      >
> >      >
> >      >     courtesy R's vectorised behavior. (The square parenthesis are
> >     needed to
> >      >     keep the dimensions, the matrix form.)
> >      >     And, I'm not sure but isn't
> >      >
> >      >     head(gev.fit)[1:4]
> >      >
> >      >     equivalent to
> >      >
> >      >     head(gev.fit, n = 4)
> >      >
> >      >     ?
> >      >
> >      >     Like Jim says, we need more information, can you post
> >     Ozone_weekly2 and
> >      >     the code that produced gev.fit? But in the mean time you can
> >     revise
> >      >     your
> >      >     code.
> >      >
> >      >     Hope this helps,
> >      >
> >      >     Rui Barradas
> >      >
> >      >
> >      >     ?s 11:08 de 08/07/21, Jim Lemon escreveu:
> >      >      > Hi Siti,
> >      >      > I think we need a bit more information to respond
> helpfully. I
> >      >     have no
> >      >      > idea what "Ozone_weekly2" is and Google is also ignorant.
> >      >     "gev.fit" is
> >      >      > also unknown. The name suggests that it is the output of
> some
> >      >      > regression or similar. What function produced it, and from
> >     what
> >      >      > library? "ti" is known as you have defined it. However, I
> >     don't know
> >      >      > what you want to do with it. Finally, as this is a text
> >     mailing list,
> >      >      > we don't get any highlighting, so the text to which you
> >     refer cannot
> >      >      > be identified. I can see you have a problem, but cannot
> >     offer any
> >      >     help
> >      >      > right now.
> >      >      >
> >      >      > Jim
> >      >      >
> >      >      > On Thu, Jul 8, 2021 at 12:06 AM SITI AISYAH ZAKARIA
> >      >      > <aisyahzakaria at unimap.edu.my
> >     <mailto:aisyahzakaria at unimap.edu.my>
> >      >     <mailto:aisyahzakaria at unimap.edu.my
> >     <mailto:aisyahzakaria at unimap.edu.my>>> wrote:
> >      >      >>
> >      >      >> Dear all,
> >      >      >>
> >      >      >> Can I ask something about programming in marginal
> >     distribution
> >      >     for spatial
> >      >      >> extreme?
> >      >      >> I really stuck on my coding to obtain the parameter
> >     estimation for
> >      >      >> univariate or marginal distribution for new model in
> spatial
> >      >     extreme.
> >      >      >>
> >      >      >> I want to run my data in order to get the parameter
> >     estimation
> >      >     value for 25
> >      >      >> stations in one table. But I really didn't get the idea
> >     of the
> >      >     correct
> >      >      >> coding. Here I attached my coding
> >      >      >>
> >      >      >> x <- data.matrix(Ozone_weekly2)
> >      >      >> x
> >      >      >> head(gev.fit)[1:4]
> >      >      >> ti = matrix(ncol = 3, nrow = 888)
> >      >      >> ti[,1] = seq(1, 888, 1)
> >      >      >> ti[,2]=sin(2*pi*(ti[,1])/52)
> >      >      >> ti[,3]=cos(2*pi*(ti[,1])/52)
> >      >      >> for(i in 1:nrow(x))
> >      >      >>    + { for(j in 1:ncol(x))
> >      >      >>      + {x[i,j] = 1}}
> >      >      >>
> >      >      >> My problem is highlighted in red color.
> >      >      >> And if are not hesitate to all. Can someone share with me
> the
> >      >     procedure,
> >      >      >> how can I map my data using spatial extreme.
> >      >      >> For example:
> >      >      >> After I finish my marginal distribution, what the next
> >      >     procedure. It is I
> >      >      >> need to get the spatial independent value.
> >      >      >>
> >      >      >> That's all
> >      >      >> Thank you.
> >      >      >>
> >      >      >> --
> >      >      >>
> >      >      >>
> >      >      >>
> >      >      >>
> >      >      >>
> >      >      >> "..Millions of trees are used to make papers, only to be
> >     thrown away
> >      >      >> after a couple of minutes reading from them. Our planet
> is at
> >      >     stake. Please
> >      >      >> be considerate. THINK TWICE BEFORE PRINTING THIS.."
> >      >      >>
> >      >      >> DISCLAIMER: This email \ and any files
> >     transmitte...{{dropped:24}}
> >      >      >>
> >      >      >> ______________________________________________
> >      >      >> R-help at r-project.org <mailto:R-help at r-project.org>
> >     <mailto:R-help at r-project.org <mailto:R-help at r-project.org>> mailing
> list
> >      >     -- To UNSUBSCRIBE and more, see
> >      >      >> https://stat.ethz.ch/mailman/listinfo/r-help
> >     <https://stat.ethz.ch/mailman/listinfo/r-help>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-help
> >     <https://stat.ethz.ch/mailman/listinfo/r-help>>
> >      >      >> PLEASE do read the posting guide
> >      > http://www.R-project.org/posting-guide.html
> >     <http://www.R-project.org/posting-guide.html>
> >      >     <http://www.R-project.org/posting-guide.html
> >     <http://www.R-project.org/posting-guide.html>>
> >      >      >> and provide commented, minimal, self-contained,
> >     reproducible code.
> >      >      >
> >      >      > ______________________________________________
> >      >      > R-help at r-project.org <mailto:R-help at r-project.org>
> >     <mailto:R-help at r-project.org <mailto:R-help at r-project.org>> mailing
> list
> >      >     -- To UNSUBSCRIBE and more, see
> >      >      > https://stat.ethz.ch/mailman/listinfo/r-help
> >     <https://stat.ethz.ch/mailman/listinfo/r-help>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-help
> >     <https://stat.ethz.ch/mailman/listinfo/r-help>>
> >      >      > PLEASE do read the posting guide
> >      > http://www.R-project.org/posting-guide.html
> >     <http://www.R-project.org/posting-guide.html>
> >      >     <http://www.R-project.org/posting-guide.html
> >     <http://www.R-project.org/posting-guide.html>>
> >      >      > and provide commented, minimal, self-contained,
> >     reproducible code.
> >      >      >
> >      >
> >      >
> >      >
> >      > "..Millions of trees are used to make papers, only to be thrown
> away
> >      > after a couple of minutes reading from them. Our planet is at
> stake.
> >      > Please be considerate. THINK TWICE BEFORE PRINTING THIS.."
> >      >
> >      > *DISCLAIMER:* This email and any files transmitted with it are
> >      > confidential and intended solely for the use of the individual
> >     orentity
> >      > to whom they are addressed. If you have received this email in
> error
> >      > please notify the UniMAP's Email Administrator. Please note that
> any
> >      > views or opinions presented in this email are solely those of the
> >     author
> >      > and do not necessarily represent those of the university.
> >     Finally, the
> >      > recipient should check this email and any attachments for the
> >     presence
> >      > of viruses.The university accepts no liability for any damage
> >     caused by
> >      > any virus transmitted by this email.
> >      >
> >      > Universiti Malaysia Perlis (UniMAP) | Digital Management &
> >     Development
> >      > Centre (DMDC), Universiti Malaysia Perlis (UniMAP), Pauh Putra
> >     Campus,
> >      > 02600 Arau, Perlis, MALAYSIA | www.unimap.edu.my
> >     <http://www.unimap.edu.my> <http://www.unimap.edu.my/
> >     <http://www.unimap.edu.my/>>
> >      >
> >
> >
> >
> > "..Millions of trees are used to make papers, only to be thrown away
> > after a couple of minutes reading from them. Our planet is at stake.
> > Please be considerate. THINK TWICE BEFORE PRINTING THIS.."
> >
> > *DISCLAIMER:* This email and any files transmitted with it are
> > confidential and intended solely for the use of the individual orentity
> > to whom they are addressed. If you have received this email in error
> > please notify the UniMAP's Email Administrator. Please note that any
> > views or opinions presented in this email are solely those of the author
> > and do not necessarily represent those of the university. Finally, the
> > recipient should check this email and any attachments for the presence
> > of viruses.The university accepts no liability for any damage caused by
> > any virus transmitted by this email.
> >
> > Universiti Malaysia Perlis (UniMAP) | Digital Management & Development
> > Centre (DMDC), Universiti Malaysia Perlis (UniMAP), Pauh Putra Campus,
> > 02600 Arau, Perlis, MALAYSIA | www.unimap.edu.my <
> http://www.unimap.edu.my/>
> >
>

-- 





"..Millions of trees are used to make papers, only to be thrown away 
after a couple of minutes reading from them. Our planet is at stake. Please 
be considerate. THINK TWICE BEFORE PRINTING THIS.."

DISCLAIMER:?This email \ and any files transmitte...{{dropped:24}}


From pd@me@ @end|ng |rom cb@@dk  Sat Jul 10 11:51:41 2021
From: pd@me@ @end|ng |rom cb@@dk (Peter Dalgaard)
Date: Sat, 10 Jul 2021 09:51:41 +0000
Subject: [R] [Rd] R 4.1.1 scheduled for August 10
Message-ID: <4CAF26B5-9712-4083-8839-F77BC51453C9@cbs.dk>

Full schedule is available on developer.r-project.org.

(This comes somewhat late this year, partly because we needed to squeeze in 4.0.5 before 4.1.0 could be released.)

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com

_______________________________________________
R-announce at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-announce


From m|gdon|o@gonz@|ez02 @end|ng |rom gm@||@com  Fri Jul  9 20:39:45 2021
From: m|gdon|o@gonz@|ez02 @end|ng |rom gm@||@com (=?UTF-8?Q?Migdonio_Gonz=C3=A1lez?=)
Date: Fri, 9 Jul 2021 13:39:45 -0500
Subject: [R] error message from read.csv in loop
In-Reply-To: <550599640.2967267.1625853711087@mail.yahoo.com>
References: <550599640.2967267.1625853711087.ref@mail.yahoo.com>
 <550599640.2967267.1625853711087@mail.yahoo.com>
Message-ID: <CA+Mj9gV2PWNGediiKhJt37KYsNJAxUp3=q4KFi8H9SND8YAQvQ@mail.gmail.com>

 It seems that your problem is that you are using single quotes inside of
the double quotes. This is not necessary. Here is the corrected for-loop:

for (j in 1:nrow(ora))
{
        mycol  <- ora[j,"fname"]
        mycsv  <- paste0(mycol,".csv")
        rdcsv  <- noquote(paste0("w:/project/_Joe.B/Oracle/data/", mycsv))
        rr     <- read.csv(rdcsv)
}

Also note that the rr variable will only store the last CSV, not all CSV.
You will need to initialize the rr variable as a list to store all CSVs if
that is what you require. Something like this:

# Initialize the rr variable as a list.
rr <- as.list(rep(NA, nrow(ora)))

# Run the for-loop to store all the CSVs in rr.
for (j in 1:nrow(ora))
{
        mycol  <- ora[j,"fname"]
        mycsv  <- paste0(mycol,".csv")
        rdcsv  <- noquote(paste0("w:/project/_Joe.B/Oracle/data/", mycsv))
        rr[[j]]     <- read.csv(rdcsv)
}

Regards
Migdonio G.

On Fri, Jul 9, 2021 at 1:10 PM Kai Yang via R-help <r-help at r-project.org>
wrote:

> Hello List,
> I use for loop to read csv difference file into data frame rr.  The data
> frame rr will be deleted after a comparison and go to the next csv file.
> Below is my code:
> for (j in 1:nrow(ora))
> {
>   mycol  <- ora[j,"fname"]
>   mycsv  <- paste0(mycol,".csv'")
>   rdcsv  <- noquote(paste0("'w:/project/_Joe.B/Oracle/data/", mycsv))
>   rr     <- read.csv(rdcsv)
> }
> but when I run this code, I got error message below:
> Error in file(file, "rt") : cannot open the connection
> In addition: Warning message:
> In file(file, "rt") :
>   cannot open file
> ''w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'': No such file or
> directory
>
> so, I checked the rdcsv and print it out, see below:
> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DISCRETE_VALUES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_QUESTIONS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_RUNS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/DATA_ENTRY_PAGES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/DISCRETE_VALUES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/ENTRY_GROUPS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_GROUPS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_VALUES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_LOT_DEFINITIONS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_SAMPLES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/MOLECULAR_WAREHOUSE.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/QUESTION_DEFINITIONS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/QUESTION_GROUPS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/RESPONSES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST_NAMES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_PLATE_ADDRESSES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/STORAGE_UNITS.csv'
> it seems correct. I copy and paste it into a code :
>  rr     <- read.csv( 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv')
> and it works fine.
> Can someone help me debug where is the problem in my for loop code?
> Thanks,
> Kai
>
>
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From m|gdon|o@gonz@|ez02 @end|ng |rom gm@||@com  Fri Jul  9 21:49:05 2021
From: m|gdon|o@gonz@|ez02 @end|ng |rom gm@||@com (=?UTF-8?Q?Migdonio_Gonz=C3=A1lez?=)
Date: Fri, 9 Jul 2021 14:49:05 -0500
Subject: [R] error message from read.csv in loop
In-Reply-To: <1571249797.2635333.1625858663382@mail.yahoo.com>
References: <550599640.2967267.1625853711087.ref@mail.yahoo.com>
 <550599640.2967267.1625853711087@mail.yahoo.com>
 <CA+Mj9gV2PWNGediiKhJt37KYsNJAxUp3=q4KFi8H9SND8YAQvQ@mail.gmail.com>
 <1571249797.2635333.1625858663382@mail.yahoo.com>
Message-ID: <CA+Mj9gXxKeo2HOmKPnTMD3WUA7GPDmB7QtMYzKFo9bi+6o1o5Q@mail.gmail.com>

Hello Kai,

Just as you did to store the data inside of rr. Try class(rr[[1]]) or
class(rr[[2]]) and so on to explore a bit more. The variable rr is a list
that contains dataframes within it. To access the dataframes you must use
the syntax rr[[i]] where i is the index of the element of the list (or the
number of the dataframe in your case). For example:

df1 <- rr[[1]]
class(df1) # Check if this is class "data.frame".

df2 <- rr[[2]]
class(df2)

You can also try other ways to store the dataframes more efficiently. This
is just a quick-and-dirty solution to the code you provided. I recommend
reading more about lists in R to understand how they work and how they
differ from other data structures like vectors.

Hope this helps,
Warm regards.
Migdonio G.

On Fri, Jul 9, 2021 at 2:24 PM Kai Yang <yangkai9999 at yahoo.com> wrote:

> Hi Migdonio,
>
> I did try your code:
>
> # Initialize the rr variable as a list.
>
> rr <- as.list(rep(NA, nrow(ora)))
>
>
>
> # Run the for-loop to store all the CSVs in rr.
>
> for (j in 1:nrow(ora))
>
> {
>
>         mycol  <- ora[j,"fname"]
>
>         mycsv  <- paste0(mycol,".csv")
>
>         rdcsv  <- noquote(paste0("w:/project/_Joe.B/Oracle/data/", mycsv))
>
>         rr[[j]]     <- read.csv(rdcsv)
>
> }
>
>
> this code is working, but rr is not a data frame, R said: Large list ( 20
> elements .....). how can I use it as a data frame one by one?
>
> Thank you for your help
>
> Kai
>
> On Friday, July 9, 2021, 11:39:59 AM PDT, Migdonio Gonz?lez <
> migdonio.gonzalez02 at gmail.com> wrote:
>
>
> It seems that your problem is that you are using single quotes inside of
> the double quotes. This is not necessary. Here is the corrected for-loop:
>
> for (j in 1:nrow(ora))
> {
>         mycol  <- ora[j,"fname"]
>         mycsv  <- paste0(mycol,".csv")
>         rdcsv  <- noquote(paste0("w:/project/_Joe.B/Oracle/data/", mycsv))
>         rr     <- read.csv(rdcsv)
> }
>
> Also note that the rr variable will only store the last CSV, not all CSV.
> You will need to initialize the rr variable as a list to store all CSVs if
> that is what you require. Something like this:
>
> # Initialize the rr variable as a list.
> rr <- as.list(rep(NA, nrow(ora)))
>
> # Run the for-loop to store all the CSVs in rr.
> for (j in 1:nrow(ora))
> {
>         mycol  <- ora[j,"fname"]
>         mycsv  <- paste0(mycol,".csv")
>         rdcsv  <- noquote(paste0("w:/project/_Joe.B/Oracle/data/", mycsv))
>         rr[[j]]     <- read.csv(rdcsv)
> }
>
> Regards
> Migdonio G.
>
> On Fri, Jul 9, 2021 at 1:10 PM Kai Yang via R-help <r-help at r-project.org>
> wrote:
>
> Hello List,
> I use for loop to read csv difference file into data frame rr.  The data
> frame rr will be deleted after a comparison and go to the next csv file.
> Below is my code:
> for (j in 1:nrow(ora))
> {
>   mycol  <- ora[j,"fname"]
>   mycsv  <- paste0(mycol,".csv'")
>   rdcsv  <- noquote(paste0("'w:/project/_Joe.B/Oracle/data/", mycsv))
>   rr     <- read.csv(rdcsv)
> }
> but when I run this code, I got error message below:
> Error in file(file, "rt") : cannot open the connection
> In addition: Warning message:
> In file(file, "rt") :
>   cannot open file
> ''w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'': No such file or
> directory
>
> so, I checked the rdcsv and print it out, see below:
> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DISCRETE_VALUES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_QUESTIONS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_RUNS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/DATA_ENTRY_PAGES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/DISCRETE_VALUES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/ENTRY_GROUPS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_GROUPS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_VALUES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_LOT_DEFINITIONS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_SAMPLES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/MOLECULAR_WAREHOUSE.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/QUESTION_DEFINITIONS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/QUESTION_GROUPS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/RESPONSES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST_NAMES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_PLATE_ADDRESSES.csv'
> [1] 'w:/project/_Joe.B/Oracle/data/STORAGE_UNITS.csv'
> it seems correct. I copy and paste it into a code :
>  rr     <- read.csv( 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv')
> and it works fine.
> Can someone help me debug where is the problem in my for loop code?
> Thanks,
> Kai
>
>
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
>

	[[alternative HTML version deleted]]


From youy||ong @end|ng |rom gm@||@com  Fri Jul  9 20:14:33 2021
From: youy||ong @end|ng |rom gm@||@com (Youyi Fong)
Date: Fri, 9 Jul 2021 11:14:33 -0700
Subject: [R] syvcoxph and cox.zph for testing the PH assumption
Message-ID: <CAA4m0GaFBsLMfttsc2C9XDTKZxiMerNMdwR8P6BtaDgkGVsD6Q@mail.gmail.com>

Hello, is it kosher to call cox.zph on a syvcoxph model fit? I see that
someone proposed a modified version of cox.zph that uses resid(fit,
'schoenfeld', **weighted=TRUE**).

https://stats.stackexchange.com/questions/265307/assessing-proportional-hazards-assumption-of-a-cox-model-with-caseweights
Is that all it takes?
Thanks,
Youyi

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Sat Jul 10 18:30:07 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 10 Jul 2021 09:30:07 -0700
Subject: [R] error message from read.csv in loop
In-Reply-To: <CA+Mj9gV2PWNGediiKhJt37KYsNJAxUp3=q4KFi8H9SND8YAQvQ@mail.gmail.com>
References: <550599640.2967267.1625853711087.ref@mail.yahoo.com>
 <550599640.2967267.1625853711087@mail.yahoo.com>
 <CA+Mj9gV2PWNGediiKhJt37KYsNJAxUp3=q4KFi8H9SND8YAQvQ@mail.gmail.com>
Message-ID: <CAGxFJbR6VP8hjKZYpUVOre4MddCrgGZyYbHa2esb-oJLPyu2=A@mail.gmail.com>

"It seems that your problem is that you are using single quotes inside of
the double quotes."

That is FALSE. From ?Quotes:
"Single and double quotes delimit character constants. They can be
used interchangeably but double quotes are preferred (and character
constants are printed using double quotes), so single quotes are
normally only used to delimit character constants containing double
quotes."

Of course, pairs of each type of quote must properly match, must not
get confused with quotes in the delineated string, etc. , but they are
otherwise interchangeable. The whole of ?Quotes, especially the
examples, is informative and worth the read (imo).

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Sat, Jul 10, 2021 at 8:20 AM Migdonio Gonz?lez
<migdonio.gonzalez02 at gmail.com> wrote:
>
>  It seems that your problem is that you are using single quotes inside of
> the double quotes. This is not necessary. Here is the corrected for-loop:
>
> for (j in 1:nrow(ora))
> {
>         mycol  <- ora[j,"fname"]
>         mycsv  <- paste0(mycol,".csv")
>         rdcsv  <- noquote(paste0("w:/project/_Joe.B/Oracle/data/", mycsv))
>         rr     <- read.csv(rdcsv)
> }
>
> Also note that the rr variable will only store the last CSV, not all CSV.
> You will need to initialize the rr variable as a list to store all CSVs if
> that is what you require. Something like this:
>
> # Initialize the rr variable as a list.
> rr <- as.list(rep(NA, nrow(ora)))
>
> # Run the for-loop to store all the CSVs in rr.
> for (j in 1:nrow(ora))
> {
>         mycol  <- ora[j,"fname"]
>         mycsv  <- paste0(mycol,".csv")
>         rdcsv  <- noquote(paste0("w:/project/_Joe.B/Oracle/data/", mycsv))
>         rr[[j]]     <- read.csv(rdcsv)
> }
>
> Regards
> Migdonio G.
>
> On Fri, Jul 9, 2021 at 1:10 PM Kai Yang via R-help <r-help at r-project.org>
> wrote:
>
> > Hello List,
> > I use for loop to read csv difference file into data frame rr.  The data
> > frame rr will be deleted after a comparison and go to the next csv file.
> > Below is my code:
> > for (j in 1:nrow(ora))
> > {
> >   mycol  <- ora[j,"fname"]
> >   mycsv  <- paste0(mycol,".csv'")
> >   rdcsv  <- noquote(paste0("'w:/project/_Joe.B/Oracle/data/", mycsv))
> >   rr     <- read.csv(rdcsv)
> > }
> > but when I run this code, I got error message below:
> > Error in file(file, "rt") : cannot open the connection
> > In addition: Warning message:
> > In file(file, "rt") :
> >   cannot open file
> > ''w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'': No such file or
> > directory
> >
> > so, I checked the rdcsv and print it out, see below:
> > [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DISCRETE_VALUES.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_QUESTIONS.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_RUNS.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/DATA_ENTRY_PAGES.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/DISCRETE_VALUES.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/ENTRY_GROUPS.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_GROUPS.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_VALUES.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/GEMD_LOT_DEFINITIONS.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/GEMD_SAMPLES.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/MOLECULAR_WAREHOUSE.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/QUESTION_DEFINITIONS.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/QUESTION_GROUPS.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/RESPONSES.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST_NAMES.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_PLATE_ADDRESSES.csv'
> > [1] 'w:/project/_Joe.B/Oracle/data/STORAGE_UNITS.csv'
> > it seems correct. I copy and paste it into a code :
> >  rr     <- read.csv( 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv')
> > and it works fine.
> > Can someone help me debug where is the problem in my for loop code?
> > Thanks,
> > Kai
> >
> >
> >
> >
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bobby@kn|ght @end|ng |rom gm@||@com  Sat Jul 10 20:01:22 2021
From: bobby@kn|ght @end|ng |rom gm@||@com (Robert Knight)
Date: Sat, 10 Jul 2021 13:01:22 -0500
Subject: [R] problem for strsplit function
In-Reply-To: <20210710153311.0f490721@rolf-Latitude-E7470>
References: <20210710153311.0f490721@rolf-Latitude-E7470>
Message-ID: <1958F4E0-D73E-4ED4-8870-9305E524AC8F@gmail.com>

My method would be to use parse and deparse and substitute.  It would iterate over each file name and build a new list of file names with the last four characters removed to have only the left side, and only the last four remaining to have only the right side.  Then a new dataframe would be created of the partial file names.   

Deparse and substitute to get the file names into a string, then use character removal on the sides, put the file name into a new vector, and then create the relevant data frame if desired.

This allows one to Rely on their software development metaphor.  It might lack a certain finess, but the metaphor is either a loom or a boxing match against a CSV so it?s fun. :)

Sent from my iPhone

> On Jul 9, 2021, at 10:33 PM, Rolf Turner <r.turner at auckland.ac.nz> wrote:
> 
> ?
> This discussion has developed in such a way that it seems a better
> subject line would be "problem for the hairsplit function". :-)
> 
> cheers,
> 
> Rolf Turner
> 
> -- 
> Honorary Research Fellow
> Department of Statistics
> University of Auckland
> Phone: +64-9-373-7599 ext. 88276
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Jul 10 20:42:08 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 10 Jul 2021 14:42:08 -0400
Subject: [R] error message from read.csv in loop
In-Reply-To: <CAGxFJbR6VP8hjKZYpUVOre4MddCrgGZyYbHa2esb-oJLPyu2=A@mail.gmail.com>
References: <550599640.2967267.1625853711087.ref@mail.yahoo.com>
 <550599640.2967267.1625853711087@mail.yahoo.com>
 <CA+Mj9gV2PWNGediiKhJt37KYsNJAxUp3=q4KFi8H9SND8YAQvQ@mail.gmail.com>
 <CAGxFJbR6VP8hjKZYpUVOre4MddCrgGZyYbHa2esb-oJLPyu2=A@mail.gmail.com>
Message-ID: <552511a1-cd63-73a1-9581-c7f164aa9b60@gmail.com>

On 10/07/2021 12:30 p.m., Bert Gunter wrote:
> "It seems that your problem is that you are using single quotes inside of
> the double quotes."
> 
> That is FALSE. From ?Quotes:
> "Single and double quotes delimit character constants. They can be
> used interchangeably but double quotes are preferred (and character
> constants are printed using double quotes), so single quotes are
> normally only used to delimit character constants containing double
> quotes."
> 
> Of course, pairs of each type of quote must properly match, must not
> get confused with quotes in the delineated string, etc. , but they are
> otherwise interchangeable. The whole of ?Quotes, especially the
> examples, is informative and worth the read (imo).

I think Migdonio is right.  From the error message the problem is that 
the filename was being specified as 
"'w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'"

That is not a legal filename:  the single quotes probably tell Windows 
to interpret it as a single filename entry, not drive, path, filename. 
Or maybe the drive is being interpreted as "'w", which isn't a legal 
drive id.

In any case, if you set f to an existing full path, and file.exists(f) 
returns TRUE, you'll find that file.exists(paste0("'", f, "'")) returns 
FALSE.

Duncan Murdoch

> 
> Bert Gunter
> 
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> 
> On Sat, Jul 10, 2021 at 8:20 AM Migdonio Gonz?lez
> <migdonio.gonzalez02 at gmail.com> wrote:
>>
>>   It seems that your problem is that you are using single quotes inside of
>> the double quotes. This is not necessary. Here is the corrected for-loop:
>>
>> for (j in 1:nrow(ora))
>> {
>>          mycol  <- ora[j,"fname"]
>>          mycsv  <- paste0(mycol,".csv")
>>          rdcsv  <- noquote(paste0("w:/project/_Joe.B/Oracle/data/", mycsv))
>>          rr     <- read.csv(rdcsv)
>> }
>>
>> Also note that the rr variable will only store the last CSV, not all CSV.
>> You will need to initialize the rr variable as a list to store all CSVs if
>> that is what you require. Something like this:
>>
>> # Initialize the rr variable as a list.
>> rr <- as.list(rep(NA, nrow(ora)))
>>
>> # Run the for-loop to store all the CSVs in rr.
>> for (j in 1:nrow(ora))
>> {
>>          mycol  <- ora[j,"fname"]
>>          mycsv  <- paste0(mycol,".csv")
>>          rdcsv  <- noquote(paste0("w:/project/_Joe.B/Oracle/data/", mycsv))
>>          rr[[j]]     <- read.csv(rdcsv)
>> }
>>
>> Regards
>> Migdonio G.
>>
>> On Fri, Jul 9, 2021 at 1:10 PM Kai Yang via R-help <r-help at r-project.org>
>> wrote:
>>
>>> Hello List,
>>> I use for loop to read csv difference file into data frame rr.  The data
>>> frame rr will be deleted after a comparison and go to the next csv file.
>>> Below is my code:
>>> for (j in 1:nrow(ora))
>>> {
>>>    mycol  <- ora[j,"fname"]
>>>    mycsv  <- paste0(mycol,".csv'")
>>>    rdcsv  <- noquote(paste0("'w:/project/_Joe.B/Oracle/data/", mycsv))
>>>    rr     <- read.csv(rdcsv)
>>> }
>>> but when I run this code, I got error message below:
>>> Error in file(file, "rt") : cannot open the connection
>>> In addition: Warning message:
>>> In file(file, "rt") :
>>>    cannot open file
>>> ''w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'': No such file or
>>> directory
>>>
>>> so, I checked the rdcsv and print it out, see below:
>>> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DISCRETE_VALUES.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_QUESTIONS.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_RUNS.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/DATA_ENTRY_PAGES.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/DISCRETE_VALUES.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/ENTRY_GROUPS.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_GROUPS.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_VALUES.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_LOT_DEFINITIONS.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/GEMD_SAMPLES.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/MOLECULAR_WAREHOUSE.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/QUESTION_DEFINITIONS.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/QUESTION_GROUPS.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/RESPONSES.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST_NAMES.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_PLATE_ADDRESSES.csv'
>>> [1] 'w:/project/_Joe.B/Oracle/data/STORAGE_UNITS.csv'
>>> it seems correct. I copy and paste it into a code :
>>>   rr     <- read.csv( 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv')
>>> and it works fine.
>>> Can someone help me debug where is the problem in my for loop code?
>>> Thanks,
>>> Kai
>>>
>>>
>>>
>>>
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From m|gdon|o@gonz@|ez02 @end|ng |rom gm@||@com  Sat Jul 10 21:54:48 2021
From: m|gdon|o@gonz@|ez02 @end|ng |rom gm@||@com (=?UTF-8?Q?Migdonio_Gonz=C3=A1lez?=)
Date: Sat, 10 Jul 2021 14:54:48 -0500
Subject: [R] error message from read.csv in loop
In-Reply-To: <CAGxFJbR6VP8hjKZYpUVOre4MddCrgGZyYbHa2esb-oJLPyu2=A@mail.gmail.com>
References: <550599640.2967267.1625853711087.ref@mail.yahoo.com>
 <550599640.2967267.1625853711087@mail.yahoo.com>
 <CA+Mj9gV2PWNGediiKhJt37KYsNJAxUp3=q4KFi8H9SND8YAQvQ@mail.gmail.com>
 <CAGxFJbR6VP8hjKZYpUVOre4MddCrgGZyYbHa2esb-oJLPyu2=A@mail.gmail.com>
Message-ID: <CA+Mj9gVH3t9c76VO5cEP=DGUKgMhxqZqn8YESrJz0sdfaWptWw@mail.gmail.com>

Thank you very much for the clarification. I will try to use a more precise
language next time.

Warm regards
Migdonio G.

On Sat, Jul 10, 2021 at 11:30 AM Bert Gunter <bgunter.4567 at gmail.com> wrote:

> "It seems that your problem is that you are using single quotes inside of
> the double quotes."
>
> That is FALSE. From ?Quotes:
> "Single and double quotes delimit character constants. They can be
> used interchangeably but double quotes are preferred (and character
> constants are printed using double quotes), so single quotes are
> normally only used to delimit character constants containing double
> quotes."
>
> Of course, pairs of each type of quote must properly match, must not
> get confused with quotes in the delineated string, etc. , but they are
> otherwise interchangeable. The whole of ?Quotes, especially the
> examples, is informative and worth the read (imo).
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> On Sat, Jul 10, 2021 at 8:20 AM Migdonio Gonz?lez
> <migdonio.gonzalez02 at gmail.com> wrote:
> >
> >  It seems that your problem is that you are using single quotes inside of
> > the double quotes. This is not necessary. Here is the corrected for-loop:
> >
> > for (j in 1:nrow(ora))
> > {
> >         mycol  <- ora[j,"fname"]
> >         mycsv  <- paste0(mycol,".csv")
> >         rdcsv  <- noquote(paste0("w:/project/_Joe.B/Oracle/data/",
> mycsv))
> >         rr     <- read.csv(rdcsv)
> > }
> >
> > Also note that the rr variable will only store the last CSV, not all CSV.
> > You will need to initialize the rr variable as a list to store all CSVs
> if
> > that is what you require. Something like this:
> >
> > # Initialize the rr variable as a list.
> > rr <- as.list(rep(NA, nrow(ora)))
> >
> > # Run the for-loop to store all the CSVs in rr.
> > for (j in 1:nrow(ora))
> > {
> >         mycol  <- ora[j,"fname"]
> >         mycsv  <- paste0(mycol,".csv")
> >         rdcsv  <- noquote(paste0("w:/project/_Joe.B/Oracle/data/",
> mycsv))
> >         rr[[j]]     <- read.csv(rdcsv)
> > }
> >
> > Regards
> > Migdonio G.
> >
> > On Fri, Jul 9, 2021 at 1:10 PM Kai Yang via R-help <r-help at r-project.org
> >
> > wrote:
> >
> > > Hello List,
> > > I use for loop to read csv difference file into data frame rr.  The
> data
> > > frame rr will be deleted after a comparison and go to the next csv
> file.
> > > Below is my code:
> > > for (j in 1:nrow(ora))
> > > {
> > >   mycol  <- ora[j,"fname"]
> > >   mycsv  <- paste0(mycol,".csv'")
> > >   rdcsv  <- noquote(paste0("'w:/project/_Joe.B/Oracle/data/", mycsv))
> > >   rr     <- read.csv(rdcsv)
> > > }
> > > but when I run this code, I got error message below:
> > > Error in file(file, "rt") : cannot open the connection
> > > In addition: Warning message:
> > > In file(file, "rt") :
> > >   cannot open file
> > > ''w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'': No such file
> or
> > > directory
> > >
> > > so, I checked the rdcsv and print it out, see below:
> > > [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DEFINITIONS.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_DISCRETE_VALUES.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_QUESTIONS.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/ASSAY_RUNS.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/DATA_ENTRY_PAGES.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/DISCRETE_VALUES.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/ENTRY_GROUPS.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_GROUPS.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/GEMD_CODELIST_VALUES.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/GEMD_LOT_DEFINITIONS.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/GEMD_SAMPLES.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/MOLECULAR_WAREHOUSE.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/QUESTION_DEFINITIONS.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/QUESTION_GROUPS.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/RESPONSES.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_LIST_NAMES.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/SAMPLE_PLATE_ADDRESSES.csv'
> > > [1] 'w:/project/_Joe.B/Oracle/data/STORAGE_UNITS.csv'
> > > it seems correct. I copy and paste it into a code :
> > >  rr     <- read.csv( 'w:/project/_Joe.B/Oracle/data/RESPONDENTS.csv')
> > > and it works fine.
> > > Can someone help me debug where is the problem in my for loop code?
> > > Thanks,
> > > Kai
> > >
> > >
> > >
> > >
> > >
> > >         [[alternative HTML version deleted]]
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide
> > > http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> > >
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From enzo@ccc @end|ng |rom gm@||@com  Sun Jul 11 11:34:19 2021
From: enzo@ccc @end|ng |rom gm@||@com (Enzo Cocca)
Date: Sun, 11 Jul 2021 11:34:19 +0200
Subject: [R] rWind: Error in if (is.numeric(v) && any(v < 0)) { : missing
 value where TRUE/FALSE needed
Message-ID: <CAC_+zupYzFm+d00L2BzjOo-se8A0OvTeSmFOWFXG9=oqbTBToQ@mail.gmail.com>

Hi,
I'm trying to work with rWind but when try to create a shortestpath (From
point a to B with gdistance package) I have this error:


Error in if (is.numeric(v) && any(v < 0)) { :
  missing value where TRUE/FALSE needed

so this is the code:

library(rWind)
library(raster)
library(gdistance)

w<-wind.dl(2020, 2, 12, 0,-17,28,45,50) #download all Mediterranea area

wind<-wind2raster(w) # create two raster about speed and direction wind

Conductance<-flow.dispersion(wind)

AtoBo<- shortestPath(Conductance,spagna,libano,output="SpatialLines")
#create shortestpath (spagna and libano are two SpatialPointsDataFrame)

where I wrong?

Thanks in advance
E

-- 
Enzo Cocca PhD
in "Science and Technology for Archaeology and Cultural Heritage"

ISMEO
International Association of Mediterranean and Oriental Studies


mail: enzo.ccc at gmail.com
cell: +393495087014

	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Sun Jul 11 11:49:33 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Sun, 11 Jul 2021 12:49:33 +0300
Subject: [R] 
 rWind: Error in if (is.numeric(v) && any(v < 0)) { : missing
 value where TRUE/FALSE needed
In-Reply-To: <CAC_+zupYzFm+d00L2BzjOo-se8A0OvTeSmFOWFXG9=oqbTBToQ@mail.gmail.com>
References: <CAC_+zupYzFm+d00L2BzjOo-se8A0OvTeSmFOWFXG9=oqbTBToQ@mail.gmail.com>
Message-ID: <CAGgJW75oSmNDA4Sv_0XhpJauWq1xLqjGJWxSGXet47-xcn7BkQ@mail.gmail.com>

This error can result from v with NAs.
e.g. to reproduce the error message

> v <- as.numeric(NA)
> if (is.numeric(v) && any(v < 0))  cat("hello world\n")

see also
https://stackoverflow.com/questions/7355187/error-in-if-while-condition-missing-value-where-true-false-needed

HTH,
Eric

	[[alternative HTML version deleted]]


From enzo@ccc @end|ng |rom gm@||@com  Sun Jul 11 12:19:57 2021
From: enzo@ccc @end|ng |rom gm@||@com (Enzo Cocca)
Date: Sun, 11 Jul 2021 12:19:57 +0200
Subject: [R] 
 rWind: Error in if (is.numeric(v) && any(v < 0)) { : missing
 value where TRUE/FALSE needed
In-Reply-To: <CAGgJW75oSmNDA4Sv_0XhpJauWq1xLqjGJWxSGXet47-xcn7BkQ@mail.gmail.com>
References: <CAC_+zupYzFm+d00L2BzjOo-se8A0OvTeSmFOWFXG9=oqbTBToQ@mail.gmail.com>
 <CAGgJW75oSmNDA4Sv_0XhpJauWq1xLqjGJWxSGXet47-xcn7BkQ@mail.gmail.com>
Message-ID: <CAC_+zuoi+TWtOsASOy9SxDz2EL384+3Y6FOJmNhOnk1ra8odYQ@mail.gmail.com>

Hi Eric,
I know but I can't understand where is the error.
the function shortestpath wants:

x="TransitionLayer", origin="Coords", goal="Coords"
or
x="TransitionLayer", origin="numeric", goal="numeric"
 or
x="TransitionLayer", origin="SpatialPointsDataFrame",
goal="SpatialPointsDataFrame"

so I followed the example in the rWind package and works, than I changed
the coordinates and I have the error



Il giorno dom 11 lug 2021 alle ore 11:50 Eric Berger <ericjberger at gmail.com>
ha scritto:

> This error can result from v with NAs.
> e.g. to reproduce the error message
>
> > v <- as.numeric(NA)
> > if (is.numeric(v) && any(v < 0))  cat("hello world\n")
>
> see also
>
> https://stackoverflow.com/questions/7355187/error-in-if-while-condition-missing-value-where-true-false-needed
>
> HTH,
> Eric
>
>

-- 
Enzo Cocca PhD
in "Science and Technology for Archaeology and Cultural Heritage"

ISMEO
International Association of Mediterranean and Oriental Studies


mail: enzo.ccc at gmail.com
cell: +393495087014

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Sun Jul 11 15:23:59 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sun, 11 Jul 2021 06:23:59 -0700
Subject: [R] 
 rWind: Error in if (is.numeric(v) && any(v < 0)) { : missing
 value where TRUE/FALSE needed
In-Reply-To: <CAC_+zuoi+TWtOsASOy9SxDz2EL384+3Y6FOJmNhOnk1ra8odYQ@mail.gmail.com>
References: <CAC_+zupYzFm+d00L2BzjOo-se8A0OvTeSmFOWFXG9=oqbTBToQ@mail.gmail.com>
 <CAGgJW75oSmNDA4Sv_0XhpJauWq1xLqjGJWxSGXet47-xcn7BkQ@mail.gmail.com>
 <CAC_+zuoi+TWtOsASOy9SxDz2EL384+3Y6FOJmNhOnk1ra8odYQ@mail.gmail.com>
Message-ID: <CAGxFJbSK0eoNR77A_uycz19wdC92RSdScUboJmATTxWA5LXPnQ@mail.gmail.com>

Further questions would be better sent to:
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Sun, Jul 11, 2021 at 3:20 AM Enzo Cocca <enzo.ccc at gmail.com> wrote:

> Hi Eric,
> I know but I can't understand where is the error.
> the function shortestpath wants:
>
> x="TransitionLayer", origin="Coords", goal="Coords"
> or
> x="TransitionLayer", origin="numeric", goal="numeric"
>  or
> x="TransitionLayer", origin="SpatialPointsDataFrame",
> goal="SpatialPointsDataFrame"
>
> so I followed the example in the rWind package and works, than I changed
> the coordinates and I have the error
>
>
>
> Il giorno dom 11 lug 2021 alle ore 11:50 Eric Berger <
> ericjberger at gmail.com>
> ha scritto:
>
> > This error can result from v with NAs.
> > e.g. to reproduce the error message
> >
> > > v <- as.numeric(NA)
> > > if (is.numeric(v) && any(v < 0))  cat("hello world\n")
> >
> > see also
> >
> >
> https://stackoverflow.com/questions/7355187/error-in-if-while-condition-missing-value-where-true-false-needed
> >
> > HTH,
> > Eric
> >
> >
>
> --
> Enzo Cocca PhD
> in "Science and Technology for Archaeology and Cultural Heritage"
>
> ISMEO
> International Association of Mediterranean and Oriental Studies
>
>
> mail: enzo.ccc at gmail.com
> cell: +393495087014
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From jhunter @end|ng |rom |deve|opment@|n|o  Sun Jul 11 21:34:46 2021
From: jhunter @end|ng |rom |deve|opment@|n|o (Jeffrey Hunter)
Date: Sun, 11 Jul 2021 15:34:46 -0400
Subject: [R] MAC version 10
In-Reply-To: <6C0F2170-B1DC-43C3-A20D-ED1FDA579405@gmail.com>
References: <3C84266E-8355-4817-841A-808F3FFE0487@icloud.com>
 <383C7D2A-52A9-42AC-9B3E-B079E547DBF4@idevelopment.info>
 <6C0F2170-B1DC-43C3-A20D-ED1FDA579405@gmail.com>
Message-ID: <CD91F311-DB61-40B4-9428-E588BF60202A@idevelopment.info>

Hello Farrah,

I too am running macOS Catalina 10.15.7. The age of your Mac shouldn?t matter.

>From the website I provided, you should download the file R-4.1.0.pkg. After successfully downloading the package to your Downloads folder, simply double-click on the file.

Thanks,
Jeff



> On Jul 10, 2021, at 5:13 PM, Farrah T <farahnaz.taghavi at gmail.com> wrote:
> 
> Hello Jeff,
> 
> Thank you for getting back to me .That file doesn?t work on my MAC since I have an older MAC. I have a 10.15.7 and R-4.1.) works on newer version. Can you assist? 
> 
> 
> Thanks, 
> Farrah
> 
>> On Jul 8, 2021, at 3:28 PM, Jeffrey Hunter <jhunter at idevelopment.info <mailto:jhunter at idevelopment.info>> wrote:
>> 
>> Hello:
>> 
>> https://cran.r-project.org/bin/macosx/ <https://cran.r-project.org/bin/macosx/>
>> 
>> Download the R-4.1.0.pkg <https://cran.r-project.org/bin/macosx/base/R-4.1.0.pkg> and install it as you would any macOS app.
>> 
>> ~jeff
>> 
>> Jeffrey M. Hunter
>> Sr. DBA, Mathematics Programmer, Author
>> jhunter at idevelopment.info <mailto:jhunter at idevelopment.info>
>> 
>> A computer without a Microsoft operating system is like a dog without bricks tied to its head.
>> 
>> God rot Windows and all its ugly, clunky, badly-designed horror.
>> 
>>> On Jul 8, 2021, at 2:19 PM, Farrah T <farahnaz.taghavi at gmail.com <mailto:farahnaz.taghavi at gmail.com>> wrote:
>>> 
>>> ?Hello, 
>>> 
>>> I have Mac Version 10 Catalina and I would like to download R on this device for my summer class. I have difficulty to find a right option when I go to the website. May you please kindly share the step by step guidance with me. The screenshot with be great. I downloaded few zip files and yet didn?t know how to follow after that step neither. Looking forward to hearing from your side. 
>>> 
>>> Best, 
>>> Fararh
>>> ______________________________________________
>>> R-help at r-project.org <mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help <https://stat.ethz.ch/mailman/listinfo/r-help>
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html <http://www.r-project.org/posting-guide.html>
>>> and provide commented, minimal, self-contained, reproducible code.
> 


From m@tth|@@-gond@n @end|ng |rom gmx@de  Mon Jul 12 12:41:34 2021
From: m@tth|@@-gond@n @end|ng |rom gmx@de (Matthias Gondan)
Date: Mon, 12 Jul 2021 12:41:34 +0200
Subject: [R] density with weights missing values
Message-ID: <1Mv2xO-1lCIn818i0-00qxLT@mail.gmx.net>

Dear R users,

This works as expected:

? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE))

This raises an error

? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, 1)))
? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, NA)))

This seems to work (it triggers a warning that the weights don?t add up to 1, which makes sense*):

? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1)))

Questions

? But shouldn?t the na.rm filter also filter the corresponding weights?
? Extra question: In case the na.rm filter is changed to filter the weights, the check for sum(weights) == 1 might trigger false positive warnings since the weights might not add up to 1 anymore

Best wishes,

Matthias


	[[alternative HTML version deleted]]


From m@tth|@@-gond@n @end|ng |rom gmx@de  Mon Jul 12 15:09:38 2021
From: m@tth|@@-gond@n @end|ng |rom gmx@de (Matthias Gondan)
Date: Mon, 12 Jul 2021 15:09:38 +0200
Subject: [R] density with weights missing values
In-Reply-To: <CABcYAd+YgDtUq4EKUzTXJ9VXSxsfnXqEqRUGOJTbyRqGA5YuxA@mail.gmail.com>
References: <1Mv2xO-1lCIn818i0-00qxLT@mail.gmx.net>
 <CABcYAd+YgDtUq4EKUzTXJ9VXSxsfnXqEqRUGOJTbyRqGA5YuxA@mail.gmail.com>
Message-ID: <1MkYXs-1lIGse0UgA-00m75k@mail.gmx.net>

Weighted mean behaves differently:
? weight is excluded for missing x
? no warning for sum(weights) != 1

> weighted.mean(c(1, 2, 3, 4), weights=c(1, 1, 1, 1))
[1] 2.5
> weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1))
[1] NA
> weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1), na.rm=TRUE)
[1] 2




Von: Richard O'Keefe
Gesendet: Montag, 12. Juli 2021 13:18
An: Matthias Gondan
Betreff: Re: [R] density with weights missing values

Does your copy of R say that the weights must add up to 1?
?density doesn't say that in mine.   But it does check.

On Mon, 12 Jul 2021 at 22:42, Matthias Gondan <matthias-gondan at gmx.de> wrote:
>
> Dear R users,
>
> This works as expected:
>
> ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE))
>
> This raises an error
>
> ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, 1)))
> ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, NA)))
>
> This seems to work (it triggers a warning that the weights don?t add up to 1, which makes sense*):
>
> ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1)))
>
> Questions
>
> ? But shouldn?t the na.rm filter also filter the corresponding weights?
> ? Extra question: In case the na.rm filter is changed to filter the weights, the check for sum(weights) == 1 might trigger false positive warnings since the weights might not add up to 1 anymore
>
> Best wishes,
>
> Matthias
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Mon Jul 12 16:25:27 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 12 Jul 2021 07:25:27 -0700
Subject: [R] density with weights missing values
In-Reply-To: <1MkYXs-1lIGse0UgA-00m75k@mail.gmx.net>
References: <1Mv2xO-1lCIn818i0-00qxLT@mail.gmx.net>
 <CABcYAd+YgDtUq4EKUzTXJ9VXSxsfnXqEqRUGOJTbyRqGA5YuxA@mail.gmail.com>
 <1MkYXs-1lIGse0UgA-00m75k@mail.gmx.net>
Message-ID: <CAGxFJbTTZktw8TzpziSgdM2f4U410hMh_7uofiEj8G+RF57+iA@mail.gmail.com>

The behavior is as documented AFAICS.

na.rm
logical; if TRUE, missing values are removed from x. If FALSE any
missing values cause an error.

The default is FALSE.

weights
numeric vector of non-negative observation weights.

NA is not a non-negative numeric.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Mon, Jul 12, 2021 at 6:10 AM Matthias Gondan <matthias-gondan at gmx.de> wrote:
>
> Weighted mean behaves differently:
> ? weight is excluded for missing x
> ? no warning for sum(weights) != 1
>
> > weighted.mean(c(1, 2, 3, 4), weights=c(1, 1, 1, 1))
> [1] 2.5
> > weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1))
> [1] NA
> > weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1), na.rm=TRUE)
> [1] 2
>
>
>
>
> Von: Richard O'Keefe
> Gesendet: Montag, 12. Juli 2021 13:18
> An: Matthias Gondan
> Betreff: Re: [R] density with weights missing values
>
> Does your copy of R say that the weights must add up to 1?
> ?density doesn't say that in mine.   But it does check.
>
> On Mon, 12 Jul 2021 at 22:42, Matthias Gondan <matthias-gondan at gmx.de> wrote:
> >
> > Dear R users,
> >
> > This works as expected:
> >
> > ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE))
> >
> > This raises an error
> >
> > ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, 1)))
> > ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, NA)))
> >
> > This seems to work (it triggers a warning that the weights don?t add up to 1, which makes sense*):
> >
> > ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1)))
> >
> > Questions
> >
> > ? But shouldn?t the na.rm filter also filter the corresponding weights?
> > ? Extra question: In case the na.rm filter is changed to filter the weights, the check for sum(weights) == 1 might trigger false positive warnings since the weights might not add up to 1 anymore
> >
> > Best wishes,
> >
> > Matthias
> >
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m@tth|@@-gond@n @end|ng |rom gmx@de  Mon Jul 12 18:13:12 2021
From: m@tth|@@-gond@n @end|ng |rom gmx@de (matthias-gondan)
Date: Mon, 12 Jul 2021 18:13:12 +0200
Subject: [R] density with weights missing values
In-Reply-To: <CAGxFJbTTZktw8TzpziSgdM2f4U410hMh_7uofiEj8G+RF57+iA@mail.gmail.com>
Message-ID: <1MYvcG-1lgtKu0Cwq-00Uu4d@mail.gmx.net>

The thing is that for na.rm=TRUE, I would expect the weights corresponding to the missing x to be removed, as well. Like in weighted.mean. So this one shouldn't raise an error,density(c(1, 2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, 1))Or am I missing something??
-------- Urspr?ngliche Nachricht --------Von: Bert Gunter <bgunter.4567 at gmail.com> Datum: 12.07.21  16:25  (GMT+01:00) An: Matthias Gondan <matthias-gondan at gmx.de> Cc: r-help at r-project.org Betreff: Re: [R] density with weights missing values The behavior is as documented AFAICS.na.rmlogical; if TRUE, missing values are removed from x. If FALSE anymissing values cause an error.The default is FALSE.weightsnumeric vector of non-negative observation weights.NA is not a non-negative numeric.Bert Gunter"The trouble with having an open mind is that people keep coming alongand sticking things into it."-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )Bert Gunter"The trouble with having an open mind is that people keep coming alongand sticking things into it."-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )On Mon, Jul 12, 2021 at 6:10 AM Matthias Gondan <matthias-gondan at gmx.de> wrote:>> Weighted mean behaves differently:> ? weight is excluded for missing x> ? no warning for sum(weights) != 1>> > weighted.mean(c(1, 2, 3, 4), weights=c(1, 1, 1, 1))> [1] 2.5> > weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1))> [1] NA> > weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1), na.rm=TRUE)> [1] 2>>>>> Von: Richard O'Keefe> Gesendet: Montag, 12. Juli 2021 13:18> An: Matthias Gondan> Betreff: Re: [R] density with weights missing values>> Does your copy of R say that the weights must add up to 1?> ?density doesn't say that in mine.?? But it does check.>> On Mon, 12 Jul 2021 at 22:42, Matthias Gondan <matthias-gondan at gmx.de> wrote:> >> > Dear R users,> >> > This works as expected:> >> > ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE))> >> > This raises an error> >> > ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, 1)))> > ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, NA)))> >> > This seems to work (it triggers a warning that the weights don?t add up to 1, which makes sense*):> >> > ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1)))> >> > Questions> >> > ? But shouldn?t the na.rm filter also filter the corresponding weights?> > ? Extra question: In case the na.rm filter is changed to filter the weights, the check for sum(weights) == 1 might trigger false positive warnings since the weights might not add up to 1 anymore> >> > Best wishes,> >> > Matthias> >> >> >???????? [[alternative HTML version deleted]]> >> > ______________________________________________> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see> > https://stat.ethz.ch/mailman/listinfo/r-help> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html> > and provide commented, minimal, self-contained, reproducible code.>>>???????? [[alternative HTML version deleted]]>> ______________________________________________> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see> https://stat.ethz.ch/mailman/listinfo/r-help> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html> and provide commented, minimal, self-contained, reproducible code.
	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Mon Jul 12 18:35:46 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 12 Jul 2021 09:35:46 -0700
Subject: [R] density with weights missing values
In-Reply-To: <1MYvcG-1lgtKu0Cwq-00Uu4d@mail.gmx.net>
References: <CAGxFJbTTZktw8TzpziSgdM2f4U410hMh_7uofiEj8G+RF57+iA@mail.gmail.com>
 <1MYvcG-1lgtKu0Cwq-00Uu4d@mail.gmx.net>
Message-ID: <CAGxFJbQ5_RLhU1uAQuF-dDb99-FzeSU_WNdpTvc3JdVC53nXkA@mail.gmail.com>

My point (confusingly made!) is that documented behavior is all you
should expect. The docs say that weights must be non-negative numeric.
If they aren't...

"Consistency" of behavior among different functions is highly
subjective -- it depends exactly on what one considers to be
"consistent", nicht wahr? And, of course, with thousands of packages
and hundreds of weight functions used for different purposes, this
seems a practical impossibility here.

However, I would agree that given R's "organic" growth over time,
"jarring" inconsistencies (i.e. that most would agree are
inconsistent) may exist. This may be such a case. But, again, all you
can do is follow the docs whether or not the behavior meets your
"reasonable" expectations.

Just my opinion, of course. Consume at your own risk.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Mon, Jul 12, 2021 at 9:13 AM matthias-gondan <matthias-gondan at gmx.de> wrote:
>
> The thing is that for na.rm=TRUE, I would expect the weights corresponding to the missing x to be removed, as well. Like in weighted.mean. So this one shouldn't raise an error,
>
> density(c(1, 2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, 1))
>
> Or am I missing something?
>
> -------- Urspr?ngliche Nachricht --------
> Von: Bert Gunter <bgunter.4567 at gmail.com>
> Datum: 12.07.21 16:25 (GMT+01:00)
> An: Matthias Gondan <matthias-gondan at gmx.de>
> Cc: r-help at r-project.org
> Betreff: Re: [R] density with weights missing values
>
> The behavior is as documented AFAICS.
>
> na.rm
> logical; if TRUE, missing values are removed from x. If FALSE any
> missing values cause an error.
>
> The default is FALSE.
>
> weights
> numeric vector of non-negative observation weights.
>
> NA is not a non-negative numeric.
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
>
> On Mon, Jul 12, 2021 at 6:10 AM Matthias Gondan <matthias-gondan at gmx.de> wrote:
> >
> > Weighted mean behaves differently:
> > ? weight is excluded for missing x
> > ? no warning for sum(weights) != 1
> >
> > > weighted.mean(c(1, 2, 3, 4), weights=c(1, 1, 1, 1))
> > [1] 2.5
> > > weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1))
> > [1] NA
> > > weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1), na.rm=TRUE)
> > [1] 2
> >
> >
> >
> >
> > Von: Richard O'Keefe
> > Gesendet: Montag, 12. Juli 2021 13:18
> > An: Matthias Gondan
> > Betreff: Re: [R] density with weights missing values
> >
> > Does your copy of R say that the weights must add up to 1?
> > ?density doesn't say that in mine.   But it does check.
> >
> > On Mon, 12 Jul 2021 at 22:42, Matthias Gondan <matthias-gondan at gmx.de> wrote:
> > >
> > > Dear R users,
> > >
> > > This works as expected:
> > >
> > > ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE))
> > >
> > > This raises an error
> > >
> > > ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, 1)))
> > > ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, NA)))
> > >
> > > This seems to work (it triggers a warning that the weights don?t add up to 1, which makes sense*):
> > >
> > > ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1)))
> > >
> > > Questions
> > >
> > > ? But shouldn?t the na.rm filter also filter the corresponding weights?
> > > ? Extra question: In case the na.rm filter is changed to filter the weights, the check for sum(weights) == 1 might trigger false positive warnings since the weights might not add up to 1 anymore
> > >
> > > Best wishes,
> > >
> > > Matthias
> > >
> > >
> > >         [[alternative HTML version deleted]]
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> >
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Mon Jul 12 18:44:43 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Mon, 12 Jul 2021 09:44:43 -0700
Subject: [R] density with weights missing values
In-Reply-To: <1MYvcG-1lgtKu0Cwq-00Uu4d@mail.gmx.net>
References: <1MYvcG-1lgtKu0Cwq-00Uu4d@mail.gmx.net>
Message-ID: <72827518-2941-4C98-94A8-4A71A5929708@dcn.davis.ca.us>

Sure, you might think that.

But most likely the reason this code has not been corrected is that when you give weights for missing data the most correct result is for your entire density to be invalid.

Fix your inputs so they make sense to you and there is no problem. But absent your intellectual input to restructure your problem the weights no longer make sense once density() removes the NAs from the data.

On July 12, 2021 9:13:12 AM PDT, matthias-gondan <matthias-gondan at gmx.de> wrote:
>The thing is that for na.rm=TRUE, I would expect the weights
>corresponding to the missing x to be removed, as well. Like in
>weighted.mean. So this one shouldn't raise an error,density(c(1, 2, 3,
>4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, 1))Or am I missing
>something??
>-------- Urspr?ngliche Nachricht --------Von: Bert Gunter
><bgunter.4567 at gmail.com> Datum: 12.07.21  16:25  (GMT+01:00) An:
>Matthias Gondan <matthias-gondan at gmx.de> Cc: r-help at r-project.org
>Betreff: Re: [R] density with weights missing values The behavior is as
>documented AFAICS.na.rmlogical; if TRUE, missing values are removed
>from x. If FALSE anymissing values cause an error.The default is
>FALSE.weightsnumeric vector of non-negative observation weights.NA is
>not a non-negative numeric.Bert Gunter"The trouble with having an open
>mind is that people keep coming alongand sticking things into it."--
>Opus (aka Berkeley Breathed in his "Bloom County" comic strip )Bert
>Gunter"The trouble with having an open mind is that people keep coming
>alongand sticking things into it."-- Opus (aka Berkeley Breathed in his
>"Bloom County" comic strip )On Mon, Jul 12, 2021 at 6:10 AM Matthias
>Gondan <matthias-gondan at gmx.de> wrote:>> Weighted mean behaves
>differently:> ? weight is excluded for missing x> ? no warning for
>sum(weights) != 1>> > weighted.mean(c(1, 2, 3, 4), weights=c(1, 1, 1,
>1))> [1] 2.5> > weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1))>
>[1] NA> > weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1),
>na.rm=TRUE)> [1] 2>>>>> Von: Richard O'Keefe> Gesendet: Montag, 12.
>Juli 2021 13:18> An: Matthias Gondan> Betreff: Re: [R] density with
>weights missing values>> Does your copy of R say that the weights must
>add up to 1?> ?density doesn't say that in mine.?? But it does check.>>
>On Mon, 12 Jul 2021 at 22:42, Matthias Gondan <matthias-gondan at gmx.de>
>wrote:> >> > Dear R users,> >> > This works as expected:> >> > ?
>plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE))> >> > This raises an
>error> >> > ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE,
>weights=c(1, 1, 1, 1, 1, 1)))> > ? plot(density(c(1,2, 3, 4, 5, NA),
>na.rm=TRUE, weights=c(1, 1, 1, 1, 1, NA)))> >> > This seems to work (it
>triggers a warning that the weights don?t add up to 1, which makes
>sense*):> >> > ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE,
>weights=c(1, 1, 1, 1, 1)))> >> > Questions> >> > ? But shouldn?t the
>na.rm filter also filter the corresponding weights?> > ? Extra
>question: In case the na.rm filter is changed to filter the weights,
>the check for sum(weights) == 1 might trigger false positive warnings
>since the weights might not add up to 1 anymore> >> > Best wishes,> >>
>> Matthias> >> >> >???????? [[alternative HTML version deleted]]> >> >
>______________________________________________> > R-help at r-project.org
>mailing list -- To UNSUBSCRIBE and more, see> >
>https://stat.ethz.ch/mailman/listinfo/r-help> > PLEASE do read the
>posting guide http://www.R-project.org/posting-guide.html> > and
>provide commented, minimal, self-contained, reproducible
>code.>>>???????? [[alternative HTML version deleted]]>>
>______________________________________________> R-help at r-project.org
>mailing list -- To UNSUBSCRIBE and more, see>
>https://stat.ethz.ch/mailman/listinfo/r-help> PLEASE do read the
>posting guide http://www.R-project.org/posting-guide.html> and provide
>commented, minimal, self-contained, reproducible code.
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From m@tth|@@-gond@n @end|ng |rom gmx@de  Mon Jul 12 19:22:19 2021
From: m@tth|@@-gond@n @end|ng |rom gmx@de (matthias-gondan)
Date: Mon, 12 Jul 2021 19:22:19 +0200
Subject: [R] density with weights missing values
In-Reply-To: <72827518-2941-4C98-94A8-4A71A5929708@dcn.davis.ca.us>
Message-ID: <1MVvL5-1lbfit2sVR-00RqWE@mail.gmx.net>

You're right, of course. Extrapolating your argument a bit, the whole practice of na.rm is questionable, since there's always a reason for missingness (that is not in x and rarely elsewhere in the data)Best wishes?Matthias?
-------- Urspr?ngliche Nachricht --------Von: Jeff Newmiller <jdnewmil at dcn.davis.ca.us> Datum: 12.07.21  18:44  (GMT+01:00) An: r-help at r-project.org, matthias-gondan <matthias-gondan at gmx.de>, Bert Gunter <bgunter.4567 at gmail.com> Cc: r-help at r-project.org Betreff: Re: [R] density with weights missing values Sure, you might think that.But most likely the reason this code has not been corrected is that when you give weights for missing data the most correct result is for your entire density to be invalid.Fix your inputs so they make sense to you and there is no problem. But absent your intellectual input to restructure your problem the weights no longer make sense once density() removes the NAs from the data.On July 12, 2021 9:13:12 AM PDT, matthias-gondan <matthias-gondan at gmx.de> wrote:>The thing is that for na.rm=TRUE, I would expect the weights>corresponding to the missing x to be removed, as well. Like in>weighted.mean. So this one shouldn't raise an error,density(c(1, 2, 3,>4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, 1))Or am I missing>something??>-------- Urspr?ngliche Nachricht --------Von: Bert Gunter><bgunter.4567 at gmail.com> Datum: 12.07.21? 16:25? (GMT+01:00) An:>Matthias Gondan <matthias-gondan at gmx.de> Cc: r-help at r-project.org>Betreff: Re: [R] density with weights missing values The behavior is as>documented AFAICS.na.rmlogical; if TRUE, missing values are removed>from x. If FALSE anymissing values cause an error.The default is>FALSE.weightsnumeric vector of non-negative observation weights.NA is>not a non-negative numeric.Bert Gunter"The trouble with having an open>mind is that people keep coming alongand sticking things into it."-->Opus (aka Berkeley Breathed in his "Bloom County" comic strip )Bert>Gunter"The trouble with having an open mind is that people keep coming>alongand sticking things into it."-- Opus (aka Berkeley Breathed in his>"Bloom County" comic strip )On Mon, Jul 12, 2021 at 6:10 AM Matthias>Gondan <matthias-gondan at gmx.de> wrote:>> Weighted mean behaves>differently:> ? weight is excluded for missing x> ? no warning for>sum(weights) != 1>> > weighted.mean(c(1, 2, 3, 4), weights=c(1, 1, 1,>1))> [1] 2.5> > weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1))>>[1] NA> > weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1),>na.rm=TRUE)> [1] 2>>>>> Von: Richard O'Keefe> Gesendet: Montag, 12.>Juli 2021 13:18> An: Matthias Gondan> Betreff: Re: [R] density with>weights missing values>> Does your copy of R say that the weights must>add up to 1?> ?density doesn't say that in mine.?? But it does check.>>>On Mon, 12 Jul 2021 at 22:42, Matthias Gondan <matthias-gondan at gmx.de>>wrote:> >> > Dear R users,> >> > This works as expected:> >> > ?>plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE))> >> > This raises an>error> >> > ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE,>weights=c(1, 1, 1, 1, 1, 1)))> > ? plot(density(c(1,2, 3, 4, 5, NA),>na.rm=TRUE, weights=c(1, 1, 1, 1, 1, NA)))> >> > This seems to work (it>triggers a warning that the weights don?t add up to 1, which makes>sense*):> >> > ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE,>weights=c(1, 1, 1, 1, 1)))> >> > Questions> >> > ? But shouldn?t the>na.rm filter also filter the corresponding weights?> > ? Extra>question: In case the na.rm filter is changed to filter the weights,>the check for sum(weights) == 1 might trigger false positive warnings>since the weights might not add up to 1 anymore> >> > Best wishes,> >>>> Matthias> >> >> >???????? [[alternative HTML version deleted]]> >> >>______________________________________________> > R-help at r-project.org>mailing list -- To UNSUBSCRIBE and more, see> >>https://stat.ethz.ch/mailman/listinfo/r-help> > PLEASE do read the>posting guide http://www.R-project.org/posting-guide.html> > and>provide commented, minimal, self-contained, reproducible>code.>>>???????? [[alternative HTML version deleted]]>>>______________________________________________> R-help at r-project.org>mailing list -- To UNSUBSCRIBE and more, see>>https://stat.ethz.ch/mailman/listinfo/r-help> PLEASE do read the>posting guide http://www.R-project.org/posting-guide.html> and provide>commented, minimal, self-contained, reproducible code.>	[[alternative HTML version deleted]]>>______________________________________________>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see>https://stat.ethz.ch/mailman/listinfo/r-help>PLEASE do read the posting guide>http://www.R-project.org/posting-guide.html>and provide commented, minimal, self-contained, reproducible code.-- Sent from my phone. Please excuse my brevity.
	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Mon Jul 12 19:59:59 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Mon, 12 Jul 2021 10:59:59 -0700
Subject: [R] density with weights missing values
In-Reply-To: <1MVvL5-1lbfit2sVR-00RqWE@mail.gmx.net>
References: <1MVvL5-1lbfit2sVR-00RqWE@mail.gmx.net>
Message-ID: <40A05067-5930-497D-A6DD-DE5D5E94D1C9@dcn.davis.ca.us>

I think the missing weights are more crucial than equally-weighted missing data would be.

what if there is a heavy weight on the missing values? it could completely change the interpretation of the result.

On July 12, 2021 10:22:19 AM PDT, matthias-gondan <matthias-gondan at gmx.de> wrote:
>You're right, of course. Extrapolating your argument a bit, the whole
>practice of na.rm is questionable, since there's always a reason for
>missingness (that is not in x and rarely elsewhere in the data)Best
>wishes?Matthias?
>-------- Urspr?ngliche Nachricht --------Von: Jeff Newmiller
><jdnewmil at dcn.davis.ca.us> Datum: 12.07.21  18:44  (GMT+01:00) An:
>r-help at r-project.org, matthias-gondan <matthias-gondan at gmx.de>, Bert
>Gunter <bgunter.4567 at gmail.com> Cc: r-help at r-project.org Betreff: Re:
>[R] density with weights missing values Sure, you might think that.But
>most likely the reason this code has not been corrected is that when
>you give weights for missing data the most correct result is for your
>entire density to be invalid.Fix your inputs so they make sense to you
>and there is no problem. But absent your intellectual input to
>restructure your problem the weights no longer make sense once
>density() removes the NAs from the data.On July 12, 2021 9:13:12 AM
>PDT, matthias-gondan <matthias-gondan at gmx.de> wrote:>The thing is that
>for na.rm=TRUE, I would expect the weights>corresponding to the missing
>x to be removed, as well. Like in>weighted.mean. So this one shouldn't
>raise an error,density(c(1, 2, 3,>4, 5, NA), na.rm=TRUE, weights=c(1,
>1, 1, 1, 1, 1))Or am I missing>something??>-------- Urspr?ngliche
>Nachricht --------Von: Bert Gunter><bgunter.4567 at gmail.com> Datum:
>12.07.21? 16:25? (GMT+01:00) An:>Matthias Gondan
><matthias-gondan at gmx.de> Cc: r-help at r-project.org>Betreff: Re: [R]
>density with weights missing values The behavior is as>documented
>AFAICS.na.rmlogical; if TRUE, missing values are removed>from x. If
>FALSE anymissing values cause an error.The default
>is>FALSE.weightsnumeric vector of non-negative observation weights.NA
>is>not a non-negative numeric.Bert Gunter"The trouble with having an
>open>mind is that people keep coming alongand sticking things into
>it."-->Opus (aka Berkeley Breathed in his "Bloom County" comic strip
>)Bert>Gunter"The trouble with having an open mind is that people keep
>coming>alongand sticking things into it."-- Opus (aka Berkeley Breathed
>in his>"Bloom County" comic strip )On Mon, Jul 12, 2021 at 6:10 AM
>Matthias>Gondan <matthias-gondan at gmx.de> wrote:>> Weighted mean
>behaves>differently:> ? weight is excluded for missing x> ? no warning
>for>sum(weights) != 1>> > weighted.mean(c(1, 2, 3, 4), weights=c(1, 1,
>1,>1))> [1] 2.5> > weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1,
>1))>>[1] NA> > weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1,
>1),>na.rm=TRUE)> [1] 2>>>>> Von: Richard O'Keefe> Gesendet: Montag,
>12.>Juli 2021 13:18> An: Matthias Gondan> Betreff: Re: [R] density
>with>weights missing values>> Does your copy of R say that the weights
>must>add up to 1?> ?density doesn't say that in mine.?? But it does
>check.>>>On Mon, 12 Jul 2021 at 22:42, Matthias Gondan
><matthias-gondan at gmx.de>>wrote:> >> > Dear R users,> >> > This works as
>expected:> >> > ?>plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE))> >> >
>This raises an>error> >> > ? plot(density(c(1,2, 3, 4, 5, NA),
>na.rm=TRUE,>weights=c(1, 1, 1, 1, 1, 1)))> > ? plot(density(c(1,2, 3,
>4, 5, NA),>na.rm=TRUE, weights=c(1, 1, 1, 1, 1, NA)))> >> > This seems
>to work (it>triggers a warning that the weights don?t add up to 1,
>which makes>sense*):> >> > ? plot(density(c(1,2, 3, 4, 5, NA),
>na.rm=TRUE,>weights=c(1, 1, 1, 1, 1)))> >> > Questions> >> > ? But
>shouldn?t the>na.rm filter also filter the corresponding weights?> > ?
>Extra>question: In case the na.rm filter is changed to filter the
>weights,>the check for sum(weights) == 1 might trigger false positive
>warnings>since the weights might not add up to 1 anymore> >> > Best
>wishes,> >>>> Matthias> >> >> >???????? [[alternative HTML version
>deleted]]> >> >>______________________________________________> >
>R-help at r-project.org>mailing list -- To UNSUBSCRIBE and more, see>
>>>https://stat.ethz.ch/mailman/listinfo/r-help> > PLEASE do read
>the>posting guide http://www.R-project.org/posting-guide.html> >
>and>provide commented, minimal, self-contained,
>reproducible>code.>>>???????? [[alternative HTML version
>deleted]]>>>______________________________________________>
>R-help at r-project.org>mailing list -- To UNSUBSCRIBE and more,
>see>>https://stat.ethz.ch/mailman/listinfo/r-help> PLEASE do read
>the>posting guide http://www.R-project.org/posting-guide.html> and
>provide>commented, minimal, self-contained, reproducible
>code.>	[[alternative HTML version
>deleted]]>>______________________________________________>R-help at r-project.org
>mailing list -- To UNSUBSCRIBE and more,
>see>https://stat.ethz.ch/mailman/listinfo/r-help>PLEASE do read the
>posting guide>http://www.R-project.org/posting-guide.html>and provide
>commented, minimal, self-contained, reproducible code.-- Sent from my
>phone. Please excuse my brevity.

-- 
Sent from my phone. Please excuse my brevity.


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Jul 12 23:03:08 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 12 Jul 2021 17:03:08 -0400
Subject: [R] density with weights missing values
In-Reply-To: <1MVvL5-1lbfit2sVR-00RqWE@mail.gmx.net>
References: <1MVvL5-1lbfit2sVR-00RqWE@mail.gmx.net>
Message-ID: <7b39dee5-c245-e2cb-5df3-ecf9f3de2ec6@gmail.com>

On 12/07/2021 1:22 p.m., matthias-gondan wrote:
> You're right, of course. Extrapolating your argument a bit, the whole practice of na.rm is questionable, since there's always a reason for missingness (that is not in x and rarely elsewhere in the data)Best wishes?Matthias

For what it's worth, I partly agree with you:  if you specify na.rm = 
TRUE, it shouldn't make your x and weights vectors incompatible.

Regarding the warning about the sum of weights:  perhaps there's some 
reason that someone would want to create an unnormalized density, and 
that lets you do it.  An unnormalized mean doesn't make any sense, so I 
wouldn't call it a design flaw that the weighted density behaves 
differently than the weighted mean.  On the other hand, it would likely 
make more sense to normalize the density, and that's how I hope I would 
have designed it.

Thinking about this, I guessed density() was a really old function, so 
this was a case of trying to be S-compatible, but it turns out the 
weights argument was added in 2005 in r34130, so perhaps someone still 
remembers what the thinking was.

Duncan Murdoch

P.S.  I think you're posting in HTML, which makes your messages look 
really messy.  If you can turn that off, they'd be clearer.


From therne@u @end|ng |rom m@yo@edu  Tue Jul 13 00:13:53 2021
From: therne@u @end|ng |rom m@yo@edu (Therneau, Terry M., Ph.D.)
Date: Mon, 12 Jul 2021 17:13:53 -0500
Subject: [R] syvcoxph and cox.zph for testing the PH assumption
In-Reply-To: <mailman.363590.1.1625997625.38277.r-help@r-project.org>
References: <mailman.363590.1.1625997625.38277.r-help@r-project.org>
Message-ID: <9b53cf$ga2o4j@ironport10.mayo.edu>



On 7/11/21 5:00 AM, r-help-request at r-project.org wrote:
> Hello, is it kosher to call cox.zph on a syvcoxph model fit? I see that
> someone proposed a modified version of cox.zph that uses resid(fit,
> 'schoenfeld', **weighted=TRUE**).
> 
> https://stats.stackexchange.com/questions/265307/assessing-proportional-hazards-assumption-of-a-cox-model-with-caseweights
> Is that all it takes?
> Thanks,
> Youyi

The cox.zph function does a formal score test.  No, it does not account for robust 
variance.  I hadn't considered that case, but will now think about it.  It is quite easy 
to show that there is a problem: just give everyone a weight of 100.

The stackexchange conversation was new to me.  The solution there won't work with the 
current code, which does not make use of resid().  It has been updated to do the proper 
score test, the older version of cox.zph, which they modified, used an approximation.

Terry T.


From youy||ong @end|ng |rom gm@||@com  Tue Jul 13 00:58:23 2021
From: youy||ong @end|ng |rom gm@||@com (Youyi Fong)
Date: Mon, 12 Jul 2021 15:58:23 -0700
Subject: [R] syvcoxph and cox.zph for testing the PH assumption
In-Reply-To: <9b53cf$ga2o4i@ironport10.mayo.edu>
References: <mailman.363590.1.1625997625.38277.r-help@r-project.org>
 <9b53cf$ga2o4i@ironport10.mayo.edu>
Message-ID: <CAA4m0GZGJFgs+3UhrwgLUKbWiBJCNj_MVF+B-6PXKOcPTwSJ+Q@mail.gmail.com>

Thank you, Terry. We look forward to hearing from you again.
Youyi

On Mon, Jul 12, 2021 at 3:13 PM Therneau, Terry M., Ph.D. <therneau at mayo.edu>
wrote:

>
>
> On 7/11/21 5:00 AM, r-help-request at r-project.org wrote:
> > Hello, is it kosher to call cox.zph on a syvcoxph model fit? I see that
> > someone proposed a modified version of cox.zph that uses resid(fit,
> > 'schoenfeld', **weighted=TRUE**).
> >
> >
> https://stats.stackexchange.com/questions/265307/assessing-proportional-hazards-assumption-of-a-cox-model-with-caseweights
> > Is that all it takes?
> > Thanks,
> > Youyi
>
> The cox.zph function does a formal score test.  No, it does not account
> for robust
> variance.  I hadn't considered that case, but will now think about it.  It
> is quite easy
> to show that there is a problem: just give everyone a weight of 100.
>
> The stackexchange conversation was new to me.  The solution there won't
> work with the
> current code, which does not make use of resid().  It has been updated to
> do the proper
> score test, the older version of cox.zph, which they modified, used an
> approximation.
>
> Terry T.
>

	[[alternative HTML version deleted]]


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Tue Jul 13 09:09:56 2021
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Tue, 13 Jul 2021 09:09:56 +0200
Subject: [R] density with weights missing values
In-Reply-To: <1MkYXs-1lIGse0UgA-00m75k@mail.gmx.net>
References: <1Mv2xO-1lCIn818i0-00qxLT@mail.gmx.net>
 <CABcYAd+YgDtUq4EKUzTXJ9VXSxsfnXqEqRUGOJTbyRqGA5YuxA@mail.gmail.com>
 <1MkYXs-1lIGse0UgA-00m75k@mail.gmx.net>
Message-ID: <24813.15428.41311.41567@stat.math.ethz.ch>

>>>>> Matthias Gondan 
>>>>>     on Mon, 12 Jul 2021 15:09:38 +0200 writes:

    > Weighted mean behaves differently:
    > ? weight is excluded for missing x
    > ? no warning for sum(weights) != 1

    >> weighted.mean(c(1, 2, 3, 4), weights=c(1, 1, 1, 1))
    > [1] 2.5
    >> weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1))
    > [1] NA
    >> weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1), na.rm=TRUE)
    > [1] 2


I'm sure the 'weights' argument in weighted.mean() has been used
much more often than the one in density().
Hence, it's quite "probable statistically" :-)  that the
weighted.mean() behavior in the NA case has been more rational
and thought through 

So I agree with you, Matthias, that ideally density() should
behave differently here,  probably entirely analogously to weighted.mean().

Still, Bert and others are right that there is no bug formally,
but something that possibly should be changed; even though it
breaks back compatibility for those cases,  such case may be
very rare (I'm not sure I've ever used weights in density() but
I know I've used it very much all those 25 years ..).

https://www.r-project.org/bugs.html

contains good information about determining if something may be
a bug in R *and* tell you how to apply for an account on R's
bugzilla for reporting it formally.
I'm hereby encouraging you, Matthias, to do that and then in
your report mention both density() and weighted.mean(), i.e., a
cleaned up version of the union of your first 2 e-mails..

Thank you for thinking about this and concisely reporting it.
Martin


    > Von: Richard O'Keefe
    > Gesendet: Montag, 12. Juli 2021 13:18
    > An: Matthias Gondan
    > Betreff: Re: [R] density with weights missing values

    > Does your copy of R say that the weights must add up to 1?
    > ?density doesn't say that in mine.   But it does check.

another small part to could be improved, indeed,
thank you, Richard.

--
Martin Maechler
ETH Zurich  and  R Core team
 
    > On Mon, 12 Jul 2021 at 22:42, Matthias Gondan <matthias-gondan at gmx.de> wrote:
    >> 
    >> Dear R users,
    >> 
    >> This works as expected:
    >> 
    >> ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE))
    >> 
    >> This raises an error
    >> 
    >> ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, 1)))
    >> ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, NA)))
[..............]


From m@tth|@@-gond@n @end|ng |rom gmx@de  Tue Jul 13 09:36:53 2021
From: m@tth|@@-gond@n @end|ng |rom gmx@de (Matthias Gondan)
Date: Tue, 13 Jul 2021 09:36:53 +0200
Subject: [R] density with weights missing values
In-Reply-To: <24813.15428.41311.41567@stat.math.ethz.ch>
References: <1Mv2xO-1lCIn818i0-00qxLT@mail.gmx.net>
 <CABcYAd+YgDtUq4EKUzTXJ9VXSxsfnXqEqRUGOJTbyRqGA5YuxA@mail.gmail.com>
 <1MkYXs-1lIGse0UgA-00m75k@mail.gmx.net>
 <24813.15428.41311.41567@stat.math.ethz.ch>
Message-ID: <1MfpOT-1lW6Cy1TD7-00gDpd@mail.gmx.net>

Thanks Martin and the others. I will do so accordingly. 

I guess the 0.1% of the population who uses density with weights will write code like this

x = c(1, 2, 3, NA)
weights = c(1, 1, 1, 1)
density(x[!is.na(x)], weights=weights[!is.na(x)])

These people won?t be affected. For the 0.01% of people with code like this,

density(x, weights=weights[!is.na(x)], na.rm=TRUE)

the corrected version would almost surely raise an error. Note that the error message can, in principle, check if length(x[!is.na(x)]) == length(the provided weights) and tell the programmer that this was the old behavior.

Best wishes,

Matthias

PS. Sorry for the HTML email. I?ve given up trying to fix such behavior.


Von: Martin Maechler
Gesendet: Dienstag, 13. Juli 2021 09:09
An: Matthias Gondan
Cc: r-help at r-project.org
Betreff: Re: [R] density with weights missing values

>>>>> Matthias Gondan 
>>>>>     on Mon, 12 Jul 2021 15:09:38 +0200 writes:

    > Weighted mean behaves differently:
    > ? weight is excluded for missing x
    > ? no warning for sum(weights) != 1

    >> weighted.mean(c(1, 2, 3, 4), weights=c(1, 1, 1, 1))
    > [1] 2.5
    >> weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1))
    > [1] NA
    >> weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1), na.rm=TRUE)
    > [1] 2


I'm sure the 'weights' argument in weighted.mean() has been used
much more often than the one in density().
Hence, it's quite "probable statistically" :-)  that the
weighted.mean() behavior in the NA case has been more rational
and thought through 

So I agree with you, Matthias, that ideally density() should
behave differently here,  probably entirely analogously to weighted.mean().

Still, Bert and others are right that there is no bug formally,
but something that possibly should be changed; even though it
breaks back compatibility for those cases,  such case may be
very rare (I'm not sure I've ever used weights in density() but
I know I've used it very much all those 25 years ..).

https://www.r-project.org/bugs.html

contains good information about determining if something may be
a bug in R *and* tell you how to apply for an account on R's
bugzilla for reporting it formally.
I'm hereby encouraging you, Matthias, to do that and then in
your report mention both density() and weighted.mean(), i.e., a
cleaned up version of the union of your first 2 e-mails..

Thank you for thinking about this and concisely reporting it.
Martin


    > Von: Richard O'Keefe
    > Gesendet: Montag, 12. Juli 2021 13:18
    > An: Matthias Gondan
    > Betreff: Re: [R] density with weights missing values

    > Does your copy of R say that the weights must add up to 1?
    > ?density doesn't say that in mine.   But it does check.

another small part to could be improved, indeed,
thank you, Richard.

--
Martin Maechler
ETH Zurich  and  R Core team
 
    > On Mon, 12 Jul 2021 at 22:42, Matthias Gondan <matthias-gondan at gmx.de> wrote:
    >> 
    >> Dear R users,
    >> 
    >> This works as expected:
    >> 
    >> ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE))
    >> 
    >> This raises an error
    >> 
    >> ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, 1)))
    >> ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, NA)))
[..............]


	[[alternative HTML version deleted]]


From gor@n@bro@trom @end|ng |rom umu@@e  Tue Jul 13 13:34:55 2021
From: gor@n@bro@trom @end|ng |rom umu@@e (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Tue, 13 Jul 2021 13:34:55 +0200
Subject: [R] density with weights missing values
In-Reply-To: <1MkYXs-1lIGse0UgA-00m75k@mail.gmx.net>
References: <1Mv2xO-1lCIn818i0-00qxLT@mail.gmx.net>
 <CABcYAd+YgDtUq4EKUzTXJ9VXSxsfnXqEqRUGOJTbyRqGA5YuxA@mail.gmail.com>
 <1MkYXs-1lIGse0UgA-00m75k@mail.gmx.net>
Message-ID: <b05942c9-2949-8fac-d3b5-c6b661f27c9c@umu.se>



Den 2021-07-12 kl. 15:09, skrev Matthias Gondan:
> Weighted mean behaves differently:

One difference is that density has a named argument 'weights' not 
present in weighted.mean, which instead has 'w' for weights.
Annoying.

So, in your examples, the argument 'weights = ' is always ignored, at 
least for weighted.mean.default:

 > stats:::weighted.mean.default
function (x, w, ..., na.rm = FALSE)
{
     if (missing(w)) {
         if (na.rm)
             x <- x[!is.na(x)]
         return(sum(x)/length(x))
     }
     if (length(w) != length(x))
         stop("'x' and 'w' must have the same length")
     if (na.rm) {
         i <- !is.na(x)
         w <- w[i]
         x <- x[i]
     }
     sum((x * w)[w != 0])/sum(w)
}

But, using 'w' for weights, missing values in weights will work only if 
na.rm = TRUE and they match missing values in x. As documented.

[...]
> ? no warning for sum(weights) != 1

and no warning for sum(w) != 1

That's because the weights w are normalized (after removing weights 
corresponding to missing values in x).

G,
> 
>> weighted.mean(c(1, 2, 3, 4), weights=c(1, 1, 1, 1))
> [1] 2.5
>> weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1))
> [1] NA
>> weighted.mean(c(1, 2, 3, NA), weights=c(1, 1, 1, 1), na.rm=TRUE)
> [1] 2
> 
> 
> 
> 
> Von: Richard O'Keefe
> Gesendet: Montag, 12. Juli 2021 13:18
> An: Matthias Gondan
> Betreff: Re: [R] density with weights missing values
> 
> Does your copy of R say that the weights must add up to 1?
> ?density doesn't say that in mine.   But it does check.
> 
> On Mon, 12 Jul 2021 at 22:42, Matthias Gondan <matthias-gondan at gmx.de> wrote:
>>
>> Dear R users,
>>
>> This works as expected:
>>
>> ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE))
>>
>> This raises an error
>>
>> ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, 1)))
>> ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1, NA)))
>>
>> This seems to work (it triggers a warning that the weights don?t add up to 1, which makes sense*):
>>
>> ? plot(density(c(1,2, 3, 4, 5, NA), na.rm=TRUE, weights=c(1, 1, 1, 1, 1)))
>>
>> Questions
>>
>> ? But shouldn?t the na.rm filter also filter the corresponding weights?
>> ? Extra question: In case the na.rm filter is changed to filter the weights, the check for sum(weights) == 1 might trigger false positive warnings since the weights might not add up to 1 anymore
>>
>> Best wishes,
>>
>> Matthias
>>
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From gor@n@bro@trom @end|ng |rom umu@@e  Wed Jul 14 12:00:36 2021
From: gor@n@bro@trom @end|ng |rom umu@@e (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Wed, 14 Jul 2021 12:00:36 +0200
Subject: [R] zero weights in weighted.mean
Message-ID: <9943780a-727e-7947-4e87-67599f46303d@umu.se>

I wonder about the last sentence in the Details section of the 
documentation of 'weighted.mean':

"However, zero weights _are_ handled specially and the corresponding ?x? 
values are omitted from the sum."

The return value of weighted.mean.default is

sum((x * w)[w != 0])/sum(w)

and indeed, it looks as if zero weights are getting special treatment, 
but what is wrong with the alternative (equivalent?) expression

sum(x * w) / sum(w)?

Is it a good idea to remove zeros from a vector before applying 'sum' to 
it? I don't think so. Anyway, the sentence in the documentation seems to 
be uncalled for.

G,


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Jul 14 13:16:16 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 14 Jul 2021 07:16:16 -0400
Subject: [R] zero weights in weighted.mean
In-Reply-To: <9943780a-727e-7947-4e87-67599f46303d@umu.se>
References: <9943780a-727e-7947-4e87-67599f46303d@umu.se>
Message-ID: <2512e737-a04f-ec3e-ad63-b3a86553e116@gmail.com>

On 14/07/2021 6:00 a.m., G?ran Brostr?m wrote:
> I wonder about the last sentence in the Details section of the
> documentation of 'weighted.mean':
> 
> "However, zero weights _are_ handled specially and the corresponding ?x?
> values are omitted from the sum."
> 
> The return value of weighted.mean.default is
> 
> sum((x * w)[w != 0])/sum(w)
> 
> and indeed, it looks as if zero weights are getting special treatment,
> but what is wrong with the alternative (equivalent?) expression
> 
> sum(x * w) / sum(w)?
> 
> Is it a good idea to remove zeros from a vector before applying 'sum' to
> it? I don't think so. Anyway, the sentence in the documentation seems to
> be uncalled for.

Inf*0 is not zero.  Setting weights to zero on infinite observations (or 
NA, or NaN) will give different results in your two expressions.

Duncan Murdoch


From gor@n@bro@trom @end|ng |rom umu@@e  Wed Jul 14 16:46:53 2021
From: gor@n@bro@trom @end|ng |rom umu@@e (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Wed, 14 Jul 2021 16:46:53 +0200
Subject: [R] zero weights in weighted.mean
In-Reply-To: <2512e737-a04f-ec3e-ad63-b3a86553e116@gmail.com>
References: <9943780a-727e-7947-4e87-67599f46303d@umu.se>
 <2512e737-a04f-ec3e-ad63-b3a86553e116@gmail.com>
Message-ID: <7f931c9e-8cd9-076a-1a92-29d95c216cf9@umu.se>



Den 2021-07-14 kl. 13:16, skrev Duncan Murdoch:
> On 14/07/2021 6:00 a.m., G?ran Brostr?m wrote:
>> I wonder about the last sentence in the Details section of the
>> documentation of 'weighted.mean':
>>
>> "However, zero weights _are_ handled specially and the corresponding ?x?
>> values are omitted from the sum."
>>
>> The return value of weighted.mean.default is
>>
>> sum((x * w)[w != 0])/sum(w)
>>
>> and indeed, it looks as if zero weights are getting special treatment,
>> but what is wrong with the alternative (equivalent?) expression
>>
>> sum(x * w) / sum(w)?
>>
>> Is it a good idea to remove zeros from a vector before applying 'sum' to
>> it? I don't think so. Anyway, the sentence in the documentation seems to
>> be uncalled for.
> 
> Inf*0 is not zero.? Setting weights to zero on infinite observations (or 
> NA, or NaN) will give different results in your two expressions.

Thanks, agreed.

G,


From y@ngk@|9999 @end|ng |rom y@hoo@com  Wed Jul 14 17:55:39 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Wed, 14 Jul 2021 15:55:39 +0000 (UTC)
Subject: [R] assign a data frame name from a list in do loop
References: <917452799.2541098.1626278139658.ref@mail.yahoo.com>
Message-ID: <917452799.2541098.1626278139658@mail.yahoo.com>

Hello List,
I wrote a script below to compare the difference of data frames structure (and will do something else). First of all I save the file list in a data frame ora, then I use for loop to 1. load the data from two resource, 2. generate data structure into two data frames, 3.do the comparesion of the two data frames of data structure and put it into a data frame, 4. remove the useless data frames for next loop
for (j in 1:nrow(ora))
{
? mycol? <- ora[j,"fname"]
#--------------------work on csv------------??
? mycsv? <- paste0(mycol,".csv")
? rdcsv? <- noquote(paste0("w:/project/_Joe.B/Oracle/data/", mycsv))
? rr? ? ?<- read.csv(rdcsv)

#--------------------work on SS ------------??
? myss? ?<- paste0("gemd.", mycol)
? rdss? ?<- paste0('select * from ',myss)
? ss? ? ?<- dbGetQuery(con, rdss)
??
#--------------------compare DF structure? ?------------??
str_rr <- as.data.frame(summary.default(rr))
str_ss <- as.data.frame(summary.default(ss))


sdif_[j] <- sqldf('select * from str_rr except select * from str_ss')

#---------remove data frame from memory--------------

? rm(rr)
? rm(ss)
? rm(str_rr)
? rm(str_ss)
}
In the step 3, I want to use ora$fname in the loop to?assign a data frame name. So, I will look the output later. But?sdif_[j] doesn't work for this. Can someone help me to fix this part?
Thanks,
Kai
	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Jul 14 19:07:45 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 14 Jul 2021 18:07:45 +0100
Subject: [R] assign a data frame name from a list in do loop
In-Reply-To: <917452799.2541098.1626278139658@mail.yahoo.com>
References: <917452799.2541098.1626278139658.ref@mail.yahoo.com>
 <917452799.2541098.1626278139658@mail.yahoo.com>
Message-ID: <2fa0edf4-a6d0-10e5-47ce-f5da7ef25a06@sapo.pt>

Hello,

Just before for(j in 1:nrow(ora)) include the following code line (I 
have removed the underscore):

sdif <- vector("list", length = nrow(ora))


In the loop:

sdif[[j]] <- sqldf(etc)



Also, once again, why noquote? It's better to form file names with 
file.path:


rdcsv? <- file.path("w:/project/_Joe.B/Oracle/data", mycsv)


Hope this helps,

Rui Barradas


?s 16:55 de 14/07/2021, Kai Yang via R-help escreveu:
> Hello List,
> I wrote a script below to compare the difference of data frames structure (and will do something else). First of all I save the file list in a data frame ora, then I use for loop to 1. load the data from two resource, 2. generate data structure into two data frames, 3.do the comparesion of the two data frames of data structure and put it into a data frame, 4. remove the useless data frames for next loop
> for (j in 1:nrow(ora))
> {
>  ? mycol? <- ora[j,"fname"]
> #--------------------work on csv------------
>  ? mycsv? <- paste0(mycol,".csv")
>  ? rdcsv? <- noquote(paste0("w:/project/_Joe.B/Oracle/data/", mycsv))
>  ? rr? ? ?<- read.csv(rdcsv)
>
> #--------------------work on SS ------------
>  ? myss? ?<- paste0("gemd.", mycol)
>  ? rdss? ?<- paste0('select * from ',myss)
>  ? ss? ? ?<- dbGetQuery(con, rdss)
>    
> #--------------------compare DF structure? ?------------
> str_rr <- as.data.frame(summary.default(rr))
> str_ss <- as.data.frame(summary.default(ss))
>
>
> sdif_[j] <- sqldf('select * from str_rr except select * from str_ss')
>
> #---------remove data frame from memory--------------
>
>  ? rm(rr)
>  ? rm(ss)
>  ? rm(str_rr)
>  ? rm(str_ss)
> }
> In the step 3, I want to use ora$fname in the loop to?assign a data frame name. So, I will look the output later. But?sdif_[j] doesn't work for this. Can someone help me to fix this part?
> Thanks,
> Kai
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


-- 
Este e-mail foi verificado em termos de v?rus pelo software antiv?rus Avast.
https://www.avast.com/antivirus


From y@ngk@|9999 @end|ng |rom y@hoo@com  Wed Jul 14 19:30:02 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Wed, 14 Jul 2021 17:30:02 +0000 (UTC)
Subject: [R] assign a data frame name from a list in do loop
In-Reply-To: <2fa0edf4-a6d0-10e5-47ce-f5da7ef25a06@sapo.pt>
References: <917452799.2541098.1626278139658.ref@mail.yahoo.com>
 <917452799.2541098.1626278139658@mail.yahoo.com>
 <2fa0edf4-a6d0-10e5-47ce-f5da7ef25a06@sapo.pt>
Message-ID: <1445677747.3397231.1626283802155@mail.yahoo.com>

 Hello Rui,
it's very helpful.?
Thank you,
Kai
    On Wednesday, July 14, 2021, 10:07:57 AM PDT, Rui Barradas <ruipbarradas at sapo.pt> wrote:  
 
 Hello,

Just before for(j in 1:nrow(ora)) include the following code line (I 
have removed the underscore):

sdif <- vector("list", length = nrow(ora))


In the loop:

sdif[[j]] <- sqldf(etc)



Also, once again, why noquote? It's better to form file names with 
file.path:


rdcsv? <- file.path("w:/project/_Joe.B/Oracle/data", mycsv)


Hope this helps,

Rui Barradas


?s 16:55 de 14/07/2021, Kai Yang via R-help escreveu:
> Hello List,
> I wrote a script below to compare the difference of data frames structure (and will do something else). First of all I save the file list in a data frame ora, then I use for loop to 1. load the data from two resource, 2. generate data structure into two data frames, 3.do the comparesion of the two data frames of data structure and put it into a data frame, 4. remove the useless data frames for next loop
> for (j in 1:nrow(ora))
> {
>? ? mycol? <- ora[j,"fname"]
> #--------------------work on csv------------
>? ? mycsv? <- paste0(mycol,".csv")
>? ? rdcsv? <- noquote(paste0("w:/project/_Joe.B/Oracle/data/", mycsv))
>? ? rr? ? ?<- read.csv(rdcsv)
>
> #--------------------work on SS ------------
>? ? myss? ?<- paste0("gemd.", mycol)
>? ? rdss? ?<- paste0('select * from ',myss)
>? ? ss? ? ?<- dbGetQuery(con, rdss)
>? ? 
> #--------------------compare DF structure? ?------------
> str_rr <- as.data.frame(summary.default(rr))
> str_ss <- as.data.frame(summary.default(ss))
>
>
> sdif_[j] <- sqldf('select * from str_rr except select * from str_ss')
>
> #---------remove data frame from memory--------------
>
>? ? rm(rr)
>? ? rm(ss)
>? ? rm(str_rr)
>? ? rm(str_ss)
> }
> In the step 3, I want to use ora$fname in the loop to?assign a data frame name. So, I will look the output later. But?sdif_[j] doesn't work for this. Can someone help me to fix this part?
> Thanks,
> Kai
> ??? [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


-- 
Este e-mail foi verificado em termos de v?rus pelo software antiv?rus Avast.
https://www.avast.com/antivirus

  
	[[alternative HTML version deleted]]


From j@ork|n @end|ng |rom @om@um@ry|@nd@edu  Wed Jul 14 19:43:11 2021
From: j@ork|n @end|ng |rom @om@um@ry|@nd@edu (Sorkin, John)
Date: Wed, 14 Jul 2021 17:43:11 +0000
Subject: [R] zero weights in weighted.mean
In-Reply-To: <7f931c9e-8cd9-076a-1a92-29d95c216cf9@umu.se>
References: <9943780a-727e-7947-4e87-67599f46303d@umu.se>
 <2512e737-a04f-ec3e-ad63-b3a86553e116@gmail.com>,
 <7f931c9e-8cd9-076a-1a92-29d95c216cf9@umu.se>
Message-ID: <MN2PR03MB5167EF7AE66714067D546C95E2139@MN2PR03MB5167.namprd03.prod.outlook.com>

Gentlemen,

At the risk of beating a dead horse, but in he spirit of learning more about R, aren't the two expressions functionally the same? One drops values where weight is zero. The other (in the case where we and infinity * 0, something one would not expect to see in data) also drops data as in R infinity * 0 = Nan. In either case the observation would be dropped. I am certain I am missing something, but I don't know what I am missing.

John

John David Sorkin M.D., Ph.D.
Professor of Medicine
University of Maryland School of Medicine
Associate Director for Biostatistics and Informatics Baltimore VA Medical Center
Geriatrics, Research, Education, and Clinical Center
Chief, Biostatistics and Informatics
University of Maryland School of Medicine Division of Gerontology, Geriatrics and Palliative Care
Senior Statistician
University of Maryland Center for Vascular Research
10 North Greene Street
GRECC (BT/18/GR)
Baltimore, MD 21201-1524
(Phone) 410-605-7119
(Fax) 410-605-7913 (Please call phone number above prior to faxing)



________________________________________
From: R-help <r-help-bounces at r-project.org> on behalf of G?ran Brostr?m <goran.brostrom at umu.se>
Sent: Wednesday, July 14, 2021 10:46 AM
To: Duncan Murdoch; r-help at r-project.org
Subject: Re: [R] zero weights in weighted.mean



Den 2021-07-14 kl. 13:16, skrev Duncan Murdoch:
> On 14/07/2021 6:00 a.m., G?ran Brostr?m wrote:
>> I wonder about the last sentence in the Details section of the
>> documentation of 'weighted.mean':
>>
>> "However, zero weights _are_ handled specially and the corresponding ?x?
>> values are omitted from the sum."
>>
>> The return value of weighted.mean.default is
>>
>> sum((x * w)[w != 0])/sum(w)
>>
>> and indeed, it looks as if zero weights are getting special treatment,
>> but what is wrong with the alternative (equivalent?) expression
>>
>> sum(x * w) / sum(w)?
>>
>> Is it a good idea to remove zeros from a vector before applying 'sum' to
>> it? I don't think so. Anyway, the sentence in the documentation seems to
>> be uncalled for.
>
> Inf*0 is not zero.  Setting weights to zero on infinite observations (or
> NA, or NaN) will give different results in your two expressions.

Thanks, agreed.

G,

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C3a3546f3bb4541fdc30808d946d6482b%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637618709012695753%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=OE%2B97ntdhOx2x19hUx0wUFg9d%2BhMrsN8v5G%2BFHv69tA%3D&amp;reserved=0
PLEASE do read the posting guide https://nam11.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C3a3546f3bb4541fdc30808d946d6482b%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637618709012695753%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=A0GsBl75Pq3MpWmncmtBz31z%2FJybPNWKWx8sgCbhKJ4%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.


From gor@n@bro@trom @end|ng |rom umu@@e  Wed Jul 14 20:26:08 2021
From: gor@n@bro@trom @end|ng |rom umu@@e (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Wed, 14 Jul 2021 20:26:08 +0200
Subject: [R] zero weights in weighted.mean
In-Reply-To: <MN2PR03MB5167EF7AE66714067D546C95E2139@MN2PR03MB5167.namprd03.prod.outlook.com>
References: <9943780a-727e-7947-4e87-67599f46303d@umu.se>
 <2512e737-a04f-ec3e-ad63-b3a86553e116@gmail.com>
 <7f931c9e-8cd9-076a-1a92-29d95c216cf9@umu.se>
 <MN2PR03MB5167EF7AE66714067D546C95E2139@MN2PR03MB5167.namprd03.prod.outlook.com>
Message-ID: <4798ea50-b46d-88a1-c959-47ec97c2a437@umu.se>



On 2021-07-14 19:43, Sorkin, John wrote:
> Gentlemen,
> 
> At the risk of beating a dead horse, but in he spirit of learning
> more about R, aren't the two expressions functionally the same? One
> drops values where weight is zero. The other (in the case where we
> and infinity * 0, something one would not expect to see in data) also
> drops data as in R infinity * 0 = Nan. In either case the observation
> would be dropped. I am certain I am missing something, but I don't
> know what I am missing.

Try this:

 > my <- function(x, w) sum(x * w) / sum(w)

 > x <- c(1, 1 / 0)

 > w <- 1:0
 > my(x, w)

[1] NaN

 > weighted.mean(x, w)

[1] 1


See?

Best, G?ran

> 
> John
> 
> John David Sorkin M.D., Ph.D. Professor of Medicine University of
> Maryland School of Medicine Associate Director for Biostatistics and
> Informatics Baltimore VA Medical Center Geriatrics, Research,
> Education, and Clinical Center Chief, Biostatistics and Informatics 
> University of Maryland School of Medicine Division of Gerontology,
> Geriatrics and Palliative Care Senior Statistician University of
> Maryland Center for Vascular Research 10 North Greene Street GRECC
> (BT/18/GR) Baltimore, MD 21201-1524 (Phone) 410-605-7119 (Fax)
> 410-605-7913 (Please call phone number above prior to faxing)
> 
> 
> 
> ________________________________________ From: R-help
> <r-help-bounces at r-project.org> on behalf of G?ran Brostr?m
> <goran.brostrom at umu.se> Sent: Wednesday, July 14, 2021 10:46 AM To:
> Duncan Murdoch; r-help at r-project.org Subject: Re: [R] zero weights in
> weighted.mean
> 
> 
> 
> Den 2021-07-14 kl. 13:16, skrev Duncan Murdoch:
>> On 14/07/2021 6:00 a.m., G?ran Brostr?m wrote:
>>> I wonder about the last sentence in the Details section of the 
>>> documentation of 'weighted.mean':
>>> 
>>> "However, zero weights _are_ handled specially and the
>>> corresponding ?x? values are omitted from the sum."
>>> 
>>> The return value of weighted.mean.default is
>>> 
>>> sum((x * w)[w != 0])/sum(w)
>>> 
>>> and indeed, it looks as if zero weights are getting special
>>> treatment, but what is wrong with the alternative (equivalent?)
>>> expression
>>> 
>>> sum(x * w) / sum(w)?
>>> 
>>> Is it a good idea to remove zeros from a vector before applying
>>> 'sum' to it? I don't think so. Anyway, the sentence in the
>>> documentation seems to be uncalled for.
>> 
>> Inf*0 is not zero.  Setting weights to zero on infinite
>> observations (or NA, or NaN) will give different results in your
>> two expressions.
> 
> Thanks, agreed.
> 
> G,
> 
> ______________________________________________ R-help at r-project.org
> mailing list -- To UNSUBSCRIBE and more, see 
> https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C3a3546f3bb4541fdc30808d946d6482b%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637618709012695753%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=OE%2B97ntdhOx2x19hUx0wUFg9d%2BhMrsN8v5G%2BFHv69tA%3D&amp;reserved=0
>
> 
PLEASE do read the posting guide 
https://nam11.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C3a3546f3bb4541fdc30808d946d6482b%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637618709012695753%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=A0GsBl75Pq3MpWmncmtBz31z%2FJybPNWKWx8sgCbhKJ4%3D&amp;reserved=0
> and provide commented, minimal, self-contained, reproducible code.
>


From y@ngk@|9999 @end|ng |rom y@hoo@com  Thu Jul 15 01:40:57 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Wed, 14 Jul 2021 23:40:57 +0000 (UTC)
Subject: [R] ls() pattern question
References: <1687407730.1243315.1626306057329.ref@mail.yahoo.com>
Message-ID: <1687407730.1243315.1626306057329@mail.yahoo.com>

Hello List,
I have many data frames in environment.? I need to keep 3 data frames only, con DB2 and ora.?
I write the script to do this.?
rm(ls(pattern != c("(con|DB2|ora)")))


but it give me an error message:


Error in rm(ls(pattern != c("(con|DB2|ora)"))) :?
? ... must contain names or character strings

I think the pattern option doesn't support != ? and is it possible to fix this?
Thank you,
Kai



	[[alternative HTML version deleted]]


From @kw@|mmo @end|ng |rom gm@||@com  Thu Jul 15 02:00:38 2021
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Wed, 14 Jul 2021 20:00:38 -0400
Subject: [R] ls() pattern question
In-Reply-To: <1687407730.1243315.1626306057329@mail.yahoo.com>
References: <1687407730.1243315.1626306057329.ref@mail.yahoo.com>
 <1687407730.1243315.1626306057329@mail.yahoo.com>
Message-ID: <CAPcHnpQ24kW9RAjTvRjKqr14GZnzXEaTgr-O+A5==W6y1T9CmA@mail.gmail.com>

Hello,


First, `ls` does not support `!=` for pattern, but it's actually throwing a
different error. For `rm`, the objects provided into `...` are substituted
(not evaluated), so you should really do something like

rm(list = ls(pattern = ...))

As for all except "con", "DB2", and "ora", I would try something like

setdiff(ls(), c("con", "DB2", "ora"))

and then add `rm` to that like

rm(list = setdiff(ls(), c("con", "DB2", "ora")))

On Wed, Jul 14, 2021 at 7:41 PM Kai Yang via R-help <r-help at r-project.org>
wrote:

> Hello List,
> I have many data frames in environment.  I need to keep 3 data frames
> only, con DB2 and ora.
> I write the script to do this.
> rm(ls(pattern != c("(con|DB2|ora)")))
>
>
> but it give me an error message:
>
>
> Error in rm(ls(pattern != c("(con|DB2|ora)"))) :
>   ... must contain names or character strings
>
> I think the pattern option doesn't support != ? and is it possible to fix
> this?
> Thank you,
> Kai
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Thu Jul 15 02:21:49 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 14 Jul 2021 17:21:49 -0700
Subject: [R] ls() pattern question
In-Reply-To: <CAPcHnpQ24kW9RAjTvRjKqr14GZnzXEaTgr-O+A5==W6y1T9CmA@mail.gmail.com>
References: <1687407730.1243315.1626306057329.ref@mail.yahoo.com>
 <1687407730.1243315.1626306057329@mail.yahoo.com>
 <CAPcHnpQ24kW9RAjTvRjKqr14GZnzXEaTgr-O+A5==W6y1T9CmA@mail.gmail.com>
Message-ID: <CAGxFJbSAKuWD1m6P=NUAEwxYoAortb6kUNzbVtEmR3NCh6HMdg@mail.gmail.com>

Actually fun( param != something..) is syntactically incorrect in the first
place for any function!

ls sees "pat != whatever"  as the "name" argument of ls() and can't make
any sense of it, of course.

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Wed, Jul 14, 2021 at 5:01 PM Andrew Simmons <akwsimmo at gmail.com> wrote:

> Hello,
>
>
> First, `ls` does not support `!=` for pattern, but it's actually throwing a
> different error. For `rm`, the objects provided into `...` are substituted
> (not evaluated), so you should really do something like
>
> rm(list = ls(pattern = ...))
>
> As for all except "con", "DB2", and "ora", I would try something like
>
> setdiff(ls(), c("con", "DB2", "ora"))
>
> and then add `rm` to that like
>
> rm(list = setdiff(ls(), c("con", "DB2", "ora")))
>
> On Wed, Jul 14, 2021 at 7:41 PM Kai Yang via R-help <r-help at r-project.org>
> wrote:
>
> > Hello List,
> > I have many data frames in environment.  I need to keep 3 data frames
> > only, con DB2 and ora.
> > I write the script to do this.
> > rm(ls(pattern != c("(con|DB2|ora)")))
> >
> >
> > but it give me an error message:
> >
> >
> > Error in rm(ls(pattern != c("(con|DB2|ora)"))) :
> >   ... must contain names or character strings
> >
> > I think the pattern option doesn't support != ? and is it possible to fix
> > this?
> > Thank you,
> > Kai
> >
> >
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From y@ngk@|9999 @end|ng |rom y@hoo@com  Thu Jul 15 02:32:40 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Thu, 15 Jul 2021 00:32:40 +0000 (UTC)
Subject: [R] ls() pattern question
In-Reply-To: <CAGxFJbSAKuWD1m6P=NUAEwxYoAortb6kUNzbVtEmR3NCh6HMdg@mail.gmail.com>
References: <1687407730.1243315.1626306057329.ref@mail.yahoo.com>
 <1687407730.1243315.1626306057329@mail.yahoo.com>
 <CAPcHnpQ24kW9RAjTvRjKqr14GZnzXEaTgr-O+A5==W6y1T9CmA@mail.gmail.com>
 <CAGxFJbSAKuWD1m6P=NUAEwxYoAortb6kUNzbVtEmR3NCh6HMdg@mail.gmail.com>
Message-ID: <727739839.1292115.1626309160307@mail.yahoo.com>

 Thanks Andrew. it works well. --- Kai
    On Wednesday, July 14, 2021, 05:22:01 PM PDT, Bert Gunter <bgunter.4567 at gmail.com> wrote:  
 
 Actually fun( param != something..) is syntactically incorrect in the first place for any function! 

ls sees "pat != whatever"? as the "name" argument of ls() and can't make any sense of it, of course. 
 
Bert Gunter

"The trouble with having an open mind is that people keep coming along and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Wed, Jul 14, 2021 at 5:01 PM Andrew Simmons <akwsimmo at gmail.com> wrote:

Hello,


First, `ls` does not support `!=` for pattern, but it's actually throwing a
different error. For `rm`, the objects provided into `...` are substituted
(not evaluated), so you should really do something like

rm(list = ls(pattern = ...))

As for all except "con", "DB2", and "ora", I would try something like

setdiff(ls(), c("con", "DB2", "ora"))

and then add `rm` to that like

rm(list = setdiff(ls(), c("con", "DB2", "ora")))

On Wed, Jul 14, 2021 at 7:41 PM Kai Yang via R-help <r-help at r-project.org>
wrote:

> Hello List,
> I have many data frames in environment.? I need to keep 3 data frames
> only, con DB2 and ora.
> I write the script to do this.
> rm(ls(pattern != c("(con|DB2|ora)")))
>
>
> but it give me an error message:
>
>
> Error in rm(ls(pattern != c("(con|DB2|ora)"))) :
>? ?... must contain names or character strings
>
> I think the pattern option doesn't support != ? and is it possible to fix
> this?
> Thank you,
> Kai
>
>
>
>? ? ? ? ?[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

? ? ? ? [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

  
	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Jul 15 11:09:01 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 15 Jul 2021 05:09:01 -0400
Subject: [R] ls() pattern question
In-Reply-To: <CAGxFJbSAKuWD1m6P=NUAEwxYoAortb6kUNzbVtEmR3NCh6HMdg@mail.gmail.com>
References: <1687407730.1243315.1626306057329.ref@mail.yahoo.com>
 <1687407730.1243315.1626306057329@mail.yahoo.com>
 <CAPcHnpQ24kW9RAjTvRjKqr14GZnzXEaTgr-O+A5==W6y1T9CmA@mail.gmail.com>
 <CAGxFJbSAKuWD1m6P=NUAEwxYoAortb6kUNzbVtEmR3NCh6HMdg@mail.gmail.com>
Message-ID: <84ceeb59-8aa5-6d4c-55d7-112e7720499e@gmail.com>

On 14/07/2021 8:21 p.m., Bert Gunter wrote:
> Actually fun( param != something..) is syntactically incorrect in the first
> place for any function!

You have to be careful with absolute statements:

   > f <- function(pattern) cat("It's legal!")
   > f(pattern != something..)
   It's legal!

"pattern != something.." is a legal expression, which would return a 
logical vector.  My function didn't ever evaluate it, so the fact that 
variables named "pattern" and "something.." didn't exist in the global 
env didn't make any difference.  It's legal syntax, just wrong.

Duncan Murdoch

> 
> ls sees "pat != whatever"  as the "name" argument of ls() and can't make
> any sense of it, of course.
> 
> Bert Gunter
> 
> "The trouble with having an open mind is that people keep coming along and
> sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> 
> 
> On Wed, Jul 14, 2021 at 5:01 PM Andrew Simmons <akwsimmo at gmail.com> wrote:
> 
>> Hello,
>>
>>
>> First, `ls` does not support `!=` for pattern, but it's actually throwing a
>> different error. For `rm`, the objects provided into `...` are substituted
>> (not evaluated), so you should really do something like
>>
>> rm(list = ls(pattern = ...))
>>
>> As for all except "con", "DB2", and "ora", I would try something like
>>
>> setdiff(ls(), c("con", "DB2", "ora"))
>>
>> and then add `rm` to that like
>>
>> rm(list = setdiff(ls(), c("con", "DB2", "ora")))
>>
>> On Wed, Jul 14, 2021 at 7:41 PM Kai Yang via R-help <r-help at r-project.org>
>> wrote:
>>
>>> Hello List,
>>> I have many data frames in environment.  I need to keep 3 data frames
>>> only, con DB2 and ora.
>>> I write the script to do this.
>>> rm(ls(pattern != c("(con|DB2|ora)")))
>>>
>>>
>>> but it give me an error message:
>>>
>>>
>>> Error in rm(ls(pattern != c("(con|DB2|ora)"))) :
>>>    ... must contain names or character strings
>>>
>>> I think the pattern option doesn't support != ? and is it possible to fix
>>> this?
>>> Thank you,
>>> Kai
>>>
>>>
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From bgunter@4567 @end|ng |rom gm@||@com  Thu Jul 15 16:20:44 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 15 Jul 2021 07:20:44 -0700
Subject: [R] ls() pattern question
In-Reply-To: <84ceeb59-8aa5-6d4c-55d7-112e7720499e@gmail.com>
References: <1687407730.1243315.1626306057329.ref@mail.yahoo.com>
 <1687407730.1243315.1626306057329@mail.yahoo.com>
 <CAPcHnpQ24kW9RAjTvRjKqr14GZnzXEaTgr-O+A5==W6y1T9CmA@mail.gmail.com>
 <CAGxFJbSAKuWD1m6P=NUAEwxYoAortb6kUNzbVtEmR3NCh6HMdg@mail.gmail.com>
 <84ceeb59-8aa5-6d4c-55d7-112e7720499e@gmail.com>
Message-ID: <CAGxFJbRT2_u5PwNi-sp4dFVhh1SDP1wvAOarN+iFD2uFT2uxGA@mail.gmail.com>

Yes,. Thanks for the clarification. I tried to indicate this with my
comment about it being used as the "name" argument of ls().
What I should have said is that it is syntactically wrong as a way to
specify an argument of any function -- "myarg != something" does not
specify anything about the argument "myarg" of a function not equalling
something --  unless, as you pointed out, it positionally matches to
"myarg" and evaluates to something. But that was certainly not the OP's
intent, and I thought it was worth pointing out that he appeared to be
confused about the syntax of argument specification in general.


Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Thu, Jul 15, 2021 at 2:09 AM Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 14/07/2021 8:21 p.m., Bert Gunter wrote:
> > Actually fun( param != something..) is syntactically incorrect in the
> first
> > place for any function!
>
> You have to be careful with absolute statements:
>
>    > f <- function(pattern) cat("It's legal!")
>    > f(pattern != something..)
>    It's legal!
>
> "pattern != something.." is a legal expression, which would return a
> logical vector.  My function didn't ever evaluate it, so the fact that
> variables named "pattern" and "something.." didn't exist in the global
> env didn't make any difference.  It's legal syntax, just wrong.
>
> Duncan Murdoch
>
> >
> > ls sees "pat != whatever"  as the "name" argument of ls() and can't make
> > any sense of it, of course.
> >
> > Bert Gunter
> >
> > "The trouble with having an open mind is that people keep coming along
> and
> > sticking things into it."
> > -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> >
> >
> > On Wed, Jul 14, 2021 at 5:01 PM Andrew Simmons <akwsimmo at gmail.com>
> wrote:
> >
> >> Hello,
> >>
> >>
> >> First, `ls` does not support `!=` for pattern, but it's actually
> throwing a
> >> different error. For `rm`, the objects provided into `...` are
> substituted
> >> (not evaluated), so you should really do something like
> >>
> >> rm(list = ls(pattern = ...))
> >>
> >> As for all except "con", "DB2", and "ora", I would try something like
> >>
> >> setdiff(ls(), c("con", "DB2", "ora"))
> >>
> >> and then add `rm` to that like
> >>
> >> rm(list = setdiff(ls(), c("con", "DB2", "ora")))
> >>
> >> On Wed, Jul 14, 2021 at 7:41 PM Kai Yang via R-help <
> r-help at r-project.org>
> >> wrote:
> >>
> >>> Hello List,
> >>> I have many data frames in environment.  I need to keep 3 data frames
> >>> only, con DB2 and ora.
> >>> I write the script to do this.
> >>> rm(ls(pattern != c("(con|DB2|ora)")))
> >>>
> >>>
> >>> but it give me an error message:
> >>>
> >>>
> >>> Error in rm(ls(pattern != c("(con|DB2|ora)"))) :
> >>>    ... must contain names or character strings
> >>>
> >>> I think the pattern option doesn't support != ? and is it possible to
> fix
> >>> this?
> >>> Thank you,
> >>> Kai
> >>>
> >>>
> >>>
> >>>          [[alternative HTML version deleted]]
> >>>
> >>> ______________________________________________
> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>> PLEASE do read the posting guide
> >>> http://www.R-project.org/posting-guide.html
> >>> and provide commented, minimal, self-contained, reproducible code.
> >>>
> >>
> >>          [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> >> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
>

	[[alternative HTML version deleted]]


From g@@mo||n@k|1 @end|ng |rom gm@||@com  Fri Jul 16 15:37:51 2021
From: g@@mo||n@k|1 @end|ng |rom gm@||@com (=?UTF-8?Q?Grzegorz_Smoli=C5=84ski?=)
Date: Fri, 16 Jul 2021 15:37:51 +0200
Subject: [R] [R-pkgs] dedupewider - package to dedupe records across
 multiple columns
Message-ID: <CABxpnnkbD5qgEZDYOM4PCrYc0uwyyH7X9YaQb4iYUXhceiC7cw@mail.gmail.com>

Dear All,

I would like to announce a one-function package dedupewider. I have
used it to find companies connected by some telephone numbers to
collapse it into one row, e.g. in case of this table:

|tel_1|tel_2|name|
------------------------
|1111|2222|nam1|
|2222|3333|nam2|
|3333|4444|nam3|

all records will be collapsed into one record with 4 unique telephone
numbers (optionally all unique names or information from other columns
can be kept). Perhaps it will be helpful for you as well.

Link to CRAN: https://CRAN.R-project.org/package=dedupewider

Best regards,

Grzegorz Smoli?ski

_______________________________________________
R-packages mailing list
R-packages at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-packages


From r@turner @end|ng |rom @uck|@nd@@c@nz  Sun Jul 18 08:17:06 2021
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Sun, 18 Jul 2021 18:17:06 +1200
Subject: [R] Plotting confidence intervals with ggplot, in multiple facets.
Message-ID: <20210718181706.03a95d29@rolf-Latitude-E7470>



I have need of creating a plot displaying confidence intervals
(for the mean bias in parameter estimates) with one panel or facet
for each of the two parameters in question.

I can do this in base R graphics, but the result is not as
aesthetically pleasing as I would like.  I have attached an example
graphic in the file "eg.pdf".

I would like to try using ggplot2, but cannot get my head around the
syntax.  (Life is a struggle when one is old and senile!)  I have been
shown in the past how to produce a single-facet plot of such confidence
intervals, basically using the geom_errorbar() function, but I cannot
see how to produce multiple facets, depending on a "param" factor.  I
have thrashed around a bit but after succeeding in only confusing
myself, I thought I would save wear and tear on my brain by asking this
list.  I'm sure the answer is pretty simple, but I'm just too stupid to
see it.

Can anyone give me a recipe for creating, with ggplot(), a graphic like
unto that shown in "eg.pdf", but prettier?  I have attached the data
that were used to create "eg.pdf" in the form of a data frame, in a
file called "egData.txt".  This file was produced by dput() so read it
in using dget("egData.txt").

With eternal gratitude.

cheers,

Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276

-------------- next part --------------
A non-text attachment was scrubbed...
Name: eg.pdf
Type: application/pdf
Size: 5654 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20210718/7726e136/attachment.pdf>

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: egData.txt
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20210718/7726e136/attachment.txt>

From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sun Jul 18 08:47:47 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sat, 17 Jul 2021 23:47:47 -0700
Subject: [R] 
 Plotting confidence intervals with ggplot, in multiple facets.
In-Reply-To: <20210718181706.03a95d29@rolf-Latitude-E7470>
References: <20210718181706.03a95d29@rolf-Latitude-E7470>
Message-ID: <C595E022-96DB-4162-B91A-FCBBC472AFB8@dcn.davis.ca.us>

ggplot(dta,aes(x=Ndat,y=estimate, ymin=lower,ymax=upper))+
  geom_point() +
  geom_errorbar(width=30) +
  facet_grid(param~1) +
  theme_minimal()

Width parameter seems odd... play with it I suppose.

For facets, you can also use facet_wrap(~param, ncol=1).

ggplot is very much about the data and the aes mapping... the more you try to manually tweak it the more messed up it tends to get. 

On July 17, 2021 11:17:06 PM PDT, Rolf Turner <r.turner at auckland.ac.nz> wrote:
>
>
>I have need of creating a plot displaying confidence intervals
>(for the mean bias in parameter estimates) with one panel or facet
>for each of the two parameters in question.
>
>I can do this in base R graphics, but the result is not as
>aesthetically pleasing as I would like.  I have attached an example
>graphic in the file "eg.pdf".
>
>I would like to try using ggplot2, but cannot get my head around the
>syntax.  (Life is a struggle when one is old and senile!)  I have been
>shown in the past how to produce a single-facet plot of such confidence
>intervals, basically using the geom_errorbar() function, but I cannot
>see how to produce multiple facets, depending on a "param" factor.  I
>have thrashed around a bit but after succeeding in only confusing
>myself, I thought I would save wear and tear on my brain by asking this
>list.  I'm sure the answer is pretty simple, but I'm just too stupid to
>see it.
>
>Can anyone give me a recipe for creating, with ggplot(), a graphic like
>unto that shown in "eg.pdf", but prettier?  I have attached the data
>that were used to create "eg.pdf" in the form of a data frame, in a
>file called "egData.txt".  This file was produced by dput() so read it
>in using dget("egData.txt").
>
>With eternal gratitude.
>
>cheers,
>
>Rolf Turner

-- 
Sent from my phone. Please excuse my brevity.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sun Jul 18 14:10:57 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sun, 18 Jul 2021 13:10:57 +0100
Subject: [R] 
 Plotting confidence intervals with ggplot, in multiple facets.
In-Reply-To: <20210718181706.03a95d29@rolf-Latitude-E7470>
References: <20210718181706.03a95d29@rolf-Latitude-E7470>
Message-ID: <b45cd75a-a19b-a59a-8f97-8c8d85d00f5e@sapo.pt>

Hello,

Something like this?

library(ggplot2)

eg <- dget("data/egData.txt")

ggplot(eg, aes(Ndat, estimate)) +
 ? geom_errorbar(aes(ymin = lower, ymax = upper), width = 20) +
 ? geom_point(colour = "slateblue", size = 1) +
 ? geom_hline(yintercept = 0, colour = "red") +
 ? facet_grid(param ~ .) +
 ? theme_bw()


Hope this helps,

Rui Barradas

?s 07:17 de 18/07/2021, Rolf Turner escreveu:
>
> I have need of creating a plot displaying confidence intervals
> (for the mean bias in parameter estimates) with one panel or facet
> for each of the two parameters in question.
>
> I can do this in base R graphics, but the result is not as
> aesthetically pleasing as I would like.  I have attached an example
> graphic in the file "eg.pdf".
>
> I would like to try using ggplot2, but cannot get my head around the
> syntax.  (Life is a struggle when one is old and senile!)  I have been
> shown in the past how to produce a single-facet plot of such confidence
> intervals, basically using the geom_errorbar() function, but I cannot
> see how to produce multiple facets, depending on a "param" factor.  I
> have thrashed around a bit but after succeeding in only confusing
> myself, I thought I would save wear and tear on my brain by asking this
> list.  I'm sure the answer is pretty simple, but I'm just too stupid to
> see it.
>
> Can anyone give me a recipe for creating, with ggplot(), a graphic like
> unto that shown in "eg.pdf", but prettier?  I have attached the data
> that were used to create "eg.pdf" in the form of a data frame, in a
> file called "egData.txt".  This file was produced by dput() so read it
> in using dget("egData.txt").
>
> With eternal gratitude.
>
> cheers,
>
> Rolf Turner
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
Este e-mail foi verificado em termos de v?rus pelo software antiv?rus Avast.
https://www.avast.com/antivirus

	[[alternative HTML version deleted]]


From @v|gro@@ @end|ng |rom ver|zon@net  Sun Jul 18 21:11:02 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Sun, 18 Jul 2021 15:11:02 -0400
Subject: [R] 
 Plotting confidence intervals with ggplot, in multiple facets.
In-Reply-To: <20210718181706.03a95d29@rolf-Latitude-E7470>
References: <20210718181706.03a95d29@rolf-Latitude-E7470>
Message-ID: <016501d77c08$a6d94b40$f48be1c0$@verizon.net>

Rolf,

Your example shows two plots with one above the other.

If that is what you want, then a solution like the one  Jeff provided  using
facet_grid() to separate data based on the parameter value. It also scales
up if you add additional sets of data for gamma and delta up to a point.

An alternative to consider if your ggplot wizardry has not kicked in, or if
your need is to connect more diverse plots into a sort of collage, is to
make multiple plots and save them as in:

P1 <- ggplot(...) ...
P2 <- ggplot(...) ...

Each of these two or more plots can operate on whatever data you supply it.
In your case, you would filter the rows that have the values you want.

Then you can use one of many packages out there such as cowplot or gridextra
to consolidate the parts as in:

plot_grid(P1, P2)

Or 

grid.arrange (P1, P2)

These other functions vary in functionality but many allow you to adjust how
many rows or columns you want or the relative sizes of the subplots and so
on. Some allow you to create output into things like a PDF where parts spill
over well into additional pages.

I note one think Jeff did not replicate. If you want that in your output,
use geom_hline as shown below:

ggplot(dta,aes(x=Ndat,y=estimate, ymin=lower,ymax=upper))+
  geom_point() +
  geom_errorbar(width=30) +
  geom_hline(yintercept = 0, color="red") +
  facet_grid(param~1)

Personally, I sometimes adjust the limits to make a graph truly start at
zero but in your case you can have error bars being displayed with parts
below zero so showing where zero is graphically can be useful.




-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Rolf Turner
Sent: Sunday, July 18, 2021 2:17 AM
To: r-help at r-project.org
Subject: [R] Plotting confidence intervals with ggplot, in multiple facets.



I have need of creating a plot displaying confidence intervals (for the mean
bias in parameter estimates) with one panel or facet for each of the two
parameters in question.

I can do this in base R graphics, but the result is not as aesthetically
pleasing as I would like.  I have attached an example graphic in the file
"eg.pdf".

I would like to try using ggplot2, but cannot get my head around the syntax.
(Life is a struggle when one is old and senile!)  I have been shown in the
past how to produce a single-facet plot of such confidence intervals,
basically using the geom_errorbar() function, but I cannot see how to
produce multiple facets, depending on a "param" factor.  I have thrashed
around a bit but after succeeding in only confusing myself, I thought I
would save wear and tear on my brain by asking this list.  I'm sure the
answer is pretty simple, but I'm just too stupid to see it.

Can anyone give me a recipe for creating, with ggplot(), a graphic like unto
that shown in "eg.pdf", but prettier?  I have attached the data that were
used to create "eg.pdf" in the form of a data frame, in a file called
"egData.txt".  This file was produced by dput() so read it in using
dget("egData.txt").

With eternal gratitude.

cheers,

Rolf Turner

--
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From r@turner @end|ng |rom @uck|@nd@@c@nz  Tue Jul 20 01:24:05 2021
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Tue, 20 Jul 2021 11:24:05 +1200
Subject: [R] 
 Plotting confidence intervals with ggplot, in multiple facets.
In-Reply-To: <016501d77c08$a6d94b40$f48be1c0$@verizon.net>
References: <20210718181706.03a95d29@rolf-Latitude-E7470>
 <016501d77c08$a6d94b40$f48be1c0$@verizon.net>
Message-ID: <20210720112405.08ec449e@rolf-Latitude-E7470>



Thanks to Jeff Newmiller, Rui Barradas and Avi Gross for their
extremely helpful replies.  I have got both Jeff's and Rui's code to
run.  I am currently experimenting with Avi's suggestion of producing
multiple plots and then putting them together using plotgrid() or
grid.arrange().  This idea seems to me to be most promising in terms of
a desideratum that the y-axis scales/limits should be different on the
two facets.  Also the y-axis labels.

And speaking of y-axis labels:  is it possible in ggplot() to get
mathematical notation in axis labels, titles and possibly other
annotation?  (In the manner of plotmath() in base R graphics.)
Specifically I'd like to get the Greek letters alpha and beta in the
y-axis labels.  In base R graphics I'd do something like
ylab=expression(paste("bias in ",beta)) .  Is there an appropriate
analogue in ggplot()?  (I think that I may have asked this question
before, some time back, but have forgotten the answer.)

cheers,

Rolf

P.S.  The following is kind of apropos of nothing, but it might serve as
a useful warning to others of a Trap for Young Players.  I nearly went
mad (madder?) for a very long time when trying to get Rui's code to run.
I kept getting errors of the form:

> Error in source("scr.Rui") : scr.Rui:6:2: unexpected input
> 5: ggplot(eg, aes(Ndat, estimate)) +
> 6:  ?
>     ^

Took me an unconscionably long while to figure out what was going on.
I could not see why Jeff's code ran without problem, while Rui's (which
was very similar) fell over.  Turns out the second character in the
offending line is a non-printing character, the 160th member of the
ASCII character set. (It can be produced using "\u00A0".)  Apparently
this is a "non-breaking space". Whatever that means.  It does NOT get
treated as white space in the usual way, and triggers the foregoing
error.

Presumably this invisible character got introduced, into the code that
Rui emailed, by one of the (many!) infuriating idiosyncrasies of
Windoze.  Yet another reason, among the many millions of such, not to
use Windoze.

R.

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From w||||@mwdun|@p @end|ng |rom gm@||@com  Tue Jul 20 02:21:23 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Mon, 19 Jul 2021 17:21:23 -0700
Subject: [R] 
 Plotting confidence intervals with ggplot, in multiple facets.
In-Reply-To: <20210720112405.08ec449e@rolf-Latitude-E7470>
References: <20210718181706.03a95d29@rolf-Latitude-E7470>
 <016501d77c08$a6d94b40$f48be1c0$@verizon.net>
 <20210720112405.08ec449e@rolf-Latitude-E7470>
Message-ID: <CAHqSRuRuDcDpNF+ViRjumJFu+L0fLbUnp2d9Y++UBLgvuYSC3Q@mail.gmail.com>

ggplot2::labs() interprets expressions as plotmath.  E.g.,

   data.frame(X=1:10,Y=(1:10)^2) %>% ggplot(aes(X,Y)) + geom_point() +
       labs(x = expression(beta), y = expression(beta^2))

-Bill


On Mon, Jul 19, 2021 at 4:24 PM Rolf Turner <r.turner at auckland.ac.nz> wrote:

>
>
> Thanks to Jeff Newmiller, Rui Barradas and Avi Gross for their
> extremely helpful replies.  I have got both Jeff's and Rui's code to
> run.  I am currently experimenting with Avi's suggestion of producing
> multiple plots and then putting them together using plotgrid() or
> grid.arrange().  This idea seems to me to be most promising in terms of
> a desideratum that the y-axis scales/limits should be different on the
> two facets.  Also the y-axis labels.
>
> And speaking of y-axis labels:  is it possible in ggplot() to get
> mathematical notation in axis labels, titles and possibly other
> annotation?  (In the manner of plotmath() in base R graphics.)
> Specifically I'd like to get the Greek letters alpha and beta in the
> y-axis labels.  In base R graphics I'd do something like
> ylab=expression(paste("bias in ",beta)) .  Is there an appropriate
> analogue in ggplot()?  (I think that I may have asked this question
> before, some time back, but have forgotten the answer.)
>
> cheers,
>
> Rolf
>
> P.S.  The following is kind of apropos of nothing, but it might serve as
> a useful warning to others of a Trap for Young Players.  I nearly went
> mad (madder?) for a very long time when trying to get Rui's code to run.
> I kept getting errors of the form:
>
> > Error in source("scr.Rui") : scr.Rui:6:2: unexpected input
> > 5: ggplot(eg, aes(Ndat, estimate)) +
> > 6:
> >     ^
>
> Took me an unconscionably long while to figure out what was going on.
> I could not see why Jeff's code ran without problem, while Rui's (which
> was very similar) fell over.  Turns out the second character in the
> offending line is a non-printing character, the 160th member of the
> ASCII character set. (It can be produced using "\u00A0".)  Apparently
> this is a "non-breaking space". Whatever that means.  It does NOT get
> treated as white space in the usual way, and triggers the foregoing
> error.
>
> Presumably this invisible character got introduced, into the code that
> Rui emailed, by one of the (many!) infuriating idiosyncrasies of
> Windoze.  Yet another reason, among the many millions of such, not to
> use Windoze.
>
> R.
>
> --
> Honorary Research Fellow
> Department of Statistics
> University of Auckland
> Phone: +64-9-373-7599 ext. 88276
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @v|gro@@ @end|ng |rom ver|zon@net  Tue Jul 20 03:39:42 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Mon, 19 Jul 2021 21:39:42 -0400
Subject: [R] 
 Plotting confidence intervals with ggplot, in multiple facets.
In-Reply-To: <20210720112405.08ec449e@rolf-Latitude-E7470>
References: <20210718181706.03a95d29@rolf-Latitude-E7470>
 <016501d77c08$a6d94b40$f48be1c0$@verizon.net>
 <20210720112405.08ec449e@rolf-Latitude-E7470>
Message-ID: <030701d77d08$1cc9b330$565d1990$@verizon.net>

Rolf,

 

Your questions probably should go to a group focused on the ggplot package, not a general R group where many do not use it.

 

A little judicious searching like "R ggplot use greek letters in text" gets you some pointers that show how to do much more than Greek letters but more complex mathematical style equations and that many aspects of ggplot support it and you can use other functions like paste() to put more complex expressions together.

 

Similarly, your comments about wanting to have different scales showing in multiple plots using facet_grid() or perhaps facet_wrap() might answer your question as the manual page explains:

 


scales

Are scales shared across all facets (the default, "fixed"), or do they vary across rows ("free_x"), columns ("free_y"), or both rows and columns ("free")?

So alter the line you use at the end to include a comma at the end of the arguments followed by ?scale=?? as needed.

 

But yes, truly independent graphs placed in a grid, after loading the packages needed, gives even more options.

 

There are some very decent books and tutorials on many aspects of ggplot including some that are free and on-line. Here is an earlier edition of one:

 

https://ggplot2-book.org/

 

Note especially this section on faceting:

 

https://ggplot2-book.org/facet.html

 

I will now go silent on ggplot-related questions ?

 

 

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Rolf Turner
Sent: Monday, July 19, 2021 7:24 PM
To: r-help at r-project.org
Subject: Re: [R] Plotting confidence intervals with ggplot, in multiple facets.

 

 

 

Thanks to Jeff Newmiller, Rui Barradas and Avi Gross for their extremely helpful replies.  I have got both Jeff's and Rui's code to run.  I am currently experimenting with Avi's suggestion of producing multiple plots and then putting them together using plotgrid() or grid.arrange().  This idea seems to me to be most promising in terms of a desideratum that the y-axis scales/limits should be different on the two facets.  Also the y-axis labels.

 

And speaking of y-axis labels:  is it possible in ggplot() to get mathematical notation in axis labels, titles and possibly other annotation?  (In the manner of plotmath() in base R graphics.) Specifically I'd like to get the Greek letters alpha and beta in the y-axis labels.  In base R graphics I'd do something like ylab=expression(paste("bias in ",beta)) .  Is there an appropriate analogue in ggplot()?  (I think that I may have asked this question before, some time back, but have forgotten the answer.)

 

cheers,

 

Rolf

 

P.S.  The following is kind of apropos of nothing, but it might serve as a useful warning to others of a Trap for Young Players.  I nearly went mad (madder?) for a very long time when trying to get Rui's code to run.

I kept getting errors of the form:

 

> Error in source("scr.Rui") : scr.Rui:6:2: unexpected input

> 5: ggplot(eg, aes(Ndat, estimate)) +

> 6:   

>     ^

 

Took me an unconscionably long while to figure out what was going on.

I could not see why Jeff's code ran without problem, while Rui's (which was very similar) fell over.  Turns out the second character in the offending line is a non-printing character, the 160th member of the ASCII character set. (It can be produced using "\u00A0".)  Apparently this is a "non-breaking space". Whatever that means.  It does NOT get treated as white space in the usual way, and triggers the foregoing error.

 

Presumably this invisible character got introduced, into the code that Rui emailed, by one of the (many!) infuriating idiosyncrasies of Windoze.  Yet another reason, among the many millions of such, not to use Windoze.

 

R.

 

--

Honorary Research Fellow

Department of Statistics

University of Auckland

Phone: +64-9-373-7599 ext. 88276

 

______________________________________________

 <mailto:R-help at r-project.org> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see  <https://stat.ethz.ch/mailman/listinfo/r-help> https://stat.ethz.ch/mailman/listinfo/r-help

PLEASE do read the posting guide  <http://www.R-project.org/posting-guide.html> http://www.R-project.org/posting-guide.html

and provide commented, minimal, self-contained, reproducible code.


	[[alternative HTML version deleted]]


From 21707095 @end|ng |rom zju@edu@cn  Tue Jul 20 16:32:23 2021
From: 21707095 @end|ng |rom zju@edu@cn (Juan Liu)
Date: Tue, 20 Jul 2021 22:32:23 +0800 (GMT+08:00)
Subject: [R] ask for help about lme function
Message-ID: <7138606d.5933f.17ac4550491.Coremail.21707095@zju.edu.cn>

Dear R project,

I am a doctoral student in Zhejiang university in China, I am using lme function in nlme package and learning the function by Package 'nlme' document. I am writing this email for some help to build a lme model.

My goal was to include two non-nested random effects in the lme model. the document described how to write the random effects while I found it difficult for me to understand. My problem are as below:




In these model, site and year were considered as non nested effects. I want to set the structure in lme model the same as lmer model(the 1st model below), and I used the structure "random=list(site=~1,year=~1)"(the 2nd model below) . According to the result, the  lme model was obviously wrong, for the R2 and AIC were different from that of lmer model. I want to know to get the same result as lmer model, how should I set the random argument?

Below is the model and results in R,




################################################################1. lmer function
lmer<-lmer(data, y~x1+x2+x3+(1|site)+(1|year))             
r2(lmer)##58.8%?29.7%
r.squaredGLMM(lmer)##58.8%; 29.72%;AIC=462.4
###################################################################2. lme1
lme1<-lme(data, y~x1+x2+x3,random = list(site=~1,year=~1))              
r2(lme1)## NA(can't get the result)
r.squaredGLMM(lme1)##92.4%; 30.89%;AIC=533




I will be appreciated for your help.




Yours sincerely,

Juan Liu

Juan Liu

PhD candidate

College of Life Sciences, Zhejiang University

866 Yuhangtang Road, Hangzhou

Zhejiang 310058, P.R.China

21707095 at zju.edu.cn? liujuan_1994 at outlook.com



	[[alternative HTML version deleted]]


From br|@n@m|th199312 @end|ng |rom gm@||@com  Tue Jul 20 11:58:56 2021
From: br|@n@m|th199312 @end|ng |rom gm@||@com (Brian Smith)
Date: Tue, 20 Jul 2021 15:28:56 +0530
Subject: [R] Using R to analyse Court documents
Message-ID: <CAHUBDY-AipzmqaD+=LZRutmHCKw_WP8GNzEZWedTm=v5A+jtaQ@mail.gmail.com>

Hi,

I am wondering if there is some references on how R can be used to
analyse legal/court documents. I searched a bit in internet but unable
to get anything meaningful.

Any reference will be very appreciated.

Thanks for your time.

Thanks and regards,


From twoo|m@n @end|ng |rom ont@rgettek@com  Tue Jul 20 17:55:00 2021
From: twoo|m@n @end|ng |rom ont@rgettek@com (Tom Woolman)
Date: Tue, 20 Jul 2021 11:55:00 -0400
Subject: [R] Using R to analyse Court documents
In-Reply-To: <CAHUBDY-AipzmqaD+=LZRutmHCKw_WP8GNzEZWedTm=v5A+jtaQ@mail.gmail.com>
Message-ID: <20210720115500.Horde.ENTssRiYQ1g8LStlLUiDYGj@www.ontargettek.com>

Hi Brian. I assume you're interested in some kind of classification of  
the theme or the contents within each document?
In which case I would direct you to natural language processing for  
multinomial classification of unstructured data. Basically an NLP  
(natural language processing) classification problem. The first  
challenge will be obtaining human-labeled training examples of a  
sufficient number of example documents.


Thanks,
Tom


Quoting Brian Smith <briansmith199312 at gmail.com>:

> Hi,
>
> I am wondering if there is some references on how R can be used to
> analyse legal/court documents. I searched a bit in internet but unable
> to get anything meaningful.
>
> Any reference will be very appreciated.
>
> Thanks for your time.
>
> Thanks and regards,
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kev|n@thorpe @end|ng |rom utoronto@c@  Tue Jul 20 18:11:42 2021
From: kev|n@thorpe @end|ng |rom utoronto@c@ (Kevin Thorpe)
Date: Tue, 20 Jul 2021 16:11:42 +0000
Subject: [R] ask for help about lme function
In-Reply-To: <7138606d.5933f.17ac4550491.Coremail.21707095@zju.edu.cn>
References: <7138606d.5933f.17ac4550491.Coremail.21707095@zju.edu.cn>
Message-ID: <2C4B984F-693D-426D-B8D4-4B1107E39D62@utoronto.ca>

You might get better answers on the r-sig-ME list.

The lmer() function from lme4 handles crossed and non-nested random effects quite seamlessly. I cannot comment on whether or not lme() can as well.

-- 
Kevin E. Thorpe
Head of Biostatistics,  Applied Health Research Centre (AHRC)
Li Ka Shing Knowledge Institute of St. Michael's
Assistant Professor, Dalla Lana School of Public Health
University of Toronto
email: kevin.thorpe at utoronto.ca  Tel: 416.864.5776  Fax: 416.864.3016

> On Jul 20, 2021, at 10:32 AM, Juan Liu <21707095 at zju.edu.cn> wrote:
> 
> EXTERNAL EMAIL:
> 
> Dear R project,
> 
> I am a doctoral student in Zhejiang university in China, I am using lme function in nlme package and learning the function by Package 'nlme' document. I am writing this email for some help to build a lme model.
> 
> My goal was to include two non-nested random effects in the lme model. the document described how to write the random effects while I found it difficult for me to understand. My problem are as below:
> 
> 
> 
> 
> In these model, site and year were considered as non nested effects. I want to set the structure in lme model the same as lmer model(the 1st model below), and I used the structure "random=list(site=~1,year=~1)"(the 2nd model below) . According to the result, the  lme model was obviously wrong, for the R2 and AIC were different from that of lmer model. I want to know to get the same result as lmer model, how should I set the random argument?
> 
> Below is the model and results in R,
> 
> 
> 
> 
> ################################################################1. lmer function
> lmer<-lmer(data, y~x1+x2+x3+(1|site)+(1|year))
> r2(lmer)##58.8%?29.7%
> r.squaredGLMM(lmer)##58.8%; 29.72%;AIC=462.4
> ###################################################################2. lme1
> lme1<-lme(data, y~x1+x2+x3,random = list(site=~1,year=~1))
> r2(lme1)## NA(can't get the result)
> r.squaredGLMM(lme1)##92.4%; 30.89%;AIC=533
> 
> 
> 
> 
> I will be appreciated for your help.
> 
> 
> 
> 
> Yours sincerely,
> 
> Juan Liu
> 
> Juan Liu
> 
> PhD candidate
> 
> College of Life Sciences, Zhejiang University
> 
> 866 Yuhangtang Road, Hangzhou
> 
> Zhejiang 310058, P.R.China
> 
> 21707095 at zju.edu.cn? liujuan_1994 at outlook.com
> 
> 
> 
>        [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Tue Jul 20 22:39:39 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 20 Jul 2021 13:39:39 -0700
Subject: [R] ask for help about lme function
In-Reply-To: <2C4B984F-693D-426D-B8D4-4B1107E39D62@utoronto.ca>
References: <7138606d.5933f.17ac4550491.Coremail.21707095@zju.edu.cn>
 <2C4B984F-693D-426D-B8D4-4B1107E39D62@utoronto.ca>
Message-ID: <CAGxFJbTy+oGLybqmPBh3=D6+mnEO8q-iQ--NzQaO5VqheR62VA@mail.gmail.com>

The mixed models list is r-sig-mixed-models .

nlme:lme is not really designed for crossed random effects. IIRC, it's
possible, but not easy. As Kevin said, lme4:lmer is really what you should
use.

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Tue, Jul 20, 2021 at 9:12 AM Kevin Thorpe <kevin.thorpe at utoronto.ca>
wrote:

> You might get better answers on the r-sig-ME list.
>
> The lmer() function from lme4 handles crossed and non-nested random
> effects quite seamlessly. I cannot comment on whether or not lme() can as
> well.
>
> --
> Kevin E. Thorpe
> Head of Biostatistics,  Applied Health Research Centre (AHRC)
> Li Ka Shing Knowledge Institute of St. Michael's
> Assistant Professor, Dalla Lana School of Public Health
> University of Toronto
> email: kevin.thorpe at utoronto.ca  Tel: 416.864.5776  Fax: 416.864.3016
>
> > On Jul 20, 2021, at 10:32 AM, Juan Liu <21707095 at zju.edu.cn> wrote:
> >
> > EXTERNAL EMAIL:
> >
> > Dear R project,
> >
> > I am a doctoral student in Zhejiang university in China, I am using lme
> function in nlme package and learning the function by Package 'nlme'
> document. I am writing this email for some help to build a lme model.
> >
> > My goal was to include two non-nested random effects in the lme model.
> the document described how to write the random effects while I found it
> difficult for me to understand. My problem are as below:
> >
> >
> >
> >
> > In these model, site and year were considered as non nested effects. I
> want to set the structure in lme model the same as lmer model(the 1st model
> below), and I used the structure "random=list(site=~1,year=~1)"(the 2nd
> model below) . According to the result, the  lme model was obviously wrong,
> for the R2 and AIC were different from that of lmer model. I want to know
> to get the same result as lmer model, how should I set the random argument?
> >
> > Below is the model and results in R,
> >
> >
> >
> >
> > ################################################################1. lmer
> function
> > lmer<-lmer(data, y~x1+x2+x3+(1|site)+(1|year))
> > r2(lmer)##58.8%?29.7%
> > r.squaredGLMM(lmer)##58.8%; 29.72%;AIC=462.4
> > ###################################################################2.
> lme1
> > lme1<-lme(data, y~x1+x2+x3,random = list(site=~1,year=~1))
> > r2(lme1)## NA(can't get the result)
> > r.squaredGLMM(lme1)##92.4%; 30.89%;AIC=533
> >
> >
> >
> >
> > I will be appreciated for your help.
> >
> >
> >
> >
> > Yours sincerely,
> >
> > Juan Liu
> >
> > Juan Liu
> >
> > PhD candidate
> >
> > College of Life Sciences, Zhejiang University
> >
> > 866 Yuhangtang Road, Hangzhou
> >
> > Zhejiang 310058, P.R.China
> >
> > 21707095 at zju.edu.cn? liujuan_1994 at outlook.com
> >
> >
> >
> >        [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Tue Jul 20 22:43:06 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 20 Jul 2021 13:43:06 -0700
Subject: [R] Using R to analyse Court documents
In-Reply-To: <CAHUBDY-AipzmqaD+=LZRutmHCKw_WP8GNzEZWedTm=v5A+jtaQ@mail.gmail.com>
References: <CAHUBDY-AipzmqaD+=LZRutmHCKw_WP8GNzEZWedTm=v5A+jtaQ@mail.gmail.com>
Message-ID: <CAGxFJbT71BWrujSx02gRQpC2K8=8jPXneBNHxSUHkhi4qV6YgA@mail.gmail.com>

Look here:

https://cran.r-project.org/web/views/NaturalLanguageProcessing.html


Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Tue, Jul 20, 2021 at 8:47 AM Brian Smith <briansmith199312 at gmail.com>
wrote:

> Hi,
>
> I am wondering if there is some references on how R can be used to
> analyse legal/court documents. I searched a bit in internet but unable
> to get anything meaningful.
>
> Any reference will be very appreciated.
>
> Thanks for your time.
>
> Thanks and regards,
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From r@turner @end|ng |rom @uck|@nd@@c@nz  Wed Jul 21 02:40:13 2021
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Wed, 21 Jul 2021 12:40:13 +1200
Subject: [R] 
 Plotting confidence intervals with ggplot, in multiple facets.
In-Reply-To: <CAHqSRuRuDcDpNF+ViRjumJFu+L0fLbUnp2d9Y++UBLgvuYSC3Q@mail.gmail.com>
References: <20210718181706.03a95d29@rolf-Latitude-E7470>
 <016501d77c08$a6d94b40$f48be1c0$@verizon.net>
 <20210720112405.08ec449e@rolf-Latitude-E7470>
 <CAHqSRuRuDcDpNF+ViRjumJFu+L0fLbUnp2d9Y++UBLgvuYSC3Q@mail.gmail.com>
Message-ID: <20210721124013.500e7089@rolf-Latitude-E7470>


Thanks to Bill Dunlap and Avi Gross for their clear and helpful answers
to my questions.

cheers,

Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From @w@y @end|ng |rom empowerph@rm@cy@com  Wed Jul 21 21:23:28 2021
From: @w@y @end|ng |rom empowerph@rm@cy@com (Shawn Way)
Date: Wed, 21 Jul 2021 19:23:28 +0000
Subject: [R] Help with Converting Excel Times to R
Message-ID: <SA1PR13MB4878B99FF67737AB8EC3B411C3E39@SA1PR13MB4878.namprd13.prod.outlook.com>

I've usually had good luck with this, but something is not working well.  I have two datetimes in excel

7/20/21 13:30
7/20/21 13:40

And when I convert these to excel's normal storage schema, I get the following:

42935.5625
42935.56944

Just try to convert this to a POSIX class gives me issues.

> dt <- c(42935.5625,42935.5694444444)

> as.POSIXct(dt,origin="1899-12-30 00:00:00",tz="GMT")

[1] "1899-12-30 11:55:36 GMT" "1899-12-30 11:55:36 GMT"

As you can see, there is a world of difference here.  I've tried any number of solutions such as lubridate, etc and I get the same result

> as_datetime(dt,origin="1899-12-30 00:00:00")

[1] "1899-12-30 11:55:36 UTC" "1899-12-30 11:55:36 UTC"

Any ideas about what I'm doing wrong?


Shawn Way


From jrm||k@ @end|ng |rom y@hoo@com  Wed Jul 21 22:56:54 2021
From: jrm||k@ @end|ng |rom y@hoo@com (Jim Milks)
Date: Wed, 21 Jul 2021 16:56:54 -0400
Subject: [R] Using R to analyse Court documents
References: <7BCD9FBE-5BAE-46A1-8156-349C278A4312.ref@yahoo.com>
Message-ID: <7BCD9FBE-5BAE-46A1-8156-349C278A4312@yahoo.com>

Brian,

Check out the corpus and tidytext packages for R.

https://rdrr.io/cran/corpus/f/vignettes/corpus.Rmd

https://www.tidytextmining.com/

Hope this helps.

Jim Milks


<briansmith199312 at gmail.com>:

> Hi,
> 
> I am wondering if there is some references on how R can be used to
> analyse legal/court documents. I searched a bit in internet but unable
> to get anything meaningful.
> 
> Any reference will be very appreciated.
> 
> Thanks for your time.
> 
> Thanks and regards,
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


Sent from my iPhone
	[[alternative HTML version deleted]]


From drj|m|emon @end|ng |rom gm@||@com  Thu Jul 22 01:08:36 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Thu, 22 Jul 2021 09:08:36 +1000
Subject: [R] Help with Converting Excel Times to R
In-Reply-To: <SA1PR13MB4878B99FF67737AB8EC3B411C3E39@SA1PR13MB4878.namprd13.prod.outlook.com>
References: <SA1PR13MB4878B99FF67737AB8EC3B411C3E39@SA1PR13MB4878.namprd13.prod.outlook.com>
Message-ID: <CA+8X3fUr19-5x0Uz4drLUi9LzbyiM5WBkCwY5m-BqS51G7b87A@mail.gmail.com>

Hi Shawn,
I don't have any trouble with this:

times<-c("7/20/21 13:30","7/20/21 13:40")
strptime(times,"%m/%d/%y %H:%M",tz="GMT")
[1] "2021-07-20 13:30:00 GMT" "2021-07-20 13:40:00 GMT"

I suspect that Excel is causing the problem. Try changing the format
of the date column to "Text" and work on the character representation
of the dates.

Jim

On Thu, Jul 22, 2021 at 8:49 AM Shawn Way <sway at empowerpharmacy.com> wrote:
>
> I've usually had good luck with this, but something is not working well.  I have two datetimes in excel
>
> 7/20/21 13:30
> 7/20/21 13:40
>
> And when I convert these to excel's normal storage schema, I get the following:
>
> 42935.5625
> 42935.56944
>
> Just try to convert this to a POSIX class gives me issues.
>
> > dt <- c(42935.5625,42935.5694444444)
>
> > as.POSIXct(dt,origin="1899-12-30 00:00:00",tz="GMT")
>
> [1] "1899-12-30 11:55:36 GMT" "1899-12-30 11:55:36 GMT"
>
> As you can see, there is a world of difference here.  I've tried any number of solutions such as lubridate, etc and I get the same result
>
> > as_datetime(dt,origin="1899-12-30 00:00:00")
>
> [1] "1899-12-30 11:55:36 UTC" "1899-12-30 11:55:36 UTC"
>
> Any ideas about what I'm doing wrong?
>
>
> Shawn Way
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @kw@|mmo @end|ng |rom gm@||@com  Thu Jul 22 01:18:25 2021
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Wed, 21 Jul 2021 19:18:25 -0400
Subject: [R] Help with Converting Excel Times to R
In-Reply-To: <SA1PR13MB4878B99FF67737AB8EC3B411C3E39@SA1PR13MB4878.namprd13.prod.outlook.com>
References: <SA1PR13MB4878B99FF67737AB8EC3B411C3E39@SA1PR13MB4878.namprd13.prod.outlook.com>
Message-ID: <CAPcHnpRcS2W8Mp51Ksd-cXXc2iX20-ob9z8QhUmKyYndrLyWZQ@mail.gmail.com>

Hello,


>From playing around with your numbers, it seems like you are using Excel
1904 Date System, which isn't a problem, it just means that your numbers
are days from 1904-01-01 instead of 1900-01-01.
The following is my solution:

times <- c(42935.5625,42935.5694444444)
as.POSIXlt((


    # offset the days by the origin for Excel
    times + unclass(as.Date("1904-01-01"))


# multiply by 86400 to convert number of days to number of seconds
) * 86400,


# .Date(0) is the origin day for R
origin = .Date(0), tz = "GMT")

though a better way to do it would be to save the datetimes in Excel as
text, and then use `as.POSIXct(..., format = ...)` on the text field once
read into R. Something like:


times <- c("7/20/2021 13:30", "7/20/2021 13:40")
as.POSIXlt(times, format = "%m/%d/%Y %H:%M", tz = "GMT")


On Wed, Jul 21, 2021 at 6:49 PM Shawn Way <sway at empowerpharmacy.com> wrote:

> I've usually had good luck with this, but something is not working well.
> I have two datetimes in excel
>
> 7/20/21 13:30
> 7/20/21 13:40
>
> And when I convert these to excel's normal storage schema, I get the
> following:
>
> 42935.5625
> 42935.56944
>
> Just try to convert this to a POSIX class gives me issues.
>
> > dt <- c(42935.5625,42935.5694444444)
>
> > as.POSIXct(dt,origin="1899-12-30 00:00:00",tz="GMT")
>
> [1] "1899-12-30 11:55:36 GMT" "1899-12-30 11:55:36 GMT"
>
> As you can see, there is a world of difference here.  I've tried any
> number of solutions such as lubridate, etc and I get the same result
>
> > as_datetime(dt,origin="1899-12-30 00:00:00")
>
> [1] "1899-12-30 11:55:36 UTC" "1899-12-30 11:55:36 UTC"
>
> Any ideas about what I'm doing wrong?
>
>
> Shawn Way
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @w@y @end|ng |rom empowerph@rm@cy@com  Thu Jul 22 01:28:49 2021
From: @w@y @end|ng |rom empowerph@rm@cy@com (Shawn Way)
Date: Wed, 21 Jul 2021 23:28:49 +0000
Subject: [R] Help with Converting Excel Times to R
In-Reply-To: <CA+8X3fUr19-5x0Uz4drLUi9LzbyiM5WBkCwY5m-BqS51G7b87A@mail.gmail.com>
References: <SA1PR13MB4878B99FF67737AB8EC3B411C3E39@SA1PR13MB4878.namprd13.prod.outlook.com>
 <CA+8X3fUr19-5x0Uz4drLUi9LzbyiM5WBkCwY5m-BqS51G7b87A@mail.gmail.com>
Message-ID: <SA1PR13MB4878D59BD9F6D7D45A80329FC3E39@SA1PR13MB4878.namprd13.prod.outlook.com>

Thank you very much!  That worked.  I didn't need the unclass(as.Date...) as the as.POSIXlt required me to use an origin to make the transformation.

The working code is as follows:

> times <- c(42935.5625,42935.5694444444)
as.POSIXct((times*86400),origin="1904-01-01",tz="America/Chicago")
[1] "2021-07-20 08:30:00 CDT" "2021-07-20 08:39:59 CDT"


I've never heard of the "1904-01-01" origin, only the "1899-12-30" origin for excel.  Nor did I know about the multiplication of 86400.

Thank you again! 


Shawn Way

-----Original Message-----
From: Jim Lemon <drjimlemon at gmail.com> 
Sent: Wednesday, July 21, 2021 6:09 PM
To: Shawn Way <sway at empowerpharmacy.com>
Cc: r-help at r-project.org
Subject: Re: [R] Help with Converting Excel Times to R

Hi Shawn,
I don't have any trouble with this:

times<-c("7/20/21 13:30","7/20/21 13:40") strptime(times,"%m/%d/%y %H:%M",tz="GMT") [1] "2021-07-20 13:30:00 GMT" "2021-07-20 13:40:00 GMT"

I suspect that Excel is causing the problem. Try changing the format of the date column to "Text" and work on the character representation of the dates.

Jim

On Thu, Jul 22, 2021 at 8:49 AM Shawn Way <sway at empowerpharmacy.com> wrote:
>
> I've usually had good luck with this, but something is not working 
> well.  I have two datetimes in excel
>
> 7/20/21 13:30
> 7/20/21 13:40
>
> And when I convert these to excel's normal storage schema, I get the following:
>
> 42935.5625
> 42935.56944
>
> Just try to convert this to a POSIX class gives me issues.
>
> > dt <- c(42935.5625,42935.5694444444)
>
> > as.POSIXct(dt,origin="1899-12-30 00:00:00",tz="GMT")
>
> [1] "1899-12-30 11:55:36 GMT" "1899-12-30 11:55:36 GMT"
>
> As you can see, there is a world of difference here.  I've tried any 
> number of solutions such as lubridate, etc and I get the same result
>
> > as_datetime(dt,origin="1899-12-30 00:00:00")
>
> [1] "1899-12-30 11:55:36 UTC" "1899-12-30 11:55:36 UTC"
>
> Any ideas about what I'm doing wrong?
>
>
> Shawn Way
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

From n@th@n@|@p@r@on@ @end|ng |rom gm@||@com  Thu Jul 22 05:12:49 2021
From: n@th@n@|@p@r@on@ @end|ng |rom gm@||@com (N. F. Parsons)
Date: Wed, 21 Jul 2021 20:12:49 -0700
Subject: [R] Assigning categorical values to dates
Message-ID: <CANdqJqcQ8AYa3_YeUcY8nBruq1rTycEMVLcy_fdvxc9FinKtRA@mail.gmail.com>

Hi all,

If I have a tibble as follows:

tibble(dates = c(rep("2021-07-04", 2),  rep("2021-07-25", 3),
rep("2021-07-18", 4)))

how in the world do I add a column that evaluates each of those dates and
assigns it a categorical value such that

dates                cycle
<chr>               <chr>
2021-07-04      1
2021-07-04      1
2021-07-25      3
2021-07-25      3
2021-07-25      3
2021-07-18      2
2021-07-18      2
2021-07-18      2
2021-07-18      2

Not to further complicate matters, but some months I may only have one
date, and some months I will have 4 dates - so thats not a fixed quantity.
We've literally been doing this by hand at my job and I'd like to automate
it.

Thanks in advance!

Nate Parsons

	[[alternative HTML version deleted]]


From twoo|m@n @end|ng |rom ont@rgettek@com  Thu Jul 22 05:23:52 2021
From: twoo|m@n @end|ng |rom ont@rgettek@com (Tom Woolman)
Date: Wed, 21 Jul 2021 23:23:52 -0400
Subject: [R] Assigning categorical values to dates
In-Reply-To: <CANdqJqcQ8AYa3_YeUcY8nBruq1rTycEMVLcy_fdvxc9FinKtRA@mail.gmail.com>
Message-ID: <20210721232352.Horde.WCDlc-n6R4Mx1XEElkxF5Ka@www.ontargettek.com>


Couldn't you convert the date columns to character type data in a data  
frame, and then convert those strings to factors in a 2nd step?

The only downside I think to treating dates as factor levels is that  
you might have an awful lot of factors if you have a large enough  
dataset.



Quoting "N. F. Parsons" <nathan.f.parsons at gmail.com>:

> Hi all,
>
> If I have a tibble as follows:
>
> tibble(dates = c(rep("2021-07-04", 2),  rep("2021-07-25", 3),
> rep("2021-07-18", 4)))
>
> how in the world do I add a column that evaluates each of those dates and
> assigns it a categorical value such that
>
> dates                cycle
> <chr>               <chr>
> 2021-07-04      1
> 2021-07-04      1
> 2021-07-25      3
> 2021-07-25      3
> 2021-07-25      3
> 2021-07-18      2
> 2021-07-18      2
> 2021-07-18      2
> 2021-07-18      2
>
> Not to further complicate matters, but some months I may only have one
> date, and some months I will have 4 dates - so thats not a fixed quantity.
> We've literally been doing this by hand at my job and I'd like to automate
> it.
>
> Thanks in advance!
>
> Nate Parsons
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From n@th@n@|@p@r@on@ @end|ng |rom gm@||@com  Thu Jul 22 05:46:41 2021
From: n@th@n@|@p@r@on@ @end|ng |rom gm@||@com (N. F. Parsons)
Date: Wed, 21 Jul 2021 20:46:41 -0700
Subject: [R] Assigning categorical values to dates
In-Reply-To: <20210721232352.Horde.WCDlc-n6R4Mx1XEElkxF5Ka@www.ontargettek.com>
References: <20210721232352.Horde.WCDlc-n6R4Mx1XEElkxF5Ka@www.ontargettek.com>
Message-ID: <b5dc3f68-fc47-4f6c-ad3b-aac57020e9ba@Canary>

I am not averse to a factor-based solution, but I would still have to manually enter that factor each month, correct? If possible, I?d just like to point R at that column and have it do the work.

?
Nathan Parsons, B.SC, M.Sc, G.C.

Ph.D. Candidate, Dept. of Sociology, Portland State University
Adjunct Professor, Dept. of Sociology, Washington State University
Graduate Advocate, American Association of University Professors (OR)

Recent work (https://www.researchgate.net/profile/Nathan_Parsons3/publications)
Schedule an appointment (https://calendly.com/nate-parsons)

> On Wednesday, Jul 21, 2021 at 8:30 PM, Tom Woolman <twoolman at ontargettek.com (mailto:twoolman at ontargettek.com)> wrote:
>
> Couldn't you convert the date columns to character type data in a data
> frame, and then convert those strings to factors in a 2nd step?
>
> The only downside I think to treating dates as factor levels is that
> you might have an awful lot of factors if you have a large enough
> dataset.
>
>
>
> Quoting "N. F. Parsons" <nathan.f.parsons at gmail.com>:
>
> > Hi all,
> >
> > If I have a tibble as follows:
> >
> > tibble(dates = c(rep("2021-07-04", 2), rep("2021-07-25", 3),
> > rep("2021-07-18", 4)))
> >
> > how in the world do I add a column that evaluates each of those dates and
> > assigns it a categorical value such that
> >
> > dates cycle
> > <chr> <chr>
> > 2021-07-04 1
> > 2021-07-04 1
> > 2021-07-25 3
> > 2021-07-25 3
> > 2021-07-25 3
> > 2021-07-18 2
> > 2021-07-18 2
> > 2021-07-18 2
> > 2021-07-18 2
> >
> > Not to further complicate matters, but some months I may only have one
> > date, and some months I will have 4 dates - so thats not a fixed quantity.
> > We've literally been doing this by hand at my job and I'd like to automate
> > it.
> >
> > Thanks in advance!
> >
> > Nate Parsons
> >
> > [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From twoo|m@n @end|ng |rom ont@rgettek@com  Thu Jul 22 05:56:40 2021
From: twoo|m@n @end|ng |rom ont@rgettek@com (Tom Woolman)
Date: Wed, 21 Jul 2021 23:56:40 -0400
Subject: [R] Assigning categorical values to dates
In-Reply-To: <b5dc3f68-fc47-4f6c-ad3b-aac57020e9ba@Canary>
References: <20210721232352.Horde.WCDlc-n6R4Mx1XEElkxF5Ka@www.ontargettek.com>
 <b5dc3f68-fc47-4f6c-ad3b-aac57020e9ba@Canary>
Message-ID: <20210721235640.Horde.tVpd29q1W3Aa04QMARS-8dX@www.ontargettek.com>

Not if you use as.factor to convert a character type column to factor  
levels. It should recode the distinct string values to factors  
automatically for you.

i.e.,

df$datefactors <- as.factor(df$datestrings)



Quoting "N. F. Parsons" <nathan.f.parsons at gmail.com>:

> I am not averse to a factor-based solution, but I would still have  
> to manually enter that factor each month, correct? If possible, I?d  
> just like to point R at that column and have it do the work.
>
> ?
> Nathan Parsons, B.SC, M.Sc, G.C.
>
> Ph.D. Candidate, Dept. of Sociology, Portland State University
> Adjunct Professor, Dept. of Sociology, Washington State University
> Graduate Advocate, American Association of University Professors (OR)
>
> Recent work  
> (https://www.researchgate.net/profile/Nathan_Parsons3/publications)
> Schedule an appointment (https://calendly.com/nate-parsons)
>
>> On Wednesday, Jul 21, 2021 at 8:30 PM, Tom Woolman  
>> <twoolman at ontargettek.com (mailto:twoolman at ontargettek.com)> wrote:
>>
>> Couldn't you convert the date columns to character type data in a data
>> frame, and then convert those strings to factors in a 2nd step?
>>
>> The only downside I think to treating dates as factor levels is that
>> you might have an awful lot of factors if you have a large enough
>> dataset.
>>
>>
>>
>> Quoting "N. F. Parsons" <nathan.f.parsons at gmail.com>:
>>
>> > Hi all,
>> >
>> > If I have a tibble as follows:
>> >
>> > tibble(dates = c(rep("2021-07-04", 2), rep("2021-07-25", 3),
>> > rep("2021-07-18", 4)))
>> >
>> > how in the world do I add a column that evaluates each of those dates and
>> > assigns it a categorical value such that
>> >
>> > dates cycle
>> > <chr> <chr>
>> > 2021-07-04 1
>> > 2021-07-04 1
>> > 2021-07-25 3
>> > 2021-07-25 3
>> > 2021-07-25 3
>> > 2021-07-18 2
>> > 2021-07-18 2
>> > 2021-07-18 2
>> > 2021-07-18 2
>> >
>> > Not to further complicate matters, but some months I may only have one
>> > date, and some months I will have 4 dates - so thats not a fixed quantity.
>> > We've literally been doing this by hand at my job and I'd like to automate
>> > it.
>> >
>> > Thanks in advance!
>> >
>> > Nate Parsons
>> >
>> > [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide  
>> http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Thu Jul 22 06:06:16 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 21 Jul 2021 21:06:16 -0700
Subject: [R] Assigning categorical values to dates
In-Reply-To: <b5dc3f68-fc47-4f6c-ad3b-aac57020e9ba@Canary>
References: <20210721232352.Horde.WCDlc-n6R4Mx1XEElkxF5Ka@www.ontargettek.com>
 <b5dc3f68-fc47-4f6c-ad3b-aac57020e9ba@Canary>
Message-ID: <CAGxFJbQxbjJ+QosfTX3LKAjzB8NR9XOT=WyB6SQJabyq=ycH7g@mail.gmail.com>

You have been told how to do it. If you do not understand, you should find
a suitable tutorial to learn about how R factors work. There are some
difficulties in converting dates on an ongoing basis to factors, so I think
you should take Tom's advice to rethink this. It sounds as if you might
also do well to find someone with more R experience to consult with... "How
in the world do  I..." does not inspire confidence that you know what you
are doing.

Cheers,
Bert



On Wed, Jul 21, 2021, 8:47 PM N. F. Parsons <nathan.f.parsons at gmail.com>
wrote:

> I am not averse to a factor-based solution, but I would still have to
> manually enter that factor each month, correct? If possible, I?d just like
> to point R at that column and have it do the work.
>
> ?
> Nathan Parsons, B.SC, M.Sc, G.C.
>
> Ph.D. Candidate, Dept. of Sociology, Portland State University
> Adjunct Professor, Dept. of Sociology, Washington State University
> Graduate Advocate, American Association of University Professors (OR)
>
> Recent work (
> https://www.researchgate.net/profile/Nathan_Parsons3/publications)
> Schedule an appointment (https://calendly.com/nate-parsons)
>
> > On Wednesday, Jul 21, 2021 at 8:30 PM, Tom Woolman <
> twoolman at ontargettek.com (mailto:twoolman at ontargettek.com)> wrote:
> >
> > Couldn't you convert the date columns to character type data in a data
> > frame, and then convert those strings to factors in a 2nd step?
> >
> > The only downside I think to treating dates as factor levels is that
> > you might have an awful lot of factors if you have a large enough
> > dataset.
> >
> >
> >
> > Quoting "N. F. Parsons" <nathan.f.parsons at gmail.com>:
> >
> > > Hi all,
> > >
> > > If I have a tibble as follows:
> > >
> > > tibble(dates = c(rep("2021-07-04", 2), rep("2021-07-25", 3),
> > > rep("2021-07-18", 4)))
> > >
> > > how in the world do I add a column that evaluates each of those dates
> and
> > > assigns it a categorical value such that
> > >
> > > dates cycle
> > > <chr> <chr>
> > > 2021-07-04 1
> > > 2021-07-04 1
> > > 2021-07-25 3
> > > 2021-07-25 3
> > > 2021-07-25 3
> > > 2021-07-18 2
> > > 2021-07-18 2
> > > 2021-07-18 2
> > > 2021-07-18 2
> > >
> > > Not to further complicate matters, but some months I may only have one
> > > date, and some months I will have 4 dates - so thats not a fixed
> quantity.
> > > We've literally been doing this by hand at my job and I'd like to
> automate
> > > it.
> > >
> > > Thanks in advance!
> > >
> > > Nate Parsons
> > >
> > > [[alternative HTML version deleted]]
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @pro @end|ng |rom un|me|b@edu@@u  Thu Jul 22 06:11:54 2021
From: @pro @end|ng |rom un|me|b@edu@@u (Andrew Robinson)
Date: Thu, 22 Jul 2021 04:11:54 +0000
Subject: [R] [EXT] Re:  Assigning categorical values to dates
In-Reply-To: <b5dc3f68-fc47-4f6c-ad3b-aac57020e9ba@Canary>
References: <20210721232352.Horde.WCDlc-n6R4Mx1XEElkxF5Ka@www.ontargettek.com>
 <b5dc3f68-fc47-4f6c-ad3b-aac57020e9ba@Canary>
Message-ID: <623ecb4b-b6ba-4d0a-be5f-52ea3c7de0be@Spark>

I wonder if you mean that you want the levels of the factor to reset within each month?  That is not obvious from your example, but implied by your question.

Andrew

--
Andrew Robinson
Director, CEBRA and Professor of Biosecurity,
School/s of BioSciences and Mathematics & Statistics
University of Melbourne, VIC 3010 Australia
Tel: (+61) 0403 138 955
Email: apro at unimelb.edu.au
Website: https://researchers.ms.unimelb.edu.au/~apro at unimelb/

I acknowledge the Traditional Owners of the land I inhabit, and pay my respects to their Elders.
On 22 Jul 2021, 1:47 PM +1000, N. F. Parsons <nathan.f.parsons at gmail.com>, wrote:
External email: Please exercise caution

I am not averse to a factor-based solution, but I would still have to manually enter that factor each month, correct? If possible, I?d just like to point R at that column and have it do the work.

?
Nathan Parsons, B.SC, M.Sc, G.C.

Ph.D. Candidate, Dept. of Sociology, Portland State University
Adjunct Professor, Dept. of Sociology, Washington State University
Graduate Advocate, American Association of University Professors (OR)

Recent work (https://www.researchgate.net/profile/Nathan_Parsons3/publications)
Schedule an appointment (https://calendly.com/nate-parsons)

On Wednesday, Jul 21, 2021 at 8:30 PM, Tom Woolman <twoolman at ontargettek.com (mailto:twoolman at ontargettek.com)> wrote:

Couldn't you convert the date columns to character type data in a data
frame, and then convert those strings to factors in a 2nd step?

The only downside I think to treating dates as factor levels is that
you might have an awful lot of factors if you have a large enough
dataset.



Quoting "N. F. Parsons" <nathan.f.parsons at gmail.com>:

Hi all,

If I have a tibble as follows:

tibble(dates = c(rep("2021-07-04", 2), rep("2021-07-25", 3),
rep("2021-07-18", 4)))

how in the world do I add a column that evaluates each of those dates and
assigns it a categorical value such that

dates cycle
<chr> <chr>
2021-07-04 1
2021-07-04 1
2021-07-25 3
2021-07-25 3
2021-07-25 3
2021-07-18 2
2021-07-18 2
2021-07-18 2
2021-07-18 2

Not to further complicate matters, but some months I may only have one
date, and some months I will have 4 dates - so thats not a fixed quantity.
We've literally been doing this by hand at my job and I'd like to automate
it.

Thanks in advance!

Nate Parsons

[[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

[[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


	[[alternative HTML version deleted]]


From n@th@n@|@p@r@on@ @end|ng |rom gm@||@com  Thu Jul 22 06:22:47 2021
From: n@th@n@|@p@r@on@ @end|ng |rom gm@||@com (N. F. Parsons)
Date: Wed, 21 Jul 2021 21:22:47 -0700
Subject: [R] [EXT] Re:  Assigning categorical values to dates
In-Reply-To: <623ecb4b-b6ba-4d0a-be5f-52ea3c7de0be@Spark>
References: <20210721232352.Horde.WCDlc-n6R4Mx1XEElkxF5Ka@www.ontargettek.com>
 <b5dc3f68-fc47-4f6c-ad3b-aac57020e9ba@Canary>
 <623ecb4b-b6ba-4d0a-be5f-52ea3c7de0be@Spark>
Message-ID: <6bf942ed-8702-493a-81ac-716d01064d4e@Canary>

@Tom Okay, yeah. That might actually be an elegant solution. I will mess around with it. Thank you - I?m not in the habit of using factors and am not super familiar with how they automatically sort themselves.

@Andrew Yes. Each month is a different 30,000 row file upon which this task must be performed.

@Bert If you?re not interested in being helpful, why comment? Am I interupting your clubhouse time? I?m legitimately stumped by this one and reaching out in earnest. ?You?ve been told how to do it? Seriously? We all have different backgrounds and knowledge levels with the entire atlas of the wonderful world of R and I neither need or want your opinion on my corner of it. Don?t be a Hooke. I?m not here to impress or inspire confidence in you - I?m here with a question that has had me spinning my wheels for the better part of a day and need fresh perspectives. Your response certainly inspires no confidence in me as to the nature of your character or your knowledge on the topic.

Best regards all,
?
Nathan Parsons, B.SC, M.Sc, G.C.

Ph.D. Candidate, Dept. of Sociology, Portland State University
Adjunct Professor, Dept. of Sociology, Washington State University
Graduate Advocate, American Association of University Professors (OR)

Recent work (https://www.researchgate.net/profile/Nathan_Parsons3/publications)
Schedule an appointment (https://calendly.com/nate-parsons)

> On Wednesday, Jul 21, 2021 at 9:12 PM, Andrew Robinson <apro at unimelb.edu.au (mailto:apro at unimelb.edu.au)> wrote:
> I wonder if you mean that you want the levels of the factor to reset within each month? That is not obvious from your example, but implied by your question.
>
> Andrew
>
>
> --
> Andrew Robinson
> Director, CEBRA and Professor of Biosecurity,
> School/s of BioSciences and Mathematics & Statistics
> University of Melbourne, VIC 3010 Australia
> Tel: (+61) 0403 138 955
> Email: apro at unimelb.edu.au
> Website: https://researchers.ms.unimelb.edu.au/~apro at unimelb/
>
> I acknowledge the Traditional Owners of the land I inhabit, and pay my respects to their Elders.
>
>
>
>
>
> On 22 Jul 2021, 1:47 PM +1000, N. F. Parsons <nathan.f.parsons at gmail.com>, wrote:
> > External email: Please exercise caution
> >
> > I am not averse to a factor-based solution, but I would still have to manually enter that factor each month, correct? If possible, I?d just like to point R at that column and have it do the work.
> >
> > ?
> > Nathan Parsons, B.SC, M.Sc, G.C.
> >
> > Ph.D. Candidate, Dept. of Sociology, Portland State University
> > Adjunct Professor, Dept. of Sociology, Washington State University
> > Graduate Advocate, American Association of University Professors (OR)
> >
> > Recent work (https://www.researchgate.net/profile/Nathan_Parsons3/publications)
> > Schedule an appointment (https://calendly.com/nate-parsons)
> >
> > > On Wednesday, Jul 21, 2021 at 8:30 PM, Tom Woolman <twoolman at ontargettek.com (mailto:twoolman at ontargettek.com)> wrote:
> > >
> > > Couldn't you convert the date columns to character type data in a data
> > > frame, and then convert those strings to factors in a 2nd step?
> > >
> > > The only downside I think to treating dates as factor levels is that
> > > you might have an awful lot of factors if you have a large enough
> > > dataset.
> > >
> > >
> > >
> > > Quoting "N. F. Parsons" <nathan.f.parsons at gmail.com>:
> > >
> > > > Hi all,
> > > >
> > > > If I have a tibble as follows:
> > > >
> > > > tibble(dates = c(rep("2021-07-04", 2), rep("2021-07-25", 3),
> > > > rep("2021-07-18", 4)))
> > > >
> > > > how in the world do I add a column that evaluates each of those dates and
> > > > assigns it a categorical value such that
> > > >
> > > > dates cycle
> > > > <chr> <chr>
> > > > 2021-07-04 1
> > > > 2021-07-04 1
> > > > 2021-07-25 3
> > > > 2021-07-25 3
> > > > 2021-07-25 3
> > > > 2021-07-18 2
> > > > 2021-07-18 2
> > > > 2021-07-18 2
> > > > 2021-07-18 2
> > > >
> > > > Not to further complicate matters, but some months I may only have one
> > > > date, and some months I will have 4 dates - so thats not a fixed quantity.
> > > > We've literally been doing this by hand at my job and I'd like to automate
> > > > it.
> > > >
> > > > Thanks in advance!
> > > >
> > > > Nate Parsons
> > > >
> > > > [[alternative HTML version deleted]]
> > > >
> > > > ______________________________________________
> > > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > > > and provide commented, minimal, self-contained, reproducible code.
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> >
> > [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >

	[[alternative HTML version deleted]]


From twoo|m@n @end|ng |rom ont@rgettek@com  Thu Jul 22 06:28:23 2021
From: twoo|m@n @end|ng |rom ont@rgettek@com (Tom Woolman)
Date: Thu, 22 Jul 2021 00:28:23 -0400
Subject: [R] [EXT] Re:  Assigning categorical values to dates
In-Reply-To: <6bf942ed-8702-493a-81ac-716d01064d4e@Canary>
References: <20210721232352.Horde.WCDlc-n6R4Mx1XEElkxF5Ka@www.ontargettek.com>
 <b5dc3f68-fc47-4f6c-ad3b-aac57020e9ba@Canary>
 <623ecb4b-b6ba-4d0a-be5f-52ea3c7de0be@Spark>
 <6bf942ed-8702-493a-81ac-716d01064d4e@Canary>
Message-ID: <20210722002823.Horde.sNbVVszshy07FM88SvCvf7K@www.ontargettek.com>

Sure thing. Typically with date related measures I'm going to build a  
time series model e.g. ARIMA or maybe something more funky like a  
recurrent neural net via Tensorflow. But in theory there's no reason  
dates can't be factors if it's in keeping with your particular design  
of experiment and you want to perform an analysis that treats time as  
qualitative data.



Quoting "N. F. Parsons" <nathan.f.parsons at gmail.com>:

> @Tom Okay, yeah. That might actually be an elegant solution. I will  
> mess around with it. Thank you - I?m not in the habit of using  
> factors and am not super familiar with how they automatically sort  
> themselves.
>
> @Andrew Yes. Each month is a different 30,000 row file upon which  
> this task must be performed.
>
> @Bert If you?re not interested in being helpful, why comment? Am I  
> interupting your clubhouse time? I?m legitimately stumped by this  
> one and reaching out in earnest. ?You?ve been told how to do it?  
> Seriously? We all have different backgrounds and knowledge levels  
> with the entire atlas of the wonderful world of R and I neither need  
> or want your opinion on my corner of it. Don?t be a Hooke. I?m not  
> here to impress or inspire confidence in you - I?m here with a  
> question that has had me spinning my wheels for the better part of a  
> day and need fresh perspectives. Your response certainly inspires no  
> confidence in me as to the nature of your character or your  
> knowledge on the topic.
>
> Best regards all,
> ?
> Nathan Parsons, B.SC, M.Sc, G.C.
>
> Ph.D. Candidate, Dept. of Sociology, Portland State University
> Adjunct Professor, Dept. of Sociology, Washington State University
> Graduate Advocate, American Association of University Professors (OR)
>
> Recent work  
> (https://www.researchgate.net/profile/Nathan_Parsons3/publications)
> Schedule an appointment (https://calendly.com/nate-parsons)
>
>> On Wednesday, Jul 21, 2021 at 9:12 PM, Andrew Robinson  
>> <apro at unimelb.edu.au (mailto:apro at unimelb.edu.au)> wrote:
>> I wonder if you mean that you want the levels of the factor to  
>> reset within each month? That is not obvious from your example, but  
>> implied by your question.
>>
>> Andrew
>>
>>
>> --
>> Andrew Robinson
>> Director, CEBRA and Professor of Biosecurity,
>> School/s of BioSciences and Mathematics & Statistics
>> University of Melbourne, VIC 3010 Australia
>> Tel: (+61) 0403 138 955
>> Email: apro at unimelb.edu.au
>> Website: https://researchers.ms.unimelb.edu.au/~apro at unimelb/
>>
>> I acknowledge the Traditional Owners of the land I inhabit, and pay  
>> my respects to their Elders.
>>
>>
>>
>>
>>
>> On 22 Jul 2021, 1:47 PM +1000, N. F. Parsons  
>> <nathan.f.parsons at gmail.com>, wrote:
>> > External email: Please exercise caution
>> >
>> > I am not averse to a factor-based solution, but I would still  
>> have to manually enter that factor each month, correct? If  
>> possible, I?d just like to point R at that column and have it do  
>> the work.
>> >
>> > ?
>> > Nathan Parsons, B.SC, M.Sc, G.C.
>> >
>> > Ph.D. Candidate, Dept. of Sociology, Portland State University
>> > Adjunct Professor, Dept. of Sociology, Washington State University
>> > Graduate Advocate, American Association of University Professors (OR)
>> >
>> > Recent work  
>> (https://www.researchgate.net/profile/Nathan_Parsons3/publications)
>> > Schedule an appointment (https://calendly.com/nate-parsons)
>> >
>> > > On Wednesday, Jul 21, 2021 at 8:30 PM, Tom Woolman  
>> <twoolman at ontargettek.com (mailto:twoolman at ontargettek.com)> wrote:
>> > >
>> > > Couldn't you convert the date columns to character type data in a data
>> > > frame, and then convert those strings to factors in a 2nd step?
>> > >
>> > > The only downside I think to treating dates as factor levels is that
>> > > you might have an awful lot of factors if you have a large enough
>> > > dataset.
>> > >
>> > >
>> > >
>> > > Quoting "N. F. Parsons" <nathan.f.parsons at gmail.com>:
>> > >
>> > > > Hi all,
>> > > >
>> > > > If I have a tibble as follows:
>> > > >
>> > > > tibble(dates = c(rep("2021-07-04", 2), rep("2021-07-25", 3),
>> > > > rep("2021-07-18", 4)))
>> > > >
>> > > > how in the world do I add a column that evaluates each of  
>> those dates and
>> > > > assigns it a categorical value such that
>> > > >
>> > > > dates cycle
>> > > > <chr> <chr>
>> > > > 2021-07-04 1
>> > > > 2021-07-04 1
>> > > > 2021-07-25 3
>> > > > 2021-07-25 3
>> > > > 2021-07-25 3
>> > > > 2021-07-18 2
>> > > > 2021-07-18 2
>> > > > 2021-07-18 2
>> > > > 2021-07-18 2
>> > > >
>> > > > Not to further complicate matters, but some months I may only have one
>> > > > date, and some months I will have 4 dates - so thats not a  
>> fixed quantity.
>> > > > We've literally been doing this by hand at my job and I'd  
>> like to automate
>> > > > it.
>> > > >
>> > > > Thanks in advance!
>> > > >
>> > > > Nate Parsons
>> > > >
>> > > > [[alternative HTML version deleted]]
>> > > >
>> > > > ______________________________________________
>> > > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > > > https://stat.ethz.ch/mailman/listinfo/r-help
>> > > > PLEASE do read the posting guide  
>> http://www.R-project.org/posting-guide.html
>> > > > and provide commented, minimal, self-contained, reproducible code.
>> > >
>> > > ______________________________________________
>> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > > https://stat.ethz.ch/mailman/listinfo/r-help
>> > > PLEASE do read the posting guide  
>> http://www.R-project.org/posting-guide.html
>> > > and provide commented, minimal, self-contained, reproducible code.
>> >
>> > [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide  
>> http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>> >


From g||ted|||e2014 @end|ng |rom gm@||@com  Thu Jul 22 07:52:19 2021
From: g||ted|||e2014 @end|ng |rom gm@||@com (Ogbos Okike)
Date: Thu, 22 Jul 2021 06:52:19 +0100
Subject: [R] THANK YOU ALL
Message-ID: <CAC8ss31hV5uU3X28gqDh1kutW_cTD62vVzdT64=7r=9d9gXxtw@mail.gmail.com>

Dear Friends,
I have been scarce here. This is because I am busy implementing what I have
learned from you. You seem to have answered all my queries and I have not
got any new ones. I will quickly contact you as soon as I encounter
challenges in my analysis.

I hope you are well.

I have two recent publications resulting from your assistance (
https://doi.org/10.3847/1538-4357/abfe60, and https://rdcu.be/cpmyg). I
tried to share the complete pdf of the first work but the Journal did not
allow that.

If you can find time to look at the acknowledgment section, you will note
that your efforts were dully acknowledged.

I will ever remain indebted to the group. I consider it plagiarism to
publish any work without indicating my source of analysis tools.

I hope you continue to devote your time to assist the world and humanity in
general. I am sure that many people value your help.

Many, many thanks.

With the warmest regards
Ogbos

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Jul 22 08:54:09 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 22 Jul 2021 07:54:09 +0100
Subject: [R] Assigning categorical values to dates
In-Reply-To: <b5dc3f68-fc47-4f6c-ad3b-aac57020e9ba@Canary>
References: <20210721232352.Horde.WCDlc-n6R4Mx1XEElkxF5Ka@www.ontargettek.com>
 <b5dc3f68-fc47-4f6c-ad3b-aac57020e9ba@Canary>
Message-ID: <6e9c0aa6-bed8-6c43-cb08-2f049d98fbbf@sapo.pt>

Hello,

Here are 3 solutions, one of them the coercion to factor one.
Since you are using tibbles, I assume you also want a dplyr solution.


library(dplyr)

df1 <- tibble(dates = c(rep("2021-07-04", 2),
                         rep("2021-07-25", 3),
                         rep("2021-07-18", 4)))

# base R
as.integer(factor(df1$dates))
match(df1$dates, unique(sort(df1$dates)))

# dplyr
df1 %>% group_by(dates) %>% mutate(cycle = cur_group_id())


My favorite is by far the 1st but that's a matter of opinion.


Hope this helps,

Rui Barradas


?s 04:46 de 22/07/21, N. F. Parsons escreveu:
> I am not averse to a factor-based solution, but I would still have to manually enter that factor each month, correct? If possible, I?d just like to point R at that column and have it do the work.
> 
> ?
> Nathan Parsons, B.SC, M.Sc, G.C.
> 
> Ph.D. Candidate, Dept. of Sociology, Portland State University
> Adjunct Professor, Dept. of Sociology, Washington State University
> Graduate Advocate, American Association of University Professors (OR)
> 
> Recent work (https://www.researchgate.net/profile/Nathan_Parsons3/publications)
> Schedule an appointment (https://calendly.com/nate-parsons)
> 
>> On Wednesday, Jul 21, 2021 at 8:30 PM, Tom Woolman <twoolman at ontargettek.com (mailto:twoolman at ontargettek.com)> wrote:
>>
>> Couldn't you convert the date columns to character type data in a data
>> frame, and then convert those strings to factors in a 2nd step?
>>
>> The only downside I think to treating dates as factor levels is that
>> you might have an awful lot of factors if you have a large enough
>> dataset.
>>
>>
>>
>> Quoting "N. F. Parsons" <nathan.f.parsons at gmail.com>:
>>
>>> Hi all,
>>>
>>> If I have a tibble as follows:
>>>
>>> tibble(dates = c(rep("2021-07-04", 2), rep("2021-07-25", 3),
>>> rep("2021-07-18", 4)))
>>>
>>> how in the world do I add a column that evaluates each of those dates and
>>> assigns it a categorical value such that
>>>
>>> dates cycle
>>> <chr> <chr>
>>> 2021-07-04 1
>>> 2021-07-04 1
>>> 2021-07-25 3
>>> 2021-07-25 3
>>> 2021-07-25 3
>>> 2021-07-18 2
>>> 2021-07-18 2
>>> 2021-07-18 2
>>> 2021-07-18 2
>>>
>>> Not to further complicate matters, but some months I may only have one
>>> date, and some months I will have 4 dates - so thats not a fixed quantity.
>>> We've literally been doing this by hand at my job and I'd like to automate
>>> it.
>>>
>>> Thanks in advance!
>>>
>>> Nate Parsons
>>>
>>> [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From er|ch@@ub@ @end|ng |rom neuw|rth@pr|v@@t  Thu Jul 22 08:54:18 2021
From: er|ch@@ub@ @end|ng |rom neuw|rth@pr|v@@t (Erich Subscriptions)
Date: Thu, 22 Jul 2021 08:54:18 +0200
Subject: [R] Assigning categorical values to dates
In-Reply-To: <b5dc3f68-fc47-4f6c-ad3b-aac57020e9ba@Canary>
References: <20210721232352.Horde.WCDlc-n6R4Mx1XEElkxF5Ka@www.ontargettek.com>
 <b5dc3f68-fc47-4f6c-ad3b-aac57020e9ba@Canary>
Message-ID: <B6FC6FE6-8272-4CE5-AA72-334FEECA7679@neuwirth.priv.at>

date_df <- tibble(dates = c(rep("2021-07-04", 2), rep("2021-07-25", 3),
rep("2021-07-18", 4)))



cycle_from_date <-   function(date,dates){
  dates |>
    unique() |>
    sort() ->
    ranks
  match(date,ranks)
}

date_df |>
  mutate(cycle_new=cycle_from_date(dates,dates))


> On 22.07.2021, at 05:46, N. F. Parsons <nathan.f.parsons at gmail.com> wrote:
> 
>>> tibble(dates = c(rep("2021-07-04", 2), rep("2021-07-25", 3),
>>> rep("2021-07-18", 4)))


From n@th@n@|@p@r@on@ @end|ng |rom gm@||@com  Thu Jul 22 08:58:24 2021
From: n@th@n@|@p@r@on@ @end|ng |rom gm@||@com (N. F. Parsons)
Date: Wed, 21 Jul 2021 23:58:24 -0700
Subject: [R] Assigning categorical values to dates
In-Reply-To: <6e9c0aa6-bed8-6c43-cb08-2f049d98fbbf@sapo.pt>
References: <20210721232352.Horde.WCDlc-n6R4Mx1XEElkxF5Ka@www.ontargettek.com>
 <b5dc3f68-fc47-4f6c-ad3b-aac57020e9ba@Canary>
 <6e9c0aa6-bed8-6c43-cb08-2f049d98fbbf@sapo.pt>
Message-ID: <e4e9fc6f-11c0-4d61-bae5-1100090a3a40@Canary>

I had no idea that ?cur_group_id()? existed!?!! Will definitely try that. Thank you!!!

?
Nathan Parsons, B.SC, M.Sc, G.C.

Ph.D. Candidate, Dept. of Sociology, Portland State University
Adjunct Professor, Dept. of Sociology, Washington State University
Graduate Advocate, American Association of University Professors (OR)

Recent work (https://www.researchgate.net/profile/Nathan_Parsons3/publications)
Schedule an appointment (https://calendly.com/nate-parsons)

> On Wednesday, Jul 21, 2021 at 11:54 PM, Rui Barradas <ruipbarradas at sapo.pt (mailto:ruipbarradas at sapo.pt)> wrote:
> Hello,
>
> Here are 3 solutions, one of them the coercion to factor one.
> Since you are using tibbles, I assume you also want a dplyr solution.
>
>
> library(dplyr)
>
> df1 <- tibble(dates = c(rep("2021-07-04", 2),
> rep("2021-07-25", 3),
> rep("2021-07-18", 4)))
>
> # base R
> as.integer(factor(df1$dates))
> match(df1$dates, unique(sort(df1$dates)))
>
> # dplyr
> df1 %>% group_by(dates) %>% mutate(cycle = cur_group_id())
>
>
> My favorite is by far the 1st but that's a matter of opinion.
>
>
> Hope this helps,
>
> Rui Barradas
>
>
> ?s 04:46 de 22/07/21, N. F. Parsons escreveu:
> > I am not averse to a factor-based solution, but I would still have to manually enter that factor each month, correct? If possible, I?d just like to point R at that column and have it do the work.
> >
> > ?
> > Nathan Parsons, B.SC, M.Sc, G.C.
> >
> > Ph.D. Candidate, Dept. of Sociology, Portland State University
> > Adjunct Professor, Dept. of Sociology, Washington State University
> > Graduate Advocate, American Association of University Professors (OR)
> >
> > Recent work (https://www.researchgate.net/profile/Nathan_Parsons3/publications)
> > Schedule an appointment (https://calendly.com/nate-parsons)
> >
> > > On Wednesday, Jul 21, 2021 at 8:30 PM, Tom Woolman <twoolman at ontargettek.com (mailto:twoolman at ontargettek.com)> wrote:
> > >
> > > Couldn't you convert the date columns to character type data in a data
> > > frame, and then convert those strings to factors in a 2nd step?
> > >
> > > The only downside I think to treating dates as factor levels is that
> > > you might have an awful lot of factors if you have a large enough
> > > dataset.
> > >
> > >
> > >
> > > Quoting "N. F. Parsons" <nathan.f.parsons at gmail.com>:
> > >
> > > > Hi all,
> > > >
> > > > If I have a tibble as follows:
> > > >
> > > > tibble(dates = c(rep("2021-07-04", 2), rep("2021-07-25", 3),
> > > > rep("2021-07-18", 4)))
> > > >
> > > > how in the world do I add a column that evaluates each of those dates and
> > > > assigns it a categorical value such that
> > > >
> > > > dates cycle
> > > > <chr> <chr>
> > > > 2021-07-04 1
> > > > 2021-07-04 1
> > > > 2021-07-25 3
> > > > 2021-07-25 3
> > > > 2021-07-25 3
> > > > 2021-07-18 2
> > > > 2021-07-18 2
> > > > 2021-07-18 2
> > > > 2021-07-18 2
> > > >
> > > > Not to further complicate matters, but some months I may only have one
> > > > date, and some months I will have 4 dates - so thats not a fixed quantity.
> > > > We've literally been doing this by hand at my job and I'd like to automate
> > > > it.
> > > >
> > > > Thanks in advance!
> > > >
> > > > Nate Parsons
> > > >
> > > > [[alternative HTML version deleted]]
> > > >
> > > > ______________________________________________
> > > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > > > and provide commented, minimal, self-contained, reproducible code.
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> >
> > [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Jul 22 09:49:22 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 22 Jul 2021 08:49:22 +0100
Subject: [R] Assigning categorical values to dates
In-Reply-To: <B6FC6FE6-8272-4CE5-AA72-334FEECA7679@neuwirth.priv.at>
References: <20210721232352.Horde.WCDlc-n6R4Mx1XEElkxF5Ka@www.ontargettek.com>
 <b5dc3f68-fc47-4f6c-ad3b-aac57020e9ba@Canary>
 <B6FC6FE6-8272-4CE5-AA72-334FEECA7679@neuwirth.priv.at>
Message-ID: <f78079ce-f183-1bff-7c1a-5acff3481883@sapo.pt>

Hello,

Great function!
Here is a simplified, (hopefully) more general version.


seq_from_group <- function(x){
   x |>
     unique() |>
     sort() |> (\(ranks) match(x, ranks))()
}

date_df |>
   mutate(cycle = seq_from_group(dates))



With ?interaction it works with more than one column.



df2 <- data.frame(
   X = c(rep("a", 4), rep("b", 5)),
   Y = c(rep(1, 2), rep(3,3), rep(2, 4))
)

df2 |>
   mutate(cnt = seq_from_group(interaction(X, Y)))



Hope this helps,

Rui Barradas


?s 07:54 de 22/07/21, Erich Subscriptions escreveu:
> date_df <- tibble(dates = c(rep("2021-07-04", 2), rep("2021-07-25", 3),
> rep("2021-07-18", 4)))
> 
> 
> 
> cycle_from_date <-   function(date,dates){
>    dates |>
>      unique() |>
>      sort() ->
>      ranks
>    match(date,ranks)
> }
> 
> date_df |>
>    mutate(cycle_new=cycle_from_date(dates,dates))
> 
> 
>> On 22.07.2021, at 05:46, N. F. Parsons <nathan.f.parsons at gmail.com> wrote:
>>
>>>> tibble(dates = c(rep("2021-07-04", 2), rep("2021-07-25", 3),
>>>> rep("2021-07-18", 4)))
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Thu Jul 22 10:11:02 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Thu, 22 Jul 2021 10:11:02 +0200
Subject: [R] Assigning categorical values to dates
In-Reply-To: <CANdqJqcQ8AYa3_YeUcY8nBruq1rTycEMVLcy_fdvxc9FinKtRA@mail.gmail.com>
References: <CANdqJqcQ8AYa3_YeUcY8nBruq1rTycEMVLcy_fdvxc9FinKtRA@mail.gmail.com>
Message-ID: <81645c62-bdeb-314b-dbf2-2f24e673953b@statistik.tu-dortmund.de>

For a data.frame d, I'd simply do

d$cycle <- factor(d$dates, labels=1:3)

but I have not  idea about tibbles.


Best,
Uwe Ligges


On 22.07.2021 05:12, N. F. Parsons wrote:
> Hi all,
> 
> If I have a tibble as follows:
> 
> tibble(dates = c(rep("2021-07-04", 2),  rep("2021-07-25", 3),
> rep("2021-07-18", 4)))
> 
> how in the world do I add a column that evaluates each of those dates and
> assigns it a categorical value such that
> 
> dates                cycle
> <chr>               <chr>
> 2021-07-04      1
> 2021-07-04      1
> 2021-07-25      3
> 2021-07-25      3
> 2021-07-25      3
> 2021-07-18      2
> 2021-07-18      2
> 2021-07-18      2
> 2021-07-18      2
> 
> Not to further complicate matters, but some months I may only have one
> date, and some months I will have 4 dates - so thats not a fixed quantity.
> We've literally been doing this by hand at my job and I'd like to automate
> it.
> 
> Thanks in advance!
> 
> Nate Parsons
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From er|cjberger @end|ng |rom gm@||@com  Thu Jul 22 13:13:28 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Thu, 22 Jul 2021 14:13:28 +0300
Subject: [R] Assigning categorical values to dates
In-Reply-To: <81645c62-bdeb-314b-dbf2-2f24e673953b@statistik.tu-dortmund.de>
References: <CANdqJqcQ8AYa3_YeUcY8nBruq1rTycEMVLcy_fdvxc9FinKtRA@mail.gmail.com>
 <81645c62-bdeb-314b-dbf2-2f24e673953b@statistik.tu-dortmund.de>
Message-ID: <CAGgJW742ieEcBZEHQjzV+445_w586fF7zXuQJEYaOtGnoq7jpw@mail.gmail.com>

While the base R solution using 'factor' appears to win based on elegance,
chapeau to the creativity of the other suggestions.
For those who are not aware, R 4.1.0 introduced two features: (1) native
pipe |> and (2) new shorter syntax for anonymous functions.
Erich's suggestion used the native pipe and Rui went with the spirit and
added an anonymous function using the new syntax.

Everyone has their preferred coding style. I tend to prefer fewer lines of
code (if there is no cost in understanding).
I think the new anonymous function syntax helps in this regard and I see no
reason to use piping if not necessary.
So here is a modified, one-line version of Rui's last suggestion (sans the
amazing observation about handling interactions).

mutate(date_df, cycle=(\(ranks) match(dates, ranks))(sort(unique(dates))))

Eric




On Thu, Jul 22, 2021 at 11:11 AM Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

> For a data.frame d, I'd simply do
>
> d$cycle <- factor(d$dates, labels=1:3)
>
> but I have not  idea about tibbles.
>
>
> Best,
> Uwe Ligges
>
>
> On 22.07.2021 05:12, N. F. Parsons wrote:
> > Hi all,
> >
> > If I have a tibble as follows:
> >
> > tibble(dates = c(rep("2021-07-04", 2),  rep("2021-07-25", 3),
> > rep("2021-07-18", 4)))
> >
> > how in the world do I add a column that evaluates each of those dates and
> > assigns it a categorical value such that
> >
> > dates                cycle
> > <chr>               <chr>
> > 2021-07-04      1
> > 2021-07-04      1
> > 2021-07-25      3
> > 2021-07-25      3
> > 2021-07-25      3
> > 2021-07-18      2
> > 2021-07-18      2
> > 2021-07-18      2
> > 2021-07-18      2
> >
> > Not to further complicate matters, but some months I may only have one
> > date, and some months I will have 4 dates - so thats not a fixed
> quantity.
> > We've literally been doing this by hand at my job and I'd like to
> automate
> > it.
> >
> > Thanks in advance!
> >
> > Nate Parsons
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From n@th@n@|@p@r@on@ @end|ng |rom gm@||@com  Thu Jul 22 22:15:57 2021
From: n@th@n@|@p@r@on@ @end|ng |rom gm@||@com (N. F. Parsons)
Date: Thu, 22 Jul 2021 13:15:57 -0700
Subject: [R] Assigning categorical values to dates
In-Reply-To: <CAGgJW742ieEcBZEHQjzV+445_w586fF7zXuQJEYaOtGnoq7jpw@mail.gmail.com>
References: <CANdqJqcQ8AYa3_YeUcY8nBruq1rTycEMVLcy_fdvxc9FinKtRA@mail.gmail.com>
 <81645c62-bdeb-314b-dbf2-2f24e673953b@statistik.tu-dortmund.de>
 <CAGgJW742ieEcBZEHQjzV+445_w586fF7zXuQJEYaOtGnoq7jpw@mail.gmail.com>
Message-ID: <CANdqJqes4=F-nA2k9J2azgOseMOPAcTQYO4KS4L6U8TLFciU3w@mail.gmail.com>

Thank you all so much for your time and your help! I am truly grateful for
the suggested solutions, but more importantly, for the lessons!

Nate Parsons


On Thu, Jul 22, 2021 at 4:13 AM Eric Berger <ericjberger at gmail.com> wrote:

> While the base R solution using 'factor' appears to win based on elegance,
> chapeau to the creativity of the other suggestions.
> For those who are not aware, R 4.1.0 introduced two features: (1) native
> pipe |> and (2) new shorter syntax for anonymous functions.
> Erich's suggestion used the native pipe and Rui went with the spirit and
> added an anonymous function using the new syntax.
>
> Everyone has their preferred coding style. I tend to prefer fewer lines of
> code (if there is no cost in understanding).
> I think the new anonymous function syntax helps in this regard and I see
> no reason to use piping if not necessary.
> So here is a modified, one-line version of Rui's last suggestion (sans the
> amazing observation about handling interactions).
>
> mutate(date_df, cycle=(\(ranks) match(dates,
> ranks))(sort(unique(dates))))
>
> Eric
>
>
>
>
> On Thu, Jul 22, 2021 at 11:11 AM Uwe Ligges <
> ligges at statistik.tu-dortmund.de> wrote:
>
>> For a data.frame d, I'd simply do
>>
>> d$cycle <- factor(d$dates, labels=1:3)
>>
>> but I have not  idea about tibbles.
>>
>>
>> Best,
>> Uwe Ligges
>>
>>
>> On 22.07.2021 05:12, N. F. Parsons wrote:
>> > Hi all,
>> >
>> > If I have a tibble as follows:
>> >
>> > tibble(dates = c(rep("2021-07-04", 2),  rep("2021-07-25", 3),
>> > rep("2021-07-18", 4)))
>> >
>> > how in the world do I add a column that evaluates each of those dates
>> and
>> > assigns it a categorical value such that
>> >
>> > dates                cycle
>> > <chr>               <chr>
>> > 2021-07-04      1
>> > 2021-07-04      1
>> > 2021-07-25      3
>> > 2021-07-25      3
>> > 2021-07-25      3
>> > 2021-07-18      2
>> > 2021-07-18      2
>> > 2021-07-18      2
>> > 2021-07-18      2
>> >
>> > Not to further complicate matters, but some months I may only have one
>> > date, and some months I will have 4 dates - so thats not a fixed
>> quantity.
>> > We've literally been doing this by hand at my job and I'd like to
>> automate
>> > it.
>> >
>> > Thanks in advance!
>> >
>> > Nate Parsons
>> >
>> >       [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>> >
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From jcub|c @end|ng |rom onet@p|  Fri Jul 23 19:21:03 2021
From: jcub|c @end|ng |rom onet@p| (Jakub T. Jankiewicz)
Date: Fri, 23 Jul 2021 19:21:03 +0200
Subject: [R] Problem with reference Class that may be a bug in R
Message-ID: <20210723192103.2d1fb569@jcubic>

Hi,

I wanted to report a bug in R but was told without investigating that it's
probably my code have a bug. Note that references classes are not used
extensively (they were replaced by R6 in shiny because they are pain in the
neck).

The problem I've found looks like this:

I have two packages PackageA and PackageB in PackageA method of refClass I
have a call a function and I extend that method in PackageB and call super.
The problem is that R doesn't see the function in PackageA.

Code:

#' @export Foo
#' @exportClass Foo
Foo <- setRefClass(
  Class = "Foo",
  methods = list(
    foo = function(x) {
      message(paste(x, "[1]"))
    },
    bar = function(x) {
      lorem(x)
    }
  )
)



#' @export Bar
#' @exportClass Bar
Bar <- setRefClass(
  Class = "Bar",
  contains = "Foo",
  methods = list(
    foo = function(x) {
      callSuper(x)
      ipsum(x)
    },
    bar = function(x) {
      callSuper(x)
      ipsum(x)
    }
  )
)


In packageB R see functions ipsum local to the package but in it doesn't see
the function lorem in packageB when called from different package.

This is way to simple code to have bug in it.

You can see the code on this repo: https://github.com/jcubic/refClass with
explanation of the problem. This have nothing to do with importing since I
only need to import a class not a function that can be hidden. And there are
no problems in reference base class from packageA because I have:

Depends: packageA

in DESCRIPTION.

I have someone can check this, and confirm that this is a bug, but basically
when I've send this to request permission to add a bug to ask for help first,
even that I have experienced R developers in my Team that confirmed that this
is a bug in reference classes.

Best
Jakub

--
Jakub T. Jankiewicz, Web Developer
https://jcubic.pl/me


From neh@@bo|ogn@90 @end|ng |rom gm@||@com  Sat Jul 24 13:38:28 2021
From: neh@@bo|ogn@90 @end|ng |rom gm@||@com (Neha gupta)
Date: Sat, 24 Jul 2021 13:38:28 +0200
Subject: [R] How to select rows, not in sequence
Message-ID: <CA+nrPns=Hv8ytFZT0j4pXc6Vr7h_e+wWzkrB2++e1E8uQ9MG1w@mail.gmail.com>

Hi

If I have to select specific rows and all columns of a dataframe, I use:

rows= df[1:12 , ]

However, how to select rows if our required rows are not in sequence i.e.
if we need to select row numbers 1,2,5,7, and 12..

Warm regards

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Jul 24 13:50:57 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 24 Jul 2021 12:50:57 +0100
Subject: [R] How to select rows, not in sequence
In-Reply-To: <CA+nrPns=Hv8ytFZT0j4pXc6Vr7h_e+wWzkrB2++e1E8uQ9MG1w@mail.gmail.com>
References: <CA+nrPns=Hv8ytFZT0j4pXc6Vr7h_e+wWzkrB2++e1E8uQ9MG1w@mail.gmail.com>
Message-ID: <b4b90650-e1c0-d313-5a18-80067e12be3f@sapo.pt>

Hello,

Simply by also passing a vector to the extraction function:


rows= df[c(1,2,5,7,12) , ]


Hope this helps,

Rui Barradas

?s 12:38 de 24/07/21, Neha gupta escreveu:
> Hi
> 
> If I have to select specific rows and all columns of a dataframe, I use:
> 
> rows= df[1:12 , ]
> 
> However, how to select rows if our required rows are not in sequence i.e.
> if we need to select row numbers 1,2,5,7, and 12..
> 
> Warm regards
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From neh@@bo|ogn@90 @end|ng |rom gm@||@com  Sat Jul 24 13:58:57 2021
From: neh@@bo|ogn@90 @end|ng |rom gm@||@com (Neha gupta)
Date: Sat, 24 Jul 2021 13:58:57 +0200
Subject: [R] How to select rows, not in sequence
In-Reply-To: <b4b90650-e1c0-d313-5a18-80067e12be3f@sapo.pt>
References: <CA+nrPns=Hv8ytFZT0j4pXc6Vr7h_e+wWzkrB2++e1E8uQ9MG1w@mail.gmail.com>
 <b4b90650-e1c0-d313-5a18-80067e12be3f@sapo.pt>
Message-ID: <CA+nrPnud7gz_EU7wb=z_=VE=G5E=q0YTa25YQubkZdFUPr2W6w@mail.gmail.com>

Thanks a lot Sir, indeed it resolved my issue.

Warm regards

On Sat, Jul 24, 2021 at 1:51 PM Rui Barradas <ruipbarradas at sapo.pt> wrote:

> Hello,
>
> Simply by also passing a vector to the extraction function:
>
>
> rows= df[c(1,2,5,7,12) , ]
>
>
> Hope this helps,
>
> Rui Barradas
>
> ?s 12:38 de 24/07/21, Neha gupta escreveu:
> > Hi
> >
> > If I have to select specific rows and all columns of a dataframe, I use:
> >
> > rows= df[1:12 , ]
> >
> > However, how to select rows if our required rows are not in sequence i.e.
> > if we need to select row numbers 1,2,5,7, and 12..
> >
> > Warm regards
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>

	[[alternative HTML version deleted]]


From re|chm@nj @end|ng |rom @bcg|ob@|@net  Sat Jul 24 15:18:49 2021
From: re|chm@nj @end|ng |rom @bcg|ob@|@net (Jeff Reichman)
Date: Sat, 24 Jul 2021 08:18:49 -0500
Subject: [R] Converting a list to a data frame
References: <000c01d7808e$71492790$53db76b0$.ref@sbcglobal.net>
Message-ID: <000c01d7808e$71492790$53db76b0$@sbcglobal.net>

How does one convert a list into a data frame?

 

> str(weight_chains)

List of 1

$ : 'mcmc' num [1:100000, 1:3] -105 -105 -105 -104 -103 ...

  ..- attr(*, "dimnames")=List of 2

  .. ..$ : NULL

  .. ..$ : chr [1:3] "a" "b" "s"

  ..- attr(*, "mcpar")= num [1:3] 1001 101000 1

- attr(*, "class")= chr "mcmc.list"

 

Such that ..

 

> 

weight_chains



               a         b         s  

1     -104.72512 1.0141407  9.369227

2     -104.52297 1.0167432  9.131354

3     -104.72669 1.0139528  9.219877

 


	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Sat Jul 24 16:34:27 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 24 Jul 2021 07:34:27 -0700
Subject: [R] Converting a list to a data frame
In-Reply-To: <000c01d7808e$71492790$53db76b0$@sbcglobal.net>
References: <000c01d7808e$71492790$53db76b0$.ref@sbcglobal.net>
 <000c01d7808e$71492790$53db76b0$@sbcglobal.net>
Message-ID: <CAGxFJbT=CNbrreqa8xQXvjn8cNuYsY7+2FcUL-XoXavkaxQCSA@mail.gmail.com>

Here is a reprex that does what I think you want:

ex <- list(mcmc = matrix(1:12, ncol = 3, byrow=TRUE),
           NULL, c("a","b", "s"))

dex <- data.frame(ex$mcmc)
names(dex) <- ex[[3]]

> dex
   a  b  s
1  1  2  3
2  4  5  6
3  7  8  9
4 10 11 12

If this is not correct, you should provide a **plain text** reprex.

Of course, even if correct, this is not a template. The exact process will
depend on the structure of the list.

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Sat, Jul 24, 2021 at 6:19 AM Jeff Reichman <reichmanj at sbcglobal.net>
wrote:

> How does one convert a list into a data frame?
>
>
>
> > str(weight_chains)
>
> List of 1
>
> $ : 'mcmc' num [1:100000, 1:3] -105 -105 -105 -104 -103 ...
>
>   ..- attr(*, "dimnames")=List of 2
>
>   .. ..$ : NULL
>
>   .. ..$ : chr [1:3] "a" "b" "s"
>
>   ..- attr(*, "mcpar")= num [1:3] 1001 101000 1
>
> - attr(*, "class")= chr "mcmc.list"
>
>
>
> Such that ..
>
>
>
> >
>
> weight_chains
>
>
>
>                a         b         s
>
> 1     -104.72512 1.0141407  9.369227
>
> 2     -104.52297 1.0167432  9.131354
>
> 3     -104.72669 1.0139528  9.219877
>
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From b|nt@oc @end|ng |rom y@hoo@com@@u  Sat Jul 24 13:19:41 2021
From: b|nt@oc @end|ng |rom y@hoo@com@@u (Bintao Cui)
Date: Sat, 24 Jul 2021 11:19:41 +0000 (UTC)
Subject: [R] Makefile error
References: <516869572.699094.1627125581061.ref@mail.yahoo.com>
Message-ID: <516869572.699094.1627125581061@mail.yahoo.com>

Makefile.in:87: *** missing separator.? Stop. 

I am trying to install R-4.1.0 version to fedora, and got the error above, please help!
Thanks.

With regards,Bintao



From @kw@|mmo @end|ng |rom gm@||@com  Sat Jul 24 17:22:14 2021
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Sat, 24 Jul 2021 11:22:14 -0400
Subject: [R] Testing for R CMD INSTALL
Message-ID: <CAPcHnpS-JsR7o7r7c3DkJBX4TOdQ8CZcs+LqgJ4RiZ3TXxJanQ@mail.gmail.com>

Hello,


I was wondering if anyone has a way to test if a package is currently being
installed. My solution was to check if environment variable "R_INSTALL_PKG"
was unset, something like:

"R CMD INSTALL-ing" <- function ()
!is.na(Sys.getenv("R_INSTALL_PKG", NA))

Unfortunately, I couldn't find what I was looking for with ?"environment
variables". So if anyone has any better methods, I'd be happy to hear them,
thank you!

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Sat Jul 24 18:05:20 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sat, 24 Jul 2021 18:05:20 +0200
Subject: [R] Makefile error
In-Reply-To: <516869572.699094.1627125581061@mail.yahoo.com>
References: <516869572.699094.1627125581061.ref@mail.yahoo.com>
 <516869572.699094.1627125581061@mail.yahoo.com>
Message-ID: <20210724180520.6517c02a@trisector>

On Sat, 24 Jul 2021 11:19:41 +0000 (UTC)
Bintao Cui via R-help <r-help at r-project.org> wrote:

> Makefile.in:87: *** missing separator.? Stop. 

Thanks for showing us the error message, but this isn't enough
information. In order to be able to help, we also need to know what
exactly you did to get the error message.

See also: http://www.catb.org/~esr/faqs/smart-questions.html

> I am trying to install R-4.1.0 version to fedora

And you're building from source because there doesn't seem to be
R-4.1.0 in the repos? I think you can install R-4.1.0 from Rawhide.

See also: the mailing list about R in Fedora:
https://stat.ethz.ch/mailman/listinfo/r-sig-fedora
This list is about programming in R language, so perhaps your question
would be better addressed there.

-- 
Best regards,
Ivan


From bgunter@4567 @end|ng |rom gm@||@com  Sat Jul 24 18:07:16 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 24 Jul 2021 09:07:16 -0700
Subject: [R] Testing for R CMD INSTALL
In-Reply-To: <CAPcHnpS-JsR7o7r7c3DkJBX4TOdQ8CZcs+LqgJ4RiZ3TXxJanQ@mail.gmail.com>
References: <CAPcHnpS-JsR7o7r7c3DkJBX4TOdQ8CZcs+LqgJ4RiZ3TXxJanQ@mail.gmail.com>
Message-ID: <CAGxFJbQRC7eH1_qiqS5f+TvzF4JfTFLThkaGo4YtDqONssPf0g@mail.gmail.com>

Does ?installed.packages help?

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Sat, Jul 24, 2021 at 8:30 AM Andrew Simmons <akwsimmo at gmail.com> wrote:

> Hello,
>
>
> I was wondering if anyone has a way to test if a package is currently being
> installed. My solution was to check if environment variable "R_INSTALL_PKG"
> was unset, something like:
>
> "R CMD INSTALL-ing" <- function ()
> !is.na(Sys.getenv("R_INSTALL_PKG", NA))
>
> Unfortunately, I couldn't find what I was looking for with ?"environment
> variables". So if anyone has any better methods, I'd be happy to hear them,
> thank you!
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Jul 24 18:34:18 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 24 Jul 2021 12:34:18 -0400
Subject: [R] Testing for R CMD INSTALL
In-Reply-To: <CAPcHnpS-JsR7o7r7c3DkJBX4TOdQ8CZcs+LqgJ4RiZ3TXxJanQ@mail.gmail.com>
References: <CAPcHnpS-JsR7o7r7c3DkJBX4TOdQ8CZcs+LqgJ4RiZ3TXxJanQ@mail.gmail.com>
Message-ID: <f925d9b7-8835-8080-edbd-c7627b3dd999@gmail.com>

On 24/07/2021 11:22 a.m., Andrew Simmons wrote:
> Hello,
> 
> 
> I was wondering if anyone has a way to test if a package is currently being
> installed. My solution was to check if environment variable "R_INSTALL_PKG"
> was unset, something like:
> 
> "R CMD INSTALL-ing" <- function ()
> !is.na(Sys.getenv("R_INSTALL_PKG", NA))
> 
> Unfortunately, I couldn't find what I was looking for with ?"environment
> variables". So if anyone has any better methods, I'd be happy to hear them,
> thank you!

Normally if you want to execute special code during installation, you'd 
add a Makevars or Makefile to your package and do it there, but 
R_INSTALL_PKG should be defined during a source install.

I believe that no code from the package is executed during a binary 
install:  it just copies files into the appropriate places.

Duncan


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Jul 24 18:39:36 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 24 Jul 2021 17:39:36 +0100
Subject: [R] Converting a list to a data frame
In-Reply-To: <000c01d7808e$71492790$53db76b0$@sbcglobal.net>
References: <000c01d7808e$71492790$53db76b0$.ref@sbcglobal.net>
 <000c01d7808e$71492790$53db76b0$@sbcglobal.net>
Message-ID: <b9f17bc0-9c8c-7822-26de-9f572b40429b@sapo.pt>

Hello,

This should do it:


as.data.frame(weight_chains$mcmc)


The only list member already has a dim attribute of length 2 and 
dimnames' 2nd member are the colnames, just coerce to df.

Hope this helps,

Rui Barradas

?s 14:18 de 24/07/21, Jeff Reichman escreveu:
> How does one convert a list into a data frame?
> 
>   
> 
>> str(weight_chains)
> 
> List of 1
> 
> $ : 'mcmc' num [1:100000, 1:3] -105 -105 -105 -104 -103 ...
> 
>    ..- attr(*, "dimnames")=List of 2
> 
>    .. ..$ : NULL
> 
>    .. ..$ : chr [1:3] "a" "b" "s"
> 
>    ..- attr(*, "mcpar")= num [1:3] 1001 101000 1
> 
> - attr(*, "class")= chr "mcmc.list"
> 
>   
> 
> Such that ..
> 
>   
> 
>>
> 
> weight_chains
> 
> 
> 
>                 a         b         s
> 
> 1     -104.72512 1.0141407  9.369227
> 
> 2     -104.52297 1.0167432  9.131354
> 
> 3     -104.72669 1.0139528  9.219877
> 
>   
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Jul 24 19:02:34 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 24 Jul 2021 13:02:34 -0400
Subject: [R] Converting a list to a data frame
In-Reply-To: <000c01d7808e$71492790$53db76b0$@sbcglobal.net>
References: <000c01d7808e$71492790$53db76b0$.ref@sbcglobal.net>
 <000c01d7808e$71492790$53db76b0$@sbcglobal.net>
Message-ID: <e484830d-081e-d60e-d442-d5c51e18f423@gmail.com>

Others have shown you how to extract the matrix and convert it to a 
dataframe.  My only addition is to suggest that you don't do this: 
matrix methods are often much more efficient than dataframe methods, so 
if you can work with the matrix without conversion, you'll often find 
things run a lot faster.

Duncan Murdoch

On 24/07/2021 9:18 a.m., Jeff Reichman wrote:
> How does one convert a list into a data frame?
> 
>   
> 
>> str(weight_chains)
> 
> List of 1
> 
> $ : 'mcmc' num [1:100000, 1:3] -105 -105 -105 -104 -103 ...
> 
>    ..- attr(*, "dimnames")=List of 2
> 
>    .. ..$ : NULL
> 
>    .. ..$ : chr [1:3] "a" "b" "s"
> 
>    ..- attr(*, "mcpar")= num [1:3] 1001 101000 1
> 
> - attr(*, "class")= chr "mcmc.list"
> 
>   
> 
> Such that ..
> 
>   
> 
>>
> 
> weight_chains
> 
> 
> 
>                 a         b         s
> 
> 1     -104.72512 1.0141407  9.369227
> 
> 2     -104.52297 1.0167432  9.131354
> 
> 3     -104.72669 1.0139528  9.219877
> 
>   
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From tg@77m @end|ng |rom y@hoo@com  Sat Jul 24 20:41:05 2021
From: tg@77m @end|ng |rom y@hoo@com (Thomas Subia)
Date: Sat, 24 Jul 2021 11:41:05 -0700
Subject: [R] Sin curve question
References: <000901d780bb$771985c0$654c9140$.ref@yahoo.com>
Message-ID: <000901d780bb$771985c0$654c9140$@yahoo.com>

Colleagues,

Here is my code which plots sin(x) vs x, for angles between 0 and 180
degrees.

library(ggplot2)
library(REdaS)
copdat$degrees <- c(0,45,90,135,180)
copdat$radians <- deg2rad(copdat$degrees)
copdat$sin_x <- sin(copdat$radians)

ggplot(copdat,aes(x=degrees,y=sin_x))+
  geom_point(size = 2)+ geom_line()+
  theme_cowplot()+xlab("x")+
  ylab("sin(x)")+
  scale_x_continuous(breaks=seq(0,180,30))+
  ggtitle("sin(x) vs x\nx is in degrees")

My trig students would prefer a curved line plot similar to what can be
plotted with Excel smooth line functionality.
I wanted to provide a relatively simple R script using ggplot to do this
without having to resort to fitting a sine curve to these points.

Some guidance would be appreciated.


From j@ork|n @end|ng |rom @om@um@ry|@nd@edu  Sat Jul 24 20:51:32 2021
From: j@ork|n @end|ng |rom @om@um@ry|@nd@edu (Sorkin, John)
Date: Sat, 24 Jul 2021 18:51:32 +0000
Subject: [R] Sin curve question
In-Reply-To: <000901d780bb$771985c0$654c9140$@yahoo.com>
References: <000901d780bb$771985c0$654c9140$.ref@yahoo.com>,
 <000901d780bb$771985c0$654c9140$@yahoo.com>
Message-ID: <64BE2C80-D309-4E96-91AA-CE7C0F4C7C06@som.umaryland.edu>

Try something like the following

copdat$degrees <- c(1:180)

John David Sorkin M.D., Ph.D.
Professor of Medicine
Chief, Biostatistics and Informatics
University of Maryland School of Medicine Division of Gerontology and Geriatric Medicine
Baltimore VA Medical Center
10 North Greene Street<x-apple-data-detectors://12>
GRECC<x-apple-data-detectors://12> (BT/18/GR)
Baltimore, MD 21201-1524<x-apple-data-detectors://13/0>
(Phone) 410-605-711<tel:410-605-7119>9
(Fax) 410-605-7913<tel:410-605-7913> (Please call phone number above prior to faxing)

On Jul 24, 2021, at 2:41 PM, Thomas Subia via R-help <r-help at r-project.org> wrote:

?Colleagues,

Here is my code which plots sin(x) vs x, for angles between 0 and 180
degrees.

library(ggplot2)
library(REdaS)
copdat$degrees <- c(0,45,90,135,180)
copdat$radians <- deg2rad(copdat$degrees)
copdat$sin_x <- sin(copdat$radians)

ggplot(copdat,aes(x=degrees,y=sin_x))+
 geom_point(size = 2)+ geom_line()+
 theme_cowplot()+xlab("x")+
 ylab("sin(x)")+
 scale_x_continuous(breaks=seq(0,180,30))+
 ggtitle("sin(x) vs x\nx is in degrees")

My trig students would prefer a curved line plot similar to what can be
plotted with Excel smooth line functionality.
I wanted to provide a relatively simple R script using ggplot to do this
without having to resort to fitting a sine curve to these points.

Some guidance would be appreciated.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C1ffa4922f2ba41588da908d94ed2a982%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637627488997910453%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=90qApIoS6rwqkQuKPzy3x2AUPntuJ2W%2FtJgPGfiddEI%3D&amp;reserved=0
PLEASE do read the posting guide https://nam11.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C1ffa4922f2ba41588da908d94ed2a982%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637627488997910453%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=s9YIcjlEo4MvI6hcX%2FkV4gwJJKa172QrPEnHsqTiRa8%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Sat Jul 24 21:04:09 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Sat, 24 Jul 2021 22:04:09 +0300
Subject: [R] Sin curve question
In-Reply-To: <64BE2C80-D309-4E96-91AA-CE7C0F4C7C06@som.umaryland.edu>
References: <000901d780bb$771985c0$654c9140$.ref@yahoo.com>
 <000901d780bb$771985c0$654c9140$@yahoo.com>
 <64BE2C80-D309-4E96-91AA-CE7C0F4C7C06@som.umaryland.edu>
Message-ID: <CAGgJW76=xTYRbZhorU6JJ+MZ3SRH1cKPc33Zrm0ps_Y+3couBQ@mail.gmail.com>

Alternatively with base graphics

N <- 500 ## number of points (arbitrary)
degrees <- seq(from=0,to=180,length=N)
degreesToRadians <- function(d) { pi * d / 180.0}  ## vectorIzed!
plot(x=degrees,y=sin(degreesToRadians(degrees)),type='l',
     xlab="x",ylab="sin(x)",main="sin(x) vs x\nx is in degrees")


On Sat, Jul 24, 2021 at 9:52 PM Sorkin, John <jsorkin at som.umaryland.edu>
wrote:

> Try something like the following
>
> copdat$degrees <- c(1:180)
>
> John David Sorkin M.D., Ph.D.
> Professor of Medicine
> Chief, Biostatistics and Informatics
> University of Maryland School of Medicine Division of Gerontology and
> Geriatric Medicine
> Baltimore VA Medical Center
> 10 North Greene Street<x-apple-data-detectors://12>
> GRECC<x-apple-data-detectors://12> (BT/18/GR)
> Baltimore, MD 21201-1524<x-apple-data-detectors://13/0>
> (Phone) 410-605-711<tel:410-605-7119>9
> (Fax) 410-605-7913<tel:410-605-7913> (Please call phone number above prior
> to faxing)
>
> On Jul 24, 2021, at 2:41 PM, Thomas Subia via R-help <r-help at r-project.org>
> wrote:
>
> ?Colleagues,
>
> Here is my code which plots sin(x) vs x, for angles between 0 and 180
> degrees.
>
> library(ggplot2)
> library(REdaS)
> copdat$degrees <- c(0,45,90,135,180)
> copdat$radians <- deg2rad(copdat$degrees)
> copdat$sin_x <- sin(copdat$radians)
>
> ggplot(copdat,aes(x=degrees,y=sin_x))+
>  geom_point(size = 2)+ geom_line()+
>  theme_cowplot()+xlab("x")+
>  ylab("sin(x)")+
>  scale_x_continuous(breaks=seq(0,180,30))+
>  ggtitle("sin(x) vs x\nx is in degrees")
>
> My trig students would prefer a curved line plot similar to what can be
> plotted with Excel smooth line functionality.
> I wanted to provide a relatively simple R script using ggplot to do this
> without having to resort to fitting a sine curve to these points.
>
> Some guidance would be appreciated.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>
> https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C1ffa4922f2ba41588da908d94ed2a982%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637627488997910453%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=90qApIoS6rwqkQuKPzy3x2AUPntuJ2W%2FtJgPGfiddEI%3D&amp;reserved=0
> PLEASE do read the posting guide
> https://nam11.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C1ffa4922f2ba41588da908d94ed2a982%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637627488997910453%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=s9YIcjlEo4MvI6hcX%2FkV4gwJJKa172QrPEnHsqTiRa8%3D&amp;reserved=0
> and provide commented, minimal, self-contained, reproducible code.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sat Jul 24 21:18:33 2021
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sat, 24 Jul 2021 14:18:33 -0500
Subject: [R] Sin curve question
In-Reply-To: <CAGgJW76=xTYRbZhorU6JJ+MZ3SRH1cKPc33Zrm0ps_Y+3couBQ@mail.gmail.com>
References: <000901d780bb$771985c0$654c9140$.ref@yahoo.com>
 <000901d780bb$771985c0$654c9140$@yahoo.com>
 <64BE2C80-D309-4E96-91AA-CE7C0F4C7C06@som.umaryland.edu>
 <CAGgJW76=xTYRbZhorU6JJ+MZ3SRH1cKPc33Zrm0ps_Y+3couBQ@mail.gmail.com>
Message-ID: <8e2f8ba8-d5b7-c8c2-3443-8782429b4921@effectivedefense.org>

plot(sin, to=pi) # also works but with x labeled in radians.


# With x axis labeled in degrees
plot(sin, to=pi, axes=FALSE)
axis(2)
lbls <- seq(0, 180, 30)
axis(1, pi*lbls/180, lbls)


	  This can probably be done in ggplot2, but I don't know how off the 
top of my head.


	  Hope this helps.
	  Spencer
	

On 7/24/21 2:04 PM, Eric Berger wrote:
> Alternatively with base graphics
> 
> N <- 500 ## number of points (arbitrary)
> degrees <- seq(from=0,to=180,length=N)
> degreesToRadians <- function(d) { pi * d / 180.0}  ## vectorIzed!
> plot(x=degrees,y=sin(degreesToRadians(degrees)),type='l',
>       xlab="x",ylab="sin(x)",main="sin(x) vs x\nx is in degrees")
> 
> 
> On Sat, Jul 24, 2021 at 9:52 PM Sorkin, John <jsorkin at som.umaryland.edu>
> wrote:
> 
>> Try something like the following
>>
>> copdat$degrees <- c(1:180)
>>
>> John David Sorkin M.D., Ph.D.
>> Professor of Medicine
>> Chief, Biostatistics and Informatics
>> University of Maryland School of Medicine Division of Gerontology and
>> Geriatric Medicine
>> Baltimore VA Medical Center
>> 10 North Greene Street<x-apple-data-detectors://12>
>> GRECC<x-apple-data-detectors://12> (BT/18/GR)
>> Baltimore, MD 21201-1524<x-apple-data-detectors://13/0>
>> (Phone) 410-605-711<tel:410-605-7119>9
>> (Fax) 410-605-7913<tel:410-605-7913> (Please call phone number above prior
>> to faxing)
>>
>> On Jul 24, 2021, at 2:41 PM, Thomas Subia via R-help <r-help at r-project.org>
>> wrote:
>>
>> ?Colleagues,
>>
>> Here is my code which plots sin(x) vs x, for angles between 0 and 180
>> degrees.
>>
>> library(ggplot2)
>> library(REdaS)
>> copdat$degrees <- c(0,45,90,135,180)
>> copdat$radians <- deg2rad(copdat$degrees)
>> copdat$sin_x <- sin(copdat$radians)
>>
>> ggplot(copdat,aes(x=degrees,y=sin_x))+
>>   geom_point(size = 2)+ geom_line()+
>>   theme_cowplot()+xlab("x")+
>>   ylab("sin(x)")+
>>   scale_x_continuous(breaks=seq(0,180,30))+
>>   ggtitle("sin(x) vs x\nx is in degrees")
>>
>> My trig students would prefer a curved line plot similar to what can be
>> plotted with Excel smooth line functionality.
>> I wanted to provide a relatively simple R script using ggplot to do this
>> without having to resort to fitting a sine curve to these points.
>>
>> Some guidance would be appreciated.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>
>> https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C1ffa4922f2ba41588da908d94ed2a982%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637627488997910453%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=90qApIoS6rwqkQuKPzy3x2AUPntuJ2W%2FtJgPGfiddEI%3D&amp;reserved=0
>> PLEASE do read the posting guide
>> https://nam11.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C1ffa4922f2ba41588da908d94ed2a982%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637627488997910453%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=s9YIcjlEo4MvI6hcX%2FkV4gwJJKa172QrPEnHsqTiRa8%3D&amp;reserved=0
>> and provide commented, minimal, self-contained, reproducible code.
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sat Jul 24 21:42:51 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sat, 24 Jul 2021 12:42:51 -0700
Subject: [R] Sin curve question
In-Reply-To: <000901d780bb$771985c0$654c9140$@yahoo.com>
References: <000901d780bb$771985c0$654c9140$.ref@yahoo.com>
 <000901d780bb$771985c0$654c9140$@yahoo.com>
Message-ID: <4663023A-C478-43D4-BA9D-56D0C31B2FFB@dcn.davis.ca.us>

This is not excel-help, but to the best of my knowledge Excel interpolates with splines when you select curved point interpolation.

R, being primarily a science tool rather than a business tool, assumes you want to be precise about how new points are to be interpolated between original data points. Thus, the task of building the spline and deciding how close the points in that interpolation need to be is typically left to the user. If the user knows that the points are part of a periodic continuous function and extrapolation is desired, then choosing a fourier series may be a better choice than a spline. But the data you have provided is insufficient to support a fourier analysis, so there is some sophisticated math in between you and your goal unless you build in heuristics about how to interpolate within these points, or just live with whatever a spline function will give you... but the choice is yours to make.

On July 24, 2021 11:41:05 AM PDT, Thomas Subia via R-help <r-help at r-project.org> wrote:
>Colleagues,
>
>Here is my code which plots sin(x) vs x, for angles between 0 and 180
>degrees.
>
>library(ggplot2)
>library(REdaS)
>copdat$degrees <- c(0,45,90,135,180)
>copdat$radians <- deg2rad(copdat$degrees)
>copdat$sin_x <- sin(copdat$radians)
>
>ggplot(copdat,aes(x=degrees,y=sin_x))+
>  geom_point(size = 2)+ geom_line()+
>  theme_cowplot()+xlab("x")+
>  ylab("sin(x)")+
>  scale_x_continuous(breaks=seq(0,180,30))+
>  ggtitle("sin(x) vs x\nx is in degrees")
>
>My trig students would prefer a curved line plot similar to what can be
>plotted with Excel smooth line functionality.
>I wanted to provide a relatively simple R script using ggplot to do
>this
>without having to resort to fitting a sine curve to these points.
>
>Some guidance would be appreciated.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Jul 24 21:49:18 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 24 Jul 2021 20:49:18 +0100
Subject: [R] Sin curve question
In-Reply-To: <000901d780bb$771985c0$654c9140$@yahoo.com>
References: <000901d780bb$771985c0$654c9140$.ref@yahoo.com>
 <000901d780bb$771985c0$654c9140$@yahoo.com>
Message-ID: <39d469db-1c4b-0399-d941-e883cb2db92a@sapo.pt>

Hello,

You can use stat_function, it will take care of all the details, all you 
have to do is to pass xlim.


library(ggplot2)
library(cowplot)

ggplot() +
   stat_function(fun = sin, xlim = c(0, pi)) +
   xlab("x") +
   ylab("sin(x)") +
   scale_x_continuous(breaks = seq(0, pi, pi/6), labels = seq(0, 180, 30)) +
   ggtitle("sin(x) vs x", subtitle = "x is in degrees") +
   theme_cowplot()


Hope this helps,

Rui Barradas

?s 19:41 de 24/07/21, Thomas Subia via R-help escreveu:
> Colleagues,
> 
> Here is my code which plots sin(x) vs x, for angles between 0 and 180
> degrees.
> 
> library(ggplot2)
> library(REdaS)
> copdat$degrees <- c(0,45,90,135,180)
> copdat$radians <- deg2rad(copdat$degrees)
> copdat$sin_x <- sin(copdat$radians)
> 
> ggplot(copdat,aes(x=degrees,y=sin_x))+
>    geom_point(size = 2)+ geom_line()+
>    theme_cowplot()+xlab("x")+
>    ylab("sin(x)")+
>    scale_x_continuous(breaks=seq(0,180,30))+
>    ggtitle("sin(x) vs x\nx is in degrees")
> 
> My trig students would prefer a curved line plot similar to what can be
> plotted with Excel smooth line functionality.
> I wanted to provide a relatively simple R script using ggplot to do this
> without having to resort to fitting a sine curve to these points.
> 
> Some guidance would be appreciated.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From re|chm@nj @end|ng |rom @bcg|ob@|@net  Sat Jul 24 23:31:22 2021
From: re|chm@nj @end|ng |rom @bcg|ob@|@net (Jeff Reichman)
Date: Sat, 24 Jul 2021 16:31:22 -0500
Subject: [R] Converting a list to a data frame
In-Reply-To: <e484830d-081e-d60e-d442-d5c51e18f423@gmail.com>
References: <000c01d7808e$71492790$53db76b0$.ref@sbcglobal.net>
 <000c01d7808e$71492790$53db76b0$@sbcglobal.net>
 <e484830d-081e-d60e-d442-d5c51e18f423@gmail.com>
Message-ID: <003e01d780d3$410a5550$c31efff0$@sbcglobal.net>

Duncan

I need to plot the results (ggplot2) and I'm thinking I can only use a data.frame object in ggplot2. It is a rath r large "list" over 1 million rows. It is possible to work with a matrix in ggplot2?

Jeff

-----Original Message-----
From: Duncan Murdoch <murdoch.duncan at gmail.com> 
Sent: Saturday, July 24, 2021 12:03 PM
To: reichmanj at sbcglobal.net; R-help at r-project.org
Subject: Re: [R] Converting a list to a data frame

Others have shown you how to extract the matrix and convert it to a dataframe.  My only addition is to suggest that you don't do this: 
matrix methods are often much more efficient than dataframe methods, so if you can work with the matrix without conversion, you'll often find things run a lot faster.

Duncan Murdoch

On 24/07/2021 9:18 a.m., Jeff Reichman wrote:
> How does one convert a list into a data frame?
> 
>   
> 
>> str(weight_chains)
> 
> List of 1
> 
> $ : 'mcmc' num [1:100000, 1:3] -105 -105 -105 -104 -103 ...
> 
>    ..- attr(*, "dimnames")=List of 2
> 
>    .. ..$ : NULL
> 
>    .. ..$ : chr [1:3] "a" "b" "s"
> 
>    ..- attr(*, "mcpar")= num [1:3] 1001 101000 1
> 
> - attr(*, "class")= chr "mcmc.list"
> 
>   
> 
> Such that ..
> 
>   
> 
>>
> 
> weight_chains
> 
> 
> 
>                 a         b         s
> 
> 1     -104.72512 1.0141407  9.369227
> 
> 2     -104.52297 1.0167432  9.131354
> 
> 3     -104.72669 1.0139528  9.219877
> 
>   
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
> 


From re|chm@nj @end|ng |rom @bcg|ob@|@net  Sat Jul 24 23:32:06 2021
From: re|chm@nj @end|ng |rom @bcg|ob@|@net (Jeff Reichman)
Date: Sat, 24 Jul 2021 16:32:06 -0500
Subject: [R] Converting a list to a data frame
In-Reply-To: <b9f17bc0-9c8c-7822-26de-9f572b40429b@sapo.pt>
References: <000c01d7808e$71492790$53db76b0$.ref@sbcglobal.net>
 <000c01d7808e$71492790$53db76b0$@sbcglobal.net>
 <b9f17bc0-9c8c-7822-26de-9f572b40429b@sapo.pt>
Message-ID: <003f01d780d3$5b1c38f0$1154aad0$@sbcglobal.net>

Thanks for the tips

-----Original Message-----
From: Rui Barradas <ruipbarradas at sapo.pt> 
Sent: Saturday, July 24, 2021 11:40 AM
To: reichmanj at sbcglobal.net; R-help at r-project.org
Subject: Re: [R] Converting a list to a data frame

Hello,

This should do it:


as.data.frame(weight_chains$mcmc)


The only list member already has a dim attribute of length 2 and dimnames' 2nd member are the colnames, just coerce to df.

Hope this helps,

Rui Barradas

?s 14:18 de 24/07/21, Jeff Reichman escreveu:
> How does one convert a list into a data frame?
> 
>   
> 
>> str(weight_chains)
> 
> List of 1
> 
> $ : 'mcmc' num [1:100000, 1:3] -105 -105 -105 -104 -103 ...
> 
>    ..- attr(*, "dimnames")=List of 2
> 
>    .. ..$ : NULL
> 
>    .. ..$ : chr [1:3] "a" "b" "s"
> 
>    ..- attr(*, "mcpar")= num [1:3] 1001 101000 1
> 
> - attr(*, "class")= chr "mcmc.list"
> 
>   
> 
> Such that ..
> 
>   
> 
>>
> 
> weight_chains
> 
> 
> 
>                 a         b         s
> 
> 1     -104.72512 1.0141407  9.369227
> 
> 2     -104.52297 1.0167432  9.131354
> 
> 3     -104.72669 1.0139528  9.219877
> 
>   
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
> 


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Jul 24 23:40:05 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 24 Jul 2021 22:40:05 +0100
Subject: [R] Converting a list to a data frame
In-Reply-To: <003e01d780d3$410a5550$c31efff0$@sbcglobal.net>
References: <000c01d7808e$71492790$53db76b0$.ref@sbcglobal.net>
 <000c01d7808e$71492790$53db76b0$@sbcglobal.net>
 <e484830d-081e-d60e-d442-d5c51e18f423@gmail.com>
 <003e01d780d3$410a5550$c31efff0$@sbcglobal.net>
Message-ID: <cb38b52b-1da7-6356-fb2a-919eb2add529@sapo.pt>

Hello,

No, it's not possible to work with a matrix in ggplot2.
Not even with an object of class "list".



l <- list(x=1:5, y=1:5)
d <- as.data.frame(l)
m <- as.matrix(d)

library(ggplot2)
ggplot(l, aes(x, y)) + geom_point()  # Error
ggplot(d, aes(x, y)) + geom_point()  # OK, as expected
ggplot(m, aes(x, y)) + geom_point()  # Error



Hope this helps,

Rui Barradas


?s 22:31 de 24/07/21, Jeff Reichman escreveu:
> Duncan
> 
> I need to plot the results (ggplot2) and I'm thinking I can only use a data.frame object in ggplot2. It is a rath r large "list" over 1 million rows. It is possible to work with a matrix in ggplot2?
> 
> Jeff
> 
> -----Original Message-----
> From: Duncan Murdoch <murdoch.duncan at gmail.com>
> Sent: Saturday, July 24, 2021 12:03 PM
> To: reichmanj at sbcglobal.net; R-help at r-project.org
> Subject: Re: [R] Converting a list to a data frame
> 
> Others have shown you how to extract the matrix and convert it to a dataframe.  My only addition is to suggest that you don't do this:
> matrix methods are often much more efficient than dataframe methods, so if you can work with the matrix without conversion, you'll often find things run a lot faster.
> 
> Duncan Murdoch
> 
> On 24/07/2021 9:18 a.m., Jeff Reichman wrote:
>> How does one convert a list into a data frame?
>>
>>    
>>
>>> str(weight_chains)
>>
>> List of 1
>>
>> $ : 'mcmc' num [1:100000, 1:3] -105 -105 -105 -104 -103 ...
>>
>>     ..- attr(*, "dimnames")=List of 2
>>
>>     .. ..$ : NULL
>>
>>     .. ..$ : chr [1:3] "a" "b" "s"
>>
>>     ..- attr(*, "mcpar")= num [1:3] 1001 101000 1
>>
>> - attr(*, "class")= chr "mcmc.list"
>>
>>    
>>
>> Such that ..
>>
>>    
>>
>>>
>>
>> weight_chains
>>
>>
>>
>>                  a         b         s
>>
>> 1     -104.72512 1.0141407  9.369227
>>
>> 2     -104.52297 1.0167432  9.131354
>>
>> 3     -104.72669 1.0139528  9.219877
>>
>>    
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Jul 25 01:27:04 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 24 Jul 2021 19:27:04 -0400
Subject: [R] Converting a list to a data frame
In-Reply-To: <cb38b52b-1da7-6356-fb2a-919eb2add529@sapo.pt>
References: <000c01d7808e$71492790$53db76b0$.ref@sbcglobal.net>
 <000c01d7808e$71492790$53db76b0$@sbcglobal.net>
 <e484830d-081e-d60e-d442-d5c51e18f423@gmail.com>
 <003e01d780d3$410a5550$c31efff0$@sbcglobal.net>
 <cb38b52b-1da7-6356-fb2a-919eb2add529@sapo.pt>
Message-ID: <d9ee01dc-27a7-38d5-c0ec-55a39d14765a@gmail.com>

On 24/07/2021 5:40 p.m., Rui Barradas wrote:
> Hello,
> 
> No, it's not possible to work with a matrix in ggplot2.
> Not even with an object of class "list".

If that's the main thing Jeff is doing, then he should convert to a 
dataframe.  But it *is* possible to work with the original matrix in 
ggplot2, just not very natural:
> 
> 
> 
> l <- list(x=1:5, y=1:5)
> d <- as.data.frame(l)
> m <- as.matrix(d)
> 
> library(ggplot2)
> ggplot(l, aes(x, y)) + geom_point()  # Error
> ggplot(d, aes(x, y)) + geom_point()  # OK, as expected
> ggplot(m, aes(x, y)) + geom_point()  # Error

ggplot(NULL, aes(x=m[,"x"], y=m[,"y"])) + geom_point() # OK

Duncan Murdoch

> 
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> 
> ?s 22:31 de 24/07/21, Jeff Reichman escreveu:
>> Duncan
>>
>> I need to plot the results (ggplot2) and I'm thinking I can only use a data.frame object in ggplot2. It is a rath r large "list" over 1 million rows. It is possible to work with a matrix in ggplot2?
>>
>> Jeff
>>
>> -----Original Message-----
>> From: Duncan Murdoch <murdoch.duncan at gmail.com>
>> Sent: Saturday, July 24, 2021 12:03 PM
>> To: reichmanj at sbcglobal.net; R-help at r-project.org
>> Subject: Re: [R] Converting a list to a data frame
>>
>> Others have shown you how to extract the matrix and convert it to a dataframe.  My only addition is to suggest that you don't do this:
>> matrix methods are often much more efficient than dataframe methods, so if you can work with the matrix without conversion, you'll often find things run a lot faster.
>>
>> Duncan Murdoch
>>
>> On 24/07/2021 9:18 a.m., Jeff Reichman wrote:
>>> How does one convert a list into a data frame?
>>>
>>>     
>>>
>>>> str(weight_chains)
>>>
>>> List of 1
>>>
>>> $ : 'mcmc' num [1:100000, 1:3] -105 -105 -105 -104 -103 ...
>>>
>>>      ..- attr(*, "dimnames")=List of 2
>>>
>>>      .. ..$ : NULL
>>>
>>>      .. ..$ : chr [1:3] "a" "b" "s"
>>>
>>>      ..- attr(*, "mcpar")= num [1:3] 1001 101000 1
>>>
>>> - attr(*, "class")= chr "mcmc.list"
>>>
>>>     
>>>
>>> Such that ..
>>>
>>>     
>>>
>>>>
>>>
>>> weight_chains
>>>
>>>
>>>
>>>                   a         b         s
>>>
>>> 1     -104.72512 1.0141407  9.369227
>>>
>>> 2     -104.52297 1.0167432  9.131354
>>>
>>> 3     -104.72669 1.0139528  9.219877
>>>
>>>     
>>>
>>>
>>> 	[[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>


From er|ch@@ub@ @end|ng |rom neuw|rth@pr|v@@t  Mon Jul 26 01:52:47 2021
From: er|ch@@ub@ @end|ng |rom neuw|rth@pr|v@@t (Erich Subscriptions)
Date: Mon, 26 Jul 2021 01:52:47 +0200
Subject: [R] Sin curve question
In-Reply-To: <000901d780bb$771985c0$654c9140$@yahoo.com>
References: <000901d780bb$771985c0$654c9140$.ref@yahoo.com>
 <000901d780bb$771985c0$654c9140$@yahoo.com>
Message-ID: <07811CBA-02DE-45E2-BDA5-F5E18B714927@neuwirth.priv.at>

plot(function(x)sin(deg2rad(x)),0,180)


> On 24.07.2021, at 20:41, Thomas Subia via R-help <r-help at r-project.org> wrote:
> 
> library(ggplot2)
> library(REdaS)
> copdat$degrees <- c(0,45,90,135,180)
> copdat$radians <- deg2rad(copdat$degrees)
> copdat$sin_x <- sin(copdat$radians)
> 
> ggplot(copdat,aes(x=degrees,y=sin_x))+
>  geom_point(size = 2)+ geom_line()+
>  theme_cowplot()+xlab("x")+
>  ylab("sin(x)")+
>  scale_x_continuous(breaks=seq(0,180,30))+
>  ggtitle("sin(x) vs x\nx is in degrees")


From er|ch@@ub@ @end|ng |rom neuw|rth@pr|v@@t  Mon Jul 26 01:59:04 2021
From: er|ch@@ub@ @end|ng |rom neuw|rth@pr|v@@t (Erich Subscriptions)
Date: Mon, 26 Jul 2021 01:59:04 +0200
Subject: [R] Sin curve question
In-Reply-To: <07811CBA-02DE-45E2-BDA5-F5E18B714927@neuwirth.priv.at>
References: <000901d780bb$771985c0$654c9140$.ref@yahoo.com>
 <000901d780bb$771985c0$654c9140$@yahoo.com>
 <07811CBA-02DE-45E2-BDA5-F5E18B714927@neuwirth.priv.at>
Message-ID: <26AEBB90-C2D5-4AA3-8009-201F16DC2A7B@neuwirth.priv.at>

With ggplot

tibble(x=0:180,y=sin(deg2rad(x))) |>
ggplot(aes(x=x,y=y)) +
  geom_line() +
  scale_x_continuous(breaks=seq(0,180,30)) +
    labs(x="x",y="sin(x)",
         title="sin(x) vs x\nx is in degrees")


> On 26.07.2021, at 01:52, Erich Subscriptions <erich.subs at neuwirth.priv.at> wrote:
> 
> plot(function(x)sin(deg2rad(x)),0,180)
> 
> 
>> On 24.07.2021, at 20:41, Thomas Subia via R-help <r-help at r-project.org> wrote:
>> 
>> library(ggplot2)
>> library(REdaS)
>> copdat$degrees <- c(0,45,90,135,180)
>> copdat$radians <- deg2rad(copdat$degrees)
>> copdat$sin_x <- sin(copdat$radians)
>> 
>> ggplot(copdat,aes(x=degrees,y=sin_x))+
>> geom_point(size = 2)+ geom_line()+
>> theme_cowplot()+xlab("x")+
>> ylab("sin(x)")+
>> scale_x_continuous(breaks=seq(0,180,30))+
>> ggtitle("sin(x) vs x\nx is in degrees")
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From petr@p|k@| @end|ng |rom prechez@@cz  Mon Jul 26 11:32:51 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Mon, 26 Jul 2021 09:32:51 +0000
Subject: [R] Help with Converting Excel Times to R
In-Reply-To: <SA1PR13MB4878B99FF67737AB8EC3B411C3E39@SA1PR13MB4878.namprd13.prod.outlook.com>
References: <SA1PR13MB4878B99FF67737AB8EC3B411C3E39@SA1PR13MB4878.namprd13.prod.outlook.com>
Message-ID: <484233c4337b4ba0ba31a5cc60490ab0@SRVEXCHCM1302.precheza.cz>

Hi

Maybe I am completely wrong but when you import Excel datetimes the result
is character, which can be converted to date format quite simply by strptime

In case of numerisc format you need to convert date number to seconds. But
you could have problems with your OS as on my system I need to set origin to
1904 nstead of 1900 suggested by Microsoft.

as.POSIXct(dt*24*60*60,origin="1904-1-1 00:00:00",tz="GMT")
[1] "2021-07-20 13:30:00 GMT" "2021-07-20 13:39:59 GMT"
>

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Shawn Way
> Sent: Wednesday, July 21, 2021 9:23 PM
> To: r-help at r-project.org
> Subject: [R] Help with Converting Excel Times to R
> 
> I've usually had good luck with this, but something is not working well.
I have
> two datetimes in excel
> 
> 7/20/21 13:30
> 7/20/21 13:40
> 
> And when I convert these to excel's normal storage schema, I get the
> following:
> 
> 42935.5625
> 42935.56944
> 
> Just try to convert this to a POSIX class gives me issues.
> 
> > dt <- c(42935.5625,42935.5694444444)
> 
> > as.POSIXct(dt,origin="1899-12-30 00:00:00",tz="GMT")
> 
> [1] "1899-12-30 11:55:36 GMT" "1899-12-30 11:55:36 GMT"
> 
> As you can see, there is a world of difference here.  I've tried any
number of
> solutions such as lubridate, etc and I get the same result
> 
> > as_datetime(dt,origin="1899-12-30 00:00:00")
> 
> [1] "1899-12-30 11:55:36 UTC" "1899-12-30 11:55:36 UTC"
> 
> Any ideas about what I'm doing wrong?
> 
> 
> Shawn Way
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

From n|ckmwr@y @end|ng |rom gm@||@com  Mon Jul 26 13:53:40 2021
From: n|ckmwr@y @end|ng |rom gm@||@com (Nick Wray)
Date: Mon, 26 Jul 2021 12:53:40 +0100
Subject: [R] Puzzled over "partial"
Message-ID: <CABxY9BMi0MYDEBoEd=wi4rSoeXXq=o22QeYsWug+GHHxv5v2qA@mail.gmail.com>

Hello   I am puzzled about the use or status of "partial" in R.  years ago
I found a little piece of code which gives the pth largest number in a
vector:
x<-c(5,4,7,2,6,9)
n <- length(x)
p<-4
sort(x,partial=n-(n-p))[n-(n-p)]
This works fine, although I have tried playing around with the code and
don't understand what "partial" is doing here.
However, wanted to work out what was going on, so I looked for "partial in
r" on t'internet and got this site:Partial apply a function, filling in
some arguments. ? partial ? purrr (tidyverse.org)
<https://purrr.tidyverse.org/reference/partial.html#:~:text=Source%3A%20R%2Fpartial.R%20Partial%20function%20application%20allows%20you%20to,that%20an%20argument%20can%20only%20be%20partialised%20once.>
Examples:
# Partial is designed to replace the use of anonymous functions for #
filling in function arguments. Instead of: compact1 <- function(x) discard
<https://purrr.tidyverse.org/reference/keep.html>(x, is.null) # we can
write: compact2 <- partial(discard, .p = is.null) # partial() works fine
with functions that do non-standard # evaluation my_long_variable <- 1:10
plot2 <- partial(plot, my_long_variable) plot2()
when i tried to run the examples on this site I got error messages - R
(studio) did not recognise the "partial" function here.  The site did not
say that I needed a particular package to run the "partial" function.
Are there essentially two different things in R both described as "partial"
but which are actually different entities?
Thanks for any elucidation
Nick Wray

	[[alternative HTML version deleted]]


From @kw@|mmo @end|ng |rom gm@||@com  Mon Jul 26 14:58:35 2021
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Mon, 26 Jul 2021 08:58:35 -0400
Subject: [R] Puzzled over "partial"
In-Reply-To: <CABxY9BMi0MYDEBoEd=wi4rSoeXXq=o22QeYsWug+GHHxv5v2qA@mail.gmail.com>
References: <CABxY9BMi0MYDEBoEd=wi4rSoeXXq=o22QeYsWug+GHHxv5v2qA@mail.gmail.com>
Message-ID: <CAPcHnpSkgKovSLLBw8aa=0LUpt30bXoSsX16YB=A4xXKwoPGiw@mail.gmail.com>

Hello,


First, your statement can be re-written as

sort(x,partial=p)[p]

since n - (n - p) is p. Second, you need to look at

?sort

And look at section "Arguments" subsection "partial", that should have the
details you're looking for. From what I understand, it guarantees that the
indices of "partial" will be sorted correctly, but all others won't, so
this saves time for things like "median". I hope this helps!


On Mon, Jul 26, 2021, 07:54 Nick Wray <nickmwray at gmail.com> wrote:

> Hello   I am puzzled about the use or status of "partial" in R.  years ago
> I found a little piece of code which gives the pth largest number in a
> vector:
> x<-c(5,4,7,2,6,9)
> n <- length(x)
> p<-4
> sort(x,partial=n-(n-p))[n-(n-p)]
> This works fine, although I have tried playing around with the code and
> don't understand what "partial" is doing here.
> However, wanted to work out what was going on, so I looked for "partial in
> r" on t'internet and got this site:Partial apply a function, filling in
> some arguments. ? partial ? purrr (tidyverse.org)
> <
> https://purrr.tidyverse.org/reference/partial.html#:~:text=Source%3A%20R%2Fpartial.R%20Partial%20function%20application%20allows%20you%20to,that%20an%20argument%20can%20only%20be%20partialised%20once
> .>
> Examples:
> # Partial is designed to replace the use of anonymous functions for #
> filling in function arguments. Instead of: compact1 <- function(x) discard
> <https://purrr.tidyverse.org/reference/keep.html>(x, is.null) # we can
> write: compact2 <- partial(discard, .p = is.null) # partial() works fine
> with functions that do non-standard # evaluation my_long_variable <- 1:10
> plot2 <- partial(plot, my_long_variable) plot2()
> when i tried to run the examples on this site I got error messages - R
> (studio) did not recognise the "partial" function here.  The site did not
> say that I needed a particular package to run the "partial" function.
> Are there essentially two different things in R both described as "partial"
> but which are actually different entities?
> Thanks for any elucidation
> Nick Wray
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From b@k|un@| @end|ng |rom y@hoo@com  Mon Jul 26 18:07:24 2021
From: b@k|un@| @end|ng |rom y@hoo@com (Baki UNAL)
Date: Mon, 26 Jul 2021 16:07:24 +0000 (UTC)
Subject: [R] RMariaDB returns a query without microseconds
References: <842556391.1123592.1627315644159.ref@mail.yahoo.com>
Message-ID: <842556391.1123592.1627315644159@mail.yahoo.com>

Hi

I can query a table from a mysql database with?RMariaDB. One of the table's column indicates "trade_time" and contains values such as "09:55:02.113000". When I query this table I can not get fractional seconds. I get a value such as "09:55:02". Also I get a variable class such as?"hms" and "difftime" for this column. Not character or POSIX* format. I tried both "datetime" and "varchar(25)" as column type of?"trade_time" in mysql. How can I solve this problem?

Best regards
Baki ?nal


From j@b@y@t194 @end|ng |rom gm@||@com  Mon Jul 26 14:05:03 2021
From: j@b@y@t194 @end|ng |rom gm@||@com (javad bayat)
Date: Mon, 26 Jul 2021 16:35:03 +0430
Subject: [R] Satelit Image
Message-ID: <CANTxAmLa9pymCRv35TbtuOwr0rTkmOV-0fU4YnTkQVVsO+3jFA@mail.gmail.com>

Dear all;
I want to extrac special wavelength of landsat8 image, 470nm and 570nm.
Is there any way to do this?
Sincerely

-- 
Best Regards
Javad Bayat
M.Sc. Environment Engineering
Alternative Mail: bayat194 at yahoo.com

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Mon Jul 26 20:58:29 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 26 Jul 2021 11:58:29 -0700
Subject: [R] Satelit Image
In-Reply-To: <CANTxAmLa9pymCRv35TbtuOwr0rTkmOV-0fU4YnTkQVVsO+3jFA@mail.gmail.com>
References: <CANTxAmLa9pymCRv35TbtuOwr0rTkmOV-0fU4YnTkQVVsO+3jFA@mail.gmail.com>
Message-ID: <CAGxFJbQGsmRC3bq=kpFaaykun1SqvA-0gzw16o=8rUZnZXj-Mw@mail.gmail.com>

You should generally post here for such geo-related queries:
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

(This is a general R language help list.)

You might also have a look here to see whether any of these curated
subject-related package directories might be of use to you.
https://cran.r-project.org/web/views/

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Mon, Jul 26, 2021 at 10:27 AM javad bayat <j.bayat194 at gmail.com> wrote:

> Dear all;
> I want to extrac special wavelength of landsat8 image, 470nm and 570nm.
> Is there any way to do this?
> Sincerely
>
> --
> Best Regards
> Javad Bayat
> M.Sc. Environment Engineering
> Alternative Mail: bayat194 at yahoo.com
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From h@@@n@d|w@n @end|ng |rom gm@||@com  Tue Jul 27 00:39:30 2021
From: h@@@n@d|w@n @end|ng |rom gm@||@com (Hasan Diwan)
Date: Mon, 26 Jul 2021 15:39:30 -0700
Subject: [R] RMariaDB returns a query without microseconds
In-Reply-To: <CAP+bYWC2bRJLNqZjMKFHhE7L1LDJTanVNBEix5LCQoy7NKWTEQ@mail.gmail.com>
References: <842556391.1123592.1627315644159.ref@mail.yahoo.com>
 <842556391.1123592.1627315644159@mail.yahoo.com>
 <CAP+bYWC2bRJLNqZjMKFHhE7L1LDJTanVNBEix5LCQoy7NKWTEQ@mail.gmail.com>
Message-ID: <CAP+bYWAE3C7B68daxwechJpc6vBV_MsQyJGH=bgdi3tDFHJUYA@mail.gmail.com>

Afternoon,

> https://mariadb.com/kb/en/microseconds-in-mariadb/ -- seems you're
> hitting a MariaDB (or perhaps, inherited from MySQL) limitation here. -- H
>
-- 
OpenPGP: https://hasan.d8u.us/openpgp.asc
If you wish to request my time, please do so using
*bit.ly/hd1AppointmentRequest
<http://bit.ly/hd1AppointmentRequest>*.
Si vous voudrais faire connnaisance, allez a *bit.ly/hd1AppointmentRequest
<http://bit.ly/hd1AppointmentRequest>*.

<https://sks-keyservers.net/pks/lookup?op=get&search=0xFEBAD7FFD041BBA1>Sent
from my mobile device
Envoye de mon portable

	[[alternative HTML version deleted]]


From r@oknz @end|ng |rom gm@||@com  Tue Jul 27 11:36:05 2021
From: r@oknz @end|ng |rom gm@||@com (Richard O'Keefe)
Date: Tue, 27 Jul 2021 21:36:05 +1200
Subject: [R] Puzzled over "partial"
In-Reply-To: <CABxY9BMi0MYDEBoEd=wi4rSoeXXq=o22QeYsWug+GHHxv5v2qA@mail.gmail.com>
References: <CABxY9BMi0MYDEBoEd=wi4rSoeXXq=o22QeYsWug+GHHxv5v2qA@mail.gmail.com>
Message-ID: <CABcYAd+UXyD-EDLvUWLOMHRdkg8rCtP3Zt6CzhtOou4a9JXRCQ@mail.gmail.com>

In this context, "partial" is not the name of any function or package in R.
It is just the name of a parameter.  And its meaning, which is specific to
sort(), is spelled out in the documentation for sort:

> ?sort
...
     If ?partial? is not ?NULL?, it is taken to contain indices of
     elements of the result which are to be placed in their correct
     positions in the sorted array by partial sorting.  For each of the
     result values in a specified position, any values smaller than
     that one are guaranteed to have a smaller index in the sorted
     array and any values which are greater are guaranteed to have a
     bigger index in the sorted array.  (This is included for
     efficiency, and many of the options are not available for partial
     sorting.  It is only substantially more efficient if ?partial? has
     a handful of elements, and a full sort is done (a Quicksort if
     possible) if there are more than 10.)  Names are discarded for
     partial sorting.

 Suppose you had the question
    IF the vector x were sorted, what would its 5th element be?
You could answer that by doing
    sort(x)[5[
but that's more work than you really need.
    sort(x, partial=5)[5]
rearranges x to c(less.than.x.5, x.5, greater.than.x.5).  This is called
partial sorting,   If you wanted the quartiles, then
   sort(x, partial=c(p,q,r))[c(p,q,r)]
will do the job, where p, q, r are the positions where the quartiles
would end up if complete sorting were done.

It's an efficiency hack for computing quantiles, basically.
If you are interested, you could look up
https://en.wikipedia.org/wiki/Quickselect

On Mon, 26 Jul 2021 at 23:54, Nick Wray <nickmwray at gmail.com> wrote:
>
> Hello   I am puzzled about the use or status of "partial" in R.  years ago
> I found a little piece of code which gives the pth largest number in a
> vector:
> x<-c(5,4,7,2,6,9)
> n <- length(x)
> p<-4
> sort(x,partial=n-(n-p))[n-(n-p)]
> This works fine, although I have tried playing around with the code and
> don't understand what "partial" is doing here.
> However, wanted to work out what was going on, so I looked for "partial in
> r" on t'internet and got this site:Partial apply a function, filling in
> some arguments. ? partial ? purrr (tidyverse.org)
> <https://purrr.tidyverse.org/reference/partial.html#:~:text=Source%3A%20R%2Fpartial.R%20Partial%20function%20application%20allows%20you%20to,that%20an%20argument%20can%20only%20be%20partialised%20once.>
> Examples:
> # Partial is designed to replace the use of anonymous functions for #
> filling in function arguments. Instead of: compact1 <- function(x) discard
> <https://purrr.tidyverse.org/reference/keep.html>(x, is.null) # we can
> write: compact2 <- partial(discard, .p = is.null) # partial() works fine
> with functions that do non-standard # evaluation my_long_variable <- 1:10
> plot2 <- partial(plot, my_long_variable) plot2()
> when i tried to run the examples on this site I got error messages - R
> (studio) did not recognise the "partial" function here.  The site did not
> say that I needed a particular package to run the "partial" function.
> Are there essentially two different things in R both described as "partial"
> but which are actually different entities?
> Thanks for any elucidation
> Nick Wray
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From r_goertz @end|ng |rom web@de  Tue Jul 27 13:24:04 2021
From: r_goertz @end|ng |rom web@de (Ralf Goertz)
Date: Tue, 27 Jul 2021 13:24:04 +0200
Subject: [R] RMariaDB returns a query without microseconds
In-Reply-To: <842556391.1123592.1627315644159@mail.yahoo.com>
References: <842556391.1123592.1627315644159.ref@mail.yahoo.com>
 <842556391.1123592.1627315644159@mail.yahoo.com>
Message-ID: <20210727132404.7b93cbd5@delli.fritz.box>

Am Mon, 26 Jul 2021 16:07:24 +0000 (UTC)
schrieb Baki UNAL via R-help <r-help at r-project.org>:

> Hi
> 
> I can query a table from a mysql database with?RMariaDB. One of the
> table's column indicates "trade_time" and contains values such as
> "09:55:02.113000". When I query this table I can not get fractional
> seconds. I get a value such as "09:55:02". Also I get a variable
> class such as?"hms" and "difftime" for this column. Not character or
> POSIX* format. I tried both "datetime" and "varchar(25)" as column
> type of?"trade_time" in mysql. How can I solve this problem?

Did you tell mariadb to include microsecond? I you just do

> create table dt (d TIME);
> insert into dt values("09:55:02.113000");
> select * from dt;
+----------+
| d        |
+----------+
| 09:55:02 |
+----------+
1 row in set (0.000 sec)

the fractional part is gone. But if you instead say

> create table dt (d DATETIME(6));

you get

> select * from dt;
+----------------------------+
| d                          |
+----------------------------+
| 2020-07-23 09:55:02.113000 |
+----------------------------+
1 row in set (0.001 sec)

And I also see this in R:
> dbGetQuery(con,"select * from dt")
                           d
1 2020-07-23 09:55:02.113000


From nur@@@mbo7 @end|ng |rom gm@||@com  Tue Jul 27 09:34:02 2021
From: nur@@@mbo7 @end|ng |rom gm@||@com (nura sambo)
Date: Tue, 27 Jul 2021 08:34:02 +0100
Subject: [R] Comparing methods for estimating misspecified models
Message-ID: <CAMq-9wHrwD-jVUWRiCWYUK3R+=7opvStvN8ugw=58r0--qo+0A@mail.gmail.com>

I want to compare between conditional maximum likelihood (CML) and weight
maximum likelihood (WML) using misspecified ordinary least square model.
Are there packages in R which implements the conditonal maximum likelihood
and weighted maximum likelihood method for estimating OLS Models?

	[[alternative HTML version deleted]]


From m@r||nkcox @end|ng |rom gm@||@com  Wed Jul 28 02:29:33 2021
From: m@r||nkcox @end|ng |rom gm@||@com (Marlin Keith Cox)
Date: Tue, 27 Jul 2021 16:29:33 -0800
Subject: [R] correlation by factor
Message-ID: <CAHskWAUEn8uWqyZFQfyU0L08FrsyfzDiLenMx_8vOKwX7BX2QA@mail.gmail.com>

I am having problems making a correlation/association between two variables
by a factor.

In the case below, I need to know the correlation between R and Day at each
frequency (a1-a5). Each frequency would have a corresponding correlation
between R and day.

I have found a lm function that is similar to what I need.
lm(R~Day*Freq), but this wont apply to the cor function.

Mind you, I have hundreds of these to with these same three columns, so if
there is an association package, I would be interested in those too.  I did
research it, but it quickly went over my head, so I thought I would
approach my problem this way.

Data is below.

Keith

R<-c(1,8,3,6,7,2,3,7,2,3,3,4,3,7,3)
Day<-c(1,1,1,1,1,2,2,2,2,2,3,3,3,3,3)
Freq<-(a1,a2,a3,a4,a5,a1,a2,a3,a4,a5,a1,a2,a3,a4,a5,)



M. Keith Cox, Ph.D.
Principal
MKConsulting
17415 Christine Ave.
Juneau, AK 99801
U.S. 907.957.4606

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Wed Jul 28 04:30:12 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 27 Jul 2021 19:30:12 -0700
Subject: [R] correlation by factor
In-Reply-To: <CAHskWAUEn8uWqyZFQfyU0L08FrsyfzDiLenMx_8vOKwX7BX2QA@mail.gmail.com>
References: <CAHskWAUEn8uWqyZFQfyU0L08FrsyfzDiLenMx_8vOKwX7BX2QA@mail.gmail.com>
Message-ID: <CAGxFJbR6Qkg-sPjjTa=-QMftBscpW_JxquTSJ0_YS1pfOHZjUg@mail.gmail.com>

Well, first of all, your example is messed up. You missed the "c" in front
of the ( in Freq <-; and all of the Freq entries need to be enclosed in
quotes for proper syntax. A simpler way to do it is just to use paste() and
rep():

Freq <- paste0("a", rep(1:5,3))
(If you are not familiar with such "utility" functions, you should consider
spending time with a basic R tutorial or two.)

Ordinarily, your individual vectors, R, Day and Freq, would be in a data
frame or similar (e.g. a tibble or data.table) structure and you would use
functions like by() in base R; or "tidyverse" or "data.table" package
equivalents/elaborations of these.

Here is a base R version (you must have version 4.1.x for the anonymous
function shortcut, \(x)  ) using by, but you may prefer tidyverse or
data.table versions that others may  provide:

> out <- by(cbind(R,Day), factor(Freq), FUN = \(x)cor(x)[1,2]) ## to just
get the off-diagonal of the 2x2 cor matrix
> as.list(out)
$a1
[1] 1

$a2
[1] -0.7559289

$a3
[1] 0

$a4
[1] 0.1889822

$a5
[1] -0.8660254

See ?by and ?cor for details as needed.


Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Tue, Jul 27, 2021 at 5:30 PM Marlin Keith Cox <marlinkcox at gmail.com>
wrote:

> I am having problems making a correlation/association between two variables
> by a factor.
>
> In the case below, I need to know the correlation between R and Day at each
> frequency (a1-a5). Each frequency would have a corresponding correlation
> between R and day.
>
> I have found a lm function that is similar to what I need.
> lm(R~Day*Freq), but this wont apply to the cor function.
>
> Mind you, I have hundreds of these to with these same three columns, so if
> there is an association package, I would be interested in those too.  I did
> research it, but it quickly went over my head, so I thought I would
> approach my problem this way.
>
> Data is below.
>
> Keith
>
> R<-c(1,8,3,6,7,2,3,7,2,3,3,4,3,7,3)
> Day<-c(1,1,1,1,1,2,2,2,2,2,3,3,3,3,3)
> Freq<-(a1,a2,a3,a4,a5,a1,a2,a3,a4,a5,a1,a2,a3,a4,a5,)
>
>
>
> M. Keith Cox, Ph.D.
> Principal
> MKConsulting
> 17415 Christine Ave.
> Juneau, AK 99801
> U.S. 907.957.4606
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Jul 28 07:51:52 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 28 Jul 2021 06:51:52 +0100
Subject: [R] correlation by factor
In-Reply-To: <CAGxFJbR6Qkg-sPjjTa=-QMftBscpW_JxquTSJ0_YS1pfOHZjUg@mail.gmail.com>
References: <CAHskWAUEn8uWqyZFQfyU0L08FrsyfzDiLenMx_8vOKwX7BX2QA@mail.gmail.com>
 <CAGxFJbR6Qkg-sPjjTa=-QMftBscpW_JxquTSJ0_YS1pfOHZjUg@mail.gmail.com>
Message-ID: <f737c3e6-287c-cb9e-e128-f8ffd1878a46@sapo.pt>

Hello,

And here are three more ways. I will put the data, corrected in Bert's 
post, in a data.frame.


R <- c(1,8,3,6,7,2,3,7,2,3,3,4,3,7,3)
Day <- c(1,1,1,1,1,2,2,2,2,2,3,3,3,3,3)
Freq <- paste0("a", rep(1:5,3))
df1 <- data.frame(R, Day, Freq)

# Base R, as for the function, see Bert's post
sapply(split(df1[-3], df1$Freq), \(x) cor(x)[1,2])


# tidyverse
library(dplyr)
df1 %>%
   group_by(Freq) %>%
   summarise(Cor = cor(R, Day))


# data.table
library(data.table)
setDT(df1)[, .(Cor = cor(R, Day)), by = Freq]


Hope this helps,

Rui Barradas


?s 03:30 de 28/07/21, Bert Gunter escreveu:
> Well, first of all, your example is messed up. You missed the "c" in front
> of the ( in Freq <-; and all of the Freq entries need to be enclosed in
> quotes for proper syntax. A simpler way to do it is just to use paste() and
> rep():
> 
> Freq <- paste0("a", rep(1:5,3))
> (If you are not familiar with such "utility" functions, you should consider
> spending time with a basic R tutorial or two.)
> 
> Ordinarily, your individual vectors, R, Day and Freq, would be in a data
> frame or similar (e.g. a tibble or data.table) structure and you would use
> functions like by() in base R; or "tidyverse" or "data.table" package
> equivalents/elaborations of these.
> 
> Here is a base R version (you must have version 4.1.x for the anonymous
> function shortcut, \(x)  ) using by, but you may prefer tidyverse or
> data.table versions that others may  provide:
> 
>> out <- by(cbind(R,Day), factor(Freq), FUN = \(x)cor(x)[1,2]) ## to just
> get the off-diagonal of the 2x2 cor matrix
>> as.list(out)
> $a1
> [1] 1
> 
> $a2
> [1] -0.7559289
> 
> $a3
> [1] 0
> 
> $a4
> [1] 0.1889822
> 
> $a5
> [1] -0.8660254
> 
> See ?by and ?cor for details as needed.
> 
> 
> Bert Gunter
> 
> "The trouble with having an open mind is that people keep coming along and
> sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> 
> 
> On Tue, Jul 27, 2021 at 5:30 PM Marlin Keith Cox <marlinkcox at gmail.com>
> wrote:
> 
>> I am having problems making a correlation/association between two variables
>> by a factor.
>>
>> In the case below, I need to know the correlation between R and Day at each
>> frequency (a1-a5). Each frequency would have a corresponding correlation
>> between R and day.
>>
>> I have found a lm function that is similar to what I need.
>> lm(R~Day*Freq), but this wont apply to the cor function.
>>
>> Mind you, I have hundreds of these to with these same three columns, so if
>> there is an association package, I would be interested in those too.  I did
>> research it, but it quickly went over my head, so I thought I would
>> approach my problem this way.
>>
>> Data is below.
>>
>> Keith
>>
>> R<-c(1,8,3,6,7,2,3,7,2,3,3,4,3,7,3)
>> Day<-c(1,1,1,1,1,2,2,2,2,2,3,3,3,3,3)
>> Freq<-(a1,a2,a3,a4,a5,a1,a2,a3,a4,a5,a1,a2,a3,a4,a5,)
>>
>>
>>
>> M. Keith Cox, Ph.D.
>> Principal
>> MKConsulting
>> 17415 Christine Ave.
>> Juneau, AK 99801
>> U.S. 907.957.4606
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From n|ckmwr@y @end|ng |rom gm@||@com  Thu Jul 29 10:07:12 2021
From: n|ckmwr@y @end|ng |rom gm@||@com (Nick Wray)
Date: Thu, 29 Jul 2021 09:07:12 +0100
Subject: [R] Unending loop
Message-ID: <CABxY9BM2uaiXgfoBfvmrwANHHtCVT1YqqZ+L96o4YzNmuO69Cg@mail.gmail.com>

Hello I don't know whether strictly speaking this is an R-help province
question but anyway...
I am looking at the extRemes package and have some code given beneath.
When I run it on my own laptop it works fine, but when I run it on my uni
laptop (which is pretty new and I only was given a couple of months ago)
when it gets to the thresh.range line it goes into an unending loop (or
something) with the little red Stop button, and just sits there.  I have R
4.0.4 on my uni laptop and R 4.0.5 on my own one.  Could this be the reason?

Thanks, Nick Wray

install.packages("extRemes")
library(extRemes)
data(Fort)
names(Fort)

bmFort <- blockmaxxer(Fort, blocks = Fort$year, which="Prec")
names(bmFort)

plot(Fort$year, Fort$Prec, xlab = "Year",
     ylab = "Precipitation (inches)",
     cex = 1.25, cex.lab = 1.25,
     col = "darkblue", bg = "lightblue", pch = 21)

points(bmFort$year, bmFort$Prec, col="darkred", cex=1.5)

# Fit a GEV distribution to annual maximum Precipitation
# in Fort Collins, Colorado, U.S.A.
fitGEV <- fevd(Prec, data = bmFort)
fitGEV
plot(fitGEV)
plot(fitGEV, "trace")

# Select a threshold for daily data from above.
threshrange.plot(Fort$Prec, c(0.1, 2), type = "PP")

# Fit the PP model to the daily data from above.
fitPP <- fevd(Prec, data = Fort, threshold = 0.395,
              type = "PP", units = "inches")
fitPP
plot(fitPP)

atdf(Fort$Prec, 0.395)

extremalindex(Fort$Prec, 0.395, blocks=Fort$year)

dcFort <- decluster(Fort$Prec, 0.395, r = 9)
plot(dcFort)

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Thu Jul 29 13:47:56 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Thu, 29 Jul 2021 13:47:56 +0200
Subject: [R] Unending loop
In-Reply-To: <CABxY9BM2uaiXgfoBfvmrwANHHtCVT1YqqZ+L96o4YzNmuO69Cg@mail.gmail.com>
References: <CABxY9BM2uaiXgfoBfvmrwANHHtCVT1YqqZ+L96o4YzNmuO69Cg@mail.gmail.com>
Message-ID: <20210729134756.68de9c2c@trisector>

Hi Nick,

Thanks for providing an example that doesn't seem to depend on external
data!

On Thu, 29 Jul 2021 09:07:12 +0100
Nick Wray <nickmwray at gmail.com> wrote:

> I am looking at the extRemes package

It's probable that there aren't many extRemes users on R-help, but if
you contact the maintainer of extRemes (run maintainer('extRemes') to
get their name and address), you might get help that way.

> When I run it on my own laptop it works fine, but when I run it on my
> uni laptop (which is pretty new and I only was given a couple of
> months ago) when it gets to the thresh.range line it goes into an
> unending loop (or something) with the little red Stop button, and
> just sits there.

If you interrupt it there, backtrace() will point you in the direction
of seemingly endless loop. You can also set options(error = recover)
and get a debugger prompt at the point where you interrupted the code
or in any other frame. See ?browser and RShowDoc('R-lang') part 9
"Debugging" for more information.

> I have R 4.0.4 on my uni laptop and R 4.0.5 on my own one.  Could
> this be the reason?

I'm afraid it's easier for you to answer this question. It should be
possible to install R on computers even without administrator access.
Can you reproduce the issue with
https://cloud.r-project.org/bin/windows/base/old/4.0.4/ on your own
laptop or https://cloud.r-project.org/bin/windows/base/old/4.0.5/ on the
university-issued one?

> 	[[alternative HTML version deleted]]

This mailing list strips away the HTML part of multipart/mixed
messages, so to make sure that your messages look exactly as you type
them, please compose them in plain text.

-- 
Best regards,
Ivan


From b@k|un@| @end|ng |rom y@hoo@com  Thu Jul 29 14:42:09 2021
From: b@k|un@| @end|ng |rom y@hoo@com (Baki UNAL)
Date: Thu, 29 Jul 2021 12:42:09 +0000 (UTC)
Subject: [R] RMariaDB returns a query without fractional seconds from MYSQL
 database
References: <1814509591.773453.1627562529410.ref@mail.yahoo.com>
Message-ID: <1814509591.773453.1627562529410@mail.yahoo.com>

Hi

I created a table with following sql code in mysql:

CREATE TABLE pp_guniciislem201906.pp_201906 (
? ? date DATE,
? ? transaction_code VARCHAR(15),
? ? joint_agree_no VARCHAR(20),
? ? match_trade_item VARCHAR(15),
? ? buy_sell VARCHAR(15),
? ? num_transactions INT,
? ? paid_price FLOAT,
? ? trade_value FLOAT,
? ? order_no VARCHAR(20),
? ? trade_time TIME(6),
? ? trade_report INT,
? ? session VARCHAR(20),
? ? trade_status INT,
? ? settlement_date VARCHAR(5),
? ? assets_liabilities VARCHAR(1),
? ? trade_id INT,
? ? deal_id INT,
? ? update_time DATETIME,
? ? give_up_flag VARCHAR(1),
? ? update_no INT,
? ? update_time2 DATETIME? ??
);

I defined "trade_time" column with "TIME(6)". Because I have only time such as?"09:55:02.113000" but not date.
Then I imported a csv file data to table with following sql code:

LOAD DATA INFILE 'G:\m201906.csv'
INTO TABLE pp_guniciislem201906.pp_201906
FIELDS TERMINATED BY ';'
LINES TERMINATED BY '\n'
IGNORE 2 ROWS;

After that, when I query "SELECT * FROM pp_guniciislem201906.pp_201906;" from mysql "trade_time" column displays with fractional seconds. (I attached screenshot of mysql screen)

Then when I query from r with following code I could not get fractional seconds. I attached Rstudio screenshot image. As seen from this image in "trade_time" column fractional seconds are gone.


library(RMariaDB)

my_date <- '2019-06-24'

my_transaction_code <- 'AKBNK.E'

pp_201906 <- dbConnect(RMariaDB::MariaDB(), user='root', password='qazwsxedc', dbname='pp_guniciislem201906', host='localhost')

myquery <- paste("SELECT * FROM pp_201906 WHERE date='",my_date,"' AND transaction_code='",my_transaction_code,"'", sep="")

rs = dbSendQuery(pp_201906, myquery)

dbRows<-dbFetch(rs)


How can I solve this problem.
Best Regards

From drj|m|emon @end|ng |rom gm@||@com  Fri Jul 30 07:39:39 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Fri, 30 Jul 2021 15:39:39 +1000
Subject: [R] plotrix: Bug in `sizetree()` function
In-Reply-To: <CAKt3tznT8Rmeu8xu3uVd1LZZ+hE2UkLDNeJsHiMi7i=iZ34cyA@mail.gmail.com>
References: <CAKt3tzks8g1xVAg0MbC9wWRvHCHE_6ciBcdMVaZQDGkzWWkMiA@mail.gmail.com>
 <CA+8X3fWwq+DRNPbxWYXdMv=SU-BLMJ=fufQP=9vWYCY-QLvx+Q@mail.gmail.com>
 <CAKt3tznT8Rmeu8xu3uVd1LZZ+hE2UkLDNeJsHiMi7i=iZ34cyA@mail.gmail.com>
Message-ID: <CA+8X3fVEKWY_=5A+Oj65eWzx8cFPM0pZeiHP_34uxFRxAC8Jrw@mail.gmail.com>

Hi Reza,
I just had a look at that and found the problem. I had not passed the
"showcount" argument in the recursive calls. The attached code, which will
be in the next version, seems to fix it.

Jim

On Fri, Jul 30, 2021 at 1:06 PM Reza Norouzian <rnorouzian at gmail.com> wrote:

> Thanks a lot! In case the bug is fixed, I'd appreciate it if you could let
> me know.
>
> Thanks again,
> Reza
> *Reza Norouzian (he/him/his)*
> *Visiting Assistant Professor, Quantitative Methods*
> *Department of Educational Psychology*
> *The University of Texas at Austin*
> 1912 Speedway, Stop D5800
> Austin, TX 78712-1289
>
>
>
>
>
> On Thu, Jul 29, 2021 at 4:42 PM Jim Lemon <drjimlemon at gmail.com> wrote:
>
>> Hi Reza,
>> Thanks for letting me know. I will get to this ASAP.
>>
>> Jim
>>
>> On Thu, Jul 29, 2021 at 11:21 PM Reza Norouzian <rnorouzian at gmail.com>
>> wrote:
>> >
>> > Dear Jim,
>> >
>> > Thank you for the nice package. I just wanted to let you know that the
>> `showcount = FALSE` in the `siztree` function doesn't work properly and
>> that the function likely has a bug.
>> >
>> > I have reported this with a reproducible example on StackOverflow as
>> well, and others also confirmed it.
>> >
>> > Thanks for your attention,
>> > Reza
>> > Reza Norouzian (he/him/his)
>> > Visiting Assistant Professor, Quantitative Methods
>> > Department of Educational Psychology
>> > The University of Texas at Austin
>> > 1912 Speedway, Stop D5800
>> > Austin, TX 78712-1289
>> >
>> >
>> >
>>
>

From @te|@no@@o||@ @end|ng |rom reg|one@m@rche@|t  Fri Jul 30 09:23:44 2021
From: @te|@no@@o||@ @end|ng |rom reg|one@m@rche@|t (Stefano Sofia)
Date: Fri, 30 Jul 2021 07:23:44 +0000
Subject: [R] Cumulates of snowfall within a given interval
Message-ID: <8B435C9568170B469AE31E8891E8CC4FC65AC61E@ESINO.regionemarche.intra>

Dear R users,
I have a data frame with daily snow cumulates (these quantities are known as "hn" and are expressed in cm), from the 1st of December to the 30th of April, for more than twenty years.

I would need to find days when the sum of a given short interval (I might choose two consecutive days, three consecutive days or something like that) is higher than a threshold (it might be 80 cm, or 100 cm).

I am trying with rle, but I really struggle to find an efficient algorithm.
Could somebody help me with some hints?

Thank you for your attention and your help
Stefano


init_day <- as.POSIXct("2018-02-01", format="%Y-%m-%d", tz="Etc/GMT-1")
fin_day <- as.POSIXct("2018-02-20", format="%Y-%m-%d", tz="Etc/GMT-1")
mydf <- data.frame(data_POSIX=seq(init_day, fin_day, by="1 day"))
mydf$hn <- c(30, 0, 10, 50, NA, 40, 70, 0, 0, 0 , NA, 10, 50, 30, 30, 10, 0, 0, 90, 0)

- if I choose a threshold of 100 cm in two days, I should get the 6th of February;
- if I choose a threshold of 80 cm in two days I should get the 6th and the 13th of February, but not the 19th of February because this is a single day;
- f I choose a threshold of 100 cm in four days, I should get the 12th of February.

         (oo)
--oOO--( )--OOo--------------------------------------
Stefano Sofia PhD
Civil Protection - Marche Region - Italy
Meteo Section
Snow Section
Via del Colle Ameno 5
60126 Torrette di Ancona, Ancona (AN)
Uff: +39 071 806 7743
E-mail: stefano.sofia at regione.marche.it
---Oo---------oO----------------------------------------

________________________________

AVVISO IMPORTANTE: Questo messaggio di posta elettronica pu? contenere informazioni confidenziali, pertanto ? destinato solo a persone autorizzate alla ricezione. I messaggi di posta elettronica per i client di Regione Marche possono contenere informazioni confidenziali e con privilegi legali. Se non si ? il destinatario specificato, non leggere, copiare, inoltrare o archiviare questo messaggio. Se si ? ricevuto questo messaggio per errore, inoltrarlo al mittente ed eliminarlo completamente dal sistema del proprio computer. Ai sensi dell?art. 6 della DGR n. 1394/2008 si segnala che, in caso di necessit? ed urgenza, la risposta al presente messaggio di posta elettronica pu? essere visionata da persone estranee al destinatario.
IMPORTANT NOTICE: This e-mail message is intended to be received only by persons entitled to receive the confidential information it may contain. E-mail messages to clients of Regione Marche may contain information that is confidential and legally privileged. Please do not read, copy, forward, or store this message unless you are an intended recipient of it. If you have received this message in error, please forward it to the sender and delete it completely from your computer system.

--
Questo messaggio  stato analizzato da Libraesva ESG ed  risultato non infetto.
This message was scanned by Libraesva ESG and is believed to be clean.


	[[alternative HTML version deleted]]


From petr@p|k@| @end|ng |rom prechez@@cz  Fri Jul 30 10:37:14 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Fri, 30 Jul 2021 08:37:14 +0000
Subject: [R] Cumulates of snowfall within a given interval
In-Reply-To: <8B435C9568170B469AE31E8891E8CC4FC65AC61E@ESINO.regionemarche.intra>
References: <8B435C9568170B469AE31E8891E8CC4FC65AC61E@ESINO.regionemarche.intra>
Message-ID: <fb55b35053a048d0b7efceb215ee400e@SRVEXCHCM1302.precheza.cz>

Hi

I would use ?embed function. 

nr <- which(rowSums(embed(mydf$hn, 2))>=80)
mydf[nr,]

But I feel strange that variant 40,50 should be accepted but 0, 90 should not. Both after two consecutive days result in more than 80cm cumulative snow. What about 1,80 how it differs from 0, 81. basically with your constrain zero means NA so if I change all zeroes to NA I get quite close.

> nr <- which(rowSums(embed(mydf$hn, 2))>=80)
> mydf[nr,]
   data_POSIX hn
6  2018-02-06 40
13 2018-02-13 50
> nr <- which(rowSums(embed(mydf$hn, 4))>=100)
> mydf[nr,]
   data_POSIX hn
12 2018-02-12 10
13 2018-02-13 50
> nr <- which(rowSums(embed(mydf$hn, 2))>=100)
> mydf[nr,]
  data_POSIX hn
6 2018-02-06 40
>

Anyway, you need to polish the result a bit as in four consecutive days both 12 and 13 results in higher than 100 cm

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stefano Sofia
> Sent: Friday, July 30, 2021 9:24 AM
> To: r-help mailing list <r-help at r-project.org>
> Subject: [R] Cumulates of snowfall within a given interval
> 
> Dear R users,
> I have a data frame with daily snow cumulates (these quantities are known
> as "hn" and are expressed in cm), from the 1st of December to the 30th of
> April, for more than twenty years.
> 
> I would need to find days when the sum of a given short interval (I might
> choose two consecutive days, three consecutive days or something like that)
> is higher than a threshold (it might be 80 cm, or 100 cm).
> 
> I am trying with rle, but I really struggle to find an efficient algorithm.
> Could somebody help me with some hints?
> 
> Thank you for your attention and your help
> Stefano
> 
> 
> init_day <- as.POSIXct("2018-02-01", format="%Y-%m-%d", tz="Etc/GMT-1")
> fin_day <- as.POSIXct("2018-02-20", format="%Y-%m-%d", tz="Etc/GMT-1")
> mydf <- data.frame(data_POSIX=seq(init_day, fin_day, by="1 day"))
> mydf$hn <- c(30, 0, 10, 50, NA, 40, 70, 0, 0, 0 , NA, 10, 50, 30, 30, 10, 0, 0, 90, 0)
> 
> - if I choose a threshold of 100 cm in two days, I should get the 6th of
> February;
> - if I choose a threshold of 80 cm in two days I should get the 6th and the 13th
> of February, but not the 19th of February because this is a single day;
> - f I choose a threshold of 100 cm in four days, I should get the 12th of
> February.
> 
>          (oo)
> --oOO--( )--OOo--------------------------------------
> Stefano Sofia PhD
> Civil Protection - Marche Region - Italy
> Meteo Section
> Snow Section
> Via del Colle Ameno 5
> 60126 Torrette di Ancona, Ancona (AN)
> Uff: +39 071 806 7743
> E-mail: stefano.sofia at regione.marche.it
> ---Oo---------oO----------------------------------------
> 
> ________________________________
> 
> AVVISO IMPORTANTE: Questo messaggio di posta elettronica pu? contenere
> informazioni confidenziali, pertanto ? destinato solo a persone autorizzate
> alla ricezione. I messaggi di posta elettronica per i client di Regione Marche
> possono contenere informazioni confidenziali e con privilegi legali. Se non si ?
> il destinatario specificato, non leggere, copiare, inoltrare o archiviare questo
> messaggio. Se si ? ricevuto questo messaggio per errore, inoltrarlo al
> mittente ed eliminarlo completamente dal sistema del proprio computer. Ai
> sensi dell?art. 6 della DGR n. 1394/2008 si segnala che, in caso di necessit? ed
> urgenza, la risposta al presente messaggio di posta elettronica pu? essere
> visionata da persone estranee al destinatario.
> IMPORTANT NOTICE: This e-mail message is intended to be received only by
> persons entitled to receive the confidential information it may contain. E-mail
> messages to clients of Regione Marche may contain information that is
> confidential and legally privileged. Please do not read, copy, forward, or store
> this message unless you are an intended recipient of it. If you have received
> this message in error, please forward it to the sender and delete it
> completely from your computer system.
> 
> --
> Questo messaggio  stato analizzato da Libraesva ESG ed  risultato non infetto.
> This message was scanned by Libraesva ESG and is believed to be clean.
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

From @te|@no@@o||@ @end|ng |rom reg|one@m@rche@|t  Fri Jul 30 11:26:46 2021
From: @te|@no@@o||@ @end|ng |rom reg|one@m@rche@|t (Stefano Sofia)
Date: Fri, 30 Jul 2021 09:26:46 +0000
Subject: [R] Cumulates of snowfall within a given interval
In-Reply-To: <fb55b35053a048d0b7efceb215ee400e@SRVEXCHCM1302.precheza.cz>
References: <8B435C9568170B469AE31E8891E8CC4FC65AC61E@ESINO.regionemarche.intra>,
 <fb55b35053a048d0b7efceb215ee400e@SRVEXCHCM1302.precheza.cz>
Message-ID: <8B435C9568170B469AE31E8891E8CC4FC65AC67D@ESINO.regionemarche.intra>

Thank you Petr,
simply perfect.

Thank you again
Stefano


         (oo)
--oOO--( )--OOo--------------------------------------
Stefano Sofia PhD
Civil Protection - Marche Region - Italy
Meteo Section
Snow Section
Via del Colle Ameno 5
60126 Torrette di Ancona, Ancona (AN)
Uff: +39 071 806 7743
E-mail: stefano.sofia at regione.marche.it
---Oo---------oO----------------------------------------

________________________________________
Da: PIKAL Petr [petr.pikal at precheza.cz]
Inviato: venerd? 30 luglio 2021 10.37
A: Stefano Sofia; r-help mailing list
Oggetto: RE: Cumulates of snowfall within a given interval

Hi

I would use ?embed function.

nr <- which(rowSums(embed(mydf$hn, 2))>=80)
mydf[nr,]

But I feel strange that variant 40,50 should be accepted but 0, 90 should not. Both after two consecutive days result in more than 80cm cumulative snow. What about 1,80 how it differs from 0, 81. basically with your constrain zero means NA so if I change all zeroes to NA I get quite close.

> nr <- which(rowSums(embed(mydf$hn, 2))>=80)
> mydf[nr,]
   data_POSIX hn
6  2018-02-06 40
13 2018-02-13 50
> nr <- which(rowSums(embed(mydf$hn, 4))>=100)
> mydf[nr,]
   data_POSIX hn
12 2018-02-12 10
13 2018-02-13 50
> nr <- which(rowSums(embed(mydf$hn, 2))>=100)
> mydf[nr,]
  data_POSIX hn
6 2018-02-06 40
>

Anyway, you need to polish the result a bit as in four consecutive days both 12 and 13 results in higher than 100 cm

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stefano Sofia
> Sent: Friday, July 30, 2021 9:24 AM
> To: r-help mailing list <r-help at r-project.org>
> Subject: [R] Cumulates of snowfall within a given interval
>
> Dear R users,
> I have a data frame with daily snow cumulates (these quantities are known
> as "hn" and are expressed in cm), from the 1st of December to the 30th of
> April, for more than twenty years.
>
> I would need to find days when the sum of a given short interval (I might
> choose two consecutive days, three consecutive days or something like that)
> is higher than a threshold (it might be 80 cm, or 100 cm).
>
> I am trying with rle, but I really struggle to find an efficient algorithm.
> Could somebody help me with some hints?
>
> Thank you for your attention and your help
> Stefano
>
>
> init_day <- as.POSIXct("2018-02-01", format="%Y-%m-%d", tz="Etc/GMT-1")
> fin_day <- as.POSIXct("2018-02-20", format="%Y-%m-%d", tz="Etc/GMT-1")
> mydf <- data.frame(data_POSIX=seq(init_day, fin_day, by="1 day"))
> mydf$hn <- c(30, 0, 10, 50, NA, 40, 70, 0, 0, 0 , NA, 10, 50, 30, 30, 10, 0, 0, 90, 0)
>
> - if I choose a threshold of 100 cm in two days, I should get the 6th of
> February;
> - if I choose a threshold of 80 cm in two days I should get the 6th and the 13th
> of February, but not the 19th of February because this is a single day;
> - f I choose a threshold of 100 cm in four days, I should get the 12th of
> February.
>
>          (oo)
> --oOO--( )--OOo--------------------------------------
> Stefano Sofia PhD
> Civil Protection - Marche Region - Italy
> Meteo Section
> Snow Section
> Via del Colle Ameno 5
> 60126 Torrette di Ancona, Ancona (AN)
> Uff: +39 071 806 7743
> E-mail: stefano.sofia at regione.marche.it
> ---Oo---------oO----------------------------------------
>
> ________________________________
>
> AVVISO IMPORTANTE: Questo messaggio di posta elettronica pu? contenere
> informazioni confidenziali, pertanto ? destinato solo a persone autorizzate
> alla ricezione. I messaggi di posta elettronica per i client di Regione Marche
> possono contenere informazioni confidenziali e con privilegi legali. Se non si ?
> il destinatario specificato, non leggere, copiare, inoltrare o archiviare questo
> messaggio. Se si ? ricevuto questo messaggio per errore, inoltrarlo al
> mittente ed eliminarlo completamente dal sistema del proprio computer. Ai
> sensi dell?art. 6 della DGR n. 1394/2008 si segnala che, in caso di necessit? ed
> urgenza, la risposta al presente messaggio di posta elettronica pu? essere
> visionata da persone estranee al destinatario.
> IMPORTANT NOTICE: This e-mail message is intended to be received only by
> persons entitled to receive the confidential information it may contain. E-mail
> messages to clients of Regione Marche may contain information that is
> confidential and legally privileged. Please do not read, copy, forward, or store
> this message unless you are an intended recipient of it. If you have received
> this message in error, please forward it to the sender and delete it
> completely from your computer system.
>
> --
> Questo messaggio  stato analizzato da Libraesva ESG ed  risultato non infetto.
> This message was scanned by Libraesva ESG and is believed to be clean.
>
>
>       [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>  https://urlsand.esvalabs.com/?u=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&e=5a635173&h=06ff70f3&f=y&p=y
> PLEASE do read the posting guide  https://urlsand.esvalabs.com/?u=http%3A%2F%2Fwww.R-project.org%2Fposting-&e=5a635173&h=9e88a0d1&f=y&p=y
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

________________________________

AVVISO IMPORTANTE: Questo messaggio di posta elettronica pu? contenere informazioni confidenziali, pertanto ? destinato solo a persone autorizzate alla ricezione. I messaggi di posta elettronica per i client di Regione Marche possono contenere informazioni confidenziali e con privilegi legali. Se non si ? il destinatario specificato, non leggere, copiare, inoltrare o archiviare questo messaggio. Se si ? ricevuto questo messaggio per errore, inoltrarlo al mittente ed eliminarlo completamente dal sistema del proprio computer. Ai sensi dell?art. 6 della DGR n. 1394/2008 si segnala che, in caso di necessit? ed urgenza, la risposta al presente messaggio di posta elettronica pu? essere visionata da persone estranee al destinatario.
IMPORTANT NOTICE: This e-mail message is intended to be received only by persons entitled to receive the confidential information it may contain. E-mail messages to clients of Regione Marche may contain information that is confidential and legally privileged. Please do not read, copy, forward, or store this message unless you are an intended recipient of it. If you have received this message in error, please forward it to the sender and delete it completely from your computer system.

--
Questo messaggio  stato analizzato da Libraesva ESG ed  risultato non infetto.
This message was scanned by Libraesva ESG and is believed to be clean.


From drj|m|emon @end|ng |rom gm@||@com  Fri Jul 30 12:05:13 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Fri, 30 Jul 2021 20:05:13 +1000
Subject: [R] Cumulates of snowfall within a given interval
In-Reply-To: <8B435C9568170B469AE31E8891E8CC4FC65AC61E@ESINO.regionemarche.intra>
References: <8B435C9568170B469AE31E8891E8CC4FC65AC61E@ESINO.regionemarche.intra>
Message-ID: <CA+8X3fXHAq_yHq8GjR2ba8VrW2hbPZs=uzhH5gPqA98-xXgKBw@mail.gmail.com>

Hi Stefano,
Try using rollsum from the zoo package:

library(zoo)
rollsum_index<-function(x,window,val) return(which(rollsum(x,window) >= val))
rollsum_index(mydf$hn,2,80)
[1]  6 13 18 19

Jim

On Fri, Jul 30, 2021 at 5:24 PM Stefano Sofia
<stefano.sofia at regione.marche.it> wrote:
>
> Dear R users,
> I have a data frame with daily snow cumulates (these quantities are known as "hn" and are expressed in cm), from the 1st of December to the 30th of April, for more than twenty years.
>
> I would need to find days when the sum of a given short interval (I might choose two consecutive days, three consecutive days or something like that) is higher than a threshold (it might be 80 cm, or 100 cm).
>
> I am trying with rle, but I really struggle to find an efficient algorithm.
> Could somebody help me with some hints?
>
> Thank you for your attention and your help
> Stefano
>
>
> init_day <- as.POSIXct("2018-02-01", format="%Y-%m-%d", tz="Etc/GMT-1")
> fin_day <- as.POSIXct("2018-02-20", format="%Y-%m-%d", tz="Etc/GMT-1")
> mydf <- data.frame(data_POSIX=seq(init_day, fin_day, by="1 day"))
> mydf$hn <- c(30, 0, 10, 50, NA, 40, 70, 0, 0, 0 , NA, 10, 50, 30, 30, 10, 0, 0, 90, 0)
>
> - if I choose a threshold of 100 cm in two days, I should get the 6th of February;
> - if I choose a threshold of 80 cm in two days I should get the 6th and the 13th of February, but not the 19th of February because this is a single day;
> - f I choose a threshold of 100 cm in four days, I should get the 12th of February.
>
>          (oo)
> --oOO--( )--OOo--------------------------------------
> Stefano Sofia PhD
> Civil Protection - Marche Region - Italy
> Meteo Section
> Snow Section
> Via del Colle Ameno 5
> 60126 Torrette di Ancona, Ancona (AN)
> Uff: +39 071 806 7743
> E-mail: stefano.sofia at regione.marche.it
> ---Oo---------oO----------------------------------------
>
> ________________________________
>
> AVVISO IMPORTANTE: Questo messaggio di posta elettronica pu? contenere informazioni confidenziali, pertanto ? destinato solo a persone autorizzate alla ricezione. I messaggi di posta elettronica per i client di Regione Marche possono contenere informazioni confidenziali e con privilegi legali. Se non si ? il destinatario specificato, non leggere, copiare, inoltrare o archiviare questo messaggio. Se si ? ricevuto questo messaggio per errore, inoltrarlo al mittente ed eliminarlo completamente dal sistema del proprio computer. Ai sensi dell?art. 6 della DGR n. 1394/2008 si segnala che, in caso di necessit? ed urgenza, la risposta al presente messaggio di posta elettronica pu? essere visionata da persone estranee al destinatario.
> IMPORTANT NOTICE: This e-mail message is intended to be received only by persons entitled to receive the confidential information it may contain. E-mail messages to clients of Regione Marche may contain information that is confidential and legally privileged. Please do not read, copy, forward, or store this message unless you are an intended recipient of it. If you have received this message in error, please forward it to the sender and delete it completely from your computer system.
>
> --
> Questo messaggio  stato analizzato da Libraesva ESG ed  risultato non infetto.
> This message was scanned by Libraesva ESG and is believed to be clean.
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From rnorouz|@n @end|ng |rom gm@||@com  Fri Jul 30 18:15:55 2021
From: rnorouz|@n @end|ng |rom gm@||@com (Reza Norouzian)
Date: Fri, 30 Jul 2021 11:15:55 -0500
Subject: [R] plotrix: Bug in `sizetree()` function
In-Reply-To: <CA+8X3fVEKWY_=5A+Oj65eWzx8cFPM0pZeiHP_34uxFRxAC8Jrw@mail.gmail.com>
References: <CAKt3tzks8g1xVAg0MbC9wWRvHCHE_6ciBcdMVaZQDGkzWWkMiA@mail.gmail.com>
 <CA+8X3fWwq+DRNPbxWYXdMv=SU-BLMJ=fufQP=9vWYCY-QLvx+Q@mail.gmail.com>
 <CAKt3tznT8Rmeu8xu3uVd1LZZ+hE2UkLDNeJsHiMi7i=iZ34cyA@mail.gmail.com>
 <CA+8X3fVEKWY_=5A+Oj65eWzx8cFPM0pZeiHP_34uxFRxAC8Jrw@mail.gmail.com>
Message-ID: <CAKt3tzndQEe0rLvr-WfJL=MOOxw1KzZMtJ0ru0OSAk+vCmV57Q@mail.gmail.com>

Thank you, Jim. Just to make sure, does the function you've shared work
independently or it depends on the current version of the package which has
the bug?

Thanks again,
Reza
*Reza Norouzian (he/him/his)*
*Visiting Assistant Professor, Quantitative Methods*
*Department of Educational Psychology*
*The University of Texas at Austin*
1912 Speedway, Stop D5800
Austin, TX 78712-1289





On Fri, Jul 30, 2021 at 12:39 AM Jim Lemon <drjimlemon at gmail.com> wrote:

> Hi Reza,
> I just had a look at that and found the problem. I had not passed the
> "showcount" argument in the recursive calls. The attached code, which will
> be in the next version, seems to fix it.
>
> Jim
>
> On Fri, Jul 30, 2021 at 1:06 PM Reza Norouzian <rnorouzian at gmail.com>
> wrote:
>
>> Thanks a lot! In case the bug is fixed, I'd appreciate it if you could
>> let me know.
>>
>> Thanks again,
>> Reza
>> *Reza Norouzian (he/him/his)*
>> *Visiting Assistant Professor, Quantitative Methods*
>> *Department of Educational Psychology*
>> *The University of Texas at Austin*
>> 1912 Speedway, Stop D5800
>> Austin, TX 78712-1289
>>
>>
>>
>>
>>
>> On Thu, Jul 29, 2021 at 4:42 PM Jim Lemon <drjimlemon at gmail.com> wrote:
>>
>>> Hi Reza,
>>> Thanks for letting me know. I will get to this ASAP.
>>>
>>> Jim
>>>
>>> On Thu, Jul 29, 2021 at 11:21 PM Reza Norouzian <rnorouzian at gmail.com>
>>> wrote:
>>> >
>>> > Dear Jim,
>>> >
>>> > Thank you for the nice package. I just wanted to let you know that the
>>> `showcount = FALSE` in the `siztree` function doesn't work properly and
>>> that the function likely has a bug.
>>> >
>>> > I have reported this with a reproducible example on StackOverflow as
>>> well, and others also confirmed it.
>>> >
>>> > Thanks for your attention,
>>> > Reza
>>> > Reza Norouzian (he/him/his)
>>> > Visiting Assistant Professor, Quantitative Methods
>>> > Department of Educational Psychology
>>> > The University of Texas at Austin
>>> > 1912 Speedway, Stop D5800
>>> > Austin, TX 78712-1289
>>> >
>>> >
>>> >
>>>
>>

	[[alternative HTML version deleted]]


From drj|m|emon @end|ng |rom gm@||@com  Fri Jul 30 23:35:18 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Sat, 31 Jul 2021 07:35:18 +1000
Subject: [R] plotrix: Bug in `sizetree()` function
In-Reply-To: <CAKt3tzndQEe0rLvr-WfJL=MOOxw1KzZMtJ0ru0OSAk+vCmV57Q@mail.gmail.com>
References: <CAKt3tzks8g1xVAg0MbC9wWRvHCHE_6ciBcdMVaZQDGkzWWkMiA@mail.gmail.com>
 <CA+8X3fWwq+DRNPbxWYXdMv=SU-BLMJ=fufQP=9vWYCY-QLvx+Q@mail.gmail.com>
 <CAKt3tznT8Rmeu8xu3uVd1LZZ+hE2UkLDNeJsHiMi7i=iZ34cyA@mail.gmail.com>
 <CA+8X3fVEKWY_=5A+Oj65eWzx8cFPM0pZeiHP_34uxFRxAC8Jrw@mail.gmail.com>
 <CAKt3tzndQEe0rLvr-WfJL=MOOxw1KzZMtJ0ru0OSAk+vCmV57Q@mail.gmail.com>
Message-ID: <CA+8X3fXjndFv8UhtNvp0rwygu83PoscWgCV-iWLiF90dHO6x=Q@mail.gmail.com>

It will fix the problem by loading plotrix and then overwriting size tree:

library(plotrix)
source("<path>/sizetree.R")

Jim


On Sat, Jul 31, 2021 at 2:16 AM Reza Norouzian <rnorouzian at gmail.com> wrote:

> Thank you, Jim. Just to make sure, does the function you've shared work
> independently or it depends on the current version of the package which has
> the bug?
>
> Thanks again,
> Reza
> *Reza Norouzian (he/him/his)*
> *Visiting Assistant Professor, Quantitative Methods*
> *Department of Educational Psychology*
> *The University of Texas at Austin*
> 1912 Speedway, Stop D5800
> Austin, TX 78712-1289
>
>
>
>
>
> On Fri, Jul 30, 2021 at 12:39 AM Jim Lemon <drjimlemon at gmail.com> wrote:
>
>> Hi Reza,
>> I just had a look at that and found the problem. I had not passed the
>> "showcount" argument in the recursive calls. The attached code, which will
>> be in the next version, seems to fix it.
>>
>> Jim
>>
>> On Fri, Jul 30, 2021 at 1:06 PM Reza Norouzian <rnorouzian at gmail.com>
>> wrote:
>>
>>> Thanks a lot! In case the bug is fixed, I'd appreciate it if you could
>>> let me know.
>>>
>>> Thanks again,
>>> Reza
>>> *Reza Norouzian (he/him/his)*
>>> *Visiting Assistant Professor, Quantitative Methods*
>>> *Department of Educational Psychology*
>>> *The University of Texas at Austin*
>>> 1912 Speedway, Stop D5800
>>> Austin, TX 78712-1289
>>>
>>>
>>>
>>>
>>>
>>> On Thu, Jul 29, 2021 at 4:42 PM Jim Lemon <drjimlemon at gmail.com> wrote:
>>>
>>>> Hi Reza,
>>>> Thanks for letting me know. I will get to this ASAP.
>>>>
>>>> Jim
>>>>
>>>> On Thu, Jul 29, 2021 at 11:21 PM Reza Norouzian <rnorouzian at gmail.com>
>>>> wrote:
>>>> >
>>>> > Dear Jim,
>>>> >
>>>> > Thank you for the nice package. I just wanted to let you know that
>>>> the `showcount = FALSE` in the `siztree` function doesn't work properly and
>>>> that the function likely has a bug.
>>>> >
>>>> > I have reported this with a reproducible example on StackOverflow as
>>>> well, and others also confirmed it.
>>>> >
>>>> > Thanks for your attention,
>>>> > Reza
>>>> > Reza Norouzian (he/him/his)
>>>> > Visiting Assistant Professor, Quantitative Methods
>>>> > Department of Educational Psychology
>>>> > The University of Texas at Austin
>>>> > 1912 Speedway, Stop D5800
>>>> > Austin, TX 78712-1289
>>>> >
>>>> >
>>>> >
>>>>
>>>

	[[alternative HTML version deleted]]


From rnorouz|@n @end|ng |rom gm@||@com  Fri Jul 30 23:49:06 2021
From: rnorouz|@n @end|ng |rom gm@||@com (Reza Norouzian)
Date: Fri, 30 Jul 2021 16:49:06 -0500
Subject: [R] plotrix: Bug in `sizetree()` function
In-Reply-To: <CA+8X3fXjndFv8UhtNvp0rwygu83PoscWgCV-iWLiF90dHO6x=Q@mail.gmail.com>
References: <CAKt3tzks8g1xVAg0MbC9wWRvHCHE_6ciBcdMVaZQDGkzWWkMiA@mail.gmail.com>
 <CA+8X3fWwq+DRNPbxWYXdMv=SU-BLMJ=fufQP=9vWYCY-QLvx+Q@mail.gmail.com>
 <CAKt3tznT8Rmeu8xu3uVd1LZZ+hE2UkLDNeJsHiMi7i=iZ34cyA@mail.gmail.com>
 <CA+8X3fVEKWY_=5A+Oj65eWzx8cFPM0pZeiHP_34uxFRxAC8Jrw@mail.gmail.com>
 <CAKt3tzndQEe0rLvr-WfJL=MOOxw1KzZMtJ0ru0OSAk+vCmV57Q@mail.gmail.com>
 <CA+8X3fXjndFv8UhtNvp0rwygu83PoscWgCV-iWLiF90dHO6x=Q@mail.gmail.com>
Message-ID: <CAKt3tz=UJwgr21gihAe2LdbrzWSv8Bosr50Q_3_xdcX=v8RJ0A@mail.gmail.com>

Thanks a lot!

*Reza Norouzian (he/him/his)*
*Visiting Assistant Professor, Quantitative Methods*
*Department of Educational Psychology*
*The University of Texas at Austin*
1912 Speedway, Stop D5800
Austin, TX 78712-1289


On Fri, Jul 30, 2021 at 4:35 PM Jim Lemon <drjimlemon at gmail.com> wrote:

> It will fix the problem by loading plotrix and then overwriting size tree:
>
> library(plotrix)
> source("<path>/sizetree.R")
>
> Jim
>
>
> On Sat, Jul 31, 2021 at 2:16 AM Reza Norouzian <rnorouzian at gmail.com>
> wrote:
>
>> Thank you, Jim. Just to make sure, does the function you've shared work
>> independently or it depends on the current version of the package which has
>> the bug?
>>
>> Thanks again,
>> Reza
>> *Reza Norouzian (he/him/his)*
>> *Visiting Assistant Professor, Quantitative Methods*
>> *Department of Educational Psychology*
>> *The University of Texas at Austin*
>> 1912 Speedway, Stop D5800
>> Austin, TX 78712-1289
>>
>>
>>
>>
>>
>> On Fri, Jul 30, 2021 at 12:39 AM Jim Lemon <drjimlemon at gmail.com> wrote:
>>
>>> Hi Reza,
>>> I just had a look at that and found the problem. I had not passed the
>>> "showcount" argument in the recursive calls. The attached code, which will
>>> be in the next version, seems to fix it.
>>>
>>> Jim
>>>
>>> On Fri, Jul 30, 2021 at 1:06 PM Reza Norouzian <rnorouzian at gmail.com>
>>> wrote:
>>>
>>>> Thanks a lot! In case the bug is fixed, I'd appreciate it if you could
>>>> let me know.
>>>>
>>>> Thanks again,
>>>> Reza
>>>> *Reza Norouzian (he/him/his)*
>>>> *Visiting Assistant Professor, Quantitative Methods*
>>>> *Department of Educational Psychology*
>>>> *The University of Texas at Austin*
>>>> 1912 Speedway, Stop D5800
>>>> Austin, TX 78712-1289
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> On Thu, Jul 29, 2021 at 4:42 PM Jim Lemon <drjimlemon at gmail.com> wrote:
>>>>
>>>>> Hi Reza,
>>>>> Thanks for letting me know. I will get to this ASAP.
>>>>>
>>>>> Jim
>>>>>
>>>>> On Thu, Jul 29, 2021 at 11:21 PM Reza Norouzian <rnorouzian at gmail.com>
>>>>> wrote:
>>>>> >
>>>>> > Dear Jim,
>>>>> >
>>>>> > Thank you for the nice package. I just wanted to let you know that
>>>>> the `showcount = FALSE` in the `siztree` function doesn't work properly and
>>>>> that the function likely has a bug.
>>>>> >
>>>>> > I have reported this with a reproducible example on StackOverflow as
>>>>> well, and others also confirmed it.
>>>>> >
>>>>> > Thanks for your attention,
>>>>> > Reza
>>>>> > Reza Norouzian (he/him/his)
>>>>> > Visiting Assistant Professor, Quantitative Methods
>>>>> > Department of Educational Psychology
>>>>> > The University of Texas at Austin
>>>>> > 1912 Speedway, Stop D5800
>>>>> > Austin, TX 78712-1289
>>>>> >
>>>>> >
>>>>> >
>>>>>
>>>>

	[[alternative HTML version deleted]]


