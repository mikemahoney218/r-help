From t|m@how@rd @end|ng |rom dec@ny@gov  Wed May  1 18:57:18 2024
From: t|m@how@rd @end|ng |rom dec@ny@gov (Howard, Tim G (DEC))
Date: Wed, 1 May 2024 16:57:18 +0000
Subject: [R] De-serialization vulnerability?
In-Reply-To: <mailman.371269.1.1714125601.27921.r-help@r-project.org>
References: <mailman.371269.1.1714125601.27921.r-help@r-project.org>
Message-ID: <PH8PR09MB97902D90C360E90A059B06B3A8192@PH8PR09MB9790.namprd09.prod.outlook.com>

All, 
There seems to be a hullaboo about a vulnerability in R when deserializing untrusted data:

https://hiddenlayer.com/research/r-bitrary-code-execution

https://nvd.nist.gov/vuln/detail/CVE-2024-27322

https://www.kb.cert.org/vuls/id/238194


Apparently a fix was made for R 4.4.0, but I see no mention of it in the changes report:

https://cloud.r-project.org/bin/windows/base/NEWS.R-4.4.0.html

Is this real?  Were there changes in R 4.4.0 that aren't reported?

Of course, we should *always* update to the most recent version, but I was confused why it wasn't mentioned in the release info. 

Thanks,
Tim


From |kry|ov @end|ng |rom d|@root@org  Wed May  1 19:19:59 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Wed, 1 May 2024 20:19:59 +0300
Subject: [R] De-serialization vulnerability?
In-Reply-To: <PH8PR09MB97902D90C360E90A059B06B3A8192@PH8PR09MB9790.namprd09.prod.outlook.com>
References: <mailman.371269.1.1714125601.27921.r-help@r-project.org>
 <PH8PR09MB97902D90C360E90A059B06B3A8192@PH8PR09MB9790.namprd09.prod.outlook.com>
Message-ID: <20240501201959.0b1c65bc@Tarkus>

? Wed, 1 May 2024 16:57:18 +0000
"Howard, Tim G \(DEC\) via R-help" <r-help at r-project.org> ?????:

> Is this real?

Yes, but with a giant elephant in the room that many are overlooking.
It has actually always been much worse.

Until R-4.4.0, there used to be a way for readRDS() to return an
unevaluated "promise object". When you access the returned value, the
code attached to the promise object is evaluated. Starting with
R-4.4.0, this particular ability is now forbidden. One particular
attack is now prevented, but the whole class of attacks is still
fundamentally impossible to avoid. The resulting increase in safety is
very small.

The R data files, both those produced by save() and opened by load(),
and those produced by saveRDS() and readRDS(), contain _internal_
object state. The code processing those objects trusts the internal
object state, because it has no other alternative, no other source of
state. This is true of all of base R, CRAN and BioConductor.

Many R objects contain executable code. For example, many saved models
contain -- as part of this internal state that gets stored inside *.rds
and *.RData files -- executable expressions that produce model matrices
from data frames. It is trivial for any aspiring attacker to take such
an object and replace the model expression with one that would take over
your system. When you perform ordinary R operations on the doctored
object, the attacker-provided "model expression" instead does whatever
the attacker wants.

The above was just one example of "trusting the internal state". An
attacker can come up with similar attacks for ALTREP objects, 'glue'
strings and a lot of other features of R, without ever touching
promises (the topic of CVE-2024-27322) or exploiting parser
vulnerabilities.

One safe way to move forward is to set aside a strict subset of R Data
Serialization format that cannot be used to create any executable code
or touch potentially vulnerable state (such as ALTREP, I think) and
reject all other features of RDS. Yes, this abandons the ability to
save model objects and many other great features of R serialization,
including those that make 'parallel' clusters possible. (But we trust
our clusters and should use regular serialize() with them.) I've been
working on this today; it's very raw, not even a package yet, and it
doesn't even read some of my data correctly, but I believe it's a
secure way forward: https://codeberg.org/aitap/unserializeData

-- 
Best regards,
Ivan


From ce||ocgw @end|ng |rom gm@||@com  Wed May  1 17:32:32 2024
From: ce||ocgw @end|ng |rom gm@||@com (Carl Witthoft)
Date: Wed, 1 May 2024 11:32:32 -0400
Subject: [R] strange behavior in base::as.double
Message-ID: <CANkkNcijFELy3Ajagu6G5S+KzoKxRknFr0y+7=Xm3Up6MjbWmA@mail.gmail.com>

Hello.
I'm running R 4.4.0 on an iMac Venture 13.5.2 .   There appears to be a bug
in as.double().

Create a string with a numeric digits followed by a single letter a thru f
(as tho' it's base 16).

for  K  in (a,b,c,d, and f ) ,  as.double( '123K') returns NA
but as.double('123e') returns 123 -- or whatever the first digit is.

Please let me know if there are additional tests I can try .


thanks
Carl Witthoft

	[[alternative HTML version deleted]]


From @@r@h@go@|ee @end|ng |rom gm@||@com  Wed May  1 21:29:05 2024
From: @@r@h@go@|ee @end|ng |rom gm@||@com (Sarah Goslee)
Date: Wed, 1 May 2024 15:29:05 -0400
Subject: [R] strange behavior in base::as.double
In-Reply-To: <CANkkNcijFELy3Ajagu6G5S+KzoKxRknFr0y+7=Xm3Up6MjbWmA@mail.gmail.com>
References: <CANkkNcijFELy3Ajagu6G5S+KzoKxRknFr0y+7=Xm3Up6MjbWmA@mail.gmail.com>
Message-ID: <CAM_vjumHr=aKWTnjw2zN3z0d+00v7Xh5XgVxx6Fvx=FqasYozg@mail.gmail.com>

Hi Carl,

Not that strange: R thinks you're using scientific notation. Also not a Mac bug.

> as.double('123e')
[1] 123
> as.double('123e+0')
[1] 123
> as.double('123e+1')
[1] 1230
> as.double('123e-1')
[1] 12.3

Can you explain what you're trying to accomplish?

Sarah

On Wed, May 1, 2024 at 3:24?PM Carl Witthoft <cellocgw at gmail.com> wrote:
>
> Hello.
> I'm running R 4.4.0 on an iMac Venture 13.5.2 .   There appears to be a bug
> in as.double().
>
> Create a string with a numeric digits followed by a single letter a thru f
> (as tho' it's base 16).
>
> for  K  in (a,b,c,d, and f ) ,  as.double( '123K') returns NA
> but as.double('123e') returns 123 -- or whatever the first digit is.
>
> Please let me know if there are additional tests I can try .
>
>
> thanks
> Carl Witthoft
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
Sarah Goslee (she/her)
http://www.numberwright.com


From |kw@|mmo @end|ng |rom gm@||@com  Wed May  1 21:32:35 2024
From: |kw@|mmo @end|ng |rom gm@||@com (Iris Simmons)
Date: Wed, 1 May 2024 15:32:35 -0400
Subject: [R] strange behavior in base::as.double
In-Reply-To: <CANkkNcijFELy3Ajagu6G5S+KzoKxRknFr0y+7=Xm3Up6MjbWmA@mail.gmail.com>
References: <CANkkNcijFELy3Ajagu6G5S+KzoKxRknFr0y+7=Xm3Up6MjbWmA@mail.gmail.com>
Message-ID: <CADNULg9jX9oEdc4UYRAg_Qx_7A_PpnC5DsveT9TtwsfS3YT6_A@mail.gmail.com>

This happens because "123e" looks like exponential form. This string has no
exponent, so it gets treated as 0 exponent.

If you're interested in converting hex numbers, append 0x:

as.numeric("0x123a")

or use strtoi:

strtoi("123a", 16)

On Wed, May 1, 2024, 15:24 Carl Witthoft <cellocgw at gmail.com> wrote:

> Hello.
> I'm running R 4.4.0 on an iMac Venture 13.5.2 .   There appears to be a bug
> in as.double().
>
> Create a string with a numeric digits followed by a single letter a thru f
> (as tho' it's base 16).
>
> for  K  in (a,b,c,d, and f ) ,  as.double( '123K') returns NA
> but as.double('123e') returns 123 -- or whatever the first digit is.
>
> Please let me know if there are additional tests I can try .
>
>
> thanks
> Carl Witthoft
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed May  1 21:33:19 2024
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 1 May 2024 15:33:19 -0400
Subject: [R] strange behavior in base::as.double
In-Reply-To: <CANkkNcijFELy3Ajagu6G5S+KzoKxRknFr0y+7=Xm3Up6MjbWmA@mail.gmail.com>
References: <CANkkNcijFELy3Ajagu6G5S+KzoKxRknFr0y+7=Xm3Up6MjbWmA@mail.gmail.com>
Message-ID: <311baecb-10ae-4ad4-9d86-b2e5ebd2707d@gmail.com>

On 01/05/2024 11:32 a.m., Carl Witthoft wrote:
> Hello.
> I'm running R 4.4.0 on an iMac Venture 13.5.2 .   There appears to be a bug
> in as.double().
> 
> Create a string with a numeric digits followed by a single letter a thru f
> (as tho' it's base 16).
> 
> for  K  in (a,b,c,d, and f ) ,  as.double( '123K') returns NA
> but as.double('123e') returns 123 -- or whatever the first digit is.
> 
> Please let me know if there are additional tests I can try .

This has been mentioned in the news recently.  123e was taken as 
scientific format, with an implied 0 at the end, i.e. 123e0.  That is no 
longer true after the recent fix; I'm not sure if it is in R 
4.4.0-patched yet.

Duncan Murdoch


From |kry|ov @end|ng |rom d|@root@org  Wed May  1 21:48:44 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Wed, 1 May 2024 22:48:44 +0300
Subject: [R] strange behavior in base::as.double
In-Reply-To: <CANkkNcijFELy3Ajagu6G5S+KzoKxRknFr0y+7=Xm3Up6MjbWmA@mail.gmail.com>
References: <CANkkNcijFELy3Ajagu6G5S+KzoKxRknFr0y+7=Xm3Up6MjbWmA@mail.gmail.com>
Message-ID: <20240501224844.14da6394@Tarkus>

? Wed, 1 May 2024 11:32:32 -0400
Carl Witthoft <cellocgw at gmail.com> ?????:

> but as.double('123e') returns 123 -- or whatever the first digit is.

Nicely spotted problem!

Prof. Brian D. Ripley has fixed it in R-devel revision 86436 [*]. Now
as.double('123e') will also return NA. I think that the fix will become
part of R-4.4.1 when it's released.

-- 
Best regards,
Ivan

[*]
https://github.com/r-devel/r-svn/commit/9069a729f5bf69de8250a4c91dd482fcf64e1154


From pd@|gd @end|ng |rom gm@||@com  Thu May  2 11:31:43 2024
From: pd@|gd @end|ng |rom gm@||@com (peter dalgaard)
Date: Thu, 2 May 2024 11:31:43 +0200
Subject: [R] De-serialization vulnerability?
In-Reply-To: <PH8PR09MB97902D90C360E90A059B06B3A8192@PH8PR09MB9790.namprd09.prod.outlook.com>
References: <mailman.371269.1.1714125601.27921.r-help@r-project.org>
 <PH8PR09MB97902D90C360E90A059B06B3A8192@PH8PR09MB9790.namprd09.prod.outlook.com>
Message-ID: <4E6EDAB7-070D-4F93-9C5D-4EDDF3F2823A@gmail.com>

As a general matter, security holes are usually not advertised by detailing them in the NEWS file. 

The disclosure of such things goes on a different schedule, typically _after_ binaries are out, at which point editing the NEWS file is too late. 

There are other things that do not go into NEWS: Documentation fixups, etc. What does go in is end-user visible functional changes and items that have an explicit PR# against them. 

- Peter D. 



> On 1 May 2024, at 18:57 , Howard, Tim G (DEC) via R-help <r-help at r-project.org> wrote:
> 
> All, 
> There seems to be a hullaboo about a vulnerability in R when deserializing untrusted data:
> 
> https://hiddenlayer.com/research/r-bitrary-code-execution
> 
> https://nvd.nist.gov/vuln/detail/CVE-2024-27322
> 
> https://www.kb.cert.org/vuls/id/238194
> 
> 
> Apparently a fix was made for R 4.4.0, but I see no mention of it in the changes report:
> 
> https://cloud.r-project.org/bin/windows/base/NEWS.R-4.4.0.html
> 
> Is this real?  Were there changes in R 4.4.0 that aren't reported?
> 
> Of course, we should *always* update to the most recent version, but I was confused why it wasn't mentioned in the release info. 
> 
> Thanks,
> Tim
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From e@tev@@m @end|ng |rom weh|@edu@@u  Fri May  3 02:42:43 2024
From: e@tev@@m @end|ng |rom weh|@edu@@u (Miguel Esteva)
Date: Fri, 3 May 2024 00:42:43 +0000
Subject: [R] grDevices segfault when building R4.4.0 on RHEL 9.1.
Message-ID: <MEYP282MB23414408289F6E94466AFDCFDA1F2@MEYP282MB2341.AUSP282.PROD.OUTLOOK.COM>

Hi all,

I seem to be getting segfaults when attempting to build R 4.4.0 on RHEL 9.1 (5.14.0-162.23.1.el9_1.x86_64). Interestingly, it seems to build ok on Rocky 9.1 and 9.3. This is the trace:


make[3]: Entering directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices'

building package 'grDevices'

make[4]: Entering directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices'

all.R is unchanged

make[4]: Leaving directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices'

make[4]: Entering directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices'

make[5]: Entering directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices/src'

make[6]: Entering directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices/src'

../../../../library/grDevices/libs/grDevices.so is unchanged

make[7]: Entering directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices/src/cairo'

make[8]: Entering directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices/src/cairo'

make[9]: Entering directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices/src/cairo'

make[9]: 'cairo.so' is up to date.

make[9]: Leaving directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices/src/cairo'

make[8]: Leaving directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices/src/cairo'

make[7]: Leaving directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices/src/cairo'

make[6]: Leaving directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices/src'

make[5]: Leaving directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices/src'

make[4]: Leaving directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices'

make[4]: Entering directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices'
byte-compiling package 'grDevices'


 *** caught segfault ***

address 0x1801fa8f70, cause 'memory not mapped'


Traceback:

 1: solve.default(rgb)

 2: solve(rgb)

 3: drop(whitexyz %*% solve(rgb))

 4: make.rgb(red = c(0.625, 0.34), green = c(0.28, 0.595), blue = c(0.155,     0.07), gamma = 1.8, white = "D65", name = "Apple RGB")

 5: eval(exprs[i], envir)

 6: eval(exprs[i], envir)

 7: sys.source(codeFile, env, keep.source = keep.source, keep.parse.data = keep.parse.data)

 8: doTryCatch(return(expr), name, parentenv, handler)

 9: tryCatchOne(expr, names, parentenv, handlers[[1L]])

10: tryCatchList(expr, classes, parentenv, handlers)

11: tryCatch(expr, error = function(e) {    call <- conditionCall(e)    if (!is.null(call)) {        if (identical(call[[1L]], quote(doTryCatch)))             call <- sys.call(-4L)        dcall <- deparse(call, nlines = 1L)        prefix <- paste("Error in", dcall, ": ")        LONG <- 75L        sm <- strsplit(conditionMessage(e), "\n")[[1L]]        w <- 14L + nchar(dcall, type = "w") + nchar(sm[1L], type = "w")        if (is.na(w))             w <- 14L + nchar(dcall, type = "b") + nchar(sm[1L],                 type = "b")        if (w > LONG)             prefix <- paste0(prefix, "\n  ")    }    else prefix <- "Error : "    msg <- paste0(prefix, conditionMessage(e), "\n")    .Internal(seterrmessage(msg[1L]))    if (!silent && isTRUE(getOption("show.error.messages"))) {        cat(msg, file = outFile)        .Internal(printDeferredWarnings())    }    invisible(structure(msg, class = "try-error", condition = e))})

12: try(sys.source(codeFile, env, keep.source = keep.source, keep.parse.data = keep.parse.data))

13: loadNamespace(package = package, lib.loc = lib.loc, keep.source = keep.source,     keep.parse.data = keep.parse.data, partial = TRUE)

14: withCallingHandlers(expr, packageStartupMessage = function(c) tryInvokeRestart("muffleMessage"))

15: suppressPackageStartupMessages(loadNamespace(package = package,     lib.loc = lib.loc, keep.source = keep.source, keep.parse.data = keep.parse.data,     partial = TRUE))

16: code2LazyLoadDB(package, lib.loc = lib.loc, keep.source = keep.source,     keep.parse.data = keep.parse.data, compress = compress, set.install.dir = set.install.dir)

17: tools:::makeLazyLoading("grDevices")

An irrecoverable exception occurred. R is aborting now ...

make[4]: *** [../../../share/make/lazycomp.mk:9: ../../../library/grDevices/R/grDevices.rdb] Error 139

make[4]: Leaving directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices'

make[3]: *** [Makefile:28: all] Error 2

make[3]: Leaving directory '/home/esteva.m/R/R-4.4.0/src/library/grDevices'

make[2]: *** [Makefile:39: R] Error 1

make[2]: Leaving directory '/home/esteva.m/R/R-4.4.0/src/library'

make[1]: *** [Makefile:28: R] Error 1

make[1]: Leaving directory '/home/esteva.m/R/R-4.4.0/src'

make: *** [Makefile:62: R] Error 1


Has anyone run into this?

cairo-1.17.4-7.el9.x86_64
cairo-gobject-1.17.4-7.el9.x86_64
cairo-devel-1.17.4-7.el9.x86_64
cairo-gobject-devel-1.17.4-7.el9.x86_64
pango-1.48.7-3.el9.x86_64
pango-devel-1.48.7-3.el9.x86_64

Cheers,


Miguel Esteva


[WEHI Logo]


Walter and Eliza Hall Institute of Medical Research
1G Royal Parade Parkville Victoria 3052 Australia

www.wehi.edu.au<https://wehi.edu.au>

Twitter<https://twitter.com/WEHI_research>  |  Facebook<https://www.facebook.com/WEHIresearch/>  |  Instagram<https://www.instagram.com/wehi_research>  |  Youtube<https://www.youtube.com/user/WEHImovies>  |  LinkedIn<https://www.linkedin.com/company/wehi_research>


WEHI acknowledges the Wurundjeri people of the Kulin Nation as the traditional owners of the land where our campuses are located and the continuing connection to country and community.

Private and confidential
The content of this e-mail and any attachments may be private and confidential, intended only for use of the individual or entity named. If you are not the intended recipient of this message you must not read, forward, print, copy, disclose, use or store in any way the information this e-mail or any attachment contains. If you are not the intended recipient, please notify the sender immediately and delete or destroy all copies of this e-mail and any attachment.

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Fri May  3 13:40:59 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Fri, 3 May 2024 14:40:59 +0300
Subject: [R] grDevices segfault when building R4.4.0 on RHEL 9.1.
In-Reply-To: <MEYP282MB23414408289F6E94466AFDCFDA1F2@MEYP282MB2341.AUSP282.PROD.OUTLOOK.COM>
References: <MEYP282MB23414408289F6E94466AFDCFDA1F2@MEYP282MB2341.AUSP282.PROD.OUTLOOK.COM>
Message-ID: <20240503144059.58281559@arachnoid>

Dear Miguel Esteva,

I couldn't get a Red Hat "ubi9" container to install enough
dependencies to build R. Is there a way to reproduce your setup on a
virtual machine somewhere?

On Fri, 3 May 2024 00:42:43 +0000
Miguel Esteva via R-help <r-help at r-project.org> wrote:

>  *** caught segfault ***
> 
> address 0x1801fa8f70, cause 'memory not mapped'
> 
> 
> Traceback:
> 
>  1: solve.default(rgb)

This seems to crash inside the BLAS. Which BLAS are you using? Any
custom ./configure arguments? Which compilers are you running?

To find out more information about the crash, try to follow it with a
debugger. Change directory to src/library/grDevices and run:

_R_COMPILE_PKGS_=1 R_COMPILER_SUPPRESS_ALL=1 \
 R_DEFAULT_PACKAGES=NULL LC_ALL=C \
../../../bin/R -d gdb --vanilla --no-echo -e \
 'tools:::makeLazyLoading("grDevices")'

(This assumes building straight from the source directory. Adjust the
paths if you're using a separate build directory.)

Use the "run" command to start the process. One you see a crash, use
"backtrace" to see the state of the call stack at the place of the
crash, or "backtrace full" to include the contents of local variables.
The first few entries are probably the most important ones.

Not sure what to do with this information yet, but it might provide
more clues.

-- 
Best regards,
Ivan


From tb|e|@kov@ @end|ng |rom @tudent@ethz@ch  Fri May  3 13:29:19 2024
From: tb|e|@kov@ @end|ng |rom @tudent@ethz@ch (Bielakova  Tatiana)
Date: Fri, 3 May 2024 11:29:19 +0000
Subject: [R] Using intervals() function for nlme model - Statistics Lab ETHZ
Message-ID: <9a74d1234c254b40b9a7d5cd119ba08a@student.ethz.ch>

Dear members of the R-Help Team,


we are reaching out to you with a question regarding using intervals()<https://www.rdocumentation.org/packages/nlme/versions/3.1-163/topics/intervals> to create inference for nlme()<https://www.rdocumentation.org/packages/nlme/versions/3.1-164/topics/nlme> function.

The maintainer for the nlme package is listed as the R-Core Team and we were advised by moderators of R-Core to write to R-Help to receive help in this case.


We are students of Statistics at ETH Zurich currently collaborating with ETH Crop Science lab on a project focused on soybean growth. We are modelling the growth using the nlme function and are facing the issue of creating a valid inference for the nlme model (we are especially interested in confidence intervals for the fixed effects).


Based on the documentation of nlme package, the function interval is supported for gls, lme, and lmList classes. Although nlme is not mentioned, we still receive intervals without any errors or warnings.


We would be therefore very grateful if you could offer your insights on the following questions:

  *   Is the intervals() function appropriate for nlme to create confidence intervals?

  *   If not, what do the outputted values represent?

  *   Do you have any other recommendations/ ideas on how should we proceed to calculate intervals in R (e.g. more suitable packages)?


Your help is greatly appreciated.


We are looking forward to hearing back from you!



Yours sincerely,

Tatiana, Marvin & Paul

from

Statistics Lab


	[[alternative HTML version deleted]]


From dynvec @end|ng |rom gm@||@com  Fri May  3 14:47:27 2024
From: dynvec @end|ng |rom gm@||@com (DynV Montrealer)
Date: Fri, 3 May 2024 08:47:27 -0400
Subject: [R] Get a copy of a matrix only for TRUE entries of a matching size
 boolean matrix?
Message-ID: <CAGYhDoM=Y2Wn4LbigoJYEdALQTR3rMw4UriP0oPXJqvtCLmNDQ@mail.gmail.com>

Is there a way to get a copy of a matrix only for TRUE entries of a
matching size boolean matrix? For *example*:
> mat_letters <- matrix(data=c('A', 'B', 'C', 'D'), ncol=2, byrow=TRUE)
> mat_letters
     [,1] [,2]
[1,] "A"  "B"
[2,] "C"  "D"
> mat_bools <- matrix(data=c(FALSE, TRUE, TRUE, FALSE), ncol=2, byrow=TRUE)
> mat_bools
      [,1]  [,2]
[1,] FALSE  TRUE
[2,]  TRUE FALSE
*Reminder:* The following is only an example ; the solution might look very
different.
some_command(mat_letters, mat_bools, false=empty)
     [,1] [,2]
[1,] ""  "B"
[2,] "C"  ""
some_command(mat_letters, mat_bools, false=na)
     [,1] [,2]
[1,] NA  "B"
[2,] "C"  NA

Thank you kindly

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Fri May  3 16:24:15 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Fri, 3 May 2024 10:24:15 -0400
Subject: [R] 
 Get a copy of a matrix only for TRUE entries of a matching size
 boolean matrix?
In-Reply-To: <CAGYhDoM=Y2Wn4LbigoJYEdALQTR3rMw4UriP0oPXJqvtCLmNDQ@mail.gmail.com>
References: <CAGYhDoM=Y2Wn4LbigoJYEdALQTR3rMw4UriP0oPXJqvtCLmNDQ@mail.gmail.com>
Message-ID: <d1e0fd9d-906f-4718-a726-896731bee87d@gmail.com>

   In two steps:

result <- matrix(NA_character_,
    nrow=nrow(mat_letters), ncol =ncol(mat_letters))
result[mat_bools] <- mat_letters[mat_bools]

On 2024-05-03 8:47 a.m., DynV Montrealer wrote:
> Is there a way to get a copy of a matrix only for TRUE entries of a
> matching size boolean matrix? For *example*:
>> mat_letters <- matrix(data=c('A', 'B', 'C', 'D'), ncol=2, byrow=TRUE)
>> mat_letters
>       [,1] [,2]
> [1,] "A"  "B"
> [2,] "C"  "D"
>> mat_bools <- matrix(data=c(FALSE, TRUE, TRUE, FALSE), ncol=2, byrow=TRUE)
>> mat_bools
>        [,1]  [,2]
> [1,] FALSE  TRUE
> [2,]  TRUE FALSE
> *Reminder:* The following is only an example ; the solution might look very
> different.
> some_command(mat_letters, mat_bools, false=empty)
>       [,1] [,2]
> [1,] ""  "B"
> [2,] "C"  ""
> some_command(mat_letters, mat_bools, false=na)
>       [,1] [,2]
> [1,] NA  "B"
> [2,] "C"  NA
> 
> Thank you kindly
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m@rc_grt @end|ng |rom y@hoo@|r  Fri May  3 16:28:26 2024
From: m@rc_grt @end|ng |rom y@hoo@|r (Marc Girondot)
Date: Fri, 3 May 2024 16:28:26 +0200
Subject: [R] 
 Get a copy of a matrix only for TRUE entries of a matching size
 boolean matrix?
In-Reply-To: <CAGYhDoM=Y2Wn4LbigoJYEdALQTR3rMw4UriP0oPXJqvtCLmNDQ@mail.gmail.com>
References: <CAGYhDoM=Y2Wn4LbigoJYEdALQTR3rMw4UriP0oPXJqvtCLmNDQ@mail.gmail.com>
Message-ID: <1fea204c-b71c-4a92-ae13-1dfcf6874357@yahoo.fr>

Is it what you want ?
mat_letters <- matrix(data=c('A', 'B', 'C', 'D'), ncol=2, byrow=TRUE)
mat_bools <- matrix(data=c(FALSE, TRUE, TRUE, FALSE), ncol=2, byrow=TRUE)

ifelse(mat_bools, mat_letters, "")
ifelse(mat_bools, mat_letters, NA)

 > ifelse(mat_bools, mat_letters, "")
 ???? [,1] [,2]
[1,] ""?? "B"
[2,] "C"? ""
 > ifelse(mat_bools, mat_letters, NA)
 ???? [,1] [,2]
[1,] NA?? "B"
[2,] "C"? NA

Marc



Le 03/05/2024 ? 14:47, DynV Montrealer a ?crit?:
> Is there a way to get a copy of a matrix only for TRUE entries of a
> matching size boolean matrix? For*example*:
>> mat_letters <- matrix(data=c('A', 'B', 'C', 'D'), ncol=2, byrow=TRUE)
>> mat_letters
>       [,1] [,2]
> [1,] "A"  "B"
> [2,] "C"  "D"
>> mat_bools <- matrix(data=c(FALSE, TRUE, TRUE, FALSE), ncol=2, byrow=TRUE)
>> mat_bools
>        [,1]  [,2]
> [1,] FALSE  TRUE
> [2,]  TRUE FALSE
> *Reminder:* The following is only an example ; the solution might look very
> different.
> some_command(mat_letters, mat_bools, false=empty)
>       [,1] [,2]
> [1,] ""  "B"
> [2,] "C"  ""
> some_command(mat_letters, mat_bools, false=na)
>       [,1] [,2]
> [1,] NA  "B"
> [2,] "C"  NA


	[[alternative HTML version deleted]]


From dynvec @end|ng |rom gm@||@com  Fri May  3 16:39:10 2024
From: dynvec @end|ng |rom gm@||@com (DynV Montrealer)
Date: Fri, 3 May 2024 10:39:10 -0400
Subject: [R] 
 Get a copy of a matrix only for TRUE entries of a matching size
 boolean matrix?
In-Reply-To: <1fea204c-b71c-4a92-ae13-1dfcf6874357@yahoo.fr>
References: <CAGYhDoM=Y2Wn4LbigoJYEdALQTR3rMw4UriP0oPXJqvtCLmNDQ@mail.gmail.com>
 <1fea204c-b71c-4a92-ae13-1dfcf6874357@yahoo.fr>
Message-ID: <CAGYhDoN66pmeMj88LvATmn+jN-VowSH4+mJfgi5kLXJGGThGmg@mail.gmail.com>

It's exactly what I was looking for, thanks.  I'm replying to the whole
list so others can skip this question, to not waste time on it.

Bonne fin de journ?e de Montr?al (nous sommes le matin ici)

On Fri, May 3, 2024 at 10:30?AM Marc Girondot <marc_grt at yahoo.fr> wrote:

> Is it what you want ?
> mat_letters <- matrix(data=c('A', 'B', 'C', 'D'), ncol=2, byrow=TRUE)
> mat_bools <- matrix(data=c(FALSE, TRUE, TRUE, FALSE), ncol=2, byrow=TRUE)
>
> ifelse(mat_bools, mat_letters, "")
> ifelse(mat_bools, mat_letters, NA)
>
> > ifelse(mat_bools, mat_letters, "")
>      [,1] [,2]
> [1,] ""   "B"
> [2,] "C"  ""
> > ifelse(mat_bools, mat_letters, NA)
>      [,1] [,2]
> [1,] NA   "B"
> [2,] "C"  NA
>
> Marc
>
>
>
> Le 03/05/2024 ? 14:47, DynV Montrealer a ?crit :
>
> Is there a way to get a copy of a matrix only for TRUE entries of a
> matching size boolean matrix? For **example**:
>
> mat_letters <- matrix(data=c('A', 'B', 'C', 'D'), ncol=2, byrow=TRUE)
> mat_letters
>
>      [,1] [,2]
> [1,] "A"  "B"
> [2,] "C"  "D"
>
> mat_bools <- matrix(data=c(FALSE, TRUE, TRUE, FALSE), ncol=2, byrow=TRUE)
> mat_bools
>
>       [,1]  [,2]
> [1,] FALSE  TRUE
> [2,]  TRUE FALSE
> *Reminder:* The following is only an example ; the solution might look very
> different.
> some_command(mat_letters, mat_bools, false=empty)
>      [,1] [,2]
> [1,] ""  "B"
> [2,] "C"  ""
> some_command(mat_letters, mat_bools, false=na)
>      [,1] [,2]
> [1,] NA  "B"
> [2,] "C"  NA
>
>
>

	[[alternative HTML version deleted]]


From Ro@@@Boy|@n @end|ng |rom uc@|@edu  Fri May  3 21:45:08 2024
From: Ro@@@Boy|@n @end|ng |rom uc@|@edu (Boylan, Ross)
Date: Fri, 3 May 2024 19:45:08 +0000
Subject: [R] R CMD check vs RStudio check
Message-ID: <BY3PR05MB811689B81D4EAFBEC54F3ED5871F2@BY3PR05MB8116.namprd05.prod.outlook.com>

I am trying to figure out why checking my package is deleting my inst/doc/ directory when I do it in RStudio.  Along the way I've hit another puzzle.
In RStudio the check runs and is mostly OK, aside from the deletion.  But when I try with vanilla R, the check fails almost immediately:
-------------------------powershell---------------------------
PS C:\Users\rdboylan\Documents\BP\pimex> & $R CMD check .
* using log directory 'C:/Users/rdboylan/Documents/BP/pimex/..Rcheck'
* using R version 4.3.3 (2024-02-29 ucrt)
* using platform: x86_64-w64-mingw32 (64-bit)
* R was compiled by
    gcc.exe (GCC) 12.3.0
    GNU Fortran (GCC) 12.3.0
* running under: Windows Server 2019 x64 (build 17763)
* using session charset: ISO8859-1
* checking for file './DESCRIPTION' ... ERROR
Required fields missing or empty:
  'Author' 'Maintainer'
* DONE

Status: 1 ERROR
See
  'C:/Users/rdboylan/Documents/BP/pimex/..Rcheck/00check.log'
for details.

PS C:\Users\rdboylan\Documents\BP\pimex> $R
C:\Program Files\R\R-4.3.3\bin\R.exe
---------------------------------------------------------------

The DESCRIPTION file includes
Authors at R: 
    utils::person("Ross", "Boylan",
    email = "ross.boylan at ucsf.edu",
    role = c("aut", "cre", "cph")
    )
but no separate Author or Maintainer field.

RStudio is using devtools::check; I don't know if it is doing anything extra beyond that.

I expected that the various ways of running check would be similar, or at least approve of the same DESCRIPTION file.  Can anyone help me understand what is going on, and how I can isolate the source of my problem?

Initially the problem with the directory deletion appeared running check in RStudio; I believe RStudio calls devtools::check, which I assume ultimately does the equivalent of R CMD check. The build invokes a bootstrap.R script I wrote, which in turn runs LyX. And I'm not sure which of these is responsible for deleting the directory.  When I invoke bootstrap.R directly from RStudio LyX runs and nothing is deleted.

R 4.3.3; RStudio 2023.12.1+402; Windows Server 2019 Standard v1809.

P.S. What's with the "..Rcheck" log directory, which appears literally with the 2 dots?  Is this just MS-Windows getting confused and not interpreting .. as the parent directory?


From |kry|ov @end|ng |rom d|@root@org  Fri May  3 21:52:26 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Fri, 3 May 2024 22:52:26 +0300
Subject: [R] R CMD check vs RStudio check
In-Reply-To: <BY3PR05MB811689B81D4EAFBEC54F3ED5871F2@BY3PR05MB8116.namprd05.prod.outlook.com>
References: <BY3PR05MB811689B81D4EAFBEC54F3ED5871F2@BY3PR05MB8116.namprd05.prod.outlook.com>
Message-ID: <20240503225226.3c45e047@Tarkus>

? Fri, 3 May 2024 19:45:08 +0000
"Boylan, Ross via R-help" <r-help at r-project.org> ?????:

> & $R CMD check .

> * checking for file './DESCRIPTION' ... ERROR
> Required fields missing or empty:
>   'Author' 'Maintainer'

You're checking a source package directory. This could work, but it's
much easier and more reliable to (1) build a source tarball using R CMD
build and (2) check the tarball. This is probably part of what
devtools::check() does. (It can also do a lot of other things pre-R CMD
build.)

The reason checking the source directory is failing is because it's R
CMD build that creates the necessary 'Author' and 'Maintainer' fields
from Authors at R in your DESCRIPTION.

> P.S. What's with the "..Rcheck" log directory, which appears
> literally with the 2 dots?  Is this just MS-Windows getting confused
> and not interpreting .. as the parent directory?

"..Rcheck" is built from the argument of R CMD check . followed by
".Rcheck".

-- 
Best regards,
Ivan


From th|erry@onke||nx @end|ng |rom |nbo@be  Mon May  6 08:45:57 2024
From: th|erry@onke||nx @end|ng |rom |nbo@be (Thierry Onkelinx)
Date: Mon, 6 May 2024 08:45:57 +0200
Subject: [R] [R-sig-ME] lmer error: number of observations <= number of
 random effects
In-Reply-To: <CAMvZauqY=naWQtSgfp+JtX73vB5+Sm3pO=iv6P6ujNGQHcg5WQ@mail.gmail.com>
References: <CAMvZauqY=naWQtSgfp+JtX73vB5+Sm3pO=iv6P6ujNGQHcg5WQ@mail.gmail.com>
Message-ID: <CAJuCY5ysmodQ=Jt8UGSuimNyz66WS9MAxdxWv4fttrM6O1Tw5A@mail.gmail.com>

Dear Srinidhi,

You are trying to fit 1 random intercept and 2 random slopes per
individual, while you have at most 3 observations per individual. You
simply don't have enough data to fit the random slopes. Reduce the random
part to (1|ID).

Best regards,

Thierry

ir. Thierry Onkelinx
Statisticus / Statistician

Vlaamse Overheid / Government of Flanders
INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND
FOREST
Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
thierry.onkelinx at inbo.be
Havenlaan 88 bus 73, 1000 Brussel
*Postadres:* Koning Albert II-laan 15 bus 186, 1210 Brussel
*Poststukken die naar dit adres worden gestuurd, worden ingescand en
digitaal aan de geadresseerde bezorgd. Zo kan de Vlaamse overheid haar
dossiers volledig digitaal behandelen. Poststukken met de vermelding
?vertrouwelijk? worden niet ingescand, maar ongeopend aan de geadresseerde
bezorgd.*
www.inbo.be

///////////////////////////////////////////////////////////////////////////////////////////
To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey
///////////////////////////////////////////////////////////////////////////////////////////

<https://www.inbo.be>


Op ma 6 mei 2024 om 01:59 schreef Srinidhi Jayakumar via R-sig-mixed-models
<r-sig-mixed-models at r-project.org>:

> I am running a multilevel growth curve model to examine predictors of
> social anhedonia (SA) trajectory through ages 12, 15 and 18. SA is a
> continuous numeric variable. The age variable (Index1) has been coded as 0
> for age 12, 1 for age 15 and 2 for age 18. I am currently using a time
> varying predictor, stress (LSI), which was measured at ages 12, 15 and 18,
> to examine whether trajectory/variation in LSI predicts difference in SA
> trajectory. LSI is a continuous numeric variable and was grand-mean
> centered before using in the models. The data has been converted to long
> format with SA in 1 column, LSI in the other, ID in another, and age in
> another column. I used the code below to run my model using lmer. However,
> I get the following error. Please let me know how I can solve this error.
> Please note that I have 50% missing data in SA at age 12.
> modelLSI_maineff_RE <- lmer(SA ~ Index1* LSI+ (1 + Index1+LSI |ID), data =
> LSIDATA, control = lmerControl(optimizer ="bobyqa"), REML=TRUE)
> summary(modelLSI_maineff_RE)
> Error: number of observations (=1080) <= number of random effects (=1479)
> for term (1 + Index1 + LSI | ID); the random-effects parameters and the
> residual variance (or scale parameter) are probably unidentifiable
>
> I did test the within-person variance for the LSI variable and the
> within-person variance is significant from the Greenhouse-Geisser,
> Hyunh-Feidt tests.
>
> I also tried control = lmerControl(check.nobs.vs.nRE = "ignore") which gave
> me the following output. modelLSI_maineff_RE <- lmer(SA ~ Index1* LSI+ (1 +
> Index1+LSI |ID), data = LSIDATA, control = lmerControl(check.nobs.vs.nRE =
> "ignore", optimizer ="bobyqa", check.conv.singular = .makeCC(action =
> "ignore", tol = 1e-4)), REML=TRUE)
>
> summary(modelLSI_maineff_RE)
> Linear mixed model fit by REML. t-tests use Satterthwaite's method
> ['lmerModLmerTest']
> Formula: SA ~ Index1 * LSI + (1 + Index1 + LSI | ID)
> Data: LSIDATA
> Control: lmerControl(check.nobs.vs.nRE = "ignore", optimizer = "bobyqa",
> check.conv.singular = .makeCC(action = "ignore", tol = 1e-04))
>
> REML criterion at convergence: 7299.6
>
> Scaled residuals:
> Min 1Q Median 3Q Max
> -2.7289 -0.4832 -0.1449 0.3604 4.5715
>
> Random effects:
> Groups Name Variance Std.Dev. Corr
> ID (Intercept) 30.2919 5.5038
> Index1 2.4765 1.5737 -0.15
> LSI 0.1669 0.4085 -0.23 0.70
> Residual 24.1793 4.9172
> Number of obs: 1080, groups: ID, 493
>
> Fixed effects:
> Estimate Std. Error df t value Pr(>|t|)
> (Intercept) 24.68016 0.39722 313.43436 62.133 < 2e-16 ***
> Index1 0.98495 0.23626 362.75018 4.169 3.83e-05 ***
> LSI -0.05197 0.06226 273.85575 -0.835 0.4046
> Index1:LSI 0.09797 0.04506 426.01185 2.174 0.0302 *
> Signif. codes: 0 ?? 0.001 ?? 0.01 ?? 0.05 ?.? 0.1 ? ? 1
>
> Correlation of Fixed Effects:
> (Intr) Index1 LSI
> Index1 -0.645
> LSI -0.032 0.057
> Index1:LSI 0.015 0.037 -0.695
>
> I am a little vary of the output still as the error states that I have
> equal observations as the number of random effects (i.e., 3 observations
> per ID and 3 random effects). Hence, I am wondering whether I can simplify
> the model as either of the below models and choose the one with the
> best-fit statistics:
>
>  modelLSI2 <- lmer(SA ~ Index1* LSI+ (1 |ID)+ (Index1+LSI -1|ID),data =
> LSIDATA, control = lmerControl(optimizer ="bobyqa"), REML=TRUE) *OR*
>
> modelLSI3 <- lmer(SA ~ Index1* LSI+ (1+LSI |ID),data = LSIDATA, control =
> lmerControl(optimizer ="bobyqa"), REML=TRUE) [image: example of dataset]
> <https://i.sstatic.net/JcRKS2C9.png>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>

	[[alternative HTML version deleted]]


From @r|n|dh|@j@y@kum@r @end|ng |rom @tonybrook@edu  Mon May  6 01:58:35 2024
From: @r|n|dh|@j@y@kum@r @end|ng |rom @tonybrook@edu (Srinidhi Jayakumar)
Date: Sun, 5 May 2024 19:58:35 -0400
Subject: [R] lmer error: number of observations <= number of random effects
Message-ID: <CAMvZauqY=naWQtSgfp+JtX73vB5+Sm3pO=iv6P6ujNGQHcg5WQ@mail.gmail.com>

I am running a multilevel growth curve model to examine predictors of
social anhedonia (SA) trajectory through ages 12, 15 and 18. SA is a
continuous numeric variable. The age variable (Index1) has been coded as 0
for age 12, 1 for age 15 and 2 for age 18. I am currently using a time
varying predictor, stress (LSI), which was measured at ages 12, 15 and 18,
to examine whether trajectory/variation in LSI predicts difference in SA
trajectory. LSI is a continuous numeric variable and was grand-mean
centered before using in the models. The data has been converted to long
format with SA in 1 column, LSI in the other, ID in another, and age in
another column. I used the code below to run my model using lmer. However,
I get the following error. Please let me know how I can solve this error.
Please note that I have 50% missing data in SA at age 12.
modelLSI_maineff_RE <- lmer(SA ~ Index1* LSI+ (1 + Index1+LSI |ID), data =
LSIDATA, control = lmerControl(optimizer ="bobyqa"), REML=TRUE)
summary(modelLSI_maineff_RE)
Error: number of observations (=1080) <= number of random effects (=1479)
for term (1 + Index1 + LSI | ID); the random-effects parameters and the
residual variance (or scale parameter) are probably unidentifiable

I did test the within-person variance for the LSI variable and the
within-person variance is significant from the Greenhouse-Geisser,
Hyunh-Feidt tests.

I also tried control = lmerControl(check.nobs.vs.nRE = "ignore") which gave
me the following output. modelLSI_maineff_RE <- lmer(SA ~ Index1* LSI+ (1 +
Index1+LSI |ID), data = LSIDATA, control = lmerControl(check.nobs.vs.nRE =
"ignore", optimizer ="bobyqa", check.conv.singular = .makeCC(action =
"ignore", tol = 1e-4)), REML=TRUE)

summary(modelLSI_maineff_RE)
Linear mixed model fit by REML. t-tests use Satterthwaite's method
['lmerModLmerTest']
Formula: SA ~ Index1 * LSI + (1 + Index1 + LSI | ID)
Data: LSIDATA
Control: lmerControl(check.nobs.vs.nRE = "ignore", optimizer = "bobyqa",
check.conv.singular = .makeCC(action = "ignore", tol = 1e-04))

REML criterion at convergence: 7299.6

Scaled residuals:
Min 1Q Median 3Q Max
-2.7289 -0.4832 -0.1449 0.3604 4.5715

Random effects:
Groups Name Variance Std.Dev. Corr
ID (Intercept) 30.2919 5.5038
Index1 2.4765 1.5737 -0.15
LSI 0.1669 0.4085 -0.23 0.70
Residual 24.1793 4.9172
Number of obs: 1080, groups: ID, 493

Fixed effects:
Estimate Std. Error df t value Pr(>|t|)
(Intercept) 24.68016 0.39722 313.43436 62.133 < 2e-16 ***
Index1 0.98495 0.23626 362.75018 4.169 3.83e-05 ***
LSI -0.05197 0.06226 273.85575 -0.835 0.4046
Index1:LSI 0.09797 0.04506 426.01185 2.174 0.0302 *
Signif. codes: 0 ?? 0.001 ?? 0.01 ?? 0.05 ?.? 0.1 ? ? 1

Correlation of Fixed Effects:
(Intr) Index1 LSI
Index1 -0.645
LSI -0.032 0.057
Index1:LSI 0.015 0.037 -0.695

I am a little vary of the output still as the error states that I have
equal observations as the number of random effects (i.e., 3 observations
per ID and 3 random effects). Hence, I am wondering whether I can simplify
the model as either of the below models and choose the one with the
best-fit statistics:

 modelLSI2 <- lmer(SA ~ Index1* LSI+ (1 |ID)+ (Index1+LSI -1|ID),data =
LSIDATA, control = lmerControl(optimizer ="bobyqa"), REML=TRUE) *OR*

modelLSI3 <- lmer(SA ~ Index1* LSI+ (1+LSI |ID),data = LSIDATA, control =
lmerControl(optimizer ="bobyqa"), REML=TRUE) [image: example of dataset]
<https://i.sstatic.net/JcRKS2C9.png>

	[[alternative HTML version deleted]]


From tr@@h|@ket @end|ng |rom gm@||@com  Mon May  6 09:11:15 2024
From: tr@@h|@ket @end|ng |rom gm@||@com (TT FF)
Date: Mon, 6 May 2024 08:11:15 +0100
Subject: [R] [R-sig-ME] lmer error: number of observations <= number of
 random effects
In-Reply-To: <CAJuCY5ysmodQ=Jt8UGSuimNyz66WS9MAxdxWv4fttrM6O1Tw5A@mail.gmail.com>
References: <CAMvZauqY=naWQtSgfp+JtX73vB5+Sm3pO=iv6P6ujNGQHcg5WQ@mail.gmail.com>
 <CAJuCY5ysmodQ=Jt8UGSuimNyz66WS9MAxdxWv4fttrM6O1Tw5A@mail.gmail.com>
Message-ID: <CF887C5A-1262-4EEE-BA5D-D28899A84A50@gmail.com>

See if this paper may help If it helps reducing the model when you have few observations. the (1|ID) may increase the type 1 error.
https://journals.sagepub.com/doi/10.1177/25152459231214454 <https://journals.sagepub.com/doi/10.1177/25152459231214454>

Best

> On 6 May 2024, at 07:45, Thierry Onkelinx via R-sig-mixed-models <r-sig-mixed-models at r-project.org> wrote:
> 
> Dear Srinidhi,
> 
> You are trying to fit 1 random intercept and 2 random slopes per
> individual, while you have at most 3 observations per individual. You
> simply don't have enough data to fit the random slopes. Reduce the random
> part to (1|ID).
> 
> Best regards,
> 
> Thierry
> 
> ir. Thierry Onkelinx
> Statisticus / Statistician
> 
> Vlaamse Overheid / Government of Flanders
> INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND
> FOREST
> Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
> thierry.onkelinx at inbo.be
> Havenlaan 88 bus 73, 1000 Brussel
> *Postadres:* Koning Albert II-laan 15 bus 186, 1210 Brussel
> *Poststukken die naar dit adres worden gestuurd, worden ingescand en
> digitaal aan de geadresseerde bezorgd. Zo kan de Vlaamse overheid haar
> dossiers volledig digitaal behandelen. Poststukken met de vermelding
> ?vertrouwelijk? worden niet ingescand, maar ongeopend aan de geadresseerde
> bezorgd.*
> www.inbo.be
> 
> ///////////////////////////////////////////////////////////////////////////////////////////
> To call in the statistician after the experiment is done may be no more
> than asking him to perform a post-mortem examination: he may be able to say
> what the experiment died of. ~ Sir Ronald Aylmer Fisher
> The plural of anecdote is not data. ~ Roger Brinner
> The combination of some data and an aching desire for an answer does not
> ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
> ///////////////////////////////////////////////////////////////////////////////////////////
> 
> <https://www.inbo.be>
> 
> 
> Op ma 6 mei 2024 om 01:59 schreef Srinidhi Jayakumar via R-sig-mixed-models
> <r-sig-mixed-models at r-project.org>:
> 
>> I am running a multilevel growth curve model to examine predictors of
>> social anhedonia (SA) trajectory through ages 12, 15 and 18. SA is a
>> continuous numeric variable. The age variable (Index1) has been coded as 0
>> for age 12, 1 for age 15 and 2 for age 18. I am currently using a time
>> varying predictor, stress (LSI), which was measured at ages 12, 15 and 18,
>> to examine whether trajectory/variation in LSI predicts difference in SA
>> trajectory. LSI is a continuous numeric variable and was grand-mean
>> centered before using in the models. The data has been converted to long
>> format with SA in 1 column, LSI in the other, ID in another, and age in
>> another column. I used the code below to run my model using lmer. However,
>> I get the following error. Please let me know how I can solve this error.
>> Please note that I have 50% missing data in SA at age 12.
>> modelLSI_maineff_RE <- lmer(SA ~ Index1* LSI+ (1 + Index1+LSI |ID), data =
>> LSIDATA, control = lmerControl(optimizer ="bobyqa"), REML=TRUE)
>> summary(modelLSI_maineff_RE)
>> Error: number of observations (=1080) <= number of random effects (=1479)
>> for term (1 + Index1 + LSI | ID); the random-effects parameters and the
>> residual variance (or scale parameter) are probably unidentifiable
>> 
>> I did test the within-person variance for the LSI variable and the
>> within-person variance is significant from the Greenhouse-Geisser,
>> Hyunh-Feidt tests.
>> 
>> I also tried control = lmerControl(check.nobs.vs.nRE = "ignore") which gave
>> me the following output. modelLSI_maineff_RE <- lmer(SA ~ Index1* LSI+ (1 +
>> Index1+LSI |ID), data = LSIDATA, control = lmerControl(check.nobs.vs.nRE =
>> "ignore", optimizer ="bobyqa", check.conv.singular = .makeCC(action =
>> "ignore", tol = 1e-4)), REML=TRUE)
>> 
>> summary(modelLSI_maineff_RE)
>> Linear mixed model fit by REML. t-tests use Satterthwaite's method
>> ['lmerModLmerTest']
>> Formula: SA ~ Index1 * LSI + (1 + Index1 + LSI | ID)
>> Data: LSIDATA
>> Control: lmerControl(check.nobs.vs.nRE = "ignore", optimizer = "bobyqa",
>> check.conv.singular = .makeCC(action = "ignore", tol = 1e-04))
>> 
>> REML criterion at convergence: 7299.6
>> 
>> Scaled residuals:
>> Min 1Q Median 3Q Max
>> -2.7289 -0.4832 -0.1449 0.3604 4.5715
>> 
>> Random effects:
>> Groups Name Variance Std.Dev. Corr
>> ID (Intercept) 30.2919 5.5038
>> Index1 2.4765 1.5737 -0.15
>> LSI 0.1669 0.4085 -0.23 0.70
>> Residual 24.1793 4.9172
>> Number of obs: 1080, groups: ID, 493
>> 
>> Fixed effects:
>> Estimate Std. Error df t value Pr(>|t|)
>> (Intercept) 24.68016 0.39722 313.43436 62.133 < 2e-16 ***
>> Index1 0.98495 0.23626 362.75018 4.169 3.83e-05 ***
>> LSI -0.05197 0.06226 273.85575 -0.835 0.4046
>> Index1:LSI 0.09797 0.04506 426.01185 2.174 0.0302 *
>> Signif. codes: 0 ?? 0.001 ?? 0.01 ?? 0.05 ?.? 0.1 ? ? 1
>> 
>> Correlation of Fixed Effects:
>> (Intr) Index1 LSI
>> Index1 -0.645
>> LSI -0.032 0.057
>> Index1:LSI 0.015 0.037 -0.695
>> 
>> I am a little vary of the output still as the error states that I have
>> equal observations as the number of random effects (i.e., 3 observations
>> per ID and 3 random effects). Hence, I am wondering whether I can simplify
>> the model as either of the below models and choose the one with the
>> best-fit statistics:
>> 
>> modelLSI2 <- lmer(SA ~ Index1* LSI+ (1 |ID)+ (Index1+LSI -1|ID),data =
>> LSIDATA, control = lmerControl(optimizer ="bobyqa"), REML=TRUE) *OR*
>> 
>> modelLSI3 <- lmer(SA ~ Index1* LSI+ (1+LSI |ID),data = LSIDATA, control =
>> lmerControl(optimizer ="bobyqa"), REML=TRUE) [image: example of dataset]
>> <https://i.sstatic.net/JcRKS2C9.png>
>> 
>>        [[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


	[[alternative HTML version deleted]]


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Mon May  6 11:10:15 2024
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Mon, 6 May 2024 11:10:15 +0200
Subject: [R] 
 Get a copy of a matrix only for TRUE entries of a matching size
 boolean matrix?
In-Reply-To: <CAGYhDoN66pmeMj88LvATmn+jN-VowSH4+mJfgi5kLXJGGThGmg@mail.gmail.com>
References: <CAGYhDoM=Y2Wn4LbigoJYEdALQTR3rMw4UriP0oPXJqvtCLmNDQ@mail.gmail.com>
 <1fea204c-b71c-4a92-ae13-1dfcf6874357@yahoo.fr>
 <CAGYhDoN66pmeMj88LvATmn+jN-VowSH4+mJfgi5kLXJGGThGmg@mail.gmail.com>
Message-ID: <26168.40567.226121.869791@stat.math.ethz.ch>

>>>>> DynV Montrealer 
>>>>>     on Fri, 3 May 2024 10:39:10 -0400 writes:

    > It's exactly what I was looking for, thanks.  I'm replying
    > to the whole list so others can skip this question, to not
    > waste time on it.

good.

    > Bonne fin de journ?e de Montr?al (nous sommes le matin ici)

Note that the answer  Ben Bolker gave you (using "indexing")
is  much more efficient than the ifelse() answer below.

ifelse() may be convenient .. but is almost always suboptimal,
where as "indexing" is typically very often more efficient,
although often requiring a bit more thought than ifelse()
[so, if overall efficience is almost entirely your own human
 time, then using ifelse() may still be a good idea... ]

Martin

    > On Fri, May 3, 2024 at 10:30?AM Marc Girondot <marc_grt at yahoo.fr> wrote:

    >> Is it what you want ?
    >> mat_letters <- matrix(data=c('A', 'B', 'C', 'D'), ncol=2, byrow=TRUE)
    >> mat_bools <- matrix(data=c(FALSE, TRUE, TRUE, FALSE), ncol=2, byrow=TRUE)
    >> 
    >> ifelse(mat_bools, mat_letters, "")
    >> ifelse(mat_bools, mat_letters, NA)
    >> 
    >> > ifelse(mat_bools, mat_letters, "")
    >> [,1] [,2]
    >> [1,] ""   "B"
    >> [2,] "C"  ""
    >> > ifelse(mat_bools, mat_letters, NA)
    >> [,1] [,2]
    >> [1,] NA   "B"
    >> [2,] "C"  NA
    >> 
    >> Marc
    >> 
    >> 
    >> 
    >> Le 03/05/2024 ? 14:47, DynV Montrealer a ?crit :
    >> 
    >> Is there a way to get a copy of a matrix only for TRUE entries of a
    >> matching size boolean matrix? For **example**:
    >> 
    >> mat_letters <- matrix(data=c('A', 'B', 'C', 'D'), ncol=2, byrow=TRUE)
    >> mat_letters
    >> 
    >> [,1] [,2]
    >> [1,] "A"  "B"
    >> [2,] "C"  "D"
    >> 
    >> mat_bools <- matrix(data=c(FALSE, TRUE, TRUE, FALSE), ncol=2, byrow=TRUE)
    >> mat_bools
    >> 
    >> [,1]  [,2]
    >> [1,] FALSE  TRUE
    >> [2,]  TRUE FALSE
    >> *Reminder:* The following is only an example ; the solution might look very
    >> different.
    >> some_command(mat_letters, mat_bools, false=empty)
    >> [,1] [,2]
    >> [1,] ""  "B"
    >> [2,] "C"  ""
    >> some_command(mat_letters, mat_bools, false=na)
    >> [,1] [,2]
    >> [1,] NA  "B"
    >> [2,] "C"  NA
    >> 
    >> 
    >> 

    > [[alternative HTML version deleted]]

    > ______________________________________________
    > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
    > https://stat.ethz.ch/mailman/listinfo/r-help
    > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
    > and provide commented, minimal, self-contained, reproducible code.


From |kry|ov @end|ng |rom d|@root@org  Mon May  6 16:24:25 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Mon, 6 May 2024 17:24:25 +0300
Subject: [R] 
 Using intervals() function for nlme model - Statistics Lab ETHZ
In-Reply-To: <9a74d1234c254b40b9a7d5cd119ba08a@student.ethz.ch>
References: <9a74d1234c254b40b9a7d5cd119ba08a@student.ethz.ch>
Message-ID: <20240506172425.7a569ed1@arachnoid>

Dear Tatiana, Marvin & Paul,

If you don't get a better answer here, try
r-sig-mixed-models at r-project.org.

On Fri, 3 May 2024 11:29:19 +0000
"Bielakova  Tatiana" <tbielakova at student.ethz.ch> wrote:

> Based on the documentation of nlme package, the function interval is
> supported for gls, lme, and lmList classes. Although nlme is not
> mentioned, we still receive intervals without any errors or warnings.

You're right to question this. Programming-language-level inheritance
ends up being backwards for statistical methods:
<https://notstatschat.rbind.io/2023/06/07/blank-cheque-inheritance-and-statistical-objects/>.
Linear mixed-effect models are a subset of the more general mixed-effect
models, but in R, "nlme" objects inherit from "lme", not the other way
around.

>   *   Do you have any other recommendations/ ideas on how should we
> proceed to calculate intervals in R (e.g. more suitable packages)?

Here's a vignette from the nlraa package where bootstrap is used to get
a confidence interval for an implicit parameter:
https://cran.r-project.org/package=nlraa/vignettes/Bootstrapping.html

The author seems to be using intervals() on an nlme model without any
problems. It may help to see if the intervals() output agrees with the
bootstrap results from nlraa::boot_nlme().

-- 
Best regards,
Ivan


