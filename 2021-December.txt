From dw|n@em|u@ @end|ng |rom comc@@t@net  Wed Dec  1 02:22:51 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Tue, 30 Nov 2021 17:22:51 -0800
Subject: [R] Degree symbol as axis label superscript [RESOLVED]
In-Reply-To: <96f2116f-93ef-f261-9ecd-2edcd36a54@appl-ecosys.com>
References: <7974ab4-92ad-9a75-98f6-a7914bb8e5@appl-ecosys.com>
 <CAPcHnpQQU6iM8swfbK1+Zws1BurRKm13tdHNrOVBkuiK81725Q@mail.gmail.com>
 <4f69214-7a32-6eb2-6476-85c164d5bbf@appl-ecosys.com>
 <ce6095c5-c2cb-4bfb-f230-2667613b2dd3@appl-ecosys.com>
 <472ac05b-11ac-f7bc-9e26-1cad38c3b96f@comcast.net>
 <96f2116f-93ef-f261-9ecd-2edcd36a54@appl-ecosys.com>
Message-ID: <f0a269ea-7bf2-3e57-70fd-88b8c2f2c562@comcast.net>


On 11/30/21 1:22 PM, Rich Shepard wrote:
> On Tue, 30 Nov 2021, David Winsemius wrote:
>
>> Really? What was wrong with this?
>> plot(1, 1, xlab=expression(32^degree) )? # the example given on 
>> ?plotmath
>
> David,
>
> Absolutely nothing. When there's no specific degree value in the label
> because the axis represents a range of values there's no digit preceeding
> the ^ symbol.
>
> The axis label is 'Temperature (oC)' with the degree symbol preceeding a
> character, not following a specific digit.


There's nothing special about following a digit. You can have it follow 
anything. Since you were going to need to quote the parentheses anywa, 
then have it superscripted above the level of the paren:


plot(1,1, ylab = expression(Temperature~"("^degree*C*")") ? )

-- 

David.

>
> Rich
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From g@@@uu| @end|ng |rom gm@||@com  Wed Dec  1 02:59:03 2021
From: g@@@uu| @end|ng |rom gm@||@com (ani jaya)
Date: Wed, 1 Dec 2021 10:59:03 +0900
Subject: [R] Degree symbol as axis label superscript
In-Reply-To: <7974ab4-92ad-9a75-98f6-a7914bb8e5@appl-ecosys.com>
References: <7974ab4-92ad-9a75-98f6-a7914bb8e5@appl-ecosys.com>
Message-ID: <CAHXS41yk-_kHGAZFcUTv0PzzSSKrSRFUCOC5+8TavnPh2qZKmg@mail.gmail.com>

one of my solution :

text(x,y,"\u00B0C", cex=1.1, font=2)

it will produce "?C"

text(x,y,"\u00B3C", cex=1.1, font=2)
it will produce "superscript(3)C"

so basically change the character after the "\u00B..." will produce
the superscript.

Best, Ani

On Wed, Dec 1, 2021 at 4:05 AM Rich Shepard <rshepard at appl-ecosys.com> wrote:
>
> I want to present the temperature on the Y-axis label as 'Water Temperature
> (oC)' with the degree symbol as a superscript.
>
> My web search found a couple of methods; one put the entire example string
> in the axis label, the other is close, but still incorrect.
>
> Source example:
> #define expression with superscript
> x_expression <- expression(x^3 ~ variable ~ label)
> # The example axis label is:
> 'X3 variable label' (with the 3 as a superscript)
>
> My use:
> # Set degree symbol as superscript in plot's y axis:
> y_expression <- expression(^o ~ C)
>
> R's error message:
> Error in source("../scripts/all_temp_plots.r") :
>    ../scripts/all_temp_plots.r:10:28: unexpected '^'
> 9: # Set degree symbol as superscript in plot's y axis:
> 10: y_expression <- expression(^
>                                 ^
>
> What is the proper way to display a degree symbol in a plot's axis label?
>
> Rich
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @v|gro@@ @end|ng |rom ver|zon@net  Wed Dec  1 04:42:35 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Tue, 30 Nov 2021 22:42:35 -0500
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <5c27e9c9-3f7e-2d28-bbb8-566586a59c79@shdawson.com>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <CAGxFJbSWcEQ6+wAHMWMbAZN8+H=-MZeAck3oswYK=bTQg9YW1w@mail.gmail.com>
 <a051a615-a38a-e590-ca5d-d23f0c1e0e6c@shdawson.com>
 <CAGxFJbRDXgVq5V7FRv1i+cF_3vJpt9bhfcRiezfjTqc7-YyuAg@mail.gmail.com>
 <5c27e9c9-3f7e-2d28-bbb8-566586a59c79@shdawson.com>
Message-ID: <05fe01d7e665$7afa5330$70eef990$@verizon.net>

Stephen,

Although what is in the STANDARD R distribution can vary several ways, in
general, if you need to add a line like:

library(something)
or
require(something)

and your code does not work unless you have done that, then you can imagine
it is not sort of built in to R as it starts.

Having said that, tons of exceptions may exist that cause R to load in
things on your machine for everyone or just for you without you having to
notice.

I think this forum lately has been deluged with questions about all kinds of
add-on packages and in particular, lots of the ones in the tidyverse.
Clearly the purpose here is not that broad.

But since I use some packages like the tidyverse extensively, and I am far
from alone, I wonder if someday the powers that be realize it is a losing
battle to exclude at least some of it. It would be so nice not having to
include a long list of packages for some programs or somehow arrange that
people using something you shared had installed and loaded them. But there
are too many packages out there of varying quality and usefulness and
popularity with more every day being added. Worse, many are somewhat
incompatible such as having functions with the same names that hide earlier
ones loaded.

Base R doe come with functions like colSums and colMeans and similar row
functions. But as mentioned, a data.frame is a list of vectors and R
supports certain functional programming constructs over lists using things
like:

lapply(df, min)
sapply(df, min)

And actually quite a few ways depending on what info you want back and
whether you insist it be returned as a list or vector or other things . You
can even supply additional arguments that might be needed such as if you
want to ignore any NA values,

lapply(df, min, na.rm=TRUE

The package you looked at it is trying to be fast and uses what looks like
compiled external code but so does lapply.

If this is too bothersome for you, consider making a one-liner function like
this:

mycolMins <- function(df, ...) lapply(df, min, ...)

Once defined, you can use that just fine and not think about it again and I
note this answer (like others) is offering you something in base R that
works fine on data.frames and the like.

You can extend to many similar ideas like this one that calulates the min
unless you over-ride it with max or mean or sd or a bizarre function like
`[` so a call to:

mycolCalc(df, `[`, 3)

Will return exactly the third items in each row!

I find it to be very common for someone these days to do a quick search for
a way to do something in a language like R and not really look to see if it
is a standard way or something special/ Matrices in R are not quite the same
as some other objects like a data.frame or tibble and a package written to
be used on one may (or may not) happen to work with another. Some packages
are carefully written to try to detect what kind of object it gets and when
possible convert it to another. The "apply" function is meant for matrices
but if it sees something else it looks ta the dimensionality and tries to
coerce it with as.matrix or as.array first. As others have noted, this mean
a data.frame containing non-numeric parts may fail or should have any other
columns hidden/removed as in this df that has some non-numeric fields:

> df
i       s   f     b i2
1 1   hello 1.2  TRUE  5
2 2   there 2.3 FALSE  4
3 3 goodbye 3.4  TRUE  3

So a bit more complex one-liner removes any non-numeric columns like this:

> mycolMins(df[, sapply(df, is.numeric)])
$i
[1] 1

$f
[1] 1.2

$i2
[1] 3

Clearly converting that to a matrix while whole would result in everything
being converted to character and a minimum may be elusive.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
DSL via R-help
Sent: Tuesday, November 30, 2021 5:37 PM
To: Bert Gunter <bgunter.4567 at gmail.com>
Cc: r-help at r-project.org
Subject: Re: [R] Question about Rfast colMins and colMaxs

Oh, you are segmenting standard R from the rest of R.

Well, that part did not come across to me in your original reply. I am not
clear on a standard versus non-standard list. I will look into this aspect
and see what I can learn going forward.


Thanks,
*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 11/30/21 5:26 PM, Bert Gunter wrote:
> ... but Rfast is *not* a "standard" package, as the rest of the PG 
> excerpt says. So contact the maintainer and ask him/her what they 
> think the best practice should be for their package. As has been 
> pointed out already, it appears to differ from the usual "read it in 
> as a data frame" procedure.
>
> Bert
>
> On Tue, Nov 30, 2021 at 2:11 PM Stephen H. Dawson, DSL 
> <service at shdawson.com> wrote:
>> Right, R Studio is not R.
>>
>> However, the Rfast package is part of R.
>>
>> https://cran.r-project.org/web/packages/Rfast/index.html
>>
>> So, rephrasing my question...
>> What is the best practice to bring a csv file into R so it can be 
>> accessed by colMaxs and colMins, please?
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 11/30/21 3:19 PM, Bert Gunter wrote:
>>> RStudio is **not** R. In particular, the so-called TidyVerse 
>>> consists of all *non*-standard contributed packages, about which the PG
says:
>>>
>>> "For questions about functions in standard packages distributed with 
>>> R (see the FAQ Add-on packages in R), ask questions on R-help.
>>> [The link is:
>>> https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
>>> This gives the list of current _standard_ packages]
>>>
>>> If the question relates to a contributed package , e.g., one 
>>> downloaded from CRAN, try contacting the package maintainer first. 
>>> You can also use find("functionname") and
>>> packageDescription("packagename") to find this information. Only 
>>> send such questions to R-help or R-devel if you get no reply or need 
>>> further assistance. This applies to both requests for help and to 
>>> bug reports."
>>>
>>> Note that RStudio maintains its own help resources at:
>>> https://community.rstudio.com/
>>> This is where questions about the TidyVerse, ggplot, etc. should be
posted.
>>>
>>>
>>>
>>> Bert Gunter
>>>
>>> "The trouble with having an open mind is that people keep coming 
>>> along and sticking things into it."
>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>>
>>> On Tue, Nov 30, 2021 at 10:55 AM Stephen H. Dawson, DSL via R-help 
>>> <r-help at r-project.org> wrote:
>>>> Hi,
>>>>
>>>>
>>>> I am working to understand the Rfast functions of colMins and 
>>>> colMaxs. I worked through the example listed on page 54 of the PDF.
>>>>
>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>
>>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>>>>
>>>> My data is in a CSV file. So, I bring it into R Studio using:
>>>> Data <- read.csv("./input/DataSet05.csv", header=T)
>>>>
>>>> However, I read the instructions listed on page 54 of the PDF 
>>>> saying I need to bring data into R using a matrix. I think read.csv 
>>>> brings the data in as a dataframe. I think colMins is failing 
>>>> because it is looking for a matrix but finds a dataframe.
>>>>
>>>>    > colMaxs(Data)
>>>> Error in colMaxs(Data) :
>>>>      Not compatible with requested type: [type=list; target=double].
>>>>    > colMins(Data, na.rm = TRUE)
>>>> Error in colMins(Data, na.rm = TRUE) :
>>>>      unused argument (na.rm = TRUE)
>>>>    > colMins(Data, value = FALSE, parallel = FALSE) Error in 
>>>> colMins(Data, value = FALSE, parallel = FALSE) :
>>>>      Not compatible with requested type: [type=list; target=double].
>>>>
>>>> QUESTION
>>>> What is the best practice to bring a csv file into R Studio so it 
>>>> can be accessed by colMaxs and colMins, please?
>>>>
>>>>
>>>> Thanks,
>>>> --
>>>> *Stephen Dawson, DSL*
>>>> /Executive Strategy Consultant/
>>>> Business & Technology
>>>> +1 (865) 804-3454
>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide 
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From @kw@|mmo @end|ng |rom gm@||@com  Wed Dec  1 04:51:41 2021
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Tue, 30 Nov 2021 22:51:41 -0500
Subject: [R] Degree symbol as axis label superscript
In-Reply-To: <CAGxFJbTiVwfLi2_p2Sb+uT3iWPtfUO-8HODuAcpe_tKz+wM3HA@mail.gmail.com>
References: <7974ab4-92ad-9a75-98f6-a7914bb8e5@appl-ecosys.com>
 <CAPcHnpQQU6iM8swfbK1+Zws1BurRKm13tdHNrOVBkuiK81725Q@mail.gmail.com>
 <CAGxFJbTiVwfLi2_p2Sb+uT3iWPtfUO-8HODuAcpe_tKz+wM3HA@mail.gmail.com>
Message-ID: <CAPcHnpSAYzpN5iFGQ=4mTfyHNecHszh+uv1r+C_jgW+fd=8ZMg@mail.gmail.com>

Using the degree character seems perfectly legit to me. The reason I
suggest looking at plotmath is that I think plotmath is easier to read
(that is, if you're escaping your characters with \u), and because for
anything more complicated like set notation, big sums, integrals, you'll
need to get used to plotmath to make your labels. Either way, nice
suggestion, both work perfectly well for this situation

On Tue, Nov 30, 2021, 16:24 Bert Gunter <bgunter.4567 at gmail.com> wrote:

> True, but unnecessary with UTF-8 encodings of unicode (subject to some
> caveats, though):
>
> plot(1:5, runif(5),xlab = "Temp (?F)", ylab = "result")
>
> should work fine, where the ? ("degree") symbol was inserted by the
> symbol insertion facility on my Mac. Windows has something similar.
> See the comments in the plotmath documentation just before the
> examples for more details on this, along with some caveats about the
> need for a suitable display/plot device.
>
> More laboriously, but perhaps more informatively, one can look up
> "unicode code point for degree symbol" to find that it is decimal 176.
> Then R's intToUtf8() function converts this to the UTF-8 encoding that
> **should** display as a "degree" symbol, subject to the above
> referenced caveats.
> Hence:
> > intToUtf8(176)
> [1] "?"  ##degree character
>
> ## So, for example, you can do:
> > degrF <-paste0(intToUtf8(176),"F")
> > degrF
> [1] "?F" ("degrees F")
>
> > plot(1:5, runif(5),xlab = paste0("Temp (", degrF,")"), ylab = "result")
>
> As Andrew said, you can use plotmath to do this, too; it just isn't
> needed for simple insertion of "standard" symbols.
>
> NOTE: As I am far from an expert on all of this, I would appreciate
> clarification or correction of any errors or misstatements in the
> above.
>
> Bert Gunter
>
>
> On Tue, Nov 30, 2021 at 11:34 AM Andrew Simmons <akwsimmo at gmail.com>
> wrote:
> >
> > Excuse my brevity, but take a look at ?plotmath
> >
> > It has tons of tips for making pretty labels
> >
> > On Tue, Nov 30, 2021, 14:05 Rich Shepard <rshepard at appl-ecosys.com>
> wrote:
> >
> > > I want to present the temperature on the Y-axis label as 'Water
> Temperature
> > > (oC)' with the degree symbol as a superscript.
> > >
> > > My web search found a couple of methods; one put the entire example
> string
> > > in the axis label, the other is close, but still incorrect.
> > >
> > > Source example:
> > > #define expression with superscript
> > > x_expression <- expression(x^3 ~ variable ~ label)
> > > # The example axis label is:
> > > 'X3 variable label' (with the 3 as a superscript)
> > >
> > > My use:
> > > # Set degree symbol as superscript in plot's y axis:
> > > y_expression <- expression(^o ~ C)
> > >
> > > R's error message:
> > > Error in source("../scripts/all_temp_plots.r") :
> > >    ../scripts/all_temp_plots.r:10:28: unexpected '^'
> > > 9: # Set degree symbol as superscript in plot's y axis:
> > > 10: y_expression <- expression(^
> > >                                 ^
> > >
> > > What is the proper way to display a degree symbol in a plot's axis
> label?
> > >
> > > Rich
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide
> > > http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> > >
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Wed Dec  1 05:58:45 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 30 Nov 2021 20:58:45 -0800
Subject: [R] Degree symbol as axis label superscript
In-Reply-To: <CAPcHnpSAYzpN5iFGQ=4mTfyHNecHszh+uv1r+C_jgW+fd=8ZMg@mail.gmail.com>
References: <7974ab4-92ad-9a75-98f6-a7914bb8e5@appl-ecosys.com>
 <CAPcHnpQQU6iM8swfbK1+Zws1BurRKm13tdHNrOVBkuiK81725Q@mail.gmail.com>
 <CAGxFJbTiVwfLi2_p2Sb+uT3iWPtfUO-8HODuAcpe_tKz+wM3HA@mail.gmail.com>
 <CAPcHnpSAYzpN5iFGQ=4mTfyHNecHszh+uv1r+C_jgW+fd=8ZMg@mail.gmail.com>
Message-ID: <CAGxFJbQFSP8fENiPuYLYXW++iVdB3FQg3L-kfqgvB1pN2Lui6Q@mail.gmail.com>

Yes, but I should acknowledge my ignorance in not realizing that "\u00b0"
(hex 176) is a simpler way to get the character in R without the OS tool
than intToUtf8() .  If you need math notation beyond simple symbol
characters, plotmath is certainly indispensable.

Bert

On Tue, Nov 30, 2021 at 7:51 PM Andrew Simmons <akwsimmo at gmail.com> wrote:

> Using the degree character seems perfectly legit to me. The reason I
> suggest looking at plotmath is that I think plotmath is easier to read
> (that is, if you're escaping your characters with \u), and because for
> anything more complicated like set notation, big sums, integrals, you'll
> need to get used to plotmath to make your labels. Either way, nice
> suggestion, both work perfectly well for this situation
>
> On Tue, Nov 30, 2021, 16:24 Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
>> True, but unnecessary with UTF-8 encodings of unicode (subject to some
>> caveats, though):
>>
>> plot(1:5, runif(5),xlab = "Temp (?F)", ylab = "result")
>>
>> should work fine, where the ? ("degree") symbol was inserted by the
>> symbol insertion facility on my Mac. Windows has something similar.
>> See the comments in the plotmath documentation just before the
>> examples for more details on this, along with some caveats about the
>> need for a suitable display/plot device.
>>
>> More laboriously, but perhaps more informatively, one can look up
>> "unicode code point for degree symbol" to find that it is decimal 176.
>> Then R's intToUtf8() function converts this to the UTF-8 encoding that
>> **should** display as a "degree" symbol, subject to the above
>> referenced caveats.
>> Hence:
>> > intToUtf8(176)
>> [1] "?"  ##degree character
>>
>> ## So, for example, you can do:
>> > degrF <-paste0(intToUtf8(176),"F")
>> > degrF
>> [1] "?F" ("degrees F")
>>
>> > plot(1:5, runif(5),xlab = paste0("Temp (", degrF,")"), ylab = "result")
>>
>> As Andrew said, you can use plotmath to do this, too; it just isn't
>> needed for simple insertion of "standard" symbols.
>>
>> NOTE: As I am far from an expert on all of this, I would appreciate
>> clarification or correction of any errors or misstatements in the
>> above.
>>
>> Bert Gunter
>>
>>
>> On Tue, Nov 30, 2021 at 11:34 AM Andrew Simmons <akwsimmo at gmail.com>
>> wrote:
>> >
>> > Excuse my brevity, but take a look at ?plotmath
>> >
>> > It has tons of tips for making pretty labels
>> >
>> > On Tue, Nov 30, 2021, 14:05 Rich Shepard <rshepard at appl-ecosys.com>
>> wrote:
>> >
>> > > I want to present the temperature on the Y-axis label as 'Water
>> Temperature
>> > > (oC)' with the degree symbol as a superscript.
>> > >
>> > > My web search found a couple of methods; one put the entire example
>> string
>> > > in the axis label, the other is close, but still incorrect.
>> > >
>> > > Source example:
>> > > #define expression with superscript
>> > > x_expression <- expression(x^3 ~ variable ~ label)
>> > > # The example axis label is:
>> > > 'X3 variable label' (with the 3 as a superscript)
>> > >
>> > > My use:
>> > > # Set degree symbol as superscript in plot's y axis:
>> > > y_expression <- expression(^o ~ C)
>> > >
>> > > R's error message:
>> > > Error in source("../scripts/all_temp_plots.r") :
>> > >    ../scripts/all_temp_plots.r:10:28: unexpected '^'
>> > > 9: # Set degree symbol as superscript in plot's y axis:
>> > > 10: y_expression <- expression(^
>> > >                                 ^
>> > >
>> > > What is the proper way to display a degree symbol in a plot's axis
>> label?
>> > >
>> > > Rich
>> > >
>> > > ______________________________________________
>> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > > https://stat.ethz.ch/mailman/listinfo/r-help
>> > > PLEASE do read the posting guide
>> > > http://www.R-project.org/posting-guide.html
>> > > and provide commented, minimal, self-contained, reproducible code.
>> > >
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Wed Dec  1 14:26:17 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Wed, 1 Dec 2021 05:26:17 -0800 (PST)
Subject: [R] Degree symbol as axis label superscript [RESOLVED]
In-Reply-To: <f0a269ea-7bf2-3e57-70fd-88b8c2f2c562@comcast.net>
References: <7974ab4-92ad-9a75-98f6-a7914bb8e5@appl-ecosys.com>
 <CAPcHnpQQU6iM8swfbK1+Zws1BurRKm13tdHNrOVBkuiK81725Q@mail.gmail.com>
 <4f69214-7a32-6eb2-6476-85c164d5bbf@appl-ecosys.com>
 <ce6095c5-c2cb-4bfb-f230-2667613b2dd3@appl-ecosys.com>
 <472ac05b-11ac-f7bc-9e26-1cad38c3b96f@comcast.net>
 <96f2116f-93ef-f261-9ecd-2edcd36a54@appl-ecosys.com>
 <f0a269ea-7bf2-3e57-70fd-88b8c2f2c562@comcast.net>
Message-ID: <47759dac-984c-4b1-1a6b-1f3e22c6a514@appl-ecosys.com>

On Tue, 30 Nov 2021, David Winsemius wrote:

> There's nothing special about following a digit. You can have it follow
> anything. Since you were going to need to quote the parentheses anywa,
> then have it superscripted above the level of the paren:
> plot(1,1, ylab = expression(Temperature~"("^degree*C*")") ? )

Thank you, David. I tried something like that missed the correct quoting.

Regards,

Rich


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Wed Dec  1 14:27:24 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Wed, 1 Dec 2021 05:27:24 -0800 (PST)
Subject: [R] Degree symbol as axis label superscript
In-Reply-To: <CAHXS41yk-_kHGAZFcUTv0PzzSSKrSRFUCOC5+8TavnPh2qZKmg@mail.gmail.com>
References: <7974ab4-92ad-9a75-98f6-a7914bb8e5@appl-ecosys.com>
 <CAHXS41yk-_kHGAZFcUTv0PzzSSKrSRFUCOC5+8TavnPh2qZKmg@mail.gmail.com>
Message-ID: <595e5212-a82-597f-1f5-176bac88575@appl-ecosys.com>

On Wed, 1 Dec 2021, ani jaya wrote:

> one of my solution :
> text(x,y,"\u00B0C", cex=1.1, font=2)
> it will produce "?C"

Ani,

That's what I did.

Thank you,

Rich


From jrkr|de@u @end|ng |rom gm@||@com  Wed Dec  1 15:17:15 2021
From: jrkr|de@u @end|ng |rom gm@||@com (John Kane)
Date: Wed, 1 Dec 2021 09:17:15 -0500
Subject: [R] Syntax help for 'Pivot_longer'
In-Reply-To: <CAMVDa_6YBoPskUyEkXZ6oo76yK0UE59p=s5OssfZj-0apc=oqA@mail.gmail.com>
References: <CAMVDa_4_ktvBh2rgrKZtnNveCpbOwkrmwbM8aeG=wx3kF=gs5g@mail.gmail.com>
 <64556987.6135303.1638115192363.JavaMail.zimbra@psyctc.org>
 <CAMVDa_4bz5HVXx7FXCZT979KTnMvSgqO9P7vzCW3BjLC13sDFQ@mail.gmail.com>
 <68011A37-C87F-4E29-A212-E0CAC604A9B4@dcn.davis.ca.us>
 <CAMVDa_6YBoPskUyEkXZ6oo76yK0UE59p=s5OssfZj-0apc=oqA@mail.gmail.com>
Message-ID: <CAKZQJMDJpaGAWF2h=L7qqQgGK5P7acDgv7MfGkdw64F8dYfA4w@mail.gmail.com>

Hi Phillip,

Let's say your original data is in a data.frame called "mydata".

What you want to do is issue de command
dput(mydata)

then just copy the output and paste it into the message.

Here is a very simple example


dat1 <-   data.frame(xx = LETTERS[1:10], yy = 10:1)

dput(dat1)

====================output to copy and paste===========

structure(list(xx = c("A", "B", "C", "D", "E", "F", "G", "H",
"I", "J"), yy = 10:1), class = "data.frame", row.names = c(NA,
-10L))

=============================================

 If you have a very large data set then something like
head(dput(myfile), 100) will likely supply enough data for us to work
with.


On Mon, 29 Nov 2021 at 05:20, Philip Monk <prmonk at gmail.com> wrote:
>
> Apologies, all.  No offence was intended.
>
> I'll go away and do a lot more reading and thinking then come back
> with a clearly articulated query if and when that is appropriate.
> I'm out of time this week, so it won't be for some time.
>
> Thank you all for the helpful replies.
>
> Best wishes,
>
> Philip
>
> On Mon, 29 Nov 2021 at 00:31, Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
> >
> > This "data_long" appears to be a mess you are not satisfied with, rather than the "data" you started with or a model of what you want.
> >
> > On November 28, 2021 9:06:54 AM PST, Philip Monk <prmonk at gmail.com> wrote:
> > >Thanks for your suggestions, Chris.
> > >
> > >I'm writing from Gmail's web client, and have checked the message is
> > >being sent as plain text (though I also did this previously so it may
> > >be that I need to change to Outlook).  Let me know if it doesn't work.
> > >
> > >Hopefully I've used dput properly (see example below with apologies to
> > >Burt and the PG).   In my defence, I have very limited time due to
> > >caring responsibilities so am time-poor out of necessity rather than
> > >laziness.
> > >
> > >Reading the 'pivot_longer' documentation I think I need to use
> > >'names_pattern' to split the weather data into different columns, but
> > >I don't understand the required syntax.
> > >
> > >Thanks for your help,
> > >
> > >Philip
> > >
> > >rm(list=ls())
> > >library(ggplot2)
> > >library(ggpubr)
> > >library(tidyverse)
> > >library(rstatix)
> > >library(ez)
> > >library(dplyr)
> > >
> > >data_long <-
> > >  structure(
> > >    list(
> > >      Buffer = c(
> > >        "100",
> > >        "200",
> > >        "300",
> > >        "400",
> > >        "500",
> > >        "600",
> > >        "700",
> > >        "800",
> > >        "900",
> > >        "1000",
> > >        "1100",
> > >        "1200",
> > >        "1300",
> > >        "1400",
> > >        "1500",
> > >        "1600",
> > >        "1700",
> > >        "1800",
> > >        "1900",
> > >        "Temperature",
> > >        "Wind speed",
> > >        "Wind trend",
> > >        "Wind direction",
> > >        "Humidity",
> > >        "Pressure",
> > >        "Pressure trend"
> > >      ),
> > >      `15/01/2010` = c(
> > >        6.091741043,
> > >        5.271975614,
> > >        4.451891901,
> > >        3.385694303,
> > >        2.900508112,
> > >        3.110238149,
> > >        3.150580922,
> > >        3.079728958,
> > >        2.327902499,
> > >        1.641887823,
> > >        1.63370882,
> > >        0.986559368,
> > >        0.920601397,
> > >        0.571882394,
> > >        0.340505009,
> > >        0.813480877,
> > >        0.471988882,
> > >        0.269067515,
> > >        0.303179244,
> > >        12,
> > >        10,
> > >        1,
> > >        22.5,
> > >        40,
> > >        1024,
> > >        1
> > >      ),
> > >      `16/02/2010` = c(
> > >        6.405879111,
> > >        5.994054977,
> > >        5.61142085,
> > >        4.77953426,
> > >        4.305900444,
> > >        3.616699448,
> > >        2.848148846,
> > >        2.016807672,
> > >        1.452876728,
> > >        2.120099832,
> > >        1.661317381,
> > >        1.133219897,
> > >        1.237239562,
> > >        0.93675648,
> > >        0.7379146,
> > >        1.026085605,
> > >        0.566766122,
> > >        0.13349775,
> > >        0.082892149,
> > >        15,
> > >        9,
> > >        1,
> > >        45,
> > >        44.5,
> > >        1018.5,
> > >        1
> > >      ),
> > >      `20/03/2010` = c(
> > >        8.925945159,
> > >        7.375445078,
> > >        6.120095292,
> > >        5.608927408,
> > >        5.61367474,
> > >        4.800003992,
> > >        4.216782177,
> > >        4.05288041,
> > >        3.779922823,
> > >        4.267840277,
> > >        3.747342619,
> > >        2.414025636,
> > >        2.647100163,
> > >        2.272566024,
> > >        2.526476424,
> > >        2.643863876,
> > >        1.290173713,
> > >        0.612263766,
> > >        0.465457136,
> > >        16,
> > >        10.5,
> > >        1,
> > >        67.5,
> > >        22,
> > >        1025,
> > >        1
> > >      ),
> > >      `24/04/2011` = c(
> > >        6.278147269,
> > >        5.805619599,
> > >        5.149985946,
> > >        4.542354226,
> > >        4.320657374,
> > >        4.006103489,
> > >        3.642003696,
> > >        3.315992643,
> > >        3.181741995,
> > >        3.321634055,
> > >        2.814670223,
> > >        2.180686348,
> > >        2.253223258,
> > >        2.07198929,
> > >        1.912840489,
> > >        1.825988411,
> > >        1.360936689,
> > >        0.666152106,
> > >        0.537232782,
> > >        23,
> > >        19.5,
> > >        0,
> > >        191.25,
> > >        24.5,
> > >        1005.5,
> > >        1
> > >      )
> > >    ),
> > >    row.names = c(NA, 26L),
> > >    class = "data.frame"
> > >  )
> > >
> > ># Converts data table from wide (many columns) to long (many rows) and
> > >creates the new object 'data_long'
> > ># Column 1 is the 'Buffer' number (100-2000), Columns 2-25 contain
> > >monthly data covering 2 years.
> > ># Column headers for columns 2:25 are mutated into a column called
> > >'Date', values for each buffer and each date into the column 'LST'
> > >
> > >data_long <- data %>% pivot_longer(cols = 2:25, names_pattern = names_to =
> > >                                     "Date", values_to = "LST")
> > >
> > ># Instructs R to treat the 'Date' column data as a date
> > >data_long$Date <- as.Date(data_long$Date, format = "%d/%m/%Y")
> > >
> > ># Creates a new column called 'Month' by extracting the month number
> > >from the date in the 'Date' column
> > >data_long <- mutate(data_long, Month = format(data_long$Date, "%m"))
> > >
> > ># Creates a new column called 'Year' by extracting the Year number
> > >(YYYY as %Y not %y) from the date in the 'Date' column
> > >data_long <- mutate(data_long, Year = format(data_long$Date, "%Y"))
> > >
> > ># Creates a new column called 'JulianDay' by calculating the Julian
> > >Day (day of the year from 1 January) from the date in the 'Date'
> > >column.
> > >data_long <- mutate(data_long, JulianDay = format(data_long$Date, "%j"))
> > >
> > ># Creates a new column called 'TimePeriod' where 1 = pre-construction,
> > >and 2 = post-construction of solar park.
> > ># Uses 'if_else' - If Year < 2015 value = 1, else 2.
> > >data_long <- mutate(data_long, TimePeriod = if_else(data_long$Year <
> > >2015, 1,2, missing = NULL))
> > >
> > ># Instructs R to treat the 'TimePeriod' column as a (categorical)
> > >factor - it is either 1 (pre-construction, or 2 (post-construction)
> > >data_long$TimePeriod <- as.factor(data_long$TimePeriod)
> > >
> > ># Change data types of Month, Year nad JulianDay
> > >data_long$Month <- as.numeric(data_long$Month)
> > >data_long$Year <- as.numeric(data_long$Year)
> > >data_long$JulianDay <- as.numeric(data_long$JulianDay)
> > >
> > ># 'Compactly display the internal structure of an R object'
> > >str(data_long)
> > >
> > ># Adds 'data_long' to R search path so that R can access it when
> > >evaluating a variable (simplifies syntax).
> > >attach(data_long)
> > >
> > >
> > >On Sun, 28 Nov 2021 at 15:59, Chris Evans <chrishold at psyctc.org> wrote:
> > >>
> > >> Often the issue is that different variables in the wide format are of different types so won't simply
> > >> pivot_longer without you making decisions which the function shouldn't make for you.  However, I think
> > >> the error messages when that happens are fairly clear so perhaps that's not what's happening here.
> > >>
> > >> I'm happy to have a look at this as I've slowly become a convert to using tidyverse principles and tools
> > >> (sometimes seen, legalistically correctly I think, as outside the remit of this Email list) but I agree
> > >> that the help for pivot_longer() and many other tidyverse functions is not as good as it could be particularly
> > >> for people new to R.  Often there is better documentation in vignettes (so look for that) or in other things
> > >> on the web.
> > >>
> > >> However, for me the data that was posted are mangled by the post coming in HTML format.  Please read the
> > >> list documentation and resubmit the question in raw text Email and submit a bit of your data using
> > >> dput() (see ?dput and search out "R reproducible examples") and then I'll look at it.
> > >>
> > >> Very best (all),
> > >>
> > >> Chris
> > >>
> > >> ----- Original Message -----
> > >> > From: "Philip Monk" <prmonk at gmail.com>
> > >> > To: "R-help Mailing List" <r-help at r-project.org>
> > >> > Sent: Sunday, 28 November, 2021 13:57:07
> > >> > Subject: [R] Syntax help for 'Pivot_longer'
> > >>
> > >> > Hello,
> > >> >
> > >> > I have a wide table that I transform to a long table for analysis.
> > >> > The wide table has 25 columns - the first is labels, then columns 2:25
> > >> > are monthly data of LST which is in 19 rows.
> > >> >
> > >> > I mutate this with :
> > >> >
> > >> > data_long <- data %>% pivot_longer(cols = 2:25, names_to =
> > >> >                                     "Date", values_to = "LST")
> > >> >
> > >> > I've decided to add some weather data which might be relevant,
> > >> > inputting this as an additional 7 rows of data in the wide format (see
> > >> > example below of the first 5 months of data).
> > >> >
> > >> > I have belatedly realised that I cannot work out how to pivot this
> > >> > into the long format I need - the documentation doesn't provide enough
> > >> > syntax examples for me to work it out (I've not long been using 'R').
> > >> >
> > >> > How do I mutate this to provide the additional columns in the long
> > >> > table for the weather variables?
> > >> >
> > >> > Thanks for your time,
> > >> >
> > >> > Philip
> > >> >
> > >> > Part-time PhD Student (Environmental Science)
> > >> > Lancaster University, UK.
> > >> >
> > >> >
> > >> >
> > >> > Wide data
> > >> > ------------------
> > >> >
> > >> > Buffer            15/01/2010     16/02/2010     20/03/2010
> > >> > 24/04/2011      07/05/2010
> > >> >
> > >> > 100                6.091741043   6.405879111   8.925945159
> > >> > 6.278147269   6.133940129
> > >> >
> > >> > 200                5.271975614   5.994054977   7.375445078
> > >> > 5.805619599   5.537759202
> > >> >
> > >> > 300                4.451891901   5.61142085     6.120095292
> > >> > 5.149985946   5.353001442
> > >> >
> > >> > 400                3.385694303   4.77953426     5.608927408
> > >> > 4.542354226   4.824773827
> > >> >
> > >> > 500                2.900508112   4.305900444   5.61367474
> > >> > 4.320657374   4.520022189
> > >> >
> > >> > 600                3.110238149   3.616699448   4.800003992
> > >> > 4.006103489   4.188421662
> > >> >
> > >> > 700                 3.150580922   2.848148846   4.216782177
> > >> > 3.642003696   3.725611032
> > >> >
> > >> > 800                 3.079728958   2.016807672   4.05288041
> > >> > 3.315992643   3.278124347
> > >> >
> > >> > 900                 2.327902499   1.452876728   3.779922823
> > >> > 3.181741995   3.29577819
> > >> >
> > >> > 1000               1.641887823   2.120099832   4.267840277
> > >> > 3.321634055   3.551965361
> > >> >
> > >> > 1100               1.63370882     1.661317381   3.747342619
> > >> > 2.814670223   2.807355369
> > >> >
> > >> > 1200               0.986559368   1.133219897   2.414025636
> > >> > 2.180686348   2.166547946
> > >> >
> > >> > 1300               0.920601397   1.237239562   2.647100163
> > >> > 2.253223258   2.411947081
> > >> >
> > >> > 1400               0.571882394   0.93675648     2.272566024
> > >> > 2.07198929     1.954723088
> > >> >
> > >> > 1500               0.340505009   0.7379146       2.526476424
> > >> > 1.912840489   2.003872651
> > >> >
> > >> > 1600               0.813480877   1.026085605   2.643863876
> > >> > 1.825988411   2.278799668
> > >> >
> > >> > 1700               0.471988882   0.566766122   1.290173713
> > >> > 1.360936689   1.45967449
> > >> >
> > >> > 1800               0.269067515   0.13349775     0.612263766
> > >> > 0.666152106   0.680354177
> > >> >
> > >> > 1900               0.303179244   0.082892149   0.465457136
> > >> > 0.537232782   0.287185161
> > >> >
> > >> > Temperautre   12                    15                     16
> > >> >          23                   21.5
> > >> >
> > >> > Wind speed     10                    9                      10.5
> > >> >          9.5                   9.5
> > >> >
> > >> > Wind trend       1                      1                      1
> > >> >                0                     1
> > >> >
> > >> > Wind direction  22.5                45                      67.5
> > >> >         191.25            56.25
> > >> >
> > >> > Humidity           40                   44.5                   22
> > >> >              24.5                7
> > >> >
> > >> > Pressure          1024               1018.5               1025
> > >> >       1005.5            1015.5
> > >> >
> > >> > Pressure trend 1                      1                        1
> > >> >               1                      1
> > >> >
> > >> >
> > >> >
> > >> >
> > >> > long data
> > >> > -----------------
> > >> > Buffer         Date             LST             Temperature      Wind
> > >> > speed ......
> > >> > 1                  01.01.21     4                  5                        10
> > >> > 2                  01.02.21     5                  2                        11
> > >> > 3                  01.03.21     7                  5                        15
> > >> > 4                  01.04.21     9                  6                        7
> > >> > 5                  01.05.21     7                  5                        10
> > >> >
> > >> > ______________________________________________
> > >> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > >> > https://stat.ethz.ch/mailman/listinfo/r-help
> > >> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > >> > and provide commented, minimal, self-contained, reproducible code.
> > >>
> > >> --
> > >> Chris Evans (he/him) <chris at psyctc.org>
> > >> Visiting Professor, UDLA, Quito, Ecuador & Honorary Professor, University of Roehampton, London, UK.
> > >> Work web site: https://www.psyctc.org/psyctc/
> > >> CORE site:     https://www.coresystemtrust.org.uk/
> > >> Personal site: https://www.psyctc.org/pelerinage2016/
> > >> OMbook:        https://ombook.psyctc.org/book/
> > >
> > >______________________________________________
> > >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > >https://stat.ethz.ch/mailman/listinfo/r-help
> > >PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > >and provide commented, minimal, self-contained, reproducible code.
> >
> > --
> > Sent from my phone. Please excuse my brevity.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



--
John Kane
Kingston ON Canada


From dpweyg@nd @end|ng |rom gm@||@com  Wed Dec  1 16:30:39 2021
From: dpweyg@nd @end|ng |rom gm@||@com (Dennis Weygand)
Date: Wed, 1 Dec 2021 10:30:39 -0500
Subject: [R] readxl
Message-ID: <CAJgAAVSqg4P+fALoj2fQB8Ro8LfccYHYN3BGk96V=wZaXqhWiw@mail.gmail.com>

I have been using readxl function for years...
Suddenly, today, I get an error message:

> T1 <- read_excel(fname,sheet="T1")
Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]])
:
  there is no package called ?lifecycle?

Does anyone know what has happened?
D.P. Weygand
Old Dominion University
Norfolk, VA

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed Dec  1 16:41:39 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 01 Dec 2021 07:41:39 -0800
Subject: [R] readxl
In-Reply-To: <CAJgAAVSqg4P+fALoj2fQB8Ro8LfccYHYN3BGk96V=wZaXqhWiw@mail.gmail.com>
References: <CAJgAAVSqg4P+fALoj2fQB8Ro8LfccYHYN3BGk96V=wZaXqhWiw@mail.gmail.com>
Message-ID: <0A2E3424-A14D-4E98-B49C-65927E5151BE@dcn.davis.ca.us>

Probably some kind of failure occurred during package updating and one or more of the packages readxl depends on was removed but not successfully re-installed.

Run

  install.packages( "lifecycle" )

and then

  update.packages()

and try using your function again. If a similar error occurs, repeat for the next missing package.

On December 1, 2021 7:30:39 AM PST, Dennis Weygand <dpweygand at gmail.com> wrote:
>I have been using readxl function for years...
>Suddenly, today, I get an error message:
>
>> T1 <- read_excel(fname,sheet="T1")
>Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]])
>:
>  there is no package called ?lifecycle?
>
>Does anyone know what has happened?
>D.P. Weygand
>Old Dominion University
>Norfolk, VA
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From @erv|ce @end|ng |rom @hd@w@on@com  Wed Dec  1 17:11:24 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Wed, 1 Dec 2021 11:11:24 -0500
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <0051e760-7444-0d68-6492-1a3949fde288@shdawson.com>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <BF32C534-58AA-42FF-9720-A07FBCF57F5C@dcn.davis.ca.us>
 <d9858425-2515-9cba-8250-a06c7e76239d@shdawson.com>
 <0051e760-7444-0d68-6492-1a3949fde288@shdawson.com>
Message-ID: <4e480fce-de00-f72d-15b5-99776ede8927@shdawson.com>

Jeff,

Can you use max and min evaluations on any other data type then numeric? 
If so, how do you evaluate max or min of text content? String length? 
Ascii values of text characters?


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 11/30/21 5:23 PM, Stephen H. Dawson, DSL via R-help wrote:
> Well, no it is not. The email list stripped off the attachment.
>
> The data is numeric, happens to be all whole numbers.
>
>
> Kindest Regards,
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
>
> On 11/30/21 5:14 PM, Stephen H. Dawson, DSL via R-help wrote:
>> Hi Jeff,
>>
>>
>> Thanks for the data review offer. Attached is the CSV.
>>
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 11/30/21 3:29 PM, Jeff Newmiller wrote:
>>> I don't know anything about this package, but read.csv returns a 
>>> data frame. How you go about forming a matrix using that data frame 
>>> depends what is in it. If it is all numeric then as.matrix may be 
>>> all you need.
>>>
>>> Half of any R data analysis is data... and the details are almost 
>>> always crucial. Since you have told us nothing useful about the 
>>> data, it is up to you to inspect your data and figure out what to do 
>>> with it.
>>>
>>> On November 30, 2021 10:55:13 AM PST, "Stephen H. Dawson, DSL via 
>>> R-help" <r-help at r-project.org> wrote:
>>>> Hi,
>>>>
>>>>
>>>> I am working to understand the Rfast functions of colMins and 
>>>> colMaxs. I
>>>> worked through the example listed on page 54 of the PDF.
>>>>
>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>
>>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>>>>
>>>> My data is in a CSV file. So, I bring it into R Studio using:
>>>> Data <- read.csv("./input/DataSet05.csv", header=T)
>>>>
>>>> However, I read the instructions listed on page 54 of the PDF saying I
>>>> need to bring data into R using a matrix. I think read.csv brings the
>>>> data in as a dataframe. I think colMins is failing because it is 
>>>> looking
>>>> for a matrix but finds a dataframe.
>>>>
>>>>> colMaxs(Data)
>>>> Error in colMaxs(Data) :
>>>> ?? Not compatible with requested type: [type=list; target=double].
>>>>> colMins(Data, na.rm = TRUE)
>>>> Error in colMins(Data, na.rm = TRUE) :
>>>> ?? unused argument (na.rm = TRUE)
>>>>> colMins(Data, value = FALSE, parallel = FALSE)
>>>> Error in colMins(Data, value = FALSE, parallel = FALSE) :
>>>> ?? Not compatible with requested type: [type=list; target=double].
>>>>
>>>> QUESTION
>>>> What is the best practice to bring a csv file into R Studio so it 
>>>> can be
>>>> accessed by colMaxs and colMins, please?
>>>>
>>>>
>>>> Thanks,
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From petr@p|k@| @end|ng |rom prechez@@cz  Wed Dec  1 17:19:18 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Wed, 1 Dec 2021 16:19:18 +0000
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <4e480fce-de00-f72d-15b5-99776ede8927@shdawson.com>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <BF32C534-58AA-42FF-9720-A07FBCF57F5C@dcn.davis.ca.us>
 <d9858425-2515-9cba-8250-a06c7e76239d@shdawson.com>
 <0051e760-7444-0d68-6492-1a3949fde288@shdawson.com>
 <4e480fce-de00-f72d-15b5-99776ede8927@shdawson.com>
Message-ID: <b911b470798242b4b50db758837979e1@SRVEXCHCM1301.precheza.cz>

Hi.

It is always worth to consult excellent R help.

max and min return the maximum or minimum of all the values present in their arguments, as integer if all are logical or integer, as double if all are numeric, and character otherwise.

Character versions are sorted lexicographically, and this depends on the collating sequence of the locale in use: the help for ?Comparison? gives details. The max/min of an empty character vector is defined to be character NA. (One could argue that as "" is the smallest character element, the maximum should be "", but there is no obvious candidate for the minimum.)

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H.
> Dawson, DSL via R-help
> Sent: Wednesday, December 1, 2021 5:11 PM
> To: r-help at r-project.org
> Subject: Re: [R] Question about Rfast colMins and colMaxs
> 
> Jeff,
> 
> Can you use max and min evaluations on any other data type then numeric?
> If so, how do you evaluate max or min of text content? String length?
> Ascii values of text characters?
> 
> 
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
> 
> 
> On 11/30/21 5:23 PM, Stephen H. Dawson, DSL via R-help wrote:
> > Well, no it is not. The email list stripped off the attachment.
> >
> > The data is numeric, happens to be all whole numbers.
> >
> >
> > Kindest Regards,
> > *Stephen Dawson, DSL*
> > /Executive Strategy Consultant/
> > Business & Technology
> > +1 (865) 804-3454
> > http://www.shdawson.com <http://www.shdawson.com>
> >
> >
> > On 11/30/21 5:14 PM, Stephen H. Dawson, DSL via R-help wrote:
> >> Hi Jeff,
> >>
> >>
> >> Thanks for the data review offer. Attached is the CSV.
> >>
> >>
> >> *Stephen Dawson, DSL*
> >> /Executive Strategy Consultant/
> >> Business & Technology
> >> +1 (865) 804-3454
> >> http://www.shdawson.com <http://www.shdawson.com>
> >>
> >>
> >> On 11/30/21 3:29 PM, Jeff Newmiller wrote:
> >>> I don't know anything about this package, but read.csv returns a
> >>> data frame. How you go about forming a matrix using that data frame
> >>> depends what is in it. If it is all numeric then as.matrix may be
> >>> all you need.
> >>>
> >>> Half of any R data analysis is data... and the details are almost
> >>> always crucial. Since you have told us nothing useful about the
> >>> data, it is up to you to inspect your data and figure out what to do
> >>> with it.
> >>>
> >>> On November 30, 2021 10:55:13 AM PST, "Stephen H. Dawson, DSL via
> >>> R-help" <r-help at r-project.org> wrote:
> >>>> Hi,
> >>>>
> >>>>
> >>>> I am working to understand the Rfast functions of colMins and
> >>>> colMaxs. I worked through the example listed on page 54 of the PDF.
> >>>>
> >>>> https://cran.r-project.org/web/packages/Rfast/index.html
> >>>>
> >>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
> >>>>
> >>>> My data is in a CSV file. So, I bring it into R Studio using:
> >>>> Data <- read.csv("./input/DataSet05.csv", header=T)
> >>>>
> >>>> However, I read the instructions listed on page 54 of the PDF
> >>>> saying I need to bring data into R using a matrix. I think read.csv
> >>>> brings the data in as a dataframe. I think colMins is failing
> >>>> because it is looking for a matrix but finds a dataframe.
> >>>>
> >>>>> colMaxs(Data)
> >>>> Error in colMaxs(Data) :
> >>>>    Not compatible with requested type: [type=list; target=double].
> >>>>> colMins(Data, na.rm = TRUE)
> >>>> Error in colMins(Data, na.rm = TRUE) :
> >>>>    unused argument (na.rm = TRUE)
> >>>>> colMins(Data, value = FALSE, parallel = FALSE)
> >>>> Error in colMins(Data, value = FALSE, parallel = FALSE) :
> >>>>    Not compatible with requested type: [type=list; target=double].
> >>>>
> >>>> QUESTION
> >>>> What is the best practice to bring a csv file into R Studio so it
> >>>> can be accessed by colMaxs and colMins, please?
> >>>>
> >>>>
> >>>> Thanks,
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> >> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >>
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed Dec  1 17:31:44 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 01 Dec 2021 08:31:44 -0800
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <05fe01d7e665$7afa5330$70eef990$@verizon.net>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <CAGxFJbSWcEQ6+wAHMWMbAZN8+H=-MZeAck3oswYK=bTQg9YW1w@mail.gmail.com>
 <a051a615-a38a-e590-ca5d-d23f0c1e0e6c@shdawson.com>
 <CAGxFJbRDXgVq5V7FRv1i+cF_3vJpt9bhfcRiezfjTqc7-YyuAg@mail.gmail.com>
 <5c27e9c9-3f7e-2d28-bbb8-566586a59c79@shdawson.com>
 <05fe01d7e665$7afa5330$70eef990$@verizon.net>
Message-ID: <368D38C8-1302-49E6-AC20-6F54A5E29225@dcn.davis.ca.us>

Avi: As I understand it, the definition regarding what is on-topic is not targeted at tidyverse... it addresses the futility of trying to support the thousands of problem domains represented by contributed packages in one mailing list without drowning the subscribers in discussions about problem domains they are not interested in. This mailing list happens to be about the R language, and extends as far as the packages included with the R language. Tidyverse just happens to be outside this scope (though some here are more opposed to using it than others and express that sentiment in their responses).

Stephen: As to obtaining min or max of columns, such a question is nonsensical when the column contains character data, and mostly nonsensical when the data are binary regardless of what package you are using. From this perspective, it only makes sense to look at extremes on numeric columns selected from the data after they are loaded into a data frame.

    dta <- read.csv( "yourdata.csv" )
    dta_num <- dta[ , c("Elapsed_Time", "Age" ) ]

I don't know this package Rfast or its functions, but I would imagine that you could then use

    dta_maxs <- colMaxs( as.matrix( dta_num ) )

which might be a few microseconds faster than a typical base R solution:

    dta_maxs <- apply( dta_num, 2, max )

which works fine without loading a special package for this rather basic functionality.

Sometimes packages get developed to meet unusual needs (thousands of columns) or while chasing an optimization that turns out to be marginal (the real time sink may be in converting a data frame into a matrix so the compiled C code can then process it a smidge quicker), and none of this should be interfering in your learning of R but you end up following biased blogs or package vignettes that may or may not deliver on their promise to simplify your tasks.

Some aspects of tidyverse are quite effective and I use them regularly... but there are a lot of these less valuable contributions also that are distractions or are best for corner cases. You can only figure out the difference by learning the basics first and comparing approaches (sometimes a package that requires you to manually convert to matrix is a good idea, but sometimes it is just a pain) for usefulness and/or speed (e.g. using the microbenchmark contributed package).

On November 30, 2021 7:42:35 PM PST, Avi Gross via R-help <r-help at r-project.org> wrote:
>Stephen,
>
>Although what is in the STANDARD R distribution can vary several ways, in
>general, if you need to add a line like:
>
>library(something)
>or
>require(something)
>
>and your code does not work unless you have done that, then you can imagine
>it is not sort of built in to R as it starts.
>
>Having said that, tons of exceptions may exist that cause R to load in
>things on your machine for everyone or just for you without you having to
>notice.
>
>I think this forum lately has been deluged with questions about all kinds of
>add-on packages and in particular, lots of the ones in the tidyverse.
>Clearly the purpose here is not that broad.
>
>But since I use some packages like the tidyverse extensively, and I am far
>from alone, I wonder if someday the powers that be realize it is a losing
>battle to exclude at least some of it. It would be so nice not having to
>include a long list of packages for some programs or somehow arrange that
>people using something you shared had installed and loaded them. But there
>are too many packages out there of varying quality and usefulness and
>popularity with more every day being added. Worse, many are somewhat
>incompatible such as having functions with the same names that hide earlier
>ones loaded.
>
>Base R doe come with functions like colSums and colMeans and similar row
>functions. But as mentioned, a data.frame is a list of vectors and R
>supports certain functional programming constructs over lists using things
>like:
>
>lapply(df, min)
>sapply(df, min)
>
>And actually quite a few ways depending on what info you want back and
>whether you insist it be returned as a list or vector or other things . You
>can even supply additional arguments that might be needed such as if you
>want to ignore any NA values,
>
>lapply(df, min, na.rm=TRUE
>
>The package you looked at it is trying to be fast and uses what looks like
>compiled external code but so does lapply.
>
>If this is too bothersome for you, consider making a one-liner function like
>this:
>
>mycolMins <- function(df, ...) lapply(df, min, ...)
>
>Once defined, you can use that just fine and not think about it again and I
>note this answer (like others) is offering you something in base R that
>works fine on data.frames and the like.
>
>You can extend to many similar ideas like this one that calulates the min
>unless you over-ride it with max or mean or sd or a bizarre function like
>`[` so a call to:
>
>mycolCalc(df, `[`, 3)
>
>Will return exactly the third items in each row!
>
>I find it to be very common for someone these days to do a quick search for
>a way to do something in a language like R and not really look to see if it
>is a standard way or something special/ Matrices in R are not quite the same
>as some other objects like a data.frame or tibble and a package written to
>be used on one may (or may not) happen to work with another. Some packages
>are carefully written to try to detect what kind of object it gets and when
>possible convert it to another. The "apply" function is meant for matrices
>but if it sees something else it looks ta the dimensionality and tries to
>coerce it with as.matrix or as.array first. As others have noted, this mean
>a data.frame containing non-numeric parts may fail or should have any other
>columns hidden/removed as in this df that has some non-numeric fields:
>
>> df
>i       s   f     b i2
>1 1   hello 1.2  TRUE  5
>2 2   there 2.3 FALSE  4
>3 3 goodbye 3.4  TRUE  3
>
>So a bit more complex one-liner removes any non-numeric columns like this:
>
>> mycolMins(df[, sapply(df, is.numeric)])
>$i
>[1] 1
>
>$f
>[1] 1.2
>
>$i2
>[1] 3
>
>Clearly converting that to a matrix while whole would result in everything
>being converted to character and a minimum may be elusive.
>
>-----Original Message-----
>From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
>DSL via R-help
>Sent: Tuesday, November 30, 2021 5:37 PM
>To: Bert Gunter <bgunter.4567 at gmail.com>
>Cc: r-help at r-project.org
>Subject: Re: [R] Question about Rfast colMins and colMaxs
>
>Oh, you are segmenting standard R from the rest of R.
>
>Well, that part did not come across to me in your original reply. I am not
>clear on a standard versus non-standard list. I will look into this aspect
>and see what I can learn going forward.
>
>
>Thanks,
>*Stephen Dawson, DSL*
>/Executive Strategy Consultant/
>Business & Technology
>+1 (865) 804-3454
>http://www.shdawson.com <http://www.shdawson.com>
>
>
>On 11/30/21 5:26 PM, Bert Gunter wrote:
>> ... but Rfast is *not* a "standard" package, as the rest of the PG 
>> excerpt says. So contact the maintainer and ask him/her what they 
>> think the best practice should be for their package. As has been 
>> pointed out already, it appears to differ from the usual "read it in 
>> as a data frame" procedure.
>>
>> Bert
>>
>> On Tue, Nov 30, 2021 at 2:11 PM Stephen H. Dawson, DSL 
>> <service at shdawson.com> wrote:
>>> Right, R Studio is not R.
>>>
>>> However, the Rfast package is part of R.
>>>
>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>
>>> So, rephrasing my question...
>>> What is the best practice to bring a csv file into R so it can be 
>>> accessed by colMaxs and colMins, please?
>>>
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 11/30/21 3:19 PM, Bert Gunter wrote:
>>>> RStudio is **not** R. In particular, the so-called TidyVerse 
>>>> consists of all *non*-standard contributed packages, about which the PG
>says:
>>>>
>>>> "For questions about functions in standard packages distributed with 
>>>> R (see the FAQ Add-on packages in R), ask questions on R-help.
>>>> [The link is:
>>>> https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
>>>> This gives the list of current _standard_ packages]
>>>>
>>>> If the question relates to a contributed package , e.g., one 
>>>> downloaded from CRAN, try contacting the package maintainer first. 
>>>> You can also use find("functionname") and
>>>> packageDescription("packagename") to find this information. Only 
>>>> send such questions to R-help or R-devel if you get no reply or need 
>>>> further assistance. This applies to both requests for help and to 
>>>> bug reports."
>>>>
>>>> Note that RStudio maintains its own help resources at:
>>>> https://community.rstudio.com/
>>>> This is where questions about the TidyVerse, ggplot, etc. should be
>posted.
>>>>
>>>>
>>>>
>>>> Bert Gunter
>>>>
>>>> "The trouble with having an open mind is that people keep coming 
>>>> along and sticking things into it."
>>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>>>
>>>> On Tue, Nov 30, 2021 at 10:55 AM Stephen H. Dawson, DSL via R-help 
>>>> <r-help at r-project.org> wrote:
>>>>> Hi,
>>>>>
>>>>>
>>>>> I am working to understand the Rfast functions of colMins and 
>>>>> colMaxs. I worked through the example listed on page 54 of the PDF.
>>>>>
>>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>>
>>>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>>>>>
>>>>> My data is in a CSV file. So, I bring it into R Studio using:
>>>>> Data <- read.csv("./input/DataSet05.csv", header=T)
>>>>>
>>>>> However, I read the instructions listed on page 54 of the PDF 
>>>>> saying I need to bring data into R using a matrix. I think read.csv 
>>>>> brings the data in as a dataframe. I think colMins is failing 
>>>>> because it is looking for a matrix but finds a dataframe.
>>>>>
>>>>>    > colMaxs(Data)
>>>>> Error in colMaxs(Data) :
>>>>>      Not compatible with requested type: [type=list; target=double].
>>>>>    > colMins(Data, na.rm = TRUE)
>>>>> Error in colMins(Data, na.rm = TRUE) :
>>>>>      unused argument (na.rm = TRUE)
>>>>>    > colMins(Data, value = FALSE, parallel = FALSE) Error in 
>>>>> colMins(Data, value = FALSE, parallel = FALSE) :
>>>>>      Not compatible with requested type: [type=list; target=double].
>>>>>
>>>>> QUESTION
>>>>> What is the best practice to bring a csv file into R Studio so it 
>>>>> can be accessed by colMaxs and colMins, please?
>>>>>
>>>>>
>>>>> Thanks,
>>>>> --
>>>>> *Stephen Dawson, DSL*
>>>>> /Executive Strategy Consultant/
>>>>> Business & Technology
>>>>> +1 (865) 804-3454
>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>
>>>>> ______________________________________________
>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>> PLEASE do read the posting guide 
>>>>> http://www.R-project.org/posting-guide.html
>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From @erv|ce @end|ng |rom @hd@w@on@com  Wed Dec  1 17:59:16 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Wed, 1 Dec 2021 11:59:16 -0500
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <368D38C8-1302-49E6-AC20-6F54A5E29225@dcn.davis.ca.us>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <CAGxFJbSWcEQ6+wAHMWMbAZN8+H=-MZeAck3oswYK=bTQg9YW1w@mail.gmail.com>
 <a051a615-a38a-e590-ca5d-d23f0c1e0e6c@shdawson.com>
 <CAGxFJbRDXgVq5V7FRv1i+cF_3vJpt9bhfcRiezfjTqc7-YyuAg@mail.gmail.com>
 <5c27e9c9-3f7e-2d28-bbb8-566586a59c79@shdawson.com>
 <05fe01d7e665$7afa5330$70eef990$@verizon.net>
 <368D38C8-1302-49E6-AC20-6F54A5E29225@dcn.davis.ca.us>
Message-ID: <b5c1473d-a04e-9951-f47f-df526721ef1f@shdawson.com>

Hi Jeff,


Thanks for the reply.

Your attitude in your writing is terse.


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/1/21 11:31 AM, Jeff Newmiller wrote:
> Avi: As I understand it, the definition regarding what is on-topic is not targeted at tidyverse... it addresses the futility of trying to support the thousands of problem domains represented by contributed packages in one mailing list without drowning the subscribers in discussions about problem domains they are not interested in. This mailing list happens to be about the R language, and extends as far as the packages included with the R language. Tidyverse just happens to be outside this scope (though some here are more opposed to using it than others and express that sentiment in their responses).
>
> Stephen: As to obtaining min or max of columns, such a question is nonsensical when the column contains character data, and mostly nonsensical when the data are binary regardless of what package you are using. From this perspective, it only makes sense to look at extremes on numeric columns selected from the data after they are loaded into a data frame.
>
>      dta <- read.csv( "yourdata.csv" )
>      dta_num <- dta[ , c("Elapsed_Time", "Age" ) ]
>
> I don't know this package Rfast or its functions, but I would imagine that you could then use
>
>      dta_maxs <- colMaxs( as.matrix( dta_num ) )
>
> which might be a few microseconds faster than a typical base R solution:
>
>      dta_maxs <- apply( dta_num, 2, max )
>
> which works fine without loading a special package for this rather basic functionality.
>
> Sometimes packages get developed to meet unusual needs (thousands of columns) or while chasing an optimization that turns out to be marginal (the real time sink may be in converting a data frame into a matrix so the compiled C code can then process it a smidge quicker), and none of this should be interfering in your learning of R but you end up following biased blogs or package vignettes that may or may not deliver on their promise to simplify your tasks.
>
> Some aspects of tidyverse are quite effective and I use them regularly... but there are a lot of these less valuable contributions also that are distractions or are best for corner cases. You can only figure out the difference by learning the basics first and comparing approaches (sometimes a package that requires you to manually convert to matrix is a good idea, but sometimes it is just a pain) for usefulness and/or speed (e.g. using the microbenchmark contributed package).
>
> On November 30, 2021 7:42:35 PM PST, Avi Gross via R-help <r-help at r-project.org> wrote:
>> Stephen,
>>
>> Although what is in the STANDARD R distribution can vary several ways, in
>> general, if you need to add a line like:
>>
>> library(something)
>> or
>> require(something)
>>
>> and your code does not work unless you have done that, then you can imagine
>> it is not sort of built in to R as it starts.
>>
>> Having said that, tons of exceptions may exist that cause R to load in
>> things on your machine for everyone or just for you without you having to
>> notice.
>>
>> I think this forum lately has been deluged with questions about all kinds of
>> add-on packages and in particular, lots of the ones in the tidyverse.
>> Clearly the purpose here is not that broad.
>>
>> But since I use some packages like the tidyverse extensively, and I am far
> >from alone, I wonder if someday the powers that be realize it is a losing
>> battle to exclude at least some of it. It would be so nice not having to
>> include a long list of packages for some programs or somehow arrange that
>> people using something you shared had installed and loaded them. But there
>> are too many packages out there of varying quality and usefulness and
>> popularity with more every day being added. Worse, many are somewhat
>> incompatible such as having functions with the same names that hide earlier
>> ones loaded.
>>
>> Base R doe come with functions like colSums and colMeans and similar row
>> functions. But as mentioned, a data.frame is a list of vectors and R
>> supports certain functional programming constructs over lists using things
>> like:
>>
>> lapply(df, min)
>> sapply(df, min)
>>
>> And actually quite a few ways depending on what info you want back and
>> whether you insist it be returned as a list or vector or other things . You
>> can even supply additional arguments that might be needed such as if you
>> want to ignore any NA values,
>>
>> lapply(df, min, na.rm=TRUE
>>
>> The package you looked at it is trying to be fast and uses what looks like
>> compiled external code but so does lapply.
>>
>> If this is too bothersome for you, consider making a one-liner function like
>> this:
>>
>> mycolMins <- function(df, ...) lapply(df, min, ...)
>>
>> Once defined, you can use that just fine and not think about it again and I
>> note this answer (like others) is offering you something in base R that
>> works fine on data.frames and the like.
>>
>> You can extend to many similar ideas like this one that calulates the min
>> unless you over-ride it with max or mean or sd or a bizarre function like
>> `[` so a call to:
>>
>> mycolCalc(df, `[`, 3)
>>
>> Will return exactly the third items in each row!
>>
>> I find it to be very common for someone these days to do a quick search for
>> a way to do something in a language like R and not really look to see if it
>> is a standard way or something special/ Matrices in R are not quite the same
>> as some other objects like a data.frame or tibble and a package written to
>> be used on one may (or may not) happen to work with another. Some packages
>> are carefully written to try to detect what kind of object it gets and when
>> possible convert it to another. The "apply" function is meant for matrices
>> but if it sees something else it looks ta the dimensionality and tries to
>> coerce it with as.matrix or as.array first. As others have noted, this mean
>> a data.frame containing non-numeric parts may fail or should have any other
>> columns hidden/removed as in this df that has some non-numeric fields:
>>
>>> df
>> i       s   f     b i2
>> 1 1   hello 1.2  TRUE  5
>> 2 2   there 2.3 FALSE  4
>> 3 3 goodbye 3.4  TRUE  3
>>
>> So a bit more complex one-liner removes any non-numeric columns like this:
>>
>>> mycolMins(df[, sapply(df, is.numeric)])
>> $i
>> [1] 1
>>
>> $f
>> [1] 1.2
>>
>> $i2
>> [1] 3
>>
>> Clearly converting that to a matrix while whole would result in everything
>> being converted to character and a minimum may be elusive.
>>
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
>> DSL via R-help
>> Sent: Tuesday, November 30, 2021 5:37 PM
>> To: Bert Gunter <bgunter.4567 at gmail.com>
>> Cc: r-help at r-project.org
>> Subject: Re: [R] Question about Rfast colMins and colMaxs
>>
>> Oh, you are segmenting standard R from the rest of R.
>>
>> Well, that part did not come across to me in your original reply. I am not
>> clear on a standard versus non-standard list. I will look into this aspect
>> and see what I can learn going forward.
>>
>>
>> Thanks,
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 11/30/21 5:26 PM, Bert Gunter wrote:
>>> ... but Rfast is *not* a "standard" package, as the rest of the PG
>>> excerpt says. So contact the maintainer and ask him/her what they
>>> think the best practice should be for their package. As has been
>>> pointed out already, it appears to differ from the usual "read it in
>>> as a data frame" procedure.
>>>
>>> Bert
>>>
>>> On Tue, Nov 30, 2021 at 2:11 PM Stephen H. Dawson, DSL
>>> <service at shdawson.com> wrote:
>>>> Right, R Studio is not R.
>>>>
>>>> However, the Rfast package is part of R.
>>>>
>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>
>>>> So, rephrasing my question...
>>>> What is the best practice to bring a csv file into R so it can be
>>>> accessed by colMaxs and colMins, please?
>>>>
>>>> *Stephen Dawson, DSL*
>>>> /Executive Strategy Consultant/
>>>> Business & Technology
>>>> +1 (865) 804-3454
>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>
>>>>
>>>> On 11/30/21 3:19 PM, Bert Gunter wrote:
>>>>> RStudio is **not** R. In particular, the so-called TidyVerse
>>>>> consists of all *non*-standard contributed packages, about which the PG
>> says:
>>>>> "For questions about functions in standard packages distributed with
>>>>> R (see the FAQ Add-on packages in R), ask questions on R-help.
>>>>> [The link is:
>>>>> https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
>>>>> This gives the list of current _standard_ packages]
>>>>>
>>>>> If the question relates to a contributed package , e.g., one
>>>>> downloaded from CRAN, try contacting the package maintainer first.
>>>>> You can also use find("functionname") and
>>>>> packageDescription("packagename") to find this information. Only
>>>>> send such questions to R-help or R-devel if you get no reply or need
>>>>> further assistance. This applies to both requests for help and to
>>>>> bug reports."
>>>>>
>>>>> Note that RStudio maintains its own help resources at:
>>>>> https://community.rstudio.com/
>>>>> This is where questions about the TidyVerse, ggplot, etc. should be
>> posted.
>>>>>
>>>>>
>>>>> Bert Gunter
>>>>>
>>>>> "The trouble with having an open mind is that people keep coming
>>>>> along and sticking things into it."
>>>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>>>>
>>>>> On Tue, Nov 30, 2021 at 10:55 AM Stephen H. Dawson, DSL via R-help
>>>>> <r-help at r-project.org> wrote:
>>>>>> Hi,
>>>>>>
>>>>>>
>>>>>> I am working to understand the Rfast functions of colMins and
>>>>>> colMaxs. I worked through the example listed on page 54 of the PDF.
>>>>>>
>>>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>>>
>>>>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>>>>>>
>>>>>> My data is in a CSV file. So, I bring it into R Studio using:
>>>>>> Data <- read.csv("./input/DataSet05.csv", header=T)
>>>>>>
>>>>>> However, I read the instructions listed on page 54 of the PDF
>>>>>> saying I need to bring data into R using a matrix. I think read.csv
>>>>>> brings the data in as a dataframe. I think colMins is failing
>>>>>> because it is looking for a matrix but finds a dataframe.
>>>>>>
>>>>>>     > colMaxs(Data)
>>>>>> Error in colMaxs(Data) :
>>>>>>       Not compatible with requested type: [type=list; target=double].
>>>>>>     > colMins(Data, na.rm = TRUE)
>>>>>> Error in colMins(Data, na.rm = TRUE) :
>>>>>>       unused argument (na.rm = TRUE)
>>>>>>     > colMins(Data, value = FALSE, parallel = FALSE) Error in
>>>>>> colMins(Data, value = FALSE, parallel = FALSE) :
>>>>>>       Not compatible with requested type: [type=list; target=double].
>>>>>>
>>>>>> QUESTION
>>>>>> What is the best practice to bring a csv file into R Studio so it
>>>>>> can be accessed by colMaxs and colMins, please?
>>>>>>
>>>>>>
>>>>>> Thanks,
>>>>>> --
>>>>>> *Stephen Dawson, DSL*
>>>>>> /Executive Strategy Consultant/
>>>>>> Business & Technology
>>>>>> +1 (865) 804-3454
>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>> PLEASE do read the posting guide
>>>>>> http://www.R-project.org/posting-guide.html
>>>>>> and provide commented, minimal, self-contained, reproducible code.
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From @erv|ce @end|ng |rom @hd@w@on@com  Wed Dec  1 18:05:13 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Wed, 1 Dec 2021 12:05:13 -0500
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <b911b470798242b4b50db758837979e1@SRVEXCHCM1301.precheza.cz>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <BF32C534-58AA-42FF-9720-A07FBCF57F5C@dcn.davis.ca.us>
 <d9858425-2515-9cba-8250-a06c7e76239d@shdawson.com>
 <0051e760-7444-0d68-6492-1a3949fde288@shdawson.com>
 <4e480fce-de00-f72d-15b5-99776ede8927@shdawson.com>
 <b911b470798242b4b50db758837979e1@SRVEXCHCM1301.precheza.cz>
Message-ID: <48b9e858-ff8e-86cb-aa64-775f0d7958e4@shdawson.com>

Thank you, Petr, for the kind explanation.


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/1/21 11:19 AM, PIKAL Petr wrote:
> Hi.
>
> It is always worth to consult excellent R help.
>
> max and min return the maximum or minimum of all the values present in their arguments, as integer if all are logical or integer, as double if all are numeric, and character otherwise.
>
> Character versions are sorted lexicographically, and this depends on the collating sequence of the locale in use: the help for ?Comparison? gives details. The max/min of an empty character vector is defined to be character NA. (One could argue that as "" is the smallest character element, the maximum should be "", but there is no obvious candidate for the minimum.)
>
> Cheers
> Petr
>
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H.
>> Dawson, DSL via R-help
>> Sent: Wednesday, December 1, 2021 5:11 PM
>> To: r-help at r-project.org
>> Subject: Re: [R] Question about Rfast colMins and colMaxs
>>
>> Jeff,
>>
>> Can you use max and min evaluations on any other data type then numeric?
>> If so, how do you evaluate max or min of text content? String length?
>> Ascii values of text characters?
>>
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 11/30/21 5:23 PM, Stephen H. Dawson, DSL via R-help wrote:
>>> Well, no it is not. The email list stripped off the attachment.
>>>
>>> The data is numeric, happens to be all whole numbers.
>>>
>>>
>>> Kindest Regards,
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 11/30/21 5:14 PM, Stephen H. Dawson, DSL via R-help wrote:
>>>> Hi Jeff,
>>>>
>>>>
>>>> Thanks for the data review offer. Attached is the CSV.
>>>>
>>>>
>>>> *Stephen Dawson, DSL*
>>>> /Executive Strategy Consultant/
>>>> Business & Technology
>>>> +1 (865) 804-3454
>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>
>>>>
>>>> On 11/30/21 3:29 PM, Jeff Newmiller wrote:
>>>>> I don't know anything about this package, but read.csv returns a
>>>>> data frame. How you go about forming a matrix using that data frame
>>>>> depends what is in it. If it is all numeric then as.matrix may be
>>>>> all you need.
>>>>>
>>>>> Half of any R data analysis is data... and the details are almost
>>>>> always crucial. Since you have told us nothing useful about the
>>>>> data, it is up to you to inspect your data and figure out what to do
>>>>> with it.
>>>>>
>>>>> On November 30, 2021 10:55:13 AM PST, "Stephen H. Dawson, DSL via
>>>>> R-help" <r-help at r-project.org> wrote:
>>>>>> Hi,
>>>>>>
>>>>>>
>>>>>> I am working to understand the Rfast functions of colMins and
>>>>>> colMaxs. I worked through the example listed on page 54 of the PDF.
>>>>>>
>>>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>>>
>>>>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>>>>>>
>>>>>> My data is in a CSV file. So, I bring it into R Studio using:
>>>>>> Data <- read.csv("./input/DataSet05.csv", header=T)
>>>>>>
>>>>>> However, I read the instructions listed on page 54 of the PDF
>>>>>> saying I need to bring data into R using a matrix. I think read.csv
>>>>>> brings the data in as a dataframe. I think colMins is failing
>>>>>> because it is looking for a matrix but finds a dataframe.
>>>>>>
>>>>>>> colMaxs(Data)
>>>>>> Error in colMaxs(Data) :
>>>>>>     Not compatible with requested type: [type=list; target=double].
>>>>>>> colMins(Data, na.rm = TRUE)
>>>>>> Error in colMins(Data, na.rm = TRUE) :
>>>>>>     unused argument (na.rm = TRUE)
>>>>>>> colMins(Data, value = FALSE, parallel = FALSE)
>>>>>> Error in colMins(Data, value = FALSE, parallel = FALSE) :
>>>>>>     Not compatible with requested type: [type=list; target=double].
>>>>>>
>>>>>> QUESTION
>>>>>> What is the best practice to bring a csv file into R Studio so it
>>>>>> can be accessed by colMaxs and colMins, please?
>>>>>>
>>>>>>
>>>>>> Thanks,
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-
>> guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From @erv|ce @end|ng |rom @hd@w@on@com  Wed Dec  1 18:06:23 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Wed, 1 Dec 2021 12:06:23 -0500
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <05fe01d7e665$7afa5330$70eef990$@verizon.net>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <CAGxFJbSWcEQ6+wAHMWMbAZN8+H=-MZeAck3oswYK=bTQg9YW1w@mail.gmail.com>
 <a051a615-a38a-e590-ca5d-d23f0c1e0e6c@shdawson.com>
 <CAGxFJbRDXgVq5V7FRv1i+cF_3vJpt9bhfcRiezfjTqc7-YyuAg@mail.gmail.com>
 <5c27e9c9-3f7e-2d28-bbb8-566586a59c79@shdawson.com>
 <05fe01d7e665$7afa5330$70eef990$@verizon.net>
Message-ID: <88a92cac-5dd6-9e75-7aba-5da491ebe59e@shdawson.com>

Thanks, Avi.

Yes, loading packages by library command is necessary to access a 
function not resident in the standard R code.

The data set I am reviewing has column names changing. The thought is to 
do a review of max and min for whatever the column names happen to be 
for the data input I am reviewing.


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 11/30/21 10:42 PM, Avi Gross via R-help wrote:
> Stephen,
>
> Although what is in the STANDARD R distribution can vary several ways, in
> general, if you need to add a line like:
>
> library(something)
> or
> require(something)
>
> and your code does not work unless you have done that, then you can imagine
> it is not sort of built in to R as it starts.
>
> Having said that, tons of exceptions may exist that cause R to load in
> things on your machine for everyone or just for you without you having to
> notice.
>
> I think this forum lately has been deluged with questions about all kinds of
> add-on packages and in particular, lots of the ones in the tidyverse.
> Clearly the purpose here is not that broad.
>
> But since I use some packages like the tidyverse extensively, and I am far
> from alone, I wonder if someday the powers that be realize it is a losing
> battle to exclude at least some of it. It would be so nice not having to
> include a long list of packages for some programs or somehow arrange that
> people using something you shared had installed and loaded them. But there
> are too many packages out there of varying quality and usefulness and
> popularity with more every day being added. Worse, many are somewhat
> incompatible such as having functions with the same names that hide earlier
> ones loaded.
>
> Base R doe come with functions like colSums and colMeans and similar row
> functions. But as mentioned, a data.frame is a list of vectors and R
> supports certain functional programming constructs over lists using things
> like:
>
> lapply(df, min)
> sapply(df, min)
>
> And actually quite a few ways depending on what info you want back and
> whether you insist it be returned as a list or vector or other things . You
> can even supply additional arguments that might be needed such as if you
> want to ignore any NA values,
>
> lapply(df, min, na.rm=TRUE
>
> The package you looked at it is trying to be fast and uses what looks like
> compiled external code but so does lapply.
>
> If this is too bothersome for you, consider making a one-liner function like
> this:
>
> mycolMins <- function(df, ...) lapply(df, min, ...)
>
> Once defined, you can use that just fine and not think about it again and I
> note this answer (like others) is offering you something in base R that
> works fine on data.frames and the like.
>
> You can extend to many similar ideas like this one that calulates the min
> unless you over-ride it with max or mean or sd or a bizarre function like
> `[` so a call to:
>
> mycolCalc(df, `[`, 3)
>
> Will return exactly the third items in each row!
>
> I find it to be very common for someone these days to do a quick search for
> a way to do something in a language like R and not really look to see if it
> is a standard way or something special/ Matrices in R are not quite the same
> as some other objects like a data.frame or tibble and a package written to
> be used on one may (or may not) happen to work with another. Some packages
> are carefully written to try to detect what kind of object it gets and when
> possible convert it to another. The "apply" function is meant for matrices
> but if it sees something else it looks ta the dimensionality and tries to
> coerce it with as.matrix or as.array first. As others have noted, this mean
> a data.frame containing non-numeric parts may fail or should have any other
> columns hidden/removed as in this df that has some non-numeric fields:
>
>> df
> i       s   f     b i2
> 1 1   hello 1.2  TRUE  5
> 2 2   there 2.3 FALSE  4
> 3 3 goodbye 3.4  TRUE  3
>
> So a bit more complex one-liner removes any non-numeric columns like this:
>
>> mycolMins(df[, sapply(df, is.numeric)])
> $i
> [1] 1
>
> $f
> [1] 1.2
>
> $i2
> [1] 3
>
> Clearly converting that to a matrix while whole would result in everything
> being converted to character and a minimum may be elusive.
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
> DSL via R-help
> Sent: Tuesday, November 30, 2021 5:37 PM
> To: Bert Gunter <bgunter.4567 at gmail.com>
> Cc: r-help at r-project.org
> Subject: Re: [R] Question about Rfast colMins and colMaxs
>
> Oh, you are segmenting standard R from the rest of R.
>
> Well, that part did not come across to me in your original reply. I am not
> clear on a standard versus non-standard list. I will look into this aspect
> and see what I can learn going forward.
>
>
> Thanks,
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
>
> On 11/30/21 5:26 PM, Bert Gunter wrote:
>> ... but Rfast is *not* a "standard" package, as the rest of the PG
>> excerpt says. So contact the maintainer and ask him/her what they
>> think the best practice should be for their package. As has been
>> pointed out already, it appears to differ from the usual "read it in
>> as a data frame" procedure.
>>
>> Bert
>>
>> On Tue, Nov 30, 2021 at 2:11 PM Stephen H. Dawson, DSL
>> <service at shdawson.com> wrote:
>>> Right, R Studio is not R.
>>>
>>> However, the Rfast package is part of R.
>>>
>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>
>>> So, rephrasing my question...
>>> What is the best practice to bring a csv file into R so it can be
>>> accessed by colMaxs and colMins, please?
>>>
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 11/30/21 3:19 PM, Bert Gunter wrote:
>>>> RStudio is **not** R. In particular, the so-called TidyVerse
>>>> consists of all *non*-standard contributed packages, about which the PG
> says:
>>>> "For questions about functions in standard packages distributed with
>>>> R (see the FAQ Add-on packages in R), ask questions on R-help.
>>>> [The link is:
>>>> https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
>>>> This gives the list of current _standard_ packages]
>>>>
>>>> If the question relates to a contributed package , e.g., one
>>>> downloaded from CRAN, try contacting the package maintainer first.
>>>> You can also use find("functionname") and
>>>> packageDescription("packagename") to find this information. Only
>>>> send such questions to R-help or R-devel if you get no reply or need
>>>> further assistance. This applies to both requests for help and to
>>>> bug reports."
>>>>
>>>> Note that RStudio maintains its own help resources at:
>>>> https://community.rstudio.com/
>>>> This is where questions about the TidyVerse, ggplot, etc. should be
> posted.
>>>>
>>>>
>>>> Bert Gunter
>>>>
>>>> "The trouble with having an open mind is that people keep coming
>>>> along and sticking things into it."
>>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>>>
>>>> On Tue, Nov 30, 2021 at 10:55 AM Stephen H. Dawson, DSL via R-help
>>>> <r-help at r-project.org> wrote:
>>>>> Hi,
>>>>>
>>>>>
>>>>> I am working to understand the Rfast functions of colMins and
>>>>> colMaxs. I worked through the example listed on page 54 of the PDF.
>>>>>
>>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>>
>>>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>>>>>
>>>>> My data is in a CSV file. So, I bring it into R Studio using:
>>>>> Data <- read.csv("./input/DataSet05.csv", header=T)
>>>>>
>>>>> However, I read the instructions listed on page 54 of the PDF
>>>>> saying I need to bring data into R using a matrix. I think read.csv
>>>>> brings the data in as a dataframe. I think colMins is failing
>>>>> because it is looking for a matrix but finds a dataframe.
>>>>>
>>>>>     > colMaxs(Data)
>>>>> Error in colMaxs(Data) :
>>>>>       Not compatible with requested type: [type=list; target=double].
>>>>>     > colMins(Data, na.rm = TRUE)
>>>>> Error in colMins(Data, na.rm = TRUE) :
>>>>>       unused argument (na.rm = TRUE)
>>>>>     > colMins(Data, value = FALSE, parallel = FALSE) Error in
>>>>> colMins(Data, value = FALSE, parallel = FALSE) :
>>>>>       Not compatible with requested type: [type=list; target=double].
>>>>>
>>>>> QUESTION
>>>>> What is the best practice to bring a csv file into R Studio so it
>>>>> can be accessed by colMaxs and colMins, please?
>>>>>
>>>>>
>>>>> Thanks,
>>>>> --
>>>>> *Stephen Dawson, DSL*
>>>>> /Executive Strategy Consultant/
>>>>> Business & Technology
>>>>> +1 (865) 804-3454
>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>
>>>>> ______________________________________________
>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>> PLEASE do read the posting guide
>>>>> http://www.R-project.org/posting-guide.html
>>>>> and provide commented, minimal, self-contained, reproducible code.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From bgunter@4567 @end|ng |rom gm@||@com  Wed Dec  1 18:23:06 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 1 Dec 2021 09:23:06 -0800
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <368D38C8-1302-49E6-AC20-6F54A5E29225@dcn.davis.ca.us>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <CAGxFJbSWcEQ6+wAHMWMbAZN8+H=-MZeAck3oswYK=bTQg9YW1w@mail.gmail.com>
 <a051a615-a38a-e590-ca5d-d23f0c1e0e6c@shdawson.com>
 <CAGxFJbRDXgVq5V7FRv1i+cF_3vJpt9bhfcRiezfjTqc7-YyuAg@mail.gmail.com>
 <5c27e9c9-3f7e-2d28-bbb8-566586a59c79@shdawson.com>
 <05fe01d7e665$7afa5330$70eef990$@verizon.net>
 <368D38C8-1302-49E6-AC20-6F54A5E29225@dcn.davis.ca.us>
Message-ID: <CAGxFJbSx1bDcX89XJHVozLr7Lnpd=XpSYi1+zXcDEF+jq2qxvg@mail.gmail.com>

"As to obtaining min or max of columns, such a question is nonsensical
when the column contains character data,"

That is false.

First, if it's plain (unclassed) character data, character data is
sorted lexicographically, which depends on the locale, as Petr already
pointed out.

Perhaps more useful, however, is that of the character data has been
classed as an *ordered* factor, then max, min, and range are all
meaningfully interpreted for it according to the ordering:

> z <- ordered(sample(letters[1:3], 10,rep = TRUE), levels = c('c','a','b'))
> z
 [1] a a c b b c a a b c
Levels: c < a < b
> max(z)
[1] b
Levels: c < a < b
> min(z)
[1] c
Levels: c < a < b
> range(z)
[1] c b
Levels: c < a < b
> sort(z)
 [1] c c c a a a a b b b
Levels: c < a < b
### etc.

See ?ordered for details, and particularly note:
"There are "factor" and "ordered" methods for the group generic Ops
which provide methods for the Comparison operators, and for the min,
max, and range generics in Summary of "ordered". (The rest of the
groups and the Math group generate an error as they are not meaningful
for factors.)"

(You would have to go down a rabbit hole to learn about group generics
for S3 classes, but I think you can ignore those details for the
purposes here).

Bert Gunter

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Wed, Dec 1, 2021 at 8:41 AM Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
>
> Avi: As I understand it, the definition regarding what is on-topic is not targeted at tidyverse... it addresses the futility of trying to support the thousands of problem domains represented by contributed packages in one mailing list without drowning the subscribers in discussions about problem domains they are not interested in. This mailing list happens to be about the R language, and extends as far as the packages included with the R language. Tidyverse just happens to be outside this scope (though some here are more opposed to using it than others and express that sentiment in their responses).
>
> Stephen: As to obtaining min or max of columns, such a question is nonsensical when the column contains character data, and mostly nonsensical when the data are binary regardless of what package you are using. From this perspective, it only makes sense to look at extremes on numeric columns selected from the data after they are loaded into a data frame.
>
>     dta <- read.csv( "yourdata.csv" )
>     dta_num <- dta[ , c("Elapsed_Time", "Age" ) ]
>
> I don't know this package Rfast or its functions, but I would imagine that you could then use
>
>     dta_maxs <- colMaxs( as.matrix( dta_num ) )
>
> which might be a few microseconds faster than a typical base R solution:
>
>     dta_maxs <- apply( dta_num, 2, max )
>
> which works fine without loading a special package for this rather basic functionality.
>
> Sometimes packages get developed to meet unusual needs (thousands of columns) or while chasing an optimization that turns out to be marginal (the real time sink may be in converting a data frame into a matrix so the compiled C code can then process it a smidge quicker), and none of this should be interfering in your learning of R but you end up following biased blogs or package vignettes that may or may not deliver on their promise to simplify your tasks.
>
> Some aspects of tidyverse are quite effective and I use them regularly... but there are a lot of these less valuable contributions also that are distractions or are best for corner cases. You can only figure out the difference by learning the basics first and comparing approaches (sometimes a package that requires you to manually convert to matrix is a good idea, but sometimes it is just a pain) for usefulness and/or speed (e.g. using the microbenchmark contributed package).
>
> On November 30, 2021 7:42:35 PM PST, Avi Gross via R-help <r-help at r-project.org> wrote:
> >Stephen,
> >
> >Although what is in the STANDARD R distribution can vary several ways, in
> >general, if you need to add a line like:
> >
> >library(something)
> >or
> >require(something)
> >
> >and your code does not work unless you have done that, then you can imagine
> >it is not sort of built in to R as it starts.
> >
> >Having said that, tons of exceptions may exist that cause R to load in
> >things on your machine for everyone or just for you without you having to
> >notice.
> >
> >I think this forum lately has been deluged with questions about all kinds of
> >add-on packages and in particular, lots of the ones in the tidyverse.
> >Clearly the purpose here is not that broad.
> >
> >But since I use some packages like the tidyverse extensively, and I am far
> >from alone, I wonder if someday the powers that be realize it is a losing
> >battle to exclude at least some of it. It would be so nice not having to
> >include a long list of packages for some programs or somehow arrange that
> >people using something you shared had installed and loaded them. But there
> >are too many packages out there of varying quality and usefulness and
> >popularity with more every day being added. Worse, many are somewhat
> >incompatible such as having functions with the same names that hide earlier
> >ones loaded.
> >
> >Base R doe come with functions like colSums and colMeans and similar row
> >functions. But as mentioned, a data.frame is a list of vectors and R
> >supports certain functional programming constructs over lists using things
> >like:
> >
> >lapply(df, min)
> >sapply(df, min)
> >
> >And actually quite a few ways depending on what info you want back and
> >whether you insist it be returned as a list or vector or other things . You
> >can even supply additional arguments that might be needed such as if you
> >want to ignore any NA values,
> >
> >lapply(df, min, na.rm=TRUE
> >
> >The package you looked at it is trying to be fast and uses what looks like
> >compiled external code but so does lapply.
> >
> >If this is too bothersome for you, consider making a one-liner function like
> >this:
> >
> >mycolMins <- function(df, ...) lapply(df, min, ...)
> >
> >Once defined, you can use that just fine and not think about it again and I
> >note this answer (like others) is offering you something in base R that
> >works fine on data.frames and the like.
> >
> >You can extend to many similar ideas like this one that calulates the min
> >unless you over-ride it with max or mean or sd or a bizarre function like
> >`[` so a call to:
> >
> >mycolCalc(df, `[`, 3)
> >
> >Will return exactly the third items in each row!
> >
> >I find it to be very common for someone these days to do a quick search for
> >a way to do something in a language like R and not really look to see if it
> >is a standard way or something special/ Matrices in R are not quite the same
> >as some other objects like a data.frame or tibble and a package written to
> >be used on one may (or may not) happen to work with another. Some packages
> >are carefully written to try to detect what kind of object it gets and when
> >possible convert it to another. The "apply" function is meant for matrices
> >but if it sees something else it looks ta the dimensionality and tries to
> >coerce it with as.matrix or as.array first. As others have noted, this mean
> >a data.frame containing non-numeric parts may fail or should have any other
> >columns hidden/removed as in this df that has some non-numeric fields:
> >
> >> df
> >i       s   f     b i2
> >1 1   hello 1.2  TRUE  5
> >2 2   there 2.3 FALSE  4
> >3 3 goodbye 3.4  TRUE  3
> >
> >So a bit more complex one-liner removes any non-numeric columns like this:
> >
> >> mycolMins(df[, sapply(df, is.numeric)])
> >$i
> >[1] 1
> >
> >$f
> >[1] 1.2
> >
> >$i2
> >[1] 3
> >
> >Clearly converting that to a matrix while whole would result in everything
> >being converted to character and a minimum may be elusive.
> >
> >-----Original Message-----
> >From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
> >DSL via R-help
> >Sent: Tuesday, November 30, 2021 5:37 PM
> >To: Bert Gunter <bgunter.4567 at gmail.com>
> >Cc: r-help at r-project.org
> >Subject: Re: [R] Question about Rfast colMins and colMaxs
> >
> >Oh, you are segmenting standard R from the rest of R.
> >
> >Well, that part did not come across to me in your original reply. I am not
> >clear on a standard versus non-standard list. I will look into this aspect
> >and see what I can learn going forward.
> >
> >
> >Thanks,
> >*Stephen Dawson, DSL*
> >/Executive Strategy Consultant/
> >Business & Technology
> >+1 (865) 804-3454
> >http://www.shdawson.com <http://www.shdawson.com>
> >
> >
> >On 11/30/21 5:26 PM, Bert Gunter wrote:
> >> ... but Rfast is *not* a "standard" package, as the rest of the PG
> >> excerpt says. So contact the maintainer and ask him/her what they
> >> think the best practice should be for their package. As has been
> >> pointed out already, it appears to differ from the usual "read it in
> >> as a data frame" procedure.
> >>
> >> Bert
> >>
> >> On Tue, Nov 30, 2021 at 2:11 PM Stephen H. Dawson, DSL
> >> <service at shdawson.com> wrote:
> >>> Right, R Studio is not R.
> >>>
> >>> However, the Rfast package is part of R.
> >>>
> >>> https://cran.r-project.org/web/packages/Rfast/index.html
> >>>
> >>> So, rephrasing my question...
> >>> What is the best practice to bring a csv file into R so it can be
> >>> accessed by colMaxs and colMins, please?
> >>>
> >>> *Stephen Dawson, DSL*
> >>> /Executive Strategy Consultant/
> >>> Business & Technology
> >>> +1 (865) 804-3454
> >>> http://www.shdawson.com <http://www.shdawson.com>
> >>>
> >>>
> >>> On 11/30/21 3:19 PM, Bert Gunter wrote:
> >>>> RStudio is **not** R. In particular, the so-called TidyVerse
> >>>> consists of all *non*-standard contributed packages, about which the PG
> >says:
> >>>>
> >>>> "For questions about functions in standard packages distributed with
> >>>> R (see the FAQ Add-on packages in R), ask questions on R-help.
> >>>> [The link is:
> >>>> https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
> >>>> This gives the list of current _standard_ packages]
> >>>>
> >>>> If the question relates to a contributed package , e.g., one
> >>>> downloaded from CRAN, try contacting the package maintainer first.
> >>>> You can also use find("functionname") and
> >>>> packageDescription("packagename") to find this information. Only
> >>>> send such questions to R-help or R-devel if you get no reply or need
> >>>> further assistance. This applies to both requests for help and to
> >>>> bug reports."
> >>>>
> >>>> Note that RStudio maintains its own help resources at:
> >>>> https://community.rstudio.com/
> >>>> This is where questions about the TidyVerse, ggplot, etc. should be
> >posted.
> >>>>
> >>>>
> >>>>
> >>>> Bert Gunter
> >>>>
> >>>> "The trouble with having an open mind is that people keep coming
> >>>> along and sticking things into it."
> >>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> >>>>
> >>>> On Tue, Nov 30, 2021 at 10:55 AM Stephen H. Dawson, DSL via R-help
> >>>> <r-help at r-project.org> wrote:
> >>>>> Hi,
> >>>>>
> >>>>>
> >>>>> I am working to understand the Rfast functions of colMins and
> >>>>> colMaxs. I worked through the example listed on page 54 of the PDF.
> >>>>>
> >>>>> https://cran.r-project.org/web/packages/Rfast/index.html
> >>>>>
> >>>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
> >>>>>
> >>>>> My data is in a CSV file. So, I bring it into R Studio using:
> >>>>> Data <- read.csv("./input/DataSet05.csv", header=T)
> >>>>>
> >>>>> However, I read the instructions listed on page 54 of the PDF
> >>>>> saying I need to bring data into R using a matrix. I think read.csv
> >>>>> brings the data in as a dataframe. I think colMins is failing
> >>>>> because it is looking for a matrix but finds a dataframe.
> >>>>>
> >>>>>    > colMaxs(Data)
> >>>>> Error in colMaxs(Data) :
> >>>>>      Not compatible with requested type: [type=list; target=double].
> >>>>>    > colMins(Data, na.rm = TRUE)
> >>>>> Error in colMins(Data, na.rm = TRUE) :
> >>>>>      unused argument (na.rm = TRUE)
> >>>>>    > colMins(Data, value = FALSE, parallel = FALSE) Error in
> >>>>> colMins(Data, value = FALSE, parallel = FALSE) :
> >>>>>      Not compatible with requested type: [type=list; target=double].
> >>>>>
> >>>>> QUESTION
> >>>>> What is the best practice to bring a csv file into R Studio so it
> >>>>> can be accessed by colMaxs and colMins, please?
> >>>>>
> >>>>>
> >>>>> Thanks,
> >>>>> --
> >>>>> *Stephen Dawson, DSL*
> >>>>> /Executive Strategy Consultant/
> >>>>> Business & Technology
> >>>>> +1 (865) 804-3454
> >>>>> http://www.shdawson.com <http://www.shdawson.com>
> >>>>>
> >>>>> ______________________________________________
> >>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>>>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>>>> PLEASE do read the posting guide
> >>>>> http://www.R-project.org/posting-guide.html
> >>>>> and provide commented, minimal, self-contained, reproducible code.
> >>>
> >
> >______________________________________________
> >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >https://stat.ethz.ch/mailman/listinfo/r-help
> >PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >and provide commented, minimal, self-contained, reproducible code.
> >
> >______________________________________________
> >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >https://stat.ethz.ch/mailman/listinfo/r-help
> >PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >and provide commented, minimal, self-contained, reproducible code.
>
> --
> Sent from my phone. Please excuse my brevity.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From drj|m|emon @end|ng |rom gm@||@com  Wed Dec  1 22:36:42 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Thu, 2 Dec 2021 08:36:42 +1100
Subject: [R] help
In-Reply-To: <CAB5P51vj8bRx2MkmnUTg_GASugy_zLu=c_9XDRFgdVhJBVxtdQ@mail.gmail.com>
References: <CAB5P51vj8bRx2MkmnUTg_GASugy_zLu=c_9XDRFgdVhJBVxtdQ@mail.gmail.com>
Message-ID: <CA+8X3fU3RZuppVj3fbUnFg4Rf1hxDdwMke8BMpuTYcBu0zxK2A@mail.gmail.com>

Hi mehdi,
Try this (first example in the help page):

ref<-rnorm(30,sd=2)
 # add a little noise
 model1<-ref+rnorm(30)/2
 # add more noise
 model2<-ref+rnorm(30)
 # display the diagram with the better model
 oldpar<-taylor.diagram(ref,model1)
 # now add the worse model
 taylor.diagram(ref,model2,add=TRUE,col="blue")
 # get approximate legend position
 lpos<-1.5*sd(ref)
 # add a legend
 legend(lpos,lpos,legend=c("Better","Worse"),pch=19,col=c("red","blue"))
 # now restore par values
 par(oldpar)

What you have done is to leave out the "reference" model (ref), so
that the second argument is missing.

Jim

On Wed, Dec 1, 2021 at 7:29 PM mehdi ghasemi <ghasemimehdi61 at gmail.com> wrote:
>
> Hi Dr
>
> If we want to draw two plots only in a Taylor diagram ,What  the  attached  code should be modified ?
> thanks


From dpweyg@nd @end|ng |rom gm@||@com  Wed Dec  1 22:38:37 2021
From: dpweyg@nd @end|ng |rom gm@||@com (Dennis Weygand)
Date: Wed, 1 Dec 2021 16:38:37 -0500
Subject: [R] readxl/lifecycle/rlang
Message-ID: <CAJgAAVS-ZB=pDLA8gUagQr4_5q=k3sd49xuT3Q5xP7sVpRCoUQ@mail.gmail.com>

I have been using read_excel for years... suddenly today I have this
problem:

> T1 <- read_excel(fname,sheet="T1")
Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]])
:
  there is no package called ?lifecycle?

So I install lifecycle:

install.packages("lifecycle")
WARNING: Rtools is required to build R packages but is not currently
installed. Please download and install the appropriate version of Rtools
before proceeding:

https://cran.rstudio.com/bin/windows/Rtools/
Installing package into ?C:/Users/dennisweygand/Documents/R/win-library/3.5?
(as ?lib? is unspecified)
also installing the dependency ?rlang?


  There are binary versions available but the source versions are later:
          binary source needs_compilation
rlang      0.4.5 0.4.12              TRUE
lifecycle  0.2.0  1.0.1             FALSE

  Binaries will be installed
trying URL 'https://cran.rstudio.com/bin/windows/contrib/3.5/rlang_0.4.5.zip
'
Content type 'application/zip' length 1115838 bytes (1.1 MB)
downloaded 1.1 MB

package ?rlang? successfully unpacked and MD5 sums checked
Warning in install.packages :
  cannot remove prior installation of package ?rlang?

The downloaded binary packages are in
C:\Users\dennisweygand\AppData\Local\Temp\RtmpKSler3\downloaded_packages
installing the source package ?lifecycle?

trying URL 'https://cran.rstudio.com/src/contrib/lifecycle_1.0.1.tar.gz'
Content type 'application/x-gzip' length 99716 bytes (97 KB)
downloaded 97 KB

ERROR: dependency 'rlang' is not available for package 'lifecycle'
* removing 'C:/Users/dennisweygand/Documents/R/win-library/3.5/lifecycle'
In R CMD INSTALL
Warning in install.packages :
  installation of package ?lifecycle? had non-zero exit status

The downloaded source packages are in
?C:\Users\dennisweygand\AppData\Local\Temp\RtmpKSler3\downloaded_packages?


Did it work?
Try it again:

> T1 <- read_excel(fname,sheet="T1")
Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]])
:
  there is no package called ?lifecycle?

I am clueless: what am I doing wrong?
Can anyone help?
D.P. Weygand

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Dec  2 00:15:12 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 01 Dec 2021 15:15:12 -0800
Subject: [R] readxl/lifecycle/rlang
In-Reply-To: <CAJgAAVS-ZB=pDLA8gUagQr4_5q=k3sd49xuT3Q5xP7sVpRCoUQ@mail.gmail.com>
References: <CAJgAAVS-ZB=pDLA8gUagQr4_5q=k3sd49xuT3Q5xP7sVpRCoUQ@mail.gmail.com>
Message-ID: <9E673E53-77EA-4A77-AB36-352A950B44B4@dcn.davis.ca.us>

This

>package ?rlang? successfully unpacked and MD5 sums checked
>Warning in install.packages :
>  cannot remove prior installation of package ?rlang?

indicates that rlang didn't get re-installed. It is a warning because R seems to think it could still be working, but it isn't verifying that status.

Below that,

>ERROR: dependency 'rlang' is not available for package 'lifecycle'

indicates that there is still a problem with rlang.

The "cannot remove prior installation" often means that the installed package is open, or you have some other program (File Manager?) holding one of the directories open. Be sure to shut down all but one instance of R before modifying your package library.

It is also possible that anti-virus software is being overly protective.

And DONT keep bashing on the package that depends on rlang... install the one that was at the root of the problem: rlang. Only after that succeeds should you go back and try lifecycle. Once that one works, try installing/updating readxl again.


On December 1, 2021 1:38:37 PM PST, Dennis Weygand <dpweygand at gmail.com> wrote:
>I have been using read_excel for years... suddenly today I have this
>problem:
>
>> T1 <- read_excel(fname,sheet="T1")
>Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]])
>:
>  there is no package called ?lifecycle?
>
>So I install lifecycle:
>
>install.packages("lifecycle")
>WARNING: Rtools is required to build R packages but is not currently
>installed. Please download and install the appropriate version of Rtools
>before proceeding:
>
>https://cran.rstudio.com/bin/windows/Rtools/
>Installing package into ?C:/Users/dennisweygand/Documents/R/win-library/3.5?
>(as ?lib? is unspecified)
>also installing the dependency ?rlang?
>
>
>  There are binary versions available but the source versions are later:
>          binary source needs_compilation
>rlang      0.4.5 0.4.12              TRUE
>lifecycle  0.2.0  1.0.1             FALSE
>
>  Binaries will be installed
>trying URL 'https://cran.rstudio.com/bin/windows/contrib/3.5/rlang_0.4.5.zip
>'
>Content type 'application/zip' length 1115838 bytes (1.1 MB)
>downloaded 1.1 MB
>
>package ?rlang? successfully unpacked and MD5 sums checked
>Warning in install.packages :
>  cannot remove prior installation of package ?rlang?
>
>The downloaded binary packages are in
>C:\Users\dennisweygand\AppData\Local\Temp\RtmpKSler3\downloaded_packages
>installing the source package ?lifecycle?
>
>trying URL 'https://cran.rstudio.com/src/contrib/lifecycle_1.0.1.tar.gz'
>Content type 'application/x-gzip' length 99716 bytes (97 KB)
>downloaded 97 KB
>
>ERROR: dependency 'rlang' is not available for package 'lifecycle'
>* removing 'C:/Users/dennisweygand/Documents/R/win-library/3.5/lifecycle'
>In R CMD INSTALL
>Warning in install.packages :
>  installation of package ?lifecycle? had non-zero exit status
>
>The downloaded source packages are in
>?C:\Users\dennisweygand\AppData\Local\Temp\RtmpKSler3\downloaded_packages?
>
>
>Did it work?
>Try it again:
>
>> T1 <- read_excel(fname,sheet="T1")
>Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]])
>:
>  there is no package called ?lifecycle?
>
>I am clueless: what am I doing wrong?
>Can anyone help?
>D.P. Weygand
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From kry|ov@r00t @end|ng |rom gm@||@com  Thu Dec  2 09:05:39 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Thu, 2 Dec 2021 11:05:39 +0300
Subject: [R] readxl/lifecycle/rlang
In-Reply-To: <CAJgAAVS-ZB=pDLA8gUagQr4_5q=k3sd49xuT3Q5xP7sVpRCoUQ@mail.gmail.com>
References: <CAJgAAVS-ZB=pDLA8gUagQr4_5q=k3sd49xuT3Q5xP7sVpRCoUQ@mail.gmail.com>
Message-ID: <20211202110539.692ed63d@Tarkus>

On Wed, 1 Dec 2021 16:38:37 -0500
Dennis Weygand <dpweygand at gmail.com> wrote:

> Installing package into
> ?C:/Users/dennisweygand/Documents/R/win-library/3.5? (as ?lib? is
> unspecified)

It could be time to install a newer version of R. CRAN doesn't provide
binary builds of packages for R 3.5...

>           binary source needs_compilation
> rlang      0.4.5 0.4.12              TRUE
> lifecycle  0.2.0  1.0.1             FALSE

...so the latest version of rlang you can currently install is 0.4.5,
but lifecycle wants rlang (? 0.4.10). You can either follow the link
https://cran.rstudio.com/bin/windows/Rtools/ and install Rtools to
compile rlang 0.4.12 from source, or install a later version of R (?
4.0) that CRAN provides Windows binaries for.

You could also try the XLConnect package (it works fine for me on
older installations of R), but it depends on Java. 

> 	[[alternative HTML version deleted]]

P.S. Please compose your messages in plain text to make sure that we
see them exactly as you write them.

-- 
Best regards,
Ivan


From @erv|ce @end|ng |rom @hd@w@on@com  Thu Dec  2 11:36:38 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Thu, 2 Dec 2021 05:36:38 -0500
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <CAGxFJbSx1bDcX89XJHVozLr7Lnpd=XpSYi1+zXcDEF+jq2qxvg@mail.gmail.com>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <CAGxFJbSWcEQ6+wAHMWMbAZN8+H=-MZeAck3oswYK=bTQg9YW1w@mail.gmail.com>
 <a051a615-a38a-e590-ca5d-d23f0c1e0e6c@shdawson.com>
 <CAGxFJbRDXgVq5V7FRv1i+cF_3vJpt9bhfcRiezfjTqc7-YyuAg@mail.gmail.com>
 <5c27e9c9-3f7e-2d28-bbb8-566586a59c79@shdawson.com>
 <05fe01d7e665$7afa5330$70eef990$@verizon.net>
 <368D38C8-1302-49E6-AC20-6F54A5E29225@dcn.davis.ca.us>
 <CAGxFJbSx1bDcX89XJHVozLr7Lnpd=XpSYi1+zXcDEF+jq2qxvg@mail.gmail.com>
Message-ID: <86283450-8ded-7a8e-d45c-dfe826bdc8ff@shdawson.com>

Thank you, Bert. I appreciate you taking the time to write this information.


Kindest Regards,
*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/1/21 12:23 PM, Bert Gunter wrote:
> "As to obtaining min or max of columns, such a question is nonsensical
> when the column contains character data,"
>
> That is false.
>
> First, if it's plain (unclassed) character data, character data is
> sorted lexicographically, which depends on the locale, as Petr already
> pointed out.
>
> Perhaps more useful, however, is that of the character data has been
> classed as an *ordered* factor, then max, min, and range are all
> meaningfully interpreted for it according to the ordering:
>
>> z <- ordered(sample(letters[1:3], 10,rep = TRUE), levels = c('c','a','b'))
>> z
>   [1] a a c b b c a a b c
> Levels: c < a < b
>> max(z)
> [1] b
> Levels: c < a < b
>> min(z)
> [1] c
> Levels: c < a < b
>> range(z)
> [1] c b
> Levels: c < a < b
>> sort(z)
>   [1] c c c a a a a b b b
> Levels: c < a < b
> ### etc.
>
> See ?ordered for details, and particularly note:
> "There are "factor" and "ordered" methods for the group generic Ops
> which provide methods for the Comparison operators, and for the min,
> max, and range generics in Summary of "ordered". (The rest of the
> groups and the Math group generate an error as they are not meaningful
> for factors.)"
>
> (You would have to go down a rabbit hole to learn about group generics
> for S3 classes, but I think you can ignore those details for the
> purposes here).
>
> Bert Gunter
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
>
> On Wed, Dec 1, 2021 at 8:41 AM Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
>> Avi: As I understand it, the definition regarding what is on-topic is not targeted at tidyverse... it addresses the futility of trying to support the thousands of problem domains represented by contributed packages in one mailing list without drowning the subscribers in discussions about problem domains they are not interested in. This mailing list happens to be about the R language, and extends as far as the packages included with the R language. Tidyverse just happens to be outside this scope (though some here are more opposed to using it than others and express that sentiment in their responses).
>>
>> Stephen: As to obtaining min or max of columns, such a question is nonsensical when the column contains character data, and mostly nonsensical when the data are binary regardless of what package you are using. From this perspective, it only makes sense to look at extremes on numeric columns selected from the data after they are loaded into a data frame.
>>
>>      dta <- read.csv( "yourdata.csv" )
>>      dta_num <- dta[ , c("Elapsed_Time", "Age" ) ]
>>
>> I don't know this package Rfast or its functions, but I would imagine that you could then use
>>
>>      dta_maxs <- colMaxs( as.matrix( dta_num ) )
>>
>> which might be a few microseconds faster than a typical base R solution:
>>
>>      dta_maxs <- apply( dta_num, 2, max )
>>
>> which works fine without loading a special package for this rather basic functionality.
>>
>> Sometimes packages get developed to meet unusual needs (thousands of columns) or while chasing an optimization that turns out to be marginal (the real time sink may be in converting a data frame into a matrix so the compiled C code can then process it a smidge quicker), and none of this should be interfering in your learning of R but you end up following biased blogs or package vignettes that may or may not deliver on their promise to simplify your tasks.
>>
>> Some aspects of tidyverse are quite effective and I use them regularly... but there are a lot of these less valuable contributions also that are distractions or are best for corner cases. You can only figure out the difference by learning the basics first and comparing approaches (sometimes a package that requires you to manually convert to matrix is a good idea, but sometimes it is just a pain) for usefulness and/or speed (e.g. using the microbenchmark contributed package).
>>
>> On November 30, 2021 7:42:35 PM PST, Avi Gross via R-help <r-help at r-project.org> wrote:
>>> Stephen,
>>>
>>> Although what is in the STANDARD R distribution can vary several ways, in
>>> general, if you need to add a line like:
>>>
>>> library(something)
>>> or
>>> require(something)
>>>
>>> and your code does not work unless you have done that, then you can imagine
>>> it is not sort of built in to R as it starts.
>>>
>>> Having said that, tons of exceptions may exist that cause R to load in
>>> things on your machine for everyone or just for you without you having to
>>> notice.
>>>
>>> I think this forum lately has been deluged with questions about all kinds of
>>> add-on packages and in particular, lots of the ones in the tidyverse.
>>> Clearly the purpose here is not that broad.
>>>
>>> But since I use some packages like the tidyverse extensively, and I am far
>> >from alone, I wonder if someday the powers that be realize it is a losing
>>> battle to exclude at least some of it. It would be so nice not having to
>>> include a long list of packages for some programs or somehow arrange that
>>> people using something you shared had installed and loaded them. But there
>>> are too many packages out there of varying quality and usefulness and
>>> popularity with more every day being added. Worse, many are somewhat
>>> incompatible such as having functions with the same names that hide earlier
>>> ones loaded.
>>>
>>> Base R doe come with functions like colSums and colMeans and similar row
>>> functions. But as mentioned, a data.frame is a list of vectors and R
>>> supports certain functional programming constructs over lists using things
>>> like:
>>>
>>> lapply(df, min)
>>> sapply(df, min)
>>>
>>> And actually quite a few ways depending on what info you want back and
>>> whether you insist it be returned as a list or vector or other things . You
>>> can even supply additional arguments that might be needed such as if you
>>> want to ignore any NA values,
>>>
>>> lapply(df, min, na.rm=TRUE
>>>
>>> The package you looked at it is trying to be fast and uses what looks like
>>> compiled external code but so does lapply.
>>>
>>> If this is too bothersome for you, consider making a one-liner function like
>>> this:
>>>
>>> mycolMins <- function(df, ...) lapply(df, min, ...)
>>>
>>> Once defined, you can use that just fine and not think about it again and I
>>> note this answer (like others) is offering you something in base R that
>>> works fine on data.frames and the like.
>>>
>>> You can extend to many similar ideas like this one that calulates the min
>>> unless you over-ride it with max or mean or sd or a bizarre function like
>>> `[` so a call to:
>>>
>>> mycolCalc(df, `[`, 3)
>>>
>>> Will return exactly the third items in each row!
>>>
>>> I find it to be very common for someone these days to do a quick search for
>>> a way to do something in a language like R and not really look to see if it
>>> is a standard way or something special/ Matrices in R are not quite the same
>>> as some other objects like a data.frame or tibble and a package written to
>>> be used on one may (or may not) happen to work with another. Some packages
>>> are carefully written to try to detect what kind of object it gets and when
>>> possible convert it to another. The "apply" function is meant for matrices
>>> but if it sees something else it looks ta the dimensionality and tries to
>>> coerce it with as.matrix or as.array first. As others have noted, this mean
>>> a data.frame containing non-numeric parts may fail or should have any other
>>> columns hidden/removed as in this df that has some non-numeric fields:
>>>
>>>> df
>>> i       s   f     b i2
>>> 1 1   hello 1.2  TRUE  5
>>> 2 2   there 2.3 FALSE  4
>>> 3 3 goodbye 3.4  TRUE  3
>>>
>>> So a bit more complex one-liner removes any non-numeric columns like this:
>>>
>>>> mycolMins(df[, sapply(df, is.numeric)])
>>> $i
>>> [1] 1
>>>
>>> $f
>>> [1] 1.2
>>>
>>> $i2
>>> [1] 3
>>>
>>> Clearly converting that to a matrix while whole would result in everything
>>> being converted to character and a minimum may be elusive.
>>>
>>> -----Original Message-----
>>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
>>> DSL via R-help
>>> Sent: Tuesday, November 30, 2021 5:37 PM
>>> To: Bert Gunter <bgunter.4567 at gmail.com>
>>> Cc: r-help at r-project.org
>>> Subject: Re: [R] Question about Rfast colMins and colMaxs
>>>
>>> Oh, you are segmenting standard R from the rest of R.
>>>
>>> Well, that part did not come across to me in your original reply. I am not
>>> clear on a standard versus non-standard list. I will look into this aspect
>>> and see what I can learn going forward.
>>>
>>>
>>> Thanks,
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 11/30/21 5:26 PM, Bert Gunter wrote:
>>>> ... but Rfast is *not* a "standard" package, as the rest of the PG
>>>> excerpt says. So contact the maintainer and ask him/her what they
>>>> think the best practice should be for their package. As has been
>>>> pointed out already, it appears to differ from the usual "read it in
>>>> as a data frame" procedure.
>>>>
>>>> Bert
>>>>
>>>> On Tue, Nov 30, 2021 at 2:11 PM Stephen H. Dawson, DSL
>>>> <service at shdawson.com> wrote:
>>>>> Right, R Studio is not R.
>>>>>
>>>>> However, the Rfast package is part of R.
>>>>>
>>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>>
>>>>> So, rephrasing my question...
>>>>> What is the best practice to bring a csv file into R so it can be
>>>>> accessed by colMaxs and colMins, please?
>>>>>
>>>>> *Stephen Dawson, DSL*
>>>>> /Executive Strategy Consultant/
>>>>> Business & Technology
>>>>> +1 (865) 804-3454
>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>
>>>>>
>>>>> On 11/30/21 3:19 PM, Bert Gunter wrote:
>>>>>> RStudio is **not** R. In particular, the so-called TidyVerse
>>>>>> consists of all *non*-standard contributed packages, about which the PG
>>> says:
>>>>>> "For questions about functions in standard packages distributed with
>>>>>> R (see the FAQ Add-on packages in R), ask questions on R-help.
>>>>>> [The link is:
>>>>>> https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
>>>>>> This gives the list of current _standard_ packages]
>>>>>>
>>>>>> If the question relates to a contributed package , e.g., one
>>>>>> downloaded from CRAN, try contacting the package maintainer first.
>>>>>> You can also use find("functionname") and
>>>>>> packageDescription("packagename") to find this information. Only
>>>>>> send such questions to R-help or R-devel if you get no reply or need
>>>>>> further assistance. This applies to both requests for help and to
>>>>>> bug reports."
>>>>>>
>>>>>> Note that RStudio maintains its own help resources at:
>>>>>> https://community.rstudio.com/
>>>>>> This is where questions about the TidyVerse, ggplot, etc. should be
>>> posted.
>>>>>>
>>>>>>
>>>>>> Bert Gunter
>>>>>>
>>>>>> "The trouble with having an open mind is that people keep coming
>>>>>> along and sticking things into it."
>>>>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>>>>>
>>>>>> On Tue, Nov 30, 2021 at 10:55 AM Stephen H. Dawson, DSL via R-help
>>>>>> <r-help at r-project.org> wrote:
>>>>>>> Hi,
>>>>>>>
>>>>>>>
>>>>>>> I am working to understand the Rfast functions of colMins and
>>>>>>> colMaxs. I worked through the example listed on page 54 of the PDF.
>>>>>>>
>>>>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>>>>
>>>>>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>>>>>>>
>>>>>>> My data is in a CSV file. So, I bring it into R Studio using:
>>>>>>> Data <- read.csv("./input/DataSet05.csv", header=T)
>>>>>>>
>>>>>>> However, I read the instructions listed on page 54 of the PDF
>>>>>>> saying I need to bring data into R using a matrix. I think read.csv
>>>>>>> brings the data in as a dataframe. I think colMins is failing
>>>>>>> because it is looking for a matrix but finds a dataframe.
>>>>>>>
>>>>>>>     > colMaxs(Data)
>>>>>>> Error in colMaxs(Data) :
>>>>>>>       Not compatible with requested type: [type=list; target=double].
>>>>>>>     > colMins(Data, na.rm = TRUE)
>>>>>>> Error in colMins(Data, na.rm = TRUE) :
>>>>>>>       unused argument (na.rm = TRUE)
>>>>>>>     > colMins(Data, value = FALSE, parallel = FALSE) Error in
>>>>>>> colMins(Data, value = FALSE, parallel = FALSE) :
>>>>>>>       Not compatible with requested type: [type=list; target=double].
>>>>>>>
>>>>>>> QUESTION
>>>>>>> What is the best practice to bring a csv file into R Studio so it
>>>>>>> can be accessed by colMaxs and colMins, please?
>>>>>>>
>>>>>>>
>>>>>>> Thanks,
>>>>>>> --
>>>>>>> *Stephen Dawson, DSL*
>>>>>>> /Executive Strategy Consultant/
>>>>>>> Business & Technology
>>>>>>> +1 (865) 804-3454
>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>> PLEASE do read the posting guide
>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>> --
>> Sent from my phone. Please excuse my brevity.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From tr@xp|@yer @end|ng |rom gm@||@com  Thu Dec  2 12:23:27 2021
From: tr@xp|@yer @end|ng |rom gm@||@com (=?UTF-8?Q?Martin_M=C3=B8ller_Skarbiniks_Pedersen?=)
Date: Thu, 2 Dec 2021 12:23:27 +0100
Subject: [R] Fwd: alternative way to define a function
In-Reply-To: <CAGAA5be=J=vjbwwqkndALdstoLF2AE_mHtvyEoreymMhcWVSSg@mail.gmail.com>
References: <CAGAA5be=J=vjbwwqkndALdstoLF2AE_mHtvyEoreymMhcWVSSg@mail.gmail.com>
Message-ID: <CAGAA5bfbwH5wBbWF1Ds6+ZTV_eS_NLXDx7tS7sVA3dACGwHxKA@mail.gmail.com>

By reading some code today I have just discovered an alternative way to
define a function:
f <- \(x, y) x * y

Is that exactly the same as:
f <- function(x,y) x * y
?

Is there any benefit to the first or second way to define a function?

Regards
Martin

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Thu Dec  2 12:40:31 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Thu, 2 Dec 2021 14:40:31 +0300
Subject: [R] Fwd: alternative way to define a function
In-Reply-To: <CAGAA5bfbwH5wBbWF1Ds6+ZTV_eS_NLXDx7tS7sVA3dACGwHxKA@mail.gmail.com>
References: <CAGAA5be=J=vjbwwqkndALdstoLF2AE_mHtvyEoreymMhcWVSSg@mail.gmail.com>
 <CAGAA5bfbwH5wBbWF1Ds6+ZTV_eS_NLXDx7tS7sVA3dACGwHxKA@mail.gmail.com>
Message-ID: <20211202144031.4587b9ae@arachnoid>

On Thu, 2 Dec 2021 12:23:27 +0100
Martin M?ller Skarbiniks Pedersen <traxplayer at gmail.com> wrote:

> Is that exactly the same as:
> f <- function(x,y) x * y
> ?
> 
> Is there any benefit to the first or second way to define a function?

The \(arguments) syntax has been introduced in R 4.1.0:
https://cran.r-project.org/doc/manuals/r-release/NEWS.html (search for
"\(x)"). It is the same as function(arguments).

The only benefit is slightly less typing; could be useful if you use
the native R pipe (also introduced in R 4.1.0, search for "|>") and
want to call an anonymous function in the right-hand side of the pipe.

-- 
Best regards,
Ivan


From tr@xp|@yer @end|ng |rom gm@||@com  Thu Dec  2 13:18:00 2021
From: tr@xp|@yer @end|ng |rom gm@||@com (=?UTF-8?Q?Martin_M=C3=B8ller_Skarbiniks_Pedersen?=)
Date: Thu, 2 Dec 2021 13:18:00 +0100
Subject: [R] Fwd: alternative way to define a function
In-Reply-To: <20211202144031.4587b9ae@arachnoid>
References: <CAGAA5be=J=vjbwwqkndALdstoLF2AE_mHtvyEoreymMhcWVSSg@mail.gmail.com>
 <CAGAA5bfbwH5wBbWF1Ds6+ZTV_eS_NLXDx7tS7sVA3dACGwHxKA@mail.gmail.com>
 <20211202144031.4587b9ae@arachnoid>
Message-ID: <CAGAA5bfrPha_=gHZfNpJeXn1KWKdJ2n0S6y9NZWODcw9_57Gpg@mail.gmail.com>

On Thu, 2 Dec 2021 at 12:40, Ivan Krylov <krylov.r00t at gmail.com> wrote:
>
>
> The \(arguments) syntax has been introduced in R 4.1.0:
> https://cran.r-project.org/doc/manuals/r-release/NEWS.html (search for
> "\(x)"). It is the same as function(arguments).
>
> The only benefit is slightly less typing; could be useful if you use
> the native R pipe (also introduced in R 4.1.0, search for "|>") and
> want to call an anonymous function in the right-hand side of the pipe.

Thanks. It is a nice new feature.
I will start using it in my apply fun's eg: apply(mtcars, 2, \(x)
length(unique(x)))

Regards
Martin

	[[alternative HTML version deleted]]


From |@bone @end|ng |rom em@||@@c@edu  Thu Dec  2 11:50:13 2021
From: |@bone @end|ng |rom em@||@@c@edu (Labone, Thomas)
Date: Thu, 2 Dec 2021 10:50:13 +0000
Subject: [R] Problem with lm Giving Wrong Results
Message-ID: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>

In the code below the first and second plots should look pretty much the same, the only difference being that the first has n=1000 points and the second n=10000 points. On two of my Linux machines (info below) the second plot is a horizontal line (incorrect answer from lm), but on my Windows 10 machine and a third Linux machine it works as expected. The interesting thing is that the code works as expected for n <= 4095 but fails for n>=4096 (which equals 2^12). Can anyone else reproduce this problem? Any ideas on how to fix it?

set.seed(132)

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# This works
n <- 1000# OK <= 4095
Z <- qnorm(ppoints(n))

k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))

quantile(k,probs=c(0.025,0.5,0.975))
summary(k)

fit <- lm(log(k) ~ Z)
summary(fit)

gm <- exp(coef(fit)[1])
gsd <- exp(coef(fit)[2])
gm
gsd

plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
lines(Z,gm*gsd^Z,col="red")

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#this does not
n <- 10000# fails >= 4096 = 2^12
Z <- qnorm(ppoints(n))

k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))

quantile(k,probs=c(0.025,0.5,0.975))
summary(k)

fit <- lm(log(k) ~ Z)
summary(fit)

gm <- exp(coef(fit)[1])
gsd <- exp(coef(fit)[2])
gm
gsd

plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
lines(Z,gm*gsd^Z,col="red")


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> sessionInfo() #for two Linux machines having problem
R version 4.1.2 (2021-11-01)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 20.2

Matrix products: default
BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
 [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.1.2  Matrix_1.3-4    tools_4.1.2     expm_0.999-6    grid_4.1.2      lattice_0.20-45

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> sessionInfo() # for a third Linux machine not having the problem
R version 4.1.1 (2021-08-10)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 19.3

Matrix products: default
BLAS/LAPACK: /opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
 [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.1.1 tools_4.1.1



Thomas R. LaBone
PhD student
Department of Epidemiology and Biostatistics
Arnold School of Public Health
University of South Carolina
Columbia, South Carolina USA


	[[alternative HTML version deleted]]


From M|ke@Fr@nc|@ @end|ng |rom cy|oethn@tur|o|cymru@gov@uk  Thu Dec  2 14:42:04 2021
From: M|ke@Fr@nc|@ @end|ng |rom cy|oethn@tur|o|cymru@gov@uk (Francis, Mike)
Date: Thu, 2 Dec 2021 13:42:04 +0000
Subject: [R] R 64 bit v 4.1.2
Message-ID: <AM6PR06MB466329EB7664394DF85E7BF0D0699@AM6PR06MB4663.eurprd06.prod.outlook.com>

Good afternoon,

Im hoping someone would be kind enough to help me with this issue.

currently using Windows 10 (OS BUILD 19042.1348). when I try to open R as standalone or from R studio the R application crashes. did some investigations and it appears the RGUI.EXE and MSVCRT.dll are causing the problem.
has anyone seen this issue before and how was it resolved.

see the info from the RGUI dump file.

This dump file has an exception of interest stored in it.
The stored exception information can be accessed via .ecxr.
(adc.1bc4): Security check failure or stack buffer overrun - code c0000409 (first/second chance not available)
Subcode: 0xd FAST_FAIL_INVALID_SET_OF_CONTEXT 
For analysis of this file, run !analyze -v
msvcrt!_except_validate_jump_buffer+0x3c:
00007ffd`30310a70 cd29            int     29h
0:000> !analyze -v
*******************************************************************************
*                                                                             *
*                        Exception Analysis                                   *
*                                                                             *
*******************************************************************************

*** WARNING: Unable to verify timestamp for R.dll

KEY_VALUES_STRING: 1

    Key  : Analysis.CPU.mSec
    Value: 2358

    Key  : Analysis.DebugAnalysisManager
    Value: Create

    Key  : Analysis.Elapsed.mSec
    Value: 3790

    Key  : Analysis.Init.CPU.mSec
    Value: 1234

    Key  : Analysis.Init.Elapsed.mSec
    Value: 26592

    Key  : Analysis.Memory.CommitPeak.Mb
    Value: 90

    Key  : FailFast.Name
    Value: INVALID_SET_OF_CONTEXT

    Key  : FailFast.Type
    Value: 13

    Key  : Timeline.Process.Start.DeltaSec
    Value: 1

    Key  : WER.OS.Branch
    Value: vb_release

    Key  : WER.OS.Timestamp
    Value: 2019-12-06T14:06:00Z

    Key  : WER.OS.Version
    Value: 10.0.19041.1

    Key  : WER.Process.Version
    Value: 4.12.15579.0


NTGLOBALFLAG:  0

PROCESS_BAM_CURRENT_THROTTLED: 0

PROCESS_BAM_PREVIOUS_THROTTLED: 0

APPLICATION_VERIFIER_FLAGS:  0

CONTEXT:  (.ecxr)
rax=000000874937a000 rbx=000000000000000c rcx=000000000000000d
rdx=000000874d3f4690 rsi=000000006e655e60 rdi=000000874d3f4690
rip=00007ffd30310a70 rsp=000000874d3f3108 rbp=000000000000000c
 r8=000000874d3f4540  r9=0000000000000000 r10=000000000000001d
r11=0000000000000000 r12=0000019eb7d98db0 r13=0000000000000001
r14=0000019eb7dbf6e0 r15=0000000000000000
iopl=0         nv up ei pl zr na po nc
cs=0033  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00000246
msvcrt!_except_validate_jump_buffer+0x3c:
00007ffd`30310a70 cd29            int     29h
Resetting default scope

EXCEPTION_RECORD:  (.exr -1)
ExceptionAddress: 00007ffd30310a70 (msvcrt!_except_validate_jump_buffer+0x000000000000003c)
   ExceptionCode: c0000409 (Security check failure or stack buffer overrun)
  ExceptionFlags: 00000001
NumberParameters: 1
   Parameter[0]: 000000000000000d
Subcode: 0xd FAST_FAIL_INVALID_SET_OF_CONTEXT 

PROCESS_NAME:  Rgui.exe

ERROR_CODE: (NTSTATUS) 0xc0000409 - The system detected an overrun of a stack-based buffer in this application. This overrun could potentially allow a malicious user to gain control of this application.

EXCEPTION_CODE_STR:  c0000409

EXCEPTION_PARAMETER1:  000000000000000d

STACK_TEXT:  
00000087`4d3f3108 00007ffd`3030f854     : 00000000`0000000c 0000019e`b7d98db0 00000000`00000001 0000019e`b7dbf6e0 : msvcrt!_except_validate_jump_buffer+0x3c
00000087`4d3f3110 00000000`6c794fdf     : 00000087`4d3f4680 00000000`6c83c758 0000019e`b7f4ba38 00000000`6e655bb0 : msvcrt!longjmp+0x14
00000087`4d3f3140 00000087`4d3f4680     : 00000000`6c83c758 0000019e`b7f4ba38 00000000`6e655bb0 0000019e`b7f4bae0 : R+0x94fdf
00000087`4d3f3148 00000000`6c83c758     : 0000019e`b7f4ba38 00000000`6e655bb0 0000019e`b7f4bae0 00000000`6e655d98 : 0x00000087`4d3f4680
00000087`4d3f3150 0000019e`b7f4ba38     : 00000000`6e655bb0 0000019e`b7f4bae0 00000000`6e655d98 0000019e`b7f4bbc0 : R+0x13c758
00000087`4d3f3158 00000000`6e655bb0     : 0000019e`b7f4bae0 00000000`6e655d98 0000019e`b7f4bbc0 00000000`6cacdc24 : 0x0000019e`b7f4ba38
00000087`4d3f3160 0000019e`b7f4bae0     : 00000000`6e655d98 0000019e`b7f4bbc0 00000000`6cacdc24 0000019e`b7f46840 : R+0x1f55bb0
00000087`4d3f3168 00000000`6e655d98     : 0000019e`b7f4bbc0 00000000`6cacdc24 0000019e`b7f46840 0000019e`b7f4ba38 : 0x0000019e`b7f4bae0
00000087`4d3f3170 0000019e`b7f4bbc0     : 00000000`6cacdc24 0000019e`b7f46840 0000019e`b7f4ba38 00000000`6e655bb0 : R+0x1f55d98
00000087`4d3f3178 00000000`6cacdc24     : 0000019e`b7f46840 0000019e`b7f4ba38 00000000`6e655bb0 00000000`6c79540f : 0x0000019e`b7f4bbc0
00000087`4d3f3180 0000019e`b7f46840     : 0000019e`b7f4ba38 00000000`6e655bb0 00000000`6c79540f 0000019e`b7f46840 : R+0x3cdc24
00000087`4d3f3188 0000019e`b7f4ba38     : 00000000`6e655bb0 00000000`6c79540f 0000019e`b7f46840 0000019e`b7f4ba38 : 0x0000019e`b7f46840
00000087`4d3f3190 00000000`6e655bb0     : 00000000`6c79540f 0000019e`b7f46840 0000019e`b7f4ba38 00000000`6e655bb0 : 0x0000019e`b7f4ba38
00000087`4d3f3198 00000000`6c79540f     : 0000019e`b7f46840 0000019e`b7f4ba38 00000000`6e655bb0 0000019e`b7dbf6e0 : R+0x1f55bb0
00000087`4d3f31a0 0000019e`b7f46840     : 0000019e`b7f4ba38 00000000`6e655bb0 0000019e`b7dbf6e0 00000000`00000000 : R+0x9540f
00000087`4d3f31a8 0000019e`b7f4ba38     : 00000000`6e655bb0 0000019e`b7dbf6e0 00000000`00000000 00000000`6c83d149 : 0x0000019e`b7f46840
00000087`4d3f31b0 00000000`6e655bb0     : 0000019e`b7dbf6e0 00000000`00000000 00000000`6c83d149 0000019e`b7e182a8 : 0x0000019e`b7f4ba38
00000087`4d3f31b8 0000019e`b7dbf6e0     : 00000000`00000000 00000000`6c83d149 0000019e`b7e182a8 0000019e`b7f4bcc0 : R+0x1f55bb0
00000087`4d3f31c0 00000000`00000000     : 00000000`6c83d149 0000019e`b7e182a8 0000019e`b7f4bcc0 0000019e`b7f4ed08 : 0x0000019e`b7dbf6e0


SYMBOL_NAME:  msvcrt!_except_validate_jump_buffer+3c

MODULE_NAME: msvcrt

IMAGE_NAME:  msvcrt.dll

STACK_COMMAND:  ~0s ; .ecxr ; kb

FAILURE_BUCKET_ID:  FAIL_FAST_INVALID_SET_OF_CONTEXT_c0000409_msvcrt.dll!_except_validate_jump_buffer

OS_VERSION:  10.0.19041.1

BUILDLAB_STR:  vb_release

OSPLATFORM_TYPE:  x64

OSNAME:  Windows 10

IMAGE_VERSION:  7.0.19041.546

FAILURE_ID_HASH:  {3e222f7c-7009-e3ad-3df7-4c44c21d59ab}

Followup:     MachineOwner
---------


Regards
Mike Francis
Peirianydd SCCM / SCCM Engineer
Cyfoeth Naturiol Cymru / Natural Resources Wales
Ffon / Mobile: 07876847084
E-Bost / Email: mike.francis at cyfoethnaturiolcymru.gov.uk
www.cyfoethnaturiol.cymru?/?www.naturalresources.wales?
?
Yn falch o arwain y ffordd at ddyfodol gwell i Gymru trwy reoli'r amgylchedd ac adnoddau naturiol yn gynaliadwy.
Proud to be leading the way to a better future for Wales by managing the environment and natural resources sustainably.
?
????
?
?


From er|cjberger @end|ng |rom gm@||@com  Thu Dec  2 15:28:11 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Thu, 2 Dec 2021 16:28:11 +0200
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
Message-ID: <CAGgJW75+PsEgreXaa1gAF9+5VL3FsBJ56hTAd5safkZ_gJWqUA@mail.gmail.com>

Hi Thomas,
I could not reproduce your problem. Both examples worked fine for me.

Here is my setup:

R version 4.1.2 (2021-11-01)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
LC_TIME=en_US.UTF-8
 [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
LC_ADDRESS=C
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8
LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] R.matlab_3.6.2

loaded via a namespace (and not attached):
[1] compiler_4.1.2    tools_4.1.2       R.methodsS3_1.8.1
R.utils_2.11.0    R.oo_1.24.0


On Thu, Dec 2, 2021 at 4:18 PM Labone, Thomas <labone at email.sc.edu> wrote:
>
> In the code below the first and second plots should look pretty much the same, the only difference being that the first has n=1000 points and the second n=10000 points. On two of my Linux machines (info below) the second plot is a horizontal line (incorrect answer from lm), but on my Windows 10 machine and a third Linux machine it works as expected. The interesting thing is that the code works as expected for n <= 4095 but fails for n>=4096 (which equals 2^12). Can anyone else reproduce this problem? Any ideas on how to fix it?
>
> set.seed(132)
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> # This works
> n <- 1000# OK <= 4095
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #this does not
> n <- 10000# fails >= 4096 = 2^12
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > sessionInfo() #for two Linux machines having problem
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 20.2
>
> Matrix products: default
> BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2  Matrix_1.3-4    tools_4.1.2     expm_0.999-6    grid_4.1.2      lattice_0.20-45
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > sessionInfo() # for a third Linux machine not having the problem
> R version 4.1.1 (2021-08-10)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 19.3
>
> Matrix products: default
> BLAS/LAPACK: /opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
>  [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.1 tools_4.1.1
>
>
>
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From pro|jcn@@h @end|ng |rom gm@||@com  Thu Dec  2 15:31:17 2021
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Thu, 2 Dec 2021 09:31:17 -0500
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
Message-ID: <be98af34-518a-7bb8-91fe-2a8fcf22a49d@gmail.com>

I get two similar graphs.

https://web.ncf.ca/nashjc/jfiles/Rplot-Labone-4095.pdf
https://web.ncf.ca/nashjc/jfiles/RplotLabone10K.pdf

Context:

R version 4.1.2 (2021-11-01)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 20.2

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3

locale:
  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C               LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8
  [5] LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_CA.UTF-8    LC_PAPER=en_CA.UTF-8       LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
  [1] compiler_4.1.2  fastmap_1.1.0   htmltools_0.5.2 tools_4.1.2     yaml_2.2.1      rmarkdown_2.11  knitr_1.36
  [8] xfun_0.28       digest_0.6.28   rlang_0.4.12    evaluate_0.14
 >

Hope this helps,

JN


On 2021-12-02 5:50 a.m., Labone, Thomas wrote:
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> # This works
> n <- 1000# OK <= 4095
> Z <- qnorm(ppoints(n))
> 
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
> 
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
> 
> fit <- lm(log(k) ~ Z)
> summary(fit)
> 
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
> 
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #this does not
> n <- 10000# fails >= 4096 = 2^12
> Z <- qnorm(ppoints(n))
> 
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
> 
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
> 
> fit <- lm(log(k) ~ Z)
> summary(fit)
> 
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
> 
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
> 
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


From |@bone @end|ng |rom em@||@@c@edu  Thu Dec  2 15:34:42 2021
From: |@bone @end|ng |rom em@||@@c@edu (Labone, Thomas)
Date: Thu, 2 Dec 2021 14:34:42 +0000
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <be98af34-518a-7bb8-91fe-2a8fcf22a49d@gmail.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
 <be98af34-518a-7bb8-91fe-2a8fcf22a49d@gmail.com>
Message-ID: <BN8PR19MB281713828C1958EFDD972659F9699@BN8PR19MB2817.namprd19.prod.outlook.com>

Thanks.

Can someone point me to the procedure for switching from the Intel Math Library back to the standard math library so that I can see if the problem is associated with using MKL?


Thomas R. LaBone
PhD student
Department of Epidemiology and Biostatistics
Arnold School of Public Health
University of South Carolina
Columbia, South Carolina USA


________________________________
From: J C Nash <profjcnash at gmail.com>
Sent: Thursday, December 2, 2021 9:31 AM
To: Labone, Thomas <labone at email.sc.edu>; r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] Problem with lm Giving Wrong Results

I get two similar graphs.

https://protect2.fireeye.com/v1/url?k=99a20372-c6393a53-99a24db3-862c53b6784d-c549bca0bcc4210d&q=1&e=8ce563a7-fac1-41d3-8699-13c4a9417e00&u=https%3A%2F%2Fweb.ncf.ca%2Fnashjc%2Fjfiles%2FRplot-Labone-4095.pdf
https://protect2.fireeye.com/v1/url?k=6d56bd36-32cd8417-6d56f3f7-862c53b6784d-85baef704a412b23&q=1&e=8ce563a7-fac1-41d3-8699-13c4a9417e00&u=https%3A%2F%2Fweb.ncf.ca%2Fnashjc%2Fjfiles%2FRplotLabone10K.pdf

Context:

R version 4.1.2 (2021-11-01)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 20.2

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3

locale:
  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C               LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8
  [5] LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_CA.UTF-8    LC_PAPER=en_CA.UTF-8       LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
  [1] compiler_4.1.2  fastmap_1.1.0   htmltools_0.5.2 tools_4.1.2     yaml_2.2.1      rmarkdown_2.11  knitr_1.36
  [8] xfun_0.28       digest_0.6.28   rlang_0.4.12    evaluate_0.14
 >

Hope this helps,

JN


On 2021-12-02 5:50 a.m., Labone, Thomas wrote:
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> # This works
> n <- 1000# OK <= 4095
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #this does not
> n <- 10000# fails >= 4096 = 2^12
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Thu Dec  2 16:17:51 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Thu, 2 Dec 2021 18:17:51 +0300
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <BN8PR19MB281713828C1958EFDD972659F9699@BN8PR19MB2817.namprd19.prod.outlook.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
 <be98af34-518a-7bb8-91fe-2a8fcf22a49d@gmail.com>
 <BN8PR19MB281713828C1958EFDD972659F9699@BN8PR19MB2817.namprd19.prod.outlook.com>
Message-ID: <20211202181751.58eda4b7@Tarkus>

On Thu, 2 Dec 2021 14:34:42 +0000
"Labone, Thomas" <labone at email.sc.edu> wrote:

> Can someone point me to the procedure for switching from the Intel
> Math Library back to the standard math library so that I can see if
> the problem is associated with using MKL?

Depends on how you have installed it. You mentioned using Linux Mint
(see also: the R-SIG-Debian mailing list), so try using
`update-alternatives` to set the value for all alternatives with "blas"
or "lapack" in their names. See `ls /etc/alternatives/ | grep -i -e blas
-e lapack` for the list.

-- 
Best regards,
Ivan


From w||||@mwdun|@p @end|ng |rom gm@||@com  Thu Dec  2 16:31:30 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Thu, 2 Dec 2021 07:31:30 -0800
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
Message-ID: <CAHqSRuSn05tHOjdDAL6gSXZbaV80YA5WvAzsKfPdR8i3tAw-VA@mail.gmail.com>

On the 'bad' machines, what did you get for
   summary(fit)
   summary(k)
   summary(Z)
   summary(gm*gsd^Z)
?

-Bill

On Thu, Dec 2, 2021 at 6:18 AM Labone, Thomas <labone at email.sc.edu> wrote:

> In the code below the first and second plots should look pretty much the
> same, the only difference being that the first has n=1000 points and the
> second n=10000 points. On two of my Linux machines (info below) the second
> plot is a horizontal line (incorrect answer from lm), but on my Windows 10
> machine and a third Linux machine it works as expected. The interesting
> thing is that the code works as expected for n <= 4095 but fails for
> n>=4096 (which equals 2^12). Can anyone else reproduce this problem? Any
> ideas on how to fix it?
>
> set.seed(132)
>
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> # This works
> n <- 1000# OK <= 4095
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #this does not
> n <- 10000# fails >= 4096 = 2^12
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
>
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > sessionInfo() #for two Linux machines having problem
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 20.2
>
> Matrix products: default
> BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>  LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>  LC_MONETARY=en_US.UTF-8
>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C
>             LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2  Matrix_1.3-4    tools_4.1.2     expm_0.999-6
> grid_4.1.2      lattice_0.20-45
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > sessionInfo() # for a third Linux machine not having the problem
> R version 4.1.1 (2021-08-10)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 19.3
>
> Matrix products: default
> BLAS/LAPACK:
> /opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>  LC_TIME=en_US.UTF-8
>  [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
> LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8
> LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.1 tools_4.1.1
>
>
>
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Dec  2 17:48:36 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 2 Dec 2021 11:48:36 -0500
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
Message-ID: <3ba31d6f-2eb0-b2e0-8cdb-b6266f8564a6@gmail.com>

On 02/12/2021 5:50 a.m., Labone, Thomas wrote:
> In the code below the first and second plots should look pretty much the same, the only difference being that the first has n=1000 points and the second n=10000 points. On two of my Linux machines (info below) the second plot is a horizontal line (incorrect answer from lm), but on my Windows 10 machine and a third Linux machine it works as expected. The interesting thing is that the code works as expected for n <= 4095 but fails for n>=4096 (which equals 2^12). Can anyone else reproduce this problem? Any ideas on how to fix it?

The likely location of this problem is the BLAS.  You are using

BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so

on the bad machines, and

BLAS/LAPACK: 
/opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so
 >

on the good one, according to the sessionInfo you posted. I don't have 
any experience dealing with such things, but that's where I'd look for a 
fix.

Duncan Murdoch



> set.seed(132)
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> # This works
> n <- 1000# OK <= 4095
> Z <- qnorm(ppoints(n))
> 
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
> 
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
> 
> fit <- lm(log(k) ~ Z)
> summary(fit)
> 
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
> 
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #this does not
> n <- 10000# fails >= 4096 = 2^12
> Z <- qnorm(ppoints(n))
> 
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
> 
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
> 
> fit <- lm(log(k) ~ Z)
> summary(fit)
> 
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
> 
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
> 
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
>> sessionInfo() #for two Linux machines having problem
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 20.2
> 
> Matrix products: default
> BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so
> 
> locale:
>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
>   [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2  Matrix_1.3-4    tools_4.1.2     expm_0.999-6    grid_4.1.2      lattice_0.20-45
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
>> sessionInfo() # for a third Linux machine not having the problem
> R version 4.1.1 (2021-08-10)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 19.3
> 
> Matrix products: default
> BLAS/LAPACK: /opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so
> 
> locale:
>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
>   [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> loaded via a namespace (and not attached):
> [1] compiler_4.1.1 tools_4.1.1
> 
> 
> 
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From |@bone @end|ng |rom em@||@@c@edu  Thu Dec  2 17:53:22 2021
From: |@bone @end|ng |rom em@||@@c@edu (Labone, Thomas)
Date: Thu, 2 Dec 2021 16:53:22 +0000
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <CAHqSRuSn05tHOjdDAL6gSXZbaV80YA5WvAzsKfPdR8i3tAw-VA@mail.gmail.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
 <CAHqSRuSn05tHOjdDAL6gSXZbaV80YA5WvAzsKfPdR8i3tAw-VA@mail.gmail.com>
Message-ID: <BN8PR19MB2817E1E5AF9FE6ED8CFF8C82F9699@BN8PR19MB2817.namprd19.prod.outlook.com>

> summary(fit)

Call:
lm(formula = log(k) ~ Z)

Residuals:
    Min      1Q  Median      3Q     Max
-21.241   1.327   1.776   2.245   4.418

Coefficients:
            Estimate Std. Error t value Pr(>|t|)
(Intercept) -0.03465    0.01916  -1.809   0.0705 .
Z           -0.24207    0.01916 -12.634   <2e-16 ***
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1

Residual standard error: 1.914 on 9998 degrees of freedom
Multiple R-squared:  0.01467, Adjusted R-squared:  0.01457
F-statistic: 148.8 on 1 and 9998 DF,  p-value: < 2.2e-16

> summary(k)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
 0.2735  3.7658  5.9052  7.5113  9.4399 82.9531
> summary(Z)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
-3.8906 -0.6744  0.0000  0.0000  0.6744  3.8906
> summary(gm*gsd^Z)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
 0.3767  0.8204  0.9659  0.9947  1.1372  2.4772
>


Thomas R. LaBone
PhD student
Department of Epidemiology and Biostatistics
Arnold School of Public Health
University of South Carolina
Columbia, South Carolina USA


________________________________
From: Bill Dunlap <williamwdunlap at gmail.com>
Sent: Thursday, December 2, 2021 10:31 AM
To: Labone, Thomas <labone at email.sc.edu>
Cc: r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] Problem with lm Giving Wrong Results

On the 'bad' machines, what did you get for
   summary(fit)
   summary(k)
   summary(Z)
   summary(gm*gsd^Z)
?

-Bill

On Thu, Dec 2, 2021 at 6:18 AM Labone, Thomas <labone at email.sc.edu<mailto:labone at email.sc.edu>> wrote:
In the code below the first and second plots should look pretty much the same, the only difference being that the first has n=1000 points and the second n=10000 points. On two of my Linux machines (info below) the second plot is a horizontal line (incorrect answer from lm), but on my Windows 10 machine and a third Linux machine it works as expected. The interesting thing is that the code works as expected for n <= 4095 but fails for n>=4096 (which equals 2^12). Can anyone else reproduce this problem? Any ideas on how to fix it?

set.seed(132)

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# This works
n <- 1000# OK <= 4095
Z <- qnorm(ppoints(n))

k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))

quantile(k,probs=c(0.025,0.5,0.975))
summary(k)

fit <- lm(log(k) ~ Z)
summary(fit)

gm <- exp(coef(fit)[1])
gsd <- exp(coef(fit)[2])
gm
gsd

plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
lines(Z,gm*gsd^Z,col="red")

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#this does not
n <- 10000# fails >= 4096 = 2^12
Z <- qnorm(ppoints(n))

k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))

quantile(k,probs=c(0.025,0.5,0.975))
summary(k)

fit <- lm(log(k) ~ Z)
summary(fit)

gm <- exp(coef(fit)[1])
gsd <- exp(coef(fit)[2])
gm
gsd

plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
lines(Z,gm*gsd^Z,col="red")


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> sessionInfo() #for two Linux machines having problem
R version 4.1.2 (2021-11-01)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 20.2

Matrix products: default
BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
 [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.1.2  Matrix_1.3-4    tools_4.1.2     expm_0.999-6    grid_4.1.2      lattice_0.20-45

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> sessionInfo() # for a third Linux machine not having the problem
R version 4.1.1 (2021-08-10)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 19.3

Matrix products: default
BLAS/LAPACK: /opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
 [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.1.1 tools_4.1.1



Thomas R. LaBone
PhD student
Department of Epidemiology and Biostatistics
Arnold School of Public Health
University of South Carolina
Columbia, South Carolina USA


        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Thu Dec  2 20:31:47 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 2 Dec 2021 11:31:47 -0800
Subject: [R] A technical question on methods for "+"
Message-ID: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>

... and probably a dumb one and almost certainly not of interest to
most R users. But anyway...

?"+" says:
"The unary and binary arithmetic operators are generic functions:
methods can be written for them individually or via the Ops group
generic function. "

So:
"+.character" <- function(e1, e2) paste0(e1, e2)
## but this doesn't 'work':
> "a" + "b"
Error in "a" + "b" : non-numeric argument to binary operator

## but explicitly invoking the method does 'work' :
> "+.character"('a','b')
[1] "ab"

##Note also:
> methods("+")
[1] +.character +.Date      +.IDate*    +.POSIXt    +.trellis*

So what am I failing to understand?
Thanks.

Bert Gunter


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Dec  2 21:01:12 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 02 Dec 2021 12:01:12 -0800
Subject: [R] A technical question on methods for "+"
In-Reply-To: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
References: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
Message-ID: <ECBA8C41-8947-468C-B799-D6B3FDB06FDC@dcn.davis.ca.us>

I think the fact that character is a built-in type rather than an S3 class has something to do with it.

On December 2, 2021 11:31:47 AM PST, Bert Gunter <bgunter.4567 at gmail.com> wrote:
>... and probably a dumb one and almost certainly not of interest to
>most R users. But anyway...
>
>?"+" says:
>"The unary and binary arithmetic operators are generic functions:
>methods can be written for them individually or via the Ops group
>generic function. "
>
>So:
>"+.character" <- function(e1, e2) paste0(e1, e2)
>## but this doesn't 'work':
>> "a" + "b"
>Error in "a" + "b" : non-numeric argument to binary operator
>
>## but explicitly invoking the method does 'work' :
>> "+.character"('a','b')
>[1] "ab"
>
>##Note also:
>> methods("+")
>[1] +.character +.Date      +.IDate*    +.POSIXt    +.trellis*
>
>So what am I failing to understand?
>Thanks.
>
>Bert Gunter
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From @kw@|mmo @end|ng |rom gm@||@com  Thu Dec  2 21:10:32 2021
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Thu, 2 Dec 2021 15:10:32 -0500
Subject: [R] A technical question on methods for "+"
In-Reply-To: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
References: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
Message-ID: <CAPcHnpRtQ4N5wbGBSczm_P1Z5dRy6D7xU09zt_eMHnPTm=jSXA@mail.gmail.com>

This is because + dispatches on the class attribute, which a string like
"test" has set to NULL, so it doesn't dispatch. You can add the class
yourself like structure("test", class = "character") and that should work.

I'm not sure where it's explained, but most primitive functions dispatch on
the class attribute, which is different from UseMethod which calls class()
if the class attribute is NULL.

I think if you want to define something like what you have written, you
could write a function `%+%` use that instead

On Thu, Dec 2, 2021, 14:32 Bert Gunter <bgunter.4567 at gmail.com> wrote:

> ... and probably a dumb one and almost certainly not of interest to
> most R users. But anyway...
>
> ?"+" says:
> "The unary and binary arithmetic operators are generic functions:
> methods can be written for them individually or via the Ops group
> generic function. "
>
> So:
> "+.character" <- function(e1, e2) paste0(e1, e2)
> ## but this doesn't 'work':
> > "a" + "b"
> Error in "a" + "b" : non-numeric argument to binary operator
>
> ## but explicitly invoking the method does 'work' :
> > "+.character"('a','b')
> [1] "ab"
>
> ##Note also:
> > methods("+")
> [1] +.character +.Date      +.IDate*    +.POSIXt    +.trellis*
>
> So what am I failing to understand?
> Thanks.
>
> Bert Gunter
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Thu Dec  2 21:22:59 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 2 Dec 2021 12:22:59 -0800
Subject: [R] A technical question on methods for "+"
In-Reply-To: <CAPcHnpRtQ4N5wbGBSczm_P1Z5dRy6D7xU09zt_eMHnPTm=jSXA@mail.gmail.com>
References: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
 <CAPcHnpRtQ4N5wbGBSczm_P1Z5dRy6D7xU09zt_eMHnPTm=jSXA@mail.gmail.com>
Message-ID: <CAGxFJbQ9-n41DE+subRTJ1umRvPciaVavmpxeyyhQUiTpnH++Q@mail.gmail.com>

"This is because + dispatches on the class attribute, which a string
like "test" has set to NULL"
Not true.

> class('test')
[1] "character"

But apparently, as Denes and Jeff said, the class must be explicitly
set, rather than relying on its built-in/implicit type.

With the above hint, I looked up what ?class had to say. It is:

"Note that for objects x of an implicit (or an S4) class, when a (S3)
generic function foo(x) is called, method dispatch may use more
classes than are returned by class(x), e.g., for a numeric matrix, the
foo.numeric() method may apply. The exact full character vector of the
classes which UseMethod() uses, is available as .class2(x) since R
version 4.0.0. (This also applies to S4 objects when S3 dispatch is
considered, see below.)"

I think this is the "official" explanation, but I find it rather opaque.

Thanks to all for your Help in finding the explanation. Much appreciated.

Bert

On Thu, Dec 2, 2021 at 12:10 PM Andrew Simmons <akwsimmo at gmail.com> wrote:
>
> This is because + dispatches on the class attribute, which a string like "test" has set to NULL, so it doesn't dispatch. You can add the class yourself like structure("test", class = "character") and that should work.
>
> I'm not sure where it's explained, but most primitive functions dispatch on the class attribute, which is different from UseMethod which calls class() if the class attribute is NULL.
>
> I think if you want to define something like what you have written, you could write a function `%+%` use that instead
>
> On Thu, Dec 2, 2021, 14:32 Bert Gunter <bgunter.4567 at gmail.com> wrote:
>>
>> ... and probably a dumb one and almost certainly not of interest to
>> most R users. But anyway...
>>
>> ?"+" says:
>> "The unary and binary arithmetic operators are generic functions:
>> methods can be written for them individually or via the Ops group
>> generic function. "
>>
>> So:
>> "+.character" <- function(e1, e2) paste0(e1, e2)
>> ## but this doesn't 'work':
>> > "a" + "b"
>> Error in "a" + "b" : non-numeric argument to binary operator
>>
>> ## but explicitly invoking the method does 'work' :
>> > "+.character"('a','b')
>> [1] "ab"
>>
>> ##Note also:
>> > methods("+")
>> [1] +.character +.Date      +.IDate*    +.POSIXt    +.trellis*
>>
>> So what am I failing to understand?
>> Thanks.
>>
>> Bert Gunter
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From @kw@|mmo @end|ng |rom gm@||@com  Thu Dec  2 21:30:20 2021
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Thu, 2 Dec 2021 15:30:20 -0500
Subject: [R] A technical question on methods for "+"
In-Reply-To: <CAGxFJbQ9-n41DE+subRTJ1umRvPciaVavmpxeyyhQUiTpnH++Q@mail.gmail.com>
References: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
 <CAPcHnpRtQ4N5wbGBSczm_P1Z5dRy6D7xU09zt_eMHnPTm=jSXA@mail.gmail.com>
 <CAGxFJbQ9-n41DE+subRTJ1umRvPciaVavmpxeyyhQUiTpnH++Q@mail.gmail.com>
Message-ID: <CAPcHnpSUk1J-95MD=ckfsejNCMiRipg9TtKuOnZbx0xKpL2YVg@mail.gmail.com>

class() does not always return the class attribute, try something more like
attr(, "class"), you'll see what I mean

On Thu, Dec 2, 2021, 15:23 Bert Gunter <bgunter.4567 at gmail.com> wrote:

> "This is because + dispatches on the class attribute, which a string
> like "test" has set to NULL"
> Not true.
>
> > class('test')
> [1] "character"
>
> But apparently, as Denes and Jeff said, the class must be explicitly
> set, rather than relying on its built-in/implicit type.
>
> With the above hint, I looked up what ?class had to say. It is:
>
> "Note that for objects x of an implicit (or an S4) class, when a (S3)
> generic function foo(x) is called, method dispatch may use more
> classes than are returned by class(x), e.g., for a numeric matrix, the
> foo.numeric() method may apply. The exact full character vector of the
> classes which UseMethod() uses, is available as .class2(x) since R
> version 4.0.0. (This also applies to S4 objects when S3 dispatch is
> considered, see below.)"
>
> I think this is the "official" explanation, but I find it rather opaque.
>
> Thanks to all for your Help in finding the explanation. Much appreciated.
>
> Bert
>
> On Thu, Dec 2, 2021 at 12:10 PM Andrew Simmons <akwsimmo at gmail.com> wrote:
> >
> > This is because + dispatches on the class attribute, which a string like
> "test" has set to NULL, so it doesn't dispatch. You can add the class
> yourself like structure("test", class = "character") and that should work.
> >
> > I'm not sure where it's explained, but most primitive functions dispatch
> on the class attribute, which is different from UseMethod which calls
> class() if the class attribute is NULL.
> >
> > I think if you want to define something like what you have written, you
> could write a function `%+%` use that instead
> >
> > On Thu, Dec 2, 2021, 14:32 Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >>
> >> ... and probably a dumb one and almost certainly not of interest to
> >> most R users. But anyway...
> >>
> >> ?"+" says:
> >> "The unary and binary arithmetic operators are generic functions:
> >> methods can be written for them individually or via the Ops group
> >> generic function. "
> >>
> >> So:
> >> "+.character" <- function(e1, e2) paste0(e1, e2)
> >> ## but this doesn't 'work':
> >> > "a" + "b"
> >> Error in "a" + "b" : non-numeric argument to binary operator
> >>
> >> ## but explicitly invoking the method does 'work' :
> >> > "+.character"('a','b')
> >> [1] "ab"
> >>
> >> ##Note also:
> >> > methods("+")
> >> [1] +.character +.Date      +.IDate*    +.POSIXt    +.trellis*
> >>
> >> So what am I failing to understand?
> >> Thanks.
> >>
> >> Bert Gunter
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Dec  2 21:40:03 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 2 Dec 2021 15:40:03 -0500
Subject: [R] A technical question on methods for "+"
In-Reply-To: <CAPcHnpRtQ4N5wbGBSczm_P1Z5dRy6D7xU09zt_eMHnPTm=jSXA@mail.gmail.com>
References: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
 <CAPcHnpRtQ4N5wbGBSczm_P1Z5dRy6D7xU09zt_eMHnPTm=jSXA@mail.gmail.com>
Message-ID: <b225551c-faab-afe9-313d-7959727271cc@gmail.com>

The reason for this behaviour is that finding methods is a lot slower 
than just evaluating the built-in function.  So R takes the time to 
determine if there's an attribute named "class" attached, but doesn't go 
searching further if there isn't one.

Duncan Murdoch

On 02/12/2021 3:10 p.m., Andrew Simmons wrote:
> This is because + dispatches on the class attribute, which a string like
> "test" has set to NULL, so it doesn't dispatch. You can add the class
> yourself like structure("test", class = "character") and that should work.
> 
> I'm not sure where it's explained, but most primitive functions dispatch on
> the class attribute, which is different from UseMethod which calls class()
> if the class attribute is NULL.
> 
> I think if you want to define something like what you have written, you
> could write a function `%+%` use that instead
> 
> On Thu, Dec 2, 2021, 14:32 Bert Gunter <bgunter.4567 at gmail.com> wrote:
> 
>> ... and probably a dumb one and almost certainly not of interest to
>> most R users. But anyway...
>>
>> ?"+" says:
>> "The unary and binary arithmetic operators are generic functions:
>> methods can be written for them individually or via the Ops group
>> generic function. "
>>
>> So:
>> "+.character" <- function(e1, e2) paste0(e1, e2)
>> ## but this doesn't 'work':
>>> "a" + "b"
>> Error in "a" + "b" : non-numeric argument to binary operator
>>
>> ## but explicitly invoking the method does 'work' :
>>> "+.character"('a','b')
>> [1] "ab"
>>
>> ##Note also:
>>> methods("+")
>> [1] +.character +.Date      +.IDate*    +.POSIXt    +.trellis*
>>
>> So what am I failing to understand?
>> Thanks.
>>
>> Bert Gunter
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From r@ywong @end|ng |rom t@mu@edu  Thu Dec  2 21:52:24 2021
From: r@ywong @end|ng |rom t@mu@edu (Raymond Wong)
Date: Thu, 2 Dec 2021 14:52:24 -0600
Subject: [R] 2022 John M. Chambers Software Award
References: <5dfd88b1-6324-45cd-8628-3d4c31d356e3@Spark>
Message-ID: <546fdedf-a5a0-4991-ac21-6eda1813dc4d@Spark>

Dear R-help listers,

I would like to let you know that submission window of the John M. Chambers Software Award is now open. The submission deadline is December 15, 2021.

The Statistical Computing Section of the American Statistical Association announces the competition for the John M. Chambers Statistical Software Award. In 1998 the Association for Computing Machinery (ACM) presented the ACM Software System Award to John Chambers for the design and development of S. Dr. Chambers generously donated his award to the Statistical Computing Section to endow an annual prize for statistical software written by, or in collaboration with, an undergraduate or graduate student.

Please visit?http://asa.stat.uconn.edu?for more information.

Best,
Raymond


	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Thu Dec  2 21:57:11 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Thu, 2 Dec 2021 23:57:11 +0300
Subject: [R] Forwarding missing arguments to the `[` method
Message-ID: <20211202235711.203958c0@Tarkus>

Hi everyone,

Suppose I've got a class 'foo' that's a matrix tagged with a vector of
length() == nrow(foo):

foo <- function(x, ...) UseMethod('foo')
foo.matrix <- function(x, y, ...) {
	stopifnot(
		!is.recursive(y),
		length(y) == nrow(x),
		length(list(...)) == 0
	)
	structure(x, class = 'foo', foo = y)
}

The invariant that the vector follows the rows of the matrix must be
maintained, so I write a [.foo method:

`[.foo` <- function(x, i, j, ..., drop = TRUE) {
	ret <- NextMethod() # could drop dimensions
	if (is.matrix(ret)) foo(
		ret,
		unname(setNames(attr(x, 'foo'), dimnames(x)[[1]])[i])
	)
	else ret
}

Note the acrobatics required to handle indexing objects of class foo by
the dimnames of the matrix. If I used foo(attr(x,'foo')[i]) instead,
indexing by dimnames would result in the correct subset of the matrix
tagged with a vector of NAs.

Now I would like to implement sub-assignment. I would like to access
the correct subset of the 'foo' vector (for example, if value is also
of class foo, I would like to check if the 'foo' attributes match
between value and x), but I don't want to copy&paste the code or create
a separate method, so I call `[.foo` instead:

`[<-.foo` <- function(x, i, j, ..., value) {
	xsub <- x[i,j]
	# safety checks on attr(xsub, 'foo')
	NextMethod()
}

...except this doesn't quite work:

x <- foo(volcano, 1:nrow(volcano))
x[] <- 1
# Error in NextMethod() : argument "i" is missing, with no default
traceback()
# 5: NextMethod() at foo.R#15
# 4: `[.foo`(x, i, j) at foo.R#24
# 3: x[i, j] at foo.R#24
# 2: `[<-.foo`(`*tmp*`, , value = 1)
# 1: `[<-`(`*tmp*`, , value = 1)

Why can I forward missing i,j to built-in `[`

-- 
Best regards,
Ivan


From kry|ov@r00t @end|ng |rom gm@||@com  Thu Dec  2 22:00:01 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 3 Dec 2021 00:00:01 +0300
Subject: [R] Forwarding missing arguments to the `[` method
In-Reply-To: <20211202235711.203958c0@Tarkus>
References: <20211202235711.203958c0@Tarkus>
Message-ID: <20211203000001.58aba4d6@Tarkus>

Sorry for sending an unfinished message!

On Thu, 2 Dec 2021 23:57:11 +0300
Ivan Krylov <krylov.r00t at gmail.com> wrote:

> Why can I forward missing i,j to built-in `[`

Why can I forward missing i,j to the built-in `[` method but not
to user-defined methods? How can I fix this? Default i and j to TRUE?
Are there less involved methods of handling my problem of subsetting
attr(x, 'foo') with the dimnames of x? Preferrably without setting
dimnames on attr(x, 'foo') itself.

-- 
Best regards,
Ivan


From bgunter@4567 @end|ng |rom gm@||@com  Thu Dec  2 22:16:56 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 2 Dec 2021 13:16:56 -0800
Subject: [R] A technical question on methods for "+"
In-Reply-To: <b225551c-faab-afe9-313d-7959727271cc@gmail.com>
References: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
 <CAPcHnpRtQ4N5wbGBSczm_P1Z5dRy6D7xU09zt_eMHnPTm=jSXA@mail.gmail.com>
 <b225551c-faab-afe9-313d-7959727271cc@gmail.com>
Message-ID: <CAGxFJbQYJTZHPN0rzwK6aj4cQdafFPcXfng+x_8S=Vo6eYR6-g@mail.gmail.com>

Those are both helpful comments. Would it not be useful to say
something along these lines in ?class. ?
The key point I missed is that there often(but not always) must be an
*explicit* class **attribute** for method dispatch; and class() does
not indicate whether its value is explicit or not (just recapitulating
what you both said). Ops methods are such a case (for anything but
classes inheriting from numeric?), and perhaps a mention there might
be useful, too.

Again, thanks for the help.

Bert

On Thu, Dec 2, 2021 at 12:40 PM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>
> The reason for this behaviour is that finding methods is a lot slower
> than just evaluating the built-in function.  So R takes the time to
> determine if there's an attribute named "class" attached, but doesn't go
> searching further if there isn't one.
>
> Duncan Murdoch
>
> On 02/12/2021 3:10 p.m., Andrew Simmons wrote:
> > This is because + dispatches on the class attribute, which a string like
> > "test" has set to NULL, so it doesn't dispatch. You can add the class
> > yourself like structure("test", class = "character") and that should work.
> >
> > I'm not sure where it's explained, but most primitive functions dispatch on
> > the class attribute, which is different from UseMethod which calls class()
> > if the class attribute is NULL.
> >
> > I think if you want to define something like what you have written, you
> > could write a function `%+%` use that instead
> >
> > On Thu, Dec 2, 2021, 14:32 Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >
> >> ... and probably a dumb one and almost certainly not of interest to
> >> most R users. But anyway...
> >>
> >> ?"+" says:
> >> "The unary and binary arithmetic operators are generic functions:
> >> methods can be written for them individually or via the Ops group
> >> generic function. "
> >>
> >> So:
> >> "+.character" <- function(e1, e2) paste0(e1, e2)
> >> ## but this doesn't 'work':
> >>> "a" + "b"
> >> Error in "a" + "b" : non-numeric argument to binary operator
> >>
> >> ## but explicitly invoking the method does 'work' :
> >>> "+.character"('a','b')
> >> [1] "ab"
> >>
> >> ##Note also:
> >>> methods("+")
> >> [1] +.character +.Date      +.IDate*    +.POSIXt    +.trellis*
> >>
> >> So what am I failing to understand?
> >> Thanks.
> >>
> >> Bert Gunter
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> >> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Dec  2 22:41:52 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 02 Dec 2021 13:41:52 -0800
Subject: [R] Forwarding missing arguments to the `[` method
In-Reply-To: <20211203000001.58aba4d6@Tarkus>
References: <20211202235711.203958c0@Tarkus> <20211203000001.58aba4d6@Tarkus>
Message-ID: <6848253E-EA56-4C2E-B78A-5BDCEA571922@dcn.davis.ca.us>

I think you need a reprex... I don't think your claim is correct as stated.

On December 2, 2021 1:00:01 PM PST, Ivan Krylov <krylov.r00t at gmail.com> wrote:
>Sorry for sending an unfinished message!
>
>On Thu, 2 Dec 2021 23:57:11 +0300
>Ivan Krylov <krylov.r00t at gmail.com> wrote:
>
>> Why can I forward missing i,j to built-in `[`
>
>Why can I forward missing i,j to the built-in `[` method but not
>to user-defined methods? How can I fix this? Default i and j to TRUE?
>Are there less involved methods of handling my problem of subsetting
>attr(x, 'foo') with the dimnames of x? Preferrably without setting
>dimnames on attr(x, 'foo') itself.
>

-- 
Sent from my phone. Please excuse my brevity.


From y@ngk@|9999 @end|ng |rom y@hoo@com  Fri Dec  3 01:21:24 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Fri, 3 Dec 2021 00:21:24 +0000 (UTC)
Subject: [R] SOMAscan data analysis
References: <975453562.357165.1638490884679.ref@mail.yahoo.com>
Message-ID: <975453562.357165.1638490884679@mail.yahoo.com>

Hello R team,we have a huge SOMAscan data set. This is an aptamer-based protecomics assay capable of measuring 1305 human protein analytes. does anyone know which package can load the data and do analysis??I apricate?any suggestion, your experience, web page, paper....?
Thank you,Kai
	[[alternative HTML version deleted]]


From r@oknz @end|ng |rom gm@||@com  Fri Dec  3 05:06:45 2021
From: r@oknz @end|ng |rom gm@||@com (Richard O'Keefe)
Date: Fri, 3 Dec 2021 17:06:45 +1300
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
Message-ID: <CABcYAdL60P_E430RRwgh+v5L932Ph7OJ0KhvFK-0kUnUYc7V8A@mail.gmail.com>

What puzzles me is why you are not just using
lapply(some.data.frame, min)
lapply(some.data.frame, max)
or as.vector(lapply(...))
Why go to another package for this?
Is it the indices you want?

col.min.indices <- function (some.data.frame) {
    v <- sapply(some.data.frame, function (column)
           which(column == min(column))[1])
    names(v) <- colnames(some.data.frame)
    v
}


On Wed, 1 Dec 2021 at 07:55, Stephen H. Dawson, DSL via R-help <
r-help at r-project.org> wrote:

> Hi,
>
>
> I am working to understand the Rfast functions of colMins and colMaxs. I
> worked through the example listed on page 54 of the PDF.
>
> https://cran.r-project.org/web/packages/Rfast/index.html
>
> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>
> My data is in a CSV file. So, I bring it into R Studio using:
> Data <- read.csv("./input/DataSet05.csv", header=T)
>
> However, I read the instructions listed on page 54 of the PDF saying I
> need to bring data into R using a matrix. I think read.csv brings the
> data in as a dataframe. I think colMins is failing because it is looking
> for a matrix but finds a dataframe.
>
>  > colMaxs(Data)
> Error in colMaxs(Data) :
>    Not compatible with requested type: [type=list; target=double].
>  > colMins(Data, na.rm = TRUE)
> Error in colMins(Data, na.rm = TRUE) :
>    unused argument (na.rm = TRUE)
>  > colMins(Data, value = FALSE, parallel = FALSE)
> Error in colMins(Data, value = FALSE, parallel = FALSE) :
>    Not compatible with requested type: [type=list; target=double].
>
> QUESTION
> What is the best practice to bring a csv file into R Studio so it can be
> accessed by colMaxs and colMins, please?
>
>
> Thanks,
> --
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From deep@y@n@@@rk@r @end|ng |rom gm@||@com  Fri Dec  3 06:11:42 2021
From: deep@y@n@@@rk@r @end|ng |rom gm@||@com (Deepayan Sarkar)
Date: Fri, 3 Dec 2021 10:41:42 +0530
Subject: [R] A technical question on methods for "+"
In-Reply-To: <CAGxFJbQYJTZHPN0rzwK6aj4cQdafFPcXfng+x_8S=Vo6eYR6-g@mail.gmail.com>
References: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
 <CAPcHnpRtQ4N5wbGBSczm_P1Z5dRy6D7xU09zt_eMHnPTm=jSXA@mail.gmail.com>
 <b225551c-faab-afe9-313d-7959727271cc@gmail.com>
 <CAGxFJbQYJTZHPN0rzwK6aj4cQdafFPcXfng+x_8S=Vo6eYR6-g@mail.gmail.com>
Message-ID: <CADfFDC7Dx_egX4pQAyTQoPo_v2h-O3qAGLKTtpMJ1Ao51mH-0g@mail.gmail.com>

On Fri, Dec 3, 2021 at 3:14 AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> Those are both helpful comments. Would it not be useful to say
> something along these lines in ?class. ?
> The key point I missed is that there often(but not always) must be an
> *explicit* class **attribute** for method dispatch; and class() does
> not indicate whether its value is explicit or not (just recapitulating
> what you both said). Ops methods are such a case (for anything but
> classes inheriting from numeric?), and perhaps a mention there might
> be useful, too.

?Ops already says

     Note that a method will be used for one of these groups or one of
     its members _only_ if it corresponds to a '"class"' attribute, as
     the internal code dispatches on 'oldClass' and not on 'class'.
     This is for efficiency: having to dispatch on, say, 'Ops.integer'
     would be too slow.

Can you suggest some text to make this clearer?

FWIW, the following seems to work as you would want (at the cost of
global inefficiency):

`+` <- function(e1, e2) UseMethod("+")
`+.default` <- function(e1, e2 = 0) .Primitive("+")(e1, e2)

and then

"+.character" <- function(e1, e2) paste0(e1, e2)

> "jan" + "feb"
[1] "janfeb"
> Reduce("+", letters)
[1] "abcdefghijklmnopqrstuvwxyz"

-Deepayan

> Again, thanks for the help.
>
> Bert
>
> On Thu, Dec 2, 2021 at 12:40 PM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> >
> > The reason for this behaviour is that finding methods is a lot slower
> > than just evaluating the built-in function.  So R takes the time to
> > determine if there's an attribute named "class" attached, but doesn't go
> > searching further if there isn't one.
> >
> > Duncan Murdoch
> >
> > On 02/12/2021 3:10 p.m., Andrew Simmons wrote:
> > > This is because + dispatches on the class attribute, which a string like
> > > "test" has set to NULL, so it doesn't dispatch. You can add the class
> > > yourself like structure("test", class = "character") and that should work.
> > >
> > > I'm not sure where it's explained, but most primitive functions dispatch on
> > > the class attribute, which is different from UseMethod which calls class()
> > > if the class attribute is NULL.
> > >
> > > I think if you want to define something like what you have written, you
> > > could write a function `%+%` use that instead
> > >
> > > On Thu, Dec 2, 2021, 14:32 Bert Gunter <bgunter.4567 at gmail.com> wrote:
> > >
> > >> ... and probably a dumb one and almost certainly not of interest to
> > >> most R users. But anyway...
> > >>
> > >> ?"+" says:
> > >> "The unary and binary arithmetic operators are generic functions:
> > >> methods can be written for them individually or via the Ops group
> > >> generic function. "
> > >>
> > >> So:
> > >> "+.character" <- function(e1, e2) paste0(e1, e2)
> > >> ## but this doesn't 'work':
> > >>> "a" + "b"
> > >> Error in "a" + "b" : non-numeric argument to binary operator
> > >>
> > >> ## but explicitly invoking the method does 'work' :
> > >>> "+.character"('a','b')
> > >> [1] "ab"
> > >>
> > >> ##Note also:
> > >>> methods("+")
> > >> [1] +.character +.Date      +.IDate*    +.POSIXt    +.trellis*
> > >>
> > >> So what am I failing to understand?
> > >> Thanks.
> > >>
> > >> Bert Gunter
> > >>
> > >> ______________________________________________
> > >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > >> https://stat.ethz.ch/mailman/listinfo/r-help
> > >> PLEASE do read the posting guide
> > >> http://www.R-project.org/posting-guide.html
> > >> and provide commented, minimal, self-contained, reproducible code.
> > >>
> > >
> > >       [[alternative HTML version deleted]]
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> > >
> >
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Dec  3 07:52:09 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 3 Dec 2021 09:52:09 +0300
Subject: [R] Forwarding missing arguments to the `[` method
In-Reply-To: <6848253E-EA56-4C2E-B78A-5BDCEA571922@dcn.davis.ca.us>
References: <20211202235711.203958c0@Tarkus> <20211203000001.58aba4d6@Tarkus>
 <6848253E-EA56-4C2E-B78A-5BDCEA571922@dcn.davis.ca.us>
Message-ID: <20211203095209.1928a976@Tarkus>

On Thu, 02 Dec 2021 13:41:52 -0800
Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:

> I think you need a reprex... I don't think your claim is correct as
> stated.

Sorry, let me try again. The following "works" for me in the sense of
throwing the same error on R 3.3 and R-devel:

foo <- function(x, ...) UseMethod('foo')

# foo is a matrix tagged with a vector of length() == nrow(foo)
foo.matrix <- function(x, y, ...) {
	stopifnot(
		!is.recursive(y),
		length(y) == nrow(x),
		length(list(...)) == 0
	)
	structure(x, class = 'foo', foo = y)
}

# the vector must be subsetted at the same time as x
`[.foo` <- function(x, i, j, ..., drop = TRUE) {
	ret <- NextMethod() # could drop dimensions
	if (is.matrix(ret)) foo(
		ret,
		unname(setNames(attr(x, 'foo'), dimnames(x)[[1]])[i])
	)
	else ret
}

`[<-.foo` <- function(x, i, j, ..., value) {
	xsub <- x[i, j, drop = FALSE]
	# TODO: some checks on xsub
	NextMethod()
}

x <- foo(volcano, 1:nrow(volcano))
invisible(x[]) # doesn't stop despite missing i
x[] <- 1       # fails in `[.foo` with "i missing"
# Error in NextMethod() : argument "i" is missing, with no default
traceback()
# 9: NextMethod() at foo.R#15
# 8: `[.foo`(x, i, j, drop = FALSE) at foo.R#24
# 7: x[i, j, drop = FALSE] at foo.R#24
# 6: `[<-.foo`(`*tmp*`, , value = 1) at foo.R#30
# 5: `[<-`(`*tmp*`, , value = 1) at foo.R#30
# 4: eval(ei, envir)
# 3: eval(ei, envir)
# 2: withVisible(eval(ei, envir))
# 1: source("foo.R", echo = TRUE)

Or did you mean some other claim?

-- 
Best regards,
Ivan


From er|cjberger @end|ng |rom gm@||@com  Fri Dec  3 10:40:38 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Fri, 3 Dec 2021 11:40:38 +0200
Subject: [R] SOMAscan data analysis
In-Reply-To: <975453562.357165.1638490884679@mail.yahoo.com>
References: <975453562.357165.1638490884679.ref@mail.yahoo.com>
 <975453562.357165.1638490884679@mail.yahoo.com>
Message-ID: <CAGgJW75fbT=xvF=df+8fmy3XZ-+dzj=yd=H86BQ9XG2TayM=Yw@mail.gmail.com>

Hi Kai,
Check out https://www.bioconductor.org
or the help there at
https://www.bioconductor.org/help/

You can also post your question there.

Best,
Eric


On Fri, Dec 3, 2021 at 2:22 AM Kai Yang via R-help <r-help at r-project.org>
wrote:

> Hello R team,we have a huge SOMAscan data set. This is an aptamer-based
> protecomics assay capable of measuring 1305 human protein analytes. does
> anyone know which package can load the data and do analysis? I apricate any
> suggestion, your experience, web page, paper....
> Thank you,Kai
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From |@bone @end|ng |rom em@||@@c@edu  Fri Dec  3 16:28:53 2021
From: |@bone @end|ng |rom em@||@@c@edu (Labone, Thomas)
Date: Fri, 3 Dec 2021 15:28:53 +0000
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <BN8PR19MB2817E1E5AF9FE6ED8CFF8C82F9699@BN8PR19MB2817.namprd19.prod.outlook.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
 <CAHqSRuSn05tHOjdDAL6gSXZbaV80YA5WvAzsKfPdR8i3tAw-VA@mail.gmail.com>
 <BN8PR19MB2817E1E5AF9FE6ED8CFF8C82F9699@BN8PR19MB2817.namprd19.prod.outlook.com>
Message-ID: <BN8PR19MB28173C7C388770DDE4FA58EFF96A9@BN8PR19MB2817.namprd19.prod.outlook.com>

Thanks for the feedback everyone. If you go to https://github.com/csantill/RPerformanceWBLAS/blob/master/RPerformanceBLAS.md you will find the Linux commands to change the default math library. When I switch the BLAS library from MKL to the system default (see sessionInfo below), everything works as expected. I installed version 2020.0-166-1 of "Intel-MKL" from the Linux Mint Software Manager. I may be coming to a hasty conclusion, but there appears to be something wrong with that package or how it interacts with other system software. Any suggestions on who I should notify about the problem (e.g., Intel, Mint, Ubuntu)?

R version 4.1.2 (2021-11-01)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 20.2

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
 [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.1.2 tools_4.1.2



Thomas R. LaBone
PhD student
Department of Epidemiology and Biostatistics
Arnold School of Public Health
University of South Carolina
Columbia, South Carolina USA



________________________________
From: Labone, Thomas <labone at email.sc.edu>
Sent: Thursday, December 2, 2021 11:53 AM
To: Bill Dunlap <williamwdunlap at gmail.com>
Cc: r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] Problem with lm Giving Wrong Results

> summary(fit)

Call:
lm(formula = log(k) ~ Z)

Residuals:
    Min      1Q  Median      3Q     Max
-21.241   1.327   1.776   2.245   4.418

Coefficients:
            Estimate Std. Error t value Pr(>|t|)
(Intercept) -0.03465    0.01916  -1.809   0.0705 .
Z           -0.24207    0.01916 -12.634   <2e-16 ***
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1

Residual standard error: 1.914 on 9998 degrees of freedom
Multiple R-squared:  0.01467, Adjusted R-squared:  0.01457
F-statistic: 148.8 on 1 and 9998 DF,  p-value: < 2.2e-16

> summary(k)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
 0.2735  3.7658  5.9052  7.5113  9.4399 82.9531
> summary(Z)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
-3.8906 -0.6744  0.0000  0.0000  0.6744  3.8906
> summary(gm*gsd^Z)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
 0.3767  0.8204  0.9659  0.9947  1.1372  2.4772
>


Thomas R. LaBone
PhD student
Department of Epidemiology and Biostatistics
Arnold School of Public Health
University of South Carolina
Columbia, South Carolina USA


________________________________
From: Bill Dunlap <williamwdunlap at gmail.com>
Sent: Thursday, December 2, 2021 10:31 AM
To: Labone, Thomas <labone at email.sc.edu>
Cc: r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] Problem with lm Giving Wrong Results

On the 'bad' machines, what did you get for
   summary(fit)
   summary(k)
   summary(Z)
   summary(gm*gsd^Z)
?

-Bill

On Thu, Dec 2, 2021 at 6:18 AM Labone, Thomas <labone at email.sc.edu<mailto:labone at email.sc.edu>> wrote:
In the code below the first and second plots should look pretty much the same, the only difference being that the first has n=1000 points and the second n=10000 points. On two of my Linux machines (info below) the second plot is a horizontal line (incorrect answer from lm), but on my Windows 10 machine and a third Linux machine it works as expected. The interesting thing is that the code works as expected for n <= 4095 but fails for n>=4096 (which equals 2^12). Can anyone else reproduce this problem? Any ideas on how to fix it?

set.seed(132)

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# This works
n <- 1000# OK <= 4095
Z <- qnorm(ppoints(n))

k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))

quantile(k,probs=c(0.025,0.5,0.975))
summary(k)

fit <- lm(log(k) ~ Z)
summary(fit)

gm <- exp(coef(fit)[1])
gsd <- exp(coef(fit)[2])
gm
gsd

plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
lines(Z,gm*gsd^Z,col="red")

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#this does not
n <- 10000# fails >= 4096 = 2^12
Z <- qnorm(ppoints(n))

k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))

quantile(k,probs=c(0.025,0.5,0.975))
summary(k)

fit <- lm(log(k) ~ Z)
summary(fit)

gm <- exp(coef(fit)[1])
gsd <- exp(coef(fit)[2])
gm
gsd

plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
lines(Z,gm*gsd^Z,col="red")


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> sessionInfo() #for two Linux machines having problem
R version 4.1.2 (2021-11-01)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 20.2

Matrix products: default
BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
 [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.1.2  Matrix_1.3-4    tools_4.1.2     expm_0.999-6    grid_4.1.2      lattice_0.20-45

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> sessionInfo() # for a third Linux machine not having the problem
R version 4.1.1 (2021-08-10)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 19.3

Matrix products: default
BLAS/LAPACK: /opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
 [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.1.1 tools_4.1.1



Thomas R. LaBone
PhD student
Department of Epidemiology and Biostatistics
Arnold School of Public Health
University of South Carolina
Columbia, South Carolina USA


        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From @@r@h@go@|ee @end|ng |rom gm@||@com  Fri Dec  3 17:00:51 2021
From: @@r@h@go@|ee @end|ng |rom gm@||@com (Sarah Goslee)
Date: Fri, 3 Dec 2021 11:00:51 -0500
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <BN8PR19MB28173C7C388770DDE4FA58EFF96A9@BN8PR19MB2817.namprd19.prod.outlook.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
 <CAHqSRuSn05tHOjdDAL6gSXZbaV80YA5WvAzsKfPdR8i3tAw-VA@mail.gmail.com>
 <BN8PR19MB2817E1E5AF9FE6ED8CFF8C82F9699@BN8PR19MB2817.namprd19.prod.outlook.com>
 <BN8PR19MB28173C7C388770DDE4FA58EFF96A9@BN8PR19MB2817.namprd19.prod.outlook.com>
Message-ID: <CAM_vjunZUZNdThGEZu1FYxV6K3BZ+WkZ-LMJ2VqGKCeL+63LYg@mail.gmail.com>

It might also be a BLAS+processor problem - I got bit pretty hard by
that, with an example here:

https://stat.ethz.ch/pipermail/r-help/2019-July/463477.html

With a key excerpt here:

On Thu, Jul 18, 2019 at 1:59 PM Ivan Krylov <krylov.r00t using gmail.com> wrote:
> Yes, this might be bad. I have heard about OpenBLAS (specifically, the
> matrix product routine) misbehaving on certain AVX-512 capable
> processors, so much that they had to disable some optimizations in
> 0.3.6 [*], which you already have installed. Still, would `env
> OPENBLAS_CORETYPE=Haswell R --vanilla` give a better result?
>

On Fri, Dec 3, 2021 at 10:29 AM Labone, Thomas <labone at email.sc.edu> wrote:
>
> Thanks for the feedback everyone. If you go to https://github.com/csantill/RPerformanceWBLAS/blob/master/RPerformanceBLAS.md you will find the Linux commands to change the default math library. When I switch the BLAS library from MKL to the system default (see sessionInfo below), everything works as expected. I installed version 2020.0-166-1 of "Intel-MKL" from the Linux Mint Software Manager. I may be coming to a hasty conclusion, but there appears to be something wrong with that package or how it interacts with other system software. Any suggestions on who I should notify about the problem (e.g., Intel, Mint, Ubuntu)?
>
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 20.2
>
> Matrix products: default
> BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
> LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
>  [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2 tools_4.1.2
>
>
>
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
>
>
>
> ________________________________
> From: Labone, Thomas <labone at email.sc.edu>
> Sent: Thursday, December 2, 2021 11:53 AM
> To: Bill Dunlap <williamwdunlap at gmail.com>
> Cc: r-help at r-project.org <r-help at r-project.org>
> Subject: Re: [R] Problem with lm Giving Wrong Results
>
> > summary(fit)
>
> Call:
> lm(formula = log(k) ~ Z)
>
> Residuals:
>     Min      1Q  Median      3Q     Max
> -21.241   1.327   1.776   2.245   4.418
>
> Coefficients:
>             Estimate Std. Error t value Pr(>|t|)
> (Intercept) -0.03465    0.01916  -1.809   0.0705 .
> Z           -0.24207    0.01916 -12.634   <2e-16 ***
> ---
> Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1
>
> Residual standard error: 1.914 on 9998 degrees of freedom
> Multiple R-squared:  0.01467, Adjusted R-squared:  0.01457
> F-statistic: 148.8 on 1 and 9998 DF,  p-value: < 2.2e-16
>
> > summary(k)
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>  0.2735  3.7658  5.9052  7.5113  9.4399 82.9531
> > summary(Z)
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
> -3.8906 -0.6744  0.0000  0.0000  0.6744  3.8906
> > summary(gm*gsd^Z)
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>  0.3767  0.8204  0.9659  0.9947  1.1372  2.4772
> >
>
>
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
>
>
> ________________________________
> From: Bill Dunlap <williamwdunlap at gmail.com>
> Sent: Thursday, December 2, 2021 10:31 AM
> To: Labone, Thomas <labone at email.sc.edu>
> Cc: r-help at r-project.org <r-help at r-project.org>
> Subject: Re: [R] Problem with lm Giving Wrong Results
>
> On the 'bad' machines, what did you get for
>    summary(fit)
>    summary(k)
>    summary(Z)
>    summary(gm*gsd^Z)
> ?
>
> -Bill
>
> On Thu, Dec 2, 2021 at 6:18 AM Labone, Thomas <labone at email.sc.edu<mailto:labone at email.sc.edu>> wrote:
> In the code below the first and second plots should look pretty much the same, the only difference being that the first has n=1000 points and the second n=10000 points. On two of my Linux machines (info below) the second plot is a horizontal line (incorrect answer from lm), but on my Windows 10 machine and a third Linux machine it works as expected. The interesting thing is that the code works as expected for n <= 4095 but fails for n>=4096 (which equals 2^12). Can anyone else reproduce this problem? Any ideas on how to fix it?
>
> set.seed(132)
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> # This works
> n <- 1000# OK <= 4095
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #this does not
> n <- 10000# fails >= 4096 = 2^12
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > sessionInfo() #for two Linux machines having problem
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 20.2
>
> Matrix products: default
> BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2  Matrix_1.3-4    tools_4.1.2     expm_0.999-6    grid_4.1.2      lattice_0.20-45
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > sessionInfo() # for a third Linux machine not having the problem
> R version 4.1.1 (2021-08-10)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 19.3
>
> Matrix products: default
> BLAS/LAPACK: /opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
>  [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.1 tools_4.1.1
>
>
>
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
Sarah Goslee (she/her)
http://www.numberwright.com


From @erv|ce @end|ng |rom @hd@w@on@com  Fri Dec  3 17:22:31 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Fri, 3 Dec 2021 11:22:31 -0500
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <CABcYAdL60P_E430RRwgh+v5L932Ph7OJ0KhvFK-0kUnUYc7V8A@mail.gmail.com>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <CABcYAdL60P_E430RRwgh+v5L932Ph7OJ0KhvFK-0kUnUYc7V8A@mail.gmail.com>
Message-ID: <3c27662b-1729-64b8-3c9b-e18a62b2664c@shdawson.com>

Thanks, Richard.

I am researching other library options for data inspection. I have many 
csv files I am reviewing with different column names and data types. 
Flexibility of a quick review of max and min is quite valuable at this 
juncture.

I will implement your code recommendation next week and see how it performs.


Kindest Regards,
*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/2/21 11:06 PM, Richard O'Keefe wrote:
> What puzzles me is why you are not just using
> lapply(some.data.frame, min)
> lapply(some.data.frame, max)
> or as.vector(lapply(...))
> Why go to another package for this?
> Is it the indices you want?
>
> col.min.indices <- function (some.data.frame) {
> ??? v <- sapply(some.data.frame, function (column)
> which(column == min(column))[1])
> ??? names(v) <- colnames(some.data.frame)
> ??? v
> }
>
>
> On Wed, 1 Dec 2021 at 07:55, Stephen H. Dawson, DSL via R-help 
> <r-help at r-project.org <mailto:r-help at r-project.org>> wrote:
>
>     Hi,
>
>
>     I am working to understand the Rfast functions of colMins and
>     colMaxs. I
>     worked through the example listed on page 54 of the PDF.
>
>     https://cran.r-project.org/web/packages/Rfast/index.html
>     <https://cran.r-project.org/web/packages/Rfast/index.html>
>
>     https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>     <https://cran.r-project.org/web/packages/Rfast/Rfast.pdf>
>
>     My data is in a CSV file. So, I bring it into R Studio using:
>     Data <- read.csv("./input/DataSet05.csv", header=T)
>
>     However, I read the instructions listed on page 54 of the PDF
>     saying I
>     need to bring data into R using a matrix. I think read.csv brings the
>     data in as a dataframe. I think colMins is failing because it is
>     looking
>     for a matrix but finds a dataframe.
>
>     ?> colMaxs(Data)
>     Error in colMaxs(Data) :
>     ?? Not compatible with requested type: [type=list; target=double].
>     ?> colMins(Data, na.rm = TRUE)
>     Error in colMins(Data, na.rm = TRUE) :
>     ?? unused argument (na.rm = TRUE)
>     ?> colMins(Data, value = FALSE, parallel = FALSE)
>     Error in colMins(Data, value = FALSE, parallel = FALSE) :
>     ?? Not compatible with requested type: [type=list; target=double].
>
>     QUESTION
>     What is the best practice to bring a csv file into R Studio so it
>     can be
>     accessed by colMaxs and colMins, please?
>
>
>     Thanks,
>     -- 
>     *Stephen Dawson, DSL*
>     /Executive Strategy Consultant/
>     Business & Technology
>     +1 (865) 804-3454
>     http://www.shdawson.com <http://www.shdawson.com>
>     <http://www.shdawson.com <http://www.shdawson.com>>
>
>     ______________________________________________
>     R-help at r-project.org <mailto:R-help at r-project.org> mailing list --
>     To UNSUBSCRIBE and more, see
>     https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>     PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>     and provide commented, minimal, self-contained, reproducible code.
>


From |@bone @end|ng |rom em@||@@c@edu  Fri Dec  3 17:37:29 2021
From: |@bone @end|ng |rom em@||@@c@edu (Labone, Thomas)
Date: Fri, 3 Dec 2021 16:37:29 +0000
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <CAM_vjunZUZNdThGEZu1FYxV6K3BZ+WkZ-LMJ2VqGKCeL+63LYg@mail.gmail.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
 <CAHqSRuSn05tHOjdDAL6gSXZbaV80YA5WvAzsKfPdR8i3tAw-VA@mail.gmail.com>
 <BN8PR19MB2817E1E5AF9FE6ED8CFF8C82F9699@BN8PR19MB2817.namprd19.prod.outlook.com>
 <BN8PR19MB28173C7C388770DDE4FA58EFF96A9@BN8PR19MB2817.namprd19.prod.outlook.com>
 <CAM_vjunZUZNdThGEZu1FYxV6K3BZ+WkZ-LMJ2VqGKCeL+63LYg@mail.gmail.com>
Message-ID: <BN8PR19MB28172DA2143E1CBDE313C6F1F96A9@BN8PR19MB2817.namprd19.prod.outlook.com>

Two of the machines having the problem are AVX-512 capable (e.g., i7-7820X) but another one is an old Samsung Series 5 with an i5-3317U. I guess I will start with the folks at Linux Mint.

Tom


Thomas R. LaBone
PhD student
Department of Epidemiology and Biostatistics
Arnold School of Public Health
University of South Carolina
Columbia, South Carolina USA



________________________________
From: Sarah Goslee <sarah.goslee at gmail.com>
Sent: Friday, December 3, 2021 11:00 AM
To: Labone, Thomas <labone at email.sc.edu>
Cc: Bill Dunlap <williamwdunlap at gmail.com>; r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] Problem with lm Giving Wrong Results

It might also be a BLAS+processor problem - I got bit pretty hard by
that, with an example here:

https://stat.ethz.ch/pipermail/r-help/2019-July/463477.html

With a key excerpt here:

On Thu, Jul 18, 2019 at 1:59 PM Ivan Krylov <krylov.r00t using gmail.com> wrote:
> Yes, this might be bad. I have heard about OpenBLAS (specifically, the
> matrix product routine) misbehaving on certain AVX-512 capable
> processors, so much that they had to disable some optimizations in
> 0.3.6 [*], which you already have installed. Still, would `env
> OPENBLAS_CORETYPE=Haswell R --vanilla` give a better result?
>

On Fri, Dec 3, 2021 at 10:29 AM Labone, Thomas <labone at email.sc.edu> wrote:
>
> Thanks for the feedback everyone. If you go to https://protect2.fireeye.com/v1/url?k=f8bdd2b7-a726ea7c-f8bd9c76-86ce7c8b8969-1acf41b3a3825b65&q=1&e=05c346dc-4f60-4e2e-ada8-1abaa8792515&u=https%3A%2F%2Fgithub.com%2Fcsantill%2FRPerformanceWBLAS%2Fblob%2Fmaster%2FRPerformanceBLAS.md you will find the Linux commands to change the default math library. When I switch the BLAS library from MKL to the system default (see sessionInfo below), everything works as expected. I installed version 2020.0-166-1 of "Intel-MKL" from the Linux Mint Software Manager. I may be coming to a hasty conclusion, but there appears to be something wrong with that package or how it interacts with other system software. Any suggestions on who I should notify about the problem (e.g., Intel, Mint, Ubuntu)?
>
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 20.2
>
> Matrix products: default
> BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
> LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
>  [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2 tools_4.1.2
>
>
>
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
>
>
>
> ________________________________
> From: Labone, Thomas <labone at email.sc.edu>
> Sent: Thursday, December 2, 2021 11:53 AM
> To: Bill Dunlap <williamwdunlap at gmail.com>
> Cc: r-help at r-project.org <r-help at r-project.org>
> Subject: Re: [R] Problem with lm Giving Wrong Results
>
> > summary(fit)
>
> Call:
> lm(formula = log(k) ~ Z)
>
> Residuals:
>     Min      1Q  Median      3Q     Max
> -21.241   1.327   1.776   2.245   4.418
>
> Coefficients:
>             Estimate Std. Error t value Pr(>|t|)
> (Intercept) -0.03465    0.01916  -1.809   0.0705 .
> Z           -0.24207    0.01916 -12.634   <2e-16 ***
> ---
> Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1
>
> Residual standard error: 1.914 on 9998 degrees of freedom
> Multiple R-squared:  0.01467, Adjusted R-squared:  0.01457
> F-statistic: 148.8 on 1 and 9998 DF,  p-value: < 2.2e-16
>
> > summary(k)
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>  0.2735  3.7658  5.9052  7.5113  9.4399 82.9531
> > summary(Z)
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
> -3.8906 -0.6744  0.0000  0.0000  0.6744  3.8906
> > summary(gm*gsd^Z)
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>  0.3767  0.8204  0.9659  0.9947  1.1372  2.4772
> >
>
>
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
>
>
> ________________________________
> From: Bill Dunlap <williamwdunlap at gmail.com>
> Sent: Thursday, December 2, 2021 10:31 AM
> To: Labone, Thomas <labone at email.sc.edu>
> Cc: r-help at r-project.org <r-help at r-project.org>
> Subject: Re: [R] Problem with lm Giving Wrong Results
>
> On the 'bad' machines, what did you get for
>    summary(fit)
>    summary(k)
>    summary(Z)
>    summary(gm*gsd^Z)
> ?
>
> -Bill
>
> On Thu, Dec 2, 2021 at 6:18 AM Labone, Thomas <labone at email.sc.edu<mailto:labone at email.sc.edu>> wrote:
> In the code below the first and second plots should look pretty much the same, the only difference being that the first has n=1000 points and the second n=10000 points. On two of my Linux machines (info below) the second plot is a horizontal line (incorrect answer from lm), but on my Windows 10 machine and a third Linux machine it works as expected. The interesting thing is that the code works as expected for n <= 4095 but fails for n>=4096 (which equals 2^12). Can anyone else reproduce this problem? Any ideas on how to fix it?
>
> set.seed(132)
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> # This works
> n <- 1000# OK <= 4095
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #this does not
> n <- 10000# fails >= 4096 = 2^12
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > sessionInfo() #for two Linux machines having problem
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 20.2
>
> Matrix products: default
> BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2  Matrix_1.3-4    tools_4.1.2     expm_0.999-6    grid_4.1.2      lattice_0.20-45
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > sessionInfo() # for a third Linux machine not having the problem
> R version 4.1.1 (2021-08-10)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 19.3
>
> Matrix products: default
> BLAS/LAPACK: /opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
>  [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.1 tools_4.1.1
>
>
>
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



--
Sarah Goslee (she/her)
https://protect2.fireeye.com/v1/url?k=c805d788-979eef43-c8059949-86ce7c8b8969-1bd7107f3d9bccca&q=1&e=05c346dc-4f60-4e2e-ada8-1abaa8792515&u=http%3A%2F%2Fwww.numberwright.com%2F

	[[alternative HTML version deleted]]


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Fri Dec  3 21:55:34 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Fri, 3 Dec 2021 12:55:34 -0800 (PST)
Subject: [R] Find tibble row with maximum recorded value
Message-ID: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>

I find solutions when the data_frame is grouped, but none when it's not.

The data:
# A tibble: 813,693 ? 9
    site_nbr  year   mon   day    hr   min tz      cfs sampdt
    <chr>    <int> <int> <int> <dbl> <dbl> <chr> <dbl> <dttm>
  1 14211720  1988    10     1     0    10 PDT   16800 1988-10-01 00:10:00
  2 14211720  1988    10     1     0    20 PDT   16800 1988-10-01 00:20:00
  3 14211720  1988    10     1     0    30 PDT   17300 1988-10-01 00:30:00
  4 14211720  1988    10     1     0    40 PDT   18200 1988-10-01 00:40:00
  5 14211720  1988    10     1     0    50 PDT   18100 1988-10-01 00:50:00
  6 14211720  1988    10     1     1     0 PDT   18400 1988-10-01 01:00:00
  7 14211720  1988    10     1     1    10 PDT   18700 1988-10-01 01:10:00
  8 14211720  1988    10     1     1    20 PDT   19200 1988-10-01 01:20:00
  9 14211720  1988    10     1     1    30 PDT   19200 1988-10-01 01:30:00
10 14211720  1988    10     1     1    40 PDT   18900 1988-10-01 01:40:00
# ? with 813,683 more rows

The script:
library(tidyverse)

max_pdx_disc <- pdx_disc %>%
     summarize(max_cfs = max(cfs), max_cfs_sampdt = cfs(which.max(cfs)))

The error:
> source('../scripts/filter_by_column_max.r') 
Error: Problem with `summarise()` column `max_cfs_sampdt`.
  `max_cfs_sampdt = sampt(which.max(cfs))`.
  could not find function "sampt"
> Run `rlang::last_error()` to see where the error occurred.

I looked at the the last_error and the traceback without understanding how
to filter the row with the maximum cfs value.

What do I read to learn how to return this row?

TIA,

Rich


From bgunter@4567 @end|ng |rom gm@||@com  Fri Dec  3 22:21:34 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 3 Dec 2021 13:21:34 -0800
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
Message-ID: <CAGxFJbQ1fKUteG3yAGjB-CA+vHqoiMYg_nxAMT1rsFbsgQwKwA@mail.gmail.com>

which.max(dat$cfs), I presume.
see ?which.max

(as usual, true tidyverse questions belong on RStudio's help site, not here).

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Fri, Dec 3, 2021 at 12:56 PM Rich Shepard <rshepard at appl-ecosys.com> wrote:
>
> I find solutions when the data_frame is grouped, but none when it's not.
>
> The data:
> # A tibble: 813,693 ? 9
>     site_nbr  year   mon   day    hr   min tz      cfs sampdt
>     <chr>    <int> <int> <int> <dbl> <dbl> <chr> <dbl> <dttm>
>   1 14211720  1988    10     1     0    10 PDT   16800 1988-10-01 00:10:00
>   2 14211720  1988    10     1     0    20 PDT   16800 1988-10-01 00:20:00
>   3 14211720  1988    10     1     0    30 PDT   17300 1988-10-01 00:30:00
>   4 14211720  1988    10     1     0    40 PDT   18200 1988-10-01 00:40:00
>   5 14211720  1988    10     1     0    50 PDT   18100 1988-10-01 00:50:00
>   6 14211720  1988    10     1     1     0 PDT   18400 1988-10-01 01:00:00
>   7 14211720  1988    10     1     1    10 PDT   18700 1988-10-01 01:10:00
>   8 14211720  1988    10     1     1    20 PDT   19200 1988-10-01 01:20:00
>   9 14211720  1988    10     1     1    30 PDT   19200 1988-10-01 01:30:00
> 10 14211720  1988    10     1     1    40 PDT   18900 1988-10-01 01:40:00
> # ? with 813,683 more rows
>
> The script:
> library(tidyverse)
>
> max_pdx_disc <- pdx_disc %>%
>      summarize(max_cfs = max(cfs), max_cfs_sampdt = cfs(which.max(cfs)))
>
> The error:
> > source('../scripts/filter_by_column_max.r')
> Error: Problem with `summarise()` column `max_cfs_sampdt`.
>   `max_cfs_sampdt = sampt(which.max(cfs))`.
>   could not find function "sampt"
> > Run `rlang::last_error()` to see where the error occurred.
>
> I looked at the the last_error and the traceback without understanding how
> to filter the row with the maximum cfs value.
>
> What do I read to learn how to return this row?
>
> TIA,
>
> Rich
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Dec  3 22:46:27 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 03 Dec 2021 13:46:27 -0800
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
Message-ID: <195122AB-777B-4AAE-8D08-DFA54B1DDF70@dcn.davis.ca.us>

cfs is not a function. Don't put parentheses next to it. Use square brackets for indexing.

On December 3, 2021 12:55:34 PM PST, Rich Shepard <rshepard at appl-ecosys.com> wrote:
>I find solutions when the data_frame is grouped, but none when it's not.
>
>The data:
># A tibble: 813,693 ? 9
>    site_nbr  year   mon   day    hr   min tz      cfs sampdt
>    <chr>    <int> <int> <int> <dbl> <dbl> <chr> <dbl> <dttm>
>  1 14211720  1988    10     1     0    10 PDT   16800 1988-10-01 00:10:00
>  2 14211720  1988    10     1     0    20 PDT   16800 1988-10-01 00:20:00
>  3 14211720  1988    10     1     0    30 PDT   17300 1988-10-01 00:30:00
>  4 14211720  1988    10     1     0    40 PDT   18200 1988-10-01 00:40:00
>  5 14211720  1988    10     1     0    50 PDT   18100 1988-10-01 00:50:00
>  6 14211720  1988    10     1     1     0 PDT   18400 1988-10-01 01:00:00
>  7 14211720  1988    10     1     1    10 PDT   18700 1988-10-01 01:10:00
>  8 14211720  1988    10     1     1    20 PDT   19200 1988-10-01 01:20:00
>  9 14211720  1988    10     1     1    30 PDT   19200 1988-10-01 01:30:00
>10 14211720  1988    10     1     1    40 PDT   18900 1988-10-01 01:40:00
># ? with 813,683 more rows
>
>The script:
>library(tidyverse)
>
>max_pdx_disc <- pdx_disc %>%
>     summarize(max_cfs = max(cfs), max_cfs_sampdt = cfs(which.max(cfs)))
>
>The error:
>> source('../scripts/filter_by_column_max.r') 
>Error: Problem with `summarise()` column `max_cfs_sampdt`.
>  `max_cfs_sampdt = sampt(which.max(cfs))`.
>  could not find function "sampt"
>> Run `rlang::last_error()` to see where the error occurred.
>
>I looked at the the last_error and the traceback without understanding how
>to filter the row with the maximum cfs value.
>
>What do I read to learn how to return this row?
>
>TIA,
>
>Rich
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Fri Dec  3 22:50:30 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Fri, 3 Dec 2021 13:50:30 -0800 (PST)
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <195122AB-777B-4AAE-8D08-DFA54B1DDF70@dcn.davis.ca.us>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
 <195122AB-777B-4AAE-8D08-DFA54B1DDF70@dcn.davis.ca.us>
Message-ID: <652ed27f-4936-d722-7eb8-89c1680704@appl-ecosys.com>

On Fri, 3 Dec 2021, Jeff Newmiller wrote:

> cfs is not a function. Don't put parentheses next to it. Use square
> brackets for indexing.

Jeff,

Thanks.

Rich


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Fri Dec  3 23:08:54 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Fri, 3 Dec 2021 14:08:54 -0800 (PST)
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
Message-ID: <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>

On Fri, 3 Dec 2021, Rich Shepard wrote:

> I find solutions when the data_frame is grouped, but none when it's not.

Thanks, Bert. ?which.max confirmed that's all I need to find the maximum
value.

Now I need to read more than ?filter to learn why I'm not getting the
relevant row with:
> which.max(pdx_disc$cfs)
[1] 8054

> filter(pdx_disc, cfs == 8054)
# A tibble: 0 ? 9
# ? with 9 variables: site_nbr <chr>, year <int>, mon <int>, day <int>,
#   hr <dbl>, min <dbl>, tz <chr>, cfs <dbl>, sampdt <dttm>

Regards,

Rich


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Fri Dec  3 23:56:21 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Fri, 3 Dec 2021 22:56:21 +0000
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
 <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>
Message-ID: <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>

Hello,

Inline.

?s 22:08 de 03/12/21, Rich Shepard escreveu:
> On Fri, 3 Dec 2021, Rich Shepard wrote:
> 
>> I find solutions when the data_frame is grouped, but none when it's not.
> 
> Thanks, Bert. ?which.max confirmed that's all I need to find the maximum
> value.
> 
> Now I need to read more than ?filter to learn why I'm not getting the
> relevant row with:
>> which.max(pdx_disc$cfs)
> [1] 8054

This is the *index* for which cfs is the first maximum, not the maximum 
value itself.

> 
>> filter(pdx_disc, cfs == 8054)

Therefore, you probably want any of


filter(pdx_disc, cfs == cfs[8054])

filter(pdx_disc, cfs == cfs[which.max(cfs)])

filter(pdx_disc, cfs == max(cfs))    # I find this one better, simpler


Hope this helps,

Rui Barradas


> # A tibble: 0 ? 9
> # ? with 9 variables: site_nbr <chr>, year <int>, mon <int>, day <int>,
> #?? hr <dbl>, min <dbl>, tz <chr>, cfs <dbl>, sampdt <dttm>
> 
> Regards,
> 
> Rich
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Sat Dec  4 00:06:28 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Fri, 3 Dec 2021 15:06:28 -0800 (PST)
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
 <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>
 <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>
Message-ID: <8ec7c17c-638f-2bd1-f771-e277d51f618f@appl-ecosys.com>

On Fri, 3 Dec 2021, Rui Barradas wrote:

>> which.max(pdx_disc$cfs)
>> [1] 8054

> This is the *index* for which cfs is the first maximum, not the maximum
> value itself.

Rui,

Mea culpa! I completely forgot this.

> Therefore, you probably want any of
> filter(pdx_disc, cfs == cfs[8054])
> filter(pdx_disc, cfs == cfs[which.max(cfs)])
> filter(pdx_disc, cfs == max(cfs))    # I find this one better, simpler

> Hope this helps,

Yes, it does.

Thank you very much,

Rich


From bgunter@4567 @end|ng |rom gm@||@com  Sat Dec  4 00:27:34 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 3 Dec 2021 15:27:34 -0800
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
 <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>
 <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>
Message-ID: <CAGxFJbRzabmD3vg--iTA985cFcd9C2QXihGze0qjLEgRmeQFOw@mail.gmail.com>

Perhaps you meant to point this out, but the cfs[which.max(cfs)] and
cfs == ... are not the same:

> x <- rep(1:2,3)
> x
[1] 1 2 1 2 1 2
> x[which.max(x)]
[1] 2
> x[x==max(x)]
[1] 2 2 2

So maybe your point is: which does the OP want (in case there are
repeated maxes)? I suspect the == forms, but ...?

Bert Gunter

On Fri, Dec 3, 2021 at 2:56 PM Rui Barradas <ruipbarradas at sapo.pt> wrote:
>
> Hello,
>
> Inline.
>
> ?s 22:08 de 03/12/21, Rich Shepard escreveu:
> > On Fri, 3 Dec 2021, Rich Shepard wrote:
> >
> >> I find solutions when the data_frame is grouped, but none when it's not.
> >
> > Thanks, Bert. ?which.max confirmed that's all I need to find the maximum
> > value.
> >
> > Now I need to read more than ?filter to learn why I'm not getting the
> > relevant row with:
> >> which.max(pdx_disc$cfs)
> > [1] 8054
>
> This is the *index* for which cfs is the first maximum, not the maximum
> value itself.
>
> >
> >> filter(pdx_disc, cfs == 8054)
>
> Therefore, you probably want any of
>
>
> filter(pdx_disc, cfs == cfs[8054])
>
> filter(pdx_disc, cfs == cfs[which.max(cfs)])
>
> filter(pdx_disc, cfs == max(cfs))    # I find this one better, simpler
>
>
> Hope this helps,
>
> Rui Barradas
>
>
> > # A tibble: 0 ? 9
> > # ? with 9 variables: site_nbr <chr>, year <int>, mon <int>, day <int>,
> > #   hr <dbl>, min <dbl>, tz <chr>, cfs <dbl>, sampdt <dttm>
> >
> > Regards,
> >
> > Rich
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Sat Dec  4 00:59:01 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Fri, 3 Dec 2021 15:59:01 -0800 (PST)
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <CAGxFJbRzabmD3vg--iTA985cFcd9C2QXihGze0qjLEgRmeQFOw@mail.gmail.com>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
 <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>
 <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>
 <CAGxFJbRzabmD3vg--iTA985cFcd9C2QXihGze0qjLEgRmeQFOw@mail.gmail.com>
Message-ID: <dcdb237c-a7da-da8-ef6c-1dd79266167e@appl-ecosys.com>

On Fri, 3 Dec 2021, Bert Gunter wrote:

> Perhaps you meant to point this out, but the cfs[which.max(cfs)] and
> cfs == ... are not the same:
>
>> x <- rep(1:2,3)
>> x
> [1] 1 2 1 2 1 2
>> x[which.max(x)]
> [1] 2
>> x[x==max(x)]
> [1] 2 2 2
>
> So maybe your point is: which does the OP want (in case there are
> repeated maxes)? I suspect the == forms, but ...?

Bert,

When I looked at the results I saw there were many rows with the maximum
(and minimum) values. I thought those represented instrument limits, and
they apparently do. For example, 99.9000 cubic feet per second is reached
multiple times over the past 32 years.

> max(pdx_disc$cfs)
[1] 99900

and

> filter(pdx_disc, cfs == max(cfs))
# A tibble: 74 ? 9
    site_nbr  year   mon   day    hr   min tz      cfs sampdt
    <chr>    <int> <int> <int> <dbl> <dbl> <chr> <dbl> <dttm>
  1 14211720  1988    11    28     0     0 PST   99900 1988-11-28 00:00:00
  2 14211720  1988    11    28     5     0 PST   99900 1988-11-28 05:00:00
  3 14211720  1988    11    28     5    10 PST   99900 1988-11-28 05:10:00
  4 14211720  1988    11    28     5    20 PST   99900 1988-11-28 05:20:00
  5 14211720  1988    11    29     6    20 PST   99900 1988-11-29 06:20:00
  6 14211720  1988    11    29    13     0 PST   99900 1988-11-29 13:00:00
  7 14211720  1988    11    29    13    10 PST   99900 1988-11-29 13:10:00
  8 14211720  1988    11    29    15    20 PST   99900 1988-11-29 15:20:00
  9 14211720  1989     1    11     0     0 PST   99900 1989-01-11 00:00:00
10 14211720  1989     1    11     0    10 PST   99900 1989-01-11 00:10:00
# ? with 64 more rows

So the gauge was pegged at its top end quite a few times over the years.
Makes me wonder just how much higher really was.

Carpe weekend,

Rich


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Sat Dec  4 01:03:15 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Fri, 3 Dec 2021 16:03:15 -0800 (PST)
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <dcdb237c-a7da-da8-ef6c-1dd79266167e@appl-ecosys.com>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
 <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>
 <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>
 <CAGxFJbRzabmD3vg--iTA985cFcd9C2QXihGze0qjLEgRmeQFOw@mail.gmail.com>
 <dcdb237c-a7da-da8-ef6c-1dd79266167e@appl-ecosys.com>
Message-ID: <78a9e35b-bfd9-c153-189e-f57bcec97ef8@appl-ecosys.com>

On Fri, 3 Dec 2021, Rich Shepard wrote:

> they apparently do. For example, 99.9000 cubic feet per second is reached
                                    99,900

Rich


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Dec  4 08:33:46 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 4 Dec 2021 07:33:46 +0000
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <CAGxFJbRzabmD3vg--iTA985cFcd9C2QXihGze0qjLEgRmeQFOw@mail.gmail.com>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
 <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>
 <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>
 <CAGxFJbRzabmD3vg--iTA985cFcd9C2QXihGze0qjLEgRmeQFOw@mail.gmail.com>
Message-ID: <625d5058-e9a5-00a7-9ffc-8810dcd45d54@sapo.pt>

Hello,

You're right, I carelessly coded this.

which.max returns the index to the first maximum of a vector, while the 
comparison of a vector with its max() returns an index to all vector 
elements.

?s 23:27 de 03/12/21, Bert Gunter escreveu:
> Perhaps you meant to point this out, but the cfs[which.max(cfs)] and
> cfs == ... are not the same:
> 
>> x <- rep(1:2,3)
>> x
> [1] 1 2 1 2 1 2
>> x[which.max(x)]
> [1] 2
>> x[x==max(x)]
> [1] 2 2 2
> 
> So maybe your point is: which does the OP want (in case there are
> repeated maxes)? I suspect the == forms, but ...?
> 
> Bert Gunter
> 
> On Fri, Dec 3, 2021 at 2:56 PM Rui Barradas <ruipbarradas at sapo.pt> wrote:
>>
>> Hello,
>>
>> Inline.
>>
>> ?s 22:08 de 03/12/21, Rich Shepard escreveu:
>>> On Fri, 3 Dec 2021, Rich Shepard wrote:
>>>
>>>> I find solutions when the data_frame is grouped, but none when it's not.
>>>
>>> Thanks, Bert. ?which.max confirmed that's all I need to find the maximum
>>> value.
>>>
>>> Now I need to read more than ?filter to learn why I'm not getting the
>>> relevant row with:
>>>> which.max(pdx_disc$cfs)
>>> [1] 8054
>>
>> This is the *index* for which cfs is the first maximum, not the maximum
>> value itself.
>>
>>>
>>>> filter(pdx_disc, cfs == 8054)
>>
>> Therefore, you probably want any of

Should be "one of", not "any of"

Rui Barradas

>>
>>
>> filter(pdx_disc, cfs == cfs[8054])
>>
>> filter(pdx_disc, cfs == cfs[which.max(cfs)])
>>
>> filter(pdx_disc, cfs == max(cfs))    # I find this one better, simpler
>>
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>>
>>> # A tibble: 0 ? 9
>>> # ? with 9 variables: site_nbr <chr>, year <int>, mon <int>, day <int>,
>>> #   hr <dbl>, min <dbl>, tz <chr>, cfs <dbl>, sampdt <dttm>
>>>
>>> Regards,
>>>
>>> Rich
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From @orenh @end|ng |rom m@th@@@u@dk  Sat Dec  4 16:54:57 2021
From: @orenh @end|ng |rom m@th@@@u@dk (=?utf-8?B?U8O4cmVuIEjDuGpzZ2FhcmQ=?=)
Date: Sat, 4 Dec 2021 15:54:57 +0000
Subject: [R] Handling dependencies on Bioconductor packages for packages on
 CRAN
Message-ID: <a77815a906d885f112e8d21d96bcb016785cf977.camel@math.aau.dk>

Dear all

My gRbase package imports the packages from Bioconductor: graph, RBGL and Rgraphviz

If these packages are not installed, then gRbase can not be installed. The error message is:

   ERROR: dependency ?graph? is not available for package ?gRbase?

If I, prior to installation, run setRepositories and highlight 'BioC software', then gRbase installs as it should, because the graph package from Bioconductor is installed along with it. However, this extra step is an obstacle to many users of the package which means that either people do not use the package or people ask questions about this issue on stack overflow, R-help, by email to me etc. It is not a problem to get the package on CRAN because, I guess, the CRAN check machines already have the three bioconductor packages installed.

Therefore, I wonder if there is a way of specifying, in the DESCRIPTION file or elsewhere, that these packages should be installed automatically from bioconductor.

An alternative would be if one could force the error message

   ERROR: dependency ?graph? is not available for package ?gRbase?

to be accompanied by a message about what the user then should do.

Any good suggestions? Thanks in advance.

Best regards
S?ren

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Sat Dec  4 16:59:27 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 4 Dec 2021 07:59:27 -0800
Subject: [R] 
 Handling dependencies on Bioconductor packages for packages on CRAN
In-Reply-To: <a77815a906d885f112e8d21d96bcb016785cf977.camel@math.aau.dk>
References: <a77815a906d885f112e8d21d96bcb016785cf977.camel@math.aau.dk>
Message-ID: <CAGxFJbQAo2NZGn4jVjRkZ-1dnZpYCM=LWTy_qOZk-SoU9gnPww@mail.gmail.com>

I suggest you post this on r-package-devel.  That seems a better fit.

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Sat, Dec 4, 2021 at 7:55 AM S?ren H?jsgaard <sorenh at math.aau.dk> wrote:

> Dear all
>
> My gRbase package imports the packages from Bioconductor: graph, RBGL and
> Rgraphviz
>
> If these packages are not installed, then gRbase can not be installed. The
> error message is:
>
>    ERROR: dependency ?graph? is not available for package ?gRbase?
>
> If I, prior to installation, run setRepositories and highlight 'BioC
> software', then gRbase installs as it should, because the graph package
> from Bioconductor is installed along with it. However, this extra step is
> an obstacle to many users of the package which means that either people do
> not use the package or people ask questions about this issue on stack
> overflow, R-help, by email to me etc. It is not a problem to get the
> package on CRAN because, I guess, the CRAN check machines already have the
> three bioconductor packages installed.
>
> Therefore, I wonder if there is a way of specifying, in the DESCRIPTION
> file or elsewhere, that these packages should be installed automatically
> from bioconductor.
>
> An alternative would be if one could force the error message
>
>    ERROR: dependency ?graph? is not available for package ?gRbase?
>
> to be accompanied by a message about what the user then should do.
>
> Any good suggestions? Thanks in advance.
>
> Best regards
> S?ren
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @v|gro@@ @end|ng |rom ver|zon@net  Sat Dec  4 18:39:47 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Sat, 4 Dec 2021 12:39:47 -0500
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <625d5058-e9a5-00a7-9ffc-8810dcd45d54@sapo.pt>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
 <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>
 <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>
 <CAGxFJbRzabmD3vg--iTA985cFcd9C2QXihGze0qjLEgRmeQFOw@mail.gmail.com>
 <625d5058-e9a5-00a7-9ffc-8810dcd45d54@sapo.pt>
Message-ID: <01d401d7e935$eed11fa0$cc735ee0$@verizon.net>

The right answer obviously depends on the REQUIREMENTS and they may not have been fully stated.

This is a bit like finding the mode of a set of numbers. The most frequent value may not be as representative of the data as the mean or even the median for some purposes, as well as other measures of central tendency.

What does Rich want? Choices can include getting the entire row where the value happens first, or maybe even the last or ALL of them as a group.

Be that as it may, if you return all of them, as a mini-data.frame, it is easy enough to then choose to keep them all, or just the first by subsetting  it to get row 1, or even to get the last row by applying nrow() to the result.

I can think of many ways you want an answer including beyond this, some kind of blending of the other columns you get back to make some kind of composite row from all the rows that matched.

Without clear requirements, there often is no right answer.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Rui Barradas
Sent: Saturday, December 4, 2021 2:34 AM
To: Bert Gunter <bgunter.4567 at gmail.com>
Cc: R-help <r-help at r-project.org>
Subject: Re: [R] Find tibble row with maximum recorded value

Hello,

You're right, I carelessly coded this.

which.max returns the index to the first maximum of a vector, while the comparison of a vector with its max() returns an index to all vector elements.

?s 23:27 de 03/12/21, Bert Gunter escreveu:
> Perhaps you meant to point this out, but the cfs[which.max(cfs)] and 
> cfs == ... are not the same:
> 
>> x <- rep(1:2,3)
>> x
> [1] 1 2 1 2 1 2
>> x[which.max(x)]
> [1] 2
>> x[x==max(x)]
> [1] 2 2 2
> 
> So maybe your point is: which does the OP want (in case there are 
> repeated maxes)? I suspect the == forms, but ...?
> 
> Bert Gunter
> 
> On Fri, Dec 3, 2021 at 2:56 PM Rui Barradas <ruipbarradas at sapo.pt> wrote:
>>
>> Hello,
>>
>> Inline.
>>
>> ?s 22:08 de 03/12/21, Rich Shepard escreveu:
>>> On Fri, 3 Dec 2021, Rich Shepard wrote:
>>>
>>>> I find solutions when the data_frame is grouped, but none when it's not.
>>>
>>> Thanks, Bert. ?which.max confirmed that's all I need to find the 
>>> maximum value.
>>>
>>> Now I need to read more than ?filter to learn why I'm not getting 
>>> the relevant row with:
>>>> which.max(pdx_disc$cfs)
>>> [1] 8054
>>
>> This is the *index* for which cfs is the first maximum, not the 
>> maximum value itself.
>>
>>>
>>>> filter(pdx_disc, cfs == 8054)
>>
>> Therefore, you probably want any of

Should be "one of", not "any of"

Rui Barradas

>>
>>
>> filter(pdx_disc, cfs == cfs[8054])
>>
>> filter(pdx_disc, cfs == cfs[which.max(cfs)])
>>
>> filter(pdx_disc, cfs == max(cfs))    # I find this one better, simpler
>>
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>>
>>> # A tibble: 0 ? 9
>>> # ? with 9 variables: site_nbr <chr>, year <int>, mon <int>, day <int>,
>>> #   hr <dbl>, min <dbl>, tz <chr>, cfs <dbl>, sampdt <dttm>
>>>
>>> Regards,
>>>
>>> Rich
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From S@ndhy@pr@k@@hyj97 @end|ng |rom out|ook@com  Mon Dec  6 14:33:50 2021
From: S@ndhy@pr@k@@hyj97 @end|ng |rom out|ook@com (Sandhya Prakash)
Date: Mon, 6 Dec 2021 13:33:50 +0000
Subject: [R] 
 Error: the leading minor of order 6 is not positive definite
In-Reply-To: <CAKZQJMA=+jz9iUG0HTByTo3m_dbnZg+teVEq6ArM42duL5c46A@mail.gmail.com>
References: <HKAPR01MB373096AF40371243EF9A3BB2DB819@HKAPR01MB3730.apcprd01.prod.exchangelabs.com>
 <CAKZQJMA=+jz9iUG0HTByTo3m_dbnZg+teVEq6ArM42duL5c46A@mail.gmail.com>
Message-ID: <HKAPR01MB3730E255A1788C0E888DE88ADB6D9@HKAPR01MB3730.apcprd01.prod.exchangelabs.com>

I will look into it sir if I don't get it I'll mail my code sir thakyou for your reply sir

Get Outlook for Android<https://aka.ms/AAb9ysg>
________________________________
From: John Kane <jrkrideau at gmail.com>
Sent: Thursday, October 28, 2021 9:27:06 PM
To: Sandhya Prakash <sandhyaprakashyj97 at outlook.com>
Cc: r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] Error: the leading minor of order 6 is not positive definite

I think we need the code you are running, any error messages you are
getting and some sample data. A handy way to supply sample data is to
use the dput() function. See ?dput.  If you have a very large data set
then something like head(dput(myfile), 100) will likely supply enough
data for us to work with.

On Mon, 25 Oct 2021 at 16:26, Sandhya Prakash
<Sandhyaprakashyj97 at outlook.com> wrote:
>
> Hi I'm too running a canonical correlation code but I'm getting my error like this can you please help me
>
> Get Outlook for Android<https://aka.ms/AAb9ysg>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



--
John Kane
Kingston ON Canada

	[[alternative HTML version deleted]]


From y@ngk@|9999 @end|ng |rom y@hoo@com  Mon Dec  6 18:32:20 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Mon, 6 Dec 2021 17:32:20 +0000 (UTC)
Subject: [R] GTsummary add title with multi row
References: <1243221180.3311066.1638811940179.ref@mail.yahoo.com>
Message-ID: <1243221180.3311066.1638811940179@mail.yahoo.com>

Hi R team,When I use GTsummary to run summary table, I can add table title by using?modify_caption() function. But it is one row title only.Is it possible to add title with multi rows for one summary table?Thanks,Kai
	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Mon Dec  6 18:47:29 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 6 Dec 2021 09:47:29 -0800
Subject: [R] GTsummary add title with multi row
In-Reply-To: <1243221180.3311066.1638811940179@mail.yahoo.com>
References: <1243221180.3311066.1638811940179.ref@mail.yahoo.com>
 <1243221180.3311066.1638811940179@mail.yahoo.com>
Message-ID: <CAGxFJbTU0pAD5ObCPZeMpis2-AY+u9TP3K7Dk7qsKJ4waqLjZw@mail.gmail.com>

Please read and follow the Posting Guide linked below, which says, among
other things:

"For questions about functions in standard packages distributed with R (see
the FAQ Add-on packages in R), ask questions on R-help.
[The link is:
https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
This gives the list of current _standard_ packages]

If the question relates to a contributed package , e.g., one downloaded
from CRAN, try contacting the package maintainer first. You can also use
find("functionname") and packageDescription("packagename") to find this
information. Only send such questions to R-help or R-devel if you get no
reply or need further assistance. This applies to both requests for help
and to bug reports."

Note that RStudio maintains its own help resources at:
https://community.rstudio.com/
This is where questions about the TidyVerse, ggplot, etc. should be posted.


Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Mon, Dec 6, 2021 at 9:32 AM Kai Yang via R-help <r-help at r-project.org>
wrote:

> Hi R team,When I use GTsummary to run summary table, I can add table title
> by using modify_caption() function. But it is one row title only.Is it
> possible to add title with multi rows for one summary table?Thanks,Kai
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ||809 @end|ng |rom nc|@c@  Tue Dec  7 01:33:25 2021
From: ||809 @end|ng |rom nc|@c@ (Brian Lunergan)
Date: Mon, 6 Dec 2021 19:33:25 -0500
Subject: [R] Puzzled about loading the Rattle interface package...
Message-ID: <bbc71d93-80c5-1ca2-2d24-ef21bdba417a@ncf.ca>

Evening folks:

Hope I'm in the right place to ask this.

Running R 4.1.2 on Linux Mint 19.3. I do have R Commander and R Studio
in place and working, so I'm not without choices for a GUI to use R.
However, I wanted to try out the Rattle interface.

The package installs OK, but it apparently needs the RGtk2 package to
run its graphic state. When I try to install that package I get the
following:

> install.packages("RGtk2")
Installing package into ?/home/brian/R/x86_64-pc-linux-gnu-library/4.1?
(as ?lib? is unspecified)
trying URL 'https://cloud.r-project.org/src/contrib/RGtk2_2.20.36.2.tar.gz'
Content type 'application/x-gzip' length 2792234 bytes (2.7 MB)
==================================================
downloaded 2.7 MB

* installing *source* package ?RGtk2? ...
** package ?RGtk2? successfully unpacked and MD5 sums checked
** using staged installation
checking for pkg-config... /usr/bin/pkg-config
checking pkg-config is at least version 0.9.0... yes
checking for INTROSPECTION... no
checking for GTK... no
configure: error: GTK version 2.8.0 required
ERROR: configuration failed for package ?RGtk2?
* removing ?/home/brian/R/x86_64-pc-linux-gnu-library/4.1/RGtk2?

The downloaded source packages are in
	?/tmp/Rtmphfaxc3/downloaded_packages?
Warning message:
In install.packages("RGtk2") :
  installation of package ?RGtk2? had non-zero exit status
>

I'm at a bit of a loss as to how to solve this. Any help would be
appreciated. Otherwise, I guess I'd be SOL for trying it out and fall
back to my existing two options.

Thanks...
-- 
Brian Lunergan
Russell, ON
Canada




-------------- next part --------------
A non-text attachment was scrubbed...
Name: OpenPGP_signature
Type: application/pgp-signature
Size: 665 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20211206/c3d758ba/attachment.sig>

From er|cjberger @end|ng |rom gm@||@com  Tue Dec  7 12:34:59 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Tue, 7 Dec 2021 13:34:59 +0200
Subject: [R] Puzzled about loading the Rattle interface package...
In-Reply-To: <bbc71d93-80c5-1ca2-2d24-ef21bdba417a@ncf.ca>
References: <bbc71d93-80c5-1ca2-2d24-ef21bdba417a@ncf.ca>
Message-ID: <CAGgJW75gDVELg-gXmMTeX0vKjZ-YMA42wfvVrpakXeyQ05O5Sg@mail.gmail.com>

Hi Brian,
I have never tried Rattle but I did a quick search and found this link
which might give some clues.

https://book.huihoo.com/data-mining-desktop-survival-guide/Installing_GTK.html

Good luck,
Eric


On Tue, Dec 7, 2021 at 1:29 PM Brian Lunergan <ff809 at ncf.ca> wrote:
>
> Evening folks:
>
> Hope I'm in the right place to ask this.
>
> Running R 4.1.2 on Linux Mint 19.3. I do have R Commander and R Studio
> in place and working, so I'm not without choices for a GUI to use R.
> However, I wanted to try out the Rattle interface.
>
> The package installs OK, but it apparently needs the RGtk2 package to
> run its graphic state. When I try to install that package I get the
> following:
>
> > install.packages("RGtk2")
> Installing package into ?/home/brian/R/x86_64-pc-linux-gnu-library/4.1?
> (as ?lib? is unspecified)
> trying URL 'https://cloud.r-project.org/src/contrib/RGtk2_2.20.36.2.tar.gz'
> Content type 'application/x-gzip' length 2792234 bytes (2.7 MB)
> ==================================================
> downloaded 2.7 MB
>
> * installing *source* package ?RGtk2? ...
> ** package ?RGtk2? successfully unpacked and MD5 sums checked
> ** using staged installation
> checking for pkg-config... /usr/bin/pkg-config
> checking pkg-config is at least version 0.9.0... yes
> checking for INTROSPECTION... no
> checking for GTK... no
> configure: error: GTK version 2.8.0 required
> ERROR: configuration failed for package ?RGtk2?
> * removing ?/home/brian/R/x86_64-pc-linux-gnu-library/4.1/RGtk2?
>
> The downloaded source packages are in
>         ?/tmp/Rtmphfaxc3/downloaded_packages?
> Warning message:
> In install.packages("RGtk2") :
>   installation of package ?RGtk2? had non-zero exit status
> >
>
> I'm at a bit of a loss as to how to solve this. Any help would be
> appreciated. Otherwise, I guess I'd be SOL for trying it out and fall
> back to my existing two options.
>
> Thanks...
> --
> Brian Lunergan
> Russell, ON
> Canada
>
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kry|ov@r00t @end|ng |rom gm@||@com  Tue Dec  7 12:44:50 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Tue, 7 Dec 2021 14:44:50 +0300
Subject: [R] Puzzled about loading the Rattle interface package...
In-Reply-To: <bbc71d93-80c5-1ca2-2d24-ef21bdba417a@ncf.ca>
References: <bbc71d93-80c5-1ca2-2d24-ef21bdba417a@ncf.ca>
Message-ID: <20211207144450.12c98795@arachnoid>

On Mon, 6 Dec 2021 19:33:25 -0500
Brian Lunergan <ff809 at ncf.ca> wrote:

> Running R 4.1.2 on Linux Mint 19.3.

> configure: error: GTK version 2.8.0 required

Thanks for mentioning your GNU/Linux distro! You need the libgtk2.0-dev
APT package installed in order to build the RGtk2 R package from
source. Alternatively, if you use the distro-built R (installed via
APT), you can install the r-cran-rgtk2 APT package and avoid building
the RGtk2 package from source.
 
Ask in the R-SIG-Debian mailing list if your problems continue.

-- 
Best regards,
Ivan


From mtmorg@n@b|oc @end|ng |rom gm@||@com  Tue Dec  7 23:23:25 2021
From: mtmorg@n@b|oc @end|ng |rom gm@||@com (Martin Morgan)
Date: Tue, 7 Dec 2021 22:23:25 +0000
Subject: [R] 
 Handling dependencies on Bioconductor packages for packages on CRAN
In-Reply-To: <a77815a906d885f112e8d21d96bcb016785cf977.camel@math.aau.dk>
References: <a77815a906d885f112e8d21d96bcb016785cf977.camel@math.aau.dk>
Message-ID: <BN8PR04MB6241A598EBC14229670AF759F96E9@BN8PR04MB6241.namprd04.prod.outlook.com>

One possibility is to make graph a Suggests: dependency, and preface any code using it (or, e.g., in an .onLoad function) with

  if (!requireNamespace("graph", quietly = TRUE))
    stop(
      "install the Bioconductor 'graph' package using these commands\n\n",
      ## standard Bioconductor package installation instructions
      "  if (!requireNamespace('BiocManager', quiety = TRUE))\n",
      "    install.packages('BiocManager')\n",
      "  BiocManager::install('graph')\n\n"
    )

Use graph:: for any function used in the graph package. The code could be simplified if BiocManager were an Imports: dependency of your package -- it would already be installed. The 'Suggests:' dependency would not cause problems with CRAN, because Suggest'ed packages are available when the package is built / checked.

The user experience of package installation would be 'non-standard' (didn't I just install gRbase??), so this is not an ideal solution.

Martin

?On 12/4/21, 10:55 AM, "R-help on behalf of S?ren H?jsgaard" <r-help-bounces at r-project.org on behalf of sorenh at math.aau.dk> wrote:

    Dear all

    My gRbase package imports the packages from Bioconductor: graph, RBGL and Rgraphviz

    If these packages are not installed, then gRbase can not be installed. The error message is:

       ERROR: dependency ?graph? is not available for package ?gRbase?

    If I, prior to installation, run setRepositories and highlight 'BioC software', then gRbase installs as it should, because the graph package from Bioconductor is installed along with it. However, this extra step is an obstacle to many users of the package which means that either people do not use the package or people ask questions about this issue on stack overflow, R-help, by email to me etc. It is not a problem to get the package on CRAN because, I guess, the CRAN check machines already have the three bioconductor packages installed.

    Therefore, I wonder if there is a way of specifying, in the DESCRIPTION file or elsewhere, that these packages should be installed automatically from bioconductor.

    An alternative would be if one could force the error message

       ERROR: dependency ?graph? is not available for package ?gRbase?

    to be accompanied by a message about what the user then should do.

    Any good suggestions? Thanks in advance.

    Best regards
    S?ren

    	[[alternative HTML version deleted]]

    ______________________________________________
    R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
    https://stat.ethz.ch/mailman/listinfo/r-help
    PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
    and provide commented, minimal, self-contained, reproducible code.

From ||809 @end|ng |rom nc|@c@  Tue Dec  7 23:43:59 2021
From: ||809 @end|ng |rom nc|@c@ (Brian Lunergan)
Date: Tue, 7 Dec 2021 17:43:59 -0500
Subject: [R] Puzzled about loading the Rattle interface package...
In-Reply-To: <20211207144450.12c98795@arachnoid>
References: <bbc71d93-80c5-1ca2-2d24-ef21bdba417a@ncf.ca>
 <20211207144450.12c98795@arachnoid>
Message-ID: <44d374cb-6d43-a083-1bd9-f59b41e9951c@ncf.ca>

On 2021-12-07 6:44 a.m., Ivan Krylov wrote:
> On Mon, 6 Dec 2021 19:33:25 -0500
> Brian Lunergan <ff809 at ncf.ca> wrote:
> 
>> Running R 4.1.2 on Linux Mint 19.3.
> 
>> configure: error: GTK version 2.8.0 required
> 
> Thanks for mentioning your GNU/Linux distro! You need the libgtk2.0-dev
> APT package installed in order to build the RGtk2 R package from
> source. Alternatively, if you use the distro-built R (installed via
> APT), you can install the r-cran-rgtk2 APT package and avoid building
> the RGtk2 package from sour
Thanks for the note. First step was:

sudo apt-get install libgtk2.0-dev

Requested pkg plus a couple of suggestions installed just fine. Then
fired up R and hit it with:

install.packages("RGtk2")

Request worked just fine. Final moves:

library(rattle)
rattle()

And up pops the interface. I now have 3 well functioning choices for a
GUI for R.

Thanks again for the assist.
-- 
Brian Lunergan
Russell, ON
Canada


-------------- next part --------------
A non-text attachment was scrubbed...
Name: OpenPGP_signature
Type: application/pgp-signature
Size: 665 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20211207/0c600529/attachment.sig>

From kry|ov@r00t @end|ng |rom gm@||@com  Wed Dec  8 14:52:00 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Wed, 8 Dec 2021 16:52:00 +0300
Subject: [R] Forwarding missing arguments to the `[` method
In-Reply-To: <6848253E-EA56-4C2E-B78A-5BDCEA571922@dcn.davis.ca.us>
References: <20211202235711.203958c0@Tarkus> <20211203000001.58aba4d6@Tarkus>
 <6848253E-EA56-4C2E-B78A-5BDCEA571922@dcn.davis.ca.us>
Message-ID: <20211208165200.203ae1f4@arachnoid>

Got some progress on this, but still not sure how to continue. First, a
much more simple script reproducing the behaviour that confuses me:

foo <- function(x, ...) structure(x, class = 'foo')
`[.foo` <- function(x, i, ..., drop = TRUE) {
	print(sys.call())
	print(match.call())
	foo(NextMethod()) # x[] should return an object of class foo
}
`[<-.foo` <- function(x, i, ..., value) {
	print(sys.call())
	print(match.call())
	x[i, ..., drop = FALSE]
	# imagine that we need to perform some checks on the
	# subset of x that we're about to replace
	NextMethod()
}

x <- foo(42)
x[]      # this works
x[] <- 1 # this doesn't

Now, the crucial difference between the x[] and x[] <- 1 calls is that
in the former case, the `i` argument isn't even specified:

x[]
# `[.foo`(x, )
# `[.foo`(x = x)
# [1] 42
# attr(,"class")
# [1] "foo"

While in the latter case, `i` is specified in the x[] call (but
missing):

x[] <- 1
# `[<-.foo`(`*tmp*`, , value = 1)
# `[<-.foo`(x = `*tmp*`, value = 1)
# x[i, ..., drop = FALSE]
# `[.foo`(x = x, i = i, drop = FALSE)
Error in NextMethod() : argument "i" is missing, with no default

What's the best way to forward the arguments from [<-.class methods to
the [.class methods in order to handle cases like x[] properly?

-- 
Best regards,
Ivan


From bgunter@4567 @end|ng |rom gm@||@com  Wed Dec  8 16:57:23 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 8 Dec 2021 07:57:23 -0800
Subject: [R] Forwarding missing arguments to the `[` method
In-Reply-To: <20211208165200.203ae1f4@arachnoid>
References: <20211202235711.203958c0@Tarkus> <20211203000001.58aba4d6@Tarkus>
 <6848253E-EA56-4C2E-B78A-5BDCEA571922@dcn.davis.ca.us>
 <20211208165200.203ae1f4@arachnoid>
Message-ID: <CAGxFJbT7XUYk13i809JLsqkj2gC_ai4zqHb6AJBq3s=CAMMN=w@mail.gmail.com>

I haven't followed this thread, so this may be stupid, but have you
looked at the do.call(`[`,...) idiom? Something like:

 x <- array(1:8, c(2,2,2))
> x
, , 1

     [,1] [,2]
[1,]    1    3
[2,]    2    4

, , 2

     [,1] [,2]
[1,]    5    7
[2,]    6    8

> l <- as.list(rep(TRUE, 2))
> do.call(`[`, c(list(x), l, list(1, drop = TRUE)))
     [,1] [,2]
[1,]    1    3
[2,]    2    4

Feel free to ignore without comment if this is unhelpful.


Bert Gunter

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Wed, Dec 8, 2021 at 5:52 AM Ivan Krylov <krylov.r00t at gmail.com> wrote:
>
> Got some progress on this, but still not sure how to continue. First, a
> much more simple script reproducing the behaviour that confuses me:
>
> foo <- function(x, ...) structure(x, class = 'foo')
> `[.foo` <- function(x, i, ..., drop = TRUE) {
>         print(sys.call())
>         print(match.call())
>         foo(NextMethod()) # x[] should return an object of class foo
> }
> `[<-.foo` <- function(x, i, ..., value) {
>         print(sys.call())
>         print(match.call())
>         x[i, ..., drop = FALSE]
>         # imagine that we need to perform some checks on the
>         # subset of x that we're about to replace
>         NextMethod()
> }
>
> x <- foo(42)
> x[]      # this works
> x[] <- 1 # this doesn't
>
> Now, the crucial difference between the x[] and x[] <- 1 calls is that
> in the former case, the `i` argument isn't even specified:
>
> x[]
> # `[.foo`(x, )
> # `[.foo`(x = x)
> # [1] 42
> # attr(,"class")
> # [1] "foo"
>
> While in the latter case, `i` is specified in the x[] call (but
> missing):
>
> x[] <- 1
> # `[<-.foo`(`*tmp*`, , value = 1)
> # `[<-.foo`(x = `*tmp*`, value = 1)
> # x[i, ..., drop = FALSE]
> # `[.foo`(x = x, i = i, drop = FALSE)
> Error in NextMethod() : argument "i" is missing, with no default
>
> What's the best way to forward the arguments from [<-.class methods to
> the [.class methods in order to handle cases like x[] properly?
>
> --
> Best regards,
> Ivan
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Thu Dec  9 15:47:02 2021
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Thu, 9 Dec 2021 15:47:02 +0100
Subject: [R] Forwarding missing arguments to the `[` method
In-Reply-To: <20211208165200.203ae1f4@arachnoid>
References: <20211202235711.203958c0@Tarkus> <20211203000001.58aba4d6@Tarkus>
 <6848253E-EA56-4C2E-B78A-5BDCEA571922@dcn.davis.ca.us>
 <20211208165200.203ae1f4@arachnoid>
Message-ID: <25010.5862.561615.738945@stat.math.ethz.ch>

>>>>> Ivan Krylov 
>>>>>     on Wed, 8 Dec 2021 16:52:00 +0300 writes:

I have always learnt a lot about programming when reading other
people's code .. notably if those people new what they are
doing.

In this case, studying R-core's

`[.data.frame`  and

`[<-.data.frame`

{or for S4 methods, the 'Matrix' or 'Rmpfr' packages}

should show you a lot.

What you should take from there:
Do work with *both*
    missing(drop)
and
    nargs()

(and more)
in order to distinguish m[i] from m[i,] etc


Best,
Martin


    > Got some progress on this, but still not sure how to continue. First, a
    > much more simple script reproducing the behaviour that confuses me:

> foo <- function(x, ...) structure(x, class = 'foo')
> `[.foo` <- function(x, i, ..., drop = TRUE) {
> 	print(sys.call())
> 	print(match.call())
> 	foo(NextMethod()) # x[] should return an object of class foo
> }
> `[<-.foo` <- function(x, i, ..., value) {
> 	print(sys.call())
> 	print(match.call())
> 	x[i, ..., drop = FALSE]
> 	# imagine that we need to perform some checks on the
> 	# subset of x that we're about to replace
> 	NextMethod()
> }
> 
> x <- foo(42)
> x[]      # this works
> x[] <- 1 # this doesn't
> 
> Now, the crucial difference between the x[] and x[] <- 1 calls is that
> in the former case, the `i` argument isn't even specified:
> 
> x[]
> # `[.foo`(x, )
> # `[.foo`(x = x)
> # [1] 42
> # attr(,"class")
> # [1] "foo"
> 
> While in the latter case, `i` is specified in the x[] call (but
> missing):
> 
> x[] <- 1
> # `[<-.foo`(`*tmp*`, , value = 1)
> # `[<-.foo`(x = `*tmp*`, value = 1)
> # x[i, ..., drop = FALSE]
> # `[.foo`(x = x, i = i, drop = FALSE)
> Error in NextMethod() : argument "i" is missing, with no default
> 
> What's the best way to forward the arguments from [<-.class methods to
> the [.class methods in order to handle cases like x[] properly?
> 
> -- 
> Best regards,
> Ivan
> 
> ______________________________________________


From |ortune4me32 @end|ng |rom gm@||@com  Wed Dec  8 21:19:06 2021
From: |ortune4me32 @end|ng |rom gm@||@com (Ekene Esiaka)
Date: Thu, 9 Dec 2021 00:19:06 +0400
Subject: [R] Error in loading tidyverse library
Message-ID: <CAFx2afecn_6KMohT-Mwo=eFxUsp7Y+Ru=vKydK52C7=7uZWc2w@mail.gmail.com>

Tidyverse cannot load on my rstudio as seen below.

Thanks for your understanding.

From bgunter@4567 @end|ng |rom gm@||@com  Thu Dec  9 21:04:01 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 9 Dec 2021 12:04:01 -0800
Subject: [R] Error in loading tidyverse library
In-Reply-To: <CAFx2afecn_6KMohT-Mwo=eFxUsp7Y+Ru=vKydK52C7=7uZWc2w@mail.gmail.com>
References: <CAFx2afecn_6KMohT-Mwo=eFxUsp7Y+Ru=vKydK52C7=7uZWc2w@mail.gmail.com>
Message-ID: <CAGxFJbR9nrBBezUymMTTNnA7EOn=HENyiERVbQNL9KY=x-mpGw@mail.gmail.com>

1. There is no "below" . Most attachments are stripped by the mail server.

2. Please read and follow the Posting Guide linked below. Your post did not.

3. RStudio is **not** R. In particular, the so-called TidyVerse
consists of all *non*-standard contributed packages, about which the
Posting Guide says:

"For questions about functions in standard packages distributed with R
(see the FAQ Add-on packages in R), ask questions on R-help.
[The link is:
https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
This gives the list of current _standard_ packages]

If the question relates to a contributed package , e.g., one
downloaded from CRAN, try contacting the package maintainer first. You
can also use find("functionname") and
packageDescription("packagename") to find this information. Only send
such questions to R-help or R-devel if you get no reply or need
further assistance. This applies to both requests for help and to bug
reports."

Note that RStudio maintains its own help resources at:
https://community.rstudio.com/
This is where questions about the TidyVerse, ggplot, etc. should be posted.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Thu, Dec 9, 2021 at 11:59 AM Ekene Esiaka <fortune4me32 at gmail.com> wrote:
>
> Tidyverse cannot load on my rstudio as seen below.
>
> Thanks for your understanding.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Dec 10 15:20:39 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 10 Dec 2021 17:20:39 +0300
Subject: [R] Forwarding missing arguments to the `[` method
In-Reply-To: <25010.5862.561615.738945@stat.math.ethz.ch>
References: <20211202235711.203958c0@Tarkus> <20211203000001.58aba4d6@Tarkus>
 <6848253E-EA56-4C2E-B78A-5BDCEA571922@dcn.davis.ca.us>
 <20211208165200.203ae1f4@arachnoid>
 <25010.5862.561615.738945@stat.math.ethz.ch>
Message-ID: <20211210172039.13569c7e@arachnoid>

On Thu, 9 Dec 2021 15:47:02 +0100
Martin Maechler <maechler at stat.math.ethz.ch> wrote:

> What you should take from there:
> Do work with *both*
>     missing(drop)
> and
>     nargs()
> 
> (and more)
> in order to distinguish m[i] from m[i,] etc

Thanks for the advice! `[<-.data.frame` does make for enlightening
reading. 

I've also considered editing the call, like lm() does:

`[<-.foo` <- function(x, i, ..., value) {
	cl <- match.call(expand.dots = FALSE)
	cl[[1L]] <- quote(`[`)
	cl$value <- NULL
	x.subset <- eval(cl, parent.frame())
	# ... checks on x.subset ...
	NextMethod()
}

...but that fails _some_ of my tests (but not others) with "object
`*tmp*` not found"). Non-standard evaluation is probably not the answer
here. I'll have to handle the forms of the call with different nargs()
manually and separately.

-- 
Best regards,
Ivan


From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Sat Dec 11 11:47:21 2021
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Sat, 11 Dec 2021 10:47:21 +0000 (UTC)
Subject: [R] Repeating a R code and counting how many repetitions working
References: <1386111968.1475570.1639219641470.ref@mail.yahoo.com>
Message-ID: <1386111968.1475570.1639219641470@mail.yahoo.com>

Dear R-experts,

Here below my R code. I am trying to do 2 things :

1) I would like to repeat this R code 10000 times

2) Out of the 10000 repetitions I would have liked R to tell me how many times the "true" mean value of the population called "s" in my R example here below is included in the 10000 BCa confidence intervals constructed.

Many thanks for your precious help.

########################################
library(boot)

s= sample(178:798, 10000, replace=TRUE)
mean(s)

a=sample(s,size=5)
mean(a)

dat<-data.frame(a)
med<-function(d,i) {
temp<-d[i,]
mean(temp)

}
boot.out<-boot(data=dat,statistic=med,R=10000)
boot.ci(boot.out,type="bca")
########################################


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Dec 11 12:55:37 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 11 Dec 2021 11:55:37 +0000
Subject: [R] 
 Repeating a R code and counting how many repetitions working
In-Reply-To: <1386111968.1475570.1639219641470@mail.yahoo.com>
References: <1386111968.1475570.1639219641470.ref@mail.yahoo.com>
 <1386111968.1475570.1639219641470@mail.yahoo.com>
Message-ID: <ff36571e-9a5c-6709-81cc-09ab0939f2ef@sapo.pt>

Hello,

The problem can be solved with ?replicate.
in the code below I only repeat N <- 1e3, not 1e4.


set.seed(2021)
N <- 1e3
out <- replicate(N, {
   boot.out <- boot(data = dat, statistic = med, R = 10000)
   boot.ci(boot.out, type = "bca")$bca[, 4:5]
})
mean(out[1,] < mean(s) & mean(s) < out[2,])


Hope this helps,

Rui Barradas

?s 10:47 de 11/12/21, varin sacha via R-help escreveu:
> Dear R-experts,
> 
> Here below my R code. I am trying to do 2 things :
> 
> 1) I would like to repeat this R code 10000 times
> 
> 2) Out of the 10000 repetitions I would have liked R to tell me how many times the "true" mean value of the population called "s" in my R example here below is included in the 10000 BCa confidence intervals constructed.
> 
> Many thanks for your precious help.
> 
> ########################################
> library(boot)
> 
> s= sample(178:798, 10000, replace=TRUE)
> mean(s)
> 
> a=sample(s,size=5)
> mean(a)
> 
> dat<-data.frame(a)
> med<-function(d,i) {
> temp<-d[i,]
> mean(temp)
> 
> }
> boot.out<-boot(data=dat,statistic=med,R=10000)
> boot.ci(boot.out,type="bca")
> ########################################
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Sat Dec 11 16:37:10 2021
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Sat, 11 Dec 2021 15:37:10 +0000 (UTC)
Subject: [R] 
 Repeating a R code and counting how many repetitions working
In-Reply-To: <ff36571e-9a5c-6709-81cc-09ab0939f2ef@sapo.pt>
References: <1386111968.1475570.1639219641470.ref@mail.yahoo.com>
 <1386111968.1475570.1639219641470@mail.yahoo.com>
 <ff36571e-9a5c-6709-81cc-09ab0939f2ef@sapo.pt>
Message-ID: <962792240.1594071.1639237030530@mail.yahoo.com>

Dear Rui,

I really thank you a lot for your response. Even if I don't fully understand your R code, there is something strange happening while running the code.
Indeed, I have run this R code here below 20 times and I always got the same answer : [1] 1

########################################
library(boot)

s= sample(178:798, 10000, replace=TRUE)
mean(s)

a=sample(s,size=5)
mean(a)

dat<-data.frame(a)
med<-function(d,i) {
temp<-d[i,]
mean(temp)
}

N <- 100
out <- replicate(N, {
? boot.out <- boot(data = dat, statistic = med, R = 10000)
? boot.ci(boot.out, type = "bca")$bca[, 4:5]
})
mean(out[1,] < mean(s) & mean(s) < out[2,])
########################################







Le samedi 11 d?cembre 2021, 12:55:43 UTC+1, Rui Barradas <ruipbarradas at sapo.pt> a ?crit : 





Hello,

The problem can be solved with ?replicate.
in the code below I only repeat N <- 1e3, not 1e4.


set.seed(2021)
N <- 1e3
out <- replicate(N, {
? boot.out <- boot(data = dat, statistic = med, R = 10000)
? boot.ci(boot.out, type = "bca")$bca[, 4:5]
})
mean(out[1,] < mean(s) & mean(s) < out[2,])


Hope this helps,

Rui Barradas

?s 10:47 de 11/12/21, varin sacha via R-help escreveu:
> Dear R-experts,
> 
> Here below my R code. I am trying to do 2 things :
> 
> 1) I would like to repeat this R code 10000 times
> 
> 2) Out of the 10000 repetitions I would have liked R to tell me how many times the "true" mean value of the population called "s" in my R example here below is included in the 10000 BCa confidence intervals constructed.
> 
> Many thanks for your precious help.
> 
> ########################################
> library(boot)
> 
> s= sample(178:798, 10000, replace=TRUE)
> mean(s)
> 
> a=sample(s,size=5)
> mean(a)
> 
> dat<-data.frame(a)
> med<-function(d,i) {
> temp<-d[i,]
> mean(temp)
> 
> }
> boot.out<-boot(data=dat,statistic=med,R=10000)
> boot.ci(boot.out,type="bca")
> ########################################
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
> 


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Dec 11 21:29:15 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 11 Dec 2021 20:29:15 +0000
Subject: [R] 
 Repeating a R code and counting how many repetitions working
In-Reply-To: <962792240.1594071.1639237030530@mail.yahoo.com>
References: <1386111968.1475570.1639219641470.ref@mail.yahoo.com>
 <1386111968.1475570.1639219641470@mail.yahoo.com>
 <ff36571e-9a5c-6709-81cc-09ab0939f2ef@sapo.pt>
 <962792240.1594071.1639237030530@mail.yahoo.com>
Message-ID: <832b2c29-10d5-b63c-1d5c-3cb0ea316652@sapo.pt>

Hello,

As for the code, I think it's simple. Before calling boot.ci you need to 
call boot. And replicate calls the expression between {} N times. After 
running boot.ci, the component bca is extracted. See ?boot.ci, section 
Value, after bca:


These latter four components will be matrices with 5 columns, the first 
column containing the level, the next two containing the indices of the 
order statistics used in the calculations and the final two the 
calculated endpoints themselves.


The four components are all intervals but normal, which is a matrix with 
3 columns only.
So I extract the 4th and 5th columns.


boot.ci(boot.out, type = "bca")$bca[, 4:5]


Also, try dropping the dimensions in the med function.


med <- function(d, i) {
   temp <- d[i, , drop = TRUE]
   mean(temp)
}


Your sample a is so small that there are only 3125 arrangements with 
repetition, and only 111 different mean values of those arrangements.

arr <- RcppAlgos::permuteGeneral(a, length(a), repetition = TRUE)
dim(arr)
#[1] 3125    5

length(table( rowMeans(arr) ))
#[1] 111



Now, the equal values. The return value of 1 means that all BCa 
intervals include mean(s). The outer mean(.) is a mean of an indicator 
function given by a logical conjunction. And there are only TRUE's.

Hope this helps,

Rui Barradas


?s 15:37 de 11/12/21, varin sacha escreveu:
> Dear Rui,
> 
> I really thank you a lot for your response. Even if I don't fully understand your R code, there is something strange happening while running the code.
> Indeed, I have run this R code here below 20 times and I always got the same answer : [1] 1
> 
> ########################################
> library(boot)
> 
> s= sample(178:798, 10000, replace=TRUE)
> mean(s)
> 
> a=sample(s,size=5)
> mean(a)
> 
> dat<-data.frame(a)
> med<-function(d,i) {
> temp<-d[i,]
> mean(temp)
> }
> 
> N <- 100
> out <- replicate(N, {
>  ? boot.out <- boot(data = dat, statistic = med, R = 10000)
>  ? boot.ci(boot.out, type = "bca")$bca[, 4:5]
> })
> mean(out[1,] < mean(s) & mean(s) < out[2,])
> ########################################
> 
> 
> 
> 
> 
> 
> 
> Le samedi 11 d?cembre 2021, 12:55:43 UTC+1, Rui Barradas <ruipbarradas at sapo.pt> a ?crit :
> 
> 
> 
> 
> 
> Hello,
> 
> The problem can be solved with ?replicate.
> in the code below I only repeat N <- 1e3, not 1e4.
> 
> 
> set.seed(2021)
> N <- 1e3
> out <- replicate(N, {
>  ? boot.out <- boot(data = dat, statistic = med, R = 10000)
>  ? boot.ci(boot.out, type = "bca")$bca[, 4:5]
> })
> mean(out[1,] < mean(s) & mean(s) < out[2,])
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 10:47 de 11/12/21, varin sacha via R-help escreveu:
>> Dear R-experts,
>>
>> Here below my R code. I am trying to do 2 things :
>>
>> 1) I would like to repeat this R code 10000 times
>>
>> 2) Out of the 10000 repetitions I would have liked R to tell me how many times the "true" mean value of the population called "s" in my R example here below is included in the 10000 BCa confidence intervals constructed.
>>
>> Many thanks for your precious help.
>>
>> ########################################
>> library(boot)
>>
>> s= sample(178:798, 10000, replace=TRUE)
>> mean(s)
>>
>> a=sample(s,size=5)
>> mean(a)
>>
>> dat<-data.frame(a)
>> med<-function(d,i) {
>> temp<-d[i,]
>> mean(temp)
>>
>> }
>> boot.out<-boot(data=dat,statistic=med,R=10000)
>> boot.ci(boot.out,type="bca")
>> ########################################
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>


From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Sat Dec 11 22:35:23 2021
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Sat, 11 Dec 2021 21:35:23 +0000 (UTC)
Subject: [R] 
 Repeating a R code and counting how many repetitions working
In-Reply-To: <832b2c29-10d5-b63c-1d5c-3cb0ea316652@sapo.pt>
References: <1386111968.1475570.1639219641470.ref@mail.yahoo.com>
 <1386111968.1475570.1639219641470@mail.yahoo.com>
 <ff36571e-9a5c-6709-81cc-09ab0939f2ef@sapo.pt>
 <962792240.1594071.1639237030530@mail.yahoo.com>
 <832b2c29-10d5-b63c-1d5c-3cb0ea316652@sapo.pt>
Message-ID: <1121837911.1668812.1639258523244@mail.yahoo.com>

Dear Rui,

Many thanks, I got it now, thanks.

In my R code, I have moved the replication term 
N <-1000
out <- replicate(N, {

This time I get what I am looking for.

########################################
library(boot)

s<- sample(178:798, 10000, replace=TRUE)
mean(s)

N <- 10000
out <- replicate(N, {
a<- sample(s,size=5)
mean(a)
dat<-data.frame(a)
med<-function(d,i) {
temp<-d[i,,drop=TRUE]
mean(temp)
}

? boot.out <- boot(data = dat, statistic = med, R = 10000)
? boot.ci(boot.out, type = "bca")$bca[, 4:5]
})
mean(out[1,] < mean(s) & mean(s) < out[2,])
########################################




Le samedi 11 d?cembre 2021, 21:29:18 UTC+1, Rui Barradas <ruipbarradas at sapo.pt> a ?crit : 





Hello,

As for the code, I think it's simple. Before calling boot.ci you need to 
call boot. And replicate calls the expression between {} N times. After 
running boot.ci, the component bca is extracted. See ?boot.ci, section 
Value, after bca:


These latter four components will be matrices with 5 columns, the first 
column containing the level, the next two containing the indices of the 
order statistics used in the calculations and the final two the 
calculated endpoints themselves.


The four components are all intervals but normal, which is a matrix with 
3 columns only.
So I extract the 4th and 5th columns.


boot.ci(boot.out, type = "bca")$bca[, 4:5]


Also, try dropping the dimensions in the med function.


med <- function(d, i) {
? temp <- d[i, , drop = TRUE]
? mean(temp)
}


Your sample a is so small that there are only 3125 arrangements with 
repetition, and only 111 different mean values of those arrangements.

arr <- RcppAlgos::permuteGeneral(a, length(a), repetition = TRUE)
dim(arr)
#[1] 3125? ? 5

length(table( rowMeans(arr) ))
#[1] 111



Now, the equal values. The return value of 1 means that all BCa 
intervals include mean(s). The outer mean(.) is a mean of an indicator 
function given by a logical conjunction. And there are only TRUE's.

Hope this helps,

Rui Barradas


?s 15:37 de 11/12/21, varin sacha escreveu:
> Dear Rui,
> 
> I really thank you a lot for your response. Even if I don't fully understand your R code, there is something strange happening while running the code.
> Indeed, I have run this R code here below 20 times and I always got the same answer : [1] 1
> 
> ########################################
> library(boot)
> 
> s= sample(178:798, 10000, replace=TRUE)
> mean(s)
> 
> a=sample(s,size=5)
> mean(a)
> 
> dat<-data.frame(a)
> med<-function(d,i) {
> temp<-d[i,]
> mean(temp)
> }
> 
> N <- 100
> out <- replicate(N, {
>? ? boot.out <- boot(data = dat, statistic = med, R = 10000)
>? ? boot.ci(boot.out, type = "bca")$bca[, 4:5]
> })
> mean(out[1,] < mean(s) & mean(s) < out[2,])
> ########################################
> 
> 
> 
> 
> 
> 
> 
> Le samedi 11 d?cembre 2021, 12:55:43 UTC+1, Rui Barradas <ruipbarradas at sapo.pt> a ?crit :
> 
> 
> 
> 
> 
> Hello,
> 
> The problem can be solved with ?replicate.
> in the code below I only repeat N <- 1e3, not 1e4.
> 
> 
> set.seed(2021)
> N <- 1e3
> out <- replicate(N, {
>? ? boot.out <- boot(data = dat, statistic = med, R = 10000)
>? ? boot.ci(boot.out, type = "bca")$bca[, 4:5]
> })
> mean(out[1,] < mean(s) & mean(s) < out[2,])
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 10:47 de 11/12/21, varin sacha via R-help escreveu:
>> Dear R-experts,
>>
>> Here below my R code. I am trying to do 2 things :
>>
>> 1) I would like to repeat this R code 10000 times
>>
>> 2) Out of the 10000 repetitions I would have liked R to tell me how many times the "true" mean value of the population called "s" in my R example here below is included in the 10000 BCa confidence intervals constructed.
>>
>> Many thanks for your precious help.
>>
>> ########################################
>> library(boot)
>>
>> s= sample(178:798, 10000, replace=TRUE)
>> mean(s)
>>
>> a=sample(s,size=5)
>> mean(a)
>>
>> dat<-data.frame(a)
>> med<-function(d,i) {
>> temp<-d[i,]
>> mean(temp)
>>
>> }
>> boot.out<-boot(data=dat,statistic=med,R=10000)
>> boot.ci(boot.out,type="bca")
>> ########################################
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>


From @k@h@y_e4 @end|ng |rom hotm@||@com  Sun Dec 12 17:43:44 2021
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Sun, 12 Dec 2021 16:43:44 +0000
Subject: [R] help with parellel processing and RSelenium
Message-ID: <PU4P216MB1568176D8E2D12B18E55FD0BC8739@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

dear members,
                         I am a stock trader based in INDIA using R for my research. I have two questions:


  1.  I want to send the same function with different arguments to different cores. This link in SO https://stackoverflow.com/questions/25045998/send-function-calls-with-different-arguments-to-different-processors-in-r-using
  2.  gives the following solution:

   library(parallel)

cl <- makeCluster(4)
clusterExport(cl, "foo")
cores <- seq_along(cl)
r <- clusterApply(cl[cores], cores, function(core) {
  if (core == 1) {
    foo(5, 4, 1/2, 3, "a")
  } else if (core == 2) {
    foo(5, 3, 1/3, 1, "b")
  } else if (core == 3) {
    foo(5, 4, 1/4, 1, "c")
  } else if (core == 4) {
    foo(5, 2, 1/5, 0, "d")
  }})

My question is: what is the structure of the output "r" in the above code? I think it is a list with r[[1]] = output of foo(5,4,1/2,3,"a"),r[[2]] = output of foo(5,1/3,1,"b")

and so on. AM I right?

  1.

I am using RSelenium to scrape a website. Javascript has a document.ready function which ensures that any JS code is run only after the whole document is

  *

loaded. Is there a similar function in RSelenium? Or will the execution of the next expression takes place only after the whole page is loaded (with the

  *

"navigate" method of RSelenium)?

Thanking you,

Yours sincerely,

AKSHAY M KULKARNI




	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sun Dec 12 18:12:17 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sun, 12 Dec 2021 17:12:17 +0000
Subject: [R] help with parellel processing and RSelenium
In-Reply-To: <PU4P216MB1568176D8E2D12B18E55FD0BC8739@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
References: <PU4P216MB1568176D8E2D12B18E55FD0BC8739@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
Message-ID: <aa97559a-2bf6-3442-956e-f7834fe2c2fc@sapo.pt>

Hello,

Inline.

?s 16:43 de 12/12/21, akshay kulkarni escreveu:
> dear members,
>                           I am a stock trader based in INDIA using R for my research. I have two questions:
> 
> 
>    1.  I want to send the same function with different arguments to different cores. This link in SO https://stackoverflow.com/questions/25045998/send-function-calls-with-different-arguments-to-different-processors-in-r-using
>    2.  gives the following solution:
> 
>     library(parallel)
> 
> cl <- makeCluster(4)
> clusterExport(cl, "foo")
> cores <- seq_along(cl)
> r <- clusterApply(cl[cores], cores, function(core) {
>    if (core == 1) {
>      foo(5, 4, 1/2, 3, "a")
>    } else if (core == 2) {
>      foo(5, 3, 1/3, 1, "b")
>    } else if (core == 3) {
>      foo(5, 4, 1/4, 1, "c")
>    } else if (core == 4) {
>      foo(5, 2, 1/5, 0, "d")
>    }})
> 
> My question is: what is the structure of the output "r" in the above code? I think it is a list with r[[1]] = output of foo(5,4,1/2,3,"a"),r[[2]] = output of foo(5,1/3,1,"b")
> 
> and so on. AM I right?

Yes, you are right. Why don't you try and print r[[1]]?

Anyway, I would put the parameters in a list and pass them to the 
function following the below lines.


library(parallel)

foo <- function(pars){
   x <- pars$x
   y <- pars$y
   z <- pars$z
   w <- pars$w
   alpha <- pars$alpha
   res <- (x + y)*z^w
   list(result = res, message = alpha)
}
params <- list(
   list(x=5, y=4, z=1/2, w=3, alpha="a"),
   list(x=5, y=3, z=1/3, w=1, alpha="b"),
   list(x=5, y=4, z=1/4, w=1, alpha="c"),
   list(x=5, y=2, z=1/5, w=0, alpha="d")
)

cl <- makeCluster(4)
clusterExport(cl, "foo")
clusterExport(cl, "params")
cores <- seq_along(cl)
r <- clusterApply(cl[cores], cores, function(core) {
   foo(params[[core]])
})
stopCluster(cl)

do.call(rbind.data.frame, r)


Hope this helps,

Rui Barradas


> 
>    1.
> 
> I am using RSelenium to scrape a website. Javascript has a document.ready function which ensures that any JS code is run only after the whole document is
> 
>    *
> 
> loaded. Is there a similar function in RSelenium? Or will the execution of the next expression takes place only after the whole page is loaded (with the
> 
>    *
> 
> "navigate" method of RSelenium)?
> 
> Thanking you,
> 
> Yours sincerely,
> 
> AKSHAY M KULKARNI
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From bgunter@4567 @end|ng |rom gm@||@com  Mon Dec 13 00:05:43 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sun, 12 Dec 2021 15:05:43 -0800
Subject: [R] help with parellel processing and RSelenium
In-Reply-To: <aa97559a-2bf6-3442-956e-f7834fe2c2fc@sapo.pt>
References: <PU4P216MB1568176D8E2D12B18E55FD0BC8739@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <aa97559a-2bf6-3442-956e-f7834fe2c2fc@sapo.pt>
Message-ID: <CAGxFJbRtRZ9fMbZRPO0ABoH63rsZeBL+a-ekxygny45oi66_jQ@mail.gmail.com>

I would suggest instead:

foo <- function(pars){
   with(pars,
   (res <- (x + y)*z^w
   list(result = res, message = alpha) ))
}

On Sun, Dec 12, 2021, 9:12 AM Rui Barradas <ruipbarradas at sapo.pt> wrote:

> Hello,
>
> Inline.
>
> ?s 16:43 de 12/12/21, akshay kulkarni escreveu:
> > dear members,
> >                           I am a stock trader based in INDIA using R for
> my research. I have two questions:
> >
> >
> >    1.  I want to send the same function with different arguments to
> different cores. This link in SO
> https://stackoverflow.com/questions/25045998/send-function-calls-with-different-arguments-to-different-processors-in-r-using
> >    2.  gives the following solution:
> >
> >     library(parallel)
> >
> > cl <- makeCluster(4)
> > clusterExport(cl, "foo")
> > cores <- seq_along(cl)
> > r <- clusterApply(cl[cores], cores, function(core) {
> >    if (core == 1) {
> >      foo(5, 4, 1/2, 3, "a")
> >    } else if (core == 2) {
> >      foo(5, 3, 1/3, 1, "b")
> >    } else if (core == 3) {
> >      foo(5, 4, 1/4, 1, "c")
> >    } else if (core == 4) {
> >      foo(5, 2, 1/5, 0, "d")
> >    }})
> >
> > My question is: what is the structure of the output "r" in the above
> code? I think it is a list with r[[1]] = output of
> foo(5,4,1/2,3,"a"),r[[2]] = output of foo(5,1/3,1,"b")
> >
> > and so on. AM I right?
>
> Yes, you are right. Why don't you try and print r[[1]]?
>
> Anyway, I would put the parameters in a list and pass them to the
> function following the below lines.
>
>
> library(parallel)
>
> foo <- function(pars){
>    x <- pars$x
>    y <- pars$y
>    z <- pars$z
>    w <- pars$w
>    alpha <- pars$alpha
>    res <- (x + y)*z^w
>    list(result = res, message = alpha)
> }
> params <- list(
>    list(x=5, y=4, z=1/2, w=3, alpha="a"),
>    list(x=5, y=3, z=1/3, w=1, alpha="b"),
>    list(x=5, y=4, z=1/4, w=1, alpha="c"),
>    list(x=5, y=2, z=1/5, w=0, alpha="d")
> )
>
> cl <- makeCluster(4)
> clusterExport(cl, "foo")
> clusterExport(cl, "params")
> cores <- seq_along(cl)
> r <- clusterApply(cl[cores], cores, function(core) {
>    foo(params[[core]])
> })
> stopCluster(cl)
>
> do.call(rbind.data.frame, r)
>
>
> Hope this helps,
>
> Rui Barradas
>
>
> >
> >    1.
> >
> > I am using RSelenium to scrape a website. Javascript has a
> document.ready function which ensures that any JS code is run only after
> the whole document is
> >
> >    *
> >
> > loaded. Is there a similar function in RSelenium? Or will the execution
> of the next expression takes place only after the whole page is loaded
> (with the
> >
> >    *
> >
> > "navigate" method of RSelenium)?
> >
> > Thanking you,
> >
> > Yours sincerely,
> >
> > AKSHAY M KULKARNI
> >
> >
> >
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From y@ngk@|9999 @end|ng |rom y@hoo@com  Mon Dec 13 05:30:11 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Mon, 13 Dec 2021 04:30:11 +0000 (UTC)
Subject: [R] subset data frame problem
References: <1544959082.741682.1639369811604.ref@mail.yahoo.com>
Message-ID: <1544959082.741682.1639369811604@mail.yahoo.com>

Hi R team,I want to delete records from a data frame if?Class = '1st' and Survived = 'No'. I wrote the code below,?test <- subset(PD, Class != '1st' && Survived != 'No')
but the code return a wrong result. Can someone help me for this??
Thanks,Kai
	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Mon Dec 13 05:46:49 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sun, 12 Dec 2021 20:46:49 -0800
Subject: [R] subset data frame problem
In-Reply-To: <1544959082.741682.1639369811604@mail.yahoo.com>
References: <1544959082.741682.1639369811604.ref@mail.yahoo.com>
 <1544959082.741682.1639369811604@mail.yahoo.com>
Message-ID: <FAA748FD-6726-4792-B27C-D202C6F3529F@dcn.davis.ca.us>

Use one ampersand, not two.

And post plain text.

On December 12, 2021 8:30:11 PM PST, Kai Yang via R-help <r-help at r-project.org> wrote:
>Hi R team,I want to delete records from a data frame if?Class = '1st' and Survived = 'No'. I wrote the code below,?test <- subset(PD, Class != '1st' && Survived != 'No')
>but the code return a wrong result. Can someone help me for this??
>Thanks,Kai
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From r@oknz @end|ng |rom gm@||@com  Mon Dec 13 13:00:20 2021
From: r@oknz @end|ng |rom gm@||@com (Richard O'Keefe)
Date: Tue, 14 Dec 2021 01:00:20 +1300
Subject: [R] subset data frame problem
In-Reply-To: <1544959082.741682.1639369811604@mail.yahoo.com>
References: <1544959082.741682.1639369811604.ref@mail.yahoo.com>
 <1544959082.741682.1639369811604@mail.yahoo.com>
Message-ID: <CABcYAdJW3de20oN3zfs2CygGOAS4J_U+n1tffEbQqqpr8BnMmQ@mail.gmail.com>

You want to DELETE rows satisfying the condition P & Q.
The subset() function requires an expression saying what
you want to RETAIN, so you need subset(PD, !(P & Q)).

test <- subset(PD, !(Class == "1st" & Survived == "No"))

By de Morgan's laws, !(P & Q) is the same as (!P) | (!Q)
so you could also write

test <- subset(PD, Class != "1st" | Survived != "No")

I'd actually be tempted to do this in two steps:

unwanted <- PD$Class == "1st" & PD$Survived == "No"
test <- PD[!unwanted,]




On Mon, 13 Dec 2021 at 17:30, Kai Yang via R-help <r-help at r-project.org>
wrote:

> Hi R team,I want to delete records from a data frame if Class = '1st' and
> Survived = 'No'. I wrote the code below, test <- subset(PD, Class != '1st'
> && Survived != 'No')
> but the code return a wrong result. Can someone help me for this?
> Thanks,Kai
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From y@ngk@|9999 @end|ng |rom y@hoo@com  Mon Dec 13 17:30:24 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Mon, 13 Dec 2021 16:30:24 +0000 (UTC)
Subject: [R] subset data frame problem
In-Reply-To: <CABcYAdJW3de20oN3zfs2CygGOAS4J_U+n1tffEbQqqpr8BnMmQ@mail.gmail.com>
References: <1544959082.741682.1639369811604.ref@mail.yahoo.com>
 <1544959082.741682.1639369811604@mail.yahoo.com>
 <CABcYAdJW3de20oN3zfs2CygGOAS4J_U+n1tffEbQqqpr8BnMmQ@mail.gmail.com>
Message-ID: <263901411.834130.1639413024738@mail.yahoo.com>

 Thans Richard, it works well. --- Kai
    On Monday, December 13, 2021, 04:00:33 AM PST, Richard O'Keefe <raoknz at gmail.com> wrote:  
 
 You want to DELETE rows satisfying the condition P & Q.The subset() function requires an expression saying whatyou want to RETAIN, so you need subset(PD, !(P & Q)).
test <- subset(PD, !(Class == "1st" & Survived == "No"))
By de Morgan's laws, !(P & Q) is the same as (!P) | (!Q)so you could also write
test <- subset(PD, Class != "1st" | Survived != "No")
I'd actually be tempted to do this in two steps:
unwanted <- PD$Class == "1st" & PD$Survived == "No"test <- PD[!unwanted,]



On Mon, 13 Dec 2021 at 17:30, Kai Yang via R-help <r-help at r-project.org> wrote:

Hi R team,I want to delete records from a data frame if?Class = '1st' and Survived = 'No'. I wrote the code below,?test <- subset(PD, Class != '1st' && Survived != 'No')
but the code return a wrong result. Can someone help me for this??
Thanks,Kai
? ? ? ? [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

  
	[[alternative HTML version deleted]]


From @ndy@j@cob@on @end|ng |rom no@@@gov  Mon Dec 13 17:37:30 2021
From: @ndy@j@cob@on @end|ng |rom no@@@gov (Andy Jacobson)
Date: Mon, 13 Dec 2021 09:37:30 -0700
Subject: [R] checkpointing
Message-ID: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>

Has anyone ever considered what it would take to implement checkpointing in R, so that long-running processes could be interrupted and resumed later, from a different process or even a different machine?

Thanks,

Andy

-- 
Andy Jacobson
andy.jacobson at noaa.gov

NOAA Global Monitoring Lab
325 Broadway
Boulder, Colorado 80305

303/497-4916


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Mon Dec 13 17:53:45 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Mon, 13 Dec 2021 08:53:45 -0800
Subject: [R] checkpointing
In-Reply-To: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
Message-ID: <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>

This sounds like an OS feature, not an R feature... certainly not a portable R feature.

On December 13, 2021 8:37:30 AM PST, Andy Jacobson via R-help <r-help at r-project.org> wrote:
>Has anyone ever considered what it would take to implement checkpointing in R, so that long-running processes could be interrupted and resumed later, from a different process or even a different machine?
>
>Thanks,
>
>Andy
>

-- 
Sent from my phone. Please excuse my brevity.


From m|n@h@|| @end|ng |rom um|ch@edu  Mon Dec 13 18:58:32 2021
From: m|n@h@|| @end|ng |rom um|ch@edu (Greg Minshall)
Date: Mon, 13 Dec 2021 20:58:32 +0300
Subject: [R] checkpointing
In-Reply-To: <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
 <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
Message-ID: <550482.1639418312@apollo2.minshall.org>

Jeff,

> This sounds like an OS feature, not an R feature... certainly not a
> portable R feature.

i'm not arguing for it, but this seems to me like something that could
be a language feature.

cheers, Greg


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Dec 13 19:51:38 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 13 Dec 2021 13:51:38 -0500
Subject: [R] checkpointing
In-Reply-To: <550482.1639418312@apollo2.minshall.org>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
 <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
 <550482.1639418312@apollo2.minshall.org>
Message-ID: <082ae6ab-48d2-bb6f-2e40-cd6d4407bbe9@gmail.com>

On 13/12/2021 12:58 p.m., Greg Minshall wrote:
> Jeff,
> 
>> This sounds like an OS feature, not an R feature... certainly not a
>> portable R feature.
> 
> i'm not arguing for it, but this seems to me like something that could
> be a language feature.
> 

R functions can call libraries written in other languages, and can start 
processes, etc.  R doesn't know everything going on in every function 
call, and would have a lot of trouble saving it.

If you added some limitations, e.g. a process that periodically has its 
entire state stored in R variables, then it would be a lot easier.

Duncan Murdoch


From m|n@h@|| @end|ng |rom um|ch@edu  Mon Dec 13 20:06:30 2021
From: m|n@h@|| @end|ng |rom um|ch@edu (Greg Minshall)
Date: Mon, 13 Dec 2021 22:06:30 +0300
Subject: [R] checkpointing
In-Reply-To: <082ae6ab-48d2-bb6f-2e40-cd6d4407bbe9@gmail.com>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
 <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
 <550482.1639418312@apollo2.minshall.org>
 <082ae6ab-48d2-bb6f-2e40-cd6d4407bbe9@gmail.com>
Message-ID: <559095.1639422390@apollo2.minshall.org>

Duncan,

> R functions can call libraries written in other languages, and can
> start processes, etc.  R doesn't know everything going on in every
> function call, and would have a lot of trouble saving it.

indeed, that obvious fact hadn't occurred to me.  i withdraw my
contention.  :)

cheers, Greg


From r@oknz @end|ng |rom gm@||@com  Mon Dec 13 22:06:42 2021
From: r@oknz @end|ng |rom gm@||@com (Richard O'Keefe)
Date: Tue, 14 Dec 2021 10:06:42 +1300
Subject: [R] checkpointing
In-Reply-To: <550482.1639418312@apollo2.minshall.org>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
 <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
 <550482.1639418312@apollo2.minshall.org>
Message-ID: <CABcYAdKtptck=NJMM18ZJJSVpD-F2Djr6NFG9unxwarXhbSmBA@mail.gmail.com>

I used to work on a Prolog implementation that did something similar.
At any point you could explicitly save a snapshot of the current state
and then from the operating system command line, resume it.
This wasn't really for checkpointing.  It was so that you could load
up a customised environment, initialise it, and then future runs would
be able to start up much quicker.

Initially it was all very simple.
(Hah!)  As long as you only expected a snapshot to work on the same kind
of machine with exactly the same operating system and libraries and the
same user files in the same (logical) places.

Then as operating systems added features, it got harder and harder.
First we had to cut back to discarding the stacks and restarting from
top level on resumption.
Finally, when address space layout randomisation came along (and by the
way, this was back in the 1980s) we gave up.

Bring in clusters with MPI and I for one don't want to go there.


On Tue, 14 Dec 2021 at 06:59, Greg Minshall <minshall at umich.edu> wrote:

> Jeff,
>
> > This sounds like an OS feature, not an R feature... certainly not a
> > portable R feature.
>
> i'm not arguing for it, but this seems to me like something that could
> be a language feature.
>
> cheers, Greg
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From r@oknz @end|ng |rom gm@||@com  Mon Dec 13 23:09:45 2021
From: r@oknz @end|ng |rom gm@||@com (Richard O'Keefe)
Date: Tue, 14 Dec 2021 11:09:45 +1300
Subject: [R] checkpointing
In-Reply-To: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
Message-ID: <CABcYAdK9Ykd8rEUB7k=YZW=c2FUu1wVc+tJBssiFoYYJ-Wf6aQ@mail.gmail.com>

Use VirtualBox.  You can take a 'snapshot' of a running virtual
machine, either from the GUI or from the CLI (vboxmanage snapshot ...)
and restore it later.

This requires NO changes to R.  Snapshots can be restored on
another machine of the same kind with the same system software.

VirtualBox is free.  Parallels is (just) under USD100.

On Tue, 14 Dec 2021 at 05:38, Andy Jacobson via R-help <r-help at r-project.org>
wrote:

> Has anyone ever considered what it would take to implement checkpointing
> in R, so that long-running processes could be interrupted and resumed
> later, from a different process or even a different machine?
>
> Thanks,
>
> Andy
>
> --
> Andy Jacobson
> andy.jacobson at noaa.gov
>
> NOAA Global Monitoring Lab
> 325 Broadway
> Boulder, Colorado 80305
>
> 303/497-4916
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @v|gro@@ @end|ng |rom ver|zon@net  Tue Dec 14 01:06:17 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Mon, 13 Dec 2021 19:06:17 -0500
Subject: [R] checkpointing
In-Reply-To: <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
 <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
Message-ID: <01c901d7f07e$6aa4f4e0$3feedea0$@verizon.net>

Jeff,

I am wondering what it even means to do what you say. In a compiled
language, I can imagine wrapping up an executable along with some kind of
run-time image (which may actually contain the parts of the executable that
includes what has not run yet) and revive it elsewhere.

But even there, how would it work if say the executable kept opening more
files for reading or appending and you move it to place those files did not
exists or had different contents or other such scenarios? What happens to
open pipes with another process attached, for an OS that supports pipes?
When you restart, the other processes re not there even if you supply an
image of a pipe and I am sure others can imagine much more.

R is interpreted. You could say the main interpreter may be like an
executable and there may be multiple threads active at the time you stop the
process and bundle it to be restarted later. But R has many fairly dynamic
features including some the interpreter has not even looked at yet. Besides
files it may want to open, there are any number of statements like
library(filename) it may encounter and of course other files it may
source(code) . In general, the info on what may be needed later is not in
any serious way bundled with the file and many things may be hard to predict
even with a look ahead as often arguments to functions are not evaluated
till some indefinite later time or even never. 

I am trying to imagine how you stop and restore say an R program running
connected to something like RSTUDIO which is also connected to a Python
program with data and instructions flowing back and forth.

It does not strike me as easy to make a reliable method to do this, albeit
as noted, there are operating systems that do allow you to suspend arbitrary
processes and restart them locally perhaps only before the system reboots.

But I can think of exceptions, including some I see others have thought of.
An example might be an R program that reads in lots of data, then makes
objects like data.frames and then pauses in some kind of nested loop that
will process the data while having the current indices saved in variables.
It could literally ask to be frozen so it starts up from there when asked
to. R can be set to intercept some signals and perhaps voluntarily save all
the variables as they are (including the data it may be operating on and
what it is making from it (as in what search items it has already found) as
well as the needed index info) and exit gracefully. If the application is
restarted, it might note the file with saved info and read in all the data
and continue from there. The above is not a serious proposal and has lots of
things that can go wrong, but I can imagine it as an app that sets itself up
doing heavy lifting once and later every time you want to do a search, it
loads the data and gets from you something to search for and does it quickly
and resuspends till needed. But this example is not exactly what you asked
for.

I have actually done weird things like the above including things that
simply start up again after a reboot as if nothing happened. 

What is a more interesting question for me is what R features might make
sense that help construct a program that is in some sense re-startable if
used right. I can imagine a package that lets you set things like a "level"
for debugging so that your code when started at some point says:

# initialize.
# load any left-in-file data if it exists.

if (level < 2) {
  do stuff
  level <- 2
  }

if (level < 3) {
  do more stuff
  level <- 3
  }

...

Something like the above might wrap parts in something like a "try()" that
intercepts some interrupt condition and saves the needed status info.

What I wonder is if long-running processes that can be up for months say in
a web-server, may already have ways to save all kinds of status info so when
they start up again after a normal reboot, are able to continue almost as if
nothing had happened.


-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Jeff Newmiller
Sent: Monday, December 13, 2021 11:54 AM
To: Andy Jacobson <andy.jacobson at noaa.gov>; Andy Jacobson via R-help
<r-help at r-project.org>; r-help at r-project.org
Subject: Re: [R] checkpointing

This sounds like an OS feature, not an R feature... certainly not a portable
R feature.

On December 13, 2021 8:37:30 AM PST, Andy Jacobson via R-help
<r-help at r-project.org> wrote:
>Has anyone ever considered what it would take to implement checkpointing in
R, so that long-running processes could be interrupted and resumed later,
from a different process or even a different machine?
>
>Thanks,
>
>Andy
>

--
Sent from my phone. Please excuse my brevity.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From @ndy @end|ng |rom yovo@org  Mon Dec 13 20:07:20 2021
From: @ndy @end|ng |rom yovo@org (Andy Jacobson)
Date: Mon, 13 Dec 2021 12:07:20 -0700
Subject: [R] checkpointing
In-Reply-To: <082ae6ab-48d2-bb6f-2e40-cd6d4407bbe9@gmail.com>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
 <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
 <550482.1639418312@apollo2.minshall.org>
 <082ae6ab-48d2-bb6f-2e40-cd6d4407bbe9@gmail.com>
Message-ID: <97429d9e-b011-dea4-41d4-2ec5a63617c4@yovo.org>

Those are good points, Duncan. I am experimenting with a nice checkpointing tool called DMTCP. It operates on the system level but is quite OS-dependent. It can be found at http://dmtcp.sourceforge.net/index.html.

Still, it would be nice to be able to checkpoint calls within R to potentially long-running processes like optim().

-Andy

On 12/13/21 11:51 AM, Duncan Murdoch wrote:
> On 13/12/2021 12:58 p.m., Greg Minshall wrote:
>> Jeff,
>>
>>> This sounds like an OS feature, not an R feature... certainly not a
>>> portable R feature.
>>
>> i'm not arguing for it, but this seems to me like something that could
>> be a language feature.
>>
> 
> R functions can call libraries written in other languages, and can start processes, etc.? R doesn't know everything going on in every function call, and would have a lot of trouble saving it.
> 
> If you added some limitations, e.g. a process that periodically has its entire state stored in R variables, then it would be a lot easier.
> 
> Duncan Murdoch

-- 
Andy Jacobson
andy at yovo.org


From er|cwe|ne15 @end|ng |rom gm@||@com  Mon Dec 13 18:50:41 2021
From: er|cwe|ne15 @end|ng |rom gm@||@com (Eric Weine)
Date: Mon, 13 Dec 2021 12:50:41 -0500
Subject: [R] [R-pkgs] qqconf: An R Package for Q-Q Plot Testing Bounds
Message-ID: <CAO=DOObcTgiq9Gz89y_g6P8A9GPcELDCo6S8K+cJrEp831Cxag@mail.gmail.com>

Hello!

I've recently released version 1.1.1 of qqconf
<https://cloud.r-project.org/web/packages/qqconf/index.html>. I'm
publicizing it for the first time as our vignette
<https://cloud.r-project.org/web/packages/qqconf/vignettes/qqconf_introduction.html>
tutorial
is now available. We have also published the code on github
<https://github.com/eweine/qqconf> and additional methodological details
are available on the arXiv <https://arxiv.org/abs/2111.15082>.

Our package contains a number of useful functionalities for creating
Quantile-Quantile (QQ) plots. Most importantly, qqconf can very quickly
create simultaneous testing bands for datasets of any size to conduct an
alpha level test to determine if the sample comes from a given reference
distribution. This process is much faster than any other currently
available packages, especially for large datasets.

Please reach out with any questions!

Eric.

	[[alternative HTML version deleted]]

_______________________________________________
R-packages mailing list
R-packages at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-packages


From @k@h@y_e4 @end|ng |rom hotm@||@com  Tue Dec 14 10:57:21 2021
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Tue, 14 Dec 2021 09:57:21 +0000
Subject: [R] help with parellel processing and RSelenium
In-Reply-To: <aa97559a-2bf6-3442-956e-f7834fe2c2fc@sapo.pt>
References: <PU4P216MB1568176D8E2D12B18E55FD0BC8739@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <aa97559a-2bf6-3442-956e-f7834fe2c2fc@sapo.pt>
Message-ID: <PU4P216MB1568770D6CD5481C530AEF34C8759@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

Dear Rui,
                Thanks a lot. I've not yet ran the function. I hoped that I make sure of it before. Therefore I can't print r. Thanks anyways!

Yours sincerely,
Akshay M Kulkarni
________________________________
From: Rui Barradas <ruipbarradas at sapo.pt>
Sent: Sunday, December 12, 2021 10:42 PM
To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
Subject: Re: [R] help with parellel processing and RSelenium

Hello,

Inline.

?s 16:43 de 12/12/21, akshay kulkarni escreveu:
> dear members,
>                           I am a stock trader based in INDIA using R for my research. I have two questions:
>
>
>    1.  I want to send the same function with different arguments to different cores. This link in SO https://stackoverflow.com/questions/25045998/send-function-calls-with-different-arguments-to-different-processors-in-r-using
>    2.  gives the following solution:
>
>     library(parallel)
>
> cl <- makeCluster(4)
> clusterExport(cl, "foo")
> cores <- seq_along(cl)
> r <- clusterApply(cl[cores], cores, function(core) {
>    if (core == 1) {
>      foo(5, 4, 1/2, 3, "a")
>    } else if (core == 2) {
>      foo(5, 3, 1/3, 1, "b")
>    } else if (core == 3) {
>      foo(5, 4, 1/4, 1, "c")
>    } else if (core == 4) {
>      foo(5, 2, 1/5, 0, "d")
>    }})
>
> My question is: what is the structure of the output "r" in the above code? I think it is a list with r[[1]] = output of foo(5,4,1/2,3,"a"),r[[2]] = output of foo(5,1/3,1,"b")
>
> and so on. AM I right?

Yes, you are right. Why don't you try and print r[[1]]?

Anyway, I would put the parameters in a list and pass them to the
function following the below lines.


library(parallel)

foo <- function(pars){
   x <- pars$x
   y <- pars$y
   z <- pars$z
   w <- pars$w
   alpha <- pars$alpha
   res <- (x + y)*z^w
   list(result = res, message = alpha)
}
params <- list(
   list(x=5, y=4, z=1/2, w=3, alpha="a"),
   list(x=5, y=3, z=1/3, w=1, alpha="b"),
   list(x=5, y=4, z=1/4, w=1, alpha="c"),
   list(x=5, y=2, z=1/5, w=0, alpha="d")
)

cl <- makeCluster(4)
clusterExport(cl, "foo")
clusterExport(cl, "params")
cores <- seq_along(cl)
r <- clusterApply(cl[cores], cores, function(core) {
   foo(params[[core]])
})
stopCluster(cl)

do.call(rbind.data.frame, r)


Hope this helps,

Rui Barradas


>
>    1.
>
> I am using RSelenium to scrape a website. Javascript has a document.ready function which ensures that any JS code is run only after the whole document is
>
>    *
>
> loaded. Is there a similar function in RSelenium? Or will the execution of the next expression takes place only after the whole page is loaded (with the
>
>    *
>
> "navigate" method of RSelenium)?
>
> Thanking you,
>
> Yours sincerely,
>
> AKSHAY M KULKARNI
>
>
>
>
>        [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From m@rong|u@|u|g| @end|ng |rom gm@||@com  Tue Dec 14 11:54:08 2021
From: m@rong|u@|u|g| @end|ng |rom gm@||@com (Luigi Marongiu)
Date: Tue, 14 Dec 2021 11:54:08 +0100
Subject: [R] Format dates issues with R
Message-ID: <CAMk+s2RU2oNHyT=ihDOgGZ1JKF0hdB3PTZUYvSCEQu6uewnPkA@mail.gmail.com>

Hello,
I have these kind of dates:
```
> ori[[n[3]]]
[1] "9/20/2021" "9/20/2021" "9/20/2021" "9/20/2021" "9/20/2021" "9/20/2021"
[7] "9/20/2021" "9/20/2021" "9/20/2021" "9/20/2021" "9/21/2021" "9/21/2021"
[13] "9/21/2021" "9/21/2021" "9/21/2021" "9/21/2021" "9/21/2021" "9/21/2021"
[19] "9/21/2021" "9/21/2021" "9/22/2021" "9/22/2021" "9/22/2021" "9/22/2021"
[25] "9/22/2021" "9/22/2021" "9/22/2021" "9/22/2021" "9/22/2021" "9/22/2021"
[31] "9/23/2021" "9/23/2021" "9/23/2021" "9/23/2021" "9/23/2021" "9/23/2021"
[37] "9/23/2021" "9/23/2021" "9/23/2021" "9/23/2021" "9/24/2021" "9/24/2021"
[43] "9/24/2021" "9/24/2021" "9/24/2021" "9/24/2021" "9/24/2021" "9/24/2021"
[49] "9/24/2021" "9/24/2021" "9/27/2021" "9/27/2021" "9/27/2021" "9/27/2021"
[55] "9/27/2021" "9/27/2021" "9/27/2021" "9/27/2021" "9/27/2021" "9/27/2021"
[61] "9/28/2021" "9/28/2021" "9/28/2021" "9/28/2021" "9/28/2021" "9/28/2021"
[67] "9/28/2021" "9/28/2021" "9/28/2021" "9/28/2021" "9/29/2021" "9/29/2021"
[73] "9/29/2021" "9/29/2021" "9/29/2021" "9/29/2021" "9/29/2021" "9/29/2021"
[79] "9/29/2021" "9/29/2021" "10/1/2021" "10/1/2021"
```
they look to me as month, date, year so I formatted them as:
```
> as.Date(ori[[n[3]]], format = "%D")
# or:  as.Date(ori[[n[3]]], format = "%d/%m/%y")
[1] NA           NA           NA           NA           NA
NA
[7] NA           NA           NA           NA           NA
NA
[13] NA           NA           NA           NA           NA
NA
[19] NA           NA           NA           NA           NA
NA
[25] NA           NA           NA           NA           NA
NA
[31] NA           NA           NA           NA           NA
NA
[37] NA           NA           NA           NA           NA
NA
[43] NA           NA           NA           NA           NA
NA
[49] NA           NA           NA           NA           NA
NA
[55] NA           NA           NA           NA           NA
NA
[61] NA           NA           NA           NA           NA
NA
[67] NA           NA           NA           NA           NA
NA
[73] NA           NA           NA           NA           NA
NA
[79] NA           NA           "2010-01-20" "2010-01-20"
```
Why the conversion did not work?
Thank you


From kry|ov@r00t @end|ng |rom gm@||@com  Tue Dec 14 11:59:51 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Tue, 14 Dec 2021 13:59:51 +0300
Subject: [R] Format dates issues with R
In-Reply-To: <CAMk+s2RU2oNHyT=ihDOgGZ1JKF0hdB3PTZUYvSCEQu6uewnPkA@mail.gmail.com>
References: <CAMk+s2RU2oNHyT=ihDOgGZ1JKF0hdB3PTZUYvSCEQu6uewnPkA@mail.gmail.com>
Message-ID: <20211214135951.7539db18@arachnoid>

On Tue, 14 Dec 2021 11:54:08 +0100
Luigi Marongiu <marongiu.luigi at gmail.com> wrote:

> "9/29/2021"

> format = "%d/%m/%y"

> Why the conversion did not work?

The according to the format, the date above is 9th of month No. 29 in
the year 2020, followed by junk characters "21". Swap %m and %d to make
them follow the actual order and use %Y to parse the 4-digit year
instead of 2-digit year.

-- 
Best regards,
Ivan


From c@|@ndr@ @end|ng |rom rgzm@de  Tue Dec 14 11:59:54 2021
From: c@|@ndr@ @end|ng |rom rgzm@de (Ivan Calandra)
Date: Tue, 14 Dec 2021 11:59:54 +0100
Subject: [R] Format dates issues with R
In-Reply-To: <CAMk+s2RU2oNHyT=ihDOgGZ1JKF0hdB3PTZUYvSCEQu6uewnPkA@mail.gmail.com>
References: <CAMk+s2RU2oNHyT=ihDOgGZ1JKF0hdB3PTZUYvSCEQu6uewnPkA@mail.gmail.com>
Message-ID: <518af955-797a-87d5-43a5-00dc547b8bf5@rgzm.de>

Dear Luigi,

Quickly, I spot two problems:
1) "09/20/2021" can only be month/day/year (and not day/month/year as 
you specified).
2) The year is given with century, so it should be upper case Y

So
as.Date(ori[[n[3]]], format = "%m/%d/%Y")
should work.

HTH,
Ivan

--
Dr. Ivan Calandra
Imaging lab
RGZM - MONREPOS Archaeological Research Centre
Schloss Monrepos
56567 Neuwied, Germany
+49 (0) 2631 9772-243
https://www.researchgate.net/profile/Ivan_Calandra

On 14/12/2021 11:54, Luigi Marongiu wrote:
> Hello,
> I have these kind of dates:
> ```
>> ori[[n[3]]]
> [1] "9/20/2021" "9/20/2021" "9/20/2021" "9/20/2021" "9/20/2021" "9/20/2021"
> [7] "9/20/2021" "9/20/2021" "9/20/2021" "9/20/2021" "9/21/2021" "9/21/2021"
> [13] "9/21/2021" "9/21/2021" "9/21/2021" "9/21/2021" "9/21/2021" "9/21/2021"
> [19] "9/21/2021" "9/21/2021" "9/22/2021" "9/22/2021" "9/22/2021" "9/22/2021"
> [25] "9/22/2021" "9/22/2021" "9/22/2021" "9/22/2021" "9/22/2021" "9/22/2021"
> [31] "9/23/2021" "9/23/2021" "9/23/2021" "9/23/2021" "9/23/2021" "9/23/2021"
> [37] "9/23/2021" "9/23/2021" "9/23/2021" "9/23/2021" "9/24/2021" "9/24/2021"
> [43] "9/24/2021" "9/24/2021" "9/24/2021" "9/24/2021" "9/24/2021" "9/24/2021"
> [49] "9/24/2021" "9/24/2021" "9/27/2021" "9/27/2021" "9/27/2021" "9/27/2021"
> [55] "9/27/2021" "9/27/2021" "9/27/2021" "9/27/2021" "9/27/2021" "9/27/2021"
> [61] "9/28/2021" "9/28/2021" "9/28/2021" "9/28/2021" "9/28/2021" "9/28/2021"
> [67] "9/28/2021" "9/28/2021" "9/28/2021" "9/28/2021" "9/29/2021" "9/29/2021"
> [73] "9/29/2021" "9/29/2021" "9/29/2021" "9/29/2021" "9/29/2021" "9/29/2021"
> [79] "9/29/2021" "9/29/2021" "10/1/2021" "10/1/2021"
> ```
> they look to me as month, date, year so I formatted them as:
> ```
>> as.Date(ori[[n[3]]], format = "%D")
> # or:  as.Date(ori[[n[3]]], format = "%d/%m/%y")
> [1] NA           NA           NA           NA           NA
> NA
> [7] NA           NA           NA           NA           NA
> NA
> [13] NA           NA           NA           NA           NA
> NA
> [19] NA           NA           NA           NA           NA
> NA
> [25] NA           NA           NA           NA           NA
> NA
> [31] NA           NA           NA           NA           NA
> NA
> [37] NA           NA           NA           NA           NA
> NA
> [43] NA           NA           NA           NA           NA
> NA
> [49] NA           NA           NA           NA           NA
> NA
> [55] NA           NA           NA           NA           NA
> NA
> [61] NA           NA           NA           NA           NA
> NA
> [67] NA           NA           NA           NA           NA
> NA
> [73] NA           NA           NA           NA           NA
> NA
> [79] NA           NA           "2010-01-20" "2010-01-20"
> ```
> Why the conversion did not work?
> Thank you
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From t@v|b@r @end|ng |rom gm@||@com  Tue Dec 14 12:05:00 2021
From: t@v|b@r @end|ng |rom gm@||@com (Micha Silver)
Date: Tue, 14 Dec 2021 13:05:00 +0200
Subject: [R] Format dates issues with R
In-Reply-To: <CAMk+s2RU2oNHyT=ihDOgGZ1JKF0hdB3PTZUYvSCEQu6uewnPkA@mail.gmail.com>
References: <CAMk+s2RU2oNHyT=ihDOgGZ1JKF0hdB3PTZUYvSCEQu6uewnPkA@mail.gmail.com>
Message-ID: <a664fbbd-eee5-b099-2756-d833183415ad@gmail.com>


On 14/12/2021 12:54, Luigi Marongiu wrote:
> Hello,
> I have these kind of dates:
> ```
>> ori[[n[3]]]
> they look to me as month, date, year so I formatted them as:
> ```

Looks like that to me also.


>> as.Date(ori[[n[3]]], format = "%D")
> # or:  as.Date(ori[[n[3]]], format = "%d/%m/%y")


But you format as day, month, yr, not what you suggested.

Try: format = "%m/%d/%Y"


-- 

Micha Silver
Ben Gurion Univ.
Sde Boker, Remote Sensing Lab
cell: +972-523-665918


From m@rong|u@|u|g| @end|ng |rom gm@||@com  Tue Dec 14 12:08:01 2021
From: m@rong|u@|u|g| @end|ng |rom gm@||@com (Luigi Marongiu)
Date: Tue, 14 Dec 2021 12:08:01 +0100
Subject: [R] Format dates issues with R
In-Reply-To: <20211214135951.7539db18@arachnoid>
References: <CAMk+s2RU2oNHyT=ihDOgGZ1JKF0hdB3PTZUYvSCEQu6uewnPkA@mail.gmail.com>
 <20211214135951.7539db18@arachnoid>
Message-ID: <CAMk+s2TVQxDUh-g3Zr8GyBu1fhuGLxiziV2KVLFkKPs4NJDxBA@mail.gmail.com>

Got it, thanks!

On Tue, Dec 14, 2021 at 11:59 AM Ivan Krylov <krylov.r00t at gmail.com> wrote:
>
> On Tue, 14 Dec 2021 11:54:08 +0100
> Luigi Marongiu <marongiu.luigi at gmail.com> wrote:
>
> > "9/29/2021"
>
> > format = "%d/%m/%y"
>
> > Why the conversion did not work?
>
> The according to the format, the date above is 9th of month No. 29 in
> the year 2020, followed by junk characters "21". Swap %m and %d to make
> them follow the actual order and use %Y to parse the 4-digit year
> instead of 2-digit year.
>
> --
> Best regards,
> Ivan



-- 
Best regards,
Luigi


From m@rk@|r@nk||n @end|ng |rom rbc@com  Tue Dec 14 15:37:47 2021
From: m@rk@|r@nk||n @end|ng |rom rbc@com (Franklin, Mark)
Date: Tue, 14 Dec 2021 14:37:47 +0000
Subject: [R] R For Windows - Apache Log4J Vulnerability Inquiry
Message-ID: <7420112a80604fbb9ad34e2f6828ed9d@SXGCM114.fg.rbc.com>

Hello R-Help,

Due to the latest remote code execution vulnerability (CVE-2021-44228<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228>) in Apache Log4J.. Would you be able to confirm if R for Windows v3.1.1 is impacted by this vulnerability?

ApplicationName

Vendor

Vendor Info

MH01W-R for Windows v3.1.1

The R Project

https://www.r-project.org/


If this is not the correct email contact, would you be able to provide the appropriate contact?

Thanks,

Mark Franklin | Business Support Analyst | RBC Global Asset Management

_______________________________________________________________________

If you received this email in error, please advise the sender (by return email or otherwise) immediately. You have consented to receive the attached electronically at the above-noted email address; please retain a copy of this confirmation for future reference.

Si vous recevez ce courriel par erreur, veuillez en aviser l'exp?diteur imm?diatement, par retour de courriel ou par un autre moyen. Vous avez accept? de recevoir le(s) document(s) ci-joint(s) par voie ?lectronique ? l'adresse courriel indiqu?e ci-dessus; veuillez conserver une copie de cette confirmation pour les fins de reference future.

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Tue Dec 14 18:47:37 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Tue, 14 Dec 2021 20:47:37 +0300
Subject: [R] R For Windows - Apache Log4J Vulnerability Inquiry
In-Reply-To: <7420112a80604fbb9ad34e2f6828ed9d@SXGCM114.fg.rbc.com>
References: <7420112a80604fbb9ad34e2f6828ed9d@SXGCM114.fg.rbc.com>
Message-ID: <20211214204737.28a15625@Tarkus>

On Tue, 14 Dec 2021 14:37:47 +0000
"Franklin, Mark via R-help" <r-help at r-project.org> wrote:

> Would you be able to confirm if R for Windows v3.1.1 is impacted by
> this vulnerability?

R itself isn't written in Java, so it cannot, but the third-party Java
code that you might be calling using rJava might be.

Bob Rudis has been very kind to scan the CRAN [*] looking for packages
written in Java that might bundle the vulnerable version of log4j, and
didn't find any, but your environment may contain different versions of
packages from different sources, and those might still be vulnerable.

There could be other vulnerabilities in R v3.1.1, some of them fixed
since 2014.

-- 
Best regards,
Ivan

[*] https://stat.ethz.ch/pipermail/r-package-devel/2021q4/007589.html


From henr|k@bengt@@on @end|ng |rom gm@||@com  Wed Dec 15 01:39:28 2021
From: henr|k@bengt@@on @end|ng |rom gm@||@com (Henrik Bengtsson)
Date: Tue, 14 Dec 2021 16:39:28 -0800
Subject: [R] checkpointing
In-Reply-To: <97429d9e-b011-dea4-41d4-2ec5a63617c4@yovo.org>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
 <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
 <550482.1639418312@apollo2.minshall.org>
 <082ae6ab-48d2-bb6f-2e40-cd6d4407bbe9@gmail.com>
 <97429d9e-b011-dea4-41d4-2ec5a63617c4@yovo.org>
Message-ID: <CAFDcVCTEjFA9f-g8hYQyJR5hYC4VKBtbjJXnqY2r=FThsUdcXQ@mail.gmail.com>

On Tue, Dec 14, 2021 at 1:17 AM Andy Jacobson <andy at yovo.org> wrote:
>
> Those are good points, Duncan. I am experimenting with a nice checkpointing tool called DMTCP. It operates on the system level but is quite OS-dependent. It can be found at http://dmtcp.sourceforge.net/index.html.
>
> Still, it would be nice to be able to checkpoint calls within R to potentially long-running processes like optim().

Teasing idea. Imagine if we could come up with some de-facto standard
API for this and that such a framework could be called automatically
by R. Something similar to how user interrupts are checked (e.g.
R_CheckUserInterrupt()) on a regular basis by the R engine and
through-out the R code. That could help troubleshooting and debugging,
e.g. sending the checkpoint to someone else or going backwards in
time.

Pasting in the below since I failed to hit Reply *All* the other day,
and it was only Richard who got it:

A few weeks ago, I played around with DMTCP (Distributed MultiThreaded
CheckPointing ) for Linux (https://github.com/dmtcp/dmtcp).  I'm
sharing in case someone is interested in investigating this further.
Also, somewhere on the DMTCP wiki, they asked for testing with R by
more experienced users.

"DMTCP is a tool to transparently checkpoint the state of multiple
simultaneous applications, including multi-threaded and distributed
applications. It operates directly on the user binary executable,
without any Linux kernel modules or other kernel modifications."

They seem to be able to run this with HPC jobs, open files, Linux
containers, and even MPI, and so on.  I've only tested it very quickly
with interactive R and it seems to work.  Obviously more testing needs
to be done to identify when it doesn't work.  For example, I'd have a
hard time it would work out of the box with local parallel PSOCK
workers.  They mention "plug-ins", so maybe there's a way to adding
support for specific use cases on a one by one.

Different academic HPC environment appear to use it, e.g.

* https://docs.nersc.gov/development/checkpoint-restart/dmtcp/
* http://wiki.orc.gmu.edu/mkdocs/Creating_Checkpoints_%28DMTCP%29/
* https://wiki.york.ac.uk/display/RCS/VK21%29+Checkpointing+with+DMTCP

That's all I have time for now,

Henrik

>
> -Andy
>
> On 12/13/21 11:51 AM, Duncan Murdoch wrote:
> > On 13/12/2021 12:58 p.m., Greg Minshall wrote:
> >> Jeff,
> >>
> >>> This sounds like an OS feature, not an R feature... certainly not a
> >>> portable R feature.
> >>
> >> i'm not arguing for it, but this seems to me like something that could
> >> be a language feature.
> >>
> >
> > R functions can call libraries written in other languages, and can start processes, etc.  R doesn't know everything going on in every function call, and would have a lot of trouble saving it.
> >
> > If you added some limitations, e.g. a process that periodically has its entire state stored in R variables, then it would be a lot easier.
> >
> > Duncan Murdoch
>
> --
> Andy Jacobson
> andy at yovo.org
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @ndy@j@cob@on @end|ng |rom no@@@gov  Wed Dec 15 02:59:48 2021
From: @ndy@j@cob@on @end|ng |rom no@@@gov (Andy Jacobson)
Date: Tue, 14 Dec 2021 18:59:48 -0700
Subject: [R] checkpointing
In-Reply-To: <CAFDcVCTEjFA9f-g8hYQyJR5hYC4VKBtbjJXnqY2r=FThsUdcXQ@mail.gmail.com>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
 <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
 <550482.1639418312@apollo2.minshall.org>
 <082ae6ab-48d2-bb6f-2e40-cd6d4407bbe9@gmail.com>
 <97429d9e-b011-dea4-41d4-2ec5a63617c4@yovo.org>
 <CAFDcVCTEjFA9f-g8hYQyJR5hYC4VKBtbjJXnqY2r=FThsUdcXQ@mail.gmail.com>
Message-ID: <295d833b-a7ee-e15f-672a-f98b5db631db@noaa.gov>

I have been using DMTCP successfully for a long-running optim() task. This is a single-core process running on a large linux cluster with slurm as the job manager. This cluster places an 8-hour limit on individual jobs, and since my cost function takes 11 minutes to compute, I need many such jobs run sequentially. To make DMTCP work, I have had to rework file I/O to avoid references to temporary files written to /tmp, but other than that...optim() is checkpointed just before 8 hours is up, and then resumed successfully in a subsequent batch job running on a different core of the cluster.

While I have an answer for my particular task, it would still be useful to checkpoint using the scheme Henrik suggests. Thanks all for the interesting conversation!

-Andy



On 12/14/21 5:39 PM, Henrik Bengtsson wrote:
> On Tue, Dec 14, 2021 at 1:17 AM Andy Jacobson <andy at yovo.org> wrote:
>>
>> Those are good points, Duncan. I am experimenting with a nice checkpointing tool called DMTCP. It operates on the system level but is quite OS-dependent. It can be found at http://dmtcp.sourceforge.net/index.html.
>>
>> Still, it would be nice to be able to checkpoint calls within R to potentially long-running processes like optim().
> 
> Teasing idea. Imagine if we could come up with some de-facto standard
> API for this and that such a framework could be called automatically
> by R. Something similar to how user interrupts are checked (e.g.
> R_CheckUserInterrupt()) on a regular basis by the R engine and
> through-out the R code. That could help troubleshooting and debugging,
> e.g. sending the checkpoint to someone else or going backwards in
> time.
> 
> Pasting in the below since I failed to hit Reply *All* the other day,
> and it was only Richard who got it:
> 
> A few weeks ago, I played around with DMTCP (Distributed MultiThreaded
> CheckPointing ) for Linux (https://github.com/dmtcp/dmtcp).  I'm
> sharing in case someone is interested in investigating this further.
> Also, somewhere on the DMTCP wiki, they asked for testing with R by
> more experienced users.
> 
> "DMTCP is a tool to transparently checkpoint the state of multiple
> simultaneous applications, including multi-threaded and distributed
> applications. It operates directly on the user binary executable,
> without any Linux kernel modules or other kernel modifications."
> 
> They seem to be able to run this with HPC jobs, open files, Linux
> containers, and even MPI, and so on.  I've only tested it very quickly
> with interactive R and it seems to work.  Obviously more testing needs
> to be done to identify when it doesn't work.  For example, I'd have a
> hard time it would work out of the box with local parallel PSOCK
> workers.  They mention "plug-ins", so maybe there's a way to adding
> support for specific use cases on a one by one.
> 
> Different academic HPC environment appear to use it, e.g.
> 
> * https://docs.nersc.gov/development/checkpoint-restart/dmtcp/
> * http://wiki.orc.gmu.edu/mkdocs/Creating_Checkpoints_%28DMTCP%29/
> * https://wiki.york.ac.uk/display/RCS/VK21%29+Checkpointing+with+DMTCP
> 
> That's all I have time for now,
> 
> Henrik
> 
>>
>> -Andy
>>
>> On 12/13/21 11:51 AM, Duncan Murdoch wrote:
>>> On 13/12/2021 12:58 p.m., Greg Minshall wrote:
>>>> Jeff,
>>>>
>>>>> This sounds like an OS feature, not an R feature... certainly not a
>>>>> portable R feature.
>>>>
>>>> i'm not arguing for it, but this seems to me like something that could
>>>> be a language feature.
>>>>
>>>
>>> R functions can call libraries written in other languages, and can start processes, etc.  R doesn't know everything going on in every function call, and would have a lot of trouble saving it.
>>>
>>> If you added some limitations, e.g. a process that periodically has its entire state stored in R variables, then it would be a lot easier.
>>>
>>> Duncan Murdoch
>>
>> --
>> Andy Jacobson
>> andy at yovo.org
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.

-- 
Andy Jacobson
andy.jacobson at noaa.gov

NOAA Global Monitoring Lab
325 Broadway
Boulder, Colorado 80305

303/497-4916


From tg@77m @end|ng |rom y@hoo@com  Wed Dec 15 14:11:47 2021
From: tg@77m @end|ng |rom y@hoo@com (Thomas Subia)
Date: Wed, 15 Dec 2021 05:11:47 -0800
Subject: [R] transformTukey
References: <005001d7f1b5$51dea7c0$f59bf740$.ref@yahoo.com>
Message-ID: <005001d7f1b5$51dea7c0$f59bf740$@yahoo.com>

Colleagues,

I attempted to copy data from the clipboard and use rcompanion's
transformTukey command in an attempt to normalize the dataset.

data = read.delim("clipboard")

head(data)
  Flatness
1    7e-04
2    1e-03
3    8e-04
4    5e-04
5    5e-04
6    5e-04

All data are greater than 0.
Data set is heavily right skewed

> library(rcompanion)
> trans_data <- transformTukey(data)

Error in is.infinite(TRANS) : 
  default method not implemented for type 'list'

Why is this occurring?

Thomas Subia


From kry|ov@r00t @end|ng |rom gm@||@com  Wed Dec 15 14:20:43 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Wed, 15 Dec 2021 16:20:43 +0300
Subject: [R] transformTukey
In-Reply-To: <005001d7f1b5$51dea7c0$f59bf740$@yahoo.com>
References: <005001d7f1b5$51dea7c0$f59bf740$.ref@yahoo.com>
 <005001d7f1b5$51dea7c0$f59bf740$@yahoo.com>
Message-ID: <20211215162043.06f260fa@arachnoid>

On Wed, 15 Dec 2021 05:11:47 -0800
Thomas Subia via R-help <r-help at r-project.org> wrote:

> data = read.delim("clipboard")

What type of value does read.delim return? Use str() to find out.

> > library(rcompanion)
> > trans_data <- transformTukey(data)  
> 
> Error in is.infinite(TRANS) : 
>   default method not implemented for type 'list'

What type of value does transformTukey expect in the "x" argument? See
help(transformTukey).

Most likely, your "data" is a data.frame, and transformTukey() expects a
vector, requiring you to extract the "Flatness" component from the
data.frame using the `[` or the `$` operator.

-- 
Best regards,
Ivan


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Wed Dec 15 15:40:09 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Wed, 15 Dec 2021 06:40:09 -0800 (PST)
Subject: [R] Changing time intervals in data set
Message-ID: <f34eb0ac-a943-2196-69cd-9a5e21be55f9@appl-ecosys.com>

A 33-year set of river discharge data at one gauge location has recording
intervals of 5, 10, and 30 minutes over the period of record.

The data.frame/tibble has columns for year, month, day, hour, minute, and
datetime.

Would difftime() allow me to find the dates when the changes occurred?

TIA,

Rich


From p_t@|@r| @end|ng |rom chg@re@@|n  Wed Dec 15 13:10:15 2021
From: p_t@|@r| @end|ng |rom chg@re@@|n (TALARI PRAVEEN)
Date: Wed, 15 Dec 2021 17:40:15 +0530
Subject: [R] Need older version of R
Message-ID: <CAGsgwu+pOUjoDLNzxLrqG0PoY1Qpk8vGbVofnjBWyLS_kLkeGw@mail.gmail.com>

Hii,
I am a Linux ubuntu user and I want to install an older version of r 4.0.2.
When I try to install by the terminal, but it is taking new version 4.1.2.
Some libraries are not supported in that version. Will please help in
installing the 4.0.2 version of R.
Regards,

-- 
Praveen Talari
MSc. Human Genetics
Centre for Human Genetics, Bengaluru

	[[alternative HTML version deleted]]


From jho|tm@n @end|ng |rom gm@||@com  Wed Dec 15 19:05:01 2021
From: jho|tm@n @end|ng |rom gm@||@com (jim holtman)
Date: Wed, 15 Dec 2021 10:05:01 -0800
Subject: [R] Changing time intervals in data set
In-Reply-To: <f34eb0ac-a943-2196-69cd-9a5e21be55f9@appl-ecosys.com>
References: <f34eb0ac-a943-2196-69cd-9a5e21be55f9@appl-ecosys.com>
Message-ID: <CAAxdm-6WGMX0W-A0g1r2j5tGDef=Oxr766smb-WUg8guAtEQcw@mail.gmail.com>

At least show a sample of the data and then what you would like as output.

Thanks

Jim Holtman
*Data Munger Guru*


*What is the problem that you are trying to solve?Tell me what you want to
do, not how you want to do it.*


On Wed, Dec 15, 2021 at 6:40 AM Rich Shepard <rshepard at appl-ecosys.com>
wrote:

> A 33-year set of river discharge data at one gauge location has recording
> intervals of 5, 10, and 30 minutes over the period of record.
>
> The data.frame/tibble has columns for year, month, day, hour, minute, and
> datetime.
>
> Would difftime() allow me to find the dates when the changes occurred?
>
> TIA,
>
> Rich
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Wed Dec 15 19:24:03 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Wed, 15 Dec 2021 21:24:03 +0300
Subject: [R] Need older version of R
In-Reply-To: <CAGsgwu+pOUjoDLNzxLrqG0PoY1Qpk8vGbVofnjBWyLS_kLkeGw@mail.gmail.com>
References: <CAGsgwu+pOUjoDLNzxLrqG0PoY1Qpk8vGbVofnjBWyLS_kLkeGw@mail.gmail.com>
Message-ID: <20211215212403.47b2b4bb@Tarkus>

On Wed, 15 Dec 2021 17:40:15 +0530
TALARI PRAVEEN <p_talari at chg.res.in> wrote:

> I am a Linux ubuntu user and I want to install an older version of r
> 4.0.2.

Try asking in R-SIG-Debian <r-sig-debian at r-project.org>, but if all
else fails, you could always download
https://cran.r-project.org/src/base/R-4/R-4.0.2.tar.gz and build it
from source:
https://cran.r-project.org/doc/manuals/r-release/R-admin.html#Installing-R-under-Unix_002dalikes

-- 
Best regards,
Ivan


From thom@@@@ub|@ @end|ng |rom |m|ndu@tr|e@@com  Wed Dec 15 16:22:27 2021
From: thom@@@@ub|@ @end|ng |rom |m|ndu@tr|e@@com (Thomas Subia)
Date: Wed, 15 Dec 2021 15:22:27 +0000
Subject: [R] transformTukey
In-Reply-To: <20211215162043.06f260fa@arachnoid>
References: <005001d7f1b5$51dea7c0$f59bf740$.ref@yahoo.com>
 <005001d7f1b5$51dea7c0$f59bf740$@yahoo.com>
 <20211215162043.06f260fa@arachnoid>
Message-ID: <BY5PR12MB55127E89608E226814FDDBF3EC769@BY5PR12MB5512.namprd12.prod.outlook.com>

Thanks Ivan!

This makes perfect sense now!

All the best,

Thomas Subia
Statistician

-----Original Message-----
From: Ivan Krylov <krylov.r00t at gmail.com> 
Sent: Wednesday, December 15, 2021 5:21 AM
To: Thomas Subia via R-help <r-help at r-project.org>
Cc: Thomas Subia <tgs77m at yahoo.com>; Thomas Subia <thomas.subia at fmindustries.com>
Subject: Re: [R] transformTukey

On Wed, 15 Dec 2021 05:11:47 -0800
Thomas Subia via R-help <r-help at r-project.org> wrote:

> data = read.delim("clipboard")

What type of value does read.delim return? Use str() to find out.

> > library(rcompanion)
> > trans_data <- transformTukey(data)
> 
> Error in is.infinite(TRANS) : 
>   default method not implemented for type 'list'

What type of value does transformTukey expect in the "x" argument? See help(transformTukey).

Most likely, your "data" is a data.frame, and transformTukey() expects a vector, requiring you to extract the "Flatness" component from the data.frame using the `[` or the `$` operator.

--
Best regards,
Ivan


From @v|gro@@ @end|ng |rom ver|zon@net  Wed Dec 15 21:04:06 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Wed, 15 Dec 2021 15:04:06 -0500
Subject: [R] Changing time intervals in data set
In-Reply-To: <CAAxdm-6WGMX0W-A0g1r2j5tGDef=Oxr766smb-WUg8guAtEQcw@mail.gmail.com>
References: <f34eb0ac-a943-2196-69cd-9a5e21be55f9@appl-ecosys.com>
 <CAAxdm-6WGMX0W-A0g1r2j5tGDef=Oxr766smb-WUg8guAtEQcw@mail.gmail.com>
Message-ID: <0a2a01d7f1ee$eac309c0$c0491d40$@verizon.net>

I think Rich has shared aspects of the data before and may have forgotten we
want something here and now.

Besides a small sample of what the relevant columns look like and a
suggestion of what he wants some new column to look like, we probably need
more to understand what he wants.

The issue could be  bit like people who want to group their data by quarter,
for example, or by some other aspect such as when someone started and ended
one topic and switched to another. No way we can guess what he actually
wants.

What Rich writes may be perfectly clear to him but not others. It does sound
like there are periods people sit there and record measurements in seemingly
multiple (?contiguous) records with each recording the time at intervals
such as every five minutes, and/or 10 or 30. So a wild guess might be to
cluster them together by finding a GAP where the next record is close enough
in time to the previous ones. In essence, the condition seems to be that:

 time-of-current-record - time-of-previous-record > threshold

Where threshold may simply be thirty minutes, assuming that all the records
are also in the same series as in locations of measurement and do not
intertwine.

I assume, as usual, there are umpteen ways to deal with such sliding window
problems but am loathe to suggest any ideas till Rich has more clearly
defined the issue, perhaps by including a small amount of data in a format
trivial to copy/paste into our R implementation to play with and verify that
the solution seems to work.

But very loosely speaking, a simple sliding window of one might work. In
base R, you can use some form of loop, obviously, starting with column 2,
that perhaps uses a comparison from row N to row N-1 and sets some new
column value to something like 1 until it encounters a big enough gap when
it starts setting it to2 and so on. A later pass on the new data could use
grouping by that column, IF all of what I assume makes sense. 

And, of course, the tidyverse has perhaps easier to use functionality such
as their non-base functions of lag() and lead() used within something like
mutate()

https://dplyr.tidyverse.org/reference/lead-lag.html

But again, you need clearer requirements. You asked how to find when DATES
change. That is not the same as my guess as the date changes at midnight
local time so measures seconds apart would change. If you want to know when
clusters of non-overlapping measures change, that is another issue.

And what exactly do you want to do after determining when things change?
Depending on what you want, you may need a different way to solve the
initial problem. I mentioned the idea of grouping by another variable you
create as one such possibility. But many other solutions would not make a
grouping variable on every row, but insert some kind of cut mark in just the
first row or add a special row between groups and anything lese your
imagination supplies.

Clearly, you do not want us to solve the entire problem you are working on,
but more context may get you answers to the specific thing you are working
on. And, note that adding a new time column may not be required as they can
be created on the fly too in some places, given the other columns. But it
does help to have it in place, at least for a while, if you want to provide
answers such as how many measures were made in what total amount of time
(first to last.)



-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of jim holtman
Sent: Wednesday, December 15, 2021 1:05 PM
To: Rich Shepard <rshepard at appl-ecosys.com>
Cc: R mailing list <r-help at r-project.org>
Subject: Re: [R] Changing time intervals in data set

At least show a sample of the data and then what you would like as output.

Thanks

Jim Holtman
*Data Munger Guru*


*What is the problem that you are trying to solve?Tell me what you want to
do, not how you want to do it.*


On Wed, Dec 15, 2021 at 6:40 AM Rich Shepard <rshepard at appl-ecosys.com>
wrote:

> A 33-year set of river discharge data at one gauge location has 
> recording intervals of 5, 10, and 30 minutes over the period of record.
>
> The data.frame/tibble has columns for year, month, day, hour, minute, 
> and datetime.
>
> Would difftime() allow me to find the dates when the changes occurred?
>
> TIA,
>
> Rich
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Wed Dec 15 22:12:39 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Wed, 15 Dec 2021 13:12:39 -0800 (PST)
Subject: [R] Changing time intervals in data set
In-Reply-To: <CAAxdm-6WGMX0W-A0g1r2j5tGDef=Oxr766smb-WUg8guAtEQcw@mail.gmail.com>
References: <f34eb0ac-a943-2196-69cd-9a5e21be55f9@appl-ecosys.com>
 <CAAxdm-6WGMX0W-A0g1r2j5tGDef=Oxr766smb-WUg8guAtEQcw@mail.gmail.com>
Message-ID: <1a73ea20-bbc-bfbc-6522-902ccdb8cf23@appl-ecosys.com>

On Wed, 15 Dec 2021, jim holtman wrote:

> At least show a sample of the data and then what you would like as output.

Jim,

There are 813,694 rows of data. As I wrote,
>> A 33-year set of river discharge data at one gauge location has recording
>> intervals of 5, 10, and 30 minutes over the period of record.

Also, 15 minute intervals

>> The data.frame/tibble has columns for year, month, day, hour, minute, and
>> datetime.

As well as a site_nbr.

What I asked is,

>> Would difftime() allow me to find the dates when the changes occurred?

I'm scrolling through the data file (not the R dataframe). The output I've
so far generated manually:

1988-10-01 00:10 - 1991-03-12 23:50  10 min
1991-03-19 00:00 - 1994-07-05 23:45  15 min
2003-04-03 00:00 - 2004-01-31 10:30  30 min
2004-01-31 10:40 - 2004-01-31 15:30   5 min
2004-01-31 16:00 - 2008-06-27 11:00  30 min
2008-06-27 11:10 - 2008-07-07 15:30   5 min
2008-07-07 16:00 - 2009-05-26 13:00  30 min
2009-05-26 13:15 - 2009-05-27 06:30   5 min
2009-05-27 07:00 - 2009-06-11 08:00  30 min
2009-06-11 08:15 - 2009-06-12 08:50   5 min
2009-06-12 09:00 - 2010-09-07 08:00  30 min
2010-09-07 08:20 - 2010-09-07 18:00   5 min
2010-09-07 18:30 - 2010-09-09 07:30  30 min
2010-09-09 07:45 - 2010-09-13 11:15   5 min
2010-09-13 11:30 - 2010-12-01 07:30  30 min
2010-12-01 07:50 - 2010-12-02 15:50   5 min
2010-12-02 16:00 - 2010-12-17 10:00  30 min
2010-12-17 10:05 - 2010-12-20 08:35   5 min
2010-12-20 09:00 - 2011-05-20 09:00  30 min
2011-05-20 09:05 - 2011-05-23 06:40   5 min
2011-05-23 07:00 - 2011-08-18 17:30  30 min
2011-08-18 17:45 - 2011-12-14 06:15  15 min
2011-12-14 06:20 - 2011-12-14 17:35   5 min
2011-12-14 17:45 - 2012-06-28 06:15  15 min
2012-06-28 06:25 - 2012-06-28 14:30   5 min
2012-06-28 14:45 - 2012-10-12 06:15  15 min
2012-10-12 06:25 - 2012-10-12 15:45   5 min
2012-10-12 16:00 - 2014-01-17 07:00  15 min
2014-01-17 07:05 - 2014-01-21 07:05   5 min
2014-01-21 07:15 - 2015-04-03 07:30  15 min

Rich


From drj|m|emon @end|ng |rom gm@||@com  Thu Dec 16 00:32:09 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Thu, 16 Dec 2021 10:32:09 +1100
Subject: [R] Changing time intervals in data set
In-Reply-To: <1a73ea20-bbc-bfbc-6522-902ccdb8cf23@appl-ecosys.com>
References: <f34eb0ac-a943-2196-69cd-9a5e21be55f9@appl-ecosys.com>
 <CAAxdm-6WGMX0W-A0g1r2j5tGDef=Oxr766smb-WUg8guAtEQcw@mail.gmail.com>
 <1a73ea20-bbc-bfbc-6522-902ccdb8cf23@appl-ecosys.com>
Message-ID: <CA+8X3fU2xXDjp4W6KnaY8LS_OuWrvRpNT_G1MEr1qr42YqucdQ@mail.gmail.com>

Hi Rich,
>From what you sent, it seems like you want to find where the change in
_measurement interval_ occurred. That looks to me as though it is the
first datetime in each row. In the first row, there is a week gap
between the ten and fifteen minute intervals. This may indicate that
no measurements were taken or perhaps they were lost.

Jim

On Thu, Dec 16, 2021 at 8:13 AM Rich Shepard <rshepard at appl-ecosys.com> wrote:
>
> On Wed, 15 Dec 2021, jim holtman wrote:
>
> > At least show a sample of the data and then what you would like as output.
>
> Jim,
>
> There are 813,694 rows of data. As I wrote,
> >> A 33-year set of river discharge data at one gauge location has recording
> >> intervals of 5, 10, and 30 minutes over the period of record.
>
> Also, 15 minute intervals
>
> >> The data.frame/tibble has columns for year, month, day, hour, minute, and
> >> datetime.
>
> As well as a site_nbr.
>
> What I asked is,
>
> >> Would difftime() allow me to find the dates when the changes occurred?
>
> I'm scrolling through the data file (not the R dataframe). The output I've
> so far generated manually:
>
> 1988-10-01 00:10 - 1991-03-12 23:50  10 min
> 1991-03-19 00:00 - 1994-07-05 23:45  15 min
> 2003-04-03 00:00 - 2004-01-31 10:30  30 min
> 2004-01-31 10:40 - 2004-01-31 15:30   5 min
> 2004-01-31 16:00 - 2008-06-27 11:00  30 min
> 2008-06-27 11:10 - 2008-07-07 15:30   5 min
> 2008-07-07 16:00 - 2009-05-26 13:00  30 min
> 2009-05-26 13:15 - 2009-05-27 06:30   5 min
> 2009-05-27 07:00 - 2009-06-11 08:00  30 min
> 2009-06-11 08:15 - 2009-06-12 08:50   5 min
> 2009-06-12 09:00 - 2010-09-07 08:00  30 min
> 2010-09-07 08:20 - 2010-09-07 18:00   5 min
> 2010-09-07 18:30 - 2010-09-09 07:30  30 min
> 2010-09-09 07:45 - 2010-09-13 11:15   5 min
> 2010-09-13 11:30 - 2010-12-01 07:30  30 min
> 2010-12-01 07:50 - 2010-12-02 15:50   5 min
> 2010-12-02 16:00 - 2010-12-17 10:00  30 min
> 2010-12-17 10:05 - 2010-12-20 08:35   5 min
> 2010-12-20 09:00 - 2011-05-20 09:00  30 min
> 2011-05-20 09:05 - 2011-05-23 06:40   5 min
> 2011-05-23 07:00 - 2011-08-18 17:30  30 min
> 2011-08-18 17:45 - 2011-12-14 06:15  15 min
> 2011-12-14 06:20 - 2011-12-14 17:35   5 min
> 2011-12-14 17:45 - 2012-06-28 06:15  15 min
> 2012-06-28 06:25 - 2012-06-28 14:30   5 min
> 2012-06-28 14:45 - 2012-10-12 06:15  15 min
> 2012-10-12 06:25 - 2012-10-12 15:45   5 min
> 2012-10-12 16:00 - 2014-01-17 07:00  15 min
> 2014-01-17 07:05 - 2014-01-21 07:05   5 min
> 2014-01-21 07:15 - 2015-04-03 07:30  15 min
>
> Rich
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Thu Dec 16 00:42:42 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Wed, 15 Dec 2021 15:42:42 -0800 (PST)
Subject: [R] Changing time intervals in data set
In-Reply-To: <CA+8X3fU2xXDjp4W6KnaY8LS_OuWrvRpNT_G1MEr1qr42YqucdQ@mail.gmail.com>
References: <f34eb0ac-a943-2196-69cd-9a5e21be55f9@appl-ecosys.com>
 <CAAxdm-6WGMX0W-A0g1r2j5tGDef=Oxr766smb-WUg8guAtEQcw@mail.gmail.com>
 <1a73ea20-bbc-bfbc-6522-902ccdb8cf23@appl-ecosys.com>
 <CA+8X3fU2xXDjp4W6KnaY8LS_OuWrvRpNT_G1MEr1qr42YqucdQ@mail.gmail.com>
Message-ID: <6db67f75-134-425e-a9e0-39f41f8f09a@appl-ecosys.com>

On Thu, 16 Dec 2021, Jim Lemon wrote:

> From what you sent, it seems like you want to find where the change in
> _measurement interval_ occurred. That looks to me as though it is the
> first datetime in each row. In the first row, there is a week gap between
> the ten and fifteen minute intervals. This may indicate that no
> measurements were taken or perhaps they were lost.

Jim,

Yes, there are times when the equipment fails, but not all changes in
measurement intervals have a time gap other than a few minutes.

Normally I work with much smaller data sets so if there are interval changes
they've not appeared in the data I've used.

I will learn from the USGS why there are so many measurement interval
changes.

Because these data are so different from what I've seen in the past I want
to explore whether (or how) they affect discharge variability calculations.

Regards,

Rich


From chr|@ho|d @end|ng |rom p@yctc@org  Thu Dec 16 08:06:03 2021
From: chr|@ho|d @end|ng |rom p@yctc@org (Chris Evans)
Date: Thu, 16 Dec 2021 07:06:03 +0000 (UTC)
Subject: [R] Changing time intervals in data set
In-Reply-To: <6db67f75-134-425e-a9e0-39f41f8f09a@appl-ecosys.com>
References: <f34eb0ac-a943-2196-69cd-9a5e21be55f9@appl-ecosys.com>
 <CAAxdm-6WGMX0W-A0g1r2j5tGDef=Oxr766smb-WUg8guAtEQcw@mail.gmail.com>
 <1a73ea20-bbc-bfbc-6522-902ccdb8cf23@appl-ecosys.com>
 <CA+8X3fU2xXDjp4W6KnaY8LS_OuWrvRpNT_G1MEr1qr42YqucdQ@mail.gmail.com>
 <6db67f75-134-425e-a9e0-39f41f8f09a@appl-ecosys.com>
Message-ID: <1451769621.1599108.1639638363633.JavaMail.zimbra@psyctc.org>

What you said earlier was:

> >> The data.frame/tibble has columns for year, month, day, hour, minute, and
> >> datetime.

> As well as a site_nbr.

> What I asked is,

> >> Would difftime() allow me to find the dates when the changes occurred?

For me the next step, in tidyverse pseudocode, might be something like:

tibData %>%
   arrange(nbr, datetime) %>% # just in case things are not ordered nicely
   group_by(site_nbr) %>% # as you want to get changes within site I think
   mutate(gapTime = datetime - lag(datetime)) %>% # get the simple gaps
   summarise(nGaps = n_distinct(gapTime)) # get the number of gaps per site

(untested, may be flawed but it conveys the ideas)

>From what you are saying that will get you numbers of time gap changes per
site.  That will help you work out how many are simple failures of sensors
etc. (would they come up as multiples of that site's then usual interval,
or might they be more complex?)  In the light of that you can start the 
somewhat more challenging issue of disentangling those from more long 
lasting switches in a site's gapTime value.  I am sure I can offer some
thoughts on that in the light of what you find but the best solutions will
depend on the number of sites and on what those distributions of changes
within site look like.  

Disclaimer: I am not a professional statistician nor a professional R 
coder though I do spend much of each week hacking up R code that works
and supports publications.  Others here are professional statisticians
_and_ professional R coders.

Very best and seasonal greetings to all,

Chris


----- Original Message -----
> From: "Rich Shepard" <rshepard at appl-ecosys.com>
> To: "r-help mailing list" <r-help at r-project.org>
> Sent: Wednesday, 15 December, 2021 23:42:42
> Subject: Re: [R] Changing time intervals in data set

> On Thu, 16 Dec 2021, Jim Lemon wrote:
> 
>> From what you sent, it seems like you want to find where the change in
>> _measurement interval_ occurred. That looks to me as though it is the
>> first datetime in each row. In the first row, there is a week gap between
>> the ten and fifteen minute intervals. This may indicate that no
>> measurements were taken or perhaps they were lost.
> 
> Jim,
> 
> Yes, there are times when the equipment fails, but not all changes in
> measurement intervals have a time gap other than a few minutes.
> 
> Normally I work with much smaller data sets so if there are interval changes
> they've not appeared in the data I've used.
> 
> I will learn from the USGS why there are so many measurement interval
> changes.
> 
> Because these data are so different from what I've seen in the past I want
> to explore whether (or how) they affect discharge variability calculations.
> 
> Regards,
> 
> Rich


-- 
Chris Evans (he/him) <chris at psyctc.org> 
Visiting Professor, UDLA, Quito, Ecuador & Honorary Professor, University of Roehampton, London, UK.
Work web site: https://www.psyctc.org/psyctc/ 
CORE site:     https://www.coresystemtrust.org.uk/
Personal site: https://www.psyctc.org/pelerinage2016/
OMbook:        https://ombook.psyctc.org/book/


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Thu Dec 16 14:57:31 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Thu, 16 Dec 2021 05:57:31 -0800 (PST)
Subject: [R] Changing time intervals in data set
In-Reply-To: <1451769621.1599108.1639638363633.JavaMail.zimbra@psyctc.org>
References: <f34eb0ac-a943-2196-69cd-9a5e21be55f9@appl-ecosys.com>
 <CAAxdm-6WGMX0W-A0g1r2j5tGDef=Oxr766smb-WUg8guAtEQcw@mail.gmail.com>
 <1a73ea20-bbc-bfbc-6522-902ccdb8cf23@appl-ecosys.com>
 <CA+8X3fU2xXDjp4W6KnaY8LS_OuWrvRpNT_G1MEr1qr42YqucdQ@mail.gmail.com>
 <6db67f75-134-425e-a9e0-39f41f8f09a@appl-ecosys.com>
 <1451769621.1599108.1639638363633.JavaMail.zimbra@psyctc.org>
Message-ID: <fdb0b79d-1013-1cf5-cb8c-f4eed53bc1b9@appl-ecosys.com>

On Thu, 16 Dec 2021, Chris Evans wrote:

> What you said earlier was:

> For me the next step, in tidyverse pseudocode, might be something like:
>
> tibData %>%
>   arrange(nbr, datetime) %>% # just in case things are not ordered nicely
>   group_by(site_nbr) %>% # as you want to get changes within site I think
>   mutate(gapTime = datetime - lag(datetime)) %>% # get the simple gaps
>   summarise(nGaps = n_distinct(gapTime)) # get the number of gaps per site

Chris,

Thank you. Each tibble has the data for the same site_nbr. Your pseudocode
should put me on the path to doing what I want.

If the rows were grouped by the minute (the measurement variable period) ...
I'll need to think deeply how only the time interval, not the individual
values, could be extracted.

> From what you are saying that will get you numbers of time gap changes per
> site. That will help you work out how many are simple failures of sensors
> etc. (would they come up as multiples of that site's then usual interval,
> or might they be more complex?) In the light of that you can start the
> somewhat more challenging issue of disentangling those from more long
> lasting switches in a site's gapTime value. I am sure I can offer some
> thoughts on that in the light of what you find but the best solutions will
> depend on the number of sites and on what those distributions of changes
> within site look like.

There are only four sites, and I've identified the dates and times of
measurement frequencies for one of them. My interest is on when that
measurement frequency changes. Because I've not before seen such frequency
changes in data sets I've used for projects I've no idea whether these
changes affect analytic results.

> Disclaimer: I am not a professional statistician nor a professional R
> coder though I do spend much of each week hacking up R code that works and
> supports publications. Others here are professional statisticians _and_
> professional R coders.

Neither am I a professional statistician nor do I use R every day or with
every project.

Regards,

Rich


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Thu Dec 16 15:39:41 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Thu, 16 Dec 2021 06:39:41 -0800 (PST)
Subject: [R] Changing time intervals in data set
In-Reply-To: <003401d7f239$655e3750$301aa5f0$@verizon.net>
References: <f34eb0ac-a943-2196-69cd-9a5e21be55f9@appl-ecosys.com>
 <CAAxdm-6WGMX0W-A0g1r2j5tGDef=Oxr766smb-WUg8guAtEQcw@mail.gmail.com>
 <0a2a01d7f1ee$eac309c0$c0491d40$@verizon.net>
 <c412bfd2-7ef1-c2e4-7bf7-c0cebd2393a@appl-ecosys.com>
 <003401d7f239$655e3750$301aa5f0$@verizon.net>
Message-ID: <db1fbb34-24d-ca58-7bb7-76c6244dcd32@appl-ecosys.com>

On Wed, 15 Dec 2021, Avi Gross wrote:

> I still do not see what you want to do, sorry.

Avi,

Backing up to my original post on this thread I've realized that no one
addressed my main question: do variable measurement intervals affect
analyses of the data. And, if so, how and how to compensate for the changes.

Since this is not an R question I'll take it to stackoverflow (I think
that's the appropriate platform for this question.

My thanks to you and all others who commented on this thread.

Regards,

Rich


From m@k@hho||y @end|ng |rom gm@||@com  Thu Dec 16 17:11:53 2021
From: m@k@hho||y @end|ng |rom gm@||@com (greg holly)
Date: Thu, 16 Dec 2021 10:11:53 -0600
Subject: [R] write out a complete GAM fitted model equation,
 using parameter estimates
Message-ID: <CAM9Qe4it0gGeWwxzoTU5aZs5CuMkHjZ7xDnDa+CMWWOn-CJLWA@mail.gmail.com>

Hi all,

I have the following results from a study. I ran this model for binary
distributed outcome log(event/non_event). I need to write out a complete
GAM fitted model equation, using parameter estimates given below. I have
difficulty putting the parameter estimates of Spline part in the fitted
model. Your help is much appreciated.

Merry Christmas,
Oslo





Regression Model Analysis
Parameter Estimates
ParameterParameter
EstimateStandard
Errort ValuePr > |t|
Intercept -0.59214 1.47184 -0.40 0.6875
Study XX -0.53056 0.15266 -3.48 0.0005
Study YY 0 . . .
sex 1 -0.23585 0.22393 -1.05 0.2924
sex 0 0 . . .
Linear(cal_a) 0.01551 0.00718 2.16 0.0309
Linear(cal_B) -0.01627 0.00950 -1.71 0.0870
Linear(vit) 0.84962 0.17092 4.97 <.0001
Linear(mg) -2.21676 0.19107 -11.60 <.0001

Smoothing Model Analysis
Fit Summary for Smoothing Components
ComponentSmoothing
ParameterDFGCVNum
Unique
Obs
Spline(cal_a) 0.999911 3.381362 3.007482 76
Spline(cal_B) 1.000000 0.140625 10.741715 1201
Spline(vit) 1.000000 0.000001597 10.593968 43
Spline(mg) 0.999960 1.673807 22.737182 36

Smoothing Model Analysis
Analysis of Deviance
SourceDFSum of SquaresChi-SquarePr > ChiSq
Spline(cal_a) 3.38136 16.148270 16.1483 0.0016
Spline(cal_B) 0.14063 0.107249 0.1072 .
Spline(vit) 0.00000160 0.090490 0.0905 .
Spline(mg) 1.67381 7.585028 7.5850 0.0156

	[[alternative HTML version deleted]]


From er|nm@hodge@@ @end|ng |rom gm@||@com  Thu Dec 16 21:17:39 2021
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Thu, 16 Dec 2021 13:17:39 -0700
Subject: [R] matching type question, please
Message-ID: <CACxE24kc3pL279MtmDLOFTTfS4Y8cU5hCY3vy3B_B=Qt96ih8A@mail.gmail.com>

Hello!

I have the following:

 cbind(xr1,xr2)

      xr1 xr2

 [1,]   8   0

 [2,]   7   1

 [3,]   6   2

 [4,]   5   3

 [5,]   4   4

 [6,]   3   5

 [7,]   2   6

 [8,]   1   7

 [9,]   0   8

> cbind(xs1,xs2)

     xs1 xs2

[1,]   9   4

[2,]   8   4

[3,]   7   4

[4,]   6   4

[5,]   5   4

[6,]   4   4

[7,]   3   4

>

These are ordered pairs.  I would like to get something that shows that the
pair (4,4) appears in both.  I have tried cbind with match and %in% and
intersect, but not getting the exact results.

Any suggestions would be appreciated.  I have a feeling that it's something
really easy that I'm just not seeing.

Thanks,
Erin


Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Thu Dec 16 21:38:35 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Thu, 16 Dec 2021 22:38:35 +0200
Subject: [R] matching type question, please
In-Reply-To: <CACxE24kc3pL279MtmDLOFTTfS4Y8cU5hCY3vy3B_B=Qt96ih8A@mail.gmail.com>
References: <CACxE24kc3pL279MtmDLOFTTfS4Y8cU5hCY3vy3B_B=Qt96ih8A@mail.gmail.com>
Message-ID: <CAGgJW76rGVdouFkd_9o1PNx4s+9x_h17t_R5Cks8Bfs64OAapw@mail.gmail.com>

> a <- cbind(c(xr1,xs1),c(xr2,xs2))
> a[duplicated(a)]
[1] 4 4


On Thu, Dec 16, 2021 at 10:18 PM Erin Hodgess <erinm.hodgess at gmail.com> wrote:
>
> Hello!
>
> I have the following:
>
>  cbind(xr1,xr2)
>
>       xr1 xr2
>
>  [1,]   8   0
>
>  [2,]   7   1
>
>  [3,]   6   2
>
>  [4,]   5   3
>
>  [5,]   4   4
>
>  [6,]   3   5
>
>  [7,]   2   6
>
>  [8,]   1   7
>
>  [9,]   0   8
>
> > cbind(xs1,xs2)
>
>      xs1 xs2
>
> [1,]   9   4
>
> [2,]   8   4
>
> [3,]   7   4
>
> [4,]   6   4
>
> [5,]   5   4
>
> [6,]   4   4
>
> [7,]   3   4
>
> >
>
> These are ordered pairs.  I would like to get something that shows that the
> pair (4,4) appears in both.  I have tried cbind with match and %in% and
> intersect, but not getting the exact results.
>
> Any suggestions would be appreciated.  I have a feeling that it's something
> really easy that I'm just not seeing.
>
> Thanks,
> Erin
>
>
> Erin Hodgess, PhD
> mailto: erinm.hodgess at gmail.com
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Thu Dec 16 23:01:32 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 16 Dec 2021 14:01:32 -0800
Subject: [R] matching type question, please
In-Reply-To: <CAGgJW76rGVdouFkd_9o1PNx4s+9x_h17t_R5Cks8Bfs64OAapw@mail.gmail.com>
References: <CACxE24kc3pL279MtmDLOFTTfS4Y8cU5hCY3vy3B_B=Qt96ih8A@mail.gmail.com>
 <CAGgJW76rGVdouFkd_9o1PNx4s+9x_h17t_R5Cks8Bfs64OAapw@mail.gmail.com>
Message-ID: <CAGxFJbQpOJUUoPrTiumAsBfHQzT-BytZiKzcbVXJ42Lv=YznvA@mail.gmail.com>

I am not sure Eric's solution is what is wanted:

Consider:
xr1 <- c(1,2,1)
xr2 <- c(4,5,4)
xs1 <- c(6,6)
xs2 <- c(7,7)

> z1 <- cbind(xr1, xr2)
> z2 <- cbind(xs1,xs2)
> z1
     xr1 xr2
[1,]   1   4
[2,]   2   5
[3,]   1   4
> z2
     xs1 xs2
[1,]   6   7
[2,]   6   7

If what is wanted is to find rows of z2 that match those in z1, Eric's
proposal gives (note the added comma to give a logical indexing
vector):

> a <- cbind(c(xr1,xs1),c(xr2,xs2))
> a[duplicated(a),]
     [,1] [,2]
[1,]    1    4
[2,]    6    7

This is obviously wrong, as it gives duplicates *within* z1 and z2,
not between them. To get rows of z2 that appear as duplicates of rows
of z1, then something like the following should do:

> a <- rbind(unique(z1),unique(z2))
> a
     xr1 xr2
[1,]   1   4
[2,]   2   5
[3,]   6   7
> a[duplicated(a),]
     xr1 xr2
## nothing

I leave it to Erin to determine whether this is relevant to her
problem and, if so, how to fix up my suggestion appropriately.

Cheers,
Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Thu, Dec 16, 2021 at 12:39 PM Eric Berger <ericjberger at gmail.com> wrote:
>
> > a <- cbind(c(xr1,xs1),c(xr2,xs2))
> > a[duplicated(a)]
> [1] 4 4
>
>
> On Thu, Dec 16, 2021 at 10:18 PM Erin Hodgess <erinm.hodgess at gmail.com> wrote:
> >
> > Hello!
> >
> > I have the following:
> >
> >  cbind(xr1,xr2)
> >
> >       xr1 xr2
> >
> >  [1,]   8   0
> >
> >  [2,]   7   1
> >
> >  [3,]   6   2
> >
> >  [4,]   5   3
> >
> >  [5,]   4   4
> >
> >  [6,]   3   5
> >
> >  [7,]   2   6
> >
> >  [8,]   1   7
> >
> >  [9,]   0   8
> >
> > > cbind(xs1,xs2)
> >
> >      xs1 xs2
> >
> > [1,]   9   4
> >
> > [2,]   8   4
> >
> > [3,]   7   4
> >
> > [4,]   6   4
> >
> > [5,]   5   4
> >
> > [6,]   4   4
> >
> > [7,]   3   4
> >
> > >
> >
> > These are ordered pairs.  I would like to get something that shows that the
> > pair (4,4) appears in both.  I have tried cbind with match and %in% and
> > intersect, but not getting the exact results.
> >
> > Any suggestions would be appreciated.  I have a feeling that it's something
> > really easy that I'm just not seeing.
> >
> > Thanks,
> > Erin
> >
> >
> > Erin Hodgess, PhD
> > mailto: erinm.hodgess at gmail.com
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Thu Dec 16 23:24:27 2021
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Thu, 16 Dec 2021 22:24:27 +0000 (UTC)
Subject: [R] Using boot.ci "norm" not working
References: <1053646063.4877388.1639693467389.ref@mail.yahoo.com>
Message-ID: <1053646063.4877388.1639693467389@mail.yahoo.com>

Dear R-experts,

Here below my R code. Using "bca" in the boot.ci function at the end of my R code works perfectly. Using "perc" and "basic" perfectly works as well. But using "norm", my R code does not work anymore.
Is it possible to solve that problem and to make my R code work ?

################################################
library(boot)

s<- sample(178:798, 10000, replace=TRUE)
mean(s) 

N <- 100
out <- replicate(N, {
a<- sample(s,size=5)
mean(a)

dat<-data.frame(a)
med<-function(d,i) {
temp<-d[i,]
mean(temp)

}

? boot.out <- boot(data = dat, statistic = med, R = 10000)
? boot.ci(boot.out, type = "norm")$norm[, 4:5]
})
mean(out[1,] < mean(s) & mean(s) < out[2,])
################################################


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Dec 16 23:51:42 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 16 Dec 2021 22:51:42 +0000
Subject: [R] matching type question, please
In-Reply-To: <CAGxFJbQpOJUUoPrTiumAsBfHQzT-BytZiKzcbVXJ42Lv=YznvA@mail.gmail.com>
References: <CACxE24kc3pL279MtmDLOFTTfS4Y8cU5hCY3vy3B_B=Qt96ih8A@mail.gmail.com>
 <CAGgJW76rGVdouFkd_9o1PNx4s+9x_h17t_R5Cks8Bfs64OAapw@mail.gmail.com>
 <CAGxFJbQpOJUUoPrTiumAsBfHQzT-BytZiKzcbVXJ42Lv=YznvA@mail.gmail.com>
Message-ID: <731b92e2-ab67-0ea9-c4f3-aed26623e7a2@sapo.pt>

Hello,

And here is another solution, addressing the problem raised by Bert and 
avoiding unique.


xr1 <- 8:0
xr2 <- 0:8
xs1 <- 9:3
xs2 <- 4
cbind(xr1, xr2)[(xr1 %in% xs1) & (xr2 %in% xs2),]
#xr1 xr2
#  4   4


xr1 <- c(1,2,1)
xr2 <- c(4,5,4)
xs1 <- c(6,6)
xs2 <- c(7,7)
cbind(xr1, xr2)[(xr1 %in% xs1) & (xr2 %in% xs2),]
#   xr1 xr2
(only column names are output)


But this only works if the vectors xr* are longer than xs*. Try swapping 
the test values (both sets, Erin's original and Bert's) and see.

So here is a function that checks lengths first, then takes the right 
branch.


dupSpecial <- function(x1, x2, y1, y2){
   if(length(x1) > length(y1)){
     cbind(x1, x2)[(x1 %in% y1) & (x2 %in% y2),]
   } else {
     cbind(y1, y2)[(y1 %in% x1) & (y2 %in% x2),]
   }
}
dupSpecial(xr1, xr2, xs1, xs2)


Hope this helps,

Rui Barradas


?s 22:01 de 16/12/21, Bert Gunter escreveu:
> I am not sure Eric's solution is what is wanted:
> 
> Consider:
> xr1 <- c(1,2,1)
> xr2 <- c(4,5,4)
> xs1 <- c(6,6)
> xs2 <- c(7,7)
> 
>> z1 <- cbind(xr1, xr2)
>> z2 <- cbind(xs1,xs2)
>> z1
>       xr1 xr2
> [1,]   1   4
> [2,]   2   5
> [3,]   1   4
>> z2
>       xs1 xs2
> [1,]   6   7
> [2,]   6   7
> 
> If what is wanted is to find rows of z2 that match those in z1, Eric's
> proposal gives (note the added comma to give a logical indexing
> vector):
> 
>> a <- cbind(c(xr1,xs1),c(xr2,xs2))
>> a[duplicated(a),]
>       [,1] [,2]
> [1,]    1    4
> [2,]    6    7
> 
> This is obviously wrong, as it gives duplicates *within* z1 and z2,
> not between them. To get rows of z2 that appear as duplicates of rows
> of z1, then something like the following should do:
> 
>> a <- rbind(unique(z1),unique(z2))
>> a
>       xr1 xr2
> [1,]   1   4
> [2,]   2   5
> [3,]   6   7
>> a[duplicated(a),]
>       xr1 xr2
> ## nothing
> 
> I leave it to Erin to determine whether this is relevant to her
> problem and, if so, how to fix up my suggestion appropriately.
> 
> Cheers,
> Bert Gunter
> 
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> 
> On Thu, Dec 16, 2021 at 12:39 PM Eric Berger <ericjberger at gmail.com> wrote:
>>
>>> a <- cbind(c(xr1,xs1),c(xr2,xs2))
>>> a[duplicated(a)]
>> [1] 4 4
>>
>>
>> On Thu, Dec 16, 2021 at 10:18 PM Erin Hodgess <erinm.hodgess at gmail.com> wrote:
>>>
>>> Hello!
>>>
>>> I have the following:
>>>
>>>   cbind(xr1,xr2)
>>>
>>>        xr1 xr2
>>>
>>>   [1,]   8   0
>>>
>>>   [2,]   7   1
>>>
>>>   [3,]   6   2
>>>
>>>   [4,]   5   3
>>>
>>>   [5,]   4   4
>>>
>>>   [6,]   3   5
>>>
>>>   [7,]   2   6
>>>
>>>   [8,]   1   7
>>>
>>>   [9,]   0   8
>>>
>>>> cbind(xs1,xs2)
>>>
>>>       xs1 xs2
>>>
>>> [1,]   9   4
>>>
>>> [2,]   8   4
>>>
>>> [3,]   7   4
>>>
>>> [4,]   6   4
>>>
>>> [5,]   5   4
>>>
>>> [6,]   4   4
>>>
>>> [7,]   3   4
>>>
>>>>
>>>
>>> These are ordered pairs.  I would like to get something that shows that the
>>> pair (4,4) appears in both.  I have tried cbind with match and %in% and
>>> intersect, but not getting the exact results.
>>>
>>> Any suggestions would be appreciated.  I have a feeling that it's something
>>> really easy that I'm just not seeing.
>>>
>>> Thanks,
>>> Erin
>>>
>>>
>>> Erin Hodgess, PhD
>>> mailto: erinm.hodgess at gmail.com
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From er|nm@hodge@@ @end|ng |rom gm@||@com  Thu Dec 16 23:53:16 2021
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Thu, 16 Dec 2021 15:53:16 -0700
Subject: [R] matching type question, please
In-Reply-To: <731b92e2-ab67-0ea9-c4f3-aed26623e7a2@sapo.pt>
References: <CACxE24kc3pL279MtmDLOFTTfS4Y8cU5hCY3vy3B_B=Qt96ih8A@mail.gmail.com>
 <CAGgJW76rGVdouFkd_9o1PNx4s+9x_h17t_R5Cks8Bfs64OAapw@mail.gmail.com>
 <CAGxFJbQpOJUUoPrTiumAsBfHQzT-BytZiKzcbVXJ42Lv=YznvA@mail.gmail.com>
 <731b92e2-ab67-0ea9-c4f3-aed26623e7a2@sapo.pt>
Message-ID: <CACxE24mYPbmuwxczSoT5eYUXn1jQXB6vkzfFr1CevP-aDnBH1g@mail.gmail.com>

Wow!  These are awesome!  Thanks so much for the special cases!

Erin

On Thu, Dec 16, 2021 at 3:52 PM Rui Barradas <ruipbarradas at sapo.pt> wrote:

> Hello,
>
> And here is another solution, addressing the problem raised by Bert and
> avoiding unique.
>
>
> xr1 <- 8:0
> xr2 <- 0:8
> xs1 <- 9:3
> xs2 <- 4
> cbind(xr1, xr2)[(xr1 %in% xs1) & (xr2 %in% xs2),]
> #xr1 xr2
> #  4   4
>
>
> xr1 <- c(1,2,1)
> xr2 <- c(4,5,4)
> xs1 <- c(6,6)
> xs2 <- c(7,7)
> cbind(xr1, xr2)[(xr1 %in% xs1) & (xr2 %in% xs2),]
> #   xr1 xr2
> (only column names are output)
>
>
> But this only works if the vectors xr* are longer than xs*. Try swapping
> the test values (both sets, Erin's original and Bert's) and see.
>
> So here is a function that checks lengths first, then takes the right
> branch.
>
>
> dupSpecial <- function(x1, x2, y1, y2){
>    if(length(x1) > length(y1)){
>      cbind(x1, x2)[(x1 %in% y1) & (x2 %in% y2),]
>    } else {
>      cbind(y1, y2)[(y1 %in% x1) & (y2 %in% x2),]
>    }
> }
> dupSpecial(xr1, xr2, xs1, xs2)
>
>
> Hope this helps,
>
> Rui Barradas
>
>
> ?s 22:01 de 16/12/21, Bert Gunter escreveu:
> > I am not sure Eric's solution is what is wanted:
> >
> > Consider:
> > xr1 <- c(1,2,1)
> > xr2 <- c(4,5,4)
> > xs1 <- c(6,6)
> > xs2 <- c(7,7)
> >
> >> z1 <- cbind(xr1, xr2)
> >> z2 <- cbind(xs1,xs2)
> >> z1
> >       xr1 xr2
> > [1,]   1   4
> > [2,]   2   5
> > [3,]   1   4
> >> z2
> >       xs1 xs2
> > [1,]   6   7
> > [2,]   6   7
> >
> > If what is wanted is to find rows of z2 that match those in z1, Eric's
> > proposal gives (note the added comma to give a logical indexing
> > vector):
> >
> >> a <- cbind(c(xr1,xs1),c(xr2,xs2))
> >> a[duplicated(a),]
> >       [,1] [,2]
> > [1,]    1    4
> > [2,]    6    7
> >
> > This is obviously wrong, as it gives duplicates *within* z1 and z2,
> > not between them. To get rows of z2 that appear as duplicates of rows
> > of z1, then something like the following should do:
> >
> >> a <- rbind(unique(z1),unique(z2))
> >> a
> >       xr1 xr2
> > [1,]   1   4
> > [2,]   2   5
> > [3,]   6   7
> >> a[duplicated(a),]
> >       xr1 xr2
> > ## nothing
> >
> > I leave it to Erin to determine whether this is relevant to her
> > problem and, if so, how to fix up my suggestion appropriately.
> >
> > Cheers,
> > Bert Gunter
> >
> > "The trouble with having an open mind is that people keep coming along
> > and sticking things into it."
> > -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> >
> > On Thu, Dec 16, 2021 at 12:39 PM Eric Berger <ericjberger at gmail.com>
> wrote:
> >>
> >>> a <- cbind(c(xr1,xs1),c(xr2,xs2))
> >>> a[duplicated(a)]
> >> [1] 4 4
> >>
> >>
> >> On Thu, Dec 16, 2021 at 10:18 PM Erin Hodgess <erinm.hodgess at gmail.com>
> wrote:
> >>>
> >>> Hello!
> >>>
> >>> I have the following:
> >>>
> >>>   cbind(xr1,xr2)
> >>>
> >>>        xr1 xr2
> >>>
> >>>   [1,]   8   0
> >>>
> >>>   [2,]   7   1
> >>>
> >>>   [3,]   6   2
> >>>
> >>>   [4,]   5   3
> >>>
> >>>   [5,]   4   4
> >>>
> >>>   [6,]   3   5
> >>>
> >>>   [7,]   2   6
> >>>
> >>>   [8,]   1   7
> >>>
> >>>   [9,]   0   8
> >>>
> >>>> cbind(xs1,xs2)
> >>>
> >>>       xs1 xs2
> >>>
> >>> [1,]   9   4
> >>>
> >>> [2,]   8   4
> >>>
> >>> [3,]   7   4
> >>>
> >>> [4,]   6   4
> >>>
> >>> [5,]   5   4
> >>>
> >>> [6,]   4   4
> >>>
> >>> [7,]   3   4
> >>>
> >>>>
> >>>
> >>> These are ordered pairs.  I would like to get something that shows
> that the
> >>> pair (4,4) appears in both.  I have tried cbind with match and %in% and
> >>> intersect, but not getting the exact results.
> >>>
> >>> Any suggestions would be appreciated.  I have a feeling that it's
> something
> >>> really easy that I'm just not seeing.
> >>>
> >>> Thanks,
> >>> Erin
> >>>
> >>>
> >>> Erin Hodgess, PhD
> >>> mailto: erinm.hodgess at gmail.com
> >>>
> >>>          [[alternative HTML version deleted]]
> >>>
> >>> ______________________________________________
> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >>> and provide commented, minimal, self-contained, reproducible code.
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
-- 
Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Dec 16 23:54:49 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 16 Dec 2021 22:54:49 +0000
Subject: [R] Using boot.ci "norm" not working
In-Reply-To: <1053646063.4877388.1639693467389@mail.yahoo.com>
References: <1053646063.4877388.1639693467389.ref@mail.yahoo.com>
 <1053646063.4877388.1639693467389@mail.yahoo.com>
Message-ID: <d945d457-5a29-28b7-2399-fb0f16bd703e@sapo.pt>

Hello,

When the confidence interval is the normal CI, the return matrix has 
only 3 columns, all other CI's return a matrix with 5 columns. See 
section value in ?boot.ci.
So just change

$norm[, 4:5]

to

$norm[, 2:3]


Hope this helps,

Rui Barradas

?s 22:24 de 16/12/21, varin sacha via R-help escreveu:
> Dear R-experts,
> 
> Here below my R code. Using "bca" in the boot.ci function at the end of my R code works perfectly. Using "perc" and "basic" perfectly works as well. But using "norm", my R code does not work anymore.
> Is it possible to solve that problem and to make my R code work ?
> 
> ################################################
> library(boot)
> 
> s<- sample(178:798, 10000, replace=TRUE)
> mean(s)
> 
> N <- 100
> out <- replicate(N, {
> a<- sample(s,size=5)
> mean(a)
> 
> dat<-data.frame(a)
> med<-function(d,i) {
> temp<-d[i,]
> mean(temp)
> 
> }
> 
>  ? boot.out <- boot(data = dat, statistic = med, R = 10000)
>  ? boot.ci(boot.out, type = "norm")$norm[, 4:5]
> })
> mean(out[1,] < mean(s) & mean(s) < out[2,])
> ################################################
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From bgunter@4567 @end|ng |rom gm@||@com  Fri Dec 17 00:29:41 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 16 Dec 2021 15:29:41 -0800
Subject: [R] matching type question, please
In-Reply-To: <731b92e2-ab67-0ea9-c4f3-aed26623e7a2@sapo.pt>
References: <CACxE24kc3pL279MtmDLOFTTfS4Y8cU5hCY3vy3B_B=Qt96ih8A@mail.gmail.com>
 <CAGgJW76rGVdouFkd_9o1PNx4s+9x_h17t_R5Cks8Bfs64OAapw@mail.gmail.com>
 <CAGxFJbQpOJUUoPrTiumAsBfHQzT-BytZiKzcbVXJ42Lv=YznvA@mail.gmail.com>
 <731b92e2-ab67-0ea9-c4f3-aed26623e7a2@sapo.pt>
Message-ID: <CAGxFJbSbmn6cJ1CcJ-H6tLqTy2qjRK7FR7=oyo9gU=qNp-xW6A@mail.gmail.com>

Not sure what you mean by this:

"But this only works if the vectors xr* are longer than xs*."

The solution I gave doesn't care about this.
> a <- rbind(unique(z2),unique(z1))
> a[duplicated(a),]
     xs1 xs2
## as before
Presumably you are referring to your use of match() (which is how %in%
is defined).

Bert



On Thu, Dec 16, 2021 at 2:51 PM Rui Barradas <ruipbarradas at sapo.pt> wrote:
>
> Hello,
>
> And here is another solution, addressing the problem raised by Bert and
> avoiding unique.
>
>
> xr1 <- 8:0
> xr2 <- 0:8
> xs1 <- 9:3
> xs2 <- 4
> cbind(xr1, xr2)[(xr1 %in% xs1) & (xr2 %in% xs2),]
> #xr1 xr2
> #  4   4
>
>
> xr1 <- c(1,2,1)
> xr2 <- c(4,5,4)
> xs1 <- c(6,6)
> xs2 <- c(7,7)
> cbind(xr1, xr2)[(xr1 %in% xs1) & (xr2 %in% xs2),]
> #   xr1 xr2
> (only column names are output)
>
>
> But this only works if the vectors xr* are longer than xs*. Try swapping
> the test values (both sets, Erin's original and Bert's) and see.
>
> So here is a function that checks lengths first, then takes the right
> branch.
>
>
> dupSpecial <- function(x1, x2, y1, y2){
>    if(length(x1) > length(y1)){
>      cbind(x1, x2)[(x1 %in% y1) & (x2 %in% y2),]
>    } else {
>      cbind(y1, y2)[(y1 %in% x1) & (y2 %in% x2),]
>    }
> }
> dupSpecial(xr1, xr2, xs1, xs2)
>
>
> Hope this helps,
>
> Rui Barradas
>
>
> ?s 22:01 de 16/12/21, Bert Gunter escreveu:
> > I am not sure Eric's solution is what is wanted:
> >
> > Consider:
> > xr1 <- c(1,2,1)
> > xr2 <- c(4,5,4)
> > xs1 <- c(6,6)
> > xs2 <- c(7,7)
> >
> >> z1 <- cbind(xr1, xr2)
> >> z2 <- cbind(xs1,xs2)
> >> z1
> >       xr1 xr2
> > [1,]   1   4
> > [2,]   2   5
> > [3,]   1   4
> >> z2
> >       xs1 xs2
> > [1,]   6   7
> > [2,]   6   7
> >
> > If what is wanted is to find rows of z2 that match those in z1, Eric's
> > proposal gives (note the added comma to give a logical indexing
> > vector):
> >
> >> a <- cbind(c(xr1,xs1),c(xr2,xs2))
> >> a[duplicated(a),]
> >       [,1] [,2]
> > [1,]    1    4
> > [2,]    6    7
> >
> > This is obviously wrong, as it gives duplicates *within* z1 and z2,
> > not between them. To get rows of z2 that appear as duplicates of rows
> > of z1, then something like the following should do:
> >
> >> a <- rbind(unique(z1),unique(z2))
> >> a
> >       xr1 xr2
> > [1,]   1   4
> > [2,]   2   5
> > [3,]   6   7
> >> a[duplicated(a),]
> >       xr1 xr2
> > ## nothing
> >
> > I leave it to Erin to determine whether this is relevant to her
> > problem and, if so, how to fix up my suggestion appropriately.
> >
> > Cheers,
> > Bert Gunter
> >
> > "The trouble with having an open mind is that people keep coming along
> > and sticking things into it."
> > -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> >
> > On Thu, Dec 16, 2021 at 12:39 PM Eric Berger <ericjberger at gmail.com> wrote:
> >>
> >>> a <- cbind(c(xr1,xs1),c(xr2,xs2))
> >>> a[duplicated(a)]
> >> [1] 4 4
> >>
> >>
> >> On Thu, Dec 16, 2021 at 10:18 PM Erin Hodgess <erinm.hodgess at gmail.com> wrote:
> >>>
> >>> Hello!
> >>>
> >>> I have the following:
> >>>
> >>>   cbind(xr1,xr2)
> >>>
> >>>        xr1 xr2
> >>>
> >>>   [1,]   8   0
> >>>
> >>>   [2,]   7   1
> >>>
> >>>   [3,]   6   2
> >>>
> >>>   [4,]   5   3
> >>>
> >>>   [5,]   4   4
> >>>
> >>>   [6,]   3   5
> >>>
> >>>   [7,]   2   6
> >>>
> >>>   [8,]   1   7
> >>>
> >>>   [9,]   0   8
> >>>
> >>>> cbind(xs1,xs2)
> >>>
> >>>       xs1 xs2
> >>>
> >>> [1,]   9   4
> >>>
> >>> [2,]   8   4
> >>>
> >>> [3,]   7   4
> >>>
> >>> [4,]   6   4
> >>>
> >>> [5,]   5   4
> >>>
> >>> [6,]   4   4
> >>>
> >>> [7,]   3   4
> >>>
> >>>>
> >>>
> >>> These are ordered pairs.  I would like to get something that shows that the
> >>> pair (4,4) appears in both.  I have tried cbind with match and %in% and
> >>> intersect, but not getting the exact results.
> >>>
> >>> Any suggestions would be appreciated.  I have a feeling that it's something
> >>> really easy that I'm just not seeing.
> >>>
> >>> Thanks,
> >>> Erin
> >>>
> >>>
> >>> Erin Hodgess, PhD
> >>> mailto: erinm.hodgess at gmail.com
> >>>
> >>>          [[alternative HTML version deleted]]
> >>>
> >>> ______________________________________________
> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >>> and provide commented, minimal, self-contained, reproducible code.
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >


From v|noddh@mnek@r11 @end|ng |rom gm@||@com  Fri Dec 17 06:32:40 2021
From: v|noddh@mnek@r11 @end|ng |rom gm@||@com (Winod Dhamnekar)
Date: Fri, 17 Dec 2021 11:02:40 +0530
Subject: [R] FinCal and ggplot2 packages in r could not be loaded.
Message-ID: <CADL+Ce1Zajh4TvP0ATZab7GE7tx7dCJQUBpPEv2xoyjNYU2Y8A@mail.gmail.com>

 Hello R users community,
 I installed 'FinCal' and  'ggplot2' packages in r and tried to load
 them, but I couldn't load them. R gave me the following error.

>library(FinCal)
Error: package or namespace load failed for ?FinCal? in loadNamespace(j <-
i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]):
 there is no package called ?fansi?
> library(ggplot2)
Error: package or namespace load failed for ?ggplot2? in loadNamespace(j <-
i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]):
 there is no package called ?fansi?

WMD('R' user)

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Fri Dec 17 16:40:50 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 17 Dec 2021 07:40:50 -0800
Subject: [R] FinCal and ggplot2 packages in r could not be loaded.
In-Reply-To: <CADL+Ce1Zajh4TvP0ATZab7GE7tx7dCJQUBpPEv2xoyjNYU2Y8A@mail.gmail.com>
References: <CADL+Ce1Zajh4TvP0ATZab7GE7tx7dCJQUBpPEv2xoyjNYU2Y8A@mail.gmail.com>
Message-ID: <CAGxFJbQCoVYOQgxO-qvLN2yjR4et9VByDVFRC9V4LrvoXXemmQ@mail.gmail.com>

Do what what the error message suggests: install the fansi package!
(You may have to switch to a different repository if the one you used
doesn't have it)

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Fri, Dec 17, 2021 at 7:36 AM Winod Dhamnekar
<vinoddhamnekar11 at gmail.com> wrote:
>
>  Hello R users community,
>  I installed 'FinCal' and  'ggplot2' packages in r and tried to load
>  them, but I couldn't load them. R gave me the following error.
>
> >library(FinCal)
> Error: package or namespace load failed for ?FinCal? in loadNamespace(j <-
> i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]):
>  there is no package called ?fansi?
> > library(ggplot2)
> Error: package or namespace load failed for ?ggplot2? in loadNamespace(j <-
> i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]):
>  there is no package called ?fansi?
>
> WMD('R' user)
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Dec 17 16:47:48 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 17 Dec 2021 10:47:48 -0500
Subject: [R] FinCal and ggplot2 packages in r could not be loaded.
In-Reply-To: <CADL+Ce1Zajh4TvP0ATZab7GE7tx7dCJQUBpPEv2xoyjNYU2Y8A@mail.gmail.com>
References: <CADL+Ce1Zajh4TvP0ATZab7GE7tx7dCJQUBpPEv2xoyjNYU2Y8A@mail.gmail.com>
Message-ID: <b1453ded-d9ad-b55d-d305-ad224aa6b537@gmail.com>

On 17/12/2021 12:32 a.m., Winod Dhamnekar wrote:
>   Hello R users community,
>   I installed 'FinCal' and  'ggplot2' packages in r and tried to load
>   them, but I couldn't load them. R gave me the following error.
> 
>> library(FinCal)
> Error: package or namespace load failed for ?FinCal? in loadNamespace(j <-
> i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]):
>   there is no package called ?fansi?
>> library(ggplot2)
> Error: package or namespace load failed for ?ggplot2? in loadNamespace(j <-
> i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]):
>   there is no package called ?fansi?
> 

You should show us how you installed them.  Normally an install will 
fail if a required dependency is missing.

Duncan Murdoch


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Fri Dec 17 18:00:31 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Fri, 17 Dec 2021 17:00:31 +0000
Subject: [R] matching type question, please
In-Reply-To: <CAGxFJbSbmn6cJ1CcJ-H6tLqTy2qjRK7FR7=oyo9gU=qNp-xW6A@mail.gmail.com>
References: <CACxE24kc3pL279MtmDLOFTTfS4Y8cU5hCY3vy3B_B=Qt96ih8A@mail.gmail.com>
 <CAGgJW76rGVdouFkd_9o1PNx4s+9x_h17t_R5Cks8Bfs64OAapw@mail.gmail.com>
 <CAGxFJbQpOJUUoPrTiumAsBfHQzT-BytZiKzcbVXJ42Lv=YznvA@mail.gmail.com>
 <731b92e2-ab67-0ea9-c4f3-aed26623e7a2@sapo.pt>
 <CAGxFJbSbmn6cJ1CcJ-H6tLqTy2qjRK7FR7=oyo9gU=qNp-xW6A@mail.gmail.com>
Message-ID: <7082d510-96c8-6a90-87d7-88fc752b83cb@sapo.pt>

Hello,

Inline.

?s 23:29 de 16/12/21, Bert Gunter escreveu:
> Not sure what you mean by this:
> 
> "But this only works if the vectors xr* are longer than xs*."
> 
> The solution I gave doesn't care about this.
>> a <- rbind(unique(z2),unique(z1))
>> a[duplicated(a),]
>       xs1 xs2
> ## as before
> Presumably you are referring to your use of match() (which is how %in%
> is defined).

Yes, that's what I meant. It's probably more time and memory efficient 
to have cbind create a matrix of length(xr1) rows and extract the wanted 
ones with a logical index also of that length. The use of match() will 
avoid creating (maybe) longer data sets but it will raise the problem I 
mentioned.

Rui Barradas

> 
> Bert
> 
> 
> 
> On Thu, Dec 16, 2021 at 2:51 PM Rui Barradas <ruipbarradas at sapo.pt> wrote:
>>
>> Hello,
>>
>> And here is another solution, addressing the problem raised by Bert and
>> avoiding unique.
>>
>>
>> xr1 <- 8:0
>> xr2 <- 0:8
>> xs1 <- 9:3
>> xs2 <- 4
>> cbind(xr1, xr2)[(xr1 %in% xs1) & (xr2 %in% xs2),]
>> #xr1 xr2
>> #  4   4
>>
>>
>> xr1 <- c(1,2,1)
>> xr2 <- c(4,5,4)
>> xs1 <- c(6,6)
>> xs2 <- c(7,7)
>> cbind(xr1, xr2)[(xr1 %in% xs1) & (xr2 %in% xs2),]
>> #   xr1 xr2
>> (only column names are output)
>>
>>
>> But this only works if the vectors xr* are longer than xs*. Try swapping
>> the test values (both sets, Erin's original and Bert's) and see.
>>
>> So here is a function that checks lengths first, then takes the right
>> branch.
>>
>>
>> dupSpecial <- function(x1, x2, y1, y2){
>>     if(length(x1) > length(y1)){
>>       cbind(x1, x2)[(x1 %in% y1) & (x2 %in% y2),]
>>     } else {
>>       cbind(y1, y2)[(y1 %in% x1) & (y2 %in% x2),]
>>     }
>> }
>> dupSpecial(xr1, xr2, xs1, xs2)
>>
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>>
>> ?s 22:01 de 16/12/21, Bert Gunter escreveu:
>>> I am not sure Eric's solution is what is wanted:
>>>
>>> Consider:
>>> xr1 <- c(1,2,1)
>>> xr2 <- c(4,5,4)
>>> xs1 <- c(6,6)
>>> xs2 <- c(7,7)
>>>
>>>> z1 <- cbind(xr1, xr2)
>>>> z2 <- cbind(xs1,xs2)
>>>> z1
>>>        xr1 xr2
>>> [1,]   1   4
>>> [2,]   2   5
>>> [3,]   1   4
>>>> z2
>>>        xs1 xs2
>>> [1,]   6   7
>>> [2,]   6   7
>>>
>>> If what is wanted is to find rows of z2 that match those in z1, Eric's
>>> proposal gives (note the added comma to give a logical indexing
>>> vector):
>>>
>>>> a <- cbind(c(xr1,xs1),c(xr2,xs2))
>>>> a[duplicated(a),]
>>>        [,1] [,2]
>>> [1,]    1    4
>>> [2,]    6    7
>>>
>>> This is obviously wrong, as it gives duplicates *within* z1 and z2,
>>> not between them. To get rows of z2 that appear as duplicates of rows
>>> of z1, then something like the following should do:
>>>
>>>> a <- rbind(unique(z1),unique(z2))
>>>> a
>>>        xr1 xr2
>>> [1,]   1   4
>>> [2,]   2   5
>>> [3,]   6   7
>>>> a[duplicated(a),]
>>>        xr1 xr2
>>> ## nothing
>>>
>>> I leave it to Erin to determine whether this is relevant to her
>>> problem and, if so, how to fix up my suggestion appropriately.
>>>
>>> Cheers,
>>> Bert Gunter
>>>
>>> "The trouble with having an open mind is that people keep coming along
>>> and sticking things into it."
>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>>
>>> On Thu, Dec 16, 2021 at 12:39 PM Eric Berger <ericjberger at gmail.com> wrote:
>>>>
>>>>> a <- cbind(c(xr1,xs1),c(xr2,xs2))
>>>>> a[duplicated(a)]
>>>> [1] 4 4
>>>>
>>>>
>>>> On Thu, Dec 16, 2021 at 10:18 PM Erin Hodgess <erinm.hodgess at gmail.com> wrote:
>>>>>
>>>>> Hello!
>>>>>
>>>>> I have the following:
>>>>>
>>>>>    cbind(xr1,xr2)
>>>>>
>>>>>         xr1 xr2
>>>>>
>>>>>    [1,]   8   0
>>>>>
>>>>>    [2,]   7   1
>>>>>
>>>>>    [3,]   6   2
>>>>>
>>>>>    [4,]   5   3
>>>>>
>>>>>    [5,]   4   4
>>>>>
>>>>>    [6,]   3   5
>>>>>
>>>>>    [7,]   2   6
>>>>>
>>>>>    [8,]   1   7
>>>>>
>>>>>    [9,]   0   8
>>>>>
>>>>>> cbind(xs1,xs2)
>>>>>
>>>>>        xs1 xs2
>>>>>
>>>>> [1,]   9   4
>>>>>
>>>>> [2,]   8   4
>>>>>
>>>>> [3,]   7   4
>>>>>
>>>>> [4,]   6   4
>>>>>
>>>>> [5,]   5   4
>>>>>
>>>>> [6,]   4   4
>>>>>
>>>>> [7,]   3   4
>>>>>
>>>>>>
>>>>>
>>>>> These are ordered pairs.  I would like to get something that shows that the
>>>>> pair (4,4) appears in both.  I have tried cbind with match and %in% and
>>>>> intersect, but not getting the exact results.
>>>>>
>>>>> Any suggestions would be appreciated.  I have a feeling that it's something
>>>>> really easy that I'm just not seeing.
>>>>>
>>>>> Thanks,
>>>>> Erin
>>>>>
>>>>>
>>>>> Erin Hodgess, PhD
>>>>> mailto: erinm.hodgess at gmail.com
>>>>>
>>>>>           [[alternative HTML version deleted]]
>>>>>
>>>>> ______________________________________________
>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>


From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Fri Dec 17 20:09:58 2021
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Fri, 17 Dec 2021 19:09:58 +0000 (UTC)
Subject: [R] Using boot.ci "norm" not working
In-Reply-To: <d945d457-5a29-28b7-2399-fb0f16bd703e@sapo.pt>
References: <1053646063.4877388.1639693467389.ref@mail.yahoo.com>
 <1053646063.4877388.1639693467389@mail.yahoo.com>
 <d945d457-5a29-28b7-2399-fb0f16bd703e@sapo.pt>
Message-ID: <519208521.5397114.1639768198986@mail.yahoo.com>

Dear Rui,

Excellent ! Many thanks really... 

Best,
SV




Le jeudi 16 d?cembre 2021, 23:54:53 UTC+1, Rui Barradas <ruipbarradas at sapo.pt> a ?crit : 





Hello,

When the confidence interval is the normal CI, the return matrix has 
only 3 columns, all other CI's return a matrix with 5 columns. See 
section value in ?boot.ci.
So just change

$norm[, 4:5]

to

$norm[, 2:3]


Hope this helps,

Rui Barradas

?s 22:24 de 16/12/21, varin sacha via R-help escreveu:
> Dear R-experts,
> 
> Here below my R code. Using "bca" in the boot.ci function at the end of my R code works perfectly. Using "perc" and "basic" perfectly works as well. But using "norm", my R code does not work anymore.
> Is it possible to solve that problem and to make my R code work ?
> 
> ################################################
> library(boot)
> 
> s<- sample(178:798, 10000, replace=TRUE)
> mean(s)
> 
> N <- 100
> out <- replicate(N, {
> a<- sample(s,size=5)
> mean(a)
> 
> dat<-data.frame(a)
> med<-function(d,i) {
> temp<-d[i,]
> mean(temp)
> 
> }
> 
>? ? boot.out <- boot(data = dat, statistic = med, R = 10000)
>? ? boot.ci(boot.out, type = "norm")$norm[, 4:5]
> })
> mean(out[1,] < mean(s) & mean(s) < out[2,])
> ################################################
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
> 


From v|noddh@mnek@r11 @end|ng |rom gm@||@com  Sat Dec 18 04:39:50 2021
From: v|noddh@mnek@r11 @end|ng |rom gm@||@com (Winod Dhamnekar)
Date: Sat, 18 Dec 2021 09:09:50 +0530
Subject: [R] 'FinCal' and 'ggplot2' packages are loaded.
Message-ID: <CADL+Ce25L13ukh0wj=b1s6YjKHSJLPBRC2CwjXZ7Q8o18Yn00Q@mail.gmail.com>

Hello,
R-users community,
 Thanks to Bert Gunter for his r-help. 'FinCal' and 'ggplot2' packages are
now loaded after installing 'Fansi  in r.

Winod Dhamnekar (R-user)

	[[alternative HTML version deleted]]


From j@ork|n @end|ng |rom @om@um@ry|@nd@edu  Sat Dec 18 06:02:21 2021
From: j@ork|n @end|ng |rom @om@um@ry|@nd@edu (Sorkin, John)
Date: Sat, 18 Dec 2021 05:02:21 +0000
Subject: [R] checkpointing
In-Reply-To: <295d833b-a7ee-e15f-672a-f98b5db631db@noaa.gov>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
 <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
 <550482.1639418312@apollo2.minshall.org>
 <082ae6ab-48d2-bb6f-2e40-cd6d4407bbe9@gmail.com>
 <97429d9e-b011-dea4-41d4-2ec5a63617c4@yovo.org>
 <CAFDcVCTEjFA9f-g8hYQyJR5hYC4VKBtbjJXnqY2r=FThsUdcXQ@mail.gmail.com>
 <295d833b-a7ee-e15f-672a-f98b5db631db@noaa.gov>
Message-ID: <MN2PR03MB5167CDB462E8B1C1C9E66278E2799@MN2PR03MB5167.namprd03.prod.outlook.com>

Colleagues,

I am late to this thread. (It brings me back to my days running checkpoint restart on an IBM 370, which very useful for very, very long jobs). A search for "linux checkpoint restore" retrieved information about CIRU (Checkpoint/Restore in user space) which sounds a lot like the facility I used on the IBM 370. It appears to allow a user's process to be stopped, have its state backed up and then restarted. Perhaps this would solve (at least for Linux users of R or RStudio) the request to have checkpoint restart ability in an R program.

Please let me know if you agree.

John

________________________________________
From: R-help <r-help-bounces at r-project.org> on behalf of Andy Jacobson via R-help <r-help at r-project.org>
Sent: Tuesday, December 14, 2021 8:59 PM
To: Henrik Bengtsson
Cc: Greg Minshall; Andy Jacobson via R-help; Andy Jacobson
Subject: Re: [R] checkpointing

I have been using DMTCP successfully for a long-running optim() task. This is a single-core process running on a large linux cluster with slurm as the job manager. This cluster places an 8-hour limit on individual jobs, and since my cost function takes 11 minutes to compute, I need many such jobs run sequentially. To make DMTCP work, I have had to rework file I/O to avoid references to temporary files written to /tmp, but other than that...optim() is checkpointed just before 8 hours is up, and then resumed successfully in a subsequent batch job running on a different core of the cluster.

While I have an answer for my particular task, it would still be useful to checkpoint using the scheme Henrik suggests. Thanks all for the interesting conversation!

-Andy



On 12/14/21 5:39 PM, Henrik Bengtsson wrote:
> On Tue, Dec 14, 2021 at 1:17 AM Andy Jacobson <andy at yovo.org> wrote:
>>
>> Those are good points, Duncan. I am experimenting with a nice checkpointing tool called DMTCP. It operates on the system level but is quite OS-dependent. It can be found at https://nam11.safelinks.protection.outlook.com/?url=http%3A%2F%2Fdmtcp.sourceforge.net%2Findex.html&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C4ea4b0ad997b48ae4cd808d9bf6ea251%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637751304208997014%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=D7knPv4UR%2FyMl%2BwSBsHeYwnxdBGU4uuCwqyPxXgjbzg%3D&amp;reserved=0.
>>
>> Still, it would be nice to be able to checkpoint calls within R to potentially long-running processes like optim().
>
> Teasing idea. Imagine if we could come up with some de-facto standard
> API for this and that such a framework could be called automatically
> by R. Something similar to how user interrupts are checked (e.g.
> R_CheckUserInterrupt()) on a regular basis by the R engine and
> through-out the R code. That could help troubleshooting and debugging,
> e.g. sending the checkpoint to someone else or going backwards in
> time.
>
> Pasting in the below since I failed to hit Reply *All* the other day,
> and it was only Richard who got it:
>
> A few weeks ago, I played around with DMTCP (Distributed MultiThreaded
> CheckPointing ) for Linux (https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdmtcp%2Fdmtcp&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C4ea4b0ad997b48ae4cd808d9bf6ea251%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637751304208997014%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=xwfnXt1KJtPHUTW3cyhtgSmdeIiFl4VaiRJJAWRc5p4%3D&amp;reserved=0).  I'm
> sharing in case someone is interested in investigating this further.
> Also, somewhere on the DMTCP wiki, they asked for testing with R by
> more experienced users.
>
> "DMTCP is a tool to transparently checkpoint the state of multiple
> simultaneous applications, including multi-threaded and distributed
> applications. It operates directly on the user binary executable,
> without any Linux kernel modules or other kernel modifications."
>
> They seem to be able to run this with HPC jobs, open files, Linux
> containers, and even MPI, and so on.  I've only tested it very quickly
> with interactive R and it seems to work.  Obviously more testing needs
> to be done to identify when it doesn't work.  For example, I'd have a
> hard time it would work out of the box with local parallel PSOCK
> workers.  They mention "plug-ins", so maybe there's a way to adding
> support for specific use cases on a one by one.
>
> Different academic HPC environment appear to use it, e.g.
>
> * https://docs.nersc.gov/development/checkpoint-restart/dmtcp/
> * https://nam11.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwiki.orc.gmu.edu%2Fmkdocs%2FCreating_Checkpoints_%2528DMTCP%2529%2F&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C4ea4b0ad997b48ae4cd808d9bf6ea251%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637751304208997014%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=MtPGzaAIKl7RytoJ3%2FCC2o583GHrKz8CkEtLgeMz63I%3D&amp;reserved=0
> * https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwiki.york.ac.uk%2Fdisplay%2FRCS%2FVK21%2529%2BCheckpointing%2Bwith%2BDMTCP&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C4ea4b0ad997b48ae4cd808d9bf6ea251%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637751304208997014%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=wUI8AqONnPtKnW5JP1lXAOx%2FO%2Bkuve6dn8QC7cpb9S8%3D&amp;reserved=0
>
> That's all I have time for now,
>
> Henrik
>
>>
>> -Andy
>>
>> On 12/13/21 11:51 AM, Duncan Murdoch wrote:
>>> On 13/12/2021 12:58 p.m., Greg Minshall wrote:
>>>> Jeff,
>>>>
>>>>> This sounds like an OS feature, not an R feature... certainly not a
>>>>> portable R feature.
>>>>
>>>> i'm not arguing for it, but this seems to me like something that could
>>>> be a language feature.
>>>>
>>>
>>> R functions can call libraries written in other languages, and can start processes, etc.  R doesn't know everything going on in every function call, and would have a lot of trouble saving it.
>>>
>>> If you added some limitations, e.g. a process that periodically has its entire state stored in R variables, then it would be a lot easier.
>>>
>>> Duncan Murdoch
>>
>> --
>> Andy Jacobson
>> andy at yovo.org
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C4ea4b0ad997b48ae4cd808d9bf6ea251%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637751304208997014%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=%2BzjDX4tvLr%2FlvpoMOiQIX75ojE4WRLEkflfzf%2F0h7Bg%3D&amp;reserved=0
>> PLEASE do read the posting guide https://nam11.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C4ea4b0ad997b48ae4cd808d9bf6ea251%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637751304208997014%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=fz3JNl6S2gCGCVT6cPOSoHIOP%2F%2FTaOIqcHf6Vd%2Fbm3U%3D&amp;reserved=0
>> and provide commented, minimal, self-contained, reproducible code.

--
Andy Jacobson
andy.jacobson at noaa.gov

NOAA Global Monitoring Lab
325 Broadway
Boulder, Colorado 80305

303/497-4916

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C4ea4b0ad997b48ae4cd808d9bf6ea251%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637751304208997014%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=%2BzjDX4tvLr%2FlvpoMOiQIX75ojE4WRLEkflfzf%2F0h7Bg%3D&amp;reserved=0
PLEASE do read the posting guide https://nam11.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7CJSorkin%40som.umaryland.edu%7C4ea4b0ad997b48ae4cd808d9bf6ea251%7C717009a620de461a88940312a395cac9%7C0%7C0%7C637751304208997014%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=fz3JNl6S2gCGCVT6cPOSoHIOP%2F%2FTaOIqcHf6Vd%2Fbm3U%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.


From Courtney@V@nDene|zen @end|ng |rom co|or@do@edu  Fri Dec 17 18:05:11 2021
From: Courtney@V@nDene|zen @end|ng |rom co|or@do@edu (Courtney Van Den elzen)
Date: Fri, 17 Dec 2021 10:05:11 -0700
Subject: [R] nlme::lme sigma parameter standard deviation or variance?
Message-ID: <CACGZ04XEHYZB+a_AdO0rjTNOrsDcNQ4cO7mkr0PSdjSSZGq+yw@mail.gmail.com>

Hi R-help,

I am a researcher fitting linear mixed models using the package nlme. I am
wondering whether the sigma value that is outputted as part of the model
object is standard deviation or variance? for example, I might fit a model

lme_mod <- nlme::lme(response ~ predictor1 + predictor2, random =
(~1|grouping1))

I am wondering whether lme_mod$sigma is actually a standard deviation or if
it's a variance.

Thanks so much,
Courtney

	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Sat Dec 18 11:00:25 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Sat, 18 Dec 2021 12:00:25 +0200
Subject: [R] nlme::lme sigma parameter standard deviation or variance?
In-Reply-To: <CACGZ04XEHYZB+a_AdO0rjTNOrsDcNQ4cO7mkr0PSdjSSZGq+yw@mail.gmail.com>
References: <CACGZ04XEHYZB+a_AdO0rjTNOrsDcNQ4cO7mkr0PSdjSSZGq+yw@mail.gmail.com>
Message-ID: <CAGgJW76q3CZjQ86=VBSDhVPUZe2RGeMXUWeY=So9WVDJcP-JGg@mail.gmail.com>

You can run a test. Multiply all your data by a scalar, say 2.
If this changes the result lme_mod$sigma by a factor of 2, then it is
a std deviation.
If it changes the result by a factor of 4, then it is a variance.

HTH,
Eric

On Sat, Dec 18, 2021 at 11:26 AM Courtney Van Den elzen
<Courtney.VanDenelzen at colorado.edu> wrote:
>
> Hi R-help,
>
> I am a researcher fitting linear mixed models using the package nlme. I am
> wondering whether the sigma value that is outputted as part of the model
> object is standard deviation or variance? for example, I might fit a model
>
> lme_mod <- nlme::lme(response ~ predictor1 + predictor2, random =
> (~1|grouping1))
>
> I am wondering whether lme_mod$sigma is actually a standard deviation or if
> it's a variance.
>
> Thanks so much,
> Courtney
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @k@h@y_e4 @end|ng |rom hotm@||@com  Sat Dec 18 13:02:20 2021
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Sat, 18 Dec 2021 12:02:20 +0000
Subject: [R] problem with RSelenium....
Message-ID: <PU4P216MB15683A7D807F32208A034C5DC8799@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

dear members,
                         I am using RSelenium. I have downloaded the java binary standalone server. I am running it in my windows powershell with the following command:      java -jar selenium-server-standalone-4.0.0-alpha-2.jar
(note that the command doesn't get finished in the powershell ( the prompt doesn't return to C"\Users\Administrator\Downloads after running the command)).

Then I run the following in R console:
 > remDr <- remoteDriver(remoteServerAddr = "localhost", port = 4444L, browserName = "chrome")

and then the following:
> remDr$open

It gives me the following error:

[1] "Connecting to remote server"

Selenium message:Unable to create new service: ChromeDriverService
Build info: version: '4.0.0-alpha-2', revision: 'f148142cf8', time: '2019-07-01T21:30:10'
System info: host: 'EC2AMAZ-1JRGETJ', ip: '172.31.9.48', os.name: 'Windows Server 2016', os.arch: 'amd64', os.version: '10.0', java.version: '17.0.1'
Driver info: driver.version: unknown

Error:   Summary: SessionNotCreatedException
         Detail: A new session could not be created.
         Further Details: run errorDetails method

Please note that I'm fine with using rsDriver. What's going on? (I'm using remoteDriver instaed of rsDriver because it should not give the "port already in use" error.

Thanking you,
Yours sincerely,
AKSHAY M KULKARNI

	[[alternative HTML version deleted]]


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sat Dec 18 14:20:38 2021
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sat, 18 Dec 2021 07:20:38 -0600
Subject: [R] nlme::lme sigma parameter standard deviation or variance?
In-Reply-To: <CAGgJW76q3CZjQ86=VBSDhVPUZe2RGeMXUWeY=So9WVDJcP-JGg@mail.gmail.com>
References: <CACGZ04XEHYZB+a_AdO0rjTNOrsDcNQ4cO7mkr0PSdjSSZGq+yw@mail.gmail.com>
 <CAGgJW76q3CZjQ86=VBSDhVPUZe2RGeMXUWeY=So9WVDJcP-JGg@mail.gmail.com>
Message-ID: <2ce7bcbf-d2f3-c614-8de1-e5eb72cfdbf7@effectivedefense.org>

	  Modifying the first example in help('lme', pac='nlme'):


library(nlme)


fm1 <- lme(distance ~ age, data = Orthodont) # random is ~ age


fm1$sigma


fm1.2 <- lme(2*distance ~ age, data = Orthodont) # random is ~ age


fm1.2$sigma


	  Conclusion:  Standard deviation, as indicated in help('lmeObject').


	  Hope this helps.
	  Spencer Graves
	

On 12/18/21 4:00 AM, Eric Berger wrote:
> You can run a test. Multiply all your data by a scalar, say 2.
> If this changes the result lme_mod$sigma by a factor of 2, then it is
> a std deviation.
> If it changes the result by a factor of 4, then it is a variance.
> 
> HTH,
> Eric
> 
> On Sat, Dec 18, 2021 at 11:26 AM Courtney Van Den elzen
> <Courtney.VanDenelzen at colorado.edu> wrote:
>>
>> Hi R-help,
>>
>> I am a researcher fitting linear mixed models using the package nlme. I am
>> wondering whether the sigma value that is outputted as part of the model
>> object is standard deviation or variance? for example, I might fit a model
>>
>> lme_mod <- nlme::lme(response ~ predictor1 + predictor2, random =
>> (~1|grouping1))
>>
>> I am wondering whether lme_mod$sigma is actually a standard deviation or if
>> it's a variance.
>>
>> Thanks so much,
>> Courtney
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From v|noddh@mnek@r11 @end|ng |rom gm@||@com  Sat Dec 18 15:14:52 2021
From: v|noddh@mnek@r11 @end|ng |rom gm@||@com (Winod Dhamnekar)
Date: Sat, 18 Dec 2021 19:44:52 +0530
Subject: [R] CandlestickCharts of any listed stock and fetching stock prices
 into R
Message-ID: <CADL+Ce0LXtWzoe4ZajqjvLajDz_Y4pugvFDYq9eeObciv1ZDjg@mail.gmail.com>

Hello,
R users community,
 I want to plot candlestickCharts of any stock prices of listed companies
on any stock exchange (Indian or  worldwide) into r by using
candlestickchart command in 'FinCal' r package. But I could not plot
candlestic charts. R showed me errors.


 candlestickChart(ohlc,2020-12-18,2021-12-17,"Google")
Error in as.Date(ohlc$date) : object 'ohlc' not found
> candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
Error: object of type 'closure' is not subsettable
> candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
Error: object of type 'closure' is not subsettable


What is the suitable syntax to use candlestickchart command from 'FinCal' r
package?

I also tried to fetch stock prices of listed companies on any stock
exchange (wordwide or Indian) But I could not fetch stock prices.
  # google <- get.ohlc.yahoo("GOOG",start="2014-07-01",end="2014-08-01");
candlestickChart(google)
 # google <- get.ohlc.yahoo("GOOG",start="2020-12-18",end="2021-12-17");
candlestickChart(google)
> candlestickChart(ohlc,2020-12-18,2021-12-17,"Google")
Error in as.Date(ohlc$date) : object 'ohlc' not found
> candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
Error: object of type 'closure' is not subsettable
> candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
Error: object of type 'closure' is not subsettable

 get.ohlc.yahoo("BOM:532504", 18-12-2021,17-12-2021,d)
Error in strsplit(start, "-") : non-character argument
> get.ohlc.yahoo('BOM:532504', 18-12-2021,17-12-2021,d)
Error in strsplit(start, "-") : non-character argument
> get.ohlc.yahoo(BOM:532504, 18-12-2021,17-12-2021,d)
Error in strsplit(start, "-") : non-character argument
 # google <- get.ohlc.yahoo("GOOG",start="2020-12-18",end="2021-12-17");
candlestickChart(google)
> candlestickChart(ohlc,2020-12-18,2021-12-17,"Google")
Error in as.Date(ohlc$date) : object 'ohlc' not found
> candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
Error: object of type 'closure' is not subsettable
 candlestickChart(ohlc,2020-12-18,2021-12-17,"Google")
Error in as.Date(ohlc$date) : object 'ohlc' not found

  How can I plot candlestickchart and fetch stock prices of any period with
any frequency of time intervals?

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Sat Dec 18 19:50:14 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 18 Dec 2021 10:50:14 -0800
Subject: [R] 
 CandlestickCharts of any listed stock and fetching stock prices
 into R
In-Reply-To: <CADL+Ce0LXtWzoe4ZajqjvLajDz_Y4pugvFDYq9eeObciv1ZDjg@mail.gmail.com>
References: <CADL+Ce0LXtWzoe4ZajqjvLajDz_Y4pugvFDYq9eeObciv1ZDjg@mail.gmail.com>
Message-ID: <CAGxFJbTr7qZBBoYtAbgUYdFvGtNqiZGK8D244T-peESHQ4+tCg@mail.gmail.com>

Please read and follow the Posting Guide linked below, which says,
among other things:

"For questions about functions in standard packages distributed with R
(see the FAQ Add-on packages in R), ask questions on R-help.
[The link is:
https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
This gives the list of current _standard_ packages]

If the question relates to a contributed package [such as FinCal] ,
e.g., one downloaded from CRAN, **try contacting the package
maintainer first**. You can also use find("functionname") and
packageDescription("packagename") to find this information. Only send
such questions to R-help or R-devel if you get no reply or need
further assistance. This applies to both requests for help and to bug
reports."


Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Sat, Dec 18, 2021 at 6:15 AM Winod Dhamnekar
<vinoddhamnekar11 at gmail.com> wrote:
>
> Hello,
> R users community,
>  I want to plot candlestickCharts of any stock prices of listed companies
> on any stock exchange (Indian or  worldwide) into r by using
> candlestickchart command in 'FinCal' r package. But I could not plot
> candlestic charts. R showed me errors.
>
>
>  candlestickChart(ohlc,2020-12-18,2021-12-17,"Google")
> Error in as.Date(ohlc$date) : object 'ohlc' not found
> > candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
> Error: object of type 'closure' is not subsettable
> > candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
> Error: object of type 'closure' is not subsettable
>
>
> What is the suitable syntax to use candlestickchart command from 'FinCal' r
> package?
>
> I also tried to fetch stock prices of listed companies on any stock
> exchange (wordwide or Indian) But I could not fetch stock prices.
>   # google <- get.ohlc.yahoo("GOOG",start="2014-07-01",end="2014-08-01");
> candlestickChart(google)
>  # google <- get.ohlc.yahoo("GOOG",start="2020-12-18",end="2021-12-17");
> candlestickChart(google)
> > candlestickChart(ohlc,2020-12-18,2021-12-17,"Google")
> Error in as.Date(ohlc$date) : object 'ohlc' not found
> > candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
> Error: object of type 'closure' is not subsettable
> > candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
> Error: object of type 'closure' is not subsettable
>
>  get.ohlc.yahoo("BOM:532504", 18-12-2021,17-12-2021,d)
> Error in strsplit(start, "-") : non-character argument
> > get.ohlc.yahoo('BOM:532504', 18-12-2021,17-12-2021,d)
> Error in strsplit(start, "-") : non-character argument
> > get.ohlc.yahoo(BOM:532504, 18-12-2021,17-12-2021,d)
> Error in strsplit(start, "-") : non-character argument
>  # google <- get.ohlc.yahoo("GOOG",start="2020-12-18",end="2021-12-17");
> candlestickChart(google)
> > candlestickChart(ohlc,2020-12-18,2021-12-17,"Google")
> Error in as.Date(ohlc$date) : object 'ohlc' not found
> > candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
> Error: object of type 'closure' is not subsettable
>  candlestickChart(ohlc,2020-12-18,2021-12-17,"Google")
> Error in as.Date(ohlc$date) : object 'ohlc' not found
>
>   How can I plot candlestickchart and fetch stock prices of any period with
> any frequency of time intervals?
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Sat Dec 18 19:56:04 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 18 Dec 2021 10:56:04 -0800
Subject: [R] 
 CandlestickCharts of any listed stock and fetching stock prices
 into R
In-Reply-To: <CAGxFJbTr7qZBBoYtAbgUYdFvGtNqiZGK8D244T-peESHQ4+tCg@mail.gmail.com>
References: <CADL+Ce0LXtWzoe4ZajqjvLajDz_Y4pugvFDYq9eeObciv1ZDjg@mail.gmail.com>
 <CAGxFJbTr7qZBBoYtAbgUYdFvGtNqiZGK8D244T-peESHQ4+tCg@mail.gmail.com>
Message-ID: <CAGxFJbRG8AOvWMOE_V790R6G3-MjCPyibifCYBvD-icpOTa7UA@mail.gmail.com>

Note also that there is an r-sig-finance list that would be a better
place to post such queries.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Sat, Dec 18, 2021 at 10:50 AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> Please read and follow the Posting Guide linked below, which says,
> among other things:
>
> "For questions about functions in standard packages distributed with R
> (see the FAQ Add-on packages in R), ask questions on R-help.
> [The link is:
> https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
> This gives the list of current _standard_ packages]
>
> If the question relates to a contributed package [such as FinCal] ,
> e.g., one downloaded from CRAN, **try contacting the package
> maintainer first**. You can also use find("functionname") and
> packageDescription("packagename") to find this information. Only send
> such questions to R-help or R-devel if you get no reply or need
> further assistance. This applies to both requests for help and to bug
> reports."
>
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
>
> On Sat, Dec 18, 2021 at 6:15 AM Winod Dhamnekar
> <vinoddhamnekar11 at gmail.com> wrote:
> >
> > Hello,
> > R users community,
> >  I want to plot candlestickCharts of any stock prices of listed companies
> > on any stock exchange (Indian or  worldwide) into r by using
> > candlestickchart command in 'FinCal' r package. But I could not plot
> > candlestic charts. R showed me errors.
> >
> >
> >  candlestickChart(ohlc,2020-12-18,2021-12-17,"Google")
> > Error in as.Date(ohlc$date) : object 'ohlc' not found
> > > candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
> > Error: object of type 'closure' is not subsettable
> > > candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
> > Error: object of type 'closure' is not subsettable
> >
> >
> > What is the suitable syntax to use candlestickchart command from 'FinCal' r
> > package?
> >
> > I also tried to fetch stock prices of listed companies on any stock
> > exchange (wordwide or Indian) But I could not fetch stock prices.
> >   # google <- get.ohlc.yahoo("GOOG",start="2014-07-01",end="2014-08-01");
> > candlestickChart(google)
> >  # google <- get.ohlc.yahoo("GOOG",start="2020-12-18",end="2021-12-17");
> > candlestickChart(google)
> > > candlestickChart(ohlc,2020-12-18,2021-12-17,"Google")
> > Error in as.Date(ohlc$date) : object 'ohlc' not found
> > > candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
> > Error: object of type 'closure' is not subsettable
> > > candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
> > Error: object of type 'closure' is not subsettable
> >
> >  get.ohlc.yahoo("BOM:532504", 18-12-2021,17-12-2021,d)
> > Error in strsplit(start, "-") : non-character argument
> > > get.ohlc.yahoo('BOM:532504', 18-12-2021,17-12-2021,d)
> > Error in strsplit(start, "-") : non-character argument
> > > get.ohlc.yahoo(BOM:532504, 18-12-2021,17-12-2021,d)
> > Error in strsplit(start, "-") : non-character argument
> >  # google <- get.ohlc.yahoo("GOOG",start="2020-12-18",end="2021-12-17");
> > candlestickChart(google)
> > > candlestickChart(ohlc,2020-12-18,2021-12-17,"Google")
> > Error in as.Date(ohlc$date) : object 'ohlc' not found
> > > candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
> > Error: object of type 'closure' is not subsettable
> >  candlestickChart(ohlc,2020-12-18,2021-12-17,"Google")
> > Error in as.Date(ohlc$date) : object 'ohlc' not found
> >
> >   How can I plot candlestickchart and fetch stock prices of any period with
> > any frequency of time intervals?
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.


From drj|m|emon @end|ng |rom gm@||@com  Sat Dec 18 22:00:10 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Sun, 19 Dec 2021 08:00:10 +1100
Subject: [R] 
 CandlestickCharts of any listed stock and fetching stock prices
 into R
In-Reply-To: <CADL+Ce0LXtWzoe4ZajqjvLajDz_Y4pugvFDYq9eeObciv1ZDjg@mail.gmail.com>
References: <CADL+Ce0LXtWzoe4ZajqjvLajDz_Y4pugvFDYq9eeObciv1ZDjg@mail.gmail.com>
Message-ID: <CA+8X3fWF-ZbjxpcfttrfoeQ4B_uEOpXddU8HEyH7kVOmVn6y4g@mail.gmail.com>

Hi Winod,
Your first error message seems to be saying that you are passing a
function that returns an "ohic" object rather than the object. Maybe:

ohic<-get.ohlc.yahoo("GOOG",start="2020-12-18",end="2021-12-17")
candlestickChart(ohic,..)

would get you a bit further. Also it's obvious that the function wants
character dates with quotes around them. There seem to be quite a few
YouTube tutorials on candlestick charts.

Jim

On Sun, Dec 19, 2021 at 1:15 AM Winod Dhamnekar
<vinoddhamnekar11 at gmail.com> wrote:
>
> Hello,
> R users community,
>  I want to plot candlestickCharts of any stock prices of listed companies
> on any stock exchange (Indian or  worldwide) into r by using
> candlestickchart command in 'FinCal' r package. But I could not plot
> candlestic charts. R showed me errors.
>
>
>  candlestickChart(ohlc,2020-12-18,2021-12-17,"Google")
> Error in as.Date(ohlc$date) : object 'ohlc' not found
> > candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
> Error: object of type 'closure' is not subsettable
> > candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
> Error: object of type 'closure' is not subsettable
>
>
> What is the suitable syntax to use candlestickchart command from 'FinCal' r
> package?
>
> I also tried to fetch stock prices of listed companies on any stock
> exchange (wordwide or Indian) But I could not fetch stock prices.
>   # google <- get.ohlc.yahoo("GOOG",start="2014-07-01",end="2014-08-01");
> candlestickChart(google)
>  # google <- get.ohlc.yahoo("GOOG",start="2020-12-18",end="2021-12-17");
> candlestickChart(google)
> > candlestickChart(ohlc,2020-12-18,2021-12-17,"Google")
> Error in as.Date(ohlc$date) : object 'ohlc' not found
> > candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
> Error: object of type 'closure' is not subsettable
> > candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
> Error: object of type 'closure' is not subsettable
>
>  get.ohlc.yahoo("BOM:532504", 18-12-2021,17-12-2021,d)
> Error in strsplit(start, "-") : non-character argument
> > get.ohlc.yahoo('BOM:532504', 18-12-2021,17-12-2021,d)
> Error in strsplit(start, "-") : non-character argument
> > get.ohlc.yahoo(BOM:532504, 18-12-2021,17-12-2021,d)
> Error in strsplit(start, "-") : non-character argument
>  # google <- get.ohlc.yahoo("GOOG",start="2020-12-18",end="2021-12-17");
> candlestickChart(google)
> > candlestickChart(ohlc,2020-12-18,2021-12-17,"Google")
> Error in as.Date(ohlc$date) : object 'ohlc' not found
> > candlestickChart(get.ohlc.google,2020-12-18,2021-12-17,"Google")
> Error: object of type 'closure' is not subsettable
>  candlestickChart(ohlc,2020-12-18,2021-12-17,"Google")
> Error in as.Date(ohlc$date) : object 'ohlc' not found
>
>   How can I plot candlestickchart and fetch stock prices of any period with
> any frequency of time intervals?
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m@r|o_reutter @end|ng |rom web@de  Sat Dec 18 15:55:37 2021
From: m@r|o_reutter @end|ng |rom web@de (Mario Reutter)
Date: Sat, 18 Dec 2021 15:55:37 +0100
Subject: [R] Bug in list.files(full.names=T)
Message-ID: <CAAWr5boNy3Dizfw9HrruA1dvoXyFcwsT7Tw5fnqfUhBOimLKog@mail.gmail.com>

Dear everybody,

I'm a researcher in the field of psychology and a passionate R user. After
having updated to the newest version, I experienced a problem with
list.files() if the parameter full.names is set to TRUE.
A path separator "/" is now always appended to path in the output even if
path %>% endsWith("/"). This breaks backwards compatibility in case path
ends with a path separator. The problem occurred somewhere between R
version 3.6.1 (2019-07-05) and 4.1.2 (2021-11-01).

Example:
>> list.files("C:/Data/", full.names=T)
C:/Data//file.csv

Expected behavior:
Either a path separator should never be appended in accordance with
the documentation: "full.names
a logical value. If TRUE, the directory path is prepended to the file names
to give a relative file path."
Or it could only be appended if path doesn't already end with a path
separator.

My question would now be if this warrants a bug report? And if you agree,
could someone issue the report since I'm not a member on Bugzilla?

Thank you and best regards,
Mario Reutter

	[[alternative HTML version deleted]]


From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Sun Dec 19 12:45:38 2021
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Sun, 19 Dec 2021 11:45:38 +0000 (UTC)
Subject: [R] Speed up studentized confidence intervals ?
References: <721769419.5879847.1639914338826.ref@mail.yahoo.com>
Message-ID: <721769419.5879847.1639914338826@mail.yahoo.com>

Dear R-experts,

Here below my R code working but really really slowly ! I need 2 hours with my computer to finally get an answer ! Is there a way to improve my R code to speed it up ? At least to win 1 hour ;=)

Many thanks

########################################################
library(boot)

s<- sample(178:798, 100000, replace=TRUE)
mean(s)

N <- 1000
out <- replicate(N, {
a<- sample(s,size=5)
mean(a)
dat<-data.frame(a)

med<-function(d,i) {
temp<-d[i,]
f<-mean(temp)
g<-var(replicate(50,mean(sample(temp,replace=T))))
return(c(f,g))

}

? boot.out <- boot(data = dat, statistic = med, R = 10000)
? boot.ci(boot.out, type = "stud")$stud[, 4:5]
})
mean(out[1,] < mean(s) & mean(s) < out[2,]) 
########################################################


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Dec 19 13:24:06 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 19 Dec 2021 07:24:06 -0500
Subject: [R] Bug in list.files(full.names=T)
In-Reply-To: <CAAWr5boNy3Dizfw9HrruA1dvoXyFcwsT7Tw5fnqfUhBOimLKog@mail.gmail.com>
References: <CAAWr5boNy3Dizfw9HrruA1dvoXyFcwsT7Tw5fnqfUhBOimLKog@mail.gmail.com>
Message-ID: <67096ee7-054d-0e89-cc44-6ca702307196@gmail.com>

I don't know the answer to your question, but I see the same behaviour 
on MacOS, e.g. list.files("./") includes ".//R" in the results on my 
system.  Both "./R" and ".//R" are legal ways to express that path on 
MacOS, so it's not a serious bug, but it does look ugly.

Duncan Murdoch

On 18/12/2021 9:55 a.m., Mario Reutter wrote:
> Dear everybody,
> 
> I'm a researcher in the field of psychology and a passionate R user. After
> having updated to the newest version, I experienced a problem with
> list.files() if the parameter full.names is set to TRUE.
> A path separator "/" is now always appended to path in the output even if
> path %>% endsWith("/"). This breaks backwards compatibility in case path
> ends with a path separator. The problem occurred somewhere between R
> version 3.6.1 (2019-07-05) and 4.1.2 (2021-11-01).
> 
> Example:
>>> list.files("C:/Data/", full.names=T)
> C:/Data//file.csv
> 
> Expected behavior:
> Either a path separator should never be appended in accordance with
> the documentation: "full.names
> a logical value. If TRUE, the directory path is prepended to the file names
> to give a relative file path."
> Or it could only be appended if path doesn't already end with a path
> separator.
> 
> My question would now be if this warrants a bug report? And if you agree,
> could someone issue the report since I'm not a member on Bugzilla?
> 
> Thank you and best regards,
> Mario Reutter
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m||uj|@b @end|ng |rom gm@||@com  Sun Dec 19 19:31:34 2021
From: m||uj|@b @end|ng |rom gm@||@com (Miluji Sb)
Date: Sun, 19 Dec 2021 19:31:34 +0100
Subject: [R] Sum every n (4) observations by group
Message-ID: <CAMLwc7MCGj6hsDes=Sj-fA5fcFMNkPXyZvucDKFWRJKPQGu3ow@mail.gmail.com>

Dear all,

I have a dataset (below) by ID and time sequence. I would like to sum every
four observations by ID.

I am confused how to combine the two conditions. Any help will be highly
appreciated. Thank you!

Best.

Milu

## Dataset
structure(list(ID = c("A", "A", "A", "A", "A", "A", "A", "A",
"B", "B", "B", "B", "B", "B", "B", "B", "C", "C", "C", "C", "C",
"C", "C", "C"), Date = c(4140L, 4141L, 4142L, 4143L, 4144L, 4145L,
4146L, 4147L, 4140L, 4141L, 4142L, 4143L, 4144L, 4145L, 4146L,
4147L, 4140L, 4141L, 4142L, 4143L, 4144L, 4145L, 4146L, 4147L
), Value = c(0.000207232, 0.000240141, 0.000271414, 0.000258384,
0.00024364, 0.00027148, 0.000280585, 0.000289691, 0.000298797,
0.000307903, 0.000317008, 0.000326114, 0.00033522, 0.000344326,
0.000353431, 0.000362537, 0.000371643, 0.000380749, 0.000389854,
0.00039896, 0.000408066, 0.000417172, 0.000426277, 0.000435383
)), class = "data.frame", row.names = c(NA, -24L))

	[[alternative HTML version deleted]]


From peter@|@ng|e|der @end|ng |rom gm@||@com  Sun Dec 19 19:49:59 2021
From: peter@|@ng|e|der @end|ng |rom gm@||@com (Peter Langfelder)
Date: Sun, 19 Dec 2021 10:49:59 -0800
Subject: [R] Sum every n (4) observations by group
In-Reply-To: <CAMLwc7MCGj6hsDes=Sj-fA5fcFMNkPXyZvucDKFWRJKPQGu3ow@mail.gmail.com>
References: <CAMLwc7MCGj6hsDes=Sj-fA5fcFMNkPXyZvucDKFWRJKPQGu3ow@mail.gmail.com>
Message-ID: <CA+hbrhUM9G_C=gyxooBsc7aG0kjJnv77S1Cv_u0-AAY5Fg=edw@mail.gmail.com>

I'm not sure I understand the task, but if I do, assuming your data
frame is assigned to a variable named df, I would do something like

sumNs = function(x, n)
{
   if (length(x) %%n !=0) stop("Length of 'x' must be a multiple of 'n'.")
   n1 = length(x)/n
   ind = rep(1:n1, each = n)
   tapply(x, ind, sum)
}
sums = tapply(df$Value, df$ID, sumNs, 4)

Peter

On Sun, Dec 19, 2021 at 10:32 AM Miluji Sb <milujisb at gmail.com> wrote:
>
> Dear all,
>
> I have a dataset (below) by ID and time sequence. I would like to sum every
> four observations by ID.
>
> I am confused how to combine the two conditions. Any help will be highly
> appreciated. Thank you!
>
> Best.
>
> Milu
>
> ## Dataset
> structure(list(ID = c("A", "A", "A", "A", "A", "A", "A", "A",
> "B", "B", "B", "B", "B", "B", "B", "B", "C", "C", "C", "C", "C",
> "C", "C", "C"), Date = c(4140L, 4141L, 4142L, 4143L, 4144L, 4145L,
> 4146L, 4147L, 4140L, 4141L, 4142L, 4143L, 4144L, 4145L, 4146L,
> 4147L, 4140L, 4141L, 4142L, 4143L, 4144L, 4145L, 4146L, 4147L
> ), Value = c(0.000207232, 0.000240141, 0.000271414, 0.000258384,
> 0.00024364, 0.00027148, 0.000280585, 0.000289691, 0.000298797,
> 0.000307903, 0.000317008, 0.000326114, 0.00033522, 0.000344326,
> 0.000353431, 0.000362537, 0.000371643, 0.000380749, 0.000389854,
> 0.00039896, 0.000408066, 0.000417172, 0.000426277, 0.000435383
> )), class = "data.frame", row.names = c(NA, -24L))
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m||uj|@b @end|ng |rom gm@||@com  Sun Dec 19 21:01:17 2021
From: m||uj|@b @end|ng |rom gm@||@com (Miluji Sb)
Date: Sun, 19 Dec 2021 21:01:17 +0100
Subject: [R] Sum every n (4) observations by group
In-Reply-To: <CA+hbrhUM9G_C=gyxooBsc7aG0kjJnv77S1Cv_u0-AAY5Fg=edw@mail.gmail.com>
References: <CAMLwc7MCGj6hsDes=Sj-fA5fcFMNkPXyZvucDKFWRJKPQGu3ow@mail.gmail.com>
 <CA+hbrhUM9G_C=gyxooBsc7aG0kjJnv77S1Cv_u0-AAY5Fg=edw@mail.gmail.com>
Message-ID: <CAMLwc7N_9P_30NNpiJnhUA3eyEsNL5b1y_xvmCZs7F_yJ2mjzQ@mail.gmail.com>

Dear Peter,

Thanks so much for your reply and the code! This is helpful.

What I would like is the data.frame below - sum values for *4140, 4141,
4142, 4143 *and then for *4144, 4145, 4146, 4147 *for IDs A, B, and C. Does
that make sense? Thanks again!

Best.

Milu

results <- structure(list(ID = c("A", "A", "A", "A", "A", "A", "A", "A",
"B", "B", "B", "B", "B", "B", "B", "B", "C", "C", "C", "C", "C",
"C", "C", "C"), Date = c(4140L, 4141L, 4142L, 4143L, 4144L, 4145L,
4146L, 4147L, 4140L, 4141L, 4142L, 4143L, 4144L, 4145L, 4146L,
4147L, 4140L, 4141L, 4142L, 4143L, 4144L, 4145L, 4146L, 4147L
), Value = c(0.000207232, 0.000240141, 0.000271414, 0.000258384,
0.00024364, 0.00027148, 0.000280585, 0.000289691, 0.000298797,
0.000307903, 0.000317008, 0.000326114, 0.00033522, 0.000344326,
0.000353431, 0.000362537, 0.000371643, 0.000380749, 0.000389854,
0.00039896, 0.000408066, 0.000417172, 0.000426277, 0.000435383
), sum = c(NA, NA, NA, 0.000977171, NA, NA, NA, 0.001054089,
NA, NA, NA, 0.001213399, NA, NA, NA, 0.001395514, NA, NA, NA,
0.001541206, NA, NA, NA, 0.001686898)), class = "data.frame", row.names =
c(NA,
-24L))

On Sun, Dec 19, 2021 at 7:50 PM Peter Langfelder <peter.langfelder at gmail.com>
wrote:

> I'm not sure I understand the task, but if I do, assuming your data
> frame is assigned to a variable named df, I would do something like
>
> sumNs = function(x, n)
> {
>    if (length(x) %%n !=0) stop("Length of 'x' must be a multiple of 'n'.")
>    n1 = length(x)/n
>    ind = rep(1:n1, each = n)
>    tapply(x, ind, sum)
> }
> sums = tapply(df$Value, df$ID, sumNs, 4)
>
> Peter
>
> On Sun, Dec 19, 2021 at 10:32 AM Miluji Sb <milujisb at gmail.com> wrote:
> >
> > Dear all,
> >
> > I have a dataset (below) by ID and time sequence. I would like to sum
> every
> > four observations by ID.
> >
> > I am confused how to combine the two conditions. Any help will be highly
> > appreciated. Thank you!
> >
> > Best.
> >
> > Milu
> >
> > ## Dataset
> > structure(list(ID = c("A", "A", "A", "A", "A", "A", "A", "A",
> > "B", "B", "B", "B", "B", "B", "B", "B", "C", "C", "C", "C", "C",
> > "C", "C", "C"), Date = c(4140L, 4141L, 4142L, 4143L, 4144L, 4145L,
> > 4146L, 4147L, 4140L, 4141L, 4142L, 4143L, 4144L, 4145L, 4146L,
> > 4147L, 4140L, 4141L, 4142L, 4143L, 4144L, 4145L, 4146L, 4147L
> > ), Value = c(0.000207232, 0.000240141, 0.000271414, 0.000258384,
> > 0.00024364, 0.00027148, 0.000280585, 0.000289691, 0.000298797,
> > 0.000307903, 0.000317008, 0.000326114, 0.00033522, 0.000344326,
> > 0.000353431, 0.000362537, 0.000371643, 0.000380749, 0.000389854,
> > 0.00039896, 0.000408066, 0.000417172, 0.000426277, 0.000435383
> > )), class = "data.frame", row.names = c(NA, -24L))
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @v|gro@@ @end|ng |rom ver|zon@net  Sun Dec 19 21:09:53 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Sun, 19 Dec 2021 15:09:53 -0500
Subject: [R] Sum every n (4) observations by group
In-Reply-To: <CAMLwc7MCGj6hsDes=Sj-fA5fcFMNkPXyZvucDKFWRJKPQGu3ow@mail.gmail.com>
References: <CAMLwc7MCGj6hsDes=Sj-fA5fcFMNkPXyZvucDKFWRJKPQGu3ow@mail.gmail.com>
Message-ID: <00f001d7f514$62b57850$282068f0$@verizon.net>

Milu,

Your data seems to be very consistent in that each value of ID has eight
rows. You seem to want to just sum every four so that fits:

   ID Date       Value
1   A 4140 0.000207232
2   A 4141 0.000240141
3   A 4142 0.000271414
4   A 4143 0.000258384
5   A 4144 0.000243640
6   A 4145 0.000271480
7   A 4146 0.000280585
8   A 4147 0.000289691
9   B 4140 0.000298797
10  B 4141 0.000307903
11  B 4142 0.000317008
12  B 4143 0.000326114
13  B 4144 0.000335220
14  B 4145 0.000344326
15  B 4146 0.000353431
16  B 4147 0.000362537
17  C 4140 0.000371643
18  C 4141 0.000380749
19  C 4142 0.000389854
20  C 4143 0.000398960
21  C 4144 0.000408066
22  C 4145 0.000417172
23  C 4146 0.000426277
24  C 4147 0.000435383

There are many ways to do what you want, some more general than others, but
one trivial way is to add a column that contains 24 numbers ranging from 1
to 6 like this assuming mydf holds the above:

Here is an example of such a vector:

rep(1:(nrow(mydf)/4), each=4)
 [1] 1 1 1 1 2 2 2 2 3 3 3 3 4 4 4 4 5 5 5 5 6 6 6 6

So you can add a column like:

> mydf$fours <- rep(1:(nrow(mydf)/4), each=4)
> mydf
   ID Date       Value fours
1   A 4140 0.000207232     1
2   A 4141 0.000240141     1
3   A 4142 0.000271414     1
4   A 4143 0.000258384     1
5   A 4144 0.000243640     2
6   A 4145 0.000271480     2
7   A 4146 0.000280585     2
8   A 4147 0.000289691     2
9   B 4140 0.000298797     3
10  B 4141 0.000307903     3
11  B 4142 0.000317008     3
12  B 4143 0.000326114     3
13  B 4144 0.000335220     4
14  B 4145 0.000344326     4
15  B 4146 0.000353431     4
16  B 4147 0.000362537     4
17  C 4140 0.000371643     5
18  C 4141 0.000380749     5
19  C 4142 0.000389854     5
20  C 4143 0.000398960     5
21  C 4144 0.000408066     6
22  C 4145 0.000417172     6
23  C 4146 0.000426277     6
24  C 4147 0.000435383     6

You now use grouping any way you want to apply a function and in this case
you want a sum. I like to use the tidyverse functions so will show that as
in:

mydf %>%
  group_by(ID, fours) %>%
  summarize(sums=sum(Value), n=n())

I threw in the extra column in case your data sometimes does not have 4 at
the end of a group or beginning of next. Here is the output:

# A tibble: 6 x 4
# Groups:   ID [3]
ID    fours     sums     n
<chr> <int>    <dbl> <int>
  1 A         1 0.000977     4
2 A         2 0.00109      4
3 B         3 0.00125      4
4 B         4 0.00140      4
5 C         5 0.00154      4
6 C         6 0.00169      4

Of course there are all kinds of ways to do this in standard R, including
trivial ones like looping over indices starting at 1 and taking four at a
time and getting the Value data for mydf$Value[N] + mydf$Value[N+1] ...



-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Miluji Sb
Sent: Sunday, December 19, 2021 1:32 PM
To: r-help mailing list <r-help at r-project.org>
Subject: [R] Sum every n (4) observations by group

Dear all,

I have a dataset (below) by ID and time sequence. I would like to sum every
four observations by ID.

I am confused how to combine the two conditions. Any help will be highly
appreciated. Thank you!

Best.

Milu

## Dataset
structure(list(ID = c("A", "A", "A", "A", "A", "A", "A", "A", "B", "B", "B",
"B", "B", "B", "B", "B", "C", "C", "C", "C", "C", "C", "C", "C"), Date =
c(4140L, 4141L, 4142L, 4143L, 4144L, 4145L, 4146L, 4147L, 4140L, 4141L,
4142L, 4143L, 4144L, 4145L, 4146L, 4147L, 4140L, 4141L, 4142L, 4143L, 4144L,
4145L, 4146L, 4147L ), Value = c(0.000207232, 0.000240141, 0.000271414,
0.000258384, 0.00024364, 0.00027148, 0.000280585, 0.000289691, 0.000298797,
0.000307903, 0.000317008, 0.000326114, 0.00033522, 0.000344326, 0.000353431,
0.000362537, 0.000371643, 0.000380749, 0.000389854, 0.00039896, 0.000408066,
0.000417172, 0.000426277, 0.000435383 )), class = "data.frame", row.names =
c(NA, -24L))

	[[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From @k@h@y_e4 @end|ng |rom hotm@||@com  Mon Dec 20 08:28:40 2021
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Mon, 20 Dec 2021 07:28:40 +0000
Subject: [R] help with LDA topic modelling..
Message-ID: <PU4P216MB1568B65E87FF7D9C1AA12674C87B9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

dear members,
                         I am using LDA for topic modelling of news articles (topicmodels package). I am visualizing the accuracy with the LDAvis package.

The visualization shows clusters as circles, probably intersecting. My question is, if a find the optimal number of topics, k, and if the circles representing the topics doesn't intersect, then I have achieved perfect segregation. AM I right?

Thanking You,
Yours sincerely,
AKSHAY M KULKARNI

	[[alternative HTML version deleted]]


From drj|m|emon @end|ng |rom gm@||@com  Mon Dec 20 09:13:49 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Mon, 20 Dec 2021 19:13:49 +1100
Subject: [R] help with LDA topic modelling..
In-Reply-To: <PU4P216MB1568B65E87FF7D9C1AA12674C87B9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
References: <PU4P216MB1568B65E87FF7D9C1AA12674C87B9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
Message-ID: <CA+8X3fUa2A1g33_=XFQee8sG8QsfdQjPCcrsy441_jkdxieytA@mail.gmail.com>

Hi Akshay,
It depends upon how the circles are calculated. If each circle
encloses all of the members of each group, yes. I doubt you would get
perfect separation in any real example, though. At the moment:
Hanukkah is finished,
Margashirsha Punima has just happened and
Christmas is coming up.
No matter how devout the adherents, I don't think you would find news
articles that only mentioned one of these festivals. Less facetious
groupings would suffer the same eclectic problem.

Jim

On Mon, Dec 20, 2021 at 6:29 PM akshay kulkarni <akshay_e4 at hotmail.com> wrote:
>
> dear members,
>                          I am using LDA for topic modelling of news articles (topicmodels package). I am visualizing the accuracy with the LDAvis package.
>
> The visualization shows clusters as circles, probably intersecting. My question is, if a find the optimal number of topics, k, and if the circles representing the topics doesn't intersect, then I have achieved perfect segregation. AM I right?
>
> Thanking You,
> Yours sincerely,
> AKSHAY M KULKARNI
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Mon Dec 20 09:46:23 2021
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Mon, 20 Dec 2021 09:46:23 +0100
Subject: [R] Bug in list.files(full.names=T)
In-Reply-To: <CAAWr5boNy3Dizfw9HrruA1dvoXyFcwsT7Tw5fnqfUhBOimLKog@mail.gmail.com>
References: <CAAWr5boNy3Dizfw9HrruA1dvoXyFcwsT7Tw5fnqfUhBOimLKog@mail.gmail.com>
Message-ID: <25024.17119.584361.442267@stat.math.ethz.ch>

>>>>> Mario Reutter 
>>>>>     on Sat, 18 Dec 2021 15:55:37 +0100 writes:

    > Dear everybody,

    > I'm a researcher in the field of psychology and a
    > passionate R user. After having updated to the newest
    > version, I experienced a problem with list.files() if the
    > parameter full.names is set to TRUE.  A path separator "/"
    > is now always appended to path in the output even if path
    > %>% endsWith("/"). This breaks backwards compatibility in
    > case path ends with a path separator. The problem occurred
    > somewhere between R version 3.6.1 (2019-07-05) and 4.1.2
    > (2021-11-01).

    > Example:
    >>> list.files("C:/Data/", full.names=T)
    > C:/Data//file.csv

    > Expected behavior: Either a path separator should never be
    > appended in accordance with the documentation: "full.names
    > a logical value. If TRUE, the directory path is prepended
    > to the file names to give a relative file path."  Or it
    > could only be appended if path doesn't already end with a
    > path separator.

This expected behavior has never been documented AFAIK.
I tried R 3.6.1 on Linux  and it already behaved like that:  If
you append a path separator  it is kept in addition to the new
one even though it's not needed:

> list.files("/tmp", "^[abc]", full.names = TRUE)
[1] "/tmp/check_proc__localuser"

> list.files("/tmp/", "^[abc]", full.names = TRUE)
[1] "/tmp//check_proc__localuser"

Why would one ever *add* a final unneeded path separator, unless
one wanted it?

Note that the default is  ".",  not "./"  ..

I think the change you see made R-for-Windows compatible
to the rest of the univeRse where list.files() aka dir() always
behaved like this.

I agree that ideally this would have been mentioned in some of
the NEWS; maybe it *is* mentioned in the rw-faw (R for Windows
FAQ) or other R for Windows news.. ?


    > My question would now be if this warrants a bug report?

I don't think so.
As I'm saying above, I think this has rather been a bug fix,
making R more universal / less platform-dependent.

Last but not least: You'd ideally update more than every 2.5 years...

Best,
Martin Maechler



    > And if you agree, could someone issue the report since I'm
    > not a member on Bugzilla?

    > Thank you and best regards, Mario Reutter


From @k@h@y_e4 @end|ng |rom hotm@||@com  Mon Dec 20 11:22:10 2021
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Mon, 20 Dec 2021 10:22:10 +0000
Subject: [R] help with LDA topic modelling..
In-Reply-To: <CA+8X3fUa2A1g33_=XFQee8sG8QsfdQjPCcrsy441_jkdxieytA@mail.gmail.com>
References: <PU4P216MB1568B65E87FF7D9C1AA12674C87B9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <CA+8X3fUa2A1g33_=XFQee8sG8QsfdQjPCcrsy441_jkdxieytA@mail.gmail.com>
Message-ID: <PU4P216MB156881C572F32E1A196F4581C87B9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

Thanks a lot
________________________________
From: Jim Lemon <drjimlemon at gmail.com>
Sent: Monday, December 20, 2021 1:43 PM
To: akshay kulkarni <akshay_e4 at hotmail.com>
Cc: R help Mailing list <r-help at r-project.org>
Subject: Re: [R] help with LDA topic modelling..

Hi Akshay,
It depends upon how the circles are calculated. If each circle
encloses all of the members of each group, yes. I doubt you would get
perfect separation in any real example, though. At the moment:
Hanukkah is finished,
Margashirsha Punima has just happened and
Christmas is coming up.
No matter how devout the adherents, I don't think you would find news
articles that only mentioned one of these festivals. Less facetious
groupings would suffer the same eclectic problem.

Jim

On Mon, Dec 20, 2021 at 6:29 PM akshay kulkarni <akshay_e4 at hotmail.com> wrote:
>
> dear members,
>                          I am using LDA for topic modelling of news articles (topicmodels package). I am visualizing the accuracy with the LDAvis package.
>
> The visualization shows clusters as circles, probably intersecting. My question is, if a find the optimal number of topics, k, and if the circles representing the topics doesn't intersect, then I have achieved perfect segregation. AM I right?
>
> Thanking You,
> Yours sincerely,
> AKSHAY M KULKARNI
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From |eo@m@d@ @end|ng |rom @yon|c@eu  Mon Dec 20 12:56:13 2021
From: |eo@m@d@ @end|ng |rom @yon|c@eu (Leonard Mada)
Date: Mon, 20 Dec 2021 13:56:13 +0200
Subject: [R] Sum every n (4) observations by group
Message-ID: <4ef13644-5a57-3f5b-d76a-082511907a85@syonic.eu>

Dear Miluji,


something like this could help:

sapply(tapply(x$Value, x$ID, cumsum),

 ??? function(x) x[seq(4, length(x), by=4)] - c(0, x[head(seq(4, 
length(x), by=4), -1)]))

1.) Step 1:

Compute the cumsum for each ID:

tapply(x$Value, x$ID, cumsum)


2.) Step 2:

- iterate over the resulting list and select each 4th value;

- you can either run a diff on this or subtract directly the (n-4) sum;


Note:

- you may wish to check if the last value is a multiple of 4;

- alternative: you can do a LOCF (last observation carried forward);


Hope this code example helps.


Sincerely,


Leonard


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Mon Dec 20 15:09:15 2021
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Mon, 20 Dec 2021 15:09:15 +0100
Subject: [R] Call for proposals to organize useR! 2023 as a hybrid conference
Message-ID: <25024.36491.616298.152473@stat.math.ethz.ch>


Dear All,

The R Foundation Conference Committee invites proposals to organize useR! 2023 as a hybrid conference:

https://www.r-project.org/conferences/useR_2023_call.html

The call is open to hosts worldwide and the deadline for outline proposals is **Friday 28 January 2022**. 

Any queries should be sent to R-conferences at r-project.org (after a careful read of the call!).

Best wishes,

Heather Turner
on behalf of the R Foundation Conference Committee

_______________________________________________
R-announce at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-announce


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Mon Dec 20 16:50:36 2021
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Mon, 20 Dec 2021 16:50:36 +0100
Subject: [R] Bug in list.files(full.names=T)
In-Reply-To: <25024.17119.584361.442267@stat.math.ethz.ch>
References: <CAAWr5boNy3Dizfw9HrruA1dvoXyFcwsT7Tw5fnqfUhBOimLKog@mail.gmail.com>
 <25024.17119.584361.442267@stat.math.ethz.ch>
Message-ID: <25024.42572.961443.768850@stat.math.ethz.ch>

>>>>> Martin Maechler 
>>>>>     on Mon, 20 Dec 2021 09:46:23 +0100 writes:

>>>>> Mario Reutter 
>>>>>     on Sat, 18 Dec 2021 15:55:37 +0100 writes:

    >> Dear everybody,

    >> I'm a researcher in the field of psychology and a
    >> passionate R user. After having updated to the newest
    >> version, I experienced a problem with list.files() if the
    >> parameter full.names is set to TRUE.  A path separator
    >> "/" is now always appended to path in the output even if
    >> path %>% endsWith("/"). This breaks backwards
    >> compatibility in case path ends with a path
    >> separator. The problem occurred somewhere between R
    >> version 3.6.1 (2019-07-05) and 4.1.2 (2021-11-01).

    >> Example:
    >>>> list.files("C:/Data/", full.names=T)
    >> C:/Data//file.csv

    >> Expected behavior: Either a path separator should never
    >> be appended in accordance with the documentation:
    >> "full.names a logical value. If TRUE, the directory path
    >> is prepended to the file names to give a relative file
    >> path."  Or it could only be appended if path doesn't
    >> already end with a path separator.

    > This expected behavior has never been documented AFAIK.  I
    > tried R 3.6.1 on Linux and it already behaved like that:
    > If you append a path separator it is kept in addition to
    > the new one even though it's not needed:

    >> list.files("/tmp", "^[abc]", full.names = TRUE)
    > [1] "/tmp/check_proc__localuser"

    >> list.files("/tmp/", "^[abc]", full.names = TRUE)
    > [1] "/tmp//check_proc__localuser"

    > Why would one ever *add* a final unneeded path separator,
    > unless one wanted it?

    > Note that the default is ".", not "./" ..

    > I think the change you see made R-for-Windows compatible
    > to the rest of the univeRse where list.files() aka dir()
    > always behaved like this.

    > I agree that ideally this would have been mentioned in
    > some of the NEWS; maybe it *is* mentioned in the rw-faw (R
    > for Windows FAQ) or other R for Windows news.. ?

On the other hand, now that I tried it,
on the Windows Terminal Server 2016 I've access to,
I see what you said *was* your previous behavior, i.e.,
I see this {R code with comments for what I see} :

##
str(c0 <- list.files("C:/"))
## chr [1:23] "$Recycle.Bin" "536F22AB9746" "Boot" "bootmgr" "BOOTNxsXT" ...
str(c1 <- list.files("C:/Boot", full.names=TRUE))
str(c1s <- list.files("C:/Boot/", full.names=TRUE))# extra '/' at end
## but even here, the extra trailing '/' does *not* harm
all(c1 == c1s) ## TRUE !

The above, using ESS and plain RGui Windows *and* Rstudio;
for ESS in the following of my (dozen or so on Windows server) R versions :
R 3.6.1, 4.0.0, 4.1.1, 4.1.2

... so I remain quite a bit puzzled...

Maybe other R-on-Windows users can have a look?
Martin

    >> My question would now be if this warrants a bug report?

    > I don't think so.  As I'm saying above, I think this has
    > rather been a bug fix, making R more universal / less
    > platform-dependent.

    > Last but not least: You'd ideally update more than every
    > 2.5 years...

    > Best, Martin Maechler



    >> And if you agree, could someone issue the report since
    >> I'm not a member on Bugzilla?

    >> Thank you and best regards, Mario Reutter

    > ______________________________________________
    > R-help at r-project.org mailing list -- To UNSUBSCRIBE and
    > more, see https://stat.ethz.ch/mailman/listinfo/r-help
    > PLEASE do read the posting guide
    > http://www.R-project.org/posting-guide.html and provide
    > commented, minimal, self-contained, reproducible code.


From JH@rm@e @end|ng |rom roku@com  Mon Dec 20 17:13:01 2021
From: JH@rm@e @end|ng |rom roku@com (Jorgen Harmse)
Date: Mon, 20 Dec 2021 16:13:01 +0000
Subject: [R] Bug in list.files(full.names=T)
Message-ID: <E64821C0-398A-42E0-8284-0A4D400D6E15@roku.com>

There is a possibly related problem in file.path. As Murdoch says, it's ugly even if the OS accepts it, and I don't see that the base version is any better than paste(sep=fsep, ...). Pasting the result into emacs wouldn't work. I wrote my own version to remove trailing fsep from all but the last argument.

> base::file.path('foo/','bar')
[1] "foo//bar"
> file.path('foo/','bar')
[1] "foo/bar"

Incidentally, I don't like T & F for Booleans (or t for transpose) in production code. Single letters are too useful for local variables, so I would say TRUE, FALSE, & base::t.

Jorgen Harmse.



    Message: 1
    Date: Sat, 18 Dec 2021 15:55:37 +0100
    From: Mario Reutter <mario_reutter at web.de>
    To: r-help at r-project.org
    Subject: [R] Bug in list.files(full.names=T)
    Message-ID:
    	<CAAWr5boNy3Dizfw9HrruA1dvoXyFcwsT7Tw5fnqfUhBOimLKog at mail.gmail.com>
    Content-Type: text/plain; charset="utf-8"

    Dear everybody,

    I'm a researcher in the field of psychology and a passionate R user. After
    having updated to the newest version, I experienced a problem with
    list.files() if the parameter full.names is set to TRUE.
    A path separator "/" is now always appended to path in the output even if
    path %>% endsWith("/"). This breaks backwards compatibility in case path
    ends with a path separator. The problem occurred somewhere between R
    version 3.6.1 (2019-07-05) and 4.1.2 (2021-11-01).

    Example:
    >> list.files("C:/Data/", full.names=T)
    C:/Data//file.csv

    Expected behavior:
    Either a path separator should never be appended in accordance with
    the documentation: "full.names
    a logical value. If TRUE, the directory path is prepended to the file names
    to give a relative file path."
    Or it could only be appended if path doesn't already end with a path
    separator.

    My question would now be if this warrants a bug report? And if you agree,
    could someone issue the report since I'm not a member on Bugzilla?

    Thank you and best regards,
    Mario Reutter

    	[[alternative HTML version deleted]]




    ------------------------------

    

    Message: 3
    Date: Sun, 19 Dec 2021 07:24:06 -0500
    From: Duncan Murdoch <murdoch.duncan at gmail.com>
    To: Mario Reutter <mario_reutter at web.de>, r-help at r-project.org
    Subject: Re: [R] Bug in list.files(full.names=T)
    Message-ID: <67096ee7-054d-0e89-cc44-6ca702307196 at gmail.com>
    Content-Type: text/plain; charset="utf-8"; Format="flowed"

    I don't know the answer to your question, but I see the same behaviour 
    on MacOS, e.g. list.files("./") includes ".//R" in the results on my 
    system.  Both "./R" and ".//R" are legal ways to express that path on 
    MacOS, so it's not a serious bug, but it does look ugly.

    Duncan Murdoch

...


    ------------------------------

    Message: 10
    Date: Mon, 20 Dec 2021 09:46:23 +0100
    From: Martin Maechler <maechler at stat.math.ethz.ch>
    To: Mario Reutter <mario_reutter at web.de>
    Cc: <r-help at r-project.org>
    Subject: Re: [R] Bug in list.files(full.names=T)
    Message-ID: <25024.17119.584361.442267 at stat.math.ethz.ch>
    Content-Type: text/plain; charset="us-ascii"

...

    This expected behavior has never been documented AFAIK.
    I tried R 3.6.1 on Linux  and it already behaved like that:  If
    you append a path separator  it is kept in addition to the new
    one even though it's not needed:

    > list.files("/tmp", "^[abc]", full.names = TRUE)
    [1] "/tmp/check_proc__localuser"

    > list.files("/tmp/", "^[abc]", full.names = TRUE)
    [1] "/tmp//check_proc__localuser"

    Why would one ever *add* a final unneeded path separator, unless
    one wanted it?

    Note that the default is  ".",  not "./"  ..

    I think the change you see made R-for-Windows compatible
    to the rest of the univeRse where list.files() aka dir() always
    behaved like this.

    I agree that ideally this would have been mentioned in some of
    the NEWS; maybe it *is* mentioned in the rw-faw (R for Windows
    FAQ) or other R for Windows news.. ?


        > My question would now be if this warrants a bug report?

    I don't think so.
    As I'm saying above, I think this has rather been a bug fix,
    making R more universal / less platform-dependent.

    Last but not least: You'd ideally update more than every 2.5 years...

    Best,
    Martin Maechler





From w||||@mwdun|@p @end|ng |rom gm@||@com  Mon Dec 20 17:40:04 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Mon, 20 Dec 2021 08:40:04 -0800
Subject: [R] Bug in list.files(full.names=T)
In-Reply-To: <25024.42572.961443.768850@stat.math.ethz.ch>
References: <CAAWr5boNy3Dizfw9HrruA1dvoXyFcwsT7Tw5fnqfUhBOimLKog@mail.gmail.com>
 <25024.17119.584361.442267@stat.math.ethz.ch>
 <25024.42572.961443.768850@stat.math.ethz.ch>
Message-ID: <CAHqSRuQLZoZKtFJtMjfwk13+v4z05wUy=xp9jv-VmyMybNPJSw@mail.gmail.com>

>
>     > Why would one ever *add* a final unneeded path separator,
>     > unless one wanted it?
>

Good question, but it is common for Windows installer programs to add a
terminal backslash to PATH entries.  E.g., on my Windows laptop I get

> grep(value=TRUE, "\\\\$", strsplit(Sys.getenv("PATH"), ";")[[1]])
[1] "C:\\Python39\\Scripts\\"
[2] "C:\\Python39\\"
[3] "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\"
[4] "C:\\WINDOWS\\System32\\OpenSSH\\"
[5] "C:\\Program Files\\nodejs\\"
[6] "C:\\Program Files\\Pandoc\\"
[7] "C:\\Program Files\\MiKTeX\\miktex\\bin\\x64\\"
[8] "C:\\Program Files\\PuTTY\\"

I did not add those entries by hand; all were added by installer programs.

-Bill

	[[alternative HTML version deleted]]


From @erv|ce @end|ng |rom @hd@w@on@com  Mon Dec 20 17:58:48 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Mon, 20 Dec 2021 11:58:48 -0500
Subject: [R] Adding SORT to UNIQUE
Message-ID: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>

Hi,


Running a simple syntax set to review entries in dataframe columns. Here 
is the working code.

Data <- read.csv("./input/Source.csv", header=T)
describe(Data)
summary(Data)
unique(Data[1])
unique(Data[2])
unique(Data[3])
unique(Data[4])

I would like to add sort the unique entries. The data in the various 
columns are not defined as numbers, but also text. I realize 1 and 10 
will not sort properly, as the column is not defined as a number, but 
want to see what I have in the columns viewed as sorted.

QUESTION
What is the best process to sort unique output, please?


Thanks.
-- 
*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Dec 20 18:05:33 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 20 Dec 2021 17:05:33 +0000
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
Message-ID: <748ab641-0036-c56b-bc9c-507807575980@sapo.pt>

Hello,

Package stringr has functions str_sort and str_order, both with an 
argument 'numeric' that will sort the numbers correctly.
Maybe that's what you are looking for, see the example below.


x <- sample(sprintf("ab%d", 1:20))     # shuffle the vector
stringr::str_sort(x, numeric = TRUE)   # sort considering the numbers


Hope this helps,

Rui Barradas


?s 16:58 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
> Hi,
> 
> 
> Running a simple syntax set to review entries in dataframe columns. Here 
> is the working code.
> 
> Data <- read.csv("./input/Source.csv", header=T)
> describe(Data)
> summary(Data)
> unique(Data[1])
> unique(Data[2])
> unique(Data[3])
> unique(Data[4])
> 
> I would like to add sort the unique entries. The data in the various 
> columns are not defined as numbers, but also text. I realize 1 and 10 
> will not sort properly, as the column is not defined as a number, but 
> want to see what I have in the columns viewed as sorted.
> 
> QUESTION
> What is the best process to sort unique output, please?
> 
> 
> Thanks.


From @v|gro@@ @end|ng |rom ver|zon@net  Mon Dec 20 18:15:06 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Mon, 20 Dec 2021 12:15:06 -0500
Subject: [R] Adding SORT to UNIQUE
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com> 
Message-ID: <01b301d7f5c5$22e19310$68a4b930$@verizon.net>

Stephen,

You can sort using sort() either before or after doing a unique. Unique
removes all duplicates in any order so sorting before may be wasteful. in
your data shown below, do this:

sort(unique(Data[1]))
sort(unique(Data[2]))
sort(unique(Data[3]))
sort(unique(Data[4]))

Even simpler is to define a function like this:

unisort <- function(vec) sort(unique(vec))

and use it like this:

unisort(Data[1])


And since you seem to want all of the first four columns of Data you may
want to do them all at once using something like:

lapply(Data[1:4], unisort)

As you note, the sort ordering depends on the data and perhaps on options
you specify.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
DSL via R-help
Sent: Monday, December 20, 2021 11:59 AM
To: Stephen H. Dawson, DSL via R-help <r-help at r-project.org>
Subject: [R] Adding SORT to UNIQUE

Hi,


Running a simple syntax set to review entries in dataframe columns. Here is
the working code.

Data <- read.csv("./input/Source.csv", header=T)
describe(Data)
summary(Data)
unique(Data[1])
unique(Data[2])
unique(Data[3])
unique(Data[4])

I would like to add sort the unique entries. The data in the various columns
are not defined as numbers, but also text. I realize 1 and 10 will not sort
properly, as the column is not defined as a number, but want to see what I
have in the columns viewed as sorted.

QUESTION
What is the best process to sort unique output, please?


Thanks.
--
*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Mon Dec 20 18:26:24 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Mon, 20 Dec 2021 09:26:24 -0800
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
Message-ID: <71BCBC21-7EFE-4C20-8E09-BB3E4074420C@dcn.davis.ca.us>

What is wrong with

as.data.frame(lapply( Data, sort, decreasing = TRUE ))

?


On December 20, 2021 8:58:48 AM PST, "Stephen H. Dawson, DSL via R-help" <r-help at r-project.org> wrote:
>Hi,
>
>
>Running a simple syntax set to review entries in dataframe columns. Here 
>is the working code.
>
>Data <- read.csv("./input/Source.csv", header=T)
>describe(Data)
>summary(Data)
>unique(Data[1])
>unique(Data[2])
>unique(Data[3])
>unique(Data[4])
>
>I would like to add sort the unique entries. The data in the various 
>columns are not defined as numbers, but also text. I realize 1 and 10 
>will not sort properly, as the column is not defined as a number, but 
>want to see what I have in the columns viewed as sorted.
>
>QUESTION
>What is the best process to sort unique output, please?
>
>
>Thanks.

-- 
Sent from my phone. Please excuse my brevity.


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Mon Dec 20 18:30:13 2021
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Mon, 20 Dec 2021 18:30:13 +0100
Subject: [R] Bug in list.files(full.names=T)
In-Reply-To: <CAHqSRuQLZoZKtFJtMjfwk13+v4z05wUy=xp9jv-VmyMybNPJSw@mail.gmail.com>
References: <CAAWr5boNy3Dizfw9HrruA1dvoXyFcwsT7Tw5fnqfUhBOimLKog@mail.gmail.com>
 <25024.17119.584361.442267@stat.math.ethz.ch>
 <25024.42572.961443.768850@stat.math.ethz.ch>
 <CAHqSRuQLZoZKtFJtMjfwk13+v4z05wUy=xp9jv-VmyMybNPJSw@mail.gmail.com>
Message-ID: <25024.48549.945030.889212@stat.math.ethz.ch>

>>>>> Bill Dunlap 
>>>>>     on Mon, 20 Dec 2021 08:40:04 -0800 writes:

    >> 
    >> > Why would one ever *add* a final unneeded path separator,
    >> > unless one wanted it?
    >> 

    > Good question, but it is common for Windows installer programs to add a
    > terminal backslash to PATH entries.  E.g., on my Windows laptop I get

    >> grep(value=TRUE, "\\\\$", strsplit(Sys.getenv("PATH"), ";")[[1]])
    > [1] "C:\\Python39\\Scripts\\"
    > [2] "C:\\Python39\\"
    > [3] "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\"
    > [4] "C:\\WINDOWS\\System32\\OpenSSH\\"
    > [5] "C:\\Program Files\\nodejs\\"
    > [6] "C:\\Program Files\\Pandoc\\"
    > [7] "C:\\Program Files\\MiKTeX\\miktex\\bin\\x64\\"
    > [8] "C:\\Program Files\\PuTTY\\"

    > I did not add those entries by hand; all were added by installer programs.

    > -Bill

Thanks a lot, Bill,  for giving this part of the picture
(even though you did not show how many there were in your PATH which
 did *not* end in `\\` ..)

However the reason for my 2nd post was that I could *not* at all
confirm what Mario reported, but rather I saw
having a final "/" and not having it
to give the *same* behavior on R for Windows versions
from 3.6.1 to 4.1.2 on our M$ Windows terminal server (2016)
and now, as I just checked, it also *still* has the same Windows-specific
behavior in R-devel-ucrt (the one from Tomas Kalibera) :

If I use a trailing `/` or `\\` it is *kept*, but no additional
fsep (i.e. '/' or `\\`) is added (on Windows) when I use

     list.files(dir, full.names=TRUE)

contrary to what Mario reported (to happen in R 4.1.2, but not R 3.6.1)

Martin


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Mon Dec 20 18:32:14 2021
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Mon, 20 Dec 2021 18:32:14 +0100
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <748ab641-0036-c56b-bc9c-507807575980@sapo.pt>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <748ab641-0036-c56b-bc9c-507807575980@sapo.pt>
Message-ID: <25024.48670.794253.975729@stat.math.ethz.ch>

>>>>> Rui Barradas 
>>>>>     on Mon, 20 Dec 2021 17:05:33 +0000 writes:

    > Hello,
    > Package stringr has functions str_sort and str_order, both with an 
    > argument 'numeric' that will sort the numbers correctly.
    > Maybe that's what you are looking for, see the example below.


    > x <- sample(sprintf("ab%d", 1:20))     # shuffle the vector
    > stringr::str_sort(x, numeric = TRUE)   # sort considering the numbers

Again:
There's really no need to use non-base R here (and in almost all
such questions about string handling!)
as Avi Gross' answer shows.


    > Hope this helps,

    > Rui Barradas


    > ?s 16:58 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
    >> Hi,
    >> 
    >> 
    >> Running a simple syntax set to review entries in dataframe columns. Here 
    >> is the working code.
    >> 
    >> Data <- read.csv("./input/Source.csv", header=T)
    >> describe(Data)
    >> summary(Data)
    >> unique(Data[1])
    >> unique(Data[2])
    >> unique(Data[3])
    >> unique(Data[4])
    >> 
    >> I would like to add sort the unique entries. The data in the various 
    >> columns are not defined as numbers, but also text. I realize 1 and 10 
    >> will not sort properly, as the column is not defined as a number, but 
    >> want to see what I have in the columns viewed as sorted.
    >> 
    >> QUESTION
    >> What is the best process to sort unique output, please?
    >> 
    >> 
    >> Thanks.

    > ______________________________________________
    > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
    > https://stat.ethz.ch/mailman/listinfo/r-help
    > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
    > and provide commented, minimal, self-contained, reproducible code.


From @v|gro@@ @end|ng |rom ver|zon@net  Mon Dec 20 18:39:44 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Mon, 20 Dec 2021 12:39:44 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <0fe4a748-2379-9723-d2d8-8192daae23db@shdawson.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <01b301d7f5c5$22e19310$68a4b930$@verizon.net>
 <0fe4a748-2379-9723-d2d8-8192daae23db@shdawson.com>
Message-ID: <01b501d7f5c8$939d68b0$bad83a10$@verizon.net>

Stephen,

 

Sorry about that. I tried modifying what you had and realize the use of [] returned a data.frame and you need [[]] to return a vector.

 

Try this:

 

sort(unique(Data[[1]]))

 

 

From: Stephen H. Dawson, DSL <service at shdawson.com> 
Sent: Monday, December 20, 2021 12:32 PM
To: Avi Gross <avigross at verizon.net>; r-help at r-project.org
Subject: Re: [R] Adding SORT to UNIQUE

 

Thanks for the reply.

sort(unique(Data[1]))
Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing = decreasing)) : 
  undefined columns selected

The recommended syntax did not work, as listed above.



Stephen Dawson, DSL
Executive Strategy Consultant
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com



On 12/20/21 12:15 PM, Avi Gross via R-help wrote:

Stephen,
 
You can sort using sort() either before or after doing a unique. Unique
removes all duplicates in any order so sorting before may be wasteful. in
your data shown below, do this:
 
sort(unique(Data[1]))
sort(unique(Data[2]))
sort(unique(Data[3]))
sort(unique(Data[4]))
 
Even simpler is to define a function like this:
 
unisort <- function(vec) sort(unique(vec))
 
and use it like this:
 
unisort(Data[1])
 
 
And since you seem to want all of the first four columns of Data you may
want to do them all at once using something like:
 
lapply(Data[1:4], unisort)
 
As you note, the sort ordering depends on the data and perhaps on options
you specify.
 
-----Original Message-----
From: R-help  <mailto:r-help-bounces at r-project.org> <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
DSL via R-help
Sent: Monday, December 20, 2021 11:59 AM
To: Stephen H. Dawson, DSL via R-help  <mailto:r-help at r-project.org> <r-help at r-project.org>
Subject: [R] Adding SORT to UNIQUE
 
Hi,
 
 
Running a simple syntax set to review entries in dataframe columns. Here is
the working code.
 
Data <- read.csv("./input/Source.csv", header=T)
describe(Data)
summary(Data)
unique(Data[1])
unique(Data[2])
unique(Data[3])
unique(Data[4])
 
I would like to add sort the unique entries. The data in the various columns
are not defined as numbers, but also text. I realize 1 and 10 will not sort
properly, as the column is not defined as a number, but want to see what I
have in the columns viewed as sorted.
 
QUESTION
What is the best process to sort unique output, please?
 
 
Thanks.
--
*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com  <http://www.shdawson.com> <http://www.shdawson.com>
 
______________________________________________
R-help at r-project.org <mailto:R-help at r-project.org>  mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org <mailto:R-help at r-project.org>  mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.





	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Dec 20 18:51:03 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 20 Dec 2021 12:51:03 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <25024.48670.794253.975729@stat.math.ethz.ch>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <748ab641-0036-c56b-bc9c-507807575980@sapo.pt>
 <25024.48670.794253.975729@stat.math.ethz.ch>
Message-ID: <27766310-e040-7019-6d38-eb808a13ecc2@gmail.com>

On 20/12/2021 12:32 p.m., Martin Maechler wrote:
>>>>>> Rui Barradas
>>>>>>      on Mon, 20 Dec 2021 17:05:33 +0000 writes:
> 
>      > Hello,
>      > Package stringr has functions str_sort and str_order, both with an
>      > argument 'numeric' that will sort the numbers correctly.
>      > Maybe that's what you are looking for, see the example below.
> 
> 
>      > x <- sample(sprintf("ab%d", 1:20))     # shuffle the vector
>      > stringr::str_sort(x, numeric = TRUE)   # sort considering the numbers
> 
> Again:
> There's really no need to use non-base R here (and in almost all
> such questions about string handling!)
> as Avi Gross' answer shows.

That gives a different sort order:

  stringr::str_sort(x, numeric = TRUE)

gives

  [1] "ab1"  "ab2"  "ab3"  "ab4"  "ab5"  "ab6"  "ab7"  "ab8"  "ab9" 
"ab10" "ab11" "ab12" "ab13" "ab14" "ab15" "ab16" "ab17"
[18] "ab18" "ab19" "ab20"

(with the numbers in order), while sort(x) gives

  [1] "ab1"  "ab10" "ab11" "ab12" "ab13" "ab14" "ab15" "ab16" "ab17" 
"ab18" "ab19" "ab2"  "ab20" "ab3"  "ab4"  "ab5"  "ab6"
[18] "ab7"  "ab8"  "ab9"

with the characters in order.  I don't think the "numeric" option is 
available in base R (though of course you could write a function to do 
it, so there's no *need*, but it's certainly more convenient to use the 
stringr function if that's the order you want).

Duncan Murdoch


> 
> 
>      > Hope this helps,
> 
>      > Rui Barradas
> 
> 
>      > ?s 16:58 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>      >> Hi,
>      >>
>      >>
>      >> Running a simple syntax set to review entries in dataframe columns. Here
>      >> is the working code.
>      >>
>      >> Data <- read.csv("./input/Source.csv", header=T)
>      >> describe(Data)
>      >> summary(Data)
>      >> unique(Data[1])
>      >> unique(Data[2])
>      >> unique(Data[3])
>      >> unique(Data[4])
>      >>
>      >> I would like to add sort the unique entries. The data in the various
>      >> columns are not defined as numbers, but also text. I realize 1 and 10
>      >> will not sort properly, as the column is not defined as a number, but
>      >> want to see what I have in the columns viewed as sorted.
>      >>
>      >> QUESTION
>      >> What is the best process to sort unique output, please?
>      >>
>      >>
>      >> Thanks.
> 
>      > ______________________________________________
>      > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>      > https://stat.ethz.ch/mailman/listinfo/r-help
>      > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>      > and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From w||||@mwdun|@p @end|ng |rom gm@||@com  Mon Dec 20 19:02:32 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Mon, 20 Dec 2021 10:02:32 -0800
Subject: [R] Bug in list.files(full.names=T)
In-Reply-To: <25024.48549.945030.889212@stat.math.ethz.ch>
References: <CAAWr5boNy3Dizfw9HrruA1dvoXyFcwsT7Tw5fnqfUhBOimLKog@mail.gmail.com>
 <25024.17119.584361.442267@stat.math.ethz.ch>
 <25024.42572.961443.768850@stat.math.ethz.ch>
 <CAHqSRuQLZoZKtFJtMjfwk13+v4z05wUy=xp9jv-VmyMybNPJSw@mail.gmail.com>
 <25024.48549.945030.889212@stat.math.ethz.ch>
Message-ID: <CAHqSRuSGsOg=p8EazgBU-FoWBc9EZy7xaWicmyrDV+MJY03TyQ@mail.gmail.com>

> grep(value=TRUE, invert=TRUE, "\\\\$", strsplit(Sys.getenv("PATH"),
";")[[1]])
 [1] "C:\\rtools40\\usr\\bin"
 [2] "C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath"
 [3] "C:\\Program Files\\ImageMagick-7.0.11-Q16-HDRI"
 [4] "C:\\WINDOWS\\system32"
 [5] "C:\\WINDOWS"
 [6] "C:\\WINDOWS\\System32\\Wbem"
 [7] "C:\\ProgramData\\chocolatey\\bin"
 [8] "C:\\Program Files\\Git\\cmd"
 [9] "C:\\Program Files\\TortoiseSVN\\bin"
[10] "C:\\Program Files\\Docker\\Docker\\resources\\bin"
[11] "C:\\ProgramData\\DockerDesktop\\version-bin"
[12] "C:\\Users\\willi\\AppData\\Local\\Microsoft\\WindowsApps"
[13] "C:\\Users\\willi\\AppData\\Local\\Programs\\Microsoft VS Code\\bin"
[14] "C:\\Users\\willi\\AppData\\Roaming\\npm"
[15] "C:\\Users\\willi\\AppData\\Local\\GitHubDesktop\\bin"
> table(grepl("\\\\$", strsplit(Sys.getenv("PATH"), ";")[[1]])) # c. 2:1
against terminal backslash

FALSE  TRUE
   15     8


On Mon, Dec 20, 2021 at 9:30 AM Martin Maechler <maechler at stat.math.ethz.ch>
wrote:

> >>>>> Bill Dunlap
> >>>>>     on Mon, 20 Dec 2021 08:40:04 -0800 writes:
>
>     >>
>     >> > Why would one ever *add* a final unneeded path separator,
>     >> > unless one wanted it?
>     >>
>
>     > Good question, but it is common for Windows installer programs to
> add a
>     > terminal backslash to PATH entries.  E.g., on my Windows laptop I get
>
>     >> grep(value=TRUE, "\\\\$", strsplit(Sys.getenv("PATH"), ";")[[1]])
>     > [1] "C:\\Python39\\Scripts\\"
>     > [2] "C:\\Python39\\"
>     > [3] "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\"
>     > [4] "C:\\WINDOWS\\System32\\OpenSSH\\"
>     > [5] "C:\\Program Files\\nodejs\\"
>     > [6] "C:\\Program Files\\Pandoc\\"
>     > [7] "C:\\Program Files\\MiKTeX\\miktex\\bin\\x64\\"
>     > [8] "C:\\Program Files\\PuTTY\\"
>
>     > I did not add those entries by hand; all were added by installer
> programs.
>
>     > -Bill
>
> Thanks a lot, Bill,  for giving this part of the picture
> (even though you did not show how many there were in your PATH which
>  did *not* end in `\\` ..)
>
> However the reason for my 2nd post was that I could *not* at all
> confirm what Mario reported, but rather I saw
> having a final "/" and not having it
> to give the *same* behavior on R for Windows versions
> from 3.6.1 to 4.1.2 on our M$ Windows terminal server (2016)
> and now, as I just checked, it also *still* has the same Windows-specific
> behavior in R-devel-ucrt (the one from Tomas Kalibera) :
>
> If I use a trailing `/` or `\\` it is *kept*, but no additional
> fsep (i.e. '/' or `\\`) is added (on Windows) when I use
>
>      list.files(dir, full.names=TRUE)
>
> contrary to what Mario reported (to happen in R 4.1.2, but not R 3.6.1)
>
> Martin
>
>

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Mon Dec 20 19:11:08 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Mon, 20 Dec 2021 10:11:08 -0800
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <71BCBC21-7EFE-4C20-8E09-BB3E4074420C@dcn.davis.ca.us>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <71BCBC21-7EFE-4C20-8E09-BB3E4074420C@dcn.davis.ca.us>
Message-ID: <1F506A2A-C519-4791-9B04-9776D089E5BC@dcn.davis.ca.us>

Er, I suppose what was wrong was the absence of unique...

as.data.frame( lapply( dta, function(v) sort( unique( v, decreasing = TRUE ) ) ) )

I do think "better" involves value judgements as to whether using one of many specialized tools (tidyverse model) is better or worse than using a sequence of generally-useful tools (base R model). I daily build and re-use my own functions that create verbs for my solution "language"... but I don't necessarily import all of them into every project I use because namespace clutter has both performance and cognitive costs that I prefer to make explicit choices about.

There are real benefits in both sides of this debate, such as avoiding re-inventing the wheel and learning how the language works.

In any event, this is the R-help mailing list, and if there is a cool package that wraps up a tedious base R expression or code chunk then I would hope people would share it, but if possible also provide some equivalent base R code to stay on topic.

On December 20, 2021 9:26:24 AM PST, Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
>What is wrong with
>
>as.data.frame(lapply( Data, sort, decreasing = TRUE ))
>
>?
>
>
>On December 20, 2021 8:58:48 AM PST, "Stephen H. Dawson, DSL via R-help" <r-help at r-project.org> wrote:
>>Hi,
>>
>>
>>Running a simple syntax set to review entries in dataframe columns. Here 
>>is the working code.
>>
>>Data <- read.csv("./input/Source.csv", header=T)
>>describe(Data)
>>summary(Data)
>>unique(Data[1])
>>unique(Data[2])
>>unique(Data[3])
>>unique(Data[4])
>>
>>I would like to add sort the unique entries. The data in the various 
>>columns are not defined as numbers, but also text. I realize 1 and 10 
>>will not sort properly, as the column is not defined as a number, but 
>>want to see what I have in the columns viewed as sorted.
>>
>>QUESTION
>>What is the best process to sort unique output, please?
>>
>>
>>Thanks.
>

-- 
Sent from my phone. Please excuse my brevity.


From bgunter@4567 @end|ng |rom gm@||@com  Mon Dec 20 19:56:59 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 20 Dec 2021 10:56:59 -0800
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <25024.48670.794253.975729@stat.math.ethz.ch>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <748ab641-0036-c56b-bc9c-507807575980@sapo.pt>
 <25024.48670.794253.975729@stat.math.ethz.ch>
Message-ID: <CAGxFJbTFTdRWD_Wq-hWBGML24X0W1hghq09f00dqXjGC17Qn_A@mail.gmail.com>

Martin:

I think the issue is this:
> sort(c('a10','a1','a3'))
[1] "a1"  "a10" "a3"
> ## wanted 'a1', 'a3', 'a10' ??

The OP would have to confirm, of course. If he only wanted to sort
just numerics, coercing to numeric first would presumably handle it.
For situations like the above, one probably needs a custom strategy to
define the ordering, right?

Cheers,
Bert


On Mon, Dec 20, 2021 at 9:32 AM Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>
> >>>>> Rui Barradas
> >>>>>     on Mon, 20 Dec 2021 17:05:33 +0000 writes:
>
>     > Hello,
>     > Package stringr has functions str_sort and str_order, both with an
>     > argument 'numeric' that will sort the numbers correctly.
>     > Maybe that's what you are looking for, see the example below.
>
>
>     > x <- sample(sprintf("ab%d", 1:20))     # shuffle the vector
>     > stringr::str_sort(x, numeric = TRUE)   # sort considering the numbers
>
> Again:
> There's really no need to use non-base R here (and in almost all
> such questions about string handling!)
> as Avi Gross' answer shows.
>
>
>     > Hope this helps,
>
>     > Rui Barradas
>
>
>     > ?s 16:58 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>     >> Hi,
>     >>
>     >>
>     >> Running a simple syntax set to review entries in dataframe columns. Here
>     >> is the working code.
>     >>
>     >> Data <- read.csv("./input/Source.csv", header=T)
>     >> describe(Data)
>     >> summary(Data)
>     >> unique(Data[1])
>     >> unique(Data[2])
>     >> unique(Data[3])
>     >> unique(Data[4])
>     >>
>     >> I would like to add sort the unique entries. The data in the various
>     >> columns are not defined as numbers, but also text. I realize 1 and 10
>     >> will not sort properly, as the column is not defined as a number, but
>     >> want to see what I have in the columns viewed as sorted.
>     >>
>     >> QUESTION
>     >> What is the best process to sort unique output, please?
>     >>
>     >>
>     >> Thanks.
>
>     > ______________________________________________
>     > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>     > https://stat.ethz.ch/mailman/listinfo/r-help
>     > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>     > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @kw@|mmo @end|ng |rom gm@||@com  Mon Dec 20 20:24:29 2021
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Mon, 20 Dec 2021 14:24:29 -0500
Subject: [R] Bug in list.files(full.names=T)
In-Reply-To: <CAAWr5boNy3Dizfw9HrruA1dvoXyFcwsT7Tw5fnqfUhBOimLKog@mail.gmail.com>
References: <CAAWr5boNy3Dizfw9HrruA1dvoXyFcwsT7Tw5fnqfUhBOimLKog@mail.gmail.com>
Message-ID: <CAPcHnpSASchWmJfQHC44=2dn24qMjJ9+mU1b-0bTjcCfMo=nUg@mail.gmail.com>

I've tried a bunch of different R versions, I can't seem to replicate what
you described. Here's the code I used:


R.pattern <- paste0("^R-", .standard_regexps()$valid_R_system_version, "$")
x <- list.files(dirname(R.home()), pattern = R.pattern, full.names = TRUE)
x <- x[file.info(x, extra_cols = FALSE)$isdir]
x <- file.path(x, "bin", "x64", "Rscript")
commands <- shQuote(x)
args <- c("--default-packages=NULL", "--vanilla",
    "-e", shQuote(r"{
        x <- list.files(c(
            "./"         ,
            "C:/"        ,
            "C:/Windows/"
        ), full.names = TRUE)
        x <- x[grepl("//", x, fixed = TRUE)]
        if (length(x))
            print(x)
    }"))
for (command in commands) {
    command <- paste(c(command, args), collapse = " ")
    cat(command, "\n", sep = "")
    system(command)
    cat("\n")
}


which should (theoretically) open every version of R you have installed and
try the code you ran. When I ran it, I found no files with two slashes in a
row:


"C:/PROGRA~1/R/R-2.15.3/bin/x64/Rscript" --default-packages=NULL --vanilla
-e "
        x <- list.files(c(
            \"./\"         ,
            \"C:/\"        ,
            \"C:/Windows/\"
        ), full.names = TRUE)
        x <- x[grepl(\"//\", x, fixed = TRUE)]
        if (length(x))
            print(x)
    "

"C:/PROGRA~1/R/R-3.5.3/bin/x64/Rscript" --default-packages=NULL --vanilla
-e "
        x <- list.files(c(
            \"./\"         ,
            \"C:/\"        ,
            \"C:/Windows/\"
        ), full.names = TRUE)
        x <- x[grepl(\"//\", x, fixed = TRUE)]
        if (length(x))
            print(x)
    "

"C:/PROGRA~1/R/R-3.6.3/bin/x64/Rscript" --default-packages=NULL --vanilla
-e "
        x <- list.files(c(
            \"./\"         ,
            \"C:/\"        ,
            \"C:/Windows/\"
        ), full.names = TRUE)
        x <- x[grepl(\"//\", x, fixed = TRUE)]
        if (length(x))
            print(x)
    "

"C:/PROGRA~1/R/R-4.0.2/bin/x64/Rscript" --default-packages=NULL --vanilla
-e "
        x <- list.files(c(
            \"./\"         ,
            \"C:/\"        ,
            \"C:/Windows/\"
        ), full.names = TRUE)
        x <- x[grepl(\"//\", x, fixed = TRUE)]
        if (length(x))
            print(x)
    "

"C:/PROGRA~1/R/R-4.1.0/bin/x64/Rscript" --default-packages=NULL --vanilla
-e "
        x <- list.files(c(
            \"./\"         ,
            \"C:/\"        ,
            \"C:/Windows/\"
        ), full.names = TRUE)
        x <- x[grepl(\"//\", x, fixed = TRUE)]
        if (length(x))
            print(x)
    "

"C:/PROGRA~1/R/R-4.1.1/bin/x64/Rscript" --default-packages=NULL --vanilla
-e "
        x <- list.files(c(
            \"./\"         ,
            \"C:/\"        ,
            \"C:/Windows/\"
        ), full.names = TRUE)
        x <- x[grepl(\"//\", x, fixed = TRUE)]
        if (length(x))
            print(x)
    "

"C:/PROGRA~1/R/R-4.1.2/bin/x64/Rscript" --default-packages=NULL --vanilla
-e "
        x <- list.files(c(
            \"./\"         ,
            \"C:/\"        ,
            \"C:/Windows/\"
        ), full.names = TRUE)
        x <- x[grepl(\"//\", x, fixed = TRUE)]
        if (length(x))
            print(x)
    "


I can't offer much more, sorry about that. Maybe your session information
could be helpful? utils::sessionInfo()

On Sun, Dec 19, 2021 at 6:40 AM Mario Reutter <mario_reutter at web.de> wrote:

> Dear everybody,
>
> I'm a researcher in the field of psychology and a passionate R user. After
> having updated to the newest version, I experienced a problem with
> list.files() if the parameter full.names is set to TRUE.
> A path separator "/" is now always appended to path in the output even if
> path %>% endsWith("/"). This breaks backwards compatibility in case path
> ends with a path separator. The problem occurred somewhere between R
> version 3.6.1 (2019-07-05) and 4.1.2 (2021-11-01).
>
> Example:
> >> list.files("C:/Data/", full.names=T)
> C:/Data//file.csv
>
> Expected behavior:
> Either a path separator should never be appended in accordance with
> the documentation: "full.names
> a logical value. If TRUE, the directory path is prepended to the file names
> to give a relative file path."
> Or it could only be appended if path doesn't already end with a path
> separator.
>
> My question would now be if this warrants a bug report? And if you agree,
> could someone issue the report since I'm not a member on Bugzilla?
>
> Thank you and best regards,
> Mario Reutter
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @erv|ce @end|ng |rom @hd@w@on@com  Mon Dec 20 22:13:46 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Mon, 20 Dec 2021 16:13:46 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <01b301d7f5c5$22e19310$68a4b930$@verizon.net>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <01b301d7f5c5$22e19310$68a4b930$@verizon.net>
Message-ID: <575ba33c-dc58-7b4a-dead-8129f22a15a6@shdawson.com>

Thanks for the reply.

sort(unique(Data[1]))
Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing = 
decreasing)) :
 ? undefined columns selected

The recommended syntax did not work, as listed above.

*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/20/21 12:15 PM, Avi Gross via R-help wrote:
> Stephen,
>
> You can sort using sort() either before or after doing a unique. Unique
> removes all duplicates in any order so sorting before may be wasteful. in
> your data shown below, do this:
>
> sort(unique(Data[1]))
> sort(unique(Data[2]))
> sort(unique(Data[3]))
> sort(unique(Data[4]))
>
> Even simpler is to define a function like this:
>
> unisort <- function(vec) sort(unique(vec))
>
> and use it like this:
>
> unisort(Data[1])
>
>
> And since you seem to want all of the first four columns of Data you may
> want to do them all at once using something like:
>
> lapply(Data[1:4], unisort)
>
> As you note, the sort ordering depends on the data and perhaps on options
> you specify.
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
> DSL via R-help
> Sent: Monday, December 20, 2021 11:59 AM
> To: Stephen H. Dawson, DSL via R-help <r-help at r-project.org>
> Subject: [R] Adding SORT to UNIQUE
>
> Hi,
>
>
> Running a simple syntax set to review entries in dataframe columns. Here is
> the working code.
>
> Data <- read.csv("./input/Source.csv", header=T)
> describe(Data)
> summary(Data)
> unique(Data[1])
> unique(Data[2])
> unique(Data[3])
> unique(Data[4])
>
> I would like to add sort the unique entries. The data in the various columns
> are not defined as numbers, but also text. I realize 1 and 10 will not sort
> properly, as the column is not defined as a number, but want to see what I
> have in the columns viewed as sorted.
>
> QUESTION
> What is the best process to sort unique output, please?
>
>
> Thanks.
> --
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From @erv|ce @end|ng |rom @hd@w@on@com  Mon Dec 20 22:18:55 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Mon, 20 Dec 2021 16:18:55 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
Message-ID: <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>

Thanks.

sort(unique(Data[[1]]))

This syntax provides row numbers, not column values.

*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
> Hi,
>
>
> Running a simple syntax set to review entries in dataframe columns. 
> Here is the working code.
>
> Data <- read.csv("./input/Source.csv", header=T)
> describe(Data)
> summary(Data)
> unique(Data[1])
> unique(Data[2])
> unique(Data[3])
> unique(Data[4])
>
> I would like to add sort the unique entries. The data in the various 
> columns are not defined as numbers, but also text. I realize 1 and 10 
> will not sort properly, as the column is not defined as a number, but 
> want to see what I have in the columns viewed as sorted.
>
> QUESTION
> What is the best process to sort unique output, please?
>
>
> Thanks.


From @v|gro@@ @end|ng |rom ver|zon@net  Mon Dec 20 22:37:53 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Mon, 20 Dec 2021 16:37:53 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <27766310-e040-7019-6d38-eb808a13ecc2@gmail.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <748ab641-0036-c56b-bc9c-507807575980@sapo.pt>
 <25024.48670.794253.975729@stat.math.ethz.ch>
 <27766310-e040-7019-6d38-eb808a13ecc2@gmail.com>
Message-ID: <00a601d7f5e9$d8a424a0$89ec6de0$@verizon.net>

Duncan and Martin and ...,

There are multiple groups where people discuss R and this seems to be a help group. The topic keeps coming up as to whether you should teach anything other than base R and I claim it depends. 

Many packages are indeed written mostly using base R or using other packages that ultimately use only base R constructions. So, obviously, those packages can be gotten around by re-writing your own complicated code to do the things you want. Some have parts written using external libraries such as parts written in C and that makes it harder.

I think the debate is not one-sided and the whole purpose of creating and sharing libraries is to make life easier for those who see tools that already exist and perhaps may even be tested by others and deemed worthy. For people with serious programming needs, I suggest often 80% of your code can easily be made easier or more powerful AND easier to read than writing many times more fairly complex code in the base language.

BUT, if someone is teaching a language like R one step at a time and a student asks a question, it is very wrong to tell them of a package to do all the work when clearly they need practice using a small subset of base functionality. If they are asked to implement a sort algorithm using say a recursive merge sort, then the assignment involves using functions that call themselves and so on.

So I was thinking of how I might have dealt with finding unique members of a vector (called "temp" below) that contained character text as in "2.2" and "99.6" and "10.1" and "1.1" if they are all numeric POTENTIALLY and you want them sorted as if they were numeric but then returned as character data. My first attempt at it was this:

as.character(sort(as.numeric(unique(temp))))

Then I considered that if there was no guarantee that everything in temp could be coerced by as.numeric() then do I handle that? I see the following extension of temp causes an error and temp2 is not created:

  > as.numeric(c(temp. "blab")) -> temp2
  Error: unexpected string constant in "as.numeric(c(temp. "blab""

So clearly to handle that I might change the one-liner into multiple lines and check for the above error in one of many ways such as embedding it inside a try() but then what is the requirement if it fails? One possibility might be to remove such entries and another is to add them back after sorting the rest but add them back where? If there are many, they all need to be sorted. Or should they become an NA, which is tolerated?

Get the idea?

It can take non-trivial work. Now if the package was made carefully, perhaps with options letting you specify among such choices as above, and it is trusted, why not use that if your needs may be complex?

One final note. In some places the functionality of unique() is done by a method that first sorts the data and then simply removes duplicates of the same thing that are adjacent. In those cases, the data would come out sorted or in reverse sort order. But that is not what the built-in unique() does as it basically keeps a list of what it has encountered and each new item is kept only if it is not already in the list. This produces output in the same order it entered. Think of how factors normally are done in R. The first item found is stored usually as a 1 then the next unique item as a 2 and so on but duplicates all share the same integer value and thus the levels only need be stored once. If you want them stored sorted, there are fairly easy ways to do that but there are packages like forcats that do such things often more consistently and easier. In a sense, you can do a unique by simply making your data into a factor and ask for levels(whatever) ad optionally sort them. Effectively, you are using it as a kind of set, and there are ways to also use sets in R.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Duncan Murdoch
Sent: Monday, December 20, 2021 12:51 PM
To: Martin Maechler <maechler at stat.math.ethz.ch>; Rui Barradas <ruipbarradas at sapo.pt>
Cc: Stephen H. Dawson, DSL via R-help <r-help at r-project.org>
Subject: Re: [R] Adding SORT to UNIQUE

On 20/12/2021 12:32 p.m., Martin Maechler wrote:
>>>>>> Rui Barradas
>>>>>>      on Mon, 20 Dec 2021 17:05:33 +0000 writes:
> 
>      > Hello,
>      > Package stringr has functions str_sort and str_order, both with an
>      > argument 'numeric' that will sort the numbers correctly.
>      > Maybe that's what you are looking for, see the example below.
> 
> 
>      > x <- sample(sprintf("ab%d", 1:20))     # shuffle the vector
>      > stringr::str_sort(x, numeric = TRUE)   # sort considering the numbers
> 
> Again:
> There's really no need to use non-base R here (and in almost all such 
> questions about string handling!) as Avi Gross' answer shows.

That gives a different sort order:

  stringr::str_sort(x, numeric = TRUE)

gives

  [1] "ab1"  "ab2"  "ab3"  "ab4"  "ab5"  "ab6"  "ab7"  "ab8"  "ab9" 
"ab10" "ab11" "ab12" "ab13" "ab14" "ab15" "ab16" "ab17"
[18] "ab18" "ab19" "ab20"

(with the numbers in order), while sort(x) gives

  [1] "ab1"  "ab10" "ab11" "ab12" "ab13" "ab14" "ab15" "ab16" "ab17" 
"ab18" "ab19" "ab2"  "ab20" "ab3"  "ab4"  "ab5"  "ab6"
[18] "ab7"  "ab8"  "ab9"

with the characters in order.  I don't think the "numeric" option is available in base R (though of course you could write a function to do it, so there's no *need*, but it's certainly more convenient to use the stringr function if that's the order you want).

Duncan Murdoch


> 
> 
>      > Hope this helps,
> 
>      > Rui Barradas
> 
> 
>      > ?s 16:58 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>      >> Hi,
>      >>
>      >>
>      >> Running a simple syntax set to review entries in dataframe columns. Here
>      >> is the working code.
>      >>
>      >> Data <- read.csv("./input/Source.csv", header=T)
>      >> describe(Data)
>      >> summary(Data)
>      >> unique(Data[1])
>      >> unique(Data[2])
>      >> unique(Data[3])
>      >> unique(Data[4])
>      >>
>      >> I would like to add sort the unique entries. The data in the various
>      >> columns are not defined as numbers, but also text. I realize 1 and 10
>      >> will not sort properly, as the column is not defined as a number, but
>      >> want to see what I have in the columns viewed as sorted.
>      >>
>      >> QUESTION
>      >> What is the best process to sort unique output, please?
>      >>
>      >>
>      >> Thanks.
> 
>      > ______________________________________________
>      > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>      > https://stat.ethz.ch/mailman/listinfo/r-help
>      > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>      > and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From @erv|ce @end|ng |rom @hd@w@on@com  Mon Dec 20 22:25:00 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Mon, 20 Dec 2021 16:25:00 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <01b301d7f5c5$22e19310$68a4b930$@verizon.net>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <01b301d7f5c5$22e19310$68a4b930$@verizon.net>
Message-ID: <251fd630-a395-0216-eb15-b39b4c7a5143@shdawson.com>

Thanks for the reply.

sort(unique(Data[1]))
Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing = 
decreasing)) :
 ? undefined columns selected

The recommended syntax did not work, as listed above.


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/20/21 12:15 PM, Avi Gross via R-help wrote:
> Stephen,
>
> You can sort using sort() either before or after doing a unique. Unique
> removes all duplicates in any order so sorting before may be wasteful. in
> your data shown below, do this:
>
> sort(unique(Data[1]))
> sort(unique(Data[2]))
> sort(unique(Data[3]))
> sort(unique(Data[4]))
>
> Even simpler is to define a function like this:
>
> unisort <- function(vec) sort(unique(vec))
>
> and use it like this:
>
> unisort(Data[1])
>
>
> And since you seem to want all of the first four columns of Data you may
> want to do them all at once using something like:
>
> lapply(Data[1:4], unisort)
>
> As you note, the sort ordering depends on the data and perhaps on options
> you specify.
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
> DSL via R-help
> Sent: Monday, December 20, 2021 11:59 AM
> To: Stephen H. Dawson, DSL via R-help <r-help at r-project.org>
> Subject: [R] Adding SORT to UNIQUE
>
> Hi,
>
>
> Running a simple syntax set to review entries in dataframe columns. Here is
> the working code.
>
> Data <- read.csv("./input/Source.csv", header=T)
> describe(Data)
> summary(Data)
> unique(Data[1])
> unique(Data[2])
> unique(Data[3])
> unique(Data[4])
>
> I would like to add sort the unique entries. The data in the various columns
> are not defined as numbers, but also text. I realize 1 and 10 will not sort
> properly, as the column is not defined as a number, but want to see what I
> have in the columns viewed as sorted.
>
> QUESTION
> What is the best process to sort unique output, please?
>
>
> Thanks.
> --
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Dec 20 23:53:29 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 20 Dec 2021 22:53:29 +0000
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
Message-ID: <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>

Hello,

Inline.

?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
> Thanks.
> 
> sort(unique(Data[[1]]))
> 
> This syntax provides row numbers, not column values.

This is not right.
The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]] 
extracts the column vector.

As for my previous answer, it was not addressing the question, I 
misinterpreted it as being a question on how to sort by numeric order 
when the data is not numeric. Here is a, hopefully, complete answer.
Still with package stringr.


cols_to_sort <- 1:4

Data2 <- lapply(Data[cols_to_sort], \(x){
   stringr::str_sort(unique(x), numeric = TRUE)
})


Or using Avi's suggestion of writing a function to do all the work and 
simplify the lapply loop later,


unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)


Hope this helps,

Rui Barradas


> 
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
> 
> 
> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>> Hi,
>>
>>
>> Running a simple syntax set to review entries in dataframe columns. 
>> Here is the working code.
>>
>> Data <- read.csv("./input/Source.csv", header=T)
>> describe(Data)
>> summary(Data)
>> unique(Data[1])
>> unique(Data[2])
>> unique(Data[3])
>> unique(Data[4])
>>
>> I would like to add sort the unique entries. The data in the various 
>> columns are not defined as numbers, but also text. I realize 1 and 10 
>> will not sort properly, as the column is not defined as a number, but 
>> want to see what I have in the columns viewed as sorted.
>>
>> QUESTION
>> What is the best process to sort unique output, please?
>>
>>
>> Thanks.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From jr@| @end|ng |rom po@teo@no  Tue Dec 21 02:19:03 2021
From: jr@| @end|ng |rom po@teo@no (Rasmus Liland)
Date: Tue, 21 Dec 2021 01:19:03 +0000
Subject: [R] Sum every n (4) observations by group
In-Reply-To: <4ef13644-5a57-3f5b-d76a-082511907a85@syonic.eu>
References: <4ef13644-5a57-3f5b-d76a-082511907a85@syonic.eu>
Message-ID: <YcErh5jZHAjVex5q@posteo.no>

Dear Miluji,

I went through different combinations, 
and find it elegant to sum the values 
with respect to ID + High/Low Date 
levels like if this was a list of 
Dose/Material/Group experiments:

	x[x$Date %in% c(4143, 4147),"j"] <-
	tapply(x$Value, paste0(x$ID, 
		ifelse(x$Date>4143, 2, 1)), sum)

This way, you escape the ?every 4th 
observation? criterium, IMHO instead 
?using? the dataframe in contrast to 
creating new information or interpreting 
the structure of the data frame ...  

I'm sorry if this only creates confusion 
and a ?what is he talking about?!? 
awkwardness by not answering the 
question in a precise way ... 

Best,
Rasmus


From m@rc_grt @end|ng |rom y@hoo@|r  Tue Dec 21 05:41:31 2021
From: m@rc_grt @end|ng |rom y@hoo@|r (Marc Girondot)
Date: Tue, 21 Dec 2021 05:41:31 +0100
Subject: [R] Creating NA equivalent
References: <977561d4-86af-69a7-de39-f53a0e2dfd92.ref@yahoo.fr>
Message-ID: <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>

Dear members,

I work about dosage and some values are bellow the detection limit. I 
would like create new "numbers" like LDL (to represent lower than 
detection limit) and UDL (upper the detection limit) that behave like 
NA, with the possibility to test them using for example is.LDL() or 
is.UDL().

Note that NA is not the same than LDL or UDL: NA represent missing data. 
Here the data is available as LDL or UDL.

NA is built in R language very deep... any option to create new version? 
of NA-equivalent ?

Thanks

Marc


From bgunter@4567 @end|ng |rom gm@||@com  Tue Dec 21 06:12:02 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 20 Dec 2021 21:12:02 -0800
Subject: [R] Creating NA equivalent
In-Reply-To: <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
References: <977561d4-86af-69a7-de39-f53a0e2dfd92.ref@yahoo.fr>
 <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
Message-ID: <CAGxFJbQswxhJFK4puh5jKxVG=trq0dBiqU26HnCGdcDfpRhaiw@mail.gmail.com>

Beyond known limits are left/right censored data. You need to use
statistical methodology that handles censoring. See the survival package
and the CRAN Survival task view for this -- or consult an appropriate
expert. There are of course standard ways of annotating such data in these
packages.

Bert

On Mon, Dec 20, 2021, 8:41 PM Marc Girondot via R-help <r-help at r-project.org>
wrote:

> Dear members,
>
> I work about dosage and some values are bellow the detection limit. I
> would like create new "numbers" like LDL (to represent lower than
> detection limit) and UDL (upper the detection limit) that behave like
> NA, with the possibility to test them using for example is.LDL() or
> is.UDL().
>
> Note that NA is not the same than LDL or UDL: NA represent missing data.
> Here the data is available as LDL or UDL.
>
> NA is built in R language very deep... any option to create new version
> of NA-equivalent ?
>
> Thanks
>
> Marc
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Dec 21 11:26:12 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 21 Dec 2021 05:26:12 -0500
Subject: [R] Creating NA equivalent
In-Reply-To: <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
References: <977561d4-86af-69a7-de39-f53a0e2dfd92.ref@yahoo.fr>
 <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
Message-ID: <7ef1e12e-9024-8dba-0f68-567db68cb803@gmail.com>

On 20/12/2021 11:41 p.m., Marc Girondot via R-help wrote:
> Dear members,
> 
> I work about dosage and some values are bellow the detection limit. I
> would like create new "numbers" like LDL (to represent lower than
> detection limit) and UDL (upper the detection limit) that behave like
> NA, with the possibility to test them using for example is.LDL() or
> is.UDL().
> 
> Note that NA is not the same than LDL or UDL: NA represent missing data.
> Here the data is available as LDL or UDL.
> 
> NA is built in R language very deep... any option to create new version
> of NA-equivalent ?
> 

There was a discussion of this back in May.  Here's a link to one 
approach that I suggested:

   https://stat.ethz.ch/pipermail/r-devel/2021-May/080776.html

Read the followup messages, I made at least one suggested improvement. 
I don't know if anyone has packaged this, but there's a later version of 
the code here:

   https://stackoverflow.com/a/69179441/2554330

Duncan Murdoch


From chr|@ho|d @end|ng |rom p@yctc@org  Tue Dec 21 12:16:55 2021
From: chr|@ho|d @end|ng |rom p@yctc@org (Chris Evans)
Date: Tue, 21 Dec 2021 11:16:55 +0000 (UTC)
Subject: [R] Creating NA equivalent
In-Reply-To: <7ef1e12e-9024-8dba-0f68-567db68cb803@gmail.com>
References: <977561d4-86af-69a7-de39-f53a0e2dfd92.ref@yahoo.fr>
 <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
 <7ef1e12e-9024-8dba-0f68-567db68cb803@gmail.com>
Message-ID: <1349245903.5000410.1640085415182.JavaMail.zimbra@psyctc.org>

I am neither a programmer nor a professional statistician but this topic interests me because:

1) I remember from long, long ago that S had a way to create labels that could denote multiple ways
   in which a value could be missing that was sometimes useful to me as my field sometimes has 
   such situations.  In R I handle this with a second variable but I can see that using attributes
   is cleaner and might have real benefits when doing missing value analyses.  That might raise
   questions about whether some of the nice packages that help with missing value analyses would
   take on board some standardised use of attributes for this.

2) I think Marc's question LDL/UDL is about a very particular sort of value that isn't missing 
   and _is_ censored but not in survival analysis meaning of censored. (At least, it's not the same
   to my mind, perhaps it is?  To me the difference is that I most often hit the LDL/UDL issue
   in data that don't have much, or any, time frame.) Again, this comes up a lot for me where 
   people are given limited possible answers in questionnaires and I've often wondered if I 
   should explore simulating probability models for an the "off the edge" value on a latent 
   variable beneath/behind the measured responses.  I'd be very grateful to hear of any work 
   in R packages (to stay only just "off the edge" of the posting    guide).  Or of any work a
   long the lines that Duncan offers, that sort of pulls this toward    base R, though that sounds
   to me as if it would be a huge undertaking.

I'm very interested to hear any thoughts on either aspect.

Seasonal (mutivalued) greetings to all!

Chris

----- Original Message -----
> From: "Duncan Murdoch" <murdoch.duncan at gmail.com>
> To: "Marc Girondot" <marc_grt at yahoo.fr>, r-help at r-project.org
> Sent: Tuesday, 21 December, 2021 10:26:12
> Subject: Re: [R] Creating NA equivalent

> On 20/12/2021 11:41 p.m., Marc Girondot via R-help wrote:
>> Dear members,
>> 
>> I work about dosage and some values are bellow the detection limit. I
>> would like create new "numbers" like LDL (to represent lower than
>> detection limit) and UDL (upper the detection limit) that behave like
>> NA, with the possibility to test them using for example is.LDL() or
>> is.UDL().
>> 
>> Note that NA is not the same than LDL or UDL: NA represent missing data.
>> Here the data is available as LDL or UDL.
>> 
>> NA is built in R language very deep... any option to create new version
>> of NA-equivalent ?
>> 
> 
> There was a discussion of this back in May.  Here's a link to one
> approach that I suggested:
> 
>   https://stat.ethz.ch/pipermail/r-devel/2021-May/080776.html
> 
> Read the followup messages, I made at least one suggested improvement.
> I don't know if anyone has packaged this, but there's a later version of
> the code here:
> 
>   https://stackoverflow.com/a/69179441/2554330
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Chris Evans (he/him) <chris at psyctc.org> 
Visiting Professor, UDLA, Quito, Ecuador & Honorary Professor, University of Roehampton, London, UK.
Work web site: https://www.psyctc.org/psyctc/ 
CORE site:     https://www.coresystemtrust.org.uk/
Personal site: https://www.psyctc.org/pelerinage2016/
OMbook:        https://ombook.psyctc.org/book/


From wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n|  Tue Dec 21 12:31:55 2021
From: wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n| (Viechtbauer, Wolfgang (SP))
Date: Tue, 21 Dec 2021 11:31:55 +0000
Subject: [R] Creating NA equivalent
In-Reply-To: <1349245903.5000410.1640085415182.JavaMail.zimbra@psyctc.org>
References: <977561d4-86af-69a7-de39-f53a0e2dfd92.ref@yahoo.fr>
 <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
 <7ef1e12e-9024-8dba-0f68-567db68cb803@gmail.com>
 <1349245903.5000410.1640085415182.JavaMail.zimbra@psyctc.org>
Message-ID: <d1ad58b35cc245b8b2b1c4dbde219534@UM-MAIL3214.unimaas.nl>

Hi Chris,

The survival package provides machinery for handling censored observations. Whether time is censored or some other type of variable (e.g., viral load due to some lower detection limit) does not make a fundamental difference. In fact, the type of model you are thinking of with 2) is a Tobit model, which can be fitted using the survival package (or censReg).

Best,
Wolfgang

>-----Original Message-----
>From: R-help [mailto:r-help-bounces at r-project.org] On Behalf Of Chris Evans
>Sent: Tuesday, 21 December, 2021 12:17
>To: Duncan Murdoch
>Cc: r-help at r-project.org
>Subject: Re: [R] Creating NA equivalent
>
> I am neither a programmer nor a professional statistician but this topic interests me because:
> 
> 1) I remember from long, long ago that S had a way to create labels that could
>    denote multiple ways in which a value could be missing that was sometimes
>    useful to me as my field sometimes has such situations.  In R I handle this
>    with a second variable but I can see that using attributes is cleaner and
>    might have real benefits when doing missing value analyses.  That might
>    raise questions about whether some of the nice packages that help with
>    missing value analyses would take on board some standardised use of
>    attributes for this.
> 
> 2) I think Marc's question LDL/UDL is about a very particular sort of value
>    that isn't missing and _is_ censored but not in survival analysis meaning
>    of censored. (At least, it's not the same to my mind, perhaps it is?  To me
>    the difference is that I most often hit the LDL/UDL issue in data that
>    don't have much, or any, time frame.) Again, this comes up a lot for me
>    where people are given limited possible answers in questionnaires and I've
>    often wondered if I should explore simulating probability models for an the
>    "off the edge" value on a latent variable beneath/behind the measured
>    responses.  I'd be very grateful to hear of any work in R packages (to stay
>    only just "off the edge" of the posting    guide).  Or of any work a long
>    the lines that Duncan offers, that sort of pulls this toward    base R,
>    though that sounds to me as if it would be a huge undertaking.
> 
> I'm very interested to hear any thoughts on either aspect.
> 
> Seasonal (mutivalued) greetings to all!
> 
> Chris


From chr|@ho|d @end|ng |rom p@yctc@org  Tue Dec 21 12:55:44 2021
From: chr|@ho|d @end|ng |rom p@yctc@org (Chris Evans)
Date: Tue, 21 Dec 2021 11:55:44 +0000 (UTC)
Subject: [R] Creating NA equivalent
In-Reply-To: <d1ad58b35cc245b8b2b1c4dbde219534@UM-MAIL3214.unimaas.nl>
References: <977561d4-86af-69a7-de39-f53a0e2dfd92.ref@yahoo.fr>
 <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
 <7ef1e12e-9024-8dba-0f68-567db68cb803@gmail.com>
 <1349245903.5000410.1640085415182.JavaMail.zimbra@psyctc.org>
 <d1ad58b35cc245b8b2b1c4dbde219534@UM-MAIL3214.unimaas.nl>
Message-ID: <1433246847.5064016.1640087744295.JavaMail.zimbra@psyctc.org>

Many thanks Wolfgang,

I guess I can see that survival analyses don't have to be time based but 
clearly I need to read up on that.  I can't see an example in the survival 
package.  And it proves to be hard to search for one. Can anyone point me 
to useful resources on that, in {survival} or not?

I am probably straying way off topic and  off list guide here but isn't a 
Tobit only handling censoring at one edge, i.e. the LDL scenario, or the UDL, 
but not both?  I think this may be getting back to Marc's original question
and certainly, again, I would love to be pointed to either Tobit handling
LDL _and_ UDL or to any other existing methods.

TIA,

Chris

----- Original Message -----
> From: "Wolfgang Viechtbauer" <wolfgang.viechtbauer at maastrichtuniversity.nl>
> To: "Chris Evans" <chrishold at psyctc.org>
> Cc: r-help at r-project.org
> Sent: Tuesday, 21 December, 2021 11:31:55
> Subject: RE: Creating NA equivalent

> Hi Chris,
> 
> The survival package provides machinery for handling censored observations.
> Whether time is censored or some other type of variable (e.g., viral load due
> to some lower detection limit) does not make a fundamental difference. In fact,
> the type of model you are thinking of with 2) is a Tobit model, which can be
> fitted using the survival package (or censReg).
> 
> Best,
> Wolfgang
> 
>>-----Original Message-----
>>From: R-help [mailto:r-help-bounces at r-project.org] On Behalf Of Chris Evans
>>Sent: Tuesday, 21 December, 2021 12:17
>>To: Duncan Murdoch
>>Cc: r-help at r-project.org
>>Subject: Re: [R] Creating NA equivalent
>>
>> I am neither a programmer nor a professional statistician but this topic
>> interests me because:
>> 
>> 1) I remember from long, long ago that S had a way to create labels that could
>>    denote multiple ways in which a value could be missing that was sometimes
>>    useful to me as my field sometimes has such situations.  In R I handle this
>>    with a second variable but I can see that using attributes is cleaner and
>>    might have real benefits when doing missing value analyses.  That might
>>    raise questions about whether some of the nice packages that help with
>>    missing value analyses would take on board some standardised use of
>>    attributes for this.
>> 
>> 2) I think Marc's question LDL/UDL is about a very particular sort of value
>>    that isn't missing and _is_ censored but not in survival analysis meaning
>>    of censored. (At least, it's not the same to my mind, perhaps it is?  To me
>>    the difference is that I most often hit the LDL/UDL issue in data that
>>    don't have much, or any, time frame.) Again, this comes up a lot for me
>>    where people are given limited possible answers in questionnaires and I've
>>    often wondered if I should explore simulating probability models for an the
>>    "off the edge" value on a latent variable beneath/behind the measured
>>    responses.  I'd be very grateful to hear of any work in R packages (to stay
>>    only just "off the edge" of the posting    guide).  Or of any work a long
>>    the lines that Duncan offers, that sort of pulls this toward    base R,
>>    though that sounds to me as if it would be a huge undertaking.
>> 
>> I'm very interested to hear any thoughts on either aspect.
>> 
>> Seasonal (mutivalued) greetings to all!
>> 
> > Chris

-- 
Chris Evans (he/him) <chris at psyctc.org> 
Visiting Professor, UDLA, Quito, Ecuador & Honorary Professor, University of Roehampton, London, UK.
Work web site: https://www.psyctc.org/psyctc/ 
CORE site:     https://www.coresystemtrust.org.uk/
Personal site: https://www.psyctc.org/pelerinage2016/
OMbook:        https://ombook.psyctc.org/book/


From wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n|  Tue Dec 21 13:26:40 2021
From: wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n| (Viechtbauer, Wolfgang (SP))
Date: Tue, 21 Dec 2021 12:26:40 +0000
Subject: [R] Creating NA equivalent
In-Reply-To: <1433246847.5064016.1640087744295.JavaMail.zimbra@psyctc.org>
References: <977561d4-86af-69a7-de39-f53a0e2dfd92.ref@yahoo.fr>
 <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
 <7ef1e12e-9024-8dba-0f68-567db68cb803@gmail.com>
 <1349245903.5000410.1640085415182.JavaMail.zimbra@psyctc.org>
 <d1ad58b35cc245b8b2b1c4dbde219534@UM-MAIL3214.unimaas.nl>
 <1433246847.5064016.1640087744295.JavaMail.zimbra@psyctc.org>
Message-ID: <9d619685dd314f63be7a4002e2a29630@UM-MAIL3214.unimaas.nl>

Say 'yi' is left censored. Then:

# naive regression model
res1 <- lm(yi ~ xi, data=dat)

# tobit model via survreg()
res2a <- survreg(Surv(yi, yi > censval, type="left") ~ xi, dist="gaussian", data=dat)

# tobit model via tobit() from AER package
res2b <- tobit(yi ~ xi, left=censval, data=dat)

# tobit model via censReg() from censReg package
res2c <- censReg(yi ~ xi, left=censval, data=dat)

(forgot to mention the AER package; and I assume there are even other packages that can fit Tobit models).

One can also have censoring on both sides in Tobit models. Just explore these packages to see what they can do.

Best,
Wolfgang

>-----Original Message-----
>From: Chris Evans [mailto:chrishold at psyctc.org]
>Sent: Tuesday, 21 December, 2021 12:56
>To: Viechtbauer, Wolfgang (SP)
>Cc: r-help at r-project.org
>Subject: Re: Creating NA equivalent
>
>Many thanks Wolfgang,
>
>I guess I can see that survival analyses don't have to be time based but
>clearly I need to read up on that.  I can't see an example in the survival
>package.  And it proves to be hard to search for one. Can anyone point me
>to useful resources on that, in {survival} or not?
>
>I am probably straying way off topic and  off list guide here but isn't a
>Tobit only handling censoring at one edge, i.e. the LDL scenario, or the UDL,
>but not both?  I think this may be getting back to Marc's original question
>and certainly, again, I would love to be pointed to either Tobit handling
>LDL _and_ UDL or to any other existing methods.
>
>TIA,
>
>Chris
>
>----- Original Message -----
>> From: "Wolfgang Viechtbauer" <wolfgang.viechtbauer at maastrichtuniversity.nl>
>> To: "Chris Evans" <chrishold at psyctc.org>
>> Cc: r-help at r-project.org
>> Sent: Tuesday, 21 December, 2021 11:31:55
>> Subject: RE: Creating NA equivalent
>
>> Hi Chris,
>>
>> The survival package provides machinery for handling censored observations.
>> Whether time is censored or some other type of variable (e.g., viral load due
>> to some lower detection limit) does not make a fundamental difference. In fact,
>> the type of model you are thinking of with 2) is a Tobit model, which can be
>> fitted using the survival package (or censReg).
>>
>> Best,
>> Wolfgang
>>
>>>-----Original Message-----
>>>From: R-help [mailto:r-help-bounces at r-project.org] On Behalf Of Chris Evans
>>>Sent: Tuesday, 21 December, 2021 12:17
>>>To: Duncan Murdoch
>>>Cc: r-help at r-project.org
>>>Subject: Re: [R] Creating NA equivalent
>>>
>>> I am neither a programmer nor a professional statistician but this topic
>>> interests me because:
>>>
>>> 1) I remember from long, long ago that S had a way to create labels that could
>>>    denote multiple ways in which a value could be missing that was sometimes
>>>    useful to me as my field sometimes has such situations.  In R I handle this
>>>    with a second variable but I can see that using attributes is cleaner and
>>>    might have real benefits when doing missing value analyses.  That might
>>>    raise questions about whether some of the nice packages that help with
>>>    missing value analyses would take on board some standardised use of
>>>    attributes for this.
>>>
>>> 2) I think Marc's question LDL/UDL is about a very particular sort of value
>>>    that isn't missing and _is_ censored but not in survival analysis meaning
>>>    of censored. (At least, it's not the same to my mind, perhaps it is?  To me
>>>    the difference is that I most often hit the LDL/UDL issue in data that
>>>    don't have much, or any, time frame.) Again, this comes up a lot for me
>>>    whe people are given limited possible answers in questionnaires and I've
>>>    often wondered if I should explore simulating probability models for an the
>>>    "off the edge" value on a latent variable beneath/behind the measured
>>>    responses.  I'd be very grateful to hear of any work in R packages (to stay
>>>    only just "off the edge" of the posting    guide).  Or of any work a long
>>>    the lines that Duncan offers, that sort of pulls this toward    base R,
>>>    though that sounds to me as if it would be a huge undertaking.
>>>
>>> I'm very interested to hear any thoughts on either aspect.
>>>
>>> Seasonal (mutivalued) greetings to all!
>>>
>> > Chris

From @erv|ce @end|ng |rom @hd@w@on@com  Tue Dec 21 16:16:08 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Tue, 21 Dec 2021 10:16:08 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
Message-ID: <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>

Thanks everyone for the replies.

It is clear one either needs to write a function or put the unique 
entries into another dataframe.

It seems odd R cannot sort a list of unique column entries with ease. 
Python and SQL can do it with ease.

QUESTION
Is there a simpler means than other than the unique function to capture 
distinct column entries, then sort that list?


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/20/21 5:53 PM, Rui Barradas wrote:
> Hello,
>
> Inline.
>
> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>> Thanks.
>>
>> sort(unique(Data[[1]]))
>>
>> This syntax provides row numbers, not column values.
>
> This is not right.
> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]] 
> extracts the column vector.
>
> As for my previous answer, it was not addressing the question, I 
> misinterpreted it as being a question on how to sort by numeric order 
> when the data is not numeric. Here is a, hopefully, complete answer.
> Still with package stringr.
>
>
> cols_to_sort <- 1:4
>
> Data2 <- lapply(Data[cols_to_sort], \(x){
> ? stringr::str_sort(unique(x), numeric = TRUE)
> })
>
>
> Or using Avi's suggestion of writing a function to do all the work and 
> simplify the lapply loop later,
>
>
> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>
>
> Hope this helps,
>
> Rui Barradas
>
>
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>> Hi,
>>>
>>>
>>> Running a simple syntax set to review entries in dataframe columns. 
>>> Here is the working code.
>>>
>>> Data <- read.csv("./input/Source.csv", header=T)
>>> describe(Data)
>>> summary(Data)
>>> unique(Data[1])
>>> unique(Data[2])
>>> unique(Data[3])
>>> unique(Data[4])
>>>
>>> I would like to add sort the unique entries. The data in the various 
>>> columns are not defined as numbers, but also text. I realize 1 and 
>>> 10 will not sort properly, as the column is not defined as a number, 
>>> but want to see what I have in the columns viewed as sorted.
>>>
>>> QUESTION
>>> What is the best process to sort unique output, please?
>>>
>>>
>>> Thanks.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Dec 21 17:07:48 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 21 Dec 2021 11:07:48 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
Message-ID: <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>

On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
> Thanks everyone for the replies.
> 
> It is clear one either needs to write a function or put the unique
> entries into another dataframe.
> 
> It seems odd R cannot sort a list of unique column entries with ease.
> Python and SQL can do it with ease.

I've seen several responses that looked pretty simple.  It's hard to 
beat sort(unique(x)), though there's a fair bit of confusion about what 
you actually want.  Maybe you should post an example of the code you'd 
use in Python?

Duncan Murdoch

> 
> QUESTION
> Is there a simpler means than other than the unique function to capture
> distinct column entries, then sort that list?
> 
> 
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
> 
> 
> On 12/20/21 5:53 PM, Rui Barradas wrote:
>> Hello,
>>
>> Inline.
>>
>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>> Thanks.
>>>
>>> sort(unique(Data[[1]]))
>>>
>>> This syntax provides row numbers, not column values.
>>
>> This is not right.
>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>> extracts the column vector.
>>
>> As for my previous answer, it was not addressing the question, I
>> misinterpreted it as being a question on how to sort by numeric order
>> when the data is not numeric. Here is a, hopefully, complete answer.
>> Still with package stringr.
>>
>>
>> cols_to_sort <- 1:4
>>
>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>  ? stringr::str_sort(unique(x), numeric = TRUE)
>> })
>>
>>
>> Or using Avi's suggestion of writing a function to do all the work and
>> simplify the lapply loop later,
>>
>>
>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>>
>>>
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>> Hi,
>>>>
>>>>
>>>> Running a simple syntax set to review entries in dataframe columns.
>>>> Here is the working code.
>>>>
>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>> describe(Data)
>>>> summary(Data)
>>>> unique(Data[1])
>>>> unique(Data[2])
>>>> unique(Data[3])
>>>> unique(Data[4])
>>>>
>>>> I would like to add sort the unique entries. The data in the various
>>>> columns are not defined as numbers, but also text. I realize 1 and
>>>> 10 will not sort properly, as the column is not defined as a number,
>>>> but want to see what I have in the columns viewed as sorted.
>>>>
>>>> QUESTION
>>>> What is the best process to sort unique output, please?
>>>>
>>>>
>>>> Thanks.
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @erv|ce @end|ng |rom @hd@w@on@com  Tue Dec 21 17:20:13 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Tue, 21 Dec 2021 11:20:13 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
Message-ID: <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>

Thanks for the reply.

sort(unique(Data[1]))
Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing = 
decreasing)) :
 ? undefined columns selected

The recommended syntax did not work, as listed above.

What I want is the sort of distinct column output. Again, the column may 
be text or numbers. This is a huge analysis effort with data coming at 
me from many different sources.


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/21/21 11:07 AM, Duncan Murdoch wrote:
> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>> Thanks everyone for the replies.
>>
>> It is clear one either needs to write a function or put the unique
>> entries into another dataframe.
>>
>> It seems odd R cannot sort a list of unique column entries with ease.
>> Python and SQL can do it with ease.
>
> I've seen several responses that looked pretty simple.? It's hard to 
> beat sort(unique(x)), though there's a fair bit of confusion about 
> what you actually want.? Maybe you should post an example of the code 
> you'd use in Python?
>
> Duncan Murdoch
>
>>
>> QUESTION
>> Is there a simpler means than other than the unique function to capture
>> distinct column entries, then sort that list?
>>
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>> Hello,
>>>
>>> Inline.
>>>
>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>> Thanks.
>>>>
>>>> sort(unique(Data[[1]]))
>>>>
>>>> This syntax provides row numbers, not column values.
>>>
>>> This is not right.
>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>>> extracts the column vector.
>>>
>>> As for my previous answer, it was not addressing the question, I
>>> misinterpreted it as being a question on how to sort by numeric order
>>> when the data is not numeric. Here is a, hopefully, complete answer.
>>> Still with package stringr.
>>>
>>>
>>> cols_to_sort <- 1:4
>>>
>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>> ?? stringr::str_sort(unique(x), numeric = TRUE)
>>> })
>>>
>>>
>>> Or using Avi's suggestion of writing a function to do all the work and
>>> simplify the lapply loop later,
>>>
>>>
>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>
>>>
>>> Hope this helps,
>>>
>>> Rui Barradas
>>>
>>>
>>>>
>>>> *Stephen Dawson, DSL*
>>>> /Executive Strategy Consultant/
>>>> Business & Technology
>>>> +1 (865) 804-3454
>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>
>>>>
>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>> Hi,
>>>>>
>>>>>
>>>>> Running a simple syntax set to review entries in dataframe columns.
>>>>> Here is the working code.
>>>>>
>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>> describe(Data)
>>>>> summary(Data)
>>>>> unique(Data[1])
>>>>> unique(Data[2])
>>>>> unique(Data[3])
>>>>> unique(Data[4])
>>>>>
>>>>> I would like to add sort the unique entries. The data in the various
>>>>> columns are not defined as numbers, but also text. I realize 1 and
>>>>> 10 will not sort properly, as the column is not defined as a number,
>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>
>>>>> QUESTION
>>>>> What is the best process to sort unique output, please?
>>>>>
>>>>>
>>>>> Thanks.
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Dec 21 17:31:06 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 21 Dec 2021 11:31:06 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
Message-ID: <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>

On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
> Thanks for the reply.
> 
> sort(unique(Data[1]))
> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
> decreasing)) :
>   ? undefined columns selected

That's the wrong syntax:  Data[1] is not "column one of Data".  Use 
Data[[1]] for that, so

   sort(unique(Data[[1]]))

I think Rui already pointed out the typo in the quoted text below...

Duncan Murdoch

> 
> The recommended syntax did not work, as listed above.
> 
> What I want is the sort of distinct column output. Again, the column may
> be text or numbers. This is a huge analysis effort with data coming at
> me from many different sources.
> 
> 
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
> 
> 
> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>> Thanks everyone for the replies.
>>>
>>> It is clear one either needs to write a function or put the unique
>>> entries into another dataframe.
>>>
>>> It seems odd R cannot sort a list of unique column entries with ease.
>>> Python and SQL can do it with ease.
>>
>> I've seen several responses that looked pretty simple.? It's hard to
>> beat sort(unique(x)), though there's a fair bit of confusion about
>> what you actually want.? Maybe you should post an example of the code
>> you'd use in Python?
>>
>> Duncan Murdoch
>>
>>>
>>> QUESTION
>>> Is there a simpler means than other than the unique function to capture
>>> distinct column entries, then sort that list?
>>>
>>>
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>> Hello,
>>>>
>>>> Inline.
>>>>
>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>>> Thanks.
>>>>>
>>>>> sort(unique(Data[[1]]))
>>>>>
>>>>> This syntax provides row numbers, not column values.
>>>>
>>>> This is not right.
>>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>>>> extracts the column vector.
>>>>
>>>> As for my previous answer, it was not addressing the question, I
>>>> misinterpreted it as being a question on how to sort by numeric order
>>>> when the data is not numeric. Here is a, hopefully, complete answer.
>>>> Still with package stringr.
>>>>
>>>>
>>>> cols_to_sort <- 1:4
>>>>
>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>  ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>> })
>>>>
>>>>
>>>> Or using Avi's suggestion of writing a function to do all the work and
>>>> simplify the lapply loop later,
>>>>
>>>>
>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>
>>>>
>>>> Hope this helps,
>>>>
>>>> Rui Barradas
>>>>
>>>>
>>>>>
>>>>> *Stephen Dawson, DSL*
>>>>> /Executive Strategy Consultant/
>>>>> Business & Technology
>>>>> +1 (865) 804-3454
>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>
>>>>>
>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>> Hi,
>>>>>>
>>>>>>
>>>>>> Running a simple syntax set to review entries in dataframe columns.
>>>>>> Here is the working code.
>>>>>>
>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>> describe(Data)
>>>>>> summary(Data)
>>>>>> unique(Data[1])
>>>>>> unique(Data[2])
>>>>>> unique(Data[3])
>>>>>> unique(Data[4])
>>>>>>
>>>>>> I would like to add sort the unique entries. The data in the various
>>>>>> columns are not defined as numbers, but also text. I realize 1 and
>>>>>> 10 will not sort properly, as the column is not defined as a number,
>>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>>
>>>>>> QUESTION
>>>>>> What is the best process to sort unique output, please?
>>>>>>
>>>>>>
>>>>>> Thanks.
>>>>>
>>>>> ______________________________________________
>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>> PLEASE do read the posting guide
>>>>> http://www.R-project.org/posting-guide.html
>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>>
> 
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Dec 21 17:38:35 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 21 Dec 2021 11:38:35 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
Message-ID: <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>

On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>> Thanks for the reply.
>>
>> sort(unique(Data[1]))
>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
>> decreasing)) :
>>    ? undefined columns selected
> 
> That's the wrong syntax:  Data[1] is not "column one of Data".  Use
> Data[[1]] for that, so
> 
>     sort(unique(Data[[1]]))

Actually, I'd probably recommend

   sort(unique(Data[, 1]))

instead.  This treats Data as a matrix rather than as a list. 
Dataframes are lists that look like matrices, but to me the matrix 
aspect is usually more intuitive.

Duncan Murdoch

> 
> I think Rui already pointed out the typo in the quoted text below...
> 
> Duncan Murdoch
> 
>>
>> The recommended syntax did not work, as listed above.
>>
>> What I want is the sort of distinct column output. Again, the column may
>> be text or numbers. This is a huge analysis effort with data coming at
>> me from many different sources.
>>
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>>> Thanks everyone for the replies.
>>>>
>>>> It is clear one either needs to write a function or put the unique
>>>> entries into another dataframe.
>>>>
>>>> It seems odd R cannot sort a list of unique column entries with ease.
>>>> Python and SQL can do it with ease.
>>>
>>> I've seen several responses that looked pretty simple.? It's hard to
>>> beat sort(unique(x)), though there's a fair bit of confusion about
>>> what you actually want.? Maybe you should post an example of the code
>>> you'd use in Python?
>>>
>>> Duncan Murdoch
>>>
>>>>
>>>> QUESTION
>>>> Is there a simpler means than other than the unique function to capture
>>>> distinct column entries, then sort that list?
>>>>
>>>>
>>>> *Stephen Dawson, DSL*
>>>> /Executive Strategy Consultant/
>>>> Business & Technology
>>>> +1 (865) 804-3454
>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>
>>>>
>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>> Hello,
>>>>>
>>>>> Inline.
>>>>>
>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>>>> Thanks.
>>>>>>
>>>>>> sort(unique(Data[[1]]))
>>>>>>
>>>>>> This syntax provides row numbers, not column values.
>>>>>
>>>>> This is not right.
>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>>>>> extracts the column vector.
>>>>>
>>>>> As for my previous answer, it was not addressing the question, I
>>>>> misinterpreted it as being a question on how to sort by numeric order
>>>>> when the data is not numeric. Here is a, hopefully, complete answer.
>>>>> Still with package stringr.
>>>>>
>>>>>
>>>>> cols_to_sort <- 1:4
>>>>>
>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>   ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>>> })
>>>>>
>>>>>
>>>>> Or using Avi's suggestion of writing a function to do all the work and
>>>>> simplify the lapply loop later,
>>>>>
>>>>>
>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>
>>>>>
>>>>> Hope this helps,
>>>>>
>>>>> Rui Barradas
>>>>>
>>>>>
>>>>>>
>>>>>> *Stephen Dawson, DSL*
>>>>>> /Executive Strategy Consultant/
>>>>>> Business & Technology
>>>>>> +1 (865) 804-3454
>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>
>>>>>>
>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>> Hi,
>>>>>>>
>>>>>>>
>>>>>>> Running a simple syntax set to review entries in dataframe columns.
>>>>>>> Here is the working code.
>>>>>>>
>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>> describe(Data)
>>>>>>> summary(Data)
>>>>>>> unique(Data[1])
>>>>>>> unique(Data[2])
>>>>>>> unique(Data[3])
>>>>>>> unique(Data[4])
>>>>>>>
>>>>>>> I would like to add sort the unique entries. The data in the various
>>>>>>> columns are not defined as numbers, but also text. I realize 1 and
>>>>>>> 10 will not sort properly, as the column is not defined as a number,
>>>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>>>
>>>>>>> QUESTION
>>>>>>> What is the best process to sort unique output, please?
>>>>>>>
>>>>>>>
>>>>>>> Thanks.
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>> PLEASE do read the posting guide
>>>>>> http://www.R-project.org/posting-guide.html
>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>>
>>
>>
>


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Tue Dec 21 17:59:09 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Tue, 21 Dec 2021 08:59:09 -0800
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
Message-ID: <28FF2409-1FD1-452A-AC4E-A3EF46E37D32@dcn.davis.ca.us>

Intuitive, perhaps, but noticably slower. And it doesn't work on tibbles by design. Data frames are lists of columns.

On December 21, 2021 8:38:35 AM PST, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>> Thanks for the reply.
>>>
>>> sort(unique(Data[1]))
>>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
>>> decreasing)) :
>>>    ? undefined columns selected
>> 
>> That's the wrong syntax:  Data[1] is not "column one of Data".  Use
>> Data[[1]] for that, so
>> 
>>     sort(unique(Data[[1]]))
>
>Actually, I'd probably recommend
>
>   sort(unique(Data[, 1]))
>
>instead.  This treats Data as a matrix rather than as a list. 
>Dataframes are lists that look like matrices, but to me the matrix 
>aspect is usually more intuitive.
>
>Duncan Murdoch
>
>> 
>> I think Rui already pointed out the typo in the quoted text below...
>> 
>> Duncan Murdoch
>> 
>>>
>>> The recommended syntax did not work, as listed above.
>>>
>>> What I want is the sort of distinct column output. Again, the column may
>>> be text or numbers. This is a huge analysis effort with data coming at
>>> me from many different sources.
>>>
>>>
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>>>> Thanks everyone for the replies.
>>>>>
>>>>> It is clear one either needs to write a function or put the unique
>>>>> entries into another dataframe.
>>>>>
>>>>> It seems odd R cannot sort a list of unique column entries with ease.
>>>>> Python and SQL can do it with ease.
>>>>
>>>> I've seen several responses that looked pretty simple.? It's hard to
>>>> beat sort(unique(x)), though there's a fair bit of confusion about
>>>> what you actually want.? Maybe you should post an example of the code
>>>> you'd use in Python?
>>>>
>>>> Duncan Murdoch
>>>>
>>>>>
>>>>> QUESTION
>>>>> Is there a simpler means than other than the unique function to capture
>>>>> distinct column entries, then sort that list?
>>>>>
>>>>>
>>>>> *Stephen Dawson, DSL*
>>>>> /Executive Strategy Consultant/
>>>>> Business & Technology
>>>>> +1 (865) 804-3454
>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>
>>>>>
>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>> Hello,
>>>>>>
>>>>>> Inline.
>>>>>>
>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>>>>> Thanks.
>>>>>>>
>>>>>>> sort(unique(Data[[1]]))
>>>>>>>
>>>>>>> This syntax provides row numbers, not column values.
>>>>>>
>>>>>> This is not right.
>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>>>>>> extracts the column vector.
>>>>>>
>>>>>> As for my previous answer, it was not addressing the question, I
>>>>>> misinterpreted it as being a question on how to sort by numeric order
>>>>>> when the data is not numeric. Here is a, hopefully, complete answer.
>>>>>> Still with package stringr.
>>>>>>
>>>>>>
>>>>>> cols_to_sort <- 1:4
>>>>>>
>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>   ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>> })
>>>>>>
>>>>>>
>>>>>> Or using Avi's suggestion of writing a function to do all the work and
>>>>>> simplify the lapply loop later,
>>>>>>
>>>>>>
>>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>
>>>>>>
>>>>>> Hope this helps,
>>>>>>
>>>>>> Rui Barradas
>>>>>>
>>>>>>
>>>>>>>
>>>>>>> *Stephen Dawson, DSL*
>>>>>>> /Executive Strategy Consultant/
>>>>>>> Business & Technology
>>>>>>> +1 (865) 804-3454
>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>
>>>>>>>
>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>> Hi,
>>>>>>>>
>>>>>>>>
>>>>>>>> Running a simple syntax set to review entries in dataframe columns.
>>>>>>>> Here is the working code.
>>>>>>>>
>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>> describe(Data)
>>>>>>>> summary(Data)
>>>>>>>> unique(Data[1])
>>>>>>>> unique(Data[2])
>>>>>>>> unique(Data[3])
>>>>>>>> unique(Data[4])
>>>>>>>>
>>>>>>>> I would like to add sort the unique entries. The data in the various
>>>>>>>> columns are not defined as numbers, but also text. I realize 1 and
>>>>>>>> 10 will not sort properly, as the column is not defined as a number,
>>>>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>>>>
>>>>>>>> QUESTION
>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>
>>>>>>>>
>>>>>>>> Thanks.
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>> PLEASE do read the posting guide
>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>> PLEASE do read the posting guide
>>>>> http://www.R-project.org/posting-guide.html
>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>>>
>>>
>>>
>>
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Dec 21 18:02:56 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 21 Dec 2021 12:02:56 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <28FF2409-1FD1-452A-AC4E-A3EF46E37D32@dcn.davis.ca.us>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <28FF2409-1FD1-452A-AC4E-A3EF46E37D32@dcn.davis.ca.us>
Message-ID: <eeb26e85-3951-1d54-3eaa-aea5bfb7d9da@gmail.com>

On 21/12/2021 11:59 a.m., Jeff Newmiller wrote:
> Intuitive, perhaps, but noticably slower. And it doesn't work on tibbles by design. Data frames are lists of columns.

That's just one of the design flaws in tibbles, but not the worst one.

Duncan Murdoch

> 
> On December 21, 2021 8:38:35 AM PST, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>> Thanks for the reply.
>>>>
>>>> sort(unique(Data[1]))
>>>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
>>>> decreasing)) :
>>>>     ? undefined columns selected
>>>
>>> That's the wrong syntax:  Data[1] is not "column one of Data".  Use
>>> Data[[1]] for that, so
>>>
>>>      sort(unique(Data[[1]]))
>>
>> Actually, I'd probably recommend
>>
>>    sort(unique(Data[, 1]))
>>
>> instead.  This treats Data as a matrix rather than as a list.
>> Dataframes are lists that look like matrices, but to me the matrix
>> aspect is usually more intuitive.
>>
>> Duncan Murdoch
>>
>>>
>>> I think Rui already pointed out the typo in the quoted text below...
>>>
>>> Duncan Murdoch
>>>
>>>>
>>>> The recommended syntax did not work, as listed above.
>>>>
>>>> What I want is the sort of distinct column output. Again, the column may
>>>> be text or numbers. This is a huge analysis effort with data coming at
>>>> me from many different sources.
>>>>
>>>>
>>>> *Stephen Dawson, DSL*
>>>> /Executive Strategy Consultant/
>>>> Business & Technology
>>>> +1 (865) 804-3454
>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>
>>>>
>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>>>>> Thanks everyone for the replies.
>>>>>>
>>>>>> It is clear one either needs to write a function or put the unique
>>>>>> entries into another dataframe.
>>>>>>
>>>>>> It seems odd R cannot sort a list of unique column entries with ease.
>>>>>> Python and SQL can do it with ease.
>>>>>
>>>>> I've seen several responses that looked pretty simple.? It's hard to
>>>>> beat sort(unique(x)), though there's a fair bit of confusion about
>>>>> what you actually want.? Maybe you should post an example of the code
>>>>> you'd use in Python?
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>>
>>>>>> QUESTION
>>>>>> Is there a simpler means than other than the unique function to capture
>>>>>> distinct column entries, then sort that list?
>>>>>>
>>>>>>
>>>>>> *Stephen Dawson, DSL*
>>>>>> /Executive Strategy Consultant/
>>>>>> Business & Technology
>>>>>> +1 (865) 804-3454
>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>
>>>>>>
>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>> Hello,
>>>>>>>
>>>>>>> Inline.
>>>>>>>
>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>>>>>> Thanks.
>>>>>>>>
>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>
>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>
>>>>>>> This is not right.
>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>>>>>>> extracts the column vector.
>>>>>>>
>>>>>>> As for my previous answer, it was not addressing the question, I
>>>>>>> misinterpreted it as being a question on how to sort by numeric order
>>>>>>> when the data is not numeric. Here is a, hopefully, complete answer.
>>>>>>> Still with package stringr.
>>>>>>>
>>>>>>>
>>>>>>> cols_to_sort <- 1:4
>>>>>>>
>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>    ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>> })
>>>>>>>
>>>>>>>
>>>>>>> Or using Avi's suggestion of writing a function to do all the work and
>>>>>>> simplify the lapply loop later,
>>>>>>>
>>>>>>>
>>>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>
>>>>>>>
>>>>>>> Hope this helps,
>>>>>>>
>>>>>>> Rui Barradas
>>>>>>>
>>>>>>>
>>>>>>>>
>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>> /Executive Strategy Consultant/
>>>>>>>> Business & Technology
>>>>>>>> +1 (865) 804-3454
>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>
>>>>>>>>
>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>> Hi,
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Running a simple syntax set to review entries in dataframe columns.
>>>>>>>>> Here is the working code.
>>>>>>>>>
>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>> describe(Data)
>>>>>>>>> summary(Data)
>>>>>>>>> unique(Data[1])
>>>>>>>>> unique(Data[2])
>>>>>>>>> unique(Data[3])
>>>>>>>>> unique(Data[4])
>>>>>>>>>
>>>>>>>>> I would like to add sort the unique entries. The data in the various
>>>>>>>>> columns are not defined as numbers, but also text. I realize 1 and
>>>>>>>>> 10 will not sort properly, as the column is not defined as a number,
>>>>>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>>>>>
>>>>>>>>> QUESTION
>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Thanks.
>>>>>>>>
>>>>>>>> ______________________________________________
>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>> PLEASE do read the posting guide
>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>>
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>> PLEASE do read the posting guide
>>>>>> http://www.R-project.org/posting-guide.html
>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>
>>>>>
>>>>
>>>>
>>>
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>


From j|ox @end|ng |rom mcm@@ter@c@  Tue Dec 21 18:28:52 2021
From: j|ox @end|ng |rom mcm@@ter@c@ (Fox, John)
Date: Tue, 21 Dec 2021 17:28:52 +0000
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <18709_1640105982_1BLGxdaM021134_28FF2409-1FD1-452A-AC4E-A3EF46E37D32@dcn.davis.ca.us>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <18709_1640105982_1BLGxdaM021134_28FF2409-1FD1-452A-AC4E-A3EF46E37D32@dcn.davis.ca.us>
Message-ID: <F74A436D-C417-4ABE-80DE-F08393606837@mcmaster.ca>

Dear Jeff,

?On 2021-12-21, 11:59 AM, "R-help on behalf of Jeff Newmiller" <r-help-bounces at r-project.org on behalf of jdnewmil at dcn.davis.ca.us> wrote:

    Intuitive, perhaps, but noticably slower. 

I think that in most applications, one wouldn't notice the difference; for example:

> D <- data.frame(matrix(rnorm(1000*1e6), 1e6, 1000))

> microbenchmark(D[, 1])
Unit: microseconds
   expr   min    lq    mean median     uq    max neval
 D[, 1] 3.321 3.362 3.98561  3.444 3.5875 51.291   100

> microbenchmark(D[[1]])
Unit: microseconds
   expr   min    lq    mean median     uq    max neval
 D[[1]] 1.722 1.763 1.99137  1.804 1.8655 17.876   100

Best,
 John


    And it doesn't work on tibbles by design. Data frames are lists of columns.


    On December 21, 2021 8:38:35 AM PST, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
    >On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
    >> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
    >>> Thanks for the reply.
    >>>
    >>> sort(unique(Data[1]))
    >>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
    >>> decreasing)) :
    >>>      undefined columns selected
    >> 
    >> That's the wrong syntax:  Data[1] is not "column one of Data".  Use
    >> Data[[1]] for that, so
    >> 
    >>     sort(unique(Data[[1]]))
    >
    >Actually, I'd probably recommend
    >
    >   sort(unique(Data[, 1]))
    >
    >instead.  This treats Data as a matrix rather than as a list. 
    >Dataframes are lists that look like matrices, but to me the matrix 
    >aspect is usually more intuitive.
    >
    >Duncan Murdoch
    >
    >> 
    >> I think Rui already pointed out the typo in the quoted text below...
    >> 
    >> Duncan Murdoch
    >> 
    >>>
    >>> The recommended syntax did not work, as listed above.
    >>>
    >>> What I want is the sort of distinct column output. Again, the column may
    >>> be text or numbers. This is a huge analysis effort with data coming at
    >>> me from many different sources.
    >>>
    >>>
    >>> *Stephen Dawson, DSL*
    >>> /Executive Strategy Consultant/
    >>> Business & Technology
    >>> +1 (865) 804-3454
    >>> http://www.shdawson.com <http://www.shdawson.com>
    >>>
    >>>
    >>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
    >>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
    >>>>> Thanks everyone for the replies.
    >>>>>
    >>>>> It is clear one either needs to write a function or put the unique
    >>>>> entries into another dataframe.
    >>>>>
    >>>>> It seems odd R cannot sort a list of unique column entries with ease.
    >>>>> Python and SQL can do it with ease.
    >>>>
    >>>> I've seen several responses that looked pretty simple.  It's hard to
    >>>> beat sort(unique(x)), though there's a fair bit of confusion about
    >>>> what you actually want.  Maybe you should post an example of the code
    >>>> you'd use in Python?
    >>>>
    >>>> Duncan Murdoch
    >>>>
    >>>>>
    >>>>> QUESTION
    >>>>> Is there a simpler means than other than the unique function to capture
    >>>>> distinct column entries, then sort that list?
    >>>>>
    >>>>>
    >>>>> *Stephen Dawson, DSL*
    >>>>> /Executive Strategy Consultant/
    >>>>> Business & Technology
    >>>>> +1 (865) 804-3454
    >>>>> http://www.shdawson.com <http://www.shdawson.com>
    >>>>>
    >>>>>
    >>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
    >>>>>> Hello,
    >>>>>>
    >>>>>> Inline.
    >>>>>>
    >>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
    >>>>>>> Thanks.
    >>>>>>>
    >>>>>>> sort(unique(Data[[1]]))
    >>>>>>>
    >>>>>>> This syntax provides row numbers, not column values.
    >>>>>>
    >>>>>> This is not right.
    >>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
    >>>>>> extracts the column vector.
    >>>>>>
    >>>>>> As for my previous answer, it was not addressing the question, I
    >>>>>> misinterpreted it as being a question on how to sort by numeric order
    >>>>>> when the data is not numeric. Here is a, hopefully, complete answer.
    >>>>>> Still with package stringr.
    >>>>>>
    >>>>>>
    >>>>>> cols_to_sort <- 1:4
    >>>>>>
    >>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
    >>>>>>      stringr::str_sort(unique(x), numeric = TRUE)
    >>>>>> })
    >>>>>>
    >>>>>>
    >>>>>> Or using Avi's suggestion of writing a function to do all the work and
    >>>>>> simplify the lapply loop later,
    >>>>>>
    >>>>>>
    >>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
    >>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
    >>>>>>
    >>>>>>
    >>>>>> Hope this helps,
    >>>>>>
    >>>>>> Rui Barradas
    >>>>>>
    >>>>>>
    >>>>>>>
    >>>>>>> *Stephen Dawson, DSL*
    >>>>>>> /Executive Strategy Consultant/
    >>>>>>> Business & Technology
    >>>>>>> +1 (865) 804-3454
    >>>>>>> http://www.shdawson.com <http://www.shdawson.com>
    >>>>>>>
    >>>>>>>
    >>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
    >>>>>>>> Hi,
    >>>>>>>>
    >>>>>>>>
    >>>>>>>> Running a simple syntax set to review entries in dataframe columns.
    >>>>>>>> Here is the working code.
    >>>>>>>>
    >>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
    >>>>>>>> describe(Data)
    >>>>>>>> summary(Data)
    >>>>>>>> unique(Data[1])
    >>>>>>>> unique(Data[2])
    >>>>>>>> unique(Data[3])
    >>>>>>>> unique(Data[4])
    >>>>>>>>
    >>>>>>>> I would like to add sort the unique entries. The data in the various
    >>>>>>>> columns are not defined as numbers, but also text. I realize 1 and
    >>>>>>>> 10 will not sort properly, as the column is not defined as a number,
    >>>>>>>> but want to see what I have in the columns viewed as sorted.
    >>>>>>>>
    >>>>>>>> QUESTION
    >>>>>>>> What is the best process to sort unique output, please?
    >>>>>>>>
    >>>>>>>>
    >>>>>>>> Thanks.
    >>>>>>>
    >>>>>>> ______________________________________________
    >>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
    >>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
    >>>>>>> PLEASE do read the posting guide
    >>>>>>> http://www.R-project.org/posting-guide.html
    >>>>>>> and provide commented, minimal, self-contained, reproducible code.
    >>>>>>
    >>>>>
    >>>>> ______________________________________________
    >>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
    >>>>> https://stat.ethz.ch/mailman/listinfo/r-help
    >>>>> PLEASE do read the posting guide
    >>>>> http://www.R-project.org/posting-guide.html
    >>>>> and provide commented, minimal, self-contained, reproducible code.
    >>>>
    >>>>
    >>>
    >>>
    >>
    >
    >______________________________________________
    >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
    >https://stat.ethz.ch/mailman/listinfo/r-help
    >PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
    >and provide commented, minimal, self-contained, reproducible code.

    -- 
    Sent from my phone. Please excuse my brevity.

    ______________________________________________
    R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
    https://stat.ethz.ch/mailman/listinfo/r-help
    PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
    and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Tue Dec 21 18:29:10 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Tue, 21 Dec 2021 09:29:10 -0800
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <eeb26e85-3951-1d54-3eaa-aea5bfb7d9da@gmail.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <28FF2409-1FD1-452A-AC4E-A3EF46E37D32@dcn.davis.ca.us>
 <eeb26e85-3951-1d54-3eaa-aea5bfb7d9da@gmail.com>
Message-ID: <5272710A-22AC-4878-9493-C8A846C0CC5D@dcn.davis.ca.us>

It is a very rational choice, not a design flaw. I don't like every choice they have made for that class, but this one is very solid, and treating data frames as lists of columns consistently helps all of us.

On December 21, 2021 9:02:56 AM PST, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>On 21/12/2021 11:59 a.m., Jeff Newmiller wrote:
>> Intuitive, perhaps, but noticably slower. And it doesn't work on tibbles by design. Data frames are lists of columns.
>
>That's just one of the design flaws in tibbles, but not the worst one.
>
>Duncan Murdoch
>
>> 
>> On December 21, 2021 8:38:35 AM PST, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>> Thanks for the reply.
>>>>>
>>>>> sort(unique(Data[1]))
>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
>>>>> decreasing)) :
>>>>>     ? undefined columns selected
>>>>
>>>> That's the wrong syntax:  Data[1] is not "column one of Data".  Use
>>>> Data[[1]] for that, so
>>>>
>>>>      sort(unique(Data[[1]]))
>>>
>>> Actually, I'd probably recommend
>>>
>>>    sort(unique(Data[, 1]))
>>>
>>> instead.  This treats Data as a matrix rather than as a list.
>>> Dataframes are lists that look like matrices, but to me the matrix
>>> aspect is usually more intuitive.
>>>
>>> Duncan Murdoch
>>>
>>>>
>>>> I think Rui already pointed out the typo in the quoted text below...
>>>>
>>>> Duncan Murdoch
>>>>
>>>>>
>>>>> The recommended syntax did not work, as listed above.
>>>>>
>>>>> What I want is the sort of distinct column output. Again, the column may
>>>>> be text or numbers. This is a huge analysis effort with data coming at
>>>>> me from many different sources.
>>>>>
>>>>>
>>>>> *Stephen Dawson, DSL*
>>>>> /Executive Strategy Consultant/
>>>>> Business & Technology
>>>>> +1 (865) 804-3454
>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>
>>>>>
>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>>>>>> Thanks everyone for the replies.
>>>>>>>
>>>>>>> It is clear one either needs to write a function or put the unique
>>>>>>> entries into another dataframe.
>>>>>>>
>>>>>>> It seems odd R cannot sort a list of unique column entries with ease.
>>>>>>> Python and SQL can do it with ease.
>>>>>>
>>>>>> I've seen several responses that looked pretty simple.? It's hard to
>>>>>> beat sort(unique(x)), though there's a fair bit of confusion about
>>>>>> what you actually want.? Maybe you should post an example of the code
>>>>>> you'd use in Python?
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>>
>>>>>>> QUESTION
>>>>>>> Is there a simpler means than other than the unique function to capture
>>>>>>> distinct column entries, then sort that list?
>>>>>>>
>>>>>>>
>>>>>>> *Stephen Dawson, DSL*
>>>>>>> /Executive Strategy Consultant/
>>>>>>> Business & Technology
>>>>>>> +1 (865) 804-3454
>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>
>>>>>>>
>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>> Hello,
>>>>>>>>
>>>>>>>> Inline.
>>>>>>>>
>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>>>>>>> Thanks.
>>>>>>>>>
>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>
>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>
>>>>>>>> This is not right.
>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>>>>>>>> extracts the column vector.
>>>>>>>>
>>>>>>>> As for my previous answer, it was not addressing the question, I
>>>>>>>> misinterpreted it as being a question on how to sort by numeric order
>>>>>>>> when the data is not numeric. Here is a, hopefully, complete answer.
>>>>>>>> Still with package stringr.
>>>>>>>>
>>>>>>>>
>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>
>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>>    ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>> })
>>>>>>>>
>>>>>>>>
>>>>>>>> Or using Avi's suggestion of writing a function to do all the work and
>>>>>>>> simplify the lapply loop later,
>>>>>>>>
>>>>>>>>
>>>>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>
>>>>>>>>
>>>>>>>> Hope this helps,
>>>>>>>>
>>>>>>>> Rui Barradas
>>>>>>>>
>>>>>>>>
>>>>>>>>>
>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>> Business & Technology
>>>>>>>>> +1 (865) 804-3454
>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>>> Hi,
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Running a simple syntax set to review entries in dataframe columns.
>>>>>>>>>> Here is the working code.
>>>>>>>>>>
>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>> describe(Data)
>>>>>>>>>> summary(Data)
>>>>>>>>>> unique(Data[1])
>>>>>>>>>> unique(Data[2])
>>>>>>>>>> unique(Data[3])
>>>>>>>>>> unique(Data[4])
>>>>>>>>>>
>>>>>>>>>> I would like to add sort the unique entries. The data in the various
>>>>>>>>>> columns are not defined as numbers, but also text. I realize 1 and
>>>>>>>>>> 10 will not sort properly, as the column is not defined as a number,
>>>>>>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>>>>>>
>>>>>>>>>> QUESTION
>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Thanks.
>>>>>>>>>
>>>>>>>>> ______________________________________________
>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>>>
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>> PLEASE do read the posting guide
>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>> 
>

-- 
Sent from my phone. Please excuse my brevity.


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Dec 21 18:53:35 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 21 Dec 2021 12:53:35 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <5272710A-22AC-4878-9493-C8A846C0CC5D@dcn.davis.ca.us>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <28FF2409-1FD1-452A-AC4E-A3EF46E37D32@dcn.davis.ca.us>
 <eeb26e85-3951-1d54-3eaa-aea5bfb7d9da@gmail.com>
 <5272710A-22AC-4878-9493-C8A846C0CC5D@dcn.davis.ca.us>
Message-ID: <714a3816-9e70-644d-70f1-73d0d4914e8f@gmail.com>

On 21/12/2021 12:29 p.m., Jeff Newmiller wrote:
> It is a very rational choice, not a design flaw. I don't like every choice they have made for that class, but this one is very solid, and treating data frames as lists of columns consistently helps all of us.
I think outlawing matrix notation is a really bad idea.  It makes code 
harder to read, and makes it much harder to switch to matrices, which 
sometimes gives a huge speed boost to code.

For example, John Fox posted an example that showed that operations on 
whole columns of dataframes is about twice as fast using list notation 
as using matrix notation.  But for operating on whole rows, matrices are 
about 100 times faster than dataframes.  You shouldn't use notation that 
makes the switch to matrices more difficult.

Duncan Murdoch

> 
> On December 21, 2021 9:02:56 AM PST, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>> On 21/12/2021 11:59 a.m., Jeff Newmiller wrote:
>>> Intuitive, perhaps, but noticably slower. And it doesn't work on tibbles by design. Data frames are lists of columns.
>>
>> That's just one of the design flaws in tibbles, but not the worst one.
>>
>> Duncan Murdoch
>>
>>>
>>> On December 21, 2021 8:38:35 AM PST, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>> Thanks for the reply.
>>>>>>
>>>>>> sort(unique(Data[1]))
>>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
>>>>>> decreasing)) :
>>>>>>      ? undefined columns selected
>>>>>
>>>>> That's the wrong syntax:  Data[1] is not "column one of Data".  Use
>>>>> Data[[1]] for that, so
>>>>>
>>>>>       sort(unique(Data[[1]]))
>>>>
>>>> Actually, I'd probably recommend
>>>>
>>>>     sort(unique(Data[, 1]))
>>>>
>>>> instead.  This treats Data as a matrix rather than as a list.
>>>> Dataframes are lists that look like matrices, but to me the matrix
>>>> aspect is usually more intuitive.
>>>>
>>>> Duncan Murdoch
>>>>
>>>>>
>>>>> I think Rui already pointed out the typo in the quoted text below...
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>>
>>>>>> The recommended syntax did not work, as listed above.
>>>>>>
>>>>>> What I want is the sort of distinct column output. Again, the column may
>>>>>> be text or numbers. This is a huge analysis effort with data coming at
>>>>>> me from many different sources.
>>>>>>
>>>>>>
>>>>>> *Stephen Dawson, DSL*
>>>>>> /Executive Strategy Consultant/
>>>>>> Business & Technology
>>>>>> +1 (865) 804-3454
>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>
>>>>>>
>>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>> Thanks everyone for the replies.
>>>>>>>>
>>>>>>>> It is clear one either needs to write a function or put the unique
>>>>>>>> entries into another dataframe.
>>>>>>>>
>>>>>>>> It seems odd R cannot sort a list of unique column entries with ease.
>>>>>>>> Python and SQL can do it with ease.
>>>>>>>
>>>>>>> I've seen several responses that looked pretty simple.? It's hard to
>>>>>>> beat sort(unique(x)), though there's a fair bit of confusion about
>>>>>>> what you actually want.? Maybe you should post an example of the code
>>>>>>> you'd use in Python?
>>>>>>>
>>>>>>> Duncan Murdoch
>>>>>>>
>>>>>>>>
>>>>>>>> QUESTION
>>>>>>>> Is there a simpler means than other than the unique function to capture
>>>>>>>> distinct column entries, then sort that list?
>>>>>>>>
>>>>>>>>
>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>> /Executive Strategy Consultant/
>>>>>>>> Business & Technology
>>>>>>>> +1 (865) 804-3454
>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>
>>>>>>>>
>>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>>> Hello,
>>>>>>>>>
>>>>>>>>> Inline.
>>>>>>>>>
>>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>>>>>>>> Thanks.
>>>>>>>>>>
>>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>>
>>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>>
>>>>>>>>> This is not right.
>>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>>>>>>>>> extracts the column vector.
>>>>>>>>>
>>>>>>>>> As for my previous answer, it was not addressing the question, I
>>>>>>>>> misinterpreted it as being a question on how to sort by numeric order
>>>>>>>>> when the data is not numeric. Here is a, hopefully, complete answer.
>>>>>>>>> Still with package stringr.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>>
>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>>>     ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>>> })
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Or using Avi's suggestion of writing a function to do all the work and
>>>>>>>>> simplify the lapply loop later,
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Hope this helps,
>>>>>>>>>
>>>>>>>>> Rui Barradas
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>>> Business & Technology
>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>>>> Hi,
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Running a simple syntax set to review entries in dataframe columns.
>>>>>>>>>>> Here is the working code.
>>>>>>>>>>>
>>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>>> describe(Data)
>>>>>>>>>>> summary(Data)
>>>>>>>>>>> unique(Data[1])
>>>>>>>>>>> unique(Data[2])
>>>>>>>>>>> unique(Data[3])
>>>>>>>>>>> unique(Data[4])
>>>>>>>>>>>
>>>>>>>>>>> I would like to add sort the unique entries. The data in the various
>>>>>>>>>>> columns are not defined as numbers, but also text. I realize 1 and
>>>>>>>>>>> 10 will not sort properly, as the column is not defined as a number,
>>>>>>>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>>>>>>>
>>>>>>>>>>> QUESTION
>>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Thanks.
>>>>>>>>>>
>>>>>>>>>> ______________________________________________
>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>>>>
>>>>>>>>
>>>>>>>> ______________________________________________
>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>> PLEASE do read the posting guide
>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>>
>>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>
>


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Tue Dec 21 18:58:29 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Tue, 21 Dec 2021 09:58:29 -0800
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <F74A436D-C417-4ABE-80DE-F08393606837@mcmaster.ca>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <18709_1640105982_1BLGxdaM021134_28FF2409-1FD1-452A-AC4E-A3EF46E37D32@dcn.davis.ca.us>
 <F74A436D-C417-4ABE-80DE-F08393606837@mcmaster.ca>
Message-ID: <437721B4-E452-4401-AFF5-AA59783300F1@dcn.davis.ca.us>

When your brain is wired to treat a data frame like a matrix, then you think things like

for ( col in colnames( col ) ) {
  idx <- expr
  D[ col, idx ] <- otherexpr
}

are reasonable, when

for ( col in colnames( col ) ) {
  idx <- expr
  D[[ col ]][ idx ] <- otherexpr
}

does actually run significantly faster.


On December 21, 2021 9:28:52 AM PST, "Fox, John" <jfox at mcmaster.ca> wrote:
>Dear Jeff,
>
>?On 2021-12-21, 11:59 AM, "R-help on behalf of Jeff Newmiller" <r-help-bounces at r-project.org on behalf of jdnewmil at dcn.davis.ca.us> wrote:
>
>    Intuitive, perhaps, but noticably slower. 
>
>I think that in most applications, one wouldn't notice the difference; for example:
>
>> D <- data.frame(matrix(rnorm(1000*1e6), 1e6, 1000))
>
>> microbenchmark(D[, 1])
>Unit: microseconds
>   expr   min    lq    mean median     uq    max neval
> D[, 1] 3.321 3.362 3.98561  3.444 3.5875 51.291   100
>
>> microbenchmark(D[[1]])
>Unit: microseconds
>   expr   min    lq    mean median     uq    max neval
> D[[1]] 1.722 1.763 1.99137  1.804 1.8655 17.876   100
>
>Best,
> John
>
>
>    And it doesn't work on tibbles by design. Data frames are lists of columns.
>
>
>    On December 21, 2021 8:38:35 AM PST, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>    >On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>    >> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>    >>> Thanks for the reply.
>    >>>
>    >>> sort(unique(Data[1]))
>    >>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
>    >>> decreasing)) :
>    >>>      undefined columns selected
>    >> 
>    >> That's the wrong syntax:  Data[1] is not "column one of Data".  Use
>    >> Data[[1]] for that, so
>    >> 
>    >>     sort(unique(Data[[1]]))
>    >
>    >Actually, I'd probably recommend
>    >
>    >   sort(unique(Data[, 1]))
>    >
>    >instead.  This treats Data as a matrix rather than as a list. 
>    >Dataframes are lists that look like matrices, but to me the matrix 
>    >aspect is usually more intuitive.
>    >
>    >Duncan Murdoch
>    >
>    >> 
>    >> I think Rui already pointed out the typo in the quoted text below...
>    >> 
>    >> Duncan Murdoch
>    >> 
>    >>>
>    >>> The recommended syntax did not work, as listed above.
>    >>>
>    >>> What I want is the sort of distinct column output. Again, the column may
>    >>> be text or numbers. This is a huge analysis effort with data coming at
>    >>> me from many different sources.
>    >>>
>    >>>
>    >>> *Stephen Dawson, DSL*
>    >>> /Executive Strategy Consultant/
>    >>> Business & Technology
>    >>> +1 (865) 804-3454
>    >>> http://www.shdawson.com <http://www.shdawson.com>
>    >>>
>    >>>
>    >>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>    >>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>    >>>>> Thanks everyone for the replies.
>    >>>>>
>    >>>>> It is clear one either needs to write a function or put the unique
>    >>>>> entries into another dataframe.
>    >>>>>
>    >>>>> It seems odd R cannot sort a list of unique column entries with ease.
>    >>>>> Python and SQL can do it with ease.
>    >>>>
>    >>>> I've seen several responses that looked pretty simple.  It's hard to
>    >>>> beat sort(unique(x)), though there's a fair bit of confusion about
>    >>>> what you actually want.  Maybe you should post an example of the code
>    >>>> you'd use in Python?
>    >>>>
>    >>>> Duncan Murdoch
>    >>>>
>    >>>>>
>    >>>>> QUESTION
>    >>>>> Is there a simpler means than other than the unique function to capture
>    >>>>> distinct column entries, then sort that list?
>    >>>>>
>    >>>>>
>    >>>>> *Stephen Dawson, DSL*
>    >>>>> /Executive Strategy Consultant/
>    >>>>> Business & Technology
>    >>>>> +1 (865) 804-3454
>    >>>>> http://www.shdawson.com <http://www.shdawson.com>
>    >>>>>
>    >>>>>
>    >>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>    >>>>>> Hello,
>    >>>>>>
>    >>>>>> Inline.
>    >>>>>>
>    >>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>    >>>>>>> Thanks.
>    >>>>>>>
>    >>>>>>> sort(unique(Data[[1]]))
>    >>>>>>>
>    >>>>>>> This syntax provides row numbers, not column values.
>    >>>>>>
>    >>>>>> This is not right.
>    >>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>    >>>>>> extracts the column vector.
>    >>>>>>
>    >>>>>> As for my previous answer, it was not addressing the question, I
>    >>>>>> misinterpreted it as being a question on how to sort by numeric order
>    >>>>>> when the data is not numeric. Here is a, hopefully, complete answer.
>    >>>>>> Still with package stringr.
>    >>>>>>
>    >>>>>>
>    >>>>>> cols_to_sort <- 1:4
>    >>>>>>
>    >>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>    >>>>>>      stringr::str_sort(unique(x), numeric = TRUE)
>    >>>>>> })
>    >>>>>>
>    >>>>>>
>    >>>>>> Or using Avi's suggestion of writing a function to do all the work and
>    >>>>>> simplify the lapply loop later,
>    >>>>>>
>    >>>>>>
>    >>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>    >>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>    >>>>>>
>    >>>>>>
>    >>>>>> Hope this helps,
>    >>>>>>
>    >>>>>> Rui Barradas
>    >>>>>>
>    >>>>>>
>    >>>>>>>
>    >>>>>>> *Stephen Dawson, DSL*
>    >>>>>>> /Executive Strategy Consultant/
>    >>>>>>> Business & Technology
>    >>>>>>> +1 (865) 804-3454
>    >>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>    >>>>>>>
>    >>>>>>>
>    >>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>    >>>>>>>> Hi,
>    >>>>>>>>
>    >>>>>>>>
>    >>>>>>>> Running a simple syntax set to review entries in dataframe columns.
>    >>>>>>>> Here is the working code.
>    >>>>>>>>
>    >>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>    >>>>>>>> describe(Data)
>    >>>>>>>> summary(Data)
>    >>>>>>>> unique(Data[1])
>    >>>>>>>> unique(Data[2])
>    >>>>>>>> unique(Data[3])
>    >>>>>>>> unique(Data[4])
>    >>>>>>>>
>    >>>>>>>> I would like to add sort the unique entries. The data in the various
>    >>>>>>>> columns are not defined as numbers, but also text. I realize 1 and
>    >>>>>>>> 10 will not sort properly, as the column is not defined as a number,
>    >>>>>>>> but want to see what I have in the columns viewed as sorted.
>    >>>>>>>>
>    >>>>>>>> QUESTION
>    >>>>>>>> What is the best process to sort unique output, please?
>    >>>>>>>>
>    >>>>>>>>
>    >>>>>>>> Thanks.
>    >>>>>>>
>    >>>>>>> ______________________________________________
>    >>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>    >>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>    >>>>>>> PLEASE do read the posting guide
>    >>>>>>> http://www.R-project.org/posting-guide.html
>    >>>>>>> and provide commented, minimal, self-contained, reproducible code.
>    >>>>>>
>    >>>>>
>    >>>>> ______________________________________________
>    >>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>    >>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>    >>>>> PLEASE do read the posting guide
>    >>>>> http://www.R-project.org/posting-guide.html
>    >>>>> and provide commented, minimal, self-contained, reproducible code.
>    >>>>
>    >>>>
>    >>>
>    >>>
>    >>
>    >
>    >______________________________________________
>    >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>    >https://stat.ethz.ch/mailman/listinfo/r-help
>    >PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>    >and provide commented, minimal, self-contained, reproducible code.
>
>    -- 
>    Sent from my phone. Please excuse my brevity.
>
>    ______________________________________________
>    R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>    https://stat.ethz.ch/mailman/listinfo/r-help
>    PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>    and provide commented, minimal, self-contained, reproducible code.
>

-- 
Sent from my phone. Please excuse my brevity.


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Dec 21 19:09:14 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 21 Dec 2021 13:09:14 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <714a3816-9e70-644d-70f1-73d0d4914e8f@gmail.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <28FF2409-1FD1-452A-AC4E-A3EF46E37D32@dcn.davis.ca.us>
 <eeb26e85-3951-1d54-3eaa-aea5bfb7d9da@gmail.com>
 <5272710A-22AC-4878-9493-C8A846C0CC5D@dcn.davis.ca.us>
 <714a3816-9e70-644d-70f1-73d0d4914e8f@gmail.com>
Message-ID: <c5aba36c-bc57-a99f-db51-fc32dd9999d7@gmail.com>

On 21/12/2021 12:53 p.m., Duncan Murdoch wrote:
> On 21/12/2021 12:29 p.m., Jeff Newmiller wrote:
>> It is a very rational choice, not a design flaw. I don't like every choice they have made for that class, but this one is very solid, and treating data frames as lists of columns consistently helps all of us.
> I think outlawing matrix notation is a really bad idea.  It makes code
> harder to read, and makes it much harder to switch to matrices, which
> sometimes gives a huge speed boost to code.
> 
> For example, John Fox posted an example that showed that operations on
> whole columns of dataframes is about twice as fast using list notation
> as using matrix notation.  But for operating on whole rows, 

... or on individual elements ...

 > matrices are
> about 100 times faster than dataframes.  You shouldn't use notation that
> makes the switch to matrices more difficult.
> 
> Duncan Murdoch
> 
>>
>> On December 21, 2021 9:02:56 AM PST, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>> On 21/12/2021 11:59 a.m., Jeff Newmiller wrote:
>>>> Intuitive, perhaps, but noticably slower. And it doesn't work on tibbles by design. Data frames are lists of columns.
>>>
>>> That's just one of the design flaws in tibbles, but not the worst one.
>>>
>>> Duncan Murdoch
>>>
>>>>
>>>> On December 21, 2021 8:38:35 AM PST, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>>> Thanks for the reply.
>>>>>>>
>>>>>>> sort(unique(Data[1]))
>>>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
>>>>>>> decreasing)) :
>>>>>>>       ? undefined columns selected
>>>>>>
>>>>>> That's the wrong syntax:  Data[1] is not "column one of Data".  Use
>>>>>> Data[[1]] for that, so
>>>>>>
>>>>>>        sort(unique(Data[[1]]))
>>>>>
>>>>> Actually, I'd probably recommend
>>>>>
>>>>>      sort(unique(Data[, 1]))
>>>>>
>>>>> instead.  This treats Data as a matrix rather than as a list.
>>>>> Dataframes are lists that look like matrices, but to me the matrix
>>>>> aspect is usually more intuitive.
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>>
>>>>>> I think Rui already pointed out the typo in the quoted text below...
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>>
>>>>>>> The recommended syntax did not work, as listed above.
>>>>>>>
>>>>>>> What I want is the sort of distinct column output. Again, the column may
>>>>>>> be text or numbers. This is a huge analysis effort with data coming at
>>>>>>> me from many different sources.
>>>>>>>
>>>>>>>
>>>>>>> *Stephen Dawson, DSL*
>>>>>>> /Executive Strategy Consultant/
>>>>>>> Business & Technology
>>>>>>> +1 (865) 804-3454
>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>
>>>>>>>
>>>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>> Thanks everyone for the replies.
>>>>>>>>>
>>>>>>>>> It is clear one either needs to write a function or put the unique
>>>>>>>>> entries into another dataframe.
>>>>>>>>>
>>>>>>>>> It seems odd R cannot sort a list of unique column entries with ease.
>>>>>>>>> Python and SQL can do it with ease.
>>>>>>>>
>>>>>>>> I've seen several responses that looked pretty simple.? It's hard to
>>>>>>>> beat sort(unique(x)), though there's a fair bit of confusion about
>>>>>>>> what you actually want.? Maybe you should post an example of the code
>>>>>>>> you'd use in Python?
>>>>>>>>
>>>>>>>> Duncan Murdoch
>>>>>>>>
>>>>>>>>>
>>>>>>>>> QUESTION
>>>>>>>>> Is there a simpler means than other than the unique function to capture
>>>>>>>>> distinct column entries, then sort that list?
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>> Business & Technology
>>>>>>>>> +1 (865) 804-3454
>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>>>> Hello,
>>>>>>>>>>
>>>>>>>>>> Inline.
>>>>>>>>>>
>>>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>>>>>>>>> Thanks.
>>>>>>>>>>>
>>>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>>>
>>>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>>>
>>>>>>>>>> This is not right.
>>>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>>>>>>>>>> extracts the column vector.
>>>>>>>>>>
>>>>>>>>>> As for my previous answer, it was not addressing the question, I
>>>>>>>>>> misinterpreted it as being a question on how to sort by numeric order
>>>>>>>>>> when the data is not numeric. Here is a, hopefully, complete answer.
>>>>>>>>>> Still with package stringr.
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>>>
>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>>>>      ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>>>> })
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Or using Avi's suggestion of writing a function to do all the work and
>>>>>>>>>> simplify the lapply loop later,
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Hope this helps,
>>>>>>>>>>
>>>>>>>>>> Rui Barradas
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>>>> Business & Technology
>>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>>>>> Hi,
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Running a simple syntax set to review entries in dataframe columns.
>>>>>>>>>>>> Here is the working code.
>>>>>>>>>>>>
>>>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>>>> describe(Data)
>>>>>>>>>>>> summary(Data)
>>>>>>>>>>>> unique(Data[1])
>>>>>>>>>>>> unique(Data[2])
>>>>>>>>>>>> unique(Data[3])
>>>>>>>>>>>> unique(Data[4])
>>>>>>>>>>>>
>>>>>>>>>>>> I would like to add sort the unique entries. The data in the various
>>>>>>>>>>>> columns are not defined as numbers, but also text. I realize 1 and
>>>>>>>>>>>> 10 will not sort properly, as the column is not defined as a number,
>>>>>>>>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>>>>>>>>
>>>>>>>>>>>> QUESTION
>>>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Thanks.
>>>>>>>>>>>
>>>>>>>>>>> ______________________________________________
>>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>>>>>
>>>>>>>>>
>>>>>>>>> ______________________________________________
>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>>
>>
>


From @v|gro@@ @end|ng |rom ver|zon@net  Tue Dec 21 20:17:03 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Tue, 21 Dec 2021 14:17:03 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
Message-ID: <00f201d7f69f$56ae5ea0$040b1be0$@verizon.net>

Stephen,

Languages have their own philosophies and are often focused initially on doing specific things well. Later, they tend to accumulate additional functionality both in the base language and extensions.

I am wondering if you have explained your need precisely enough to get the answers you want. 

SQL and Python have their own ways and both have advantages but also huge deficiencies relative to just base R. 

But there are rules you live with and if you choose day a data.frame to store things in, the columns must all be the same length. The unique members of one data.frame are likely to not be the same number so storing them in a data.frame does not work. They can be stored quite  few other ways, such as a list of lists.

And what is your definition of ease? I can program in Python and SQL and way over a hundred other languages and I know I need to adapt my thinking to the flow of the language and not the other way around. Base R was not designed to be like either SQL or Python. But it can be extended quite a few ways to do just about anything.

What you ran into for example is the fact that some functionality is more selective in what it works on. A data.frame with one column is logically the same as a matrix with one column and as a vector but in reality, they are not the same thing. Yes, they can be converted into each other fairly trivially. Sort() seems to care what you feed it. If you did not worry about efficiency, you could have a version of sort that accepts a wide variety of inputs, converts any it can to some possibly common internal form, then converts the output back into the form it was received in, or uses a command-line option to specify the output format. It is not hard in R to make such a function as it has the primitives needed to examine an arbitrary object and see what dimensions it has for some number of types and so on, and has utilities to do the conversion.

If you want a language that has calculated every possible combination of ways to combine functions and already made tens of thousands available, good luck. What languages (including Python and R) expect is for you to compose such combinations yourself in one of many ways. The annoying discussions here between purists and those wanting to use pre-made packages aside, your question can be handled in many of the ways we already discussed. They include making your own (often very small) function that implements consolidating the many steps into one logical step. It can mean using pipelines like the new "|>" operator recently added to base R or the older versions often used in the tidyverse packages like "%>%".

You want to take a data.frame and select a column at a time and ask for it to be made into unique values then ordered and shown. So you want a VECTOR and your initial use of the "[" operator does not take the underlying list structure of a data.frame apart the way you might have thought but as a narrow data.frame. So you MAY need to either extract it using "[[" or use various routines R supplies like unlist() or as.vector().

Here is a pipeline using this as my data:

mydf <- data.frame(ints=c(5,4,3,3,4,5), chars=c("z","i","t","s","t","i"))

Note the number of unique items differs s does the data type:

  mydf
  ints chars
  1    5     z
  2    4     i
  3    3     t
  4    3     s
  5    4     t
  6    5     i

To handle the columns one at a time can be done using a pipeline like:

  > mydf[2] |> unlist() |> unique() |> sort()
  [1] "i" "s" "t" "z"
  > mydf[1] |> unlist() |> unique() |> sort()
  [1] 3 4 5

The above takes a two-column data.frame and restricts it into a one-column data.frame and then passes the new temporary variable/object into the command line of the unlist() function which returns an object (again temporary) which is a  vector (in one case numeric and in the other character) and then that result is passed into the command line of unique() which returns a shorter vector in the same order and then you pass it on to sort() which reorders it. 

Note the first steps can be shortened if using the "[[" notation or by using the named way of asking for a column:

  > mydf[[1]] |> unique() |> sort()
  [1] 3 4 5
  > mydf$ints |> unique() |> sort()
  [1] 3 4 5

But pipelines are simply syntactic sugar mostly so you also can just nest function calls as in sort(unique(unlist(mydf[1]))) or do what I showed earlier of creating a function that does the work invisibly and call that.

Python often does their own version of pipelines by adding a dot at the end and calling a method and if needed another dot and then calling a method on the resulting object and so on. But that is arguably more limiting in some ways and more powerful in others. Different paradigms. In R, you do not do object.method1.method2(args).method3(args) so a pieline method is used to sort of so something related.

Now if your need was to do your operation on an entire data.frame at once, then sometimes you will find a way to do it easily and sometimes use things like functional programming techniques. It is so common to calculate the sums or means of columns in a data.frame (or matrix) that functions like rowSums() and colSums() and colMeans() are available in R. But they also allow fairly arbitrary things to be done too as in the lapply() family of functions that applies an arbitrary function perhaps including arguments, like:

lapply(mydf, max)

sapply(mydf, `[`, 2)

The latter takes the second value in each and every column of the data.frame and when possible, consolidates the results. Of course the uniqueness criterion when producing uneven numbers of results, does not simplify. Below I show how you can do many things including nested methods:


  > lapply(mydf, sort)
  $ints
  [1] 3 3 4 4 5 5
  
  $chars
  [1] "i" "i" "s" "t" "t" "z"
  
  > lapply(lapply(mydf, sort), unique)
  $ints
  [1] 3 4 5
  
  $chars
  [1] "i" "s" "t" "z"
  
  > lapply(lapply(mydf, unique), sort)
  $ints
  [1] 3 4 5
  
  $chars
  [1] "i" "s" "t" "z"

  > lapply(lapply(lapply(mydf, unique), sort), toupper)
  $ints
  [1] "3" "4" "5"
  
  $chars
  [1] "I" "S" "T" "Z"

R has plenty of other such primitives that allow you to compose things many ways including other variants like Filter and Reduce and pmap and so on, with way more in various packages.

It is simply wrong to insist that a language you are not very familiar with is not able to (often fairly easily) do all kinds of things. 

Back to your question, if I may, I think one of my earlier posts on this topic suggested another. Use factors which are part of base-R to perform the unique() for you and then extract the unique levels and re-order them by sorting.

  > sort(levels(factor(mydf[[1]])))
  [1] "3" "4" "5"
  > sort(levels(factor(mydf[[2]])))
  [1] "i" "s" "t" "z"

But note this converts everything to characters so a numeric may need to be converted back, and yes, the sorting is not done numerically.

Generally, there are oodles of ways to do anything. If this were Python, you might create an object that maintains a sorted set for example but that just hides the complexity as the various methods of the underlying object have to carefully deal keeping track of the current order and dealing with how things are added into the right place or tightening up the data structure if something is removed all the time. Others simply supply a sorted() method to use only when you actually need that. R can be done in similar ways and you can create objects of quite a few kinds to implement some things but it does not often seem necessary, at least to me.

I can imagine writing a function that makes a data.frame even from vectors of unequal length by calculating the length of the longest vector and then setting each shorter vector to be longer with code like:

length(a) <- longest

You can then patch together all the results into a data.frame with trailing NA values on some columns.

I quickly cobbled together a few lines that can do that and can be placed inside a function to return this:

  lapply(lapply(lapply(mydf, unique), sort), toupper) -> uneven
  longest <- max(unlist(lapply(uneven, length)))
  answer <- data.frame(lapply(uneven, `length<-`, longest))
  print(answer)

  ints chars
1    3     I
2    4     S
3    5     T
4 <NA>     Z

Now this has a single NA but I suggest generalizes well to a more complex example:

   ints lower upper
1    10     k     Z
2     9     j     A
3     8     i     Z
4     7     h     A
5     6     g     Z
6     5     f     A
7     4     h     Z
8     3     i     A
9     2     j     Z
10    1     k     A
11    2     l     Z
12    3     m     A

These are uneven and three columns so I tried a function version:

  mydf2 <- data.frame(ints = c(10:1, 2:3),
                      lower = c(letters[11:6], letters[8:13]),
                      upper = rep(c("Z", "A"), 6))
  
  unisortuneven <- function(anydf) {
    uneven <- lapply(lapply(lapply(anydf, unique), sort), toupper)
    longest <- max(unlist(lapply(uneven, length)))
    data.frame(lapply(uneven, `length<-`, longest))
  }
  
  unisortuneven(mydf2)
  ints lower upper
  1     1     F     A
  2     2     G     Z
  3     3     H  <NA>
    4     4     I  <NA>
    5     5     J  <NA>
    6     6     K  <NA>
    7     7     L  <NA>
    8     8     M  <NA>
    9     9  <NA>  <NA>
    10   10  <NA>  <NA>
    
    The above does not format great for text, sadly, so is better shown as the transpose for display purposes:

  > t(unisortuneven(mydf2))
  [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
  ints  "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" 
  lower "F"  "G"  "H"  "I"  "J"  "K"  "L"  "M"  NA   NA   
  upper "A"  "Z"  NA   NA   NA   NA   NA   NA   NA   NA

But hopefully it makes my point that a little thinking and KNOWING about features of R like how to use a functionalized version of length() that sets a changed value using the odd notation of `length<-` can let you solve all kinds of problems in a somewhat abstract manner. Of course the above function is not refined and will not handle some useful transformations or deal with errors. That can make it quite a bit harder and in some cases, make it a good idea to find someone sharing a package where they did the hard work and documented exactly what their function does.

I am eclectic and happy to switch tools at a moment's notice if they offer an interesting way to do something. But, within a language, I learn the darn rules and also the idioms often used and then choose from among many ways I can see to solve something and use what is available.  You had a trivial solution available to you to simply do one step at a time and save intermediate values, transforming at times. Some of us have sent you more general solutions. Do you still think what you want is so much harder to do in R, or that perhaps you are not thinking in R and thus want it to do it some other way other languages do?





-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson, DSL via R-help
Sent: Tuesday, December 21, 2021 10:16 AM
To: Rui Barradas <ruipbarradas at sapo.pt>; Stephen H. Dawson, DSL via R-help <r-help at r-project.org>
Subject: Re: [R] Adding SORT to UNIQUE

Thanks everyone for the replies.

It is clear one either needs to write a function or put the unique entries into another dataframe.

It seems odd R cannot sort a list of unique column entries with ease. 
Python and SQL can do it with ease.

QUESTION
Is there a simpler means than other than the unique function to capture distinct column entries, then sort that list?


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/20/21 5:53 PM, Rui Barradas wrote:
> Hello,
>
> Inline.
>
> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>> Thanks.
>>
>> sort(unique(Data[[1]]))
>>
>> This syntax provides row numbers, not column values.
>
> This is not right.
> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]] 
> extracts the column vector.
>
> As for my previous answer, it was not addressing the question, I 
> misinterpreted it as being a question on how to sort by numeric order 
> when the data is not numeric. Here is a, hopefully, complete answer.
> Still with package stringr.
>
>
> cols_to_sort <- 1:4
>
> Data2 <- lapply(Data[cols_to_sort], \(x){
>   stringr::str_sort(unique(x), numeric = TRUE)
> })
>
>
> Or using Avi's suggestion of writing a function to do all the work and 
> simplify the lapply loop later,
>
>
> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>
>
> Hope this helps,
>
> Rui Barradas
>
>
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>> Hi,
>>>
>>>
>>> Running a simple syntax set to review entries in dataframe columns. 
>>> Here is the working code.
>>>
>>> Data <- read.csv("./input/Source.csv", header=T)
>>> describe(Data)
>>> summary(Data)
>>> unique(Data[1])
>>> unique(Data[2])
>>> unique(Data[3])
>>> unique(Data[4])
>>>
>>> I would like to add sort the unique entries. The data in the various 
>>> columns are not defined as numbers, but also text. I realize 1 and 
>>> 10 will not sort properly, as the column is not defined as a number, 
>>> but want to see what I have in the columns viewed as sorted.
>>>
>>> QUESTION
>>> What is the best process to sort unique output, please?
>>>
>>>
>>> Thanks.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From @v|gro@@ @end|ng |rom ver|zon@net  Tue Dec 21 20:28:29 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Tue, 21 Dec 2021 14:28:29 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <eeb26e85-3951-1d54-3eaa-aea5bfb7d9da@gmail.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <28FF2409-1FD1-452A-AC4E-A3EF46E37D32@dcn.davis.ca.us>
 <eeb26e85-3951-1d54-3eaa-aea5bfb7d9da@gmail.com>
Message-ID: <00f801d7f6a0$ef16d450$cd447cf0$@verizon.net>

Duncan,

Let's not go there discussing the trouble with tibbles when the topic asked how to do things in more native R.

The reality is that tibbles when used in the tidyverse often use somewhat different ways to select what columns you want including some very quite sophisticated ones like:

select(mydf, wed:fri, ends_with(".xyz), everything())

So it is often not really used to select columns by number but you can do that too. What you re talking about is using [] notation which is often not needed as you use verbs like filter and select independently.

I find it often way more intuitive to solve things the dplyr way but I agree you sometimes want to convert tibbles back to data.frames before using base R techniques on them.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Duncan Murdoch
Sent: Tuesday, December 21, 2021 12:03 PM
To: Jeff Newmiller <jdnewmil at dcn.davis.ca.us>; r-help at r-project.org; service at shdawson.com; Rui Barradas <ruipbarradas at sapo.pt>
Subject: Re: [R] Adding SORT to UNIQUE

On 21/12/2021 11:59 a.m., Jeff Newmiller wrote:
> Intuitive, perhaps, but noticably slower. And it doesn't work on tibbles by design. Data frames are lists of columns.

That's just one of the design flaws in tibbles, but not the worst one.

Duncan Murdoch

> 
> On December 21, 2021 8:38:35 AM PST, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>> Thanks for the reply.
>>>>
>>>> sort(unique(Data[1]))
>>>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
>>>> decreasing)) :
>>>>       undefined columns selected
>>>
>>> That's the wrong syntax:  Data[1] is not "column one of Data".  Use 
>>> Data[[1]] for that, so
>>>
>>>      sort(unique(Data[[1]]))
>>
>> Actually, I'd probably recommend
>>
>>    sort(unique(Data[, 1]))
>>
>> instead.  This treats Data as a matrix rather than as a list.
>> Dataframes are lists that look like matrices, but to me the matrix 
>> aspect is usually more intuitive.
>>
>> Duncan Murdoch
>>
>>>
>>> I think Rui already pointed out the typo in the quoted text below...
>>>
>>> Duncan Murdoch
>>>
>>>>
>>>> The recommended syntax did not work, as listed above.
>>>>
>>>> What I want is the sort of distinct column output. Again, the 
>>>> column may be text or numbers. This is a huge analysis effort with 
>>>> data coming at me from many different sources.
>>>>
>>>>
>>>> *Stephen Dawson, DSL*
>>>> /Executive Strategy Consultant/
>>>> Business & Technology
>>>> +1 (865) 804-3454
>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>
>>>>
>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>>>>> Thanks everyone for the replies.
>>>>>>
>>>>>> It is clear one either needs to write a function or put the 
>>>>>> unique entries into another dataframe.
>>>>>>
>>>>>> It seems odd R cannot sort a list of unique column entries with ease.
>>>>>> Python and SQL can do it with ease.
>>>>>
>>>>> I've seen several responses that looked pretty simple.  It's hard 
>>>>> to beat sort(unique(x)), though there's a fair bit of confusion 
>>>>> about what you actually want.  Maybe you should post an example of 
>>>>> the code you'd use in Python?
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>>
>>>>>> QUESTION
>>>>>> Is there a simpler means than other than the unique function to 
>>>>>> capture distinct column entries, then sort that list?
>>>>>>
>>>>>>
>>>>>> *Stephen Dawson, DSL*
>>>>>> /Executive Strategy Consultant/
>>>>>> Business & Technology
>>>>>> +1 (865) 804-3454
>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>
>>>>>>
>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>> Hello,
>>>>>>>
>>>>>>> Inline.
>>>>>>>
>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>>>>>> Thanks.
>>>>>>>>
>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>
>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>
>>>>>>> This is not right.
>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax 
>>>>>>> Data[[1]] extracts the column vector.
>>>>>>>
>>>>>>> As for my previous answer, it was not addressing the question, I 
>>>>>>> misinterpreted it as being a question on how to sort by numeric 
>>>>>>> order when the data is not numeric. Here is a, hopefully, complete answer.
>>>>>>> Still with package stringr.
>>>>>>>
>>>>>>>
>>>>>>> cols_to_sort <- 1:4
>>>>>>>
>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>       stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>> })
>>>>>>>
>>>>>>>
>>>>>>> Or using Avi's suggestion of writing a function to do all the 
>>>>>>> work and simplify the lapply loop later,
>>>>>>>
>>>>>>>
>>>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), 
>>>>>>> ...)
>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>
>>>>>>>
>>>>>>> Hope this helps,
>>>>>>>
>>>>>>> Rui Barradas
>>>>>>>
>>>>>>>
>>>>>>>>
>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>> /Executive Strategy Consultant/ Business & Technology
>>>>>>>> +1 (865) 804-3454
>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>
>>>>>>>>
>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>> Hi,
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Running a simple syntax set to review entries in dataframe columns.
>>>>>>>>> Here is the working code.
>>>>>>>>>
>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>> describe(Data)
>>>>>>>>> summary(Data)
>>>>>>>>> unique(Data[1])
>>>>>>>>> unique(Data[2])
>>>>>>>>> unique(Data[3])
>>>>>>>>> unique(Data[4])
>>>>>>>>>
>>>>>>>>> I would like to add sort the unique entries. The data in the 
>>>>>>>>> various columns are not defined as numbers, but also text. I 
>>>>>>>>> realize 1 and
>>>>>>>>> 10 will not sort properly, as the column is not defined as a 
>>>>>>>>> number, but want to see what I have in the columns viewed as sorted.
>>>>>>>>>
>>>>>>>>> QUESTION
>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Thanks.
>>>>>>>>
>>>>>>>> ______________________________________________
>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, 
>>>>>>>> see https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>> PLEASE do read the posting guide 
>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>>
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>> PLEASE do read the posting guide
>>>>>> http://www.R-project.org/posting-guide.html
>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>
>>>>>
>>>>
>>>>
>>>
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From j|ox @end|ng |rom mcm@@ter@c@  Tue Dec 21 20:44:42 2021
From: j|ox @end|ng |rom mcm@@ter@c@ (Fox, John)
Date: Tue, 21 Dec 2021 19:44:42 +0000
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <7059_1640109844_1BLI421c004109_437721B4-E452-4401-AFF5-AA59783300F1@dcn.davis.ca.us>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <18709_1640105982_1BLGxdaM021134_28FF2409-1FD1-452A-AC4E-A3EF46E37D32@dcn.davis.ca.us>
 <F74A436D-C417-4ABE-80DE-F08393606837@mcmaster.ca>
 <7059_1640109844_1BLI421c004109_437721B4-E452-4401-AFF5-AA59783300F1@dcn.davis.ca.us>
Message-ID: <E7F2EB5E-4B89-4E9E-9FC0-BF7508BCCEE4@mcmaster.ca>

Dear Jeff,

I haven't investigated your claim systematically, but out of curiosity, I did try extending my previous example, admittedly arbitrarily. In doing so, I assumed that you intended col in the first case to be the column subscript, not the row subscript. Here's what I got (on a newish M1 MacBook Pro):

> system.time(
+   for ( col in colnames( D ) ) {
+     idx <- sample(1e6, 1000)
+     D[ idx, col ] <- idx
+   }
+ )
   user  system elapsed 
  0.913   6.545  43.737 

> system.time(
+   for ( col in colnames( D ) ) {
+     idx <- sample(1e6, 1000)
+     D[[ col ]][ idx ] <- idx
+   }
+ )
   user  system elapsed 
  0.876   6.828  52.033

Best,
 John

?On 2021-12-21, 1:04 PM, "R-help on behalf of Jeff Newmiller" <r-help-bounces at r-project.org on behalf of jdnewmil at dcn.davis.ca.us> wrote:

    When your brain is wired to treat a data frame like a matrix, then you think things like

    for ( col in colnames( col ) ) {
      idx <- expr
      D[ col, idx ] <- otherexpr
    }

    are reasonable, when

    for ( col in colnames( col ) ) {
      idx <- expr
      D[[ col ]][ idx ] <- otherexpr
    }

    does actually run significantly faster.


    On December 21, 2021 9:28:52 AM PST, "Fox, John" <jfox at mcmaster.ca> wrote:
    >Dear Jeff,
    >
    >On 2021-12-21, 11:59 AM, "R-help on behalf of Jeff Newmiller" <r-help-bounces at r-project.org on behalf of jdnewmil at dcn.davis.ca.us> wrote:
    >
    >    Intuitive, perhaps, but noticably slower. 
    >
    >I think that in most applications, one wouldn't notice the difference; for example:
    >
    >> D <- data.frame(matrix(rnorm(1000*1e6), 1e6, 1000))
    >
    >> microbenchmark(D[, 1])
    >Unit: microseconds
    >   expr   min    lq    mean median     uq    max neval
    > D[, 1] 3.321 3.362 3.98561  3.444 3.5875 51.291   100
    >
    >> microbenchmark(D[[1]])
    >Unit: microseconds
    >   expr   min    lq    mean median     uq    max neval
    > D[[1]] 1.722 1.763 1.99137  1.804 1.8655 17.876   100
    >
    >Best,
    > John
    >
    >
    >    And it doesn't work on tibbles by design. Data frames are lists of columns.
    >
    >
    >    On December 21, 2021 8:38:35 AM PST, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
    >    >On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
    >    >> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
    >    >>> Thanks for the reply.
    >    >>>
    >    >>> sort(unique(Data[1]))
    >    >>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
    >    >>> decreasing)) :
    >    >>>      undefined columns selected
    >    >> 
    >    >> That's the wrong syntax:  Data[1] is not "column one of Data".  Use
    >    >> Data[[1]] for that, so
    >    >> 
    >    >>     sort(unique(Data[[1]]))
    >    >
    >    >Actually, I'd probably recommend
    >    >
    >    >   sort(unique(Data[, 1]))
    >    >
    >    >instead.  This treats Data as a matrix rather than as a list. 
    >    >Dataframes are lists that look like matrices, but to me the matrix 
    >    >aspect is usually more intuitive.
    >    >
    >    >Duncan Murdoch
    >    >
    >    >> 
    >    >> I think Rui already pointed out the typo in the quoted text below...
    >    >> 
    >    >> Duncan Murdoch
    >    >> 
    >    >>>
    >    >>> The recommended syntax did not work, as listed above.
    >    >>>
    >    >>> What I want is the sort of distinct column output. Again, the column may
    >    >>> be text or numbers. This is a huge analysis effort with data coming at
    >    >>> me from many different sources.
    >    >>>
    >    >>>
    >    >>> *Stephen Dawson, DSL*
    >    >>> /Executive Strategy Consultant/
    >    >>> Business & Technology
    >    >>> +1 (865) 804-3454
    >    >>> http://www.shdawson.com <http://www.shdawson.com>
    >    >>>
    >    >>>
    >    >>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
    >    >>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
    >    >>>>> Thanks everyone for the replies.
    >    >>>>>
    >    >>>>> It is clear one either needs to write a function or put the unique
    >    >>>>> entries into another dataframe.
    >    >>>>>
    >    >>>>> It seems odd R cannot sort a list of unique column entries with ease.
    >    >>>>> Python and SQL can do it with ease.
    >    >>>>
    >    >>>> I've seen several responses that looked pretty simple.  It's hard to
    >    >>>> beat sort(unique(x)), though there's a fair bit of confusion about
    >    >>>> what you actually want.  Maybe you should post an example of the code
    >    >>>> you'd use in Python?
    >    >>>>
    >    >>>> Duncan Murdoch
    >    >>>>
    >    >>>>>
    >    >>>>> QUESTION
    >    >>>>> Is there a simpler means than other than the unique function to capture
    >    >>>>> distinct column entries, then sort that list?
    >    >>>>>
    >    >>>>>
    >    >>>>> *Stephen Dawson, DSL*
    >    >>>>> /Executive Strategy Consultant/
    >    >>>>> Business & Technology
    >    >>>>> +1 (865) 804-3454
    >    >>>>> http://www.shdawson.com <http://www.shdawson.com>
    >    >>>>>
    >    >>>>>
    >    >>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
    >    >>>>>> Hello,
    >    >>>>>>
    >    >>>>>> Inline.
    >    >>>>>>
    >    >>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
    >    >>>>>>> Thanks.
    >    >>>>>>>
    >    >>>>>>> sort(unique(Data[[1]]))
    >    >>>>>>>
    >    >>>>>>> This syntax provides row numbers, not column values.
    >    >>>>>>
    >    >>>>>> This is not right.
    >    >>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
    >    >>>>>> extracts the column vector.
    >    >>>>>>
    >    >>>>>> As for my previous answer, it was not addressing the question, I
    >    >>>>>> misinterpreted it as being a question on how to sort by numeric order
    >    >>>>>> when the data is not numeric. Here is a, hopefully, complete answer.
    >    >>>>>> Still with package stringr.
    >    >>>>>>
    >    >>>>>>
    >    >>>>>> cols_to_sort <- 1:4
    >    >>>>>>
    >    >>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
    >    >>>>>>      stringr::str_sort(unique(x), numeric = TRUE)
    >    >>>>>> })
    >    >>>>>>
    >    >>>>>>
    >    >>>>>> Or using Avi's suggestion of writing a function to do all the work and
    >    >>>>>> simplify the lapply loop later,
    >    >>>>>>
    >    >>>>>>
    >    >>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
    >    >>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
    >    >>>>>>
    >    >>>>>>
    >    >>>>>> Hope this helps,
    >    >>>>>>
    >    >>>>>> Rui Barradas
    >    >>>>>>
    >    >>>>>>
    >    >>>>>>>
    >    >>>>>>> *Stephen Dawson, DSL*
    >    >>>>>>> /Executive Strategy Consultant/
    >    >>>>>>> Business & Technology
    >    >>>>>>> +1 (865) 804-3454
    >    >>>>>>> http://www.shdawson.com <http://www.shdawson.com>
    >    >>>>>>>
    >    >>>>>>>
    >    >>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
    >    >>>>>>>> Hi,
    >    >>>>>>>>
    >    >>>>>>>>
    >    >>>>>>>> Running a simple syntax set to review entries in dataframe columns.
    >    >>>>>>>> Here is the working code.
    >    >>>>>>>>
    >    >>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
    >    >>>>>>>> describe(Data)
    >    >>>>>>>> summary(Data)
    >    >>>>>>>> unique(Data[1])
    >    >>>>>>>> unique(Data[2])
    >    >>>>>>>> unique(Data[3])
    >    >>>>>>>> unique(Data[4])
    >    >>>>>>>>
    >    >>>>>>>> I would like to add sort the unique entries. The data in the various
    >    >>>>>>>> columns are not defined as numbers, but also text. I realize 1 and
    >    >>>>>>>> 10 will not sort properly, as the column is not defined as a number,
    >    >>>>>>>> but want to see what I have in the columns viewed as sorted.
    >    >>>>>>>>
    >    >>>>>>>> QUESTION
    >    >>>>>>>> What is the best process to sort unique output, please?
    >    >>>>>>>>
    >    >>>>>>>>
    >    >>>>>>>> Thanks.
    >    >>>>>>>
    >    >>>>>>> ______________________________________________
    >    >>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
    >    >>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
    >    >>>>>>> PLEASE do read the posting guide
    >    >>>>>>> http://www.R-project.org/posting-guide.html
    >    >>>>>>> and provide commented, minimal, self-contained, reproducible code.
    >    >>>>>>
    >    >>>>>
    >    >>>>> ______________________________________________
    >    >>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
    >    >>>>> https://stat.ethz.ch/mailman/listinfo/r-help
    >    >>>>> PLEASE do read the posting guide
    >    >>>>> http://www.R-project.org/posting-guide.html
    >    >>>>> and provide commented, minimal, self-contained, reproducible code.
    >    >>>>
    >    >>>>
    >    >>>
    >    >>>
    >    >>
    >    >
    >    >______________________________________________
    >    >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
    >    >https://stat.ethz.ch/mailman/listinfo/r-help
    >    >PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
    >    >and provide commented, minimal, self-contained, reproducible code.
    >
    >    -- 
    >    Sent from my phone. Please excuse my brevity.
    >
    >    ______________________________________________
    >    R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
    >    https://stat.ethz.ch/mailman/listinfo/r-help
    >    PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
    >    and provide commented, minimal, self-contained, reproducible code.
    >

    -- 
    Sent from my phone. Please excuse my brevity.

    ______________________________________________
    R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
    https://stat.ethz.ch/mailman/listinfo/r-help
    PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
    and provide commented, minimal, self-contained, reproducible code.


From @v|gro@@ @end|ng |rom ver|zon@net  Tue Dec 21 20:45:44 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Tue, 21 Dec 2021 14:45:44 -0500
Subject: [R] Creating NA equivalent
In-Reply-To: <7ef1e12e-9024-8dba-0f68-567db68cb803@gmail.com>
References: <977561d4-86af-69a7-de39-f53a0e2dfd92.ref@yahoo.fr>
 <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
 <7ef1e12e-9024-8dba-0f68-567db68cb803@gmail.com>
Message-ID: <010c01d7f6a3$57fe6170$07fb2450$@verizon.net>

I wonder if the package Adrian Du?a created might be helpful or point you along the way.

It was eventually named "declared" 

https://cran.r-project.org/web/packages/declared/index.html

With a vignette here:

https://cran.r-project.org/web/packages/declared/vignettes/declared.pdf

I do not know if it would easily satisfy your needs but it may be a step along the way. A package called Haven was part of the motivation and Adrian wanted a way to import data from external sources that had more than one category of NA that sounds a bit like what you want. His functions should allow the creation of such data within R, as well. I am including him in this email if you want to contact him or he has something to say.


-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Duncan Murdoch
Sent: Tuesday, December 21, 2021 5:26 AM
To: Marc Girondot <marc_grt at yahoo.fr>; r-help at r-project.org
Subject: Re: [R] Creating NA equivalent

On 20/12/2021 11:41 p.m., Marc Girondot via R-help wrote:
> Dear members,
> 
> I work about dosage and some values are bellow the detection limit. I 
> would like create new "numbers" like LDL (to represent lower than 
> detection limit) and UDL (upper the detection limit) that behave like 
> NA, with the possibility to test them using for example is.LDL() or 
> is.UDL().
> 
> Note that NA is not the same than LDL or UDL: NA represent missing data.
> Here the data is available as LDL or UDL.
> 
> NA is built in R language very deep... any option to create new 
> version of NA-equivalent ?
> 

There was a discussion of this back in May.  Here's a link to one approach that I suggested:

   https://stat.ethz.ch/pipermail/r-devel/2021-May/080776.html

Read the followup messages, I made at least one suggested improvement. 
I don't know if anyone has packaged this, but there's a later version of the code here:

   https://stackoverflow.com/a/69179441/2554330

Duncan Murdoch

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Tue Dec 21 21:37:31 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Tue, 21 Dec 2021 12:37:31 -0800
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <c5aba36c-bc57-a99f-db51-fc32dd9999d7@gmail.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <28FF2409-1FD1-452A-AC4E-A3EF46E37D32@dcn.davis.ca.us>
 <eeb26e85-3951-1d54-3eaa-aea5bfb7d9da@gmail.com>
 <5272710A-22AC-4878-9493-C8A846C0CC5D@dcn.davis.ca.us>
 <714a3816-9e70-644d-70f1-73d0d4914e8f@gmail.com>
 <c5aba36c-bc57-a99f-db51-fc32dd9999d7@gmail.com>
Message-ID: <7DDFC541-20EB-4B27-BFED-014A1CBCD2EC@dcn.davis.ca.us>

It is not about outlawing matrix notation... to the contrary, it is about consistency. For tibbles, [] always returns another tibble. If you wanted a column vector, you should have asked for a column vector. Does the fact that DF[ 1, ] yields a different type than DF[ , 1 ] and DF[ 1:2, ] satisfy your desire to "support" matrix notation? Matlab has no concept of vectors distinct from row or column matrices, but R tries too hard to blur the lines between vectors and matrix-like objects.  The "drop" argument was a mistaken hack in defense of this failure to live with the difference between vectors and matrix-like objects and data frames.

On December 21, 2021 10:09:14 AM PST, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>On 21/12/2021 12:53 p.m., Duncan Murdoch wrote:
>> On 21/12/2021 12:29 p.m., Jeff Newmiller wrote:
>>> It is a very rational choice, not a design flaw. I don't like every choice they have made for that class, but this one is very solid, and treating data frames as lists of columns consistently helps all of us.
>> I think outlawing matrix notation is a really bad idea.  It makes code
>> harder to read, and makes it much harder to switch to matrices, which
>> sometimes gives a huge speed boost to code.
>> 
>> For example, John Fox posted an example that showed that operations on
>> whole columns of dataframes is about twice as fast using list notation
>> as using matrix notation.  But for operating on whole rows, 
>
>... or on individual elements ...
>
> > matrices are
>> about 100 times faster than dataframes.  You shouldn't use notation that
>> makes the switch to matrices more difficult.
>> 
>> Duncan Murdoch
>> 
>>>
>>> On December 21, 2021 9:02:56 AM PST, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>> On 21/12/2021 11:59 a.m., Jeff Newmiller wrote:
>>>>> Intuitive, perhaps, but noticably slower. And it doesn't work on tibbles by design. Data frames are lists of columns.
>>>>
>>>> That's just one of the design flaws in tibbles, but not the worst one.
>>>>
>>>> Duncan Murdoch
>>>>
>>>>>
>>>>> On December 21, 2021 8:38:35 AM PST, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>>>> Thanks for the reply.
>>>>>>>>
>>>>>>>> sort(unique(Data[1]))
>>>>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
>>>>>>>> decreasing)) :
>>>>>>>>       ? undefined columns selected
>>>>>>>
>>>>>>> That's the wrong syntax:  Data[1] is not "column one of Data".  Use
>>>>>>> Data[[1]] for that, so
>>>>>>>
>>>>>>>        sort(unique(Data[[1]]))
>>>>>>
>>>>>> Actually, I'd probably recommend
>>>>>>
>>>>>>      sort(unique(Data[, 1]))
>>>>>>
>>>>>> instead.  This treats Data as a matrix rather than as a list.
>>>>>> Dataframes are lists that look like matrices, but to me the matrix
>>>>>> aspect is usually more intuitive.
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>>
>>>>>>> I think Rui already pointed out the typo in the quoted text below...
>>>>>>>
>>>>>>> Duncan Murdoch
>>>>>>>
>>>>>>>>
>>>>>>>> The recommended syntax did not work, as listed above.
>>>>>>>>
>>>>>>>> What I want is the sort of distinct column output. Again, the column may
>>>>>>>> be text or numbers. This is a huge analysis effort with data coming at
>>>>>>>> me from many different sources.
>>>>>>>>
>>>>>>>>
>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>> /Executive Strategy Consultant/
>>>>>>>> Business & Technology
>>>>>>>> +1 (865) 804-3454
>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>
>>>>>>>>
>>>>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>>> Thanks everyone for the replies.
>>>>>>>>>>
>>>>>>>>>> It is clear one either needs to write a function or put the unique
>>>>>>>>>> entries into another dataframe.
>>>>>>>>>>
>>>>>>>>>> It seems odd R cannot sort a list of unique column entries with ease.
>>>>>>>>>> Python and SQL can do it with ease.
>>>>>>>>>
>>>>>>>>> I've seen several responses that looked pretty simple.? It's hard to
>>>>>>>>> beat sort(unique(x)), though there's a fair bit of confusion about
>>>>>>>>> what you actually want.? Maybe you should post an example of the code
>>>>>>>>> you'd use in Python?
>>>>>>>>>
>>>>>>>>> Duncan Murdoch
>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> QUESTION
>>>>>>>>>> Is there a simpler means than other than the unique function to capture
>>>>>>>>>> distinct column entries, then sort that list?
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>>> Business & Technology
>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>>>>> Hello,
>>>>>>>>>>>
>>>>>>>>>>> Inline.
>>>>>>>>>>>
>>>>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>>>>>>>>>> Thanks.
>>>>>>>>>>>>
>>>>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>>>>
>>>>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>>>>
>>>>>>>>>>> This is not right.
>>>>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>>>>>>>>>>> extracts the column vector.
>>>>>>>>>>>
>>>>>>>>>>> As for my previous answer, it was not addressing the question, I
>>>>>>>>>>> misinterpreted it as being a question on how to sort by numeric order
>>>>>>>>>>> when the data is not numeric. Here is a, hopefully, complete answer.
>>>>>>>>>>> Still with package stringr.
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>>>>
>>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>>>>>      ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>>>>> })
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Or using Avi's suggestion of writing a function to do all the work and
>>>>>>>>>>> simplify the lapply loop later,
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Hope this helps,
>>>>>>>>>>>
>>>>>>>>>>> Rui Barradas
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>>>>> Business & Technology
>>>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>>>>>> Hi,
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Running a simple syntax set to review entries in dataframe columns.
>>>>>>>>>>>>> Here is the working code.
>>>>>>>>>>>>>
>>>>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>>>>> describe(Data)
>>>>>>>>>>>>> summary(Data)
>>>>>>>>>>>>> unique(Data[1])
>>>>>>>>>>>>> unique(Data[2])
>>>>>>>>>>>>> unique(Data[3])
>>>>>>>>>>>>> unique(Data[4])
>>>>>>>>>>>>>
>>>>>>>>>>>>> I would like to add sort the unique entries. The data in the various
>>>>>>>>>>>>> columns are not defined as numbers, but also text. I realize 1 and
>>>>>>>>>>>>> 10 will not sort properly, as the column is not defined as a number,
>>>>>>>>>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>>>>>>>>>
>>>>>>>>>>>>> QUESTION
>>>>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Thanks.
>>>>>>>>>>>>
>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> ______________________________________________
>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>
>>>>
>>>
>> 
>

-- 
Sent from my phone. Please excuse my brevity.


From bgunter@4567 @end|ng |rom gm@||@com  Tue Dec 21 21:38:08 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 21 Dec 2021 12:38:08 -0800
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
Message-ID: <CAGxFJbQSYv6ExzmjgNVy2LABEmeESCiZCM3R93iO3tF5L1Eing@mail.gmail.com>

Stephen:
You seem confused about data frames. sort(unique(...)) has no problem
sorting individual columns in a data frame (mod the issues about
mixing numerics and non-numerics that have already been discussed).
But the problem is that the results can *not* be put back in a data
frame because, **by definition** all columns in a data frame **must**
have the same number of values. unique() will change the number of
values in a column if done column by column, e.g. via lapply() or
looping over columns. Consequently, if you do this by lapply(), you'll
get a list back, not a data frame. e.g.

> dat <- data.frame(a = rep(3:1,2), b = c(5:1,5))
> dat
  a b
1 3 5
2 2 4
3 1 3
4 3 2
5 2 1
6 1 5
>
> ## via lapply
> dat <- lapply(dat, \(x)sort(unique(x)))
> dat  ## a list.
$a
[1] 1 2 3

$b
[1] 1 2 3 4 5

> ## Trying to do this with an explicit loop results in an error
> dat <- data.frame(a = rep(1:3,2), b = c(1:5,5))
> for(nm in names(dat))dat[[nm]] <- sort(unique(dat[[nm]])) ## error
Error in `[[<-.data.frame`(`*tmp*`, nm, value = c(1, 2, 3, 4, 5)) :
  replacement has 5 rows, data has 6

OTOH, unique() has a data.frame method which will give unique *rows*
(thinking of a data frame as a matrix-like object with a "dim"
attribute):

> dat <- data.frame(a = c(1,2,1), b = c('a','b','a'))
> dat
  a b
1 1 a
2 2 b
3 1 a
> unique(dat)
  a b
1 1 a
2 2 b

There is no sort() method for data frames as this has no obvious
single interpretation of sorting by whole rows. However, see ?sort for
an example using ?order to carry out one possible interpretation of
sorting by rows.

Bert


On Tue, Dec 21, 2021 at 7:16 AM Stephen H. Dawson, DSL via R-help
<r-help at r-project.org> wrote:
>
> Thanks everyone for the replies.
>
> It is clear one either needs to write a function or put the unique
> entries into another dataframe.
>
> It seems odd R cannot sort a list of unique column entries with ease.
> Python and SQL can do it with ease.
>
> QUESTION
> Is there a simpler means than other than the unique function to capture
> distinct column entries, then sort that list?
>
>
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
>
> On 12/20/21 5:53 PM, Rui Barradas wrote:
> > Hello,
> >
> > Inline.
> >
> > ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
> >> Thanks.
> >>
> >> sort(unique(Data[[1]]))
> >>
> >> This syntax provides row numbers, not column values.
> >
> > This is not right.
> > The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
> > extracts the column vector.
> >
> > As for my previous answer, it was not addressing the question, I
> > misinterpreted it as being a question on how to sort by numeric order
> > when the data is not numeric. Here is a, hopefully, complete answer.
> > Still with package stringr.
> >
> >
> > cols_to_sort <- 1:4
> >
> > Data2 <- lapply(Data[cols_to_sort], \(x){
> >   stringr::str_sort(unique(x), numeric = TRUE)
> > })
> >
> >
> > Or using Avi's suggestion of writing a function to do all the work and
> > simplify the lapply loop later,
> >
> >
> > unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
> > Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
> >
> >
> > Hope this helps,
> >
> > Rui Barradas
> >
> >
> >>
> >> *Stephen Dawson, DSL*
> >> /Executive Strategy Consultant/
> >> Business & Technology
> >> +1 (865) 804-3454
> >> http://www.shdawson.com <http://www.shdawson.com>
> >>
> >>
> >> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
> >>> Hi,
> >>>
> >>>
> >>> Running a simple syntax set to review entries in dataframe columns.
> >>> Here is the working code.
> >>>
> >>> Data <- read.csv("./input/Source.csv", header=T)
> >>> describe(Data)
> >>> summary(Data)
> >>> unique(Data[1])
> >>> unique(Data[2])
> >>> unique(Data[3])
> >>> unique(Data[4])
> >>>
> >>> I would like to add sort the unique entries. The data in the various
> >>> columns are not defined as numbers, but also text. I realize 1 and
> >>> 10 will not sort properly, as the column is not defined as a number,
> >>> but want to see what I have in the columns viewed as sorted.
> >>>
> >>> QUESTION
> >>> What is the best process to sort unique output, please?
> >>>
> >>>
> >>> Thanks.
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> >> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From drj|m|emon @end|ng |rom gm@||@com  Tue Dec 21 23:00:20 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Wed, 22 Dec 2021 09:00:20 +1100
Subject: [R] Creating NA equivalent
In-Reply-To: <010c01d7f6a3$57fe6170$07fb2450$@verizon.net>
References: <977561d4-86af-69a7-de39-f53a0e2dfd92.ref@yahoo.fr>
 <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
 <7ef1e12e-9024-8dba-0f68-567db68cb803@gmail.com>
 <010c01d7f6a3$57fe6170$07fb2450$@verizon.net>
Message-ID: <CA+8X3fXe4tt-FGm7FOdPNJngVc66Fs8r7CwsGYaprzAHDNcfgA@mail.gmail.com>

Please pardon a comment that may be off-target as well as off-topic.
This appears similar to a number of things like fuzzy logic, where an
instance can take incompatible truth values.

It is known that an instance may have an attribute with a numeric
value, but that value cannot be determined.

It seems to me that an appropriate designation for the value is Unk,
perhaps with an associated probability of determination to distinguish
it from NA (it is definitely not known).

Jim

On Wed, Dec 22, 2021 at 6:55 AM Avi Gross via R-help
<r-help at r-project.org> wrote:
>
> I wonder if the package Adrian Du?a created might be helpful or point you along the way.
>
> It was eventually named "declared"
>
> https://cran.r-project.org/web/packages/declared/index.html
>
> With a vignette here:
>
> https://cran.r-project.org/web/packages/declared/vignettes/declared.pdf
>
> I do not know if it would easily satisfy your needs but it may be a step along the way. A package called Haven was part of the motivation and Adrian wanted a way to import data from external sources that had more than one category of NA that sounds a bit like what you want. His functions should allow the creation of such data within R, as well. I am including him in this email if you want to contact him or he has something to say.
>
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Duncan Murdoch
> Sent: Tuesday, December 21, 2021 5:26 AM
> To: Marc Girondot <marc_grt at yahoo.fr>; r-help at r-project.org
> Subject: Re: [R] Creating NA equivalent
>
> On 20/12/2021 11:41 p.m., Marc Girondot via R-help wrote:
> > Dear members,
> >
> > I work about dosage and some values are bellow the detection limit. I
> > would like create new "numbers" like LDL (to represent lower than
> > detection limit) and UDL (upper the detection limit) that behave like
> > NA, with the possibility to test them using for example is.LDL() or
> > is.UDL().
> >
> > Note that NA is not the same than LDL or UDL: NA represent missing data.
> > Here the data is available as LDL or UDL.
> >
> > NA is built in R language very deep... any option to create new
> > version of NA-equivalent ?
> >
>
> There was a discussion of this back in May.  Here's a link to one approach that I suggested:
>
>    https://stat.ethz.ch/pipermail/r-devel/2021-May/080776.html
>
> Read the followup messages, I made at least one suggested improvement.
> I don't know if anyone has packaged this, but there's a later version of the code here:
>
>    https://stackoverflow.com/a/69179441/2554330
>
> Duncan Murdoch
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Tue Dec 21 23:55:58 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 21 Dec 2021 14:55:58 -0800
Subject: [R] Creating NA equivalent
In-Reply-To: <CA+8X3fXe4tt-FGm7FOdPNJngVc66Fs8r7CwsGYaprzAHDNcfgA@mail.gmail.com>
References: <977561d4-86af-69a7-de39-f53a0e2dfd92.ref@yahoo.fr>
 <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
 <7ef1e12e-9024-8dba-0f68-567db68cb803@gmail.com>
 <010c01d7f6a3$57fe6170$07fb2450$@verizon.net>
 <CA+8X3fXe4tt-FGm7FOdPNJngVc66Fs8r7CwsGYaprzAHDNcfgA@mail.gmail.com>
Message-ID: <CAGxFJbS0HdtQ-uBHWKtU8Sy_-z-U3K9XVpadCgADvjXPGLa=3w@mail.gmail.com>

But you appear to be missing something, Jim -- see inline below (and
the original post):

Bert


On Tue, Dec 21, 2021 at 2:00 PM Jim Lemon <drjimlemon at gmail.com> wrote:
>
> Please pardon a comment that may be off-target as well as off-topic.
> This appears similar to a number of things like fuzzy logic, where an
> instance can take incompatible truth values.
>
> It is known that an instance may have an attribute with a numeric
> value, but that value cannot be determined.
Yes, but **something** about the value is known: that it is > an upper
value or < a lower value. Such information should be used
(censoring!), not characterized as completely unknown. Think about it
in terms of survival time: saying that a person lasted longer than k
months is much more informative than saying that how long they lasted
is completely unknown!

>
> It seems to me that an appropriate designation for the value is Unk,
> perhaps with an associated probability of determination to distinguish
> it from NA (it is definitely not known).
>
> Jim
>
> On Wed, Dec 22, 2021 at 6:55 AM Avi Gross via R-help
> <r-help at r-project.org> wrote:
> >
> > I wonder if the package Adrian Du?a created might be helpful or point you along the way.
> >
> > It was eventually named "declared"
> >
> > https://cran.r-project.org/web/packages/declared/index.html
> >
> > With a vignette here:
> >
> > https://cran.r-project.org/web/packages/declared/vignettes/declared.pdf
> >
> > I do not know if it would easily satisfy your needs but it may be a step along the way. A package called Haven was part of the motivation and Adrian wanted a way to import data from external sources that had more than one category of NA that sounds a bit like what you want. His functions should allow the creation of such data within R, as well. I am including him in this email if you want to contact him or he has something to say.
> >
> >
> > -----Original Message-----
> > From: R-help <r-help-bounces at r-project.org> On Behalf Of Duncan Murdoch
> > Sent: Tuesday, December 21, 2021 5:26 AM
> > To: Marc Girondot <marc_grt at yahoo.fr>; r-help at r-project.org
> > Subject: Re: [R] Creating NA equivalent
> >
> > On 20/12/2021 11:41 p.m., Marc Girondot via R-help wrote:
> > > Dear members,
> > >
> > > I work about dosage and some values are bellow the detection limit. I
> > > would like create new "numbers" like LDL (to represent lower than
> > > detection limit) and UDL (upper the detection limit) that behave like
> > > NA, with the possibility to test them using for example is.LDL() or
> > > is.UDL().
> > >
> > > Note that NA is not the same than LDL or UDL: NA represent missing data.
> > > Here the data is available as LDL or UDL.
> > >
> > > NA is built in R language very deep... any option to create new
> > > version of NA-equivalent ?
> > >
> >
> > There was a discussion of this back in May.  Here's a link to one approach that I suggested:
> >
> >    https://stat.ethz.ch/pipermail/r-devel/2021-May/080776.html
> >
> > Read the followup messages, I made at least one suggested improvement.
> > I don't know if anyone has packaged this, but there's a later version of the code here:
> >
> >    https://stackoverflow.com/a/69179441/2554330
> >
> > Duncan Murdoch
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From drj|m|emon @end|ng |rom gm@||@com  Wed Dec 22 00:35:55 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Wed, 22 Dec 2021 10:35:55 +1100
Subject: [R] Creating NA equivalent
In-Reply-To: <CAGxFJbS0HdtQ-uBHWKtU8Sy_-z-U3K9XVpadCgADvjXPGLa=3w@mail.gmail.com>
References: <977561d4-86af-69a7-de39-f53a0e2dfd92.ref@yahoo.fr>
 <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
 <7ef1e12e-9024-8dba-0f68-567db68cb803@gmail.com>
 <010c01d7f6a3$57fe6170$07fb2450$@verizon.net>
 <CA+8X3fXe4tt-FGm7FOdPNJngVc66Fs8r7CwsGYaprzAHDNcfgA@mail.gmail.com>
 <CAGxFJbS0HdtQ-uBHWKtU8Sy_-z-U3K9XVpadCgADvjXPGLa=3w@mail.gmail.com>
Message-ID: <CA+8X3fW8fUuy-BodF86y50XsJgdwaUAnJfsouEYYJ3AyQN2QYQ@mail.gmail.com>

Hi Bert,
What troubles me about this is that something like detectable level(s)
is determined at a particular time and may change. Censoring in
survival tells us that the case lasted "at least this long". While a
less than detectable value doesn't give any useful information apart
from perhaps "non-zero", an over limit value gives something like
censoring with "at least this much". However, it is more difficult to
conceptualize and I suspect, to quantify. To me, the important
information is that we think there _may be_ a value but we don't
(yet?) know it.

Jim

On Wed, Dec 22, 2021 at 9:56 AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> But you appear to be missing something, Jim -- see inline below (and
> the original post):
>
> Bert
>
>
> On Tue, Dec 21, 2021 at 2:00 PM Jim Lemon <drjimlemon at gmail.com> wrote:
> >
> > Please pardon a comment that may be off-target as well as off-topic.
> > This appears similar to a number of things like fuzzy logic, where an
> > instance can take incompatible truth values.
> >
> > It is known that an instance may have an attribute with a numeric
> > value, but that value cannot be determined.
> Yes, but **something** about the value is known: that it is > an upper
> value or < a lower value. Such information should be used
> (censoring!), not characterized as completely unknown. Think about it
> in terms of survival time: saying that a person lasted longer than k
> months is much more informative than saying that how long they lasted
> is completely unknown!
>
> >
> > It seems to me that an appropriate designation for the value is Unk,
> > perhaps with an associated probability of determination to distinguish
> > it from NA (it is definitely not known).
> >
> > Jim
> >
> > On Wed, Dec 22, 2021 at 6:55 AM Avi Gross via R-help
> > <r-help at r-project.org> wrote:
> > >
> > > I wonder if the package Adrian Du?a created might be helpful or point you along the way.
> > >
> > > It was eventually named "declared"
> > >
> > > https://cran.r-project.org/web/packages/declared/index.html
> > >
> > > With a vignette here:
> > >
> > > https://cran.r-project.org/web/packages/declared/vignettes/declared.pdf
> > >
> > > I do not know if it would easily satisfy your needs but it may be a step along the way. A package called Haven was part of the motivation and Adrian wanted a way to import data from external sources that had more than one category of NA that sounds a bit like what you want. His functions should allow the creation of such data within R, as well. I am including him in this email if you want to contact him or he has something to say.
> > >
> > >
> > > -----Original Message-----
> > > From: R-help <r-help-bounces at r-project.org> On Behalf Of Duncan Murdoch
> > > Sent: Tuesday, December 21, 2021 5:26 AM
> > > To: Marc Girondot <marc_grt at yahoo.fr>; r-help at r-project.org
> > > Subject: Re: [R] Creating NA equivalent
> > >
> > > On 20/12/2021 11:41 p.m., Marc Girondot via R-help wrote:
> > > > Dear members,
> > > >
> > > > I work about dosage and some values are bellow the detection limit. I
> > > > would like create new "numbers" like LDL (to represent lower than
> > > > detection limit) and UDL (upper the detection limit) that behave like
> > > > NA, with the possibility to test them using for example is.LDL() or
> > > > is.UDL().
> > > >
> > > > Note that NA is not the same than LDL or UDL: NA represent missing data.
> > > > Here the data is available as LDL or UDL.
> > > >
> > > > NA is built in R language very deep... any option to create new
> > > > version of NA-equivalent ?
> > > >
> > >
> > > There was a discussion of this back in May.  Here's a link to one approach that I suggested:
> > >
> > >    https://stat.ethz.ch/pipermail/r-devel/2021-May/080776.html
> > >
> > > Read the followup messages, I made at least one suggested improvement.
> > > I don't know if anyone has packaged this, but there's a later version of the code here:
> > >
> > >    https://stackoverflow.com/a/69179441/2554330
> > >
> > > Duncan Murdoch
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.


From d@v|d@@teven@ @end|ng |rom u@u@edu  Wed Dec 22 01:50:54 2021
From: d@v|d@@teven@ @end|ng |rom u@u@edu (David K Stevens)
Date: Tue, 21 Dec 2021 17:50:54 -0700
Subject: [R] [EXT] Re:  Creating NA equivalent
In-Reply-To: <CA+8X3fW8fUuy-BodF86y50XsJgdwaUAnJfsouEYYJ3AyQN2QYQ@mail.gmail.com>
References: <977561d4-86af-69a7-de39-f53a0e2dfd92.ref@yahoo.fr>
 <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
 <7ef1e12e-9024-8dba-0f68-567db68cb803@gmail.com>
 <010c01d7f6a3$57fe6170$07fb2450$@verizon.net>
 <CA+8X3fXe4tt-FGm7FOdPNJngVc66Fs8r7CwsGYaprzAHDNcfgA@mail.gmail.com>
 <CAGxFJbS0HdtQ-uBHWKtU8Sy_-z-U3K9XVpadCgADvjXPGLa=3w@mail.gmail.com>
 <CA+8X3fW8fUuy-BodF86y50XsJgdwaUAnJfsouEYYJ3AyQN2QYQ@mail.gmail.com>
Message-ID: <0919d557-add6-b365-5a23-f5117c2846f9@usu.edu>

Hello all,

My two cents. We use the term "below the detection limit" for any 
physical measurement that is cannot be distinguished from noise in the 
measurement system. This may either be instance specific (determine the 
detection limit for each instance) or "below the reporting limit" which 
is usually set at the maximum of the detection limits found for each 
instance as an administrative simplification. Either way the 
interpretation is "the value is between 0 and the limit" which carries 
information just as the "at least this much" limit in survival analysis. 
Some data sets have both lower and upper censoring and survival analysis 
appears to be the most appropriate. This is discussed in detail by 
Dennis Helsel from Practical Stats and is captured in the NADA package 
in R for environmental and hydrological data.

regards

David Stevens

On 12/21/2021 4:35 PM, Jim Lemon wrote:
> Hi Bert,
> What troubles me about this is that something like detectable level(s)
> is determined at a particular time and may change. Censoring in
> survival tells us that the case lasted "at least this long". While a
> less than detectable value doesn't give any useful information apart
> from perhaps "non-zero", an over limit value gives something like
> censoring with "at least this much". However, it is more difficult to
> conceptualize and I suspect, to quantify. To me, the important
> information is that we think there _may be_ a value but we don't
> (yet?) know it.
>
> Jim
>
> On Wed, Dec 22, 2021 at 9:56 AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>> But you appear to be missing something, Jim -- see inline below (and
>> the original post):
>>
>> Bert
>>
>>
>> On Tue, Dec 21, 2021 at 2:00 PM Jim Lemon <drjimlemon at gmail.com> wrote:
>>> Please pardon a comment that may be off-target as well as off-topic.
>>> This appears similar to a number of things like fuzzy logic, where an
>>> instance can take incompatible truth values.
>>>
>>> It is known that an instance may have an attribute with a numeric
>>> value, but that value cannot be determined.
>> Yes, but **something** about the value is known: that it is > an upper
>> value or < a lower value. Such information should be used
>> (censoring!), not characterized as completely unknown. Think about it
>> in terms of survival time: saying that a person lasted longer than k
>> months is much more informative than saying that how long they lasted
>> is completely unknown!
>>
>>> It seems to me that an appropriate designation for the value is Unk,
>>> perhaps with an associated probability of determination to distinguish
>>> it from NA (it is definitely not known).
>>>
>>> Jim
>>>
>>> On Wed, Dec 22, 2021 at 6:55 AM Avi Gross via R-help
>>> <r-help at r-project.org> wrote:
>>>> I wonder if the package Adrian Du?a created might be helpful or point you along the way.
>>>>
>>>> It was eventually named "declared"
>>>>
>>>> https://cran.r-project.org/web/packages/declared/index.html
>>>>
>>>> With a vignette here:
>>>>
>>>> https://cran.r-project.org/web/packages/declared/vignettes/declared.pdf
>>>>
>>>> I do not know if it would easily satisfy your needs but it may be a step along the way. A package called Haven was part of the motivation and Adrian wanted a way to import data from external sources that had more than one category of NA that sounds a bit like what you want. His functions should allow the creation of such data within R, as well. I am including him in this email if you want to contact him or he has something to say.
>>>>
>>>>
>>>> -----Original Message-----
>>>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Duncan Murdoch
>>>> Sent: Tuesday, December 21, 2021 5:26 AM
>>>> To: Marc Girondot <marc_grt at yahoo.fr>; r-help at r-project.org
>>>> Subject: Re: [R] Creating NA equivalent
>>>>
>>>> On 20/12/2021 11:41 p.m., Marc Girondot via R-help wrote:
>>>>> Dear members,
>>>>>
>>>>> I work about dosage and some values are bellow the detection limit. I
>>>>> would like create new "numbers" like LDL (to represent lower than
>>>>> detection limit) and UDL (upper the detection limit) that behave like
>>>>> NA, with the possibility to test them using for example is.LDL() or
>>>>> is.UDL().
>>>>>
>>>>> Note that NA is not the same than LDL or UDL: NA represent missing data.
>>>>> Here the data is available as LDL or UDL.
>>>>>
>>>>> NA is built in R language very deep... any option to create new
>>>>> version of NA-equivalent ?
>>>>>
>>>> There was a discussion of this back in May.  Here's a link to one approach that I suggested:
>>>>
>>>>     https://stat.ethz.ch/pipermail/r-devel/2021-May/080776.html
>>>>
>>>> Read the followup messages, I made at least one suggested improvement.
>>>> I don't know if anyone has packaged this, but there's a later version of the code here:
>>>>
>>>>     https://stackoverflow.com/a/69179441/2554330
>>>>
>>>> Duncan Murdoch
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
> CAUTION: This email originated from outside of USU. If this appears to be a USU employee, beware of impersonators. Do not click links, reply, download images, or open attachments unless you verify the sender?s identity and know the content is safe.
>
-- 
David K Stevens, PhD,PE
Professor
Civil and Environmental Engineering
Utah State University
Logan, UT 84322-8200
david.stevens at usu.edu
014357973229


From @v|gro@@ @end|ng |rom ver|zon@net  Wed Dec 22 02:36:27 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Tue, 21 Dec 2021 20:36:27 -0500
Subject: [R] Creating NA equivalent
In-Reply-To: <CA+8X3fXe4tt-FGm7FOdPNJngVc66Fs8r7CwsGYaprzAHDNcfgA@mail.gmail.com>
References: <977561d4-86af-69a7-de39-f53a0e2dfd92.ref@yahoo.fr>
 <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
 <7ef1e12e-9024-8dba-0f68-567db68cb803@gmail.com>
 <010c01d7f6a3$57fe6170$07fb2450$@verizon.net>
 <CA+8X3fXe4tt-FGm7FOdPNJngVc66Fs8r7CwsGYaprzAHDNcfgA@mail.gmail.com>
Message-ID: <011601d7f6d4$56f9a560$04ecf020$@verizon.net>

Jim,

there are indeed many mathematical areas where data are not quite fixed. Consider inequalities such as a value that can be higher than some number but lower than another. A grade of A can often mean a score between 90 and 100 (no extra credit). An event deemed to be "significant at the 95% level of probability can be in a 5% range or based on various errors, may not even be in the range. Some places you can have infinitesimals or things approaching infinity and yet sometimes cancel things out without having an exact number.

The list of such things is vast and as was already pointed out here, many such cases have some info, even USEFUL info, that is lost if you declare them to be an NA or an Inf or by say choosing to view an A is exactly 95. If a student has straight A's, there is an excellent chance many of those A's came from scores above 95. A student with an overall C average may be more likely to have the single A be in the low 90's. 

R was not necessarily designed to work this way. For some purposes, you may want to use a variable that is more of a range. When I make plots in ggplot, I often use Inf or -Inf to specify one end of a range, so that, for example, whatever the data makes ggplot choose for upper and lower bounds, something I draw in the background will extend to that border. 

But there is a difference between how we store info, and how we use it. Many R functions have a feature like saying na.rm=TRUE that may not make sense if you store a value as an NA whose meaning is "between 95 and 100". You might want to write code that makes two copies of any vector which has an NA value associated with a range, and do something like place the minimum value(s) in one and the maximum in the other and then do some complex calculation.

Or consider a value like measuring a room with a ruler accurate only to 1/4 inch? If a side is 100 inches, the real value can be between 99.75 and 100.25 inches. Each measurement can be stored as a number and a plus/minus. To calculate the volume of a room, you might multiply all the low values to get one number and the high values to get another and store that as a range or whatever else makes send like averaging the two. 

Still, some of that is normally ignored or done some other way, without inventing new meanings for NA. I noted earlier that programs outside R will often do something like store out-of-band info that when imported into R is always treated as NA. Some thig may be unavailable because the person did not show up, others because they had horrible handwriting and the one who typed it in guessed what it said, and others who refused to answer . It may be that much of your program should treat all those as NA but other parts might want to record that some percent of the responders did this or that. As noted, Adrian Dusa and others had such needs and have a package that in some way annotates NA values when asked. I have played with it but currently have no need for it. And, just FYI, Adrian tried other things first as there already are multiple bit patterns that mean specific variation on an NA such as NA_integer_ (note the two underscores) and other variants for character, real, complex and a few more. In a bizarre way, you can play games and test them as in:

  > a=NA_integer_
  > b=NA_character_
  > identical(a, NA_integer_)
  [1] TRUE
  > identical(a, NA_character_)
  [1] FALSE
  > identical(a, a)
  [1] TRUE
  > identical(a, b)
  [1] FALSE
  > identical(a, NA)
  [1] FALSE

So, in THEORY, you might get away to using these oddball bitmap variations, or adding to them but they do not survive well in vectors which must in some sense only contain one type. I have had some minor success making a list and test the contents, which normally show all version as NA but clearly retain subtle differences:

  > temp=list(1, NA_integer_, 2, NA_character_, 3, NA)
  > temp
  [[1]]
  [1] 1
  
  [[2]]
  [1] NA
  
  [[3]]
  [1] 2
  
  [[4]]
  [1] NA
  
  [[5]]
  [1] 3
  
  [[6]]
  [1] NA
  
  > temp[[2]]
  [1] NA
  > identical(temp[[2]], NA_integer_)
  [1] TRUE
  > identical(temp[[2]], NA_character_)
  [1] FALSE
  > identical(temp[[4]], NA_character_)
  [1] TRUE

So, yes, I can imagine a subtle window of opportunity for re-using some of these NA variants to act like an NA but also be able to carefully signal some other opportunities. But as noted, vectors break the scheme so your data.frame might need to use list columns, which is doable. I bet many tools you use, especially ones that make copies or conversions, will break the scheme.

Please note that for ME, the above discussion is academic and a reaction to the ideas raised by others. I am not in any way suggesting R is deficient for not being designed for things like this, nor that wanting some such feature is a bad thing. What Adrian provided is sort of in between as real NA are stored but also some attributes record what the NA is supposed to represent.




-----Original Message-----
From: Jim Lemon <drjimlemon at gmail.com> 
Sent: Tuesday, December 21, 2021 5:00 PM
To: Avi Gross <avigross at verizon.net>
Cc: r-help mailing list <r-help at r-project.org>; Adrian Du?a <dusa.adrian at unibuc.ro>
Subject: Re: [R] Creating NA equivalent

Please pardon a comment that may be off-target as well as off-topic.
This appears similar to a number of things like fuzzy logic, where an instance can take incompatible truth values.

It is known that an instance may have an attribute with a numeric value, but that value cannot be determined.

It seems to me that an appropriate designation for the value is Unk, perhaps with an associated probability of determination to distinguish it from NA (it is definitely not known).

Jim

On Wed, Dec 22, 2021 at 6:55 AM Avi Gross via R-help <r-help at r-project.org> wrote:
>
> I wonder if the package Adrian Du?a created might be helpful or point you along the way.
>
> It was eventually named "declared"
>
> https://cran.r-project.org/web/packages/declared/index.html
>
> With a vignette here:
>
> https://cran.r-project.org/web/packages/declared/vignettes/declared.pd
> f
>
> I do not know if it would easily satisfy your needs but it may be a step along the way. A package called Haven was part of the motivation and Adrian wanted a way to import data from external sources that had more than one category of NA that sounds a bit like what you want. His functions should allow the creation of such data within R, as well. I am including him in this email if you want to contact him or he has something to say.
>
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Duncan 
> Murdoch
> Sent: Tuesday, December 21, 2021 5:26 AM
> To: Marc Girondot <marc_grt at yahoo.fr>; r-help at r-project.org
> Subject: Re: [R] Creating NA equivalent
>
> On 20/12/2021 11:41 p.m., Marc Girondot via R-help wrote:
> > Dear members,
> >
> > I work about dosage and some values are bellow the detection limit. 
> > I would like create new "numbers" like LDL (to represent lower than 
> > detection limit) and UDL (upper the detection limit) that behave 
> > like NA, with the possibility to test them using for example 
> > is.LDL() or is.UDL().
> >
> > Note that NA is not the same than LDL or UDL: NA represent missing data.
> > Here the data is available as LDL or UDL.
> >
> > NA is built in R language very deep... any option to create new 
> > version of NA-equivalent ?
> >
>
> There was a discussion of this back in May.  Here's a link to one approach that I suggested:
>
>    https://stat.ethz.ch/pipermail/r-devel/2021-May/080776.html
>
> Read the followup messages, I made at least one suggested improvement.
> I don't know if anyone has packaged this, but there's a later version of the code here:
>
>    https://stackoverflow.com/a/69179441/2554330
>
> Duncan Murdoch
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From y@ngk@|9999 @end|ng |rom y@hoo@com  Wed Dec 22 03:00:00 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Wed, 22 Dec 2021 02:00:00 +0000 (UTC)
Subject: [R] problem: try to passing macro value into submit block
References: <1504267170.261737.1640138400264.ref@mail.yahoo.com>
Message-ID: <1504267170.261737.1640138400264@mail.yahoo.com>

Hi team,I'm trying to pass macro variable into R script in Proc iml. I want to do change variable in color= and export the result with different file name.If I don't use macro, the code work well. But when I try to use macro below, I got error message: "Submit block cannot be directly placed in a macro. Instead, place the submit block into a file first and then use %include to include the file within a macro definition.".?After reading the message, I still not sure how to fix the problem in the code. Anyone can help me?
Thank you,Kai
%macro pplot(a);proc iml;
submit / R;
library(ggplot2)library(tidyverse)
mpg %>%? filter(hwy <35) %>%?? ggplot(aes(x = displ, y = hwy, color = &a)) +?? geom_point()ggsave("c:/temp/&a..jpg")
endsubmit;
quit;%mend;%pplot(drv);%pplot(cyl);

	[[alternative HTML version deleted]]


From dw|n@em|u@ @end|ng |rom comc@@t@net  Wed Dec 22 04:21:50 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Tue, 21 Dec 2021 19:21:50 -0800
Subject: [R] problem: try to passing macro value into submit block
In-Reply-To: <1504267170.261737.1640138400264@mail.yahoo.com>
References: <1504267170.261737.1640138400264.ref@mail.yahoo.com>
 <1504267170.261737.1640138400264@mail.yahoo.com>
Message-ID: <8830af57-a00f-484b-8ec8-ad8c32d26e50@comcast.net>


On 12/21/21 6:00 PM, Kai Yang via R-help wrote:
> Hi team,I'm trying to pass macro variable into R script in Proc iml. I want to do change variable in color= and export the result with different file name.If I don't use macro, the code work well. But when I try to use macro below, I got error message: "Submit block cannot be directly placed in a macro. Instead, place the submit block into a file first and then use %include to include the file within a macro definition.".?After reading the message, I still not sure how to fix the problem in the code. Anyone can help me?
> Thank you,Kai
> %macro pplot(a);proc iml;
> submit / R;
> library(ggplot2)library(tidyverse)
> mpg %>%? filter(hwy <35) %>%?? ggplot(aes(x = displ, y = hwy, color = &a)) +?? geom_point()ggsave("c:/temp/&a..jpg")
> endsubmit;
> quit;%mend;%pplot(drv);%pplot(cyl);
>
> 	[[alternative HTML version deleted]]


Two problems I see. 1) you posted to R-help using html whereas the 
mailing list is a plain text venue, and 2) I reasonably sure that's a 
SAS error message and we don't consult on SAS problems.

If you strip out the stuff involving "&a" and add back in the elided 
line-breaks the R code runs without error.

-- 

David.

>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From d@v|d@@teven@ @end|ng |rom u@u@edu  Wed Dec 22 01:50:54 2021
From: d@v|d@@teven@ @end|ng |rom u@u@edu (David K Stevens)
Date: Tue, 21 Dec 2021 17:50:54 -0700
Subject: [R] [EXT] Re:  Creating NA equivalent
In-Reply-To: <CA+8X3fW8fUuy-BodF86y50XsJgdwaUAnJfsouEYYJ3AyQN2QYQ@mail.gmail.com>
References: <977561d4-86af-69a7-de39-f53a0e2dfd92.ref@yahoo.fr>
 <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
 <7ef1e12e-9024-8dba-0f68-567db68cb803@gmail.com>
 <010c01d7f6a3$57fe6170$07fb2450$@verizon.net>
 <CA+8X3fXe4tt-FGm7FOdPNJngVc66Fs8r7CwsGYaprzAHDNcfgA@mail.gmail.com>
 <CAGxFJbS0HdtQ-uBHWKtU8Sy_-z-U3K9XVpadCgADvjXPGLa=3w@mail.gmail.com>
 <CA+8X3fW8fUuy-BodF86y50XsJgdwaUAnJfsouEYYJ3AyQN2QYQ@mail.gmail.com>
Message-ID: <0919d557-add6-b365-5a23-f5117c2846f9@usu.edu>

Hello all,

My two cents. We use the term "below the detection limit" for any 
physical measurement that is cannot be distinguished from noise in the 
measurement system. This may either be instance specific (determine the 
detection limit for each instance) or "below the reporting limit" which 
is usually set at the maximum of the detection limits found for each 
instance as an administrative simplification. Either way the 
interpretation is "the value is between 0 and the limit" which carries 
information just as the "at least this much" limit in survival analysis. 
Some data sets have both lower and upper censoring and survival analysis 
appears to be the most appropriate. This is discussed in detail by 
Dennis Helsel from Practical Stats and is captured in the NADA package 
in R for environmental and hydrological data.

regards

David Stevens

On 12/21/2021 4:35 PM, Jim Lemon wrote:
> Hi Bert,
> What troubles me about this is that something like detectable level(s)
> is determined at a particular time and may change. Censoring in
> survival tells us that the case lasted "at least this long". While a
> less than detectable value doesn't give any useful information apart
> from perhaps "non-zero", an over limit value gives something like
> censoring with "at least this much". However, it is more difficult to
> conceptualize and I suspect, to quantify. To me, the important
> information is that we think there _may be_ a value but we don't
> (yet?) know it.
>
> Jim
>
> On Wed, Dec 22, 2021 at 9:56 AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>> But you appear to be missing something, Jim -- see inline below (and
>> the original post):
>>
>> Bert
>>
>>
>> On Tue, Dec 21, 2021 at 2:00 PM Jim Lemon <drjimlemon at gmail.com> wrote:
>>> Please pardon a comment that may be off-target as well as off-topic.
>>> This appears similar to a number of things like fuzzy logic, where an
>>> instance can take incompatible truth values.
>>>
>>> It is known that an instance may have an attribute with a numeric
>>> value, but that value cannot be determined.
>> Yes, but **something** about the value is known: that it is > an upper
>> value or < a lower value. Such information should be used
>> (censoring!), not characterized as completely unknown. Think about it
>> in terms of survival time: saying that a person lasted longer than k
>> months is much more informative than saying that how long they lasted
>> is completely unknown!
>>
>>> It seems to me that an appropriate designation for the value is Unk,
>>> perhaps with an associated probability of determination to distinguish
>>> it from NA (it is definitely not known).
>>>
>>> Jim
>>>
>>> On Wed, Dec 22, 2021 at 6:55 AM Avi Gross via R-help
>>> <r-help at r-project.org> wrote:
>>>> I wonder if the package Adrian Du?a created might be helpful or point you along the way.
>>>>
>>>> It was eventually named "declared"
>>>>
>>>> https://cran.r-project.org/web/packages/declared/index.html
>>>>
>>>> With a vignette here:
>>>>
>>>> https://cran.r-project.org/web/packages/declared/vignettes/declared.pdf
>>>>
>>>> I do not know if it would easily satisfy your needs but it may be a step along the way. A package called Haven was part of the motivation and Adrian wanted a way to import data from external sources that had more than one category of NA that sounds a bit like what you want. His functions should allow the creation of such data within R, as well. I am including him in this email if you want to contact him or he has something to say.
>>>>
>>>>
>>>> -----Original Message-----
>>>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Duncan Murdoch
>>>> Sent: Tuesday, December 21, 2021 5:26 AM
>>>> To: Marc Girondot <marc_grt at yahoo.fr>; r-help at r-project.org
>>>> Subject: Re: [R] Creating NA equivalent
>>>>
>>>> On 20/12/2021 11:41 p.m., Marc Girondot via R-help wrote:
>>>>> Dear members,
>>>>>
>>>>> I work about dosage and some values are bellow the detection limit. I
>>>>> would like create new "numbers" like LDL (to represent lower than
>>>>> detection limit) and UDL (upper the detection limit) that behave like
>>>>> NA, with the possibility to test them using for example is.LDL() or
>>>>> is.UDL().
>>>>>
>>>>> Note that NA is not the same than LDL or UDL: NA represent missing data.
>>>>> Here the data is available as LDL or UDL.
>>>>>
>>>>> NA is built in R language very deep... any option to create new
>>>>> version of NA-equivalent ?
>>>>>
>>>> There was a discussion of this back in May.  Here's a link to one approach that I suggested:
>>>>
>>>>     https://stat.ethz.ch/pipermail/r-devel/2021-May/080776.html
>>>>
>>>> Read the followup messages, I made at least one suggested improvement.
>>>> I don't know if anyone has packaged this, but there's a later version of the code here:
>>>>
>>>>     https://stackoverflow.com/a/69179441/2554330
>>>>
>>>> Duncan Murdoch
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
> CAUTION: This email originated from outside of USU. If this appears to be a USU employee, beware of impersonators. Do not click links, reply, download images, or open attachments unless you verify the sender?s identity and know the content is safe.
>
-- 
David K Stevens, PhD,PE
Professor
Civil and Environmental Engineering
Utah State University
Logan, UT 84322-8200
david.stevens at usu.edu
014357973229


From @k@h@y_e4 @end|ng |rom hotm@||@com  Wed Dec 22 13:56:33 2021
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Wed, 22 Dec 2021 12:56:33 +0000
Subject: [R] visualizing CTM topic models in R...
Message-ID: <PU4P216MB15681ACC474E88A11AEF53D4C87D9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

dear members,
                         I am using topicmodels package in R to segregate some news articles related to stocks.

I know that I can visualize LDA models with LDAvis package. But I have not stumbled upon any package or a base function(in the internet) to visualize the CTM model. Any ideas therefor?

Thanking You,
Yours sincerely,
AKSHAY M KULKARNI

	[[alternative HTML version deleted]]


From @erv|ce @end|ng |rom @hd@w@on@com  Wed Dec 22 16:20:41 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Wed, 22 Dec 2021 10:20:41 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
Message-ID: <8f4efdcb-57bc-2922-7f96-753af38d1c0b@shdawson.com>

Thanks for the reply.

Both syntax options work to render the correct (unique) output. However, 
the output is rendered as horizontal. What needs to happen to get the 
output to render vertical, please?


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/21/21 11:38 AM, Duncan Murdoch wrote:
> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>> Thanks for the reply.
>>>
>>> sort(unique(Data[1]))
>>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
>>> decreasing)) :
>>> ?? ? undefined columns selected
>>
>> That's the wrong syntax:? Data[1] is not "column one of Data". Use
>> Data[[1]] for that, so
>>
>> ??? sort(unique(Data[[1]]))
>
> Actually, I'd probably recommend
>
> ? sort(unique(Data[, 1]))
>
> instead.? This treats Data as a matrix rather than as a list. 
> Dataframes are lists that look like matrices, but to me the matrix 
> aspect is usually more intuitive.
>
> Duncan Murdoch
>
>>
>> I think Rui already pointed out the typo in the quoted text below...
>>
>> Duncan Murdoch
>>
>>>
>>> The recommended syntax did not work, as listed above.
>>>
>>> What I want is the sort of distinct column output. Again, the column 
>>> may
>>> be text or numbers. This is a huge analysis effort with data coming at
>>> me from many different sources.
>>>
>>>
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>>>> Thanks everyone for the replies.
>>>>>
>>>>> It is clear one either needs to write a function or put the unique
>>>>> entries into another dataframe.
>>>>>
>>>>> It seems odd R cannot sort a list of unique column entries with ease.
>>>>> Python and SQL can do it with ease.
>>>>
>>>> I've seen several responses that looked pretty simple.? It's hard to
>>>> beat sort(unique(x)), though there's a fair bit of confusion about
>>>> what you actually want.? Maybe you should post an example of the code
>>>> you'd use in Python?
>>>>
>>>> Duncan Murdoch
>>>>
>>>>>
>>>>> QUESTION
>>>>> Is there a simpler means than other than the unique function to 
>>>>> capture
>>>>> distinct column entries, then sort that list?
>>>>>
>>>>>
>>>>> *Stephen Dawson, DSL*
>>>>> /Executive Strategy Consultant/
>>>>> Business & Technology
>>>>> +1 (865) 804-3454
>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>
>>>>>
>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>> Hello,
>>>>>>
>>>>>> Inline.
>>>>>>
>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>>>>> Thanks.
>>>>>>>
>>>>>>> sort(unique(Data[[1]]))
>>>>>>>
>>>>>>> This syntax provides row numbers, not column values.
>>>>>>
>>>>>> This is not right.
>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>>>>>> extracts the column vector.
>>>>>>
>>>>>> As for my previous answer, it was not addressing the question, I
>>>>>> misinterpreted it as being a question on how to sort by numeric 
>>>>>> order
>>>>>> when the data is not numeric. Here is a, hopefully, complete answer.
>>>>>> Still with package stringr.
>>>>>>
>>>>>>
>>>>>> cols_to_sort <- 1:4
>>>>>>
>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>> ? ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>> })
>>>>>>
>>>>>>
>>>>>> Or using Avi's suggestion of writing a function to do all the 
>>>>>> work and
>>>>>> simplify the lapply loop later,
>>>>>>
>>>>>>
>>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>
>>>>>>
>>>>>> Hope this helps,
>>>>>>
>>>>>> Rui Barradas
>>>>>>
>>>>>>
>>>>>>>
>>>>>>> *Stephen Dawson, DSL*
>>>>>>> /Executive Strategy Consultant/
>>>>>>> Business & Technology
>>>>>>> +1 (865) 804-3454
>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>
>>>>>>>
>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>> Hi,
>>>>>>>>
>>>>>>>>
>>>>>>>> Running a simple syntax set to review entries in dataframe 
>>>>>>>> columns.
>>>>>>>> Here is the working code.
>>>>>>>>
>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>> describe(Data)
>>>>>>>> summary(Data)
>>>>>>>> unique(Data[1])
>>>>>>>> unique(Data[2])
>>>>>>>> unique(Data[3])
>>>>>>>> unique(Data[4])
>>>>>>>>
>>>>>>>> I would like to add sort the unique entries. The data in the 
>>>>>>>> various
>>>>>>>> columns are not defined as numbers, but also text. I realize 1 and
>>>>>>>> 10 will not sort properly, as the column is not defined as a 
>>>>>>>> number,
>>>>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>>>>
>>>>>>>> QUESTION
>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>
>>>>>>>>
>>>>>>>> Thanks.
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>> PLEASE do read the posting guide
>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>> PLEASE do read the posting guide
>>>>> http://www.R-project.org/posting-guide.html
>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>>>
>>>
>>>
>>
>
>


From @erv|ce @end|ng |rom @hd@w@on@com  Wed Dec 22 16:27:01 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Wed, 22 Dec 2021 10:27:01 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <CAGxFJbQSYv6ExzmjgNVy2LABEmeESCiZCM3R93iO3tF5L1Eing@mail.gmail.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <CAGxFJbQSYv6ExzmjgNVy2LABEmeESCiZCM3R93iO3tF5L1Eing@mail.gmail.com>
Message-ID: <d6d9a827-d791-074a-6212-c9529ffa6b5e@shdawson.com>

Bert,


Thanks for the reply.

I did not think to put values back into the same column. This action 
would not make sense to me, as it would destroy data integrity. I guess 
adding to a new column in the same container, in this case a dataframe, 
is possible but again not probable with me.

Either way, thanks for confirming all that comes out count-wise in a 
dataframe is what must go back into a dataframe count-wise.

It is nice to have folks on a mailing list that help to flush out what 
one thinks is and will happen with syntax versus what is happening and 
will happen with syntax.


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/21/21 3:38 PM, Bert Gunter wrote:
> Stephen:
> You seem confused about data frames. sort(unique(...)) has no problem
> sorting individual columns in a data frame (mod the issues about
> mixing numerics and non-numerics that have already been discussed).
> But the problem is that the results can *not* be put back in a data
> frame because, **by definition** all columns in a data frame **must**
> have the same number of values. unique() will change the number of
> values in a column if done column by column, e.g. via lapply() or
> looping over columns. Consequently, if you do this by lapply(), you'll
> get a list back, not a data frame. e.g.
>
>> dat <- data.frame(a = rep(3:1,2), b = c(5:1,5))
>> dat
>    a b
> 1 3 5
> 2 2 4
> 3 1 3
> 4 3 2
> 5 2 1
> 6 1 5
>> ## via lapply
>> dat <- lapply(dat, \(x)sort(unique(x)))
>> dat  ## a list.
> $a
> [1] 1 2 3
>
> $b
> [1] 1 2 3 4 5
>
>> ## Trying to do this with an explicit loop results in an error
>> dat <- data.frame(a = rep(1:3,2), b = c(1:5,5))
>> for(nm in names(dat))dat[[nm]] <- sort(unique(dat[[nm]])) ## error
> Error in `[[<-.data.frame`(`*tmp*`, nm, value = c(1, 2, 3, 4, 5)) :
>    replacement has 5 rows, data has 6
>
> OTOH, unique() has a data.frame method which will give unique *rows*
> (thinking of a data frame as a matrix-like object with a "dim"
> attribute):
>
>> dat <- data.frame(a = c(1,2,1), b = c('a','b','a'))
>> dat
>    a b
> 1 1 a
> 2 2 b
> 3 1 a
>> unique(dat)
>    a b
> 1 1 a
> 2 2 b
>
> There is no sort() method for data frames as this has no obvious
> single interpretation of sorting by whole rows. However, see ?sort for
> an example using ?order to carry out one possible interpretation of
> sorting by rows.
>
> Bert
>
>
> On Tue, Dec 21, 2021 at 7:16 AM Stephen H. Dawson, DSL via R-help
> <r-help at r-project.org> wrote:
>> Thanks everyone for the replies.
>>
>> It is clear one either needs to write a function or put the unique
>> entries into another dataframe.
>>
>> It seems odd R cannot sort a list of unique column entries with ease.
>> Python and SQL can do it with ease.
>>
>> QUESTION
>> Is there a simpler means than other than the unique function to capture
>> distinct column entries, then sort that list?
>>
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>> Hello,
>>>
>>> Inline.
>>>
>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>> Thanks.
>>>>
>>>> sort(unique(Data[[1]]))
>>>>
>>>> This syntax provides row numbers, not column values.
>>> This is not right.
>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>>> extracts the column vector.
>>>
>>> As for my previous answer, it was not addressing the question, I
>>> misinterpreted it as being a question on how to sort by numeric order
>>> when the data is not numeric. Here is a, hopefully, complete answer.
>>> Still with package stringr.
>>>
>>>
>>> cols_to_sort <- 1:4
>>>
>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>    stringr::str_sort(unique(x), numeric = TRUE)
>>> })
>>>
>>>
>>> Or using Avi's suggestion of writing a function to do all the work and
>>> simplify the lapply loop later,
>>>
>>>
>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>
>>>
>>> Hope this helps,
>>>
>>> Rui Barradas
>>>
>>>
>>>> *Stephen Dawson, DSL*
>>>> /Executive Strategy Consultant/
>>>> Business & Technology
>>>> +1 (865) 804-3454
>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>
>>>>
>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>> Hi,
>>>>>
>>>>>
>>>>> Running a simple syntax set to review entries in dataframe columns.
>>>>> Here is the working code.
>>>>>
>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>> describe(Data)
>>>>> summary(Data)
>>>>> unique(Data[1])
>>>>> unique(Data[2])
>>>>> unique(Data[3])
>>>>> unique(Data[4])
>>>>>
>>>>> I would like to add sort the unique entries. The data in the various
>>>>> columns are not defined as numbers, but also text. I realize 1 and
>>>>> 10 will not sort properly, as the column is not defined as a number,
>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>
>>>>> QUESTION
>>>>> What is the best process to sort unique output, please?
>>>>>
>>>>>
>>>>> Thanks.
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Dec 22 16:47:46 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 22 Dec 2021 10:47:46 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <8f4efdcb-57bc-2922-7f96-753af38d1c0b@shdawson.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <8f4efdcb-57bc-2922-7f96-753af38d1c0b@shdawson.com>
Message-ID: <dead8a81-9ad7-2df3-f97c-ff8fb3f1b903@gmail.com>

On 22/12/2021 10:20 a.m., Stephen H. Dawson, DSL wrote:
> Thanks for the reply.
> 
> Both syntax options work to render the correct (unique) output. However,
> the output is rendered as horizontal. What needs to happen to get the
> output to render vertical, please?

The result of those expressions is a vector of the same type as the 
column, so your question is really about how to get a vector to print 
one element per line.

Probably the simplest way is to put the vector in a dataframe (or 
matrix, or tibble, depending on which formatting you prefer).  For example,

 >   v <- c("red", "green", "blue")
 >   data.frame(v)
       v
1   red
2 green
3  blue

If you want a more minimal display, try

 > cat(v, sep = "\n")
red
green
blue

or

 > cat(format(v, justify = "right"), sep = "\n")
   red
green
  blue

If you want this to happen when you auto-print the object, you can give 
it a class attribute and write a function to print that class, e.g.

 >  class(v) <- "oneperline"
 >
 >   print.oneperline <- function(x, ...) cat(format(x, justify = 
"right"), sep = "\n")
 >
 >   v
   red
green
  blue

Duncan Murdoch

> 
> 
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
> 
> 
> On 12/21/21 11:38 AM, Duncan Murdoch wrote:
>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>> Thanks for the reply.
>>>>
>>>> sort(unique(Data[1]))
>>>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
>>>> decreasing)) :
>>>>  ?? ? undefined columns selected
>>>
>>> That's the wrong syntax:? Data[1] is not "column one of Data". Use
>>> Data[[1]] for that, so
>>>
>>>  ??? sort(unique(Data[[1]]))
>>
>> Actually, I'd probably recommend
>>
>>  ? sort(unique(Data[, 1]))
>>
>> instead.? This treats Data as a matrix rather than as a list.
>> Dataframes are lists that look like matrices, but to me the matrix
>> aspect is usually more intuitive.
>>
>> Duncan Murdoch
>>
>>>
>>> I think Rui already pointed out the typo in the quoted text below...
>>>
>>> Duncan Murdoch
>>>
>>>>
>>>> The recommended syntax did not work, as listed above.
>>>>
>>>> What I want is the sort of distinct column output. Again, the column
>>>> may
>>>> be text or numbers. This is a huge analysis effort with data coming at
>>>> me from many different sources.
>>>>
>>>>
>>>> *Stephen Dawson, DSL*
>>>> /Executive Strategy Consultant/
>>>> Business & Technology
>>>> +1 (865) 804-3454
>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>
>>>>
>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>>>>> Thanks everyone for the replies.
>>>>>>
>>>>>> It is clear one either needs to write a function or put the unique
>>>>>> entries into another dataframe.
>>>>>>
>>>>>> It seems odd R cannot sort a list of unique column entries with ease.
>>>>>> Python and SQL can do it with ease.
>>>>>
>>>>> I've seen several responses that looked pretty simple.? It's hard to
>>>>> beat sort(unique(x)), though there's a fair bit of confusion about
>>>>> what you actually want.? Maybe you should post an example of the code
>>>>> you'd use in Python?
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>>
>>>>>> QUESTION
>>>>>> Is there a simpler means than other than the unique function to
>>>>>> capture
>>>>>> distinct column entries, then sort that list?
>>>>>>
>>>>>>
>>>>>> *Stephen Dawson, DSL*
>>>>>> /Executive Strategy Consultant/
>>>>>> Business & Technology
>>>>>> +1 (865) 804-3454
>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>
>>>>>>
>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>> Hello,
>>>>>>>
>>>>>>> Inline.
>>>>>>>
>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>>>>>> Thanks.
>>>>>>>>
>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>
>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>
>>>>>>> This is not right.
>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>>>>>>> extracts the column vector.
>>>>>>>
>>>>>>> As for my previous answer, it was not addressing the question, I
>>>>>>> misinterpreted it as being a question on how to sort by numeric
>>>>>>> order
>>>>>>> when the data is not numeric. Here is a, hopefully, complete answer.
>>>>>>> Still with package stringr.
>>>>>>>
>>>>>>>
>>>>>>> cols_to_sort <- 1:4
>>>>>>>
>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>  ? ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>> })
>>>>>>>
>>>>>>>
>>>>>>> Or using Avi's suggestion of writing a function to do all the
>>>>>>> work and
>>>>>>> simplify the lapply loop later,
>>>>>>>
>>>>>>>
>>>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>
>>>>>>>
>>>>>>> Hope this helps,
>>>>>>>
>>>>>>> Rui Barradas
>>>>>>>
>>>>>>>
>>>>>>>>
>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>> /Executive Strategy Consultant/
>>>>>>>> Business & Technology
>>>>>>>> +1 (865) 804-3454
>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>
>>>>>>>>
>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>> Hi,
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Running a simple syntax set to review entries in dataframe
>>>>>>>>> columns.
>>>>>>>>> Here is the working code.
>>>>>>>>>
>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>> describe(Data)
>>>>>>>>> summary(Data)
>>>>>>>>> unique(Data[1])
>>>>>>>>> unique(Data[2])
>>>>>>>>> unique(Data[3])
>>>>>>>>> unique(Data[4])
>>>>>>>>>
>>>>>>>>> I would like to add sort the unique entries. The data in the
>>>>>>>>> various
>>>>>>>>> columns are not defined as numbers, but also text. I realize 1 and
>>>>>>>>> 10 will not sort properly, as the column is not defined as a
>>>>>>>>> number,
>>>>>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>>>>>
>>>>>>>>> QUESTION
>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Thanks.
>>>>>>>>
>>>>>>>> ______________________________________________
>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>> PLEASE do read the posting guide
>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>>
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>> PLEASE do read the posting guide
>>>>>> http://www.R-project.org/posting-guide.html
>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>
>>>>>
>>>>
>>>>
>>>
>>
>>
>


From @erv|ce @end|ng |rom @hd@w@on@com  Wed Dec 22 16:47:49 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Wed, 22 Dec 2021 10:47:49 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <00f201d7f69f$56ae5ea0$040b1be0$@verizon.net>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <00f201d7f69f$56ae5ea0$040b1be0$@verizon.net>
Message-ID: <de60612c-619d-2d33-8ee9-2c61331517f4@shdawson.com>

Avi,


Thanks for the detailed reply. I am unable to reply with the same 
detail. Please do not take my lack of response depth as demonstrating a 
lack of appreciation.

My intent was to post an open-ended question asking best process, not 
best practice, to amend sort to unique. I posted code showing how I 
arrived at my present status. The function read.csv reads a file in 
table format and creates a data frame from it. No column types are 
defined in the code. The scale of workload was not considered, as it is 
beyond scope at this point in the dialogue. What is present is defining 
what works, then selecting the efficient option for the scale of 
workload to accomplish.

The biggest benefit of an open-ended question is dialogue members asking 
questions to both confirm understandings and explore other 
considerations. Asking a specific question is necessary for an 
open-ended discussion, perhaps two questions. What often destroys an 
open-ended dialogue is placing boundaries on the dialogue.

This dialogue has shown there is no single best process to add sort to 
unique. I am fine with this outcome. It has been time well-spent for me, 
and the dialogue members from what I read in their positions on the 
concept of arranging data to be processed.

My definition of ease is simple: Whatever it takes to do what I need to do.

What is not included in this definition is mastering all aspects of step 
one before I move to step two.

Sort() does care what is fed to it. This has been the case with all 
occurrences of my experiences for both programming and using 
already-built code. Computers have a funny way of doing what they are 
told to do.

I do not want a language that has calculated every possible combination 
of ways to combine functions and already made tens of thousands available.

I look forward to learning more about the over 100 languages you can 
program during my journey to learn more about GNU R.


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/21/21 2:17 PM, Avi Gross via R-help wrote:
> Stephen,
>
> Languages have their own philosophies and are often focused initially on doing specific things well. Later, they tend to accumulate additional functionality both in the base language and extensions.
>
> I am wondering if you have explained your need precisely enough to get the answers you want.
>
> SQL and Python have their own ways and both have advantages but also huge deficiencies relative to just base R.
>
> But there are rules you live with and if you choose day a data.frame to store things in, the columns must all be the same length. The unique members of one data.frame are likely to not be the same number so storing them in a data.frame does not work. They can be stored quite  few other ways, such as a list of lists.
>
> And what is your definition of ease? I can program in Python and SQL and way over a hundred other languages and I know I need to adapt my thinking to the flow of the language and not the other way around. Base R was not designed to be like either SQL or Python. But it can be extended quite a few ways to do just about anything.
>
> What you ran into for example is the fact that some functionality is more selective in what it works on. A data.frame with one column is logically the same as a matrix with one column and as a vector but in reality, they are not the same thing. Yes, they can be converted into each other fairly trivially. Sort() seems to care what you feed it. If you did not worry about efficiency, you could have a version of sort that accepts a wide variety of inputs, converts any it can to some possibly common internal form, then converts the output back into the form it was received in, or uses a command-line option to specify the output format. It is not hard in R to make such a function as it has the primitives needed to examine an arbitrary object and see what dimensions it has for some number of types and so on, and has utilities to do the conversion.
>
> If you want a language that has calculated every possible combination of ways to combine functions and already made tens of thousands available, good luck. What languages (including Python and R) expect is for you to compose such combinations yourself in one of many ways. The annoying discussions here between purists and those wanting to use pre-made packages aside, your question can be handled in many of the ways we already discussed. They include making your own (often very small) function that implements consolidating the many steps into one logical step. It can mean using pipelines like the new "|>" operator recently added to base R or the older versions often used in the tidyverse packages like "%>%".
>
> You want to take a data.frame and select a column at a time and ask for it to be made into unique values then ordered and shown. So you want a VECTOR and your initial use of the "[" operator does not take the underlying list structure of a data.frame apart the way you might have thought but as a narrow data.frame. So you MAY need to either extract it using "[[" or use various routines R supplies like unlist() or as.vector().
>
> Here is a pipeline using this as my data:
>
> mydf <- data.frame(ints=c(5,4,3,3,4,5), chars=c("z","i","t","s","t","i"))
>
> Note the number of unique items differs s does the data type:
>
>    mydf
>    ints chars
>    1    5     z
>    2    4     i
>    3    3     t
>    4    3     s
>    5    4     t
>    6    5     i
>
> To handle the columns one at a time can be done using a pipeline like:
>
>    > mydf[2] |> unlist() |> unique() |> sort()
>    [1] "i" "s" "t" "z"
>    > mydf[1] |> unlist() |> unique() |> sort()
>    [1] 3 4 5
>
> The above takes a two-column data.frame and restricts it into a one-column data.frame and then passes the new temporary variable/object into the command line of the unlist() function which returns an object (again temporary) which is a  vector (in one case numeric and in the other character) and then that result is passed into the command line of unique() which returns a shorter vector in the same order and then you pass it on to sort() which reorders it.
>
> Note the first steps can be shortened if using the "[[" notation or by using the named way of asking for a column:
>
>    > mydf[[1]] |> unique() |> sort()
>    [1] 3 4 5
>    > mydf$ints |> unique() |> sort()
>    [1] 3 4 5
>
> But pipelines are simply syntactic sugar mostly so you also can just nest function calls as in sort(unique(unlist(mydf[1]))) or do what I showed earlier of creating a function that does the work invisibly and call that.
>
> Python often does their own version of pipelines by adding a dot at the end and calling a method and if needed another dot and then calling a method on the resulting object and so on. But that is arguably more limiting in some ways and more powerful in others. Different paradigms. In R, you do not do object.method1.method2(args).method3(args) so a pieline method is used to sort of so something related.
>
> Now if your need was to do your operation on an entire data.frame at once, then sometimes you will find a way to do it easily and sometimes use things like functional programming techniques. It is so common to calculate the sums or means of columns in a data.frame (or matrix) that functions like rowSums() and colSums() and colMeans() are available in R. But they also allow fairly arbitrary things to be done too as in the lapply() family of functions that applies an arbitrary function perhaps including arguments, like:
>
> lapply(mydf, max)
>
> sapply(mydf, `[`, 2)
>
> The latter takes the second value in each and every column of the data.frame and when possible, consolidates the results. Of course the uniqueness criterion when producing uneven numbers of results, does not simplify. Below I show how you can do many things including nested methods:
>
>
>    > lapply(mydf, sort)
>    $ints
>    [1] 3 3 4 4 5 5
>    
>    $chars
>    [1] "i" "i" "s" "t" "t" "z"
>    
>    > lapply(lapply(mydf, sort), unique)
>    $ints
>    [1] 3 4 5
>    
>    $chars
>    [1] "i" "s" "t" "z"
>    
>    > lapply(lapply(mydf, unique), sort)
>    $ints
>    [1] 3 4 5
>    
>    $chars
>    [1] "i" "s" "t" "z"
>
>    > lapply(lapply(lapply(mydf, unique), sort), toupper)
>    $ints
>    [1] "3" "4" "5"
>    
>    $chars
>    [1] "I" "S" "T" "Z"
>
> R has plenty of other such primitives that allow you to compose things many ways including other variants like Filter and Reduce and pmap and so on, with way more in various packages.
>
> It is simply wrong to insist that a language you are not very familiar with is not able to (often fairly easily) do all kinds of things.
>
> Back to your question, if I may, I think one of my earlier posts on this topic suggested another. Use factors which are part of base-R to perform the unique() for you and then extract the unique levels and re-order them by sorting.
>
>    > sort(levels(factor(mydf[[1]])))
>    [1] "3" "4" "5"
>    > sort(levels(factor(mydf[[2]])))
>    [1] "i" "s" "t" "z"
>
> But note this converts everything to characters so a numeric may need to be converted back, and yes, the sorting is not done numerically.
>
> Generally, there are oodles of ways to do anything. If this were Python, you might create an object that maintains a sorted set for example but that just hides the complexity as the various methods of the underlying object have to carefully deal keeping track of the current order and dealing with how things are added into the right place or tightening up the data structure if something is removed all the time. Others simply supply a sorted() method to use only when you actually need that. R can be done in similar ways and you can create objects of quite a few kinds to implement some things but it does not often seem necessary, at least to me.
>
> I can imagine writing a function that makes a data.frame even from vectors of unequal length by calculating the length of the longest vector and then setting each shorter vector to be longer with code like:
>
> length(a) <- longest
>
> You can then patch together all the results into a data.frame with trailing NA values on some columns.
>
> I quickly cobbled together a few lines that can do that and can be placed inside a function to return this:
>
>    lapply(lapply(lapply(mydf, unique), sort), toupper) -> uneven
>    longest <- max(unlist(lapply(uneven, length)))
>    answer <- data.frame(lapply(uneven, `length<-`, longest))
>    print(answer)
>
>    ints chars
> 1    3     I
> 2    4     S
> 3    5     T
> 4 <NA>     Z
>
> Now this has a single NA but I suggest generalizes well to a more complex example:
>
>     ints lower upper
> 1    10     k     Z
> 2     9     j     A
> 3     8     i     Z
> 4     7     h     A
> 5     6     g     Z
> 6     5     f     A
> 7     4     h     Z
> 8     3     i     A
> 9     2     j     Z
> 10    1     k     A
> 11    2     l     Z
> 12    3     m     A
>
> These are uneven and three columns so I tried a function version:
>
>    mydf2 <- data.frame(ints = c(10:1, 2:3),
>                        lower = c(letters[11:6], letters[8:13]),
>                        upper = rep(c("Z", "A"), 6))
>    
>    unisortuneven <- function(anydf) {
>      uneven <- lapply(lapply(lapply(anydf, unique), sort), toupper)
>      longest <- max(unlist(lapply(uneven, length)))
>      data.frame(lapply(uneven, `length<-`, longest))
>    }
>    
>    unisortuneven(mydf2)
>    ints lower upper
>    1     1     F     A
>    2     2     G     Z
>    3     3     H  <NA>
>      4     4     I  <NA>
>      5     5     J  <NA>
>      6     6     K  <NA>
>      7     7     L  <NA>
>      8     8     M  <NA>
>      9     9  <NA>  <NA>
>      10   10  <NA>  <NA>
>      
>      The above does not format great for text, sadly, so is better shown as the transpose for display purposes:
>
>    > t(unisortuneven(mydf2))
>    [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
>    ints  "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10"
>    lower "F"  "G"  "H"  "I"  "J"  "K"  "L"  "M"  NA   NA
>    upper "A"  "Z"  NA   NA   NA   NA   NA   NA   NA   NA
>
> But hopefully it makes my point that a little thinking and KNOWING about features of R like how to use a functionalized version of length() that sets a changed value using the odd notation of `length<-` can let you solve all kinds of problems in a somewhat abstract manner. Of course the above function is not refined and will not handle some useful transformations or deal with errors. That can make it quite a bit harder and in some cases, make it a good idea to find someone sharing a package where they did the hard work and documented exactly what their function does.
>
> I am eclectic and happy to switch tools at a moment's notice if they offer an interesting way to do something. But, within a language, I learn the darn rules and also the idioms often used and then choose from among many ways I can see to solve something and use what is available.  You had a trivial solution available to you to simply do one step at a time and save intermediate values, transforming at times. Some of us have sent you more general solutions. Do you still think what you want is so much harder to do in R, or that perhaps you are not thinking in R and thus want it to do it some other way other languages do?
>
>
>
>
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson, DSL via R-help
> Sent: Tuesday, December 21, 2021 10:16 AM
> To: Rui Barradas <ruipbarradas at sapo.pt>; Stephen H. Dawson, DSL via R-help <r-help at r-project.org>
> Subject: Re: [R] Adding SORT to UNIQUE
>
> Thanks everyone for the replies.
>
> It is clear one either needs to write a function or put the unique entries into another dataframe.
>
> It seems odd R cannot sort a list of unique column entries with ease.
> Python and SQL can do it with ease.
>
> QUESTION
> Is there a simpler means than other than the unique function to capture distinct column entries, then sort that list?
>
>
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
>
> On 12/20/21 5:53 PM, Rui Barradas wrote:
>> Hello,
>>
>> Inline.
>>
>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>> Thanks.
>>>
>>> sort(unique(Data[[1]]))
>>>
>>> This syntax provides row numbers, not column values.
>> This is not right.
>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>> extracts the column vector.
>>
>> As for my previous answer, it was not addressing the question, I
>> misinterpreted it as being a question on how to sort by numeric order
>> when the data is not numeric. Here is a, hopefully, complete answer.
>> Still with package stringr.
>>
>>
>> cols_to_sort <- 1:4
>>
>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>    stringr::str_sort(unique(x), numeric = TRUE)
>> })
>>
>>
>> Or using Avi's suggestion of writing a function to do all the work and
>> simplify the lapply loop later,
>>
>>
>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>>
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>> Hi,
>>>>
>>>>
>>>> Running a simple syntax set to review entries in dataframe columns.
>>>> Here is the working code.
>>>>
>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>> describe(Data)
>>>> summary(Data)
>>>> unique(Data[1])
>>>> unique(Data[2])
>>>> unique(Data[3])
>>>> unique(Data[4])
>>>>
>>>> I would like to add sort the unique entries. The data in the various
>>>> columns are not defined as numbers, but also text. I realize 1 and
>>>> 10 will not sort properly, as the column is not defined as a number,
>>>> but want to see what I have in the columns viewed as sorted.
>>>>
>>>> QUESTION
>>>> What is the best process to sort unique output, please?
>>>>
>>>>
>>>> Thanks.
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From @erv|ce @end|ng |rom @hd@w@on@com  Wed Dec 22 16:55:22 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Wed, 22 Dec 2021 10:55:22 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <dead8a81-9ad7-2df3-f97c-ff8fb3f1b903@gmail.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <8f4efdcb-57bc-2922-7f96-753af38d1c0b@shdawson.com>
 <dead8a81-9ad7-2df3-f97c-ff8fb3f1b903@gmail.com>
Message-ID: <f99ab582-0902-614a-3824-1dc606b944c1@shdawson.com>

I see.

So, we are talking taking the output into a new dataframe. I was hoping 
to have the output rendered on screen without another dataframe, but I 
can live with this option it if must occur.

Am I correct the desired vertical output must first go to a dataframe?


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/22/21 10:47 AM, Duncan Murdoch wrote:
> On 22/12/2021 10:20 a.m., Stephen H. Dawson, DSL wrote:
>> Thanks for the reply.
>>
>> Both syntax options work to render the correct (unique) output. However,
>> the output is rendered as horizontal. What needs to happen to get the
>> output to render vertical, please?
>
> The result of those expressions is a vector of the same type as the 
> column, so your question is really about how to get a vector to print 
> one element per line.
>
> Probably the simplest way is to put the vector in a dataframe (or 
> matrix, or tibble, depending on which formatting you prefer).? For 
> example,
>
> >?? v <- c("red", "green", "blue")
> >?? data.frame(v)
> ????? v
> 1?? red
> 2 green
> 3? blue
>
> If you want a more minimal display, try
>
> > cat(v, sep = "\n")
> red
> green
> blue
>
> or
>
> > cat(format(v, justify = "right"), sep = "\n")
> ? red
> green
> ?blue
>
> If you want this to happen when you auto-print the object, you can 
> give it a class attribute and write a function to print that class, e.g.
>
> >? class(v) <- "oneperline"
> >
> >?? print.oneperline <- function(x, ...) cat(format(x, justify = 
> "right"), sep = "\n")
> >
> >?? v
> ? red
> green
> ?blue
>
> Duncan Murdoch
>
>>
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 12/21/21 11:38 AM, Duncan Murdoch wrote:
>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>> Thanks for the reply.
>>>>>
>>>>> sort(unique(Data[1]))
>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
>>>>> decreasing)) :
>>>>> ??? ? undefined columns selected
>>>>
>>>> That's the wrong syntax:? Data[1] is not "column one of Data". Use
>>>> Data[[1]] for that, so
>>>>
>>>> ???? sort(unique(Data[[1]]))
>>>
>>> Actually, I'd probably recommend
>>>
>>> ?? sort(unique(Data[, 1]))
>>>
>>> instead.? This treats Data as a matrix rather than as a list.
>>> Dataframes are lists that look like matrices, but to me the matrix
>>> aspect is usually more intuitive.
>>>
>>> Duncan Murdoch
>>>
>>>>
>>>> I think Rui already pointed out the typo in the quoted text below...
>>>>
>>>> Duncan Murdoch
>>>>
>>>>>
>>>>> The recommended syntax did not work, as listed above.
>>>>>
>>>>> What I want is the sort of distinct column output. Again, the column
>>>>> may
>>>>> be text or numbers. This is a huge analysis effort with data 
>>>>> coming at
>>>>> me from many different sources.
>>>>>
>>>>>
>>>>> *Stephen Dawson, DSL*
>>>>> /Executive Strategy Consultant/
>>>>> Business & Technology
>>>>> +1 (865) 804-3454
>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>
>>>>>
>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>>>>>> Thanks everyone for the replies.
>>>>>>>
>>>>>>> It is clear one either needs to write a function or put the unique
>>>>>>> entries into another dataframe.
>>>>>>>
>>>>>>> It seems odd R cannot sort a list of unique column entries with 
>>>>>>> ease.
>>>>>>> Python and SQL can do it with ease.
>>>>>>
>>>>>> I've seen several responses that looked pretty simple. It's hard to
>>>>>> beat sort(unique(x)), though there's a fair bit of confusion about
>>>>>> what you actually want.? Maybe you should post an example of the 
>>>>>> code
>>>>>> you'd use in Python?
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>>
>>>>>>> QUESTION
>>>>>>> Is there a simpler means than other than the unique function to
>>>>>>> capture
>>>>>>> distinct column entries, then sort that list?
>>>>>>>
>>>>>>>
>>>>>>> *Stephen Dawson, DSL*
>>>>>>> /Executive Strategy Consultant/
>>>>>>> Business & Technology
>>>>>>> +1 (865) 804-3454
>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>
>>>>>>>
>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>> Hello,
>>>>>>>>
>>>>>>>> Inline.
>>>>>>>>
>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>>>>>>> Thanks.
>>>>>>>>>
>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>
>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>
>>>>>>>> This is not right.
>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>>>>>>>> extracts the column vector.
>>>>>>>>
>>>>>>>> As for my previous answer, it was not addressing the question, I
>>>>>>>> misinterpreted it as being a question on how to sort by numeric
>>>>>>>> order
>>>>>>>> when the data is not numeric. Here is a, hopefully, complete 
>>>>>>>> answer.
>>>>>>>> Still with package stringr.
>>>>>>>>
>>>>>>>>
>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>
>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>> ?? ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>> })
>>>>>>>>
>>>>>>>>
>>>>>>>> Or using Avi's suggestion of writing a function to do all the
>>>>>>>> work and
>>>>>>>> simplify the lapply loop later,
>>>>>>>>
>>>>>>>>
>>>>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>
>>>>>>>>
>>>>>>>> Hope this helps,
>>>>>>>>
>>>>>>>> Rui Barradas
>>>>>>>>
>>>>>>>>
>>>>>>>>>
>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>> Business & Technology
>>>>>>>>> +1 (865) 804-3454
>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>>> Hi,
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Running a simple syntax set to review entries in dataframe
>>>>>>>>>> columns.
>>>>>>>>>> Here is the working code.
>>>>>>>>>>
>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>> describe(Data)
>>>>>>>>>> summary(Data)
>>>>>>>>>> unique(Data[1])
>>>>>>>>>> unique(Data[2])
>>>>>>>>>> unique(Data[3])
>>>>>>>>>> unique(Data[4])
>>>>>>>>>>
>>>>>>>>>> I would like to add sort the unique entries. The data in the
>>>>>>>>>> various
>>>>>>>>>> columns are not defined as numbers, but also text. I realize 
>>>>>>>>>> 1 and
>>>>>>>>>> 10 will not sort properly, as the column is not defined as a
>>>>>>>>>> number,
>>>>>>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>>>>>>
>>>>>>>>>> QUESTION
>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Thanks.
>>>>>>>>>
>>>>>>>>> ______________________________________________
>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>> and provide commented, minimal, self-contained, reproducible 
>>>>>>>>> code.
>>>>>>>>
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>> PLEASE do read the posting guide
>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>
>>>
>>>
>>
>
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Dec 22 17:08:06 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 22 Dec 2021 11:08:06 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <f99ab582-0902-614a-3824-1dc606b944c1@shdawson.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <8f4efdcb-57bc-2922-7f96-753af38d1c0b@shdawson.com>
 <dead8a81-9ad7-2df3-f97c-ff8fb3f1b903@gmail.com>
 <f99ab582-0902-614a-3824-1dc606b944c1@shdawson.com>
Message-ID: <36bb5a89-42fa-9108-4798-3d3ac5698d1e@gmail.com>

On 22/12/2021 10:55 a.m., Stephen H. Dawson, DSL wrote:
> I see.
> 
> So, we are talking taking the output into a new dataframe. I was hoping
> to have the output rendered on screen without another dataframe, but I
> can live with this option it if must occur.
> 
> Am I correct the desired vertical output must first go to a dataframe?

No, that's just one option.  The other 3 don't use dataframes.

Duncan Murdoch
> 
> 
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
> 
> 
> On 12/22/21 10:47 AM, Duncan Murdoch wrote:
>> On 22/12/2021 10:20 a.m., Stephen H. Dawson, DSL wrote:
>>> Thanks for the reply.
>>>
>>> Both syntax options work to render the correct (unique) output. However,
>>> the output is rendered as horizontal. What needs to happen to get the
>>> output to render vertical, please?
>>
>> The result of those expressions is a vector of the same type as the
>> column, so your question is really about how to get a vector to print
>> one element per line.
>>
>> Probably the simplest way is to put the vector in a dataframe (or
>> matrix, or tibble, depending on which formatting you prefer).? For
>> example,
>>
>>>  ?? v <- c("red", "green", "blue")
>>>  ?? data.frame(v)
>>  ????? v
>> 1?? red
>> 2 green
>> 3? blue
>>
>> If you want a more minimal display, try
>>
>>> cat(v, sep = "\n")
>> red
>> green
>> blue
>>
>> or
>>
>>> cat(format(v, justify = "right"), sep = "\n")
>>  ? red
>> green
>>  ?blue
>>
>> If you want this to happen when you auto-print the object, you can
>> give it a class attribute and write a function to print that class, e.g.
>>
>>>  ? class(v) <- "oneperline"
>>>
>>>  ?? print.oneperline <- function(x, ...) cat(format(x, justify =
>> "right"), sep = "\n")
>>>
>>>  ?? v
>>  ? red
>> green
>>  ?blue
>>
>> Duncan Murdoch
>>
>>>
>>>
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 12/21/21 11:38 AM, Duncan Murdoch wrote:
>>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>> Thanks for the reply.
>>>>>>
>>>>>> sort(unique(Data[1]))
>>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
>>>>>> decreasing)) :
>>>>>>  ??? ? undefined columns selected
>>>>>
>>>>> That's the wrong syntax:? Data[1] is not "column one of Data". Use
>>>>> Data[[1]] for that, so
>>>>>
>>>>>  ???? sort(unique(Data[[1]]))
>>>>
>>>> Actually, I'd probably recommend
>>>>
>>>>  ?? sort(unique(Data[, 1]))
>>>>
>>>> instead.? This treats Data as a matrix rather than as a list.
>>>> Dataframes are lists that look like matrices, but to me the matrix
>>>> aspect is usually more intuitive.
>>>>
>>>> Duncan Murdoch
>>>>
>>>>>
>>>>> I think Rui already pointed out the typo in the quoted text below...
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>>
>>>>>> The recommended syntax did not work, as listed above.
>>>>>>
>>>>>> What I want is the sort of distinct column output. Again, the column
>>>>>> may
>>>>>> be text or numbers. This is a huge analysis effort with data
>>>>>> coming at
>>>>>> me from many different sources.
>>>>>>
>>>>>>
>>>>>> *Stephen Dawson, DSL*
>>>>>> /Executive Strategy Consultant/
>>>>>> Business & Technology
>>>>>> +1 (865) 804-3454
>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>
>>>>>>
>>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>> Thanks everyone for the replies.
>>>>>>>>
>>>>>>>> It is clear one either needs to write a function or put the unique
>>>>>>>> entries into another dataframe.
>>>>>>>>
>>>>>>>> It seems odd R cannot sort a list of unique column entries with
>>>>>>>> ease.
>>>>>>>> Python and SQL can do it with ease.
>>>>>>>
>>>>>>> I've seen several responses that looked pretty simple. It's hard to
>>>>>>> beat sort(unique(x)), though there's a fair bit of confusion about
>>>>>>> what you actually want.? Maybe you should post an example of the
>>>>>>> code
>>>>>>> you'd use in Python?
>>>>>>>
>>>>>>> Duncan Murdoch
>>>>>>>
>>>>>>>>
>>>>>>>> QUESTION
>>>>>>>> Is there a simpler means than other than the unique function to
>>>>>>>> capture
>>>>>>>> distinct column entries, then sort that list?
>>>>>>>>
>>>>>>>>
>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>> /Executive Strategy Consultant/
>>>>>>>> Business & Technology
>>>>>>>> +1 (865) 804-3454
>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>
>>>>>>>>
>>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>>> Hello,
>>>>>>>>>
>>>>>>>>> Inline.
>>>>>>>>>
>>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>>>>>>>> Thanks.
>>>>>>>>>>
>>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>>
>>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>>
>>>>>>>>> This is not right.
>>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>>>>>>>>> extracts the column vector.
>>>>>>>>>
>>>>>>>>> As for my previous answer, it was not addressing the question, I
>>>>>>>>> misinterpreted it as being a question on how to sort by numeric
>>>>>>>>> order
>>>>>>>>> when the data is not numeric. Here is a, hopefully, complete
>>>>>>>>> answer.
>>>>>>>>> Still with package stringr.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>>
>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>>>  ?? ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>>> })
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Or using Avi's suggestion of writing a function to do all the
>>>>>>>>> work and
>>>>>>>>> simplify the lapply loop later,
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Hope this helps,
>>>>>>>>>
>>>>>>>>> Rui Barradas
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>>> Business & Technology
>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>>>> Hi,
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Running a simple syntax set to review entries in dataframe
>>>>>>>>>>> columns.
>>>>>>>>>>> Here is the working code.
>>>>>>>>>>>
>>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>>> describe(Data)
>>>>>>>>>>> summary(Data)
>>>>>>>>>>> unique(Data[1])
>>>>>>>>>>> unique(Data[2])
>>>>>>>>>>> unique(Data[3])
>>>>>>>>>>> unique(Data[4])
>>>>>>>>>>>
>>>>>>>>>>> I would like to add sort the unique entries. The data in the
>>>>>>>>>>> various
>>>>>>>>>>> columns are not defined as numbers, but also text. I realize
>>>>>>>>>>> 1 and
>>>>>>>>>>> 10 will not sort properly, as the column is not defined as a
>>>>>>>>>>> number,
>>>>>>>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>>>>>>>
>>>>>>>>>>> QUESTION
>>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Thanks.
>>>>>>>>>>
>>>>>>>>>> ______________________________________________
>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>> and provide commented, minimal, self-contained, reproducible
>>>>>>>>>> code.
>>>>>>>>>
>>>>>>>>
>>>>>>>> ______________________________________________
>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>> PLEASE do read the posting guide
>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>>
>>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>
>>>>
>>>
>>
>>
>


From @erv|ce @end|ng |rom @hd@w@on@com  Wed Dec 22 17:13:29 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Wed, 22 Dec 2021 11:13:29 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <36bb5a89-42fa-9108-4798-3d3ac5698d1e@gmail.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <8f4efdcb-57bc-2922-7f96-753af38d1c0b@shdawson.com>
 <dead8a81-9ad7-2df3-f97c-ff8fb3f1b903@gmail.com>
 <f99ab582-0902-614a-3824-1dc606b944c1@shdawson.com>
 <36bb5a89-42fa-9108-4798-3d3ac5698d1e@gmail.com>
Message-ID: <b375b182-bdfb-171d-76e9-8bad2686f0dc@shdawson.com>

OK, now I get what you are suggesting.

Much appreciated.


Kindest Regards,
*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/22/21 11:08 AM, Duncan Murdoch wrote:
> On 22/12/2021 10:55 a.m., Stephen H. Dawson, DSL wrote:
>> I see.
>>
>> So, we are talking taking the output into a new dataframe. I was hoping
>> to have the output rendered on screen without another dataframe, but I
>> can live with this option it if must occur.
>>
>> Am I correct the desired vertical output must first go to a dataframe?
>
> No, that's just one option.? The other 3 don't use dataframes.
>
> Duncan Murdoch
>>
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 12/22/21 10:47 AM, Duncan Murdoch wrote:
>>> On 22/12/2021 10:20 a.m., Stephen H. Dawson, DSL wrote:
>>>> Thanks for the reply.
>>>>
>>>> Both syntax options work to render the correct (unique) output. 
>>>> However,
>>>> the output is rendered as horizontal. What needs to happen to get the
>>>> output to render vertical, please?
>>>
>>> The result of those expressions is a vector of the same type as the
>>> column, so your question is really about how to get a vector to print
>>> one element per line.
>>>
>>> Probably the simplest way is to put the vector in a dataframe (or
>>> matrix, or tibble, depending on which formatting you prefer). For
>>> example,
>>>
>>>> ??? v <- c("red", "green", "blue")
>>>> ??? data.frame(v)
>>> ?????? v
>>> 1?? red
>>> 2 green
>>> 3? blue
>>>
>>> If you want a more minimal display, try
>>>
>>>> cat(v, sep = "\n")
>>> red
>>> green
>>> blue
>>>
>>> or
>>>
>>>> cat(format(v, justify = "right"), sep = "\n")
>>> ?? red
>>> green
>>> ??blue
>>>
>>> If you want this to happen when you auto-print the object, you can
>>> give it a class attribute and write a function to print that class, 
>>> e.g.
>>>
>>>> ?? class(v) <- "oneperline"
>>>>
>>>> ??? print.oneperline <- function(x, ...) cat(format(x, justify =
>>> "right"), sep = "\n")
>>>>
>>>> ??? v
>>> ?? red
>>> green
>>> ??blue
>>>
>>> Duncan Murdoch
>>>
>>>>
>>>>
>>>> *Stephen Dawson, DSL*
>>>> /Executive Strategy Consultant/
>>>> Business & Technology
>>>> +1 (865) 804-3454
>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>
>>>>
>>>> On 12/21/21 11:38 AM, Duncan Murdoch wrote:
>>>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>>> Thanks for the reply.
>>>>>>>
>>>>>>> sort(unique(Data[1]))
>>>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
>>>>>>> decreasing)) :
>>>>>>> ???? ? undefined columns selected
>>>>>>
>>>>>> That's the wrong syntax:? Data[1] is not "column one of Data". Use
>>>>>> Data[[1]] for that, so
>>>>>>
>>>>>> ????? sort(unique(Data[[1]]))
>>>>>
>>>>> Actually, I'd probably recommend
>>>>>
>>>>> ??? sort(unique(Data[, 1]))
>>>>>
>>>>> instead.? This treats Data as a matrix rather than as a list.
>>>>> Dataframes are lists that look like matrices, but to me the matrix
>>>>> aspect is usually more intuitive.
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>>
>>>>>> I think Rui already pointed out the typo in the quoted text below...
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>>
>>>>>>> The recommended syntax did not work, as listed above.
>>>>>>>
>>>>>>> What I want is the sort of distinct column output. Again, the 
>>>>>>> column
>>>>>>> may
>>>>>>> be text or numbers. This is a huge analysis effort with data
>>>>>>> coming at
>>>>>>> me from many different sources.
>>>>>>>
>>>>>>>
>>>>>>> *Stephen Dawson, DSL*
>>>>>>> /Executive Strategy Consultant/
>>>>>>> Business & Technology
>>>>>>> +1 (865) 804-3454
>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>
>>>>>>>
>>>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>> Thanks everyone for the replies.
>>>>>>>>>
>>>>>>>>> It is clear one either needs to write a function or put the 
>>>>>>>>> unique
>>>>>>>>> entries into another dataframe.
>>>>>>>>>
>>>>>>>>> It seems odd R cannot sort a list of unique column entries with
>>>>>>>>> ease.
>>>>>>>>> Python and SQL can do it with ease.
>>>>>>>>
>>>>>>>> I've seen several responses that looked pretty simple. It's 
>>>>>>>> hard to
>>>>>>>> beat sort(unique(x)), though there's a fair bit of confusion about
>>>>>>>> what you actually want.? Maybe you should post an example of the
>>>>>>>> code
>>>>>>>> you'd use in Python?
>>>>>>>>
>>>>>>>> Duncan Murdoch
>>>>>>>>
>>>>>>>>>
>>>>>>>>> QUESTION
>>>>>>>>> Is there a simpler means than other than the unique function to
>>>>>>>>> capture
>>>>>>>>> distinct column entries, then sort that list?
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>> Business & Technology
>>>>>>>>> +1 (865) 804-3454
>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>>>> Hello,
>>>>>>>>>>
>>>>>>>>>> Inline.
>>>>>>>>>>
>>>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help 
>>>>>>>>>> escreveu:
>>>>>>>>>>> Thanks.
>>>>>>>>>>>
>>>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>>>
>>>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>>>
>>>>>>>>>> This is not right.
>>>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax 
>>>>>>>>>> Data[[1]]
>>>>>>>>>> extracts the column vector.
>>>>>>>>>>
>>>>>>>>>> As for my previous answer, it was not addressing the question, I
>>>>>>>>>> misinterpreted it as being a question on how to sort by numeric
>>>>>>>>>> order
>>>>>>>>>> when the data is not numeric. Here is a, hopefully, complete
>>>>>>>>>> answer.
>>>>>>>>>> Still with package stringr.
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>>>
>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>>>> ??? ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>>>> })
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Or using Avi's suggestion of writing a function to do all the
>>>>>>>>>> work and
>>>>>>>>>> simplify the lapply loop later,
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), 
>>>>>>>>>> ...)
>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Hope this helps,
>>>>>>>>>>
>>>>>>>>>> Rui Barradas
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>>>> Business & Technology
>>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>>>>> Hi,
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Running a simple syntax set to review entries in dataframe
>>>>>>>>>>>> columns.
>>>>>>>>>>>> Here is the working code.
>>>>>>>>>>>>
>>>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>>>> describe(Data)
>>>>>>>>>>>> summary(Data)
>>>>>>>>>>>> unique(Data[1])
>>>>>>>>>>>> unique(Data[2])
>>>>>>>>>>>> unique(Data[3])
>>>>>>>>>>>> unique(Data[4])
>>>>>>>>>>>>
>>>>>>>>>>>> I would like to add sort the unique entries. The data in the
>>>>>>>>>>>> various
>>>>>>>>>>>> columns are not defined as numbers, but also text. I realize
>>>>>>>>>>>> 1 and
>>>>>>>>>>>> 10 will not sort properly, as the column is not defined as a
>>>>>>>>>>>> number,
>>>>>>>>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>>>>>>>>
>>>>>>>>>>>> QUESTION
>>>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Thanks.
>>>>>>>>>>>
>>>>>>>>>>> ______________________________________________
>>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and 
>>>>>>>>>>> more, see
>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>>> and provide commented, minimal, self-contained, reproducible
>>>>>>>>>>> code.
>>>>>>>>>>
>>>>>>>>>
>>>>>>>>> ______________________________________________
>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>> and provide commented, minimal, self-contained, reproducible 
>>>>>>>>> code.
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>
>>>
>>>
>>
>
>


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Dec 22 17:57:57 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 22 Dec 2021 16:57:57 +0000
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <f99ab582-0902-614a-3824-1dc606b944c1@shdawson.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <8f4efdcb-57bc-2922-7f96-753af38d1c0b@shdawson.com>
 <dead8a81-9ad7-2df3-f97c-ff8fb3f1b903@gmail.com>
 <f99ab582-0902-614a-3824-1dc606b944c1@shdawson.com>
Message-ID: <735eb6cb-cc27-e741-432a-2c4318cbe73a@sapo.pt>

Hello,

The problem is that the vectors of unique values in each column of the 
original data.frame Data need not be same length. And the output of 
sort(unique(.)) is a list of vectors of different lengths. And lists 
print "horizontally", each vector on its own.

Like Duncan said, one of the ways of getting a vertical display is to 
have the list of sorted, unique values be of a custom class and write a 
print method for that class. Here is an example of this. The function to 
sort outputs an object of a class that sub-classes class "list". And a 
print method takes care of the printing. This method creates a temp 
data.frame, prints that df and invisibly returns its input.

# Create a test data set
set.seed(2021)
Data <- replicate(4, as.character(sample(20, 20, TRUE)))
Data <- as.data.frame(Data)


# Now the functions
sort_unique <- function(x){
   y <- lapply(x, \(.x) stringr::str_sort(unique(.x), numeric = TRUE))
   old_class <- class(y)
   class(y) <- c("sortUnique", old_class)
   y
}
print.sortUnique <- function(x, ...){
   n <- max(lengths(x))
   y <- lapply(x, \(.x) c(.x, rep("", n - length(.x))))
   y <- do.call(cbind.data.frame, y)
   names(y) <- names(x)
   print(y)
   invisible(x)
}

# Test the functions above
Data2 <- sort_unique(Data)

class(Data2)
Data2
print(Data2)


Hope this helps,

Rui Barradas

?s 15:55 de 22/12/21, Stephen H. Dawson, DSL escreveu:
> I see.
> 
> So, we are talking taking the output into a new dataframe. I was hoping 
> to have the output rendered on screen without another dataframe, but I 
> can live with this option it if must occur.
> 
> Am I correct the desired vertical output must first go to a dataframe?
> 
> 
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
> 
> 
> On 12/22/21 10:47 AM, Duncan Murdoch wrote:
>> On 22/12/2021 10:20 a.m., Stephen H. Dawson, DSL wrote:
>>> Thanks for the reply.
>>>
>>> Both syntax options work to render the correct (unique) output. However,
>>> the output is rendered as horizontal. What needs to happen to get the
>>> output to render vertical, please?
>>
>> The result of those expressions is a vector of the same type as the 
>> column, so your question is really about how to get a vector to print 
>> one element per line.
>>
>> Probably the simplest way is to put the vector in a dataframe (or 
>> matrix, or tibble, depending on which formatting you prefer).? For 
>> example,
>>
>> >?? v <- c("red", "green", "blue")
>> >?? data.frame(v)
>> ????? v
>> 1?? red
>> 2 green
>> 3? blue
>>
>> If you want a more minimal display, try
>>
>> > cat(v, sep = "\n")
>> red
>> green
>> blue
>>
>> or
>>
>> > cat(format(v, justify = "right"), sep = "\n")
>> ? red
>> green
>> ?blue
>>
>> If you want this to happen when you auto-print the object, you can 
>> give it a class attribute and write a function to print that class, e.g.
>>
>> >? class(v) <- "oneperline"
>> >
>> >?? print.oneperline <- function(x, ...) cat(format(x, justify = 
>> "right"), sep = "\n")
>> >
>> >?? v
>> ? red
>> green
>> ?blue
>>
>> Duncan Murdoch
>>
>>>
>>>
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 12/21/21 11:38 AM, Duncan Murdoch wrote:
>>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>> Thanks for the reply.
>>>>>>
>>>>>> sort(unique(Data[1]))
>>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
>>>>>> decreasing)) :
>>>>>> ??? ? undefined columns selected
>>>>>
>>>>> That's the wrong syntax:? Data[1] is not "column one of Data". Use
>>>>> Data[[1]] for that, so
>>>>>
>>>>> ???? sort(unique(Data[[1]]))
>>>>
>>>> Actually, I'd probably recommend
>>>>
>>>> ?? sort(unique(Data[, 1]))
>>>>
>>>> instead.? This treats Data as a matrix rather than as a list.
>>>> Dataframes are lists that look like matrices, but to me the matrix
>>>> aspect is usually more intuitive.
>>>>
>>>> Duncan Murdoch
>>>>
>>>>>
>>>>> I think Rui already pointed out the typo in the quoted text below...
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>>
>>>>>> The recommended syntax did not work, as listed above.
>>>>>>
>>>>>> What I want is the sort of distinct column output. Again, the column
>>>>>> may
>>>>>> be text or numbers. This is a huge analysis effort with data 
>>>>>> coming at
>>>>>> me from many different sources.
>>>>>>
>>>>>>
>>>>>> *Stephen Dawson, DSL*
>>>>>> /Executive Strategy Consultant/
>>>>>> Business & Technology
>>>>>> +1 (865) 804-3454
>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>
>>>>>>
>>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>> Thanks everyone for the replies.
>>>>>>>>
>>>>>>>> It is clear one either needs to write a function or put the unique
>>>>>>>> entries into another dataframe.
>>>>>>>>
>>>>>>>> It seems odd R cannot sort a list of unique column entries with 
>>>>>>>> ease.
>>>>>>>> Python and SQL can do it with ease.
>>>>>>>
>>>>>>> I've seen several responses that looked pretty simple. It's hard to
>>>>>>> beat sort(unique(x)), though there's a fair bit of confusion about
>>>>>>> what you actually want.? Maybe you should post an example of the 
>>>>>>> code
>>>>>>> you'd use in Python?
>>>>>>>
>>>>>>> Duncan Murdoch
>>>>>>>
>>>>>>>>
>>>>>>>> QUESTION
>>>>>>>> Is there a simpler means than other than the unique function to
>>>>>>>> capture
>>>>>>>> distinct column entries, then sort that list?
>>>>>>>>
>>>>>>>>
>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>> /Executive Strategy Consultant/
>>>>>>>> Business & Technology
>>>>>>>> +1 (865) 804-3454
>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>
>>>>>>>>
>>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>>> Hello,
>>>>>>>>>
>>>>>>>>> Inline.
>>>>>>>>>
>>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>>>>>>>> Thanks.
>>>>>>>>>>
>>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>>
>>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>>
>>>>>>>>> This is not right.
>>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax Data[[1]]
>>>>>>>>> extracts the column vector.
>>>>>>>>>
>>>>>>>>> As for my previous answer, it was not addressing the question, I
>>>>>>>>> misinterpreted it as being a question on how to sort by numeric
>>>>>>>>> order
>>>>>>>>> when the data is not numeric. Here is a, hopefully, complete 
>>>>>>>>> answer.
>>>>>>>>> Still with package stringr.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>>
>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>>> ?? ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>>> })
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Or using Avi's suggestion of writing a function to do all the
>>>>>>>>> work and
>>>>>>>>> simplify the lapply loop later,
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), ...)
>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Hope this helps,
>>>>>>>>>
>>>>>>>>> Rui Barradas
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>>> Business & Technology
>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>>>> Hi,
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Running a simple syntax set to review entries in dataframe
>>>>>>>>>>> columns.
>>>>>>>>>>> Here is the working code.
>>>>>>>>>>>
>>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>>> describe(Data)
>>>>>>>>>>> summary(Data)
>>>>>>>>>>> unique(Data[1])
>>>>>>>>>>> unique(Data[2])
>>>>>>>>>>> unique(Data[3])
>>>>>>>>>>> unique(Data[4])
>>>>>>>>>>>
>>>>>>>>>>> I would like to add sort the unique entries. The data in the
>>>>>>>>>>> various
>>>>>>>>>>> columns are not defined as numbers, but also text. I realize 
>>>>>>>>>>> 1 and
>>>>>>>>>>> 10 will not sort properly, as the column is not defined as a
>>>>>>>>>>> number,
>>>>>>>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>>>>>>>
>>>>>>>>>>> QUESTION
>>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Thanks.
>>>>>>>>>>
>>>>>>>>>> ______________________________________________
>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>> and provide commented, minimal, self-contained, reproducible 
>>>>>>>>>> code.
>>>>>>>>>
>>>>>>>>
>>>>>>>> ______________________________________________
>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>> PLEASE do read the posting guide
>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>>
>>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>
>>>>
>>>
>>
>>
>


From y@ngk@|9999 @end|ng |rom y@hoo@com  Wed Dec 22 17:58:18 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Wed, 22 Dec 2021 16:58:18 +0000 (UTC)
Subject: [R] for loop question in R
References: <2122195934.369982.1640192298494.ref@mail.yahoo.com>
Message-ID: <2122195934.369982.1640192298494@mail.yahoo.com>

Hello R team,I want to use for loop to generate multiple plots with 3 parameter, (y is for y axis, c is for color and f is for file name in output). I created a data frame to save the information and use the information in for loop. I use y[i], c[i] and f[i] in the loop, but it seems doesn't work. Can anyone correct my code to make it work?
Thanks,Kai

library(ggplot2)library(tidyverse)
y <- c("hwy","cty")c <- c("cyl","class")f <- c("hwy_cyl","cty_class")
mac <- data.frame(y,c,f)
for (i in nrow(mac)){? mpg %>%? ? filter(hwy <35) %>%?? ? ggplot(aes(x = displ, y = y[i], color = c[i])) +?? ? geom_point()? ggsave("c:/temp/f[i].jpg",width = 9, height = 6, dpi = 1200, units = "in")}

	[[alternative HTML version deleted]]


From @v|gro@@ @end|ng |rom ver|zon@net  Wed Dec 22 17:59:35 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Wed, 22 Dec 2021 11:59:35 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <f99ab582-0902-614a-3824-1dc606b944c1@shdawson.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <8f4efdcb-57bc-2922-7f96-753af38d1c0b@shdawson.com>
 <dead8a81-9ad7-2df3-f97c-ff8fb3f1b903@gmail.com>
 <f99ab582-0902-614a-3824-1dc606b944c1@shdawson.com>
Message-ID: <00f201d7f755$4cb0b950$e6122bf0$@verizon.net>

Stephen,

Understanding a bit better where you are coming from, I come back to how people think about things. Languages like R often focus on doing things incrementally. I don't mean the language exactly as much as many of the people using the language.

So it is perfectly normal to make multiple versions of something as you go along and let older versions no longer in use be garbage collected if needed.

Your latest question was how to display your data a certain way. You want it written down the screen (or paper) rather than across. Duncan provided you with a few of the many ways to do that. Unless you are working with giant amounts of data already using up most of your available memory, it is fairly harmless to make some temporary copies that get you what you want.

What you may not have known is that some of the systems in R use a concept of generic functions. In particular, when you use print() or just put a variable name on a line by itself which normally implicitly calls print() for you, it does not just magically print but examines what you asked to print and does a lookup to see  how to print it. My setup currently has 303 such methods defined with names like print.factor and print.Date and print.data.frame that are given control to print each kind of object the way you want. So one way to change how something is printed is to make it into an object for some class and let the system then print it. Of course, you can also design a new class of your own and make a print method for it and I suspect someone has done what you want in some package.

Changing the class of an existing object, even a large object, is fairly inexpensive. Other attributes can also control things like "dim" specifying dimensions. Say I have a vector containing 1:5 that I want to print vertically.

> vec <- 1:5

  > vec
  [1] 1 2 3 4 5

You can see it normally prints horizontally. Transposing it might sound like a good way to go except R vectors generally do not have the concept. Transposing a vector will make a matrix which prints a biut differently but is still horizontal, but a second transpose works beter:

  > class(t(vec))
  [1] "matrix" "array" 
 
 > t(vec)
  [,1] [,2] [,3] [,4] [,5]
  [1,]    1    2    3    4    5
  
> t(t(vec))
  [,1]
  [1,]    1
  [2,]    2
  [3,]    3
  [4,]    4
  [5,]    5

Of course, you can probably as easily make it a matrix:

  > as.matrix(vec)
  [,1]
  [1,]    1
  [2,]    2
  [3,]    3
  [4,]    4
  [5,]    5
  
  > matrix(vec, ncol=1)
  [,1]
  [1,]    1
  [2,]    2
  [3,]    3
  [4,]    4
  [5,]    5

The above made a copy, of course.

You can change the original into a matrix by just changing an attribute:

  > dim(vec) <- c(length(vec), 1)

  > vec
  [,1]
  [1,]    1
  [2,]    2
  [3,]    3
  [4,]    4
  [5,]    5

  > attributes(vec)
  $dim
  [1] 5 1
  
  > class(vec)
  [1] "matrix" "array"

BUT you need to be careful as in your earlier experience. Some places that accept a vector will not accept a 1-column or 1-row matrix, or a data.frame with one column or just one row. Best to be careful about mixing.

So look again at what Duncan sent and some are quite nice. You can speficically use the cat() command instead of a default print and it has added functionality. Various packages exist including some that do various kinds of pretty printing.

He left out one of the simplest ones, which is simply to write your own print routine such as this loop:

Here you define a trivial one-line function that calls print() multiple times to make your output vertical:

vertprint <- function(horiz) for (item in horiz) print(item)

for (item in horiz) print(item)

  [1] 1
  [1] 2
  [1] 3
  [1] 4
  [1] 5

Obviously if you are printing huge amounts of data, this is not necessarily any more efficient. But it does not necessarily make many copies of your data if that bothers you.

May I end with a suggestion. It can be fun to start a discussion in a place like this but it can also be a waste of time for many people, especially those who provide longer answers and do some experimenting to illustrate. Often a simple search like the following can rapidly get you an answer before feeling the need to ask here. I did a simple search just now for what I assumed was a very frequent question:

"R how to print data vertically"

I looked at a few of the answers and noted a few other suggestions with one similar but different:

cat(paste(x),sep="\n")

And of course various packages that implemented something like print.vertical().

Your earlier statement suggests you may be interested in what is the canonical or best way and by now, you may note there are very often MANY ways and some programmers prefer one or another. And, I note, after enough questions of a fairly basic or even na?ve nature, some responders in these groups stop responding for some reason.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson, DSL via R-help
Sent: Wednesday, December 22, 2021 10:55 AM
To: Duncan Murdoch <murdoch.duncan at gmail.com>; Rui Barradas <ruipbarradas at sapo.pt>; Stephen H. Dawson, DSL via R-help <r-help at r-project.org>
Subject: Re: [R] Adding SORT to UNIQUE

I see.

So, we are talking taking the output into a new dataframe. I was hoping to have the output rendered on screen without another dataframe, but I can live with this option it if must occur.

Am I correct the desired vertical output must first go to a dataframe?


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/22/21 10:47 AM, Duncan Murdoch wrote:
> On 22/12/2021 10:20 a.m., Stephen H. Dawson, DSL wrote:
>> Thanks for the reply.
>>
>> Both syntax options work to render the correct (unique) output. 
>> However, the output is rendered as horizontal. What needs to happen 
>> to get the output to render vertical, please?
>
> The result of those expressions is a vector of the same type as the 
> column, so your question is really about how to get a vector to print 
> one element per line.
>
> Probably the simplest way is to put the vector in a dataframe (or 
> matrix, or tibble, depending on which formatting you prefer).  For 
> example,
>
> >   v <- c("red", "green", "blue")
> >   data.frame(v)
>       v
> 1   red
> 2 green
> 3  blue
>
> If you want a more minimal display, try
>
> > cat(v, sep = "\n")
> red
> green
> blue
>
> or
>
> > cat(format(v, justify = "right"), sep = "\n")
>   red
> green
>  blue
>
> If you want this to happen when you auto-print the object, you can 
> give it a class attribute and write a function to print that class, e.g.
>
> >  class(v) <- "oneperline"
> >
> >   print.oneperline <- function(x, ...) cat(format(x, justify =
> "right"), sep = "\n")
> >
> >   v
>   red
> green
>  blue
>
> Duncan Murdoch
>
>>
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 12/21/21 11:38 AM, Duncan Murdoch wrote:
>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>> Thanks for the reply.
>>>>>
>>>>> sort(unique(Data[1]))
>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing 
>>>>> =
>>>>> decreasing)) :
>>>>>       undefined columns selected
>>>>
>>>> That's the wrong syntax:  Data[1] is not "column one of Data". Use 
>>>> Data[[1]] for that, so
>>>>
>>>>      sort(unique(Data[[1]]))
>>>
>>> Actually, I'd probably recommend
>>>
>>>    sort(unique(Data[, 1]))
>>>
>>> instead.  This treats Data as a matrix rather than as a list.
>>> Dataframes are lists that look like matrices, but to me the matrix 
>>> aspect is usually more intuitive.
>>>
>>> Duncan Murdoch
>>>
>>>>
>>>> I think Rui already pointed out the typo in the quoted text below...
>>>>
>>>> Duncan Murdoch
>>>>
>>>>>
>>>>> The recommended syntax did not work, as listed above.
>>>>>
>>>>> What I want is the sort of distinct column output. Again, the 
>>>>> column may be text or numbers. This is a huge analysis effort with 
>>>>> data coming at me from many different sources.
>>>>>
>>>>>
>>>>> *Stephen Dawson, DSL*
>>>>> /Executive Strategy Consultant/
>>>>> Business & Technology
>>>>> +1 (865) 804-3454
>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>
>>>>>
>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>>>>>> Thanks everyone for the replies.
>>>>>>>
>>>>>>> It is clear one either needs to write a function or put the 
>>>>>>> unique entries into another dataframe.
>>>>>>>
>>>>>>> It seems odd R cannot sort a list of unique column entries with 
>>>>>>> ease.
>>>>>>> Python and SQL can do it with ease.
>>>>>>
>>>>>> I've seen several responses that looked pretty simple. It's hard 
>>>>>> to beat sort(unique(x)), though there's a fair bit of confusion 
>>>>>> about what you actually want.  Maybe you should post an example 
>>>>>> of the code you'd use in Python?
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>>
>>>>>>> QUESTION
>>>>>>> Is there a simpler means than other than the unique function to 
>>>>>>> capture distinct column entries, then sort that list?
>>>>>>>
>>>>>>>
>>>>>>> *Stephen Dawson, DSL*
>>>>>>> /Executive Strategy Consultant/
>>>>>>> Business & Technology
>>>>>>> +1 (865) 804-3454
>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>
>>>>>>>
>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>> Hello,
>>>>>>>>
>>>>>>>> Inline.
>>>>>>>>
>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>>>>>>> Thanks.
>>>>>>>>>
>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>
>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>
>>>>>>>> This is not right.
>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax 
>>>>>>>> Data[[1]] extracts the column vector.
>>>>>>>>
>>>>>>>> As for my previous answer, it was not addressing the question, 
>>>>>>>> I misinterpreted it as being a question on how to sort by 
>>>>>>>> numeric order when the data is not numeric. Here is a, 
>>>>>>>> hopefully, complete answer.
>>>>>>>> Still with package stringr.
>>>>>>>>
>>>>>>>>
>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>
>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>>       stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>> })
>>>>>>>>
>>>>>>>>
>>>>>>>> Or using Avi's suggestion of writing a function to do all the 
>>>>>>>> work and simplify the lapply loop later,
>>>>>>>>
>>>>>>>>
>>>>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), 
>>>>>>>> ...)
>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>
>>>>>>>>
>>>>>>>> Hope this helps,
>>>>>>>>
>>>>>>>> Rui Barradas
>>>>>>>>
>>>>>>>>
>>>>>>>>>
>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>> /Executive Strategy Consultant/ Business & Technology
>>>>>>>>> +1 (865) 804-3454
>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>>> Hi,
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Running a simple syntax set to review entries in dataframe 
>>>>>>>>>> columns.
>>>>>>>>>> Here is the working code.
>>>>>>>>>>
>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>> describe(Data)
>>>>>>>>>> summary(Data)
>>>>>>>>>> unique(Data[1])
>>>>>>>>>> unique(Data[2])
>>>>>>>>>> unique(Data[3])
>>>>>>>>>> unique(Data[4])
>>>>>>>>>>
>>>>>>>>>> I would like to add sort the unique entries. The data in the 
>>>>>>>>>> various columns are not defined as numbers, but also text. I 
>>>>>>>>>> realize
>>>>>>>>>> 1 and
>>>>>>>>>> 10 will not sort properly, as the column is not defined as a 
>>>>>>>>>> number, but want to see what I have in the columns viewed as 
>>>>>>>>>> sorted.
>>>>>>>>>>
>>>>>>>>>> QUESTION
>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Thanks.
>>>>>>>>>
>>>>>>>>> ______________________________________________
>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, 
>>>>>>>>> see https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>> PLEASE do read the posting guide 
>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>> and provide commented, minimal, self-contained, reproducible 
>>>>>>>>> code.
>>>>>>>>
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, 
>>>>>>> see https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>> PLEASE do read the posting guide 
>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>
>>>
>>>
>>
>
>

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From @erv|ce @end|ng |rom @hd@w@on@com  Wed Dec 22 18:01:49 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Wed, 22 Dec 2021 12:01:49 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <b375b182-bdfb-171d-76e9-8bad2686f0dc@shdawson.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <8f4efdcb-57bc-2922-7f96-753af38d1c0b@shdawson.com>
 <dead8a81-9ad7-2df3-f97c-ff8fb3f1b903@gmail.com>
 <f99ab582-0902-614a-3824-1dc606b944c1@shdawson.com>
 <36bb5a89-42fa-9108-4798-3d3ac5698d1e@gmail.com>
 <b375b182-bdfb-171d-76e9-8bad2686f0dc@shdawson.com>
Message-ID: <46338490-263d-d026-2017-333f61734646@shdawson.com>

Data <- read.csv("./input/Source.csv", header=T)
v1 <- sort(unique(Data[, 1]))
cat(format(v1, justify = "right"), sep = "\n")

OK, working with the options you presented. This is the combination 
where I gain the most benefit.

However, there is no listing of a column header with the output of this 
syntax.

 > cat(format(v1, justify = "right"), sep = "\n")
 ?2
 ?3
 ?4
 ?5
 ?6
 ?7
 ?8
 ?9
10
 >

NOTE
The output here is correct (unique) based on the entries from the column.

QUESTION
How does one add a text label of something as simple as v1 to the 
vertical output of this syntax, please?

*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/22/21 11:13 AM, Stephen H. Dawson, DSL via R-help wrote:
> OK, now I get what you are suggesting.
>
> Much appreciated.
>
>
> Kindest Regards,
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
>
> On 12/22/21 11:08 AM, Duncan Murdoch wrote:
>> On 22/12/2021 10:55 a.m., Stephen H. Dawson, DSL wrote:
>>> I see.
>>>
>>> So, we are talking taking the output into a new dataframe. I was hoping
>>> to have the output rendered on screen without another dataframe, but I
>>> can live with this option it if must occur.
>>>
>>> Am I correct the desired vertical output must first go to a dataframe?
>>
>> No, that's just one option.? The other 3 don't use dataframes.
>>
>> Duncan Murdoch
>>>
>>>
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 12/22/21 10:47 AM, Duncan Murdoch wrote:
>>>> On 22/12/2021 10:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>> Thanks for the reply.
>>>>>
>>>>> Both syntax options work to render the correct (unique) output. 
>>>>> However,
>>>>> the output is rendered as horizontal. What needs to happen to get the
>>>>> output to render vertical, please?
>>>>
>>>> The result of those expressions is a vector of the same type as the
>>>> column, so your question is really about how to get a vector to print
>>>> one element per line.
>>>>
>>>> Probably the simplest way is to put the vector in a dataframe (or
>>>> matrix, or tibble, depending on which formatting you prefer). For
>>>> example,
>>>>
>>>>> ??? v <- c("red", "green", "blue")
>>>>> ??? data.frame(v)
>>>> ?????? v
>>>> 1?? red
>>>> 2 green
>>>> 3? blue
>>>>
>>>> If you want a more minimal display, try
>>>>
>>>>> cat(v, sep = "\n")
>>>> red
>>>> green
>>>> blue
>>>>
>>>> or
>>>>
>>>>> cat(format(v, justify = "right"), sep = "\n")
>>>> ?? red
>>>> green
>>>> ??blue
>>>>
>>>> If you want this to happen when you auto-print the object, you can
>>>> give it a class attribute and write a function to print that class, 
>>>> e.g.
>>>>
>>>>> ?? class(v) <- "oneperline"
>>>>>
>>>>> ??? print.oneperline <- function(x, ...) cat(format(x, justify =
>>>> "right"), sep = "\n")
>>>>>
>>>>> ??? v
>>>> ?? red
>>>> green
>>>> ??blue
>>>>
>>>> Duncan Murdoch
>>>>
>>>>>
>>>>>
>>>>> *Stephen Dawson, DSL*
>>>>> /Executive Strategy Consultant/
>>>>> Business & Technology
>>>>> +1 (865) 804-3454
>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>
>>>>>
>>>>> On 12/21/21 11:38 AM, Duncan Murdoch wrote:
>>>>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>>>> Thanks for the reply.
>>>>>>>>
>>>>>>>> sort(unique(Data[1]))
>>>>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last, 
>>>>>>>> decreasing =
>>>>>>>> decreasing)) :
>>>>>>>> ???? ? undefined columns selected
>>>>>>>
>>>>>>> That's the wrong syntax:? Data[1] is not "column one of Data". Use
>>>>>>> Data[[1]] for that, so
>>>>>>>
>>>>>>> ????? sort(unique(Data[[1]]))
>>>>>>
>>>>>> Actually, I'd probably recommend
>>>>>>
>>>>>> ??? sort(unique(Data[, 1]))
>>>>>>
>>>>>> instead.? This treats Data as a matrix rather than as a list.
>>>>>> Dataframes are lists that look like matrices, but to me the matrix
>>>>>> aspect is usually more intuitive.
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>>
>>>>>>> I think Rui already pointed out the typo in the quoted text 
>>>>>>> below...
>>>>>>>
>>>>>>> Duncan Murdoch
>>>>>>>
>>>>>>>>
>>>>>>>> The recommended syntax did not work, as listed above.
>>>>>>>>
>>>>>>>> What I want is the sort of distinct column output. Again, the 
>>>>>>>> column
>>>>>>>> may
>>>>>>>> be text or numbers. This is a huge analysis effort with data
>>>>>>>> coming at
>>>>>>>> me from many different sources.
>>>>>>>>
>>>>>>>>
>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>> /Executive Strategy Consultant/
>>>>>>>> Business & Technology
>>>>>>>> +1 (865) 804-3454
>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>
>>>>>>>>
>>>>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help 
>>>>>>>>> wrote:
>>>>>>>>>> Thanks everyone for the replies.
>>>>>>>>>>
>>>>>>>>>> It is clear one either needs to write a function or put the 
>>>>>>>>>> unique
>>>>>>>>>> entries into another dataframe.
>>>>>>>>>>
>>>>>>>>>> It seems odd R cannot sort a list of unique column entries with
>>>>>>>>>> ease.
>>>>>>>>>> Python and SQL can do it with ease.
>>>>>>>>>
>>>>>>>>> I've seen several responses that looked pretty simple. It's 
>>>>>>>>> hard to
>>>>>>>>> beat sort(unique(x)), though there's a fair bit of confusion 
>>>>>>>>> about
>>>>>>>>> what you actually want.? Maybe you should post an example of the
>>>>>>>>> code
>>>>>>>>> you'd use in Python?
>>>>>>>>>
>>>>>>>>> Duncan Murdoch
>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> QUESTION
>>>>>>>>>> Is there a simpler means than other than the unique function to
>>>>>>>>>> capture
>>>>>>>>>> distinct column entries, then sort that list?
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>>> Business & Technology
>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>>>>> Hello,
>>>>>>>>>>>
>>>>>>>>>>> Inline.
>>>>>>>>>>>
>>>>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help 
>>>>>>>>>>> escreveu:
>>>>>>>>>>>> Thanks.
>>>>>>>>>>>>
>>>>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>>>>
>>>>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>>>>
>>>>>>>>>>> This is not right.
>>>>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax 
>>>>>>>>>>> Data[[1]]
>>>>>>>>>>> extracts the column vector.
>>>>>>>>>>>
>>>>>>>>>>> As for my previous answer, it was not addressing the 
>>>>>>>>>>> question, I
>>>>>>>>>>> misinterpreted it as being a question on how to sort by numeric
>>>>>>>>>>> order
>>>>>>>>>>> when the data is not numeric. Here is a, hopefully, complete
>>>>>>>>>>> answer.
>>>>>>>>>>> Still with package stringr.
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>>>>
>>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>>>>> ??? ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>>>>> })
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Or using Avi's suggestion of writing a function to do all the
>>>>>>>>>>> work and
>>>>>>>>>>> simplify the lapply loop later,
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> unisort2 <- function(vec, ...) 
>>>>>>>>>>> stringr::str_sort(unique(vec), ...)
>>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Hope this helps,
>>>>>>>>>>>
>>>>>>>>>>> Rui Barradas
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>>>>> Business & Technology
>>>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>>>>>> Hi,
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Running a simple syntax set to review entries in dataframe
>>>>>>>>>>>>> columns.
>>>>>>>>>>>>> Here is the working code.
>>>>>>>>>>>>>
>>>>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>>>>> describe(Data)
>>>>>>>>>>>>> summary(Data)
>>>>>>>>>>>>> unique(Data[1])
>>>>>>>>>>>>> unique(Data[2])
>>>>>>>>>>>>> unique(Data[3])
>>>>>>>>>>>>> unique(Data[4])
>>>>>>>>>>>>>
>>>>>>>>>>>>> I would like to add sort the unique entries. The data in the
>>>>>>>>>>>>> various
>>>>>>>>>>>>> columns are not defined as numbers, but also text. I realize
>>>>>>>>>>>>> 1 and
>>>>>>>>>>>>> 10 will not sort properly, as the column is not defined as a
>>>>>>>>>>>>> number,
>>>>>>>>>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>>>>>>>>>
>>>>>>>>>>>>> QUESTION
>>>>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Thanks.
>>>>>>>>>>>>
>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and 
>>>>>>>>>>>> more, see
>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>>>> and provide commented, minimal, self-contained, reproducible
>>>>>>>>>>>> code.
>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> ______________________________________________
>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, 
>>>>>>>>>> see
>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>> and provide commented, minimal, self-contained, reproducible 
>>>>>>>>>> code.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>
>>>>
>>>
>>
>>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From @erv|ce @end|ng |rom @hd@w@on@com  Wed Dec 22 18:03:39 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Wed, 22 Dec 2021 12:03:39 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <735eb6cb-cc27-e741-432a-2c4318cbe73a@sapo.pt>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <8f4efdcb-57bc-2922-7f96-753af38d1c0b@shdawson.com>
 <dead8a81-9ad7-2df3-f97c-ff8fb3f1b903@gmail.com>
 <f99ab582-0902-614a-3824-1dc606b944c1@shdawson.com>
 <735eb6cb-cc27-e741-432a-2c4318cbe73a@sapo.pt>
Message-ID: <2fa3459a-d4a4-2a78-9a8b-bfd849e5ee54@shdawson.com>

Wow! Thanks.

I need to process the logic you have presented next week when I have the 
time to focus. I now need to accomplish some productive work output 
based on what I have now for understandings.


Kindest Regards,
*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/22/21 11:57 AM, Rui Barradas wrote:
> Hello,
>
> The problem is that the vectors of unique values in each column of the 
> original data.frame Data need not be same length. And the output of 
> sort(unique(.)) is a list of vectors of different lengths. And lists 
> print "horizontally", each vector on its own.
>
> Like Duncan said, one of the ways of getting a vertical display is to 
> have the list of sorted, unique values be of a custom class and write 
> a print method for that class. Here is an example of this. The 
> function to sort outputs an object of a class that sub-classes class 
> "list". And a print method takes care of the printing. This method 
> creates a temp data.frame, prints that df and invisibly returns its 
> input.
>
> # Create a test data set
> set.seed(2021)
> Data <- replicate(4, as.character(sample(20, 20, TRUE)))
> Data <- as.data.frame(Data)
>
>
> # Now the functions
> sort_unique <- function(x){
> ? y <- lapply(x, \(.x) stringr::str_sort(unique(.x), numeric = TRUE))
> ? old_class <- class(y)
> ? class(y) <- c("sortUnique", old_class)
> ? y
> }
> print.sortUnique <- function(x, ...){
> ? n <- max(lengths(x))
> ? y <- lapply(x, \(.x) c(.x, rep("", n - length(.x))))
> ? y <- do.call(cbind.data.frame, y)
> ? names(y) <- names(x)
> ? print(y)
> ? invisible(x)
> }
>
> # Test the functions above
> Data2 <- sort_unique(Data)
>
> class(Data2)
> Data2
> print(Data2)
>
>
> Hope this helps,
>
> Rui Barradas
>
> ?s 15:55 de 22/12/21, Stephen H. Dawson, DSL escreveu:
>> I see.
>>
>> So, we are talking taking the output into a new dataframe. I was 
>> hoping to have the output rendered on screen without another 
>> dataframe, but I can live with this option it if must occur.
>>
>> Am I correct the desired vertical output must first go to a dataframe?
>>
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 12/22/21 10:47 AM, Duncan Murdoch wrote:
>>> On 22/12/2021 10:20 a.m., Stephen H. Dawson, DSL wrote:
>>>> Thanks for the reply.
>>>>
>>>> Both syntax options work to render the correct (unique) output. 
>>>> However,
>>>> the output is rendered as horizontal. What needs to happen to get the
>>>> output to render vertical, please?
>>>
>>> The result of those expressions is a vector of the same type as the 
>>> column, so your question is really about how to get a vector to 
>>> print one element per line.
>>>
>>> Probably the simplest way is to put the vector in a dataframe (or 
>>> matrix, or tibble, depending on which formatting you prefer).? For 
>>> example,
>>>
>>> >?? v <- c("red", "green", "blue")
>>> >?? data.frame(v)
>>> ????? v
>>> 1?? red
>>> 2 green
>>> 3? blue
>>>
>>> If you want a more minimal display, try
>>>
>>> > cat(v, sep = "\n")
>>> red
>>> green
>>> blue
>>>
>>> or
>>>
>>> > cat(format(v, justify = "right"), sep = "\n")
>>> ? red
>>> green
>>> ?blue
>>>
>>> If you want this to happen when you auto-print the object, you can 
>>> give it a class attribute and write a function to print that class, 
>>> e.g.
>>>
>>> >? class(v) <- "oneperline"
>>> >
>>> >?? print.oneperline <- function(x, ...) cat(format(x, justify = 
>>> "right"), sep = "\n")
>>> >
>>> >?? v
>>> ? red
>>> green
>>> ?blue
>>>
>>> Duncan Murdoch
>>>
>>>>
>>>>
>>>> *Stephen Dawson, DSL*
>>>> /Executive Strategy Consultant/
>>>> Business & Technology
>>>> +1 (865) 804-3454
>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>
>>>>
>>>> On 12/21/21 11:38 AM, Duncan Murdoch wrote:
>>>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>>> Thanks for the reply.
>>>>>>>
>>>>>>> sort(unique(Data[1]))
>>>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing =
>>>>>>> decreasing)) :
>>>>>>> ??? ? undefined columns selected
>>>>>>
>>>>>> That's the wrong syntax:? Data[1] is not "column one of Data". Use
>>>>>> Data[[1]] for that, so
>>>>>>
>>>>>> ???? sort(unique(Data[[1]]))
>>>>>
>>>>> Actually, I'd probably recommend
>>>>>
>>>>> ?? sort(unique(Data[, 1]))
>>>>>
>>>>> instead.? This treats Data as a matrix rather than as a list.
>>>>> Dataframes are lists that look like matrices, but to me the matrix
>>>>> aspect is usually more intuitive.
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>>
>>>>>> I think Rui already pointed out the typo in the quoted text below...
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>>
>>>>>>> The recommended syntax did not work, as listed above.
>>>>>>>
>>>>>>> What I want is the sort of distinct column output. Again, the 
>>>>>>> column
>>>>>>> may
>>>>>>> be text or numbers. This is a huge analysis effort with data 
>>>>>>> coming at
>>>>>>> me from many different sources.
>>>>>>>
>>>>>>>
>>>>>>> *Stephen Dawson, DSL*
>>>>>>> /Executive Strategy Consultant/
>>>>>>> Business & Technology
>>>>>>> +1 (865) 804-3454
>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>
>>>>>>>
>>>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>> Thanks everyone for the replies.
>>>>>>>>>
>>>>>>>>> It is clear one either needs to write a function or put the 
>>>>>>>>> unique
>>>>>>>>> entries into another dataframe.
>>>>>>>>>
>>>>>>>>> It seems odd R cannot sort a list of unique column entries 
>>>>>>>>> with ease.
>>>>>>>>> Python and SQL can do it with ease.
>>>>>>>>
>>>>>>>> I've seen several responses that looked pretty simple. It's 
>>>>>>>> hard to
>>>>>>>> beat sort(unique(x)), though there's a fair bit of confusion about
>>>>>>>> what you actually want.? Maybe you should post an example of 
>>>>>>>> the code
>>>>>>>> you'd use in Python?
>>>>>>>>
>>>>>>>> Duncan Murdoch
>>>>>>>>
>>>>>>>>>
>>>>>>>>> QUESTION
>>>>>>>>> Is there a simpler means than other than the unique function to
>>>>>>>>> capture
>>>>>>>>> distinct column entries, then sort that list?
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>> Business & Technology
>>>>>>>>> +1 (865) 804-3454
>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>>>> Hello,
>>>>>>>>>>
>>>>>>>>>> Inline.
>>>>>>>>>>
>>>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help 
>>>>>>>>>> escreveu:
>>>>>>>>>>> Thanks.
>>>>>>>>>>>
>>>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>>>
>>>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>>>
>>>>>>>>>> This is not right.
>>>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax 
>>>>>>>>>> Data[[1]]
>>>>>>>>>> extracts the column vector.
>>>>>>>>>>
>>>>>>>>>> As for my previous answer, it was not addressing the question, I
>>>>>>>>>> misinterpreted it as being a question on how to sort by numeric
>>>>>>>>>> order
>>>>>>>>>> when the data is not numeric. Here is a, hopefully, complete 
>>>>>>>>>> answer.
>>>>>>>>>> Still with package stringr.
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>>>
>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>>>> ?? ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>>>> })
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Or using Avi's suggestion of writing a function to do all the
>>>>>>>>>> work and
>>>>>>>>>> simplify the lapply loop later,
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec), 
>>>>>>>>>> ...)
>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> Hope this helps,
>>>>>>>>>>
>>>>>>>>>> Rui Barradas
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>>>> Business & Technology
>>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>>>>> Hi,
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Running a simple syntax set to review entries in dataframe
>>>>>>>>>>>> columns.
>>>>>>>>>>>> Here is the working code.
>>>>>>>>>>>>
>>>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>>>> describe(Data)
>>>>>>>>>>>> summary(Data)
>>>>>>>>>>>> unique(Data[1])
>>>>>>>>>>>> unique(Data[2])
>>>>>>>>>>>> unique(Data[3])
>>>>>>>>>>>> unique(Data[4])
>>>>>>>>>>>>
>>>>>>>>>>>> I would like to add sort the unique entries. The data in the
>>>>>>>>>>>> various
>>>>>>>>>>>> columns are not defined as numbers, but also text. I 
>>>>>>>>>>>> realize 1 and
>>>>>>>>>>>> 10 will not sort properly, as the column is not defined as a
>>>>>>>>>>>> number,
>>>>>>>>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>>>>>>>>
>>>>>>>>>>>> QUESTION
>>>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Thanks.
>>>>>>>>>>>
>>>>>>>>>>> ______________________________________________
>>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and 
>>>>>>>>>>> more, see
>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>>> and provide commented, minimal, self-contained, reproducible 
>>>>>>>>>>> code.
>>>>>>>>>>
>>>>>>>>>
>>>>>>>>> ______________________________________________
>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>> and provide commented, minimal, self-contained, reproducible 
>>>>>>>>> code.
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>
>>>
>>>
>>
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Dec 22 18:12:57 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 22 Dec 2021 12:12:57 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <46338490-263d-d026-2017-333f61734646@shdawson.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <8f4efdcb-57bc-2922-7f96-753af38d1c0b@shdawson.com>
 <dead8a81-9ad7-2df3-f97c-ff8fb3f1b903@gmail.com>
 <f99ab582-0902-614a-3824-1dc606b944c1@shdawson.com>
 <36bb5a89-42fa-9108-4798-3d3ac5698d1e@gmail.com>
 <b375b182-bdfb-171d-76e9-8bad2686f0dc@shdawson.com>
 <46338490-263d-d026-2017-333f61734646@shdawson.com>
Message-ID: <a3c5d12a-d598-efa7-f356-abfaf24cf27d@gmail.com>

On 22/12/2021 12:01 p.m., Stephen H. Dawson, DSL wrote:
> Data <- read.csv("./input/Source.csv", header=T)
> v1 <- sort(unique(Data[, 1]))
> cat(format(v1, justify = "right"), sep = "\n")
> 
> OK, working with the options you presented. This is the combination
> where I gain the most benefit.
> 
> However, there is no listing of a column header with the output of this
> syntax.
> 
>   > cat(format(v1, justify = "right"), sep = "\n")
>   ?2
>   ?3
>   ?4
>   ?5
>   ?6
>   ?7
>   ?8
>   ?9
> 10
>   >
> 
> NOTE
> The output here is correct (unique) based on the entries from the column.
> 
> QUESTION
> How does one add a text label of something as simple as v1 to the
> vertical output of this syntax, please?

In this case, you'd just put in cat("v1\n") before the given command.

In the general case where you want to get the name of the column from 
the dataframe, I think you'll need to write your own function.  The one 
Rui just posted looks pretty good.  To get it to print without the row 
numbers as in the example above, just change it a little in the header 
and one other line:

print.sortUnique <- function(x, row.names = FALSE, ...){
    n <- max(lengths(x))
    y <- lapply(x, \(.x) c(.x, rep("", n - length(.x))))
    y <- do.call(cbind.data.frame, y)
    names(y) <- names(x)
    print(y, row.names = row.names, ...)
    invisible(x)
}

This will give

 > Data2
  V1 V2 V3 V4
   3  2  2  1
   5  4  3  2
   6  5  4  4
   7  6  5  5
   8  9  6  6
   9 11  8  9
  12 15  9 10
  14 16 11 11
  15 17 14 12
  18 18 15 13
  19 19 17 14
  20    19 16
        20 18
           19

with his example data.

Duncan Murdoch


> 
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
> 
> 
> On 12/22/21 11:13 AM, Stephen H. Dawson, DSL via R-help wrote:
>> OK, now I get what you are suggesting.
>>
>> Much appreciated.
>>
>>
>> Kindest Regards,
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 12/22/21 11:08 AM, Duncan Murdoch wrote:
>>> On 22/12/2021 10:55 a.m., Stephen H. Dawson, DSL wrote:
>>>> I see.
>>>>
>>>> So, we are talking taking the output into a new dataframe. I was hoping
>>>> to have the output rendered on screen without another dataframe, but I
>>>> can live with this option it if must occur.
>>>>
>>>> Am I correct the desired vertical output must first go to a dataframe?
>>>
>>> No, that's just one option.? The other 3 don't use dataframes.
>>>
>>> Duncan Murdoch
>>>>
>>>>
>>>> *Stephen Dawson, DSL*
>>>> /Executive Strategy Consultant/
>>>> Business & Technology
>>>> +1 (865) 804-3454
>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>
>>>>
>>>> On 12/22/21 10:47 AM, Duncan Murdoch wrote:
>>>>> On 22/12/2021 10:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>> Thanks for the reply.
>>>>>>
>>>>>> Both syntax options work to render the correct (unique) output.
>>>>>> However,
>>>>>> the output is rendered as horizontal. What needs to happen to get the
>>>>>> output to render vertical, please?
>>>>>
>>>>> The result of those expressions is a vector of the same type as the
>>>>> column, so your question is really about how to get a vector to print
>>>>> one element per line.
>>>>>
>>>>> Probably the simplest way is to put the vector in a dataframe (or
>>>>> matrix, or tibble, depending on which formatting you prefer). For
>>>>> example,
>>>>>
>>>>>>  ??? v <- c("red", "green", "blue")
>>>>>>  ??? data.frame(v)
>>>>>  ?????? v
>>>>> 1?? red
>>>>> 2 green
>>>>> 3? blue
>>>>>
>>>>> If you want a more minimal display, try
>>>>>
>>>>>> cat(v, sep = "\n")
>>>>> red
>>>>> green
>>>>> blue
>>>>>
>>>>> or
>>>>>
>>>>>> cat(format(v, justify = "right"), sep = "\n")
>>>>>  ?? red
>>>>> green
>>>>>  ??blue
>>>>>
>>>>> If you want this to happen when you auto-print the object, you can
>>>>> give it a class attribute and write a function to print that class,
>>>>> e.g.
>>>>>
>>>>>>  ?? class(v) <- "oneperline"
>>>>>>
>>>>>>  ??? print.oneperline <- function(x, ...) cat(format(x, justify =
>>>>> "right"), sep = "\n")
>>>>>>
>>>>>>  ??? v
>>>>>  ?? red
>>>>> green
>>>>>  ??blue
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>>
>>>>>>
>>>>>> *Stephen Dawson, DSL*
>>>>>> /Executive Strategy Consultant/
>>>>>> Business & Technology
>>>>>> +1 (865) 804-3454
>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>
>>>>>>
>>>>>> On 12/21/21 11:38 AM, Duncan Murdoch wrote:
>>>>>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>>>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>>>>> Thanks for the reply.
>>>>>>>>>
>>>>>>>>> sort(unique(Data[1]))
>>>>>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last,
>>>>>>>>> decreasing =
>>>>>>>>> decreasing)) :
>>>>>>>>>  ???? ? undefined columns selected
>>>>>>>>
>>>>>>>> That's the wrong syntax:? Data[1] is not "column one of Data". Use
>>>>>>>> Data[[1]] for that, so
>>>>>>>>
>>>>>>>>  ????? sort(unique(Data[[1]]))
>>>>>>>
>>>>>>> Actually, I'd probably recommend
>>>>>>>
>>>>>>>  ??? sort(unique(Data[, 1]))
>>>>>>>
>>>>>>> instead.? This treats Data as a matrix rather than as a list.
>>>>>>> Dataframes are lists that look like matrices, but to me the matrix
>>>>>>> aspect is usually more intuitive.
>>>>>>>
>>>>>>> Duncan Murdoch
>>>>>>>
>>>>>>>>
>>>>>>>> I think Rui already pointed out the typo in the quoted text
>>>>>>>> below...
>>>>>>>>
>>>>>>>> Duncan Murdoch
>>>>>>>>
>>>>>>>>>
>>>>>>>>> The recommended syntax did not work, as listed above.
>>>>>>>>>
>>>>>>>>> What I want is the sort of distinct column output. Again, the
>>>>>>>>> column
>>>>>>>>> may
>>>>>>>>> be text or numbers. This is a huge analysis effort with data
>>>>>>>>> coming at
>>>>>>>>> me from many different sources.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>> Business & Technology
>>>>>>>>> +1 (865) 804-3454
>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help
>>>>>>>>>> wrote:
>>>>>>>>>>> Thanks everyone for the replies.
>>>>>>>>>>>
>>>>>>>>>>> It is clear one either needs to write a function or put the
>>>>>>>>>>> unique
>>>>>>>>>>> entries into another dataframe.
>>>>>>>>>>>
>>>>>>>>>>> It seems odd R cannot sort a list of unique column entries with
>>>>>>>>>>> ease.
>>>>>>>>>>> Python and SQL can do it with ease.
>>>>>>>>>>
>>>>>>>>>> I've seen several responses that looked pretty simple. It's
>>>>>>>>>> hard to
>>>>>>>>>> beat sort(unique(x)), though there's a fair bit of confusion
>>>>>>>>>> about
>>>>>>>>>> what you actually want.? Maybe you should post an example of the
>>>>>>>>>> code
>>>>>>>>>> you'd use in Python?
>>>>>>>>>>
>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> QUESTION
>>>>>>>>>>> Is there a simpler means than other than the unique function to
>>>>>>>>>>> capture
>>>>>>>>>>> distinct column entries, then sort that list?
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>>>> Business & Technology
>>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>>>>>> Hello,
>>>>>>>>>>>>
>>>>>>>>>>>> Inline.
>>>>>>>>>>>>
>>>>>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help
>>>>>>>>>>>> escreveu:
>>>>>>>>>>>>> Thanks.
>>>>>>>>>>>>>
>>>>>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>>>>>
>>>>>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>>>>>
>>>>>>>>>>>> This is not right.
>>>>>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax
>>>>>>>>>>>> Data[[1]]
>>>>>>>>>>>> extracts the column vector.
>>>>>>>>>>>>
>>>>>>>>>>>> As for my previous answer, it was not addressing the
>>>>>>>>>>>> question, I
>>>>>>>>>>>> misinterpreted it as being a question on how to sort by numeric
>>>>>>>>>>>> order
>>>>>>>>>>>> when the data is not numeric. Here is a, hopefully, complete
>>>>>>>>>>>> answer.
>>>>>>>>>>>> Still with package stringr.
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>>>>>
>>>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>>>>>>  ??? ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>>>>>> })
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Or using Avi's suggestion of writing a function to do all the
>>>>>>>>>>>> work and
>>>>>>>>>>>> simplify the lapply loop later,
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> unisort2 <- function(vec, ...)
>>>>>>>>>>>> stringr::str_sort(unique(vec), ...)
>>>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Hope this helps,
>>>>>>>>>>>>
>>>>>>>>>>>> Rui Barradas
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>>>>>> Business & Technology
>>>>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>>>>>>> Hi,
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Running a simple syntax set to review entries in dataframe
>>>>>>>>>>>>>> columns.
>>>>>>>>>>>>>> Here is the working code.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>>>>>> describe(Data)
>>>>>>>>>>>>>> summary(Data)
>>>>>>>>>>>>>> unique(Data[1])
>>>>>>>>>>>>>> unique(Data[2])
>>>>>>>>>>>>>> unique(Data[3])
>>>>>>>>>>>>>> unique(Data[4])
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> I would like to add sort the unique entries. The data in the
>>>>>>>>>>>>>> various
>>>>>>>>>>>>>> columns are not defined as numbers, but also text. I realize
>>>>>>>>>>>>>> 1 and
>>>>>>>>>>>>>> 10 will not sort properly, as the column is not defined as a
>>>>>>>>>>>>>> number,
>>>>>>>>>>>>>> but want to see what I have in the columns viewed as sorted.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> QUESTION
>>>>>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Thanks.
>>>>>>>>>>>>>
>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and
>>>>>>>>>>>>> more, see
>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>>>>> and provide commented, minimal, self-contained, reproducible
>>>>>>>>>>>>> code.
>>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> ______________________________________________
>>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more,
>>>>>>>>>>> see
>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>>> and provide commented, minimal, self-contained, reproducible
>>>>>>>>>>> code.
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>
>>>
>>>
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>


From @kw@|mmo @end|ng |rom gm@||@com  Wed Dec 22 18:18:17 2021
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Wed, 22 Dec 2021 12:18:17 -0500
Subject: [R] for loop question in R
In-Reply-To: <2122195934.369982.1640192298494@mail.yahoo.com>
References: <2122195934.369982.1640192298494.ref@mail.yahoo.com>
 <2122195934.369982.1640192298494@mail.yahoo.com>
Message-ID: <CAPcHnpS+HequR8ML8jHMtSEby0vt9gfiHK681K0WpRKFqYT5tg@mail.gmail.com>

nrow() is just the numbers of rows in your data frame, use seq_len(nrow())
or seq(nrow()) to loop through all row numbers

On Wed, Dec 22, 2021, 12:08 Kai Yang via R-help <r-help at r-project.org>
wrote:

> Hello R team,I want to use for loop to generate multiple plots with 3
> parameter, (y is for y axis, c is for color and f is for file name in
> output). I created a data frame to save the information and use the
> information in for loop. I use y[i], c[i] and f[i] in the loop, but it
> seems doesn't work. Can anyone correct my code to make it work?
> Thanks,Kai
>
> library(ggplot2)library(tidyverse)
> y <- c("hwy","cty")c <- c("cyl","class")f <- c("hwy_cyl","cty_class")
> mac <- data.frame(y,c,f)
> for (i in nrow(mac)){  mpg %>%    filter(hwy <35) %>%     ggplot(aes(x =
> displ, y = y[i], color = c[i])) +     geom_point()
> ggsave("c:/temp/f[i].jpg",width = 9, height = 6, dpi = 1200, units = "in")}
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Wed Dec 22 18:19:07 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Wed, 22 Dec 2021 19:19:07 +0200
Subject: [R] for loop question in R
In-Reply-To: <2122195934.369982.1640192298494@mail.yahoo.com>
References: <2122195934.369982.1640192298494.ref@mail.yahoo.com>
 <2122195934.369982.1640192298494@mail.yahoo.com>
Message-ID: <CAGgJW74ifSJhSaAn5AXV9HofXx6Vz6oqnPZV=0hvt5VqOMW1Gg@mail.gmail.com>

Try replacing
"c:/temp/f[i].jpg"
with
paste0("c:/temp/",f[i],".jpg")


On Wed, Dec 22, 2021 at 7:08 PM Kai Yang via R-help <r-help at r-project.org>
wrote:

> Hello R team,I want to use for loop to generate multiple plots with 3
> parameter, (y is for y axis, c is for color and f is for file name in
> output). I created a data frame to save the information and use the
> information in for loop. I use y[i], c[i] and f[i] in the loop, but it
> seems doesn't work. Can anyone correct my code to make it work?
> Thanks,Kai
>
> library(ggplot2)library(tidyverse)
> y <- c("hwy","cty")c <- c("cyl","class")f <- c("hwy_cyl","cty_class")
> mac <- data.frame(y,c,f)
> for (i in nrow(mac)){  mpg %>%    filter(hwy <35) %>%     ggplot(aes(x =
> displ, y = y[i], color = c[i])) +     geom_point()
> ggsave("c:/temp/f[i].jpg",width = 9, height = 6, dpi = 1200, units = "in")}
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From jho|tm@n @end|ng |rom gm@||@com  Wed Dec 22 18:27:33 2021
From: jho|tm@n @end|ng |rom gm@||@com (jim holtman)
Date: Wed, 22 Dec 2021 09:27:33 -0800
Subject: [R] for loop question in R
In-Reply-To: <2122195934.369982.1640192298494@mail.yahoo.com>
References: <2122195934.369982.1640192298494.ref@mail.yahoo.com>
 <2122195934.369982.1640192298494@mail.yahoo.com>
Message-ID: <CAAxdm-4yzu6ddxWPHY2aZToKXUkSh6W+G_ksm6rWaVjXVfPHFg@mail.gmail.com>

You may have to add an explicit 'print' to ggplot

library(ggplot2)
library(tidyverse)
y <- c("hwy","cty")
c <- c("cyl","class")
f <- c("hwy_cyl","cty_class")
mac <- data.frame(y,c,f)
for (i in nrow(mac)){
  mpg %>%    filter(hwy <35) %>%
     print(ggplot(aes(x = displ, y = y[i], color = c[i])) +     geom_point())
  ggsave("c:/temp/f[i].jpg",width = 9, height = 6, dpi = 1200, units = "in")
}

Thanks

Jim Holtman
Data Munger Guru

What is the problem that you are trying to solve?
Tell me what you want to do, not how you want to do it.


Thanks

Jim Holtman
Data Munger Guru

What is the problem that you are trying to solve?
Tell me what you want to do, not how you want to do it.


On Wed, Dec 22, 2021 at 9:08 AM Kai Yang via R-help
<r-help at r-project.org> wrote:
>
> Hello R team,I want to use for loop to generate multiple plots with 3 parameter, (y is for y axis, c is for color and f is for file name in output). I created a data frame to save the information and use the information in for loop. I use y[i], c[i] and f[i] in the loop, but it seems doesn't work. Can anyone correct my code to make it work?
> Thanks,Kai
>
> library(ggplot2)library(tidyverse)
> y <- c("hwy","cty")c <- c("cyl","class")f <- c("hwy_cyl","cty_class")
> mac <- data.frame(y,c,f)
> for (i in nrow(mac)){  mpg %>%    filter(hwy <35) %>%     ggplot(aes(x = displ, y = y[i], color = c[i])) +     geom_point()  ggsave("c:/temp/f[i].jpg",width = 9, height = 6, dpi = 1200, units = "in")}
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @v|gro@@ @end|ng |rom ver|zon@net  Wed Dec 22 18:33:18 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Wed, 22 Dec 2021 12:33:18 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <46338490-263d-d026-2017-333f61734646@shdawson.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <8f4efdcb-57bc-2922-7f96-753af38d1c0b@shdawson.com>
 <dead8a81-9ad7-2df3-f97c-ff8fb3f1b903@gmail.com>
 <f99ab582-0902-614a-3824-1dc606b944c1@shdawson.com>
 <36bb5a89-42fa-9108-4798-3d3ac5698d1e@gmail.com>
 <b375b182-bdfb-171d-76e9-8bad2686f0dc@shdawson.com>
 <46338490-263d-d026-2017-333f61734646@shdawson.com>
Message-ID: <018301d7f75a$02757b50$076071f0$@verizon.net>

Stephen,

Why should there be a column header when you take your data and reformat it? 

cat(format(v1, justify = "right"), sep = "\n")

The above is no longer your original data structure and has specified what you want printed. Your column header and other names associated with your original data.frame are stored as attributes that you sort of discarded.

The name you want is associated not with v1 but with what you call Data[,1] and you can get that name using names(Data[,1]) and put it where you want. In your case, if you want the single line above your values to have that name, this would do it:

cat(format(names(Data[,1]). "\n", v1, justify = "right"), sep = "\n")

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson, DSL via R-help
Sent: Wednesday, December 22, 2021 12:02 PM
To: Duncan Murdoch <murdoch.duncan at gmail.com>; Rui Barradas <ruipbarradas at sapo.pt>; Stephen H. Dawson, DSL via R-help <r-help at r-project.org>
Subject: Re: [R] Adding SORT to UNIQUE

Data <- read.csv("./input/Source.csv", header=T)
v1 <- sort(unique(Data[, 1]))
cat(format(v1, justify = "right"), sep = "\n")

OK, working with the options you presented. This is the combination where I gain the most benefit.

However, there is no listing of a column header with the output of this syntax.

 > cat(format(v1, justify = "right"), sep = "\n")
  2
  3
  4
  5
  6
  7
  8
  9
10
 >

NOTE
The output here is correct (unique) based on the entries from the column.

QUESTION
How does one add a text label of something as simple as v1 to the vertical output of this syntax, please?

*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/22/21 11:13 AM, Stephen H. Dawson, DSL via R-help wrote:
> OK, now I get what you are suggesting.
>
> Much appreciated.
>
>
> Kindest Regards,
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
>
> On 12/22/21 11:08 AM, Duncan Murdoch wrote:
>> On 22/12/2021 10:55 a.m., Stephen H. Dawson, DSL wrote:
>>> I see.
>>>
>>> So, we are talking taking the output into a new dataframe. I was 
>>> hoping to have the output rendered on screen without another 
>>> dataframe, but I can live with this option it if must occur.
>>>
>>> Am I correct the desired vertical output must first go to a dataframe?
>>
>> No, that's just one option.  The other 3 don't use dataframes.
>>
>> Duncan Murdoch
>>>
>>>
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 12/22/21 10:47 AM, Duncan Murdoch wrote:
>>>> On 22/12/2021 10:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>> Thanks for the reply.
>>>>>
>>>>> Both syntax options work to render the correct (unique) output. 
>>>>> However,
>>>>> the output is rendered as horizontal. What needs to happen to get 
>>>>> the output to render vertical, please?
>>>>
>>>> The result of those expressions is a vector of the same type as the 
>>>> column, so your question is really about how to get a vector to 
>>>> print one element per line.
>>>>
>>>> Probably the simplest way is to put the vector in a dataframe (or 
>>>> matrix, or tibble, depending on which formatting you prefer). For 
>>>> example,
>>>>
>>>>>     v <- c("red", "green", "blue")
>>>>>     data.frame(v)
>>>>        v
>>>> 1   red
>>>> 2 green
>>>> 3  blue
>>>>
>>>> If you want a more minimal display, try
>>>>
>>>>> cat(v, sep = "\n")
>>>> red
>>>> green
>>>> blue
>>>>
>>>> or
>>>>
>>>>> cat(format(v, justify = "right"), sep = "\n")
>>>>    red
>>>> green
>>>>   blue
>>>>
>>>> If you want this to happen when you auto-print the object, you can 
>>>> give it a class attribute and write a function to print that class, 
>>>> e.g.
>>>>
>>>>>    class(v) <- "oneperline"
>>>>>
>>>>>     print.oneperline <- function(x, ...) cat(format(x, justify =
>>>> "right"), sep = "\n")
>>>>>
>>>>>     v
>>>>    red
>>>> green
>>>>   blue
>>>>
>>>> Duncan Murdoch
>>>>
>>>>>
>>>>>
>>>>> *Stephen Dawson, DSL*
>>>>> /Executive Strategy Consultant/
>>>>> Business & Technology
>>>>> +1 (865) 804-3454
>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>
>>>>>
>>>>> On 12/21/21 11:38 AM, Duncan Murdoch wrote:
>>>>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>>>> Thanks for the reply.
>>>>>>>>
>>>>>>>> sort(unique(Data[1]))
>>>>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last, 
>>>>>>>> decreasing =
>>>>>>>> decreasing)) :
>>>>>>>>        undefined columns selected
>>>>>>>
>>>>>>> That's the wrong syntax:  Data[1] is not "column one of Data". 
>>>>>>> Use Data[[1]] for that, so
>>>>>>>
>>>>>>>       sort(unique(Data[[1]]))
>>>>>>
>>>>>> Actually, I'd probably recommend
>>>>>>
>>>>>>     sort(unique(Data[, 1]))
>>>>>>
>>>>>> instead.  This treats Data as a matrix rather than as a list.
>>>>>> Dataframes are lists that look like matrices, but to me the 
>>>>>> matrix aspect is usually more intuitive.
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>>
>>>>>>> I think Rui already pointed out the typo in the quoted text 
>>>>>>> below...
>>>>>>>
>>>>>>> Duncan Murdoch
>>>>>>>
>>>>>>>>
>>>>>>>> The recommended syntax did not work, as listed above.
>>>>>>>>
>>>>>>>> What I want is the sort of distinct column output. Again, the 
>>>>>>>> column may be text or numbers. This is a huge analysis effort 
>>>>>>>> with data coming at me from many different sources.
>>>>>>>>
>>>>>>>>
>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>> /Executive Strategy Consultant/ Business & Technology
>>>>>>>> +1 (865) 804-3454
>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>
>>>>>>>>
>>>>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help
>>>>>>>>> wrote:
>>>>>>>>>> Thanks everyone for the replies.
>>>>>>>>>>
>>>>>>>>>> It is clear one either needs to write a function or put the 
>>>>>>>>>> unique entries into another dataframe.
>>>>>>>>>>
>>>>>>>>>> It seems odd R cannot sort a list of unique column entries 
>>>>>>>>>> with ease.
>>>>>>>>>> Python and SQL can do it with ease.
>>>>>>>>>
>>>>>>>>> I've seen several responses that looked pretty simple. It's 
>>>>>>>>> hard to beat sort(unique(x)), though there's a fair bit of 
>>>>>>>>> confusion about what you actually want.  Maybe you should post 
>>>>>>>>> an example of the code you'd use in Python?
>>>>>>>>>
>>>>>>>>> Duncan Murdoch
>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> QUESTION
>>>>>>>>>> Is there a simpler means than other than the unique function 
>>>>>>>>>> to capture distinct column entries, then sort that list?
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>> /Executive Strategy Consultant/ Business & Technology
>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>>>>> Hello,
>>>>>>>>>>>
>>>>>>>>>>> Inline.
>>>>>>>>>>>
>>>>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help
>>>>>>>>>>> escreveu:
>>>>>>>>>>>> Thanks.
>>>>>>>>>>>>
>>>>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>>>>
>>>>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>>>>
>>>>>>>>>>> This is not right.
>>>>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax 
>>>>>>>>>>> Data[[1]] extracts the column vector.
>>>>>>>>>>>
>>>>>>>>>>> As for my previous answer, it was not addressing the 
>>>>>>>>>>> question, I misinterpreted it as being a question on how to 
>>>>>>>>>>> sort by numeric order when the data is not numeric. Here is 
>>>>>>>>>>> a, hopefully, complete answer.
>>>>>>>>>>> Still with package stringr.
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>>>>
>>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>>>>>        stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>>>>> })
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Or using Avi's suggestion of writing a function to do all 
>>>>>>>>>>> the work and simplify the lapply loop later,
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> unisort2 <- function(vec, ...) 
>>>>>>>>>>> stringr::str_sort(unique(vec), ...)
>>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Hope this helps,
>>>>>>>>>>>
>>>>>>>>>>> Rui Barradas
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>>>> /Executive Strategy Consultant/ Business & Technology
>>>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>>>>>> Hi,
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Running a simple syntax set to review entries in dataframe 
>>>>>>>>>>>>> columns.
>>>>>>>>>>>>> Here is the working code.
>>>>>>>>>>>>>
>>>>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>>>>> describe(Data)
>>>>>>>>>>>>> summary(Data)
>>>>>>>>>>>>> unique(Data[1])
>>>>>>>>>>>>> unique(Data[2])
>>>>>>>>>>>>> unique(Data[3])
>>>>>>>>>>>>> unique(Data[4])
>>>>>>>>>>>>>
>>>>>>>>>>>>> I would like to add sort the unique entries. The data in 
>>>>>>>>>>>>> the various columns are not defined as numbers, but also 
>>>>>>>>>>>>> text. I realize
>>>>>>>>>>>>> 1 and
>>>>>>>>>>>>> 10 will not sort properly, as the column is not defined as 
>>>>>>>>>>>>> a number, but want to see what I have in the columns 
>>>>>>>>>>>>> viewed as sorted.
>>>>>>>>>>>>>
>>>>>>>>>>>>> QUESTION
>>>>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Thanks.
>>>>>>>>>>>>
>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and 
>>>>>>>>>>>> more, see https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>>>> PLEASE do read the posting guide 
>>>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>>>> and provide commented, minimal, self-contained, 
>>>>>>>>>>>> reproducible code.
>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> ______________________________________________
>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, 
>>>>>>>>>> see
>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>> and provide commented, minimal, self-contained, reproducible 
>>>>>>>>>> code.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>
>>>>
>>>
>>
>>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From kry|ov@r00t @end|ng |rom gm@||@com  Wed Dec 22 18:42:41 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Wed, 22 Dec 2021 20:42:41 +0300
Subject: [R] for loop question in R
In-Reply-To: <2122195934.369982.1640192298494@mail.yahoo.com>
References: <2122195934.369982.1640192298494.ref@mail.yahoo.com>
 <2122195934.369982.1640192298494@mail.yahoo.com>
Message-ID: <20211222204241.29d99eb7@Tarkus>

On Wed, 22 Dec 2021 16:58:18 +0000 (UTC)
Kai Yang via R-help <r-help at r-project.org> wrote:

> mpg %>%? ? filter(hwy <35) %>%?? ? ggplot(aes(x = displ, y = y[i],
> color = c[i])) +?? ? geom_point()

Your code relies on R's auto-printing, where each line of code executed
at the top level (not in loops or functions) is run as if it was
wrapped in print(...the rest of the line...).

Solution: make that print() explicit.

A better solution: explicitly pass the plot object returned by the
ggplot functions to the ggsave() function instead of relying on the
global state of the program.

> ggsave("c:/temp/f[i].jpg",width = 9, height = 6, dpi = 1200, units =
> "in")

When you type "c:/temp/f[i].jpg", what do you get in return?

Use paste0() or sprintf() to compose strings out of parts.

> 	[[alternative HTML version deleted]]

P.S. Please compose your messages in plain text, not HTML. See the
R-help posting guide for more info.

-- 
Best regards,
Ivan


From @erv|ce @end|ng |rom @hd@w@on@com  Wed Dec 22 18:59:30 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Wed, 22 Dec 2021 12:59:30 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <018301d7f75a$02757b50$076071f0$@verizon.net>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <8f4efdcb-57bc-2922-7f96-753af38d1c0b@shdawson.com>
 <dead8a81-9ad7-2df3-f97c-ff8fb3f1b903@gmail.com>
 <f99ab582-0902-614a-3824-1dc606b944c1@shdawson.com>
 <36bb5a89-42fa-9108-4798-3d3ac5698d1e@gmail.com>
 <b375b182-bdfb-171d-76e9-8bad2686f0dc@shdawson.com>
 <46338490-263d-d026-2017-333f61734646@shdawson.com>
 <018301d7f75a$02757b50$076071f0$@verizon.net>
Message-ID: <393012d3-c0cb-3fb9-326a-ef4a03d51a7a@shdawson.com>

Thanks.

I am pondering label names, not set on one as of yet. I like your 
recommendation.


 > cat(format(names(Data[,1]). "\n", v1, justify = "right"), sep = "\n")
Error: unexpected symbol in "cat(format(names(Data[,1])."
 >

Your proposed syntax has an error.

QUESTION
Can you identify the error and reply with another recommendation, please?


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/22/21 12:33 PM, Avi Gross via R-help wrote:
> Stephen,
>
> Why should there be a column header when you take your data and reformat it?
>
> cat(format(v1, justify = "right"), sep = "\n")
>
> The above is no longer your original data structure and has specified what you want printed. Your column header and other names associated with your original data.frame are stored as attributes that you sort of discarded.
>
> The name you want is associated not with v1 but with what you call Data[,1] and you can get that name using names(Data[,1]) and put it where you want. In your case, if you want the single line above your values to have that name, this would do it:
>
> cat(format(names(Data[,1]). "\n", v1, justify = "right"), sep = "\n")
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson, DSL via R-help
> Sent: Wednesday, December 22, 2021 12:02 PM
> To: Duncan Murdoch <murdoch.duncan at gmail.com>; Rui Barradas <ruipbarradas at sapo.pt>; Stephen H. Dawson, DSL via R-help <r-help at r-project.org>
> Subject: Re: [R] Adding SORT to UNIQUE
>
> Data <- read.csv("./input/Source.csv", header=T)
> v1 <- sort(unique(Data[, 1]))
> cat(format(v1, justify = "right"), sep = "\n")
>
> OK, working with the options you presented. This is the combination where I gain the most benefit.
>
> However, there is no listing of a column header with the output of this syntax.
>
>   > cat(format(v1, justify = "right"), sep = "\n")
>    2
>    3
>    4
>    5
>    6
>    7
>    8
>    9
> 10
>   >
>
> NOTE
> The output here is correct (unique) based on the entries from the column.
>
> QUESTION
> How does one add a text label of something as simple as v1 to the vertical output of this syntax, please?
>
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
>
> On 12/22/21 11:13 AM, Stephen H. Dawson, DSL via R-help wrote:
>> OK, now I get what you are suggesting.
>>
>> Much appreciated.
>>
>>
>> Kindest Regards,
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 12/22/21 11:08 AM, Duncan Murdoch wrote:
>>> On 22/12/2021 10:55 a.m., Stephen H. Dawson, DSL wrote:
>>>> I see.
>>>>
>>>> So, we are talking taking the output into a new dataframe. I was
>>>> hoping to have the output rendered on screen without another
>>>> dataframe, but I can live with this option it if must occur.
>>>>
>>>> Am I correct the desired vertical output must first go to a dataframe?
>>> No, that's just one option.  The other 3 don't use dataframes.
>>>
>>> Duncan Murdoch
>>>>
>>>> *Stephen Dawson, DSL*
>>>> /Executive Strategy Consultant/
>>>> Business & Technology
>>>> +1 (865) 804-3454
>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>
>>>>
>>>> On 12/22/21 10:47 AM, Duncan Murdoch wrote:
>>>>> On 22/12/2021 10:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>> Thanks for the reply.
>>>>>>
>>>>>> Both syntax options work to render the correct (unique) output.
>>>>>> However,
>>>>>> the output is rendered as horizontal. What needs to happen to get
>>>>>> the output to render vertical, please?
>>>>> The result of those expressions is a vector of the same type as the
>>>>> column, so your question is really about how to get a vector to
>>>>> print one element per line.
>>>>>
>>>>> Probably the simplest way is to put the vector in a dataframe (or
>>>>> matrix, or tibble, depending on which formatting you prefer). For
>>>>> example,
>>>>>
>>>>>>      v <- c("red", "green", "blue")
>>>>>>      data.frame(v)
>>>>>         v
>>>>> 1   red
>>>>> 2 green
>>>>> 3  blue
>>>>>
>>>>> If you want a more minimal display, try
>>>>>
>>>>>> cat(v, sep = "\n")
>>>>> red
>>>>> green
>>>>> blue
>>>>>
>>>>> or
>>>>>
>>>>>> cat(format(v, justify = "right"), sep = "\n")
>>>>>     red
>>>>> green
>>>>>    blue
>>>>>
>>>>> If you want this to happen when you auto-print the object, you can
>>>>> give it a class attribute and write a function to print that class,
>>>>> e.g.
>>>>>
>>>>>>     class(v) <- "oneperline"
>>>>>>
>>>>>>      print.oneperline <- function(x, ...) cat(format(x, justify =
>>>>> "right"), sep = "\n")
>>>>>>      v
>>>>>     red
>>>>> green
>>>>>    blue
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>>
>>>>>> *Stephen Dawson, DSL*
>>>>>> /Executive Strategy Consultant/
>>>>>> Business & Technology
>>>>>> +1 (865) 804-3454
>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>
>>>>>>
>>>>>> On 12/21/21 11:38 AM, Duncan Murdoch wrote:
>>>>>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>>>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>>>>> Thanks for the reply.
>>>>>>>>>
>>>>>>>>> sort(unique(Data[1]))
>>>>>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last,
>>>>>>>>> decreasing =
>>>>>>>>> decreasing)) :
>>>>>>>>>         undefined columns selected
>>>>>>>> That's the wrong syntax:  Data[1] is not "column one of Data".
>>>>>>>> Use Data[[1]] for that, so
>>>>>>>>
>>>>>>>>        sort(unique(Data[[1]]))
>>>>>>> Actually, I'd probably recommend
>>>>>>>
>>>>>>>      sort(unique(Data[, 1]))
>>>>>>>
>>>>>>> instead.  This treats Data as a matrix rather than as a list.
>>>>>>> Dataframes are lists that look like matrices, but to me the
>>>>>>> matrix aspect is usually more intuitive.
>>>>>>>
>>>>>>> Duncan Murdoch
>>>>>>>
>>>>>>>> I think Rui already pointed out the typo in the quoted text
>>>>>>>> below...
>>>>>>>>
>>>>>>>> Duncan Murdoch
>>>>>>>>
>>>>>>>>> The recommended syntax did not work, as listed above.
>>>>>>>>>
>>>>>>>>> What I want is the sort of distinct column output. Again, the
>>>>>>>>> column may be text or numbers. This is a huge analysis effort
>>>>>>>>> with data coming at me from many different sources.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>> /Executive Strategy Consultant/ Business & Technology
>>>>>>>>> +1 (865) 804-3454
>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help
>>>>>>>>>> wrote:
>>>>>>>>>>> Thanks everyone for the replies.
>>>>>>>>>>>
>>>>>>>>>>> It is clear one either needs to write a function or put the
>>>>>>>>>>> unique entries into another dataframe.
>>>>>>>>>>>
>>>>>>>>>>> It seems odd R cannot sort a list of unique column entries
>>>>>>>>>>> with ease.
>>>>>>>>>>> Python and SQL can do it with ease.
>>>>>>>>>> I've seen several responses that looked pretty simple. It's
>>>>>>>>>> hard to beat sort(unique(x)), though there's a fair bit of
>>>>>>>>>> confusion about what you actually want.  Maybe you should post
>>>>>>>>>> an example of the code you'd use in Python?
>>>>>>>>>>
>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>
>>>>>>>>>>> QUESTION
>>>>>>>>>>> Is there a simpler means than other than the unique function
>>>>>>>>>>> to capture distinct column entries, then sort that list?
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>>> /Executive Strategy Consultant/ Business & Technology
>>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>>>>>> Hello,
>>>>>>>>>>>>
>>>>>>>>>>>> Inline.
>>>>>>>>>>>>
>>>>>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help
>>>>>>>>>>>> escreveu:
>>>>>>>>>>>>> Thanks.
>>>>>>>>>>>>>
>>>>>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>>>>>
>>>>>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>>>>> This is not right.
>>>>>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax
>>>>>>>>>>>> Data[[1]] extracts the column vector.
>>>>>>>>>>>>
>>>>>>>>>>>> As for my previous answer, it was not addressing the
>>>>>>>>>>>> question, I misinterpreted it as being a question on how to
>>>>>>>>>>>> sort by numeric order when the data is not numeric. Here is
>>>>>>>>>>>> a, hopefully, complete answer.
>>>>>>>>>>>> Still with package stringr.
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>>>>>
>>>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>>>>>>         stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>>>>>> })
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Or using Avi's suggestion of writing a function to do all
>>>>>>>>>>>> the work and simplify the lapply loop later,
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> unisort2 <- function(vec, ...)
>>>>>>>>>>>> stringr::str_sort(unique(vec), ...)
>>>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> Hope this helps,
>>>>>>>>>>>>
>>>>>>>>>>>> Rui Barradas
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>>>>> /Executive Strategy Consultant/ Business & Technology
>>>>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>>>>>>> Hi,
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Running a simple syntax set to review entries in dataframe
>>>>>>>>>>>>>> columns.
>>>>>>>>>>>>>> Here is the working code.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>>>>>> describe(Data)
>>>>>>>>>>>>>> summary(Data)
>>>>>>>>>>>>>> unique(Data[1])
>>>>>>>>>>>>>> unique(Data[2])
>>>>>>>>>>>>>> unique(Data[3])
>>>>>>>>>>>>>> unique(Data[4])
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> I would like to add sort the unique entries. The data in
>>>>>>>>>>>>>> the various columns are not defined as numbers, but also
>>>>>>>>>>>>>> text. I realize
>>>>>>>>>>>>>> 1 and
>>>>>>>>>>>>>> 10 will not sort properly, as the column is not defined as
>>>>>>>>>>>>>> a number, but want to see what I have in the columns
>>>>>>>>>>>>>> viewed as sorted.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> QUESTION
>>>>>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Thanks.
>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and
>>>>>>>>>>>>> more, see https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>>>>> and provide commented, minimal, self-contained,
>>>>>>>>>>>>> reproducible code.
>>>>>>>>>>> ______________________________________________
>>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more,
>>>>>>>>>>> see
>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>>> and provide commented, minimal, self-contained, reproducible
>>>>>>>>>>> code.
>>>>>>>>>>
>>>>>>>>>
>>>>>>>
>>>>>
>>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From y@ngk@|9999 @end|ng |rom y@hoo@com  Wed Dec 22 19:18:56 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Wed, 22 Dec 2021 18:18:56 +0000 (UTC)
Subject: [R] for loop question in R
In-Reply-To: <20211222204241.29d99eb7@Tarkus>
References: <2122195934.369982.1640192298494.ref@mail.yahoo.com>
 <2122195934.369982.1640192298494@mail.yahoo.com>
 <20211222204241.29d99eb7@Tarkus>
Message-ID: <1126650868.384268.1640197136406@mail.yahoo.com>

 Hello Eric, Jim and Ivan,
Many thanks all of your help. I'm a new one in R area. I may not fully understand the idea from you.? I modified my code below, I can get the plots out with correct file name, but plots? are not using correct fields' name. it use y[i], and c[i] as variables' name, does not use hwy, cyl or cty, class in ggplot statement. And there is not any error message. Could you please look into my modified code below and let me know how to modify y= y[i], color = c[i] part?
Thanks,
Kai

y <- c("hwy","cty")
c <- c("cyl","class")
f <- c("hwy_cyl","cty_class")
mac <- data.frame(y,c,f)
for (i in seq(nrow(mac))){
? mpg %>%
? ? filter(hwy <35) %>%?
? ? ggplot(aes(x = displ, y = y[i], color = c[i])) +?
? ? geom_point()
? ggsave(paste0("c:/temp/",f[i],".jpg"),width = 9, height = 6, dpi = 1200, units = "in")
}

    On Wednesday, December 22, 2021, 09:42:45 AM PST, Ivan Krylov <krylov.r00t at gmail.com> wrote:  
 
 On Wed, 22 Dec 2021 16:58:18 +0000 (UTC)
Kai Yang via R-help <r-help at r-project.org> wrote:

> mpg %>%? ? filter(hwy <35) %>%?? ? ggplot(aes(x = displ, y = y[i],
> color = c[i])) +?? ? geom_point()

Your code relies on R's auto-printing, where each line of code executed
at the top level (not in loops or functions) is run as if it was
wrapped in print(...the rest of the line...).

Solution: make that print() explicit.

A better solution: explicitly pass the plot object returned by the
ggplot functions to the ggsave() function instead of relying on the
global state of the program.

> ggsave("c:/temp/f[i].jpg",width = 9, height = 6, dpi = 1200, units =
> "in")

When you type "c:/temp/f[i].jpg", what do you get in return?

Use paste0() or sprintf() to compose strings out of parts.

> ??? [[alternative HTML version deleted]]

P.S. Please compose your messages in plain text, not HTML. See the
R-help posting guide for more info.

-- 
Best regards,
Ivan
  
	[[alternative HTML version deleted]]


From y@ngk@|9999 @end|ng |rom y@hoo@com  Wed Dec 22 19:50:18 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Wed, 22 Dec 2021 18:50:18 +0000 (UTC)
Subject: [R] for loop question in R
In-Reply-To: <1126650868.384268.1640197136406@mail.yahoo.com>
References: <2122195934.369982.1640192298494.ref@mail.yahoo.com>
 <2122195934.369982.1640192298494@mail.yahoo.com>
 <20211222204241.29d99eb7@Tarkus>
 <1126650868.384268.1640197136406@mail.yahoo.com>
Message-ID: <1251537188.390384.1640199018317@mail.yahoo.com>

 strange, I got error message when I run again:
Error: unexpected symbol in:
"? ? geom_point()
? ggsave"
> }
Error: unexpected '}' in "}"

    On Wednesday, December 22, 2021, 10:18:56 AM PST, Kai Yang <yangkai9999 at yahoo.com> wrote:  
 
  Hello Eric, Jim and Ivan,
Many thanks all of your help. I'm a new one in R area. I may not fully understand the idea from you.? I modified my code below, I can get the plots out with correct file name, but plots? are not using correct fields' name. it use y[i], and c[i] as variables' name, does not use hwy, cyl or cty, class in ggplot statement. And there is not any error message. Could you please look into my modified code below and let me know how to modify y= y[i], color = c[i] part?
Thanks,
Kai

y <- c("hwy","cty")
c <- c("cyl","class")
f <- c("hwy_cyl","cty_class")
mac <- data.frame(y,c,f)
for (i in seq(nrow(mac))){
? mpg %>%
? ? filter(hwy <35) %>%?
? ? ggplot(aes(x = displ, y = y[i], color = c[i])) +?
? ? geom_point()
? ggsave(paste0("c:/temp/",f[i],".jpg"),width = 9, height = 6, dpi = 1200, units = "in")
}

    On Wednesday, December 22, 2021, 09:42:45 AM PST, Ivan Krylov <krylov.r00t at gmail.com> wrote:  
 
 On Wed, 22 Dec 2021 16:58:18 +0000 (UTC)
Kai Yang via R-help <r-help at r-project.org> wrote:

> mpg %>%? ? filter(hwy <35) %>%?? ? ggplot(aes(x = displ, y = y[i],
> color = c[i])) +?? ? geom_point()

Your code relies on R's auto-printing, where each line of code executed
at the top level (not in loops or functions) is run as if it was
wrapped in print(...the rest of the line...).

Solution: make that print() explicit.

A better solution: explicitly pass the plot object returned by the
ggplot functions to the ggsave() function instead of relying on the
global state of the program.

> ggsave("c:/temp/f[i].jpg",width = 9, height = 6, dpi = 1200, units =
> "in")

When you type "c:/temp/f[i].jpg", what do you get in return?

Use paste0() or sprintf() to compose strings out of parts.

> ??? [[alternative HTML version deleted]]

P.S. Please compose your messages in plain text, not HTML. See the
R-help posting guide for more info.

-- 
Best regards,
Ivan
    
	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Dec 22 23:30:43 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 22 Dec 2021 22:30:43 +0000
Subject: [R] for loop question in R
In-Reply-To: <1126650868.384268.1640197136406@mail.yahoo.com>
References: <2122195934.369982.1640192298494.ref@mail.yahoo.com>
 <2122195934.369982.1640192298494@mail.yahoo.com>
 <20211222204241.29d99eb7@Tarkus>
 <1126650868.384268.1640197136406@mail.yahoo.com>
Message-ID: <d7ecd33b-c15e-d9f5-a034-6989373441bc@sapo.pt>

Hello,

y[i] and c[i] are character strings, they are not variables of data set mpg.
To get the variables, use, well, help("get").

Note that I have changed the temp dir to mine. So I created a variable 
to hold the value


tmpdir <- "c:/temp/"

for (i in seq(nrow(mac))){
   mpg %>%
     filter(hwy < 35) %>%
     ggplot(aes(x = displ, y = get(y[i]), color = get(c[i]))) +
     geom_point() +
     ylab(y[i]) +
     guides(color = guide_legend(title = c[i]))
   ggsave(
     paste0(tmpdir, f[i], ".jpg"),
     width = 9,
     height = 6,
     dpi = 1200,
     units = "in")
}



Like Ivan said, don't rely on auto print. In order to have to open the 
graphics files output by the loop I would have done something like the 
following.

First create a list to hold the plots. Inside the for loop save the 
plots in the list and explicitly print them. And use ggsave argument 
plot. Like this, after the loop you can see what you have by printing 
each list member.


p <- vector("list", length = nrow(mac))
for (i in seq(nrow(mac))){
   mpg %>%
     filter(hwy < 35) %>%
     ggplot(aes(x = displ, y = get(y[i]), color = get(c[i]))) +
     geom_point() +
     ylab(y[i]) +
     guides(color = guide_legend(title = c[i])) -> p[[i]]
   ggsave(
     paste0(tmpdir, f[i], ".jpg"),
     plot = p[[i]],
     width = 9,
     height = 6,
     dpi = 1200,
     units = "in")
}

# See the first plot
p[[1]]


Hope this helps,

Rui Barradas

?s 18:18 de 22/12/21, Kai Yang via R-help escreveu:
>   Hello Eric, Jim and Ivan,
> Many thanks all of your help. I'm a new one in R area. I may not fully understand the idea from you.? I modified my code below, I can get the plots out with correct file name, but plots? are not using correct fields' name. it use y[i], and c[i] as variables' name, does not use hwy, cyl or cty, class in ggplot statement. And there is not any error message. Could you please look into my modified code below and let me know how to modify y= y[i], color = c[i] part?
> Thanks,
> Kai
> 
> y <- c("hwy","cty")
> c <- c("cyl","class")
> f <- c("hwy_cyl","cty_class")
> mac <- data.frame(y,c,f)
> for (i in seq(nrow(mac))){
>  ? mpg %>%
>  ? ? filter(hwy <35) %>%
>  ? ? ggplot(aes(x = displ, y = y[i], color = c[i])) +
>  ? ? geom_point()
>  ? ggsave(paste0("c:/temp/",f[i],".jpg"),width = 9, height = 6, dpi = 1200, units = "in")
> }
> 
>      On Wednesday, December 22, 2021, 09:42:45 AM PST, Ivan Krylov <krylov.r00t at gmail.com> wrote:
>   
>   On Wed, 22 Dec 2021 16:58:18 +0000 (UTC)
> Kai Yang via R-help <r-help at r-project.org> wrote:
> 
>> mpg %>%? ? filter(hwy <35) %>%?? ? ggplot(aes(x = displ, y = y[i],
>> color = c[i])) +?? ? geom_point()
> 
> Your code relies on R's auto-printing, where each line of code executed
> at the top level (not in loops or functions) is run as if it was
> wrapped in print(...the rest of the line...).
> 
> Solution: make that print() explicit.
> 
> A better solution: explicitly pass the plot object returned by the
> ggplot functions to the ggsave() function instead of relying on the
> global state of the program.
> 
>> ggsave("c:/temp/f[i].jpg",width = 9, height = 6, dpi = 1200, units =
>> "in")
> 
> When you type "c:/temp/f[i].jpg", what do you get in return?
> 
> Use paste0() or sprintf() to compose strings out of parts.
> 
>>  ??? [[alternative HTML version deleted]]
> 
> P.S. Please compose your messages in plain text, not HTML. See the
> R-help posting guide for more info.
>


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Dec 22 23:37:21 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 22 Dec 2021 22:37:21 +0000
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <393012d3-c0cb-3fb9-326a-ef4a03d51a7a@shdawson.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <8f4efdcb-57bc-2922-7f96-753af38d1c0b@shdawson.com>
 <dead8a81-9ad7-2df3-f97c-ff8fb3f1b903@gmail.com>
 <f99ab582-0902-614a-3824-1dc606b944c1@shdawson.com>
 <36bb5a89-42fa-9108-4798-3d3ac5698d1e@gmail.com>
 <b375b182-bdfb-171d-76e9-8bad2686f0dc@shdawson.com>
 <46338490-263d-d026-2017-333f61734646@shdawson.com>
 <018301d7f75a$02757b50$076071f0$@verizon.net>
 <393012d3-c0cb-3fb9-326a-ef4a03d51a7a@shdawson.com>
Message-ID: <4128b1aa-af72-9385-355e-96dc8166f1c4@sapo.pt>

Hello,

The error is a simple typo, instead of the period after names(Data[,1]), 
it should be a comma.

cat(format(names(Data[,1]), "\n", v1, justify = "right"), sep = "\n")

(And the error message accurately points out where the error is, in 
these cases try to read the instruction more carefully, typos can be 
hard to find.)


Hope this helps,

Rui Barradas

?s 17:59 de 22/12/21, Stephen H. Dawson, DSL via R-help escreveu:
> Thanks.
> 
> I am pondering label names, not set on one as of yet. I like your 
> recommendation.
> 
> 
>  > cat(format(names(Data[,1]). "\n", v1, justify = "right"), sep = "\n")
> Error: unexpected symbol in "cat(format(names(Data[,1])."
>  >
> 
> Your proposed syntax has an error.
> 
> QUESTION
> Can you identify the error and reply with another recommendation, please?
> 
> 
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
> 
> 
> On 12/22/21 12:33 PM, Avi Gross via R-help wrote:
>> Stephen,
>>
>> Why should there be a column header when you take your data and 
>> reformat it?
>>
>> cat(format(v1, justify = "right"), sep = "\n")
>>
>> The above is no longer your original data structure and has specified 
>> what you want printed. Your column header and other names associated 
>> with your original data.frame are stored as attributes that you sort 
>> of discarded.
>>
>> The name you want is associated not with v1 but with what you call 
>> Data[,1] and you can get that name using names(Data[,1]) and put it 
>> where you want. In your case, if you want the single line above your 
>> values to have that name, this would do it:
>>
>> cat(format(names(Data[,1]). "\n", v1, justify = "right"), sep = "\n")
>>
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. 
>> Dawson, DSL via R-help
>> Sent: Wednesday, December 22, 2021 12:02 PM
>> To: Duncan Murdoch <murdoch.duncan at gmail.com>; Rui Barradas 
>> <ruipbarradas at sapo.pt>; Stephen H. Dawson, DSL via R-help 
>> <r-help at r-project.org>
>> Subject: Re: [R] Adding SORT to UNIQUE
>>
>> Data <- read.csv("./input/Source.csv", header=T)
>> v1 <- sort(unique(Data[, 1]))
>> cat(format(v1, justify = "right"), sep = "\n")
>>
>> OK, working with the options you presented. This is the combination 
>> where I gain the most benefit.
>>
>> However, there is no listing of a column header with the output of 
>> this syntax.
>>
>> ? > cat(format(v1, justify = "right"), sep = "\n")
>> ?? 2
>> ?? 3
>> ?? 4
>> ?? 5
>> ?? 6
>> ?? 7
>> ?? 8
>> ?? 9
>> 10
>> ? >
>>
>> NOTE
>> The output here is correct (unique) based on the entries from the column.
>>
>> QUESTION
>> How does one add a text label of something as simple as v1 to the 
>> vertical output of this syntax, please?
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 12/22/21 11:13 AM, Stephen H. Dawson, DSL via R-help wrote:
>>> OK, now I get what you are suggesting.
>>>
>>> Much appreciated.
>>>
>>>
>>> Kindest Regards,
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 12/22/21 11:08 AM, Duncan Murdoch wrote:
>>>> On 22/12/2021 10:55 a.m., Stephen H. Dawson, DSL wrote:
>>>>> I see.
>>>>>
>>>>> So, we are talking taking the output into a new dataframe. I was
>>>>> hoping to have the output rendered on screen without another
>>>>> dataframe, but I can live with this option it if must occur.
>>>>>
>>>>> Am I correct the desired vertical output must first go to a dataframe?
>>>> No, that's just one option.? The other 3 don't use dataframes.
>>>>
>>>> Duncan Murdoch
>>>>>
>>>>> *Stephen Dawson, DSL*
>>>>> /Executive Strategy Consultant/
>>>>> Business & Technology
>>>>> +1 (865) 804-3454
>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>
>>>>>
>>>>> On 12/22/21 10:47 AM, Duncan Murdoch wrote:
>>>>>> On 22/12/2021 10:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>>> Thanks for the reply.
>>>>>>>
>>>>>>> Both syntax options work to render the correct (unique) output.
>>>>>>> However,
>>>>>>> the output is rendered as horizontal. What needs to happen to get
>>>>>>> the output to render vertical, please?
>>>>>> The result of those expressions is a vector of the same type as the
>>>>>> column, so your question is really about how to get a vector to
>>>>>> print one element per line.
>>>>>>
>>>>>> Probably the simplest way is to put the vector in a dataframe (or
>>>>>> matrix, or tibble, depending on which formatting you prefer). For
>>>>>> example,
>>>>>>
>>>>>>> ???? v <- c("red", "green", "blue")
>>>>>>> ???? data.frame(v)
>>>>>> ??????? v
>>>>>> 1?? red
>>>>>> 2 green
>>>>>> 3? blue
>>>>>>
>>>>>> If you want a more minimal display, try
>>>>>>
>>>>>>> cat(v, sep = "\n")
>>>>>> red
>>>>>> green
>>>>>> blue
>>>>>>
>>>>>> or
>>>>>>
>>>>>>> cat(format(v, justify = "right"), sep = "\n")
>>>>>> ??? red
>>>>>> green
>>>>>> ?? blue
>>>>>>
>>>>>> If you want this to happen when you auto-print the object, you can
>>>>>> give it a class attribute and write a function to print that class,
>>>>>> e.g.
>>>>>>
>>>>>>> ??? class(v) <- "oneperline"
>>>>>>>
>>>>>>> ???? print.oneperline <- function(x, ...) cat(format(x, justify =
>>>>>> "right"), sep = "\n")
>>>>>>> ???? v
>>>>>> ??? red
>>>>>> green
>>>>>> ?? blue
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>>
>>>>>>> *Stephen Dawson, DSL*
>>>>>>> /Executive Strategy Consultant/
>>>>>>> Business & Technology
>>>>>>> +1 (865) 804-3454
>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>
>>>>>>>
>>>>>>> On 12/21/21 11:38 AM, Duncan Murdoch wrote:
>>>>>>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>>>>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>>>>>> Thanks for the reply.
>>>>>>>>>>
>>>>>>>>>> sort(unique(Data[1]))
>>>>>>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last,
>>>>>>>>>> decreasing =
>>>>>>>>>> decreasing)) :
>>>>>>>>>> ??????? undefined columns selected
>>>>>>>>> That's the wrong syntax:? Data[1] is not "column one of Data".
>>>>>>>>> Use Data[[1]] for that, so
>>>>>>>>>
>>>>>>>>> ?????? sort(unique(Data[[1]]))
>>>>>>>> Actually, I'd probably recommend
>>>>>>>>
>>>>>>>> ???? sort(unique(Data[, 1]))
>>>>>>>>
>>>>>>>> instead.? This treats Data as a matrix rather than as a list.
>>>>>>>> Dataframes are lists that look like matrices, but to me the
>>>>>>>> matrix aspect is usually more intuitive.
>>>>>>>>
>>>>>>>> Duncan Murdoch
>>>>>>>>
>>>>>>>>> I think Rui already pointed out the typo in the quoted text
>>>>>>>>> below...
>>>>>>>>>
>>>>>>>>> Duncan Murdoch
>>>>>>>>>
>>>>>>>>>> The recommended syntax did not work, as listed above.
>>>>>>>>>>
>>>>>>>>>> What I want is the sort of distinct column output. Again, the
>>>>>>>>>> column may be text or numbers. This is a huge analysis effort
>>>>>>>>>> with data coming at me from many different sources.
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>> /Executive Strategy Consultant/ Business & Technology
>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help
>>>>>>>>>>> wrote:
>>>>>>>>>>>> Thanks everyone for the replies.
>>>>>>>>>>>>
>>>>>>>>>>>> It is clear one either needs to write a function or put the
>>>>>>>>>>>> unique entries into another dataframe.
>>>>>>>>>>>>
>>>>>>>>>>>> It seems odd R cannot sort a list of unique column entries
>>>>>>>>>>>> with ease.
>>>>>>>>>>>> Python and SQL can do it with ease.
>>>>>>>>>>> I've seen several responses that looked pretty simple. It's
>>>>>>>>>>> hard to beat sort(unique(x)), though there's a fair bit of
>>>>>>>>>>> confusion about what you actually want.? Maybe you should post
>>>>>>>>>>> an example of the code you'd use in Python?
>>>>>>>>>>>
>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>
>>>>>>>>>>>> QUESTION
>>>>>>>>>>>> Is there a simpler means than other than the unique function
>>>>>>>>>>>> to capture distinct column entries, then sort that list?
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>>>> /Executive Strategy Consultant/ Business & Technology
>>>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>>>>>>> Hello,
>>>>>>>>>>>>>
>>>>>>>>>>>>> Inline.
>>>>>>>>>>>>>
>>>>>>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help
>>>>>>>>>>>>> escreveu:
>>>>>>>>>>>>>> Thanks.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>>>>>> This is not right.
>>>>>>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax
>>>>>>>>>>>>> Data[[1]] extracts the column vector.
>>>>>>>>>>>>>
>>>>>>>>>>>>> As for my previous answer, it was not addressing the
>>>>>>>>>>>>> question, I misinterpreted it as being a question on how to
>>>>>>>>>>>>> sort by numeric order when the data is not numeric. Here is
>>>>>>>>>>>>> a, hopefully, complete answer.
>>>>>>>>>>>>> Still with package stringr.
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>>>>>>
>>>>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>>>>>>> ??????? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>>>>>>> })
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Or using Avi's suggestion of writing a function to do all
>>>>>>>>>>>>> the work and simplify the lapply loop later,
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> unisort2 <- function(vec, ...)
>>>>>>>>>>>>> stringr::str_sort(unique(vec), ...)
>>>>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Hope this helps,
>>>>>>>>>>>>>
>>>>>>>>>>>>> Rui Barradas
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>>>>>> /Executive Strategy Consultant/ Business & Technology
>>>>>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help 
>>>>>>>>>>>>>> wrote:
>>>>>>>>>>>>>>> Hi,
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Running a simple syntax set to review entries in dataframe
>>>>>>>>>>>>>>> columns.
>>>>>>>>>>>>>>> Here is the working code.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>>>>>>> describe(Data)
>>>>>>>>>>>>>>> summary(Data)
>>>>>>>>>>>>>>> unique(Data[1])
>>>>>>>>>>>>>>> unique(Data[2])
>>>>>>>>>>>>>>> unique(Data[3])
>>>>>>>>>>>>>>> unique(Data[4])
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> I would like to add sort the unique entries. The data in
>>>>>>>>>>>>>>> the various columns are not defined as numbers, but also
>>>>>>>>>>>>>>> text. I realize
>>>>>>>>>>>>>>> 1 and
>>>>>>>>>>>>>>> 10 will not sort properly, as the column is not defined as
>>>>>>>>>>>>>>> a number, but want to see what I have in the columns
>>>>>>>>>>>>>>> viewed as sorted.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> QUESTION
>>>>>>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Thanks.
>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and
>>>>>>>>>>>>>> more, see https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>>>>>> and provide commented, minimal, self-contained,
>>>>>>>>>>>>>> reproducible code.
>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more,
>>>>>>>>>>>> see
>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>>>> and provide commented, minimal, self-contained, reproducible
>>>>>>>>>>>> code.
>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>
>>>>>>
>>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Dec 22 23:43:10 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 22 Dec 2021 22:43:10 +0000
Subject: [R] for loop question in R
In-Reply-To: <d7ecd33b-c15e-d9f5-a034-6989373441bc@sapo.pt>
References: <2122195934.369982.1640192298494.ref@mail.yahoo.com>
 <2122195934.369982.1640192298494@mail.yahoo.com>
 <20211222204241.29d99eb7@Tarkus>
 <1126650868.384268.1640197136406@mail.yahoo.com>
 <d7ecd33b-c15e-d9f5-a034-6989373441bc@sapo.pt>
Message-ID: <37753dcb-568f-553e-32ac-f46440d4fa49@sapo.pt>

Hello,

There's a stupid typo in my previous post. Inline

?s 22:30 de 22/12/21, Rui Barradas escreveu:
> Hello,
> 
> y[i] and c[i] are character strings, they are not variables of data set 
> mpg.
> To get the variables, use, well, help("get").
> 
> Note that I have changed the temp dir to mine. So I created a variable 
> to hold the value
> 
> 
> tmpdir <- "c:/temp/"
> 
> for (i in seq(nrow(mac))){
>  ? mpg %>%
>  ??? filter(hwy < 35) %>%
>  ??? ggplot(aes(x = displ, y = get(y[i]), color = get(c[i]))) +
>  ??? geom_point() +
>  ??? ylab(y[i]) +
>  ??? guides(color = guide_legend(title = c[i]))
>  ? ggsave(
>  ??? paste0(tmpdir, f[i], ".jpg"),
>  ??? width = 9,
>  ??? height = 6,
>  ??? dpi = 1200,
>  ??? units = "in")
> }
> 
> 
> 
> Like Ivan said, don't rely on auto print. In order to have to open the 

Should read

In order to *avoid* to open the


Rui Barradas


> graphics files output by the loop I would have done something like the 
> following.
> 
> First create a list to hold the plots. Inside the for loop save the 
> plots in the list and explicitly print them. And use ggsave argument 
> plot. Like this, after the loop you can see what you have by printing 
> each list member.
> 
> 
> p <- vector("list", length = nrow(mac))
> for (i in seq(nrow(mac))){
>  ? mpg %>%
>  ??? filter(hwy < 35) %>%
>  ??? ggplot(aes(x = displ, y = get(y[i]), color = get(c[i]))) +
>  ??? geom_point() +
>  ??? ylab(y[i]) +
>  ??? guides(color = guide_legend(title = c[i])) -> p[[i]]
>  ? ggsave(
>  ??? paste0(tmpdir, f[i], ".jpg"),
>  ??? plot = p[[i]],
>  ??? width = 9,
>  ??? height = 6,
>  ??? dpi = 1200,
>  ??? units = "in")
> }
> 
> # See the first plot
> p[[1]]
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 18:18 de 22/12/21, Kai Yang via R-help escreveu:
>> ? Hello Eric, Jim and Ivan,
>> Many thanks all of your help. I'm a new one in R area. I may not fully 
>> understand the idea from you.? I modified my code below, I can get the 
>> plots out with correct file name, but plots? are not using correct 
>> fields' name. it use y[i], and c[i] as variables' name, does not use 
>> hwy, cyl or cty, class in ggplot statement. And there is not any error 
>> message. Could you please look into my modified code below and let me 
>> know how to modify y= y[i], color = c[i] part?
>> Thanks,
>> Kai
>>
>> y <- c("hwy","cty")
>> c <- c("cyl","class")
>> f <- c("hwy_cyl","cty_class")
>> mac <- data.frame(y,c,f)
>> for (i in seq(nrow(mac))){
>> ?? mpg %>%
>> ?? ? filter(hwy <35) %>%
>> ?? ? ggplot(aes(x = displ, y = y[i], color = c[i])) +
>> ?? ? geom_point()
>> ?? ggsave(paste0("c:/temp/",f[i],".jpg"),width = 9, height = 6, dpi = 
>> 1200, units = "in")
>> }
>>
>> ???? On Wednesday, December 22, 2021, 09:42:45 AM PST, Ivan Krylov 
>> <krylov.r00t at gmail.com> wrote:
>> ? On Wed, 22 Dec 2021 16:58:18 +0000 (UTC)
>> Kai Yang via R-help <r-help at r-project.org> wrote:
>>
>>> mpg %>%? ? filter(hwy <35) %>%?? ? ggplot(aes(x = displ, y = y[i],
>>> color = c[i])) +?? ? geom_point()
>>
>> Your code relies on R's auto-printing, where each line of code executed
>> at the top level (not in loops or functions) is run as if it was
>> wrapped in print(...the rest of the line...).
>>
>> Solution: make that print() explicit.
>>
>> A better solution: explicitly pass the plot object returned by the
>> ggplot functions to the ggsave() function instead of relying on the
>> global state of the program.
>>
>>> ggsave("c:/temp/f[i].jpg",width = 9, height = 6, dpi = 1200, units =
>>> "in")
>>
>> When you type "c:/temp/f[i].jpg", what do you get in return?
>>
>> Use paste0() or sprintf() to compose strings out of parts.
>>
>>> ???? [[alternative HTML version deleted]]
>>
>> P.S. Please compose your messages in plain text, not HTML. See the
>> R-help posting guide for more info.
>>
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From y@ngk@|9999 @end|ng |rom y@hoo@com  Wed Dec 22 23:57:38 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Wed, 22 Dec 2021 22:57:38 +0000 (UTC)
Subject: [R] for loop question in R
In-Reply-To: <d7ecd33b-c15e-d9f5-a034-6989373441bc@sapo.pt>
References: <2122195934.369982.1640192298494.ref@mail.yahoo.com>
 <2122195934.369982.1640192298494@mail.yahoo.com>
 <20211222204241.29d99eb7@Tarkus>
 <1126650868.384268.1640197136406@mail.yahoo.com>
 <d7ecd33b-c15e-d9f5-a034-6989373441bc@sapo.pt>
Message-ID: <43263280.436926.1640213858980@mail.yahoo.com>

 Hi Rui and Ivan,Thank you explain of the code for me in detail. This is very helpful. And the code works well now.Happy Holiday,Kai
    On Wednesday, December 22, 2021, 02:30:49 PM PST, Rui Barradas <ruipbarradas at sapo.pt> wrote:  
 
 Hello,

y[i] and c[i] are character strings, they are not variables of data set mpg.
To get the variables, use, well, help("get").

Note that I have changed the temp dir to mine. So I created a variable 
to hold the value


tmpdir <- "c:/temp/"

for (i in seq(nrow(mac))){
? mpg %>%
? ? filter(hwy < 35) %>%
? ? ggplot(aes(x = displ, y = get(y[i]), color = get(c[i]))) +
? ? geom_point() +
? ? ylab(y[i]) +
? ? guides(color = guide_legend(title = c[i]))
? ggsave(
? ? paste0(tmpdir, f[i], ".jpg"),
? ? width = 9,
? ? height = 6,
? ? dpi = 1200,
? ? units = "in")
}



Like Ivan said, don't rely on auto print. In order to have to open the 
graphics files output by the loop I would have done something like the 
following.

First create a list to hold the plots. Inside the for loop save the 
plots in the list and explicitly print them. And use ggsave argument 
plot. Like this, after the loop you can see what you have by printing 
each list member.


p <- vector("list", length = nrow(mac))
for (i in seq(nrow(mac))){
? mpg %>%
? ? filter(hwy < 35) %>%
? ? ggplot(aes(x = displ, y = get(y[i]), color = get(c[i]))) +
? ? geom_point() +
? ? ylab(y[i]) +
? ? guides(color = guide_legend(title = c[i])) -> p[[i]]
? ggsave(
? ? paste0(tmpdir, f[i], ".jpg"),
? ? plot = p[[i]],
? ? width = 9,
? ? height = 6,
? ? dpi = 1200,
? ? units = "in")
}

# See the first plot
p[[1]]


Hope this helps,

Rui Barradas

?s 18:18 de 22/12/21, Kai Yang via R-help escreveu:
>? Hello Eric, Jim and Ivan,
> Many thanks all of your help. I'm a new one in R area. I may not fully understand the idea from you.? I modified my code below, I can get the plots out with correct file name, but plots? are not using correct fields' name. it use y[i], and c[i] as variables' name, does not use hwy, cyl or cty, class in ggplot statement. And there is not any error message. Could you please look into my modified code below and let me know how to modify y= y[i], color = c[i] part?
> Thanks,
> Kai
> 
> y <- c("hwy","cty")
> c <- c("cyl","class")
> f <- c("hwy_cyl","cty_class")
> mac <- data.frame(y,c,f)
> for (i in seq(nrow(mac))){
>? ? mpg %>%
>? ? ? filter(hwy <35) %>%
>? ? ? ggplot(aes(x = displ, y = y[i], color = c[i])) +
>? ? ? geom_point()
>? ? ggsave(paste0("c:/temp/",f[i],".jpg"),width = 9, height = 6, dpi = 1200, units = "in")
> }
> 
>? ? ? On Wednesday, December 22, 2021, 09:42:45 AM PST, Ivan Krylov <krylov.r00t at gmail.com> wrote:
>? 
>? On Wed, 22 Dec 2021 16:58:18 +0000 (UTC)
> Kai Yang via R-help <r-help at r-project.org> wrote:
> 
>> mpg %>%? ? filter(hwy <35) %>%?? ? ggplot(aes(x = displ, y = y[i],
>> color = c[i])) +?? ? geom_point()
> 
> Your code relies on R's auto-printing, where each line of code executed
> at the top level (not in loops or functions) is run as if it was
> wrapped in print(...the rest of the line...).
> 
> Solution: make that print() explicit.
> 
> A better solution: explicitly pass the plot object returned by the
> ggplot functions to the ggsave() function instead of relying on the
> global state of the program.
> 
>> ggsave("c:/temp/f[i].jpg",width = 9, height = 6, dpi = 1200, units =
>> "in")
> 
> When you type "c:/temp/f[i].jpg", what do you get in return?
> 
> Use paste0() or sprintf() to compose strings out of parts.
> 
>>? ??? [[alternative HTML version deleted]]
> 
> P.S. Please compose your messages in plain text, not HTML. See the
> R-help posting guide for more info.
> 
  
	[[alternative HTML version deleted]]


From jwd @end|ng |rom @urewe@t@net  Thu Dec 23 00:04:05 2021
From: jwd @end|ng |rom @urewe@t@net (John Dougherty)
Date: Wed, 22 Dec 2021 15:04:05 -0800
Subject: [R] Creating NA equivalent
In-Reply-To: <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
References: <977561d4-86af-69a7-de39-f53a0e2dfd92.ref@yahoo.fr>
 <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
Message-ID: <20211222150405.566f3bef.jwd@surewest.net>

On Tue, 21 Dec 2021 05:41:31 +0100
Marc Girondot via R-help <r-help at r-project.org> wrote:

> Dear members,
> 
> I work about dosage and some values are bellow the detection limit. I 
> would like create new "numbers" like LDL (to represent lower than 
> detection limit) and UDL (upper the detection limit) that behave like 
> NA, with the possibility to test them using for example is.LDL() or 
> is.UDL().
> 
> Note that NA is not the same than LDL or UDL: NA represent missing
> data. Here the data is available as LDL or UDL.
> 
> NA is built in R language very deep... any option to create new
> version of NA-equivalent ?
> 
> Thanks
> 
> Marc

You are concerned with a distinct quality in the data with respect to a
specific method. You might want to code a qualitative variable that
defines the detectability state of the specific reading.  Then filter on
the state of interest, and as a means of establishing the quality of the
method or the data, summarize the detection properties in your sample
for the anaytical method employed. I had an engineer tell me flatly
that the measures claimed in a paper were "impossible."  The method
used was already common, but his system was not sensitive enough.  

As far as the statistical properties go, there are measures that could
be made and measures that could not be made.  If a different method
became available, you would probably still desire to either reanalyze
the older data employing the new method, or append new measures where
they were previously unavailable. Either way you encounter
data range or compatibility issues that have to be addressed
methodologically.


From dw|n@em|u@ @end|ng |rom comc@@t@net  Thu Dec 23 01:15:17 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Wed, 22 Dec 2021 16:15:17 -0800
Subject: [R] Speed up studentized confidence intervals ?
In-Reply-To: <721769419.5879847.1639914338826@mail.yahoo.com>
References: <721769419.5879847.1639914338826@mail.yahoo.com>
Message-ID: <AB132323-C2CE-4350-8716-0E0EE645D690@comcast.net>

I?m wondering if this is an X-Y problem. (A request to do X when the real problem should be doing Y. ) You haven?t explained the goals in natural or mathematical language which is leaving me to wonder why you are doing either sampling or replication (much less doing both within each iteration in the the function given to boot. )

? 
David

Sent from my iPhone

> On Dec 19, 2021, at 3:50 AM, varin sacha via R-help <r-help at r-project.org> wrote:
> 
> ?Dear R-experts,
> 
> Here below my R code working but really really slowly ! I need 2 hours with my computer to finally get an answer ! Is there a way to improve my R code to speed it up ? At least to win 1 hour ;=)
> 
> Many thanks
> 
> ########################################################
> library(boot)
> 
> s<- sample(178:798, 100000, replace=TRUE)
> mean(s)
> 
> N <- 1000
> out <- replicate(N, {
> a<- sample(s,size=5)
> mean(a)
> dat<-data.frame(a)
> 
> med<-function(d,i) {
> temp<-d[i,]
> f<-mean(temp)
> g<-var(replicate(50,mean(sample(temp,replace=T))))
> return(c(f,g))
> 
> }
> 
>   boot.out <- boot(data = dat, statistic = med, R = 10000)
>   boot.ci(boot.out, type = "stud")$stud[, 4:5]
> })
> mean(out[1,] < mean(s) & mean(s) < out[2,]) 
> ########################################################
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m@rn@@w@g|ey @end|ng |rom gm@||@com  Thu Dec 23 07:22:32 2021
From: m@rn@@w@g|ey @end|ng |rom gm@||@com (Marna Wagley)
Date: Wed, 22 Dec 2021 22:22:32 -0800
Subject: [R] able to estimate in the excel but not in R, any suggestion?
Message-ID: <CAMwU6B0PyDgRNAD18+bTgFb90q1BVt45VJdihuHBDpv0n86C0g@mail.gmail.com>

Hi R users,
I was trying to estimate some values in r but could not figure out how to
write the script in r. Although I was able to estimate it correctly in the
excel. For example I have the following data set.

daT<-structure(list(sd = c(0.481, 0.682, 0.741, 0.394, 0.2, 0.655, 0.375),
mcd = c(51.305, 51.284, 51.249, 51.2, 51.137, 51.059, 50.968), ca =
c(49.313, 69.985, 75.914, 40.303, 20.493, 66.905,38.185)), class =
"data.frame", row.names = c(NA, -7L))
head(daT)

In this data set, I need to estimate in the column name "ca", In the excel
I estimated the value using the following formula:
IF(A2>B2*2,PI()*B2^2,((0.5*A2)*SQRT(B2^2-(0.5*A2)^2)+B2^2*ASIN((0.5*A2)/B2))*2)

But when I wrote the following code in the R, it did not work
attach(daT)
daT$ca<-if(sd>mcd*2,pi()*mcd^2,((0.5*sd)*sqrt(mcd^2-(0.5*sd)^2)+mcd^2*asin((0.5*sd)/mcd))*2)

Your suggestion would be highly appreciated.

Sincerely,

MW

	[[alternative HTML version deleted]]


From jho|tm@n @end|ng |rom gm@||@com  Thu Dec 23 07:57:15 2021
From: jho|tm@n @end|ng |rom gm@||@com (jim holtman)
Date: Wed, 22 Dec 2021 22:57:15 -0800
Subject: [R] able to estimate in the excel but not in R, any suggestion?
In-Reply-To: <CAMwU6B0PyDgRNAD18+bTgFb90q1BVt45VJdihuHBDpv0n86C0g@mail.gmail.com>
References: <CAMwU6B0PyDgRNAD18+bTgFb90q1BVt45VJdihuHBDpv0n86C0g@mail.gmail.com>
Message-ID: <CAAxdm-49zqKi2EF23qFR+YjFn5nUrWBkDbmPpr3OUaz3qKRbVQ@mail.gmail.com>

You need to use the 'ifelse' function.  I think I copied down your
formula and here is the output:

> daT<-structure(list(sd = c(0.481, 0.682, 0.741, 0.394, 0.2, 0.655, 0.375),
+ mcd = c(51.305, 51.284, 51.249, 51.2, 51.137, 51.059, 50.968), ca =
+ c(49.313, 69.985, 75.914, 40.303, 20.493, 66.905,38.185)), class =
+ "data.frame", row.names = c(NA, -7L))
> head(daT)
     sd    mcd     ca
1 0.481 51.305 49.313
2 0.682 51.284 69.985
3 0.741 51.249 75.914
4 0.394 51.200 40.303
5 0.200 51.137 20.493
6 0.655 51.059 66.905
>
> # add in a new column with the calculation
>
> daT$ca_1 <- with(daT,
+    ifelse(sd > mcd * 2,
+           pi * mcd ^ 2,
+           (0.5 * sd) * sqrt(mcd^2 - (0.5 * sd)^2) +
+               mcd^2 * asin((0.5 * sd) / (mcd)) * 2
+           )
+     )
>
> daT
     sd    mcd     ca     ca_1
1 0.481 51.305 49.313 37.01651
2 0.682 51.284 69.985 52.46340
3 0.741 51.249 75.914 56.96310
4 0.394 51.200 40.303 30.25918
5 0.200 51.137 20.493 15.34110
6 0.655 51.059 66.905 50.16535
7 0.375 50.968 38.185 28.66948
>


Thanks

Jim Holtman
Data Munger Guru

What is the problem that you are trying to solve?
Tell me what you want to do, not how you want to do it.

On Wed, Dec 22, 2021 at 10:23 PM Marna Wagley <marna.wagley at gmail.com> wrote:
>
> Hi R users,
> I was trying to estimate some values in r but could not figure out how to
> write the script in r. Although I was able to estimate it correctly in the
> excel. For example I have the following data set.
>
> daT<-structure(list(sd = c(0.481, 0.682, 0.741, 0.394, 0.2, 0.655, 0.375),
> mcd = c(51.305, 51.284, 51.249, 51.2, 51.137, 51.059, 50.968), ca =
> c(49.313, 69.985, 75.914, 40.303, 20.493, 66.905,38.185)), class =
> "data.frame", row.names = c(NA, -7L))
> head(daT)
>
> In this data set, I need to estimate in the column name "ca", In the excel
> I estimated the value using the following formula:
> IF(A2>B2*2,PI()*B2^2,((0.5*A2)*SQRT(B2^2-(0.5*A2)^2)+B2^2*ASIN((0.5*A2)/B2))*2)
>
> But when I wrote the following code in the R, it did not work
> attach(daT)
> daT$ca<-if(sd>mcd*2,pi()*mcd^2,((0.5*sd)*sqrt(mcd^2-(0.5*sd)^2)+mcd^2*asin((0.5*sd)/mcd))*2)
>
> Your suggestion would be highly appreciated.
>
> Sincerely,
>
> MW
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m@rn@@w@g|ey @end|ng |rom gm@||@com  Thu Dec 23 08:12:39 2021
From: m@rn@@w@g|ey @end|ng |rom gm@||@com (Marna Wagley)
Date: Wed, 22 Dec 2021 23:12:39 -0800
Subject: [R] able to estimate in the excel but not in R, any suggestion?
In-Reply-To: <CAAxdm-49zqKi2EF23qFR+YjFn5nUrWBkDbmPpr3OUaz3qKRbVQ@mail.gmail.com>
References: <CAMwU6B0PyDgRNAD18+bTgFb90q1BVt45VJdihuHBDpv0n86C0g@mail.gmail.com>
 <CAAxdm-49zqKi2EF23qFR+YjFn5nUrWBkDbmPpr3OUaz3qKRbVQ@mail.gmail.com>
Message-ID: <CAMwU6B1ZnqLZKf0sBq1+_+h_Gpo9YN1WzczdrGYT3WFb3iuRfg@mail.gmail.com>

Dear Jim,
Thank you very much for the help. The code seems to be right. Using this
code, I got exactly the same value as the excel's value.
This is great.
Thanks
MW

On Wed, Dec 22, 2021 at 10:57 PM jim holtman <jholtman at gmail.com> wrote:

> You need to use the 'ifelse' function.  I think I copied down your
> formula and here is the output:
>
> > daT<-structure(list(sd = c(0.481, 0.682, 0.741, 0.394, 0.2, 0.655,
> 0.375),
> + mcd = c(51.305, 51.284, 51.249, 51.2, 51.137, 51.059, 50.968), ca =
> + c(49.313, 69.985, 75.914, 40.303, 20.493, 66.905,38.185)), class =
> + "data.frame", row.names = c(NA, -7L))
> > head(daT)
>      sd    mcd     ca
> 1 0.481 51.305 49.313
> 2 0.682 51.284 69.985
> 3 0.741 51.249 75.914
> 4 0.394 51.200 40.303
> 5 0.200 51.137 20.493
> 6 0.655 51.059 66.905
> >
> > # add in a new column with the calculation
> >
> > daT$ca_1 <- with(daT,
> +    ifelse(sd > mcd * 2,
> +           pi * mcd ^ 2,
> +           (0.5 * sd) * sqrt(mcd^2 - (0.5 * sd)^2) +
> +               mcd^2 * asin((0.5 * sd) / (mcd)) * 2
> +           )
> +     )
> >
> > daT
>      sd    mcd     ca     ca_1
> 1 0.481 51.305 49.313 37.01651
> 2 0.682 51.284 69.985 52.46340
> 3 0.741 51.249 75.914 56.96310
> 4 0.394 51.200 40.303 30.25918
> 5 0.200 51.137 20.493 15.34110
> 6 0.655 51.059 66.905 50.16535
> 7 0.375 50.968 38.185 28.66948
> >
>
>
> Thanks
>
> Jim Holtman
> Data Munger Guru
>
> What is the problem that you are trying to solve?
> Tell me what you want to do, not how you want to do it.
>
> On Wed, Dec 22, 2021 at 10:23 PM Marna Wagley <marna.wagley at gmail.com>
> wrote:
> >
> > Hi R users,
> > I was trying to estimate some values in r but could not figure out how to
> > write the script in r. Although I was able to estimate it correctly in
> the
> > excel. For example I have the following data set.
> >
> > daT<-structure(list(sd = c(0.481, 0.682, 0.741, 0.394, 0.2, 0.655,
> 0.375),
> > mcd = c(51.305, 51.284, 51.249, 51.2, 51.137, 51.059, 50.968), ca =
> > c(49.313, 69.985, 75.914, 40.303, 20.493, 66.905,38.185)), class =
> > "data.frame", row.names = c(NA, -7L))
> > head(daT)
> >
> > In this data set, I need to estimate in the column name "ca", In the
> excel
> > I estimated the value using the following formula:
> >
> IF(A2>B2*2,PI()*B2^2,((0.5*A2)*SQRT(B2^2-(0.5*A2)^2)+B2^2*ASIN((0.5*A2)/B2))*2)
> >
> > But when I wrote the following code in the R, it did not work
> > attach(daT)
> >
> daT$ca<-if(sd>mcd*2,pi()*mcd^2,((0.5*sd)*sqrt(mcd^2-(0.5*sd)^2)+mcd^2*asin((0.5*sd)/mcd))*2)
> >
> > Your suggestion would be highly appreciated.
> >
> > Sincerely,
> >
> > MW
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @k@h@y_e4 @end|ng |rom hotm@||@com  Thu Dec 23 08:14:45 2021
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Thu, 23 Dec 2021 07:14:45 +0000
Subject: [R] problem with switching windows in RSelenium..
Message-ID: <PU4P216MB15683234F58F214BAD2C6AAFC87E9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

dear Kim,
                Hope you are doing well.

I am Akshay, from bengaluru, INDIA. I am stock trader and am using R for my research. More specifically, I am using RSelenium to scrape news articles. I am stuck in the problem related to RSelenium.

I am not able to switch windows in Rselenium 1.7.7 ( I am using chrome) . My situation is exactly as described in this link: https://github.com/ropensci/RSelenium/issues/143
I also referred to this link:   https://github.com/ropensci/RSelenium/issues/205
I have three questions:


  1.  Please refer to the second link. I ran the following command as suggested in that link:
  2.  > binman::list_versions("chromedriver")
$win32
[1] "96.0.4664.45" "97.0.4692.20" "97.0.4692.36"

          I am currently using the first option. Will i be lucky if I switch to either the second or the third option? Or to any other version? Also, I suppose the versions are for 32 bit($win32 above). Again, will I be lucky if I switch to 64bit versions? If yes, how do you switch to 64 bit versions? (I am using AWS EC2 windows instance which is 64 bit system)

        2. Please refer to the first link. I have read in the comments that the myswitch function works in these cases. The solution was presented in 2017. Will myswitch still be valid in December 2021? If not, can you please give me a modified version?

        3. My Rselenium session gets terminated after some period of inactivity. How can I change that?

Your help will be highly appreciated.

Thanking You,
Yours sincerely,
AKSHAY M KULKARNI


	[[alternative HTML version deleted]]


From @erv|ce @end|ng |rom @hd@w@on@com  Thu Dec 23 11:36:34 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Thu, 23 Dec 2021 05:36:34 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <4128b1aa-af72-9385-355e-96dc8166f1c4@sapo.pt>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <8f4efdcb-57bc-2922-7f96-753af38d1c0b@shdawson.com>
 <dead8a81-9ad7-2df3-f97c-ff8fb3f1b903@gmail.com>
 <f99ab582-0902-614a-3824-1dc606b944c1@shdawson.com>
 <36bb5a89-42fa-9108-4798-3d3ac5698d1e@gmail.com>
 <b375b182-bdfb-171d-76e9-8bad2686f0dc@shdawson.com>
 <46338490-263d-d026-2017-333f61734646@shdawson.com>
 <018301d7f75a$02757b50$076071f0$@verizon.net>
 <393012d3-c0cb-3fb9-326a-ef4a03d51a7a@shdawson.com>
 <4128b1aa-af72-9385-355e-96dc8166f1c4@sapo.pt>
Message-ID: <a2df5e8b-6a5c-f43c-04e4-82d125ff6fc9@shdawson.com>

Yes, I saw the period character is where the problem occurred. However, 
I decided to loop back with the poster to close the discussion loop.


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/22/21 5:37 PM, Rui Barradas wrote:
> Hello,
>
> The error is a simple typo, instead of the period after 
> names(Data[,1]), it should be a comma.
>
> cat(format(names(Data[,1]), "\n", v1, justify = "right"), sep = "\n")
>
> (And the error message accurately points out where the error is, in 
> these cases try to read the instruction more carefully, typos can be 
> hard to find.)
>
>
> Hope this helps,
>
> Rui Barradas
>
> ?s 17:59 de 22/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>> Thanks.
>>
>> I am pondering label names, not set on one as of yet. I like your 
>> recommendation.
>>
>>
>> ?> cat(format(names(Data[,1]). "\n", v1, justify = "right"), sep = "\n")
>> Error: unexpected symbol in "cat(format(names(Data[,1])."
>> ?>
>>
>> Your proposed syntax has an error.
>>
>> QUESTION
>> Can you identify the error and reply with another recommendation, 
>> please?
>>
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 12/22/21 12:33 PM, Avi Gross via R-help wrote:
>>> Stephen,
>>>
>>> Why should there be a column header when you take your data and 
>>> reformat it?
>>>
>>> cat(format(v1, justify = "right"), sep = "\n")
>>>
>>> The above is no longer your original data structure and has 
>>> specified what you want printed. Your column header and other names 
>>> associated with your original data.frame are stored as attributes 
>>> that you sort of discarded.
>>>
>>> The name you want is associated not with v1 but with what you call 
>>> Data[,1] and you can get that name using names(Data[,1]) and put it 
>>> where you want. In your case, if you want the single line above your 
>>> values to have that name, this would do it:
>>>
>>> cat(format(names(Data[,1]). "\n", v1, justify = "right"), sep = "\n")
>>>
>>> -----Original Message-----
>>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. 
>>> Dawson, DSL via R-help
>>> Sent: Wednesday, December 22, 2021 12:02 PM
>>> To: Duncan Murdoch <murdoch.duncan at gmail.com>; Rui Barradas 
>>> <ruipbarradas at sapo.pt>; Stephen H. Dawson, DSL via R-help 
>>> <r-help at r-project.org>
>>> Subject: Re: [R] Adding SORT to UNIQUE
>>>
>>> Data <- read.csv("./input/Source.csv", header=T)
>>> v1 <- sort(unique(Data[, 1]))
>>> cat(format(v1, justify = "right"), sep = "\n")
>>>
>>> OK, working with the options you presented. This is the combination 
>>> where I gain the most benefit.
>>>
>>> However, there is no listing of a column header with the output of 
>>> this syntax.
>>>
>>> ? > cat(format(v1, justify = "right"), sep = "\n")
>>> ?? 2
>>> ?? 3
>>> ?? 4
>>> ?? 5
>>> ?? 6
>>> ?? 7
>>> ?? 8
>>> ?? 9
>>> 10
>>> ? >
>>>
>>> NOTE
>>> The output here is correct (unique) based on the entries from the 
>>> column.
>>>
>>> QUESTION
>>> How does one add a text label of something as simple as v1 to the 
>>> vertical output of this syntax, please?
>>>
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 12/22/21 11:13 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>> OK, now I get what you are suggesting.
>>>>
>>>> Much appreciated.
>>>>
>>>>
>>>> Kindest Regards,
>>>> *Stephen Dawson, DSL*
>>>> /Executive Strategy Consultant/
>>>> Business & Technology
>>>> +1 (865) 804-3454
>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>
>>>>
>>>> On 12/22/21 11:08 AM, Duncan Murdoch wrote:
>>>>> On 22/12/2021 10:55 a.m., Stephen H. Dawson, DSL wrote:
>>>>>> I see.
>>>>>>
>>>>>> So, we are talking taking the output into a new dataframe. I was
>>>>>> hoping to have the output rendered on screen without another
>>>>>> dataframe, but I can live with this option it if must occur.
>>>>>>
>>>>>> Am I correct the desired vertical output must first go to a 
>>>>>> dataframe?
>>>>> No, that's just one option.? The other 3 don't use dataframes.
>>>>>
>>>>> Duncan Murdoch
>>>>>>
>>>>>> *Stephen Dawson, DSL*
>>>>>> /Executive Strategy Consultant/
>>>>>> Business & Technology
>>>>>> +1 (865) 804-3454
>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>
>>>>>>
>>>>>> On 12/22/21 10:47 AM, Duncan Murdoch wrote:
>>>>>>> On 22/12/2021 10:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>>>> Thanks for the reply.
>>>>>>>>
>>>>>>>> Both syntax options work to render the correct (unique) output.
>>>>>>>> However,
>>>>>>>> the output is rendered as horizontal. What needs to happen to get
>>>>>>>> the output to render vertical, please?
>>>>>>> The result of those expressions is a vector of the same type as the
>>>>>>> column, so your question is really about how to get a vector to
>>>>>>> print one element per line.
>>>>>>>
>>>>>>> Probably the simplest way is to put the vector in a dataframe (or
>>>>>>> matrix, or tibble, depending on which formatting you prefer). For
>>>>>>> example,
>>>>>>>
>>>>>>>> ???? v <- c("red", "green", "blue")
>>>>>>>> ???? data.frame(v)
>>>>>>> ??????? v
>>>>>>> 1?? red
>>>>>>> 2 green
>>>>>>> 3? blue
>>>>>>>
>>>>>>> If you want a more minimal display, try
>>>>>>>
>>>>>>>> cat(v, sep = "\n")
>>>>>>> red
>>>>>>> green
>>>>>>> blue
>>>>>>>
>>>>>>> or
>>>>>>>
>>>>>>>> cat(format(v, justify = "right"), sep = "\n")
>>>>>>> ??? red
>>>>>>> green
>>>>>>> ?? blue
>>>>>>>
>>>>>>> If you want this to happen when you auto-print the object, you can
>>>>>>> give it a class attribute and write a function to print that class,
>>>>>>> e.g.
>>>>>>>
>>>>>>>> ??? class(v) <- "oneperline"
>>>>>>>>
>>>>>>>> ???? print.oneperline <- function(x, ...) cat(format(x, justify =
>>>>>>> "right"), sep = "\n")
>>>>>>>> ???? v
>>>>>>> ??? red
>>>>>>> green
>>>>>>> ?? blue
>>>>>>>
>>>>>>> Duncan Murdoch
>>>>>>>
>>>>>>>>
>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>> /Executive Strategy Consultant/
>>>>>>>> Business & Technology
>>>>>>>> +1 (865) 804-3454
>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>
>>>>>>>>
>>>>>>>> On 12/21/21 11:38 AM, Duncan Murdoch wrote:
>>>>>>>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>>>>>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>>>>>>> Thanks for the reply.
>>>>>>>>>>>
>>>>>>>>>>> sort(unique(Data[1]))
>>>>>>>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last,
>>>>>>>>>>> decreasing =
>>>>>>>>>>> decreasing)) :
>>>>>>>>>>> ??????? undefined columns selected
>>>>>>>>>> That's the wrong syntax:? Data[1] is not "column one of Data".
>>>>>>>>>> Use Data[[1]] for that, so
>>>>>>>>>>
>>>>>>>>>> ?????? sort(unique(Data[[1]]))
>>>>>>>>> Actually, I'd probably recommend
>>>>>>>>>
>>>>>>>>> ???? sort(unique(Data[, 1]))
>>>>>>>>>
>>>>>>>>> instead.? This treats Data as a matrix rather than as a list.
>>>>>>>>> Dataframes are lists that look like matrices, but to me the
>>>>>>>>> matrix aspect is usually more intuitive.
>>>>>>>>>
>>>>>>>>> Duncan Murdoch
>>>>>>>>>
>>>>>>>>>> I think Rui already pointed out the typo in the quoted text
>>>>>>>>>> below...
>>>>>>>>>>
>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>
>>>>>>>>>>> The recommended syntax did not work, as listed above.
>>>>>>>>>>>
>>>>>>>>>>> What I want is the sort of distinct column output. Again, the
>>>>>>>>>>> column may be text or numbers. This is a huge analysis effort
>>>>>>>>>>> with data coming at me from many different sources.
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>>> /Executive Strategy Consultant/ Business & Technology
>>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>>>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help
>>>>>>>>>>>> wrote:
>>>>>>>>>>>>> Thanks everyone for the replies.
>>>>>>>>>>>>>
>>>>>>>>>>>>> It is clear one either needs to write a function or put the
>>>>>>>>>>>>> unique entries into another dataframe.
>>>>>>>>>>>>>
>>>>>>>>>>>>> It seems odd R cannot sort a list of unique column entries
>>>>>>>>>>>>> with ease.
>>>>>>>>>>>>> Python and SQL can do it with ease.
>>>>>>>>>>>> I've seen several responses that looked pretty simple. It's
>>>>>>>>>>>> hard to beat sort(unique(x)), though there's a fair bit of
>>>>>>>>>>>> confusion about what you actually want. Maybe you should post
>>>>>>>>>>>> an example of the code you'd use in Python?
>>>>>>>>>>>>
>>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>>
>>>>>>>>>>>>> QUESTION
>>>>>>>>>>>>> Is there a simpler means than other than the unique function
>>>>>>>>>>>>> to capture distinct column entries, then sort that list?
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>>>>> /Executive Strategy Consultant/ Business & Technology
>>>>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>>>>>>>> Hello,
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Inline.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help
>>>>>>>>>>>>>> escreveu:
>>>>>>>>>>>>>>> Thanks.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>>>>>>> This is not right.
>>>>>>>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax
>>>>>>>>>>>>>> Data[[1]] extracts the column vector.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> As for my previous answer, it was not addressing the
>>>>>>>>>>>>>> question, I misinterpreted it as being a question on how to
>>>>>>>>>>>>>> sort by numeric order when the data is not numeric. Here is
>>>>>>>>>>>>>> a, hopefully, complete answer.
>>>>>>>>>>>>>> Still with package stringr.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>>>>>>>> ??????? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>>>>>>>> })
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Or using Avi's suggestion of writing a function to do all
>>>>>>>>>>>>>> the work and simplify the lapply loop later,
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> unisort2 <- function(vec, ...)
>>>>>>>>>>>>>> stringr::str_sort(unique(vec), ...)
>>>>>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Hope this helps,
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> Rui Barradas
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>>>>>>> /Executive Strategy Consultant/ Business & Technology
>>>>>>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help 
>>>>>>>>>>>>>>> wrote:
>>>>>>>>>>>>>>>> Hi,
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Running a simple syntax set to review entries in dataframe
>>>>>>>>>>>>>>>> columns.
>>>>>>>>>>>>>>>> Here is the working code.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>>>>>>>> describe(Data)
>>>>>>>>>>>>>>>> summary(Data)
>>>>>>>>>>>>>>>> unique(Data[1])
>>>>>>>>>>>>>>>> unique(Data[2])
>>>>>>>>>>>>>>>> unique(Data[3])
>>>>>>>>>>>>>>>> unique(Data[4])
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> I would like to add sort the unique entries. The data in
>>>>>>>>>>>>>>>> the various columns are not defined as numbers, but also
>>>>>>>>>>>>>>>> text. I realize
>>>>>>>>>>>>>>>> 1 and
>>>>>>>>>>>>>>>> 10 will not sort properly, as the column is not defined as
>>>>>>>>>>>>>>>> a number, but want to see what I have in the columns
>>>>>>>>>>>>>>>> viewed as sorted.
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> QUESTION
>>>>>>>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>> Thanks.
>>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and
>>>>>>>>>>>>>>> more, see https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>>>>>>> and provide commented, minimal, self-contained,
>>>>>>>>>>>>>>> reproducible code.
>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more,
>>>>>>>>>>>>> see
>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>>>>> and provide commented, minimal, self-contained, reproducible
>>>>>>>>>>>>> code.
>>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>
>>>>>>>
>>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide 
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide 
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>


From @erv|ce @end|ng |rom @hd@w@on@com  Thu Dec 23 12:03:57 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Thu, 23 Dec 2021 06:03:57 -0500
Subject: [R] Script Run Output Capturing
Message-ID: <f2fc14b2-cd07-a2d0-b46d-868227e8313c@shdawson.com>

Hi,


I need to capture the output in a physical file when I run an R script. 
I would like to capture the output as a TXT file. I am thinking 
something along the line of the tee command is what I am after, but I am 
not certain what I am after here.

https://en.wikipedia.org/wiki/Tee_(command)

https://www.gnu.org/software/coreutils/manual/html_node/tee-invocation.html


Here is a syntax example of how I use the tee command on other efforts 
of life:
/bin/bash ./BackUp_script-v3.sh | tee -a ~/Desktop/script-run-Sunday-1.txt


Here is a syntax example of how I am running my R scripts now:
#R Studio Console
#source("./process/script-name.r")

#Bash Terminal
#Rscript ./process/script-name.r


QUESTIONS
What command or function am I after to capture console and terminal output?

It would be best to also define the character encoding and line ending 
parameters of the TXT file. How do I amend my existing script run syntax 
to capture the said outputs?


Thanks,
-- 
*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


From @erv|ce @end|ng |rom @hd@w@on@com  Thu Dec 23 12:11:46 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Thu, 23 Dec 2021 06:11:46 -0500
Subject: [R] Error Awareness
Message-ID: <a379c1dd-9a6e-f8a0-62eb-3ba893978f8e@shdawson.com>

Hi,


I am thinking about awareness of errors when an R script runs.

My concern is I have an error-free script. I run it for months on end 
without problems. Then, something changes somewhere causing an error. My 
wonderment is how R will tell me I had an error in the script, but the 
rest of the script ran without impairment.

QUESTIONS
What are some of the more helpful options available to an R developer to 
capture errors in a script run?

What are some of the best processes to implement these more helpful options?


Thanks,
-- 
*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


From jr@| @end|ng |rom po@teo@no  Thu Dec 23 12:44:41 2021
From: jr@| @end|ng |rom po@teo@no (Rasmus Liland)
Date: Thu, 23 Dec 2021 11:44:41 +0000
Subject: [R] Script Run Output Capturing
In-Reply-To: <f2fc14b2-cd07-a2d0-b46d-868227e8313c@shdawson.com>
References: <f2fc14b2-cd07-a2d0-b46d-868227e8313c@shdawson.com>
Message-ID: <YcRhKYsLgEASsb0B@posteo.no>

Dear Stephen,

Maybe running R in batch mode is what 
you're after?  E.g. running 

	R CMD BATCH ./process/script-name.r

creates ./process/script-name.Rout (or 
./process/script-name.rout ?) with 
output of R commands and inline output, 
I think stderr (maybe others?  Not only 
stdout like tee ... 
https://en.wikipedia.org/wiki/Standard_streams )

Note, the batch output is overwritten, 
as opposed to being appended to (the tee 
-a flag) the next time you run that line 
again ... 

Best,
Rasmus


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Dec 23 14:10:31 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 23 Dec 2021 13:10:31 +0000
Subject: [R] Speed up studentized confidence intervals ?
In-Reply-To: <721769419.5879847.1639914338826@mail.yahoo.com>
References: <721769419.5879847.1639914338826.ref@mail.yahoo.com>
 <721769419.5879847.1639914338826@mail.yahoo.com>
Message-ID: <ade3d6fe-011e-7b1d-174e-d5e5dc6fa0cf@sapo.pt>

Hello,

The code is running very slowly because you are recreating the function 
in the replicate() loop and because you are creating a data.frame also 
in the loop.

And because in the bootstrap statistic function med() you are computing 
the variance of yet another loop. This is probably statistically wrong 
but like David says, without a problem description it's hard to say.

Also, why compute variances if they are never used?

Here is complete code executing in much less than 2:00 hours. Note that 
it passes the vector a directly to med(), not a df with just one column.


library(boot)

set.seed(2021)
s <- sample(178:798, 100000, replace = TRUE)
mean(s)

med <- function(d, i) {
   temp <- d[i]
   f <- mean(temp)
   g <- var(temp)
   c(Mean = f, Var = g)
}

N <- 1000
out <- replicate(N, {
   a <- sample(s, size = 5)
   boot.out <- boot(data = a, statistic = med, R = 10000)
   boot.ci(boot.out, type = "stud")$stud[, 4:5]
})
mean(out[1, ] < mean(s) & mean(s) < out[2, ])
#[1] 0.952



Hope this helps,

Rui Barradas

?s 11:45 de 19/12/21, varin sacha via R-help escreveu:
> Dear R-experts,
> 
> Here below my R code working but really really slowly ! I need 2 hours with my computer to finally get an answer ! Is there a way to improve my R code to speed it up ? At least to win 1 hour ;=)
> 
> Many thanks
> 
> ########################################################
> library(boot)
> 
> s<- sample(178:798, 100000, replace=TRUE)
> mean(s)
> 
> N <- 1000
> out <- replicate(N, {
> a<- sample(s,size=5)
> mean(a)
> dat<-data.frame(a)
> 
> med<-function(d,i) {
> temp<-d[i,]
> f<-mean(temp)
> g<-var(replicate(50,mean(sample(temp,replace=T))))
> return(c(f,g))
> 
> }
> 
>  ? boot.out <- boot(data = dat, statistic = med, R = 10000)
>  ? boot.ci(boot.out, type = "stud")$stud[, 4:5]
> })
> mean(out[1,] < mean(s) & mean(s) < out[2,])
> ########################################################
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From @erv|ce @end|ng |rom @hd@w@on@com  Thu Dec 23 14:27:56 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Thu, 23 Dec 2021 08:27:56 -0500
Subject: [R] Script Run Output Capturing
In-Reply-To: <YcRhKYsLgEASsb0B@posteo.no>
References: <f2fc14b2-cd07-a2d0-b46d-868227e8313c@shdawson.com>
 <YcRhKYsLgEASsb0B@posteo.no>
Message-ID: <ff7ad3f5-36a6-3555-25ef-4bd25c40a16a@shdawson.com>

Nice! Thanks for the reply.

I will research over the next few days.

https://www.ssc.wisc.edu/~hemken/Rworkshops/interface/savingoutput.html

How about the sink() and capture.output() functions? Have you ever used 
them?


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/23/21 6:44 AM, Rasmus Liland wrote:
> Dear Stephen,
>
> Maybe running R in batch mode is what
> you're after?  E.g. running
>
> 	R CMD BATCH ./process/script-name.r
>
> creates ./process/script-name.Rout (or
> ./process/script-name.rout ?) with
> output of R commands and inline output,
> I think stderr (maybe others?  Not only
> stdout like tee ...
> https://en.wikipedia.org/wiki/Standard_streams )
>
> Note, the batch output is overwritten,
> as opposed to being appended to (the tee
> -a flag) the next time you run that line
> again ...
>
> Best,
> Rasmus
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From jho|tm@n @end|ng |rom gm@||@com  Thu Dec 23 15:37:44 2021
From: jho|tm@n @end|ng |rom gm@||@com (jim holtman)
Date: Thu, 23 Dec 2021 06:37:44 -0800
Subject: [R] able to estimate in the excel but not in R, any suggestion?
In-Reply-To: <CAMwU6B1ZnqLZKf0sBq1+_+h_Gpo9YN1WzczdrGYT3WFb3iuRfg@mail.gmail.com>
References: <CAMwU6B0PyDgRNAD18+bTgFb90q1BVt45VJdihuHBDpv0n86C0g@mail.gmail.com>
 <CAAxdm-49zqKi2EF23qFR+YjFn5nUrWBkDbmPpr3OUaz3qKRbVQ@mail.gmail.com>
 <CAMwU6B1ZnqLZKf0sBq1+_+h_Gpo9YN1WzczdrGYT3WFb3iuRfg@mail.gmail.com>
Message-ID: <CAAxdm-6AOxYO_JZU+ufgj3SWBMRGTJuB56cw+LOd1_pPCdfNog@mail.gmail.com>

Glad to help!

Happy Holidays

Thanks

Jim Holtman
Data Munger Guru

What is the problem that you are trying to solve?
Tell me what you want to do, not how you want to do it.

On Wed, Dec 22, 2021 at 11:12 PM Marna Wagley <marna.wagley at gmail.com> wrote:
>
> Dear Jim,
> Thank you very much for the help. The code seems to be right. Using this code, I got exactly the same value as the excel's value.
> This is great.
> Thanks
> MW
>
> On Wed, Dec 22, 2021 at 10:57 PM jim holtman <jholtman at gmail.com> wrote:
>>
>> You need to use the 'ifelse' function.  I think I copied down your
>> formula and here is the output:
>>
>> > daT<-structure(list(sd = c(0.481, 0.682, 0.741, 0.394, 0.2, 0.655, 0.375),
>> + mcd = c(51.305, 51.284, 51.249, 51.2, 51.137, 51.059, 50.968), ca =
>> + c(49.313, 69.985, 75.914, 40.303, 20.493, 66.905,38.185)), class =
>> + "data.frame", row.names = c(NA, -7L))
>> > head(daT)
>>      sd    mcd     ca
>> 1 0.481 51.305 49.313
>> 2 0.682 51.284 69.985
>> 3 0.741 51.249 75.914
>> 4 0.394 51.200 40.303
>> 5 0.200 51.137 20.493
>> 6 0.655 51.059 66.905
>> >
>> > # add in a new column with the calculation
>> >
>> > daT$ca_1 <- with(daT,
>> +    ifelse(sd > mcd * 2,
>> +           pi * mcd ^ 2,
>> +           (0.5 * sd) * sqrt(mcd^2 - (0.5 * sd)^2) +
>> +               mcd^2 * asin((0.5 * sd) / (mcd)) * 2
>> +           )
>> +     )
>> >
>> > daT
>>      sd    mcd     ca     ca_1
>> 1 0.481 51.305 49.313 37.01651
>> 2 0.682 51.284 69.985 52.46340
>> 3 0.741 51.249 75.914 56.96310
>> 4 0.394 51.200 40.303 30.25918
>> 5 0.200 51.137 20.493 15.34110
>> 6 0.655 51.059 66.905 50.16535
>> 7 0.375 50.968 38.185 28.66948
>> >
>>
>>
>> Thanks
>>
>> Jim Holtman
>> Data Munger Guru
>>
>> What is the problem that you are trying to solve?
>> Tell me what you want to do, not how you want to do it.
>>
>> On Wed, Dec 22, 2021 at 10:23 PM Marna Wagley <marna.wagley at gmail.com> wrote:
>> >
>> > Hi R users,
>> > I was trying to estimate some values in r but could not figure out how to
>> > write the script in r. Although I was able to estimate it correctly in the
>> > excel. For example I have the following data set.
>> >
>> > daT<-structure(list(sd = c(0.481, 0.682, 0.741, 0.394, 0.2, 0.655, 0.375),
>> > mcd = c(51.305, 51.284, 51.249, 51.2, 51.137, 51.059, 50.968), ca =
>> > c(49.313, 69.985, 75.914, 40.303, 20.493, 66.905,38.185)), class =
>> > "data.frame", row.names = c(NA, -7L))
>> > head(daT)
>> >
>> > In this data set, I need to estimate in the column name "ca", In the excel
>> > I estimated the value using the following formula:
>> > IF(A2>B2*2,PI()*B2^2,((0.5*A2)*SQRT(B2^2-(0.5*A2)^2)+B2^2*ASIN((0.5*A2)/B2))*2)
>> >
>> > But when I wrote the following code in the R, it did not work
>> > attach(daT)
>> > daT$ca<-if(sd>mcd*2,pi()*mcd^2,((0.5*sd)*sqrt(mcd^2-(0.5*sd)^2)+mcd^2*asin((0.5*sd)/mcd))*2)
>> >
>> > Your suggestion would be highly appreciated.
>> >
>> > Sincerely,
>> >
>> > MW
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.


From jr@| @end|ng |rom po@teo@no  Thu Dec 23 16:00:33 2021
From: jr@| @end|ng |rom po@teo@no (Rasmus Liland)
Date: Thu, 23 Dec 2021 15:00:33 +0000
Subject: [R] Script Run Output Capturing
In-Reply-To: <ff7ad3f5-36a6-3555-25ef-4bd25c40a16a@shdawson.com>
References: <f2fc14b2-cd07-a2d0-b46d-868227e8313c@shdawson.com>
 <YcRhKYsLgEASsb0B@posteo.no>
 <ff7ad3f5-36a6-3555-25ef-4bd25c40a16a@shdawson.com>
Message-ID: <YcSPEdeIFDUX8oHN@posteo.no>

sink and capture.output seem 
useful, but I have not used them.  
I looked into pipe() a long time ago ...


From bgunter@4567 @end|ng |rom gm@||@com  Thu Dec 23 16:49:24 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 23 Dec 2021 07:49:24 -0800
Subject: [R] Error Awareness
In-Reply-To: <a379c1dd-9a6e-f8a0-62eb-3ba893978f8e@shdawson.com>
References: <a379c1dd-9a6e-f8a0-62eb-3ba893978f8e@shdawson.com>
Message-ID: <CAGxFJbS4O9Hg95P19Tj17HJ4MjTuRUyqGuCsFWLENnhLJkPhEw@mail.gmail.com>

?tryCatch

This list is not meant for tutorials. A web search on "find errors in
R code" brought up what appeared to be many resources to address your
question. Please make use of such resources before posting here. Also,
please read and follow the posting gui)de linked below to find out
what sort of help you can expect (and have already received here.

Cheers,
Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Thu, Dec 23, 2021 at 3:14 AM Stephen H. Dawson, DSL via R-help
<r-help at r-project.org> wrote:
>
> Hi,
>
>
> I am thinking about awareness of errors when an R script runs.
>
> My concern is I have an error-free script. I run it for months on end
> without problems. Then, something changes somewhere causing an error. My
> wonderment is how R will tell me I had an error in the script, but the
> rest of the script ran without impairment.
>
> QUESTIONS
> What are some of the more helpful options available to an R developer to
> capture errors in a script run?
>
> What are some of the best processes to implement these more helpful options?
>
>
> Thanks,
> --
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Thu Dec 23 16:54:42 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 23 Dec 2021 07:54:42 -0800
Subject: [R] Script Run Output Capturing
In-Reply-To: <ff7ad3f5-36a6-3555-25ef-4bd25c40a16a@shdawson.com>
References: <f2fc14b2-cd07-a2d0-b46d-868227e8313c@shdawson.com>
 <YcRhKYsLgEASsb0B@posteo.no>
 <ff7ad3f5-36a6-3555-25ef-4bd25c40a16a@shdawson.com>
Message-ID: <CAGxFJbTZ1c2z5A5v5ePW4=y8cm=ETdsx_QZC7kgQJ8t3ayENEA@mail.gmail.com>

?sink explicitly says:

"sink diverts R output to a connection (and stops such diversions)"

Is this not exactly what you requested? If not, why not? Have you
tried it to see?

Bert Gunter

On Thu, Dec 23, 2021 at 5:28 AM Stephen H. Dawson, DSL via R-help
<r-help at r-project.org> wrote:
>
> Nice! Thanks for the reply.
>
> I will research over the next few days.
>
> https://www.ssc.wisc.edu/~hemken/Rworkshops/interface/savingoutput.html
>
> How about the sink() and capture.output() functions? Have you ever used
> them?
>
>
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
>
> On 12/23/21 6:44 AM, Rasmus Liland wrote:
> > Dear Stephen,
> >
> > Maybe running R in batch mode is what
> > you're after?  E.g. running
> >
> >       R CMD BATCH ./process/script-name.r
> >
> > creates ./process/script-name.Rout (or
> > ./process/script-name.rout ?) with
> > output of R commands and inline output,
> > I think stderr (maybe others?  Not only
> > stdout like tee ...
> > https://en.wikipedia.org/wiki/Standard_streams )
> >
> > Note, the batch output is overwritten,
> > as opposed to being appended to (the tee
> > -a flag) the next time you run that line
> > again ...
> >
> > Best,
> > Rasmus
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @erv|ce @end|ng |rom @hd@w@on@com  Thu Dec 23 17:16:58 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Thu, 23 Dec 2021 11:16:58 -0500
Subject: [R] Error Awareness
In-Reply-To: <CAGxFJbS4O9Hg95P19Tj17HJ4MjTuRUyqGuCsFWLENnhLJkPhEw@mail.gmail.com>
References: <a379c1dd-9a6e-f8a0-62eb-3ba893978f8e@shdawson.com>
 <CAGxFJbS4O9Hg95P19Tj17HJ4MjTuRUyqGuCsFWLENnhLJkPhEw@mail.gmail.com>
Message-ID: <6ad7bcfb-8828-0572-e4f9-783945d64325@shdawson.com>

Hi Bert,


Thanks for the reply.

The use case I presented involves working code, not diagnosing a script 
in development.

The concern is running a script where something changes outside of the 
script, as I stated. An example of a change is a data source changing 
perhaps the columns in the data source, or even changing the spelling of 
a column. The point is something changes.

The question then becomes how to be aware of the change when the reset 
of the script runs fine, as I presented.

Think of having a script running daily where you are not running it 
manually. How do you know there are errors in the script processing at 
this point?

Does this question now make more sense?


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/23/21 10:49 AM, Bert Gunter wrote:
> ?tryCatch
>
> This list is not meant for tutorials. A web search on "find errors in
> R code" brought up what appeared to be many resources to address your
> question. Please make use of such resources before posting here. Also,
> please read and follow the posting gui)de linked below to find out
> what sort of help you can expect (and have already received here.
>
> Cheers,
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> On Thu, Dec 23, 2021 at 3:14 AM Stephen H. Dawson, DSL via R-help
> <r-help at r-project.org> wrote:
>> Hi,
>>
>>
>> I am thinking about awareness of errors when an R script runs.
>>
>> My concern is I have an error-free script. I run it for months on end
>> without problems. Then, something changes somewhere causing an error. My
>> wonderment is how R will tell me I had an error in the script, but the
>> rest of the script ran without impairment.
>>
>> QUESTIONS
>> What are some of the more helpful options available to an R developer to
>> capture errors in a script run?
>>
>> What are some of the best processes to implement these more helpful options?
>>
>>
>> Thanks,
>> --
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From @erv|ce @end|ng |rom @hd@w@on@com  Thu Dec 23 17:18:24 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Thu, 23 Dec 2021 11:18:24 -0500
Subject: [R] Script Run Output Capturing
In-Reply-To: <CAGxFJbTZ1c2z5A5v5ePW4=y8cm=ETdsx_QZC7kgQJ8t3ayENEA@mail.gmail.com>
References: <f2fc14b2-cd07-a2d0-b46d-868227e8313c@shdawson.com>
 <YcRhKYsLgEASsb0B@posteo.no>
 <ff7ad3f5-36a6-3555-25ef-4bd25c40a16a@shdawson.com>
 <CAGxFJbTZ1c2z5A5v5ePW4=y8cm=ETdsx_QZC7kgQJ8t3ayENEA@mail.gmail.com>
Message-ID: <e9699ca0-4e72-0097-80e8-d29d1afd96f2@shdawson.com>

I have not tired sink yet. I was asking for best processes by soliciting 
input from others who have succeeded in this effort before. My question 
is more conceptual in nature, a research point, to learn more about the 
strengths and weaknesses of options.


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/23/21 10:54 AM, Bert Gunter wrote:
> ?sink explicitly says:
>
> "sink diverts R output to a connection (and stops such diversions)"
>
> Is this not exactly what you requested? If not, why not? Have you
> tried it to see?
>
> Bert Gunter
>
> On Thu, Dec 23, 2021 at 5:28 AM Stephen H. Dawson, DSL via R-help
> <r-help at r-project.org> wrote:
>> Nice! Thanks for the reply.
>>
>> I will research over the next few days.
>>
>> https://www.ssc.wisc.edu/~hemken/Rworkshops/interface/savingoutput.html
>>
>> How about the sink() and capture.output() functions? Have you ever used
>> them?
>>
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 12/23/21 6:44 AM, Rasmus Liland wrote:
>>> Dear Stephen,
>>>
>>> Maybe running R in batch mode is what
>>> you're after?  E.g. running
>>>
>>>        R CMD BATCH ./process/script-name.r
>>>
>>> creates ./process/script-name.Rout (or
>>> ./process/script-name.rout ?) with
>>> output of R commands and inline output,
>>> I think stderr (maybe others?  Not only
>>> stdout like tee ...
>>> https://en.wikipedia.org/wiki/Standard_streams )
>>>
>>> Note, the batch output is overwritten,
>>> as opposed to being appended to (the tee
>>> -a flag) the next time you run that line
>>> again ...
>>>
>>> Best,
>>> Rasmus
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From @erv|ce @end|ng |rom @hd@w@on@com  Thu Dec 23 17:36:45 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Thu, 23 Dec 2021 11:36:45 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <00f201d7f755$4cb0b950$e6122bf0$@verizon.net>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <8f4efdcb-57bc-2922-7f96-753af38d1c0b@shdawson.com>
 <dead8a81-9ad7-2df3-f97c-ff8fb3f1b903@gmail.com>
 <f99ab582-0902-614a-3824-1dc606b944c1@shdawson.com>
 <00f201d7f755$4cb0b950$e6122bf0$@verizon.net>
Message-ID: <357907df-ca08-16fc-9488-202d33d5195d@shdawson.com>

Hi Avi,


Thanks for the reply. You bring much insight to the equation of the R 
journey. I look forward to dialoging with you.


Kindest Regards,
*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/22/21 11:59 AM, Avi Gross via R-help wrote:
> Stephen,
>
> Understanding a bit better where you are coming from, I come back to how people think about things. Languages like R often focus on doing things incrementally. I don't mean the language exactly as much as many of the people using the language.
>
> So it is perfectly normal to make multiple versions of something as you go along and let older versions no longer in use be garbage collected if needed.
>
> Your latest question was how to display your data a certain way. You want it written down the screen (or paper) rather than across. Duncan provided you with a few of the many ways to do that. Unless you are working with giant amounts of data already using up most of your available memory, it is fairly harmless to make some temporary copies that get you what you want.
>
> What you may not have known is that some of the systems in R use a concept of generic functions. In particular, when you use print() or just put a variable name on a line by itself which normally implicitly calls print() for you, it does not just magically print but examines what you asked to print and does a lookup to see  how to print it. My setup currently has 303 such methods defined with names like print.factor and print.Date and print.data.frame that are given control to print each kind of object the way you want. So one way to change how something is printed is to make it into an object for some class and let the system then print it. Of course, you can also design a new class of your own and make a print method for it and I suspect someone has done what you want in some package.
>
> Changing the class of an existing object, even a large object, is fairly inexpensive. Other attributes can also control things like "dim" specifying dimensions. Say I have a vector containing 1:5 that I want to print vertically.
>
>> vec <- 1:5
>    > vec
>    [1] 1 2 3 4 5
>
> You can see it normally prints horizontally. Transposing it might sound like a good way to go except R vectors generally do not have the concept. Transposing a vector will make a matrix which prints a biut differently but is still horizontal, but a second transpose works beter:
>
>    > class(t(vec))
>    [1] "matrix" "array"
>   
>   > t(vec)
>    [,1] [,2] [,3] [,4] [,5]
>    [1,]    1    2    3    4    5
>    
>> t(t(vec))
>    [,1]
>    [1,]    1
>    [2,]    2
>    [3,]    3
>    [4,]    4
>    [5,]    5
>
> Of course, you can probably as easily make it a matrix:
>
>    > as.matrix(vec)
>    [,1]
>    [1,]    1
>    [2,]    2
>    [3,]    3
>    [4,]    4
>    [5,]    5
>    
>    > matrix(vec, ncol=1)
>    [,1]
>    [1,]    1
>    [2,]    2
>    [3,]    3
>    [4,]    4
>    [5,]    5
>
> The above made a copy, of course.
>
> You can change the original into a matrix by just changing an attribute:
>
>    > dim(vec) <- c(length(vec), 1)
>
>    > vec
>    [,1]
>    [1,]    1
>    [2,]    2
>    [3,]    3
>    [4,]    4
>    [5,]    5
>
>    > attributes(vec)
>    $dim
>    [1] 5 1
>    
>    > class(vec)
>    [1] "matrix" "array"
>
> BUT you need to be careful as in your earlier experience. Some places that accept a vector will not accept a 1-column or 1-row matrix, or a data.frame with one column or just one row. Best to be careful about mixing.
>
> So look again at what Duncan sent and some are quite nice. You can speficically use the cat() command instead of a default print and it has added functionality. Various packages exist including some that do various kinds of pretty printing.
>
> He left out one of the simplest ones, which is simply to write your own print routine such as this loop:
>
> Here you define a trivial one-line function that calls print() multiple times to make your output vertical:
>
> vertprint <- function(horiz) for (item in horiz) print(item)
>
> for (item in horiz) print(item)
>
>    [1] 1
>    [1] 2
>    [1] 3
>    [1] 4
>    [1] 5
>
> Obviously if you are printing huge amounts of data, this is not necessarily any more efficient. But it does not necessarily make many copies of your data if that bothers you.
>
> May I end with a suggestion. It can be fun to start a discussion in a place like this but it can also be a waste of time for many people, especially those who provide longer answers and do some experimenting to illustrate. Often a simple search like the following can rapidly get you an answer before feeling the need to ask here. I did a simple search just now for what I assumed was a very frequent question:
>
> "R how to print data vertically"
>
> I looked at a few of the answers and noted a few other suggestions with one similar but different:
>
> cat(paste(x),sep="\n")
>
> And of course various packages that implemented something like print.vertical().
>
> Your earlier statement suggests you may be interested in what is the canonical or best way and by now, you may note there are very often MANY ways and some programmers prefer one or another. And, I note, after enough questions of a fairly basic or even na?ve nature, some responders in these groups stop responding for some reason.
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson, DSL via R-help
> Sent: Wednesday, December 22, 2021 10:55 AM
> To: Duncan Murdoch <murdoch.duncan at gmail.com>; Rui Barradas <ruipbarradas at sapo.pt>; Stephen H. Dawson, DSL via R-help <r-help at r-project.org>
> Subject: Re: [R] Adding SORT to UNIQUE
>
> I see.
>
> So, we are talking taking the output into a new dataframe. I was hoping to have the output rendered on screen without another dataframe, but I can live with this option it if must occur.
>
> Am I correct the desired vertical output must first go to a dataframe?
>
>
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
>
> On 12/22/21 10:47 AM, Duncan Murdoch wrote:
>> On 22/12/2021 10:20 a.m., Stephen H. Dawson, DSL wrote:
>>> Thanks for the reply.
>>>
>>> Both syntax options work to render the correct (unique) output.
>>> However, the output is rendered as horizontal. What needs to happen
>>> to get the output to render vertical, please?
>> The result of those expressions is a vector of the same type as the
>> column, so your question is really about how to get a vector to print
>> one element per line.
>>
>> Probably the simplest way is to put the vector in a dataframe (or
>> matrix, or tibble, depending on which formatting you prefer).  For
>> example,
>>
>>>    v <- c("red", "green", "blue")
>>>    data.frame(v)
>>        v
>> 1   red
>> 2 green
>> 3  blue
>>
>> If you want a more minimal display, try
>>
>>> cat(v, sep = "\n")
>> red
>> green
>> blue
>>
>> or
>>
>>> cat(format(v, justify = "right"), sep = "\n")
>>    red
>> green
>>   blue
>>
>> If you want this to happen when you auto-print the object, you can
>> give it a class attribute and write a function to print that class, e.g.
>>
>>>   class(v) <- "oneperline"
>>>
>>>    print.oneperline <- function(x, ...) cat(format(x, justify =
>> "right"), sep = "\n")
>>>    v
>>    red
>> green
>>   blue
>>
>> Duncan Murdoch
>>
>>>
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 12/21/21 11:38 AM, Duncan Murdoch wrote:
>>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>> Thanks for the reply.
>>>>>>
>>>>>> sort(unique(Data[1]))
>>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last, decreasing
>>>>>> =
>>>>>> decreasing)) :
>>>>>>        undefined columns selected
>>>>> That's the wrong syntax:  Data[1] is not "column one of Data". Use
>>>>> Data[[1]] for that, so
>>>>>
>>>>>       sort(unique(Data[[1]]))
>>>> Actually, I'd probably recommend
>>>>
>>>>     sort(unique(Data[, 1]))
>>>>
>>>> instead.  This treats Data as a matrix rather than as a list.
>>>> Dataframes are lists that look like matrices, but to me the matrix
>>>> aspect is usually more intuitive.
>>>>
>>>> Duncan Murdoch
>>>>
>>>>> I think Rui already pointed out the typo in the quoted text below...
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>> The recommended syntax did not work, as listed above.
>>>>>>
>>>>>> What I want is the sort of distinct column output. Again, the
>>>>>> column may be text or numbers. This is a huge analysis effort with
>>>>>> data coming at me from many different sources.
>>>>>>
>>>>>>
>>>>>> *Stephen Dawson, DSL*
>>>>>> /Executive Strategy Consultant/
>>>>>> Business & Technology
>>>>>> +1 (865) 804-3454
>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>
>>>>>>
>>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>> Thanks everyone for the replies.
>>>>>>>>
>>>>>>>> It is clear one either needs to write a function or put the
>>>>>>>> unique entries into another dataframe.
>>>>>>>>
>>>>>>>> It seems odd R cannot sort a list of unique column entries with
>>>>>>>> ease.
>>>>>>>> Python and SQL can do it with ease.
>>>>>>> I've seen several responses that looked pretty simple. It's hard
>>>>>>> to beat sort(unique(x)), though there's a fair bit of confusion
>>>>>>> about what you actually want.  Maybe you should post an example
>>>>>>> of the code you'd use in Python?
>>>>>>>
>>>>>>> Duncan Murdoch
>>>>>>>
>>>>>>>> QUESTION
>>>>>>>> Is there a simpler means than other than the unique function to
>>>>>>>> capture distinct column entries, then sort that list?
>>>>>>>>
>>>>>>>>
>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>> /Executive Strategy Consultant/
>>>>>>>> Business & Technology
>>>>>>>> +1 (865) 804-3454
>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>
>>>>>>>>
>>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>>> Hello,
>>>>>>>>>
>>>>>>>>> Inline.
>>>>>>>>>
>>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help escreveu:
>>>>>>>>>> Thanks.
>>>>>>>>>>
>>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>>
>>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>> This is not right.
>>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax
>>>>>>>>> Data[[1]] extracts the column vector.
>>>>>>>>>
>>>>>>>>> As for my previous answer, it was not addressing the question,
>>>>>>>>> I misinterpreted it as being a question on how to sort by
>>>>>>>>> numeric order when the data is not numeric. Here is a,
>>>>>>>>> hopefully, complete answer.
>>>>>>>>> Still with package stringr.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>>
>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>>>        stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>>> })
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Or using Avi's suggestion of writing a function to do all the
>>>>>>>>> work and simplify the lapply loop later,
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> unisort2 <- function(vec, ...) stringr::str_sort(unique(vec),
>>>>>>>>> ...)
>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Hope this helps,
>>>>>>>>>
>>>>>>>>> Rui Barradas
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>> /Executive Strategy Consultant/ Business & Technology
>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help wrote:
>>>>>>>>>>> Hi,
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Running a simple syntax set to review entries in dataframe
>>>>>>>>>>> columns.
>>>>>>>>>>> Here is the working code.
>>>>>>>>>>>
>>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>>> describe(Data)
>>>>>>>>>>> summary(Data)
>>>>>>>>>>> unique(Data[1])
>>>>>>>>>>> unique(Data[2])
>>>>>>>>>>> unique(Data[3])
>>>>>>>>>>> unique(Data[4])
>>>>>>>>>>>
>>>>>>>>>>> I would like to add sort the unique entries. The data in the
>>>>>>>>>>> various columns are not defined as numbers, but also text. I
>>>>>>>>>>> realize
>>>>>>>>>>> 1 and
>>>>>>>>>>> 10 will not sort properly, as the column is not defined as a
>>>>>>>>>>> number, but want to see what I have in the columns viewed as
>>>>>>>>>>> sorted.
>>>>>>>>>>>
>>>>>>>>>>> QUESTION
>>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>> Thanks.
>>>>>>>>>> ______________________________________________
>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more,
>>>>>>>>>> see https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>> and provide commented, minimal, self-contained, reproducible
>>>>>>>>>> code.
>>>>>>>> ______________________________________________
>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more,
>>>>>>>> see https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>> PLEASE do read the posting guide
>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>>>
>>>>>>
>>>>
>>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From @erv|ce @end|ng |rom @hd@w@on@com  Thu Dec 23 17:38:23 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Thu, 23 Dec 2021 11:38:23 -0500
Subject: [R] Adding SORT to UNIQUE
In-Reply-To: <a3c5d12a-d598-efa7-f356-abfaf24cf27d@gmail.com>
References: <c533e71e-4baf-4b96-8aa4-6df38f6a3b33@shdawson.com>
 <eccebea6-de42-5cb8-4d94-43d266b50ce8@shdawson.com>
 <48827f10-ac8b-ba26-923b-7fdc525930f1@sapo.pt>
 <c16769c3-02ce-bf26-9532-3483e5e6e478@shdawson.com>
 <e2f7e004-02d7-3738-e05b-e9378c7663ed@gmail.com>
 <f379efd4-e401-e702-71b3-a501245b2b08@shdawson.com>
 <31e9cb7f-3ddd-7860-f290-8b34e8031616@gmail.com>
 <328fe875-d63d-8b45-76dd-ab1244820113@gmail.com>
 <8f4efdcb-57bc-2922-7f96-753af38d1c0b@shdawson.com>
 <dead8a81-9ad7-2df3-f97c-ff8fb3f1b903@gmail.com>
 <f99ab582-0902-614a-3824-1dc606b944c1@shdawson.com>
 <36bb5a89-42fa-9108-4798-3d3ac5698d1e@gmail.com>
 <b375b182-bdfb-171d-76e9-8bad2686f0dc@shdawson.com>
 <46338490-263d-d026-2017-333f61734646@shdawson.com>
 <a3c5d12a-d598-efa7-f356-abfaf24cf27d@gmail.com>
Message-ID: <054b16a4-da4f-5124-e229-97aaa4490d08@shdawson.com>

Hi Duncan,


Thanks for the reply. You bring much insight to the equation of the R 
journey. I look forward to dialoging with you.


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/22/21 12:12 PM, Duncan Murdoch wrote:
> On 22/12/2021 12:01 p.m., Stephen H. Dawson, DSL wrote:
>> Data <- read.csv("./input/Source.csv", header=T)
>> v1 <- sort(unique(Data[, 1]))
>> cat(format(v1, justify = "right"), sep = "\n")
>>
>> OK, working with the options you presented. This is the combination
>> where I gain the most benefit.
>>
>> However, there is no listing of a column header with the output of this
>> syntax.
>>
>> ? > cat(format(v1, justify = "right"), sep = "\n")
>> ? ?2
>> ? ?3
>> ? ?4
>> ? ?5
>> ? ?6
>> ? ?7
>> ? ?8
>> ? ?9
>> 10
>> ? >
>>
>> NOTE
>> The output here is correct (unique) based on the entries from the 
>> column.
>>
>> QUESTION
>> How does one add a text label of something as simple as v1 to the
>> vertical output of this syntax, please?
>
> In this case, you'd just put in cat("v1\n") before the given command.
>
> In the general case where you want to get the name of the column from 
> the dataframe, I think you'll need to write your own function.? The 
> one Rui just posted looks pretty good.? To get it to print without the 
> row numbers as in the example above, just change it a little in the 
> header and one other line:
>
> print.sortUnique <- function(x, row.names = FALSE, ...){
> ?? n <- max(lengths(x))
> ?? y <- lapply(x, \(.x) c(.x, rep("", n - length(.x))))
> ?? y <- do.call(cbind.data.frame, y)
> ?? names(y) <- names(x)
> ?? print(y, row.names = row.names, ...)
> ?? invisible(x)
> }
>
> This will give
>
> > Data2
> ?V1 V2 V3 V4
> ? 3? 2? 2? 1
> ? 5? 4? 3? 2
> ? 6? 5? 4? 4
> ? 7? 6? 5? 5
> ? 8? 9? 6? 6
> ? 9 11? 8? 9
> ?12 15? 9 10
> ?14 16 11 11
> ?15 17 14 12
> ?18 18 15 13
> ?19 19 17 14
> ?20??? 19 16
> ?????? 20 18
> ????????? 19
>
> with his example data.
>
> Duncan Murdoch
>
>
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 12/22/21 11:13 AM, Stephen H. Dawson, DSL via R-help wrote:
>>> OK, now I get what you are suggesting.
>>>
>>> Much appreciated.
>>>
>>>
>>> Kindest Regards,
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 12/22/21 11:08 AM, Duncan Murdoch wrote:
>>>> On 22/12/2021 10:55 a.m., Stephen H. Dawson, DSL wrote:
>>>>> I see.
>>>>>
>>>>> So, we are talking taking the output into a new dataframe. I was 
>>>>> hoping
>>>>> to have the output rendered on screen without another dataframe, 
>>>>> but I
>>>>> can live with this option it if must occur.
>>>>>
>>>>> Am I correct the desired vertical output must first go to a 
>>>>> dataframe?
>>>>
>>>> No, that's just one option.? The other 3 don't use dataframes.
>>>>
>>>> Duncan Murdoch
>>>>>
>>>>>
>>>>> *Stephen Dawson, DSL*
>>>>> /Executive Strategy Consultant/
>>>>> Business & Technology
>>>>> +1 (865) 804-3454
>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>
>>>>>
>>>>> On 12/22/21 10:47 AM, Duncan Murdoch wrote:
>>>>>> On 22/12/2021 10:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>>> Thanks for the reply.
>>>>>>>
>>>>>>> Both syntax options work to render the correct (unique) output.
>>>>>>> However,
>>>>>>> the output is rendered as horizontal. What needs to happen to 
>>>>>>> get the
>>>>>>> output to render vertical, please?
>>>>>>
>>>>>> The result of those expressions is a vector of the same type as the
>>>>>> column, so your question is really about how to get a vector to 
>>>>>> print
>>>>>> one element per line.
>>>>>>
>>>>>> Probably the simplest way is to put the vector in a dataframe (or
>>>>>> matrix, or tibble, depending on which formatting you prefer). For
>>>>>> example,
>>>>>>
>>>>>>> ???? v <- c("red", "green", "blue")
>>>>>>> ???? data.frame(v)
>>>>>> ??????? v
>>>>>> 1?? red
>>>>>> 2 green
>>>>>> 3? blue
>>>>>>
>>>>>> If you want a more minimal display, try
>>>>>>
>>>>>>> cat(v, sep = "\n")
>>>>>> red
>>>>>> green
>>>>>> blue
>>>>>>
>>>>>> or
>>>>>>
>>>>>>> cat(format(v, justify = "right"), sep = "\n")
>>>>>> ??? red
>>>>>> green
>>>>>> ???blue
>>>>>>
>>>>>> If you want this to happen when you auto-print the object, you can
>>>>>> give it a class attribute and write a function to print that class,
>>>>>> e.g.
>>>>>>
>>>>>>> ??? class(v) <- "oneperline"
>>>>>>>
>>>>>>> ???? print.oneperline <- function(x, ...) cat(format(x, justify =
>>>>>> "right"), sep = "\n")
>>>>>>>
>>>>>>> ???? v
>>>>>> ??? red
>>>>>> green
>>>>>> ???blue
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> *Stephen Dawson, DSL*
>>>>>>> /Executive Strategy Consultant/
>>>>>>> Business & Technology
>>>>>>> +1 (865) 804-3454
>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>
>>>>>>>
>>>>>>> On 12/21/21 11:38 AM, Duncan Murdoch wrote:
>>>>>>>> On 21/12/2021 11:31 a.m., Duncan Murdoch wrote:
>>>>>>>>> On 21/12/2021 11:20 a.m., Stephen H. Dawson, DSL wrote:
>>>>>>>>>> Thanks for the reply.
>>>>>>>>>>
>>>>>>>>>> sort(unique(Data[1]))
>>>>>>>>>> Error in `[.data.frame`(x, order(x, na.last = na.last,
>>>>>>>>>> decreasing =
>>>>>>>>>> decreasing)) :
>>>>>>>>>> ????? ? undefined columns selected
>>>>>>>>>
>>>>>>>>> That's the wrong syntax:? Data[1] is not "column one of Data". 
>>>>>>>>> Use
>>>>>>>>> Data[[1]] for that, so
>>>>>>>>>
>>>>>>>>> ?????? sort(unique(Data[[1]]))
>>>>>>>>
>>>>>>>> Actually, I'd probably recommend
>>>>>>>>
>>>>>>>> ???? sort(unique(Data[, 1]))
>>>>>>>>
>>>>>>>> instead.? This treats Data as a matrix rather than as a list.
>>>>>>>> Dataframes are lists that look like matrices, but to me the matrix
>>>>>>>> aspect is usually more intuitive.
>>>>>>>>
>>>>>>>> Duncan Murdoch
>>>>>>>>
>>>>>>>>>
>>>>>>>>> I think Rui already pointed out the typo in the quoted text
>>>>>>>>> below...
>>>>>>>>>
>>>>>>>>> Duncan Murdoch
>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> The recommended syntax did not work, as listed above.
>>>>>>>>>>
>>>>>>>>>> What I want is the sort of distinct column output. Again, the
>>>>>>>>>> column
>>>>>>>>>> may
>>>>>>>>>> be text or numbers. This is a huge analysis effort with data
>>>>>>>>>> coming at
>>>>>>>>>> me from many different sources.
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>>> Business & Technology
>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> On 12/21/21 11:07 AM, Duncan Murdoch wrote:
>>>>>>>>>>> On 21/12/2021 10:16 a.m., Stephen H. Dawson, DSL via R-help
>>>>>>>>>>> wrote:
>>>>>>>>>>>> Thanks everyone for the replies.
>>>>>>>>>>>>
>>>>>>>>>>>> It is clear one either needs to write a function or put the
>>>>>>>>>>>> unique
>>>>>>>>>>>> entries into another dataframe.
>>>>>>>>>>>>
>>>>>>>>>>>> It seems odd R cannot sort a list of unique column entries 
>>>>>>>>>>>> with
>>>>>>>>>>>> ease.
>>>>>>>>>>>> Python and SQL can do it with ease.
>>>>>>>>>>>
>>>>>>>>>>> I've seen several responses that looked pretty simple. It's
>>>>>>>>>>> hard to
>>>>>>>>>>> beat sort(unique(x)), though there's a fair bit of confusion
>>>>>>>>>>> about
>>>>>>>>>>> what you actually want.? Maybe you should post an example of 
>>>>>>>>>>> the
>>>>>>>>>>> code
>>>>>>>>>>> you'd use in Python?
>>>>>>>>>>>
>>>>>>>>>>> Duncan Murdoch
>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> QUESTION
>>>>>>>>>>>> Is there a simpler means than other than the unique 
>>>>>>>>>>>> function to
>>>>>>>>>>>> capture
>>>>>>>>>>>> distinct column entries, then sort that list?
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>>>>> Business & Technology
>>>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> On 12/20/21 5:53 PM, Rui Barradas wrote:
>>>>>>>>>>>>> Hello,
>>>>>>>>>>>>>
>>>>>>>>>>>>> Inline.
>>>>>>>>>>>>>
>>>>>>>>>>>>> ?s 21:18 de 20/12/21, Stephen H. Dawson, DSL via R-help
>>>>>>>>>>>>> escreveu:
>>>>>>>>>>>>>> Thanks.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> sort(unique(Data[[1]]))
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> This syntax provides row numbers, not column values.
>>>>>>>>>>>>>
>>>>>>>>>>>>> This is not right.
>>>>>>>>>>>>> The syntax Data[1] extracts a sub-data.frame, the syntax
>>>>>>>>>>>>> Data[[1]]
>>>>>>>>>>>>> extracts the column vector.
>>>>>>>>>>>>>
>>>>>>>>>>>>> As for my previous answer, it was not addressing the
>>>>>>>>>>>>> question, I
>>>>>>>>>>>>> misinterpreted it as being a question on how to sort by 
>>>>>>>>>>>>> numeric
>>>>>>>>>>>>> order
>>>>>>>>>>>>> when the data is not numeric. Here is a, hopefully, complete
>>>>>>>>>>>>> answer.
>>>>>>>>>>>>> Still with package stringr.
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> cols_to_sort <- 1:4
>>>>>>>>>>>>>
>>>>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], \(x){
>>>>>>>>>>>>> ???? ?? stringr::str_sort(unique(x), numeric = TRUE)
>>>>>>>>>>>>> })
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Or using Avi's suggestion of writing a function to do all the
>>>>>>>>>>>>> work and
>>>>>>>>>>>>> simplify the lapply loop later,
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> unisort2 <- function(vec, ...)
>>>>>>>>>>>>> stringr::str_sort(unique(vec), ...)
>>>>>>>>>>>>> Data2 <- lapply(Data[cols_to_sort], unisort, numeric = TRUE)
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>> Hope this helps,
>>>>>>>>>>>>>
>>>>>>>>>>>>> Rui Barradas
>>>>>>>>>>>>>
>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> *Stephen Dawson, DSL*
>>>>>>>>>>>>>> /Executive Strategy Consultant/
>>>>>>>>>>>>>> Business & Technology
>>>>>>>>>>>>>> +1 (865) 804-3454
>>>>>>>>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> On 12/20/21 11:58 AM, Stephen H. Dawson, DSL via R-help 
>>>>>>>>>>>>>> wrote:
>>>>>>>>>>>>>>> Hi,
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Running a simple syntax set to review entries in dataframe
>>>>>>>>>>>>>>> columns.
>>>>>>>>>>>>>>> Here is the working code.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Data <- read.csv("./input/Source.csv", header=T)
>>>>>>>>>>>>>>> describe(Data)
>>>>>>>>>>>>>>> summary(Data)
>>>>>>>>>>>>>>> unique(Data[1])
>>>>>>>>>>>>>>> unique(Data[2])
>>>>>>>>>>>>>>> unique(Data[3])
>>>>>>>>>>>>>>> unique(Data[4])
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> I would like to add sort the unique entries. The data in 
>>>>>>>>>>>>>>> the
>>>>>>>>>>>>>>> various
>>>>>>>>>>>>>>> columns are not defined as numbers, but also text. I 
>>>>>>>>>>>>>>> realize
>>>>>>>>>>>>>>> 1 and
>>>>>>>>>>>>>>> 10 will not sort properly, as the column is not defined 
>>>>>>>>>>>>>>> as a
>>>>>>>>>>>>>>> number,
>>>>>>>>>>>>>>> but want to see what I have in the columns viewed as 
>>>>>>>>>>>>>>> sorted.
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> QUESTION
>>>>>>>>>>>>>>> What is the best process to sort unique output, please?
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>>
>>>>>>>>>>>>>>> Thanks.
>>>>>>>>>>>>>>
>>>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and
>>>>>>>>>>>>>> more, see
>>>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>>>>>> and provide commented, minimal, self-contained, reproducible
>>>>>>>>>>>>>> code.
>>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>>> ______________________________________________
>>>>>>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more,
>>>>>>>>>>>> see
>>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>>>>>>> PLEASE do read the posting guide
>>>>>>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>>>>>>> and provide commented, minimal, self-contained, reproducible
>>>>>>>>>>>> code.
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>
>>>>
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>
>
>


From @erv|ce @end|ng |rom @hd@w@on@com  Thu Dec 23 17:39:52 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Thu, 23 Dec 2021 11:39:52 -0500
Subject: [R] Script Run Output Capturing
In-Reply-To: <YcSPEdeIFDUX8oHN@posteo.no>
References: <f2fc14b2-cd07-a2d0-b46d-868227e8313c@shdawson.com>
 <YcRhKYsLgEASsb0B@posteo.no>
 <ff7ad3f5-36a6-3555-25ef-4bd25c40a16a@shdawson.com>
 <YcSPEdeIFDUX8oHN@posteo.no>
Message-ID: <74850056-8a78-cf25-6bab-b3339d57ecfc@shdawson.com>

Thank you, Rasmus. I appreciate the reply.


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/23/21 10:00 AM, Rasmus Liland wrote:
> sink and capture.output seem
> useful, but I have not used them.
> I looked into pipe() a long time ago ...
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Dec 23 18:17:57 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 23 Dec 2021 09:17:57 -0800
Subject: [R] Error Awareness
In-Reply-To: <6ad7bcfb-8828-0572-e4f9-783945d64325@shdawson.com>
References: <a379c1dd-9a6e-f8a0-62eb-3ba893978f8e@shdawson.com>
 <CAGxFJbS4O9Hg95P19Tj17HJ4MjTuRUyqGuCsFWLENnhLJkPhEw@mail.gmail.com>
 <6ad7bcfb-8828-0572-e4f9-783945d64325@shdawson.com>
Message-ID: <5B3BF8C7-8E6F-4813-A105-CA20EE24F7CC@dcn.davis.ca.us>

You still are not exhibiting signs of understanding Bert's response, and your question is vague, particularly to the extent that it could be pertinent to the R language (and therefore to the topic of this list). R itself just raises an error condition that custom tryCatch or default handling will deal with. If you run the script in a logging context (as defined by a non-R, operating-system-specific tool) then whatever error was printed by R to stdout or stderr will be in that log. If you want some different form communication then you will need to use tryCatch and initiate that effort. But since R itself doesn't know how you are running it (cron? CGI? Windows Task Manager? self-implemented socket monitoring?) it is up to you to deal with that.

If you have a more focused question (e.g. how can I send an email or text) then there may well be a package for that, but you can find such things yourself with a search engine and discussion of how to use them is almost certainly off-topic here (read the Posting Guide).

On December 23, 2021 8:16:58 AM PST, "Stephen H. Dawson, DSL via R-help" <r-help at r-project.org> wrote:
>Hi Bert,
>
>
>Thanks for the reply.
>
>The use case I presented involves working code, not diagnosing a script 
>in development.
>
>The concern is running a script where something changes outside of the 
>script, as I stated. An example of a change is a data source changing 
>perhaps the columns in the data source, or even changing the spelling of 
>a column. The point is something changes.
>
>The question then becomes how to be aware of the change when the reset 
>of the script runs fine, as I presented.
>
>Think of having a script running daily where you are not running it 
>manually. How do you know there are errors in the script processing at 
>this point?
>
>Does this question now make more sense?
>
>
>*Stephen Dawson, DSL*
>/Executive Strategy Consultant/
>Business & Technology
>+1 (865) 804-3454
>http://www.shdawson.com <http://www.shdawson.com>
>
>
>On 12/23/21 10:49 AM, Bert Gunter wrote:
>> ?tryCatch
>>
>> This list is not meant for tutorials. A web search on "find errors in
>> R code" brought up what appeared to be many resources to address your
>> question. Please make use of such resources before posting here. Also,
>> please read and follow the posting gui)de linked below to find out
>> what sort of help you can expect (and have already received here.
>>
>> Cheers,
>> Bert Gunter
>>
>> "The trouble with having an open mind is that people keep coming along
>> and sticking things into it."
>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>
>> On Thu, Dec 23, 2021 at 3:14 AM Stephen H. Dawson, DSL via R-help
>> <r-help at r-project.org> wrote:
>>> Hi,
>>>
>>>
>>> I am thinking about awareness of errors when an R script runs.
>>>
>>> My concern is I have an error-free script. I run it for months on end
>>> without problems. Then, something changes somewhere causing an error. My
>>> wonderment is how R will tell me I had an error in the script, but the
>>> rest of the script ran without impairment.
>>>
>>> QUESTIONS
>>> What are some of the more helpful options available to an R developer to
>>> capture errors in a script run?
>>>
>>> What are some of the best processes to implement these more helpful options?
>>>
>>>
>>> Thanks,
>>> --
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From k@m@rjeet21 @end|ng |rom gm@||@com  Thu Dec 23 16:39:40 2021
From: k@m@rjeet21 @end|ng |rom gm@||@com (Amarjeet Kumar)
Date: Thu, 23 Dec 2021 21:09:40 +0530
Subject: [R] Request for help in solving an optimization problem
Message-ID: <CAJoS5hE+Zf1cttMNgksv4bFi8xfKp2e4q9w6J+egC9Oe4-upPg@mail.gmail.com>

Dear All.

Warm greetings to you. I need help in solving an optimization formulation
in R software. I tried to solve it in excel solver but it was going up to
local minimum using GRG nonlinear solving method. I thought R can help in
solving this problem so I am explaining the problem in few sentences below:

The optimization problem is to determine weights for ranking six
alternatives(j) based on two attributes(i).

Y1 Y2

2 4

4 5

4 4

5 3

5 2

An aggregate performance function Pj is used to calculate jth alternative
performance to the ideal.

[image: enter image description here] <https://i.stack.imgur.com/JoM3B.png>

Pj is the aggregate performance of the jth alternative relative to the
ideal.

Sj is the relative distance between the jth alternative and the ideal in
terms of the aggregate performance given by

Sj = 1 ? Pj

The problem is transformed to finding the set of weights Wi, i = 1, . . . ,
m, which produce the smallest total squared difference between the relative
performance of the alternative and that of the ideal.

Here the maximum value of each attribute is taken as the ideal (Y*). Ideal
for our data is (Y1*,Y2*)=(5,5)

Objective function :

[image: enter image description here] <https://i.stack.imgur.com/Yymud.png>

e is a small value greater than zero so that weights are not zero

After the optimal weights Wi , i = 1, . . . , m, are obtained, the relative
performance of the jth alternative is calculated as [image: enter image
description here] <https://i.stack.imgur.com/AqEqx.png>

The relative distance to the ideal is[image: enter image description here]
<https://i.stack.imgur.com/z3YlD.png> which is the basis of ranking. The
higher value means the alternative is away from ideal and hence ranks low.

I know that R has better capabilities to find solutions for this
optimization problem but, as I have no experience in R, I am unable to move
a step further. If you can find some time to help me in this regard I would
be very thankful to you for this timely help.

Thank you in advance for your help.


Kind Regards,
*Amarjeet Kumar*
Research scholar,

	[[alternative HTML version deleted]]


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Thu Dec 23 20:18:45 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Thu, 23 Dec 2021 11:18:45 -0800 (PST)
Subject: [R] .Rdata not loading
Message-ID: <95a8a491-a827-597f-edf7-4a6e9ee2dfb7@appl-ecosys.com>

Each time I finish with a session I save the image. Today the saved image
did not load and manually running 'load('.RData') fails:
> load('.RData')
Error in load(".RData") :
   ReadItem: unknown type 0, perhaps written by later version of R
>

This has not happened before.

Installed is R-4.1.2-x86_64-1_SBo and in the PWD I see:
$ ll .RData*
-rw-r--r-- 1 rshepard users 28074080 Dec 22 15:32 .RData
-rw-r--r-- 1 rshepard users      134 Nov  4 14:57 .RDataTmp
-rw-r--r-- 1 rshepard users        0 Nov  4 14:57 .RDataTmp1

What might be keeping .RData from loading? Is there a maximum size for
.RData? The /home partition has 270G available space so that's not limiting.

How do I load it?

TIA,

Rich


From bgunter@4567 @end|ng |rom gm@||@com  Thu Dec 23 20:22:38 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 23 Dec 2021 11:22:38 -0800
Subject: [R] Request for help in solving an optimization problem
In-Reply-To: <CAJoS5hE+Zf1cttMNgksv4bFi8xfKp2e4q9w6J+egC9Oe4-upPg@mail.gmail.com>
References: <CAJoS5hE+Zf1cttMNgksv4bFi8xfKp2e4q9w6J+egC9Oe4-upPg@mail.gmail.com>
Message-ID: <CAGxFJbQXW1-_8pE5wLBcV6Oo=KeC2zC5AzrxyHDZ37ZXjNUL2Q@mail.gmail.com>

1. This ia a plain text list. No html.

2. Looks like homework. We don't do homework here.

3. Please read the posting guide. This is R-Help, not "R we do your
work for you." We expect posters to show us their efforts to solve
their problems. (In R, not Excel of course).

4. See here for R optimization resources:
https://cran.r-project.org/web/views/Optimization.html


Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Thu, Dec 23, 2021 at 10:31 AM Amarjeet Kumar <kamarjeet21 at gmail.com> wrote:
>
> Dear All.
>
> Warm greetings to you. I need help in solving an optimization formulation
> in R software. I tried to solve it in excel solver but it was going up to
> local minimum using GRG nonlinear solving method. I thought R can help in
> solving this problem so I am explaining the problem in few sentences below:
>
> The optimization problem is to determine weights for ranking six
> alternatives(j) based on two attributes(i).
>
> Y1 Y2
>
> 2 4
>
> 4 5
>
> 4 4
>
> 5 3
>
> 5 2
>
> An aggregate performance function Pj is used to calculate jth alternative
> performance to the ideal.
>
> [image: enter image description here] <https://i.stack.imgur.com/JoM3B.png>
>
> Pj is the aggregate performance of the jth alternative relative to the
> ideal.
>
> Sj is the relative distance between the jth alternative and the ideal in
> terms of the aggregate performance given by
>
> Sj = 1 ? Pj
>
> The problem is transformed to finding the set of weights Wi, i = 1, . . . ,
> m, which produce the smallest total squared difference between the relative
> performance of the alternative and that of the ideal.
>
> Here the maximum value of each attribute is taken as the ideal (Y*). Ideal
> for our data is (Y1*,Y2*)=(5,5)
>
> Objective function :
>
> [image: enter image description here] <https://i.stack.imgur.com/Yymud.png>
>
> e is a small value greater than zero so that weights are not zero
>
> After the optimal weights Wi , i = 1, . . . , m, are obtained, the relative
> performance of the jth alternative is calculated as [image: enter image
> description here] <https://i.stack.imgur.com/AqEqx.png>
>
> The relative distance to the ideal is[image: enter image description here]
> <https://i.stack.imgur.com/z3YlD.png> which is the basis of ranking. The
> higher value means the alternative is away from ideal and hence ranks low.
>
> I know that R has better capabilities to find solutions for this
> optimization problem but, as I have no experience in R, I am unable to move
> a step further. If you can find some time to help me in this regard I would
> be very thankful to you for this timely help.
>
> Thank you in advance for your help.
>
>
> Kind Regards,
> *Amarjeet Kumar*
> Research scholar,
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Dec 23 21:09:05 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 23 Dec 2021 12:09:05 -0800
Subject: [R] .Rdata not loading
In-Reply-To: <95a8a491-a827-597f-edf7-4a6e9ee2dfb7@appl-ecosys.com>
References: <95a8a491-a827-597f-edf7-4a6e9ee2dfb7@appl-ecosys.com>
Message-ID: <9C45FA1D-5F19-4D47-949A-B309778C0991@dcn.davis.ca.us>

This practice (saving and resuming from Rdata files) often ends badly this way. Objects that are "shared" in memory get saved as separate data and may not "fit" when re-loaded. This is why re-running from scratch should always be part of your workflow. There are caching approaches that track individual objects rather than entire workspaces such as the targets package or others or you can roll your own with saveRDS/readRDS or the qs package.

On December 23, 2021 11:18:45 AM PST, Rich Shepard <rshepard at appl-ecosys.com> wrote:
>Each time I finish with a session I save the image. Today the saved image
>did not load and manually running 'load('.RData') fails:
>> load('.RData')
>Error in load(".RData") :
>   ReadItem: unknown type 0, perhaps written by later version of R
>>
>
>This has not happened before.
>
>Installed is R-4.1.2-x86_64-1_SBo and in the PWD I see:
>$ ll .RData*
>-rw-r--r-- 1 rshepard users 28074080 Dec 22 15:32 .RData
>-rw-r--r-- 1 rshepard users      134 Nov  4 14:57 .RDataTmp
>-rw-r--r-- 1 rshepard users        0 Nov  4 14:57 .RDataTmp1
>
>What might be keeping .RData from loading? Is there a maximum size for
>.RData? The /home partition has 270G available space so that's not limiting.
>
>How do I load it?
>
>TIA,
>
>Rich
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Thu Dec 23 21:40:46 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Thu, 23 Dec 2021 12:40:46 -0800 (PST)
Subject: [R] .Rdata not loading
In-Reply-To: <9C45FA1D-5F19-4D47-949A-B309778C0991@dcn.davis.ca.us>
References: <95a8a491-a827-597f-edf7-4a6e9ee2dfb7@appl-ecosys.com>
 <9C45FA1D-5F19-4D47-949A-B309778C0991@dcn.davis.ca.us>
Message-ID: <54384b89-c081-4ae1-3516-895c3726968f@appl-ecosys.com>

On Thu, 23 Dec 2021, Jeff Newmiller wrote:

> This practice (saving and resuming from Rdata files) often ends badly this
> way. Objects that are "shared" in memory get saved as separate data and
> may not "fit" when re-loaded. This is why re-running from scratch should
> always be part of your workflow. There are caching approaches that track
> individual objects rather than entire workspaces such as the targets
> package or others or you can roll your own with saveRDS/readRDS or the qs
> package.

Jeff,

While I've used R for more than a decade I've not before had this
experience.

I'll set up a script to run all existing scripts, in order, and run it to be
able to continue my project. I'll definitely look at the targets and qs
packages as well as save-read/RDS.

Thanks for pointing me in the right direction and teaching me a valuable
lesson.

Have safe and healthy holidays and stay well,

Rich


From w||||@mwdun|@p @end|ng |rom gm@||@com  Fri Dec 24 02:25:10 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Thu, 23 Dec 2021 17:25:10 -0800
Subject: [R] .Rdata not loading
In-Reply-To: <95a8a491-a827-597f-edf7-4a6e9ee2dfb7@appl-ecosys.com>
References: <95a8a491-a827-597f-edf7-4a6e9ee2dfb7@appl-ecosys.com>
Message-ID: <CAHqSRuQV0PcKWhac7GZUqK+Cr=aGhrZvdO+R4vnjS-9ZYcu4GQ@mail.gmail.com>

Three things you might try using R (and show the results in this email
thread):

* load(verbose=TRUE, ".RData") # see how far it gets before stopping
* file.info(normalizePath(".RData")) # is this the file you think it is?
* dput(readBin(".RData", what=raw(), n=100))

The last will print some hex numbers that others may be able to interpret.
E.g., it may show that this .RData is not from a call to save() or
save.image().

-Bill

On Thu, Dec 23, 2021 at 11:19 AM Rich Shepard <rshepard at appl-ecosys.com>
wrote:

> Each time I finish with a session I save the image. Today the saved image
> did not load and manually running 'load('.RData') fails:
> > load('.RData')
> Error in load(".RData") :
>    ReadItem: unknown type 0, perhaps written by later version of R
> >
>
> This has not happened before.
>
> Installed is R-4.1.2-x86_64-1_SBo and in the PWD I see:
> $ ll .RData*
> -rw-r--r-- 1 rshepard users 28074080 Dec 22 15:32 .RData
> -rw-r--r-- 1 rshepard users      134 Nov  4 14:57 .RDataTmp
> -rw-r--r-- 1 rshepard users        0 Nov  4 14:57 .RDataTmp1
>
> What might be keeping .RData from loading? Is there a maximum size for
> .RData? The /home partition has 270G available space so that's not
> limiting.
>
> How do I load it?
>
> TIA,
>
> Rich
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From w||||@mwdun|@p @end|ng |rom gm@||@com  Fri Dec 24 02:29:01 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Thu, 23 Dec 2021 17:29:01 -0800
Subject: [R] .Rdata not loading
In-Reply-To: <CAHqSRuQV0PcKWhac7GZUqK+Cr=aGhrZvdO+R4vnjS-9ZYcu4GQ@mail.gmail.com>
References: <95a8a491-a827-597f-edf7-4a6e9ee2dfb7@appl-ecosys.com>
 <CAHqSRuQV0PcKWhac7GZUqK+Cr=aGhrZvdO+R4vnjS-9ZYcu4GQ@mail.gmail.com>
Message-ID: <CAHqSRuSqJaEOP49cg2_U9Mi=bbypTM84RyzWCkoC0MCXnNvRxQ@mail.gmail.com>

And a fourth thing to do:

* dput(tail(n=20, readBin(".RData", what=raw(), n=file.size(".RData"))))

This can show if the file got truncated.

-Bill

On Thu, Dec 23, 2021 at 5:25 PM Bill Dunlap <williamwdunlap at gmail.com>
wrote:

> Three things you might try using R (and show the results in this email
> thread):
>
> * load(verbose=TRUE, ".RData") # see how far it gets before stopping
> * file.info(normalizePath(".RData")) # is this the file you think it is?
> * dput(readBin(".RData", what=raw(), n=100))
>
> The last will print some hex numbers that others may be able to
> interpret.  E.g., it may show that this .RData is not from a call to save()
> or save.image().
>
> -Bill
>
> On Thu, Dec 23, 2021 at 11:19 AM Rich Shepard <rshepard at appl-ecosys.com>
> wrote:
>
>> Each time I finish with a session I save the image. Today the saved image
>> did not load and manually running 'load('.RData') fails:
>> > load('.RData')
>> Error in load(".RData") :
>>    ReadItem: unknown type 0, perhaps written by later version of R
>> >
>>
>> This has not happened before.
>>
>> Installed is R-4.1.2-x86_64-1_SBo and in the PWD I see:
>> $ ll .RData*
>> -rw-r--r-- 1 rshepard users 28074080 Dec 22 15:32 .RData
>> -rw-r--r-- 1 rshepard users      134 Nov  4 14:57 .RDataTmp
>> -rw-r--r-- 1 rshepard users        0 Nov  4 14:57 .RDataTmp1
>>
>> What might be keeping .RData from loading? Is there a maximum size for
>> .RData? The /home partition has 270G available space so that's not
>> limiting.
>>
>> How do I load it?
>>
>> TIA,
>>
>> Rich
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From @v|gro@@ @end|ng |rom ver|zon@net  Fri Dec 24 04:28:55 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Thu, 23 Dec 2021 22:28:55 -0500
Subject: [R] Error Awareness
In-Reply-To: <6ad7bcfb-8828-0572-e4f9-783945d64325@shdawson.com>
References: <a379c1dd-9a6e-f8a0-62eb-3ba893978f8e@shdawson.com>
 <CAGxFJbS4O9Hg95P19Tj17HJ4MjTuRUyqGuCsFWLENnhLJkPhEw@mail.gmail.com>
 <6ad7bcfb-8828-0572-e4f9-783945d64325@shdawson.com>
Message-ID: <07ee01d7f876$61a399a0$24eacce0$@verizon.net>

Stephen,

It is becoming a pattern here.

You have been told R allows ways to check for errors as the code is
interpreted and this DOES NOT distinguish between development aspects and in
the field. It does not matter if a problem is external like a required file
not being in place or having a new name or whatever.

Anything that may go wrong can be handled in quite a few ways. Some are
fairly obvious, such as checking if an expected  list or vector or whatever
is returned that is empty or not set or is the wrong data type or contains
some NA or negative numbers and on and on. All kinds of IF statements and
checks are a way to deal with these and you decide whether to make some kind
of fix or abort.

But obviously if the error happens outside your code (and sometimes also
within) you can use various ways R provides to intercept the error and do
something. Heck, people often use this in advance as a programming tactic
such as using try() or tryCatch() to something like try to open file1 in the
current directory and if that fails, in a specified directory and maybe if
that fails, get it from file2 or maybe standard input ...

Well-written code that wants to be bullet-proof will often be a bit bloated
as it regularly stops and checks not only for all kinds of error conditions
but also checks if the variables being used are in the proper format and
range before being passed to functions that might break, is say you told it
to use a correlation above 1. It also decides to intelligently deal with the
errors, when possible.

I have written code that called a statistical analysis (lavaan)  function
hundreds of thousands of times on randomly generated data and it worked
fine, except occasionally it broke. As I tended to run it overnight, it was
a pain to wake up and find it had crashed. No, I am not aware why it
crashed, but it could have been something as simple as a matrix that could
not be inverted. But for my purposes, it did not matter as what I would be
happy to get is knowing it failed, marking associated rows of a data.frame
accordingly, and filtering out the results in later analyses. So, I wrapped
not only this call but some others as described above and intercepted the
rare problem and dealt with it and let my program continue overnight.

Clearly if you expect anomalies to be rare, this is extra overhead. But if
things do happen, then your code is not robust enough.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
DSL via R-help
Sent: Thursday, December 23, 2021 11:17 AM
To: Bert Gunter <bgunter.4567 at gmail.com>
Cc: R-help <r-help at r-project.org>
Subject: Re: [R] Error Awareness

Hi Bert,


Thanks for the reply.

The use case I presented involves working code, not diagnosing a script in
development.

The concern is running a script where something changes outside of the
script, as I stated. An example of a change is a data source changing
perhaps the columns in the data source, or even changing the spelling of a
column. The point is something changes.

The question then becomes how to be aware of the change when the reset of
the script runs fine, as I presented.

Think of having a script running daily where you are not running it
manually. How do you know there are errors in the script processing at this
point?

Does this question now make more sense?


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/23/21 10:49 AM, Bert Gunter wrote:
> ?tryCatch
>
> This list is not meant for tutorials. A web search on "find errors in 
> R code" brought up what appeared to be many resources to address your 
> question. Please make use of such resources before posting here. Also, 
> please read and follow the posting gui)de linked below to find out 
> what sort of help you can expect (and have already received here.
>
> Cheers,
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along 
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> On Thu, Dec 23, 2021 at 3:14 AM Stephen H. Dawson, DSL via R-help 
> <r-help at r-project.org> wrote:
>> Hi,
>>
>>
>> I am thinking about awareness of errors when an R script runs.
>>
>> My concern is I have an error-free script. I run it for months on end 
>> without problems. Then, something changes somewhere causing an error. 
>> My wonderment is how R will tell me I had an error in the script, but 
>> the rest of the script ran without impairment.
>>
>> QUESTIONS
>> What are some of the more helpful options available to an R developer 
>> to capture errors in a script run?
>>
>> What are some of the best processes to implement these more helpful
options?
>>
>>
>> Thanks,
>> --
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Fri Dec 24 15:30:46 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Fri, 24 Dec 2021 06:30:46 -0800 (PST)
Subject: [R] .Rdata not loading
In-Reply-To: <CAHqSRuQV0PcKWhac7GZUqK+Cr=aGhrZvdO+R4vnjS-9ZYcu4GQ@mail.gmail.com>
References: <95a8a491-a827-597f-edf7-4a6e9ee2dfb7@appl-ecosys.com>
 <CAHqSRuQV0PcKWhac7GZUqK+Cr=aGhrZvdO+R4vnjS-9ZYcu4GQ@mail.gmail.com>
Message-ID: <8aef2a98-b928-1699-415-bef7fd428ff7@appl-ecosys.com>

On Thu, 23 Dec 2021, Bill Dunlap wrote:

> Three things you might try using R (and show the results in this email
> thread):

Bill,

> * load(verbose=TRUE, ".RData") # see how far it gets before stopping
load(verbose=TRUE, ".RData")
Loading objects:
   all_turb_plot
   disc_all
Error in load(verbose = TRUE, ".RData") :
   ReadItem: unknown type 0, perhaps written by later version of R

> * file.info(normalizePath(".RData")) # is this the file you think it is?
file.info(normalizePath(".RData"))
                                                                                        size
/home/rshepard/documents/monographs/regulatory-science/npdes-wqbel/analyses/.RData 28074080
                                                                                    isdir
/home/rshepard/documents/monographs/regulatory-science/npdes-wqbel/analyses/.RData FALSE
                                                                                    mode
/home/rshepard/documents/monographs/regulatory-science/npdes-wqbel/analyses/.RData  644
                                                                                                  mtime
/home/rshepard/documents/monographs/regulatory-science/npdes-wqbel/analyses/.RData 2021-12-22 15:32:59
                                                                                                  ctime
/home/rshepard/documents/monographs/regulatory-science/npdes-wqbel/analyses/.RData 2021-12-22 15:32:59
                                                                                                  atime
/home/rshepard/documents/monographs/regulatory-science/npdes-wqbel/analyses/.RData 2021-12-24 06:23:33
                                                                                     uid
/home/rshepard/documents/monographs/regulatory-science/npdes-wqbel/analyses/.RData 1000
                                                                                    gid
/home/rshepard/documents/monographs/regulatory-science/npdes-wqbel/analyses/.RData 100
                                                                                       uname
/home/rshepard/documents/monographs/regulatory-science/npdes-wqbel/analyses/.RData rshepard
                                                                                    grname
/home/rshepard/documents/monographs/regulatory-science/npdes-wqbel/analyses/.RData  users

> * dput(readBin(".RData", what=raw(), n=100))
dput(readBin(".RData", what=raw(), n=100))
as.raw(c(0x1f, 0x8b, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x03, 0xec, 0xfd, 0x09, 0x9c, 0x24, 0x47, 0x79, 0xe7, 0x8d, 0x67, 
0x9f, 0x73, 0x68, 0xa4, 0x19, 0x8d, 0xa4, 0xd1, 0x81, 0x84, 0x5a, 
0x07, 0x58, 0x02, 0xd4, 0x74, 0xf7, 0xdc, 0x18, 0xd4, 0xc3, 0x21, 
0x61, 0xec, 0xb1, 0x60, 0x41, 0xe2, 0xb2, 0xf0, 0xb8, 0x7a, 0xba, 
0xa7, 0xd5, 0xa8, 0x2f, 0x77, 0xf7, 0x68, 0xa6, 0x05, 0x86, 0x59, 
0xc0, 0x60, 0x03, 0xb6, 0x58, 0x63, 0x9b, 0xe3, 0xc5, 0x17, 0x5e, 
0x1f, 0x8b, 0x4f, 0xfe, 0xde, 0x77, 0x7d, 0xbc, 0x3e, 0x64, 0xf0, 
0x1a, 0x1b, 0x6c, 0x2f, 0xa7, 0x0d, 0x98, 0x43, 0x20, 0x83, 0x39, 
0x0c, 0x6e, 0x63))

> And a fourth thing to do:
> * dput(tail(n=20, readBin(".RData", what=raw(), n=file.size(".RData"))))
dput(tail(n=20, readBin(".RData", what=raw(), n=file.size(".RData"))))
as.raw(c(0x5c, 0xae, 0x97, 0x5f, 0x1d, 0x9d, 0x2d, 0x1f, 0xad, 
0xa8, 0xf5, 0x5f, 0x8f, 0x47, 0xdd, 0x56, 0x60, 0xd5, 0x70, 0x3c
))

I hope this explains why .RData contains only two files when there were
30 or more when I saved it.

Thanks,

Rich


From jr@| @end|ng |rom po@teo@no  Fri Dec 24 15:38:08 2021
From: jr@| @end|ng |rom po@teo@no (Rasmus Liland)
Date: Fri, 24 Dec 2021 14:38:08 +0000
Subject: [R] .Rdata not loading
In-Reply-To: <95a8a491-a827-597f-edf7-4a6e9ee2dfb7@appl-ecosys.com>
References: <95a8a491-a827-597f-edf7-4a6e9ee2dfb7@appl-ecosys.com>
Message-ID: <YcXbUDfAJIY/Jpid@posteo.no>

Dear Rich,

If you want to look at Rdata-files in a quick way in the 
terminal, use this little gem in your .zshrc.local:

readrdata() { Rscript -e "options(width=$COLUMNS); load('$1'); sapply(ls(), get, simplify=F)" | less }

Merry Christmas!

Best,
Rasmus


From @erv|ce @end|ng |rom @hd@w@on@com  Fri Dec 24 15:49:28 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Fri, 24 Dec 2021 09:49:28 -0500
Subject: [R] Error Awareness
In-Reply-To: <07ee01d7f876$61a399a0$24eacce0$@verizon.net>
References: <a379c1dd-9a6e-f8a0-62eb-3ba893978f8e@shdawson.com>
 <CAGxFJbS4O9Hg95P19Tj17HJ4MjTuRUyqGuCsFWLENnhLJkPhEw@mail.gmail.com>
 <6ad7bcfb-8828-0572-e4f9-783945d64325@shdawson.com>
 <07ee01d7f876$61a399a0$24eacce0$@verizon.net>
Message-ID: <7a2f4d50-604c-4c16-f0a0-84b0e8d5e971@shdawson.com>

Thank you, Avi. I appreciate your reply. I agree maturing code is the 
best move to answer this interrogatory. I express deep thanks for 
contextualizing your response.

I also agree with you responses are becoming a pattern here. A post of 
an open-ended question regarding either a conceptual or stylistic topic 
is answered pervasively with linear thinking. This combination is a 
mismatch of context.

https://www.r-project.org/posting-guide.html

I summarize reading in the R Posting Guide, which is written in English, 
the recommendation to state a specific question involving specific R 
functionality. I read nothing in the R Posting Guide where open-ended 
questions are disallowed or even discouraged. Furthermore, I cannot 
imagine not posting either conceptual or stylistic questions to any 
practice group. If learning is not accomplished by open-ended questions, 
then there is nothing left other than closed-ended (direct) questions.

All the same, the benefit of gaining either tacit understanding or 
wisdom to use the R language by way of open-ended questioning is not 
found in the R Posting Guide as it is either written or practiced. This 
reality impairs the ability to learn about a dialogue member's thought 
process. It also impairs the ability to ever be able to one day offer 
either contract or employment work to anyone demonstrating both intimate 
knowledge of the R language and having the wisdom to implement it 
effectively.

It is inappropriate to recommend modifications to the R Posting Guide in 
this discussion, as it would be out of scope. So, I will not do it.

I close this dialogue as resolved. It is best to post any further 
discussion of this interrogatory in a new dialogue to avoid violating 
the R Posting Guide requirement of the stated Latin term ad hominem.

 ?https://www.dictionary.com/browse/ad-hominem

 ?https://en.wikipedia.org/wiki/Ad_hominem#Terminology


 ?Kindest Regards,
*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/23/21 10:28 PM, Avi Gross via R-help wrote:
> Stephen,
>
> It is becoming a pattern here.
>
> You have been told R allows ways to check for errors as the code is
> interpreted and this DOES NOT distinguish between development aspects and in
> the field. It does not matter if a problem is external like a required file
> not being in place or having a new name or whatever.
>
> Anything that may go wrong can be handled in quite a few ways. Some are
> fairly obvious, such as checking if an expected  list or vector or whatever
> is returned that is empty or not set or is the wrong data type or contains
> some NA or negative numbers and on and on. All kinds of IF statements and
> checks are a way to deal with these and you decide whether to make some kind
> of fix or abort.
>
> But obviously if the error happens outside your code (and sometimes also
> within) you can use various ways R provides to intercept the error and do
> something. Heck, people often use this in advance as a programming tactic
> such as using try() or tryCatch() to something like try to open file1 in the
> current directory and if that fails, in a specified directory and maybe if
> that fails, get it from file2 or maybe standard input ...
>
> Well-written code that wants to be bullet-proof will often be a bit bloated
> as it regularly stops and checks not only for all kinds of error conditions
> but also checks if the variables being used are in the proper format and
> range before being passed to functions that might break, is say you told it
> to use a correlation above 1. It also decides to intelligently deal with the
> errors, when possible.
>
> I have written code that called a statistical analysis (lavaan)  function
> hundreds of thousands of times on randomly generated data and it worked
> fine, except occasionally it broke. As I tended to run it overnight, it was
> a pain to wake up and find it had crashed. No, I am not aware why it
> crashed, but it could have been something as simple as a matrix that could
> not be inverted. But for my purposes, it did not matter as what I would be
> happy to get is knowing it failed, marking associated rows of a data.frame
> accordingly, and filtering out the results in later analyses. So, I wrapped
> not only this call but some others as described above and intercepted the
> rare problem and dealt with it and let my program continue overnight.
>
> Clearly if you expect anomalies to be rare, this is extra overhead. But if
> things do happen, then your code is not robust enough.
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
> DSL via R-help
> Sent: Thursday, December 23, 2021 11:17 AM
> To: Bert Gunter <bgunter.4567 at gmail.com>
> Cc: R-help <r-help at r-project.org>
> Subject: Re: [R] Error Awareness
>
> Hi Bert,
>
>
> Thanks for the reply.
>
> The use case I presented involves working code, not diagnosing a script in
> development.
>
> The concern is running a script where something changes outside of the
> script, as I stated. An example of a change is a data source changing
> perhaps the columns in the data source, or even changing the spelling of a
> column. The point is something changes.
>
> The question then becomes how to be aware of the change when the reset of
> the script runs fine, as I presented.
>
> Think of having a script running daily where you are not running it
> manually. How do you know there are errors in the script processing at this
> point?
>
> Does this question now make more sense?
>
>
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
>
> On 12/23/21 10:49 AM, Bert Gunter wrote:
>> ?tryCatch
>>
>> This list is not meant for tutorials. A web search on "find errors in
>> R code" brought up what appeared to be many resources to address your
>> question. Please make use of such resources before posting here. Also,
>> please read and follow the posting gui)de linked below to find out
>> what sort of help you can expect (and have already received here.
>>
>> Cheers,
>> Bert Gunter
>>
>> "The trouble with having an open mind is that people keep coming along
>> and sticking things into it."
>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>
>> On Thu, Dec 23, 2021 at 3:14 AM Stephen H. Dawson, DSL via R-help
>> <r-help at r-project.org> wrote:
>>> Hi,
>>>
>>>
>>> I am thinking about awareness of errors when an R script runs.
>>>
>>> My concern is I have an error-free script. I run it for months on end
>>> without problems. Then, something changes somewhere causing an error.
>>> My wonderment is how R will tell me I had an error in the script, but
>>> the rest of the script ran without impairment.
>>>
>>> QUESTIONS
>>> What are some of the more helpful options available to an R developer
>>> to capture errors in a script run?
>>>
>>> What are some of the best processes to implement these more helpful
> options?
>>>
>>> Thanks,
>>> --
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Fri Dec 24 16:34:37 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Fri, 24 Dec 2021 07:34:37 -0800 (PST)
Subject: [R] .Rdata not loading
In-Reply-To: <YcXbUDfAJIY/Jpid@posteo.no>
References: <95a8a491-a827-597f-edf7-4a6e9ee2dfb7@appl-ecosys.com>
 <YcXbUDfAJIY/Jpid@posteo.no>
Message-ID: <19e511a7-a062-d37d-5890-e53d77e5dc86@appl-ecosys.com>

On Fri, 24 Dec 2021, Rasmus Liland wrote:

> If you want to look at Rdata-files in a quick way in the
> terminal, use this little gem in your .zshrc.local:
>
> readrdata() { Rscript -e "options(width=$COLUMNS); load('$1'); sapply(ls(), get, simplify=F)" | less }

Rasmus,

I use bash, not zsh. And running the readdata() command in R produces no
output.

Thanks for the thought,

Rich


From du@@@@dr|@n @end|ng |rom gm@||@com  Fri Dec 24 16:48:17 2021
From: du@@@@dr|@n @end|ng |rom gm@||@com (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Fri, 24 Dec 2021 17:48:17 +0200
Subject: [R] .Rdata not loading
In-Reply-To: <19e511a7-a062-d37d-5890-e53d77e5dc86@appl-ecosys.com>
References: <95a8a491-a827-597f-edf7-4a6e9ee2dfb7@appl-ecosys.com>
 <YcXbUDfAJIY/Jpid@posteo.no>
 <19e511a7-a062-d37d-5890-e53d77e5dc86@appl-ecosys.com>
Message-ID: <CAJ=0CtD6-zcHFzW7fKuAidew=F038KUVJtSb0TjHQ-zXy+NExQ@mail.gmail.com>

On Fri, 24 Dec 2021 at 17:35, Rich Shepard <rshepard at appl-ecosys.com> wrote:

> On Fri, 24 Dec 2021, Rasmus Liland wrote:
>
> > If you want to look at Rdata-files in a quick way in the
> > terminal, use this little gem in your .zshrc.local:
> >
> > readrdata() { Rscript -e "options(width=$COLUMNS); load('$1');
> sapply(ls(), get, simplify=F)" | less }
>
> Rasmus,
>
> I use bash, not zsh. And running the readdata() command in R produces no
> output.
>

Package admisc has a function called obj.rda(), which returns the names of
the objects from an .Rdata file.
Not sure how it handles corrupt .Rdata files, but should generally give an
idea about what's inside.

Hth,
Adrian

	[[alternative HTML version deleted]]


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Fri Dec 24 17:31:21 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Fri, 24 Dec 2021 08:31:21 -0800 (PST)
Subject: [R] .Rdata not loading
In-Reply-To: <CAJ=0CtD6-zcHFzW7fKuAidew=F038KUVJtSb0TjHQ-zXy+NExQ@mail.gmail.com>
References: <95a8a491-a827-597f-edf7-4a6e9ee2dfb7@appl-ecosys.com>
 <YcXbUDfAJIY/Jpid@posteo.no>
 <19e511a7-a062-d37d-5890-e53d77e5dc86@appl-ecosys.com>
 <CAJ=0CtD6-zcHFzW7fKuAidew=F038KUVJtSb0TjHQ-zXy+NExQ@mail.gmail.com>
Message-ID: <88e4249c-bb3b-a6da-6be9-cfabd1396d2b@appl-ecosys.com>

On Fri, 24 Dec 2021, Adrian Du?a wrote:

> Package admisc has a function called obj.rda(), which returns the names of
> the objects from an .Rdata file. Not sure how it handles corrupt .Rdata
> files, but should generally give an idea about what's inside.

Adrian,

Thank you. I know what dataframes and plots should be in there. I'll
probably end up running all scripts again, in sequence, and reconstructing
what's lost. And, I'm experimenting with qs (quick save) to understand what
it does and how to use it.

Regards,

Rich


From @v|gro@@ @end|ng |rom ver|zon@net  Fri Dec 24 18:07:15 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Fri, 24 Dec 2021 12:07:15 -0500
Subject: [R] Error Awareness
In-Reply-To: <7a2f4d50-604c-4c16-f0a0-84b0e8d5e971@shdawson.com>
References: <a379c1dd-9a6e-f8a0-62eb-3ba893978f8e@shdawson.com>
 <CAGxFJbS4O9Hg95P19Tj17HJ4MjTuRUyqGuCsFWLENnhLJkPhEw@mail.gmail.com>
 <6ad7bcfb-8828-0572-e4f9-783945d64325@shdawson.com>
 <07ee01d7f876$61a399a0$24eacce0$@verizon.net>
 <7a2f4d50-604c-4c16-f0a0-84b0e8d5e971@shdawson.com>
Message-ID: <006101d7f8e8$b367e2b0$1a37a810$@verizon.net>

Stephen,

I actually happen to like debates and abstractions especially covering multiple languages and domains but not HERE. As you note, some people created this forum for several purposes but the word HELP should provide a clue as to the main purpose. It is not meant to teach R or do homework for people but is somewhere in between and elsewhere. Ideally, it helps people who are a bit stuck somewhere but can already program and need a fresh pair of eyes or some domain knowledge to get over that problem and continue. The Posting Guide spells it out.

There is some latitude but stretching it too far can be a problem. Plenty of people do and I suppose some of my longer messages also make me guilty. And people who repeatedly ask for one thing after another, often are those who should do some independent study before working on the problems as the people who volunteer here generally do not want a full-time unpaid tutoring job.

If you can find another forum that welcomes lively debates on what is good or bad about a language like R or discusses alternative ways to do things or bet practices and so on, or what new features might be helpful, let me know and I might join.

For now, I think I will step aside and focus my efforts elsewhere.

-----Original Message-----
From: Stephen H. Dawson, DSL <service at shdawson.com> 
Sent: Friday, December 24, 2021 9:49 AM
To: Avi Gross <avigross at verizon.net>; 'r-help mailing list' <r-help at r-project.org>
Subject: Re: [R] Error Awareness

Thank you, Avi. I appreciate your reply. I agree maturing code is the best move to answer this interrogatory. I express deep thanks for contextualizing your response.

I also agree with you responses are becoming a pattern here. A post of an open-ended question regarding either a conceptual or stylistic topic is answered pervasively with linear thinking. This combination is a mismatch of context.

https://www.r-project.org/posting-guide.html

I summarize reading in the R Posting Guide, which is written in English, the recommendation to state a specific question involving specific R functionality. I read nothing in the R Posting Guide where open-ended questions are disallowed or even discouraged. Furthermore, I cannot imagine not posting either conceptual or stylistic questions to any practice group. If learning is not accomplished by open-ended questions, then there is nothing left other than closed-ended (direct) questions.

All the same, the benefit of gaining either tacit understanding or wisdom to use the R language by way of open-ended questioning is not found in the R Posting Guide as it is either written or practiced. This reality impairs the ability to learn about a dialogue member's thought process. It also impairs the ability to ever be able to one day offer either contract or employment work to anyone demonstrating both intimate knowledge of the R language and having the wisdom to implement it effectively.

It is inappropriate to recommend modifications to the R Posting Guide in this discussion, as it would be out of scope. So, I will not do it.

I close this dialogue as resolved. It is best to post any further discussion of this interrogatory in a new dialogue to avoid violating the R Posting Guide requirement of the stated Latin term ad hominem.

  https://www.dictionary.com/browse/ad-hominem

  https://en.wikipedia.org/wiki/Ad_hominem#Terminology


  Kindest Regards,
*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/23/21 10:28 PM, Avi Gross via R-help wrote:
> Stephen,
>
> It is becoming a pattern here.
>
> You have been told R allows ways to check for errors as the code is 
> interpreted and this DOES NOT distinguish between development aspects 
> and in the field. It does not matter if a problem is external like a 
> required file not being in place or having a new name or whatever.
>
> Anything that may go wrong can be handled in quite a few ways. Some 
> are fairly obvious, such as checking if an expected  list or vector or 
> whatever is returned that is empty or not set or is the wrong data 
> type or contains some NA or negative numbers and on and on. All kinds 
> of IF statements and checks are a way to deal with these and you 
> decide whether to make some kind of fix or abort.
>
> But obviously if the error happens outside your code (and sometimes 
> also
> within) you can use various ways R provides to intercept the error and 
> do something. Heck, people often use this in advance as a programming 
> tactic such as using try() or tryCatch() to something like try to open 
> file1 in the current directory and if that fails, in a specified 
> directory and maybe if that fails, get it from file2 or maybe standard input ...
>
> Well-written code that wants to be bullet-proof will often be a bit 
> bloated as it regularly stops and checks not only for all kinds of 
> error conditions but also checks if the variables being used are in 
> the proper format and range before being passed to functions that 
> might break, is say you told it to use a correlation above 1. It also 
> decides to intelligently deal with the errors, when possible.
>
> I have written code that called a statistical analysis (lavaan)  
> function hundreds of thousands of times on randomly generated data and 
> it worked fine, except occasionally it broke. As I tended to run it 
> overnight, it was a pain to wake up and find it had crashed. No, I am 
> not aware why it crashed, but it could have been something as simple 
> as a matrix that could not be inverted. But for my purposes, it did 
> not matter as what I would be happy to get is knowing it failed, 
> marking associated rows of a data.frame accordingly, and filtering out 
> the results in later analyses. So, I wrapped not only this call but 
> some others as described above and intercepted the rare problem and dealt with it and let my program continue overnight.
>
> Clearly if you expect anomalies to be rare, this is extra overhead. 
> But if things do happen, then your code is not robust enough.
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. 
> Dawson, DSL via R-help
> Sent: Thursday, December 23, 2021 11:17 AM
> To: Bert Gunter <bgunter.4567 at gmail.com>
> Cc: R-help <r-help at r-project.org>
> Subject: Re: [R] Error Awareness
>
> Hi Bert,
>
>
> Thanks for the reply.
>
> The use case I presented involves working code, not diagnosing a 
> script in development.
>
> The concern is running a script where something changes outside of the 
> script, as I stated. An example of a change is a data source changing 
> perhaps the columns in the data source, or even changing the spelling 
> of a column. The point is something changes.
>
> The question then becomes how to be aware of the change when the reset 
> of the script runs fine, as I presented.
>
> Think of having a script running daily where you are not running it 
> manually. How do you know there are errors in the script processing at 
> this point?
>
> Does this question now make more sense?
>
>
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
>
> On 12/23/21 10:49 AM, Bert Gunter wrote:
>> ?tryCatch
>>
>> This list is not meant for tutorials. A web search on "find errors in 
>> R code" brought up what appeared to be many resources to address your 
>> question. Please make use of such resources before posting here. 
>> Also, please read and follow the posting gui)de linked below to find 
>> out what sort of help you can expect (and have already received here.
>>
>> Cheers,
>> Bert Gunter
>>
>> "The trouble with having an open mind is that people keep coming 
>> along and sticking things into it."
>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>
>> On Thu, Dec 23, 2021 at 3:14 AM Stephen H. Dawson, DSL via R-help 
>> <r-help at r-project.org> wrote:
>>> Hi,
>>>
>>>
>>> I am thinking about awareness of errors when an R script runs.
>>>
>>> My concern is I have an error-free script. I run it for months on 
>>> end without problems. Then, something changes somewhere causing an error.
>>> My wonderment is how R will tell me I had an error in the script, 
>>> but the rest of the script ran without impairment.
>>>
>>> QUESTIONS
>>> What are some of the more helpful options available to an R 
>>> developer to capture errors in a script run?
>>>
>>> What are some of the best processes to implement these more helpful
> options?
>>>
>>> Thanks,
>>> --
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Fri Dec 24 19:22:45 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Fri, 24 Dec 2021 18:22:45 +0000
Subject: [R] .Rdata not loading
In-Reply-To: <88e4249c-bb3b-a6da-6be9-cfabd1396d2b@appl-ecosys.com>
References: <95a8a491-a827-597f-edf7-4a6e9ee2dfb7@appl-ecosys.com>
 <YcXbUDfAJIY/Jpid@posteo.no>
 <19e511a7-a062-d37d-5890-e53d77e5dc86@appl-ecosys.com>
 <CAJ=0CtD6-zcHFzW7fKuAidew=F038KUVJtSb0TjHQ-zXy+NExQ@mail.gmail.com>
 <88e4249c-bb3b-a6da-6be9-cfabd1396d2b@appl-ecosys.com>
Message-ID: <b487f62e-44df-01a1-f392-fc336c5e7f80@sapo.pt>

Hello,

Can section Adoption of this Library of Congress link


https://www.loc.gov/preservation/digital/formats/fdd/fdd000470.shtml


help? I'm really not sure.


Happy Holidays,

Rui Barradas

?s 16:31 de 24/12/21, Rich Shepard escreveu:
> On Fri, 24 Dec 2021, Adrian Du?a wrote:
> 
>> Package admisc has a function called obj.rda(), which returns the 
>> names of
>> the objects from an .Rdata file. Not sure how it handles corrupt .Rdata
>> files, but should generally give an idea about what's inside.
> 
> Adrian,
> 
> Thank you. I know what dataframes and plots should be in there. I'll
> probably end up running all scripts again, in sequence, and reconstructing
> what's lost. And, I'm experimenting with qs (quick save) to understand what
> it does and how to use it.
> 
> Regards,
> 
> Rich
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Dec 24 19:30:29 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 24 Dec 2021 10:30:29 -0800
Subject: [R] .Rdata not loading
In-Reply-To: <88e4249c-bb3b-a6da-6be9-cfabd1396d2b@appl-ecosys.com>
References: <95a8a491-a827-597f-edf7-4a6e9ee2dfb7@appl-ecosys.com>
 <YcXbUDfAJIY/Jpid@posteo.no>
 <19e511a7-a062-d37d-5890-e53d77e5dc86@appl-ecosys.com>
 <CAJ=0CtD6-zcHFzW7fKuAidew=F038KUVJtSb0TjHQ-zXy+NExQ@mail.gmail.com>
 <88e4249c-bb3b-a6da-6be9-cfabd1396d2b@appl-ecosys.com>
Message-ID: <7BB4DBBE-3E57-4F34-A262-DB98434B8016@dcn.davis.ca.us>

The qsave/qread functions from the qs package are functionally interchangeable with saveRDS/readRDS, but faster and create smaller files. A simple

  if ( file.exists( "obj1.qs" ) ) {
    obj1 <- qread( "onj1.qs" )
  } else {
    obj1 <- compute_obj1()
    qsave( obj1, "obj1.qs" )
  }

can be used but there are various caching packages [1] for ad-hoc use that attempt to determine when a computation is out of date better than the existence of a file (that you have to manually delete if you want to recompute) but they may either fail to notice relevant changes or recompute unnecessarily.  I have in the last couple of months found that the targets package [2] seems to excel at balancing these concerns and regularly use it now for large or complicated analyses. You can build the _targets.R file by hand or use a targets markdown file to build it for you and let you document your  process as you go. Once all objects are computed and in the cache then you can build reporting scripts that generate plots and tabular output that retrieve the data as needed.

[1] https://joshuacook.netlify.app/post/caching-in-r/

[2] https://books.ropensci.org/targets/

On December 24, 2021 8:31:21 AM PST, Rich Shepard <rshepard at appl-ecosys.com> wrote:
>On Fri, 24 Dec 2021, Adrian Du?a wrote:
>
>> Package admisc has a function called obj.rda(), which returns the names of
>> the objects from an .Rdata file. Not sure how it handles corrupt .Rdata
>> files, but should generally give an idea about what's inside.
>
>Adrian,
>
>Thank you. I know what dataframes and plots should be in there. I'll
>probably end up running all scripts again, in sequence, and reconstructing
>what's lost. And, I'm experimenting with qs (quick save) to understand what
>it does and how to use it.
>
>Regards,
>
>Rich
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Fri Dec 24 20:13:40 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Fri, 24 Dec 2021 11:13:40 -0800 (PST)
Subject: [R] .Rdata not loading
In-Reply-To: <b487f62e-44df-01a1-f392-fc336c5e7f80@sapo.pt>
References: <95a8a491-a827-597f-edf7-4a6e9ee2dfb7@appl-ecosys.com>
 <YcXbUDfAJIY/Jpid@posteo.no>
 <19e511a7-a062-d37d-5890-e53d77e5dc86@appl-ecosys.com>
 <CAJ=0CtD6-zcHFzW7fKuAidew=F038KUVJtSb0TjHQ-zXy+NExQ@mail.gmail.com>
 <88e4249c-bb3b-a6da-6be9-cfabd1396d2b@appl-ecosys.com>
 <b487f62e-44df-01a1-f392-fc336c5e7f80@sapo.pt>
Message-ID: <9b70bc13-8082-86bb-159-29605e3074d0@appl-ecosys.com>

On Fri, 24 Dec 2021, Rui Barradas wrote:

> Can section Adoption of this Library of Congress link
> https://www.loc.gov/preservation/digital/formats/fdd/fdd000470.shtml
> help? I'm really not sure.

Rui,

After reading that interesting page I don't see how it helps me. I think
that re-running all my scripts, in order, is needed. As this is the first
time I've started R and not have the saved workspace automatically loaded
I'll keep saving the workspace prior to exiting. Should this happen again
I'll change to using an alternative, probably quick sequense (qs). Having
all scripts makes re-creating the workspace a small time investment.

Happy holiday to you and yours,

Rich


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Fri Dec 24 20:26:25 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Fri, 24 Dec 2021 11:26:25 -0800 (PST)
Subject: [R] .Rdata not loading
In-Reply-To: <7BB4DBBE-3E57-4F34-A262-DB98434B8016@dcn.davis.ca.us>
References: <95a8a491-a827-597f-edf7-4a6e9ee2dfb7@appl-ecosys.com>
 <YcXbUDfAJIY/Jpid@posteo.no>
 <19e511a7-a062-d37d-5890-e53d77e5dc86@appl-ecosys.com>
 <CAJ=0CtD6-zcHFzW7fKuAidew=F038KUVJtSb0TjHQ-zXy+NExQ@mail.gmail.com>
 <88e4249c-bb3b-a6da-6be9-cfabd1396d2b@appl-ecosys.com>
 <7BB4DBBE-3E57-4F34-A262-DB98434B8016@dcn.davis.ca.us>
Message-ID: <a278b519-e2d3-b453-8fc7-d3114e8f2757@appl-ecosys.com>

On Fri, 24 Dec 2021, Jeff Newmiller wrote:

> The qsave/qread functions from the qs package are functionally
> interchangeable with saveRDS/readRDS, but faster and create smaller files.
> A simple
>
>  if ( file.exists( "obj1.qs" ) ) {
>    obj1 <- qread( "onj1.qs" )
>  } else {
>    obj1 <- compute_obj1()
>    qsave( obj1, "obj1.qs" )
>  }
> can be used

Jeff,

I understand that with qs each R object needs to be in a separate .qs file
rather than having all of them in a single file such as .RData or .rda.

> ... but there are various caching packages [1] for ad-hoc use that
> attempt to determine when a computation is out of date better than the
> existence of a file (that you have to manually delete if you want to
> recompute) but they may either fail to notice relevant changes or
> recompute unnecessarily.

I'll look closely at caching-in-R.

> I have in the last couple of months found that the targets package [2]
> seems to excel at balancing these concerns and regularly use it now for
> large or complicated analyses.

I read the targets users manual and vignettes and found that it's much too
complex for my simple needs. I consider my projects to be subjectively
small and uncomplicated. Each of my projects are unique and one-off.

Thanks and happy holiday,

Rich


From y@ngk@|9999 @end|ng |rom y@hoo@com  Fri Dec 24 22:48:00 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Fri, 24 Dec 2021 21:48:00 +0000 (UTC)
Subject: [R] question about for loop
References: <730562731.721058.1640382480210.ref@mail.yahoo.com>
Message-ID: <730562731.721058.1640382480210@mail.yahoo.com>

Hello Team,
I create a csv file (mac2) to save?parameter values. the file looks like:

y,c,f
hwy,cyl,hwy_cyl2
cty,class,cty_class2

Then I load the file into R and apply the parameters y, c, f in for loop, see my code below:
library(ggplot2)
library(tidyverse)
library(readr)
mac2 <- read_csv("C:/temp/mac2.csv")
View(mac2)
for (i in seq(nrow(mac2))){
? mpg %>%
? ? filter(hwy <35) %>%?
? ? ggplot(aes(x = displ, y = get(y[i]), color = get(c[i]) )) +?
? ? geom_point()+
? ? ylab(y[i]) +? ? ? ? ? ? ? ? ? ? ? ? ? ? ??
? ? guides(color = guide_legend(title = c[i]))??? ggsave(paste0("c:/temp/",f[i],".jpg"),width = 9, height = 6, dpi = 1200, units = "in")
}

but I got an error message: "Error in dots_list(..., title = title, subtitle = subtitle, caption = caption,? :? object 'y' not found"
Does anyone know how to fix the problem?
Thanks,
Kai


	[[alternative HTML version deleted]]


From @kw@|mmo @end|ng |rom gm@||@com  Fri Dec 24 23:37:02 2021
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Fri, 24 Dec 2021 17:37:02 -0500
Subject: [R] question about for loop
In-Reply-To: <730562731.721058.1640382480210@mail.yahoo.com>
References: <730562731.721058.1640382480210.ref@mail.yahoo.com>
 <730562731.721058.1640382480210@mail.yahoo.com>
Message-ID: <CAPcHnpRwhfVOJ20EuS4ceLv0t6O5RHnQR=ZGdNuYxGtkeKt6gA@mail.gmail.com>

y, c, and f only exist in the context of mac2
If you want to use them, you'll have to write mac2$y, mac2$c, or mac2$f (or
the [[ versions mac2[["y"]], mac2[["c"]], or mac2[["f"]])
Combining that with index i would then look like mac2$y[[i]] or mac2[[i,
"y"]]

Also, I think you want to use aes_string instead of aes (since you want
those expressions within aes to be evaluated)
Something like this seems to work for me:


`%>%` <- magrittr::`%>%`


writeLines(FILE <- tempfile(), text =
r"{y,c,f
hwy,cyl,hwy_cyl2
cty,class,cty_class2}")


mac2 <- readr::read_csv(FILE)
for (i in seq_len(nrow(mac2))) {
    ggplt <- ggplot2::mpg %>%
        dplyr::filter(hwy < 35) %>%
        ggplot2::ggplot(
            ggplot2::aes_string(
                x = "displ",
                y = mac2[[i, "y"]],
                color = mac2[[i, "c"]]
            )
        ) +
        ggplot2::geom_point() +
        ggplot2::ylab(mac2[[i, "y"]]) +
        ggplot2::guides(
            color = ggplot2::guide_legend(title = mac2[[i, "c"]])
        )
    ggplot2::ggsave(
        filename = tempfile(
            mac2[[i, "f"]],
            fileext = ".jpg"
        ),
        plot = ggplt,
        width = 9, height = 6, dpi = 1200
    )
}


unlink(FILE)


runs fine on my computer, but might look more like this for you:


library(magrittr)
library(ggplot2)
library(dplyr)
library(readr)


mac2 <- read_csv("C:/temp/mac2.csv")
for (i in seq_len(nrow(mac2))) {
    ggplt <- mpg %>%
        filter(hwy < 35) %>%
        ggplot(
            aes_string(
                x = "displ",
                y = mac2[[i, "y"]],
                color = mac2[[i, "c"]]
            )
        ) +
        geom_point() +
        ylab(mac2[[i, "y"]]) +
        guides(
            color = guide_legend(title = mac2[[i, "c"]])
        )
    ggsave(
        filename = paste0("C:/temp/", mac2[[i, "f"]], ".jpg"),
        plot = ggplt,
        width = 9, height = 6, dpi = 1200
    )
}


try reading through aes and aes_string, and keep in mind that columns in
data frames aren't R variables (where they are in Excel). If you want to
use columns like they are variables, you can try using `with`. For example:


library(magrittr)
library(ggplot2)
library(dplyr)
library(readr)


mac2 <- read_csv("C:/temp/mac2.csv")
for (i in seq_len(nrow(mac2))) {
    with(mac2[i, ], {
        ggplt <- mpg %>%
            filter(hwy < 35) %>%
            ggplot(
                aes_string(
                    x = "displ",
                    y = y,
                    color = c
                )
            ) +
            geom_point() +
            ylab(y) +
            guides(
                color = guide_legend(title = c)
            )
        ggsave(
            filename = paste0("C:/temp/", f, ".jpg"),
            plot = ggplt,
            width = 9, height = 6, dpi = 1200
        )
    })
}




On Fri, Dec 24, 2021 at 4:48 PM Kai Yang via R-help <r-help at r-project.org>
wrote:

> Hello Team,
> I create a csv file (mac2) to save parameter values. the file looks like:
>
> y,c,f
> hwy,cyl,hwy_cyl2
> cty,class,cty_class2
>
> Then I load the file into R and apply the parameters y, c, f in for loop,
> see my code below:
> library(ggplot2)
> library(tidyverse)
> library(readr)
> mac2 <- read_csv("C:/temp/mac2.csv")
> View(mac2)
> for (i in seq(nrow(mac2))){
>   mpg %>%
>     filter(hwy <35) %>%
>     ggplot(aes(x = displ, y = get(y[i]), color = get(c[i]) )) +
>     geom_point()+
>     ylab(y[i]) +
>     guides(color = guide_legend(title = c[i]))
> ggsave(paste0("c:/temp/",f[i],".jpg"),width = 9, height = 6, dpi = 1200,
> units = "in")
> }
>
> but I got an error message: "Error in dots_list(..., title = title,
> subtitle = subtitle, caption = caption,  :  object 'y' not found"
> Does anyone know how to fix the problem?
> Thanks,
> Kai
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From y@ngk@|9999 @end|ng |rom y@hoo@com  Sat Dec 25 01:41:29 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Sat, 25 Dec 2021 00:41:29 +0000 (UTC)
Subject: [R] question about for loop
In-Reply-To: <CAPcHnpRwhfVOJ20EuS4ceLv0t6O5RHnQR=ZGdNuYxGtkeKt6gA@mail.gmail.com>
References: <730562731.721058.1640382480210.ref@mail.yahoo.com>
 <730562731.721058.1640382480210@mail.yahoo.com>
 <CAPcHnpRwhfVOJ20EuS4ceLv0t6O5RHnQR=ZGdNuYxGtkeKt6gA@mail.gmail.com>
Message-ID: <196177208.715226.1640392889292@mail.yahoo.com>

 Thanks Andrew. This is super helpful. --- Kai
    On Friday, December 24, 2021, 02:37:14 PM PST, Andrew Simmons <akwsimmo at gmail.com> wrote:  
 
 y, c, and f only exist in the context of mac2If you want to use them, you'll have to write mac2$y, mac2$c, or mac2$f (or the [[ versions mac2[["y"]], mac2[["c"]], or mac2[["f"]])Combining that with index i would then look like mac2$y[[i]] or mac2[[i, "y"]]
Also, I think you want to use aes_string instead of aes (since you want those expressions within aes to be evaluated)Something?like this seems to work for me:

`%>%` <- magrittr::`%>%`


writeLines(FILE <- tempfile(), text =
r"{y,c,f
hwy,cyl,hwy_cyl2
cty,class,cty_class2}")


mac2 <- readr::read_csv(FILE)
for (i in seq_len(nrow(mac2))) {
? ? ggplt <- ggplot2::mpg %>%
? ? ? ? dplyr::filter(hwy < 35) %>%
? ? ? ? ggplot2::ggplot(
? ? ? ? ? ? ggplot2::aes_string(
? ? ? ? ? ? ? ? x = "displ",
? ? ? ? ? ? ? ? y = mac2[[i, "y"]],
? ? ? ? ? ? ? ? color = mac2[[i, "c"]]
? ? ? ? ? ? )
? ? ? ? ) +
? ? ? ? ggplot2::geom_point() +
? ? ? ? ggplot2::ylab(mac2[[i, "y"]]) +
? ? ? ? ggplot2::guides(
? ? ? ? ? ? color = ggplot2::guide_legend(title = mac2[[i, "c"]])
? ? ? ? )
? ? ggplot2::ggsave(
? ? ? ? filename = tempfile(
? ? ? ? ? ? mac2[[i, "f"]],
? ? ? ? ? ? fileext = ".jpg"
? ? ? ? ),
? ? ? ? plot = ggplt,
? ? ? ? width = 9, height = 6, dpi = 1200
? ? )
}


unlink(FILE)


runs fine on my computer, but might look more like this for you:

library(magrittr)
library(ggplot2)
library(dplyr)
library(readr)


mac2 <- read_csv("C:/temp/mac2.csv")
for (i in seq_len(nrow(mac2))) {
? ? ggplt <- mpg %>%
? ? ? ? filter(hwy < 35) %>%
? ? ? ? ggplot(
? ? ? ? ? ? aes_string(
? ? ? ? ? ? ? ? x = "displ",
? ? ? ? ? ? ? ? y = mac2[[i, "y"]],
? ? ? ? ? ? ? ? color = mac2[[i, "c"]]
? ? ? ? ? ? )
? ? ? ? ) +
? ? ? ? geom_point() +
? ? ? ? ylab(mac2[[i, "y"]]) +
? ? ? ? guides(
? ? ? ? ? ? color = guide_legend(title = mac2[[i, "c"]])
? ? ? ? )
? ? ggsave(
? ? ? ? filename = paste0("C:/temp/", mac2[[i, "f"]], ".jpg"),
? ? ? ? plot = ggplt,
? ? ? ? width = 9, height = 6, dpi = 1200
? ? )
}


try reading through aes and aes_string, and keep in mind that columns in data frames aren't R variables (where they are in Excel). If you want to use columns like they are variables, you can try using `with`. For example:

library(magrittr)
library(ggplot2)
library(dplyr)
library(readr)


mac2 <- read_csv("C:/temp/mac2.csv")
for (i in seq_len(nrow(mac2))) {
? ? with(mac2[i, ], {
? ? ? ? ggplt <- mpg %>%
? ? ? ? ? ? filter(hwy < 35) %>%
? ? ? ? ? ? ggplot(
? ? ? ? ? ? ? ? aes_string(
? ? ? ? ? ? ? ? ? ? x = "displ",
? ? ? ? ? ? ? ? ? ? y = y,
? ? ? ? ? ? ? ? ? ? color = c
? ? ? ? ? ? ? ? )
? ? ? ? ? ? ) +
? ? ? ? ? ? geom_point() +
? ? ? ? ? ? ylab(y) +
? ? ? ? ? ? guides(
? ? ? ? ? ? ? ? color = guide_legend(title = c)
? ? ? ? ? ? )
? ? ? ? ggsave(
? ? ? ? ? ? filename = paste0("C:/temp/", f, ".jpg"),
? ? ? ? ? ? plot = ggplt,
? ? ? ? ? ? width = 9, height = 6, dpi = 1200
? ? ? ? )
? ? })
}




On Fri, Dec 24, 2021 at 4:48 PM Kai Yang via R-help <r-help at r-project.org> wrote:

Hello Team,
I create a csv file (mac2) to save?parameter values. the file looks like:

y,c,f
hwy,cyl,hwy_cyl2
cty,class,cty_class2

Then I load the file into R and apply the parameters y, c, f in for loop, see my code below:
library(ggplot2)
library(tidyverse)
library(readr)
mac2 <- read_csv("C:/temp/mac2.csv")
View(mac2)
for (i in seq(nrow(mac2))){
? mpg %>%
? ? filter(hwy <35) %>%?
? ? ggplot(aes(x = displ, y = get(y[i]), color = get(c[i]) )) +?
? ? geom_point()+
? ? ylab(y[i]) +? ? ? ? ? ? ? ? ? ? ? ? ? ? ??
? ? guides(color = guide_legend(title = c[i]))??? ggsave(paste0("c:/temp/",f[i],".jpg"),width = 9, height = 6, dpi = 1200, units = "in")
}

but I got an error message: "Error in dots_list(..., title = title, subtitle = subtitle, caption = caption,? :? object 'y' not found"
Does anyone know how to fix the problem?
Thanks,
Kai


? ? ? ? [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

  
	[[alternative HTML version deleted]]


From @v|gro@@ @end|ng |rom ver|zon@net  Sat Dec 25 01:54:04 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Fri, 24 Dec 2021 19:54:04 -0500
Subject: [R] question about for loop
In-Reply-To: <CAPcHnpRwhfVOJ20EuS4ceLv0t6O5RHnQR=ZGdNuYxGtkeKt6gA@mail.gmail.com>
References: <730562731.721058.1640382480210.ref@mail.yahoo.com>
 <730562731.721058.1640382480210@mail.yahoo.com>
 <CAPcHnpRwhfVOJ20EuS4ceLv0t6O5RHnQR=ZGdNuYxGtkeKt6gA@mail.gmail.com>
Message-ID: <030901d7f929$ea2f4220$be8dc660$@verizon.net>

Suggestion to consider another approach:

Once various errors are fixed, the program being done basically sounds like
you want to repeat a sequence of actions one per ROW of a data.frame. As it
happens, the action to perform is based on a second data.frame given to
ggplot, with parts dynamically inserted from the variables in one row.

So consider making a function with a name like graph_it() that does what you
want when passed three named arguments. I mean it takes arguments with names
like alpha, beta and gamma and then use the pmap() function (part of the
tidyverse unfortunately in the purr package) along with the function you
want:

Typing:

pmap(.l=mac2, .f=graph_it)

Will implicitly perform your functionality one row after another without an
explicit loop and often faster than nested loops would be. I have used the
technique to replace a deeply nested loop that generates all combinations of
multiple categorical variables (about a million) into a data.frame, then do
something with each one fairly efficiently.

If nothing else, it would make this problem a tad simpler by not needing
subscripts.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Andrew Simmons
Sent: Friday, December 24, 2021 5:37 PM
To: Kai Yang <yangkai9999 at yahoo.com>
Cc: R-help Mailing List <r-help at r-project.org>
Subject: Re: [R] question about for loop

y, c, and f only exist in the context of mac2 If you want to use them,
you'll have to write mac2$y, mac2$c, or mac2$f (or the [[ versions
mac2[["y"]], mac2[["c"]], or mac2[["f"]]) Combining that with index i would
then look like mac2$y[[i]] or mac2[[i, "y"]]

Also, I think you want to use aes_string instead of aes (since you want
those expressions within aes to be evaluated) Something like this seems to
work for me:


`%>%` <- magrittr::`%>%`


writeLines(FILE <- tempfile(), text =
r"{y,c,f
hwy,cyl,hwy_cyl2
cty,class,cty_class2}")


mac2 <- readr::read_csv(FILE)
for (i in seq_len(nrow(mac2))) {
    ggplt <- ggplot2::mpg %>%
        dplyr::filter(hwy < 35) %>%
        ggplot2::ggplot(
            ggplot2::aes_string(
                x = "displ",
                y = mac2[[i, "y"]],
                color = mac2[[i, "c"]]
            )
        ) +
        ggplot2::geom_point() +
        ggplot2::ylab(mac2[[i, "y"]]) +
        ggplot2::guides(
            color = ggplot2::guide_legend(title = mac2[[i, "c"]])
        )
    ggplot2::ggsave(
        filename = tempfile(
            mac2[[i, "f"]],
            fileext = ".jpg"
        ),
        plot = ggplt,
        width = 9, height = 6, dpi = 1200
    )
}


unlink(FILE)


runs fine on my computer, but might look more like this for you:


library(magrittr)
library(ggplot2)
library(dplyr)
library(readr)


mac2 <- read_csv("C:/temp/mac2.csv")
for (i in seq_len(nrow(mac2))) {
    ggplt <- mpg %>%
        filter(hwy < 35) %>%
        ggplot(
            aes_string(
                x = "displ",
                y = mac2[[i, "y"]],
                color = mac2[[i, "c"]]
            )
        ) +
        geom_point() +
        ylab(mac2[[i, "y"]]) +
        guides(
            color = guide_legend(title = mac2[[i, "c"]])
        )
    ggsave(
        filename = paste0("C:/temp/", mac2[[i, "f"]], ".jpg"),
        plot = ggplt,
        width = 9, height = 6, dpi = 1200
    )
}


try reading through aes and aes_string, and keep in mind that columns in
data frames aren't R variables (where they are in Excel). If you want to use
columns like they are variables, you can try using `with`. For example:


library(magrittr)
library(ggplot2)
library(dplyr)
library(readr)


mac2 <- read_csv("C:/temp/mac2.csv")
for (i in seq_len(nrow(mac2))) {
    with(mac2[i, ], {
        ggplt <- mpg %>%
            filter(hwy < 35) %>%
            ggplot(
                aes_string(
                    x = "displ",
                    y = y,
                    color = c
                )
            ) +
            geom_point() +
            ylab(y) +
            guides(
                color = guide_legend(title = c)
            )
        ggsave(
            filename = paste0("C:/temp/", f, ".jpg"),
            plot = ggplt,
            width = 9, height = 6, dpi = 1200
        )
    })
}




On Fri, Dec 24, 2021 at 4:48 PM Kai Yang via R-help <r-help at r-project.org>
wrote:

> Hello Team,
> I create a csv file (mac2) to save parameter values. the file looks like:
>
> y,c,f
> hwy,cyl,hwy_cyl2
> cty,class,cty_class2
>
> Then I load the file into R and apply the parameters y, c, f in for 
> loop, see my code below:
> library(ggplot2)
> library(tidyverse)
> library(readr)
> mac2 <- read_csv("C:/temp/mac2.csv")
> View(mac2)
> for (i in seq(nrow(mac2))){
>   mpg %>%
>     filter(hwy <35) %>%
>     ggplot(aes(x = displ, y = get(y[i]), color = get(c[i]) )) +
>     geom_point()+
>     ylab(y[i]) +
>     guides(color = guide_legend(title = c[i])) 
> ggsave(paste0("c:/temp/",f[i],".jpg"),width = 9, height = 6, dpi = 
> 1200, units = "in") }
>
> but I got an error message: "Error in dots_list(..., title = title, 
> subtitle = subtitle, caption = caption,  :  object 'y' not found"
> Does anyone know how to fix the problem?
> Thanks,
> Kai
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From y@ngk@|9999 @end|ng |rom y@hoo@com  Sat Dec 25 03:07:39 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Sat, 25 Dec 2021 02:07:39 +0000 (UTC)
Subject: [R] question about for loop
In-Reply-To: <030901d7f929$ea2f4220$be8dc660$@verizon.net>
References: <730562731.721058.1640382480210.ref@mail.yahoo.com>
 <730562731.721058.1640382480210@mail.yahoo.com>
 <CAPcHnpRwhfVOJ20EuS4ceLv0t6O5RHnQR=ZGdNuYxGtkeKt6gA@mail.gmail.com>
 <030901d7f929$ea2f4220$be8dc660$@verizon.net>
Message-ID: <983023812.607894.1640398059228@mail.yahoo.com>

 Thanks Avi. This is a good idea. I'm learning how to create a function in R now and may have more questions for you.?I really apricate all of your help.?Wish you have a great holiday and happy new year !Kai
    On Friday, December 24, 2021, 04:54:36 PM PST, Avi Gross via R-help <r-help at r-project.org> wrote:  
 
 Suggestion to consider another approach:

Once various errors are fixed, the program being done basically sounds like
you want to repeat a sequence of actions one per ROW of a data.frame. As it
happens, the action to perform is based on a second data.frame given to
ggplot, with parts dynamically inserted from the variables in one row.

So consider making a function with a name like graph_it() that does what you
want when passed three named arguments. I mean it takes arguments with names
like alpha, beta and gamma and then use the pmap() function (part of the
tidyverse unfortunately in the purr package) along with the function you
want:

Typing:

pmap(.l=mac2, .f=graph_it)

Will implicitly perform your functionality one row after another without an
explicit loop and often faster than nested loops would be. I have used the
technique to replace a deeply nested loop that generates all combinations of
multiple categorical variables (about a million) into a data.frame, then do
something with each one fairly efficiently.

If nothing else, it would make this problem a tad simpler by not needing
subscripts.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Andrew Simmons
Sent: Friday, December 24, 2021 5:37 PM
To: Kai Yang <yangkai9999 at yahoo.com>
Cc: R-help Mailing List <r-help at r-project.org>
Subject: Re: [R] question about for loop

y, c, and f only exist in the context of mac2 If you want to use them,
you'll have to write mac2$y, mac2$c, or mac2$f (or the [[ versions
mac2[["y"]], mac2[["c"]], or mac2[["f"]]) Combining that with index i would
then look like mac2$y[[i]] or mac2[[i, "y"]]

Also, I think you want to use aes_string instead of aes (since you want
those expressions within aes to be evaluated) Something like this seems to
work for me:


`%>%` <- magrittr::`%>%`


writeLines(FILE <- tempfile(), text =
r"{y,c,f
hwy,cyl,hwy_cyl2
cty,class,cty_class2}")


mac2 <- readr::read_csv(FILE)
for (i in seq_len(nrow(mac2))) {
? ? ggplt <- ggplot2::mpg %>%
? ? ? ? dplyr::filter(hwy < 35) %>%
? ? ? ? ggplot2::ggplot(
? ? ? ? ? ? ggplot2::aes_string(
? ? ? ? ? ? ? ? x = "displ",
? ? ? ? ? ? ? ? y = mac2[[i, "y"]],
? ? ? ? ? ? ? ? color = mac2[[i, "c"]]
? ? ? ? ? ? )
? ? ? ? ) +
? ? ? ? ggplot2::geom_point() +
? ? ? ? ggplot2::ylab(mac2[[i, "y"]]) +
? ? ? ? ggplot2::guides(
? ? ? ? ? ? color = ggplot2::guide_legend(title = mac2[[i, "c"]])
? ? ? ? )
? ? ggplot2::ggsave(
? ? ? ? filename = tempfile(
? ? ? ? ? ? mac2[[i, "f"]],
? ? ? ? ? ? fileext = ".jpg"
? ? ? ? ),
? ? ? ? plot = ggplt,
? ? ? ? width = 9, height = 6, dpi = 1200
? ? )
}


unlink(FILE)


runs fine on my computer, but might look more like this for you:


library(magrittr)
library(ggplot2)
library(dplyr)
library(readr)


mac2 <- read_csv("C:/temp/mac2.csv")
for (i in seq_len(nrow(mac2))) {
? ? ggplt <- mpg %>%
? ? ? ? filter(hwy < 35) %>%
? ? ? ? ggplot(
? ? ? ? ? ? aes_string(
? ? ? ? ? ? ? ? x = "displ",
? ? ? ? ? ? ? ? y = mac2[[i, "y"]],
? ? ? ? ? ? ? ? color = mac2[[i, "c"]]
? ? ? ? ? ? )
? ? ? ? ) +
? ? ? ? geom_point() +
? ? ? ? ylab(mac2[[i, "y"]]) +
? ? ? ? guides(
? ? ? ? ? ? color = guide_legend(title = mac2[[i, "c"]])
? ? ? ? )
? ? ggsave(
? ? ? ? filename = paste0("C:/temp/", mac2[[i, "f"]], ".jpg"),
? ? ? ? plot = ggplt,
? ? ? ? width = 9, height = 6, dpi = 1200
? ? )
}


try reading through aes and aes_string, and keep in mind that columns in
data frames aren't R variables (where they are in Excel). If you want to use
columns like they are variables, you can try using `with`. For example:


library(magrittr)
library(ggplot2)
library(dplyr)
library(readr)


mac2 <- read_csv("C:/temp/mac2.csv")
for (i in seq_len(nrow(mac2))) {
? ? with(mac2[i, ], {
? ? ? ? ggplt <- mpg %>%
? ? ? ? ? ? filter(hwy < 35) %>%
? ? ? ? ? ? ggplot(
? ? ? ? ? ? ? ? aes_string(
? ? ? ? ? ? ? ? ? ? x = "displ",
? ? ? ? ? ? ? ? ? ? y = y,
? ? ? ? ? ? ? ? ? ? color = c
? ? ? ? ? ? ? ? )
? ? ? ? ? ? ) +
? ? ? ? ? ? geom_point() +
? ? ? ? ? ? ylab(y) +
? ? ? ? ? ? guides(
? ? ? ? ? ? ? ? color = guide_legend(title = c)
? ? ? ? ? ? )
? ? ? ? ggsave(
? ? ? ? ? ? filename = paste0("C:/temp/", f, ".jpg"),
? ? ? ? ? ? plot = ggplt,
? ? ? ? ? ? width = 9, height = 6, dpi = 1200
? ? ? ? )
? ? })
}




On Fri, Dec 24, 2021 at 4:48 PM Kai Yang via R-help <r-help at r-project.org>
wrote:

> Hello Team,
> I create a csv file (mac2) to save parameter values. the file looks like:
>
> y,c,f
> hwy,cyl,hwy_cyl2
> cty,class,cty_class2
>
> Then I load the file into R and apply the parameters y, c, f in for 
> loop, see my code below:
> library(ggplot2)
> library(tidyverse)
> library(readr)
> mac2 <- read_csv("C:/temp/mac2.csv")
> View(mac2)
> for (i in seq(nrow(mac2))){
>? mpg %>%
>? ? filter(hwy <35) %>%
>? ? ggplot(aes(x = displ, y = get(y[i]), color = get(c[i]) )) +
>? ? geom_point()+
>? ? ylab(y[i]) +
>? ? guides(color = guide_legend(title = c[i])) 
> ggsave(paste0("c:/temp/",f[i],".jpg"),width = 9, height = 6, dpi = 
> 1200, units = "in") }
>
> but I got an error message: "Error in dots_list(..., title = title, 
> subtitle = subtitle, caption = caption,? :? object 'y' not found"
> Does anyone know how to fix the problem?
> Thanks,
> Kai
>
>
>? ? ? ? [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

??? [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.
  
	[[alternative HTML version deleted]]


From r@oknz @end|ng |rom gm@||@com  Sat Dec 25 08:51:38 2021
From: r@oknz @end|ng |rom gm@||@com (Richard O'Keefe)
Date: Sat, 25 Dec 2021 20:51:38 +1300
Subject: [R] Error Awareness
In-Reply-To: <a379c1dd-9a6e-f8a0-62eb-3ba893978f8e@shdawson.com>
References: <a379c1dd-9a6e-f8a0-62eb-3ba893978f8e@shdawson.com>
Message-ID: <CABcYAdKHAZH7zXizietm33U=9_MaN4vtgjjwwVbNX4-GgOrCpQ@mail.gmail.com>

You want to read this:

http://adv-r.had.co.nz/Exceptions-Debugging.html

It describes all the ways that R can report a problem
and all the ways you can catch such a report while still in R.

Let me heartily recommend the whole site, or better yet, the book
https://www.amazon.com/dp/0815384572/ref=cm_sw_su_dp?tag=devtools-20



On Fri, 24 Dec 2021 at 00:14, Stephen H. Dawson, DSL via R-help <
r-help at r-project.org> wrote:

> Hi,
>
>
> I am thinking about awareness of errors when an R script runs.
>
> My concern is I have an error-free script. I run it for months on end
> without problems. Then, something changes somewhere causing an error. My
> wonderment is how R will tell me I had an error in the script, but the
> rest of the script ran without impairment.
>
> QUESTIONS
> What are some of the more helpful options available to an R developer to
> capture errors in a script run?
>
> What are some of the best processes to implement these more helpful
> options?
>
>
> Thanks,
> --
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From dw|n@em|u@ @end|ng |rom comc@@t@net  Sun Dec 26 22:15:54 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Sun, 26 Dec 2021 13:15:54 -0800
Subject: [R] Error Awareness
In-Reply-To: <a379c1dd-9a6e-f8a0-62eb-3ba893978f8e@shdawson.com>
References: <a379c1dd-9a6e-f8a0-62eb-3ba893978f8e@shdawson.com>
Message-ID: <3914df6e-086a-d478-9558-d8b49c59effb@comcast.net>


On 12/23/21 3:11 AM, Stephen H. Dawson, DSL via R-help wrote:
> Hi,
>
>
> I am thinking about awareness of errors when an R script runs.
>
> My concern is I have an error-free script. I run it for months on end 
> without problems. Then, something changes somewhere causing an error. 
> My wonderment is how R will tell me I had an error in the script, but 
> the rest of the script ran without impairment.
>
> QUESTIONS
> What are some of the more helpful options available to an R developer 
> to capture errors in a script run?
>
> What are some of the best processes to implement these more helpful 
> options?

See this insight from Spencer Graves from Feb 2011 on Rhelp:

https://stat.ethz.ch/pipermail/r-help/2011-February/268512.html


>
>
> Thanks,


From du@@@@dr|@n @end|ng |rom gm@||@com  Sun Dec 26 22:54:20 2021
From: du@@@@dr|@n @end|ng |rom gm@||@com (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Sun, 26 Dec 2021 23:54:20 +0200
Subject: [R] Creating NA equivalent
In-Reply-To: <010c01d7f6a3$57fe6170$07fb2450$@verizon.net>
References: <977561d4-86af-69a7-de39-f53a0e2dfd92.ref@yahoo.fr>
 <977561d4-86af-69a7-de39-f53a0e2dfd92@yahoo.fr>
 <7ef1e12e-9024-8dba-0f68-567db68cb803@gmail.com>
 <010c01d7f6a3$57fe6170$07fb2450$@verizon.net>
Message-ID: <CAJ=0CtDyZT33rKa=2=mnqjW9Jz7kSNrQcxtp-1=tbJRcU+15jA@mail.gmail.com>

Responding a bit slow during holidays.
Indeed, following Ducan Murdoch's advice I created the package declared
which has a simple mechanism of attributing different interpretations for
the same NA value, within a vector.

I learned there is no need for different NA values, the built in NA is
enough. By allocating different interpretations (labels), the end result is
similar as if we had different NA values, all in base R.

This meta-information can subsequently be used for any conceivable purpose,
including what I read in this thread about censoring etc.

I hope this helps, best wishes and season's greetings,
Adrian

On Tue, 21 Dec 2021 at 21:45, Avi Gross <avigross at verizon.net> wrote:

> I wonder if the package Adrian Du?a created might be helpful or point you
> along the way.
>
> It was eventually named "declared"
>
> https://cran.r-project.org/web/packages/declared/index.html
>
> With a vignette here:
>
> https://cran.r-project.org/web/packages/declared/vignettes/declared.pdf
>
> I do not know if it would easily satisfy your needs but it may be a step
> along the way. A package called Haven was part of the motivation and Adrian
> wanted a way to import data from external sources that had more than one
> category of NA that sounds a bit like what you want. His functions should
> allow the creation of such data within R, as well. I am including him in
> this email if you want to contact him or he has something to say.
>
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Duncan Murdoch
> Sent: Tuesday, December 21, 2021 5:26 AM
> To: Marc Girondot <marc_grt at yahoo.fr>; r-help at r-project.org
> Subject: Re: [R] Creating NA equivalent
>
> On 20/12/2021 11:41 p.m., Marc Girondot via R-help wrote:
> > Dear members,
> >
> > I work about dosage and some values are bellow the detection limit. I
> > would like create new "numbers" like LDL (to represent lower than
> > detection limit) and UDL (upper the detection limit) that behave like
> > NA, with the possibility to test them using for example is.LDL() or
> > is.UDL().
> >
> > Note that NA is not the same than LDL or UDL: NA represent missing data.
> > Here the data is available as LDL or UDL.
> >
> > NA is built in R language very deep... any option to create new
> > version of NA-equivalent ?
> >
>
> There was a discussion of this back in May.  Here's a link to one approach
> that I suggested:
>
>    https://stat.ethz.ch/pipermail/r-devel/2021-May/080776.html
>
> Read the followup messages, I made at least one suggested improvement.
> I don't know if anyone has packaged this, but there's a later version of
> the code here:
>
>    https://stackoverflow.com/a/69179441/2554330
>
> Duncan Murdoch
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
>

	[[alternative HTML version deleted]]


From g@@mo||n@k|1 @end|ng |rom gm@||@com  Mon Dec 27 14:06:49 2021
From: g@@mo||n@k|1 @end|ng |rom gm@||@com (=?UTF-8?Q?Grzegorz_Smoli=C5=84ski?=)
Date: Mon, 27 Dec 2021 14:06:49 +0100
Subject: [R] How to modify object's code living in some environment?
Message-ID: <CABxpnnk-FqSLFeE4EA0Au8hZtfNRbYZyEsQRrE8bFs-5sPNAag@mail.gmail.com>

Hi,

I know it is possible to find the environment in which some object
lives using the 'environment()' function and the name of this object,
but how to modify code of this object after this? Below is MRE:

test <- function() 1

test() # 1

environment(test)$test <- eval(parse(text = "function() 2"))

test() # still 1

.GlobalEnv$test <- eval(parse(text = "function() 3"))

test() # 3

The context is I have shiny app which code I would like to modify (add
something) and the only way to refer to this environment I know is to
use 'environment()' (as I see, those functions do not live in
.GlobalEnv), but as you can see above, I can't use it to modify the
code.

Best regards,

Grzegorz Smoli?ski


From kry|ov@r00t @end|ng |rom gm@||@com  Mon Dec 27 14:17:14 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Mon, 27 Dec 2021 16:17:14 +0300
Subject: [R] How to modify object's code living in some environment?
In-Reply-To: <CABxpnnk-FqSLFeE4EA0Au8hZtfNRbYZyEsQRrE8bFs-5sPNAag@mail.gmail.com>
References: <CABxpnnk-FqSLFeE4EA0Au8hZtfNRbYZyEsQRrE8bFs-5sPNAag@mail.gmail.com>
Message-ID: <20211227161714.3a6d8b23@Tarkus>

On Mon, 27 Dec 2021 14:06:49 +0100
Grzegorz Smoli?ski <g.smolinski1 at gmail.com> wrote:

> I know it is possible to find the environment in which some object
> lives using the 'environment()' function

That's not exactly what environment() does. This function returns the
environment belonging to a function (where it searches for its
variables), not where it's defined. A function may have many names, but
only one "own" environment (plus its parent, plus the parent's parent
and so on).

You'll need to modify some other environment, where the function
actually lives, to make this work.

Is the shiny app a package? Perhaps trace() could help you? Modifying
package environments is even trickier.

-- 
Best regards,
Ivan


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Dec 27 14:25:44 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 27 Dec 2021 08:25:44 -0500
Subject: [R] How to modify object's code living in some environment?
In-Reply-To: <CABxpnnk-FqSLFeE4EA0Au8hZtfNRbYZyEsQRrE8bFs-5sPNAag@mail.gmail.com>
References: <CABxpnnk-FqSLFeE4EA0Au8hZtfNRbYZyEsQRrE8bFs-5sPNAag@mail.gmail.com>
Message-ID: <c4a08cad-74fc-501a-cb04-b7e905a021b7@gmail.com>

On 27/12/2021 8:06 a.m., Grzegorz Smoli?ski wrote:
> Hi,
> 
> I know it is possible to find the environment in which some object
> lives using the 'environment()' function and the name of this object,
> but how to modify code of this object after this? Below is MRE:

You are misunderstanding the relation between environments and 
functions.  However, your understanding is also being messed up by a bug 
in R, so it's not entirely your fault.

More details below:
> 
> test <- function() 1
> 
> test() # 1
> 
> environment(test)$test <- eval(parse(text = "function() 2"))

First:  while it's usually true that function f will be found in 
environment(f), these are really separate concepts.

The environment of a function is where it will start looking for 
non-local variables. It is initially the environment in which the 
function definition is evaluated.

The environment holding a function can be completely different.  This 
most commonly shows up when you have functions that create other 
functions.  For example,

   factory <- function(x) {
     force(x)
     function() print(x)
   }

   f <- factory(3)
   f()

which will print 3.  Here environment(f) is the evaluation frame of the 
call to factory(3), while f is not stored there, it is stored in the 
global environment.  (If you run ls(environment(f)) you won't see "f" 
listed, only "x".)

In your first line "test <- function() 1" you create a function named 
test in the global environment whose environment is also the global 
environment.

The third line should do what you want, i.e. put the new definition into 
the environment of the test function, using the name test, but it 
doesn't:  I think that's a bug in R.  It should be equivalent to

   .GlobalEnv$test <- eval(parse(text = "function() 2"))

or

   test <- eval(parse(text = "function() 2"))

but as you saw, it's not.  They do what you were expecting your third 
line to do.

> 
> test() # still 1
> 
> .GlobalEnv$test <- eval(parse(text = "function() 3"))
> 
> test() # 3
> 
> The context is I have shiny app which code I would like to modify (add
> something) and the only way to refer to this environment I know is to
> use 'environment()' (as I see, those functions do not live in
> .GlobalEnv), but as you can see above, I can't use it to modify the
> code.

You can, as long as you work around the bug in R.  Just change that 
third line into two statements:

   e <- environment(test)
   e$test <- eval(parse(text = "function() 2"))

Duncan Murdoch


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Dec 27 14:27:28 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 27 Dec 2021 08:27:28 -0500
Subject: [R] How to modify object's code living in some environment?
In-Reply-To: <c4a08cad-74fc-501a-cb04-b7e905a021b7@gmail.com>
References: <CABxpnnk-FqSLFeE4EA0Au8hZtfNRbYZyEsQRrE8bFs-5sPNAag@mail.gmail.com>
 <c4a08cad-74fc-501a-cb04-b7e905a021b7@gmail.com>
Message-ID: <4d423ac5-46e0-ff44-335d-f336720af553@gmail.com>

On 27/12/2021 8:25 a.m., Duncan Murdoch wrote:
> On 27/12/2021 8:06 a.m., Grzegorz Smoli?ski wrote:
>> Hi,
>>
>> I know it is possible to find the environment in which some object
>> lives using the 'environment()' function and the name of this object,
>> but how to modify code of this object after this? Below is MRE:
> 
> You are misunderstanding the relation between environments and
> functions.  However, your understanding is also being messed up by a bug
> in R, so it's not entirely your fault.
> 
> More details below:
>>
>> test <- function() 1
>>
>> test() # 1
>>
>> environment(test)$test <- eval(parse(text = "function() 2"))
> 
> First:  while it's usually true that function f will be found in
> environment(f), these are really separate concepts.
> 
> The environment of a function is where it will start looking for
> non-local variables. It is initially the environment in which the
> function definition is evaluated.
> 
> The environment holding a function can be completely different.  This
> most commonly shows up when you have functions that create other
> functions.  For example,
> 
>     factory <- function(x) {
>       force(x)
>       function() print(x)
>     }
> 
>     f <- factory(3)
>     f()
> 
> which will print 3.  Here environment(f) is the evaluation frame of the
> call to factory(3), while f is not stored there, it is stored in the
> global environment.  (If you run ls(environment(f)) you won't see "f"
> listed, only "x".)
> 
> In your first line "test <- function() 1" you create a function named
> test in the global environment whose environment is also the global
> environment.
> 
> The third line should do what you want, i.e. put the new definition into
> the environment of the test function, using the name test, but it
> doesn't:  I think that's a bug in R.  It should be equivalent to
> 
>     .GlobalEnv$test <- eval(parse(text = "function() 2"))
> 
> or
> 
>     test <- eval(parse(text = "function() 2"))
> 
> but as you saw, it's not.  They do what you were expecting your third
> line to do.
> 
>>
>> test() # still 1
>>
>> .GlobalEnv$test <- eval(parse(text = "function() 3"))
>>
>> test() # 3
>>
>> The context is I have shiny app which code I would like to modify (add
>> something) and the only way to refer to this environment I know is to
>> use 'environment()' (as I see, those functions do not live in
>> .GlobalEnv), but as you can see above, I can't use it to modify the
>> code.
> 
> You can, as long as you work around the bug in R.  Just change that
> third line into two statements:
> 
>     e <- environment(test)
>     e$test <- eval(parse(text = "function() 2"))
> 

And I forgot to mention, as Ivan did, that this might not do what you 
want, because of the difference in the concepts of "environment(f)" and 
"environment where f is found".

Duncan Murdoch


From g@@mo||n@k|1 @end|ng |rom gm@||@com  Mon Dec 27 15:36:01 2021
From: g@@mo||n@k|1 @end|ng |rom gm@||@com (=?UTF-8?Q?Grzegorz_Smoli=C5=84ski?=)
Date: Mon, 27 Dec 2021 15:36:01 +0100
Subject: [R] How to modify object's code living in some environment?
In-Reply-To: <4d423ac5-46e0-ff44-335d-f336720af553@gmail.com>
References: <CABxpnnk-FqSLFeE4EA0Au8hZtfNRbYZyEsQRrE8bFs-5sPNAag@mail.gmail.com>
 <c4a08cad-74fc-501a-cb04-b7e905a021b7@gmail.com>
 <4d423ac5-46e0-ff44-335d-f336720af553@gmail.com>
Message-ID: <CABxpnn=O+L_0MWLMWTMW8AnYx60=uoHpm4pJTie65CEs-=wCVw@mail.gmail.com>

Thank you, Ivan and Duncan. The truth is I still feel lost in this
concept of environments, generally speaking.

What I really thought about is the possibility to make a shiny app
where there will be possible to choose the function name (from the set
of all functions defined in this app / modules / other helper files
sourced on the start of app) and write on the beginning of the body of
this chosen function 'browser()'. I have developed an app using
modules and I have found that it is not convenient to stop the app,
write 'browser()' where needed, start the app and make something to
run the function where is `browser()`, so I have started to think if I
could write this `browser()` on demand, using the app itself (so:
without stopping the app), then make something to run the function,
where is 'browser()' and enabling interactive debugger. But I see now
it is not good to make too many assumptions didn't knowing some topic
:)

pon., 27 gru 2021 o 14:27 Duncan Murdoch <murdoch.duncan at gmail.com> napisa?(a):
>
> On 27/12/2021 8:25 a.m., Duncan Murdoch wrote:
> > On 27/12/2021 8:06 a.m., Grzegorz Smoli?ski wrote:
> >> Hi,
> >>
> >> I know it is possible to find the environment in which some object
> >> lives using the 'environment()' function and the name of this object,
> >> but how to modify code of this object after this? Below is MRE:
> >
> > You are misunderstanding the relation between environments and
> > functions.  However, your understanding is also being messed up by a bug
> > in R, so it's not entirely your fault.
> >
> > More details below:
> >>
> >> test <- function() 1
> >>
> >> test() # 1
> >>
> >> environment(test)$test <- eval(parse(text = "function() 2"))
> >
> > First:  while it's usually true that function f will be found in
> > environment(f), these are really separate concepts.
> >
> > The environment of a function is where it will start looking for
> > non-local variables. It is initially the environment in which the
> > function definition is evaluated.
> >
> > The environment holding a function can be completely different.  This
> > most commonly shows up when you have functions that create other
> > functions.  For example,
> >
> >     factory <- function(x) {
> >       force(x)
> >       function() print(x)
> >     }
> >
> >     f <- factory(3)
> >     f()
> >
> > which will print 3.  Here environment(f) is the evaluation frame of the
> > call to factory(3), while f is not stored there, it is stored in the
> > global environment.  (If you run ls(environment(f)) you won't see "f"
> > listed, only "x".)
> >
> > In your first line "test <- function() 1" you create a function named
> > test in the global environment whose environment is also the global
> > environment.
> >
> > The third line should do what you want, i.e. put the new definition into
> > the environment of the test function, using the name test, but it
> > doesn't:  I think that's a bug in R.  It should be equivalent to
> >
> >     .GlobalEnv$test <- eval(parse(text = "function() 2"))
> >
> > or
> >
> >     test <- eval(parse(text = "function() 2"))
> >
> > but as you saw, it's not.  They do what you were expecting your third
> > line to do.
> >
> >>
> >> test() # still 1
> >>
> >> .GlobalEnv$test <- eval(parse(text = "function() 3"))
> >>
> >> test() # 3
> >>
> >> The context is I have shiny app which code I would like to modify (add
> >> something) and the only way to refer to this environment I know is to
> >> use 'environment()' (as I see, those functions do not live in
> >> .GlobalEnv), but as you can see above, I can't use it to modify the
> >> code.
> >
> > You can, as long as you work around the bug in R.  Just change that
> > third line into two statements:
> >
> >     e <- environment(test)
> >     e$test <- eval(parse(text = "function() 2"))
> >
>
> And I forgot to mention, as Ivan did, that this might not do what you
> want, because of the difference in the concepts of "environment(f)" and
> "environment where f is found".
>
> Duncan Murdoch


From bgunter@4567 @end|ng |rom gm@||@com  Mon Dec 27 16:51:05 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 27 Dec 2021 07:51:05 -0800
Subject: [R] How to modify object's code living in some environment?
In-Reply-To: <CABxpnnk-FqSLFeE4EA0Au8hZtfNRbYZyEsQRrE8bFs-5sPNAag@mail.gmail.com>
References: <CABxpnnk-FqSLFeE4EA0Au8hZtfNRbYZyEsQRrE8bFs-5sPNAag@mail.gmail.com>
Message-ID: <CAGxFJbQY5ELke2BP8ZEomaqh2sJyHQF=evPYRC0PcVpDgtthvw@mail.gmail.com>

I think ?body, especially the replacement form body<-, might be what
you are looking for.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Mon, Dec 27, 2021 at 5:07 AM Grzegorz Smoli?ski
<g.smolinski1 at gmail.com> wrote:
>
> Hi,
>
> I know it is possible to find the environment in which some object
> lives using the 'environment()' function and the name of this object,
> but how to modify code of this object after this? Below is MRE:
>
> test <- function() 1
>
> test() # 1
>
> environment(test)$test <- eval(parse(text = "function() 2"))
>
> test() # still 1
>
> .GlobalEnv$test <- eval(parse(text = "function() 3"))
>
> test() # 3
>
> The context is I have shiny app which code I would like to modify (add
> something) and the only way to refer to this environment I know is to
> use 'environment()' (as I see, those functions do not live in
> .GlobalEnv), but as you can see above, I can't use it to modify the
> code.
>
> Best regards,
>
> Grzegorz Smoli?ski
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kry|ov@r00t @end|ng |rom gm@||@com  Mon Dec 27 17:06:39 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Mon, 27 Dec 2021 19:06:39 +0300
Subject: [R] How to modify object's code living in some environment?
In-Reply-To: <CABxpnn=O+L_0MWLMWTMW8AnYx60=uoHpm4pJTie65CEs-=wCVw@mail.gmail.com>
References: <CABxpnnk-FqSLFeE4EA0Au8hZtfNRbYZyEsQRrE8bFs-5sPNAag@mail.gmail.com>
 <c4a08cad-74fc-501a-cb04-b7e905a021b7@gmail.com>
 <4d423ac5-46e0-ff44-335d-f336720af553@gmail.com>
 <CABxpnn=O+L_0MWLMWTMW8AnYx60=uoHpm4pJTie65CEs-=wCVw@mail.gmail.com>
Message-ID: <20211227190639.02a755da@arachnoid>

On Mon, 27 Dec 2021 15:36:01 +0100
Grzegorz Smoli?ski <g.smolinski1 at gmail.com> wrote:

> write on the beginning of the body of this chosen function
> 'browser()'. 

Is your desired result similar to what debug() (or debugonce()) does?
Perhaps you won't even need to construct a call and evaluate it in a
given environment for it to work.

-- 
Best regards,
Ivan


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Dec 27 18:28:11 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 27 Dec 2021 12:28:11 -0500
Subject: [R] How to modify object's code living in some environment?
In-Reply-To: <c4a08cad-74fc-501a-cb04-b7e905a021b7@gmail.com>
References: <CABxpnnk-FqSLFeE4EA0Au8hZtfNRbYZyEsQRrE8bFs-5sPNAag@mail.gmail.com>
 <c4a08cad-74fc-501a-cb04-b7e905a021b7@gmail.com>
Message-ID: <e22e1d7e-1ec1-ed3a-7276-8fc05fde69a9@gmail.com>

On 27/12/2021 8:25 a.m., Duncan Murdoch wrote:
> On 27/12/2021 8:06 a.m., Grzegorz Smoli?ski wrote:
>> Hi,
>>
>> I know it is possible to find the environment in which some object
>> lives using the 'environment()' function and the name of this object,
>> but how to modify code of this object after this? Below is MRE:
> 
> You are misunderstanding the relation between environments and
> functions.  However, your understanding is also being messed up by a bug
> in R, so it's not entirely your fault.

Actually this isn't a bug in R, it is working as documented.  For a 
detailed explanation, see the response to my bug report here: 
https://bugs.r-project.org/show_bug.cgi?id=18269 .

For a quick idea:  "complex assignments" are assignments where there is 
a complex expression on the left hand side, e.g.

   environment(test)$test <- ...

The way these are documented to work (in the R Language Definition 
manual) makes intuitive sense when you are working with regular R 
objects, but environments are "mutable" objects:  assigning them to a 
new name doesn't make a new copy, just a new reference.  That causes the 
definition of the complex assignment above to work in an unintuitive way.

Conclusion:  you should avoid using calls like environment(f) on the 
left hand side of assignments, especially as part of a larger 
expression.  Break up the statement into steps like I did below:

>     e <- environment(test)
>     e$test <- eval(parse(text = "function() 2"))

The same advice would apply to a function that returned an R6 object or 
a mutable object from the methods package (which are really environments 
in disguise), as well as some other exotic objects.

Duncan Murdoch


From @k@h@y_e4 @end|ng |rom hotm@||@com  Tue Dec 28 14:17:52 2021
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Tue, 28 Dec 2021 13:17:52 +0000
Subject: [R] doubt with boosting algorithms in caret in r
Message-ID: <PU4P216MB1568F2D52556714DAF2291DFC8439@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

dear members,
                         I am using caret and caretEnsemble packages for my research involving machine learning.

This link https://topepo.github.io/caret/train-models-by-tag.html#boosting indicates the various boosting algorithms available in the caret package. However, I know that boosting algorithms need to have base learners specified. I have no issues with adaboost.m1 algorithm which takes as a base learner Decision Trees. But what about the other algorithms? How do you specify the base learners for the algorithms? The page in the link speaks loosely of "Ensembles" relating to the boosting algorithms, but it doesn't specify how to pass them as arguments for the boosting algorithms in caret. What's going on? For example, I need a boosting algorithm with SVM. How do you effect it with caret or caretEnsemble?

Thanking you,
Yours sincerely,
AKSHAY M KULKARNI


	[[alternative HTML version deleted]]


From g@@mo||n@k|1 @end|ng |rom gm@||@com  Tue Dec 28 22:21:40 2021
From: g@@mo||n@k|1 @end|ng |rom gm@||@com (=?UTF-8?Q?Grzegorz_Smoli=C5=84ski?=)
Date: Tue, 28 Dec 2021 22:21:40 +0100
Subject: [R] How to modify object's code living in some environment?
In-Reply-To: <e22e1d7e-1ec1-ed3a-7276-8fc05fde69a9@gmail.com>
References: <CABxpnnk-FqSLFeE4EA0Au8hZtfNRbYZyEsQRrE8bFs-5sPNAag@mail.gmail.com>
 <c4a08cad-74fc-501a-cb04-b7e905a021b7@gmail.com>
 <e22e1d7e-1ec1-ed3a-7276-8fc05fde69a9@gmail.com>
Message-ID: <CABxpnn=hWbuxY=4x8eN9QNJWJj3dfdjBYWLzmQPTmU2i6LgYDw@mail.gmail.com>

Thank you for all the comments. If this is not a problem, I would like
to continue this thread as for me a lot of questions are still open.
But if I should post other questions in different messages / topics,
please let me know.

I didn?t answer Ivan?s question previously, but yes, my desired result
is indeed what debug() / debugonce() does and Ivan mentioned trace()
earlier also, so I have tried this. I thought that trace() will be
better in my case (than debug()) since I would like to be able to call
trace() from one environment and insert browser() (using trace()) to
the function defined in parent environment (still not sure if I
understand this concept of environments).

Even if I would like to use it in an shiny app, I have started with
this example:

------------------------------

fun1 <- function() {
  a <-  1
  a
}

fun2 <- function() {
  fun1 <- function(){
    b <- 2
    b
  }
  trace(fun1, browser, where = globalenv())
}

fun1()
fun2()
fun1()

--------------------------------

So I was hoping to use trace inside child environment of global env,
i.e. set browser() using trace() to the body of function defined in
parent environment, but for sure I do not understand this since
trace() in my example above is putting the browser() function inside
fun1() function defined not in global environment, but in the body of
fun2(). I.e. I'm starting to browse the fun1() function with the local
variable 'b', not 'a' as I wanted.

Can I ask for help with this? In other words, how can I refer to some
function from the parent environment (not necessarily defined in the
global environment) being in the child environment?

Also, if I could ask - is the reversed operation possible? I mean -
can I refer to some function from the child environment being in the
parent environment? I guess not, because of ephemerality?

As I mentioned, I'm thinking about all of this in the context of shiny
app and the shiny app which consists of multiple files, modules. I'm
thinking if I could refer to any function from any environment (or at
least to any function in any parent environment) from one place (one,
current environment) where I will call debug() or trace() to insert
browser() at the beginning of this chosen function. And by "any
function" I'm thinking about another thing problematic for me. If I
consider this example:

-------------------------------
mod.R inside R/
---

mod_UI <- function(id) {
}

name_mod <- function(input, output, session) {
  fun1 <- reactive({
    a  <-  1
  })
}

---
app.R
---

library(shiny)

ui <- fluidPage(
  mod_UI("mod"),
  textOutput("env")
)

server <- function(input, output, session) {

  name_mod("mod")

  output$env <- renderPrint({
    names(environment(name_mod))
  })

  observe({
    #trace(fun1, browser, where = environment(name_mod))
  })
}

shinyApp(ui, server)
---------------------------------------
I tried to refer to the fun1 in environment(name_mod) - if I'm not
wrong, this is my parent environment, where objects "mod_UI" and
"name_mod" exist, but obviously I'm doing this wrong, right? Because
here: "#trace(fun1, browser, where = environment(name_mod))" I have
tried to refer to the module environment, but I should refer to the
environment inside "name_mod". I don't know how to do this and here I
also would like to ask for help.

I know this may not be the best place for questions regarding shiny,
but I think these questions are purely linked to environment topics.

I also remember Bert's post about "body()" and yes, this seems to be a
better idea than my first try in my first post, but "trace()" and
"debug()" seem much easier as all I want is to insert browser(). But I
just can't get it, how to refer to functions in (any) other
environments.

Thank you very much for all your help and I hope it is OK to keep asking :).

pon., 27 gru 2021 o 18:28 Duncan Murdoch <murdoch.duncan at gmail.com> napisa?(a):
>
> On 27/12/2021 8:25 a.m., Duncan Murdoch wrote:
> > On 27/12/2021 8:06 a.m., Grzegorz Smoli?ski wrote:
> >> Hi,
> >>
> >> I know it is possible to find the environment in which some object
> >> lives using the 'environment()' function and the name of this object,
> >> but how to modify code of this object after this? Below is MRE:
> >
> > You are misunderstanding the relation between environments and
> > functions.  However, your understanding is also being messed up by a bug
> > in R, so it's not entirely your fault.
>
> Actually this isn't a bug in R, it is working as documented.  For a
> detailed explanation, see the response to my bug report here:
> https://bugs.r-project.org/show_bug.cgi?id=18269 .
>
> For a quick idea:  "complex assignments" are assignments where there is
> a complex expression on the left hand side, e.g.
>
>    environment(test)$test <- ...
>
> The way these are documented to work (in the R Language Definition
> manual) makes intuitive sense when you are working with regular R
> objects, but environments are "mutable" objects:  assigning them to a
> new name doesn't make a new copy, just a new reference.  That causes the
> definition of the complex assignment above to work in an unintuitive way.
>
> Conclusion:  you should avoid using calls like environment(f) on the
> left hand side of assignments, especially as part of a larger
> expression.  Break up the statement into steps like I did below:
>
> >     e <- environment(test)
> >     e$test <- eval(parse(text = "function() 2"))
>
> The same advice would apply to a function that returned an R6 object or
> a mutable object from the methods package (which are really environments
> in disguise), as well as some other exotic objects.
>
> Duncan Murdoch


From bgunter@4567 @end|ng |rom gm@||@com  Tue Dec 28 22:46:38 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 28 Dec 2021 13:46:38 -0800
Subject: [R] How to modify object's code living in some environment?
In-Reply-To: <CABxpnn=hWbuxY=4x8eN9QNJWJj3dfdjBYWLzmQPTmU2i6LgYDw@mail.gmail.com>
References: <CABxpnnk-FqSLFeE4EA0Au8hZtfNRbYZyEsQRrE8bFs-5sPNAag@mail.gmail.com>
 <c4a08cad-74fc-501a-cb04-b7e905a021b7@gmail.com>
 <e22e1d7e-1ec1-ed3a-7276-8fc05fde69a9@gmail.com>
 <CABxpnn=hWbuxY=4x8eN9QNJWJj3dfdjBYWLzmQPTmU2i6LgYDw@mail.gmail.com>
Message-ID: <CAGxFJbRv1Ept27uiMpyV33VAq+way3wU-g4xPQguaW16VxcmUg@mail.gmail.com>

Are you aware that RStudio has its own Help resources at:

https://community.rstudio.com/

As they created and maintain  Shiny, perhaps you should post there.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Tue, Dec 28, 2021 at 1:22 PM Grzegorz Smoli?ski
<g.smolinski1 at gmail.com> wrote:
>
> Thank you for all the comments. If this is not a problem, I would like
> to continue this thread as for me a lot of questions are still open.
> But if I should post other questions in different messages / topics,
> please let me know.
>
> I didn?t answer Ivan?s question previously, but yes, my desired result
> is indeed what debug() / debugonce() does and Ivan mentioned trace()
> earlier also, so I have tried this. I thought that trace() will be
> better in my case (than debug()) since I would like to be able to call
> trace() from one environment and insert browser() (using trace()) to
> the function defined in parent environment (still not sure if I
> understand this concept of environments).
>
> Even if I would like to use it in an shiny app, I have started with
> this example:
>
> ------------------------------
>
> fun1 <- function() {
>   a <-  1
>   a
> }
>
> fun2 <- function() {
>   fun1 <- function(){
>     b <- 2
>     b
>   }
>   trace(fun1, browser, where = globalenv())
> }
>
> fun1()
> fun2()
> fun1()
>
> --------------------------------
>
> So I was hoping to use trace inside child environment of global env,
> i.e. set browser() using trace() to the body of function defined in
> parent environment, but for sure I do not understand this since
> trace() in my example above is putting the browser() function inside
> fun1() function defined not in global environment, but in the body of
> fun2(). I.e. I'm starting to browse the fun1() function with the local
> variable 'b', not 'a' as I wanted.
>
> Can I ask for help with this? In other words, how can I refer to some
> function from the parent environment (not necessarily defined in the
> global environment) being in the child environment?
>
> Also, if I could ask - is the reversed operation possible? I mean -
> can I refer to some function from the child environment being in the
> parent environment? I guess not, because of ephemerality?
>
> As I mentioned, I'm thinking about all of this in the context of shiny
> app and the shiny app which consists of multiple files, modules. I'm
> thinking if I could refer to any function from any environment (or at
> least to any function in any parent environment) from one place (one,
> current environment) where I will call debug() or trace() to insert
> browser() at the beginning of this chosen function. And by "any
> function" I'm thinking about another thing problematic for me. If I
> consider this example:
>
> -------------------------------
> mod.R inside R/
> ---
>
> mod_UI <- function(id) {
> }
>
> name_mod <- function(input, output, session) {
>   fun1 <- reactive({
>     a  <-  1
>   })
> }
>
> ---
> app.R
> ---
>
> library(shiny)
>
> ui <- fluidPage(
>   mod_UI("mod"),
>   textOutput("env")
> )
>
> server <- function(input, output, session) {
>
>   name_mod("mod")
>
>   output$env <- renderPrint({
>     names(environment(name_mod))
>   })
>
>   observe({
>     #trace(fun1, browser, where = environment(name_mod))
>   })
> }
>
> shinyApp(ui, server)
> ---------------------------------------
> I tried to refer to the fun1 in environment(name_mod) - if I'm not
> wrong, this is my parent environment, where objects "mod_UI" and
> "name_mod" exist, but obviously I'm doing this wrong, right? Because
> here: "#trace(fun1, browser, where = environment(name_mod))" I have
> tried to refer to the module environment, but I should refer to the
> environment inside "name_mod". I don't know how to do this and here I
> also would like to ask for help.
>
> I know this may not be the best place for questions regarding shiny,
> but I think these questions are purely linked to environment topics.
>
> I also remember Bert's post about "body()" and yes, this seems to be a
> better idea than my first try in my first post, but "trace()" and
> "debug()" seem much easier as all I want is to insert browser(). But I
> just can't get it, how to refer to functions in (any) other
> environments.
>
> Thank you very much for all your help and I hope it is OK to keep asking :).
>
> pon., 27 gru 2021 o 18:28 Duncan Murdoch <murdoch.duncan at gmail.com> napisa?(a):
> >
> > On 27/12/2021 8:25 a.m., Duncan Murdoch wrote:
> > > On 27/12/2021 8:06 a.m., Grzegorz Smoli?ski wrote:
> > >> Hi,
> > >>
> > >> I know it is possible to find the environment in which some object
> > >> lives using the 'environment()' function and the name of this object,
> > >> but how to modify code of this object after this? Below is MRE:
> > >
> > > You are misunderstanding the relation between environments and
> > > functions.  However, your understanding is also being messed up by a bug
> > > in R, so it's not entirely your fault.
> >
> > Actually this isn't a bug in R, it is working as documented.  For a
> > detailed explanation, see the response to my bug report here:
> > https://bugs.r-project.org/show_bug.cgi?id=18269 .
> >
> > For a quick idea:  "complex assignments" are assignments where there is
> > a complex expression on the left hand side, e.g.
> >
> >    environment(test)$test <- ...
> >
> > The way these are documented to work (in the R Language Definition
> > manual) makes intuitive sense when you are working with regular R
> > objects, but environments are "mutable" objects:  assigning them to a
> > new name doesn't make a new copy, just a new reference.  That causes the
> > definition of the complex assignment above to work in an unintuitive way.
> >
> > Conclusion:  you should avoid using calls like environment(f) on the
> > left hand side of assignments, especially as part of a larger
> > expression.  Break up the statement into steps like I did below:
> >
> > >     e <- environment(test)
> > >     e$test <- eval(parse(text = "function() 2"))
> >
> > The same advice would apply to a function that returned an R6 object or
> > a mutable object from the methods package (which are really environments
> > in disguise), as well as some other exotic objects.
> >
> > Duncan Murdoch
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Dec 29 11:24:16 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 29 Dec 2021 05:24:16 -0500
Subject: [R] How to modify object's code living in some environment?
In-Reply-To: <CABxpnn=hWbuxY=4x8eN9QNJWJj3dfdjBYWLzmQPTmU2i6LgYDw@mail.gmail.com>
References: <CABxpnnk-FqSLFeE4EA0Au8hZtfNRbYZyEsQRrE8bFs-5sPNAag@mail.gmail.com>
 <c4a08cad-74fc-501a-cb04-b7e905a021b7@gmail.com>
 <e22e1d7e-1ec1-ed3a-7276-8fc05fde69a9@gmail.com>
 <CABxpnn=hWbuxY=4x8eN9QNJWJj3dfdjBYWLzmQPTmU2i6LgYDw@mail.gmail.com>
Message-ID: <ef8d8ca8-f5e6-6d80-bda0-dea5450aeb14@gmail.com>

On 28/12/2021 4:21 p.m., Grzegorz Smoli?ski wrote:
> Thank you for all the comments. If this is not a problem, I would like
> to continue this thread as for me a lot of questions are still open.
> But if I should post other questions in different messages / topics,
> please let me know.
> 
> I didn?t answer Ivan?s question previously, but yes, my desired result
> is indeed what debug() / debugonce() does and Ivan mentioned trace()
> earlier also, so I have tried this. I thought that trace() will be
> better in my case (than debug()) since I would like to be able to call
> trace() from one environment and insert browser() (using trace()) to
> the function defined in parent environment (still not sure if I
> understand this concept of environments).
> 
> Even if I would like to use it in an shiny app, I have started with
> this example:
> 
> ------------------------------
> 
> fun1 <- function() {
>    a <-  1
>    a
> }
> 
> fun2 <- function() {
>    fun1 <- function(){
>      b <- 2
>      b
>    }
>    trace(fun1, browser, where = globalenv())
> }
> 
> fun1()
> fun2()
> fun1()
> 
> --------------------------------
> 
> So I was hoping to use trace inside child environment of global env,
> i.e. set browser() using trace() to the body of function defined in
> parent environment, but for sure I do not understand this since
> trace() in my example above is putting the browser() function inside
> fun1() function defined not in global environment, but in the body of
> fun2(). I.e. I'm starting to browse the fun1() function with the local
> variable 'b', not 'a' as I wanted.

You are being bitten by normal R scoping.  While fun2 is executing, as 
soon as it executes the fun1 assignment the name fun1 is bound to the 
local function, so when you use fun1 in the first argument to trace(), 
you get that one.  It will ignore then "where" argument because it was 
passed a function object.  If you quote the name it will have to do a 
lookup and it will use "where".  So write fun2 like this:

fun2 <- function() {
   fun1 <- function(){
     b <- 2
     b
   }
   trace("fun1", browser, where = globalenv())
}


> 
> Can I ask for help with this? In other words, how can I refer to some
> function from the parent environment (not necessarily defined in the
> global environment) being in the child environment?

You could have used parent.frame() in place of globalenv() if you want a 
function that was visible to the caller of fun2.  If you want a function 
that was defined with the same environment as fun2, you can usually use 
environment(fun2), or parent.env(environment()).


> 
> Also, if I could ask - is the reversed operation possible? I mean -
> can I refer to some function from the child environment being in the
> parent environment? I guess not, because of ephemerality?

Sometimes you can, but not usually.  If fun2 had returned a value that 
referenced the evaluation frame, you would be able to see the "b" 
version of fun1 there.  But yours didn't.  This one would:


fun2 <- function() {
   fun1 <- function(){
     b <- 2
     b
   }
   trace("fun1", browser, where = globalenv())
   environment()
}

Now if you do e <- fun2(), you'll set the trace on the global fun1, but 
e$fun1 will be the local one.

I don't really know how Shiny sets things up, so I can't help with the 
stuff below.

Duncan Murdoch


> 
> As I mentioned, I'm thinking about all of this in the context of shiny
> app and the shiny app which consists of multiple files, modules. I'm
> thinking if I could refer to any function from any environment (or at
> least to any function in any parent environment) from one place (one,
> current environment) where I will call debug() or trace() to insert
> browser() at the beginning of this chosen function. And by "any
> function" I'm thinking about another thing problematic for me. If I
> consider this example:
> 
> -------------------------------
> mod.R inside R/
> ---
> 
> mod_UI <- function(id) {
> }
> 
> name_mod <- function(input, output, session) {
>    fun1 <- reactive({
>      a  <-  1
>    })
> }
> 
> ---
> app.R
> ---
> 
> library(shiny)
> 
> ui <- fluidPage(
>    mod_UI("mod"),
>    textOutput("env")
> )
> 
> server <- function(input, output, session) {
> 
>    name_mod("mod")
> 
>    output$env <- renderPrint({
>      names(environment(name_mod))
>    })
> 
>    observe({
>      #trace(fun1, browser, where = environment(name_mod))
>    })
> }
> 
> shinyApp(ui, server)
> ---------------------------------------
> I tried to refer to the fun1 in environment(name_mod) - if I'm not
> wrong, this is my parent environment, where objects "mod_UI" and
> "name_mod" exist, but obviously I'm doing this wrong, right? Because
> here: "#trace(fun1, browser, where = environment(name_mod))" I have
> tried to refer to the module environment, but I should refer to the
> environment inside "name_mod". I don't know how to do this and here I
> also would like to ask for help.
> 
> I know this may not be the best place for questions regarding shiny,
> but I think these questions are purely linked to environment topics.
> 
> I also remember Bert's post about "body()" and yes, this seems to be a
> better idea than my first try in my first post, but "trace()" and
> "debug()" seem much easier as all I want is to insert browser(). But I
> just can't get it, how to refer to functions in (any) other
> environments.
> 
> Thank you very much for all your help and I hope it is OK to keep asking :).
> 
> pon., 27 gru 2021 o 18:28 Duncan Murdoch <murdoch.duncan at gmail.com> napisa?(a):
>>
>> On 27/12/2021 8:25 a.m., Duncan Murdoch wrote:
>>> On 27/12/2021 8:06 a.m., Grzegorz Smoli?ski wrote:
>>>> Hi,
>>>>
>>>> I know it is possible to find the environment in which some object
>>>> lives using the 'environment()' function and the name of this object,
>>>> but how to modify code of this object after this? Below is MRE:
>>>
>>> You are misunderstanding the relation between environments and
>>> functions.  However, your understanding is also being messed up by a bug
>>> in R, so it's not entirely your fault.
>>
>> Actually this isn't a bug in R, it is working as documented.  For a
>> detailed explanation, see the response to my bug report here:
>> https://bugs.r-project.org/show_bug.cgi?id=18269 .
>>
>> For a quick idea:  "complex assignments" are assignments where there is
>> a complex expression on the left hand side, e.g.
>>
>>     environment(test)$test <- ...
>>
>> The way these are documented to work (in the R Language Definition
>> manual) makes intuitive sense when you are working with regular R
>> objects, but environments are "mutable" objects:  assigning them to a
>> new name doesn't make a new copy, just a new reference.  That causes the
>> definition of the complex assignment above to work in an unintuitive way.
>>
>> Conclusion:  you should avoid using calls like environment(f) on the
>> left hand side of assignments, especially as part of a larger
>> expression.  Break up the statement into steps like I did below:
>>
>>>      e <- environment(test)
>>>      e$test <- eval(parse(text = "function() 2"))
>>
>> The same advice would apply to a function that returned an R6 object or
>> a mutable object from the methods package (which are really environments
>> in disguise), as well as some other exotic objects.
>>
>> Duncan Murdoch
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From petr@p|k@| @end|ng |rom prechez@@cz  Wed Dec 29 12:05:22 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Wed, 29 Dec 2021 11:05:22 +0000
Subject: [R] mixture univariate distributions fit
Message-ID: <42e04a96845c4c96a15da9d7e8044028@SRVEXCHCM1301.precheza.cz>

Dear all

I have data which are either density distribution estimate or cummulative
density distribution estimate (temp1, temp2 below). I would like to get
values (mu, sd) for underlaying original data but they are not available.

I found mixtools package which calculate what I need but it requires
original data (AFAIK). They could be generated from e.g. temp1 by

set.seed(111)
x<- sample(temp1$velik, size=100000, replace=TRUE, prob=temp1$proc)

library(mixtools)
fit <- normalmixEM(x)
plot(fit, which=2)
summary(fit)
summary of normalmixEM object:
           comp 1     comp 2
lambda   0.576346   0.423654
mu     170.784520 229.192823
sigma    7.203491  10.793461
loglik at estimate:  -424062.7 
>

Is there any way how to get such values directly from density or cummulative
density estimation without generating fake data by sample? 

Best regards
Petr


temp1 <- structure(list(velik = c(155, 156.8, 157.9, 158.8, 159.6, 160.4, 
161.2, 161.9, 162.5, 163.1, 163.8, 164.3, 164.7, 165.3, 165.8, 
166.2, 166.7, 167.2, 167.7, 168.2, 168.7, 169.1, 169.6, 170.1, 
170.6, 171.1, 171.6, 172, 172.5, 173, 173.5, 174, 174.5, 175.1, 
175.7, 176.3, 177, 177.6, 178.3, 179.1, 179.9, 180.6, 181.4, 
182.4, 183.5, 184.7, 186.1, 187.9, 189.8, 192, 194.4, 197, 200.1, 
203.5, 206.7, 209.2, 211.3, 213.1, 214.8, 216.3, 217.4, 218.5, 
219.5, 220.4, 221.3, 222.1, 223, 223.7, 224.5, 225.2, 225.9, 
226.7, 227.5, 228.2, 228.9, 229.6, 230.4, 231.2, 231.9, 232.6, 
233.4, 234.2, 235, 235.9, 236.8, 237.7, 238.6, 239.7, 241, 242.3, 
243.6, 245.2, 247.1, 249.3, 251.9, 255.3, 260, 266, 274.9, 323.4
), proc = c(0.6171, 1.583, 1.371, 2.13, 1.828, 2.095, 1.994, 
2.694, 2.824, 2.41, 2.909, 3.768, 3.179, 3.029, 3.798, 3.743, 
3.276, 3.213, 3.579, 2.928, 4.634, 3.415, 3.473, 3.135, 3.476, 
3.759, 3.726, 3.9, 3.593, 2.89, 3.707, 4.08, 2.846, 2.685, 3.394, 
2.737, 2.693, 2.878, 2.248, 2.368, 2.258, 2.662, 1.866, 1.895, 
1.457, 1.513, 1.181, 1.008, 0.9641, 0.799, 0.7878, 0.7209, 0.5869, 
0.5778, 0.7313, 0.9531, 1.053, 1.317, 1.247, 1.739, 2.064, 1.99, 
2.522, 2.401, 2.48, 2.687, 2.797, 2.918, 3.243, 3.055, 3.009, 
2.89, 3.037, 3.25, 3.349, 3.141, 2.771, 2.985, 3.203, 3.298, 
3.215, 2.637, 2.683, 2.782, 2.632, 2.625, 2.475, 2.014, 1.781, 
1.987, 1.627, 1.374, 1.352, 0.9441, 1.01, 0.5737, 0.5265, 0.3794, 
0.2513, 0.0351)), row.names = 2:101, class = "data.frame")

temp2 <- structure(list(velik = c(153.8, 156.3, 157.3, 158.4, 159.2, 160.1, 
160.8, 161.6, 162.2, 162.8, 163.5, 164, 164.5, 165, 165.5, 166, 
166.4, 166.9, 167.5, 167.9, 168.5, 168.9, 169.4, 169.8, 170.4, 
170.9, 171.3, 171.8, 172.2, 172.7, 173.3, 173.8, 174.2, 174.8, 
175.5, 176, 176.6, 177.3, 177.9, 178.7, 179.5, 180.3, 180.9, 
181.9, 182.9, 184.1, 185.3, 186.9, 188.8, 190.8, 193.2, 195.6, 
198.4, 201.8, 205.3, 208.1, 210.3, 212.3, 213.9, 215.7, 216.9, 
218, 219.1, 219.9, 220.8, 221.7, 222.6, 223.4, 224.1, 224.8, 
225.6, 226.3, 227.1, 227.8, 228.5, 229.2, 230, 230.8, 231.6, 
232.3, 233, 233.7, 234.6, 235.5, 236.3, 237.2, 238.1, 239.1, 
240.3, 241.6, 242.9, 244.4, 246.1, 248, 250.6, 253.1, 257.6, 
262.5, 269.5, 280.4, 372.9), proc = c(0, 1, 2, 3, 4, 5, 6, 7, 
8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 
24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 
40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 
56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 
72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 
88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100)), row.names = c(NA, 
101L), class = "data.frame")
>

>

From g@@mo||n@k|1 @end|ng |rom gm@||@com  Wed Dec 29 15:29:02 2021
From: g@@mo||n@k|1 @end|ng |rom gm@||@com (=?UTF-8?Q?Grzegorz_Smoli=C5=84ski?=)
Date: Wed, 29 Dec 2021 15:29:02 +0100
Subject: [R] How to modify object's code living in some environment?
In-Reply-To: <ef8d8ca8-f5e6-6d80-bda0-dea5450aeb14@gmail.com>
References: <CABxpnnk-FqSLFeE4EA0Au8hZtfNRbYZyEsQRrE8bFs-5sPNAag@mail.gmail.com>
 <c4a08cad-74fc-501a-cb04-b7e905a021b7@gmail.com>
 <e22e1d7e-1ec1-ed3a-7276-8fc05fde69a9@gmail.com>
 <CABxpnn=hWbuxY=4x8eN9QNJWJj3dfdjBYWLzmQPTmU2i6LgYDw@mail.gmail.com>
 <ef8d8ca8-f5e6-6d80-bda0-dea5450aeb14@gmail.com>
Message-ID: <CABxpnn=48D9jZz5krqyatAvCiaa-Qq_Ea+5fx_EK6v5TkTUmEA@mail.gmail.com>

Thank you. I posted this question on SO in the meantime as well, but
there is no answer for my question, so I pasted your answer
(https://stackoverflow.com/questions/70517625/how-to-use-trace-for-function-in-parent-or-child-environment).
Hope it is fine for you.

?r., 29 gru 2021 o 11:24 Duncan Murdoch <murdoch.duncan at gmail.com> napisa?(a):
>
> On 28/12/2021 4:21 p.m., Grzegorz Smoli?ski wrote:
> > Thank you for all the comments. If this is not a problem, I would like
> > to continue this thread as for me a lot of questions are still open.
> > But if I should post other questions in different messages / topics,
> > please let me know.
> >
> > I didn?t answer Ivan?s question previously, but yes, my desired result
> > is indeed what debug() / debugonce() does and Ivan mentioned trace()
> > earlier also, so I have tried this. I thought that trace() will be
> > better in my case (than debug()) since I would like to be able to call
> > trace() from one environment and insert browser() (using trace()) to
> > the function defined in parent environment (still not sure if I
> > understand this concept of environments).
> >
> > Even if I would like to use it in an shiny app, I have started with
> > this example:
> >
> > ------------------------------
> >
> > fun1 <- function() {
> >    a <-  1
> >    a
> > }
> >
> > fun2 <- function() {
> >    fun1 <- function(){
> >      b <- 2
> >      b
> >    }
> >    trace(fun1, browser, where = globalenv())
> > }
> >
> > fun1()
> > fun2()
> > fun1()
> >
> > --------------------------------
> >
> > So I was hoping to use trace inside child environment of global env,
> > i.e. set browser() using trace() to the body of function defined in
> > parent environment, but for sure I do not understand this since
> > trace() in my example above is putting the browser() function inside
> > fun1() function defined not in global environment, but in the body of
> > fun2(). I.e. I'm starting to browse the fun1() function with the local
> > variable 'b', not 'a' as I wanted.
>
> You are being bitten by normal R scoping.  While fun2 is executing, as
> soon as it executes the fun1 assignment the name fun1 is bound to the
> local function, so when you use fun1 in the first argument to trace(),
> you get that one.  It will ignore then "where" argument because it was
> passed a function object.  If you quote the name it will have to do a
> lookup and it will use "where".  So write fun2 like this:
>
> fun2 <- function() {
>    fun1 <- function(){
>      b <- 2
>      b
>    }
>    trace("fun1", browser, where = globalenv())
> }
>
>
> >
> > Can I ask for help with this? In other words, how can I refer to some
> > function from the parent environment (not necessarily defined in the
> > global environment) being in the child environment?
>
> You could have used parent.frame() in place of globalenv() if you want a
> function that was visible to the caller of fun2.  If you want a function
> that was defined with the same environment as fun2, you can usually use
> environment(fun2), or parent.env(environment()).
>
>
> >
> > Also, if I could ask - is the reversed operation possible? I mean -
> > can I refer to some function from the child environment being in the
> > parent environment? I guess not, because of ephemerality?
>
> Sometimes you can, but not usually.  If fun2 had returned a value that
> referenced the evaluation frame, you would be able to see the "b"
> version of fun1 there.  But yours didn't.  This one would:
>
>
> fun2 <- function() {
>    fun1 <- function(){
>      b <- 2
>      b
>    }
>    trace("fun1", browser, where = globalenv())
>    environment()
> }
>
> Now if you do e <- fun2(), you'll set the trace on the global fun1, but
> e$fun1 will be the local one.
>
> I don't really know how Shiny sets things up, so I can't help with the
> stuff below.
>
> Duncan Murdoch
>
>
> >
> > As I mentioned, I'm thinking about all of this in the context of shiny
> > app and the shiny app which consists of multiple files, modules. I'm
> > thinking if I could refer to any function from any environment (or at
> > least to any function in any parent environment) from one place (one,
> > current environment) where I will call debug() or trace() to insert
> > browser() at the beginning of this chosen function. And by "any
> > function" I'm thinking about another thing problematic for me. If I
> > consider this example:
> >
> > -------------------------------
> > mod.R inside R/
> > ---
> >
> > mod_UI <- function(id) {
> > }
> >
> > name_mod <- function(input, output, session) {
> >    fun1 <- reactive({
> >      a  <-  1
> >    })
> > }
> >
> > ---
> > app.R
> > ---
> >
> > library(shiny)
> >
> > ui <- fluidPage(
> >    mod_UI("mod"),
> >    textOutput("env")
> > )
> >
> > server <- function(input, output, session) {
> >
> >    name_mod("mod")
> >
> >    output$env <- renderPrint({
> >      names(environment(name_mod))
> >    })
> >
> >    observe({
> >      #trace(fun1, browser, where = environment(name_mod))
> >    })
> > }
> >
> > shinyApp(ui, server)
> > ---------------------------------------
> > I tried to refer to the fun1 in environment(name_mod) - if I'm not
> > wrong, this is my parent environment, where objects "mod_UI" and
> > "name_mod" exist, but obviously I'm doing this wrong, right? Because
> > here: "#trace(fun1, browser, where = environment(name_mod))" I have
> > tried to refer to the module environment, but I should refer to the
> > environment inside "name_mod". I don't know how to do this and here I
> > also would like to ask for help.
> >
> > I know this may not be the best place for questions regarding shiny,
> > but I think these questions are purely linked to environment topics.
> >
> > I also remember Bert's post about "body()" and yes, this seems to be a
> > better idea than my first try in my first post, but "trace()" and
> > "debug()" seem much easier as all I want is to insert browser(). But I
> > just can't get it, how to refer to functions in (any) other
> > environments.
> >
> > Thank you very much for all your help and I hope it is OK to keep asking :).
> >
> > pon., 27 gru 2021 o 18:28 Duncan Murdoch <murdoch.duncan at gmail.com> napisa?(a):
> >>
> >> On 27/12/2021 8:25 a.m., Duncan Murdoch wrote:
> >>> On 27/12/2021 8:06 a.m., Grzegorz Smoli?ski wrote:
> >>>> Hi,
> >>>>
> >>>> I know it is possible to find the environment in which some object
> >>>> lives using the 'environment()' function and the name of this object,
> >>>> but how to modify code of this object after this? Below is MRE:
> >>>
> >>> You are misunderstanding the relation between environments and
> >>> functions.  However, your understanding is also being messed up by a bug
> >>> in R, so it's not entirely your fault.
> >>
> >> Actually this isn't a bug in R, it is working as documented.  For a
> >> detailed explanation, see the response to my bug report here:
> >> https://bugs.r-project.org/show_bug.cgi?id=18269 .
> >>
> >> For a quick idea:  "complex assignments" are assignments where there is
> >> a complex expression on the left hand side, e.g.
> >>
> >>     environment(test)$test <- ...
> >>
> >> The way these are documented to work (in the R Language Definition
> >> manual) makes intuitive sense when you are working with regular R
> >> objects, but environments are "mutable" objects:  assigning them to a
> >> new name doesn't make a new copy, just a new reference.  That causes the
> >> definition of the complex assignment above to work in an unintuitive way.
> >>
> >> Conclusion:  you should avoid using calls like environment(f) on the
> >> left hand side of assignments, especially as part of a larger
> >> expression.  Break up the statement into steps like I did below:
> >>
> >>>      e <- environment(test)
> >>>      e$test <- eval(parse(text = "function() 2"))
> >>
> >> The same advice would apply to a function that returned an R6 object or
> >> a mutable object from the methods package (which are really environments
> >> in disguise), as well as some other exotic objects.
> >>
> >> Duncan Murdoch
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Dec 29 15:49:03 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 29 Dec 2021 09:49:03 -0500
Subject: [R] How to modify object's code living in some environment?
In-Reply-To: <CABxpnn=48D9jZz5krqyatAvCiaa-Qq_Ea+5fx_EK6v5TkTUmEA@mail.gmail.com>
References: <CABxpnnk-FqSLFeE4EA0Au8hZtfNRbYZyEsQRrE8bFs-5sPNAag@mail.gmail.com>
 <c4a08cad-74fc-501a-cb04-b7e905a021b7@gmail.com>
 <e22e1d7e-1ec1-ed3a-7276-8fc05fde69a9@gmail.com>
 <CABxpnn=hWbuxY=4x8eN9QNJWJj3dfdjBYWLzmQPTmU2i6LgYDw@mail.gmail.com>
 <ef8d8ca8-f5e6-6d80-bda0-dea5450aeb14@gmail.com>
 <CABxpnn=48D9jZz5krqyatAvCiaa-Qq_Ea+5fx_EK6v5TkTUmEA@mail.gmail.com>
Message-ID: <c1dbfc56-41e5-472a-37f5-cc83256bea18@gmail.com>

On 29/12/2021 9:29 a.m., Grzegorz Smoli?ski wrote:
> Thank you. I posted this question on SO in the meantime as well, but
> there is no answer for my question, so I pasted your answer
> (https://stackoverflow.com/questions/70517625/how-to-use-trace-for-function-in-parent-or-child-environment).
> Hope it is fine for you.

No problem, though I'd suggest posting the answer as an answer, rather 
than an edit to your question.

Duncan Murdoch

> 
> ?r., 29 gru 2021 o 11:24 Duncan Murdoch <murdoch.duncan at gmail.com> napisa?(a):
>>
>> On 28/12/2021 4:21 p.m., Grzegorz Smoli?ski wrote:
>>> Thank you for all the comments. If this is not a problem, I would like
>>> to continue this thread as for me a lot of questions are still open.
>>> But if I should post other questions in different messages / topics,
>>> please let me know.
>>>
>>> I didn?t answer Ivan?s question previously, but yes, my desired result
>>> is indeed what debug() / debugonce() does and Ivan mentioned trace()
>>> earlier also, so I have tried this. I thought that trace() will be
>>> better in my case (than debug()) since I would like to be able to call
>>> trace() from one environment and insert browser() (using trace()) to
>>> the function defined in parent environment (still not sure if I
>>> understand this concept of environments).
>>>
>>> Even if I would like to use it in an shiny app, I have started with
>>> this example:
>>>
>>> ------------------------------
>>>
>>> fun1 <- function() {
>>>     a <-  1
>>>     a
>>> }
>>>
>>> fun2 <- function() {
>>>     fun1 <- function(){
>>>       b <- 2
>>>       b
>>>     }
>>>     trace(fun1, browser, where = globalenv())
>>> }
>>>
>>> fun1()
>>> fun2()
>>> fun1()
>>>
>>> --------------------------------
>>>
>>> So I was hoping to use trace inside child environment of global env,
>>> i.e. set browser() using trace() to the body of function defined in
>>> parent environment, but for sure I do not understand this since
>>> trace() in my example above is putting the browser() function inside
>>> fun1() function defined not in global environment, but in the body of
>>> fun2(). I.e. I'm starting to browse the fun1() function with the local
>>> variable 'b', not 'a' as I wanted.
>>
>> You are being bitten by normal R scoping.  While fun2 is executing, as
>> soon as it executes the fun1 assignment the name fun1 is bound to the
>> local function, so when you use fun1 in the first argument to trace(),
>> you get that one.  It will ignore then "where" argument because it was
>> passed a function object.  If you quote the name it will have to do a
>> lookup and it will use "where".  So write fun2 like this:
>>
>> fun2 <- function() {
>>     fun1 <- function(){
>>       b <- 2
>>       b
>>     }
>>     trace("fun1", browser, where = globalenv())
>> }
>>
>>
>>>
>>> Can I ask for help with this? In other words, how can I refer to some
>>> function from the parent environment (not necessarily defined in the
>>> global environment) being in the child environment?
>>
>> You could have used parent.frame() in place of globalenv() if you want a
>> function that was visible to the caller of fun2.  If you want a function
>> that was defined with the same environment as fun2, you can usually use
>> environment(fun2), or parent.env(environment()).
>>
>>
>>>
>>> Also, if I could ask - is the reversed operation possible? I mean -
>>> can I refer to some function from the child environment being in the
>>> parent environment? I guess not, because of ephemerality?
>>
>> Sometimes you can, but not usually.  If fun2 had returned a value that
>> referenced the evaluation frame, you would be able to see the "b"
>> version of fun1 there.  But yours didn't.  This one would:
>>
>>
>> fun2 <- function() {
>>     fun1 <- function(){
>>       b <- 2
>>       b
>>     }
>>     trace("fun1", browser, where = globalenv())
>>     environment()
>> }
>>
>> Now if you do e <- fun2(), you'll set the trace on the global fun1, but
>> e$fun1 will be the local one.
>>
>> I don't really know how Shiny sets things up, so I can't help with the
>> stuff below.
>>
>> Duncan Murdoch
>>
>>
>>>
>>> As I mentioned, I'm thinking about all of this in the context of shiny
>>> app and the shiny app which consists of multiple files, modules. I'm
>>> thinking if I could refer to any function from any environment (or at
>>> least to any function in any parent environment) from one place (one,
>>> current environment) where I will call debug() or trace() to insert
>>> browser() at the beginning of this chosen function. And by "any
>>> function" I'm thinking about another thing problematic for me. If I
>>> consider this example:
>>>
>>> -------------------------------
>>> mod.R inside R/
>>> ---
>>>
>>> mod_UI <- function(id) {
>>> }
>>>
>>> name_mod <- function(input, output, session) {
>>>     fun1 <- reactive({
>>>       a  <-  1
>>>     })
>>> }
>>>
>>> ---
>>> app.R
>>> ---
>>>
>>> library(shiny)
>>>
>>> ui <- fluidPage(
>>>     mod_UI("mod"),
>>>     textOutput("env")
>>> )
>>>
>>> server <- function(input, output, session) {
>>>
>>>     name_mod("mod")
>>>
>>>     output$env <- renderPrint({
>>>       names(environment(name_mod))
>>>     })
>>>
>>>     observe({
>>>       #trace(fun1, browser, where = environment(name_mod))
>>>     })
>>> }
>>>
>>> shinyApp(ui, server)
>>> ---------------------------------------
>>> I tried to refer to the fun1 in environment(name_mod) - if I'm not
>>> wrong, this is my parent environment, where objects "mod_UI" and
>>> "name_mod" exist, but obviously I'm doing this wrong, right? Because
>>> here: "#trace(fun1, browser, where = environment(name_mod))" I have
>>> tried to refer to the module environment, but I should refer to the
>>> environment inside "name_mod". I don't know how to do this and here I
>>> also would like to ask for help.
>>>
>>> I know this may not be the best place for questions regarding shiny,
>>> but I think these questions are purely linked to environment topics.
>>>
>>> I also remember Bert's post about "body()" and yes, this seems to be a
>>> better idea than my first try in my first post, but "trace()" and
>>> "debug()" seem much easier as all I want is to insert browser(). But I
>>> just can't get it, how to refer to functions in (any) other
>>> environments.
>>>
>>> Thank you very much for all your help and I hope it is OK to keep asking :).
>>>
>>> pon., 27 gru 2021 o 18:28 Duncan Murdoch <murdoch.duncan at gmail.com> napisa?(a):
>>>>
>>>> On 27/12/2021 8:25 a.m., Duncan Murdoch wrote:
>>>>> On 27/12/2021 8:06 a.m., Grzegorz Smoli?ski wrote:
>>>>>> Hi,
>>>>>>
>>>>>> I know it is possible to find the environment in which some object
>>>>>> lives using the 'environment()' function and the name of this object,
>>>>>> but how to modify code of this object after this? Below is MRE:
>>>>>
>>>>> You are misunderstanding the relation between environments and
>>>>> functions.  However, your understanding is also being messed up by a bug
>>>>> in R, so it's not entirely your fault.
>>>>
>>>> Actually this isn't a bug in R, it is working as documented.  For a
>>>> detailed explanation, see the response to my bug report here:
>>>> https://bugs.r-project.org/show_bug.cgi?id=18269 .
>>>>
>>>> For a quick idea:  "complex assignments" are assignments where there is
>>>> a complex expression on the left hand side, e.g.
>>>>
>>>>      environment(test)$test <- ...
>>>>
>>>> The way these are documented to work (in the R Language Definition
>>>> manual) makes intuitive sense when you are working with regular R
>>>> objects, but environments are "mutable" objects:  assigning them to a
>>>> new name doesn't make a new copy, just a new reference.  That causes the
>>>> definition of the complex assignment above to work in an unintuitive way.
>>>>
>>>> Conclusion:  you should avoid using calls like environment(f) on the
>>>> left hand side of assignments, especially as part of a larger
>>>> expression.  Break up the statement into steps like I did below:
>>>>
>>>>>       e <- environment(test)
>>>>>       e$test <- eval(parse(text = "function() 2"))
>>>>
>>>> The same advice would apply to a function that returned an R6 object or
>>>> a mutable object from the methods package (which are really environments
>>>> in disguise), as well as some other exotic objects.
>>>>
>>>> Duncan Murdoch
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Wed Dec 29 17:00:47 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 29 Dec 2021 08:00:47 -0800
Subject: [R] mixture univariate distributions fit
In-Reply-To: <42e04a96845c4c96a15da9d7e8044028@SRVEXCHCM1301.precheza.cz>
References: <42e04a96845c4c96a15da9d7e8044028@SRVEXCHCM1301.precheza.cz>
Message-ID: <CAGxFJbTxasFj4+MpFZfngvHA_d_8BK41mknZzoSDFfq+Cxa6fg@mail.gmail.com>

No.

However, if the object returned is the "Value" structure of whatever
density function you use, it probably contains the original data. You
need to check the docs to see. But this does not appear to be your
situation.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Wed, Dec 29, 2021 at 3:05 AM PIKAL Petr <petr.pikal at precheza.cz> wrote:
>
> Dear all
>
> I have data which are either density distribution estimate or cummulative
> density distribution estimate (temp1, temp2 below). I would like to get
> values (mu, sd) for underlaying original data but they are not available.
>
> I found mixtools package which calculate what I need but it requires
> original data (AFAIK). They could be generated from e.g. temp1 by
>
> set.seed(111)
> x<- sample(temp1$velik, size=100000, replace=TRUE, prob=temp1$proc)
>
> library(mixtools)
> fit <- normalmixEM(x)
> plot(fit, which=2)
> summary(fit)
> summary of normalmixEM object:
>            comp 1     comp 2
> lambda   0.576346   0.423654
> mu     170.784520 229.192823
> sigma    7.203491  10.793461
> loglik at estimate:  -424062.7
> >
>
> Is there any way how to get such values directly from density or cummulative
> density estimation without generating fake data by sample?
>
> Best regards
> Petr
>
>
> temp1 <- structure(list(velik = c(155, 156.8, 157.9, 158.8, 159.6, 160.4,
> 161.2, 161.9, 162.5, 163.1, 163.8, 164.3, 164.7, 165.3, 165.8,
> 166.2, 166.7, 167.2, 167.7, 168.2, 168.7, 169.1, 169.6, 170.1,
> 170.6, 171.1, 171.6, 172, 172.5, 173, 173.5, 174, 174.5, 175.1,
> 175.7, 176.3, 177, 177.6, 178.3, 179.1, 179.9, 180.6, 181.4,
> 182.4, 183.5, 184.7, 186.1, 187.9, 189.8, 192, 194.4, 197, 200.1,
> 203.5, 206.7, 209.2, 211.3, 213.1, 214.8, 216.3, 217.4, 218.5,
> 219.5, 220.4, 221.3, 222.1, 223, 223.7, 224.5, 225.2, 225.9,
> 226.7, 227.5, 228.2, 228.9, 229.6, 230.4, 231.2, 231.9, 232.6,
> 233.4, 234.2, 235, 235.9, 236.8, 237.7, 238.6, 239.7, 241, 242.3,
> 243.6, 245.2, 247.1, 249.3, 251.9, 255.3, 260, 266, 274.9, 323.4
> ), proc = c(0.6171, 1.583, 1.371, 2.13, 1.828, 2.095, 1.994,
> 2.694, 2.824, 2.41, 2.909, 3.768, 3.179, 3.029, 3.798, 3.743,
> 3.276, 3.213, 3.579, 2.928, 4.634, 3.415, 3.473, 3.135, 3.476,
> 3.759, 3.726, 3.9, 3.593, 2.89, 3.707, 4.08, 2.846, 2.685, 3.394,
> 2.737, 2.693, 2.878, 2.248, 2.368, 2.258, 2.662, 1.866, 1.895,
> 1.457, 1.513, 1.181, 1.008, 0.9641, 0.799, 0.7878, 0.7209, 0.5869,
> 0.5778, 0.7313, 0.9531, 1.053, 1.317, 1.247, 1.739, 2.064, 1.99,
> 2.522, 2.401, 2.48, 2.687, 2.797, 2.918, 3.243, 3.055, 3.009,
> 2.89, 3.037, 3.25, 3.349, 3.141, 2.771, 2.985, 3.203, 3.298,
> 3.215, 2.637, 2.683, 2.782, 2.632, 2.625, 2.475, 2.014, 1.781,
> 1.987, 1.627, 1.374, 1.352, 0.9441, 1.01, 0.5737, 0.5265, 0.3794,
> 0.2513, 0.0351)), row.names = 2:101, class = "data.frame")
>
> temp2 <- structure(list(velik = c(153.8, 156.3, 157.3, 158.4, 159.2, 160.1,
> 160.8, 161.6, 162.2, 162.8, 163.5, 164, 164.5, 165, 165.5, 166,
> 166.4, 166.9, 167.5, 167.9, 168.5, 168.9, 169.4, 169.8, 170.4,
> 170.9, 171.3, 171.8, 172.2, 172.7, 173.3, 173.8, 174.2, 174.8,
> 175.5, 176, 176.6, 177.3, 177.9, 178.7, 179.5, 180.3, 180.9,
> 181.9, 182.9, 184.1, 185.3, 186.9, 188.8, 190.8, 193.2, 195.6,
> 198.4, 201.8, 205.3, 208.1, 210.3, 212.3, 213.9, 215.7, 216.9,
> 218, 219.1, 219.9, 220.8, 221.7, 222.6, 223.4, 224.1, 224.8,
> 225.6, 226.3, 227.1, 227.8, 228.5, 229.2, 230, 230.8, 231.6,
> 232.3, 233, 233.7, 234.6, 235.5, 236.3, 237.2, 238.1, 239.1,
> 240.3, 241.6, 242.9, 244.4, 246.1, 248, 250.6, 253.1, 257.6,
> 262.5, 269.5, 280.4, 372.9), proc = c(0, 1, 2, 3, 4, 5, 6, 7,
> 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
> 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39,
> 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55,
> 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
> 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87,
> 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100)), row.names = c(NA,
> 101L), class = "data.frame")
> >
>
> >
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Wed Dec 29 20:08:33 2021
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Wed, 29 Dec 2021 19:08:33 +0000 (UTC)
Subject: [R] Speed up studentized confidence intervals ?
In-Reply-To: <ade3d6fe-011e-7b1d-174e-d5e5dc6fa0cf@sapo.pt>
References: <721769419.5879847.1639914338826.ref@mail.yahoo.com>
 <721769419.5879847.1639914338826@mail.yahoo.com>
 <ade3d6fe-011e-7b1d-174e-d5e5dc6fa0cf@sapo.pt>
Message-ID: <1382401986.3579113.1640804913673@mail.yahoo.com>

Dear David,
Dear Rui,

Many thanks for your response. It perfectly works for the mean. Now I have a problem with my R code for the median. Because I always get 1 (100%) coverage probability that is more than very strange. Indeed, considering that an interval whose lower limit is the smallest value in the sample and whose upper limit is the largest value has 1/32 + 1/32 = 1/16 probability of non-coverage, implying that the confidence of such an interval is 15/16 rather than 1 (100%), I suspect that the confidence interval I use for the median is not correctly defined for n=5 observations, and likely contains all observations in the sample ? What is wrong with my R code ?

########################################
library(boot)

s=rgamma(n=100000,shape=2,rate=5)
median(s)

N <- 100
out <- replicate(N, {
a<- sample(s,size=5)
median(a) 

dat<-data.frame(a)
med<-function(d,i) {
temp<-d[i,]
median(temp)
}

? boot.out <- boot(data = dat, statistic = med, R = 10000)
? boot.ci(boot.out, type = "bca")$bca[, 4:5]
})

#coverage probability
median(out[1, ] < median(s) & median(s) < out[2, ])
########################################




Le jeudi 23 d?cembre 2021, 14:10:36 UTC+1, Rui Barradas <ruipbarradas at sapo.pt> a ?crit : 





Hello,

The code is running very slowly because you are recreating the function 
in the replicate() loop and because you are creating a data.frame also 
in the loop.

And because in the bootstrap statistic function med() you are computing 
the variance of yet another loop. This is probably statistically wrong 
but like David says, without a problem description it's hard to say.

Also, why compute variances if they are never used?

Here is complete code executing in much less than 2:00 hours. Note that 
it passes the vector a directly to med(), not a df with just one column.


library(boot)

set.seed(2021)
s <- sample(178:798, 100000, replace = TRUE)
mean(s)

med <- function(d, i) {
? temp <- d[i]
? f <- mean(temp)
? g <- var(temp)
? c(Mean = f, Var = g)
}

N <- 1000
out <- replicate(N, {
? a <- sample(s, size = 5)
? boot.out <- boot(data = a, statistic = med, R = 10000)
? boot.ci(boot.out, type = "stud")$stud[, 4:5]
})
mean(out[1, ] < mean(s) & mean(s) < out[2, ])
#[1] 0.952



Hope this helps,

Rui Barradas

?s 11:45 de 19/12/21, varin sacha via R-help escreveu:
> Dear R-experts,
> 
> Here below my R code working but really really slowly ! I need 2 hours with my computer to finally get an answer ! Is there a way to improve my R code to speed it up ? At least to win 1 hour ;=)
> 
> Many thanks
> 
> ########################################################
> library(boot)
> 
> s<- sample(178:798, 100000, replace=TRUE)
> mean(s)
> 
> N <- 1000
> out <- replicate(N, {
> a<- sample(s,size=5)
> mean(a)
> dat<-data.frame(a)
> 
> med<-function(d,i) {
> temp<-d[i,]
> f<-mean(temp)
> g<-var(replicate(50,mean(sample(temp,replace=T))))
> return(c(f,g))
> 
> }
> 
>? ? boot.out <- boot(data = dat, statistic = med, R = 10000)
>? ? boot.ci(boot.out, type = "stud")$stud[, 4:5]
> })
> mean(out[1,] < mean(s) & mean(s) < out[2,])
> ########################################################
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
> 


From george@br|d@ @end|ng |rom gm@||@com  Wed Dec 29 21:34:17 2021
From: george@br|d@ @end|ng |rom gm@||@com (george brida)
Date: Wed, 29 Dec 2021 21:34:17 +0100
Subject: [R] Mapping of groups of countries
Message-ID: <CAGsroM0GkdR=63reA1h5T1Qtr5rm=ACL3T0xusiu+qkhbbC18A@mail.gmail.com>

Dear R users,

I would like to map with R the following countries (with their names on the
map) as follows: the first group in red composed by China, Bangladesh,
Eypt, Indonesia, South Korea, Nigeria. The second group in blue composed by
Brazil, Pakistan, Philippines, Vietnam.

The third group in green solely composed by South Africa.

Finally, the fourth group in orange composed by India, Mexico and Turkey.

I'd also like a legend that assigns the different colors to the various
group.
I tried several times with library maps but it seems that I failed to find
the real setting of xlim and ylim. Can you please help me, I will be very
grateful.

Best regards
George

	[[alternative HTML version deleted]]


From drj|m|emon @end|ng |rom gm@||@com  Wed Dec 29 22:10:24 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Thu, 30 Dec 2021 08:10:24 +1100
Subject: [R] Mapping of groups of countries
In-Reply-To: <CAGsroM0GkdR=63reA1h5T1Qtr5rm=ACL3T0xusiu+qkhbbC18A@mail.gmail.com>
References: <CAGsroM0GkdR=63reA1h5T1Qtr5rm=ACL3T0xusiu+qkhbbC18A@mail.gmail.com>
Message-ID: <CA+8X3fU-Xczjp6X7oRmdCPaZ8YrdQYUGkZ63o874Ji0c6b7HfA@mail.gmail.com>

Hi George,
This example is obviously a mess, but it shows the basic elements. The
labels may be placed manually using something like boxed.labels
(plotrix) with lines connecting the labels to the smaller countries.
If you want the labels within the countries you will have to use a big
graphics device.

library(maps)
map("world")
countries=c("China","Bangladesh","Egypt","Indonesia","South Korea","Nigeria",
 "Brazil","Pakistan","Philippines","Vietnam","South Africa",
 "India","Mexico","Turkey")
countrycol<-c(rep("red",6),rep("blue",4),"green",rep("orange",3))
for(i in 1:length(countries)) {
 mapinf<-map(region=countries[i],col=countrycol[i],add=TRUE)
 xpos<-sum(mapinf$range[1:2])/2
 ypos<-sum(mapinf$range[3:4])/2
 text(xpos,ypos,countries[i])
}


Jim

On Thu, Dec 30, 2021 at 7:34 AM george brida <george.brida at gmail.com> wrote:
>
> Dear R users,
>
> I would like to map with R the following countries (with their names on the
> map) as follows: the first group in red composed by China, Bangladesh,
> Eypt, Indonesia, South Korea, Nigeria. The second group in blue composed by
> Brazil, Pakistan, Philippines, Vietnam.
>
> The third group in green solely composed by South Africa.
>
> Finally, the fourth group in orange composed by India, Mexico and Turkey.
>
> I'd also like a legend that assigns the different colors to the various
> group.
> I tried several times with library maps but it seems that I failed to find
> the real setting of xlim and ylim. Can you please help me, I will be very
> grateful.
>
> Best regards
> George
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From dw|n@em|u@ @end|ng |rom comc@@t@net  Thu Dec 30 02:22:10 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Wed, 29 Dec 2021 17:22:10 -0800
Subject: [R] Speed up studentized confidence intervals ?
In-Reply-To: <1382401986.3579113.1640804913673@mail.yahoo.com>
References: <721769419.5879847.1639914338826.ref@mail.yahoo.com>
 <721769419.5879847.1639914338826@mail.yahoo.com>
 <ade3d6fe-011e-7b1d-174e-d5e5dc6fa0cf@sapo.pt>
 <1382401986.3579113.1640804913673@mail.yahoo.com>
Message-ID: <5923ef8c-f005-8775-96f3-c222a53b9d39@comcast.net>


On 12/29/21 11:08 AM, varin sacha via R-help wrote:
> Dear David,
> Dear Rui,
>
> Many thanks for your response. It perfectly works for the mean. Now I have a problem with my R code for the median. Because I always get 1 (100%) coverage probability that is more than very strange. Indeed, considering that an interval whose lower limit is the smallest value in the sample and whose upper limit is the largest value has 1/32 + 1/32 = 1/16 probability of non-coverage, implying that the confidence of such an interval is 15/16 rather than 1 (100%), I suspect that the confidence interval I use for the median is not correctly defined for n=5 observations, and likely contains all observations in the sample ? What is wrong with my R code ?


Seems to me that doing? a bootstrap within a `replicate` call is not 
needed. (Use one or the other as a mechanism for replication.

Here's what I would consider to be a "bootstrap" operation for 
estimating a 95% CI on the Gamma distributed population you created:

Used a sample size of 10000 rather than 100000


 > quantile( replicate( 1000, {median(sample(s,5))}) , .5+c(-0.475,0.475))
 ???? 2.5%???? 97.5%
0.1343071 0.6848352

This is using boot::boot to calculate medians of samples of size 5

 > med <- function( data, indices) {
+???? d <- data[indices[1:5]] # allows boot to select sample
+???? return( median(d))
+ }
 > res <- boot(data=s, med, 1000)

 > str(res)
List of 11
 ?$ t0?????? : num 0.275
 ?$ t??????? : num [1:1000, 1] 0.501 0.152 0.222 0.11 0.444 ...
 ?$ R??????? : num 1000
 ?$ data???? : num [1:10000] 0.7304 0.4062 0.1901 0.0275 0.2748 ...
 ?$ seed???? : int [1:626] 10403 431 -118115842 -603122380 -2026881868 
758139796 1148648893 -1161368223 1814605964 -1456558535 ...
 ?$ statistic:function (data, indices)
 ? ..- attr(*, "srcref")= 'srcref' int [1:8] 1 8 4 1 8 1 1 4
 ? .. ..- attr(*, "srcfile")=Classes 'srcfilecopy', 'srcfile' 
<environment: 0x5562fcb434e8>
 ?$ sim????? : chr "ordinary"
 ?$ call???? : language boot(data = s, statistic = med, R = 1000)
 ?$ stype??? : chr "i"
 ?$ strata?? : num [1:10000] 1 1 1 1 1 1 1 1 1 1 ...
 ?$ weights? : num [1:10000] 1e-04 1e-04 1e-04 1e-04 1e-04 1e-04 1e-04 
1e-04 1e-04 1e-04 ...
 ?- attr(*, "class")= chr "boot"
 ?- attr(*, "boot_type")= chr "boot"

 > quantile( res$t , .5+c(-0.475,0.475))
 ???? 2.5%???? 97.5%
0.1283309 0.6821874



>
> ########################################
> library(boot)
>
> s=rgamma(n=100000,shape=2,rate=5)
> median(s)
>
> N <- 100
> out <- replicate(N, {
> a<- sample(s,size=5)
> median(a)
>
> dat<-data.frame(a)
> med<-function(d,i) {
> temp<-d[i,]
> median(temp)
> }
>
>  ? boot.out <- boot(data = dat, statistic = med, R = 10000)
>  ? boot.ci(boot.out, type = "bca")$bca[, 4:5]
> })
>
> #coverage probability
> median(out[1, ] < median(s) & median(s) < out[2, ])
> ########################################
>
>
>
>
> Le jeudi 23 d?cembre 2021, 14:10:36 UTC+1, Rui Barradas <ruipbarradas at sapo.pt> a ?crit :
>
>
>
>
>
> Hello,
>
> The code is running very slowly because you are recreating the function
> in the replicate() loop and because you are creating a data.frame also
> in the loop.
>
> And because in the bootstrap statistic function med() you are computing
> the variance of yet another loop. This is probably statistically wrong
> but like David says, without a problem description it's hard to say.
>
> Also, why compute variances if they are never used?
>
> Here is complete code executing in much less than 2:00 hours. Note that
> it passes the vector a directly to med(), not a df with just one column.
>
>
> library(boot)
>
> set.seed(2021)
> s <- sample(178:798, 100000, replace = TRUE)
> mean(s)
>
> med <- function(d, i) {
>  ? temp <- d[i]
>  ? f <- mean(temp)
>  ? g <- var(temp)
>  ? c(Mean = f, Var = g)
> }
>
> N <- 1000
> out <- replicate(N, {
>  ? a <- sample(s, size = 5)
>  ? boot.out <- boot(data = a, statistic = med, R = 10000)
>  ? boot.ci(boot.out, type = "stud")$stud[, 4:5]
> })
> mean(out[1, ] < mean(s) & mean(s) < out[2, ])
> #[1] 0.952
>
>
>
> Hope this helps,
>
> Rui Barradas
>
> ?s 11:45 de 19/12/21, varin sacha via R-help escreveu:
>> Dear R-experts,
>>
>> Here below my R code working but really really slowly ! I need 2 hours with my computer to finally get an answer ! Is there a way to improve my R code to speed it up ? At least to win 1 hour ;=)
>>
>> Many thanks
>>
>> ########################################################
>> library(boot)
>>
>> s<- sample(178:798, 100000, replace=TRUE)
>> mean(s)
>>
>> N <- 1000
>> out <- replicate(N, {
>> a<- sample(s,size=5)
>> mean(a)
>> dat<-data.frame(a)
>>
>> med<-function(d,i) {
>> temp<-d[i,]
>> f<-mean(temp)
>> g<-var(replicate(50,mean(sample(temp,replace=T))))
>> return(c(f,g))
>>
>> }
>>
>>  ? ? boot.out <- boot(data = dat, statistic = med, R = 10000)
>>  ? ? boot.ci(boot.out, type = "stud")$stud[, 4:5]
>> })
>> mean(out[1,] < mean(s) & mean(s) < out[2,])
>> ########################################################
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From j|ox @end|ng |rom mcm@@ter@c@  Thu Dec 30 05:25:09 2021
From: j|ox @end|ng |rom mcm@@ter@c@ (Fox, John)
Date: Thu, 30 Dec 2021 04:25:09 +0000
Subject: [R] Speed up studentized confidence intervals ?
In-Reply-To: <5715_1640804948_1BTJ96KP008110_1382401986.3579113.1640804913673@mail.yahoo.com>
References: <721769419.5879847.1639914338826.ref@mail.yahoo.com>
 <721769419.5879847.1639914338826@mail.yahoo.com>
 <ade3d6fe-011e-7b1d-174e-d5e5dc6fa0cf@sapo.pt>
 <5715_1640804948_1BTJ96KP008110_1382401986.3579113.1640804913673@mail.yahoo.com>
Message-ID: <175EC817-7136-4559-BF04-39675578EDA0@mcmaster.ca>

Dear varin sacha,

You didn't correctly adapt the code to the median. The outer call to mean() in the last line shouldn't be replaced with median() -- it computes the proportion of intervals that include the population median.

As well, you can't rely on the asymptotics of the bootstrap for a nonlinear statistic like the median with an n as small as 5, as your example, properly implemented (and with the code slightly cleaned up), illustrates:

> library(boot)
> set.seed(123)
> s <- rgamma(n=100000, shape=2, rate=5)
> (m <- median(s))
[1] 0.3364465
> N <- 1000
> n <- 5
> set.seed(321)
> out <- replicate(N, {
+   dat <- data.frame(sample(s, size=n))
+   med <- function(d, i) {
+     median(d[i, ])
+   }
+   boot.out <- boot(data = dat, statistic = med, R = 10000)
+   boot.ci(boot.out, type = "bca")$bca[, 4:5]
+ })
> #coverage probability
> mean(out[1, ] < m & m < out[2, ])
[1] 0.758


You do get the expected coverage, however, for a larger sample, here with n = 100:

> N <- 1000
> n <- 100
> set.seed(321)
> out <- replicate(N, {
+   dat <- data.frame(sample(s, size=n))
+   med <- function(d, i) {
+     median(d[i, ])
+   }
+   boot.out <- boot(data = dat, statistic = med, R = 10000)
+   boot.ci(boot.out, type = "bca")$bca[, 4:5]
+ })
> #coverage probability
> mean(out[1, ] < m & m < out[2, ])
[1] 0.952

I hope this helps,
 John

-- 
John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
Web: http://socserv.mcmaster.ca/jfox/
 
 


?On 2021-12-29, 2:09 PM, "R-help on behalf of varin sacha via R-help" <r-help-bounces at r-project.org on behalf of r-help at r-project.org> wrote:

    Dear David,
    Dear Rui,

    Many thanks for your response. It perfectly works for the mean. Now I have a problem with my R code for the median. Because I always get 1 (100%) coverage probability that is more than very strange. Indeed, considering that an interval whose lower limit is the smallest value in the sample and whose upper limit is the largest value has 1/32 + 1/32 = 1/16 probability of non-coverage, implying that the confidence of such an interval is 15/16 rather than 1 (100%), I suspect that the confidence interval I use for the median is not correctly defined for n=5 observations, and likely contains all observations in the sample ? What is wrong with my R code ?

    ########################################
    library(boot)

    s=rgamma(n=100000,shape=2,rate=5)
    median(s)

    N <- 100
    out <- replicate(N, {
    a<- sample(s,size=5)
    median(a) 

    dat<-data.frame(a)
    med<-function(d,i) {
    temp<-d[i,]
    median(temp)
    }

      boot.out <- boot(data = dat, statistic = med, R = 10000)
      boot.ci(boot.out, type = "bca")$bca[, 4:5]
    })

    #coverage probability
    median(out[1, ] < median(s) & median(s) < out[2, ])
    ########################################




    Le jeudi 23 d?cembre 2021, 14:10:36 UTC+1, Rui Barradas <ruipbarradas at sapo.pt> a ?crit : 





    Hello,

    The code is running very slowly because you are recreating the function 
    in the replicate() loop and because you are creating a data.frame also 
    in the loop.

    And because in the bootstrap statistic function med() you are computing 
    the variance of yet another loop. This is probably statistically wrong 
    but like David says, without a problem description it's hard to say.

    Also, why compute variances if they are never used?

    Here is complete code executing in much less than 2:00 hours. Note that 
    it passes the vector a directly to med(), not a df with just one column.


    library(boot)

    set.seed(2021)
    s <- sample(178:798, 100000, replace = TRUE)
    mean(s)

    med <- function(d, i) {
      temp <- d[i]
      f <- mean(temp)
      g <- var(temp)
      c(Mean = f, Var = g)
    }

    N <- 1000
    out <- replicate(N, {
      a <- sample(s, size = 5)
      boot.out <- boot(data = a, statistic = med, R = 10000)
      boot.ci(boot.out, type = "stud")$stud[, 4:5]
    })
    mean(out[1, ] < mean(s) & mean(s) < out[2, ])
    #[1] 0.952



    Hope this helps,

    Rui Barradas

    ?s 11:45 de 19/12/21, varin sacha via R-help escreveu:
    > Dear R-experts,
    > 
    > Here below my R code working but really really slowly ! I need 2 hours with my computer to finally get an answer ! Is there a way to improve my R code to speed it up ? At least to win 1 hour ;=)
    > 
    > Many thanks
    > 
    > ########################################################
    > library(boot)
    > 
    > s<- sample(178:798, 100000, replace=TRUE)
    > mean(s)
    > 
    > N <- 1000
    > out <- replicate(N, {
    > a<- sample(s,size=5)
    > mean(a)
    > dat<-data.frame(a)
    > 
    > med<-function(d,i) {
    > temp<-d[i,]
    > f<-mean(temp)
    > g<-var(replicate(50,mean(sample(temp,replace=T))))
    > return(c(f,g))
    > 
    > }
    > 
    >    boot.out <- boot(data = dat, statistic = med, R = 10000)
    >    boot.ci(boot.out, type = "stud")$stud[, 4:5]
    > })
    > mean(out[1,] < mean(s) & mean(s) < out[2,])
    > ########################################################
    > 
    > ______________________________________________
    > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
    > https://stat.ethz.ch/mailman/listinfo/r-help
    > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
    > and provide commented, minimal, self-contained, reproducible code.
    > 

    ______________________________________________
    R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
    https://stat.ethz.ch/mailman/listinfo/r-help
    PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
    and provide commented, minimal, self-contained, reproducible code.


From petr@p|k@| @end|ng |rom prechez@@cz  Thu Dec 30 09:36:07 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Thu, 30 Dec 2021 08:36:07 +0000
Subject: [R] mixture univariate distributions fit
In-Reply-To: <CAGxFJbTxasFj4+MpFZfngvHA_d_8BK41mknZzoSDFfq+Cxa6fg@mail.gmail.com>
References: <42e04a96845c4c96a15da9d7e8044028@SRVEXCHCM1301.precheza.cz>
 <CAGxFJbTxasFj4+MpFZfngvHA_d_8BK41mknZzoSDFfq+Cxa6fg@mail.gmail.com>
Message-ID: <f95d630111d44aa1ad9823501a4eef16@SRVEXCHCM1301.precheza.cz>

Thank you Bert

The values are results from particle size measurement by sedimentation and 
they are really available only as these cumulative or density distributions. 
What I thought about was that there is some package which could fit data of 
such curves and deliver parameters of fitted curves.

Something like
https://chrisostrouchov.com/post/peak_fit_xrd_python/

I found package EMpeaksR which results close to values estimated from mixtools 
package.

test <- spect_em_gmm(temp1$velik, temp1$proc, mu=c(170, 220), 
mix_ratio=c(1,1), sigma=c(5,5), maxit=2000, conv.cri=1e-8)
print(cbind(test$mu, test$sigma, test$mix_ratio))
         [,1]      [,2]      [,3]
[1,] 170.7744  7.200109 0.5759867
[2,] 229.1815 10.831626 0.4240133

But it is probably in stage of intensive development as it is limited in data 
visualisation

Any further hint is appreciated.

Regards
Petr

> -----Original Message-----
> From: Bert Gunter <bgunter.4567 at gmail.com>
> Sent: Wednesday, December 29, 2021 5:01 PM
> To: PIKAL Petr <petr.pikal at precheza.cz>
> Cc: r-help mailing list <r-help at r-project.org>
> Subject: Re: [R] mixture univariate distributions fit
>
> No.
>
> However, if the object returned is the "Value" structure of whatever density
> function you use, it probably contains the original data. You need to check
> the docs to see. But this does not appear to be your situation.
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along and
> sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> On Wed, Dec 29, 2021 at 3:05 AM PIKAL Petr <petr.pikal at precheza.cz>
> wrote:
> >
> > Dear all
> >
> > I have data which are either density distribution estimate or
> > cummulative density distribution estimate (temp1, temp2 below). I
> > would like to get values (mu, sd) for underlaying original data but they 
> > are
> not available.
> >
> > I found mixtools package which calculate what I need but it requires
> > original data (AFAIK). They could be generated from e.g. temp1 by
> >
> > set.seed(111)
> > x<- sample(temp1$velik, size=100000, replace=TRUE, prob=temp1$proc)
> >
> > library(mixtools)
> > fit <- normalmixEM(x)
> > plot(fit, which=2)
> > summary(fit)
> > summary of normalmixEM object:
> >            comp 1     comp 2
> > lambda   0.576346   0.423654
> > mu     170.784520 229.192823
> > sigma    7.203491  10.793461
> > loglik at estimate:  -424062.7
> > >
> >
> > Is there any way how to get such values directly from density or
> > cummulative density estimation without generating fake data by sample?
> >
> > Best regards
> > Petr
> >
> >
> > temp1 <- structure(list(velik = c(155, 156.8, 157.9, 158.8, 159.6,
> > 160.4, 161.2, 161.9, 162.5, 163.1, 163.8, 164.3, 164.7, 165.3, 165.8,
> > 166.2, 166.7, 167.2, 167.7, 168.2, 168.7, 169.1, 169.6, 170.1, 170.6,
> > 171.1, 171.6, 172, 172.5, 173, 173.5, 174, 174.5, 175.1, 175.7, 176.3,
> > 177, 177.6, 178.3, 179.1, 179.9, 180.6, 181.4, 182.4, 183.5, 184.7,
> > 186.1, 187.9, 189.8, 192, 194.4, 197, 200.1, 203.5, 206.7, 209.2,
> > 211.3, 213.1, 214.8, 216.3, 217.4, 218.5, 219.5, 220.4, 221.3, 222.1,
> > 223, 223.7, 224.5, 225.2, 225.9, 226.7, 227.5, 228.2, 228.9, 229.6,
> > 230.4, 231.2, 231.9, 232.6, 233.4, 234.2, 235, 235.9, 236.8, 237.7,
> > 238.6, 239.7, 241, 242.3, 243.6, 245.2, 247.1, 249.3, 251.9, 255.3,
> > 260, 266, 274.9, 323.4 ), proc = c(0.6171, 1.583, 1.371, 2.13, 1.828,
> > 2.095, 1.994, 2.694, 2.824, 2.41, 2.909, 3.768, 3.179, 3.029, 3.798,
> > 3.743, 3.276, 3.213, 3.579, 2.928, 4.634, 3.415, 3.473, 3.135, 3.476,
> > 3.759, 3.726, 3.9, 3.593, 2.89, 3.707, 4.08, 2.846, 2.685, 3.394,
> > 2.737, 2.693, 2.878, 2.248, 2.368, 2.258, 2.662, 1.866, 1.895, 1.457,
> > 1.513, 1.181, 1.008, 0.9641, 0.799, 0.7878, 0.7209, 0.5869, 0.5778,
> > 0.7313, 0.9531, 1.053, 1.317, 1.247, 1.739, 2.064, 1.99, 2.522, 2.401,
> > 2.48, 2.687, 2.797, 2.918, 3.243, 3.055, 3.009, 2.89, 3.037, 3.25,
> > 3.349, 3.141, 2.771, 2.985, 3.203, 3.298, 3.215, 2.637, 2.683, 2.782,
> > 2.632, 2.625, 2.475, 2.014, 1.781, 1.987, 1.627, 1.374, 1.352, 0.9441,
> > 1.01, 0.5737, 0.5265, 0.3794, 0.2513, 0.0351)), row.names = 2:101,
> > class = "data.frame")
> >
> > temp2 <- structure(list(velik = c(153.8, 156.3, 157.3, 158.4, 159.2,
> > 160.1, 160.8, 161.6, 162.2, 162.8, 163.5, 164, 164.5, 165, 165.5, 166,
> > 166.4, 166.9, 167.5, 167.9, 168.5, 168.9, 169.4, 169.8, 170.4, 170.9,
> > 171.3, 171.8, 172.2, 172.7, 173.3, 173.8, 174.2, 174.8, 175.5, 176,
> > 176.6, 177.3, 177.9, 178.7, 179.5, 180.3, 180.9, 181.9, 182.9, 184.1,
> > 185.3, 186.9, 188.8, 190.8, 193.2, 195.6, 198.4, 201.8, 205.3, 208.1,
> > 210.3, 212.3, 213.9, 215.7, 216.9, 218, 219.1, 219.9, 220.8, 221.7,
> > 222.6, 223.4, 224.1, 224.8, 225.6, 226.3, 227.1, 227.8, 228.5, 229.2,
> > 230, 230.8, 231.6, 232.3, 233, 233.7, 234.6, 235.5, 236.3, 237.2,
> > 238.1, 239.1, 240.3, 241.6, 242.9, 244.4, 246.1, 248, 250.6, 253.1,
> > 257.6, 262.5, 269.5, 280.4, 372.9), proc = c(0, 1, 2, 3, 4, 5, 6, 7,
> > 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25,
> > 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42,
> > 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59,
> > 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76,
> > 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93,
> > 94, 95, 96, 97, 98, 99, 100)), row.names = c(NA, 101L), class =
> > "data.frame")
> > >
> >
> > >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.

From bgunter@4567 @end|ng |rom gm@||@com  Thu Dec 30 17:09:42 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 30 Dec 2021 08:09:42 -0800
Subject: [R] mixture univariate distributions fit
In-Reply-To: <f95d630111d44aa1ad9823501a4eef16@SRVEXCHCM1301.precheza.cz>
References: <42e04a96845c4c96a15da9d7e8044028@SRVEXCHCM1301.precheza.cz>
 <CAGxFJbTxasFj4+MpFZfngvHA_d_8BK41mknZzoSDFfq+Cxa6fg@mail.gmail.com>
 <f95d630111d44aa1ad9823501a4eef16@SRVEXCHCM1301.precheza.cz>
Message-ID: <CAGxFJbSnPeSPZSOudUZapg1V4waoG2A-DpnstE2FLZMMwUyCcw@mail.gmail.com>

Petr:

1. I now am somewhat confused by your goals. Any curve fitting
procedure can fit curves to data, including discrete points on a
smooth curve. What cannot be done is to recover the exact parameters
of the smooth curve from which your data derive, at least not without
knowing how the curve was fitted to that underlying (particle size)
data, i.e. the nature of the parameterization (if even there was one
-- it may just be some sort of empirical smoother like kernel density
estimation or some such).

2. mixtools uses EM, so the similarity you noted is probably not surprising.

3. Given my evident confusion, I hope that this email may prompt
someone more knowledgeable than I to correct or clarify my "advice."
You may wish to further clarify what you wish to do with the
parameters that you hope to get to encourage such comments. For
example, do you wish to compare the densities you get via their
parameterizations? If so, others may be able to offer better
strategies to do this, perhaps on SO --
https://stats.stackexchange.com/  -- rather than here.

Cheers,
Bert Gunter

On Thu, Dec 30, 2021 at 12:36 AM PIKAL Petr <petr.pikal at precheza.cz> wrote:
>
> Thank you Bert
>
> The values are results from particle size measurement by sedimentation and
> they are really available only as these cumulative or density distributions.
> What I thought about was that there is some package which could fit data of
> such curves and deliver parameters of fitted curves.
>
> Something like
> https://chrisostrouchov.com/post/peak_fit_xrd_python/
>
> I found package EMpeaksR which results close to values estimated from mixtools
> package.
>
> test <- spect_em_gmm(temp1$velik, temp1$proc, mu=c(170, 220),
> mix_ratio=c(1,1), sigma=c(5,5), maxit=2000, conv.cri=1e-8)
> print(cbind(test$mu, test$sigma, test$mix_ratio))
>          [,1]      [,2]      [,3]
> [1,] 170.7744  7.200109 0.5759867
> [2,] 229.1815 10.831626 0.4240133
>
> But it is probably in stage of intensive development as it is limited in data
> visualisation
>
> Any further hint is appreciated.
>
> Regards
> Petr
>
> > -----Original Message-----
> > From: Bert Gunter <bgunter.4567 at gmail.com>
> > Sent: Wednesday, December 29, 2021 5:01 PM
> > To: PIKAL Petr <petr.pikal at precheza.cz>
> > Cc: r-help mailing list <r-help at r-project.org>
> > Subject: Re: [R] mixture univariate distributions fit
> >
> > No.
> >
> > However, if the object returned is the "Value" structure of whatever density
> > function you use, it probably contains the original data. You need to check
> > the docs to see. But this does not appear to be your situation.
> >
> > Bert Gunter
> >
> > "The trouble with having an open mind is that people keep coming along and
> > sticking things into it."
> > -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> >
> > On Wed, Dec 29, 2021 at 3:05 AM PIKAL Petr <petr.pikal at precheza.cz>
> > wrote:
> > >
> > > Dear all
> > >
> > > I have data which are either density distribution estimate or
> > > cummulative density distribution estimate (temp1, temp2 below). I
> > > would like to get values (mu, sd) for underlaying original data but they
> > > are
> > not available.
> > >
> > > I found mixtools package which calculate what I need but it requires
> > > original data (AFAIK). They could be generated from e.g. temp1 by
> > >
> > > set.seed(111)
> > > x<- sample(temp1$velik, size=100000, replace=TRUE, prob=temp1$proc)
> > >
> > > library(mixtools)
> > > fit <- normalmixEM(x)
> > > plot(fit, which=2)
> > > summary(fit)
> > > summary of normalmixEM object:
> > >            comp 1     comp 2
> > > lambda   0.576346   0.423654
> > > mu     170.784520 229.192823
> > > sigma    7.203491  10.793461
> > > loglik at estimate:  -424062.7
> > > >
> > >
> > > Is there any way how to get such values directly from density or
> > > cummulative density estimation without generating fake data by sample?
> > >
> > > Best regards
> > > Petr
> > >
> > >
> > > temp1 <- structure(list(velik = c(155, 156.8, 157.9, 158.8, 159.6,
> > > 160.4, 161.2, 161.9, 162.5, 163.1, 163.8, 164.3, 164.7, 165.3, 165.8,
> > > 166.2, 166.7, 167.2, 167.7, 168.2, 168.7, 169.1, 169.6, 170.1, 170.6,
> > > 171.1, 171.6, 172, 172.5, 173, 173.5, 174, 174.5, 175.1, 175.7, 176.3,
> > > 177, 177.6, 178.3, 179.1, 179.9, 180.6, 181.4, 182.4, 183.5, 184.7,
> > > 186.1, 187.9, 189.8, 192, 194.4, 197, 200.1, 203.5, 206.7, 209.2,
> > > 211.3, 213.1, 214.8, 216.3, 217.4, 218.5, 219.5, 220.4, 221.3, 222.1,
> > > 223, 223.7, 224.5, 225.2, 225.9, 226.7, 227.5, 228.2, 228.9, 229.6,
> > > 230.4, 231.2, 231.9, 232.6, 233.4, 234.2, 235, 235.9, 236.8, 237.7,
> > > 238.6, 239.7, 241, 242.3, 243.6, 245.2, 247.1, 249.3, 251.9, 255.3,
> > > 260, 266, 274.9, 323.4 ), proc = c(0.6171, 1.583, 1.371, 2.13, 1.828,
> > > 2.095, 1.994, 2.694, 2.824, 2.41, 2.909, 3.768, 3.179, 3.029, 3.798,
> > > 3.743, 3.276, 3.213, 3.579, 2.928, 4.634, 3.415, 3.473, 3.135, 3.476,
> > > 3.759, 3.726, 3.9, 3.593, 2.89, 3.707, 4.08, 2.846, 2.685, 3.394,
> > > 2.737, 2.693, 2.878, 2.248, 2.368, 2.258, 2.662, 1.866, 1.895, 1.457,
> > > 1.513, 1.181, 1.008, 0.9641, 0.799, 0.7878, 0.7209, 0.5869, 0.5778,
> > > 0.7313, 0.9531, 1.053, 1.317, 1.247, 1.739, 2.064, 1.99, 2.522, 2.401,
> > > 2.48, 2.687, 2.797, 2.918, 3.243, 3.055, 3.009, 2.89, 3.037, 3.25,
> > > 3.349, 3.141, 2.771, 2.985, 3.203, 3.298, 3.215, 2.637, 2.683, 2.782,
> > > 2.632, 2.625, 2.475, 2.014, 1.781, 1.987, 1.627, 1.374, 1.352, 0.9441,
> > > 1.01, 0.5737, 0.5265, 0.3794, 0.2513, 0.0351)), row.names = 2:101,
> > > class = "data.frame")
> > >
> > > temp2 <- structure(list(velik = c(153.8, 156.3, 157.3, 158.4, 159.2,
> > > 160.1, 160.8, 161.6, 162.2, 162.8, 163.5, 164, 164.5, 165, 165.5, 166,
> > > 166.4, 166.9, 167.5, 167.9, 168.5, 168.9, 169.4, 169.8, 170.4, 170.9,
> > > 171.3, 171.8, 172.2, 172.7, 173.3, 173.8, 174.2, 174.8, 175.5, 176,
> > > 176.6, 177.3, 177.9, 178.7, 179.5, 180.3, 180.9, 181.9, 182.9, 184.1,
> > > 185.3, 186.9, 188.8, 190.8, 193.2, 195.6, 198.4, 201.8, 205.3, 208.1,
> > > 210.3, 212.3, 213.9, 215.7, 216.9, 218, 219.1, 219.9, 220.8, 221.7,
> > > 222.6, 223.4, 224.1, 224.8, 225.6, 226.3, 227.1, 227.8, 228.5, 229.2,
> > > 230, 230.8, 231.6, 232.3, 233, 233.7, 234.6, 235.5, 236.3, 237.2,
> > > 238.1, 239.1, 240.3, 241.6, 242.9, 244.4, 246.1, 248, 250.6, 253.1,
> > > 257.6, 262.5, 269.5, 280.4, 372.9), proc = c(0, 1, 2, 3, 4, 5, 6, 7,
> > > 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25,
> > > 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42,
> > > 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59,
> > > 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76,
> > > 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93,
> > > 94, 95, 96, 97, 98, 99, 100)), row.names = c(NA, 101L), class =
> > > "data.frame")
> > > >
> > >
> > > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide
> > > http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.


From y@ngk@|9999 @end|ng |rom y@hoo@com  Thu Dec 30 19:42:43 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Thu, 30 Dec 2021 18:42:43 +0000 (UTC)
Subject: [R] question about error message: "Aesthetics must be either length
 1 or the same as the data (226): y and colour"
References: <348174286.252195.1640889763384.ref@mail.yahoo.com>
Message-ID: <348174286.252195.1640889763384@mail.yahoo.com>

Hi R team,
I can create a plot using the code below:
library(ggplot2)
library(dplyr)
mpg %>%
? filter(hwy <35) %>%?
? ggplot(aes(x = displ, y = hwy, color = cyl)) +?
? geom_point()
ggsave("c:/temp/hwy_cyl.jpg",width = 9, height = 6, dpi = 1200, units = "in")


I want to do the exactly same work using function. Below is the function I created:
plot1 <- function(y, c, f){
? ? ? ? ? mpg %>%
? ? ? ? ? ? filter(hwy <35) %>%?
? ? ? ? ? ? ggplot(aes(x = displ, y = mpg[[y]], color = mpg[[c]] )) +?
? ? ? ? ? ? geom_point()??
? ? ? ? ? ggsave(paste0("c:/temp/", f ,".jpg"), width = 9, height = 6, dpi = 1200, units = "in")??
}?
plot1("hwy","cyl","hwy_cyl_f")

But I got error message when I run the code: "Aesthetics must be either length 1 or the same as the data (226): y and colour" . I checked online about the message. My understanding is: I need to add "fill" in geom_point() statement. My questions are:
1. is it possible to make the code work without add 'fill' in geom_point() statement, but keep the color as same as the first code??
2. if I must add 'fill' option in geom_point() statement, how to add them in? Should I add 266 colors name after 'fill'?
3. this is my first function in R, I'm sure there are many problems in the code. please point out my error in the code.


Thank you,
Kai

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Thu Dec 30 20:06:18 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 30 Dec 2021 11:06:18 -0800
Subject: [R] 
 question about error message: "Aesthetics must be either length
 1 or the same as the data (226): y and colour"
In-Reply-To: <348174286.252195.1640889763384@mail.yahoo.com>
References: <348174286.252195.1640889763384.ref@mail.yahoo.com>
 <348174286.252195.1640889763384@mail.yahoo.com>
Message-ID: <CAGxFJbTz-uX5KCKVzB=5N1w2bNSxtYxq77KkFRAxOdNh+RoaXw@mail.gmail.com>

1. Please read and follow the Posting Guide linked below. Among other
things, it says:

"For questions about functions in standard packages distributed with R
(see the FAQ Add-on packages in R), ask questions on R-help."
[The link is:
https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
This gives the list of current _standard_ packages]

"If the question relates to a contributed package [ggplot is such a
package] , e.g., one downloaded from CRAN, try contacting the package
maintainer first. You can also use find("functionname") and
packageDescription("packagename") to find this information. Only send
such questions to R-help or R-devel if you get no reply or need
further assistance. This applies to both requests for help and to bug
reports."

Note that RStudio maintains its own help resources at:
https://community.rstudio.com/
This is where questions about the TidyVerse, ggplot, etc. should be posted.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Thu, Dec 30, 2021 at 10:43 AM Kai Yang via R-help
<r-help at r-project.org> wrote:
>
> Hi R team,
> I can create a plot using the code below:
> library(ggplot2)
> library(dplyr)
> mpg %>%
>   filter(hwy <35) %>%
>   ggplot(aes(x = displ, y = hwy, color = cyl)) +
>   geom_point()
> ggsave("c:/temp/hwy_cyl.jpg",width = 9, height = 6, dpi = 1200, units = "in")
>
>
> I want to do the exactly same work using function. Below is the function I created:
> plot1 <- function(y, c, f){
>           mpg %>%
>             filter(hwy <35) %>%
>             ggplot(aes(x = displ, y = mpg[[y]], color = mpg[[c]] )) +
>             geom_point()
>           ggsave(paste0("c:/temp/", f ,".jpg"), width = 9, height = 6, dpi = 1200, units = "in")
> }
> plot1("hwy","cyl","hwy_cyl_f")
>
> But I got error message when I run the code: "Aesthetics must be either length 1 or the same as the data (226): y and colour" . I checked online about the message. My understanding is: I need to add "fill" in geom_point() statement. My questions are:
> 1. is it possible to make the code work without add 'fill' in geom_point() statement, but keep the color as same as the first code?
> 2. if I must add 'fill' option in geom_point() statement, how to add them in? Should I add 266 colors name after 'fill'?
> 3. this is my first function in R, I'm sure there are many problems in the code. please point out my error in the code.
>
>
> Thank you,
> Kai
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Dec 30 20:29:12 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 30 Dec 2021 19:29:12 +0000
Subject: [R] 
 question about error message: "Aesthetics must be either length
 1 or the same as the data (226): y and colour"
In-Reply-To: <348174286.252195.1640889763384@mail.yahoo.com>
References: <348174286.252195.1640889763384.ref@mail.yahoo.com>
 <348174286.252195.1640889763384@mail.yahoo.com>
Message-ID: <64c7f0bc-ad35-1574-d8ba-def9b64da3b8@sapo.pt>

Hello,

This seems like a repetition of a question you already asked and it has 
nothing to do with the fill aesthetic.

The error message is caused by the maps

y = mpg[[y]]
color = mpg[[c]]


First you filter the data keeping only a subset of the rows but now you 
are using the full data. This causes the error, the sizes of the 
filtered data and of the full data are not the same.


mpg %>% filter(hwy < 35) %>% dim()
#[1] 226  11

y <- "hwy"
length(mpg[[y]])
#[1] 234


If you pass a string as variable, you must ?get the variable value, like 
in the first function below, plot1.




plot1 <- function(y, c, f){
   mpg %>%
     filter(hwy <35) %>%
     ggplot(aes(x = displ, y = get(y), color = get(c))) +
     geom_point()
   ggsave(paste0("~/tmp/", f ,".jpg"), width = 9, height = 6, dpi = 
1200, units = "in")
}
plot1("hwy","cyl","hwy_cyl_f")




Or you can use aes_string. But since the x axis is fixed, not variable, 
pay attention to not mix a variable (displ) with variables' names (hwy 
and cyl). So in the next function I use aes() in the initial call to 
ggplot and aes_string in the geom_point layer.




plot2 <- function(y, c, f){
   mpg %>%
     filter(hwy <35) %>%
     ggplot(aes(x = displ)) +
     geom_point(aes_string(y = y, color = c))
   ggsave(paste0("~/tmp/", f ,".jpg"), width = 9, height = 6, dpi = 
1200, units = "in")
}
plot2("hwy","cyl","hwy_cyl_f2")



Hope this helps,

Rui Barradas

?s 18:42 de 30/12/21, Kai Yang via R-help escreveu:
> Hi R team,
> I can create a plot using the code below:
> library(ggplot2)
> library(dplyr)
> mpg %>%
>  ? filter(hwy <35) %>%
>  ? ggplot(aes(x = displ, y = hwy, color = cyl)) +
>  ? geom_point()
> ggsave("c:/temp/hwy_cyl.jpg",width = 9, height = 6, dpi = 1200, units = "in")
> 
> 
> I want to do the exactly same work using function. Below is the function I created:
> plot1 <- function(y, c, f){
>  ? ? ? ? ? mpg %>%
>  ? ? ? ? ? ? filter(hwy <35) %>%
>  ? ? ? ? ? ? ggplot(aes(x = displ, y = mpg[[y]], color = mpg[[c]] )) +
>  ? ? ? ? ? ? geom_point()
>  ? ? ? ? ? ggsave(paste0("c:/temp/", f ,".jpg"), width = 9, height = 6, dpi = 1200, units = "in")
> }
> plot1("hwy","cyl","hwy_cyl_f")
> 
> But I got error message when I run the code: "Aesthetics must be either length 1 or the same as the data (226): y and colour" . I checked online about the message. My understanding is: I need to add "fill" in geom_point() statement. My questions are:
> 1. is it possible to make the code work without add 'fill' in geom_point() statement, but keep the color as same as the first code?
> 2. if I must add 'fill' option in geom_point() statement, how to add them in? Should I add 266 colors name after 'fill'?
> 3. this is my first function in R, I'm sure there are many problems in the code. please point out my error in the code.
> 
> 
> Thank you,
> Kai
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From y@ngk@|9999 @end|ng |rom y@hoo@com  Fri Dec 31 01:11:56 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Fri, 31 Dec 2021 00:11:56 +0000 (UTC)
Subject: [R] 
 question about error message: "Aesthetics must be either length
 1 or the same as the data (226): y and colour"
In-Reply-To: <2ed868b1-1f51-43d6-a461-6d1b4b1a7c82@email.android.com>
References: <348174286.252195.1640889763384@mail.yahoo.com>
 <2ed868b1-1f51-43d6-a461-6d1b4b1a7c82@email.android.com>
Message-ID: <1841343128.302658.1640909516542@mail.yahoo.com>

 Thank you all of your help. I'm new in R. I'll follow Bert's and your suggestions to post the question in another area in future.?
Happy New Year
Kai
    On Thursday, December 30, 2021, 02:05:12 PM PST, CALUM POLWART <cpolwart at chemo.org.uk> wrote:  
 
 You will get shot down in flames for posting this here. This list is for base-R and your query is tidyverse related so belongs on somewhere tidy specific...
But...
mpg[[y]]
Is returning the column mpg[[y]] unfiltered but displ is filtered.
It would be possible to use mpg[[y]][ mpg$hwy<35]
But I suspect there is a better solution involving . As a data source or perhaps select to pick only the data you want...

On 30 Dec 2021 18:42, Kai Yang via R-help <r-help at r-project.org> wrote:


Hi R team,
I can create a plot using the code below:
library(ggplot2)
library(dplyr)
mpg %>%
? filter(hwy <35) %>%?
? ggplot(aes(x = displ, y = hwy, color = cyl)) +?
? geom_point()
ggsave("c:/temp/hwy_cyl.jpg",width = 9, height = 6, dpi = 1200, units = "in")


I want to do the exactly same work using function. Below is the function I created:
plot1 <- function(y, c, f){
? ? ? ? ? mpg %>%
? ? ? ? ? ? filter(hwy <35) %>%?
? ? ? ? ? ? ggplot(aes(x = displ, y = mpg[[y]], color = mpg[[c]] )) +?
? ? ? ? ? ? geom_point()??
? ? ? ? ? ggsave(paste0("c:/temp/", f ,".jpg"), width = 9, height = 6, dpi = 1200, units = "in")??
}?
plot1("hwy","cyl","hwy_cyl_f")

But I got error message when I run the code: "Aesthetics must be either length 1 or the same as the data (226): y and colour" . I checked online about the message. My understanding is: I need to add "fill" in geom_point() statement. My questions are:
1. is it possible to make the code work without add 'fill' in geom_point() statement, but keep the color as same as the first code??
2. if I must add 'fill' option in geom_point() statement, how to add them in? Should I add 266 colors name after 'fill'?
3. this is my first function in R, I'm sure there are many problems in the code. please point out my error in the code.


Thank you,
Kai

 [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.



  
	[[alternative HTML version deleted]]


From petr@p|k@| @end|ng |rom prechez@@cz  Fri Dec 31 08:59:11 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Fri, 31 Dec 2021 07:59:11 +0000
Subject: [R] mixture univariate distributions fit
In-Reply-To: <CAGxFJbSnPeSPZSOudUZapg1V4waoG2A-DpnstE2FLZMMwUyCcw@mail.gmail.com>
References: <42e04a96845c4c96a15da9d7e8044028@SRVEXCHCM1301.precheza.cz>
 <CAGxFJbTxasFj4+MpFZfngvHA_d_8BK41mknZzoSDFfq+Cxa6fg@mail.gmail.com>
 <f95d630111d44aa1ad9823501a4eef16@SRVEXCHCM1301.precheza.cz>
 <CAGxFJbSnPeSPZSOudUZapg1V4waoG2A-DpnstE2FLZMMwUyCcw@mail.gmail.com>
Message-ID: <08b00b524de748d28179321e8cf41145@SRVEXCHCM1301.precheza.cz>

Hallo Bert

Sorry for the confusion, I may not have used correct wording in describing 
what I wanted to do. Consider this example

# 2 different distribution densities mixed together in 1:2 proportion
x <- (0:100)/100
y1 <- dnorm((x, mean=.3, sd=.1)
y2 <- dnorm((x, mean=.7, sd=.1)
ymix <- ((y1+2*y2)/max(y1+2*y2))
plot((x, ymix)

# sampling  x based on mixed distribution density
dist <- sample((x, size=10000, replace=TRUE, prob=ymix)
library(mixtools)
fit <- normalmixEM(dist)
summary(fit)

summary of normalmixEM object:
         comp 1    comp 2
lambda 0.334926 0.6650742
mu     0.304862 0.7036926
sigma  0.098673 0.0994382
loglik at estimate:  30935.34

I can get estimation of mu and sigma together with proportion of each (lambda) 
distribution in mixture. My question is if there is some package or function 
which could get those values ***directly from x and ymix values***, which is 
basically what is measured in my case.

I know I could code some optimisation procedure and adopt what was done in 
Python https://chrisostrouchov.com/post/peak_fit_xrd_python/ for peak fitting 
or this one 
https://stats.stackexchange.com/questions/92748/multi-peak-gaussian-fit-in-r 
but I do not like to reinvent the wheel.

I went through Chemometrics and Computational Physics task view, which I 
consider most appropriate to have such functions but it is usually quite 
specific, especially in required input data form.

Anyway, thanks for your effort.

I wish you best for new year 2022.
Petr


> -----Original Message-----
> From: Bert Gunter <bgunter.4567 at gmail.com>
> Sent: Thursday, December 30, 2021 5:10 PM
> To: PIKAL Petr <petr.pikal at precheza.cz>
> Cc: r-help mailing list <r-help at r-project.org>
> Subject: Re: [R] mixture univariate distributions fit
>
> Petr:
>
> 1. I now am somewhat confused by your goals. Any curve fitting procedure
> can fit curves to data, including discrete points on a smooth curve. What
> cannot be done is to recover the exact parameters of the smooth curve from
> which your data derive, at least not without knowing how the curve was
> fitted to that underlying (particle size) data, i.e. the nature of the
> parameterization (if even there was one
> -- it may just be some sort of empirical smoother like kernel density
> estimation or some such).
>
> 2. mixtools uses EM, so the similarity you noted is probably not surprising.
>
> 3. Given my evident confusion, I hope that this email may prompt someone
> more knowledgeable than I to correct or clarify my "advice."
> You may wish to further clarify what you wish to do with the parameters that
> you hope to get to encourage such comments. For example, do you wish to
> compare the densities you get via their parameterizations? If so, others may
> be able to offer better strategies to do this, perhaps on SO --
> https://stats.stackexchange.com/  -- rather than here.
>
> Cheers,
> Bert Gunter
>
> On Thu, Dec 30, 2021 at 12:36 AM PIKAL Petr <petr.pikal at precheza.cz>
> wrote:
> >
> > Thank you Bert
> >
> > The values are results from particle size measurement by sedimentation
> > and they are really available only as these cumulative or density
> distributions.
> > What I thought about was that there is some package which could fit
> > data of such curves and deliver parameters of fitted curves.
> >
> > Something like
> > https://chrisostrouchov.com/post/peak_fit_xrd_python/
> >
> > I found package EMpeaksR which results close to values estimated from
> > mixtools package.
> >
> > test <- spect_em_gmm(temp1$velik, temp1$proc, mu=c(170, 220),
> > mix_ratio=c(1,1), sigma=c(5,5), maxit=2000, conv.cri=1e-8)
> > print(cbind(test$mu, test$sigma, test$mix_ratio))
> >          [,1]      [,2]      [,3]
> > [1,] 170.7744  7.200109 0.5759867
> > [2,] 229.1815 10.831626 0.4240133
> >
> > But it is probably in stage of intensive development as it is limited
> > in data visualisation
> >
> > Any further hint is appreciated.
> >
> > Regards
> > Petr
> >
> > > -----Original Message-----
> > > From: Bert Gunter <bgunter.4567 at gmail.com>
> > > Sent: Wednesday, December 29, 2021 5:01 PM
> > > To: PIKAL Petr <petr.pikal at precheza.cz>
> > > Cc: r-help mailing list <r-help at r-project.org>
> > > Subject: Re: [R] mixture univariate distributions fit
> > >
> > > No.
> > >
> > > However, if the object returned is the "Value" structure of whatever
> > > density function you use, it probably contains the original data.
> > > You need to check the docs to see. But this does not appear to be your
> situation.
> > >
> > > Bert Gunter
> > >
> > > "The trouble with having an open mind is that people keep coming
> > > along and sticking things into it."
> > > -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> > >
> > > On Wed, Dec 29, 2021 at 3:05 AM PIKAL Petr <petr.pikal at precheza.cz>
> > > wrote:
> > > >
> > > > Dear all
> > > >
> > > > I have data which are either density distribution estimate or
> > > > cummulative density distribution estimate (temp1, temp2 below). I
> > > > would like to get values (mu, sd) for underlaying original data
> > > > but they are
> > > not available.
> > > >
> > > > I found mixtools package which calculate what I need but it
> > > > requires original data (AFAIK). They could be generated from e.g.
> > > > temp1 by
> > > >
> > > > set.seed(111)
> > > > x<- sample(temp1$velik, size=100000, replace=TRUE,
> > > > prob=temp1$proc)
> > > >
> > > > library(mixtools)
> > > > fit <- normalmixEM(x)
> > > > plot(fit, which=2)
> > > > summary(fit)
> > > > summary of normalmixEM object:
> > > >            comp 1     comp 2
> > > > lambda   0.576346   0.423654
> > > > mu     170.784520 229.192823
> > > > sigma    7.203491  10.793461
> > > > loglik at estimate:  -424062.7
> > > > >
> > > >
> > > > Is there any way how to get such values directly from density or
> > > > cummulative density estimation without generating fake data by
> sample?
> > > >
> > > > Best regards
> > > > Petr
> > > >
> > > >
> > > > temp1 <- structure(list(velik = c(155, 156.8, 157.9, 158.8, 159.6,
> > > > 160.4, 161.2, 161.9, 162.5, 163.1, 163.8, 164.3, 164.7, 165.3,
> > > > 165.8, 166.2, 166.7, 167.2, 167.7, 168.2, 168.7, 169.1, 169.6,
> > > > 170.1, 170.6, 171.1, 171.6, 172, 172.5, 173, 173.5, 174, 174.5,
> > > > 175.1, 175.7, 176.3, 177, 177.6, 178.3, 179.1, 179.9, 180.6,
> > > > 181.4, 182.4, 183.5, 184.7, 186.1, 187.9, 189.8, 192, 194.4, 197,
> > > > 200.1, 203.5, 206.7, 209.2, 211.3, 213.1, 214.8, 216.3, 217.4,
> > > > 218.5, 219.5, 220.4, 221.3, 222.1, 223, 223.7, 224.5, 225.2,
> > > > 225.9, 226.7, 227.5, 228.2, 228.9, 229.6, 230.4, 231.2, 231.9,
> > > > 232.6, 233.4, 234.2, 235, 235.9, 236.8, 237.7, 238.6, 239.7, 241,
> > > > 242.3, 243.6, 245.2, 247.1, 249.3, 251.9, 255.3, 260, 266, 274.9,
> > > > 323.4 ), proc = c(0.6171, 1.583, 1.371, 2.13, 1.828, 2.095, 1.994,
> > > > 2.694, 2.824, 2.41, 2.909, 3.768, 3.179, 3.029, 3.798, 3.743,
> > > > 3.276, 3.213, 3.579, 2.928, 4.634, 3.415, 3.473, 3.135, 3.476,
> > > > 3.759, 3.726, 3.9, 3.593, 2.89, 3.707, 4.08, 2.846, 2.685, 3.394,
> > > > 2.737, 2.693, 2.878, 2.248, 2.368, 2.258, 2.662, 1.866, 1.895,
> > > > 1.457, 1.513, 1.181, 1.008, 0.9641, 0.799, 0.7878, 0.7209, 0.5869,
> > > > 0.5778, 0.7313, 0.9531, 1.053, 1.317, 1.247, 1.739, 2.064, 1.99,
> > > > 2.522, 2.401, 2.48, 2.687, 2.797, 2.918, 3.243, 3.055, 3.009,
> > > > 2.89, 3.037, 3.25, 3.349, 3.141, 2.771, 2.985, 3.203, 3.298,
> > > > 3.215, 2.637, 2.683, 2.782, 2.632, 2.625, 2.475, 2.014, 1.781,
> > > > 1.987, 1.627, 1.374, 1.352, 0.9441, 1.01, 0.5737, 0.5265, 0.3794,
> > > > 0.2513, 0.0351)), row.names = 2:101, class = "data.frame")
> > > >
> > > > temp2 <- structure(list(velik = c(153.8, 156.3, 157.3, 158.4,
> > > > 159.2, 160.1, 160.8, 161.6, 162.2, 162.8, 163.5, 164, 164.5, 165,
> > > > 165.5, 166, 166.4, 166.9, 167.5, 167.9, 168.5, 168.9, 169.4,
> > > > 169.8, 170.4, 170.9, 171.3, 171.8, 172.2, 172.7, 173.3, 173.8,
> > > > 174.2, 174.8, 175.5, 176, 176.6, 177.3, 177.9, 178.7, 179.5,
> > > > 180.3, 180.9, 181.9, 182.9, 184.1, 185.3, 186.9, 188.8, 190.8,
> > > > 193.2, 195.6, 198.4, 201.8, 205.3, 208.1, 210.3, 212.3, 213.9,
> > > > 215.7, 216.9, 218, 219.1, 219.9, 220.8, 221.7, 222.6, 223.4,
> > > > 224.1, 224.8, 225.6, 226.3, 227.1, 227.8, 228.5, 229.2, 230,
> > > > 230.8, 231.6, 232.3, 233, 233.7, 234.6, 235.5, 236.3, 237.2,
> > > > 238.1, 239.1, 240.3, 241.6, 242.9, 244.4, 246.1, 248, 250.6,
> > > > 253.1, 257.6, 262.5, 269.5, 280.4, 372.9), proc = c(0, 1, 2, 3, 4,
> > > > 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
> > > > 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38,
> > > > 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54,
> > > > 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70,
> > > > 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86,
> > > > 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100)),
> > > > row.names = c(NA, 101L), class =
> > > > "data.frame")
> > > > >
> > > >
> > > > >
> > > > ______________________________________________
> > > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > > PLEASE do read the posting guide
> > > > http://www.R-project.org/posting-guide.html
> > > > and provide commented, minimal, self-contained, reproducible code.

From kry|ov@r00t @end|ng |rom gm@||@com  Fri Dec 31 09:25:49 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 31 Dec 2021 11:25:49 +0300
Subject: [R] mixture univariate distributions fit
In-Reply-To: <08b00b524de748d28179321e8cf41145@SRVEXCHCM1301.precheza.cz>
References: <42e04a96845c4c96a15da9d7e8044028@SRVEXCHCM1301.precheza.cz>
 <CAGxFJbTxasFj4+MpFZfngvHA_d_8BK41mknZzoSDFfq+Cxa6fg@mail.gmail.com>
 <f95d630111d44aa1ad9823501a4eef16@SRVEXCHCM1301.precheza.cz>
 <CAGxFJbSnPeSPZSOudUZapg1V4waoG2A-DpnstE2FLZMMwUyCcw@mail.gmail.com>
 <08b00b524de748d28179321e8cf41145@SRVEXCHCM1301.precheza.cz>
Message-ID: <20211231112549.7bf51abb@Tarkus>

On Fri, 31 Dec 2021 07:59:11 +0000
PIKAL Petr <petr.pikal at precheza.cz> wrote:

> x <- (0:100)/100
> y1 <- dnorm((x, mean=.3, sd=.1)
> y2 <- dnorm((x, mean=.7, sd=.1)
> ymix <- ((y1+2*y2)/max(y1+2*y2))
 
> My question is if there is some package or function which could get
> those values ***directly from x and ymix values***, which is
> basically what is measured in my case.

Apologies if I'm missing something, but, this being a peak fitting
problem, shouldn't nls() (or something from the minpack.lm or nlsr
packages) work for you here?

minpack.lm::nlsLM(
 ymix ~ a1 * dnorm(x, mu1, sigma1) + a2 * dnorm(x, mu2, sigma2),
 start = c(a1 = 1, mu1 = 0, sigma1 = 1, a2 = 1, mu2 = 1, sigma2 = 1),
 lower = rep(0, 6) # help minpack avoid NaNs
)
# Nonlinear regression model
#  model: ymix ~ a1 * dnorm(x, mu1, sigma1) + a2 * dnorm(x, mu2, sigma2)
#  data: parent.frame()
#      a1    mu1 sigma1     a2    mu2 sigma2
#  0.1253 0.3000 0.1000 0.2506 0.7000 0.1000
# residual sum-of-squares: 1.289e-31
# 
# Number of iterations to convergence: 23 
# Achieved convergence tolerance: 1.49e-08

(Some nonlinear least squares problems will be much harder to solve
though.)

-- 
Best regards,
Ivan


From petr@p|k@| @end|ng |rom prechez@@cz  Fri Dec 31 10:48:52 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Fri, 31 Dec 2021 09:48:52 +0000
Subject: [R] mixture univariate distributions fit
In-Reply-To: <20211231112549.7bf51abb@Tarkus>
References: <42e04a96845c4c96a15da9d7e8044028@SRVEXCHCM1301.precheza.cz>
 <CAGxFJbTxasFj4+MpFZfngvHA_d_8BK41mknZzoSDFfq+Cxa6fg@mail.gmail.com>
 <f95d630111d44aa1ad9823501a4eef16@SRVEXCHCM1301.precheza.cz>
 <CAGxFJbSnPeSPZSOudUZapg1V4waoG2A-DpnstE2FLZMMwUyCcw@mail.gmail.com>
 <08b00b524de748d28179321e8cf41145@SRVEXCHCM1301.precheza.cz>
 <20211231112549.7bf51abb@Tarkus>
Message-ID: <09d639fe79ce44198db4c276dc726956@SRVEXCHCM1301.precheza.cz>

Hallo Ivan

Thanks. Yes, this approach seems to be viable. I did not consider using
dnorm in fitting procedure. But as you pointed

> (Some nonlinear least squares problems will be much harder to solve
> though.)

This simple example is quite easy. The more messy are data and the more
distributions are mixed in them the more problematic could be the correct
starting values selection. Errors could be quite common.

x <- (0:200)/100
y1 <- dnorm(x, mean=.3, sd=.1)
y2 <- dnorm(x, mean=.7, sd=.2)
y3 <- dnorm(x, mean=.5, sd=.1)

ymix <- ((y1+2*y2+y3)/max(y1+2*y2+y3))+rnorm(201, sd=.001)
plot(x, ymix)

With just sd1 and sd2 slightly higher, the fit results to error.
> fit <- minpack.lm::nlsLM(
+  ymix ~ a1 * dnorm(x, mu1, sd1) + a2 * dnorm(x, mu2, sd2)+
+  a3 * dnorm(x, mu3, sd3),
+  start = c(a1 = 1, mu1 = .3, sd1=.3, a2 = 2, mu2 = .7, sd2 =.3,
+  a3 = 1, mu3 = .5, sd3 = .1),
+  lower = rep(0, 9) # help minpack avoid NaNs
+ )
Error in nlsModel(formula, mf, start, wts) : 
  singular gradient matrix at initial parameter estimates

If sd1 and sd2 are set to lower value, the function is no longer singular
and arrives with result. 

Well, it seems that the  only way how to procced is to code such function by
myself and take care of suitable starting values. 

Best regards.
Petr

> -----Original Message-----
> From: Ivan Krylov <krylov.r00t at gmail.com>
> Sent: Friday, December 31, 2021 9:26 AM
> To: PIKAL Petr <petr.pikal at precheza.cz>
> Cc: r-help mailing list <r-help at r-project.org>
> Subject: Re: [R] mixture univariate distributions fit
> 
> On Fri, 31 Dec 2021 07:59:11 +0000
> PIKAL Petr <petr.pikal at precheza.cz> wrote:
> 
> > x <- (0:100)/100
> > y1 <- dnorm((x, mean=.3, sd=.1)
> > y2 <- dnorm((x, mean=.7, sd=.1)
> > ymix <- ((y1+2*y2)/max(y1+2*y2))
> 
> > My question is if there is some package or function which could get
> > those values ***directly from x and ymix values***, which is
> > basically what is measured in my case.
> 
> Apologies if I'm missing something, but, this being a peak fitting
> problem, shouldn't nls() (or something from the minpack.lm or nlsr
> packages) work for you here?
> 
> minpack.lm::nlsLM(
>  ymix ~ a1 * dnorm(x, mu1, sigma1) + a2 * dnorm(x, mu2, sigma2),
>  start = c(a1 = 1, mu1 = 0, sigma1 = 1, a2 = 1, mu2 = 1, sigma2 = 1),
>  lower = rep(0, 6) # help minpack avoid NaNs
> )
> # Nonlinear regression model
> #  model: ymix ~ a1 * dnorm(x, mu1, sigma1) + a2 * dnorm(x, mu2, sigma2)
> #  data: parent.frame()
> #      a1    mu1 sigma1     a2    mu2 sigma2
> #  0.1253 0.3000 0.1000 0.2506 0.7000 0.1000
> # residual sum-of-squares: 1.289e-31
> #
> # Number of iterations to convergence: 23
> # Achieved convergence tolerance: 1.49e-08
> 
> (Some nonlinear least squares problems will be much harder to solve
> though.)
> 
> --
> Best regards,
> Ivan

From r|ch@rd@k@ev@n@ @end|ng |rom n@@@@gov  Fri Dec 31 15:19:21 2021
From: r|ch@rd@k@ev@n@ @end|ng |rom n@@@@gov (Evans, Richard K. (GRC-H000))
Date: Fri, 31 Dec 2021 14:19:21 +0000
Subject: [R] Using R to convert RDF/XML to
Message-ID: <SA1PR09MB863839E04AF2C7B029F49F6DD4469@SA1PR09MB8638.namprd09.prod.outlook.com>

Hello R community,

I am a novice R enthusiast trying to use R to convert an RDFdump file [1] from Semantic Mediawiki [2] into something that can be natively imported by GePhi [3] for graph visualization. The SMW RDFdump file is formatted as RDF/XML and I have found the R package "rdflib" [4] and am able to read the RDF/XML file into R as an "rdf" object, but it is not clear to me how to save the "rdf_serialize" function output to a new file. 

What I have so far is: 
library(rdflib)
NewRDF <- tempfile( "TempFile", fileext = ".nq" )
MyRDF <- rdf_parse( "MyRDFdumpFile.txt" )
rdf_serialize( MyRDF, NewRDF, format = "nquads"  )
write_nquads( MyRDF, NewRDF ) 

..but this results in the error: "Error: object of type 'closure' is not subsettable"

I will keep struggling with this to learn what I need to learn, but any advice to help make quick work of this would be much appreciated. 

Thank you in advance.
/Rich

[1] https://www.semantic-mediawiki.org/wiki/Help:Maintenance_script_dumpRDF.php
[2] https://www.semantic-mediawiki.org/wiki/Help:Introduction_to_Semantic_MediaWiki
[3] https://gephi.org/
[4] https://cran.r-project.org/web/packages/rdflib/rdflib.pdf

- Richard Evans, NASA GRC - Armstrong Test Facility
  mailto://richard.k.evans at nasa.gov 
? http://www.linkedin.com/in/rkevans 


From w||||@mwdun|@p @end|ng |rom gm@||@com  Fri Dec 31 17:37:50 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Fri, 31 Dec 2021 08:37:50 -0800
Subject: [R] Using R to convert RDF/XML to
In-Reply-To: <SA1PR09MB863839E04AF2C7B029F49F6DD4469@SA1PR09MB8638.namprd09.prod.outlook.com>
References: <SA1PR09MB863839E04AF2C7B029F49F6DD4469@SA1PR09MB8638.namprd09.prod.outlook.com>
Message-ID: <CAHqSRuTG=mAn94njMA+8V6P+t6Wii_94BbSJWMWp=5v+pj9Pvg@mail.gmail.com>

This is the sort of thing that you should first ask the package maintainer
about; there is an error in the rdf method for write_nquads:

> rdflib:::write_nquads.rdf
function (x, file, ...)
{
    rdf_serialize(rdf, file, "nquads", ...)
}

I suspect that the first argument to rdf_serialize should be 'x', not 'rdf'.

Another error in the package is that this function isn't tested.

-Bill


On Fri, Dec 31, 2021 at 6:19 AM Evans, Richard K. (GRC-H000) via R-help <
r-help at r-project.org> wrote:

> Hello R community,
>
> I am a novice R enthusiast trying to use R to convert an RDFdump file [1]
> from Semantic Mediawiki [2] into something that can be natively imported by
> GePhi [3] for graph visualization. The SMW RDFdump file is formatted as
> RDF/XML and I have found the R package "rdflib" [4] and am able to read the
> RDF/XML file into R as an "rdf" object, but it is not clear to me how to
> save the "rdf_serialize" function output to a new file.
>
> What I have so far is:
> library(rdflib)
> NewRDF <- tempfile( "TempFile", fileext = ".nq" )
> MyRDF <- rdf_parse( "MyRDFdumpFile.txt" )
> rdf_serialize( MyRDF, NewRDF, format = "nquads"  )
> write_nquads( MyRDF, NewRDF )
>
> ..but this results in the error: "Error: object of type 'closure' is not
> subsettable"
>
> I will keep struggling with this to learn what I need to learn, but any
> advice to help make quick work of this would be much appreciated.
>
> Thank you in advance.
> /Rich
>
> [1]
> https://www.semantic-mediawiki.org/wiki/Help:Maintenance_script_dumpRDF.php
> [2]
> https://www.semantic-mediawiki.org/wiki/Help:Introduction_to_Semantic_MediaWiki
> [3] https://gephi.org/
> [4] https://cran.r-project.org/web/packages/rdflib/rdflib.pdf
>
> - Richard Evans, NASA GRC - Armstrong Test Facility
>   mailto://richard.k.evans at nasa.gov
>   http://www.linkedin.com/in/rkevans
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From k@p4||n @end|ng |rom gm@||@com  Fri Dec 31 18:38:25 2021
From: k@p4||n @end|ng |rom gm@||@com (kap4lin)
Date: Fri, 31 Dec 2021 12:38:25 -0500
Subject: [R] compiling from source on RedHat 8
Message-ID: <CAAu6L-GkXVdKLaepxgMq0gh5eEJgV3+wqzQs-BsPRkwWyKurTg@mail.gmail.com>

Hi,

Before I proceed with the error output, is this the right list for help on
compiling R from source. If not, please point me in the right direction.

The error itself is related to this:
https://stackoverflow.com/questions/53610178/installation-of-r-fails-because-of-undefined-reference-to-libiconv


Kap Lin

	[[alternative HTML version deleted]]


From m@rc_@chw@rtz @end|ng |rom me@com  Fri Dec 31 18:52:25 2021
From: m@rc_@chw@rtz @end|ng |rom me@com (Marc Schwartz)
Date: Fri, 31 Dec 2021 12:52:25 -0500
Subject: [R] compiling from source on RedHat 8
In-Reply-To: <CAAu6L-GkXVdKLaepxgMq0gh5eEJgV3+wqzQs-BsPRkwWyKurTg@mail.gmail.com>
References: <CAAu6L-GkXVdKLaepxgMq0gh5eEJgV3+wqzQs-BsPRkwWyKurTg@mail.gmail.com>
Message-ID: <d14c46b8-3873-8ef4-0b9a-e5cb93254e8d@me.com>

Hi,

I presume that you mean RHEL 8, and not just RH 8?

In either case, there is a list specifically for using R on RHEL/Fedora 
based Linux derivative distributions:

https://stat.ethz.ch/mailman/listinfo/r-sig-fedora

You should subscribe to that list and post your query there, as the 
RHEL/Fedora R maintainers are active on that list. They can give you 
guidance on compiling R from source, if you really need to do that, or 
to suggest that you use the existing RPMs for R that they maintain and 
make available.

Regards,

Marc Schwartz

kap4lin wrote on 12/31/21 12:38 PM:
> Hi,
>
> Before I proceed with the error output, is this the right list for help on
> compiling R from source. If not, please point me in the right direction.
>
> The error itself is related to this:
> https://stackoverflow.com/questions/53610178/installation-of-r-fails-because-of-undefined-reference-to-libiconv
>
>
> Kap Lin
>


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Dec 31 18:56:04 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 31 Dec 2021 09:56:04 -0800
Subject: [R] compiling from source on RedHat 8
In-Reply-To: <CAAu6L-GkXVdKLaepxgMq0gh5eEJgV3+wqzQs-BsPRkwWyKurTg@mail.gmail.com>
References: <CAAu6L-GkXVdKLaepxgMq0gh5eEJgV3+wqzQs-BsPRkwWyKurTg@mail.gmail.com>
Message-ID: <324D20EA-B244-4CD3-A6F1-6D682C824991@dcn.davis.ca.us>

Perhaps https://stat.ethz.ch/mailman/listinfo/r-sig-fedora ?

On December 31, 2021 9:38:25 AM PST, kap4lin <kap4lin at gmail.com> wrote:
>Hi,
>
>Before I proceed with the error output, is this the right list for help on
>compiling R from source. If not, please point me in the right direction.
>
>The error itself is related to this:
>https://stackoverflow.com/questions/53610178/installation-of-r-fails-because-of-undefined-reference-to-libiconv
>
>
>Kap Lin
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From k@p4||n @end|ng |rom gm@||@com  Fri Dec 31 18:56:29 2021
From: k@p4||n @end|ng |rom gm@||@com (Kap Lin)
Date: Fri, 31 Dec 2021 12:56:29 -0500
Subject: [R] compiling from source on RedHat 8
In-Reply-To: <d14c46b8-3873-8ef4-0b9a-e5cb93254e8d@me.com>
References: <CAAu6L-GkXVdKLaepxgMq0gh5eEJgV3+wqzQs-BsPRkwWyKurTg@mail.gmail.com>
 <d14c46b8-3873-8ef4-0b9a-e5cb93254e8d@me.com>
Message-ID: <CAAu6L-GE313eB2EWZo8knf0SrSx1-vYszvBBh=b2qT-S3mht=A@mail.gmail.com>

Thanks Marc, Jeff - will post there.

On Fri, Dec 31, 2021 at 12:52 PM Marc Schwartz <marc_schwartz at me.com> wrote:

> Hi,
>
> I presume that you mean RHEL 8, and not just RH 8?
>
> In either case, there is a list specifically for using R on RHEL/Fedora
> based Linux derivative distributions:
>
> https://stat.ethz.ch/mailman/listinfo/r-sig-fedora
>
> You should subscribe to that list and post your query there, as the
> RHEL/Fedora R maintainers are active on that list. They can give you
> guidance on compiling R from source, if you really need to do that, or
> to suggest that you use the existing RPMs for R that they maintain and
> make available.
>
> Regards,
>
> Marc Schwartz
>
> kap4lin wrote on 12/31/21 12:38 PM:
> > Hi,
> >
> > Before I proceed with the error output, is this the right list for help
> on
> > compiling R from source. If not, please point me in the right direction.
> >
> > The error itself is related to this:
> >
> https://stackoverflow.com/questions/53610178/installation-of-r-fails-because-of-undefined-reference-to-libiconv
> >
> >
> > Kap Lin
> >
>
>

-- 
Regards
Kap4Lin
--------------------------------------
http://counter.li.org  #402424

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Fri Dec 31 18:57:20 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 31 Dec 2021 09:57:20 -0800
Subject: [R] mixture univariate distributions fit
In-Reply-To: <09d639fe79ce44198db4c276dc726956@SRVEXCHCM1301.precheza.cz>
References: <42e04a96845c4c96a15da9d7e8044028@SRVEXCHCM1301.precheza.cz>
 <CAGxFJbTxasFj4+MpFZfngvHA_d_8BK41mknZzoSDFfq+Cxa6fg@mail.gmail.com>
 <f95d630111d44aa1ad9823501a4eef16@SRVEXCHCM1301.precheza.cz>
 <CAGxFJbSnPeSPZSOudUZapg1V4waoG2A-DpnstE2FLZMMwUyCcw@mail.gmail.com>
 <08b00b524de748d28179321e8cf41145@SRVEXCHCM1301.precheza.cz>
 <20211231112549.7bf51abb@Tarkus>
 <09d639fe79ce44198db4c276dc726956@SRVEXCHCM1301.precheza.cz>
Message-ID: <CAGxFJbQw074136DhPJFx_Lg_qNTiT_vy01REMrc8qguhHt1MVw@mail.gmail.com>

Petr:
Please feel free to ignore and not reply if you think the following
questions are unhelpful.

1. Do you want to know the location of peaks (local modes) or the
parameters of the/a mixture distribution? Peaks do not have to be
located at the modes of the individual components of the mixture.

2. Do you know the number of components in the mixture? This would
simplify the problem (a lot, I believe; though those more
knowledgeable should comment on that).

3. Do you know that the points on the fitted density you get are
obtained as a mixture of normals? Or  at least of symmetric
distributions? ... or whether they are obtained by some sort of
(algorithmic) density estimation procedure?

Best and New Year's greeting to all,
Bert



On Fri, Dec 31, 2021 at 1:49 AM PIKAL Petr <petr.pikal at precheza.cz> wrote:
>
> Hallo Ivan
>
> Thanks. Yes, this approach seems to be viable. I did not consider using
> dnorm in fitting procedure. But as you pointed
>
> > (Some nonlinear least squares problems will be much harder to solve
> > though.)
>
> This simple example is quite easy. The more messy are data and the more
> distributions are mixed in them the more problematic could be the correct
> starting values selection. Errors could be quite common.
>
> x <- (0:200)/100
> y1 <- dnorm(x, mean=.3, sd=.1)
> y2 <- dnorm(x, mean=.7, sd=.2)
> y3 <- dnorm(x, mean=.5, sd=.1)
>
> ymix <- ((y1+2*y2+y3)/max(y1+2*y2+y3))+rnorm(201, sd=.001)
> plot(x, ymix)
>
> With just sd1 and sd2 slightly higher, the fit results to error.
> > fit <- minpack.lm::nlsLM(
> +  ymix ~ a1 * dnorm(x, mu1, sd1) + a2 * dnorm(x, mu2, sd2)+
> +  a3 * dnorm(x, mu3, sd3),
> +  start = c(a1 = 1, mu1 = .3, sd1=.3, a2 = 2, mu2 = .7, sd2 =.3,
> +  a3 = 1, mu3 = .5, sd3 = .1),
> +  lower = rep(0, 9) # help minpack avoid NaNs
> + )
> Error in nlsModel(formula, mf, start, wts) :
>   singular gradient matrix at initial parameter estimates
>
> If sd1 and sd2 are set to lower value, the function is no longer singular
> and arrives with result.
>
> Well, it seems that the  only way how to procced is to code such function by
> myself and take care of suitable starting values.
>
> Best regards.
> Petr
>
> > -----Original Message-----
> > From: Ivan Krylov <krylov.r00t at gmail.com>
> > Sent: Friday, December 31, 2021 9:26 AM
> > To: PIKAL Petr <petr.pikal at precheza.cz>
> > Cc: r-help mailing list <r-help at r-project.org>
> > Subject: Re: [R] mixture univariate distributions fit
> >
> > On Fri, 31 Dec 2021 07:59:11 +0000
> > PIKAL Petr <petr.pikal at precheza.cz> wrote:
> >
> > > x <- (0:100)/100
> > > y1 <- dnorm((x, mean=.3, sd=.1)
> > > y2 <- dnorm((x, mean=.7, sd=.1)
> > > ymix <- ((y1+2*y2)/max(y1+2*y2))
> >
> > > My question is if there is some package or function which could get
> > > those values ***directly from x and ymix values***, which is
> > > basically what is measured in my case.
> >
> > Apologies if I'm missing something, but, this being a peak fitting
> > problem, shouldn't nls() (or something from the minpack.lm or nlsr
> > packages) work for you here?
> >
> > minpack.lm::nlsLM(
> >  ymix ~ a1 * dnorm(x, mu1, sigma1) + a2 * dnorm(x, mu2, sigma2),
> >  start = c(a1 = 1, mu1 = 0, sigma1 = 1, a2 = 1, mu2 = 1, sigma2 = 1),
> >  lower = rep(0, 6) # help minpack avoid NaNs
> > )
> > # Nonlinear regression model
> > #  model: ymix ~ a1 * dnorm(x, mu1, sigma1) + a2 * dnorm(x, mu2, sigma2)
> > #  data: parent.frame()
> > #      a1    mu1 sigma1     a2    mu2 sigma2
> > #  0.1253 0.3000 0.1000 0.2506 0.7000 0.1000
> > # residual sum-of-squares: 1.289e-31
> > #
> > # Number of iterations to convergence: 23
> > # Achieved convergence tolerance: 1.49e-08
> >
> > (Some nonlinear least squares problems will be much harder to solve
> > though.)
> >
> > --
> > Best regards,
> > Ivan
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


