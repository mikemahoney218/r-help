From bgunter@4567 @end|ng |rom gm@||@com  Thu Apr  1 00:42:38 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 31 Mar 2021 15:42:38 -0700
Subject: [R] FD package_dbFD error
In-Reply-To: <22acffee587bcf8377643dfd95ef2c5d@biol.pmf.hr>
References: <22acffee587bcf8377643dfd95ef2c5d@biol.pmf.hr>
Message-ID: <CAGxFJbSbt2qwyNNT5VnBsynDn572Ppbi2UHy_c8ERZk16+i9ug@mail.gmail.com>

I think you would more likely find the help you seek on the r-sig-ecology
list rather than here.

Also, do note per the posting guide linked below:

"For questions about functions in standard packages distributed with R (see
the FAQ Add-on packages in R
<https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R>), ask
questions on R-help.
If the question relates to a *contributed package* , e.g., one downloaded
from CRAN, try contacting the package maintainer first [who you can find
via ?maintainer]. You can also use find("functionname") and
packageDescription("packagename") to find this information. *Only* send
such questions to R-help or R-devel if you get no reply or need further
assistance. This applies to both requests for help and to bug reports."


Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Wed, Mar 31, 2021 at 3:32 PM Vesna Gulin <vesna.gulin at biol.pmf.hr> wrote:

> Hi everyone,
>
> I am trying to conduct dbFD from the FD package, but it keeps giving me
> the same error:
>
> ex1 <- dbFD(sites, traits)
> Error in dbFD(sites, traits) :
>    Different number of species in 'x' and 'a'.
>
> Ab, bb, Ci.... are species names.
> I have tried rewriting the species names so many times and ways, but
> nothing seems to work. I also checked for blank space but can't seem to
> find one. Does anyone have and idea what am I doing wrong?
>
> My data consists of two data frames:
> sites
>
>    X Ab Bb Ci Cb Cbm Cdo Cm Cdi Dv Edi Ee Ede Es Eb Gc La Mm Op Oc Oh Or
> Pgr Ps Pgi Pf Pgri Po Pp Rr Ss Sl Ts Tv Tr
> 1 A  0  0  0  0   0   0  1   0  0   0  0   0  1  0  0  0  1  0  0  0  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
> 2 B  0  0  0  0   0   0  0   0  0   0  0   0  1  0  0  0  0  2  0  0  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
> 3 C  0  0  0  0   0   0  0   0  0   0  0   0  0  0  0  0  0  0  0  0  0
>   0  0   0  0    0  1  0  0  0  0  0  0  0
> 4 D  0  0  0  0   0   0  0   0  0   0  0   0  0  0  0  0  0  0  0  0  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
> 5 E  0  0  0  0   0   0  0   3  2   3  0   0  0  0  0  0  0  0  0  4  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
> 6 F  0  0  0  0   0   0  0   0  3   0  1   0  0  4  1  8  0  1  3  2  0
>   0  0   0  0    0  0  0  0  0  0  0  0  2
> 7 G  0  0  0  0   0   0  1   1  1   2  0   0  0  0  0  0  0  0  1  4  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
>
> traits
>
>       X body    ration  flight     feeding       lifestyle     moisture
> 1    Ab 29.5 0.6203390    none herbivorous geo-chortobiont  xerophilous
> 2    Bb 16.0 1.0625000 reduced  omnivorous     chortobiont  mesophilous
> 3    Ci 23.5 0.5829787    full  omnivorous geo-chortobiont  xerophilous
> 4    Cb 18.0 0.6000000    full herbivorous     chortobiont  mesophilous
> 5   Cbm 18.0 0.6000000    full herbivorous     chortobiont  mesophilous
> 6   Cdo 17.5 0.6342857 reduced herbivorous     chortobiont  mesophilous
> 7    Cm 17.5 0.5914286    full herbivorous     chortobiont  mesophilous
> 8   Cdi 21.5 0.5883721 reduced herbivorous     chortobiont hygrophilous
> 9    Dv 34.0 0.9044118 reduced carnivorous geo-chortobiont  mesophilous
> 10  Edi 27.0 0.7222222    none  omnivorous     thamnobiont  xerophilous
> 11   Ee 25.0 0.6400000    none  omnivorous     thamnobiont  mesophilous
> 12  Ede 20.5 0.5902439    none herbivorous     chortobiont  xerophilous
> 13   Es 25.5 0.9803922    none  omnivorous     thamnobiont  mesophilous
> 14   Eb 18.0 0.6416667 reduced herbivorous     chortobiont  mesophilous
> 15   Gc 22.5 0.4555556    none  omnivorous        geobiont  mesophilous
> 16   La 13.0 0.9807692    none herbivorous     chortobiont  mesophilous
> 17   Mm 18.0 1.0972222    none  omnivorous geo-chortobiont  xerophilous
> 18   Op 12.0 0.6666667    full  omnivorous     thamnobiont  xerophilous
> 19   Oc 21.0 0.5690476    full herbivorous        geobiont  xerophilous
> 20   Oh 15.5 0.5967742 reduced herbivorous     chortobiont  mesophilous
> 21   Or 15.5 0.7193548 reduced herbivorous     chortobiont  mesophilous
> 22  Pgr 17.0 1.0588235    none  omnivorous     thamnobiont  mesophilous
> 23   Ps 21.5 1.0465116    none  omnivorous     thamnobiont  mesophilous
> 24  Pgi 14.0 0.5500000    none herbivorous     chortobiont  mesophilous
> 25   Pf 26.5 0.9622642    none  omnivorous     thamnobiont  mesophilous
> 26 Pgri 17.5 1.0428571    none  omnivorous     thamnobiont  mesophilous
> 27   Po 17.0 0.8970588    none herbivorous     chortobiont  mesophilous
> 28   Pp 17.5 0.6542857 reduced herbivorous     chortobiont  mesophilous
> 29   Rr 17.5 0.8857143 reduced  omnivorous     chortobiont  mesophilous
> 30   Ss 22.5 0.5733333    full herbivorous     chortobiont  mesophilous
> 31   Sl 20.5 0.6268293 reduced herbivorous     chortobiont  mesophilous
> 32   Ts 12.5 0.4720000 reduced herbivorous        geobiont hygrophilous
> 33   Tv 33.0 0.7803030    full carnivorous     thamnobiont  mesophilous
> 34   Tr 20.0 0.9000000    none  omnivorous        geobiont hygrophilous
>
>
> Thank you in advance and kind regards,
> Vesna
>
>
> --
> Vesna Gulin,  Research and Teaching Assistant
> Department of Biology
> Faculty of Science
> University of Zagreb
> Rooseveltov trg 6, 10000 Zagreb, Croatia
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From m@hmood@n@der@n @end|ng |rom ugent@be  Thu Apr  1 00:49:40 2021
From: m@hmood@n@der@n @end|ng |rom ugent@be (Mahmood Naderan-Tahan)
Date: Wed, 31 Mar 2021 22:49:40 +0000
Subject: [R] Controling the presentation of violin plot
Message-ID: <62007f9b632d49c1bfa8c12dbb1b44a5@ugent.be>

Hi,

With the following command, I get a messy violin plot which can be seen at https://pasteboard.co/JVdZKNz.jpg


p <- ggplot(mydata, aes(x=BE, y=INT)) + geom_violin(trim=FALSE)
p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)


It seems that the y-axis has a large scale and that causes the points to be shown with bad sizes.

Any way to fix that?



Regards,
Mahmood

	[[alternative HTML version deleted]]


From @@r@h@go@|ee @end|ng |rom gm@||@com  Thu Apr  1 00:58:09 2021
From: @@r@h@go@|ee @end|ng |rom gm@||@com (Sarah Goslee)
Date: Wed, 31 Mar 2021 18:58:09 -0400
Subject: [R] FD package_dbFD error
In-Reply-To: <22acffee587bcf8377643dfd95ef2c5d@biol.pmf.hr>
References: <22acffee587bcf8377643dfd95ef2c5d@biol.pmf.hr>
Message-ID: <CAM_vjunW6m274kKvEfs1gnVxwuuUktCBZptyd7RjoDNii60VeA@mail.gmail.com>

Hi,

While Bert is right that this would be a good question for
r-sig-ecology, I think you might have made a very simple-to-fix
mistake:

According to https://www.rdocumentation.org/packages/FD/versions/1.0-12/topics/dbFD
if you don't name the arguments, traits should come BEFORE sites.

If that doesn't help, take a look at the site and trait data frames
used in the examples and see if you can figure out where you went
wrong. If you can't, then try r-sig-ecology.

Sarah

On Wed, Mar 31, 2021 at 6:33 PM Vesna Gulin <vesna.gulin at biol.pmf.hr> wrote:
>
> Hi everyone,
>
> I am trying to conduct dbFD from the FD package, but it keeps giving me
> the same error:
>
> ex1 <- dbFD(sites, traits)
> Error in dbFD(sites, traits) :
>    Different number of species in 'x' and 'a'.
>
> Ab, bb, Ci.... are species names.
> I have tried rewriting the species names so many times and ways, but
> nothing seems to work. I also checked for blank space but can't seem to
> find one. Does anyone have and idea what am I doing wrong?
>
> My data consists of two data frames:
> sites
>
>    X Ab Bb Ci Cb Cbm Cdo Cm Cdi Dv Edi Ee Ede Es Eb Gc La Mm Op Oc Oh Or
> Pgr Ps Pgi Pf Pgri Po Pp Rr Ss Sl Ts Tv Tr
> 1 A  0  0  0  0   0   0  1   0  0   0  0   0  1  0  0  0  1  0  0  0  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
> 2 B  0  0  0  0   0   0  0   0  0   0  0   0  1  0  0  0  0  2  0  0  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
> 3 C  0  0  0  0   0   0  0   0  0   0  0   0  0  0  0  0  0  0  0  0  0
>   0  0   0  0    0  1  0  0  0  0  0  0  0
> 4 D  0  0  0  0   0   0  0   0  0   0  0   0  0  0  0  0  0  0  0  0  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
> 5 E  0  0  0  0   0   0  0   3  2   3  0   0  0  0  0  0  0  0  0  4  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
> 6 F  0  0  0  0   0   0  0   0  3   0  1   0  0  4  1  8  0  1  3  2  0
>   0  0   0  0    0  0  0  0  0  0  0  0  2
> 7 G  0  0  0  0   0   0  1   1  1   2  0   0  0  0  0  0  0  0  1  4  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
>
> traits
>
>       X body    ration  flight     feeding       lifestyle     moisture
> 1    Ab 29.5 0.6203390    none herbivorous geo-chortobiont  xerophilous
> 2    Bb 16.0 1.0625000 reduced  omnivorous     chortobiont  mesophilous
> 3    Ci 23.5 0.5829787    full  omnivorous geo-chortobiont  xerophilous
> 4    Cb 18.0 0.6000000    full herbivorous     chortobiont  mesophilous
> 5   Cbm 18.0 0.6000000    full herbivorous     chortobiont  mesophilous
> 6   Cdo 17.5 0.6342857 reduced herbivorous     chortobiont  mesophilous
> 7    Cm 17.5 0.5914286    full herbivorous     chortobiont  mesophilous
> 8   Cdi 21.5 0.5883721 reduced herbivorous     chortobiont hygrophilous
> 9    Dv 34.0 0.9044118 reduced carnivorous geo-chortobiont  mesophilous
> 10  Edi 27.0 0.7222222    none  omnivorous     thamnobiont  xerophilous
> 11   Ee 25.0 0.6400000    none  omnivorous     thamnobiont  mesophilous
> 12  Ede 20.5 0.5902439    none herbivorous     chortobiont  xerophilous
> 13   Es 25.5 0.9803922    none  omnivorous     thamnobiont  mesophilous
> 14   Eb 18.0 0.6416667 reduced herbivorous     chortobiont  mesophilous
> 15   Gc 22.5 0.4555556    none  omnivorous        geobiont  mesophilous
> 16   La 13.0 0.9807692    none herbivorous     chortobiont  mesophilous
> 17   Mm 18.0 1.0972222    none  omnivorous geo-chortobiont  xerophilous
> 18   Op 12.0 0.6666667    full  omnivorous     thamnobiont  xerophilous
> 19   Oc 21.0 0.5690476    full herbivorous        geobiont  xerophilous
> 20   Oh 15.5 0.5967742 reduced herbivorous     chortobiont  mesophilous
> 21   Or 15.5 0.7193548 reduced herbivorous     chortobiont  mesophilous
> 22  Pgr 17.0 1.0588235    none  omnivorous     thamnobiont  mesophilous
> 23   Ps 21.5 1.0465116    none  omnivorous     thamnobiont  mesophilous
> 24  Pgi 14.0 0.5500000    none herbivorous     chortobiont  mesophilous
> 25   Pf 26.5 0.9622642    none  omnivorous     thamnobiont  mesophilous
> 26 Pgri 17.5 1.0428571    none  omnivorous     thamnobiont  mesophilous
> 27   Po 17.0 0.8970588    none herbivorous     chortobiont  mesophilous
> 28   Pp 17.5 0.6542857 reduced herbivorous     chortobiont  mesophilous
> 29   Rr 17.5 0.8857143 reduced  omnivorous     chortobiont  mesophilous
> 30   Ss 22.5 0.5733333    full herbivorous     chortobiont  mesophilous
> 31   Sl 20.5 0.6268293 reduced herbivorous     chortobiont  mesophilous
> 32   Ts 12.5 0.4720000 reduced herbivorous        geobiont hygrophilous
> 33   Tv 33.0 0.7803030    full carnivorous     thamnobiont  mesophilous
> 34   Tr 20.0 0.9000000    none  omnivorous        geobiont hygrophilous
>
>
> Thank you in advance and kind regards,
> Vesna
>
>
> --
> Vesna Gulin,  Research and Teaching Assistant
> Department of Biology
> Faculty of Science
> University of Zagreb
> Rooseveltov trg 6, 10000 Zagreb, Croatia
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
Sarah Goslee (she/her)
http://www.numberwright.com


From chettyvk @end|ng |rom gm@||@com  Thu Apr  1 02:10:29 2021
From: chettyvk @end|ng |rom gm@||@com (Veerappa Chetty)
Date: Wed, 31 Mar 2021 20:10:29 -0400
Subject: [R] using MAP and PURR to compute characteristic roots
Message-ID: <CAFpsATYpxa8PvT0y7j8qOc+gGrkov=2sCaOU9VW0D6dwPiysHw@mail.gmail.com>

I have to compute characteristic roots for 100s of U.S.counties.  I got
help using " lapply". I prefer using MAP and PURR if that is possible. I am
using them to compute linear regressions.
Here is my test problem and the output. I would appreciate any help.
Thanks
V.K.Chetty
____
test.dat<- tibble(ID=c(1,2),a=c(1,1),b=c(1,1),c=c(2,2),d=c(4,3))
test.out<-test.dat %>% nest(-ID) %>% mutate(fit = purrr::map(data,~
function(x) eigen(data.matrix(x)), data=.))

I get this output:
> test.out$fit
[[1]]
function(x) eigen(data.matrix(x))
<environment: 0x0000017d35f00518>

[[2]]
function(x) eigen(data.matrix(x))
<environment: 0x0000017d35ef73d0>

	[[alternative HTML version deleted]]


From dw|n@em|u@ @end|ng |rom comc@@t@net  Thu Apr  1 02:42:11 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Wed, 31 Mar 2021 17:42:11 -0700
Subject: [R] using MAP and PURR to compute characteristic roots
In-Reply-To: <CAFpsATYpxa8PvT0y7j8qOc+gGrkov=2sCaOU9VW0D6dwPiysHw@mail.gmail.com>
References: <CAFpsATYpxa8PvT0y7j8qOc+gGrkov=2sCaOU9VW0D6dwPiysHw@mail.gmail.com>
Message-ID: <51e75345-b8fe-d1ff-d600-3554bfb18dd9@comcast.net>


On 3/31/21 5:10 PM, Veerappa Chetty wrote:
> I have to compute characteristic roots for 100s of U.S.counties.  I got
> help using " lapply". I prefer using MAP and PURR if that is possible. I am
> using them to compute linear regressions.
> Here is my test problem and the output. I would appreciate any help.
> Thanks
> V.K.Chetty
> ____
> test.dat<- tibble(ID=c(1,2),a=c(1,1),b=c(1,1),c=c(2,2),d=c(4,3))
> test.out<-test.dat %>% nest(-ID) %>% mutate(fit = purrr::map(data,~
> function(x) eigen(data.matrix(x)), data=.))


I think you will find that there is a bias on R-help toward using "base" 
R functions where it seems "natural". The venue where "tidyverse" 
solutions are typically returned is StackOverflow.)

It wasn't stated? clearly what you wanted from this. The `eigen` 
function returns a list object so the apply function neatly handles row 
based operations:


 > apply( test.dat[-1], 1, function(x){eigen(matrix(x,2))})
[[1]]
eigen() decomposition
$values
[1] 4.5615528 0.4384472

$vectors
 ?????????? [,1]?????? [,2]
[1,] -0.4896337 -0.9627697
[2,] -0.8719282? 0.2703230


[[2]]
eigen() decomposition
$values
[1] 3.7320508 0.2679492

$vectors
 ?????????? [,1]?????? [,2]
[1,] -0.5906905 -0.9390708
[2,] -0.8068982? 0.3437238


If you instead wanted only the eigenvalues you might have chosen to 
extract them at the time of the `eigen` call:


 ?apply( test.dat[-1], 1, function(x){eigen(matrix(x,2))$values})
 ????????? [,1]????? [,2]
[1,] 4.5615528 3.7320508
[2,] 0.4384472 0.2679492

Do note that the values are returned column-wise.

(I see that you noted in an earlier (duplicate) rhelp posting that you 
were expecting "younger" respondents. Since I'm in my eighth decade, I 
probably don't qualify.)


-- 

David Winsemius, MD


>
> I get this output:
>> test.out$fit
> [[1]]
> function(x) eigen(data.matrix(x))
> <environment: 0x0000017d35f00518>
>
> [[2]]
> function(x) eigen(data.matrix(x))
> <environment: 0x0000017d35ef73d0>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Apr  1 02:46:26 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 31 Mar 2021 17:46:26 -0700
Subject: [R] using MAP and PURR to compute characteristic roots
In-Reply-To: <CAFpsATYpxa8PvT0y7j8qOc+gGrkov=2sCaOU9VW0D6dwPiysHw@mail.gmail.com>
References: <CAFpsATYpxa8PvT0y7j8qOc+gGrkov=2sCaOU9VW0D6dwPiysHw@mail.gmail.com>
Message-ID: <528D658C-C7B8-4D48-9432-67DBB1B5B862@dcn.davis.ca.us>

Since purrr:map() is functionally identical to lapply, it is not at all clear to me what you are having trouble with. What output did you want?

On March 31, 2021 5:10:29 PM PDT, Veerappa Chetty <chettyvk at gmail.com> wrote:
>I have to compute characteristic roots for 100s of U.S.counties.  I got
>help using " lapply". I prefer using MAP and PURR if that is possible.
>I am
>using them to compute linear regressions.
>Here is my test problem and the output. I would appreciate any help.
>Thanks
>V.K.Chetty
>____
>test.dat<- tibble(ID=c(1,2),a=c(1,1),b=c(1,1),c=c(2,2),d=c(4,3))
>test.out<-test.dat %>% nest(-ID) %>% mutate(fit = purrr::map(data,~
>function(x) eigen(data.matrix(x)), data=.))
>
>I get this output:
>> test.out$fit
>[[1]]
>function(x) eigen(data.matrix(x))
><environment: 0x0000017d35f00518>
>
>[[2]]
>function(x) eigen(data.matrix(x))
><environment: 0x0000017d35ef73d0>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From drj|m|emon @end|ng |rom gm@||@com  Thu Apr  1 03:46:07 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Thu, 1 Apr 2021 12:46:07 +1100
Subject: [R] Controling the presentation of violin plot
In-Reply-To: <62007f9b632d49c1bfa8c12dbb1b44a5@ugent.be>
References: <62007f9b632d49c1bfa8c12dbb1b44a5@ugent.be>
Message-ID: <CA+8X3fVQ_BaYHxaLD_By70CG8YaGsu6nJr-NcFhy3MKkbd2R+g@mail.gmail.com>

Hi Mahmood,
As I don't know what "mydata" is, I'll have to fake it. Do you want
something like this?

yourdata<-data.frame(x1=c(1250,600,rep(200,9)),
 x2=c(7000,2300,800,rep(100,8)),
 x3=c(8900,950,300,rep(0,8)),
 x4=c(1400,1000,rep(600,4),rep(200,5)))
library(plotrix)
violin_plot(yourdata)

Jim

On Thu, Apr 1, 2021 at 9:53 AM Mahmood Naderan-Tahan
<mahmood.naderan at ugent.be> wrote:
>
> Hi,
>
> With the following command, I get a messy violin plot which can be seen at https://pasteboard.co/JVdZKNz.jpg
>
>
> p <- ggplot(mydata, aes(x=BE, y=INT)) + geom_violin(trim=FALSE)
> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)
>
>
> It seems that the y-axis has a large scale and that causes the points to be shown with bad sizes.
>
> Any way to fix that?
>
>
>
> Regards,
> Mahmood
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Apr  1 05:09:20 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 1 Apr 2021 04:09:20 +0100
Subject: [R] Controling the presentation of violin plot
In-Reply-To: <62007f9b632d49c1bfa8c12dbb1b44a5@ugent.be>
References: <62007f9b632d49c1bfa8c12dbb1b44a5@ugent.be>
Message-ID: <314abe3b-936f-5638-1726-697cb78db54c@sapo.pt>

Hello,

If the problem is the dots sizes, why not reduce it?
Below I have dotsize=0.5, half of yours.


p + geom_dotplot(binaxis='y', stackdir='center', dotsize=0.5)


Alternatively, plot the y axis in a log scale. Since there are zeros in 
the data, scales::pseudo_log_trans, will be used.

p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1) +
   scale_y_continuous(
     trans = scales::pseudo_log_trans(base = exp(1))
   )


Hope this helps,

Rui Barradas

?s 23:49 de 31/03/21, Mahmood Naderan-Tahan escreveu:
> Hi,
> 
> With the following command, I get a messy violin plot which can be seen at https://pasteboard.co/JVdZKNz.jpg
> 
> 
> p <- ggplot(mydata, aes(x=BE, y=INT)) + geom_violin(trim=FALSE)
> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)
> 
> 
> It seems that the y-axis has a large scale and that causes the points to be shown with bad sizes.
> 
> Any way to fix that?
> 
> 
> 
> Regards,
> Mahmood
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From m@hmood@n@der@n @end|ng |rom ugent@be  Thu Apr  1 07:52:38 2021
From: m@hmood@n@der@n @end|ng |rom ugent@be (Mahmood Naderan-Tahan)
Date: Thu, 1 Apr 2021 05:52:38 +0000
Subject: [R] Controling the presentation of violin plot
In-Reply-To: <314abe3b-936f-5638-1726-697cb78db54c@sapo.pt>
References: <62007f9b632d49c1bfa8c12dbb1b44a5@ugent.be>,
 <314abe3b-936f-5638-1726-697cb78db54c@sapo.pt>
Message-ID: <655283520c5743639f8d0ac319e18199@ugent.be>

>Alternatively, plot the y axis in a log scale. Since there are zeros in
>the data, scales::pseudo_log_trans, will be used.
>
>p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1) +
>   scale_y_continuous(
>     trans = scales::pseudo_log_trans(base = exp(1))
>   )



Yes that is a good hint. Thanks.


Regards,
Mahmood

________________________________
From: Rui Barradas <ruipbarradas at sapo.pt>
Sent: Thursday, April 1, 2021 5:09:20 AM
To: Mahmood Naderan-Tahan; r-help at r-project.org
Subject: Re: [R] Controling the presentation of violin plot

Hello,

If the problem is the dots sizes, why not reduce it?
Below I have dotsize=0.5, half of yours.


p + geom_dotplot(binaxis='y', stackdir='center', dotsize=0.5)


Alternatively, plot the y axis in a log scale. Since there are zeros in
the data, scales::pseudo_log_trans, will be used.

p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1) +
   scale_y_continuous(
     trans = scales::pseudo_log_trans(base = exp(1))
   )


Hope this helps,

Rui Barradas

?s 23:49 de 31/03/21, Mahmood Naderan-Tahan escreveu:
> Hi,
>
> With the following command, I get a messy violin plot which can be seen at https://pasteboard.co/JVdZKNz.jpg
>
>
> p <- ggplot(mydata, aes(x=BE, y=INT)) + geom_violin(trim=FALSE)
> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)
>
>
> It seems that the y-axis has a large scale and that causes the points to be shown with bad sizes.
>
> Any way to fix that?
>
>
>
> Regards,
> Mahmood
>
>        [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From m@hmood@n@der@n @end|ng |rom ugent@be  Thu Apr  1 08:00:37 2021
From: m@hmood@n@der@n @end|ng |rom ugent@be (Mahmood Naderan-Tahan)
Date: Thu, 1 Apr 2021 06:00:37 +0000
Subject: [R] Violin plot with mean_sdl
Message-ID: <315326e2411e4436aa5f64c171c4b1c7@ugent.be>

Hi,

I followed the example described at [1] but I don't know why I get the following warning


> library(ggplot2)
> library(Hmisc)
> mydata <- read.csv('test.csv', header=T,row.names=1)
> mydata
     V1  V2   V3 V4
P1 73.6 0.7 74.6  R
P2 75.2 0.7 75.8  R
P3  6.5 0.0  7.3  R
P4 41.4 0.3 39.2  C
P5  5.4 0.1 18.2  C
P6 18.8 0.3 30.3  C
> p <- ggplot(mydata, aes(x=V4, y=V1)) + geom_violin(trim=FALSE)
> p + stat_summary(fun.data="mean_sdl", mult=1,
+                  geom="crossbar", width=0.2 )
Warning message:
Ignoring unknown parameters: mult


How can I fix that?



[1] http://www.sthda.com/english/wiki/ggplot2-violin-plot-quick-start-guide-r-software-and-data-visualization


Regards,
Mahmood

	[[alternative HTML version deleted]]


From r_goertz @end|ng |rom web@de  Thu Apr  1 10:05:04 2021
From: r_goertz @end|ng |rom web@de (Ralf Goertz)
Date: Thu, 1 Apr 2021 10:05:04 +0200
Subject: [R] How can certain variables be automatically excluded from being
 saved?
Message-ID: <20210401100504.0a77696e@delli.fritz.box>

Hi,

after having read here about the "seed problem" I wonder if there is a
way to automatically exclude certain variables from being saved when the
workspace image is saved at the end of an interactive session. I have
been using .First() and .Last() for ages but apparently they are of no
help as .First() gets called before loading the workspace and .Last()
after it has been saved. At least the line

if (".Random.seed" %in% ls(all.names=T)) rm(.Random.seed, pos=1)

in either of those functions doesn't have the desired effect.


From drj|m|emon @end|ng |rom gm@||@com  Thu Apr  1 12:20:24 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Thu, 1 Apr 2021 21:20:24 +1100
Subject: [R] 
 How can certain variables be automatically excluded from being
 saved?
In-Reply-To: <20210401100504.0a77696e@delli.fritz.box>
References: <20210401100504.0a77696e@delli.fritz.box>
Message-ID: <CA+8X3fVEVHhhRTbQa8vGMF58S=qrwfsDx3-zDib8LoSz_zHk1w@mail.gmail.com>

Hi Ralph,
I suppose you could write a wrapper for q():

byebye<-function(drop=".Random.seed",save = "default", status = 0,
runLast = TRUE) {
 if(drop %in% ls(all.names=TRUE)) rm(drop,pos=1)
 q(save=save,status=status,runLast=runLast)
)

warning: untested

Jim

On Thu, Apr 1, 2021 at 7:05 PM Ralf Goertz <r_goertz at web.de> wrote:
>
> Hi,
>
> after having read here about the "seed problem" I wonder if there is a
> way to automatically exclude certain variables from being saved when the
> workspace image is saved at the end of an interactive session. I have
> been using .First() and .Last() for ages but apparently they are of no
> help as .First() gets called before loading the workspace and .Last()
> after it has been saved. At least the line
>
> if (".Random.seed" %in% ls(all.names=T)) rm(.Random.seed, pos=1)
>
> in either of those functions doesn't have the desired effect.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Apr  1 14:39:45 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 1 Apr 2021 08:39:45 -0400
Subject: [R] 
 How can certain variables be automatically excluded from being
 saved?
In-Reply-To: <20210401100504.0a77696e@delli.fritz.box>
References: <20210401100504.0a77696e@delli.fritz.box>
Message-ID: <c17e87e7-ee5a-6936-95ae-88af59d74ed9@gmail.com>

On 01/04/2021 4:05 a.m., Ralf Goertz wrote:
> Hi,
> 
> after having read here about the "seed problem" I wonder if there is a
> way to automatically exclude certain variables from being saved when the
> workspace image is saved at the end of an interactive session. I have
> been using .First() and .Last() for ages but apparently they are of no
> help as .First() gets called before loading the workspace and .Last()
> after it has been saved. At least the line
> 
> if (".Random.seed" %in% ls(all.names=T)) rm(.Random.seed, pos=1)
> 
> in either of those functions doesn't have the desired effect.

Jim suggested a way to do that, but I don't think it's really a good 
idea:  it just fixes one aspect of the problem, it doesn't solve the 
whole thing.

The real problem is saving the workspace occasionally, but always 
loading it.  The "always loading" part is automatic, so I think the real 
solution should address the "occasionally saving" part.

If you always save the workspace, things are fine.  You'll save the seed 
at the end of one session, and load it at the beginning of the next.

If you never save the workspace, things are also fine.  You'll always 
generate a new seed in each session that needs one.

Personally, I believe in the "never save it" workflow.  I think it has 
lots of benefits besides the random seed issue:  you won't get a 
more-and-more cluttered workspace over time, you end up with more 
reproducible results, etc.  However, I can understand that some people 
use a different workflow, so "always save it" is sometimes a reasonable 
choice.

So the real problem is the "sometimes save it" workflow, which is 
**encouraged** by the default q(save = "default") option, which asks 
when interactive.  Changing the default to act like q(save = "no") would 
be my preference (and that's how I configure things), but changing it to 
act like q(save = "yes") would be an improvement over the current choice.

Duncan Murdoch


From r_goertz @end|ng |rom web@de  Thu Apr  1 15:27:03 2021
From: r_goertz @end|ng |rom web@de (Ralf Goertz)
Date: Thu, 1 Apr 2021 15:27:03 +0200
Subject: [R] 
 How can certain variables be automatically excluded from being
 saved?
In-Reply-To: <c17e87e7-ee5a-6936-95ae-88af59d74ed9@gmail.com>
References: <20210401100504.0a77696e@delli.fritz.box>
 <c17e87e7-ee5a-6936-95ae-88af59d74ed9@gmail.com>
Message-ID: <20210401152703.50bb308e@delli.fritz.box>

Am Thu, 1 Apr 2021 08:39:45 -0400
schrieb Duncan Murdoch <murdoch.duncan at gmail.com>:

> On 01/04/2021 4:05 a.m., Ralf Goertz wrote:
> > Hi,
> >
> > after having read here about the "seed problem" I wonder if there
> > is a way to automatically exclude certain variables from being
> > saved when the workspace image is saved at the end of an
> > interactive session. I have been using .First() and .Last() for
> > ages but apparently they are of no help as .First() gets called
> > before loading the workspace and .Last() after it has been saved.
> > At least the line
> >
> > if (".Random.seed" %in% ls(all.names=T)) rm(.Random.seed, pos=1)
> >
> > in either of those functions doesn't have the desired effect.
>
> Jim suggested a way to do that, but I don't think it's really a good
> idea:  it just fixes one aspect of the problem, it doesn't solve the
> whole thing.
>
> The real problem is saving the workspace occasionally, but always
> loading it.  The "always loading" part is automatic, so I think the
> real solution should address the "occasionally saving" part.

Yes, that is exactly what I quite often do. I have to work in different
projects and I usually start R in the project directory. When I do
serious stuff I save afterwards. But quite often I want to check
something quickly and then I don't want to clutter up my workspace.

> If you always save the workspace, things are fine.  You'll save the
> seed at the end of one session, and load it at the beginning of the
> next.
>
> If you never save the workspace, things are also fine.  You'll always
> generate a new seed in each session that needs one.
>
> Personally, I believe in the "never save it" workflow.  I think it
> has lots of benefits besides the random seed issue:  you won't get a
> more-and-more cluttered workspace over time, you end up with more
> reproducible results, etc.  However, I can understand that some
> people use a different workflow, so "always save it" is sometimes a
> reasonable choice.
>
> So the real problem is the "sometimes save it" workflow, which is
> **encouraged** by the default q(save = "default") option, which asks
> when interactive.  Changing the default to act like q(save = "no")
> would be my preference (and that's how I configure things), but
> changing it to act like q(save = "yes") would be an improvement over
> the current choice.

I would prefer to be able to only save the history since that is where
the work is done. Usually, my data is easily restored using commands
from the history. I could probably accomplish that by linking .RData to
/dev/null or making it an empty readonly file. However, I would have to
do that in every directory I happen to use R in.


From ve@n@@gu||n @end|ng |rom b|o|@pm|@hr  Thu Apr  1 10:33:00 2021
From: ve@n@@gu||n @end|ng |rom b|o|@pm|@hr (Vesna Gulin)
Date: Thu, 01 Apr 2021 10:33:00 +0200
Subject: [R] FD package_dbFD error
In-Reply-To: <CAM_vjunW6m274kKvEfs1gnVxwuuUktCBZptyd7RjoDNii60VeA@mail.gmail.com>
References: <22acffee587bcf8377643dfd95ef2c5d@biol.pmf.hr>
 <CAM_vjunW6m274kKvEfs1gnVxwuuUktCBZptyd7RjoDNii60VeA@mail.gmail.com>
Message-ID: <e52d188288b67e7669a69ac435efe42e@biol.pmf.hr>

Hi Sara,

Thank you for your advice and apologies for spamming.

I will try to reorganise the arguments and if it doesn't work, will try 
r-sig-ecology.

Kind regards,
Vesna

On 2021-04-01 0:58, Sarah Goslee wrote:
> Hi,
> 
> While Bert is right that this would be a good question for
> r-sig-ecology, I think you might have made a very simple-to-fix
> mistake:
> 
> According to
> https://www.rdocumentation.org/packages/FD/versions/1.0-12/topics/dbFD
> if you don't name the arguments, traits should come BEFORE sites.
> 
> If that doesn't help, take a look at the site and trait data frames
> used in the examples and see if you can figure out where you went
> wrong. If you can't, then try r-sig-ecology.
> 
> Sarah
> 
> On Wed, Mar 31, 2021 at 6:33 PM Vesna Gulin <vesna.gulin at biol.pmf.hr> 
> wrote:
>> 
>> Hi everyone,
>> 
>> I am trying to conduct dbFD from the FD package, but it keeps giving 
>> me
>> the same error:
>> 
>> ex1 <- dbFD(sites, traits)
>> Error in dbFD(sites, traits) :
>>    Different number of species in 'x' and 'a'.
>> 
>> Ab, bb, Ci.... are species names.
>> I have tried rewriting the species names so many times and ways, but
>> nothing seems to work. I also checked for blank space but can't seem 
>> to
>> find one. Does anyone have and idea what am I doing wrong?
>> 
>> My data consists of two data frames:
>> sites
>> 
>>    X Ab Bb Ci Cb Cbm Cdo Cm Cdi Dv Edi Ee Ede Es Eb Gc La Mm Op Oc Oh 
>> Or
>> Pgr Ps Pgi Pf Pgri Po Pp Rr Ss Sl Ts Tv Tr
>> 1 A  0  0  0  0   0   0  1   0  0   0  0   0  1  0  0  0  1  0  0  0  
>> 0
>>   0  0   0  0    0  0  0  0  0  0  0  0  0
>> 2 B  0  0  0  0   0   0  0   0  0   0  0   0  1  0  0  0  0  2  0  0  
>> 0
>>   0  0   0  0    0  0  0  0  0  0  0  0  0
>> 3 C  0  0  0  0   0   0  0   0  0   0  0   0  0  0  0  0  0  0  0  0  
>> 0
>>   0  0   0  0    0  1  0  0  0  0  0  0  0
>> 4 D  0  0  0  0   0   0  0   0  0   0  0   0  0  0  0  0  0  0  0  0  
>> 0
>>   0  0   0  0    0  0  0  0  0  0  0  0  0
>> 5 E  0  0  0  0   0   0  0   3  2   3  0   0  0  0  0  0  0  0  0  4  
>> 0
>>   0  0   0  0    0  0  0  0  0  0  0  0  0
>> 6 F  0  0  0  0   0   0  0   0  3   0  1   0  0  4  1  8  0  1  3  2  
>> 0
>>   0  0   0  0    0  0  0  0  0  0  0  0  2
>> 7 G  0  0  0  0   0   0  1   1  1   2  0   0  0  0  0  0  0  0  1  4  
>> 0
>>   0  0   0  0    0  0  0  0  0  0  0  0  0
>> 
>> traits
>> 
>>       X body    ration  flight     feeding       lifestyle     
>> moisture
>> 1    Ab 29.5 0.6203390    none herbivorous geo-chortobiont  
>> xerophilous
>> 2    Bb 16.0 1.0625000 reduced  omnivorous     chortobiont  
>> mesophilous
>> 3    Ci 23.5 0.5829787    full  omnivorous geo-chortobiont  
>> xerophilous
>> 4    Cb 18.0 0.6000000    full herbivorous     chortobiont  
>> mesophilous
>> 5   Cbm 18.0 0.6000000    full herbivorous     chortobiont  
>> mesophilous
>> 6   Cdo 17.5 0.6342857 reduced herbivorous     chortobiont  
>> mesophilous
>> 7    Cm 17.5 0.5914286    full herbivorous     chortobiont  
>> mesophilous
>> 8   Cdi 21.5 0.5883721 reduced herbivorous     chortobiont 
>> hygrophilous
>> 9    Dv 34.0 0.9044118 reduced carnivorous geo-chortobiont  
>> mesophilous
>> 10  Edi 27.0 0.7222222    none  omnivorous     thamnobiont  
>> xerophilous
>> 11   Ee 25.0 0.6400000    none  omnivorous     thamnobiont  
>> mesophilous
>> 12  Ede 20.5 0.5902439    none herbivorous     chortobiont  
>> xerophilous
>> 13   Es 25.5 0.9803922    none  omnivorous     thamnobiont  
>> mesophilous
>> 14   Eb 18.0 0.6416667 reduced herbivorous     chortobiont  
>> mesophilous
>> 15   Gc 22.5 0.4555556    none  omnivorous        geobiont  
>> mesophilous
>> 16   La 13.0 0.9807692    none herbivorous     chortobiont  
>> mesophilous
>> 17   Mm 18.0 1.0972222    none  omnivorous geo-chortobiont  
>> xerophilous
>> 18   Op 12.0 0.6666667    full  omnivorous     thamnobiont  
>> xerophilous
>> 19   Oc 21.0 0.5690476    full herbivorous        geobiont  
>> xerophilous
>> 20   Oh 15.5 0.5967742 reduced herbivorous     chortobiont  
>> mesophilous
>> 21   Or 15.5 0.7193548 reduced herbivorous     chortobiont  
>> mesophilous
>> 22  Pgr 17.0 1.0588235    none  omnivorous     thamnobiont  
>> mesophilous
>> 23   Ps 21.5 1.0465116    none  omnivorous     thamnobiont  
>> mesophilous
>> 24  Pgi 14.0 0.5500000    none herbivorous     chortobiont  
>> mesophilous
>> 25   Pf 26.5 0.9622642    none  omnivorous     thamnobiont  
>> mesophilous
>> 26 Pgri 17.5 1.0428571    none  omnivorous     thamnobiont  
>> mesophilous
>> 27   Po 17.0 0.8970588    none herbivorous     chortobiont  
>> mesophilous
>> 28   Pp 17.5 0.6542857 reduced herbivorous     chortobiont  
>> mesophilous
>> 29   Rr 17.5 0.8857143 reduced  omnivorous     chortobiont  
>> mesophilous
>> 30   Ss 22.5 0.5733333    full herbivorous     chortobiont  
>> mesophilous
>> 31   Sl 20.5 0.6268293 reduced herbivorous     chortobiont  
>> mesophilous
>> 32   Ts 12.5 0.4720000 reduced herbivorous        geobiont 
>> hygrophilous
>> 33   Tv 33.0 0.7803030    full carnivorous     thamnobiont  
>> mesophilous
>> 34   Tr 20.0 0.9000000    none  omnivorous        geobiont 
>> hygrophilous
>> 
>> 
>> Thank you in advance and kind regards,
>> Vesna
>> 
>> 
>> --
>> Vesna Gulin,  Research and Teaching Assistant
>> Department of Biology
>> Faculty of Science
>> University of Zagreb
>> Rooseveltov trg 6, 10000 Zagreb, Croatia
>> 
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From w|@e_co|em@n @end|ng |rom y@hoo@com  Thu Apr  1 13:23:37 2021
From: w|@e_co|em@n @end|ng |rom y@hoo@com (Collins Boahen)
Date: Thu, 1 Apr 2021 11:23:37 +0000 (UTC)
Subject: [R] pie3D.labels
In-Reply-To: <CA+8X3fWDw39DrC5UughXNY2N+G2mHby2iFmYgGxU7EuW2QA_Fg@mail.gmail.com>
References: <279211430.1963047.1617108166917.ref@mail.yahoo.com>
 <279211430.1963047.1617108166917@mail.yahoo.com>
 <CA+8X3fWDw39DrC5UughXNY2N+G2mHby2iFmYgGxU7EuW2QA_Fg@mail.gmail.com>
Message-ID: <2032838816.2977186.1617276217366@mail.yahoo.com>

 Dear Dr. Lemon,
Thank you for the rapid response and suggestions as well.
BestCollins
    On Tuesday, March 30, 2021, 11:46:08 PM GMT+2, Jim Lemon <drjimlemon at gmail.com> wrote:  
 
 Hi Collins,
pie3D draws a pseudo-3D pie and then places 2D labels around it. If
you put the labels on top of the pie, it is not going to look right.
The labels will be displayed with an orthogonal viewing angle, while
the pie will be tilted. pie3D is one of those functions that I wrote
for those who might otherwise think that if R can't produce 3D pie
charts, then R is no good. You can do fulsomely decorative plots in R,
and if your boss demands a 3D pie chart, you can do it. If you really
want to create a 3D pie chart with 3D labels, do it with a 3D
rendering program like POVray. I'm afraid that I don't have the time
to provide you with an example right now.

Jim

On Tue, Mar 30, 2021 at 11:42 PM Collins Boahen <wise_coleman at yahoo.com> wrote:
>
> Dear Dr. Lemon,
>
> Thank you for developing such a fantastic package.
>
> I would like to find out if there is a way to insert the labels inside the pie and? manipulate the labels for fit perfectly.
>
> Please any tips or suggestions will be appreciated.
>
> Thank you
>
> Best
> Collins
>
  
	[[alternative HTML version deleted]]


From bend|x@c@r@ten@en @end|ng |rom reg|onh@dk  Thu Apr  1 15:00:21 2021
From: bend|x@c@r@ten@en @end|ng |rom reg|onh@dk (Bendix Carstensen)
Date: Thu, 1 Apr 2021 13:00:21 +0000
Subject: [R] cox.zph
Message-ID: <AM4PR08MB2674993040E72279B6216E3C9D7B9@AM4PR08MB2674.eurprd08.prod.outlook.com>

Further to John Sorkin's post on the cox.zph:
You get test(s) of whether there is an interaction between a variable, say, sex, and time.

Suppose it is significant. You will have no clue whether the M/W hazard ratio is increasing or decreasing by time.

Suppose it is not significant. You will have no clue whether the (non-significant) M/W hazrad ratio exhibits a pattern that is worth looking further into or not.

In this sense the cox.zph is a perfect tool to allow you to write 'we checked for non proportionality' instead of 'we have no clue of how the M/W ratio varies by time'.

If you label it what it is, namely a test of interaction, you might realize that you should ESTIMATE the shape and size of the interaction before deriving a test, either ad-hoc by the Shoenfeld residuals or by proper modeling.

See for example pp 202 ff. in 'Epidemiology with R' by (surprise, surprise) me, published by OUP a few months ago.

b.r.
Bendix Carstensen
Senior Statistician
Steno Diabetes Center Copenhagen
Clinical Epidemiology
Niels Steensens Vej 2-4
DK-2820 Gentofte
Denmark
tel: +45 30 91 29 61
b at bxc.dk
bendix.carstensen at regionh.dk
http://BendixCarstensen.com


________________________________


Region Hovedstaden anvender de personoplysninger, du giver os i forbindelse med din henvendelse. Du kan l?se mere om form?let med anvendelsen samt dine rettigheder p? vores hjemmeside: www.regionh.dk/persondatapolitik


From m@015k3113 @end|ng |rom b|ueyonder@co@uk  Thu Apr  1 17:10:13 2021
From: m@015k3113 @end|ng |rom b|ueyonder@co@uk (e-mail ma015k3113)
Date: Thu, 1 Apr 2021 16:10:13 +0100 (BST)
Subject: [R] 
 [EXT] Calculating the total change in shareprice over a time periond
In-Reply-To: <5c173bf0-3a48-ebb4-a8a6-5b2d99410ee6@usu.edu>
References: <63365987.939790.1617210292526@mail2.virginmedia.com>
 <5c173bf0-3a48-ebb4-a8a6-5b2d99410ee6@usu.edu>
Message-ID: <2120722153.1003459.1617289813954@mail2.virginmedia.com>

Dear David, thanks so much for your time and suggestion. It has worked now.

Kind regards

Ahson
> On 31 March 2021 at 19:17 David K Stevens <david.stevens at usu.edu> wrote:
> 
> 
> Mr. Blueyonder,
> 
> There are a number of problems with this.
> 
> 1) is the data below really in a data frame? I coerced your table into a 
> data frame, guessing at the structure and when I print out the 1st three 
> rows I get an alignment into proper columns
> 
> COMPANY_NUMBER COMPANY_NAME??????????????? CITY YEAR_END_DATE 
> CLOSE_SHARE_PRICE
> 1?????????? 22705? CARDIFF PROPERTY PUBLIC LIMITED COMPANY????????? 
> (THE)Egham??? 30/09/2005??????????????? NA
> 2?????????? 22705? CARDIFF PROPERTY PUBLIC LIMITED COMPANY????????? 
> (THE)Egham??? 30/09/2006??????????????? NA
> 3?????????? 22705? CARDIFF PROPERTY PUBLIC LIMITED COMPANY????????? 
> (THE)Egham??? 30/09/2007????????????? 9.65
> 
> I'd guess that your PLC is actually a 1 column data frame based on how 
> you present it. Because what you gave is so small, I just added commas 
> where they seemed suitable and used
> 
> PLC <- read.csv(file='clipboard',header=T,stringsAsFactors = T)
> 
> to create the data frame above. It's likely that your actual problem is 
> much larger so I'd export the data as a CSV file, and read it into R in 
> a similar way using
> 
> PLC <- read.csv(file='myfile.csv',header=T,stringsAsFactors = T)
> 
> 2) Your code is incorrect as is for two reasons. a) for your approach to 
> work, you'll need to create an empty column CH_SH_PRICE before running 
> the loop, because your loop is trying to place data into a non-existent 
> column b) the code PLC$CH_SH_PRICE(i+1) has to use square brackets, 
> otherwise R thinks PCL$CH_SH_PRICE is a function rather than a reference 
> to column element i+1 as in PLC$CH_SH_PRICE[i+1]
> 
> Also, the functionisTRUE is actually the following
> 
> function (x)
> is.logical(x) && length(x) == 1L && !is.na(x) && x
> 
> Is this really what you want to do, rather than just checking the 
> company number, as inPLC[i,1] == PLC[i+1,1]?
> 
> Assuming (tentatively) I guessed right, here's what I got
> 
> COMPANY_NUMBER??????????????????????????? COMPANY_NAME CITY 
> YEAR_END_DATE CLOSE_SHARE_PRICE CH_SH_PRICE
> 1????????? 22705 CARDIFF PROPERTY PUBLIC LIMITED COMPANY (THE)Egham??? 
> 30/09/2005??????????????? NA????????? NA
> 2????????? 22705 CARDIFF PROPERTY PUBLIC LIMITED COMPANY (THE)Egham??? 
> 30/09/2006??????????????? NA????????? NA
> 3????????? 22705 CARDIFF PROPERTY PUBLIC LIMITED COMPANY (THE)Egham??? 
> 30/09/2007????????????? 9.65????????? NA
> 4????????? 22705 CARDIFF PROPERTY PUBLIC LIMITED COMPANY (THE)Egham??? 
> 30/09/2008????????????? 6.55?????? -3.10
> 
> Good luck.
> 
> David Stevens
> 
> On 3/31/2021 11:04 AM, e-mail ma015k3113 via R-help wrote:
> > Dear All, I have a data frame which is structured as follows:
> >
> >
> > COMPANY_NUMBER  COMPANY_NAME    CITY    YEAR_END_DATE   CLOSE_SHARE_PRICE
> > 22705   CARDIFF PROPERTY PUBLIC LIMITED COMPANY         (THE)Egham      30/09/2005      NA
> > 22705   CARDIFF PROPERTY PUBLIC LIMITED COMPANY         (THE)Egham      30/09/2006      NA
> > 22705   CARDIFF PROPERTY PUBLIC LIMITED COMPANY         (THE)Egham      30/09/2007      9.65
> > 22705   CARDIFF PROPERTY PUBLIC LIMITED COMPANY         (THE)Egham      30/09/2008      6.55
> > 22705   CARDIFF PROPERTY PUBLIC LIMITED COMPANY         (THE)Egham      30/09/2009      6.55
> > 22705   CARDIFF PROPERTY PUBLIC LIMITED COMPANY         (THE)Egham      30/09/2010      7.5
> > 10395804        TOC PROPERTY BACKED LENDING TRUST PLC   Newcastle Upon Tyne     30/11/2016      NA
> > 10395804        TOC PROPERTY BACKED LENDING TRUST PLC   Newcastle Upon Tyne     30/11/2017      1.04
> > 10395804        TOC PROPERTY BACKED LENDING TRUST PLC   Newcastle Upon Tyne     30/11/2018      1.04
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2000      NA
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2001      NA
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2003      NA
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2004      NA
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2005      NA
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2006      1.09
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2007      1.17
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2008      1.24
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2009      0.9
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2010      1.14
> >
> >
> >
> > I am trying to calculate the total change in share price like for CARDIFF PROPERTY PUBLIC LIMITED COMPANY the total change
> >
> > between 2005 and 2006 is NA and for 2006 and 2007 it is NA for 2007 and 2008 it is -3.1 and 2008 and 2009 it is 0 and 2009 and 2010 it is +.95.
> >
> >
> > I am trying to achieve this via he following code:
> >
> > for (i in 1:(nrow(PLC)-1))
> > if (isTRUE (PLC[i, 1] == PLC[i + 1, 1]))
> > {
> > PLC$CH_SH_PRICE(i+1) = (PLC$CLOSE_SHARE_PRICE[i+1] -
> > PLC$CLOSE_SHARE_PRICE[i])
> > }
> >
> >
> > I get the following error
> >
> >
> > Error in 1:(nrow(PLC) - 1) : argument of length 0
> >
> >
> > Can you kindly suggest any solution to this issue?
> >
> >
> > Thanks in advance.
> >          [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> > CAUTION: This email originated from outside of USU. If this appears to be a USU employee, beware of impersonators. Do not click links, reply, download images, or open attachments unless you verify the sender?s identity and know the content is safe.
> >
> -- 
> David K Stevens, P.E., Ph.D.
> Professor, Environmental Engineering
> Civil and Environmental Engineering
> Utah Water Research Laboratory
> 8200 Old Main Hill
> Logan, UT  84322-8200
> 435 797 3229 - voice
> 435 797 1363 - fax
> david.stevens at usu.edu
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From w||||@mwdun|@p @end|ng |rom gm@||@com  Thu Apr  1 17:16:31 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Thu, 1 Apr 2021 08:16:31 -0700
Subject: [R] Violin plot with mean_sdl
In-Reply-To: <315326e2411e4436aa5f64c171c4b1c7@ugent.be>
References: <315326e2411e4436aa5f64c171c4b1c7@ugent.be>
Message-ID: <CAHqSRuR+a7K=T5JhEsmRpDVCvh+FWuSx56UQtca=Qi6tY8CV4w@mail.gmail.com>

help(stat_summary) suggests you use the fun.args=list(...) argument to
pass arguments to the fun.* functions.   Try replacing mult=1 by
fun.args=list(mult=1).

It is possible that ggplot2::stat_summary changed its behavior since
that web page was written or that the web page was always wrong.

-Bill

On Wed, Mar 31, 2021 at 11:03 PM Mahmood Naderan-Tahan
<mahmood.naderan at ugent.be> wrote:
>
> Hi,
>
> I followed the example described at [1] but I don't know why I get the following warning
>
>
> > library(ggplot2)
> > library(Hmisc)
> > mydata <- read.csv('test.csv', header=T,row.names=1)
> > mydata
>      V1  V2   V3 V4
> P1 73.6 0.7 74.6  R
> P2 75.2 0.7 75.8  R
> P3  6.5 0.0  7.3  R
> P4 41.4 0.3 39.2  C
> P5  5.4 0.1 18.2  C
> P6 18.8 0.3 30.3  C
> > p <- ggplot(mydata, aes(x=V4, y=V1)) + geom_violin(trim=FALSE)
> > p + stat_summary(fun.data="mean_sdl", mult=1,
> +                  geom="crossbar", width=0.2 )
> Warning message:
> Ignoring unknown parameters: mult
>
>
> How can I fix that?
>
>
>
> [1] http://www.sthda.com/english/wiki/ggplot2-violin-plot-quick-start-guide-r-software-and-data-visualization
>
>
> Regards,
> Mahmood
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kev|n@thorpe @end|ng |rom utoronto@c@  Thu Apr  1 17:46:35 2021
From: kev|n@thorpe @end|ng |rom utoronto@c@ (Kevin Thorpe)
Date: Thu, 1 Apr 2021 15:46:35 +0000
Subject: [R] cox.zph
In-Reply-To: <AM4PR08MB2674993040E72279B6216E3C9D7B9@AM4PR08MB2674.eurprd08.prod.outlook.com>
References: <AM4PR08MB2674993040E72279B6216E3C9D7B9@AM4PR08MB2674.eurprd08.prod.outlook.com>
Message-ID: <202F3418-9344-43F9-B84B-2D083E871C5D@utoronto.ca>

While the statements below about cox.zph are true, plotting the cox.zph result does tell you what the HR is doing. I never use one without the other.

-- 
Kevin E. Thorpe
Head of Biostatistics,  Applied Health Research Centre (AHRC)
Li Ka Shing Knowledge Institute of St. Michael's
Assistant Professor, Dalla Lana School of Public Health
University of Toronto
email: kevin.thorpe at utoronto.ca  Tel: 416.864.5776  Fax: 416.864.3016

> On Apr 1, 2021, at 9:00 AM, Bendix Carstensen <bendix.carstensen at regionh.dk> wrote:
> 
> EXTERNAL EMAIL:
> 
> Further to John Sorkin's post on the cox.zph:
> You get test(s) of whether there is an interaction between a variable, say, sex, and time.
> 
> Suppose it is significant. You will have no clue whether the M/W hazard ratio is increasing or decreasing by time.
> 
> Suppose it is not significant. You will have no clue whether the (non-significant) M/W hazrad ratio exhibits a pattern that is worth looking further into or not.
> 
> In this sense the cox.zph is a perfect tool to allow you to write 'we checked for non proportionality' instead of 'we have no clue of how the M/W ratio varies by time'.
> 
> If you label it what it is, namely a test of interaction, you might realize that you should ESTIMATE the shape and size of the interaction before deriving a test, either ad-hoc by the Shoenfeld residuals or by proper modeling.
> 
> See for example pp 202 ff. in 'Epidemiology with R' by (surprise, surprise) me, published by OUP a few months ago.
> 
> b.r.
> Bendix Carstensen
> Senior Statistician
> Steno Diabetes Center Copenhagen
> Clinical Epidemiology
> Niels Steensens Vej 2-4
> DK-2820 Gentofte
> Denmark
> tel: +45 30 91 29 61
> b at bxc.dk
> bendix.carstensen at regionh.dk
> http://BendixCarstensen.com
> 
> 
> ________________________________
> 
> 
> Region Hovedstaden anvender de personoplysninger, du giver os i forbindelse med din henvendelse. Du kan l?se mere om form?let med anvendelsen samt dine rettigheder p? vores hjemmeside: www.regionh.dk/persondatapolitik
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From giusepp@cei@iu m@iii@g oii gm@ii@com  Thu Apr  1 18:32:04 2021
From: giusepp@cei@iu m@iii@g oii gm@ii@com (giusepp@cei@iu m@iii@g oii gm@ii@com)
Date: Thu, 1 Apr 2021 12:32:04 -0400
Subject: [R] File corruption?
Message-ID: <000801d72714$8d5cd720$a8168560$@gmail.com>

Hello,

I would like to know if anyone has encounter this problem before and what
they have done to solve the problem.  I am not sure if the problem has to do
with R itself or with RStudio.  The problem is the following: sometimes when
I am developing code in R, using R studio -script inside a Shiny
application- at one point my code does not work in the application.  I works
outside the application as a separate script, but it stops working inside
the application with the rest of the functions. So far, what I have done is
to start an entire new script and rewrite the entire code and this will
solve the problem, the code will work fine again.  I wonder if files/script
get corrupted sometimes and need to be refreshed.  

 

Thank you


	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Thu Apr  1 21:52:40 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Thu, 1 Apr 2021 22:52:40 +0300
Subject: [R] File corruption?
In-Reply-To: <000801d72714$8d5cd720$a8168560$@gmail.com>
References: <000801d72714$8d5cd720$a8168560$@gmail.com>
Message-ID: <CAGgJW74sxMx8CApardV4dsUsZ546k-Z10EE0A93Fu_gXt38C0Q@mail.gmail.com>

If your workflow involves debugging and rerunning the code, you may
experience differences between starting from a clean RStudio session and
simply restarting your application. This can be caused by your environment
having variables, shared objects etc defined. It is generally quite quick
to close and open a new RStudio session, so ... when in doubt it's probably
best to do that.

You should be able to organize your workflow so that stopping and starting
RStudio does not require you to rewrite any scripts. (e.g. save your
scripts as you go along)

HTH,
Eric


On Thu, Apr 1, 2021 at 9:45 PM <giuseppacefalu at gmail.com> wrote:

> Hello,
>
> I would like to know if anyone has encounter this problem before and what
> they have done to solve the problem.  I am not sure if the problem has to
> do
> with R itself or with RStudio.  The problem is the following: sometimes
> when
> I am developing code in R, using R studio -script inside a Shiny
> application- at one point my code does not work in the application.  I
> works
> outside the application as a separate script, but it stops working inside
> the application with the rest of the functions. So far, what I have done is
> to start an entire new script and rewrite the entire code and this will
> solve the problem, the code will work fine again.  I wonder if files/script
> get corrupted sometimes and need to be refreshed.
>
>
>
> Thank you
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From m@rn@@w@g|ey @end|ng |rom gm@||@com  Fri Apr  2 16:14:40 2021
From: m@rn@@w@g|ey @end|ng |rom gm@||@com (Marna Wagley)
Date: Fri, 2 Apr 2021 07:14:40 -0700
Subject: [R] extraction of last observation date from many observations in
 each row/column
Message-ID: <CAMwU6B09eA5S_yfnUtroTfG=O2P=9gYSaQKUHPBKT6dUd8jDdA@mail.gmail.com>

Dear R-Users,
I have a dataset containing more than two observation dates in some of the
columns and sites  but I wanted to extract only the last date of the
observation.
Is there any easiest way to get that last observation in each column/row?

Here is the example data:
daT<-structure(list(ID = c("M3", "M5", "M1"), Site1 =
c("12/20/2018,12/28/2018",
"12/17/18", ""), Site2 = c("", "", "1/19/2019"), Site3 = c("9/25/2019", "",
"1/10/2019, 1/11/2019, 1/17/2019")), class = "data.frame", row.names =
c(NA,-3L))

#I wanted to make the table like this:
output<-structure(list(ID = c("M3", "M5", "M1"), Site1 = c("12/28/2018",
"12/7/2018", ""), Site2 = c("", "", "1/19/2019"), Site3 = c("9/25/2019",
 "", "1/17/2019")), class = "data.frame", row.names = c(NA, -3L))

Thank you for your help.
Sincerely,
MW

	[[alternative HTML version deleted]]


From @@r@h@go@|ee @end|ng |rom gm@||@com  Fri Apr  2 16:31:51 2021
From: @@r@h@go@|ee @end|ng |rom gm@||@com (Sarah Goslee)
Date: Fri, 2 Apr 2021 10:31:51 -0400
Subject: [R] 
 extraction of last observation date from many observations in
 each row/column
In-Reply-To: <CAMwU6B09eA5S_yfnUtroTfG=O2P=9gYSaQKUHPBKT6dUd8jDdA@mail.gmail.com>
References: <CAMwU6B09eA5S_yfnUtroTfG=O2P=9gYSaQKUHPBKT6dUd8jDdA@mail.gmail.com>
Message-ID: <CAM_vju=hQRYQC+=qaq0UFi8-cM60CDZzj=o_avRwkk7HDnVONg@mail.gmail.com>

Hi Marna,

This very short function deletes everything before the last , if there
is a comma. Some of your entries have comma-space and some just have
comma, so it deletes the optional space as well.

lastdate <- function(x) {
  sub("^.*, *", "", x)
 }

data.frame(apply(daT, 2, lastdate))

Sarah

On Fri, Apr 2, 2021 at 10:15 AM Marna Wagley <marna.wagley at gmail.com> wrote:
>
> Dear R-Users,
> I have a dataset containing more than two observation dates in some of the
> columns and sites  but I wanted to extract only the last date of the
> observation.
> Is there any easiest way to get that last observation in each column/row?
>
> Here is the example data:
> daT<-structure(list(ID = c("M3", "M5", "M1"), Site1 =
> c("12/20/2018,12/28/2018",
> "12/17/18", ""), Site2 = c("", "", "1/19/2019"), Site3 = c("9/25/2019", "",
> "1/10/2019, 1/11/2019, 1/17/2019")), class = "data.frame", row.names =
> c(NA,-3L))
>
> #I wanted to make the table like this:
> output<-structure(list(ID = c("M3", "M5", "M1"), Site1 = c("12/28/2018",
> "12/7/2018", ""), Site2 = c("", "", "1/19/2019"), Site3 = c("9/25/2019",
>  "", "1/17/2019")), class = "data.frame", row.names = c(NA, -3L))
>
> Thank you for your help.
> Sincerely,
> MW
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
Sarah Goslee (she/her)
http://www.numberwright.com


From m@@@|mo@bre@@@n @end|ng |rom @rp@@veneto@|t  Sat Apr  3 11:13:46 2021
From: m@@@|mo@bre@@@n @end|ng |rom @rp@@veneto@|t (massimo bressan)
Date: Sat, 3 Apr 2021 11:13:46 +0200
Subject: [R] overlay geom_contour to ggmap
Message-ID: <CAFZj84_RMyFKga_=_pcs+2oL41dFBX_DVqpdfPCODm8mL2d8bA@mail.gmail.com>

consider this reproducible example

# set the origin of the grid # in cartesian coordinates (epsg 32632)
xmin<-742966
ymin<-5037923
# set x and y axis
x<-seq(xmin, xmin+25*39, by=25)
y<-seq(ymin, ymin+25*39, by =25)
# define a 40 x 40 grid
mygrid<-expand.grid(x = x, y = y)
# set the z value to be interpolated by the contour
set.seed(123)
mygrid$z<- rnorm(nrow(mygrid))

library(tidyverse)
# plot of contour is fine
ggplot(data=mygrid, aes(x=x,y=y,z=z))+
  geom_contour()

library(ggspatial)
# transform coordinates to wgs84 4326# (one of the possible many other
ways to do it)
mygrid_4326<-xy_transform(mygrid$x, mygrid$y, from = 32632, to = 4326)
# create new grid with lon and lat # (geographical coordinates espg 4326)
mygrid_4326<-mygrid_4326%>%
  mutate(z=mygrid$z)
# define the bounding box
my_bb<-c(min(mygrid_4326$x), min(mygrid_4326$y),
         max(mygrid_4326$x),
max(mygrid_4326$y))names(my_bb)<-c('left', 'bottom', 'right', 'top')

library(ggmap)
# get the background map (by a free provider)
mymap<-get_stamenmap(bbox = c(left = my_bb[['left']],
                              bottom = my_bb[['bottom']],
                              right = my_bb[['right']],
                              top = my_bb[['top']]),
                     zoom = 15,
                     maptype = 'toner-lite')
# plot of the map is fine
mymap%>%
  ggmap()
# overlay the contour of z is failing
mymap%>%
  ggmap()+
  #geom_contour(data=mygrid_4326, mapping=aes(x = x, y = y, z = z))
  stat_contour(data=mygrid_4326, mapping=aes(x = x, y = y, z = z))

Warning messages:1: stat_contour(): Zero contours were generated 2: In
min(x) : no non-missing arguments to min; returning Inf3: In max(x) :
no non-missing arguments to max; returning -Inf



the problem here is the overlay of the contour plot made with ggplot to a
base map made with ggmap

any help?

thanks

	[[alternative HTML version deleted]]


From j@ork|n @end|ng |rom @om@um@ry|@nd@edu  Mon Apr  5 03:34:42 2021
From: j@ork|n @end|ng |rom @om@um@ry|@nd@edu (Sorkin, John)
Date: Mon, 5 Apr 2021 01:34:42 +0000
Subject: [R] Plotting adjusted KM curve
Message-ID: <MN2PR03MB5167831095C7DEFEFAF23E76E2779@MN2PR03MB5167.namprd03.prod.outlook.com>

Colleagues,
I am using the coxph to model survival time. How do I plot an adjusted Kaplan Meir plot resulting from coxph? The code I would like to run would start with:

# run cox model
fit1Cox <- coxph(surv_object ~age+sex,data=mydata)

I have no idea what would follow.

I would like to plot adjusted KM curves for men vs. women at age 65.

Thank you,
John


	[[alternative HTML version deleted]]


From j|ox @end|ng |rom mcm@@ter@c@  Mon Apr  5 04:45:41 2021
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Sun, 4 Apr 2021 22:45:41 -0400
Subject: [R] Plotting adjusted KM curve
In-Reply-To: <31181_1617586517_1351ZHCt005276_MN2PR03MB5167831095C7DEFEFAF23E76E2779@MN2PR03MB5167.namprd03.prod.outlook.com>
References: <31181_1617586517_1351ZHCt005276_MN2PR03MB5167831095C7DEFEFAF23E76E2779@MN2PR03MB5167.namprd03.prod.outlook.com>
Message-ID: <bd421645-0754-9c59-9499-e312b44a783e@mcmaster.ca>

Dear John,

I think that what you're looking for is

plot(survfit(fit1Cox, newdata=data.frame(age=rep(65, 2), 
sex=factor("female", "male"))))

assuming, of course, that sex is a factor with levels "female" and "male".

I hope this helps,
  John

John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://socialsciences.mcmaster.ca/jfox/

On 2021-04-04 9:34 p.m., Sorkin, John wrote:
> Colleagues,
> I am using the coxph to model survival time. How do I plot an adjusted Kaplan Meir plot resulting from coxph? The code I would like to run would start with:
> 
> # run cox model
> fit1Cox <- coxph(surv_object ~age+sex,data=mydata)
> 
> I have no idea what would follow.
> 
> I would like to plot adjusted KM curves for men vs. women at age 65.
> 
> Thank you,
> John
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From j|ox @end|ng |rom mcm@@ter@c@  Mon Apr  5 04:58:23 2021
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Sun, 4 Apr 2021 22:58:23 -0400
Subject: [R] Plotting adjusted KM curve
In-Reply-To: <15682_1617590758_1352jwRV026176_bd421645-0754-9c59-9499-e312b44a783e@mcmaster.ca>
References: <31181_1617586517_1351ZHCt005276_MN2PR03MB5167831095C7DEFEFAF23E76E2779@MN2PR03MB5167.namprd03.prod.outlook.com>
 <15682_1617590758_1352jwRV026176_bd421645-0754-9c59-9499-e312b44a783e@mcmaster.ca>
Message-ID: <0b6849c4-9fa7-733a-a92c-371a8a80703c@mcmaster.ca>

On 2021-04-04 10:45 p.m., John Fox wrote:
> Dear John,
> 
> I think that what you're looking for is
> 
> plot(survfit(fit1Cox, newdata=data.frame(age=rep(65, 2), 
> sex=factor("female", "male"))))

Whoops, that should be

plot(survfit(fit1Cox, newdata=data.frame(age=rep(65, 2), 
sex=factor(c("female", "male")))))

John


> 
> assuming, of course, that sex is a factor with levels "female" and "male".
> 
> I hope this helps,
> John
> 
> John Fox, Professor Emeritus
> McMaster University
> Hamilton, Ontario, Canada
> web: https://socialsciences.mcmaster.ca/jfox/
> 
> On 2021-04-04 9:34 p.m., Sorkin, John wrote:
>> Colleagues,
>> I am using the coxph to model survival time. How do I plot an adjusted 
>> Kaplan Meir plot resulting from coxph? The code I would like to run 
>> would start with:
>>
>> # run cox model
>> fit1Cox <- coxph(surv_object ~age+sex,data=mydata)
>>
>> I have no idea what would follow.
>>
>> I would like to plot adjusted KM curves for men vs. women at age 65.
>>
>> Thank you,
>> John
>>
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From grond @end|ng |rom number|@nd@de  Mon Apr  5 09:54:07 2021
From: grond @end|ng |rom number|@nd@de (Wolfgang Grond)
Date: Mon, 5 Apr 2021 09:54:07 +0200
Subject: [R] Identifying tidygraph subgraphs
Message-ID: <db5e2e32-32ad-3f22-86d2-613c1306270d@numberland.de>

Dear all,

imagine the following situation:

I want to create a tidygraph consisting of several subgraphs like in 
this example:

gr1  <-  create_notable 
<https://rdrr.io/cran/tidygraph/man/create_graphs.html>('bull')  %>%
   activate <https://rdrr.io/cran/tidygraph/man/activate.html>(nodes)  %>%
   mutate <https://rdrr.io/cran/tidygraph/man/reexports.html>(name 
<https://rdrr.io/r/base/name.html>  =  letters <https://rdrr.io/r/base/Constants.html>[1:5])
gr2  <-  create_ring <https://rdrr.io/cran/tidygraph/man/create_graphs.html>(10)  %>%
   activate <https://rdrr.io/cran/tidygraph/man/activate.html>(nodes)  %>%
   mutate <https://rdrr.io/cran/tidygraph/man/reexports.html>(name 
<https://rdrr.io/r/base/name.html>  =  letters <https://rdrr.io/r/base/Constants.html>[4:13])

gr1  %>%  graph_join <https://rdrr.io/cran/tidygraph/man/graph_join.html>(gr2) 
when the merged graph is plotted with ggraph afterwards, I would like to 
identify the former graphs gr1 and gr2 by their node color, so that it 
is possible to see which node originates from which source. The result 
will be as follows: nodes a, b, c have i. e. color blue as they 
originate from gr1, nodes f, g, h, i, j, k, l, m have i. e. color red as 
they originate from gr2, nodes d, e either have color blue or color red 
(depending in which sequence the graphs are joined), or nodes d. e have 
a third color, i. e. green as the belong to both graphs How can this be 
done? Thanks in advance. Wolfgang Grond


	[[alternative HTML version deleted]]


From erodo|||| @end|ng |rom u||@edu  Mon Apr  5 21:46:14 2021
From: erodo|||| @end|ng |rom u||@edu (Rodofili, Esteban Nicolas)
Date: Mon, 5 Apr 2021 19:46:14 +0000
Subject: [R] Geolocating image frames automatically from an already
 georeferenced image
Message-ID: <BN6PR22MB0132FE03A080F1EDFA3B7FACA6779@BN6PR22MB0132.namprd22.prod.outlook.com>

Hi! I have drone footage on a still position I want to analyze as separate image frames in Google Earth Engine. Nothing was geolocated. I georeferenced an image frame with ground control points in Global Mapper. I am wondering if in R I could take the remaining image frames and automatically geolocate them using the georeferenced frame, without going one by one or using ground control points. The video is always still in the same position so what I need is to give the remaining image frames the same geolocation as the one I georeferenced with the ground control points. If not possible in R, I welcome other suggestions. Thanks.

Esteban N. Rodofili
Ph.D. Student - Interdisciplinary Ecology Program, SNRE
Lic. in Biology - Mgtr. in Public Policy
Marine Geomatics Lab
University of Florida
UF Climate Action Plan - Transportation Working Group
352-284-6828
erodofili at ufl.edu
https://www.thelecourslab.org/

I stand in solidarity with Graduate Assistants United and demand the University of Florida:
1.      Follow through with its agreement to pay certain fees on behalf of GAs as outlined in Article 10.6 of our Collective Bargaining Agreement.
2.      Discontinue all business relationships with Aramark due to their use of prison labor, and directly consult with the Food Justice League, Gator NAACP, Dream Defenders, and allied groups on the upcoming food service vendor contract to ensure racial equity.
3.      Immediately reverse its plan to demolish the Maguire and UVS Graduate Family Housing complexes.
4.      Immediately revoke its new furlough policy.



	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Mon Apr  5 23:25:03 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 5 Apr 2021 14:25:03 -0700
Subject: [R] Geolocating image frames automatically from an already
 georeferenced image
In-Reply-To: <BN6PR22MB0132FE03A080F1EDFA3B7FACA6779@BN6PR22MB0132.namprd22.prod.outlook.com>
References: <BN6PR22MB0132FE03A080F1EDFA3B7FACA6779@BN6PR22MB0132.namprd22.prod.outlook.com>
Message-ID: <CAGxFJbRfdEofZecK3cbgG2tAzmzAOgq6SQNo9U14cM=tCeruWA@mail.gmail.com>

Your query is basically off topic on this list -- see the posting guide
linked below for what is on topic.

R has several "SIGs" where your query is more likely to fit. See here
https://www.r-project.org/mail.html for a list. I think either
r-sig-ecology  or r-sig-geo might be appropriate, but you decide. Post on
only one at a time and wait several days for a response before posting on
another (R netiquette).

Cheers,

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Mon, Apr 5, 2021 at 1:20 PM Rodofili, Esteban Nicolas <erodofili at ufl.edu>
wrote:

> Hi! I have drone footage on a still position I want to analyze as separate
> image frames in Google Earth Engine. Nothing was geolocated. I
> georeferenced an image frame with ground control points in Global Mapper. I
> am wondering if in R I could take the remaining image frames and
> automatically geolocate them using the georeferenced frame, without going
> one by one or using ground control points. The video is always still in the
> same position so what I need is to give the remaining image frames the same
> geolocation as the one I georeferenced with the ground control points. If
> not possible in R, I welcome other suggestions. Thanks.
>
> Esteban N. Rodofili
> Ph.D. Student - Interdisciplinary Ecology Program, SNRE
> Lic. in Biology - Mgtr. in Public Policy
> Marine Geomatics Lab
> University of Florida
> UF Climate Action Plan - Transportation Working Group
> 352-284-6828
> erodofili at ufl.edu
> https://www.thelecourslab.org/
>
> I stand in solidarity with Graduate Assistants United and demand the
> University of Florida:
> 1.      Follow through with its agreement to pay certain fees on behalf of
> GAs as outlined in Article 10.6 of our Collective Bargaining Agreement.
> 2.      Discontinue all business relationships with Aramark due to their
> use of prison labor, and directly consult with the Food Justice League,
> Gator NAACP, Dream Defenders, and allied groups on the upcoming food
> service vendor contract to ensure racial equity.
> 3.      Immediately reverse its plan to demolish the Maguire and UVS
> Graduate Family Housing complexes.
> 4.      Immediately revoke its new furlough policy.
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From j@ork|n @end|ng |rom @om@um@ry|@nd@edu  Tue Apr  6 05:28:29 2021
From: j@ork|n @end|ng |rom @om@um@ry|@nd@edu (Sorkin, John)
Date: Tue, 6 Apr 2021 03:28:29 +0000
Subject: [R] Contrasts in coxph
Message-ID: <MN2PR03MB51678A76DFF4A1CA8D7D8A03E2769@MN2PR03MB5167.namprd03.prod.outlook.com>

I would like to define contrasts on the output of a coxph function. It appears that the contrast function from the contrast library does not have a method defined that will allow computation of contrasts on a coxph object.

How does one define and evaluate contrasts for a cox model?

Thank you,
John

John David Sorkin M.D., Ph.D.
Professor of Medicine
Chief, Biostatistics and Informatics
University of Maryland School of Medicine Division of Gerontology and Geriatric Medicine
Baltimore VA Medical Center
10 North Greene Street
GRECC (BT/18/GR)
Baltimore, MD 21201-1524
(Phone) 410-605-7119
(Fax) 410-605-7913 (Please call phone number above prior to faxing)



From |r@|nj @end|ng |rom gm@||@com  Tue Apr  6 15:42:28 2021
From: |r@|nj @end|ng |rom gm@||@com (John C Frain)
Date: Tue, 6 Apr 2021 14:42:28 +0100
Subject: [R] Probit model- endogeneity issue
In-Reply-To: <PR2PR09MB316189FAAD84903158C44A69E9639@PR2PR09MB3161.eurprd09.prod.outlook.com>
References: <PR2PR09MB316189FAAD84903158C44A69E9639@PR2PR09MB3161.eurprd09.prod.outlook.com>
Message-ID: <CAHrK5149W8Dg7PqxaNGKdyN_g3HBDOW8HOGP4_J+1F5cGyY2AQ@mail.gmail.com>

On Wed 24 Mar 2021 at 07:54, hannelore nelissen <
hannelore.nelissen at outlook.be> wrote:

> Dear all,
> I am having some issues with using the IV strategy for an endogeneity
> problem in terms of a probit model.  In particular, I want to follow a
> two-stage procedure where I estimate a probit on the decision to peg the
> exchange rate, and then use the predicted values in the second stage
> regression. So, I need to get a probability that the country has a peg
> (estimated based on the Z variables). So, in the second stage, I have to
> include this estimated probability of the first stage (and exclude the Z
> variables that showed a significant effect). However, I do not know how to
> get this estimated probability of the first stage which I can then include
> in my second stage?
> Can somebody help me with the command I should use?
>
>
> I would really appreciate it, thanks Dear all,
>
>
> I find it a bit difficult to follow your question.  You might find

Lee (1981), Simultaneous Equation Models with discrete and censored
dependent variables, in Mansfield and McFadden (Ed?s), 346-364, MIT,
helpful in suggesting ways to proceed.

 Chapter 19 of Wooldridge :(2010), Econometric Analysis of Cross Section
and Panel Data, Princeton, may also be useful.

You might look at the r packages ivprobit and ivporbit






>
> Verzonden vanuit Mail<https://go.microsoft.com/fwlink/?LinkId=550986>
> voor Windows 10
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
-- 
John C Frain
3 Aranleigh Park
Rathfarnham
Dublin 14
Ireland
www.tcd.ie/Economics/staff/frainj/home.html
mailto:frainj at tcd.ie
mailto:frainj at gmail.com

	[[alternative HTML version deleted]]


From gor@n@bro@trom @end|ng |rom umu@@e  Tue Apr  6 16:47:27 2021
From: gor@n@bro@trom @end|ng |rom umu@@e (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Tue, 6 Apr 2021 16:47:27 +0200
Subject: [R] Contrasts in coxph
In-Reply-To: <MN2PR03MB51678A76DFF4A1CA8D7D8A03E2769@MN2PR03MB5167.namprd03.prod.outlook.com>
References: <MN2PR03MB51678A76DFF4A1CA8D7D8A03E2769@MN2PR03MB5167.namprd03.prod.outlook.com>
Message-ID: <1413a992-f092-fc01-e450-94c03ac9e8cf@umu.se>

Dear John,

I googled "contrasts Cox regression" and found

https://stats.stackexchange.com/questions/15603/performing-contrasts-among-treatment-levels-in-survival-analysis

where Frank Harrell reports how to do what you want with his rms 
package. At least I think so, haven't tried it myself.

Best, G?ran

On 2021-04-06 05:28, Sorkin, John wrote:
> I would like to define contrasts on the output of a coxph function.
> It appears that the contrast function from the contrast library does
> not have a method defined that will allow computation of contrasts on
> a coxph object.
> 
> How does one define and evaluate contrasts for a cox model?
> 
> Thank you, John
> 
> John David Sorkin M.D., Ph.D. Professor of Medicine Chief,
> Biostatistics and Informatics University of Maryland School of
> Medicine Division of Gerontology and Geriatric Medicine Baltimore VA
> Medical Center 10 North Greene Street GRECC (BT/18/GR) Baltimore, MD
> 21201-1524 (Phone) 410-605-7119 (Fax) 410-605-7913 (Please call phone
> number above prior to faxing)
> 
> 
> ______________________________________________ R-help at r-project.org
> mailing list -- To UNSUBSCRIBE and more, see 
> https://stat.ethz.ch/mailman/listinfo/r-help PLEASE do read the
> posting guide http://www.R-project.org/posting-guide.html and provide
> commented, minimal, self-contained, reproducible code.
>


From j|ox @end|ng |rom mcm@@ter@c@  Tue Apr  6 19:13:24 2021
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Tue, 6 Apr 2021 13:13:24 -0400
Subject: [R] Contrasts in coxph
In-Reply-To: <24118_1617679737_1363Suiw018542_MN2PR03MB51678A76DFF4A1CA8D7D8A03E2769@MN2PR03MB5167.namprd03.prod.outlook.com>
References: <24118_1617679737_1363Suiw018542_MN2PR03MB51678A76DFF4A1CA8D7D8A03E2769@MN2PR03MB5167.namprd03.prod.outlook.com>
Message-ID: <04ed429b-e395-adb8-b643-de6df730d614@mcmaster.ca>

Dear John,

It's not clear to me exactly what you have in mind, but 
car::linearHypothesis(), multcomp::glht(), and the emmeans package work 
with Cox models. I expect there are functions in other packages that 
will work too.

Here's an example, surely simpler than what you have in mind, but you 
can probably adapt it:

------------------ snip -----------------

 > library("survival")
 > library("car")
Loading required package: carData
 > mod.allison <- coxph(Surv(week, arrest) ~
+                        fin + age + race + wexp + mar + paro + prio,
+                      data=Rossi)
 > mod.allison
Call:
coxph(formula = Surv(week, arrest) ~ fin + age + race + wexp +
     mar + paro + prio, data = Rossi)

                    coef exp(coef) se(coef)      z       p
finyes         -0.37942   0.68426  0.19138 -1.983 0.04742
age            -0.05744   0.94418  0.02200 -2.611 0.00903
raceother      -0.31390   0.73059  0.30799 -1.019 0.30812
wexpyes        -0.14980   0.86088  0.21222 -0.706 0.48029
marnot married  0.43370   1.54296  0.38187  1.136 0.25606
paroyes        -0.08487   0.91863  0.19576 -0.434 0.66461
prio            0.09150   1.09581  0.02865  3.194 0.00140

Likelihood ratio test=33.27  on 7 df, p=2.362e-05
n= 432, number of events= 114
 >
 > linearHypothesis(mod.allison, "finyes")
Linear hypothesis test

Hypothesis:
finyes = 0

Model 1: restricted model
Model 2: Surv(week, arrest) ~ fin + age + race + wexp + mar + paro + prio

   Res.Df Df  Chisq Pr(>Chisq)
1    426
2    425  1 3.9306    0.04742 *
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1
 >
 > library("multcomp")
Loading required package: mvtnorm
Loading required package: TH.data
Loading required package: MASS

Attaching package: ?TH.data?

The following object is masked from ?package:MASS?:

     geyser

 > summary(glht(mod.allison, "finyes=0"))

	 Simultaneous Tests for General Linear Hypotheses

Fit: coxph(formula = Surv(week, arrest) ~ fin + age + race + wexp +
     mar + paro + prio, data = Rossi)

Linear Hypotheses:
             Estimate Std. Error z value Pr(>|z|)
finyes == 0  -0.3794     0.1914  -1.983   0.0474 *
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1
(Adjusted p values reported -- single-step method)

 >
 > library(emmeans)
 > pairs(emmeans(mod.allison, ~ fin))
  contrast estimate    SE  df z.ratio p.value
  no - yes    0.379 0.191 Inf 1.983   0.0474

------------------ snip -----------------

Results are averaged over the levels of: race, wexp, mar, paro
Results are given on the log (not the response) scale.

John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://socialsciences.mcmaster.ca/jfox/

On 2021-04-05 11:28 p.m., Sorkin, John wrote:
> I would like to define contrasts on the output of a coxph function. It appears that the contrast function from the contrast library does not have a method defined that will allow computation of contrasts on a coxph object.
> 
> How does one define and evaluate contrasts for a cox model?
> 
> Thank you,
> John
> 
> John David Sorkin M.D., Ph.D.
> Professor of Medicine
> Chief, Biostatistics and Informatics
> University of Maryland School of Medicine Division of Gerontology and Geriatric Medicine
> Baltimore VA Medical Center
> 10 North Greene Street
> GRECC (BT/18/GR)
> Baltimore, MD 21201-1524
> (Phone) 410-605-7119
> (Fax) 410-605-7913 (Please call phone number above prior to faxing)
> 
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From dw|n@em|u@ @end|ng |rom comc@@t@net  Wed Apr  7 03:01:07 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Tue, 6 Apr 2021 18:01:07 -0700
Subject: [R] Contrasts in coxph
In-Reply-To: <MN2PR03MB51678A76DFF4A1CA8D7D8A03E2769@MN2PR03MB5167.namprd03.prod.outlook.com>
References: <MN2PR03MB51678A76DFF4A1CA8D7D8A03E2769@MN2PR03MB5167.namprd03.prod.outlook.com>
Message-ID: <3676aa83-4230-cd1d-d5c7-05e09c43ef66@comcast.net>


On 4/5/21 8:28 PM, Sorkin, John wrote:
> I would like to define contrasts on the output of a coxph function. It appears that the contrast function from the contrast library does not have a method defined that will allow computation of contrasts on a coxph object.
>
> How does one define and evaluate contrasts for a cox model?


I suspect that you are hoping for post-hoc pairwise contrasts. If that's 
the case, then the multcomp package's glht is generally very capable. It 
has three examples in its vignette the involve survivla models. The last 
one constructs a categorical variable for age. That's not a procedure 
that I endorse, but it may have been done for illustration of a method 
and would therefore be free of sin.


library(multcomp)? # console output follows

 > if (require("survival") && require("MASS")) {
+???? ### construct 4 classes of age
+???? Melanoma$Cage <- factor(sapply(Melanoma$age, function(x){if( x <= 
25 ) return(1)
+???????? if( x > 25 & x <= 50 ) return(2)
+???????? if( x > 50 & x <= 75 ) return(3)
+???????? if( x > 75 & x <= 100) return(4) }
+???? ))
+ }
 > summary(Melanoma)
 ????? time????????? status????????? sex age???????????? year??????? 
thickness
 ?Min.?? :? 10?? Min.?? :1.00?? Min.?? :0.0000?? Min.?? : 4.00 Min.?? 
:1962?? Min.?? : 0.10
 ?1st Qu.:1525?? 1st Qu.:1.00?? 1st Qu.:0.0000?? 1st Qu.:42.00 1st 
Qu.:1968?? 1st Qu.: 0.97
 ?Median :2005?? Median :2.00?? Median :0.0000?? Median :54.00 Median 
:1970?? Median : 1.94
 ?Mean?? :2153?? Mean?? :1.79?? Mean?? :0.3854?? Mean?? :52.46 Mean?? 
:1970?? Mean?? : 2.92
 ?3rd Qu.:3042?? 3rd Qu.:2.00?? 3rd Qu.:1.0000?? 3rd Qu.:65.00 3rd 
Qu.:1972?? 3rd Qu.: 3.56
 ?Max.?? :5565?? Max.?? :3.00?? Max.?? :1.0000?? Max.?? :95.00 Max.?? 
:1977?? Max.?? :17.42
 ???? ulcer?????? Cage
 ?Min.?? :0.000?? 1: 14
 ?1st Qu.:0.000?? 2: 73
 ?Median :0.000?? 3:104
 ?Mean?? :0.439?? 4: 14
 ?3rd Qu.:1.000
 ?Max.?? :1.000
 > cm <- coxph(Surv(time, status == 1) ~ Cage, data = Melanoma)
 > ### specify all pair-wise comparisons among levels of "Cage"
 > cm.glht <- glht(cm, mcp(Cage = "Tukey"))
 > cm.glht

 ??? ?General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Linear Hypotheses:
 ?????????? Estimate
2 - 1 == 0? -0.2889
3 - 1 == 0?? 0.1910
4 - 1 == 0?? 1.0742
3 - 2 == 0?? 0.4800
4 - 2 == 0?? 1.3631
4 - 3 == 0?? 0.8832


-- 

David.

>
> Thank you,
> John
>
> John David Sorkin M.D., Ph.D.
> Professor of Medicine
> Chief, Biostatistics and Informatics
> University of Maryland School of Medicine Division of Gerontology and Geriatric Medicine
> Baltimore VA Medical Center
> 10 North Greene Street
> GRECC (BT/18/GR)
> Baltimore, MD 21201-1524
> (Phone) 410-605-7119
> (Fax) 410-605-7913 (Please call phone number above prior to faxing)
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @@h|mk@poor @end|ng |rom gm@||@com  Wed Apr  7 07:05:14 2021
From: @@h|mk@poor @end|ng |rom gm@||@com (Ashim Kapoor)
Date: Wed, 7 Apr 2021 10:35:14 +0530
Subject: [R] R does not start from (Debian) linux command line - error with
 doWithOneRestart() - segmentation fault
Message-ID: <CAC8=1eoxsgbi7fc=hPXEp+HsfPwWYvMPdV9CNT+bxyb+wPAruQ@mail.gmail.com>

Dear R experts,

Here is my problem :

R startup FAILS with an error message. The error message is more
meaningful when I do invoke R via sudo OR as root. I attach the
startup messages when I invoke R as :

1. as non root user
2. with sudo
3. as Root user.

The error messages ( mentioned in snippets below ) are more meaningful
to me in the above mentioned order.

When I google around for the error message, it looks like there is an
.xlsx file which has non english characters which is messing with
Java.

I do not know how to fix this. I tried :-

R --vanilla

so that it would not use any startup scripts but that also does not work.

----------------- snip
----------------------------------------------------------------------------------------------------------------------------

When I try to start R from the command line :

~$ R

 *** caught segfault ***
address (nil), cause 'unknown'

Traceback:
 1: NextMethod(.Generic)
 2: Ops.numeric_version(R_version_built_under, "3.0.0")
 3: testRversion(pkgInfo, package, pkgpath)
 4: library(package, lib.loc = lib.loc, character.only = TRUE,
logical.return = TRUE,     warn.conflicts = warn.conflicts, quietly =
quietly, mask.ok = mask.ok,     exclude = exclude, include.only =
include.only, attach.required = attach.required)
 5: doTryCatch(return(expr), name, parentenv, handler)
 6: tryCatchOne(expr, names, parentenv, handlers[[1L]])
 7: tryCatchList(expr, classes, parentenv, handlers)
 8: tryCatch(library(package, lib.loc = lib.loc, character.only =
TRUE,     logical.return = TRUE, warn.conflicts = warn.conflicts,
quietly = quietly,     mask.ok = mask.ok, exclude = exclude,
include.only = include.only,     attach.required = attach.required),
error = function(e) e)
 9: require(pkg, quietly = TRUE, warn.conflicts = FALSE, character.only = TRUE)
10: .OptRequireMethods()

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection: Segmentation fault

----------------- snip
----------------------------------------------------------------------------------------------------------------------------
When I try to start R with sudo it gives a more clear message :-

~$ sudo R

 *** caught segfault ***
address (nil), cause 'unknown'

Traceback:
 1: NextMethod(.Generic)
 2: Ops.numeric_version(R_version_built_under, "3.0.0")
 3: testRversion(pkgInfo, package, pkgpath)
 4: library(package, lib.loc = lib.loc, character.only = TRUE,
logical.return = TRUE,     warn.conflicts = warn.conflicts, quietly =
quietly, mask.ok = mask.ok,     exclude = exclude, include.only =
include.only, attach.required = attach.required)
 5: doTryCatch(return(expr), name, parentenv, handler)
 6: tryCatchOne(expr, names, parentenv, handlers[[1L]])
 7: tryCatchList(expr, classes, parentenv, handlers)
 8: tryCatch(library(package, lib.loc = lib.loc, character.only =
TRUE,     logical.return = TRUE, warn.conflicts = warn.conflicts,
quietly = quietly,     mask.ok = mask.ok, exclude = exclude,
include.only = include.only,     attach.required = attach.required),
error = function(e) e)
 9: require(pkg, quietly = TRUE, warn.conflicts = FALSE, character.only = TRUE)
10: .OptRequireMethods()

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection: Error in doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
  not a proper file name

R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

Error: not a proper file name
Error in doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
  promise already under evaluation: recursive default argument
reference or earlier problems?
Segmentation fault

----------------- snip
----------------------------------------------------------------------------------------------------------------------------

Invoking R as a root user :-

$ sudo -i
root at crayshrimp ~ # R

 *** caught segfault ***
address (nil), cause 'unknown'

Traceback:
 1: NextMethod(.Generic)
 2: Ops.numeric_version(R_version_built_under, "3.0.0")
 3: testRversion(pkgInfo, package, pkgpath)
 4: library(package, lib.loc = lib.loc, character.only = TRUE,
logical.return = TRUE,     warn.conflicts = warn.conflicts, quietly =
quietly, mask.ok = mask.ok,     exclude = exclude, include.only =
include.only, attach.required = attach.required)
 5: doTryCatch(return(expr), name, parentenv, handler)
 6: tryCatchOne(expr, names, parentenv, handlers[[1L]])
 7: tryCatchList(expr, classes, parentenv, handlers)
 8: tryCatch(library(package, lib.loc = lib.loc, character.only =
TRUE,     logical.return = TRUE, warn.conflicts = warn.conflicts,
quietly = quietly,     mask.ok = mask.ok, exclude = exclude,
include.only = include.only,     attach.required = attach.required),
error = function(e) e)
 9: require(pkg, quietly = TRUE, warn.conflicts = FALSE, character.only = TRUE)
10: .OptRequireMethods()

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection: Error in doWithOneRestart(return(), restart) : not a proper file name

R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

Error: not a proper file name
Error in doWithOneRestart(return(), restart) :
  promise already under evaluation: recursive default argument
reference or earlier problems?
Error in tryCatchOne(, names, parentenv, handlers[[1L]]) :
  promise already under evaluation: recursive default argument
reference or earlier problems?
Error: not a proper file name
Fatal error: unable to initialize the JIT

----------------- snip
----------------------------------------------------------------------------------------------------------------------------

Thank you,
Ashim


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Wed Apr  7 09:21:37 2021
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Wed, 7 Apr 2021 09:21:37 +0200
Subject: [R] 
 R does not start from (Debian) linux command line - error with
 doWithOneRestart() - segmentation fault
In-Reply-To: <CAC8=1eoxsgbi7fc=hPXEp+HsfPwWYvMPdV9CNT+bxyb+wPAruQ@mail.gmail.com>
References: <CAC8=1eoxsgbi7fc=hPXEp+HsfPwWYvMPdV9CNT+bxyb+wPAruQ@mail.gmail.com>
Message-ID: <24685.23937.706650.276577@stat.math.ethz.ch>

>>>>> Ashim Kapoor 
>>>>>     on Wed, 7 Apr 2021 10:35:14 +0530 writes:

    > Dear R experts,

    > Here is my problem :

    > R startup FAILS with an error message. The error message
    > is more meaningful when I do invoke R via sudo OR as
    > root. I attach the startup messages when I invoke R as :

    > 1. as non root user 2. with sudo 3. as Root user.

    > The error messages ( mentioned in snippets below ) are
    > more meaningful to me in the above mentioned order.

Thank you, Ashim.

Yes, the messages point to something really bad.

OTOH ("On the other hand"), what we *can* see is that you try to
start R version 3.6.3.

While that is not extremely old, it may well be older than
several other pieces of software (or even hardware) that you are
running with.

I very very  *strongly* recommend to use an R version 4.0.x ... and why not
use the latest  4.0.5 ?

Then, it may also be caused by a mismatch of system libraries
and your oldish version of R. ... but there I'd strongly
recommend consulting with other Debian users, notably as there
is a dedicated  mailing list  R-SIG-Debian --> do subscribe
there, and ask -- with more details on how you got your R: Is it
the default R on your Debian, which version of Debian,  etc.

Last but not least, Dirk Eddelbuettel, the maintainer of the
official R Debian package maintains a nice web page -- part of
the official CRAN web pages, but unfortunately a bit hidden
nowadays, (not the least because CRAN still uses frames (w?rg!!)):

  https://cloud.r-project.org/bin/linux/debian/

A very nice and useful page,  much underrated and underused,
probably.

Best regards,

Martin Maechler
ETH Zurich  and  R Core Team


    > When I google around for the error message, it looks like
    > there is an .xlsx file which has non english characters
    > which is messing with Java.

    > I do not know how to fix this. I tried :-

    > R --vanilla

    > so that it would not use any startup scripts but that also
    > does not work.

    > ----------------- snip
    > ----------------------------------------------------------------------------------------------------------------------------

    > When I try to start R from the command line :

    > ~$ R

    >  *** caught segfault *** address (nil), cause 'unknown'

    > Traceback: 1: NextMethod(.Generic) 2:
    > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
    > testRversion(pkgInfo, package, pkgpath) 4:
    > library(package, lib.loc = lib.loc, character.only = TRUE,
    > logical.return = TRUE, warn.conflicts = warn.conflicts,
    > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
    > include.only = include.only, attach.required =
    > attach.required) 5: doTryCatch(return(expr), name,
    > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
    > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
    > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
    > character.only = TRUE, logical.return = TRUE,
    > warn.conflicts = warn.conflicts, quietly = quietly,
    > mask.ok = mask.ok, exclude = exclude, include.only =
    > include.only, attach.required = attach.required), error =
    > function(e) e) 9: require(pkg, quietly = TRUE,
    > warn.conflicts = FALSE, character.only = TRUE) 10:
    > .OptRequireMethods()

    > Possible actions: 1: abort (with core dump, if enabled) 2:
    > normal R exit 3: exit R without saving workspace 4: exit R
    > saving workspace Selection: Segmentation fault

    > ----------------- snip
    > ----------------------------------------------------------------------------------------------------------------------------
    > When I try to start R with sudo it gives a more clear
    > message :-

    > ~$ sudo R

    >  *** caught segfault *** address (nil), cause 'unknown'

    > Traceback: 1: NextMethod(.Generic) 2:
    > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
    > testRversion(pkgInfo, package, pkgpath) 4:
    > library(package, lib.loc = lib.loc, character.only = TRUE,
    > logical.return = TRUE, warn.conflicts = warn.conflicts,
    > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
    > include.only = include.only, attach.required =
    > attach.required) 5: doTryCatch(return(expr), name,
    > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
    > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
    > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
    > character.only = TRUE, logical.return = TRUE,
    > warn.conflicts = warn.conflicts, quietly = quietly,
    > mask.ok = mask.ok, exclude = exclude, include.only =
    > include.only, attach.required = attach.required), error =
    > function(e) e) 9: require(pkg, quietly = TRUE,
    > warn.conflicts = FALSE, character.only = TRUE) 10:
    > .OptRequireMethods()

    > Possible actions: 1: abort (with core dump, if enabled) 2:
    > normal R exit 3: exit R without saving workspace 4: exit R
    > saving workspace Selection: Error in
    > doWithOneRestart(return(` \\x82\\x0ccPV`), restart) : not
    > a proper file name

    > R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
    > Copyright (C) 2020 The R Foundation for Statistical
    > Computing Platform: x86_64-pc-linux-gnu (64-bit)

    > R is free software and comes with ABSOLUTELY NO WARRANTY.
    > You are welcome to redistribute it under certain
    > conditions.  Type 'license()' or 'licence()' for
    > distribution details.

    >   Natural language support but running in an English
    > locale

    > R is a collaborative project with many contributors.  Type
    > 'contributors()' for more information and 'citation()' on
    > how to cite R or R packages in publications.

    > Type 'demo()' for some demos, 'help()' for on-line help,
    > or 'help.start()' for an HTML browser interface to help.
    > Type 'q()' to quit R.

    > Error: not a proper file name Error in
    > doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
    > promise already under evaluation: recursive default
    > argument reference or earlier problems?  Segmentation
    > fault

    > ----------------- snip
    > ----------------------------------------------------------------------------------------------------------------------------

    > Invoking R as a root user :-

    > $ sudo -i root at crayshrimp ~ # R

    >  *** caught segfault *** address (nil), cause 'unknown'

    > Traceback: 1: NextMethod(.Generic) 2:
    > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
    > testRversion(pkgInfo, package, pkgpath) 4:
    > library(package, lib.loc = lib.loc, character.only = TRUE,
    > logical.return = TRUE, warn.conflicts = warn.conflicts,
    > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
    > include.only = include.only, attach.required =
    > attach.required) 5: doTryCatch(return(expr), name,
    > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
    > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
    > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
    > character.only = TRUE, logical.return = TRUE,
    > warn.conflicts = warn.conflicts, quietly = quietly,
    > mask.ok = mask.ok, exclude = exclude, include.only =
    > include.only, attach.required = attach.required), error =
    > function(e) e) 9: require(pkg, quietly = TRUE,
    > warn.conflicts = FALSE, character.only = TRUE) 10:
    > .OptRequireMethods()

    > Possible actions: 1: abort (with core dump, if enabled) 2:
    > normal R exit 3: exit R without saving workspace 4: exit R
    > saving workspace Selection: Error in
    > doWithOneRestart(return(), restart) : not a proper file
    > name

    > R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
    > Copyright (C) 2020 The R Foundation for Statistical
    > Computing Platform: x86_64-pc-linux-gnu (64-bit)

    > R is free software and comes with ABSOLUTELY NO WARRANTY.
    > You are welcome to redistribute it under certain
    > conditions.  Type 'license()' or 'licence()' for
    > distribution details.

    >   Natural language support but running in an English
    > locale

    > R is a collaborative project with many contributors.  Type
    > 'contributors()' for more information and 'citation()' on
    > how to cite R or R packages in publications.

    > Type 'demo()' for some demos, 'help()' for on-line help,
    > or 'help.start()' for an HTML browser interface to help.
    > Type 'q()' to quit R.

    > Error: not a proper file name Error in
    > doWithOneRestart(return(), restart) : promise already
    > under evaluation: recursive default argument reference or
    > earlier problems?  Error in tryCatchOne(, names,
    > parentenv, handlers[[1L]]) : promise already under
    > evaluation: recursive default argument reference or
    > earlier problems?  Error: not a proper file name Fatal
    > error: unable to initialize the JIT

    > ----------------- snip
    > ----------------------------------------------------------------------------------------------------------------------------

    > Thank you, Ashim

    > ______________________________________________
    > R-help at r-project.org mailing list -- To UNSUBSCRIBE and
    > more, see https://stat.ethz.ch/mailman/listinfo/r-help
    > PLEASE do read the posting guide
    > http://www.R-project.org/posting-guide.html and provide
    > commented, minimal, self-contained, reproducible code.


From @@h|mk@poor @end|ng |rom gm@||@com  Wed Apr  7 10:16:46 2021
From: @@h|mk@poor @end|ng |rom gm@||@com (Ashim Kapoor)
Date: Wed, 7 Apr 2021 13:46:46 +0530
Subject: [R] 
 R does not start from (Debian) linux command line - error with
 doWithOneRestart() - segmentation fault
In-Reply-To: <24685.23937.706650.276577@stat.math.ethz.ch>
References: <CAC8=1eoxsgbi7fc=hPXEp+HsfPwWYvMPdV9CNT+bxyb+wPAruQ@mail.gmail.com>
 <24685.23937.706650.276577@stat.math.ethz.ch>
Message-ID: <CAC8=1eqGH_edCisjEF6Me_h9EvMnriEihWUoYkaAcORy+oLJRw@mail.gmail.com>

On Wed, Apr 7, 2021 at 12:51 PM Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>
> >>>>> Ashim Kapoor
> >>>>>     on Wed, 7 Apr 2021 10:35:14 +0530 writes:
>
>     > Dear R experts,
>
>     > Here is my problem :
>
>     > R startup FAILS with an error message. The error message
>     > is more meaningful when I do invoke R via sudo OR as
>     > root. I attach the startup messages when I invoke R as :
>
>     > 1. as non root user 2. with sudo 3. as Root user.
>
>     > The error messages ( mentioned in snippets below ) are
>     > more meaningful to me in the above mentioned order.
>
> Thank you, Ashim.
>
> Yes, the messages point to something really bad.
>
> OTOH ("On the other hand"), what we *can* see is that you try to
> start R version 3.6.3.
>

My apologies for not being clear.

I would like to clarify :

1. The error message from the incantation `R` is not very informative.

2. The error message from the incantation `sudo R` says (among other
things which don't seem significant to me):
Error in doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
  not a proper file name

3. The error message from invoking R as a root user says:

Error: not a proper file name
Fatal error: unable to initialize the JIT

I found this on the internet :
https://stackoverflow.com/questions/19512165/error-in-dowithonerestart

The error messages and the above link point to issues with JAVA, but
it does not say how to fix them.

That is why I thought : there is an .xlsx file which has non english
characters which is messing with
Java.

Query : is there a way to do JAVA garbage collection when R is not starting ?

> While that is not extremely old, it may well be older than
> several other pieces of software (or even hardware) that you are
> running with.
>
> I very very  *strongly* recommend to use an R version 4.0.x ... and why not
> use the latest  4.0.5 ?
>

We upgraded to 4.0.5 but it did not make a difference. We restarted
the computer and that fixed the error.
I think the JAVA garbage collection kicked in when we reset the
computer and that is why it was fixed on rebooting. Not sure though.

> Then, it may also be caused by a mismatch of system libraries
> and your oldish version of R. ... but there I'd strongly
> recommend consulting with other Debian users, notably as there
> is a dedicated  mailing list  R-SIG-Debian --> do subscribe
> there, and ask -- with more details on how you got your R: Is it
> the default R on your Debian, which version of Debian,  etc.
>
> Last but not least, Dirk Eddelbuettel, the maintainer of the
> official R Debian package maintains a nice web page -- part of
> the official CRAN web pages, but unfortunately a bit hidden
> nowadays, (not the least because CRAN still uses frames (w?rg!!)):
>
>   https://cloud.r-project.org/bin/linux/debian/
>
> A very nice and useful page,  much underrated and underused,
> probably.
>

Thank you for this.

> Best regards,
>
> Martin Maechler
> ETH Zurich  and  R Core Team
>
>
>     > When I google around for the error message, it looks like
>     > there is an .xlsx file which has non english characters
>     > which is messing with Java.
>
>     > I do not know how to fix this. I tried :-
>
>     > R --vanilla
>
>     > so that it would not use any startup scripts but that also
>     > does not work.
>
>     > ----------------- snip
>     > ----------------------------------------------------------------------------------------------------------------------------
>
>     > When I try to start R from the command line :
>
>     > ~$ R
>
>     >  *** caught segfault *** address (nil), cause 'unknown'
>
>     > Traceback: 1: NextMethod(.Generic) 2:
>     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
>     > testRversion(pkgInfo, package, pkgpath) 4:
>     > library(package, lib.loc = lib.loc, character.only = TRUE,
>     > logical.return = TRUE, warn.conflicts = warn.conflicts,
>     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
>     > include.only = include.only, attach.required =
>     > attach.required) 5: doTryCatch(return(expr), name,
>     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
>     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
>     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
>     > character.only = TRUE, logical.return = TRUE,
>     > warn.conflicts = warn.conflicts, quietly = quietly,
>     > mask.ok = mask.ok, exclude = exclude, include.only =
>     > include.only, attach.required = attach.required), error =
>     > function(e) e) 9: require(pkg, quietly = TRUE,
>     > warn.conflicts = FALSE, character.only = TRUE) 10:
>     > .OptRequireMethods()
>
>     > Possible actions: 1: abort (with core dump, if enabled) 2:
>     > normal R exit 3: exit R without saving workspace 4: exit R
>     > saving workspace Selection: Segmentation fault
>
>     > ----------------- snip
>     > ----------------------------------------------------------------------------------------------------------------------------
>     > When I try to start R with sudo it gives a more clear
>     > message :-
>
>     > ~$ sudo R
>
>     >  *** caught segfault *** address (nil), cause 'unknown'
>
>     > Traceback: 1: NextMethod(.Generic) 2:
>     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
>     > testRversion(pkgInfo, package, pkgpath) 4:
>     > library(package, lib.loc = lib.loc, character.only = TRUE,
>     > logical.return = TRUE, warn.conflicts = warn.conflicts,
>     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
>     > include.only = include.only, attach.required =
>     > attach.required) 5: doTryCatch(return(expr), name,
>     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
>     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
>     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
>     > character.only = TRUE, logical.return = TRUE,
>     > warn.conflicts = warn.conflicts, quietly = quietly,
>     > mask.ok = mask.ok, exclude = exclude, include.only =
>     > include.only, attach.required = attach.required), error =
>     > function(e) e) 9: require(pkg, quietly = TRUE,
>     > warn.conflicts = FALSE, character.only = TRUE) 10:
>     > .OptRequireMethods()
>
>     > Possible actions: 1: abort (with core dump, if enabled) 2:
>     > normal R exit 3: exit R without saving workspace 4: exit R
>     > saving workspace Selection: Error in
>     > doWithOneRestart(return(` \\x82\\x0ccPV`), restart) : not
>     > a proper file name
>
>     > R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
>     > Copyright (C) 2020 The R Foundation for Statistical
>     > Computing Platform: x86_64-pc-linux-gnu (64-bit)
>
>     > R is free software and comes with ABSOLUTELY NO WARRANTY.
>     > You are welcome to redistribute it under certain
>     > conditions.  Type 'license()' or 'licence()' for
>     > distribution details.
>
>     >   Natural language support but running in an English
>     > locale
>
>     > R is a collaborative project with many contributors.  Type
>     > 'contributors()' for more information and 'citation()' on
>     > how to cite R or R packages in publications.
>
>     > Type 'demo()' for some demos, 'help()' for on-line help,
>     > or 'help.start()' for an HTML browser interface to help.
>     > Type 'q()' to quit R.
>
>     > Error: not a proper file name Error in
>     > doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
>     > promise already under evaluation: recursive default
>     > argument reference or earlier problems?  Segmentation
>     > fault
>
>     > ----------------- snip
>     > ----------------------------------------------------------------------------------------------------------------------------
>
>     > Invoking R as a root user :-
>
>     > $ sudo -i root at crayshrimp ~ # R
>
>     >  *** caught segfault *** address (nil), cause 'unknown'
>
>     > Traceback: 1: NextMethod(.Generic) 2:
>     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
>     > testRversion(pkgInfo, package, pkgpath) 4:
>     > library(package, lib.loc = lib.loc, character.only = TRUE,
>     > logical.return = TRUE, warn.conflicts = warn.conflicts,
>     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
>     > include.only = include.only, attach.required =
>     > attach.required) 5: doTryCatch(return(expr), name,
>     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
>     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
>     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
>     > character.only = TRUE, logical.return = TRUE,
>     > warn.conflicts = warn.conflicts, quietly = quietly,
>     > mask.ok = mask.ok, exclude = exclude, include.only =
>     > include.only, attach.required = attach.required), error =
>     > function(e) e) 9: require(pkg, quietly = TRUE,
>     > warn.conflicts = FALSE, character.only = TRUE) 10:
>     > .OptRequireMethods()
>
>     > Possible actions: 1: abort (with core dump, if enabled) 2:
>     > normal R exit 3: exit R without saving workspace 4: exit R
>     > saving workspace Selection: Error in
>     > doWithOneRestart(return(), restart) : not a proper file
>     > name
>
>     > R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
>     > Copyright (C) 2020 The R Foundation for Statistical
>     > Computing Platform: x86_64-pc-linux-gnu (64-bit)
>
>     > R is free software and comes with ABSOLUTELY NO WARRANTY.
>     > You are welcome to redistribute it under certain
>     > conditions.  Type 'license()' or 'licence()' for
>     > distribution details.
>
>     >   Natural language support but running in an English
>     > locale
>
>     > R is a collaborative project with many contributors.  Type
>     > 'contributors()' for more information and 'citation()' on
>     > how to cite R or R packages in publications.
>
>     > Type 'demo()' for some demos, 'help()' for on-line help,
>     > or 'help.start()' for an HTML browser interface to help.
>     > Type 'q()' to quit R.
>
>     > Error: not a proper file name Error in
>     > doWithOneRestart(return(), restart) : promise already
>     > under evaluation: recursive default argument reference or
>     > earlier problems?  Error in tryCatchOne(, names,
>     > parentenv, handlers[[1L]]) : promise already under
>     > evaluation: recursive default argument reference or
>     > earlier problems?  Error: not a proper file name Fatal
>     > error: unable to initialize the JIT
>
>     > ----------------- snip
>     > ----------------------------------------------------------------------------------------------------------------------------
>
>     > Thank you, Ashim
>
>     > ______________________________________________
>     > R-help at r-project.org mailing list -- To UNSUBSCRIBE and
>     > more, see https://stat.ethz.ch/mailman/listinfo/r-help
>     > PLEASE do read the posting guide
>     > http://www.R-project.org/posting-guide.html and provide
>     > commented, minimal, self-contained, reproducible code.


From tmreg@06 @end|ng |rom gm@||@com  Wed Apr  7 20:49:38 2021
From: tmreg@06 @end|ng |rom gm@||@com (Tammy Regalado)
Date: Wed, 7 Apr 2021 14:49:38 -0400
Subject: [R] R Language on Windows 2019
Message-ID: <F75E6CD0-F610-4B24-BC3F-9F194148EF29@gmail.com>


What versions of Windows can R Language be installed on?  Specifically, is Windows Server 2019 a supported platform?

From g|eyne@ @end|ng |rom gm@||@com  Wed Apr  7 21:40:04 2021
From: g|eyne@ @end|ng |rom gm@||@com (Gene Leynes)
Date: Wed, 7 Apr 2021 14:40:04 -0500
Subject: [R] /usr/local/lib/R/site-library is not writable
Message-ID: <CAOBARVhbjxO04FEyZ16sEZVCixyRGmjwNWATUvsaSpn9UaHDnQ@mail.gmail.com>

Hello R Community,

I've been using R for a long time, and this is a question that still makes
me think twice every single time I install R, which is more and more often .

The first search hit is this StackOverflow question:
https://stackoverflow.com/questions/32540919/library-is-not-writable

The warning message hasn't changed over the years:

install.packages("randomForest")
Installing package into ?/usr/local/lib/R/site-library?
(as ?lib? is unspecified)
Warning in install.packages :
  'lib = "/usr/local/lib/R/site-library"' is not writable

In this question they suggest using the personal library, which is what I
end up doing as well, but some people suggest changing your group.  This
actually seems like the right answer to me, but others say they had
problems when they changed groups, which also sounds about right.

Can someone please tell me (or tell StackOverflow) the real best practice?

I've gotten into some very thorny issues with installations that can't find
any library when I deploy jobs using cron or other users, and it's hard to
remember / figure out how to install (if missing) libraries in the script
because it's hard to remember the mirror syntax.

I know there's a packrat  package, and I've invented some workarounds, but
I normally just need two or three stable packages for a particular project.
I'd bet that .libPaths would be implemented differently today, but maybe
with the right library path none of that would be necessary to understand?

My final simplified questions are:

   1. What is the best practice to install libraries so that the current
   user (Linux) can always find them?
   2. Why is the default library path not writable by default, should we
   change that?

Hope everyone's doing well out there, and I hope to see some of you at
conferences when things get back to normal.

Thank you,

Gene

	[[alternative HTML version deleted]]


From drj|m|emon @end|ng |rom gm@||@com  Thu Apr  8 00:34:25 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Thu, 8 Apr 2021 08:34:25 +1000
Subject: [R] /usr/local/lib/R/site-library is not writable
In-Reply-To: <CAOBARVhbjxO04FEyZ16sEZVCixyRGmjwNWATUvsaSpn9UaHDnQ@mail.gmail.com>
References: <CAOBARVhbjxO04FEyZ16sEZVCixyRGmjwNWATUvsaSpn9UaHDnQ@mail.gmail.com>
Message-ID: <CA+8X3fUPrfcbtDEw0xi18DMaJfpwqC9V8mB4EdaZy09G1z9VTw@mail.gmail.com>

Hi Gene,
This is probably not best practice, but I install packages as root,
which allows me to write into the default library. The restriction on
non-root users being blocked from making changes to appications is
pretty standard.

Jim

On Thu, Apr 8, 2021 at 8:18 AM Gene Leynes <gleynes at gmail.com> wrote:
>
> Hello R Community,
>
> I've been using R for a long time, and this is a question that still makes
> me think twice every single time I install R, which is more and more often .
>
> The first search hit is this StackOverflow question:
> https://stackoverflow.com/questions/32540919/library-is-not-writable
>
> The warning message hasn't changed over the years:
>
> install.packages("randomForest")
> Installing package into ?/usr/local/lib/R/site-library?
> (as ?lib? is unspecified)
> Warning in install.packages :
>   'lib = "/usr/local/lib/R/site-library"' is not writable
>
> In this question they suggest using the personal library, which is what I
> end up doing as well, but some people suggest changing your group.  This
> actually seems like the right answer to me, but others say they had
> problems when they changed groups, which also sounds about right.
>
> Can someone please tell me (or tell StackOverflow) the real best practice?
>
> I've gotten into some very thorny issues with installations that can't find
> any library when I deploy jobs using cron or other users, and it's hard to
> remember / figure out how to install (if missing) libraries in the script
> because it's hard to remember the mirror syntax.
>
> I know there's a packrat  package, and I've invented some workarounds, but
> I normally just need two or three stable packages for a particular project.
> I'd bet that .libPaths would be implemented differently today, but maybe
> with the right library path none of that would be necessary to understand?
>
> My final simplified questions are:
>
>    1. What is the best practice to install libraries so that the current
>    user (Linux) can always find them?
>    2. Why is the default library path not writable by default, should we
>    change that?
>
> Hope everyone's doing well out there, and I hope to see some of you at
> conferences when things get back to normal.
>
> Thank you,
>
> Gene
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Apr  8 00:32:32 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 7 Apr 2021 23:32:32 +0100
Subject: [R] R Language on Windows 2019
In-Reply-To: <F75E6CD0-F610-4B24-BC3F-9F194148EF29@gmail.com>
References: <F75E6CD0-F610-4B24-BC3F-9F194148EF29@gmail.com>
Message-ID: <4350e3a4-a399-5dee-0863-a9a7585fee92@sapo.pt>

Hello,

Yes, it is.
I have worked with R on Windows Server for many years with no problems 
except for the usual ones, users make something wrong, configurations, 
tool chains needing upgrading, etc. But nothing unsolvable.
Give it a try and I'm sure that you will be find it that R is great 
software with no real Windows Server 2019 compatibility problems.

Hope this helps,

Rui Barradas

?s 19:49 de 07/04/21, Tammy Regalado escreveu:
> 
> What versions of Windows can R Language be installed on?  Specifically, is Windows Server 2019 a supported platform?
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Apr  8 00:45:31 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 07 Apr 2021 15:45:31 -0700
Subject: [R] /usr/local/lib/R/site-library is not writable
In-Reply-To: <CAOBARVhbjxO04FEyZ16sEZVCixyRGmjwNWATUvsaSpn9UaHDnQ@mail.gmail.com>
References: <CAOBARVhbjxO04FEyZ16sEZVCixyRGmjwNWATUvsaSpn9UaHDnQ@mail.gmail.com>
Message-ID: <B7187B67-77A3-4306-831A-2EB3704C40E6@dcn.davis.ca.us>

1. Use a personal library. Mucking with the default library puts you at risk of changing file permissions on your personal files inadvertently and making them unusable by your normal user. Even if you did alter your user permissions so you could mess with it without elevating privileges, POSIX is designed as a multi-user system and the other users will generally not like having shared packages changed without their knowledge.

2. The default library is where R goes looking if you don't have the desired package in your personal package. It is normally updated only when the R software is updated.

On April 7, 2021 12:40:04 PM PDT, Gene Leynes <gleynes at gmail.com> wrote:
>Hello R Community,
>
>I've been using R for a long time, and this is a question that still
>makes
>me think twice every single time I install R, which is more and more
>often .
>
>The first search hit is this StackOverflow question:
>https://stackoverflow.com/questions/32540919/library-is-not-writable
>
>The warning message hasn't changed over the years:
>
>install.packages("randomForest")
>Installing package into ?/usr/local/lib/R/site-library?
>(as ?lib? is unspecified)
>Warning in install.packages :
>  'lib = "/usr/local/lib/R/site-library"' is not writable
>
>In this question they suggest using the personal library, which is what
>I
>end up doing as well, but some people suggest changing your group. 
>This
>actually seems like the right answer to me, but others say they had
>problems when they changed groups, which also sounds about right.
>
>Can someone please tell me (or tell StackOverflow) the real best
>practice?
>
>I've gotten into some very thorny issues with installations that can't
>find
>any library when I deploy jobs using cron or other users, and it's hard
>to
>remember / figure out how to install (if missing) libraries in the
>script
>because it's hard to remember the mirror syntax.
>
>I know there's a packrat  package, and I've invented some workarounds,
>but
>I normally just need two or three stable packages for a particular
>project.
>I'd bet that .libPaths would be implemented differently today, but
>maybe
>with the right library path none of that would be necessary to
>understand?
>
>My final simplified questions are:
>
>  1. What is the best practice to install libraries so that the current
>   user (Linux) can always find them?
>  2. Why is the default library path not writable by default, should we
>   change that?
>
>Hope everyone's doing well out there, and I hope to see some of you at
>conferences when things get back to normal.
>
>Thank you,
>
>Gene
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Apr  8 00:55:56 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 07 Apr 2021 15:55:56 -0700
Subject: [R] R Language on Windows 2019
In-Reply-To: <F75E6CD0-F610-4B24-BC3F-9F194148EF29@gmail.com>
References: <F75E6CD0-F610-4B24-BC3F-9F194148EF29@gmail.com>
Message-ID: <AED99293-D7E8-44CD-B569-23505E01F2EB@dcn.davis.ca.us>

There is one volunteer-supported installer for all Windows versions, and it is not built as a Windows Service. I highly doubt that any of those volunteer developers have access to Windows Server 2019... if it doesn't work there interactively then you may need to enable some level of compatibility using OS configuration tools.

On April 7, 2021 11:49:38 AM PDT, Tammy Regalado <tmrega06 at gmail.com> wrote:
>
>What versions of Windows can R Language be installed on?  Specifically,
>is Windows Server 2019 a supported platform?
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From edd @end|ng |rom deb|@n@org  Thu Apr  8 02:58:10 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Wed, 7 Apr 2021 19:58:10 -0500
Subject: [R] /usr/local/lib/R/site-library is not writable
In-Reply-To: <B7187B67-77A3-4306-831A-2EB3704C40E6@dcn.davis.ca.us>
References: <CAOBARVhbjxO04FEyZ16sEZVCixyRGmjwNWATUvsaSpn9UaHDnQ@mail.gmail.com>
 <B7187B67-77A3-4306-831A-2EB3704C40E6@dcn.davis.ca.us>
Message-ID: <24686.21794.390884.122283@rob.eddelbuettel.com>


Hi Gene,

"It's complicated". (Not really, but listen for a sec...)

We need to ship a default policy that makes sense for all / most
situations.  So

- users cannot write into /usr/local/lib/R/site-library -- unless they are
  set up to, but adding them to the 'group' that owns that directory

- root can (but ideally one should not run as root as one generally does not
  now what code you might get slipped in a tar.gz); but root can enable users

- so we recommend letting (some or all) users write there by explicitly
  adding them to an appropriate group.

Personally, I do not think personal libraries are a good idea on shared
machines because you can end up with a different set of package (versions)
than your colleague on the same machine.  And or you running shiny from $HOME
have different packages than shiny running as server. And on and on. Other
people differ, and that is fine. If one wants personal libraries one can.

I must have explained the reasoning and fixes a dozen times each on
r-sig-debian (where you could have asked this too) and StackOverflow. At
least the latter can be searched so look at this set:
https://stackoverflow.com/search?q=user%3Ame+is%3Aanser+%2Fusr%2Flocal%2Flib%2FR%2Fsite-library

Happy to take it offline too, and who knows, we even get to meet for a coffee
one of these days.

Hope this helps, Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From rhe|p @end|ng |rom eoo@@dd@@n|  Thu Apr  8 15:18:38 2021
From: rhe|p @end|ng |rom eoo@@dd@@n| (Jan van der Laan)
Date: Thu, 8 Apr 2021 15:18:38 +0200
Subject: [R] /usr/local/lib/R/site-library is not writable
In-Reply-To: <24686.21794.390884.122283@rob.eddelbuettel.com>
References: <CAOBARVhbjxO04FEyZ16sEZVCixyRGmjwNWATUvsaSpn9UaHDnQ@mail.gmail.com>
 <B7187B67-77A3-4306-831A-2EB3704C40E6@dcn.davis.ca.us>
 <24686.21794.390884.122283@rob.eddelbuettel.com>
Message-ID: <fcda6668-bf89-f68c-25a5-de6401449bd1@eoos.dds.nl>


I would actually go a step in the other direction: per project 
libraries. For example by adding a .Rprofile file to your project 
directory. This ensures that everybody working on a project uses the 
same version of the packages (even on different machines e.g. on shared 
folders).

This can give issues when a new version of R arrives, but that is 
usually easy to solve. Either hard code the path to the old R-version or 
decide to update all packages in a project to the new R-version (and 
test that everything is still working ok).

We have the most often used packages installed centrally on the 
server/network, so I actually usually end up with a mixture of central, 
personal and project libraries. Theory vs practice.

HTH,
Jan



On 08-04-2021 02:58, Dirk Eddelbuettel wrote:
> Hi Gene,
> 
> "It's complicated". (Not really, but listen for a sec...)
> 
> We need to ship a default policy that makes sense for all / most
> situations.  So
> 
> - users cannot write into /usr/local/lib/R/site-library -- unless they are
>    set up to, but adding them to the 'group' that owns that directory
> 
> - root can (but ideally one should not run as root as one generally does not
>    now what code you might get slipped in a tar.gz); but root can enable users
> 
> - so we recommend letting (some or all) users write there by explicitly
>    adding them to an appropriate group.
> 
> Personally, I do not think personal libraries are a good idea on shared
> machines because you can end up with a different set of package (versions)
> than your colleague on the same machine.  And or you running shiny from $HOME
> have different packages than shiny running as server. And on and on. Other
> people differ, and that is fine. If one wants personal libraries one can.
> 
> I must have explained the reasoning and fixes a dozen times each on
> r-sig-debian (where you could have asked this too) and StackOverflow. At
> least the latter can be searched so look at this set:
> https://stackoverflow.com/search?q=user%3Ame+is%3Aanser+%2Fusr%2Flocal%2Flib%2FR%2Fsite-library
> 
> Happy to take it offline too, and who knows, we even get to meet for a coffee
> one of these days.
> 
> Hope this helps, Dirk
>


From thebudget72 m@iii@g oii gm@ii@com  Thu Apr  8 18:10:16 2021
From: thebudget72 m@iii@g oii gm@ii@com (thebudget72 m@iii@g oii gm@ii@com)
Date: Thu, 8 Apr 2021 18:10:16 +0200
Subject: [R] Variance of the sample mean by bootstrapping
Message-ID: <966b0a1f-7cde-d69c-3727-f2281df01679@gmail.com>

Hello,

I'm studying bootstrapping.

I devised a code that draw a sample of heights, and then compute the 
sample mean of those heights.

I want to compute the variance of the sample mean by bootstrapping.

I am comparing this with the "real" variance of the sample meanand with 
an "estimated" variance of the sample mean.

Is my code correct? The results looks very similar in all three cases.

I just want to be sure that I made everything right.

Thanks in advance!

#!/usr/bin/env R

its <- 10000
mean <- 180
sd <- 50
N <- 10000

heights <- rnorm(N, mean, sd)

sample.mean <- mean(heights)

print(paste0("Real mean: ", mean))
print(paste0("Sample mean: ", sample.mean))

# unbiased sample variance
# the var() function already uses the unbiased estimator
#sample.var <- (N/(N-1))*var(heights)
sample.var <- var(heights)

mean.var.real <- (sd^2)/N
print(paste0("Actual variance of the sample mean: ", mean.var.real))

mean.var.sample <- sample.var/N
print(paste0("Estimated variance of the sample mean: ", mean.var.sample))

# Compute variance by bootstrap
boot.means <- rep(NA, its)
for(it in 1:its) {
 ? boot.h <- sample(heights, N, replace=T)
 ? boot.means[it] <- mean(boot.h)
}

mean.var.boot <- var(boot.means)
print(paste0("Bootstrapped variance of the sample mean: ", mean.var.boot))


	[[alternative HTML version deleted]]


From henr|k@bengt@@on @end|ng |rom gm@||@com  Thu Apr  8 18:28:49 2021
From: henr|k@bengt@@on @end|ng |rom gm@||@com (Henrik Bengtsson)
Date: Thu, 8 Apr 2021 09:28:49 -0700
Subject: [R] 
 R does not start from (Debian) linux command line - error with
 doWithOneRestart() - segmentation fault
In-Reply-To: <CAC8=1eqGH_edCisjEF6Me_h9EvMnriEihWUoYkaAcORy+oLJRw@mail.gmail.com>
References: <CAC8=1eoxsgbi7fc=hPXEp+HsfPwWYvMPdV9CNT+bxyb+wPAruQ@mail.gmail.com>
 <24685.23937.706650.276577@stat.math.ethz.ch>
 <CAC8=1eqGH_edCisjEF6Me_h9EvMnriEihWUoYkaAcORy+oLJRw@mail.gmail.com>
Message-ID: <CAFDcVCSLf1=kg0MnXp0QHOutVzrxOOfDrH+v3DMDuM3Sie84gQ@mail.gmail.com>

Ashim, as Martin says, there's something really weird going on with
your core R installation.  This is definitely not expected, and I
don't know think if I've every seen this reported before.  Here are
some questions/comments that might help you move forward and for
others to pitch in:

1. How did you install R?

2. What happens if you call:

$ Rscript --vanilla -e "1+2"

3. What happens if you call:

$ Rscript --vanilla --default-packages=base -e "1+2"

4. What happens if you call:

$ Rscript --vanilla --default-packages=base,methods -e "1+2"

If any of 2-4 gives a different result, that's a first clue.

/Henrik

On Wed, Apr 7, 2021 at 1:17 AM Ashim Kapoor <ashimkapoor at gmail.com> wrote:
>
> On Wed, Apr 7, 2021 at 12:51 PM Martin Maechler
> <maechler at stat.math.ethz.ch> wrote:
> >
> > >>>>> Ashim Kapoor
> > >>>>>     on Wed, 7 Apr 2021 10:35:14 +0530 writes:
> >
> >     > Dear R experts,
> >
> >     > Here is my problem :
> >
> >     > R startup FAILS with an error message. The error message
> >     > is more meaningful when I do invoke R via sudo OR as
> >     > root. I attach the startup messages when I invoke R as :
> >
> >     > 1. as non root user 2. with sudo 3. as Root user.
> >
> >     > The error messages ( mentioned in snippets below ) are
> >     > more meaningful to me in the above mentioned order.
> >
> > Thank you, Ashim.
> >
> > Yes, the messages point to something really bad.
> >
> > OTOH ("On the other hand"), what we *can* see is that you try to
> > start R version 3.6.3.
> >
>
> My apologies for not being clear.
>
> I would like to clarify :
>
> 1. The error message from the incantation `R` is not very informative.
>
> 2. The error message from the incantation `sudo R` says (among other
> things which don't seem significant to me):
> Error in doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
>   not a proper file name
>
> 3. The error message from invoking R as a root user says:
>
> Error: not a proper file name
> Fatal error: unable to initialize the JIT
>
> I found this on the internet :
> https://stackoverflow.com/questions/19512165/error-in-dowithonerestart
>
> The error messages and the above link point to issues with JAVA, but
> it does not say how to fix them.
>
> That is why I thought : there is an .xlsx file which has non english
> characters which is messing with
> Java.
>
> Query : is there a way to do JAVA garbage collection when R is not starting ?
>
> > While that is not extremely old, it may well be older than
> > several other pieces of software (or even hardware) that you are
> > running with.
> >
> > I very very  *strongly* recommend to use an R version 4.0.x ... and why not
> > use the latest  4.0.5 ?
> >
>
> We upgraded to 4.0.5 but it did not make a difference. We restarted
> the computer and that fixed the error.
> I think the JAVA garbage collection kicked in when we reset the
> computer and that is why it was fixed on rebooting. Not sure though.
>
> > Then, it may also be caused by a mismatch of system libraries
> > and your oldish version of R. ... but there I'd strongly
> > recommend consulting with other Debian users, notably as there
> > is a dedicated  mailing list  R-SIG-Debian --> do subscribe
> > there, and ask -- with more details on how you got your R: Is it
> > the default R on your Debian, which version of Debian,  etc.
> >
> > Last but not least, Dirk Eddelbuettel, the maintainer of the
> > official R Debian package maintains a nice web page -- part of
> > the official CRAN web pages, but unfortunately a bit hidden
> > nowadays, (not the least because CRAN still uses frames (w?rg!!)):
> >
> >   https://cloud.r-project.org/bin/linux/debian/
> >
> > A very nice and useful page,  much underrated and underused,
> > probably.
> >
>
> Thank you for this.
>
> > Best regards,
> >
> > Martin Maechler
> > ETH Zurich  and  R Core Team
> >
> >
> >     > When I google around for the error message, it looks like
> >     > there is an .xlsx file which has non english characters
> >     > which is messing with Java.
> >
> >     > I do not know how to fix this. I tried :-
> >
> >     > R --vanilla
> >
> >     > so that it would not use any startup scripts but that also
> >     > does not work.
> >
> >     > ----------------- snip
> >     > ----------------------------------------------------------------------------------------------------------------------------
> >
> >     > When I try to start R from the command line :
> >
> >     > ~$ R
> >
> >     >  *** caught segfault *** address (nil), cause 'unknown'
> >
> >     > Traceback: 1: NextMethod(.Generic) 2:
> >     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
> >     > testRversion(pkgInfo, package, pkgpath) 4:
> >     > library(package, lib.loc = lib.loc, character.only = TRUE,
> >     > logical.return = TRUE, warn.conflicts = warn.conflicts,
> >     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
> >     > include.only = include.only, attach.required =
> >     > attach.required) 5: doTryCatch(return(expr), name,
> >     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
> >     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
> >     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
> >     > character.only = TRUE, logical.return = TRUE,
> >     > warn.conflicts = warn.conflicts, quietly = quietly,
> >     > mask.ok = mask.ok, exclude = exclude, include.only =
> >     > include.only, attach.required = attach.required), error =
> >     > function(e) e) 9: require(pkg, quietly = TRUE,
> >     > warn.conflicts = FALSE, character.only = TRUE) 10:
> >     > .OptRequireMethods()
> >
> >     > Possible actions: 1: abort (with core dump, if enabled) 2:
> >     > normal R exit 3: exit R without saving workspace 4: exit R
> >     > saving workspace Selection: Segmentation fault
> >
> >     > ----------------- snip
> >     > ----------------------------------------------------------------------------------------------------------------------------
> >     > When I try to start R with sudo it gives a more clear
> >     > message :-
> >
> >     > ~$ sudo R
> >
> >     >  *** caught segfault *** address (nil), cause 'unknown'
> >
> >     > Traceback: 1: NextMethod(.Generic) 2:
> >     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
> >     > testRversion(pkgInfo, package, pkgpath) 4:
> >     > library(package, lib.loc = lib.loc, character.only = TRUE,
> >     > logical.return = TRUE, warn.conflicts = warn.conflicts,
> >     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
> >     > include.only = include.only, attach.required =
> >     > attach.required) 5: doTryCatch(return(expr), name,
> >     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
> >     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
> >     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
> >     > character.only = TRUE, logical.return = TRUE,
> >     > warn.conflicts = warn.conflicts, quietly = quietly,
> >     > mask.ok = mask.ok, exclude = exclude, include.only =
> >     > include.only, attach.required = attach.required), error =
> >     > function(e) e) 9: require(pkg, quietly = TRUE,
> >     > warn.conflicts = FALSE, character.only = TRUE) 10:
> >     > .OptRequireMethods()
> >
> >     > Possible actions: 1: abort (with core dump, if enabled) 2:
> >     > normal R exit 3: exit R without saving workspace 4: exit R
> >     > saving workspace Selection: Error in
> >     > doWithOneRestart(return(` \\x82\\x0ccPV`), restart) : not
> >     > a proper file name
> >
> >     > R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
> >     > Copyright (C) 2020 The R Foundation for Statistical
> >     > Computing Platform: x86_64-pc-linux-gnu (64-bit)
> >
> >     > R is free software and comes with ABSOLUTELY NO WARRANTY.
> >     > You are welcome to redistribute it under certain
> >     > conditions.  Type 'license()' or 'licence()' for
> >     > distribution details.
> >
> >     >   Natural language support but running in an English
> >     > locale
> >
> >     > R is a collaborative project with many contributors.  Type
> >     > 'contributors()' for more information and 'citation()' on
> >     > how to cite R or R packages in publications.
> >
> >     > Type 'demo()' for some demos, 'help()' for on-line help,
> >     > or 'help.start()' for an HTML browser interface to help.
> >     > Type 'q()' to quit R.
> >
> >     > Error: not a proper file name Error in
> >     > doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
> >     > promise already under evaluation: recursive default
> >     > argument reference or earlier problems?  Segmentation
> >     > fault
> >
> >     > ----------------- snip
> >     > ----------------------------------------------------------------------------------------------------------------------------
> >
> >     > Invoking R as a root user :-
> >
> >     > $ sudo -i root at crayshrimp ~ # R
> >
> >     >  *** caught segfault *** address (nil), cause 'unknown'
> >
> >     > Traceback: 1: NextMethod(.Generic) 2:
> >     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
> >     > testRversion(pkgInfo, package, pkgpath) 4:
> >     > library(package, lib.loc = lib.loc, character.only = TRUE,
> >     > logical.return = TRUE, warn.conflicts = warn.conflicts,
> >     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
> >     > include.only = include.only, attach.required =
> >     > attach.required) 5: doTryCatch(return(expr), name,
> >     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
> >     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
> >     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
> >     > character.only = TRUE, logical.return = TRUE,
> >     > warn.conflicts = warn.conflicts, quietly = quietly,
> >     > mask.ok = mask.ok, exclude = exclude, include.only =
> >     > include.only, attach.required = attach.required), error =
> >     > function(e) e) 9: require(pkg, quietly = TRUE,
> >     > warn.conflicts = FALSE, character.only = TRUE) 10:
> >     > .OptRequireMethods()
> >
> >     > Possible actions: 1: abort (with core dump, if enabled) 2:
> >     > normal R exit 3: exit R without saving workspace 4: exit R
> >     > saving workspace Selection: Error in
> >     > doWithOneRestart(return(), restart) : not a proper file
> >     > name
> >
> >     > R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
> >     > Copyright (C) 2020 The R Foundation for Statistical
> >     > Computing Platform: x86_64-pc-linux-gnu (64-bit)
> >
> >     > R is free software and comes with ABSOLUTELY NO WARRANTY.
> >     > You are welcome to redistribute it under certain
> >     > conditions.  Type 'license()' or 'licence()' for
> >     > distribution details.
> >
> >     >   Natural language support but running in an English
> >     > locale
> >
> >     > R is a collaborative project with many contributors.  Type
> >     > 'contributors()' for more information and 'citation()' on
> >     > how to cite R or R packages in publications.
> >
> >     > Type 'demo()' for some demos, 'help()' for on-line help,
> >     > or 'help.start()' for an HTML browser interface to help.
> >     > Type 'q()' to quit R.
> >
> >     > Error: not a proper file name Error in
> >     > doWithOneRestart(return(), restart) : promise already
> >     > under evaluation: recursive default argument reference or
> >     > earlier problems?  Error in tryCatchOne(, names,
> >     > parentenv, handlers[[1L]]) : promise already under
> >     > evaluation: recursive default argument reference or
> >     > earlier problems?  Error: not a proper file name Fatal
> >     > error: unable to initialize the JIT
> >
> >     > ----------------- snip
> >     > ----------------------------------------------------------------------------------------------------------------------------
> >
> >     > Thank you, Ashim
> >
> >     > ______________________________________________
> >     > R-help at r-project.org mailing list -- To UNSUBSCRIBE and
> >     > more, see https://stat.ethz.ch/mailman/listinfo/r-help
> >     > PLEASE do read the posting guide
> >     > http://www.R-project.org/posting-guide.html and provide
> >     > commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From pj@|nh@07 @end|ng |rom gm@||@com  Thu Apr  8 23:30:31 2021
From: pj@|nh@07 @end|ng |rom gm@||@com (pooja sinha)
Date: Thu, 8 Apr 2021 17:30:31 -0400
Subject: [R] Unable to extract gene list from chromosome
Message-ID: <CAGjf1cM=UhmZPbRLVwg0S6+KJ1P0CnZcH5O9f8Ozc3=vMj-uCg@mail.gmail.com>

Hi All,

I am trying to extract gene list from chromosome number and position, for
that I am using biomaRt in R but I am getting error messages as shown
below. Also below is the code I am using for extraction.

library("biomaRt")
listMarts()
ensembl <- useMart("ensembl")
datasets <- listDatasets(ensembl)
ensembl = useDataset("rnorvegicus_gene_ensembl",mart=ensembl)
AT_AC_Gene <- read.csv("AT-AC-methylkit_biomart-4-7-21.csv",header=T)
attributes <-
c("external_gene_name","ensembl_gene_id","start_position","end_position","rgd_symbol","chromosome_name")
filters <- c("chromosome_name","start","end")
values <- list(AT_AC_Gene$chr,AT_AC_Gene$start,AT_AC_Gene$end)
final_1 <- getBM(attributes=attributes, filters=filters, values=values,
mart=ensembl)

The code runs well without any error but the final1 output has 0
observations of 6 variables. Why?

Can anyone help me with this?


Thanks,

Puja

	[[alternative HTML version deleted]]


From dw|n@em|u@ @end|ng |rom comc@@t@net  Fri Apr  9 00:01:05 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Thu, 8 Apr 2021 15:01:05 -0700
Subject: [R] Unable to extract gene list from chromosome
In-Reply-To: <CAGjf1cM=UhmZPbRLVwg0S6+KJ1P0CnZcH5O9f8Ozc3=vMj-uCg@mail.gmail.com>
References: <CAGjf1cM=UhmZPbRLVwg0S6+KJ1P0CnZcH5O9f8Ozc3=vMj-uCg@mail.gmail.com>
Message-ID: <040e6438-0744-33d7-33a8-f0ffd9c18e16@comcast.net>


On 4/8/21 2:30 PM, pooja sinha wrote:
> Hi All,
>
> I am trying to extract gene list from chromosome number and position, for
> that I am using biomaRt in R but I am getting error messages as shown
> below. Also below is the code I am using for extraction.
>
> library("biomaRt")
> listMarts()
> ensembl <- useMart("ensembl")
> datasets <- listDatasets(ensembl)
> ensembl = useDataset("rnorvegicus_gene_ensembl",mart=ensembl)
> AT_AC_Gene <- read.csv("AT-AC-methylkit_biomart-4-7-21.csv",header=T)


#--- a this point I get

Error in file(file, "rt") : cannot open the connection
In addition: Warning message:
In file(file, "rt") :
 ? cannot open file 'AT-AC-methylkit_biomart-4-7-21.csv': No such file 
or directory

> attributes <-
> c("external_gene_name","ensembl_gene_id","start_position","end_position","rgd_symbol","chromosome_name")
> filters <- c("chromosome_name","start","end")
> values <- list(AT_AC_Gene$chr,AT_AC_Gene$start,AT_AC_Gene$end)
> final_1 <- getBM(attributes=attributes, filters=filters, values=values,
> mart=ensembl)
>
> The code runs well without any error but the final1 output has 0
> observations of 6 variables. Why?
>
> Can anyone help me with this?


You are more likely to get a useful response on the BioC mailing list. 
It appears you have a dependenciy of a csv file that you have not told 
us about.


-- 

David

>
>
> Thanks,
>
> Puja
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From dw|n@em|u@ @end|ng |rom comc@@t@net  Fri Apr  9 01:28:14 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Thu, 8 Apr 2021 16:28:14 -0700
Subject: [R] Unable to extract gene list from chromosome
In-Reply-To: <CAGjf1cN267Yfu8ucboLKEndDWUUyCVqYUH8vS1qBb8Xqjt6SgA@mail.gmail.com>
References: <CAGjf1cM=UhmZPbRLVwg0S6+KJ1P0CnZcH5O9f8Ozc3=vMj-uCg@mail.gmail.com>
 <040e6438-0744-33d7-33a8-f0ffd9c18e16@comcast.net>
 <CAGjf1cN267Yfu8ucboLKEndDWUUyCVqYUH8vS1qBb8Xqjt6SgA@mail.gmail.com>
Message-ID: <83a9badc-9461-61c7-c8e9-17074eb8475b@comcast.net>


On 4/8/21 3:42 PM, pooja sinha wrote:
> Hi David,
>
> Sorry I forgot to attach the file. Now it's attached.


Now when I go back and check the values of the setup variables after 
seeing an error on the last call,

Error in .processResults(postRes, mart = mart, sep = sep, fullXmlQuery = 
fullXmlQuery,? :
 ? Query ERROR: caught BioMart::Exception::Database: Error during query 
execution: You have an error in your SQL syntax; check the manual that 
corresponds to your MySQL server version for the right syntax to use 
near 'AND (main.seq_region_end_1020 >= '15108600' OR 
main.seq_region_end_1020 >= '9115' at line 1

I now notice:


AT_AC_Gene$chr

#NULL

Changing that to AT_AC_Gene$Chromosome_number gets at least a startup 
message from the server:

Batch submitting query 
[==>-------------------------------------------------------------------] 
5% eta:? 1m

Error in .processResults(postRes, mart = mart, sep = sep, fullXmlQuery = 
fullXmlQuery,? :
 ? Query ERROR: caught BioMart::Exception::Database: Error during query 
execution: You have an error in your SQL syntax; check the manual that 
corresponds to your MySQL server version for the right syntax to use 
near 'AND (main.seq_region_end_1020 >= '15108600' OR 
main.seq_region_end_1020 >= '9115' at line 1

But then I get the same error before about SQL syntax error.


Then I ran it with only complete cases and now get no error but again 
see no hits:

str(final_1)
'data.frame':??? 0 obs. of? 6 variables:
 ?$ external_gene_name: logi
 ?$ ensembl_gene_id?? : logi
 ?$ start_position??? : logi
 ?$ end_position????? : logi
 ?$ rgd_symbol??????? : logi
 ?$ chromosome_name?? : logi


I also see a lot of NA's in that dataset and when I just send the first 
10 rows of the request, I get no error (but also no matches.)


So you clearly are not giving us all the data or all the code, but I'm 
finally wondering if you just don't have an data that matches teh 
external datasets in your chosen "biomart". Can you offer a smaller 
dataset that you know with certainty should produce a match?


Alternatively, you might want to post this instead at the BioConductor 
mailing list. They are the people who have a better chance of spotting 
obvious errors. I've found two likely code-related errors but I'm not a 
computational biostatistician.

David

>
>
> Thanks,
> Puja
>
> On Thu, Apr 8, 2021 at 6:01 PM David Winsemius <dwinsemius at comcast.net 
> <mailto:dwinsemius at comcast.net>> wrote:
>
>
>     On 4/8/21 2:30 PM, pooja sinha wrote:
>     > Hi All,
>     >
>     > I am trying to extract gene list from chromosome number and
>     position, for
>     > that I am using biomaRt in R but I am getting error messages as
>     shown
>     > below. Also below is the code I am using for extraction.
>     >
>     > library("biomaRt")
>     > listMarts()
>     > ensembl <- useMart("ensembl")
>     > datasets <- listDatasets(ensembl)
>     > ensembl = useDataset("rnorvegicus_gene_ensembl",mart=ensembl)
>     > AT_AC_Gene <-
>     read.csv("AT-AC-methylkit_biomart-4-7-21.csv",header=T)
>
>
>     #--- a this point I get
>
>     Error in file(file, "rt") : cannot open the connection
>     In addition: Warning message:
>     In file(file, "rt") :
>     ?? cannot open file 'AT-AC-methylkit_biomart-4-7-21.csv': No such
>     file
>     or directory
>
>     > attributes <-
>     >
>     c("external_gene_name","ensembl_gene_id","start_position","end_position","rgd_symbol","chromosome_name")
>     > filters <- c("chromosome_name","start","end")
>     > values <- list(AT_AC_Gene$chr,AT_AC_Gene$start,AT_AC_Gene$end)
>     > final_1 <- getBM(attributes=attributes, filters=filters,
>     values=values,
>     > mart=ensembl)
>     >
>     > The code runs well without any error but the final1 output has 0
>     > observations of 6 variables. Why?
>     >
>     > Can anyone help me with this?
>
>
>     You are more likely to get a useful response on the BioC mailing
>     list.
>     It appears you have a dependenciy of a csv file that you have not
>     told
>     us about.
>
>
>     -- 
>
>     David
>
>     >
>     >
>     > Thanks,
>     >
>     > Puja
>     >
>     >? ? ? ?[[alternative HTML version deleted]]
>     >
>     > ______________________________________________
>     > R-help at r-project.org <mailto:R-help at r-project.org> mailing list
>     -- To UNSUBSCRIBE and more, see
>     > https://stat.ethz.ch/mailman/listinfo/r-help
>     > PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @@h|mk@poor @end|ng |rom gm@||@com  Fri Apr  9 06:27:58 2021
From: @@h|mk@poor @end|ng |rom gm@||@com (Ashim Kapoor)
Date: Fri, 9 Apr 2021 09:57:58 +0530
Subject: [R] 
 R does not start from (Debian) linux command line - error with
 doWithOneRestart() - segmentation fault
In-Reply-To: <CAFDcVCSLf1=kg0MnXp0QHOutVzrxOOfDrH+v3DMDuM3Sie84gQ@mail.gmail.com>
References: <CAC8=1eoxsgbi7fc=hPXEp+HsfPwWYvMPdV9CNT+bxyb+wPAruQ@mail.gmail.com>
 <24685.23937.706650.276577@stat.math.ethz.ch>
 <CAC8=1eqGH_edCisjEF6Me_h9EvMnriEihWUoYkaAcORy+oLJRw@mail.gmail.com>
 <CAFDcVCSLf1=kg0MnXp0QHOutVzrxOOfDrH+v3DMDuM3Sie84gQ@mail.gmail.com>
Message-ID: <CAC8=1erP7aZss-=sbru0zmKM7G+kF6vQeJ8_PO3WjrvMmNe_qg@mail.gmail.com>

Dear Henrik,

We upgraded R and rebooted the computer and the error went away. Hence
I do not think we will get any strange results anymore.

Still, I could be mistaken and I am still curious as to what happened
to my R installation. Please find the answers inline below.

On Thu, Apr 8, 2021 at 9:59 PM Henrik Bengtsson
<henrik.bengtsson at gmail.com> wrote:
>
> Ashim, as Martin says, there's something really weird going on with
> your core R installation.  This is definitely not expected, and I
> don't know think if I've every seen this reported before.  Here are
> some questions/comments that might help you move forward and for
> others to pitch in:
>
> 1. How did you install R?
>

IIRC I installed R by doing:

apt-get install r-base r-base-dev

( following the instructions on this page :
https://cloud.r-project.org/ ) I went to this page and clicked on
"Download R for Linux" and then clicked on  "debian". I think, since
the page uses frames, the url does not change when I do those 2 steps.

> 2. What happens if you call:
>
> $ Rscript --vanilla -e "1+2"
>

$ Rscript --vanilla -e "1+2"
[1] 3


> 3. What happens if you call:
>
> $ Rscript --vanilla --default-packages=base -e "1+2"
>

$ Rscript --vanilla --default-packages=base -e "1+2"
[1] 3

> 4. What happens if you call:
>
> $ Rscript --vanilla --default-packages=base,methods -e "1+2"
>
$ Rscript --vanilla --default-packages=base,methods -e "1+2"
[1] 3

> If any of 2-4 gives a different result, that's a first clue.
>
> /Henrik
>

Many thanks for your help,
Best Regards,
Ashim

> On Wed, Apr 7, 2021 at 1:17 AM Ashim Kapoor <ashimkapoor at gmail.com> wrote:
> >
> > On Wed, Apr 7, 2021 at 12:51 PM Martin Maechler
> > <maechler at stat.math.ethz.ch> wrote:
> > >
> > > >>>>> Ashim Kapoor
> > > >>>>>     on Wed, 7 Apr 2021 10:35:14 +0530 writes:
> > >
> > >     > Dear R experts,
> > >
> > >     > Here is my problem :
> > >
> > >     > R startup FAILS with an error message. The error message
> > >     > is more meaningful when I do invoke R via sudo OR as
> > >     > root. I attach the startup messages when I invoke R as :
> > >
> > >     > 1. as non root user 2. with sudo 3. as Root user.
> > >
> > >     > The error messages ( mentioned in snippets below ) are
> > >     > more meaningful to me in the above mentioned order.
> > >
> > > Thank you, Ashim.
> > >
> > > Yes, the messages point to something really bad.
> > >
> > > OTOH ("On the other hand"), what we *can* see is that you try to
> > > start R version 3.6.3.
> > >
> >
> > My apologies for not being clear.
> >
> > I would like to clarify :
> >
> > 1. The error message from the incantation `R` is not very informative.
> >
> > 2. The error message from the incantation `sudo R` says (among other
> > things which don't seem significant to me):
> > Error in doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
> >   not a proper file name
> >
> > 3. The error message from invoking R as a root user says:
> >
> > Error: not a proper file name
> > Fatal error: unable to initialize the JIT
> >
> > I found this on the internet :
> > https://stackoverflow.com/questions/19512165/error-in-dowithonerestart
> >
> > The error messages and the above link point to issues with JAVA, but
> > it does not say how to fix them.
> >
> > That is why I thought : there is an .xlsx file which has non english
> > characters which is messing with
> > Java.
> >
> > Query : is there a way to do JAVA garbage collection when R is not starting ?
> >
> > > While that is not extremely old, it may well be older than
> > > several other pieces of software (or even hardware) that you are
> > > running with.
> > >
> > > I very very  *strongly* recommend to use an R version 4.0.x ... and why not
> > > use the latest  4.0.5 ?
> > >
> >
> > We upgraded to 4.0.5 but it did not make a difference. We restarted
> > the computer and that fixed the error.
> > I think the JAVA garbage collection kicked in when we reset the
> > computer and that is why it was fixed on rebooting. Not sure though.
> >
> > > Then, it may also be caused by a mismatch of system libraries
> > > and your oldish version of R. ... but there I'd strongly
> > > recommend consulting with other Debian users, notably as there
> > > is a dedicated  mailing list  R-SIG-Debian --> do subscribe
> > > there, and ask -- with more details on how you got your R: Is it
> > > the default R on your Debian, which version of Debian,  etc.
> > >
> > > Last but not least, Dirk Eddelbuettel, the maintainer of the
> > > official R Debian package maintains a nice web page -- part of
> > > the official CRAN web pages, but unfortunately a bit hidden
> > > nowadays, (not the least because CRAN still uses frames (w?rg!!)):
> > >
> > >   https://cloud.r-project.org/bin/linux/debian/
> > >
> > > A very nice and useful page,  much underrated and underused,
> > > probably.
> > >
> >
> > Thank you for this.
> >
> > > Best regards,
> > >
> > > Martin Maechler
> > > ETH Zurich  and  R Core Team
> > >
> > >
> > >     > When I google around for the error message, it looks like
> > >     > there is an .xlsx file which has non english characters
> > >     > which is messing with Java.
> > >
> > >     > I do not know how to fix this. I tried :-
> > >
> > >     > R --vanilla
> > >
> > >     > so that it would not use any startup scripts but that also
> > >     > does not work.
> > >
> > >     > ----------------- snip
> > >     > ----------------------------------------------------------------------------------------------------------------------------
> > >
> > >     > When I try to start R from the command line :
> > >
> > >     > ~$ R
> > >
> > >     >  *** caught segfault *** address (nil), cause 'unknown'
> > >
> > >     > Traceback: 1: NextMethod(.Generic) 2:
> > >     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
> > >     > testRversion(pkgInfo, package, pkgpath) 4:
> > >     > library(package, lib.loc = lib.loc, character.only = TRUE,
> > >     > logical.return = TRUE, warn.conflicts = warn.conflicts,
> > >     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
> > >     > include.only = include.only, attach.required =
> > >     > attach.required) 5: doTryCatch(return(expr), name,
> > >     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
> > >     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
> > >     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
> > >     > character.only = TRUE, logical.return = TRUE,
> > >     > warn.conflicts = warn.conflicts, quietly = quietly,
> > >     > mask.ok = mask.ok, exclude = exclude, include.only =
> > >     > include.only, attach.required = attach.required), error =
> > >     > function(e) e) 9: require(pkg, quietly = TRUE,
> > >     > warn.conflicts = FALSE, character.only = TRUE) 10:
> > >     > .OptRequireMethods()
> > >
> > >     > Possible actions: 1: abort (with core dump, if enabled) 2:
> > >     > normal R exit 3: exit R without saving workspace 4: exit R
> > >     > saving workspace Selection: Segmentation fault
> > >
> > >     > ----------------- snip
> > >     > ----------------------------------------------------------------------------------------------------------------------------
> > >     > When I try to start R with sudo it gives a more clear
> > >     > message :-
> > >
> > >     > ~$ sudo R
> > >
> > >     >  *** caught segfault *** address (nil), cause 'unknown'
> > >
> > >     > Traceback: 1: NextMethod(.Generic) 2:
> > >     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
> > >     > testRversion(pkgInfo, package, pkgpath) 4:
> > >     > library(package, lib.loc = lib.loc, character.only = TRUE,
> > >     > logical.return = TRUE, warn.conflicts = warn.conflicts,
> > >     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
> > >     > include.only = include.only, attach.required =
> > >     > attach.required) 5: doTryCatch(return(expr), name,
> > >     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
> > >     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
> > >     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
> > >     > character.only = TRUE, logical.return = TRUE,
> > >     > warn.conflicts = warn.conflicts, quietly = quietly,
> > >     > mask.ok = mask.ok, exclude = exclude, include.only =
> > >     > include.only, attach.required = attach.required), error =
> > >     > function(e) e) 9: require(pkg, quietly = TRUE,
> > >     > warn.conflicts = FALSE, character.only = TRUE) 10:
> > >     > .OptRequireMethods()
> > >
> > >     > Possible actions: 1: abort (with core dump, if enabled) 2:
> > >     > normal R exit 3: exit R without saving workspace 4: exit R
> > >     > saving workspace Selection: Error in
> > >     > doWithOneRestart(return(` \\x82\\x0ccPV`), restart) : not
> > >     > a proper file name
> > >
> > >     > R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
> > >     > Copyright (C) 2020 The R Foundation for Statistical
> > >     > Computing Platform: x86_64-pc-linux-gnu (64-bit)
> > >
> > >     > R is free software and comes with ABSOLUTELY NO WARRANTY.
> > >     > You are welcome to redistribute it under certain
> > >     > conditions.  Type 'license()' or 'licence()' for
> > >     > distribution details.
> > >
> > >     >   Natural language support but running in an English
> > >     > locale
> > >
> > >     > R is a collaborative project with many contributors.  Type
> > >     > 'contributors()' for more information and 'citation()' on
> > >     > how to cite R or R packages in publications.
> > >
> > >     > Type 'demo()' for some demos, 'help()' for on-line help,
> > >     > or 'help.start()' for an HTML browser interface to help.
> > >     > Type 'q()' to quit R.
> > >
> > >     > Error: not a proper file name Error in
> > >     > doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
> > >     > promise already under evaluation: recursive default
> > >     > argument reference or earlier problems?  Segmentation
> > >     > fault
> > >
> > >     > ----------------- snip
> > >     > ----------------------------------------------------------------------------------------------------------------------------
> > >
> > >     > Invoking R as a root user :-
> > >
> > >     > $ sudo -i root at crayshrimp ~ # R
> > >
> > >     >  *** caught segfault *** address (nil), cause 'unknown'
> > >
> > >     > Traceback: 1: NextMethod(.Generic) 2:
> > >     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
> > >     > testRversion(pkgInfo, package, pkgpath) 4:
> > >     > library(package, lib.loc = lib.loc, character.only = TRUE,
> > >     > logical.return = TRUE, warn.conflicts = warn.conflicts,
> > >     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
> > >     > include.only = include.only, attach.required =
> > >     > attach.required) 5: doTryCatch(return(expr), name,
> > >     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
> > >     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
> > >     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
> > >     > character.only = TRUE, logical.return = TRUE,
> > >     > warn.conflicts = warn.conflicts, quietly = quietly,
> > >     > mask.ok = mask.ok, exclude = exclude, include.only =
> > >     > include.only, attach.required = attach.required), error =
> > >     > function(e) e) 9: require(pkg, quietly = TRUE,
> > >     > warn.conflicts = FALSE, character.only = TRUE) 10:
> > >     > .OptRequireMethods()
> > >
> > >     > Possible actions: 1: abort (with core dump, if enabled) 2:
> > >     > normal R exit 3: exit R without saving workspace 4: exit R
> > >     > saving workspace Selection: Error in
> > >     > doWithOneRestart(return(), restart) : not a proper file
> > >     > name
> > >
> > >     > R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
> > >     > Copyright (C) 2020 The R Foundation for Statistical
> > >     > Computing Platform: x86_64-pc-linux-gnu (64-bit)
> > >
> > >     > R is free software and comes with ABSOLUTELY NO WARRANTY.
> > >     > You are welcome to redistribute it under certain
> > >     > conditions.  Type 'license()' or 'licence()' for
> > >     > distribution details.
> > >
> > >     >   Natural language support but running in an English
> > >     > locale
> > >
> > >     > R is a collaborative project with many contributors.  Type
> > >     > 'contributors()' for more information and 'citation()' on
> > >     > how to cite R or R packages in publications.
> > >
> > >     > Type 'demo()' for some demos, 'help()' for on-line help,
> > >     > or 'help.start()' for an HTML browser interface to help.
> > >     > Type 'q()' to quit R.
> > >
> > >     > Error: not a proper file name Error in
> > >     > doWithOneRestart(return(), restart) : promise already
> > >     > under evaluation: recursive default argument reference or
> > >     > earlier problems?  Error in tryCatchOne(, names,
> > >     > parentenv, handlers[[1L]]) : promise already under
> > >     > evaluation: recursive default argument reference or
> > >     > earlier problems?  Error: not a proper file name Fatal
> > >     > error: unable to initialize the JIT
> > >
> > >     > ----------------- snip
> > >     > ----------------------------------------------------------------------------------------------------------------------------
> > >
> > >     > Thank you, Ashim
> > >
> > >     > ______________________________________________
> > >     > R-help at r-project.org mailing list -- To UNSUBSCRIBE and
> > >     > more, see https://stat.ethz.ch/mailman/listinfo/r-help
> > >     > PLEASE do read the posting guide
> > >     > http://www.R-project.org/posting-guide.html and provide
> > >     > commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.


From petr@p|k@| @end|ng |rom prechez@@cz  Fri Apr  9 11:29:31 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Fri, 9 Apr 2021 09:29:31 +0000
Subject: [R] Plotting adjusted KM curve
In-Reply-To: <MN2PR03MB5167831095C7DEFEFAF23E76E2779@MN2PR03MB5167.namprd03.prod.outlook.com>
References: <MN2PR03MB5167831095C7DEFEFAF23E76E2779@MN2PR03MB5167.namprd03.prod.outlook.com>
Message-ID: <23cdd4bece7341848889f9422e9386b3@SRVEXCHCM1302.precheza.cz>

Hi

Google answered

https://rdrr.io/bioc/survcomp/man/km.coxph.plot.html

Is it what do you want?

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Sorkin, John
> Sent: Monday, April 5, 2021 3:35 AM
> To: r-help at r-project.org (r-help at r-project.org) <r-help at r-project.org>
> Subject: [R] Plotting adjusted KM curve
> 
> Colleagues,
> I am using the coxph to model survival time. How do I plot an adjusted
Kaplan
> Meir plot resulting from coxph? The code I would like to run would start
with:
> 
> # run cox model
> fit1Cox <- coxph(surv_object ~age+sex,data=mydata)
> 
> I have no idea what would follow.
> 
> I would like to plot adjusted KM curves for men vs. women at age 65.
> 
> Thank you,
> John
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

From grond @end|ng |rom number|@nd@de  Fri Apr  9 11:48:55 2021
From: grond @end|ng |rom number|@nd@de (Wolfgang Grond)
Date: Fri, 9 Apr 2021 11:48:55 +0200
Subject: [R] Assigning several lists to variables whose names are contained
 in other variables
Message-ID: <557f5c83-003f-4406-a717-c8a2c3f160ff@numberland.de>

Dear all,

I'm creating a list (which is a tbl_graph) by a function, and assign the 
result to a variable:

subnet_MYSUBNET <- my_function(MYSUBNET)

# MYSUBNET: a tbl_graph

Because there are multiple subnets to create, I can get the names of the 
subnets (MYSUBNET1, MYSUBNET2, MYSUBNET3, etc.) from a row in a 
dataframe column.

subnet_MYSUBNET <- my_function(datatable$column[i])

Because I know how many subnets to create - nrow(dataframe) I want to 
assign the subnets to variables whose names contain the name of the subnet

For this to work I have to assign a variable name which is contained in 
an other variable name:

#################

for(i in 1:nrow(datatable)) {

val <- datatable$column[i]

result <- assign(paste("subnet_",? val, sep = "")

result <- my_function(val)

}

this works in bash, but seems not to work in R - I don't succeed at least.

Am I wrong?

Where is my mistake?

Many thanks in advance for any hint.

Wolfgang



	[[alternative HTML version deleted]]


From petr@p|k@| @end|ng |rom prechez@@cz  Fri Apr  9 12:28:58 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Fri, 9 Apr 2021 10:28:58 +0000
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <557f5c83-003f-4406-a717-c8a2c3f160ff@numberland.de>
References: <557f5c83-003f-4406-a717-c8a2c3f160ff@numberland.de>
Message-ID: <dd7b2f2acaa24a819c9a6909638ec79a@SRVEXCHCM1302.precheza.cz>

Hi


I may be wrong but

> result <- assign(paste("subnet_",  val, sep = "")
here you miss the right parentheses
maybe you intended
assign(result, paste("subnet_",  val, sep = ""))

> result <- my_function(val)
but here you change (rewrite) the result variable to my_function result

So your overall cycle gives you only one result variable containing last value 
computed by my_function.

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Wolfgang Grond
> Sent: Friday, April 9, 2021 11:49 AM
> To: mailman, r-help <r-help at r-project.org>
> Subject: [R] Assigning several lists to variables whose names are contained 
> in
> other variables
>
> Dear all,
>
> I'm creating a list (which is a tbl_graph) by a function, and assign the 
> result to
> a variable:
>
> subnet_MYSUBNET <- my_function(MYSUBNET)
>
> # MYSUBNET: a tbl_graph
>
> Because there are multiple subnets to create, I can get the names of the
> subnets (MYSUBNET1, MYSUBNET2, MYSUBNET3, etc.) from a row in a
> dataframe column.
>
> subnet_MYSUBNET <- my_function(datatable$column[i])
>
> Because I know how many subnets to create - nrow(dataframe) I want to
> assign the subnets to variables whose names contain the name of the subnet
>
> For this to work I have to assign a variable name which is contained in an
> other variable name:
>
> #################
>
> for(i in 1:nrow(datatable)) {
>
> val <- datatable$column[i]
>
> result <- assign(paste("subnet_",  val, sep = "")
>
> result <- my_function(val)
>
> }
>
> this works in bash, but seems not to work in R - I don't succeed at least.
>
> Am I wrong?
>
> Where is my mistake?
>
> Many thanks in advance for any hint.
>
> Wolfgang
>
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

From m|n@h@|| @end|ng |rom um|ch@edu  Fri Apr  9 12:35:40 2021
From: m|n@h@|| @end|ng |rom um|ch@edu (Greg Minshall)
Date: Fri, 09 Apr 2021 13:35:40 +0300
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: Your message of "Fri, 09 Apr 2021 11:48:55 +0200."
 <557f5c83-003f-4406-a717-c8a2c3f160ff@numberland.de>
Message-ID: <1154678.1617964540@apollo2.minshall.org>

Wolfgang,

> result <- assign(paste("subnet_",? val, sep = "")
> 
> result <- my_function(val)

i don't understand why you are twice assigning to =result=.  also, the
first assignment doesn't seem well formatted (t's missing a value?).

did you mean something like

: assign(paste("subnet_",? val, sep = ""), my_function(val))

(which i would think should work)?

cheers, Greg


From gor@n@bro@trom @end|ng |rom umu@@e  Fri Apr  9 13:13:00 2021
From: gor@n@bro@trom @end|ng |rom umu@@e (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Fri, 9 Apr 2021 13:13:00 +0200
Subject: [R] Plotting adjusted KM curve
In-Reply-To: <MN2PR03MB5167831095C7DEFEFAF23E76E2779@MN2PR03MB5167.namprd03.prod.outlook.com>
References: <MN2PR03MB5167831095C7DEFEFAF23E76E2779@MN2PR03MB5167.namprd03.prod.outlook.com>
Message-ID: <fee46fac-89ef-9bb4-303d-b8c7a7ba8f99@umu.se>



On 2021-04-05 03:34, Sorkin, John wrote:
> Colleagues,
> I am using the coxph to model survival time. How do I plot an adjusted Kaplan Meir plot resulting from coxph? The code I would like to run would start with:
> 
> # run cox model
> fit1Cox <- coxph(surv_object ~age+sex,data=mydata)
> 
> I have no idea what would follow.

You should look at

?survfit.coxph

in the survival package, especially the 'newdata' argument.
> 
> I would like to plot adjusted KM curves for men vs. women at age 65.

Then I guess that you should stratify on sex:

fit <- coxph(surv_object ~ age + strata(sex), data = mydata)

sfit <- survfit(fit, newdata = data.frame(age = 65))
plot(sfit)

HTW, G?ran

> 
> Thank you,
> John
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Apr  9 13:43:57 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 9 Apr 2021 14:43:57 +0300
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <557f5c83-003f-4406-a717-c8a2c3f160ff@numberland.de>
References: <557f5c83-003f-4406-a717-c8a2c3f160ff@numberland.de>
Message-ID: <20210409144357.06211e46@arachnoid>

Dear Wolfgang,

On Fri, 9 Apr 2021 11:48:55 +0200
Wolfgang Grond <grond at numberland.de> wrote:

> I want to assign the subnets to variables whose names contain the
> name of the subnet

Apologies if this sounds too opinionated, but creating variable names
from variable values is a FAQ in a different dynamic language:

https://perldoc.perl.org/perlfaq7#How-can-I-use-a-variable-as-a-variable-name?

Most of the explanation doesn't apply to R, of course, but the main
idea here is to use data structures instead of causing (potential,
unlikely, but still) conflicts in the variable namespace. What if you
create a list of function values instead of just a bunch of variables?

results <- list()
for(i in 1:nrow(datatable)) {
	val <- datatable$column[i]
	results[[as.character(val)]] <- my_function(val)
}

Or even

results <- lapply(setNames(nm = datatable$column), my_function)

Wouldn't that be more convenient?

-- 
Best regards,
Ivan


From pj@|nh@07 @end|ng |rom gm@||@com  Fri Apr  9 00:42:05 2021
From: pj@|nh@07 @end|ng |rom gm@||@com (pooja sinha)
Date: Thu, 8 Apr 2021 18:42:05 -0400
Subject: [R] Unable to extract gene list from chromosome
In-Reply-To: <040e6438-0744-33d7-33a8-f0ffd9c18e16@comcast.net>
References: <CAGjf1cM=UhmZPbRLVwg0S6+KJ1P0CnZcH5O9f8Ozc3=vMj-uCg@mail.gmail.com>
 <040e6438-0744-33d7-33a8-f0ffd9c18e16@comcast.net>
Message-ID: <CAGjf1cN267Yfu8ucboLKEndDWUUyCVqYUH8vS1qBb8Xqjt6SgA@mail.gmail.com>

Hi David,

Sorry I forgot to attach the file. Now it's attached.


Thanks,
Puja

On Thu, Apr 8, 2021 at 6:01 PM David Winsemius <dwinsemius at comcast.net>
wrote:

>
> On 4/8/21 2:30 PM, pooja sinha wrote:
> > Hi All,
> >
> > I am trying to extract gene list from chromosome number and position, for
> > that I am using biomaRt in R but I am getting error messages as shown
> > below. Also below is the code I am using for extraction.
> >
> > library("biomaRt")
> > listMarts()
> > ensembl <- useMart("ensembl")
> > datasets <- listDatasets(ensembl)
> > ensembl = useDataset("rnorvegicus_gene_ensembl",mart=ensembl)
> > AT_AC_Gene <- read.csv("AT-AC-methylkit_biomart-4-7-21.csv",header=T)
>
>
> #--- a this point I get
>
> Error in file(file, "rt") : cannot open the connection
> In addition: Warning message:
> In file(file, "rt") :
>    cannot open file 'AT-AC-methylkit_biomart-4-7-21.csv': No such file
> or directory
>
> > attributes <-
> >
> c("external_gene_name","ensembl_gene_id","start_position","end_position","rgd_symbol","chromosome_name")
> > filters <- c("chromosome_name","start","end")
> > values <- list(AT_AC_Gene$chr,AT_AC_Gene$start,AT_AC_Gene$end)
> > final_1 <- getBM(attributes=attributes, filters=filters, values=values,
> > mart=ensembl)
> >
> > The code runs well without any error but the final1 output has 0
> > observations of 6 variables. Why?
> >
> > Can anyone help me with this?
>
>
> You are more likely to get a useful response on the BioC mailing list.
> It appears you have a dependenciy of a csv file that you have not told
> us about.
>
>
> --
>
> David
>
> >
> >
> > Thanks,
> >
> > Puja
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

From wgrond @end|ng |rom wgrond@de  Fri Apr  9 14:14:47 2021
From: wgrond @end|ng |rom wgrond@de (Wolfgang Grond)
Date: Fri, 09 Apr 2021 14:14:47 +0200
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <20210409144357.06211e46@arachnoid>
References: <557f5c83-003f-4406-a717-c8a2c3f160ff@numberland.de>
 <20210409144357.06211e46@arachnoid>
Message-ID: <04B79467-3219-4DDF-810C-35667463970A@wgrond.de>

Dear Ivan,

when I try your solution with lapply as below I get the following error message:

Error in eval ... : object 'function' not found ( I think anything about my_function is meant).

Am 9. April 2021 13:43:57 MESZ schrieb Ivan Krylov <krylov.r00t at gmail.com>:
>Dear Wolfgang,
>
>On Fri, 9 Apr 2021 11:48:55 +0200
>Wolfgang Grond <grond at numberland.de> wrote:
>
>> I want to assign the subnets to variables whose names contain the
>> name of the subnet
>
>Apologies if this sounds too opinionated, but creating variable names
>from variable values is a FAQ in a different dynamic language:
>
>https://perldoc.perl.org/perlfaq7#How-can-I-use-a-variable-as-a-variable-name?
>
>Most of the explanation doesn't apply to R, of course, but the main
>idea here is to use data structures instead of causing (potential,
>unlikely, but still) conflicts in the variable namespace. What if you
>create a list of function values instead of just a bunch of variables?
>
>results <- list()
>for(i in 1:nrow(datatable)) {
>	val <- datatable$column[i]
>	results[[as.character(val)]] <- my_function(val)
>}
>
>Or even
>
>results <- lapply(setNames(nm = datatable$column), my_function)
>
>Wouldn't that be more convenient?
>
>-- 
>Best regards,
>Ivan
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From wgrond @end|ng |rom wgrond@de  Fri Apr  9 14:17:24 2021
From: wgrond @end|ng |rom wgrond@de (Wolfgang Grond)
Date: Fri, 09 Apr 2021 14:17:24 +0200
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <20210409144357.06211e46@arachnoid>
References: <557f5c83-003f-4406-a717-c8a2c3f160ff@numberland.de>
 <20210409144357.06211e46@arachnoid>
Message-ID: <5FBE1A74-2C54-4E51-AAB5-4FD2FAE5D82E@wgrond.de>

Ivan,

same situation when I try your list() solution:

Error in eval ... : object 'function' not found ( I think anything about my_function is meant).


Am 9. April 2021 13:43:57 MESZ schrieb Ivan Krylov <krylov.r00t at gmail.com>:
>Dear Wolfgang,
>
>On Fri, 9 Apr 2021 11:48:55 +0200
>Wolfgang Grond <grond at numberland.de> wrote:
>
>> I want to assign the subnets to variables whose names contain the
>> name of the subnet
>
>Apologies if this sounds too opinionated, but creating variable names
>from variable values is a FAQ in a different dynamic language:
>
>https://perldoc.perl.org/perlfaq7#How-can-I-use-a-variable-as-a-variable-name?
>
>Most of the explanation doesn't apply to R, of course, but the main
>idea here is to use data structures instead of causing (potential,
>unlikely, but still) conflicts in the variable namespace. What if you
>create a list of function values instead of just a bunch of variables?
>
>results <- list()
>for(i in 1:nrow(datatable)) {
>	val <- datatable$column[i]
>	results[[as.character(val)]] <- my_function(val)
>}
>
>Or even
>
>results <- lapply(setNames(nm = datatable$column), my_function)
>
>Wouldn't that be more convenient?
>
>-- 
>Best regards,
>Ivan
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.


-
Numberland - Dr. Wolfgang Grond
Diplomphysiker, TQM-Assessor (EFQM)
Six Sigma Green Belt
Ingenieurb?ro / Engineering Consultancy
Lohfeld 20, DE-95326 Kulmbach, Germany
Phone: +49 9221 6919131
Fax: +49 9221 6919156
Mail: grond at numberland.com
URL: http://www.numberland.com
	[[alternative HTML version deleted]]


From wgrond @end|ng |rom wgrond@de  Fri Apr  9 14:21:13 2021
From: wgrond @end|ng |rom wgrond@de (Wolfgang Grond)
Date: Fri, 09 Apr 2021 14:21:13 +0200
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <1154678.1617964540@apollo2.minshall.org>
References: <1154678.1617964540@apollo2.minshall.org>
Message-ID: <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>

Greg,

here I get the error message:

Error my_function(val) :

cannot find function my_function.

Am 9. April 2021 12:35:40 MESZ schrieb Greg Minshall <minshall at umich.edu>:
>Wolfgang,
>
>> result <- assign(paste("subnet_",? val, sep = "")
>> 
>> result <- my_function(val)
>
>i don't understand why you are twice assigning to =result=.  also, the
>first assignment doesn't seem well formatted (t's missing a value?).
>
>did you mean something like
>
>: assign(paste("subnet_",? val, sep = ""), my_function(val))
>
>(which i would think should work)?
>
>cheers, Greg
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.


-
Numberland - Dr. Wolfgang Grond
Diplomphysiker, TQM-Assessor (EFQM)
Six Sigma Green Belt
Ingenieurb?ro / Engineering Consultancy
Lohfeld 20, DE-95326 Kulmbach, Germany
Phone: +49 9221 6919131
Fax: +49 9221 6919156
Mail: grond at numberland.com
URL: http://www.numberland.com
	[[alternative HTML version deleted]]


From pj@|nh@07 @end|ng |rom gm@||@com  Fri Apr  9 15:34:08 2021
From: pj@|nh@07 @end|ng |rom gm@||@com (pooja sinha)
Date: Fri, 9 Apr 2021 09:34:08 -0400
Subject: [R] Unable to extract gene list from chromosome
In-Reply-To: <83a9badc-9461-61c7-c8e9-17074eb8475b@comcast.net>
References: <CAGjf1cM=UhmZPbRLVwg0S6+KJ1P0CnZcH5O9f8Ozc3=vMj-uCg@mail.gmail.com>
 <040e6438-0744-33d7-33a8-f0ffd9c18e16@comcast.net>
 <CAGjf1cN267Yfu8ucboLKEndDWUUyCVqYUH8vS1qBb8Xqjt6SgA@mail.gmail.com>
 <83a9badc-9461-61c7-c8e9-17074eb8475b@comcast.net>
Message-ID: <CAGjf1cMe+fkzJmFmdLj0JVWaTmWpooUQ0NdDPvXrXRhmyK-NZA@mail.gmail.com>

Hi David,

That's the only file I have for analysis and I am also getting the final_1
as 0 obs. of  6 variables. My problem is that I am not getting any output.
It seems like I am missing something in the* values* code but I don't know
what. Just for your hint I googled and some people have suggested using
values as vectors which I do not understand. Also when I pick one row of
the start column and do it on the interactive phase it's giving the result
but it's not possible to do one by one due to the large no. of rows. I
posted my problem in biostars but am still waiting for someone to reply.

Thanks,
Puja

On Thu, Apr 8, 2021 at 7:28 PM David Winsemius <dwinsemius at comcast.net>
wrote:

>
> On 4/8/21 3:42 PM, pooja sinha wrote:
>
> Hi David,
>
> Sorry I forgot to attach the file. Now it's attached.
>
>
> Now when I go back and check the values of the setup variables after
> seeing an error on the last call,
>
> Error in .processResults(postRes, mart = mart, sep = sep, fullXmlQuery =
> fullXmlQuery,  :
>   Query ERROR: caught BioMart::Exception::Database: Error during query
> execution: You have an error in your SQL syntax; check the manual that
> corresponds to your MySQL server version for the right syntax to use near
> 'AND (main.seq_region_end_1020 >= '15108600' OR main.seq_region_end_1020 >=
> '9115' at line 1
>
> I now notice:
>
>
> AT_AC_Gene$chr
>
> #NULL
>
> Changing that to AT_AC_Gene$Chromosome_number gets at least a startup
> message from the server:
>
> Batch submitting query
> [==>-------------------------------------------------------------------]
> 5% eta:  1m
>
> Error in .processResults(postRes, mart = mart, sep = sep, fullXmlQuery =
> fullXmlQuery,  :
>   Query ERROR: caught BioMart::Exception::Database: Error during query
> execution: You have an error in your SQL syntax; check the manual that
> corresponds to your MySQL server version for the right syntax to use near
> 'AND (main.seq_region_end_1020 >= '15108600' OR main.seq_region_end_1020 >=
> '9115' at line 1
>
> But then I get the same error before about SQL syntax error.
>
>
> Then I ran it with only complete cases and now get no error but again see
> no hits:
>
> str(final_1)
> 'data.frame':    0 obs. of  6 variables:
>  $ external_gene_name: logi
>  $ ensembl_gene_id   : logi
>  $ start_position    : logi
>  $ end_position      : logi
>  $ rgd_symbol        : logi
>  $ chromosome_name   : logi
>
>
> I also see a lot of NA's in that dataset and when I just send the first 10
> rows of the request, I get no error (but also no matches.)
>
>
> So you clearly are not giving us all the data or all the code, but I'm
> finally wondering if you just don't have an data that matches teh external
> datasets in your chosen "biomart". Can you offer a smaller dataset that you
> know with certainty should produce a match?
>
>
> Alternatively, you might want to post this instead at the BioConductor
> mailing list. They are the people who have a better chance of spotting
> obvious errors. I've found two likely code-related errors but I'm not a
> computational biostatistician.
>
> David
>
>
>
> Thanks,
> Puja
>
> On Thu, Apr 8, 2021 at 6:01 PM David Winsemius <dwinsemius at comcast.net>
> wrote:
>
>>
>> On 4/8/21 2:30 PM, pooja sinha wrote:
>> > Hi All,
>> >
>> > I am trying to extract gene list from chromosome number and position,
>> for
>> > that I am using biomaRt in R but I am getting error messages as shown
>> > below. Also below is the code I am using for extraction.
>> >
>> > library("biomaRt")
>> > listMarts()
>> > ensembl <- useMart("ensembl")
>> > datasets <- listDatasets(ensembl)
>> > ensembl = useDataset("rnorvegicus_gene_ensembl",mart=ensembl)
>> > AT_AC_Gene <- read.csv("AT-AC-methylkit_biomart-4-7-21.csv",header=T)
>>
>>
>> #--- a this point I get
>>
>> Error in file(file, "rt") : cannot open the connection
>> In addition: Warning message:
>> In file(file, "rt") :
>>    cannot open file 'AT-AC-methylkit_biomart-4-7-21.csv': No such file
>> or directory
>>
>> > attributes <-
>> >
>> c("external_gene_name","ensembl_gene_id","start_position","end_position","rgd_symbol","chromosome_name")
>> > filters <- c("chromosome_name","start","end")
>> > values <- list(AT_AC_Gene$chr,AT_AC_Gene$start,AT_AC_Gene$end)
>> > final_1 <- getBM(attributes=attributes, filters=filters, values=values,
>> > mart=ensembl)
>> >
>> > The code runs well without any error but the final1 output has 0
>> > observations of 6 variables. Why?
>> >
>> > Can anyone help me with this?
>>
>>
>> You are more likely to get a useful response on the BioC mailing list.
>> It appears you have a dependenciy of a csv file that you have not told
>> us about.
>>
>>
>> --
>>
>> David
>>
>> >
>> >
>> > Thanks,
>> >
>> > Puja
>> >
>> >       [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Fri Apr  9 15:43:27 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Fri, 9 Apr 2021 14:43:27 +0100
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
References: <1154678.1617964540@apollo2.minshall.org>
 <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
Message-ID: <2c0c6ceb-6ec9-f881-f4d5-5a93e3959d8c@sapo.pt>

Hello,

my_function seems to be a function you have defined somewhere in your code.
In your original post you mention it 3 times, this is the first one:


subnet_MYSUBNET <- my_function(MYSUBNET)


So Ivan's and Greg's code should work, they use a function you haven't 
posted but is assumed to exist.

Note: if you are more comfortable with for loops than with *apply, I 
would rewrite Ivan's for loop solution as


results <- vector("list", length = nrow(datatable))
for(val in datatable$column) {
	results[[as.character(val)]] <- my_function(val)
}


To keep extending a vector or list object in a loop is inefficient, this 
creates the list with the right length beforehand.


Hope this helps,

Rui Barradas

?s 13:21 de 09/04/21, Wolfgang Grond escreveu:
> Greg,
> 
> here I get the error message:
> 
> Error my_function(val) :
> 
> cannot find function my_function.
> 
> Am 9. April 2021 12:35:40 MESZ schrieb Greg Minshall <minshall at umich.edu>:
>> Wolfgang,
>>
>>> result <- assign(paste("subnet_",? val, sep = "")
>>>
>>> result <- my_function(val)
>>
>> i don't understand why you are twice assigning to =result=.  also, the
>> first assignment doesn't seem well formatted (t's missing a value?).
>>
>> did you mean something like
>>
>> : assign(paste("subnet_",? val, sep = ""), my_function(val))
>>
>> (which i would think should work)?
>>
>> cheers, Greg
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> 
> -
> Numberland - Dr. Wolfgang Grond
> Diplomphysiker, TQM-Assessor (EFQM)
> Six Sigma Green Belt
> Ingenieurb?ro / Engineering Consultancy
> Lohfeld 20, DE-95326 Kulmbach, Germany
> Phone: +49 9221 6919131
> Fax: +49 9221 6919156
> Mail: grond at numberland.com
> URL: http://www.numberland.com
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From dw|n@em|u@ @end|ng |rom comc@@t@net  Fri Apr  9 17:22:05 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Fri, 9 Apr 2021 08:22:05 -0700
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
References: <1154678.1617964540@apollo2.minshall.org>
 <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
Message-ID: <2e9d9627-cc60-d053-5c7e-64ff5175bd52@comcast.net>


On 4/9/21 5:21 AM, Wolfgang Grond wrote:
> Greg,
>
> here I get the error message:
>
> Error my_function(val) :
>
> cannot find function my_function.

I'm guessing that you are following someone else's blog and have failed 
one of two things:

- understand that what was meant by the author was that you were assumed 
to have a function in mind to use for a programming strategy being 
illustrated

- or you were copying and pasting only part of a blog and failed to 
paste in the code from above where there was earlier code defining 
`my_function`

>
> Am 9. April 2021 12:35:40 MESZ schrieb Greg Minshall <minshall at umich.edu>:
>> Wolfgang,
>>
>>> result <- assign(paste("subnet_",? val, sep = "")
>>>
>>> result <- my_function(val)
>> i don't understand why you are twice assigning to =result=.  also, the
>> first assignment doesn't seem well formatted (t's missing a value?).
>>
>> did you mean something like
>>
>> : assign(paste("subnet_",? val, sep = ""), my_function(val))
>>
>> (which i would think should work)?
>>
>> cheers, Greg
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
> -
> Numberland - Dr. Wolfgang Grond
> Diplomphysiker, TQM-Assessor (EFQM)
> Six Sigma Green Belt
> Ingenieurb?ro / Engineering Consultancy
> Lohfeld 20, DE-95326 Kulmbach, Germany
> Phone: +49 9221 6919131
> Fax: +49 9221 6919156
> Mail: grond at numberland.com
> URL: http://www.numberland.com
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From wgrond @end|ng |rom wgrond@de  Fri Apr  9 17:12:18 2021
From: wgrond @end|ng |rom wgrond@de (Wolfgang Grond)
Date: Fri, 09 Apr 2021 17:12:18 +0200
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <2c0c6ceb-6ec9-f881-f4d5-5a93e3959d8c@sapo.pt>
References: <1154678.1617964540@apollo2.minshall.org>
 <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
 <2c0c6ceb-6ec9-f881-f4d5-5a93e3959d8c@sapo.pt>
Message-ID: <96D5907A-C2ED-4755-B699-1B962ED80A0C@wgrond.de>

Folks,

first of all - thanks a lot for your hints!

I will try each again and think about, why I get error messages.

But to resume: if I understand you right:

there is no way to do something like this:

$name = $result?

Regards

Wolfgang

Am 9. April 2021 15:43:27 MESZ schrieb Rui Barradas <ruipbarradas at sapo.pt>:
>Hello,
>
>my_function seems to be a function you have defined somewhere in your
>code.
>In your original post you mention it 3 times, this is the first one:
>
>
>subnet_MYSUBNET <- my_function(MYSUBNET)
>
>
>So Ivan's and Greg's code should work, they use a function you haven't 
>posted but is assumed to exist.
>
>Note: if you are more comfortable with for loops than with *apply, I 
>would rewrite Ivan's for loop solution as
>
>
>results <- vector("list", length = nrow(datatable))
>for(val in datatable$column) {
>	results[[as.character(val)]] <- my_function(val)
>}
>
>
>To keep extending a vector or list object in a loop is inefficient,
>this 
>creates the list with the right length beforehand.
>
>
>Hope this helps,
>
>Rui Barradas
>
>?s 13:21 de 09/04/21, Wolfgang Grond escreveu:
>> Greg,
>> 
>> here I get the error message:
>> 
>> Error my_function(val) :
>> 
>> cannot find function my_function.
>> 
>> Am 9. April 2021 12:35:40 MESZ schrieb Greg Minshall
><minshall at umich.edu>:
>>> Wolfgang,
>>>
>>>> result <- assign(paste("subnet_",? val, sep = "")
>>>>
>>>> result <- my_function(val)
>>>
>>> i don't understand why you are twice assigning to =result=.  also,
>the
>>> first assignment doesn't seem well formatted (t's missing a value?).
>>>
>>> did you mean something like
>>>
>>> : assign(paste("subnet_",? val, sep = ""), my_function(val))
>>>
>>> (which i would think should work)?
>>>
>>> cheers, Greg
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>> 
>> 
>> -
>> Numberland - Dr. Wolfgang Grond
>> Diplomphysiker, TQM-Assessor (EFQM)
>> Six Sigma Green Belt
>> Ingenieurb?ro / Engineering Consultancy
>> Lohfeld 20, DE-95326 Kulmbach, Germany
>> Phone: +49 9221 6919131
>> Fax: +49 9221 6919156
>> Mail: grond at numberland.com
>> URL: http://www.numberland.com
>> 	[[alternative HTML version deleted]]
>> 
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From wgrond @end|ng |rom wgrond@de  Fri Apr  9 17:26:28 2021
From: wgrond @end|ng |rom wgrond@de (Wolfgang Grond)
Date: Fri, 09 Apr 2021 17:26:28 +0200
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <2e9d9627-cc60-d053-5c7e-64ff5175bd52@comcast.net>
References: <1154678.1617964540@apollo2.minshall.org>
 <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
 <2e9d9627-cc60-d053-5c7e-64ff5175bd52@comcast.net>
Message-ID: <06DADD35-A2B3-4293-AE45-CCE9CBE7BB37@wgrond.de>

David,

I don't think that this is the case.

When I do the calculation like this

subnet_MYSUBNET <- my_function(MYSUBNET),

i.e. assigning a variable by hand to each function result, all is fine.



Am 9. April 2021 17:22:05 MESZ schrieb David Winsemius <dwinsemius at comcast.net>:
>
>On 4/9/21 5:21 AM, Wolfgang Grond wrote:
>> Greg,
>>
>> here I get the error message:
>>
>> Error my_function(val) :
>>
>> cannot find function my_function.
>
>I'm guessing that you are following someone else's blog and have failed
>
>one of two things:
>
>- understand that what was meant by the author was that you were
>assumed 
>to have a function in mind to use for a programming strategy being 
>illustrated
>
>- or you were copying and pasting only part of a blog and failed to 
>paste in the code from above where there was earlier code defining 
>`my_function`
>
>>
>> Am 9. April 2021 12:35:40 MESZ schrieb Greg Minshall
><minshall at umich.edu>:
>>> Wolfgang,
>>>
>>>> result <- assign(paste("subnet_",? val, sep = "")
>>>>
>>>> result <- my_function(val)
>>> i don't understand why you are twice assigning to =result=.  also,
>the
>>> first assignment doesn't seem well formatted (t's missing a value?).
>>>
>>> did you mean something like
>>>
>>> : assign(paste("subnet_",? val, sep = ""), my_function(val))
>>>
>>> (which i would think should work)?
>>>
>>> cheers, Greg
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> -
>> Numberland - Dr. Wolfgang Grond
>> Diplomphysiker, TQM-Assessor (EFQM)
>> Six Sigma Green Belt
>> Ingenieurb?ro / Engineering Consultancy
>> Lohfeld 20, DE-95326 Kulmbach, Germany
>> Phone: +49 9221 6919131
>> Fax: +49 9221 6919156
>> Mail: grond at numberland.com
>> URL: http://www.numberland.com
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From wgrond @end|ng |rom wgrond@de  Fri Apr  9 18:23:57 2021
From: wgrond @end|ng |rom wgrond@de (Wolfgang Grond)
Date: Fri, 09 Apr 2021 18:23:57 +0200
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <2e9d9627-cc60-d053-5c7e-64ff5175bd52@comcast.net>
References: <1154678.1617964540@apollo2.minshall.org>
 <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
 <2e9d9627-cc60-d053-5c7e-64ff5175bd52@comcast.net>
Message-ID: <6389EB6E-5D31-48C2-A657-1E885586E212@wgrond.de>

As I wrote before, I calculate tbl_graph objects, which will be joined afterwards. Not too much, the number of graphs to calculate is in the range between 5 to 20.

Further steps are not automated, because they depend on how the single graphs look like, and which of them will be joined.

For this reason I thought it would be nice to have the single tbl_ graph objects stored in variables having the name of the graph.

For this reason I tried to find a better solution instead of assigning each graph by hand:

subnet_MYSUBNET <- my_function(MYSUBNET)

To my understanding it is therefore neccessary to assign the result of the function to a variable whose name consists of a fixed string and the content of a further variable.

That was the intention for me to ask.

Am 9. April 2021 17:22:05 MESZ schrieb David Winsemius <dwinsemius at comcast.net>:
>
>On 4/9/21 5:21 AM, Wolfgang Grond wrote:
>> Greg,
>>
>> here I get the error message:
>>
>> Error my_function(val) :
>>
>> cannot find function my_function.
>
>I'm guessing that you are following someone else's blog and have failed
>
>one of two things:
>
>- understand that what was meant by the author was that you were
>assumed 
>to have a function in mind to use for a programming strategy being 
>illustrated
>
>- or you were copying and pasting only part of a blog and failed to 
>paste in the code from above where there was earlier code defining 
>`my_function`
>
>>
>> Am 9. April 2021 12:35:40 MESZ schrieb Greg Minshall
><minshall at umich.edu>:
>>> Wolfgang,
>>>
>>>> result <- assign(paste("subnet_",? val, sep = "")
>>>>
>>>> result <- my_function(val)
>>> i don't understand why you are twice assigning to =result=.  also,
>the
>>> first assignment doesn't seem well formatted (t's missing a value?).
>>>
>>> did you mean something like
>>>
>>> : assign(paste("subnet_",? val, sep = ""), my_function(val))
>>>
>>> (which i would think should work)?
>>>
>>> cheers, Greg
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> -
>> Numberland - Dr. Wolfgang Grond
>> Diplomphysiker, TQM-Assessor (EFQM)
>> Six Sigma Green Belt
>> Ingenieurb?ro / Engineering Consultancy
>> Lohfeld 20, DE-95326 Kulmbach, Germany
>> Phone: +49 9221 6919131
>> Fax: +49 9221 6919156
>> Mail: grond at numberland.com
>> URL: http://www.numberland.com
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From @tyen @end|ng |rom ntu@edu@tw  Sat Apr 10 05:25:36 2021
From: @tyen @end|ng |rom ntu@edu@tw (Steven Yen)
Date: Sat, 10 Apr 2021 11:25:36 +0800
Subject: [R] Identifying column type
Message-ID: <e302e97f-1425-a1c5-c597-d2bcb299875e@ntu.edu.tw>

I have data of mixed types in a data frame - date and numeric, as shown 
in summary below. How do I identify the column(s) that is/are not 
numeric, in this case, the first. All I want is to identify the 
column(s) and so that I can remove it/them from the data frame Thanks.

> summary(mydata)

Date Spot Futures Min. :1997-09-01 00:00:00 Min. : 735.1 Min. : 734.2 
1st Qu.:2002-10-16 12:00:00 1st Qu.:1120.7 1st Qu.:1122.6 Median 
:2007-12-01 00:00:00 Median :1301.8 Median :1303.2 Mean :2007-12-01 
06:01:27 Mean :1423.1 Mean :1423.6 3rd Qu.:2013-01-16 12:00:00 3rd 
Qu.:1540.0 3rd Qu.:1546.5 Max. :2018-03-01 00:00:00 Max. :2823.8 Max. 
:2825.8


	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sat Apr 10 05:33:47 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 09 Apr 2021 20:33:47 -0700
Subject: [R] Identifying column type
In-Reply-To: <e302e97f-1425-a1c5-c597-d2bcb299875e@ntu.edu.tw>
References: <e302e97f-1425-a1c5-c597-d2bcb299875e@ntu.edu.tw>
Message-ID: <2644DE71-15B5-417C-98D0-6D967E313C73@dcn.davis.ca.us>

Does

sapply( mydata, inherits, what = "POSIXt" )

give you any ideas?

On April 9, 2021 8:25:36 PM PDT, Steven Yen <styen at ntu.edu.tw> wrote:
>I have data of mixed types in a data frame - date and numeric, as shown
>
>in summary below. How do I identify the column(s) that is/are not 
>numeric, in this case, the first. All I want is to identify the 
>column(s) and so that I can remove it/them from the data frame Thanks.
>
>> summary(mydata)
>
>Date Spot Futures Min. :1997-09-01 00:00:00 Min. : 735.1 Min. : 734.2 
>1st Qu.:2002-10-16 12:00:00 1st Qu.:1120.7 1st Qu.:1122.6 Median 
>:2007-12-01 00:00:00 Median :1301.8 Median :1303.2 Mean :2007-12-01 
>06:01:27 Mean :1423.1 Mean :1423.6 3rd Qu.:2013-01-16 12:00:00 3rd 
>Qu.:1540.0 3rd Qu.:1546.5 Max. :2018-03-01 00:00:00 Max. :2823.8 Max. 
>:2825.8
>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From @tyen @end|ng |rom ntu@edu@tw  Sat Apr 10 05:54:56 2021
From: @tyen @end|ng |rom ntu@edu@tw (Steven Yen)
Date: Sat, 10 Apr 2021 11:54:56 +0800
Subject: [R] Identifying column type
In-Reply-To: <2644DE71-15B5-417C-98D0-6D967E313C73@dcn.davis.ca.us>
References: <e302e97f-1425-a1c5-c597-d2bcb299875e@ntu.edu.tw>
 <2644DE71-15B5-417C-98D0-6D967E313C73@dcn.davis.ca.us>
Message-ID: <f97f56c1-f54a-65ce-bbbb-657126a6834e@ntu.edu.tw>

Thanks much! Yes it does. I will read.

On 2021/4/10 ?? 11:33, Jeff Newmiller wrote:
> Does
>
> sapply( mydata, inherits, what = "POSIXt" )
>
> give you any ideas?
>
> On April 9, 2021 8:25:36 PM PDT, Steven Yen <styen at ntu.edu.tw> wrote:
>> I have data of mixed types in a data frame - date and numeric, as shown
>>
>> in summary below. How do I identify the column(s) that is/are not
>> numeric, in this case, the first. All I want is to identify the
>> column(s) and so that I can remove it/them from the data frame Thanks.
>>
>>> summary(mydata)
>> Date Spot Futures Min. :1997-09-01 00:00:00 Min. : 735.1 Min. : 734.2
>> 1st Qu.:2002-10-16 12:00:00 1st Qu.:1120.7 1st Qu.:1122.6 Median
>> :2007-12-01 00:00:00 Median :1301.8 Median :1303.2 Mean :2007-12-01
>> 06:01:27 Mean :1423.1 Mean :1423.6 3rd Qu.:2013-01-16 12:00:00 3rd
>> Qu.:1540.0 3rd Qu.:1546.5 Max. :2018-03-01 00:00:00 Max. :2823.8 Max.
>> :2825.8
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Sat Apr 10 06:32:36 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 9 Apr 2021 21:32:36 -0700
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <6389EB6E-5D31-48C2-A657-1E885586E212@wgrond.de>
References: <1154678.1617964540@apollo2.minshall.org>
 <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
 <2e9d9627-cc60-d053-5c7e-64ff5175bd52@comcast.net>
 <6389EB6E-5D31-48C2-A657-1E885586E212@wgrond.de>
Message-ID: <CAGxFJbRtVEkB+VrPQMUvCtFK7HEcGq3YeNSbnYmXWZMp5K+Bag@mail.gmail.com>

I freely admit that I do not understand what you mean. But it sounds like
you are trying to make things more complicated than necessary.

Perhaps this little example may help clarify the issues:


> a <- 1; b <- 2; d <- c(3,5)
> stuff <- lapply(list(a,b,d),function(x)x^2)
> stuff
[[1]]
[1] 1

[[2]]
[1] 4

[[3]]
[1]  9 25

> stuff[[3]]
[1]  9 25

Note that one may apply (almost) any function that returns objects (and
doesn't have nasty side effects, I suppose), including graphical objects,
and store them in the list that is returned. These objects can then be
accessed as usual and manipulated/displayed/assigned ... whatever.

If this misunderstands your query and is irrelevant, do not bother to
explain. Or reply. Won't be the first time I did not get it.

If OTOH this is a complete mystery to you, then you need to spend some time
learning about R lists and how. to use them.

Cheers,
Bert



Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Fri, Apr 9, 2021 at 7:22 PM Wolfgang Grond <wgrond at wgrond.de> wrote:

> As I wrote before, I calculate tbl_graph objects, which will be joined
> afterwards. Not too much, the number of graphs to calculate is in the range
> between 5 to 20.
>
> Further steps are not automated, because they depend on how the single
> graphs look like, and which of them will be joined.
>
> For this reason I thought it would be nice to have the single tbl_ graph
> objects stored in variables having the name of the graph.
>
> For this reason I tried to find a better solution instead of assigning
> each graph by hand:
>
> subnet_MYSUBNET <- my_function(MYSUBNET)
>
> To my understanding it is therefore neccessary to assign the result of the
> function to a variable whose name consists of a fixed string and the
> content of a further variable.
>
> That was the intention for me to ask.
>
> Am 9. April 2021 17:22:05 MESZ schrieb David Winsemius <
> dwinsemius at comcast.net>:
> >
> >On 4/9/21 5:21 AM, Wolfgang Grond wrote:
> >> Greg,
> >>
> >> here I get the error message:
> >>
> >> Error my_function(val) :
> >>
> >> cannot find function my_function.
> >
> >I'm guessing that you are following someone else's blog and have failed
> >
> >one of two things:
> >
> >- understand that what was meant by the author was that you were
> >assumed
> >to have a function in mind to use for a programming strategy being
> >illustrated
> >
> >- or you were copying and pasting only part of a blog and failed to
> >paste in the code from above where there was earlier code defining
> >`my_function`
> >
> >>
> >> Am 9. April 2021 12:35:40 MESZ schrieb Greg Minshall
> ><minshall at umich.edu>:
> >>> Wolfgang,
> >>>
> >>>> result <- assign(paste("subnet_",  val, sep = "")
> >>>>
> >>>> result <- my_function(val)
> >>> i don't understand why you are twice assigning to =result=.  also,
> >the
> >>> first assignment doesn't seem well formatted (t's missing a value?).
> >>>
> >>> did you mean something like
> >>>
> >>> : assign(paste("subnet_",  val, sep = ""), my_function(val))
> >>>
> >>> (which i would think should work)?
> >>>
> >>> cheers, Greg
> >>>
> >>> ______________________________________________
> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>> PLEASE do read the posting guide
> >>> http://www.R-project.org/posting-guide.html
> >>> and provide commented, minimal, self-contained, reproducible code.
> >>
> >> -
> >> Numberland - Dr. Wolfgang Grond
> >> Diplomphysiker, TQM-Assessor (EFQM)
> >> Six Sigma Green Belt
> >> Ingenieurb?ro / Engineering Consultancy
> >> Lohfeld 20, DE-95326 Kulmbach, Germany
> >> Phone: +49 9221 6919131
> >> Fax: +49 9221 6919156
> >> Mail: grond at numberland.com
> >> URL: http://www.numberland.com
> >>      [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> >http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >
> >______________________________________________
> >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >https://stat.ethz.ch/mailman/listinfo/r-help
> >PLEASE do read the posting guide
> >http://www.R-project.org/posting-guide.html
> >and provide commented, minimal, self-contained, reproducible code.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Apr 10 07:37:42 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 10 Apr 2021 06:37:42 +0100
Subject: [R] Identifying column type
In-Reply-To: <e302e97f-1425-a1c5-c597-d2bcb299875e@ntu.edu.tw>
References: <e302e97f-1425-a1c5-c597-d2bcb299875e@ntu.edu.tw>
Message-ID: <e9d0a692-a431-db36-6d50-1cee04c7d3a2@sapo.pt>

Hello,

Maybe something like


ok <- sapply(mydata, is.numeric)
mydata <- mydata[ok]


to keep the numeric columns only.


Hope this helps,

Rui Barradas

?s 04:25 de 10/04/21, Steven Yen escreveu:
> I have data of mixed types in a data frame - date and numeric, as shown
> in summary below. How do I identify the column(s) that is/are not
> numeric, in this case, the first. All I want is to identify the
> column(s) and so that I can remove it/them from the data frame Thanks.
> 
>> summary(mydata)
> 
> Date Spot Futures Min. :1997-09-01 00:00:00 Min. : 735.1 Min. : 734.2
> 1st Qu.:2002-10-16 12:00:00 1st Qu.:1120.7 1st Qu.:1122.6 Median
> :2007-12-01 00:00:00 Median :1301.8 Median :1303.2 Mean :2007-12-01
> 06:01:27 Mean :1423.1 Mean :1423.6 3rd Qu.:2013-01-16 12:00:00 3rd
> Qu.:1540.0 3rd Qu.:1546.5 Max. :2018-03-01 00:00:00 Max. :2823.8 Max.
> :2825.8
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Apr 10 09:01:43 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 10 Apr 2021 08:01:43 +0100
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <6389EB6E-5D31-48C2-A657-1E885586E212@wgrond.de>
References: <1154678.1617964540@apollo2.minshall.org>
 <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
 <2e9d9627-cc60-d053-5c7e-64ff5175bd52@comcast.net>
 <6389EB6E-5D31-48C2-A657-1E885586E212@wgrond.de>
Message-ID: <da4a6d27-95ef-ebb9-070b-5a752c948487@sapo.pt>

Hello,

I believe that the point we are missing is that datatable$column stores 
the *names* of the graphs, not the graph objects themselves. So in the 
loop the objects must be retrieved with mget() or get().

First create a reproducible example.



library(tidygraph)

my_function <- function(g){
   stopifnot(inherits(g, "igraph"))
   g %>% mutate(centrality = centrality_pagerank())
}

MYSUBNET1 <- create_notable('bull')
iris_clust <- hclust(dist(iris[1:4]))
MYSUBNET2 <- as_tbl_graph(iris_clust)
MYSUBNET3 <- play_smallworld(1, 100, 3, 0.05)

datatable <- data.frame(column = paste0("MYSUBNET", 1:3))



Now apply the function above to each of the "tbl_graph" objects.

1. Get all objects and apply the function in one instruction. Then 
assign the new names.


result <- lapply(mget(datatable$column, envir = .GlobalEnv), my_function)
names(result) <- paste("subnet", datatable$column, sep = "_")


2. Loop through the column with lapply, getting one object and applying 
the function one at a time. Then assign the new names.



result2 <- lapply(datatable$column, function(net_name){
   NET <- get(net_name, envir = .GlobalEnv)
   my_function(NET)
})
names(result2) <- paste("subnet", datatable$column, sep = "_")



3. Loop through the column with a for loop, getting one object and 
applying the function one at a time. Then assign the new names.



result3 <- vector("list", length = nrow(datatable))
for(i in seq_along(datatable$column)){
   net_name <- datatable$column[i]
   NET <- get(net_name, envir = .GlobalEnv)
   result3[[i]] <- my_function(NET)
}
names(result3) <- paste("subnet", datatable$column, sep = "_")



4. Now check that all 3 solutions give the same result.


identical(result, result2)
#[1] TRUE
identical(result, result3)
#[1] TRUE


Is this it?

Rui Barradas


?s 17:23 de 09/04/21, Wolfgang Grond escreveu:
> As I wrote before, I calculate tbl_graph objects, which will be joined afterwards. Not too much, the number of graphs to calculate is in the range between 5 to 20.
> 
> Further steps are not automated, because they depend on how the single graphs look like, and which of them will be joined.
> 
> For this reason I thought it would be nice to have the single tbl_ graph objects stored in variables having the name of the graph.
> 
> For this reason I tried to find a better solution instead of assigning each graph by hand:
> 
> subnet_MYSUBNET <- my_function(MYSUBNET)
> 
> To my understanding it is therefore neccessary to assign the result of the function to a variable whose name consists of a fixed string and the content of a further variable.
> 
> That was the intention for me to ask.
> 
> Am 9. April 2021 17:22:05 MESZ schrieb David Winsemius <dwinsemius at comcast.net>:
>>
>> On 4/9/21 5:21 AM, Wolfgang Grond wrote:
>>> Greg,
>>>
>>> here I get the error message:
>>>
>>> Error my_function(val) :
>>>
>>> cannot find function my_function.
>>
>> I'm guessing that you are following someone else's blog and have failed
>>
>> one of two things:
>>
>> - understand that what was meant by the author was that you were
>> assumed
>> to have a function in mind to use for a programming strategy being
>> illustrated
>>
>> - or you were copying and pasting only part of a blog and failed to
>> paste in the code from above where there was earlier code defining
>> `my_function`
>>
>>>
>>> Am 9. April 2021 12:35:40 MESZ schrieb Greg Minshall
>> <minshall at umich.edu>:
>>>> Wolfgang,
>>>>
>>>>> result <- assign(paste("subnet_",? val, sep = "")
>>>>>
>>>>> result <- my_function(val)
>>>> i don't understand why you are twice assigning to =result=.  also,
>> the
>>>> first assignment doesn't seem well formatted (t's missing a value?).
>>>>
>>>> did you mean something like
>>>>
>>>> : assign(paste("subnet_",? val, sep = ""), my_function(val))
>>>>
>>>> (which i would think should work)?
>>>>
>>>> cheers, Greg
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>> -
>>> Numberland - Dr. Wolfgang Grond
>>> Diplomphysiker, TQM-Assessor (EFQM)
>>> Six Sigma Green Belt
>>> Ingenieurb?ro / Engineering Consultancy
>>> Lohfeld 20, DE-95326 Kulmbach, Germany
>>> Phone: +49 9221 6919131
>>> Fax: +49 9221 6919156
>>> Mail: grond at numberland.com
>>> URL: http://www.numberland.com
>>> 	[[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From rkoenker @end|ng |rom ||||no|@@edu  Sat Apr 10 11:26:07 2021
From: rkoenker @end|ng |rom ||||no|@@edu (Koenker, Roger W)
Date: Sat, 10 Apr 2021 09:26:07 +0000
Subject: [R] Stata/Rstudio evil attributes
Message-ID: <DC13D3BA-857E-45BC-A472-90E9B3CDCEDE@illinois.edu>

As shown in the reproducible example below, I used the RStudio function haven() to read a Stata .dta file, and then tried to do some fitting with the resulting data.frame.  This produced an error from my fitting function rqss() in the package quantreg.  After a bit of frustrated cursing, I converted the data.frame, D, to a matrix A, and thence back to a data.frame B, and tried again, which worked as expected.  The conversion removed the attributes of D.  My question is:  why were the attributes inhibiting the fitting?

In accordance with the usual R-help etiquette I first tried to contact the maintainer of the haven package, i.e. RStudio, which elicited the response: "since the error is occurring outside RStudio we?re not responsible, so try Stack Overflow".  This is pretty much what I would have expected from the capitalist running dogs they are.  Admittedly, the error is probably due to some unforeseen infelicity in my rqss() coding, but it does seem odd that attributes could have such a drastic  effect.  I would be most grateful for any insight the R commune might offer.

#require(haven) # for reading dta file
#Ddta <- read_dta(?foo.dta")
#D <- with(Ddta, data.frame(y = access_merg, x = meannets_allhh, z = meanhh))
#save(D, file = "D.Rda")
con <- url("http://www.econ.uiuc.edu/~roger/research/data/D.Rda")
load(con)

# If I purge the Stata attributes in D:
A <- as.matrix(D)
B <- as.data.frame(A)

# This works:
with(D,plot(x, y, cex = .5, col = "grey"))
taus <- 1:4/5
require(quantreg)
for(i in 1:length(taus)){
    f <- rqss(y ~ qss(x, constraint = "I", lambda = 1), tau = taus[i], data = B)
    plot(f, add = TRUE, col = i)
}
# However, the same code with data = D, does not.  Why?

From wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n|  Sat Apr 10 12:59:34 2021
From: wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n| (Viechtbauer, Wolfgang (SP))
Date: Sat, 10 Apr 2021 10:59:34 +0000
Subject: [R] Stata/Rstudio evil attributes
In-Reply-To: <DC13D3BA-857E-45BC-A472-90E9B3CDCEDE@illinois.edu>
References: <DC13D3BA-857E-45BC-A472-90E9B3CDCEDE@illinois.edu>
Message-ID: <ee2a475c7d7244fbaaf8d2854006e64f@UM-MAIL3214.unimaas.nl>

Dear Roger,

The problem is this. qss() looks like this:

if (is.matrix(x)) {
   [...]
}
if (is.vector(x)) {
   [...]
}
qss

Now let's check these if() statements:
is.vector(B$x) # TRUE
is.vector(D$x) # FALSE
is.matrix(B$x) # FALSE
is.matrix(D$x) # FALSE

is.vector(D$x) being FALSE may be surprising, but see ?is.vector: "is.vector returns TRUE if x is a vector of the specified mode having no attributes other than names. It returns FALSE otherwise." And as D$x shows, this vector has additional attributes.

So, with 'D', qss() returns the qss function (c.f., qss(B$x) and qss(D$x)) which makes no sense. So, the internal logic in qss() needs to be fixed.

>In accordance with the usual R-help etiquette I first tried to contact the
>maintainer of the haven package, i.e. RStudio, which elicited the response: "since
>the error is occurring outside RStudio we?re not responsible, so try Stack
>Overflow".  This is pretty much what I would have expected from the capitalist
>running dogs they are.  Admittedly, the error is probably due to some unforeseen

This kind of bashing is really silly. Can you tell us again how much you paid for the use of the haven package?

Best,
Wolfgang

>-----Original Message-----
>From: R-help [mailto:r-help-bounces at r-project.org] On Behalf Of Koenker, Roger W
>Sent: Saturday, 10 April, 2021 11:26
>To: r-help
>Subject: [R] Stata/Rstudio evil attributes
>
>As shown in the reproducible example below, I used the RStudio function haven() to
>read a Stata .dta file, and then tried to do some fitting with the resulting
>data.frame.  This produced an error from my fitting function rqss() in the package
>quantreg.  After a bit of frustrated cursing, I converted the data.frame, D, to a
>matrix A, and thence back to a data.frame B, and tried again, which worked as
>expected.  The conversion removed the attributes of D.  My question is:  why were
>the attributes inhibiting the fitting?
>
>In accordance with the usual R-help etiquette I first tried to contact the
>maintainer of the haven package, i.e. RStudio, which elicited the response: "since
>the error is occurring outside RStudio we?re not responsible, so try Stack
>Overflow".  This is pretty much what I would have expected from the capitalist
>running dogs they are.  Admittedly, the error is probably due to some unforeseen
>infelicity in my rqss() coding, but it does seem odd that attributes could have
>such a drastic  effect.  I would be most grateful for any insight the R commune
>might offer.
>
>#require(haven) # for reading dta file
>#Ddta <- read_dta(?foo.dta")
>#D <- with(Ddta, data.frame(y = access_merg, x = meannets_allhh, z = meanhh))
>#save(D, file = "D.Rda")
>con <- url("http://www.econ.uiuc.edu/~roger/research/data/D.Rda")
>load(con)
>
># If I purge the Stata attributes in D:
>A <- as.matrix(D)
>B <- as.data.frame(A)
>
># This works:
>with(D,plot(x, y, cex = .5, col = "grey"))
>taus <- 1:4/5
>require(quantreg)
>for(i in 1:length(taus)){
>    f <- rqss(y ~ qss(x, constraint = "I", lambda = 1), tau = taus[i], data = B)
>    plot(f, add = TRUE, col = i)
>}
># However, the same code with data = D, does not.  Why?

From ku|upp @end|ng |rom on||ne@de  Sat Apr 10 13:06:15 2021
From: ku|upp @end|ng |rom on||ne@de (Kulupp)
Date: Sat, 10 Apr 2021 13:06:15 +0200
Subject: [R] Comparing dates in two large data frames
Message-ID: <ff086c31-1feb-ec24-e16d-0ba2e5c50b9c@online.de>

Dear all,

I have two data frames (df1 and df2) and for each timepoint in df1 I 
want to know: is it whithin any of the timespans in df2? The result 
(e.g. "no" or "yes" or 0 and 1) should be shown in a new column of df1

Here is the code to create the two data frames (the size of the two data 
frames is approx. the same as in my original data frames):

# create data frame df1
ti1 <- seq.POSIXt(from=as.POSIXct("2020/01/01", tz="UTC"), 
to=as.POSIXct("2020/06/01", tz="UTC"), by="10 min")
df1 <- data.frame(Time=ti1)

# create data frame df2 with random timespans, i.e. start and end dates
start <- sort(sample(seq(as.POSIXct("2020/01/01", tz="UTC"), 
as.POSIXct("2020/06/01", tz="UTC"), by="1 mins"), 5000))
end?? <- start + 120
df2 <- data.frame(start=start, end=end)

Everything I tried (ifelse combined with sapply or for loops) has been 
very very very slow. Thus, I am looking for a reasonably fast solution.

Thanks a lot for any hint in advance !

Cheers,

Thomas


From rkoenker @end|ng |rom ||||no|@@edu  Sat Apr 10 13:12:25 2021
From: rkoenker @end|ng |rom ||||no|@@edu (Koenker, Roger W)
Date: Sat, 10 Apr 2021 11:12:25 +0000
Subject: [R] Stata/Rstudio evil attributes
In-Reply-To: <ee2a475c7d7244fbaaf8d2854006e64f@UM-MAIL3214.unimaas.nl>
References: <DC13D3BA-857E-45BC-A472-90E9B3CDCEDE@illinois.edu>
 <ee2a475c7d7244fbaaf8d2854006e64f@UM-MAIL3214.unimaas.nl>
Message-ID: <09546B8E-084D-4AED-8919-67E3FF43092C@illinois.edu>

Wolfgang,

Thanks, this is _extremely_ helpful.

Roger

> On Apr 10, 2021, at 11:59 AM, Viechtbauer, Wolfgang (SP) <wolfgang.viechtbauer at maastrichtuniversity.nl> wrote:
> 
> Dear Roger,
> 
> The problem is this. qss() looks like this:
> 
> if (is.matrix(x)) {
>   [...]
> }
> if (is.vector(x)) {
>   [...]
> }
> qss
> 
> Now let's check these if() statements:
> is.vector(B$x) # TRUE
> is.vector(D$x) # FALSE
> is.matrix(B$x) # FALSE
> is.matrix(D$x) # FALSE
> 
> is.vector(D$x) being FALSE may be surprising, but see ?is.vector: "is.vector returns TRUE if x is a vector of the specified mode having no attributes other than names. It returns FALSE otherwise." And as D$x shows, this vector has additional attributes.
> 
> So, with 'D', qss() returns the qss function (c.f., qss(B$x) and qss(D$x)) which makes no sense. So, the internal logic in qss() needs to be fixed.
> 
>> In accordance with the usual R-help etiquette I first tried to contact the
>> maintainer of the haven package, i.e. RStudio, which elicited the response: "since
>> the error is occurring outside RStudio we?re not responsible, so try Stack
>> Overflow".  This is pretty much what I would have expected from the capitalist
>> running dogs they are.  Admittedly, the error is probably due to some unforeseen
> 
> This kind of bashing is really silly. Can you tell us again how much you paid for the use of the haven package?
> 
> Best,
> Wolfgang
> 
>> -----Original Message-----
>> From: R-help [mailto:r-help-bounces at r-project.org] On Behalf Of Koenker, Roger W
>> Sent: Saturday, 10 April, 2021 11:26
>> To: r-help
>> Subject: [R] Stata/Rstudio evil attributes
>> 
>> As shown in the reproducible example below, I used the RStudio function haven() to
>> read a Stata .dta file, and then tried to do some fitting with the resulting
>> data.frame.  This produced an error from my fitting function rqss() in the package
>> quantreg.  After a bit of frustrated cursing, I converted the data.frame, D, to a
>> matrix A, and thence back to a data.frame B, and tried again, which worked as
>> expected.  The conversion removed the attributes of D.  My question is:  why were
>> the attributes inhibiting the fitting?
>> 
>> In accordance with the usual R-help etiquette I first tried to contact the
>> maintainer of the haven package, i.e. RStudio, which elicited the response: "since
>> the error is occurring outside RStudio we?re not responsible, so try Stack
>> Overflow".  This is pretty much what I would have expected from the capitalist
>> running dogs they are.  Admittedly, the error is probably due to some unforeseen
>> infelicity in my rqss() coding, but it does seem odd that attributes could have
>> such a drastic  effect.  I would be most grateful for any insight the R commune
>> might offer.
>> 
>> #require(haven) # for reading dta file
>> #Ddta <- read_dta(?foo.dta")
>> #D <- with(Ddta, data.frame(y = access_merg, x = meannets_allhh, z = meanhh))
>> #save(D, file = "D.Rda")
>> con <- url("http://www.econ.uiuc.edu/~roger/research/data/D.Rda")
>> load(con)
>> 
>> # If I purge the Stata attributes in D:
>> A <- as.matrix(D)
>> B <- as.data.frame(A)
>> 
>> # This works:
>> with(D,plot(x, y, cex = .5, col = "grey"))
>> taus <- 1:4/5
>> require(quantreg)
>> for(i in 1:length(taus)){
>>   f <- rqss(y ~ qss(x, constraint = "I", lambda = 1), tau = taus[i], data = B)
>>   plot(f, add = TRUE, col = i)
>> }
>> # However, the same code with data = D, does not.  Why?


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Apr 10 14:47:01 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 10 Apr 2021 13:47:01 +0100
Subject: [R] Comparing dates in two large data frames
In-Reply-To: <ff086c31-1feb-ec24-e16d-0ba2e5c50b9c@online.de>
References: <ff086c31-1feb-ec24-e16d-0ba2e5c50b9c@online.de>
Message-ID: <9b32be4c-ba64-d774-346b-a89f512df398@sapo.pt>

Hello,

The following solution seems to work and is fast, like findInterval is.
It first determines where in df2$start is each value of df1$Time. Then 
uses that index to see if those Times are not greater than the 
corresponding df$end.
I checked against a small subset of df1 and the results were right.


result <- logical(nrow(df1))
inx <- findInterval(df1$Time, df2$start)
not_zero <- inx != 0
result[not_zero] <- df1$Time[not_zero] <= df2$end[ inx[not_zero] ]


Hope this helps,

Rui Barradas


?s 12:06 de 10/04/21, Kulupp escreveu:
> Dear all,
> 
> I have two data frames (df1 and df2) and for each timepoint in df1 I 
> want to know: is it whithin any of the timespans in df2? The result 
> (e.g. "no" or "yes" or 0 and 1) should be shown in a new column of df1
> 
> Here is the code to create the two data frames (the size of the two data 
> frames is approx. the same as in my original data frames):
> 
> # create data frame df1
> ti1 <- seq.POSIXt(from=as.POSIXct("2020/01/01", tz="UTC"), 
> to=as.POSIXct("2020/06/01", tz="UTC"), by="10 min")
> df1 <- data.frame(Time=ti1)
> 
> # create data frame df2 with random timespans, i.e. start and end dates
> start <- sort(sample(seq(as.POSIXct("2020/01/01", tz="UTC"), 
> as.POSIXct("2020/06/01", tz="UTC"), by="1 mins"), 5000))
> end?? <- start + 120
> df2 <- data.frame(start=start, end=end)
> 
> Everything I tried (ifelse combined with sapply or for loops) has been 
> very very very slow. Thus, I am looking for a reasonably fast solution.
> 
> Thanks a lot for any hint in advance !
> 
> Cheers,
> 
> Thomas
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From wjm1 @end|ng |rom c@@@co|umb|@@edu  Sat Apr 10 18:20:11 2021
From: wjm1 @end|ng |rom c@@@co|umb|@@edu (William Michels)
Date: Sat, 10 Apr 2021 09:20:11 -0700
Subject: [R] Stata/Rstudio evil attributes
In-Reply-To: <09546B8E-084D-4AED-8919-67E3FF43092C@illinois.edu>
References: <DC13D3BA-857E-45BC-A472-90E9B3CDCEDE@illinois.edu>
 <ee2a475c7d7244fbaaf8d2854006e64f@UM-MAIL3214.unimaas.nl>
 <09546B8E-084D-4AED-8919-67E3FF43092C@illinois.edu>
Message-ID: <CAA99HCxRhQYWyEJZr0MAAT_Z5x33hd5wi1Bb3WvDBD72W376uQ@mail.gmail.com>

Hi Roger,

You could look at the attributes() function in base-R. See:

> ?attributes

>From the help-page:

> ## strip an object's attributes:
> attributes(x) <- NULL

HTH, Bill.

W. Michels, Ph.D.



On Sat, Apr 10, 2021 at 4:20 AM Koenker, Roger W <rkoenker at illinois.edu> wrote:
>
> Wolfgang,
>
> Thanks, this is _extremely_ helpful.
>
> Roger
>
> > On Apr 10, 2021, at 11:59 AM, Viechtbauer, Wolfgang (SP) <wolfgang.viechtbauer at maastrichtuniversity.nl> wrote:
> >
> > Dear Roger,
> >
> > The problem is this. qss() looks like this:
> >
> > if (is.matrix(x)) {
> >   [...]
> > }
> > if (is.vector(x)) {
> >   [...]
> > }
> > qss
> >
> > Now let's check these if() statements:
> > is.vector(B$x) # TRUE
> > is.vector(D$x) # FALSE
> > is.matrix(B$x) # FALSE
> > is.matrix(D$x) # FALSE
> >
> > is.vector(D$x) being FALSE may be surprising, but see ?is.vector: "is.vector returns TRUE if x is a vector of the specified mode having no attributes other than names. It returns FALSE otherwise." And as D$x shows, this vector has additional attributes.
> >
> > So, with 'D', qss() returns the qss function (c.f., qss(B$x) and qss(D$x)) which makes no sense. So, the internal logic in qss() needs to be fixed.
> >
> >> In accordance with the usual R-help etiquette I first tried to contact the
> >> maintainer of the haven package, i.e. RStudio, which elicited the response: "since
> >> the error is occurring outside RStudio we?re not responsible, so try Stack
> >> Overflow".  This is pretty much what I would have expected from the capitalist
> >> running dogs they are.  Admittedly, the error is probably due to some unforeseen
> >
> > This kind of bashing is really silly. Can you tell us again how much you paid for the use of the haven package?
> >
> > Best,
> > Wolfgang
> >
> >> -----Original Message-----
> >> From: R-help [mailto:r-help-bounces at r-project.org] On Behalf Of Koenker, Roger W
> >> Sent: Saturday, 10 April, 2021 11:26
> >> To: r-help
> >> Subject: [R] Stata/Rstudio evil attributes
> >>
> >> As shown in the reproducible example below, I used the RStudio function haven() to
> >> read a Stata .dta file, and then tried to do some fitting with the resulting
> >> data.frame.  This produced an error from my fitting function rqss() in the package
> >> quantreg.  After a bit of frustrated cursing, I converted the data.frame, D, to a
> >> matrix A, and thence back to a data.frame B, and tried again, which worked as
> >> expected.  The conversion removed the attributes of D.  My question is:  why were
> >> the attributes inhibiting the fitting?
> >>
> >> In accordance with the usual R-help etiquette I first tried to contact the
> >> maintainer of the haven package, i.e. RStudio, which elicited the response: "since
> >> the error is occurring outside RStudio we?re not responsible, so try Stack
> >> Overflow".  This is pretty much what I would have expected from the capitalist
> >> running dogs they are.  Admittedly, the error is probably due to some unforeseen
> >> infelicity in my rqss() coding, but it does seem odd that attributes could have
> >> such a drastic  effect.  I would be most grateful for any insight the R commune
> >> might offer.
> >>
> >> #require(haven) # for reading dta file
> >> #Ddta <- read_dta(?foo.dta")
> >> #D <- with(Ddta, data.frame(y = access_merg, x = meannets_allhh, z = meanhh))
> >> #save(D, file = "D.Rda")
> >> con <- url("http://www.econ.uiuc.edu/~roger/research/data/D.Rda")
> >> load(con)
> >>
> >> # If I purge the Stata attributes in D:
> >> A <- as.matrix(D)
> >> B <- as.data.frame(A)
> >>
> >> # This works:
> >> with(D,plot(x, y, cex = .5, col = "grey"))
> >> taus <- 1:4/5
> >> require(quantreg)
> >> for(i in 1:length(taus)){
> >>   f <- rqss(y ~ qss(x, constraint = "I", lambda = 1), tau = taus[i], data = B)
> >>   plot(f, add = TRUE, col = i)
> >> }
> >> # However, the same code with data = D, does not.  Why?
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From thebudget72 m@iii@g oii gm@ii@com  Sun Apr 11 05:48:46 2021
From: thebudget72 m@iii@g oii gm@ii@com (thebudget72 m@iii@g oii gm@ii@com)
Date: Sun, 11 Apr 2021 05:48:46 +0200
Subject: [R] Random Forest: OOB performance = test set performance?
Message-ID: <e570a236-641d-a218-e8d1-99487975586a@gmail.com>

Hi ML,

For random forest, I thought that the out-of-bag performance should be 
the same (or at least very similar) to the performance calculated on a 
separated test set.

But this does not seem to be the case.

In the following code, the accuracy computed on out-of-bag sample is 
77.81%, while the one computed on a separated test set is 81%.

Can you please check what I am doing wrong?

Thanks in advance and best regards.

library(randomForest)
library(ISLR)

Carseats$High <- ifelse(Carseats$Sales<=8,"No","Yes")
Carseats$High <- as.factor(Carseats$High)

train = sample(1:nrow(Carseats), 200)

rf = randomForest(High~.-Sales,
 ????????????????? data=Carseats,
 ????????????????? subset=train,
 ????????????????? mtry=6,
 ????????????????? importance=T)

acc <- (rf$confusion[1,1] + rf$confusion[2,2]) / sum(rf$confusion)
print(paste0("Accuracy OOB: ", round(acc*100,2), "%"))

yhat <- predict(rf, newdata=Carseats[-train,])
y <- Carseats[-train,]$High
conftest <- table(y, yhat)
acctest <- (conftest[1,1] + conftest[2,2]) / sum(conftest)
print(paste0("Accuracy test set: ", round(acctest*100,2), "%"))


From peter@|@ng|e|der @end|ng |rom gm@||@com  Sun Apr 11 06:34:40 2021
From: peter@|@ng|e|der @end|ng |rom gm@||@com (Peter Langfelder)
Date: Sat, 10 Apr 2021 21:34:40 -0700
Subject: [R] Random Forest: OOB performance = test set performance?
In-Reply-To: <e570a236-641d-a218-e8d1-99487975586a@gmail.com>
References: <e570a236-641d-a218-e8d1-99487975586a@gmail.com>
Message-ID: <CA+hbrhXU7rafkS42c08ic==+WPwf86W9Birs+r0WKA-2dk681A@mail.gmail.com>

I think the only thing you are doing wrong is not setting the random
seed (set.seed()) so your results are not reproducible. Depending on
the random sample used to select the training and test sets, you get
slightly varying accuracy for both, sometimes one is better and
sometimes the other.

HTH,

Peter

On Sat, Apr 10, 2021 at 8:49 PM <thebudget72 at gmail.com> wrote:
>
> Hi ML,
>
> For random forest, I thought that the out-of-bag performance should be
> the same (or at least very similar) to the performance calculated on a
> separated test set.
>
> But this does not seem to be the case.
>
> In the following code, the accuracy computed on out-of-bag sample is
> 77.81%, while the one computed on a separated test set is 81%.
>
> Can you please check what I am doing wrong?
>
> Thanks in advance and best regards.
>
> library(randomForest)
> library(ISLR)
>
> Carseats$High <- ifelse(Carseats$Sales<=8,"No","Yes")
> Carseats$High <- as.factor(Carseats$High)
>
> train = sample(1:nrow(Carseats), 200)
>
> rf = randomForest(High~.-Sales,
>                    data=Carseats,
>                    subset=train,
>                    mtry=6,
>                    importance=T)
>
> acc <- (rf$confusion[1,1] + rf$confusion[2,2]) / sum(rf$confusion)
> print(paste0("Accuracy OOB: ", round(acc*100,2), "%"))
>
> yhat <- predict(rf, newdata=Carseats[-train,])
> y <- Carseats[-train,]$High
> conftest <- table(y, yhat)
> acctest <- (conftest[1,1] + conftest[2,2]) / sum(conftest)
> print(paste0("Accuracy test set: ", round(acctest*100,2), "%"))
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @tyen @end|ng |rom ntu@edu@tw  Sun Apr 11 12:00:58 2021
From: @tyen @end|ng |rom ntu@edu@tw (Steven Yen)
Date: Sun, 11 Apr 2021 18:00:58 +0800
Subject: [R] Identifying column type
In-Reply-To: <e9d0a692-a431-db36-6d50-1cee04c7d3a2@sapo.pt>
References: <e9d0a692-a431-db36-6d50-1cee04c7d3a2@sapo.pt>
Message-ID: <966320B1-E776-4EC3-AA8D-5A5B0A7A02F2@ntu.edu.tw>

Thanks. Great idea!

Sent from my iPhone
Beware: My autocorrect is crazy

> On Apr 10, 2021, at 1:37 PM, Rui Barradas <ruipbarradas at sapo.pt> wrote:
> 
> ?Hello,
> 
> Maybe something like
> 
> 
> ok <- sapply(mydata, is.numeric)
> mydata <- mydata[ok]
> 
> 
> to keep the numeric columns only.
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 04:25 de 10/04/21, Steven Yen escreveu:
>> I have data of mixed types in a data frame - date and numeric, as shown
>> in summary below. How do I identify the column(s) that is/are not
>> numeric, in this case, the first. All I want is to identify the
>> column(s) and so that I can remove it/them from the data frame Thanks.
>>> summary(mydata)
>> Date Spot Futures Min. :1997-09-01 00:00:00 Min. : 735.1 Min. : 734.2
>> 1st Qu.:2002-10-16 12:00:00 1st Qu.:1120.7 1st Qu.:1122.6 Median
>> :2007-12-01 00:00:00 Median :1301.8 Median :1303.2 Mean :2007-12-01
>> 06:01:27 Mean :1423.1 Mean :1423.6 3rd Qu.:2013-01-16 12:00:00 3rd
>> Qu.:1540.0 3rd Qu.:1546.5 Max. :2018-03-01 00:00:00 Max. :2823.8 Max.
>> :2825.8
>>    [[alternative HTML version deleted]]
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From therne@u @end|ng |rom m@yo@edu  Sat Apr 10 16:12:10 2021
From: therne@u @end|ng |rom m@yo@edu (Therneau, Terry M., Ph.D.)
Date: Sat, 10 Apr 2021 09:12:10 -0500
Subject: [R] evil attributes
Message-ID: <9b53cf$fog2pq@ironport10.mayo.edu>

I wrote: "I confess to being puzzled WHY the R core has decided on this definition..."
After just a little more thought let me answer my own question.

a. The as.vector() function is designed to strip off everything extraneous and leave just 
the core.?? (I have a mental image of Jack Webb saying "Just the facts ma'am"). ? I myself 
use it freqently in the test suite for survival, in cases where I'm checking the corrent 
numeric result and don't care about any attached names.

 ?b. is.vector(x) essentially answers the question "does x look like a result of as.vector?"

Nevertheless I understand Roger's confusion.

-- 
Terry M Therneau, PhD
Department of Quantitative Health Sciences
Mayo Clinic
therneau at mayo.edu

"TERR-ree THUR-noh"


	[[alternative HTML version deleted]]


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Sun Apr 11 18:09:39 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Sun, 11 Apr 2021 09:09:39 -0700 (PDT)
Subject: [R] updating OpenMx failed
Message-ID: <alpine.LNX.2.20.2104110907110.5793@salmo.appl-ecosys.com>

I'm running Slackware-14.2/x86_64 and R-4.0.2-x86_64-1_SBo.

Updating OpenMx failed:
omxState.cpp:1230:82:   required from here
omxState.cpp:1229:17: error: cannot call member function ?void ConstraintVec::eval(FitContext*, double*, double*)? without object
                  eval(fc2, result.data(), 0);
                  ^
/usr/lib64/R/etc/Makeconf:174: recipe for target 'omxState.o' failed
make: *** [omxState.o] Error 1
ERROR: compilation failed for package ?OpenMx?
* removing ?/usr/lib64/R/library/OpenMx?
* restoring previous ?/usr/lib64/R/library/OpenMx?

The downloaded source packages are in
 	?/tmp/Rtmp9jMe61/downloaded_packages?
Updating HTML index of packages in '.Library'
Making 'packages.html' ... done
Warning message:
In install.packages("OpenMx") :
   installation of package ?OpenMx? had non-zero exit status

Please advise,

Rich


From wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n|  Sun Apr 11 20:46:02 2021
From: wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n| (Viechtbauer, Wolfgang (SP))
Date: Sun, 11 Apr 2021 18:46:02 +0000
Subject: [R] evil attributes
In-Reply-To: <9b53cf$fog2pq@ironport10.mayo.edu>
References: <9b53cf$fog2pq@ironport10.mayo.edu>
Message-ID: <5f9a76951df14574ac610967c586b477@UM-MAIL3214.unimaas.nl>

The is.vector() thing has also bitten me in the behind on a few occasions. When I want to check if something is a vector, allow for it to possibly have some additional attributes (besides names) that would make is.vector() evaluate to FALSE, but evaluate to FALSE for lists (since is.vector(list(a=1, b=2)) is TRUE -- which also wasn't what I had initially expected before reading the documentation), I use:

.is.vector <- function(x)
   is.atomic(x) && !is.matrix(x) && !is.null(x)

This might also work:

.is.vector <- function(x)
   is(x, "vector") && !is.list(x)

I am sure there are all kinds of edge (and probably also not so edge) cases where these also fail to work properly. Kinda curious if there are better approaches out there.

Best,
Wolfgang

>-----Original Message-----
>From: R-help [mailto:r-help-bounces at r-project.org] On Behalf Of Therneau, Terry
>M., Ph.D. via R-help
>Sent: Saturday, 10 April, 2021 16:12
>To: R-help
>Subject: Re: [R] evil attributes
>
>I wrote: "I confess to being puzzled WHY the R core has decided on this
>definition..."
>After just a little more thought let me answer my own question.
>
>a. The as.vector() function is designed to strip off everything extraneous and
>leave just
>the core.?? (I have a mental image of Jack Webb saying "Just the facts
>ma'am"). ? I myself
>use it freqently in the test suite for survival, in cases where I'm checking the
>corrent
>numeric result and don't care about any attached names.
>
> ?b. is.vector(x) essentially answers the question "does x look like a result of
>as.vector?"
>
>Nevertheless I understand Roger's confusion.
>
>--
>Terry M Therneau, PhD
>Department of Quantitative Health Sciences
>Mayo Clinic
>therneau at mayo.edu
>
>"TERR-ree THUR-noh"

From dw|n@em|u@ @end|ng |rom comc@@t@net  Sun Apr 11 23:06:42 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Sun, 11 Apr 2021 14:06:42 -0700
Subject: [R] evil attributes
In-Reply-To: <5f9a76951df14574ac610967c586b477@UM-MAIL3214.unimaas.nl>
References: <9b53cf$fog2pq@ironport10.mayo.edu>
 <5f9a76951df14574ac610967c586b477@UM-MAIL3214.unimaas.nl>
Message-ID: <936407c3-4a56-9827-c0d9-2f88e7986f8b@comcast.net>


On 4/11/21 11:46 AM, Viechtbauer, Wolfgang (SP) wrote:
> The is.vector() thing has also bitten me in the behind on a few occasions. When I want to check if something is a vector, allow for it to possibly have some additional attributes (besides names) that would make is.vector() evaluate to FALSE, but evaluate to FALSE for lists (since is.vector(list(a=1, b=2)) is TRUE -- which also wasn't what I had initially expected before reading the documentation), I use:
>
> .is.vector <- function(x)
>     is.atomic(x) && !is.matrix(x) && !is.null(x)
>
> This might also work:
>
> .is.vector <- function(x)
>     is(x, "vector") && !is.list(x)

That will allow expression vectors to return TRUE, but they are not 
atomic so they would be excluded by your current version.

-- 

David.

>
> I am sure there are all kinds of edge (and probably also not so edge) cases where these also fail to work properly. Kinda curious if there are better approaches out there.


You might want to exclude expression vectors as well.



> Best,
> Wolfgang
>
>> -----Original Message-----
>> From: R-help [mailto:r-help-bounces at r-project.org] On Behalf Of Therneau, Terry
>> M., Ph.D. via R-help
>> Sent: Saturday, 10 April, 2021 16:12
>> To: R-help
>> Subject: Re: [R] evil attributes
>>
>> I wrote: "I confess to being puzzled WHY the R core has decided on this
>> definition..."
>> After just a little more thought let me answer my own question.
>>
>> a. The as.vector() function is designed to strip off everything extraneous and
>> leave just
>> the core.?? (I have a mental image of Jack Webb saying "Just the facts
>> ma'am"). ? I myself
>> use it freqently in the test suite for survival, in cases where I'm checking the
>> corrent
>> numeric result and don't care about any attached names.
>>
>>  ?b. is.vector(x) essentially answers the question "does x look like a result of
>> as.vector?"
>>
>> Nevertheless I understand Roger's confusion.
>>
>> --
>> Terry M Therneau, PhD
>> Department of Quantitative Health Sciences
>> Mayo Clinic
>> therneau at mayo.edu
>>
>> "TERR-ree THUR-noh"
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From tr@xp|@yer @end|ng |rom gm@||@com  Sun Apr 11 23:55:12 2021
From: tr@xp|@yer @end|ng |rom gm@||@com (=?UTF-8?Q?Martin_M=C3=B8ller_Skarbiniks_Pedersen?=)
Date: Sun, 11 Apr 2021 23:55:12 +0200
Subject: [R] updating OpenMx failed
In-Reply-To: <alpine.LNX.2.20.2104110907110.5793@salmo.appl-ecosys.com>
References: <alpine.LNX.2.20.2104110907110.5793@salmo.appl-ecosys.com>
Message-ID: <CAGAA5bdP+dMP0cEr=_GdcDbAtsvrHx1XMi1EmNx=WYc-z04XCA@mail.gmail.com>

On Sun, 11 Apr 2021 at 18:10, Rich Shepard <rshepard at appl-ecosys.com> wrote:
>
> I'm running Slackware-14.2/x86_64 and R-4.0.2-x86_64-1_SBo.
>
> Updating OpenMx failed:
> omxState.cpp:1230:82:   required from here
> omxState.cpp:1229:17: error: cannot call member function ?void
ConstraintVec::eval(FitContext*, double*, double*)? without object
>                   eval(fc2, result.data(), 0);
>                   ^

[...]

> Please advise,

You should contact the maintainers of the package.
According to this page:
https://cran.r-project.org/web/packages/OpenMx/index.html
you can get help from http://openmx.ssri.psu.edu/forums

Regards
Martin

	[[alternative HTML version deleted]]


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Mon Apr 12 00:30:50 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Sun, 11 Apr 2021 15:30:50 -0700 (PDT)
Subject: [R] updating OpenMx failed
In-Reply-To: <CAGAA5bdP+dMP0cEr=_GdcDbAtsvrHx1XMi1EmNx=WYc-z04XCA@mail.gmail.com>
References: <alpine.LNX.2.20.2104110907110.5793@salmo.appl-ecosys.com>
 <CAGAA5bdP+dMP0cEr=_GdcDbAtsvrHx1XMi1EmNx=WYc-z04XCA@mail.gmail.com>
Message-ID: <alpine.LNX.2.20.2104111529560.5793@salmo.appl-ecosys.com>

On Sun, 11 Apr 2021, Martin M?ller Skarbiniks Pedersen wrote:

> You should contact the maintainers of the package.
> According to this page:
> https://cran.r-project.org/web/packages/OpenMx/index.html
> you can get help from http://openmx.ssri.psu.edu/forums

Martin,

You're correct. I should have looked up the maintainer and directly
contacted them. I'll do so.

Regards,

Rich


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Apr 12 01:57:53 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 11 Apr 2021 19:57:53 -0400
Subject: [R] evil attributes
In-Reply-To: <5f9a76951df14574ac610967c586b477@UM-MAIL3214.unimaas.nl>
References: <9b53cf$fog2pq@ironport10.mayo.edu>
 <5f9a76951df14574ac610967c586b477@UM-MAIL3214.unimaas.nl>
Message-ID: <32a40d2c-2472-eaf8-2542-3d57295500ea@gmail.com>

On 11/04/2021 2:46 p.m., Viechtbauer, Wolfgang (SP) wrote:
> The is.vector() thing has also bitten me in the behind on a few occasions. When I want to check if something is a vector, allow for it to possibly have some additional attributes (besides names) that would make is.vector() evaluate to FALSE, but evaluate to FALSE for lists (since is.vector(list(a=1, b=2)) is TRUE -- which also wasn't what I had initially expected before reading the documentation), I use:
> 
> .is.vector <- function(x)
>     is.atomic(x) && !is.matrix(x) && !is.null(x)
> 
> This might also work:
> 
> .is.vector <- function(x)
>     is(x, "vector") && !is.list(x)
> 
> I am sure there are all kinds of edge (and probably also not so edge) cases where these also fail to work properly. Kinda curious if there are better approaches out there.

Sorry, but nobody has said what "properly" would be here.  How can an 
approach be better at something if you don't say what you want it to do?

The base::is.vector() definition looks fairly useless, and I can't 
remember ever using that function.  But at least it's quite well 
documented what it is supposed to do.  What claims are you making about 
your .is.vector() definitions?

Duncan Murdoch


From w||||@mwdun|@p @end|ng |rom gm@||@com  Mon Apr 12 02:44:47 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Sun, 11 Apr 2021 17:44:47 -0700
Subject: [R] evil attributes
In-Reply-To: <9b53cf$fog2pq@ironport10.mayo.edu>
References: <9b53cf$fog2pq@ironport10.mayo.edu>
Message-ID: <CAHqSRuQzVkd1H9ZUW1bTYTGmuxOS3jpVk5eAuS0yd4rxyPBo4g@mail.gmail.com>

Terry wrote
           I confess to being puzzled WHY the R core has decided on this
definition [of vector] ...
I believe that "R core" followed S's definition of "vector".  From the
beginning (at least when I first saw it in 1981) an S vector was the basic
unit of an S object - it had a type and a length and no more.  This has
little to do with the mathematician's or physicist's notion of a vector.
It is more like what Technopedia (
https://www.techopedia.com/definition/22817/vector-programming) says is a
programmer's notion of a vector:

What Does Vector Mean?
A vector, in programming, is a type of array that is one dimensional.
Vectors are a logical element in programming languages that are used for
storing data. Vectors are similar to arrays but their actual implementation
and operation differs.
Techopedia Explains Vector
Vectors are primarily used within the programming context of most
programming languages and serve as data structure containers. Being a data
structure, vectors are used for storing objects and collections of objects
in an organized structure.
The major difference between and array and a vector is that, unlike typical
arrays, the container size of a vector can be easily increased and
decreased to complement different data storage types. Vectors have a
dynamic structure and provide the ability to assign container size up front
and enable allocation of memory space quickly. Vectors can be thought of as
dynamic arrays.

-Bill


On Sun, Apr 11, 2021 at 8:04 AM Therneau, Terry M., Ph.D. via R-help <
r-help at r-project.org> wrote:

> I wrote: "I confess to being puzzled WHY the R core has decided on this
> definition..."
> After just a little more thought let me answer my own question.
>
> a. The as.vector() function is designed to strip off everything extraneous
> and leave just
> the core.   (I have a mental image of Jack Webb saying "Just the facts
> ma'am").   I myself
> use it freqently in the test suite for survival, in cases where I'm
> checking the corrent
> numeric result and don't care about any attached names.
>
>   b. is.vector(x) essentially answers the question "does x look like a
> result of as.vector?"
>
> Nevertheless I understand Roger's confusion.
>
> --
> Terry M Therneau, PhD
> Department of Quantitative Health Sciences
> Mayo Clinic
> therneau at mayo.edu
>
> "TERR-ree THUR-noh"
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From thebudget72 m@iii@g oii gm@ii@com  Mon Apr 12 02:49:53 2021
From: thebudget72 m@iii@g oii gm@ii@com (thebudget72 m@iii@g oii gm@ii@com)
Date: Mon, 12 Apr 2021 02:49:53 +0200
Subject: [R] Random Forest: OOB performance = test set performance?
In-Reply-To: <CA+hbrhXU7rafkS42c08ic==+WPwf86W9Birs+r0WKA-2dk681A@mail.gmail.com>
References: <e570a236-641d-a218-e8d1-99487975586a@gmail.com>
 <CA+hbrhXU7rafkS42c08ic==+WPwf86W9Birs+r0WKA-2dk681A@mail.gmail.com>
Message-ID: <ad2e37ca-8cd8-cf13-5c45-0d7e41cdde1b@gmail.com>

Thanks Peter.

Indeed by setting a seed the two results are similar.

I am self-studying and wanted to make sure I understood the concept of 
OOB samples and how much "reliable" were performance metrics calculated 
on them.

It seems I did got it. That's good :)

On 4/11/21 6:34 AM, Peter Langfelder wrote:
> I think the only thing you are doing wrong is not setting the random
> seed (set.seed()) so your results are not reproducible. Depending on
> the random sample used to select the training and test sets, you get
> slightly varying accuracy for both, sometimes one is better and
> sometimes the other.
>
> HTH,
>
> Peter
>
> On Sat, Apr 10, 2021 at 8:49 PM<thebudget72 at gmail.com>  wrote:
>> Hi ML,
>>
>> For random forest, I thought that the out-of-bag performance should be
>> the same (or at least very similar) to the performance calculated on a
>> separated test set.
>>
>> But this does not seem to be the case.
>>
>> In the following code, the accuracy computed on out-of-bag sample is
>> 77.81%, while the one computed on a separated test set is 81%.
>>
>> Can you please check what I am doing wrong?
>>
>> Thanks in advance and best regards.
>>
>> library(randomForest)
>> library(ISLR)
>>
>> Carseats$High <- ifelse(Carseats$Sales<=8,"No","Yes")
>> Carseats$High <- as.factor(Carseats$High)
>>
>> train = sample(1:nrow(Carseats), 200)
>>
>> rf = randomForest(High~.-Sales,
>>                     data=Carseats,
>>                     subset=train,
>>                     mtry=6,
>>                     importance=T)
>>
>> acc <- (rf$confusion[1,1] + rf$confusion[2,2]) / sum(rf$confusion)
>> print(paste0("Accuracy OOB: ", round(acc*100,2), "%"))
>>
>> yhat <- predict(rf, newdata=Carseats[-train,])
>> y <- Carseats[-train,]$High
>> conftest <- table(y, yhat)
>> acctest <- (conftest[1,1] + conftest[2,2]) / sum(conftest)
>> print(paste0("Accuracy test set: ", round(acctest*100,2), "%"))
>>
>> ______________________________________________
>> R-help at r-project.org  mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guidehttp://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From tr@xp|@yer @end|ng |rom gm@||@com  Mon Apr 12 11:17:50 2021
From: tr@xp|@yer @end|ng |rom gm@||@com (=?UTF-8?Q?Martin_M=C3=B8ller_Skarbiniks_Pedersen?=)
Date: Mon, 12 Apr 2021 11:17:50 +0200
Subject: [R] updating OpenMx failed
In-Reply-To: <alpine.LNX.2.20.2104111529560.5793@salmo.appl-ecosys.com>
References: <alpine.LNX.2.20.2104110907110.5793@salmo.appl-ecosys.com>
 <CAGAA5bdP+dMP0cEr=_GdcDbAtsvrHx1XMi1EmNx=WYc-z04XCA@mail.gmail.com>
 <alpine.LNX.2.20.2104111529560.5793@salmo.appl-ecosys.com>
Message-ID: <CAGAA5bcR51Y2mX7RWtsOBpm5Az2eLfEf1s5e61K_ru=kLExPMA@mail.gmail.com>

btw. I installed without problems OpenMx on a xubuntu 20.10 running R 4.0.5.

Are your gcc toolchain up to date?


On Mon, Apr 12, 2021, 00:31 Rich Shepard <rshepard at appl-ecosys.com> wrote:

> On Sun, 11 Apr 2021, Martin M?ller Skarbiniks Pedersen wrote:
>
> > You should contact the maintainers of the package.
> > According to this page:
> > https://cran.r-project.org/web/packages/OpenMx/index.html
> > you can get help from http://openmx.ssri.psu.edu/forums
>
> Martin,
>
> You're correct. I should have looked up the maintainer and directly
> contacted them. I'll do so.
>
> Regards,
>
> Rich

	[[alternative HTML version deleted]]


From wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n|  Mon Apr 12 14:09:13 2021
From: wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n| (Viechtbauer, Wolfgang (SP))
Date: Mon, 12 Apr 2021 12:09:13 +0000
Subject: [R] evil attributes
In-Reply-To: <32a40d2c-2472-eaf8-2542-3d57295500ea@gmail.com>
References: <9b53cf$fog2pq@ironport10.mayo.edu>
 <5f9a76951df14574ac610967c586b477@UM-MAIL3214.unimaas.nl>
 <32a40d2c-2472-eaf8-2542-3d57295500ea@gmail.com>
Message-ID: <9e10b5eb0fbb4355b1dec348ab5f81e3@UM-MAIL3214.unimaas.nl>

>-----Original Message-----
>From: Duncan Murdoch [mailto:murdoch.duncan at gmail.com]
>Sent: Monday, 12 April, 2021 1:58
>To: Viechtbauer, Wolfgang (SP); R-help
>Subject: Re: [R] evil attributes
>
>On 11/04/2021 2:46 p.m., Viechtbauer, Wolfgang (SP) wrote:
>> The is.vector() thing has also bitten me in the behind on a few occasions. When
>I want to check if something is a vector, allow for it to possibly have some
>additional attributes (besides names) that would make is.vector() evaluate to
>FALSE, but evaluate to FALSE for lists (since is.vector(list(a=1, b=2)) is TRUE --
>which also wasn't what I had initially expected before reading the documentation),
>I use:
>>
>> .is.vector <- function(x)
>>     is.atomic(x) && !is.matrix(x) && !is.null(x)
>>
>> This might also work:
>>
>> .is.vector <- function(x)
>>     is(x, "vector") && !is.list(x)
>>
>> I am sure there are all kinds of edge (and probably also not so edge) cases
>where these also fail to work properly. Kinda curious if there are better
>approaches out there.
>
>Sorry, but nobody has said what "properly" would be here.  How can an
>approach be better at something if you don't say what you want it to do?
>
>The base::is.vector() definition looks fairly useless, and I can't
>remember ever using that function.  But at least it's quite well
>documented what it is supposed to do.  What claims are you making about
>your .is.vector() definitions?
>
>Duncan Murdoch

I only suggested a possible way of identifying vectors which is a bit more in line with the definition Bill described in his post (and which avoids the problem that Roger initially ran into that additional attributes make is.vector() evaluate to FALSE). It's not better than is.vector(), which is well documented as to what it does, and which has a different purpose. But I occasionally need to identify vectors (in the former sense) and was curious if there are other/better ways of doing so.

Best,
Wolfgang

From dr@@|@m@o|@ng| @end|ng |rom gm@||@com  Mon Apr 12 14:21:14 2021
From: dr@@|@m@o|@ng| @end|ng |rom gm@||@com (Shah Alam)
Date: Mon, 12 Apr 2021 14:21:14 +0200
Subject: [R] LHS random number generator
Message-ID: <CA+bivFg5WFxZis_aYgg+5+kZZZ7x+UgGvy94tDaK0QR8mVJfjw@mail.gmail.com>

Hello everyone,

I am using the LHS package to generate a combination of a
set of parameter values. However, I am not sure how to fix some parameter
values to 2 decimal points.
For example:

I want to make combinations in such a way that values for parameter
c("lmp", 0.40, 0.43) are taken as 0.40, 0.41, 0.42,0.43.

My codes are:

prior_lhs <- list(c("r_mu", 0.00299, 0.0032),
                  c("r_sd", 0.001, 0.002),
                  c("lmp", 0.40, 0.43),
                  c("gr_mu", 0.14, 0.16),
                  c("gr_sd", 0.01, 0.020),
                  c("alpha1", 0.0001, 0.0018),
                  c("alpha2", 0.0017, 0.0028),
                  c("alpha3", 0.005, 0.009),
                  c("beta", 0.69, 0.75)
)


### Simulation with priors from LHS ####
nb_simul <- 10000
nparam <- length(prior_lhs)
random_tab = randomLHS(nb_simul, nparam)
lhs_index = 1
param <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)

for (i in 1:nb_simul) {
  temp_par <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
  for (j in 1:nparam) {
    temp_par[j] = as.numeric(prior_lhs[[j]][2]) +
      (as.numeric(prior_lhs[[j]][3]) - as.numeric(prior_lhs[[j]][2])) *
random_tab[lhs_index, j]
  }
  param <- rbind(param, temp_par)
  lhs_index <- lhs_index+1
}
param <- param[-1,]

Best regards,
Shah

	[[alternative HTML version deleted]]


From rmh @end|ng |rom temp|e@edu  Mon Apr 12 18:56:44 2021
From: rmh @end|ng |rom temp|e@edu (Richard M. Heiberger)
Date: Mon, 12 Apr 2021 16:56:44 +0000
Subject: [R] [External]  LHS random number generator
In-Reply-To: <CA+bivFg5WFxZis_aYgg+5+kZZZ7x+UgGvy94tDaK0QR8mVJfjw@mail.gmail.com>
References: <CA+bivFg5WFxZis_aYgg+5+kZZZ7x+UgGvy94tDaK0QR8mVJfjw@mail.gmail.com>
Message-ID: <F7B21031-41A4-46BF-AE6A-3B159AA05B52@temple.edu>

I don't know the LHS package.  I don't see it on CRAN as either LHS, or more likely, as lhs (lower case).
When you write back to the list, using plain text, not HTML, please state where the LHS package is located.

I do see several potential problems.

You use a function randomLHS without first loading the package with a call something like
library(LHS)


Your use of the c() function turns the numbers into characters.  There is no indication
that you want to increment in units of .01:
> c("lmp", 0.40, 0.43)
[1] "lmp"  "0.4"  "0.43"



Explicit use of seq doesn't get what you are looking for.  Numbers in R (and most computer
programs) are binary and the representation in only a few decimal places is rounded. Thus:
> print(seq(.40, .43, .01), digits=17)
[1] 0.40000000000000002 0.41000000000000003 0.42000000000000004
[4] 0.42999999999999999


see FAQ 7.31 for discussion of number representations.
https://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-doesn_0027t-R-think-these-numbers-are-equal_003f



> On Apr 12, 2021, at 08:21, Shah Alam <dr.alamsolangi at gmail.com> wrote:
> 
> Hello everyone,
> 
> I am using the LHS package to generate a combination of a
> set of parameter values. However, I am not sure how to fix some parameter
> values to 2 decimal points.
> For example:
> 
> I want to make combinations in such a way that values for parameter
> c("lmp", 0.40, 0.43) are taken as 0.40, 0.41, 0.42,0.43.
> 
> My codes are:
> 
> prior_lhs <- list(c("r_mu", 0.00299, 0.0032),
>                  c("r_sd", 0.001, 0.002),
>                  c("lmp", 0.40, 0.43),
>                  c("gr_mu", 0.14, 0.16),
>                  c("gr_sd", 0.01, 0.020),
>                  c("alpha1", 0.0001, 0.0018),
>                  c("alpha2", 0.0017, 0.0028),
>                  c("alpha3", 0.005, 0.009),
>                  c("beta", 0.69, 0.75)
> )
> 
> 
> ### Simulation with priors from LHS ####
> nb_simul <- 10000
> nparam <- length(prior_lhs)
> random_tab = randomLHS(nb_simul, nparam)
> lhs_index = 1
> param <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
> 
> for (i in 1:nb_simul) {
>  temp_par <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
>  for (j in 1:nparam) {
>    temp_par[j] = as.numeric(prior_lhs[[j]][2]) +
>      (as.numeric(prior_lhs[[j]][3]) - as.numeric(prior_lhs[[j]][2])) *
> random_tab[lhs_index, j]
>  }
>  param <- rbind(param, temp_par)
>  lhs_index <- lhs_index+1
> }
> param <- param[-1,]
> 
> Best regards,
> Shah
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m@hmood@n@der@n @end|ng |rom ugent@be  Mon Apr 12 22:01:18 2021
From: m@hmood@n@der@n @end|ng |rom ugent@be (Mahmood Naderan-Tahan)
Date: Mon, 12 Apr 2021 20:01:18 +0000
Subject: [R] Weighted violin chart
Message-ID: <d4cb0b32817c43c699baed56f71bc2ad@ugent.be>

Hi,

I would like to know if it is possible to plot a weighted violin chart with R. Currently, I have


> library(ggplot2)
> mydata <- read.csv('test.csv', header=T,row.names=1)
> mydata
     V1 V2 V3
P1 73.6 50  R
P2 75.2 20  R
P3  6.5  5  R
P4 41.4 10  C
P5  5.4 10  C
P6 18.8  5  C
> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE)
> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)

I would like to use V2 as the weight vector. Any idea about that?



Regards,
Mahmood

	[[alternative HTML version deleted]]


From chr|@ho|d @end|ng |rom p@yctc@org  Tue Apr 13 08:32:55 2021
From: chr|@ho|d @end|ng |rom p@yctc@org (Chris Evans)
Date: Tue, 13 Apr 2021 07:32:55 +0100 (BST)
Subject: [R] Weighted violin chart
In-Reply-To: <d4cb0b32817c43c699baed56f71bc2ad@ugent.be>
References: <d4cb0b32817c43c699baed56f71bc2ad@ugent.be>
Message-ID: <1679959036.7318104.1618295575104.JavaMail.zimbra@psyctc.org>



----- Original Message -----
> From: "Mahmood Naderan-Tahan" <mahmood.naderan at ugent.be>
> To: r-help at r-project.org
> Sent: Monday, 12 April, 2021 21:01:18
> Subject: [R] Weighted violin chart

> Hi,
> 
> I would like to know if it is possible to plot a weighted violin chart with R.
> Currently, I have
> 
> 
>> library(ggplot2)
>> mydata <- read.csv('test.csv', header=T,row.names=1)
>> mydata
>     V1 V2 V3
> P1 73.6 50  R
> P2 75.2 20  R
> P3  6.5  5  R
> P4 41.4 10  C
> P5  5.4 10  C
> P6 18.8  5  C
>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE)
>> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)
> 
> I would like to use V2 as the weight vector. Any idea about that?
> 
> 
> 
> Regards,
> Mahmood

There are, of course, nice ways to do this using base R but I am trying to convert to using tidyverse. 
Here is one:

### use tribble to create a tibble rowwise
tribble(
  ~V1, ~V2, ~V3,
  73.6, 50, "R",
  75.2, 20, "R",
  6.5, 5, "R",
  41.4, 10, "C",
  5.4, 10, "C",
  18.8, 5, "C") -> myData

### use tidyr::uncount() to get to the data you want
myData %>%
  uncount(V2) -> tibWtdMyData

### plot it 
ggplot(tibWtdMyData, 
       aes(x=V3, y=V1)) + 
  geom_violin(trim=FALSE) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)

Of course, with so many identical values, I'm not sure a violin plot makes sense but perhaps you 
were showing us a small subset of your data.

I have a nasty feeling there is a way of weighting things within ggplot.  If so, I am sure someone
will tell us.

For future, it's much easier for us to reply if you put small bits of data like your myData into
your Email using dput.  The output from dput doesn't look terribly human friendly but unless it 
is mangled by HTML Emailing, it is wonderfully human friendly to use!

Very best (all),

Chris


-- 
Chris Evans (he/him) <chris at psyctc.org> Visiting Professor, University of Sheffield <chris.evans at sheffield.ac.uk>
I do some consultation work for the University of Roehampton <chris.evans at roehampton.ac.uk> and other places
but <chris at psyctc.org> remains my main Email address.  I have a work web site at:
   https://www.psyctc.org/psyctc/
and a site I manage for CORE and CORE system trust at:
   http://www.coresystemtrust.org.uk/
I have "semigrated" to France, see: 
   https://www.psyctc.org/pelerinage2016/semigrating-to-france/ 
   https://www.psyctc.org/pelerinage2016/register-to-get-updates-from-pelerinage2016/

If you want an Emeeting, I am trying to keep them to Thursdays and my diary is at:
   https://www.psyctc.org/pelerinage2016/ceworkdiary/
Beware: French time, generally an hour ahead of UK.


From drj|m|emon @end|ng |rom gm@||@com  Tue Apr 13 09:02:10 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Tue, 13 Apr 2021 17:02:10 +1000
Subject: [R] LHS random number generator
In-Reply-To: <CA+bivFg5WFxZis_aYgg+5+kZZZ7x+UgGvy94tDaK0QR8mVJfjw@mail.gmail.com>
References: <CA+bivFg5WFxZis_aYgg+5+kZZZ7x+UgGvy94tDaK0QR8mVJfjw@mail.gmail.com>
Message-ID: <CA+8X3fWM6quxADfvy+g=s36V+r7EvKDwsPbhHsZJTmGyZx4a6A@mail.gmail.com>

Hi Shah,
I think what you are struggling toward is this:

prior_lhs <- list(r_mu=c( 0.00299, 0.0032),
                  r_sd=c( 0.001, 0.002),
                  lmp=c( 0.40, 0.43),
                  gr_mu=c( 0.14, 0.16),
                  gr_s=c( 0.01, 0.020),
                  alpha1=c( 0.0001, 0.0018),
                  alpha2=c(0.0017, 0.0028),
                  alpha3=c( 0.005, 0.009),
                  beta=c(0.69, 0.75))
for(i in 1:length(prior_lhs))
 prior_lhs[[i]]<-seq(prior_lhs[[i]][1],prior_lhs[[i]][2],length.out=4)

This gives you the "quartiles" you need for randomLHS function in the
"lhs" package if I read the help page correctly.

Jim

On Mon, Apr 12, 2021 at 10:21 PM Shah Alam <dr.alamsolangi at gmail.com> wrote:
>
> Hello everyone,
>
> I am using the LHS package to generate a combination of a
> set of parameter values. However, I am not sure how to fix some parameter
> values to 2 decimal points.
> For example:
>
> I want to make combinations in such a way that values for parameter
> c("lmp", 0.40, 0.43) are taken as 0.40, 0.41, 0.42,0.43.
>
> My codes are:
>
> prior_lhs <- list(c("r_mu", 0.00299, 0.0032),
>                   c("r_sd", 0.001, 0.002),
>                   c("lmp", 0.40, 0.43),
>                   c("gr_mu", 0.14, 0.16),
>                   c("gr_sd", 0.01, 0.020),
>                   c("alpha1", 0.0001, 0.0018),
>                   c("alpha2", 0.0017, 0.0028),
>                   c("alpha3", 0.005, 0.009),
>                   c("beta", 0.69, 0.75)
> )
>
>
> ### Simulation with priors from LHS ####
> nb_simul <- 10000
> nparam <- length(prior_lhs)
> random_tab = randomLHS(nb_simul, nparam)
> lhs_index = 1
> param <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
>
> for (i in 1:nb_simul) {
>   temp_par <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
>   for (j in 1:nparam) {
>     temp_par[j] = as.numeric(prior_lhs[[j]][2]) +
>       (as.numeric(prior_lhs[[j]][3]) - as.numeric(prior_lhs[[j]][2])) *
> random_tab[lhs_index, j]
>   }
>   param <- rbind(param, temp_par)
>   lhs_index <- lhs_index+1
> }
> param <- param[-1,]
>
> Best regards,
> Shah
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From |eder|co@c@|bo|| @end|ng |rom ku|euven@be  Tue Apr 13 09:24:49 2021
From: |eder|co@c@|bo|| @end|ng |rom ku|euven@be (Federico Calboli)
Date: Tue, 13 Apr 2021 07:24:49 +0000
Subject: [R] install_github  does not work locally
Message-ID: <20DC4A21-BFC9-4C2F-B102-654F95EB83D1@kuleuven.be>

Hello,

I am trying to install a package from github, but my local installation fails (whereas doing the very same thing on a remote cluster works, and downloading the tarball by hand works).  I assume the issue is mine, but I have no idea how to solve it.  In any case, here is what I am doing and my session info.

Cheers

F

devtools::install_github("Syksy/curatedPCaData")
Downloading GitHub repo Syksy/curatedPCaData at HEAD
Error in utils::download.file(url, path, method = method, quiet = quiet,  : 
  download from 'https://api.github.com/repos/Syksy/curatedPCaData/tarball/HEAD? failed


> sessionInfo()
R version 4.0.4 (2021-02-15)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Mojave 10.14.6

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib

locale:
[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
 [1] magrittr_2.0.1    usethis_2.0.1     devtools_2.4.0    pkgload_1.2.1     R6_2.5.0          rlang_0.4.10      fastmap_1.1.0     tools_4.0.4      
 [9] pkgbuild_1.2.0    sessioninfo_1.1.1 cli_2.4.0         withr_2.4.1       ellipsis_0.3.1    remotes_2.3.0     rprojroot_2.0.2   lifecycle_1.0.0  
[17] crayon_1.4.1      processx_3.5.1    purrr_0.3.4       callr_3.6.0       fs_1.5.0          ps_1.6.0          curl_4.3          testthat_3.0.2   
[25] memoise_2.0.0     glue_1.4.2        cachem_1.0.4      compiler_4.0.4    desc_1.3.0        prettyunits_1.1.1

--
Federico Calboli
LBEG - Laboratory of Biodiversity and Evolutionary Genomics
Charles Deberiotstraat 32 box 2439
3000 Leuven
+32 16 32 87 67






From dr@@|@m@o|@ng| @end|ng |rom gm@||@com  Tue Apr 13 11:16:22 2021
From: dr@@|@m@o|@ng| @end|ng |rom gm@||@com (Shah Alam)
Date: Tue, 13 Apr 2021 11:16:22 +0200
Subject: [R] LHS random number generator
In-Reply-To: <CA+8X3fWM6quxADfvy+g=s36V+r7EvKDwsPbhHsZJTmGyZx4a6A@mail.gmail.com>
References: <CA+bivFg5WFxZis_aYgg+5+kZZZ7x+UgGvy94tDaK0QR8mVJfjw@mail.gmail.com>
 <CA+8X3fWM6quxADfvy+g=s36V+r7EvKDwsPbhHsZJTmGyZx4a6A@mail.gmail.com>
Message-ID: <CA+bivFhNLOwsxLmMYmru4fAc5sNBPh-gXz8DEArXi40ppM2D+A@mail.gmail.com>

Hi Richard and Jim

Thanks for your response. Sorry for the confusion. This is lhs package
(small letters), and after loading the package, I used the function
randomLHS.

The problem remained the same. I am trying to fix the length.out=2 for
lmp=c(0.40, 0.43), and length.out = 4 for all other variables/inputs.

Best regards,
Shah








On Tue, 13 Apr 2021 at 09:02, Jim Lemon <drjimlemon at gmail.com> wrote:

> Hi Shah,
> I think what you are struggling toward is this:
>
> prior_lhs <- list(r_mu=c( 0.00299, 0.0032),
>                   r_sd=c( 0.001, 0.002),
>                   lmp=c( 0.40, 0.43),
>                   gr_mu=c( 0.14, 0.16),
>                   gr_s=c( 0.01, 0.020),
>                   alpha1=c( 0.0001, 0.0018),
>                   alpha2=c(0.0017, 0.0028),
>                   alpha3=c( 0.005, 0.009),
>                   beta=c(0.69, 0.75))
> for(i in 1:length(prior_lhs))
>  prior_lhs[[i]]<-seq(prior_lhs[[i]][1],prior_lhs[[i]][2],length.out=4)
>
> This gives you the "quartiles" you need for randomLHS function in the
> "lhs" package if I read the help page correctly.
>
> Jim
>
> On Mon, Apr 12, 2021 at 10:21 PM Shah Alam <dr.alamsolangi at gmail.com>
> wrote:
> >
> > Hello everyone,
> >
> > I am using the LHS package to generate a combination of a
> > set of parameter values. However, I am not sure how to fix some parameter
> > values to 2 decimal points.
> > For example:
> >
> > I want to make combinations in such a way that values for parameter
> > c("lmp", 0.40, 0.43) are taken as 0.40, 0.41, 0.42,0.43.
> >
> > My codes are:
> >
> > prior_lhs <- list(c("r_mu", 0.00299, 0.0032),
> >                   c("r_sd", 0.001, 0.002),
> >                   c("lmp", 0.40, 0.43),
> >                   c("gr_mu", 0.14, 0.16),
> >                   c("gr_sd", 0.01, 0.020),
> >                   c("alpha1", 0.0001, 0.0018),
> >                   c("alpha2", 0.0017, 0.0028),
> >                   c("alpha3", 0.005, 0.009),
> >                   c("beta", 0.69, 0.75)
> > )
> >
> >
> > ### Simulation with priors from LHS ####
> > nb_simul <- 10000
> > nparam <- length(prior_lhs)
> > random_tab = randomLHS(nb_simul, nparam)
> > lhs_index = 1
> > param <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
> >
> > for (i in 1:nb_simul) {
> >   temp_par <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
> >   for (j in 1:nparam) {
> >     temp_par[j] = as.numeric(prior_lhs[[j]][2]) +
> >       (as.numeric(prior_lhs[[j]][3]) - as.numeric(prior_lhs[[j]][2])) *
> > random_tab[lhs_index, j]
> >   }
> >   param <- rbind(param, temp_par)
> >   lhs_index <- lhs_index+1
> > }
> > param <- param[-1,]
> >
> > Best regards,
> > Shah
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ch@|@b|@e|@he @end|ng |rom y@hoo@de  Tue Apr 13 12:26:22 2021
From: ch@|@b|@e|@he @end|ng |rom y@hoo@de (Elahe chalabi)
Date: Tue, 13 Apr 2021 10:26:22 +0000 (UTC)
Subject: [R] Add a new row based on test set predicted values and time stamps
References: <568265892.2252019.1618309582985.ref@mail.yahoo.com>
Message-ID: <568265892.2252019.1618309582985@mail.yahoo.com>

Hi all,

I have the prediction for my test set which are forecasted Value for "4/1/2020" for each match of "id" and "Group". I would like to add a fourth row to each group by (Group,id) in my train set and the values for this row should come from test set :

my train set:?

? ? ?structure(list(Date = c("1/1/2020", "2/1/2020", "3/1/2020", "1/1/2020",?
? ? ?"2/1/2020", "3/1/2020", "1/1/2020", "2/1/2020", "3/1/2020", ""
? ? ?), Value = c(3.5, 2.7, 4, 2.5, 3.7, 0, 3, 0, 1, NA), Group = c("A",?
? ? "A", "A", "B", "B", "B", "C", "C", "C", ""), id = c(1L, 1L, 1L,?
? ? 101L, 101L, 101L, 100L, 100L, 100L, NA)), class = "data.frame", row.names = c(NA,?
? ? -10L))

test set:

? ? structure(list(Date = c("4/1/2020", "4/1/2020", "4/1/2020", ""
? ? ? ), Value = c(3.5, 2.5, 3, NA), Group = c("A", "B", "C", ""),?
? ? id = c(1L, 101L, 100L, NA), value = c(0.2, 0.7, 0.9, NA)), class = "data.frame", row.names = c(NA,?
? ? ?-4L))structure(list(Date = c("4/1/2020", "4/1/2020", "4/1/2020", ""
? ? ), Value = c(3.5, 2.5, 3, NA), Group = c("A", "B", "C", ""),?
? ? id = c(1L, 101L, 100L, NA)), class = "data.frame", row.names = c(NA,?
? ? -4L))

desired output:?

? ??structure(list(Date = c("1/1/2020", "2/1/2020", "3/1/2020", "4/1/2020",?
? ? "1/1/2020", "2/1/2020", "3/1/2020", "4/1/2020", "1/1/2020", "2/1/2020",?
? ? "3/1/2020", "4/1/2020"), Value = c(3.5, 2.7, 4, 0.2, 2.5, 3.7,?
? ? ?0, 0.7, 3, 0, 1, 0.9), Group = c("A", "A", "A", "A", "B", "B",?
? ? "B", "B", "C", "C", "C", "C"), id = c(1L, 1L, 1L, 1L, 101L, 101L,?
? ? 101L, 101L, 100L, 100L, 100L, 100L)), class = "data.frame", row.names = c(NA,?
? ?-12L))

Data is dummy and I have milions of records in original data set.?

Thanks for any help.
Elahe?
?


From m@015k3113 @end|ng |rom b|ueyonder@co@uk  Tue Apr 13 14:51:21 2021
From: m@015k3113 @end|ng |rom b|ueyonder@co@uk (e-mail ma015k3113)
Date: Tue, 13 Apr 2021 13:51:21 +0100 (BST)
Subject: [R] Looping through data error
Message-ID: <59634000.142366.1618318281941@mail2.virginmedia.com>

Dear All,I have a dataframe with 4 variables and I am trying to calculate how many shares can be purchased with ?100 in the first year when the company was listed

The data looks like:

COMPANY_NUMBER YEAR_END_DATE CLOSE_SHARE_PRICE  NUMBER_OF_SHARES
22705                                30/09/2002                          NA                                 0
22705                                30/09/2004                         NA                                  0
22705                                30/09/2005                        6.55                                 0
22705                                30/09/2006                        7.5                                   0
22705                                30/09/2007                        9.65                                 0
22705                                30/09/2008                        6.55                                 0
1091347                            31/01/2010                        8.14                                 0
1091347                             31/01/2011                      11.38                                 0
11356069                           30/06/2019                      1.09                                   0
SC192761                         31/01/2000                         NA                                   0
SC192761                         31/01/2001                         NA                                   0
SC192761                          31/01/2002                        NA                                   0
SC192761                         31/01/2004                         NA                                   0
SC192761                         31/01/2005                         NA                                   0
SC192761                          31/01/2006                      1.09                                   0
SC192761                          31/01/2008                      1.24                                   0
SC192761                          31/01/2009                       0.9                                    0
SC192761                          31/01/2010                     1.14                                    0
SC192761                           31/01/2011                    1.25                                    0
SC192761                          31/01/2012                     1.29                                    0


The code I have written is

i <- 0

for (i in 1:(nrow(PLC_Return)-1))
if (i == 1)
{
NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
} else if
(is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])
{
NUMBER_OF_SHARES[i]=0
} else
{
NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
}


The error I get is Error: unexpected 'else' in:

" NUMBER_OF_SHARES[i] = 0
} else"
> {NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])}
>
> }
Error: unexpected '}' in "}"


Don't know how to fix it-any help will be appreciated.


Kind regards


Ahson
	[[alternative HTML version deleted]]


From jho|tm@n @end|ng |rom gm@||@com  Tue Apr 13 15:29:43 2021
From: jho|tm@n @end|ng |rom gm@||@com (jim holtman)
Date: Tue, 13 Apr 2021 06:29:43 -0700
Subject: [R] Looping through data error
In-Reply-To: <59634000.142366.1618318281941@mail2.virginmedia.com>
References: <59634000.142366.1618318281941@mail2.virginmedia.com>
Message-ID: <CAAxdm-58YhUa1f87Bm_ZGCAJGO_aAf44ujpUxD67YTPYzh25sg@mail.gmail.com>

Your code was formatted incorrectly.  There is always a problem with the
'else' statement after an 'if' since in R there is no semicolon to mark the
end of a line.  Here might be a better format for your code.  I would
recommend the liberal use of "{}"s when using 'if/else'



i <- 0

for (i in 1:(nrow(PLC_Return) - 1)) {
  if (i == 1) {
    NUMBER_OF_SHARES[i] = 100 / is.na(CLOSE_SHARE_PRICE[i])
  } else {
    if (is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1]) {
      NUMBER_OF_SHARES[i] = 0
    } else {
      NUMBER_OF_SHARES[i] = 100 / is.na(CLOSE_SHARE_PRICE[i])
    }
  }
}


Jim Holtman
*Data Munger Guru*


*What is the problem that you are trying to solve?Tell me what you want to
do, not how you want to do it.*


On Tue, Apr 13, 2021 at 5:51 AM e-mail ma015k3113 via R-help <
r-help at r-project.org> wrote:

> Dear All,I have a dataframe with 4 variables and I am trying to calculate
> how many shares can be purchased with ?100 in the first year when the
> company was listed
>
> The data looks like:
>
> COMPANY_NUMBER YEAR_END_DATE CLOSE_SHARE_PRICE  NUMBER_OF_SHARES
> 22705                                30/09/2002
> NA                                 0
> 22705                                30/09/2004
>  NA                                  0
> 22705                                30/09/2005
> 6.55                                 0
> 22705                                30/09/2006
> 7.5                                   0
> 22705                                30/09/2007
> 9.65                                 0
> 22705                                30/09/2008
> 6.55                                 0
> 1091347                            31/01/2010                        8.14
>                                0
> 1091347                             31/01/2011                      11.38
>                                0
> 11356069                           30/06/2019                      1.09
>                                0
> SC192761                         31/01/2000                         NA
>                                0
> SC192761                         31/01/2001                         NA
>                                0
> SC192761                          31/01/2002                        NA
>                                0
> SC192761                         31/01/2004                         NA
>                                0
> SC192761                         31/01/2005                         NA
>                                0
> SC192761                          31/01/2006                      1.09
>                                0
> SC192761                          31/01/2008                      1.24
>                                0
> SC192761                          31/01/2009                       0.9
>                                 0
> SC192761                          31/01/2010                     1.14
>                               0
> SC192761                           31/01/2011                    1.25
>                               0
> SC192761                          31/01/2012                     1.29
>                               0
>
>
> The code I have written is
>
> i <- 0
>
> for (i in 1:(nrow(PLC_Return)-1))
> if (i == 1)
> {
> NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> } else if
> (is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])
> {
> NUMBER_OF_SHARES[i]=0
> } else
> {
> NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> }
>
>
> The error I get is Error: unexpected 'else' in:
>
> " NUMBER_OF_SHARES[i] = 0
> } else"
> > {NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])}
> >
> > }
> Error: unexpected '}' in "}"
>
>
> Don't know how to fix it-any help will be appreciated.
>
>
> Kind regards
>
>
> Ahson
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Tue Apr 13 18:06:29 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Tue, 13 Apr 2021 17:06:29 +0100
Subject: [R] Looping through data error
In-Reply-To: <59634000.142366.1618318281941@mail2.virginmedia.com>
References: <59634000.142366.1618318281941@mail2.virginmedia.com>
Message-ID: <b4cd892a-a4c6-8635-e1b3-7fb4bf90f0ae@sapo.pt>

Hello,

A close parenthesis is missing in the nd if.


for (i in 1:(nrow(PLC_Return)-1)){
   if (i == 1){
     NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
   } else if(is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])){
     NUMBER_OF_SHARES[i]=0
   } else {
     NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
   }
}


Hope this helps,

Rui Barradas

?s 13:51 de 13/04/21, e-mail ma015k3113 via R-help escreveu:
> Dear All,I have a dataframe with 4 variables and I am trying to calculate how many shares can be purchased with ?100 in the first year when the company was listed
> 
> The data looks like:
> 
> COMPANY_NUMBER YEAR_END_DATE CLOSE_SHARE_PRICE  NUMBER_OF_SHARES
> 22705                                30/09/2002                          NA                                 0
> 22705                                30/09/2004                         NA                                  0
> 22705                                30/09/2005                        6.55                                 0
> 22705                                30/09/2006                        7.5                                   0
> 22705                                30/09/2007                        9.65                                 0
> 22705                                30/09/2008                        6.55                                 0
> 1091347                            31/01/2010                        8.14                                 0
> 1091347                             31/01/2011                      11.38                                 0
> 11356069                           30/06/2019                      1.09                                   0
> SC192761                         31/01/2000                         NA                                   0
> SC192761                         31/01/2001                         NA                                   0
> SC192761                          31/01/2002                        NA                                   0
> SC192761                         31/01/2004                         NA                                   0
> SC192761                         31/01/2005                         NA                                   0
> SC192761                          31/01/2006                      1.09                                   0
> SC192761                          31/01/2008                      1.24                                   0
> SC192761                          31/01/2009                       0.9                                    0
> SC192761                          31/01/2010                     1.14                                    0
> SC192761                           31/01/2011                    1.25                                    0
> SC192761                          31/01/2012                     1.29                                    0
> 
> 
> The code I have written is
> 
> i <- 0
> 
> for (i in 1:(nrow(PLC_Return)-1))
> if (i == 1)
> {
> NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> } else if
> (is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])
> {
> NUMBER_OF_SHARES[i]=0
> } else
> {
> NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> }
> 
> 
> The error I get is Error: unexpected 'else' in:
> 
> " NUMBER_OF_SHARES[i] = 0
> } else"
>> {NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])}
>>
>> }
> Error: unexpected '}' in "}"
> 
> 
> Don't know how to fix it-any help will be appreciated.
> 
> 
> Kind regards
> 
> 
> Ahson
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Tue Apr 13 18:09:04 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Tue, 13 Apr 2021 17:09:04 +0100
Subject: [R] Looping through data error
In-Reply-To: <b4cd892a-a4c6-8635-e1b3-7fb4bf90f0ae@sapo.pt>
References: <59634000.142366.1618318281941@mail2.virginmedia.com>
 <b4cd892a-a4c6-8635-e1b3-7fb4bf90f0ae@sapo.pt>
Message-ID: <97b652ea-e214-8bc3-7ebe-b64db2bfa1c5@sapo.pt>

Hello,

Typo, inline.

?s 17:06 de 13/04/21, Rui Barradas escreveu:
> Hello,
> 
> A close parenthesis is missing in the nd if.

Should be "the 2nd if".

Rui Barradas

> 
> 
> for (i in 1:(nrow(PLC_Return)-1)){
>  ? if (i == 1){
>  ??? NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
>  ? } else if(is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])){
>  ??? NUMBER_OF_SHARES[i]=0
>  ? } else {
>  ??? NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
>  ? }
> }
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 13:51 de 13/04/21, e-mail ma015k3113 via R-help escreveu:
>> Dear All,I have a dataframe with 4 variables and I am trying to 
>> calculate how many shares can be purchased with ?100 in the first year 
>> when the company was listed
>>
>> The data looks like:
>>
>> COMPANY_NUMBER YEAR_END_DATE CLOSE_SHARE_PRICE? NUMBER_OF_SHARES
>> 22705                                
>> 30/09/2002????????????????????????? NA???????????????????????????????? 0
>> 22705                                
>> 30/09/2004???????????????????????? NA????????????????????????????????? 0
>> 22705??????????????????????????????? 30/09/2005                        
>> 6.55???????????????????????????????? 0
>> 22705??????????????????????????????? 30/09/2006                        
>> 7.5?????????????????????????????????? 0
>> 22705??????????????????????????????? 30/09/2007                        
>> 9.65???????????????????????????????? 0
>> 22705??????????????????????????????? 30/09/2008                        
>> 6.55???????????????????????????????? 0
>> 1091347??????????????????????????? 31/01/2010                        
>> 8.14???????????????????????????????? 0
>> 1091347???????????????????????????? 31/01/2011                      
>> 11.38???????????????????????????????? 0
>> 11356069?????????????????????????? 30/06/2019                      
>> 1.09?????????????????????????????????? 0
>> SC192761???????????????????????? 31/01/2000                         
>> NA?????????????????????????????????? 0
>> SC192761???????????????????????? 31/01/2001                         
>> NA?????????????????????????????????? 0
>> SC192761????????????????????????? 31/01/2002                        
>> NA?????????????????????????????????? 0
>> SC192761???????????????????????? 31/01/2004                         
>> NA?????????????????????????????????? 0
>> SC192761???????????????????????? 31/01/2005                         
>> NA?????????????????????????????????? 0
>> SC192761????????????????????????? 31/01/2006                      
>> 1.09?????????????????????????????????? 0
>> SC192761????????????????????????? 31/01/2008                      
>> 1.24?????????????????????????????????? 0
>> SC192761????????????????????????? 31/01/2009                       
>> 0.9??????????????????????????????????? 0
>> SC192761????????????????????????? 31/01/2010                     
>> 1.14??????????????????????????????????? 0
>> SC192761?????????????????????????? 31/01/2011                    
>> 1.25??????????????????????????????????? 0
>> SC192761????????????????????????? 31/01/2012                     
>> 1.29??????????????????????????????????? 0
>>
>>
>> The code I have written is
>>
>> i <- 0
>>
>> for (i in 1:(nrow(PLC_Return)-1))
>> if (i == 1)
>> {
>> NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
>> } else if
>> (is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])
>> {
>> NUMBER_OF_SHARES[i]=0
>> } else
>> {
>> NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
>> }
>>
>>
>> The error I get is Error: unexpected 'else' in:
>>
>> " NUMBER_OF_SHARES[i] = 0
>> } else"
>>> {NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])}
>>>
>>> }
>> Error: unexpected '}' in "}"
>>
>>
>> Don't know how to fix it-any help will be appreciated.
>>
>>
>> Kind regards
>>
>>
>> Ahson
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m@015k3113 @end|ng |rom b|ueyonder@co@uk  Tue Apr 13 18:11:21 2021
From: m@015k3113 @end|ng |rom b|ueyonder@co@uk (e-mail ma015k3113)
Date: Tue, 13 Apr 2021 17:11:21 +0100 (BST)
Subject: [R] Looping through data error
In-Reply-To: <CAAxdm-58YhUa1f87Bm_ZGCAJGO_aAf44ujpUxD67YTPYzh25sg@mail.gmail.com>
References: <59634000.142366.1618318281941@mail2.virginmedia.com>
 <CAAxdm-58YhUa1f87Bm_ZGCAJGO_aAf44ujpUxD67YTPYzh25sg@mail.gmail.com>
Message-ID: <995683180.149379.1618330281680@mail2.virginmedia.com>

Jim, thanks for taking the time to look into this. Yes, these if else statements are so confusing.

I tried your amended scode and it does not work. The error are as follows:


Error: unexpected '}' in " }"
> NUMBER_OF_SHARES[i] = 100 / is.na(CLOSE_SHARE_PRICE[i])
> }
Error: unexpected '}' in " }"
> }
Error: unexpected '}' in " }"
> }
Error: unexpected '}' in "}"
>

I have spent so much time on this-hopefully I will come to grips sooner or later. In the mean time any further suggestion?


Kind regards


Ahson

> On 13 April 2021 at 14:29 jim holtman <jholtman at gmail.com> wrote:
> 
>     Your code was formatted incorrectly.  There is always a problem with the 'else' statement after an 'if' since in R there is no semicolon to mark the end of a line.  Here might be a better format for your code.  I would recommend the liberal use of "{}"s when using 'if/else'
> 
> 
> 
>     i <- 0
> 
>     for (i in 1:(nrow(PLC_Return) - 1)) {
>       if (i == 1) {
>         NUMBER_OF_SHARES[i] = 100 /http://is.na (CLOSE_SHARE_PRICE[i])
>       } else {
>         if (http://is.na (PLC_Return[i, 1]) ==http://is.na (PLC_Return[i + 1, 1]) {
>           NUMBER_OF_SHARES[i] = 0
>         } else {
>           NUMBER_OF_SHARES[i] = 100 /http://is.na (CLOSE_SHARE_PRICE[i])
>         }
>       }
>     }  
> 
> 
>     Jim Holtman
>     Data Munger Guru
>      
>     What is the problem that you are trying to solve?
>     Tell me what you want to do, not how you want to do it.
> 
> 
>     On Tue, Apr 13, 2021 at 5:51 AM e-mail ma015k3113 via R-help < r-help at r-project.org mailto:r-help at r-project.org > wrote:
> 
>         > > Dear All,I have a dataframe with 4 variables and I am trying to calculate how many shares can be purchased with ?100 in the first year when the company was listed
> > 
> >         The data looks like:
> > 
> >         COMPANY_NUMBER YEAR_END_DATE CLOSE_SHARE_PRICE  NUMBER_OF_SHARES
> >         22705                                30/09/2002                          NA                                 0
> >         22705                                30/09/2004                         NA                                  0
> >         22705                                30/09/2005                        6.55                                 0
> >         22705                                30/09/2006                        7.5                                   0
> >         22705                                30/09/2007                        9.65                                 0
> >         22705                                30/09/2008                        6.55                                 0
> >         1091347                            31/01/2010                        8.14                                 0
> >         1091347                             31/01/2011                      11.38                                 0
> >         11356069                           30/06/2019                      1.09                                   0
> >         SC192761                         31/01/2000                         NA                                   0
> >         SC192761                         31/01/2001                         NA                                   0
> >         SC192761                          31/01/2002                        NA                                   0
> >         SC192761                         31/01/2004                         NA                                   0
> >         SC192761                         31/01/2005                         NA                                   0
> >         SC192761                          31/01/2006                      1.09                                   0
> >         SC192761                          31/01/2008                      1.24                                   0
> >         SC192761                          31/01/2009                       0.9                                    0
> >         SC192761                          31/01/2010                     1.14                                    0
> >         SC192761                           31/01/2011                    1.25                                    0
> >         SC192761                          31/01/2012                     1.29                                    0
> > 
> > 
> >         The code I have written is
> > 
> >         i <- 0
> > 
> >         for (i in 1:(nrow(PLC_Return)-1))
> >         if (i == 1)
> >         {
> >         NUMBER_OF_SHARES[i] = 100/http://is.na (CLOSE_SHARE_PRICE[i])
> >         } else if
> >         (http://is.na (PLC_Return[i, 1]) ==http://is.na (PLC_Return[i + 1, 1])
> >         {
> >         NUMBER_OF_SHARES[i]=0
> >         } else
> >         {
> >         NUMBER_OF_SHARES[i] = 100/http://is.na (CLOSE_SHARE_PRICE[i])
> >         }
> > 
> > 
> >         The error I get is Error: unexpected 'else' in:
> > 
> >         " NUMBER_OF_SHARES[i] = 0
> >         } else"
> >         > {NUMBER_OF_SHARES[i] = 100/http://is.na (CLOSE_SHARE_PRICE[i])}
> >         >
> >         > }
> >         Error: unexpected '}' in "}"
> > 
> > 
> >         Don't know how to fix it-any help will be appreciated.
> > 
> > 
> >         Kind regards
> > 
> > 
> >         Ahson
> >                 [[alternative HTML version deleted]]
> > 
> >         ______________________________________________
> >         R-help at r-project.org mailto:R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >         https://stat.ethz.ch/mailman/listinfo/r-help
> >         PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >         and provide commented, minimal, self-contained, reproducible code.
> > 
> >     > 

	[[alternative HTML version deleted]]


From cd@@ek m@iii@g oii posteo@de  Tue Apr 13 17:11:39 2021
From: cd@@ek m@iii@g oii posteo@de (cd@@ek m@iii@g oii posteo@de)
Date: Tue, 13 Apr 2021 17:11:39 +0200
Subject: [R] =?utf-8?q?graphics_useRaster_check=5Firregular_definition_fo?=
 =?utf-8?q?r_date_or_posix?=
Message-ID: <c5279327071e612bd17d1d69b8f16496@posteo.de>

 Hi

The function `check_irregular()` defined within
`graphics::image.default()` checks if the `useRaster` argument for
`graphics::image()` can be true or must be false. 

According to this function, the following example vector is irregular:
```
time <- seq(as.Date("2020-1-1"), as.Date("2020-12-31"), l=12)
 check_irregular(time, time)
# TRUE
```
In my view, this is not correct. 

In this case, the `all.equal`-call does not evaluate to true due to the
special class of `dx` (or `dy`). If I slightly rewrite the function as
```
my_check_irregular <- function (x, y)
{ 
 dx <- as.numeric(diff(x)) 
 dy <- as.numeric(diff(y)) 
 (length(dx) && !isTRUE(all.equal(dx, rep(dx[1], length(dx))))) || 
 (length(dy) && !isTRUE(all.equal(dy, rep(dy[1], length(dy))))) 
}
 ```
the correct answer is obtained (i.e. that the input vector is not
irregular based on the rational behind `all.equal`):
```
my_check_irregular(time, time) 
# FALSE
 ```

The same applies to POSIX* objects. I was wondering if this is intended
or not?

Thanks a lot for any answer,
Chris 
	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Tue Apr 13 19:47:36 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 13 Apr 2021 10:47:36 -0700
Subject: [R] Add a new row based on test set predicted values and time
 stamps
In-Reply-To: <568265892.2252019.1618309582985@mail.yahoo.com>
References: <568265892.2252019.1618309582985.ref@mail.yahoo.com>
 <568265892.2252019.1618309582985@mail.yahoo.com>
Message-ID: <CAGxFJbSQUguSHwBBtRFFX74w+9gmr2hU82HXwBEY7DJzb_YwLA@mail.gmail.com>

It may not be necessary to insert the rows in that order -- R can identify
and use the information from the rows in in most cases without it.
So to combine the results as you described (the code you sent got garbled a
bit btw -- you should proofread more carefully in future), all you would
need to do is:

## with train and test your train and test data frames of course
out <- na.omit(rbind(train, cbind(test[,c(1,3,4)], Value = test[,"value"])))
## Note that the cbind() stuff is needed to create the correct "Value"
column for rbind(). See ?rbind for details

If you insist that you need the row ordering as you specified, then follow
this by:

out <- with(out, out[order(Group, id, as.POSIXct(Date,format = "%D%")), ])

What this does is to first convert your text data column to POSIXct ("See
?DateTimeClasses for details) which gives them the desired calendar
ordering. The order() function (see ?order for details) then gives the
permutation ordering them from early to late within groups and id's, which
are then used as the row subscripts to reorder the rows in the data frame.

DO NOTE: For this to work reliably, your Date column must be consistent and
correct in its formatting!

Other note: It probably makes more sense to convert your Date column to a
POSIXct or POSIXlt dates from the beginning, as this will make things like
plotting in date order straightforward. There are also date-time packages
(in the "tidyverse" suite, I think,  as well as others) that simplify such
things. I am pretty ignorant about date-time stuff, so I can't really be
more specific. https://cran.r-project.org/web/views/TimeSeries.html  will
have lots of info on this if you need it. As well as searching, of course.

HTH

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Tue, Apr 13, 2021 at 3:26 AM Elahe chalabi via R-help <
r-help at r-project.org> wrote:

> Hi all,
>
> I have the prediction for my test set which are forecasted Value for
> "4/1/2020" for each match of "id" and "Group". I would like to add a fourth
> row to each group by (Group,id) in my train set and the values for this row
> should come from test set :
>
> my train set:
>
>      structure(list(Date = c("1/1/2020", "2/1/2020", "3/1/2020",
> "1/1/2020",
>      "2/1/2020", "3/1/2020", "1/1/2020", "2/1/2020", "3/1/2020", ""
>      ), Value = c(3.5, 2.7, 4, 2.5, 3.7, 0, 3, 0, 1, NA), Group = c("A",
>     "A", "A", "B", "B", "B", "C", "C", "C", ""), id = c(1L, 1L, 1L,
>     101L, 101L, 101L, 100L, 100L, 100L, NA)), class = "data.frame",
> row.names = c(NA,
>     -10L))
>
> test set:
>
>     structure(list(Date = c("4/1/2020", "4/1/2020", "4/1/2020", ""
>       ), Value = c(3.5, 2.5, 3, NA), Group = c("A", "B", "C", ""),
>     id = c(1L, 101L, 100L, NA), value = c(0.2, 0.7, 0.9, NA)), class =
> "data.frame", row.names = c(NA,
>      -4L))structure(list(Date = c("4/1/2020", "4/1/2020", "4/1/2020", ""
>     ), Value = c(3.5, 2.5, 3, NA), Group = c("A", "B", "C", ""),
>     id = c(1L, 101L, 100L, NA)), class = "data.frame", row.names = c(NA,
>     -4L))
>
> desired output:
>
>     structure(list(Date = c("1/1/2020", "2/1/2020", "3/1/2020",
> "4/1/2020",
>     "1/1/2020", "2/1/2020", "3/1/2020", "4/1/2020", "1/1/2020",
> "2/1/2020",
>     "3/1/2020", "4/1/2020"), Value = c(3.5, 2.7, 4, 0.2, 2.5, 3.7,
>      0, 0.7, 3, 0, 1, 0.9), Group = c("A", "A", "A", "A", "B", "B",
>     "B", "B", "C", "C", "C", "C"), id = c(1L, 1L, 1L, 1L, 101L, 101L,
>     101L, 101L, 100L, 100L, 100L, 100L)), class = "data.frame", row.names
> = c(NA,
>    -12L))
>
> Data is dummy and I have milions of records in original data set.
>
> Thanks for any help.
> Elahe
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Tue Apr 13 19:55:04 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 13 Apr 2021 10:55:04 -0700
Subject: [R] Add a new row based on test set predicted values and time
 stamps
In-Reply-To: <CAGxFJbSQUguSHwBBtRFFX74w+9gmr2hU82HXwBEY7DJzb_YwLA@mail.gmail.com>
References: <568265892.2252019.1618309582985.ref@mail.yahoo.com>
 <568265892.2252019.1618309582985@mail.yahoo.com>
 <CAGxFJbSQUguSHwBBtRFFX74w+9gmr2hU82HXwBEY7DJzb_YwLA@mail.gmail.com>
Message-ID: <CAGxFJbS_zyvbrMGvvXri6AeWX7V15S67Sge1jpftSpf50y1ysg@mail.gmail.com>

(Revealing my ignorance):

Simpler still than the as.POSIXct() idiom is just to use the as.Date
version:

out <- with(out, out [order(Group, id, as.Date(Date)),])

## all else the same...

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Tue, Apr 13, 2021 at 10:47 AM Bert Gunter <bgunter.4567 at gmail.com> wrote:

> It may not be necessary to insert the rows in that order -- R can identify
> and use the information from the rows in in most cases without it.
> So to combine the results as you described (the code you sent got garbled
> a bit btw -- you should proofread more carefully in future), all you would
> need to do is:
>
> ## with train and test your train and test data frames of course
> out <- na.omit(rbind(train, cbind(test[,c(1,3,4)], Value =
> test[,"value"])))
> ## Note that the cbind() stuff is needed to create the correct "Value"
> column for rbind(). See ?rbind for details
>
> If you insist that you need the row ordering as you specified, then follow
> this by:
>
> out <- with(out, out[order(Group, id, as.POSIXct(Date,format = "%D%")), ])
>
> What this does is to first convert your text data column to POSIXct ("See
> ?DateTimeClasses for details) which gives them the desired calendar
> ordering. The order() function (see ?order for details) then gives the
> permutation ordering them from early to late within groups and id's, which
> are then used as the row subscripts to reorder the rows in the data frame.
>
> DO NOTE: For this to work reliably, your Date column must be consistent
> and correct in its formatting!
>
> Other note: It probably makes more sense to convert your Date column to a
> POSIXct or POSIXlt dates from the beginning, as this will make things like
> plotting in date order straightforward. There are also date-time packages
> (in the "tidyverse" suite, I think,  as well as others) that simplify such
> things. I am pretty ignorant about date-time stuff, so I can't really be
> more specific. https://cran.r-project.org/web/views/TimeSeries.html  will
> have lots of info on this if you need it. As well as searching, of course.
>
> HTH
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along and
> sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
>
> On Tue, Apr 13, 2021 at 3:26 AM Elahe chalabi via R-help <
> r-help at r-project.org> wrote:
>
>> Hi all,
>>
>> I have the prediction for my test set which are forecasted Value for
>> "4/1/2020" for each match of "id" and "Group". I would like to add a fourth
>> row to each group by (Group,id) in my train set and the values for this row
>> should come from test set :
>>
>> my train set:
>>
>>      structure(list(Date = c("1/1/2020", "2/1/2020", "3/1/2020",
>> "1/1/2020",
>>      "2/1/2020", "3/1/2020", "1/1/2020", "2/1/2020", "3/1/2020", ""
>>      ), Value = c(3.5, 2.7, 4, 2.5, 3.7, 0, 3, 0, 1, NA), Group = c("A",
>>     "A", "A", "B", "B", "B", "C", "C", "C", ""), id = c(1L, 1L, 1L,
>>     101L, 101L, 101L, 100L, 100L, 100L, NA)), class = "data.frame",
>> row.names = c(NA,
>>     -10L))
>>
>> test set:
>>
>>     structure(list(Date = c("4/1/2020", "4/1/2020", "4/1/2020", ""
>>       ), Value = c(3.5, 2.5, 3, NA), Group = c("A", "B", "C", ""),
>>     id = c(1L, 101L, 100L, NA), value = c(0.2, 0.7, 0.9, NA)), class =
>> "data.frame", row.names = c(NA,
>>      -4L))structure(list(Date = c("4/1/2020", "4/1/2020", "4/1/2020", ""
>>     ), Value = c(3.5, 2.5, 3, NA), Group = c("A", "B", "C", ""),
>>     id = c(1L, 101L, 100L, NA)), class = "data.frame", row.names = c(NA,
>>     -4L))
>>
>> desired output:
>>
>>     structure(list(Date = c("1/1/2020", "2/1/2020", "3/1/2020",
>> "4/1/2020",
>>     "1/1/2020", "2/1/2020", "3/1/2020", "4/1/2020", "1/1/2020",
>> "2/1/2020",
>>     "3/1/2020", "4/1/2020"), Value = c(3.5, 2.7, 4, 0.2, 2.5, 3.7,
>>      0, 0.7, 3, 0, 1, 0.9), Group = c("A", "A", "A", "A", "B", "B",
>>     "B", "B", "C", "C", "C", "C"), id = c(1L, 1L, 1L, 1L, 101L, 101L,
>>     101L, 101L, 100L, 100L, 100L, 100L)), class = "data.frame", row.names
>> = c(NA,
>>    -12L))
>>
>> Data is dummy and I have milions of records in original data set.
>>
>> Thanks for any help.
>> Elahe
>>
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Tue Apr 13 20:23:38 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Tue, 13 Apr 2021 11:23:38 -0700
Subject: [R] Add a new row based on test set predicted values and time
 stamps
In-Reply-To: <CAGxFJbS_zyvbrMGvvXri6AeWX7V15S67Sge1jpftSpf50y1ysg@mail.gmail.com>
References: <568265892.2252019.1618309582985.ref@mail.yahoo.com>
 <568265892.2252019.1618309582985@mail.yahoo.com>
 <CAGxFJbSQUguSHwBBtRFFX74w+9gmr2hU82HXwBEY7DJzb_YwLA@mail.gmail.com>
 <CAGxFJbS_zyvbrMGvvXri6AeWX7V15S67Sge1jpftSpf50y1ysg@mail.gmail.com>
Message-ID: <5DC03B26-FFA4-416D-9C8D-1DA3348FE4AB@dcn.davis.ca.us>

The date you get using as.Date on a POSIXct value depends on the timezone. That is, as.Date only pays attention to the underlying UTC seconds-since-epoch value, so it ignores the timezone which can be unexpected for most people. 

TL;DR as.Date is not the same as as.POSIXct( trunc( dtm, units="days" ) ) unless you are using GMT.

On April 13, 2021 10:55:04 AM PDT, Bert Gunter <bgunter.4567 at gmail.com> wrote:
>(Revealing my ignorance):
>
>Simpler still than the as.POSIXct() idiom is just to use the as.Date
>version:
>
>out <- with(out, out [order(Group, id, as.Date(Date)),])
>
>## all else the same...
>
>Bert Gunter
>
>"The trouble with having an open mind is that people keep coming along
>and
>sticking things into it."
>-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
>
>On Tue, Apr 13, 2021 at 10:47 AM Bert Gunter <bgunter.4567 at gmail.com>
>wrote:
>
>> It may not be necessary to insert the rows in that order -- R can
>identify
>> and use the information from the rows in in most cases without it.
>> So to combine the results as you described (the code you sent got
>garbled
>> a bit btw -- you should proofread more carefully in future), all you
>would
>> need to do is:
>>
>> ## with train and test your train and test data frames of course
>> out <- na.omit(rbind(train, cbind(test[,c(1,3,4)], Value =
>> test[,"value"])))
>> ## Note that the cbind() stuff is needed to create the correct
>"Value"
>> column for rbind(). See ?rbind for details
>>
>> If you insist that you need the row ordering as you specified, then
>follow
>> this by:
>>
>> out <- with(out, out[order(Group, id, as.POSIXct(Date,format =
>"%D%")), ])
>>
>> What this does is to first convert your text data column to POSIXct
>("See
>> ?DateTimeClasses for details) which gives them the desired calendar
>> ordering. The order() function (see ?order for details) then gives
>the
>> permutation ordering them from early to late within groups and id's,
>which
>> are then used as the row subscripts to reorder the rows in the data
>frame.
>>
>> DO NOTE: For this to work reliably, your Date column must be
>consistent
>> and correct in its formatting!
>>
>> Other note: It probably makes more sense to convert your Date column
>to a
>> POSIXct or POSIXlt dates from the beginning, as this will make things
>like
>> plotting in date order straightforward. There are also date-time
>packages
>> (in the "tidyverse" suite, I think,  as well as others) that simplify
>such
>> things. I am pretty ignorant about date-time stuff, so I can't really
>be
>> more specific. https://cran.r-project.org/web/views/TimeSeries.html 
>will
>> have lots of info on this if you need it. As well as searching, of
>course.
>>
>> HTH
>>
>> Bert Gunter
>>
>> "The trouble with having an open mind is that people keep coming
>along and
>> sticking things into it."
>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>
>>
>> On Tue, Apr 13, 2021 at 3:26 AM Elahe chalabi via R-help <
>> r-help at r-project.org> wrote:
>>
>>> Hi all,
>>>
>>> I have the prediction for my test set which are forecasted Value for
>>> "4/1/2020" for each match of "id" and "Group". I would like to add a
>fourth
>>> row to each group by (Group,id) in my train set and the values for
>this row
>>> should come from test set :
>>>
>>> my train set:
>>>
>>>      structure(list(Date = c("1/1/2020", "2/1/2020", "3/1/2020",
>>> "1/1/2020",
>>>      "2/1/2020", "3/1/2020", "1/1/2020", "2/1/2020", "3/1/2020", ""
>>>      ), Value = c(3.5, 2.7, 4, 2.5, 3.7, 0, 3, 0, 1, NA), Group =
>c("A",
>>>     "A", "A", "B", "B", "B", "C", "C", "C", ""), id = c(1L, 1L, 1L,
>>>     101L, 101L, 101L, 100L, 100L, 100L, NA)), class = "data.frame",
>>> row.names = c(NA,
>>>     -10L))
>>>
>>> test set:
>>>
>>>     structure(list(Date = c("4/1/2020", "4/1/2020", "4/1/2020", ""
>>>       ), Value = c(3.5, 2.5, 3, NA), Group = c("A", "B", "C", ""),
>>>     id = c(1L, 101L, 100L, NA), value = c(0.2, 0.7, 0.9, NA)), class
>=
>>> "data.frame", row.names = c(NA,
>>>      -4L))structure(list(Date = c("4/1/2020", "4/1/2020",
>"4/1/2020", ""
>>>     ), Value = c(3.5, 2.5, 3, NA), Group = c("A", "B", "C", ""),
>>>     id = c(1L, 101L, 100L, NA)), class = "data.frame", row.names =
>c(NA,
>>>     -4L))
>>>
>>> desired output:
>>>
>>>     structure(list(Date = c("1/1/2020", "2/1/2020", "3/1/2020",
>>> "4/1/2020",
>>>     "1/1/2020", "2/1/2020", "3/1/2020", "4/1/2020", "1/1/2020",
>>> "2/1/2020",
>>>     "3/1/2020", "4/1/2020"), Value = c(3.5, 2.7, 4, 0.2, 2.5, 3.7,
>>>      0, 0.7, 3, 0, 1, 0.9), Group = c("A", "A", "A", "A", "B", "B",
>>>     "B", "B", "C", "C", "C", "C"), id = c(1L, 1L, 1L, 1L, 101L,
>101L,
>>>     101L, 101L, 100L, 100L, 100L, 100L)), class = "data.frame",
>row.names
>>> = c(NA,
>>>    -12L))
>>>
>>> Data is dummy and I have milions of records in original data set.
>>>
>>> Thanks for any help.
>>> Elahe
>>>
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From m@015k3113 @end|ng |rom b|ueyonder@co@uk  Tue Apr 13 20:24:02 2021
From: m@015k3113 @end|ng |rom b|ueyonder@co@uk (e-mail ma015k3113)
Date: Tue, 13 Apr 2021 19:24:02 +0100 (BST)
Subject: [R] Looping through data error
In-Reply-To: <b4cd892a-a4c6-8635-e1b3-7fb4bf90f0ae@sapo.pt>
References: <59634000.142366.1618318281941@mail2.virginmedia.com>
 <b4cd892a-a4c6-8635-e1b3-7fb4bf90f0ae@sapo.pt>
Message-ID: <1129233458.153486.1618338243060@mail2.virginmedia.com>

Rui, excellent diagnosis and suggestion. It worked but my damn logic is still not delivering what I want-will spend more time on it tomorrow.


Kind regards

Ahson

> On 13 April 2021 at 17:06 Rui Barradas <ruipbarradas at sapo.pt> wrote:
> 
> 
> Hello,
> 
> A close parenthesis is missing in the nd if.
> 
> 
> for (i in 1:(nrow(PLC_Return)-1)){
>    if (i == 1){
>      NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
>    } else if(is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])){
>      NUMBER_OF_SHARES[i]=0
>    } else {
>      NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
>    }
> }
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 13:51 de 13/04/21, e-mail ma015k3113 via R-help escreveu:
> > Dear All,I have a dataframe with 4 variables and I am trying to calculate how many shares can be purchased with ?100 in the first year when the company was listed
> > 
> > The data looks like:
> > 
> > COMPANY_NUMBER YEAR_END_DATE CLOSE_SHARE_PRICE  NUMBER_OF_SHARES
> > 22705                                30/09/2002                          NA                                 0
> > 22705                                30/09/2004                         NA                                  0
> > 22705                                30/09/2005                        6.55                                 0
> > 22705                                30/09/2006                        7.5                                   0
> > 22705                                30/09/2007                        9.65                                 0
> > 22705                                30/09/2008                        6.55                                 0
> > 1091347                            31/01/2010                        8.14                                 0
> > 1091347                             31/01/2011                      11.38                                 0
> > 11356069                           30/06/2019                      1.09                                   0
> > SC192761                         31/01/2000                         NA                                   0
> > SC192761                         31/01/2001                         NA                                   0
> > SC192761                          31/01/2002                        NA                                   0
> > SC192761                         31/01/2004                         NA                                   0
> > SC192761                         31/01/2005                         NA                                   0
> > SC192761                          31/01/2006                      1.09                                   0
> > SC192761                          31/01/2008                      1.24                                   0
> > SC192761                          31/01/2009                       0.9                                    0
> > SC192761                          31/01/2010                     1.14                                    0
> > SC192761                           31/01/2011                    1.25                                    0
> > SC192761                          31/01/2012                     1.29                                    0
> > 
> > 
> > The code I have written is
> > 
> > i <- 0
> > 
> > for (i in 1:(nrow(PLC_Return)-1))
> > if (i == 1)
> > {
> > NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> > } else if
> > (is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])
> > {
> > NUMBER_OF_SHARES[i]=0
> > } else
> > {
> > NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> > }
> > 
> > 
> > The error I get is Error: unexpected 'else' in:
> > 
> > " NUMBER_OF_SHARES[i] = 0
> > } else"
> >> {NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])}
> >>
> >> }
> > Error: unexpected '}' in "}"
> > 
> > 
> > Don't know how to fix it-any help will be appreciated.
> > 
> > 
> > Kind regards
> > 
> > 
> > Ahson
> > 	[[alternative HTML version deleted]]
> > 
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >


From bgunter@4567 @end|ng |rom gm@||@com  Tue Apr 13 22:33:26 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 13 Apr 2021 13:33:26 -0700
Subject: [R] Looping through data error
In-Reply-To: <1129233458.153486.1618338243060@mail2.virginmedia.com>
References: <59634000.142366.1618318281941@mail2.virginmedia.com>
 <b4cd892a-a4c6-8635-e1b3-7fb4bf90f0ae@sapo.pt>
 <1129233458.153486.1618338243060@mail2.virginmedia.com>
Message-ID: <CAGxFJbQAYaUnEiyEYWQmqkBYAz3eAzvdV=_-=6Xcfpyf74egrQ@mail.gmail.com>

Well, if I understand your query, wouldn't the following simple approach
suffice -- it assumes that the results for each company are ordered by
year, as your example seems to show:

## test is your example data
## first remove NA's
test2 <- na.omit(test)

## Now just use tapply():
> out <-with(test2, tapply(CLOSE_SHARE_PRICE, COMPANY_NUMBER,
+                       FUN =function(x)100 /x[1]))
> out
 1091347 11356069    22705 SC192761
12.28501 91.74312 15.26718 91.74312
## essentially a labelled vector
##You can use  %/% if you only want the whole number of shares that can be
purchased

It's somewhat messier if the results are not ordered by date within company
-- you could use by() and POSIXct to order the dates within company to get
the right one.

Cheers,

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Tue, Apr 13, 2021 at 11:34 AM e-mail ma015k3113 via R-help <
r-help at r-project.org> wrote:

> Rui, excellent diagnosis and suggestion. It worked but my damn logic is
> still not delivering what I want-will spend more time on it tomorrow.
>
>
> Kind regards
>
> Ahson
>
> > On 13 April 2021 at 17:06 Rui Barradas <ruipbarradas at sapo.pt> wrote:
> >
> >
> > Hello,
> >
> > A close parenthesis is missing in the nd if.
> >
> >
> > for (i in 1:(nrow(PLC_Return)-1)){
> >    if (i == 1){
> >      NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> >    } else if(is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])){
> >      NUMBER_OF_SHARES[i]=0
> >    } else {
> >      NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> >    }
> > }
> >
> >
> > Hope this helps,
> >
> > Rui Barradas
> >
> > ?s 13:51 de 13/04/21, e-mail ma015k3113 via R-help escreveu:
> > > Dear All,I have a dataframe with 4 variables and I am trying to
> calculate how many shares can be purchased with ?100 in the first year when
> the company was listed
> > >
> > > The data looks like:
> > >
> > > COMPANY_NUMBER YEAR_END_DATE CLOSE_SHARE_PRICE  NUMBER_OF_SHARES
> > > 22705                                30/09/2002
>   NA                                 0
> > > 22705                                30/09/2004
>  NA                                  0
> > > 22705                                30/09/2005
> 6.55                                 0
> > > 22705                                30/09/2006
> 7.5                                   0
> > > 22705                                30/09/2007
> 9.65                                 0
> > > 22705                                30/09/2008
> 6.55                                 0
> > > 1091347                            31/01/2010
> 8.14                                 0
> > > 1091347                             31/01/2011
> 11.38                                 0
> > > 11356069                           30/06/2019
> 1.09                                   0
> > > SC192761                         31/01/2000
>  NA                                   0
> > > SC192761                         31/01/2001
>  NA                                   0
> > > SC192761                          31/01/2002
> NA                                   0
> > > SC192761                         31/01/2004
>  NA                                   0
> > > SC192761                         31/01/2005
>  NA                                   0
> > > SC192761                          31/01/2006
> 1.09                                   0
> > > SC192761                          31/01/2008
> 1.24                                   0
> > > SC192761                          31/01/2009
>  0.9                                    0
> > > SC192761                          31/01/2010                     1.14
>                                   0
> > > SC192761                           31/01/2011                    1.25
>                                   0
> > > SC192761                          31/01/2012                     1.29
>                                   0
> > >
> > >
> > > The code I have written is
> > >
> > > i <- 0
> > >
> > > for (i in 1:(nrow(PLC_Return)-1))
> > > if (i == 1)
> > > {
> > > NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> > > } else if
> > > (is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])
> > > {
> > > NUMBER_OF_SHARES[i]=0
> > > } else
> > > {
> > > NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> > > }
> > >
> > >
> > > The error I get is Error: unexpected 'else' in:
> > >
> > > " NUMBER_OF_SHARES[i] = 0
> > > } else"
> > >> {NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])}
> > >>
> > >> }
> > > Error: unexpected '}' in "}"
> > >
> > >
> > > Don't know how to fix it-any help will be appreciated.
> > >
> > >
> > > Kind regards
> > >
> > >
> > > Ahson
> > >     [[alternative HTML version deleted]]
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> > >
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From p@u| @end|ng |rom @t@t@@uck|@nd@@c@nz  Wed Apr 14 04:37:48 2021
From: p@u| @end|ng |rom @t@t@@uck|@nd@@c@nz (Paul Murrell)
Date: Wed, 14 Apr 2021 14:37:48 +1200
Subject: [R] 
 graphics useRaster check_irregular definition for date or posix
In-Reply-To: <c5279327071e612bd17d1d69b8f16496@posteo.de>
References: <c5279327071e612bd17d1d69b8f16496@posteo.de>
Message-ID: <5d3a892b-06b3-71fc-46bf-f2c8b90899f7@stat.auckland.ac.nz>

Hi

I doubt it is intended (to deliberately exclude "difftime" objects).

Can you please supply a full image() example (with 'x' and/or 'y' as 
Dates and a 'z') ?  So that I can see what ...

image(x, y, z, useRaster=FALSE)

... looks like, so I can see what you want ...

image(x, y, z, useRaster=TRUE)

... to look like.

I also wonder whether switching to ...

dx[1][rep(1, length(dx))]

... might be better than switching to ...

as.numeric(dx)

It produces the same result for "difftime" objects, and may have a 
better chance of working better with other objects (although I confess 
that not having thought of using a "difftime" for 'x' I am also failing 
to think of further possibilities for 'x').

Paul

On 14/04/21 3:11 am, cdanek at posteo.de wrote:
> Hi
> 
> The function `check_irregular()` defined within
> `graphics::image.default()` checks if the `useRaster` argument for
> `graphics::image()` can be true or must be false.
> 
> According to this function, the following example vector is irregular:
> ```
> time <- seq(as.Date("2020-1-1"), as.Date("2020-12-31"), l=12)
> check_irregular(time, time)
> # TRUE
> ```
> In my view, this is not correct.
> 
> In this case, the `all.equal`-call does not evaluate to true due to the
> special class of `dx` (or `dy`). If I slightly rewrite the function as
> ```
> my_check_irregular <- function (x, y)
> {
> dx <- as.numeric(diff(x))
> dy <- as.numeric(diff(y))
> (length(dx) && !isTRUE(all.equal(dx, rep(dx[1], length(dx))))) ||
> (length(dy) && !isTRUE(all.equal(dy, rep(dy[1], length(dy)))))
> }
> ```
> the correct answer is obtained (i.e. that the input vector is not
> irregular based on the rational behind `all.equal`):
> ```
> my_check_irregular(time, time)
> # FALSE
> ```
> 
> The same applies to POSIX* objects. I was wondering if this is intended
> or not?
> 
> Thanks a lot for any answer,
> Chris
> [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help 
> <https://stat.ethz.ch/mailman/listinfo/r-help>
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html 
> <http://www.R-project.org/posting-guide.html>
> and provide commented, minimal, self-contained, reproducible code.

-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul at stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/


From mbrockw@y @end|ng |rom mtech@edu  Tue Apr 13 18:19:03 2021
From: mbrockw@y @end|ng |rom mtech@edu (Brockway, Molly)
Date: Tue, 13 Apr 2021 16:19:03 +0000
Subject: [R] How to force boundary conditions on discretized derivative in
 deSolve?
Message-ID: <CY4PR15MB12698FB5F66018F0AB4C5FDFA24F9@CY4PR15MB1269.namprd15.prod.outlook.com>

Hello,

I am using R package deSolve to solve a system of two differential equations for a one-dimensional spatial and time-based problem. There is one ODE and a second-order PDE. In order to solve with the function ode.1D, I've discretized the spatial derivative and put both equations in terms of the time derivative only. However, I'm now stuck with the problem of being unable to impose boundary conditions on the spatial derivative for flux at the edges of the system. How can I force a value for the discretized dE/dx part of my equations at x = 0 and x = 1?

The code I have been using is below. The ode.1D solver will run on it, but the solutions aren't correct for my system owing to the missing boundary conditions.

Thanks,

Molly C Brockway
Materials Science - PhD Candidate
Metallurgical and Materials Engineering - B.S.

Montana Technological University


```
BVmod1D <- function(time, state, parms, N, dx) {
? with(as.list(parms), {
? ? U <- state[1 : N]
? ? E <- state[(N + 1) : (2 * N)]
? ? 
? ? coef1 <- Sv * io / (Qox - Qred)
? ? coef2 <- Tau * io / Cd
? ? BV <- exp(aa * f * (E - 0.5 * (U) )) - exp(-ac * f * (E - 0.5 * (1 + U)))

? ? dEdx <- diff(c(E, E[N])) / dx # first spatial derivative of E
? ? ddEddx <- diff(c(dEdx, dEdx[N])) / dx # second spatial derivative of E
? 
? ? dU <- coef1 * BV   
? ? dE <- (ddEddx - (coef2 * BV)) / Tau 

? ? return(list(c(dU, dE)))
? })
}

pars <- c(Sv = 1.72e5, 
? ? ? ? ? io = 1.71e-6, 
? ? ? ? ? Qox = 1.56, 
? ? ? ? ? Qred = 0,
? ? ? ? ? Tau = 3.79e-6, 
? ? ? ? ? Cd = 7.42e-8, 
? ? ? ? ? aa = 0.7674, 
? ? ? ? ? ac = 0.2326, 
? ? ? ? ? ks = 0.042992, 
? ? ? ? ? sig = 1.67e-6, 
? ? ? ? ? f = 38.92237)

R <- 1
N <- 50
dx <- R / N
Vo <- 0.5

# Initial and Boundary Conditions
yini <- rep(0, (2 * N))
yini[ 1 : N ] <- 2 * Vo
yini[ (N + 1) : (2 * N)] <- 1 
times <- seq(0, 1 , by = 0.002 )

out <- ode.1D(
? y = yini,
? times = times,
? func = BVmod1D,
? parms = pars,
? nspec = 2,
? N = N,
? dx = dx
)
```



















From mcg@rvey@bern@rd @end|ng |rom comc@@t@net  Wed Apr 14 19:42:15 2021
From: mcg@rvey@bern@rd @end|ng |rom comc@@t@net (Bernard McGarvey)
Date: Wed, 14 Apr 2021 13:42:15 -0400 (EDT)
Subject: [R] Error loading "XLConnect" library
Message-ID: <635919934.197924.1618422135644@connect.xfinity.com>

I installed the "XLConnect" package which appears to be successful and then tried to load the "XLConnect" library and got an error as shown below. Any ideas as to where to look for the source of the error? The word "release" in the error message makes me think it is some issue with the version of "XLConnect" but that is just a guess.

I am running the latest version of R available on CRAN on Windows 10.

> install.packages("XLConnect")
Installing package into ?E:/Data/OneDrive/Documents/R/win-library/4.0?
(as ?lib? is unspecified)
trying URL 'https://cran.rstudio.com/bin/windows/contrib/4.0/XLConnect_1.0.3.zip'
Content type 'application/zip' length 29498979 bytes (28.1 MB)
downloaded 28.1 MB
package ?XLConnect? successfully unpacked and MD5 sums checked
The downloaded binary packages are in
C:\Users\User\AppData\Local\Temp\RtmpARt8Er\downloaded_packages

> library(XLConnect)
Error: package or namespace load failed for ?XLConnect?:
.onLoad failed in loadNamespace() for 'XLConnect', details:
call: system2("cat", c("/etc/*-release"), stdout = TRUE, stderr = TRUE)
error: '"cat"' not found

> library("XLConnect")
Error: package or namespace load failed for ?XLConnect?:
.onLoad failed in loadNamespace() for 'XLConnect', details:
call: system2("cat", c("/etc/*-release"), stdout = TRUE, stderr = TRUE)
error: '"cat"' not found



Thanks



Bernard McGarvey

Director, Fort Myers Beach Lions Foundation, Inc.

Retired (Lilly Engineering Fellow).




	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Wed Apr 14 19:59:30 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 14 Apr 2021 10:59:30 -0700
Subject: [R] 
 How to force boundary conditions on discretized derivative in
 deSolve?
In-Reply-To: <CY4PR15MB12698FB5F66018F0AB4C5FDFA24F9@CY4PR15MB1269.namprd15.prod.outlook.com>
References: <CY4PR15MB12698FB5F66018F0AB4C5FDFA24F9@CY4PR15MB1269.namprd15.prod.outlook.com>
Message-ID: <CAGxFJbQ=e9VwieLqXAjDUYhLa7SELZhPAKmaK2O6ZBtBAezeWg@mail.gmail.com>

1. Your query is off topic. See the posting guide linked below for what is
appropriate. In particular, note:
"*Questions about statistics:* The R mailing lists are primarily intended
for questions and discussion about the R software. However, questions about
statistical methodology are sometimes posted. If the question is well-asked
and of interest to someone on the list, it *may* elicit an informative
up-to-date answer."

and

"For questions about functions in standard packages distributed with R (see
the FAQ Add-on packages in R
<https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R>), ask
questions on R-help.
If the question relates to a *contributed package* , e.g., one downloaded
from CRAN, try contacting the package maintainer first. You can also use
find("functionname") and packageDescription("packagename") to find this
information. *Only* send such questions to R-help or R-devel if you get no
reply or need further assistance. This applies to both requests for help
and to bug reports."

2. See https://cran.r-project.org/web/views/DifferentialEquations.html  .
Note especially the link to the dynamic models SIG therein, which I assume
might be helpful to you.

Cheers,
Bert

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Wed, Apr 14, 2021 at 7:05 AM Brockway, Molly <mbrockway at mtech.edu> wrote:

> Hello,
>
> I am using R package deSolve to solve a system of two differential
> equations for a one-dimensional spatial and time-based problem. There is
> one ODE and a second-order PDE. In order to solve with the function ode.1D,
> I've discretized the spatial derivative and put both equations in terms of
> the time derivative only. However, I'm now stuck with the problem of being
> unable to impose boundary conditions on the spatial derivative for flux at
> the edges of the system. How can I force a value for the discretized dE/dx
> part of my equations at x = 0 and x = 1?
>
> The code I have been using is below. The ode.1D solver will run on it, but
> the solutions aren't correct for my system owing to the missing boundary
> conditions.
>
> Thanks,
>
> Molly C Brockway
> Materials Science - PhD Candidate
> Metallurgical and Materials Engineering - B.S.
>
> Montana Technological University
>
>
> ```
> BVmod1D <- function(time, state, parms, N, dx) {
>   with(as.list(parms), {
>     U <- state[1 : N]
>     E <- state[(N + 1) : (2 * N)]
>
>     coef1 <- Sv * io / (Qox - Qred)
>     coef2 <- Tau * io / Cd
>     BV <- exp(aa * f * (E - 0.5 * (U) )) - exp(-ac * f * (E - 0.5 * (1 +
> U)))
>
>     dEdx <- diff(c(E, E[N])) / dx # first spatial derivative of E
>     ddEddx <- diff(c(dEdx, dEdx[N])) / dx # second spatial derivative of E
>
>     dU <- coef1 * BV
>     dE <- (ddEddx - (coef2 * BV)) / Tau
>
>     return(list(c(dU, dE)))
>   })
> }
>
> pars <- c(Sv = 1.72e5,
>           io = 1.71e-6,
>           Qox = 1.56,
>           Qred = 0,
>           Tau = 3.79e-6,
>           Cd = 7.42e-8,
>           aa = 0.7674,
>           ac = 0.2326,
>           ks = 0.042992,
>           sig = 1.67e-6,
>           f = 38.92237)
>
> R <- 1
> N <- 50
> dx <- R / N
> Vo <- 0.5
>
> # Initial and Boundary Conditions
> yini <- rep(0, (2 * N))
> yini[ 1 : N ] <- 2 * Vo
> yini[ (N + 1) : (2 * N)] <- 1
> times <- seq(0, 1 , by = 0.002 )
>
> out <- ode.1D(
>   y = yini,
>   times = times,
>   func = BVmod1D,
>   parms = pars,
>   nspec = 2,
>   N = N,
>   dx = dx
> )
> ```
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Apr 14 20:19:25 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 14 Apr 2021 19:19:25 +0100
Subject: [R] Error loading "XLConnect" library
In-Reply-To: <635919934.197924.1618422135644@connect.xfinity.com>
References: <635919934.197924.1618422135644@connect.xfinity.com>
Message-ID: <661a752b-dd22-c362-54b6-4d549ae2e30b@sapo.pt>

Hello,

That is a unix/linux command and you are on Windows. The cat command and 
other unix/linux commands can be installed when you install Rtools [1].

It is not well seen to cross post [2].

[1] https://cran.r-project.org/bin/windows/Rtools/
[2] 
https://stackoverflow.com/questions/67087299/error-package-or-namespace-load-failed-for-xlconnect

Hope this helps,

Rui Barradas


?s 18:42 de 14/04/21, Bernard McGarvey escreveu:
> I installed the "XLConnect" package which appears to be successful and then tried to load the "XLConnect" library and got an error as shown below. Any ideas as to where to look for the source of the error? The word "release" in the error message makes me think it is some issue with the version of "XLConnect" but that is just a guess.
> 
> I am running the latest version of R available on CRAN on Windows 10.
> 
>> install.packages("XLConnect")
> Installing package into ?E:/Data/OneDrive/Documents/R/win-library/4.0?
> (as ?lib? is unspecified)
> trying URL 'https://cran.rstudio.com/bin/windows/contrib/4.0/XLConnect_1.0.3.zip'
> Content type 'application/zip' length 29498979 bytes (28.1 MB)
> downloaded 28.1 MB
> package ?XLConnect? successfully unpacked and MD5 sums checked
> The downloaded binary packages are in
> C:\Users\User\AppData\Local\Temp\RtmpARt8Er\downloaded_packages
> 
>> library(XLConnect)
> Error: package or namespace load failed for ?XLConnect?:
> .onLoad failed in loadNamespace() for 'XLConnect', details:
> call: system2("cat", c("/etc/*-release"), stdout = TRUE, stderr = TRUE)
> error: '"cat"' not found
> 
>> library("XLConnect")
> Error: package or namespace load failed for ?XLConnect?:
> .onLoad failed in loadNamespace() for 'XLConnect', details:
> call: system2("cat", c("/etc/*-release"), stdout = TRUE, stderr = TRUE)
> error: '"cat"' not found
> 
> 
> 
> Thanks
> 
> 
> 
> Bernard McGarvey
> 
> Director, Fort Myers Beach Lions Foundation, Inc.
> 
> Retired (Lilly Engineering Fellow).
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From m@rc_@chw@rtz @end|ng |rom me@com  Wed Apr 14 20:20:51 2021
From: m@rc_@chw@rtz @end|ng |rom me@com (Marc Schwartz)
Date: Wed, 14 Apr 2021 14:20:51 -0400
Subject: [R] Error loading "XLConnect" library
In-Reply-To: <635919934.197924.1618422135644@connect.xfinity.com>
References: <635919934.197924.1618422135644@connect.xfinity.com>
Message-ID: <d0ab8791-4633-7468-ca1e-dc1812abc7f7@me.com>

Hi,

When you experience errors with a third party package like that, one of 
the first steps to take is to review the results of CRAN testing on the 
package. That is available via the "CRAN checks:" link on the package page:

   https://cran.r-project.org/web/packages/XLConnect/index.html

That link takes you to:

   https://cran.r-project.org/web/checks/check_results_XLConnect.html

where you can see that there are NOTEs and ERRORs being reported across 
multiple platforms.

I would therefore contact the package maintainer and inquire as to the 
current status of the package, plans to resolve the outstanding issues, 
and a workaround in the mean time.

 From a review of the Issues page on the package's Github site, there 
appear to be a number of such reports already:

   https://github.com/miraisolutions/xlconnect/issues

So you may want to review those communications first.

Regards,

Marc Schwartz


Bernard McGarvey wrote on 4/14/21 1:42 PM:
> I installed the "XLConnect" package which appears to be successful and then tried to load the "XLConnect" library and got an error as shown below. Any ideas as to where to look for the source of the error? The word "release" in the error message makes me think it is some issue with the version of "XLConnect" but that is just a guess.
> 
> I am running the latest version of R available on CRAN on Windows 10.
> 
>> install.packages("XLConnect")
> Installing package into ?E:/Data/OneDrive/Documents/R/win-library/4.0?
> (as ?lib? is unspecified)
> trying URL 'https://cran.rstudio.com/bin/windows/contrib/4.0/XLConnect_1.0.3.zip'
> Content type 'application/zip' length 29498979 bytes (28.1 MB)
> downloaded 28.1 MB
> package ?XLConnect? successfully unpacked and MD5 sums checked
> The downloaded binary packages are in
> C:\Users\User\AppData\Local\Temp\RtmpARt8Er\downloaded_packages
> 
>> library(XLConnect)
> Error: package or namespace load failed for ?XLConnect?:
> .onLoad failed in loadNamespace() for 'XLConnect', details:
> call: system2("cat", c("/etc/*-release"), stdout = TRUE, stderr = TRUE)
> error: '"cat"' not found
> 
>> library("XLConnect")
> Error: package or namespace load failed for ?XLConnect?:
> .onLoad failed in loadNamespace() for 'XLConnect', details:
> call: system2("cat", c("/etc/*-release"), stdout = TRUE, stderr = TRUE)
> error: '"cat"' not found
> 
> 
> 
> Thanks
> 
> 
> 
> Bernard McGarvey
> 
> Director, Fort Myers Beach Lions Foundation, Inc.
> 
> Retired (Lilly Engineering Fellow).
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From mcg@rvey@bern@rd @end|ng |rom comc@@t@net  Wed Apr 14 20:36:58 2021
From: mcg@rvey@bern@rd @end|ng |rom comc@@t@net (Bernard Comcast)
Date: Wed, 14 Apr 2021 14:36:58 -0400
Subject: [R] Error loading "XLConnect" library
In-Reply-To: <d0ab8791-4633-7468-ca1e-dc1812abc7f7@me.com>
References: <d0ab8791-4633-7468-ca1e-dc1812abc7f7@me.com>
Message-ID: <E25A696F-A96F-43BC-8029-D187B5F97198@comcast.net>

Thanks Marc

Bernard
Sent from my iPhone so please excuse the spelling!"

> On Apr 14, 2021, at 2:20 PM, Marc Schwartz <marc_schwartz at me.com> wrote:
> 
> ?Hi,
> 
> When you experience errors with a third party package like that, one of the first steps to take is to review the results of CRAN testing on the package. That is available via the "CRAN checks:" link on the package page:
> 
>  https://cran.r-project.org/web/packages/XLConnect/index.html
> 
> That link takes you to:
> 
>  https://cran.r-project.org/web/checks/check_results_XLConnect.html
> 
> where you can see that there are NOTEs and ERRORs being reported across multiple platforms.
> 
> I would therefore contact the package maintainer and inquire as to the current status of the package, plans to resolve the outstanding issues, and a workaround in the mean time.
> 
> From a review of the Issues page on the package's Github site, there appear to be a number of such reports already:
> 
>  https://github.com/miraisolutions/xlconnect/issues
> 
> So you may want to review those communications first.
> 
> Regards,
> 
> Marc Schwartz
> 
> 
> Bernard McGarvey wrote on 4/14/21 1:42 PM:
>> I installed the "XLConnect" package which appears to be successful and then tried to load the "XLConnect" library and got an error as shown below. Any ideas as to where to look for the source of the error? The word "release" in the error message makes me think it is some issue with the version of "XLConnect" but that is just a guess.
>> I am running the latest version of R available on CRAN on Windows 10.
>>> install.packages("XLConnect")
>> Installing package into ?E:/Data/OneDrive/Documents/R/win-library/4.0?
>> (as ?lib? is unspecified)
>> trying URL 'https://cran.rstudio.com/bin/windows/contrib/4.0/XLConnect_1.0.3.zip'
>> Content type 'application/zip' length 29498979 bytes (28.1 MB)
>> downloaded 28.1 MB
>> package ?XLConnect? successfully unpacked and MD5 sums checked
>> The downloaded binary packages are in
>> C:\Users\User\AppData\Local\Temp\RtmpARt8Er\downloaded_packages
>>> library(XLConnect)
>> Error: package or namespace load failed for ?XLConnect?:
>> .onLoad failed in loadNamespace() for 'XLConnect', details:
>> call: system2("cat", c("/etc/*-release"), stdout = TRUE, stderr = TRUE)
>> error: '"cat"' not found
>>> library("XLConnect")
>> Error: package or namespace load failed for ?XLConnect?:
>> .onLoad failed in loadNamespace() for 'XLConnect', details:
>> call: system2("cat", c("/etc/*-release"), stdout = TRUE, stderr = TRUE)
>> error: '"cat"' not found
>> Thanks
>> Bernard McGarvey
>> Director, Fort Myers Beach Lions Foundation, Inc.
>> Retired (Lilly Engineering Fellow).
>>    [[alternative HTML version deleted]]
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From bertc@rne|| @end|ng |rom gm@||@com  Wed Apr 14 23:34:11 2021
From: bertc@rne|| @end|ng |rom gm@||@com (Rob C)
Date: Wed, 14 Apr 2021 17:34:11 -0400
Subject: [R] LHS random number generator
Message-ID: <CAPtunJYnzUbPkStd_ZvdVeV-t_Zk+UO9XwUadS8suf_88WxWNQ@mail.gmail.com>

Shah,

I am the maintainer of the lhs package.  Please feel free to contact
package maintainers directly for help specific to their package.

If I understood your request, this is how I would construct the lhs...

prior_lhs <- data.frame(
  name = c("r_mu", "r_sd", "lmp", "gr_mu", "gr_sd", "alpha1",
"alpha2", "alpha3", "beta"),
  lower = c(0.00299, 0.001, 0.40, 0.14, 0.01, 0.0001, 0.0017, 0.005, 0.69),
  upper = c(0.00320, 0.002, 0.43, 0.16, 0.20, 0.0018, 0.0028, 0.009, 0.75),
  place = c(100000, 1000, 100, 100, 100, 10000, 10000, 1000, 100)
)
require(lhs)
nb_simul <- 10000
nparam <- nrow(prior_lhs)
random_tab <- randomLHS(nb_simul, nparam)
X <- random_tab
for (i in 1:nparam)
{
  X[,i] <- floor(qunif(random_tab[,i],
  prior_lhs$lower[i]*prior_lhs$place[i],
  prior_lhs$upper[i]*prior_lhs$place[i] + 1)) / prior_lhs$place[i]
}
apply(X, 2, range)


> On Apr 12, 2021, at 08:21, Shah Alam <dr.alamsolangi at gmail.com> wrote:
>
> Hello everyone,
>
> I am using the LHS package to generate a combination of a
> set of parameter values. However, I am not sure how to fix some parameter
> values to 2 decimal points.
> For example:
>
> I want to make combinations in such a way that values for parameter
> c("lmp", 0.40, 0.43) are taken as 0.40, 0.41, 0.42,0.43.
>
> My codes are:
>
> prior_lhs <- list(c("r_mu", 0.00299, 0.0032),
>                  c("r_sd", 0.001, 0.002),
>                  c("lmp", 0.40, 0.43),
>                  c("gr_mu", 0.14, 0.16),
>                  c("gr_sd", 0.01, 0.020),
>                  c("alpha1", 0.0001, 0.0018),
>                  c("alpha2", 0.0017, 0.0028),
>                  c("alpha3", 0.005, 0.009),
>                  c("beta", 0.69, 0.75)
> )
>
>
> ### Simulation with priors from LHS ####
> nb_simul <- 10000
> nparam <- length(prior_lhs)
> random_tab = randomLHS(nb_simul, nparam)
> lhs_index = 1
> param <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
>
> for (i in 1:nb_simul) {
>  temp_par <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
>  for (j in 1:nparam) {
>    temp_par[j] = as.numeric(prior_lhs[[j]][2]) +
>      (as.numeric(prior_lhs[[j]][3]) - as.numeric(prior_lhs[[j]][2])) *
> random_tab[lhs_index, j]
>  }
>  param <- rbind(param, temp_par)
>  lhs_index <- lhs_index+1
> }
> param <- param[-1,]
>
> Best regards,
> Shah
>
>       [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ddey1 @end|ng |rom jhu@edu  Wed Apr 14 21:35:30 2021
From: ddey1 @end|ng |rom jhu@edu (Debangan Dey)
Date: Wed, 14 Apr 2021 19:35:30 +0000
Subject: [R] NLSR package newDeriv function
Message-ID: <BL0PR01MB49623F85F6B7A637A0404AC3FA4E9@BL0PR01MB4962.prod.exchangelabs.com>

Hi,

I am trying to solve a non-linear least square which has a function from R^3 -> R. Is it possible to define gradient using newDeriv for a 3-variate scalar function?

I am trying to use the genD function in numDeriv package to define numerical gradient and treat them as a function. So far, I have failed to do it for simple function as follows ?

f <- function(x,y){x+y}
grad.f <- function(x,y){z <- c(x,y)
  f2 <- function(z){f(z[1],z[2])}
  gd <- genD(f2,z)$D[,1:length(z)]
  return(gd)
}
newDeriv(f(x,y), grad.f(x,y))

This derivative definition is not working as the following error pops up ?

fd <- fnDeriv(~ f(x,y), c("x",?y?))
fd(c(1,2))
Error in .grad[, "x"] <- grad.f(x) :
  number of items to replace is not a multiple of replacement length


I know the above example would work if I just give expressions instead of using grad function in numDeriv but I am trying to use numDeriv::grad here to see if my toy example can be translated to the bigger function I would later use it on.

Thanks,
Debanga

--
Debangan Dey,
PhD Student in Biostatistics,
Johns Hopkins Bloomberg School of Public Health,
Baltimore, MD

	[[alternative HTML version deleted]]


From JH@rm@e @end|ng |rom roku@com  Wed Apr 14 23:36:58 2021
From: JH@rm@e @end|ng |rom roku@com (Jorgen Harmse)
Date: Wed, 14 Apr 2021 21:36:58 +0000
Subject: [R] Documentation of Trigonometric Functions.
Message-ID: <E0E46FFA-81F9-4C40-BAF1-4E138F186E01@roku.com>

Is correct but incomplete documentation considered a bug? The documentation of trigonometric functions goes into detail about branch cuts for asin etc., but does not discuss the discontinuities of atan2. (It also fails to explain the difference between asin(2) (NaN) and asin(2+0i) (pi/2-acosh(2)i).) Since atan2 accepts complex arguments, the discontinuities are not just on the half-axis with x<=0 and y=0.

I also think that documentation of trigonometric functions should link to hyperbolic functions and that documentation of hyperbolic functions should link to the exponential function.

Jorgen Harmse.




From mjherrer|@@t @end|ng |rom gm@||@com  Wed Apr 14 23:57:59 2021
From: mjherrer|@@t @end|ng |rom gm@||@com (maria jesus herrerias)
Date: Wed, 14 Apr 2021 23:57:59 +0200
Subject: [R] different dimensions in W and my data in moran and spatial model
Message-ID: <CAPvcma1VvHMvi49KROakn6GGaweE40AMD0EZsCkQxFTAhdJXBA@mail.gmail.com>

Hello everyone,

    I am writing my code in R to run the spatial models. I am learning this
at the moment.
    I have my data for 116 countries over the period 1990-2014,
    and I got the shapefile from the website below.
    The objective is to get the matrix to run the spatial models.
    In the code below, I can get the matrix for the world and also for the
subsample.
    But when I try to run the moran test or sar model I get an error.
    The error is related to the dimension of W (listw) and my dataset. So
any help,
    I would be grateful.

    Below my code just in case someone can help  here.

    # Load the required Packages.

    `library(spdep)          # Spatial Dependence: Weighting Schemes,
Statistics
    `library(rgdal)          # to read shapefiles

    #shapefiles (world map from diva-gis)

       # Read the panel data from stata format for the regression analysis
below.

    `library(foreign)

    `mydata <- read.dta("C:/Users/Usuario/Desktop/instituciones/revision
energy economics/
     spatial  panel in stata/countries_shp/neworiginal.dta")

    `fix(mydata)
    `attach(mydata)

    my data contains 116 countries from 1990 to 2014 in panel.

    # Prepare the dataset for panel data analysis in R.

    `library(plm)

    `mydata <- pdata.frame(mydata, index = c("id", "year"))


    # Read the shapefile and set up the working directory.

    `setwd("C:/Users/Usuario/Desktop/instituciones/revision energy
economics/spatial panel in stata/countries_shp")

    `worlddata <- readOGR("countries.shp")
    `names(worlddata)
    `summary(worlddata)

    # Get the centroids

    `coords <-coordinates(worlddata)

    A. Contiguity based relations

     1. First Order Queen Contiguity

    `queen.nb = poly2nb(worlddata, queen=TRUE)
    `summary(queen.nb)
    `plot(queen.nb,coords)


    # the numbers of neighbours of regions in the neighbours list.

    `cards <- card(queen.nb)

    # convert into a listw type based on contiguity row normalized

    `queen.listw <- nb2listw(queen.nb,style="W", zero.policy = TRUE)
    `summary(queen.listw,zero.policy=TRUE)

    #marginal effects
    `impacts(reg2, listw = listw1,zero.policy=TRUE)

    #marginal effects with p-values
    `summary(impacts(reg2, listw = listw1), R= 500, zstats =
TRUE,zero.policy=TRUE)

    `attributes(queen.listw)

     #Selection of a subset of countries to fit with mydataset (116
countries, the previous ones I did for all countries in the shapefile)


    `setwd("C:/Users/Usuario/Desktop/instituciones/revision energy
economics/spatial panel in stata/countries_shp")

    `worlddata <- readOGR("countries.shp")

    `queen.nb = poly2nb(worlddata, queen=TRUE)

    `coords <-coordinates(worlddata)

    `plot(queen.nb, coords)


    Following Roger Bivand example:

    `to.be.dropped <- c(1, 2, 5, 6, 8, 9, 10, 13, 14, 18, 20, 21, 23, 26,
28, 29, 31, 34, 36, 37, 39, 40, 41, 45, 46, 47, 48, 51, 52, 53, 55, 56, 58,
59, 62, 63, 64, 66, 68, 69, 74, 75, 77, 78, 79, 80, 81, 82, 85, 86, 87, 89,
90, 94, 95, 97, 98, 99, 100, 102, 103, 104, 105, 107, 109, 110, 118, 123,
124, 125, 127, 130, 131, 133, 134, 137, 138, 139, 140, 143, 145, 146, 148,
149, 151, 152, 153, 155, 157, 159, 161, 162, 166, 167, 170, 173, 175, 176,
177, 178, 181, 182, 183, 184, 186, 190, 193, 194, 195, 198, 199, 200, 201,
202, 203, 204, 205, 206, 207, 208, 211, 212, 213, 215, 216, 218, 219, 221,
222, 224, 226, 227, 228, 229, 232, 233, 237, 239, 240, 242, 246, 247, 248,
255, 258, 259, 260, 261, 265)
    sub.queen.nb <- subset(queen.nb,
      !(1:length(queen.nb) %in% to.be.dropped))
    which(!(attr(queen.nb, "region.id") %in%
      attr(sub.queen.nb, "region.id")))

    `sub.queen.listw <- nb2listw(sub.queen.nb,style="W", zero.policy = TRUE)

    so now, I have my 116 countries in the queen matrix.

    # My data and variables
    `y <- cbind(lei)
    `x <- cbind(lgdppcnew, lgdppcnew2, industryg, importsg, fdig)
    `xy <- cbind(mydata$x, mydata$y)
    `listw1 <- sub.queen.listw
    `coords <- coords

    #Define formula

    `reg.ols <- y ~ x


    # Autocorrelation test
    `lm.morantest(ols.eq1,listw1,zero.policy=TRUE)
    `plot.moran(ols.eq1,listw1)

    (here I get the error where it is said the objects have different
dimensions)

    `reg2 <- lagsarlm(ols.eq1, data = mydata, listw1, zero.policy=TRUE)
    `summary(reg2,correlation=TRUE, Nagelkerke=TRUE, Hausman=TRUE,
zero.policy=TRUE)

    (here I get the error where it is said the objects have different
dimensions)

     #marginal effects

    `impacts(reg2, listw = listw1,zero.policy=TRUE)

     #marginal effects with p-values

     `summary(impacts(reg2, listw = listw1), R= 500, zstats =
TRUE,zero.policy=TRUE)

     I don't know if it is for my panel data, the missing values or
something else.
     I tried also in Stata having similar issues.

     thanks in advance and my apologies if it is very naive question, but I
am stuck.

all the best
Maria Jesus

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Thu Apr 15 00:42:02 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 14 Apr 2021 15:42:02 -0700
Subject: [R] different dimensions in W and my data in moran and spatial
 model
In-Reply-To: <CAPvcma1VvHMvi49KROakn6GGaweE40AMD0EZsCkQxFTAhdJXBA@mail.gmail.com>
References: <CAPvcma1VvHMvi49KROakn6GGaweE40AMD0EZsCkQxFTAhdJXBA@mail.gmail.com>
Message-ID: <CAGxFJbSeBAXbqVvFviBW=NuGpppGm3r2uum8nH-mvYFgDbp8SQ@mail.gmail.com>

Almost certainly better posted on R-Sig-geo, not here.
See here for more info on R mailing lists:
https://www.r-project.org/mail.html

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Wed, Apr 14, 2021 at 3:32 PM maria jesus herrerias <
mjherreriast at gmail.com> wrote:

> Hello everyone,
>
>     I am writing my code in R to run the spatial models. I am learning this
> at the moment.
>     I have my data for 116 countries over the period 1990-2014,
>     and I got the shapefile from the website below.
>     The objective is to get the matrix to run the spatial models.
>     In the code below, I can get the matrix for the world and also for the
> subsample.
>     But when I try to run the moran test or sar model I get an error.
>     The error is related to the dimension of W (listw) and my dataset. So
> any help,
>     I would be grateful.
>
>     Below my code just in case someone can help  here.
>
>     # Load the required Packages.
>
>     `library(spdep)          # Spatial Dependence: Weighting Schemes,
> Statistics
>     `library(rgdal)          # to read shapefiles
>
>     #shapefiles (world map from diva-gis)
>
>        # Read the panel data from stata format for the regression analysis
> below.
>
>     `library(foreign)
>
>     `mydata <- read.dta("C:/Users/Usuario/Desktop/instituciones/revision
> energy economics/
>      spatial  panel in stata/countries_shp/neworiginal.dta")
>
>     `fix(mydata)
>     `attach(mydata)
>
>     my data contains 116 countries from 1990 to 2014 in panel.
>
>     # Prepare the dataset for panel data analysis in R.
>
>     `library(plm)
>
>     `mydata <- pdata.frame(mydata, index = c("id", "year"))
>
>
>     # Read the shapefile and set up the working directory.
>
>     `setwd("C:/Users/Usuario/Desktop/instituciones/revision energy
> economics/spatial panel in stata/countries_shp")
>
>     `worlddata <- readOGR("countries.shp")
>     `names(worlddata)
>     `summary(worlddata)
>
>     # Get the centroids
>
>     `coords <-coordinates(worlddata)
>
>     A. Contiguity based relations
>
>      1. First Order Queen Contiguity
>
>     `queen.nb = poly2nb(worlddata, queen=TRUE)
>     `summary(queen.nb)
>     `plot(queen.nb,coords)
>
>
>     # the numbers of neighbours of regions in the neighbours list.
>
>     `cards <- card(queen.nb)
>
>     # convert into a listw type based on contiguity row normalized
>
>     `queen.listw <- nb2listw(queen.nb,style="W", zero.policy = TRUE)
>     `summary(queen.listw,zero.policy=TRUE)
>
>     #marginal effects
>     `impacts(reg2, listw = listw1,zero.policy=TRUE)
>
>     #marginal effects with p-values
>     `summary(impacts(reg2, listw = listw1), R= 500, zstats =
> TRUE,zero.policy=TRUE)
>
>     `attributes(queen.listw)
>
>      #Selection of a subset of countries to fit with mydataset (116
> countries, the previous ones I did for all countries in the shapefile)
>
>
>     `setwd("C:/Users/Usuario/Desktop/instituciones/revision energy
> economics/spatial panel in stata/countries_shp")
>
>     `worlddata <- readOGR("countries.shp")
>
>     `queen.nb = poly2nb(worlddata, queen=TRUE)
>
>     `coords <-coordinates(worlddata)
>
>     `plot(queen.nb, coords)
>
>
>     Following Roger Bivand example:
>
>     `to.be.dropped <- c(1, 2, 5, 6, 8, 9, 10, 13, 14, 18, 20, 21, 23, 26,
> 28, 29, 31, 34, 36, 37, 39, 40, 41, 45, 46, 47, 48, 51, 52, 53, 55, 56, 58,
> 59, 62, 63, 64, 66, 68, 69, 74, 75, 77, 78, 79, 80, 81, 82, 85, 86, 87, 89,
> 90, 94, 95, 97, 98, 99, 100, 102, 103, 104, 105, 107, 109, 110, 118, 123,
> 124, 125, 127, 130, 131, 133, 134, 137, 138, 139, 140, 143, 145, 146, 148,
> 149, 151, 152, 153, 155, 157, 159, 161, 162, 166, 167, 170, 173, 175, 176,
> 177, 178, 181, 182, 183, 184, 186, 190, 193, 194, 195, 198, 199, 200, 201,
> 202, 203, 204, 205, 206, 207, 208, 211, 212, 213, 215, 216, 218, 219, 221,
> 222, 224, 226, 227, 228, 229, 232, 233, 237, 239, 240, 242, 246, 247, 248,
> 255, 258, 259, 260, 261, 265)
>     sub.queen.nb <- subset(queen.nb,
>       !(1:length(queen.nb) %in% to.be.dropped))
>     which(!(attr(queen.nb, "region.id") %in%
>       attr(sub.queen.nb, "region.id")))
>
>     `sub.queen.listw <- nb2listw(sub.queen.nb,style="W", zero.policy =
> TRUE)
>
>     so now, I have my 116 countries in the queen matrix.
>
>     # My data and variables
>     `y <- cbind(lei)
>     `x <- cbind(lgdppcnew, lgdppcnew2, industryg, importsg, fdig)
>     `xy <- cbind(mydata$x, mydata$y)
>     `listw1 <- sub.queen.listw
>     `coords <- coords
>
>     #Define formula
>
>     `reg.ols <- y ~ x
>
>
>     # Autocorrelation test
>     `lm.morantest(ols.eq1,listw1,zero.policy=TRUE)
>     `plot.moran(ols.eq1,listw1)
>
>     (here I get the error where it is said the objects have different
> dimensions)
>
>     `reg2 <- lagsarlm(ols.eq1, data = mydata, listw1, zero.policy=TRUE)
>     `summary(reg2,correlation=TRUE, Nagelkerke=TRUE, Hausman=TRUE,
> zero.policy=TRUE)
>
>     (here I get the error where it is said the objects have different
> dimensions)
>
>      #marginal effects
>
>     `impacts(reg2, listw = listw1,zero.policy=TRUE)
>
>      #marginal effects with p-values
>
>      `summary(impacts(reg2, listw = listw1), R= 500, zstats =
> TRUE,zero.policy=TRUE)
>
>      I don't know if it is for my panel data, the missing values or
> something else.
>      I tried also in Stata having similar issues.
>
>      thanks in advance and my apologies if it is very naive question, but I
> am stuck.
>
> all the best
> Maria Jesus
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @orenh @end|ng |rom m@th@@@u@dk  Thu Apr 15 00:55:38 2021
From: @orenh @end|ng |rom m@th@@@u@dk (=?utf-8?B?U8O4cmVuIEjDuGpzZ2FhcmQ=?=)
Date: Wed, 14 Apr 2021 22:55:38 +0000
Subject: [R] NLSR package newDeriv function
In-Reply-To: <BL0PR01MB49623F85F6B7A637A0404AC3FA4E9@BL0PR01MB4962.prod.exchangelabs.com>
References: <BL0PR01MB49623F85F6B7A637A0404AC3FA4E9@BL0PR01MB4962.prod.exchangelabs.com>
Message-ID: <ce6a84a00699ab30beeb58ec4db9dd791de2db91.camel@math.aau.dk>

One approach is to compute things exact using the caracas package; see
below.

Best regards
S?ren

----

> library(caracas)
> f <- function(x,y){x+y}
> def_sym(x,y,z)
> f <- x+y^2+y*z^2
> f
[caracas]:      2      2
           x + y  + y?z
> 
> d1  <- der(f, c(x,y,z))
> d2 <- der2(f, c(x,y,z))
> 
> d1
[caracas]: ?          2       ?
           ?1  2?y + z   2?y?z?
> d2
[caracas]: ?0   0    0 ?
           ?           ?
           ?0   2   2?z?
           ?           ?
           ?0  2?z  2?y?
> 
> tex(d1)
[1] "\\left[\\begin{matrix}1 & 2 y + z^{2} & 2 y
z\\end{matrix}\\right]"
> tex(d2)
[1] "\\left[\\begin{matrix}0 & 0 & 0\\\\0 & 2 & 2 z\\\\0 & 2 z & 2
y\\end{matrix}\\right]"
> 
> as_expr(d1)
expression(cbind(1,  2*y + z^2,  2*y*z))
> as_expr(d2)
expression(rbind(cbind(0, 0, 0), cbind(0, 2, 2*z), cbind(0, 2*z, 2*y)))
> 



On Wed, 2021-04-14 at 19:35 +0000, Debangan Dey wrote:
> Hi,
> 
> I am trying to solve a non-linear least square which has a function
> from R^3 -> R. Is it possible to define gradient using newDeriv for a
> 3-variate scalar function?
> 
> I am trying to use the genD function in numDeriv package to define
> numerical gradient and treat them as a function. So far, I have
> failed to do it for simple function as follows ?
> 
> f <- function(x,y){x+y}
> grad.f <- function(x,y){z <- c(x,y)
>   f2 <- function(z){f(z[1],z[2])}
>   gd <- genD(f2,z)$D[,1:length(z)]
>   return(gd)
> }
> newDeriv(f(x,y), grad.f(x,y))
> 
> This derivative definition is not working as the following error pops
> up ?
> 
> fd <- fnDeriv(~ f(x,y), c("x",?y?))
> fd(c(1,2))
> Error in .grad[, "x"] <- grad.f(x) :
>   number of items to replace is not a multiple of replacement length
> 
> 
> I know the above example would work if I just give expressions
> instead of using grad function in numDeriv but I am trying to use
> numDeriv::grad here to see if my toy example can be translated to the
> bigger function I would later use it on.
> 
> Thanks,
> Debanga
> 
> --
> Debangan Dey,
> PhD Student in Biostatistics,
> Johns Hopkins Bloomberg School of Public Health,
> Baltimore, MD
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

From ddey1 @end|ng |rom jhu@edu  Thu Apr 15 02:06:12 2021
From: ddey1 @end|ng |rom jhu@edu (Debangan Dey)
Date: Thu, 15 Apr 2021 00:06:12 +0000
Subject: [R] NLSR package newDeriv function
In-Reply-To: <ce6a84a00699ab30beeb58ec4db9dd791de2db91.camel@math.aau.dk>
References: <BL0PR01MB49623F85F6B7A637A0404AC3FA4E9@BL0PR01MB4962.prod.exchangelabs.com>,
 <ce6a84a00699ab30beeb58ec4db9dd791de2db91.camel@math.aau.dk>
Message-ID: <BL0PR01MB49626B6D6F1C660BE7887F52FA4D9@BL0PR01MB4962.prod.exchangelabs.com>

Hi Soren,

Thanks for the reply. The main reason I want to compute the derivative is to add it to the derivative table in R so that I can use it later in my optimization. And, my complicated function doesn?t have an analytical form of the derivative as it involves distribution function of a bivariate normal distribution.

Thanks,
Debangan

--
Debangan Dey,
PhD Student in Biostatistics,
Johns Hopkins Bloomberg School of Public Health,
Baltimore, MD

From: S?ren H?jsgaard <sorenh at math.aau.dk>
Date: Wednesday, April 14, 2021 at 6:56 PM
To: Debangan Dey <ddey1 at jhu.edu>, r-help at r-project.org <r-help at r-project.org>
Cc: Mikkel Meyer Andersen <mikl at math.aau.dk>
Subject: Re: [R] NLSR package newDeriv function

      External Email - Use Caution



One approach is to compute things exact using the caracas package; see
below.

Best regards
S?ren

----

> library(caracas)
> f <- function(x,y){x+y}
> def_sym(x,y,z)
> f <- x+y^2+y*z^2
> f
[caracas]:      2      2
           x + y  + y?z
>
> d1  <- der(f, c(x,y,z))
> d2 <- der2(f, c(x,y,z))
>
> d1
[caracas]: ?          2       ?
           ?1  2?y + z   2?y?z?
> d2
[caracas]: ?0   0    0 ?
           ?           ?
           ?0   2   2?z?
           ?           ?
           ?0  2?z  2?y?
>
> tex(d1)
[1] "\\left[\\begin{matrix}1 & 2 y + z^{2} & 2 y
z\\end{matrix}\\right]"
> tex(d2)
[1] "\\left[\\begin{matrix}0 & 0 & 0\\\\0 & 2 & 2 z\\\\0 & 2 z & 2
y\\end{matrix}\\right]"
>
> as_expr(d1)
expression(cbind(1,  2*y + z^2,  2*y*z))
> as_expr(d2)
expression(rbind(cbind(0, 0, 0), cbind(0, 2, 2*z), cbind(0, 2*z, 2*y)))
>



On Wed, 2021-04-14 at 19:35 +0000, Debangan Dey wrote:
> Hi,
>
> I am trying to solve a non-linear least square which has a function
> from R^3 -> R. Is it possible to define gradient using newDeriv for a
> 3-variate scalar function?
>
> I am trying to use the genD function in numDeriv package to define
> numerical gradient and treat them as a function. So far, I have
> failed to do it for simple function as follows ?
>
> f <- function(x,y){x+y}
> grad.f <- function(x,y){z <- c(x,y)
>   f2 <- function(z){f(z[1],z[2])}
>   gd <- genD(f2,z)$D[,1:length(z)]
>   return(gd)
> }
> newDeriv(f(x,y), grad.f(x,y))
>
> This derivative definition is not working as the following error pops
> up ?
>
> fd <- fnDeriv(~ f(x,y), c("x",?y?))
> fd(c(1,2))
> Error in .grad[, "x"] <- grad.f(x) :
>   number of items to replace is not a multiple of replacement length
>
>
> I know the above example would work if I just give expressions
> instead of using grad function in numDeriv but I am trying to use
> numDeriv::grad here to see if my toy example can be translated to the
> bigger function I would later use it on.
>
> Thanks,
> Debanga
>
> --
> Debangan Dey,
> PhD Student in Biostatistics,
> Johns Hopkins Bloomberg School of Public Health,
> Baltimore, MD
>
>       [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://nam02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7Cddey1%40jhu.edu%7C24130e75316f4a4d701308d8ff98701f%7C9fa4f438b1e6473b803f86f8aedf0dec%7C0%7C0%7C637540377919364158%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=Q26CwpHPCqViRwuZu4rCc7OyPlO0Kp4nr84JJ3Llcyk%3D&amp;reserved=0
> PLEASE do read the posting guide
> https://nam02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7Cddey1%40jhu.edu%7C24130e75316f4a4d701308d8ff98701f%7C9fa4f438b1e6473b803f86f8aedf0dec%7C0%7C0%7C637540377919364158%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=R6SR3Eap%2FqHHm0jn%2BibWmM9hlLqkSzehU74ZCZJo3ok%3D&amp;reserved=0
> and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From p@u| @end|ng |rom @t@t@@uck|@nd@@c@nz  Thu Apr 15 03:26:53 2021
From: p@u| @end|ng |rom @t@t@@uck|@nd@@c@nz (Paul Murrell)
Date: Thu, 15 Apr 2021 13:26:53 +1200
Subject: [R] 
 graphics useRaster check_irregular definition for date or posix
In-Reply-To: <3fb60cb3218a723211892f2b8d356bdc@posteo.de>
References: <c5279327071e612bd17d1d69b8f16496@posteo.de>
 <5d3a892b-06b3-71fc-46bf-f2c8b90899f7@stat.auckland.ac.nz>
 <3fb60cb3218a723211892f2b8d356bdc@posteo.de>
Message-ID: <9ae35f4b-817e-c263-bf45-d307088145d2@stat.auckland.ac.nz>

Hi

Feeding R-help back in, in case my suggestions might be of use to 
someone else ...

Thanks for the examples - so the main benefit you are looking for is the 
labelling on the axes (date labels) ?

If you are just trying to avoid the annoying white lines, it may just be 
your PNG/PDF viewer;  see ...

http://cran.stat.auckland.ac.nz/doc/FAQ/R-FAQ.html#Why-are-there-unwanted-borders

Even so, making this work for date values for x/y seems like a useful 
thing.  However, ...

Neither your "fix" nor my "fix" actually works for the example that you 
have provided.  It just reveals another problem within image.default(), 
which is the calculation of "midpoints" ...

     if (length(x) > 1 && length(x) == nrow(z)) { # midpoints
         dx <- 0.5*diff(x)
         x <- c(x[1L] - dx[1L], x[-length(x)] + dx,
                x[length(x)] + dx[length(x)-1])
     }

This calculation does NOT produce the desired result for "Date"s (the 
diff() of the resulting modified 'x' is no longer regular).

So this needs a bit more thought - let me know if you come up with a fix 
for that calculation before me :)

Paul

On 15/04/21 4:05 am, cdanek at posteo.de wrote:
> Hi Paul
> 
> Thanks for your answer. I just answer to you, I dont know if this is 
> correct (also the maillist?)
> 
> x <- y <- seq(as.Date("2020-1-1"), as.Date("2020-12-31"), l=12)
> 
> z <- array(rnorm(length(x)*length(y)), c(length(x), length(y)))
> image(x, y, z, useRaster=FALSE) # ok
> 
> image(x, y, z, useRaster=TRUE) # error: ?useRaster = TRUE? can only be used with a regular grid
> 
> x <- y <- seq_len(12)
> 
> image(x, y, z, useRaster=FALSE) # ok
> 
> image(x, y, z, useRaster=TRUE) # ok
> 
> The difference is the plot quality: useRaster = TRUE yields better quality as it omits strange white lines (in both png and pdf). I did not find a pattern when those white lines appear and when not. Hence, I cannot provide a reproducable example in which you can see the differences induced by the useRaster argument. In simple examples like the one above there is no difference between useRaster true and false plots.
> 
> Do you have a suggestion on how to continue?
> 
> Thanks a lot,
> Chris
> 
> Am 14.04.2021 04:37 schrieb Paul Murrell:
> 
>> Hi
>>
>> I doubt it is intended (to deliberately exclude "difftime" objects).
>>
>> Can you please supply a full image() example (with 'x' and/or 'y' as Dates and a 'z') ?  So that I can see what ...
>>
>> image(x, y, z, useRaster=FALSE)
>>
>> ... looks like, so I can see what you want ...
>>
>> image(x, y, z, useRaster=TRUE)
>>
>> ... to look like.
>>
>> I also wonder whether switching to ...
>>
>> dx[1][rep(1, length(dx))]
>>
>> ... might be better than switching to ...
>>
>> as.numeric(dx)
>>
>> It produces the same result for "difftime" objects, and may have a better chance of working better with other objects (although I confess that not having thought of using a "difftime" for 'x' I am also failing to think of further possibilities for 'x').
>>
>> Paul
>>
>> On 14/04/21 3:11 am,cdanek at posteo.de  <mailto:cdanek at posteo.de>  wrote:
>>> Hi The function `check_irregular()` defined within 
>>> `graphics::image.default()` checks if the `useRaster` argument for 
>>> `graphics::image()` can be true or must be false. According to this 
>>> function, the following example vector is irregular: ``` time <- 
>>> seq(as.Date("2020-1-1"), as.Date("2020-12-31"), l=12) 
>>> check_irregular(time, time) # TRUE ``` In my view, this is not 
>>> correct. In this case, the `all.equal`-call does not evaluate to true 
>>> due to the special class of `dx` (or `dy`). If I slightly rewrite the 
>>> function as ``` my_check_irregular <- function (x, y) { dx <- 
>>> as.numeric(diff(x)) dy <- as.numeric(diff(y)) (length(dx) && 
>>> !isTRUE(all.equal(dx, rep(dx[1], length(dx))))) || (length(dy) && 
>>> !isTRUE(all.equal(dy, rep(dy[1], length(dy))))) } ``` the correct 
>>> answer is obtained (i.e. that the input vector is not irregular based 
>>> on the rational behind `all.equal`): ``` my_check_irregular(time, 
>>> time) # FALSE ``` The same applies to POSIX* objects. I was wondering 
>>> if this is intended or not? Thanks a lot for any answer, Chris 
>>> [[alternative HTML version deleted]] 
>>> ______________________________________________ R-help at r-project.org 
>>> <mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and 
>>> more, see https://stat.ethz.ch/mailman/listinfo/r-help 
>>> <https://stat.ethz.ch/mailman/listinfo/r-help> 
>>> <https://stat.ethz.ch/mailman/listinfo/r-help 
>>> <https://stat.ethz.ch/mailman/listinfo/r-help>> 
>>> PLEASE do read the posting guide 
>>> http://www.R-project.org/posting-guide.html 
>>> <http://www.R-project.org/posting-guide.html> 
>>> <http://www.R-project.org/posting-guide.html 
>>> <http://www.R-project.org/posting-guide.html>> 
>>> and provide commented, minimal, self-contained, reproducible code.

-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul at stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/


From john@m@|ndon@|d @end|ng |rom @nu@edu@@u  Thu Apr 15 07:39:32 2021
From: john@m@|ndon@|d @end|ng |rom @nu@edu@@u (John Maindonald)
Date: Thu, 15 Apr 2021 05:39:32 +0000
Subject: [R] mgcv::gam() scale parameter estimates for quasibinomial error
 models
Message-ID: <7A006521-DD52-4D5D-BB12-7D93F19DF3B6@anu.edu.au>

For both glm() and mgcv::gam() quasibinomial error models, the summary
object has a dispersion value that has the same role as sigma^2 in the
summary object for lm() model fits.

Where some fitted probabilities are small, the `gam()` default scale parameter 
estimates, returned as `scale` (and `sig2`) in the gam object and as ?dispersion" 
in the summary object, can differ wildly from the Pearson values that `glm()`
works with, and that can be obtained by calling `gam()` with a suitable control
setting (see the code that now follows.)

The following demonstrates the issue:

  ## ?mgcv? version 1.8-34
  Cholera <- HistData:: Cholera
  library(mgcv)
  form <- cbind(cholera_deaths, popn-cholera_deaths) ~ 
     water + elevation + poor_rate
  default.gam <- gam(form, data=Cholera, family=quasibinomial)
  pearson.gam <- update(quasibin.gam, control=gam.control(scale.est=?pearson"))

  c(Pearson=pearson.gam$scale, Default=default.gam$scale)
  ##  Pearson     Default 
  ## 33.545829  2.919535 

My own calculation (from either fitted model), returns 30.07 for the
(Fletcher 2012) version of the dispersion that was, according to 
Wood?s ?Generalized Additive Models? (2nd edn, 2017, p.111),
returned as the GAM scale estimate at the time when the book was 
written. 

The default scale estimates returned by `gam()` vary wildly, relative 
to the relatively stable ?pearson" estimates, in data that are simulated
to have comparable dispersion estimates.

For the Cholera data, it would make good sense to fit a model
with quasipoisson errors to the death counts, using log(popn) as an
offset.  The GAM model then uses, with default setting for `scale.est`, 
a scale parameter that is close to that returned by "pearson.gam?. 
SEs (as well as coefficients) are similar to those returned by 
"pearson.gam?. 

The detailed calculations that are documented in the following 
documents may be of some general interest.
  https://www.dropbox.com/s/vl9usat07urbgel/quasibin-gam.pdf?dl=0
  or https://www.dropbox.com/s/s83mh1mut5xc3gk/quasibin-gam.html?dl=0

I am posting this here now before posting a bug report in case I have
missed something important.  It would be useful to be directed to the 
mgcv code used for calculation of what is returned as the Fletcher statistic.

  Rmd file: https://www.dropbox.com/s/ghmsdcvgxp068bs/quasibin-gam.Rmd?dl=0
  .bib file: https://www.dropbox.com/s/r1yjqx0sni2pzjy/quasi.bib?dl=0

John Maindonald             email: john.maindonald at anu.edu.au



From @|mon@wood @end|ng |rom b@th@edu  Thu Apr 15 10:56:31 2021
From: @|mon@wood @end|ng |rom b@th@edu (Simon Wood)
Date: Thu, 15 Apr 2021 09:56:31 +0100
Subject: [R] 
 mgcv::gam() scale parameter estimates for quasibinomial error models
In-Reply-To: <7A006521-DD52-4D5D-BB12-7D93F19DF3B6@anu.edu.au>
References: <7A006521-DD52-4D5D-BB12-7D93F19DF3B6@anu.edu.au>
Message-ID: <8b18f3ba-4b1a-704e-f4c8-f082cfae57b9@bath.edu>

Thanks John. It's a bug in weights handling. mgcv will give wrong scale 
parameter estimates for weighted models where the scale parameter is 
unknown, (except Gaussian, fortunately). quasibinomial with trials > 1 
is one such case, because the weights are used to store the number of 
trials. Otherwise the problem would only arise if weights were 
explicitly provided in a non-Gaussian model with unknown scale 
parameter. Fixed for 1. 8-35. best,

Simon

On 15/04/2021 06:39, John Maindonald wrote:
> For both glm() and mgcv::gam() quasibinomial error models, the summary
> object has a dispersion value that has the same role as sigma^2 in the
> summary object for lm() model fits.
>
> Where some fitted probabilities are small, the `gam()` default scale parameter
> estimates, returned as `scale` (and `sig2`) in the gam object and as ?dispersion"
> in the summary object, can differ wildly from the Pearson values that `glm()`
> works with, and that can be obtained by calling `gam()` with a suitable control
> setting (see the code that now follows.)
>
> The following demonstrates the issue:
>
>    ## ?mgcv? version 1.8-34
>    Cholera <- HistData:: Cholera
>    library(mgcv)
>    form <- cbind(cholera_deaths, popn-cholera_deaths) ~
>       water + elevation + poor_rate
>    default.gam <- gam(form, data=Cholera, family=quasibinomial)
>    pearson.gam <- update(quasibin.gam, control=gam.control(scale.est=?pearson"))
>
>    c(Pearson=pearson.gam$scale, Default=default.gam$scale)
>    ##  Pearson     Default
>    ## 33.545829  2.919535
>
> My own calculation (from either fitted model), returns 30.07 for the
> (Fletcher 2012) version of the dispersion that was, according to
> Wood?s ?Generalized Additive Models? (2nd edn, 2017, p.111),
> returned as the GAM scale estimate at the time when the book was
> written.
>
> The default scale estimates returned by `gam()` vary wildly, relative
> to the relatively stable ?pearson" estimates, in data that are simulated
> to have comparable dispersion estimates.
>
> For the Cholera data, it would make good sense to fit a model
> with quasipoisson errors to the death counts, using log(popn) as an
> offset.  The GAM model then uses, with default setting for `scale.est`,
> a scale parameter that is close to that returned by "pearson.gam?.
> SEs (as well as coefficients) are similar to those returned by
> "pearson.gam?.
>
> The detailed calculations that are documented in the following
> documents may be of some general interest.
>    https://www.dropbox.com/s/vl9usat07urbgel/quasibin-gam.pdf?dl=0
>    or https://www.dropbox.com/s/s83mh1mut5xc3gk/quasibin-gam.html?dl=0
>
> I am posting this here now before posting a bug report in case I have
> missed something important.  It would be useful to be directed to the
> mgcv code used for calculation of what is returned as the Fletcher statistic.
>
>    Rmd file: https://www.dropbox.com/s/ghmsdcvgxp068bs/quasibin-gam.Rmd?dl=0
>    .bib file: https://www.dropbox.com/s/r1yjqx0sni2pzjy/quasi.bib?dl=0
>
> John Maindonald             email: john.maindonald at anu.edu.au
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Simon Wood, School of Mathematics, University of Edinburgh,
https://www.maths.ed.ac.uk/~swood34/


From m@hmood@n@der@n @end|ng |rom ugent@be  Thu Apr 15 16:01:45 2021
From: m@hmood@n@der@n @end|ng |rom ugent@be (Mahmood Naderan-Tahan)
Date: Thu, 15 Apr 2021 14:01:45 +0000
Subject: [R] Weighted violin chart
In-Reply-To: <d4cb0b32817c43c699baed56f71bc2ad@ugent.be>
References: <d4cb0b32817c43c699baed56f71bc2ad@ugent.be>
Message-ID: <2a7361287d7e4fedb0e3ae101916e7a3@ugent.be>

Hi again,

As a follow up, does anybody know how to fix the following error?

It seems that I can use a "weight" parameter in geom_violin, but I am able to  figure out what is the problem with the following code.



> library(ggplot2)

> mydata <- read.csv('test.csv', header=T,row.names=1)
> mydata
     V1 V2 V3
P1 73.6 50  R
P2 75.2 20  R
P3  6.5  5  R
P4 41.4 10  C
P5  5.4 10  C
P6 18.8  5  C
> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE, weight=V2)
Error in layer(data = data, mapping = mapping, stat = stat, geom = GeomViolin,  :
  object 'V2' not found
>
>
> wg <- as.factor(mydata$V2)
> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE, weight=wg)
> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)
`stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.
Error: Aesthetics must be either length 1 or the same as the data (1024): weight
Run `rlang::last_error()` to see where the error occurred.





Regards,
Mahmood


________________________________
From: Mahmood Naderan-Tahan
Sent: Monday, April 12, 2021 10:01 PM
To: r-help at r-project.org
Subject: Weighted violin chart


Hi,

I would like to know if it is possible to plot a weighted violin chart with R. Currently, I have


> library(ggplot2)
> mydata <- read.csv('test.csv', header=T,row.names=1)
> mydata
     V1 V2 V3
P1 73.6 50  R
P2 75.2 20  R
P3  6.5  5  R
P4 41.4 10  C
P5  5.4 10  C
P6 18.8  5  C
> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE)
> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)

I would like to use V2 as the weight vector. Any idea about that?



Regards,
Mahmood

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Apr 15 16:13:10 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 15 Apr 2021 07:13:10 -0700
Subject: [R] Weighted violin chart
In-Reply-To: <2a7361287d7e4fedb0e3ae101916e7a3@ugent.be>
References: <d4cb0b32817c43c699baed56f71bc2ad@ugent.be>
 <2a7361287d7e4fedb0e3ae101916e7a3@ugent.be>
Message-ID: <B1311724-95D1-47E1-9A00-D90835317290@dcn.davis.ca.us>

Not strictly on topic on this list (ggplot2 is a contributed package) but...

ggplot(mydata, aes(x=V3, y=V1, weight=V2 )) + geom_violin(trim=FALSE)

If you want to refer to variables in the data, they have to be listed in the mapping.

On April 15, 2021 7:01:45 AM PDT, Mahmood Naderan-Tahan <mahmood.naderan at ugent.be> wrote:
>Hi again,
>
>As a follow up, does anybody know how to fix the following error?
>
>It seems that I can use a "weight" parameter in geom_violin, but I am
>able to  figure out what is the problem with the following code.
>
>
>
>> library(ggplot2)
>
>> mydata <- read.csv('test.csv', header=T,row.names=1)
>> mydata
>     V1 V2 V3
>P1 73.6 50  R
>P2 75.2 20  R
>P3  6.5  5  R
>P4 41.4 10  C
>P5  5.4 10  C
>P6 18.8  5  C
>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE,
>weight=V2)
>Error in layer(data = data, mapping = mapping, stat = stat, geom =
>GeomViolin,  :
>  object 'V2' not found
>>
>>
>> wg <- as.factor(mydata$V2)
>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE,
>weight=wg)
>> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)
>`stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.
>Error: Aesthetics must be either length 1 or the same as the data
>(1024): weight
>Run `rlang::last_error()` to see where the error occurred.
>
>
>
>
>
>Regards,
>Mahmood
>
>
>________________________________
>From: Mahmood Naderan-Tahan
>Sent: Monday, April 12, 2021 10:01 PM
>To: r-help at r-project.org
>Subject: Weighted violin chart
>
>
>Hi,
>
>I would like to know if it is possible to plot a weighted violin chart
>with R. Currently, I have
>
>
>> library(ggplot2)
>> mydata <- read.csv('test.csv', header=T,row.names=1)
>> mydata
>     V1 V2 V3
>P1 73.6 50  R
>P2 75.2 20  R
>P3  6.5  5  R
>P4 41.4 10  C
>P5  5.4 10  C
>P6 18.8  5  C
>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE)
>> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)
>
>I would like to use V2 as the weight vector. Any idea about that?
>
>
>
>Regards,
>Mahmood
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From grond @end|ng |rom number|@nd@de  Thu Apr 15 16:57:03 2021
From: grond @end|ng |rom number|@nd@de (Wolfgang Grond)
Date: Thu, 15 Apr 2021 16:57:03 +0200
Subject: [R] geom_node_point color in ggraph
Message-ID: <89e9e91c-6011-c74e-691c-8d9fd93b2d7b@numberland.de>

Dear all,

I'm joining differnts graphs to one with command graph_join from ggraph,

and try to color the nodes depending on the subgraph they come from.

To do that, I have these commands in my ggraph:

####################################################

...
geom_node_point(size = 8, aes(colour = project_all$Acronym)) +
 ??? scale_color_discrete(name="Project / Projekt") +
...

####################################################

All works well, but

how to define the colors to use for the nodes?

Is it possible to either

- define the colors explicitely, or

- define a color palette to use?

Please point me to where I should look how to do it.

Many thanks in advance

Wolfgang


	[[alternative HTML version deleted]]


From m@hmood@n@der@n @end|ng |rom ugent@be  Thu Apr 15 17:07:17 2021
From: m@hmood@n@der@n @end|ng |rom ugent@be (Mahmood Naderan-Tahan)
Date: Thu, 15 Apr 2021 15:07:17 +0000
Subject: [R] Weighted violin chart
In-Reply-To: <47ACA187-1477-40DF-87BE-AFA2568C6B5A@dcn.davis.ca.us>
References: <d4cb0b32817c43c699baed56f71bc2ad@ugent.be>
 <2a7361287d7e4fedb0e3ae101916e7a3@ugent.be>,
 <B1311724-95D1-47E1-9A00-D90835317290@dcn.davis.ca.us>
 <1b4aa7fca412488f905b988618abe898@ugent.be>,
 <E8203F71-11B8-4C7F-A03C-9307A1A80A68@dcn.davis.ca.us>
 <82462aaad852402e97cae2699a2890b1@ugent.be>,
 <47ACA187-1477-40DF-87BE-AFA2568C6B5A@dcn.davis.ca.us>
Message-ID: <ba528f68fc63419d9401fbf3c379d451@ugent.be>

It seems that using weight in ggplot has no effect. Also, using weight parameter in geom_violin results in an error.


> mydata
     V1 V2 V3
P1 73.6  5  R
P2 75.2  5  R
P3  6.5 60  R
P4 41.4 15  C
P5  5.4  5  C
P6 18.8 10  C
> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE)
> p
> p <- ggplot(mydata, aes(x=V3, y=V1), weight=V2) + geom_violin(trim=FALSE)
> p

In the code above, there is no difference between the two charts.
Also, the following code ends up in an error

> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE, weight=mydata$V2)
> p
Error: Aesthetics must be either length 1 or the same as the data (1024): weight
Run `rlang::last_error()` to see where the error occurred.
> mydata$V2
[1] 50 20  5 10 10  5


Any idea to fix that?


Regards,
Mahmood


________________________________

>>________________________________
>>From: Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
>>Sent: Thursday, April 15, 2021 4:13:10 PM
>>To: r-help at r-project.org; Mahmood Naderan-Tahan; r-help at r-project.org
>>Subject: Re: [R] Weighted violin chart
>>
>>Not strictly on topic on this list (ggplot2 is a contributed package)
>>but...
>>
>>ggplot(mydata, aes(x=V3, y=V1, weight=V2 )) + geom_violin(trim=FALSE)
>>
>>If you want to refer to variables in the data, they have to be listed
>>in the mapping.
>>
>>On April 15, 2021 7:01:45 AM PDT, Mahmood Naderan-Tahan
>><mahmood.naderan at ugent.be> wrote:
>>>Hi again,
>>>
>>>As a follow up, does anybody know how to fix the following error?
>>>
>>>It seems that I can use a "weight" parameter in geom_violin, but I am
>>>able to  figure out what is the problem with the following code.
>>>
>>>
>>>
>>>> library(ggplot2)
>>>
>>>> mydata <- read.csv('test.csv', header=T,row.names=1)
>>>> mydata
>>>     V1 V2 V3
>>>P1 73.6 50  R
>>>P2 75.2 20  R
>>>P3  6.5  5  R
>>>P4 41.4 10  C
>>>P5  5.4 10  C
>>>P6 18.8  5  C
>>>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE,
>>>weight=V2)
>>>Error in layer(data = data, mapping = mapping, stat = stat, geom =
>>>GeomViolin,  :
>>>  object 'V2' not found
>>>>
>>>>
>>>> wg <- as.factor(mydata$V2)
>>>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE,
>>>weight=wg)
>>>> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)
>>>`stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.
>>>Error: Aesthetics must be either length 1 or the same as the data
>>>(1024): weight
>>>Run `rlang::last_error()` to see where the error occurred.
>>>
>>>
>>>
>>>
>>>
>>>Regards,
>>>Mahmood
>>>
>>>
>>>________________________________
>>>From: Mahmood Naderan-Tahan
>>>Sent: Monday, April 12, 2021 10:01 PM
>>>To: r-help at r-project.org
>>>Subject: Weighted violin chart
>>>
>>>
>>>Hi,
>>>
>>>I would like to know if it is possible to plot a weighted violin
>chart
>>>with R. Currently, I have
>>>
>>>
>>>> library(ggplot2)
>>>> mydata <- read.csv('test.csv', header=T,row.names=1)
>>>> mydata
>>>     V1 V2 V3
>>>P1 73.6 50  R
>>>P2 75.2 20  R
>>>P3  6.5  5  R
>>>P4 41.4 10  C
>>>P5  5.4 10  C
>>>P6 18.8  5  C
>>>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE)
>>>> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)
>>>
>>>I would like to use V2 as the weight vector. Any idea about that?
>>>
>>>
>>>
>>>Regards,
>>>Mahmood
>>>
>>>       [[alternative HTML version deleted]]
>>>
>>>______________________________________________
>>>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>https://stat.ethz.ch/mailman/listinfo/r-help
>>>PLEASE do read the posting guide
>>>http://www.R-project.org/posting-guide.html
>>>and provide commented, minimal, self-contained, reproducible code.
>>
>>--
>>Sent from my phone. Please excuse my brevity.
>
>--
>Sent from my phone. Please excuse my brevity.

--
Sent from my phone. Please excuse my brevity.

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Apr 15 17:24:04 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 15 Apr 2021 11:24:04 -0400
Subject: [R] Weighted violin chart
In-Reply-To: <ba528f68fc63419d9401fbf3c379d451@ugent.be>
References: <d4cb0b32817c43c699baed56f71bc2ad@ugent.be>
 <2a7361287d7e4fedb0e3ae101916e7a3@ugent.be>
 <B1311724-95D1-47E1-9A00-D90835317290@dcn.davis.ca.us>
 <1b4aa7fca412488f905b988618abe898@ugent.be>
 <E8203F71-11B8-4C7F-A03C-9307A1A80A68@dcn.davis.ca.us>
 <82462aaad852402e97cae2699a2890b1@ugent.be>
 <47ACA187-1477-40DF-87BE-AFA2568C6B5A@dcn.davis.ca.us>
 <ba528f68fc63419d9401fbf3c379d451@ugent.be>
Message-ID: <ec02ebe6-fddb-9316-98b9-4c61412a2c3e@gmail.com>

On 15/04/2021 11:07 a.m., Mahmood Naderan-Tahan wrote:
> It seems that using weight in ggplot has no effect. Also, using weight parameter in geom_violin results in an error.
> 
> 
>> mydata
>       V1 V2 V3
> P1 73.6  5  R
> P2 75.2  5  R
> P3  6.5 60  R
> P4 41.4 15  C
> P5  5.4  5  C
> P6 18.8 10  C
>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE)
>> p
>> p <- ggplot(mydata, aes(x=V3, y=V1), weight=V2) + geom_violin(trim=FALSE)

That's not what Jeff suggested.  weight should be an argumnent to aes().

Duncan Murdoch

>> p
> 
> In the code above, there is no difference between the two charts.
> Also, the following code ends up in an error
> 
>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE, weight=mydata$V2)
>> p
> Error: Aesthetics must be either length 1 or the same as the data (1024): weight
> Run `rlang::last_error()` to see where the error occurred.
>> mydata$V2
> [1] 50 20  5 10 10  5
> 
> 
> Any idea to fix that?
> 
> 
> Regards,
> Mahmood
> 
> 
> ________________________________
> 
>>> ________________________________
>>> From: Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
>>> Sent: Thursday, April 15, 2021 4:13:10 PM
>>> To: r-help at r-project.org; Mahmood Naderan-Tahan; r-help at r-project.org
>>> Subject: Re: [R] Weighted violin chart
>>>
>>> Not strictly on topic on this list (ggplot2 is a contributed package)
>>> but...
>>>
>>> ggplot(mydata, aes(x=V3, y=V1, weight=V2 )) + geom_violin(trim=FALSE)
>>>
>>> If you want to refer to variables in the data, they have to be listed
>>> in the mapping.
>>>
>>> On April 15, 2021 7:01:45 AM PDT, Mahmood Naderan-Tahan
>>> <mahmood.naderan at ugent.be> wrote:
>>>> Hi again,
>>>>
>>>> As a follow up, does anybody know how to fix the following error?
>>>>
>>>> It seems that I can use a "weight" parameter in geom_violin, but I am
>>>> able to  figure out what is the problem with the following code.
>>>>
>>>>
>>>>
>>>>> library(ggplot2)
>>>>
>>>>> mydata <- read.csv('test.csv', header=T,row.names=1)
>>>>> mydata
>>>>      V1 V2 V3
>>>> P1 73.6 50  R
>>>> P2 75.2 20  R
>>>> P3  6.5  5  R
>>>> P4 41.4 10  C
>>>> P5  5.4 10  C
>>>> P6 18.8  5  C
>>>>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE,
>>>> weight=V2)
>>>> Error in layer(data = data, mapping = mapping, stat = stat, geom =
>>>> GeomViolin,  :
>>>>   object 'V2' not found
>>>>>
>>>>>
>>>>> wg <- as.factor(mydata$V2)
>>>>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE,
>>>> weight=wg)
>>>>> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)
>>>> `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.
>>>> Error: Aesthetics must be either length 1 or the same as the data
>>>> (1024): weight
>>>> Run `rlang::last_error()` to see where the error occurred.
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> Regards,
>>>> Mahmood
>>>>
>>>>
>>>> ________________________________
>>>> From: Mahmood Naderan-Tahan
>>>> Sent: Monday, April 12, 2021 10:01 PM
>>>> To: r-help at r-project.org
>>>> Subject: Weighted violin chart
>>>>
>>>>
>>>> Hi,
>>>>
>>>> I would like to know if it is possible to plot a weighted violin
>> chart
>>>> with R. Currently, I have
>>>>
>>>>
>>>>> library(ggplot2)
>>>>> mydata <- read.csv('test.csv', header=T,row.names=1)
>>>>> mydata
>>>>      V1 V2 V3
>>>> P1 73.6 50  R
>>>> P2 75.2 20  R
>>>> P3  6.5  5  R
>>>> P4 41.4 10  C
>>>> P5  5.4 10  C
>>>> P6 18.8  5  C
>>>>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE)
>>>>> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)
>>>>
>>>> I would like to use V2 as the weight vector. Any idea about that?
>>>>
>>>>
>>>>
>>>> Regards,
>>>> Mahmood
>>>>
>>>>        [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>> --
>>> Sent from my phone. Please excuse my brevity.
>>
>> --
>> Sent from my phone. Please excuse my brevity.
> 
> --
> Sent from my phone. Please excuse my brevity.
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From m@hmood@n@der@n @end|ng |rom ugent@be  Thu Apr 15 17:37:04 2021
From: m@hmood@n@der@n @end|ng |rom ugent@be (Mahmood Naderan-Tahan)
Date: Thu, 15 Apr 2021 15:37:04 +0000
Subject: [R] Weighted violin chart
In-Reply-To: <ec02ebe6-fddb-9316-98b9-4c61412a2c3e@gmail.com>
References: <d4cb0b32817c43c699baed56f71bc2ad@ugent.be>
 <2a7361287d7e4fedb0e3ae101916e7a3@ugent.be>
 <B1311724-95D1-47E1-9A00-D90835317290@dcn.davis.ca.us>
 <1b4aa7fca412488f905b988618abe898@ugent.be>
 <E8203F71-11B8-4C7F-A03C-9307A1A80A68@dcn.davis.ca.us>
 <82462aaad852402e97cae2699a2890b1@ugent.be>
 <47ACA187-1477-40DF-87BE-AFA2568C6B5A@dcn.davis.ca.us>
 <ba528f68fc63419d9401fbf3c379d451@ugent.be>,
 <ec02ebe6-fddb-9316-98b9-4c61412a2c3e@gmail.com>
Message-ID: <e1bc6700c6ab4f1f9843623aff208618@ugent.be>

Correct. This one


p <- ggplot(mydata, aes(x=V3, y=V1, weight=V2)) + geom_violin(trim=FALSE)


works fine. Thank you very much.

Regards,
Mahmood

________________________________
From: Duncan Murdoch <murdoch.duncan at gmail.com>
Sent: Thursday, April 15, 2021 5:24:04 PM
To: Mahmood Naderan-Tahan; r-help at r-project.org
Subject: Re: [R] Weighted violin chart

On 15/04/2021 11:07 a.m., Mahmood Naderan-Tahan wrote:
> It seems that using weight in ggplot has no effect. Also, using weight parameter in geom_violin results in an error.
>
>
>> mydata
>       V1 V2 V3
> P1 73.6  5  R
> P2 75.2  5  R
> P3  6.5 60  R
> P4 41.4 15  C
> P5  5.4  5  C
> P6 18.8 10  C
>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE)
>> p
>> p <- ggplot(mydata, aes(x=V3, y=V1), weight=V2) + geom_violin(trim=FALSE)

That's not what Jeff suggested.  weight should be an argumnent to aes().

Duncan Murdoch

>> p
>
> In the code above, there is no difference between the two charts.
> Also, the following code ends up in an error
>
>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE, weight=mydata$V2)
>> p
> Error: Aesthetics must be either length 1 or the same as the data (1024): weight
> Run `rlang::last_error()` to see where the error occurred.
>> mydata$V2
> [1] 50 20  5 10 10  5
>
>
> Any idea to fix that?
>
>
> Regards,
> Mahmood
>
>
> ________________________________
>
>>> ________________________________
>>> From: Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
>>> Sent: Thursday, April 15, 2021 4:13:10 PM
>>> To: r-help at r-project.org; Mahmood Naderan-Tahan; r-help at r-project.org
>>> Subject: Re: [R] Weighted violin chart
>>>
>>> Not strictly on topic on this list (ggplot2 is a contributed package)
>>> but...
>>>
>>> ggplot(mydata, aes(x=V3, y=V1, weight=V2 )) + geom_violin(trim=FALSE)
>>>
>>> If you want to refer to variables in the data, they have to be listed
>>> in the mapping.
>>>
>>> On April 15, 2021 7:01:45 AM PDT, Mahmood Naderan-Tahan
>>> <mahmood.naderan at ugent.be> wrote:
>>>> Hi again,
>>>>
>>>> As a follow up, does anybody know how to fix the following error?
>>>>
>>>> It seems that I can use a "weight" parameter in geom_violin, but I am
>>>> able to  figure out what is the problem with the following code.
>>>>
>>>>
>>>>
>>>>> library(ggplot2)
>>>>
>>>>> mydata <- read.csv('test.csv', header=T,row.names=1)
>>>>> mydata
>>>>      V1 V2 V3
>>>> P1 73.6 50  R
>>>> P2 75.2 20  R
>>>> P3  6.5  5  R
>>>> P4 41.4 10  C
>>>> P5  5.4 10  C
>>>> P6 18.8  5  C
>>>>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE,
>>>> weight=V2)
>>>> Error in layer(data = data, mapping = mapping, stat = stat, geom =
>>>> GeomViolin,  :
>>>>   object 'V2' not found
>>>>>
>>>>>
>>>>> wg <- as.factor(mydata$V2)
>>>>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE,
>>>> weight=wg)
>>>>> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)
>>>> `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.
>>>> Error: Aesthetics must be either length 1 or the same as the data
>>>> (1024): weight
>>>> Run `rlang::last_error()` to see where the error occurred.
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> Regards,
>>>> Mahmood
>>>>
>>>>
>>>> ________________________________
>>>> From: Mahmood Naderan-Tahan
>>>> Sent: Monday, April 12, 2021 10:01 PM
>>>> To: r-help at r-project.org
>>>> Subject: Weighted violin chart
>>>>
>>>>
>>>> Hi,
>>>>
>>>> I would like to know if it is possible to plot a weighted violin
>> chart
>>>> with R. Currently, I have
>>>>
>>>>
>>>>> library(ggplot2)
>>>>> mydata <- read.csv('test.csv', header=T,row.names=1)
>>>>> mydata
>>>>      V1 V2 V3
>>>> P1 73.6 50  R
>>>> P2 75.2 20  R
>>>> P3  6.5  5  R
>>>> P4 41.4 10  C
>>>> P5  5.4 10  C
>>>> P6 18.8  5  C
>>>>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE)
>>>>> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)
>>>>
>>>> I would like to use V2 as the weight vector. Any idea about that?
>>>>
>>>>
>>>>
>>>> Regards,
>>>> Mahmood
>>>>
>>>>        [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>> --
>>> Sent from my phone. Please excuse my brevity.
>>
>> --
>> Sent from my phone. Please excuse my brevity.
>
> --
> Sent from my phone. Please excuse my brevity.
>
>        [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Apr 15 21:19:27 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 15 Apr 2021 20:19:27 +0100
Subject: [R] geom_node_point color in ggraph
In-Reply-To: <89e9e91c-6011-c74e-691c-8d9fd93b2d7b@numberland.de>
References: <89e9e91c-6011-c74e-691c-8d9fd93b2d7b@numberland.de>
Message-ID: <1a542b06-d338-8c29-44fe-a40ed9fb1d29@sapo.pt>

Hello,

To define the colors, remove the data set name from the aesthetic.
This

aes(colour = project_all$Acronym)


should be this

aes(colour = Acronym)


Then choose the colours in the usual ggplot way. Here is a reproducible 
example.


library(igraph)
library(ggraph)

project_all <- make_graph("bull")
vertex_attr(project_all, "Acronym", index = V(project_all)) <- "red"
vertex_attr(project_all, "Acronym", index = V(project_all)[[3]]) <- "blue"

ggraph(project_all, layout = "igraph", algorithm = "kk") +
   geom_edge_link() +
   geom_node_point(aes(colour = Acronym), size = 8) +
   scale_color_manual(name = "Project / Projekt",
                      values = c("blue", "red"))


Hope this helps,

Rui Barradas


?s 15:57 de 15/04/21, Wolfgang Grond escreveu:
> Dear all,
> 
> I'm joining differnts graphs to one with command graph_join from ggraph,
> 
> and try to color the nodes depending on the subgraph they come from.
> 
> To do that, I have these commands in my ggraph:
> 
> ####################################################
> 
> ...
> geom_node_point(size = 8, aes(colour = project_all$Acronym)) +
>   ??? scale_color_discrete(name="Project / Projekt") +
> ...
> 
> ####################################################
> 
> All works well, but
> 
> how to define the colors to use for the nodes?
> 
> Is it possible to either
> 
> - define the colors explicitely, or
> 
> - define a color palette to use?
> 
> Please point me to where I should look how to do it.
> 
> Many thanks in advance
> 
> Wolfgang
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From |e|yn82 @end|ng |rom hotm@||@com  Thu Apr 15 04:04:42 2021
From: |e|yn82 @end|ng |rom hotm@||@com (Felyn Tay)
Date: Thu, 15 Apr 2021 02:04:42 +0000
Subject: [R] Is R supported on Virtual Infrastructure environment?
Message-ID: <CY4PR22MB00065A69AF6683BB710B79CFBD4D9@CY4PR22MB0006.namprd22.prod.outlook.com>

Good Morning!

I would like to find out whether there is any documentation or anyone has experience running R on Virtual Infrastructure Environment, particularly VMWare Horizon.

Thank you!

Felyn

	[[alternative HTML version deleted]]


From cd@@ek m@iii@g oii posteo@de  Thu Apr 15 09:27:19 2021
From: cd@@ek m@iii@g oii posteo@de (cd@@ek m@iii@g oii posteo@de)
Date: Thu, 15 Apr 2021 09:27:19 +0200
Subject: [R] 
 =?utf-8?q?graphics_useRaster_check=5Firregular_definition_fo?=
 =?utf-8?q?r_date_or_posix?=
In-Reply-To: <9ae35f4b-817e-c263-bf45-d307088145d2@stat.auckland.ac.nz>
References: <c5279327071e612bd17d1d69b8f16496@posteo.de>
 <5d3a892b-06b3-71fc-46bf-f2c8b90899f7@stat.auckland.ac.nz>
 <3fb60cb3218a723211892f2b8d356bdc@posteo.de>
 <9ae35f4b-817e-c263-bf45-d307088145d2@stat.auckland.ac.nz>
Message-ID: <8f07f756532eacf8bfe773b2b7077609@posteo.de>

 Hi Paul

Thanks for the FAQs related to the unwanted white lines. However, even
if it is just the png/pdf viewer that causes the white lines, I would
like to try to avoid them as much as possible, and setting useRaster to
true does that.

My wish would be that I can use a date or POSIX* vector as x and/or y
axis as it is without using some numerical values instead and then
always need to take special care for the corresponding labels.
Particularly for date/POSIX* objects this can be annoying. So the axes
or their labels are not my problem, I just need the useRaster true or
false decision to be consistent.

How do you deduce that the diff of the midpoints (i.e. the modifided x)
is not "regular"? This, again, will be decided later in image.default()
by check_irregular(), what brings us back to my initial post?

Cheers,
Chris

Am 15.04.2021 03:26 schrieb Paul Murrell: 

> Hi
> 
> Feeding R-help back in, in case my suggestions might be of use to someone else ...
> 
> Thanks for the examples - so the main benefit you are looking for is the labelling on the axes (date labels) ?
> 
> If you are just trying to avoid the annoying white lines, it may just be your PNG/PDF viewer; see ...
> 
> http://cran.stat.auckland.ac.nz/doc/FAQ/R-FAQ.html#Why-are-there-unwanted-borders [1]
> 
> Even so, making this work for date values for x/y seems like a useful thing. However, ...
> 
> Neither your "fix" nor my "fix" actually works for the example that you have provided. It just reveals another problem within image.default(), which is the calculation of "midpoints" ...
> 
> if (length(x) > 1 && length(x) == nrow(z)) { # midpoints
> dx <- 0.5*diff(x)
> x <- c(x[1L] - dx[1L], x[-length(x)] + dx,
> x[length(x)] + dx[length(x)-1])
> }
> 
> This calculation does NOT produce the desired result for "Date"s (the diff() of the resulting modified 'x' is no longer regular).
> 
> So this needs a bit more thought - let me know if you come up with a fix for that calculation before me :)
> 
> Paul
> 
> On 15/04/21 4:05 am, cdanek at posteo.de wrote:
> Hi Paul Thanks for your answer. I just answer to you, I dont know if this is correct (also the maillist?) x <- y <- seq(as.Date("2020-1-1"), as.Date("2020-12-31"), l=12) z <- array(rnorm(length(x)*length(y)), c(length(x), length(y))) image(x, y, z, useRaster=FALSE) # ok image(x, y, z, useRaster=TRUE) # error: 'useRaster = TRUE' can only be used with a regular grid x <- y <- seq_len(12) image(x, y, z, useRaster=FALSE) # ok image(x, y, z, useRaster=TRUE) # ok The difference is the plot quality: useRaster = TRUE yields better quality as it omits strange white lines (in both png and pdf). I did not find a pattern when those white lines appear and when not. Hence, I cannot provide a reproducable example in which you can see the differences induced by the useRaster argument. In simple examples like the one above there is no difference between useRaster true and false plots. Do you have a suggestion on how to continue? Thanks a lot, Chris Am 14.04.2021 04:37 schrieb Paul Murrell: Hi I
doubt it is intended (to deliberately exclude "difftime" objects). Can you please supply a full image() example (with 'x' and/or 'y' as Dates and a 'z') ? So that I can see what ... image(x, y, z, useRaster=FALSE) ... looks like, so I can see what you want ... image(x, y, z, useRaster=TRUE) ... to look like. I also wonder whether switching to ... dx[1][rep(1, length(dx))] ... might be better than switching to ... as.numeric(dx) It produces the same result for "difftime" objects, and may have a better chance of working better with other objects (although I confess that not having thought of using a "difftime" for 'x' I am also failing to think of further possibilities for 'x'). Paul On 14/04/21 3:11 am,cdanek at posteo.de <mailto:cdanek at posteo.de> wrote: Hi The function `check_irregular()` defined within `graphics::image.default()` checks if the `useRaster` argument for `graphics::image()` can be true or must be false. According to this function, the following example vector is
irregular: ``` time <- seq(as.Date("2020-1-1"), as.Date("2020-12-31"), l=12) check_irregular(time, time) # TRUE ``` In my view, this is not correct. In this case, the `all.equal`-call does not evaluate to true due to the special class of `dx` (or `dy`). If I slightly rewrite the function as ``` my_check_irregular <- function (x, y) { dx <- as.numeric(diff(x)) dy <- as.numeric(diff(y)) (length(dx) && !isTRUE(all.equal(dx, rep(dx[1], length(dx))))) || (length(dy) && !isTRUE(all.equal(dy, rep(dy[1], length(dy))))) } ``` the correct answer is obtained (i.e. that the input vector is not irregular based on the rational behind `all.equal`): ``` my_check_irregular(time, time) # FALSE ``` The same applies to POSIX* objects. I was wondering if this is intended or not? Thanks a lot for any answer, Chris [[alternative HTML version deleted]] ______________________________________________ R-help at r-project.org <mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help [2] <https://stat.ethz.ch/mailman/listinfo/r-help [2]> <https://stat.ethz.ch/mailman/listinfo/r-help [2] <https://stat.ethz.ch/mailman/listinfo/r-help [2]>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html [3] <http://www.R-project.org/posting-guide.html [3]> <http://www.R-project.org/posting-guide.html [3] <http://www.R-project.org/posting-guide.html [3]>> and provide commented, minimal, self-contained, reproducible code.
 

Links:
------
[1]
http://cran.stat.auckland.ac.nz/doc/FAQ/R-FAQ.html#Why-are-there-unwanted-borders
[2] https://stat.ethz.ch/mailman/listinfo/r-help
[3] http://www.R-project.org/posting-guide.html

	[[alternative HTML version deleted]]


From ee224 @end|ng |rom b@th@@c@uk  Thu Apr 15 14:33:24 2021
From: ee224 @end|ng |rom b@th@@c@uk (Evangelos Evangelou)
Date: Thu, 15 Apr 2021 12:33:24 +0000
Subject: [R] Bug? Index output of C functions R_qsort_I and R_qsort_int_I is
 not modified
Message-ID: <CWXP265MB2151D2ED2C174E7EF8CB48B0CD4D9@CWXP265MB2151.GBRP265.PROD.OUTLOOK.COM>

Hi all.

Reading the documentation of these two functions
https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Utility-functions
"The ..._I() versions also return the sort.index() vector in I."
I can't find anything in the documentation about sort.index(), but I'm guessing that I is the index that makes the input sorted, as in R's order(). However running the following code on
R version 4.0.5 (2021-03-31) Platform: x86_64-pc-linux-gnu (64-bit)
does not give me that. It just gives me the original input.

Rlib = file.path(Sys.getenv("R_HOME"), "lib", paste0("libR", .Platform$dynlib.ext))
dyn.load(Rlib)
n = 4L
ix = n:1
i = integer(n)
cc = .C("R_qsort_int_I", ix, i, 1L, n)
cc[[2]]

I expect 4 3 2 1, but I get 0 0 0 0. Is this a bug or have I misunderstood something?

Best,
Vangelis

	[[alternative HTML version deleted]]


From wgrond @end|ng |rom wgrond@de  Thu Apr 15 22:07:05 2021
From: wgrond @end|ng |rom wgrond@de (Wolfgang Grond)
Date: Thu, 15 Apr 2021 22:07:05 +0200
Subject: [R] geom_node_point color in ggraph
In-Reply-To: <1a542b06-d338-8c29-44fe-a40ed9fb1d29@sapo.pt>
References: <89e9e91c-6011-c74e-691c-8d9fd93b2d7b@numberland.de>
 <1a542b06-d338-8c29-44fe-a40ed9fb1d29@sapo.pt>
Message-ID: <1D04168E-CE24-4B5D-88F5-89C973E60AB7@wgrond.de>

Rui,

thanks a lot, I'll try it this way.

Best regards

Wolfgang

Am 15. April 2021 21:19:27 MESZ schrieb Rui Barradas <ruipbarradas at sapo.pt>:
>Hello,
>
>To define the colors, remove the data set name from the aesthetic.
>This
>
>aes(colour = project_all$Acronym)
>
>
>should be this
>
>aes(colour = Acronym)
>
>
>Then choose the colours in the usual ggplot way. Here is a reproducible
>
>example.
>
>
>library(igraph)
>library(ggraph)
>
>project_all <- make_graph("bull")
>vertex_attr(project_all, "Acronym", index = V(project_all)) <- "red"
>vertex_attr(project_all, "Acronym", index = V(project_all)[[3]]) <-
>"blue"
>
>ggraph(project_all, layout = "igraph", algorithm = "kk") +
>   geom_edge_link() +
>   geom_node_point(aes(colour = Acronym), size = 8) +
>   scale_color_manual(name = "Project / Projekt",
>                      values = c("blue", "red"))
>
>
>Hope this helps,
>
>Rui Barradas
>
>
>?s 15:57 de 15/04/21, Wolfgang Grond escreveu:
>> Dear all,
>> 
>> I'm joining differnts graphs to one with command graph_join from
>ggraph,
>> 
>> and try to color the nodes depending on the subgraph they come from.
>> 
>> To do that, I have these commands in my ggraph:
>> 
>> ####################################################
>> 
>> ...
>> geom_node_point(size = 8, aes(colour = project_all$Acronym)) +
>>   ??? scale_color_discrete(name="Project / Projekt") +
>> ...
>> 
>> ####################################################
>> 
>> All works well, but
>> 
>> how to define the colors to use for the nodes?
>> 
>> Is it possible to either
>> 
>> - define the colors explicitely, or
>> 
>> - define a color palette to use?
>> 
>> Please point me to where I should look how to do it.
>> 
>> Many thanks in advance
>> 
>> Wolfgang
>> 
>> 
>> 	[[alternative HTML version deleted]]
>> 
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From w||||@mwdun|@p @end|ng |rom gm@||@com  Fri Apr 16 05:50:40 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Thu, 15 Apr 2021 20:50:40 -0700
Subject: [R] 
 Bug? Index output of C functions R_qsort_I and R_qsort_int_I is
 not modified
In-Reply-To: <CWXP265MB2151D2ED2C174E7EF8CB48B0CD4D9@CWXP265MB2151.GBRP265.PROD.OUTLOOK.COM>
References: <CWXP265MB2151D2ED2C174E7EF8CB48B0CD4D9@CWXP265MB2151.GBRP265.PROD.OUTLOOK.COM>
Message-ID: <CAHqSRuT2nZrHZ_FXvXa4a4b9j6noHuP-6Ak28B6ACaui_Hesow@mail.gmail.com>

R_ext/Utils.h:void R_qsort_int_I(int *iv, int *II, int i, int j);

The last 2 arguments are int, not int*.  .C() passes pointers to vectors so
you cannot call this function directly from .C().

-Bill

On Thu, Apr 15, 2021 at 3:15 PM Evangelos Evangelou via R-help <
r-help at r-project.org> wrote:

> Hi all.
>
> Reading the documentation of these two functions
>
> https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Utility-functions
> "The ..._I() versions also return the sort.index() vector in I."
> I can't find anything in the documentation about sort.index(), but I'm
> guessing that I is the index that makes the input sorted, as in R's
> order(). However running the following code on
> R version 4.0.5 (2021-03-31) Platform: x86_64-pc-linux-gnu (64-bit)
> does not give me that. It just gives me the original input.
>
> Rlib = file.path(Sys.getenv("R_HOME"), "lib", paste0("libR",
> .Platform$dynlib.ext))
> dyn.load(Rlib)
> n = 4L
> ix = n:1
> i = integer(n)
> cc = .C("R_qsort_int_I", ix, i, 1L, n)
> cc[[2]]
>
> I expect 4 3 2 1, but I get 0 0 0 0. Is this a bug or have I misunderstood
> something?
>
> Best,
> Vangelis
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From p@u| @end|ng |rom @t@t@@uck|@nd@@c@nz  Fri Apr 16 05:54:34 2021
From: p@u| @end|ng |rom @t@t@@uck|@nd@@c@nz (Paul Murrell)
Date: Fri, 16 Apr 2021 15:54:34 +1200
Subject: [R] 
 graphics useRaster check_irregular definition for date or posix
In-Reply-To: <8f07f756532eacf8bfe773b2b7077609@posteo.de>
References: <c5279327071e612bd17d1d69b8f16496@posteo.de>
 <5d3a892b-06b3-71fc-46bf-f2c8b90899f7@stat.auckland.ac.nz>
 <3fb60cb3218a723211892f2b8d356bdc@posteo.de>
 <9ae35f4b-817e-c263-bf45-d307088145d2@stat.auckland.ac.nz>
 <8f07f756532eacf8bfe773b2b7077609@posteo.de>
Message-ID: <baec7926-66ed-25aa-769c-6dcbccad020a@stat.auckland.ac.nz>

Hi

On 15/04/21 7:27 pm, cdanek at posteo.de wrote:
> Hi Paul
> 
> Thanks for the FAQs related to the unwanted white lines. However, even 
> if it is just the png/pdf viewer that causes the white lines, I would 
> like to try to avoid them as much as possible, and setting useRaster to 
> true does that.

Sure.  Fair enough.

> My wish would be that I can use a date or POSIX* vector as x and/or y 
> axis as it is without using some numerical values instead and then 
> always need to take special care for the corresponding labels. 
> Particularly for date/POSIX* objects this can be annoying. So the axes 
> or their labels are not my problem, I just need the useRaster true or 
> false decision to be consistent.
> 
> How do you deduce that the diff of the midpoints (i.e. the modifided x) 
> is not "regular"? This, again, will be decided later in image.default() 
> by check_irregular(), what brings us back to my initial post?

The problem is that the modification of 'x' for midpoints makes the 'x' 
irregular even if 'x' starts off as regular (when 'x' is a Date).

Paul

> Cheers,
> Chris
> 
> Am 15.04.2021 03:26 schrieb Paul Murrell:
> 
>> Hi
>>
>> Feeding R-help back in, in case my suggestions might be of use to someone else ...
>>
>> Thanks for the examples - so the main benefit you are looking for is the labelling on the axes (date labels) ?
>>
>> If you are just trying to avoid the annoying white lines, it may just be your PNG/PDF viewer;  see ...
>>
>> http://cran.stat.auckland.ac.nz/doc/FAQ/R-FAQ.html#Why-are-there-unwanted-borders  <http://cran.stat.auckland.ac.nz/doc/FAQ/R-FAQ.html#Why-are-there-unwanted-borders>
>>
>> Even so, making this work for date values for x/y seems like a useful thing.  However, ...
>>
>> Neither your "fix" nor my "fix" actually works for the example that you have provided.  It just reveals another problem within image.default(), which is the calculation of "midpoints" ...
>>
>>      if (length(x) > 1 && length(x) == nrow(z)) { # midpoints
>>          dx <- 0.5*diff(x)
>>          x <- c(x[1L] - dx[1L], x[-length(x)] + dx,
>>                 x[length(x)] + dx[length(x)-1])
>>      }
>>
>> This calculation does NOT produce the desired result for "Date"s (the diff() of the resulting modified 'x' is no longer regular).
>>
>> So this needs a bit more thought - let me know if you come up with a fix for that calculation before me :)
>>
>> Paul
>>
>> On 15/04/21 4:05 am,cdanek at posteo.de  <mailto:cdanek at posteo.de>  wrote:
>>> Hi Paul Thanks for your answer. I just answer to you, I dont know if 
>>> this is correct (also the maillist?) x <- y <- 
>>> seq(as.Date("2020-1-1"), as.Date("2020-12-31"), l=12) z <- 
>>> array(rnorm(length(x)*length(y)), c(length(x), length(y))) image(x, 
>>> y, z, useRaster=FALSE) # ok image(x, y, z, useRaster=TRUE) # error: 
>>> 'useRaster = TRUE' can only be used with a regular grid x <- y <- 
>>> seq_len(12) image(x, y, z, useRaster=FALSE) # ok image(x, y, z, 
>>> useRaster=TRUE) # ok The difference is the plot quality: useRaster = 
>>> TRUE yields better quality as it omits strange white lines (in both 
>>> png and pdf). I did not find a pattern when those white lines appear 
>>> and when not. Hence, I cannot provide a reproducable example in which 
>>> you can see the differences induced by the useRaster argument. In 
>>> simple examples like the one above there is no difference between 
>>> useRaster true and false plots. Do you have a suggestion on how to 
>>> continue? Thanks a lot, Chris Am 14.04.2021 04:37 schrieb Paul Murrell:
>>>> Hi I doubt it is intended (to deliberately exclude "difftime" 
>>>> objects). Can you please supply a full image() example (with 'x' 
>>>> and/or 'y' as Dates and a 'z') ? So that I can see what ... image(x, 
>>>> y, z, useRaster=FALSE) ... looks like, so I can see what you want 
>>>> ... image(x, y, z, useRaster=TRUE) ... to look like. I also wonder 
>>>> whether switching to ... dx[1][rep(1, length(dx))] ... might be 
>>>> better than switching to ... as.numeric(dx) It produces the same 
>>>> result for "difftime" objects, and may have a better chance of 
>>>> working better with other objects (although I confess that not 
>>>> having thought of using a "difftime" for 'x' I am also failing to 
>>>> think of further possibilities for 'x'). Paul On 14/04/21 3:11 
>>>> am,cdanek at posteo.de <mailto:cdanek at posteo.de> 
>>>> <mailto:cdanek at posteo.de <mailto:cdanek at posteo.de>> wrote:
>>>>> Hi The function `check_irregular()` defined within 
>>>>> `graphics::image.default()` checks if the `useRaster` argument for 
>>>>> `graphics::image()` can be true or must be false. According to this 
>>>>> function, the following example vector is irregular: ``` time <- 
>>>>> seq(as.Date("2020-1-1"), as.Date("2020-12-31"), l=12) 
>>>>> check_irregular(time, time) # TRUE ``` In my view, this is not 
>>>>> correct. In this case, the `all.equal`-call does not evaluate to 
>>>>> true due to the special class of `dx` (or `dy`). If I slightly 
>>>>> rewrite the function as ``` my_check_irregular <- function (x, y) { 
>>>>> dx <- as.numeric(diff(x)) dy <- as.numeric(diff(y)) (length(dx) && 
>>>>> !isTRUE(all.equal(dx, rep(dx[1], length(dx))))) || (length(dy) && 
>>>>> !isTRUE(all.equal(dy, rep(dy[1], length(dy))))) } ``` the correct 
>>>>> answer is obtained (i.e. that the input vector is not irregular 
>>>>> based on the rational behind `all.equal`): ``` 
>>>>> my_check_irregular(time, time) # FALSE ``` The same applies to 
>>>>> POSIX* objects. I was wondering if this is intended or not? Thanks 
>>>>> a lot for any answer, Chris [[alternative HTML version deleted]] 
>>>>> ______________________________________________ R-help at r-project.org 
>>>>> <mailto:R-help at r-project.org> <mailto:R-help at r-project.org 
>>>>> <mailto:R-help at r-project.org>> mailing list -- To UNSUBSCRIBE and 
>>>>> more, see https://stat.ethz.ch/mailman/listinfo/r-help 
>>>>> <https://stat.ethz.ch/mailman/listinfo/r-help> 
>>>>> <https://stat.ethz.ch/mailman/listinfo/r-help 
>>>>> <https://stat.ethz.ch/mailman/listinfo/r-help>> 
>>>>> <https://stat.ethz.ch/mailman/listinfo/r-help 
>>>>> <https://stat.ethz.ch/mailman/listinfo/r-help> 
>>>>> <https://stat.ethz.ch/mailman/listinfo/r-help 
>>>>> <https://stat.ethz.ch/mailman/listinfo/r-help>>> 
>>>>> PLEASE do read the posting guide 
>>>>> http://www.R-project.org/posting-guide.html 
>>>>> <http://www.R-project.org/posting-guide.html> 
>>>>> <http://www.R-project.org/posting-guide.html 
>>>>> <http://www.R-project.org/posting-guide.html>> 
>>>>> <http://www.R-project.org/posting-guide.html 
>>>>> <http://www.R-project.org/posting-guide.html> 
>>>>> <http://www.R-project.org/posting-guide.html 
>>>>> <http://www.R-project.org/posting-guide.html>>> 
>>>>> and provide commented, minimal, self-contained, reproducible code.

-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul at stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/


From deep@y@n@@@rk@r @end|ng |rom gm@||@com  Fri Apr 16 08:04:20 2021
From: deep@y@n@@@rk@r @end|ng |rom gm@||@com (Deepayan Sarkar)
Date: Fri, 16 Apr 2021 11:34:20 +0530
Subject: [R] Matrix::solve() with 1-d arrays
Message-ID: <CADfFDC7mYee1R3giUZA38XzG73wrhzz0zD6M-3DGxEUpk-qimg@mail.gmail.com>

I get what I initially thought was unexpected behaviour from:

x <- tapply(runif(100), sample(5, 100, TRUE), mean)
solve(Diagonal(5), x)
# Error: not-yet-implemented method for solve(<ddiMatrix>, <array>).
#  ->>  Ask the package authors to implement the missing feature.

This is because x is a 1-D array, so the operation is not
well-defined. Would it make sense for Matrix to support this (treat
1-D arrays as column vectors, as it does for plain vectors)? Or should
I make my intent clear with

solve(Diagonal(5), as.vector(x))

?

-Deepayan


From phgro@je@n @end|ng |rom @c|v|ew@@org  Fri Apr 16 12:32:16 2021
From: phgro@je@n @end|ng |rom @c|v|ew@@org (SciViews)
Date: Fri, 16 Apr 2021 12:32:16 +0200
Subject: [R] New French translations fro foreign and nlme
Message-ID: <C2E49D87-C3DA-4B25-AD71-7FBF20790503@sciviews.org>

Dear packages maintainer,

Here are new and much improved French translation files for foreign and nlme recommended package.
Best,

Philippe Grosjean

..............................................<?}))><........
 ) ) ) ) )
( ( ( ( (    Prof. Philippe Grosjean
 ) ) ) ) )
( ( ( ( (    Numerical Ecology
 ) ) ) ) )   Mons University, Belgium
( ( ( ( (
..............................................................

From pd@me@ @end|ng |rom cb@@dk  Fri Apr 16 12:41:21 2021
From: pd@me@ @end|ng |rom cb@@dk (Peter Dalgaard)
Date: Fri, 16 Apr 2021 10:41:21 +0000
Subject: [R] [Rd] R 4.1.0 scheduled for May 18
Message-ID: <3AB91EC3-24D7-4BCE-9B65-C47FF351A22B@cbs.dk>

Full schedule is available on developer.r-project.org.

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel

_______________________________________________
R-announce at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-announce


From ee224 @end|ng |rom b@th@@c@uk  Fri Apr 16 10:35:04 2021
From: ee224 @end|ng |rom b@th@@c@uk (Evangelos Evangelou)
Date: Fri, 16 Apr 2021 08:35:04 +0000
Subject: [R] 
 Bug? Index output of C functions R_qsort_I and R_qsort_int_I is
 not modified
In-Reply-To: <CAHqSRuT2nZrHZ_FXvXa4a4b9j6noHuP-6Ak28B6ACaui_Hesow@mail.gmail.com>
References: <CWXP265MB2151D2ED2C174E7EF8CB48B0CD4D9@CWXP265MB2151.GBRP265.PROD.OUTLOOK.COM>,
 <CAHqSRuT2nZrHZ_FXvXa4a4b9j6noHuP-6Ak28B6ACaui_Hesow@mail.gmail.com>
Message-ID: <CWXP265MB215156CB19B868F2D7DC0E86CD4C9@CWXP265MB2151.GBRP265.PROD.OUTLOOK.COM>

Thanks for your input Bill.

I also realised that the second argument must be initialised to 1:n, which is not mentioned in the documentation. So, if I define
void mysort2i (int *x, int *i, int *n)
{
  R_qsort_int_I(x,i,1,*n);
}

Then

> .C("mysort2i",4:1,integer(4),4L)
[[1]]
[1] 1 2 3 4

[[2]]
[1] 0 0 0 0

[[3]]
[1] 4

but

> .C("mysort2i",4:1,1:4,4L)
[[1]]
[1] 1 2 3 4

[[2]]
[1] 4 3 2 1

[[3]]
[1] 4


________________________________
From: Bill Dunlap <williamwdunlap at gmail.com>
Sent: 16 April 2021 04:50
To: Evangelos Evangelou <ee224 at bath.ac.uk>
Cc: r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] Bug? Index output of C functions R_qsort_I and R_qsort_int_I is not modified




R_ext/Utils.h:void R_qsort_int_I(int *iv, int *II, int i, int j);

The last 2 arguments are int, not int*.  .C() passes pointers to vectors so you cannot call this function directly from .C().

-Bill

On Thu, Apr 15, 2021 at 3:15 PM Evangelos Evangelou via R-help <r-help at r-project.org<mailto:r-help at r-project.org>> wrote:
Hi all.

Reading the documentation of these two functions
https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Utility-functions<https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcran.r-project.org%2Fdoc%2Fmanuals%2Fr-release%2FR-exts.html%23Utility-functions&data=04%7C01%7Cee224%40bath.ac.uk%7C10bfc437aa4c4a1de23208d9008ad510%7C377e3d224ea1422db0ad8fcc89406b9e%7C0%7C0%7C637541418550685457%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&sdata=vIt2tF%2BtNP%2B8t%2FNmUtNsP0JGRoOyo30jy1hWD%2BQI2vk%3D&reserved=0>
"The ..._I() versions also return the sort.index() vector in I."
I can't find anything in the documentation about sort.index(), but I'm guessing that I is the index that makes the input sorted, as in R's order(). However running the following code on
R version 4.0.5 (2021-03-31) Platform: x86_64-pc-linux-gnu (64-bit)
does not give me that. It just gives me the original input.

Rlib = file.path(Sys.getenv("R_HOME"), "lib", paste0("libR", .Platform$dynlib.ext))
dyn.load(Rlib)
n = 4L
ix = n:1
i = integer(n)
cc = .C("R_qsort_int_I", ix, i, 1L, n)
cc[[2]]

I expect 4 3 2 1, but I get 0 0 0 0. Is this a bug or have I misunderstood something?

Best,
Vangelis

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help<https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&data=04%7C01%7Cee224%40bath.ac.uk%7C10bfc437aa4c4a1de23208d9008ad510%7C377e3d224ea1422db0ad8fcc89406b9e%7C0%7C0%7C637541418550685457%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&sdata=h1Rb1vobBq49NzofsNBgZfwSqa1ZSqVhQbZT%2BBpq2ac%3D&reserved=0>
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html<https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&data=04%7C01%7Cee224%40bath.ac.uk%7C10bfc437aa4c4a1de23208d9008ad510%7C377e3d224ea1422db0ad8fcc89406b9e%7C0%7C0%7C637541418550695414%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&sdata=yY8ALqCrEoBvQftAibVu7urh9%2FNHgmAGPgcauW%2Ff9Mo%3D&reserved=0>
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Sat Apr 17 17:38:30 2021
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Sat, 17 Apr 2021 17:38:30 +0200
Subject: [R] Matrix::solve() with 1-d arrays -- treating "array" as
 "numeric"?
In-Reply-To: <CADfFDC7mYee1R3giUZA38XzG73wrhzz0zD6M-3DGxEUpk-qimg@mail.gmail.com>
References: <CADfFDC7mYee1R3giUZA38XzG73wrhzz0zD6M-3DGxEUpk-qimg@mail.gmail.com>
Message-ID: <24699.246.141949.778635@stat.math.ethz.ch>

>>>>> Deepayan Sarkar 
>>>>>     on Fri, 16 Apr 2021 11:34:20 +0530 writes:

    > I get what I initially thought was unexpected behaviour from:

    > x <- tapply(runif(100), sample(5, 100, TRUE), mean)
    > solve(Diagonal(5), x)
    > # Error: not-yet-implemented method for solve(<ddiMatrix>, <array>).
    > #  ->>  Ask the package authors to implement the missing feature.

    ((why did you not ask the package authors ?? --- never mind))


    > This is because x is a 1-D array, so the operation is not
    > well-defined. Would it make sense for Matrix to support this (treat
    > 1-D arrays as column vectors, as it does for plain vectors)? Or should
    > I make my intent clear with

    > solve(Diagonal(5), as.vector(x))

well ...

The "fun" thing is that it actually works when Matrix methods
are not fully available, i.e., if you do *not* do
require(Matrix) or equivalent,
but rather only load the Matrix namespace via

  solve(Matrix::Diagonal(5), x)

actually currently works correctly by some "good coincidence"
(I have not yet tried to understand, as that's a bit painful:
 selectMethod("solve", c("ddiMatrix", "array"))  is "lying" here ! )
   
However this looks like a more general problem with S4 methods
-- and probably a good reason for asking on R-help --  namely,
the fact that d1-dimensional (numeric) arrays are not automatically treated as
(numeric) vectors i.e. class "numeric"  wrt S4 methods.

In the following case the  solve() - coincidence does not help, BTW.

     Diagonal(3) %*% array(1:3)

     ## Error in Diagonal(3) %*% array(1:3) : 
     ##   not-yet-implemented method for <ddiMatrix> %*% <array>


In principle, we should consider a way to tell that "array"
should be tried as "vector",

possibly via something like    setIs("array", "vector")  or
rather  setIs("array", "numeric")  because in the Matrix package
the vectors encountered are really numeric vectors.

.. OTOH, in all of the 3 packages I co-author and which use S4  heavily,  Matrix, Rmpfr, lme4,
I had till now decided *not* to  setIs()  because it never
worked as I intended, or rather had unpleasant side effects.

Here,
      setIs("array", "numeric", test=is.numeric)

gives

    Error in setIs("array", "numeric", test = is.numeric) : 
    cannot create a 'setIs' relation when neither of the classes (?array? and ?numeric?) is local and modifiable in this package

A more successful alternative had been to use  setClassUnion(),
so I could consider defining

  setClassUnion("mVector", c("numeric", "array"))

and replace "numeric" in many of the method signatures by  "mVector"
(but that would then also dispatch for 1d character arrays
 ... not so nicely).



    > -Deepayan

    > ______________________________________________
    > R-help at r-project.org mailing list -- To UNSUBSCRIBE and
    > more, see https://stat.ethz.ch/mailman/listinfo/r-help
    > PLEASE do read the posting guide
    > http://www.R-project.org/posting-guide.html and provide
    > commented, minimal, self-contained, reproducible code.


From neh@@bo|ogn@90 @end|ng |rom gm@||@com  Sat Apr 17 21:02:15 2021
From: neh@@bo|ogn@90 @end|ng |rom gm@||@com (Neha gupta)
Date: Sat, 17 Apr 2021 21:02:15 +0200
Subject: [R] Installed Packages not working
Message-ID: <CA+nrPntaQSh=vBFXDKxjfBMuCAw=7Y9r+d5ssCddc2SmpXHVwQ@mail.gmail.com>

Hi, suddenly the packages I installed not working. It gives me the error:

Error: package or namespace load failed for ?farff? in loadNamespace(i,
c(lib.loc, .libPaths()), versionCheck = vI[[i]]):
 namespace ?rlang? 0.4.7 is already loaded, but >= 0.4.10 is required

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sat Apr 17 21:05:26 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sat, 17 Apr 2021 12:05:26 -0700
Subject: [R] Installed Packages not working
In-Reply-To: <CA+nrPntaQSh=vBFXDKxjfBMuCAw=7Y9r+d5ssCddc2SmpXHVwQ@mail.gmail.com>
References: <CA+nrPntaQSh=vBFXDKxjfBMuCAw=7Y9r+d5ssCddc2SmpXHVwQ@mail.gmail.com>
Message-ID: <5F798F83-310A-4CB2-A03D-F1CA1CF1D1A6@dcn.davis.ca.us>

Either upgrade rlang or remove farff and install an older version.

On April 17, 2021 12:02:15 PM PDT, Neha gupta <neha.bologna90 at gmail.com> wrote:
>Hi, suddenly the packages I installed not working. It gives me the
>error:
>
>Error: package or namespace load failed for ?farff? in loadNamespace(i,
>c(lib.loc, .libPaths()), versionCheck = vI[[i]]):
> namespace ?rlang? 0.4.7 is already loaded, but >= 0.4.10 is required
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Apr 17 21:12:01 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 17 Apr 2021 15:12:01 -0400
Subject: [R] Installed Packages not working
In-Reply-To: <CA+nrPntaQSh=vBFXDKxjfBMuCAw=7Y9r+d5ssCddc2SmpXHVwQ@mail.gmail.com>
References: <CA+nrPntaQSh=vBFXDKxjfBMuCAw=7Y9r+d5ssCddc2SmpXHVwQ@mail.gmail.com>
Message-ID: <81e44567-ec81-fb43-5d0c-24668144b24d@gmail.com>

On 17/04/2021 3:02 p.m., Neha gupta wrote:
> Hi, suddenly the packages I installed not working. It gives me the error:
> 
> Error: package or namespace load failed for ?farff? in loadNamespace(i,
> c(lib.loc, .libPaths()), versionCheck = vI[[i]]):
>   namespace ?rlang? 0.4.7 is already loaded, but >= 0.4.10 is required

Something you are trying to use needs rlang 0.4.10, and you don't have that.

Duncan Murdoch


From |@heemj@n93 @end|ng |rom y@hoo@com  Sat Apr 17 21:32:55 2021
From: |@heemj@n93 @end|ng |rom y@hoo@com (Faheem Jan)
Date: Sat, 17 Apr 2021 19:32:55 +0000 (UTC)
Subject: [R] Check accuracy of the model
References: <2114079008.3411660.1618687975375.ref@mail.yahoo.com>
Message-ID: <2114079008.3411660.1618687975375@mail.yahoo.com>

   
   -    
Hi, hope that you will be fine, I have a problem with functional time series,   
I am working with the hourly electricity spot price data, due to the large dimensionality I convert the discrete data into functional data. The model I use the functional autoregressive model of order more than one, as per my knowledge there no R package available to deal with such model, so I apply an alternative method, using the functional principal components (FPC's) as dimensional reduction, utilizing the associated principal components for the forecasting through multivariate time series model. Then I convert these forecast scores into functional curves through Karhunen-Loeve decomposition into a functional form, in such a way I obtained a forecast of each day as a single curve. Know, to check the accuracy of the model I want to calculate percentage mean square error or mean absolute error. know my problem start from here, So I want to reverse back each curve into 24 discrete points, is there is any package in R which is helpful in dealing with such a problem. I will be waiting for your fruitful reply in this regard.

   - 


	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Apr 17 21:35:18 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 17 Apr 2021 20:35:18 +0100
Subject: [R] Installed Packages not working
In-Reply-To: <CA+nrPntaQSh=vBFXDKxjfBMuCAw=7Y9r+d5ssCddc2SmpXHVwQ@mail.gmail.com>
References: <CA+nrPntaQSh=vBFXDKxjfBMuCAw=7Y9r+d5ssCddc2SmpXHVwQ@mail.gmail.com>
Message-ID: <72fcd04d-e1e1-6a7d-21e7-a155561ac6c2@sapo.pt>

Hello,

That error message means you need to run

install.packages("rlang")

before running

library(farff)


Hope this helps,

Rui Barradas

?s 20:02 de 17/04/21, Neha gupta escreveu:
> Hi, suddenly the packages I installed not working. It gives me the error:
> 
> Error: package or namespace load failed for ?farff? in loadNamespace(i,
> c(lib.loc, .libPaths()), versionCheck = vI[[i]]):
>   namespace ?rlang? 0.4.7 is already loaded, but >= 0.4.10 is required
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From neh@@bo|ogn@90 @end|ng |rom gm@||@com  Sat Apr 17 21:52:27 2021
From: neh@@bo|ogn@90 @end|ng |rom gm@||@com (Neha gupta)
Date: Sat, 17 Apr 2021 21:52:27 +0200
Subject: [R] Installed Packages not working
In-Reply-To: <72fcd04d-e1e1-6a7d-21e7-a155561ac6c2@sapo.pt>
References: <CA+nrPntaQSh=vBFXDKxjfBMuCAw=7Y9r+d5ssCddc2SmpXHVwQ@mail.gmail.com>
 <72fcd04d-e1e1-6a7d-21e7-a155561ac6c2@sapo.pt>
Message-ID: <CA+nrPnvpdEUNamVa8MZ8K2RXeDH3HR0GHqj9oH8N3F5rUZopJg@mail.gmail.com>

Thank you. I have installed "rlang" but now giving error message below:

Error: package or namespace load failed for ?farff? in loadNamespace(i,
c(lib.loc, .libPaths()), versionCheck = vI[[i]]):
 namespace ?rlang? 0.4.7 is already loaded, but >= 0.4.10 is required

On Sat, Apr 17, 2021 at 9:35 PM Rui Barradas <ruipbarradas at sapo.pt> wrote:

> Hello,
>
> That error message means you need to run
>
> install.packages("rlang")
>
> before running
>
> library(farff)
>
>
> Hope this helps,
>
> Rui Barradas
>
> ?s 20:02 de 17/04/21, Neha gupta escreveu:
> > Hi, suddenly the packages I installed not working. It gives me the error:
> >
> > Error: package or namespace load failed for ?farff? in loadNamespace(i,
> > c(lib.loc, .libPaths()), versionCheck = vI[[i]]):
> >   namespace ?rlang? 0.4.7 is already loaded, but >= 0.4.10 is required
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>

	[[alternative HTML version deleted]]


From neh@@bo|ogn@90 @end|ng |rom gm@||@com  Sat Apr 17 22:04:56 2021
From: neh@@bo|ogn@90 @end|ng |rom gm@||@com (Neha gupta)
Date: Sat, 17 Apr 2021 22:04:56 +0200
Subject: [R] Installed Packages not working
In-Reply-To: <CA+nrPnvpdEUNamVa8MZ8K2RXeDH3HR0GHqj9oH8N3F5rUZopJg@mail.gmail.com>
References: <CA+nrPntaQSh=vBFXDKxjfBMuCAw=7Y9r+d5ssCddc2SmpXHVwQ@mail.gmail.com>
 <72fcd04d-e1e1-6a7d-21e7-a155561ac6c2@sapo.pt>
 <CA+nrPnvpdEUNamVa8MZ8K2RXeDH3HR0GHqj9oH8N3F5rUZopJg@mail.gmail.com>
Message-ID: <CA+nrPntfJSDjHmDoemK7_nXH54SYYBNs_reXZh8ekqUb82iHRw@mail.gmail.com>

Thank you all.. I installed vctrs and install_dependencies and now its
working

Regards

On Sat, Apr 17, 2021 at 9:52 PM Neha gupta <neha.bologna90 at gmail.com> wrote:

> Thank you. I have installed "rlang" but now giving error message below:
>
> Error: package or namespace load failed for ?farff? in loadNamespace(i,
> c(lib.loc, .libPaths()), versionCheck = vI[[i]]):
>  namespace ?rlang? 0.4.7 is already loaded, but >= 0.4.10 is required
>
> On Sat, Apr 17, 2021 at 9:35 PM Rui Barradas <ruipbarradas at sapo.pt> wrote:
>
>> Hello,
>>
>> That error message means you need to run
>>
>> install.packages("rlang")
>>
>> before running
>>
>> library(farff)
>>
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>> ?s 20:02 de 17/04/21, Neha gupta escreveu:
>> > Hi, suddenly the packages I installed not working. It gives me the
>> error:
>> >
>> > Error: package or namespace load failed for ?farff? in loadNamespace(i,
>> > c(lib.loc, .libPaths()), versionCheck = vI[[i]]):
>> >   namespace ?rlang? 0.4.7 is already loaded, but >= 0.4.10 is required
>> >
>> >       [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>> >
>>
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Sat Apr 17 22:07:44 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 17 Apr 2021 13:07:44 -0700
Subject: [R] Check accuracy of the model
In-Reply-To: <2114079008.3411660.1618687975375@mail.yahoo.com>
References: <2114079008.3411660.1618687975375.ref@mail.yahoo.com>
 <2114079008.3411660.1618687975375@mail.yahoo.com>
Message-ID: <CAGxFJbS0Cy3J7edS2ibUror5nqsJdwNeryYGPPSyaJa5q7YSeA@mail.gmail.com>

" The model I use the functional autoregressive model of order more than
one, as per my knowledge there no R package available to deal with such
model," ...

Have you looked here:
https://cran.r-project.org/web/views/TimeSeries.html
or perhaps here:
https://cran.r-project.org/web/views/Econometrics.html

A full list of all such R "task views" -- very useful to be aware of -- is
of course in the parent directory here:
https://cran.r-project.org/web/views/

I should note that your query is largely off topic. Read and follow the
posting guide linked below if you post again, but note, per the guide:

"*Questions about statistics:* The R mailing lists are primarily intended
for questions and discussion about the R software. However, questions about
statistical methodology are sometimes posted. If the question is well-asked
and of interest to someone on the list, it *may* elicit an informative
up-to-date answer."

Also, this is a **plain text** list -- so **no HTML** in any future
postings, please.


Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Sat, Apr 17, 2021 at 12:33 PM Faheem Jan via R-help <r-help at r-project.org>
wrote:

>
>    -
> Hi, hope that you will be fine, I have a problem with functional time
> series,
> I am working with the hourly electricity spot price data, due to the large
> dimensionality I convert the discrete data into functional data. The model
> I use the functional autoregressive model of order more than one, as per my
> knowledge there no R package available to deal with such model, so I apply
> an alternative method, using the functional principal components (FPC's) as
> dimensional reduction, utilizing the associated principal components for
> the forecasting through multivariate time series model. Then I convert
> these forecast scores into functional curves through Karhunen-Loeve
> decomposition into a functional form, in such a way I obtained a forecast
> of each day as a single curve. Know, to check the accuracy of the model I
> want to calculate percentage mean square error or mean absolute error. know
> my problem start from here, So I want to reverse back each curve into 24
> discrete points, is there is any package in R which is helpful in dealing
> with such a problem. I will be waiting
>   for your fruitful reply in this regard.
>
>    -
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From deep@y@n@@@rk@r @end|ng |rom gm@||@com  Mon Apr 19 06:26:58 2021
From: deep@y@n@@@rk@r @end|ng |rom gm@||@com (Deepayan Sarkar)
Date: Mon, 19 Apr 2021 09:56:58 +0530
Subject: [R] Matrix::solve() with 1-d arrays -- treating "array" as
 "numeric"?
In-Reply-To: <24699.246.141949.778635@stat.math.ethz.ch>
References: <CADfFDC7mYee1R3giUZA38XzG73wrhzz0zD6M-3DGxEUpk-qimg@mail.gmail.com>
 <24699.246.141949.778635@stat.math.ethz.ch>
Message-ID: <CADfFDC62kmYXd4zztCTpOaBP5fu7gU1E-13ETy1soDq1ZCmRmw@mail.gmail.com>

On Sat, Apr 17, 2021 at 9:08 PM Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>
> >>>>> Deepayan Sarkar
> >>>>>     on Fri, 16 Apr 2021 11:34:20 +0530 writes:
>
>     > I get what I initially thought was unexpected behaviour from:
>
>     > x <- tapply(runif(100), sample(5, 100, TRUE), mean)
>     > solve(Diagonal(5), x)
>     > # Error: not-yet-implemented method for solve(<ddiMatrix>, <array>).
>     > #  ->>  Ask the package authors to implement the missing feature.
>
>     ((why did you not ask the package authors ?? --- never mind))
>
>
>     > This is because x is a 1-D array, so the operation is not
>     > well-defined. Would it make sense for Matrix to support this (treat
>     > 1-D arrays as column vectors, as it does for plain vectors)? Or should
>     > I make my intent clear with
>
>     > solve(Diagonal(5), as.vector(x))
>
> well ...
>
> The "fun" thing is that it actually works when Matrix methods
> are not fully available, i.e., if you do *not* do
> require(Matrix) or equivalent,
> but rather only load the Matrix namespace via
>
>   solve(Matrix::Diagonal(5), x)
>
> actually currently works correctly by some "good coincidence"
> (I have not yet tried to understand, as that's a bit painful:
>  selectMethod("solve", c("ddiMatrix", "array"))  is "lying" here ! )
>
> However this looks like a more general problem with S4 methods
> -- and probably a good reason for asking on R-help --  namely,
> the fact that d1-dimensional (numeric) arrays are not automatically treated as
> (numeric) vectors i.e. class "numeric"  wrt S4 methods.
>
> In the following case the  solve() - coincidence does not help, BTW.
>
>      Diagonal(3) %*% array(1:3)
>
>      ## Error in Diagonal(3) %*% array(1:3) :
>      ##   not-yet-implemented method for <ddiMatrix> %*% <array>
>
>
> In principle, we should consider a way to tell that "array"
> should be tried as "vector",

Actually, if you think compatible 1-d numeric arrays should 'work',
then all I was thinking of was something along the following lines:
Add an additional

setMethod("solve", c("ANY", "array"), function(a, b, ...) ...

which would basically do a dimension check for b, for 1-d numeric
arrays call solve(a, as.vector(b), ...), and error out for dim(b) > 2.
The actual details may be more involved, but that's the basic idea.

> possibly via something like    setIs("array", "vector")  or
> rather  setIs("array", "numeric")  because in the Matrix package
> the vectors encountered are really numeric vectors.
>
> .. OTOH, in all of the 3 packages I co-author and which use S4  heavily,  Matrix, Rmpfr, lme4,
> I had till now decided *not* to  setIs()  because it never
> worked as I intended, or rather had unpleasant side effects.
>
> Here,
>       setIs("array", "numeric", test=is.numeric)
>
> gives
>
>     Error in setIs("array", "numeric", test = is.numeric) :
>     cannot create a 'setIs' relation when neither of the classes (?array? and ?numeric?) is local and modifiable in this package
>
> A more successful alternative had been to use  setClassUnion(),
> so I could consider defining
>
>   setClassUnion("mVector", c("numeric", "array"))
>
> and replace "numeric" in many of the method signatures by  "mVector"
> (but that would then also dispatch for 1d character arrays
>  ... not so nicely).

But you already have that problem, I think:

> s = matrix(letters[1:10], 5, 2)
> solve(Diagonal(5), s)
Error in .M.kind(data) :
  not yet implemented for matrix with typeof character

whereas

m = matrix(1:10, 5, 2)

works nicely. Unfortunately, both m and s have the same class
(c("matrix", "array")), so I don't think method dispatch would be able
to distinguish between them with the current design, and you anyway
need to check in the solve method for c("diagonalMatrix", "matrix").

Best,
-Deepayan


>     > -Deepayan
>
>     > ______________________________________________
>     > R-help at r-project.org mailing list -- To UNSUBSCRIBE and
>     > more, see https://stat.ethz.ch/mailman/listinfo/r-help
>     > PLEASE do read the posting guide
>     > http://www.R-project.org/posting-guide.html and provide
>     > commented, minimal, self-contained, reproducible code.


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Mon Apr 19 09:06:11 2021
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Mon, 19 Apr 2021 09:06:11 +0200
Subject: [R] Matrix::solve() with 1-d arrays -- treating "array" as
 "numeric"?
In-Reply-To: <CADfFDC62kmYXd4zztCTpOaBP5fu7gU1E-13ETy1soDq1ZCmRmw@mail.gmail.com>
References: <CADfFDC7mYee1R3giUZA38XzG73wrhzz0zD6M-3DGxEUpk-qimg@mail.gmail.com>
 <24699.246.141949.778635@stat.math.ethz.ch>
 <CADfFDC62kmYXd4zztCTpOaBP5fu7gU1E-13ETy1soDq1ZCmRmw@mail.gmail.com>
Message-ID: <24701.11235.574009.37902@stat.math.ethz.ch>

>>>>> Deepayan Sarkar 
>>>>>     on Mon, 19 Apr 2021 09:56:58 +0530 writes:

    > On Sat, Apr 17, 2021 at 9:08 PM Martin Maechler
    > <maechler at stat.math.ethz.ch> wrote:
    >> 
    >> >>>>> Deepayan Sarkar >>>>> on Fri, 16 Apr 2021 11:34:20
    >> +0530 writes:
    >> 
    >> > I get what I initially thought was unexpected behaviour
    >> from:
    >> 
    >> > x <- tapply(runif(100), sample(5, 100, TRUE), mean) >
    >> solve(Diagonal(5), x) > # Error: not-yet-implemented
    >> method for solve(<ddiMatrix>, <array>).  > # ->> Ask the
    >> package authors to implement the missing feature.
    >> 
    >> ((why did you not ask the package authors ?? --- never
    >> mind))
    >> 
    >> 
    >> > This is because x is a 1-D array, so the operation is
    >> not > well-defined. Would it make sense for Matrix to
    >> support this (treat > 1-D arrays as column vectors, as it
    >> does for plain vectors)? Or should > I make my intent
    >> clear with
    >> 
    >> > solve(Diagonal(5), as.vector(x))
    >> 
    >> well ...
    >> 
    >> The "fun" thing is that it actually works when Matrix
    >> methods are not fully available, i.e., if you do *not* do
    >> require(Matrix) or equivalent, but rather only load the
    >> Matrix namespace via
    >> 
    >> solve(Matrix::Diagonal(5), x)
    >> 
    >> actually currently works correctly by some "good
    >> coincidence" (I have not yet tried to understand, as
    >> that's a bit painful: selectMethod("solve",
    >> c("ddiMatrix", "array")) is "lying" here ! )
    >> 
    >> However this looks like a more general problem with S4
    >> methods -- and probably a good reason for asking on
    >> R-help -- namely, the fact that d1-dimensional (numeric)
    >> arrays are not automatically treated as (numeric) vectors
    >> i.e. class "numeric" wrt S4 methods.
    >> 
    >> In the following case the solve() - coincidence does not
    >> help, BTW.
    >> 
    >> Diagonal(3) %*% array(1:3)
    >> 
    >> ## Error in Diagonal(3) %*% array(1:3) : ##
    >> not-yet-implemented method for <ddiMatrix> %*% <array>
    >> 
    >> 
    >> In principle, we should consider a way to tell that
    >> "array" should be tried as "vector",

    > Actually, if you think compatible 1-d numeric arrays
    > should 'work', then all I was thinking of was something
    > along the following lines: Add an additional

    > setMethod("solve", c("ANY", "array"), function(a, b, ...)
    > ...

    > which would basically do a dimension check for b, for 1-d
    > numeric arrays call solve(a, as.vector(b), ...), and error
    > out for dim(b) > 2.  The actual details may be more
    > involved, but that's the basic idea.

Well, of course, it's just that a method like the one above
would have to be provided for all signatures where something
corresponding for "numeric" now exists ..
and these may easily get to many dozens at least.

In other words  solve() is just one special case of very many
and I was rather interested in finding a method to solve "all
cases" at once - "automagically".

Otherwise, supporting  1d "array" to work Matrix-pkg matrices
would not only mean providing these many dozen of methods now,
but
also for every new functionality that uses S4 methods with
numeric vectors to have to always provide an additional "array"
method, i.e.,  increasing the Matrix-maintenance burden yet more.




    >> possibly via something like setIs("array", "vector") or
    >> rather setIs("array", "numeric") because in the Matrix
    >> package the vectors encountered are really numeric
    >> vectors.
    >> 
    >> .. OTOH, in all of the 3 packages I co-author and which
    >> use S4 heavily, Matrix, Rmpfr, lme4, I had till now
    >> decided *not* to setIs() because it never worked as I
    >> intended, or rather had unpleasant side effects.
    >> 
    >> Here, setIs("array", "numeric", test=is.numeric)
    >> 
    >> gives
    >> 
    >> Error in setIs("array", "numeric", test = is.numeric) :
    >> cannot create a 'setIs' relation when neither of the
    >> classes (?array? and ?numeric?) is local and modifiable
    >> in this package
    >> 
    >> A more successful alternative had been to use
    >> setClassUnion(), so I could consider defining
    >> 
    >> setClassUnion("mVector", c("numeric", "array"))
    >> 
    >> and replace "numeric" in many of the method signatures by
    >> "mVector" (but that would then also dispatch for 1d
    >> character arrays ... not so nicely).

    > But you already have that problem, I think:

    >> s = matrix(letters[1:10], 5, 2) solve(Diagonal(5), s)
    > Error in .M.kind(data) : not yet implemented for matrix
    > with typeof character

    > whereas

    > m = matrix(1:10, 5, 2)

    > works nicely. Unfortunately, both m and s have the same
    > class (c("matrix", "array")), so I don't think method
    > dispatch would be able to distinguish between them with
    > the current design, and you anyway need to check in the
    > solve method for c("diagonalMatrix", "matrix").

    > Best, -Deepayan

That's a convincing argument, I concur,
thank you.

So maybe such a "global" class union containing "array", and
replacing "numeric" in Matrix' current setMethod()s' signatures
would solve the problem  quite nicely (well, as "nicely" as it
can easily get).

Something we should really try (as soon as current R-forge
version of Matrix, 1.3-3, will have been on CRAN).

Note BTW, that since R 4.0.x, we have  the function

 .class2()  which provides the full
 	    "method-dispatch class vector", 
e.g.,

> .class2(array(1:3))
[1] "array"   "integer" "numeric"
> .class2(matrix(letters, 2))
[1] "matrix"    "array"     "character"
>

Martin


From dr@@|@m@o|@ng| @end|ng |rom gm@||@com  Mon Apr 19 14:35:45 2021
From: dr@@|@m@o|@ng| @end|ng |rom gm@||@com (Shah Alam)
Date: Mon, 19 Apr 2021 14:35:45 +0200
Subject: [R] What is an alternative to expand.grid if create a long vector?
Message-ID: <CA+bivFgnf4cC1sZzKv2fm9769PO2HRXX9NRyhh4NJNWDUTHqxA@mail.gmail.com>

Dear All,

I would like to know that is there any problem in *expand.grid* function or
it is a limitation of this function.

I am trying to create a combination of elements using expand.grid function.

A <- expand.grid(
c(seq(0.001, 0.1, length.out = 100)),
c(seq(0.0001, 0.001, length.out = 100)),
c(seq(0.38, 0.42, length.out = 100)),
c(seq(0.12, 0.18, length.out = 100)))

Four combinations work fine. However, If I increase the combinations up to
ten. The following error appears.

 A <- expand.grid(
c(seq(0.001, 1, length.out = 100)),
c(seq(0.0001, 0.001, length.out = 100)),
c(seq(0.38, 0.42, length.out = 100)),
c(seq(0.12, 0.18, length.out = 100)),
c(seq(0.01, 0.04, length.out = 100)),
c(seq(0.0001, 0.001, length.out = 100)),
c(seq(0.0001, 0.001, length.out = 100)),
c(seq(0.001, 0.01, length.out = 100)),
c(seq(0.01, 0.3, length.out = 100))
)

*Error in rep.int <http://rep.int>(rep.int <http://rep.int>(seq_len(nx),
rep.int <http://rep.int>(rep.fac, nx)), orep) :   invalid 'times' value*

After reducing the length to 10. It produced a different type of error

A <- expand.grid(
c(seq(0.001, 0.005, length.out = 10)),
c(seq(0.0001, 0.0005, length.out = 10)),
c(seq(0.38, 0.42, length.out = 5)),
c(seq(0.12, 0.18, length.out = 7)),
c(seq(0.01, 0.04, length.out = 5)),
c(seq(0.0001, 0.001, length.out = 10)),
c(seq(0.0001, 0.001, length.out = 10)),
c(seq(0.001, 0.01, length.out = 10)),
c(seq(0.1, 0.8, length.out = 8))
)

*Error: cannot allocate vector of size 1.0 Gb*

What is an alternative to expand.grid if create a long vector based on 10
elements?

With kind regards,
Shah Alam

	[[alternative HTML version deleted]]


From petr@p|k@| @end|ng |rom prechez@@cz  Mon Apr 19 14:52:11 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Mon, 19 Apr 2021 12:52:11 +0000
Subject: [R] 
 What is an alternative to expand.grid if create a long vector?
In-Reply-To: <CA+bivFgnf4cC1sZzKv2fm9769PO2HRXX9NRyhh4NJNWDUTHqxA@mail.gmail.com>
References: <CA+bivFgnf4cC1sZzKv2fm9769PO2HRXX9NRyhh4NJNWDUTHqxA@mail.gmail.com>
Message-ID: <cee8264b02674750a9bb95b86a9e08fc@SRVEXCHCM1302.precheza.cz>

Hi

Actually expand.grid produces data frame and not vector. And dimension of
the data frame is "big"

> dim(A)
[1] 100000000         4
> str(A)
'data.frame':   100000000 obs. of  4 variables:
 $ Var1: num  0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008 0.009 0.01 ...
 $ Var2: num  1e-04 1e-04 1e-04 1e-04 1e-04 1e-04 1e-04 1e-04 1e-04 1e-04
...
 $ Var3: num  0.38 0.38 0.38 0.38 0.38 0.38 0.38 0.38 0.38 0.38 ...
 $ Var4: num  0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 ...
 - attr(*, "out.attrs")=List of 2
  ..$ dim     : int [1:4] 100 100 100 100
  ..$ dimnames:List of 4
  .. ..$ Var1: chr [1:100] "Var1=0.001" "Var1=0.002" "Var1=0.003"
"Var1=0.004" ...
  .. ..$ Var2: chr [1:100] "Var2=0.0001000000" "Var2=0.0001090909"
"Var2=0.0001181818" "Var2=0.0001272727" ...
  .. ..$ Var3: chr [1:100] "Var3=0.3800000" "Var3=0.3804040"
"Var3=0.3808081" "Var3=0.3812121" ...
  .. ..$ Var4: chr [1:100] "Var4=0.1200000" "Var4=0.1206061"
"Var4=0.1212121" "Var4=0.1218182" ...
>

in case of 4 sequences 1e8 rows, 4 columns
in case of 10 sequences 1e20 rows and 10 columns
in your last example 1.4e8 rows and 10 columns which probably cross the
memory capacity of your PC.

Maybe you could increase memory of you PC. If I am correct to store the
first you need about 3.2GB, to strore the last 11.2 GB.

May I ask what you want to do with such a big object? 

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Shah Alam
> Sent: Monday, April 19, 2021 2:36 PM
> To: r-help mailing list <r-help at r-project.org>
> Subject: [R] What is an alternative to expand.grid if create a long
vector?
> 
> Dear All,
> 
> I would like to know that is there any problem in *expand.grid* function
or it
> is a limitation of this function.
> 
> I am trying to create a combination of elements using expand.grid
function.
> 
> A <- expand.grid(
> c(seq(0.001, 0.1, length.out = 100)),
> c(seq(0.0001, 0.001, length.out = 100)), c(seq(0.38, 0.42, length.out =
100)),
> c(seq(0.12, 0.18, length.out = 100)))
> 
> Four combinations work fine. However, If I increase the combinations up to
> ten. The following error appears.
> 
>  A <- expand.grid(
> c(seq(0.001, 1, length.out = 100)),
> c(seq(0.0001, 0.001, length.out = 100)), c(seq(0.38, 0.42, length.out =
100)),
> c(seq(0.12, 0.18, length.out = 100)), c(seq(0.01, 0.04, length.out =
100)),
> c(seq(0.0001, 0.001, length.out = 100)), c(seq(0.0001, 0.001, length.out =
> 100)), c(seq(0.001, 0.01, length.out = 100)), c(seq(0.01, 0.3, length.out
= 100))
> )
> 
> *Error in rep.int <http://rep.int>(rep.int <http://rep.int>(seq_len(nx),
> rep.int <http://rep.int>(rep.fac, nx)), orep) :   invalid 'times' value*
> 
> After reducing the length to 10. It produced a different type of error
> 
> A <- expand.grid(
> c(seq(0.001, 0.005, length.out = 10)),
> c(seq(0.0001, 0.0005, length.out = 10)), c(seq(0.38, 0.42, length.out =
5)),
> c(seq(0.12, 0.18, length.out = 7)), c(seq(0.01, 0.04, length.out = 5)),
> c(seq(0.0001, 0.001, length.out = 10)), c(seq(0.0001, 0.001, length.out =
10)),
> c(seq(0.001, 0.01, length.out = 10)), c(seq(0.1, 0.8, length.out = 8))
> )
> 
> *Error: cannot allocate vector of size 1.0 Gb*
> 
> What is an alternative to expand.grid if create a long vector based on 10
> elements?
> 
> With kind regards,
> Shah Alam
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Apr 19 18:02:02 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 19 Apr 2021 17:02:02 +0100
Subject: [R] 
 What is an alternative to expand.grid if create a long vector?
In-Reply-To: <CA+bivFgnf4cC1sZzKv2fm9769PO2HRXX9NRyhh4NJNWDUTHqxA@mail.gmail.com>
References: <CA+bivFgnf4cC1sZzKv2fm9769PO2HRXX9NRyhh4NJNWDUTHqxA@mail.gmail.com>
Message-ID: <de6a2a44-d297-3c92-513e-b3f6e91d47eb@sapo.pt>

Hello,

If you want to process the data by rows, then maybe you should consider 
a custom function that divides the problem in small chunks and process 
one chunk at a time.

But even so, at 8 bytes per double, 100^10 rows is

(100^10*8)/(1024^4)  # Tera bytes
#[1] 727595761

It will take you a very, very long time to process.

Revise the problem?

Hope this helps,

Rui Barradas

?s 13:35 de 19/04/21, Shah Alam escreveu:
> Dear All,
> 
> I would like to know that is there any problem in *expand.grid* function or
> it is a limitation of this function.
> 
> I am trying to create a combination of elements using expand.grid function.
> 
> A <- expand.grid(
> c(seq(0.001, 0.1, length.out = 100)),
> c(seq(0.0001, 0.001, length.out = 100)),
> c(seq(0.38, 0.42, length.out = 100)),
> c(seq(0.12, 0.18, length.out = 100)))
> 
> Four combinations work fine. However, If I increase the combinations up to
> ten. The following error appears.
> 
>   A <- expand.grid(
> c(seq(0.001, 1, length.out = 100)),
> c(seq(0.0001, 0.001, length.out = 100)),
> c(seq(0.38, 0.42, length.out = 100)),
> c(seq(0.12, 0.18, length.out = 100)),
> c(seq(0.01, 0.04, length.out = 100)),
> c(seq(0.0001, 0.001, length.out = 100)),
> c(seq(0.0001, 0.001, length.out = 100)),
> c(seq(0.001, 0.01, length.out = 100)),
> c(seq(0.01, 0.3, length.out = 100))
> )
> 
> *Error in rep.int <http://rep.int>(rep.int <http://rep.int>(seq_len(nx),
> rep.int <http://rep.int>(rep.fac, nx)), orep) :   invalid 'times' value*
> 
> After reducing the length to 10. It produced a different type of error
> 
> A <- expand.grid(
> c(seq(0.001, 0.005, length.out = 10)),
> c(seq(0.0001, 0.0005, length.out = 10)),
> c(seq(0.38, 0.42, length.out = 5)),
> c(seq(0.12, 0.18, length.out = 7)),
> c(seq(0.01, 0.04, length.out = 5)),
> c(seq(0.0001, 0.001, length.out = 10)),
> c(seq(0.0001, 0.001, length.out = 10)),
> c(seq(0.001, 0.01, length.out = 10)),
> c(seq(0.1, 0.8, length.out = 8))
> )
> 
> *Error: cannot allocate vector of size 1.0 Gb*
> 
> What is an alternative to expand.grid if create a long vector based on 10
> elements?
> 
> With kind regards,
> Shah Alam
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From @okov|c@@n@m@r|j@ @end|ng |rom gm@||@com  Tue Apr 20 00:01:11 2021
From: @okov|c@@n@m@r|j@ @end|ng |rom gm@||@com (Ana Marija)
Date: Mon, 19 Apr 2021 17:01:11 -0500
Subject: [R] Error in n * rvec : non-numeric argument to binary operator
Message-ID: <CAF9-5jNE0HWJrLvMYdE5kqUN+J22JXm8soa=-7uXaPJ0VjuaAA@mail.gmail.com>

Hello,

I have this code, and when I run it:
> kbpowerf()
Error in n * rvec : non-numeric argument to binary operator

this is the code:

function (){
  #USER SPECIFICATION PORTION
  alpha=0.05 #DESIGNATED ALPHA
  g=3 #NUMBER OF GROUPS
  nvec=c(25,10,15) #GROUP SIZES
  beta1vec=c(789.93,122.87,1871.99) #SLOPE COEFFICIENTS
  sigsq=209460.57 #ERROR VARIANCE
  tausqvec=c(0.1596,0.1602,0.1360) #PREDICTOR VARIANCES
  #END OF SPECIFICATION
  df1<-g-1
  numint<-200
  l<-numint+1
  dd<-1e-6
  coevec<-c(1,rep(c(4,2),numint/2-1),4,1)
  set.seed(2017)
  repn<-20000
  kbpowerf<-function(){
    df<-sum(nvec)-2*g
    fcrit<-qf(1-alpha,df1,df)
    dfkvec<-nvec-1
    dfk<-sum(dfkvec)
    cl<-dd
    cu<-qchisq(1-dd,dfk)
    intc<-(cu-cl)/numint
    cvec<-cl+intc*(0:numint)
    wcpdf<-(intc/3)*coevec*dchisq(cvec,dfk)
    dfb1<-cumsum(dfkvec[1:g-1])
    dfb2<-dfkvec[2:g]
    ep<-0
    for (i in seq(repn)) {
      bvec<-rbeta(df1,dfb1/2,dfb2/2)
      avec<-rep(0,g)
      avec[1]<-exp(sum(log(bvec)))
      for (ig in (2:df1)) {
        avec[ig]<-(1-bvec[ig-1])*exp(sum(log(bvec[ig:df1])))
      }
      avec[g]<-1-bvec[df1]
      oavec<-tausqvec*avec
      buw<-sum(oavec*beta1vec)/sum(oavec)
      lamvec<-cvec*sum(oavec*(beta1vec-buw)^2)/sigsq
      ep<-ep+sum(wcpdf*pf(fcrit,df1,df,lamvec,lower.tail=FALSE))
    }
    kbpower<-ep/repn
  }
  kbpower<-kbpowerf()
  return(list(sample_size=nvec,attained_power=kbpower))
}

Can you please advise,
Thanks
Ana


From r@turner @end|ng |rom @uck|@nd@@c@nz  Tue Apr 20 02:26:59 2021
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Tue, 20 Apr 2021 12:26:59 +1200
Subject: [R] Error in n * rvec : non-numeric argument to binary operator
In-Reply-To: <CAF9-5jNE0HWJrLvMYdE5kqUN+J22JXm8soa=-7uXaPJ0VjuaAA@mail.gmail.com>
References: <CAF9-5jNE0HWJrLvMYdE5kqUN+J22JXm8soa=-7uXaPJ0VjuaAA@mail.gmail.com>
Message-ID: <20210420122659.6d202854@rolf-Latitude-E7470>


On Mon, 19 Apr 2021 17:01:11 -0500
Ana Marija <sokovic.anamarija at gmail.com> wrote:

> Hello,
> 
> I have this code, and when I run it:
> > kbpowerf()
> Error in n * rvec : non-numeric argument to binary operator
> 
> this is the code:
> 
> function (){
>   #USER SPECIFICATION PORTION
>   alpha=0.05 #DESIGNATED ALPHA
>   g=3 #NUMBER OF GROUPS
>   nvec=c(25,10,15) #GROUP SIZES
>   beta1vec=c(789.93,122.87,1871.99) #SLOPE COEFFICIENTS
>   sigsq=209460.57 #ERROR VARIANCE
>   tausqvec=c(0.1596,0.1602,0.1360) #PREDICTOR VARIANCES
>   #END OF SPECIFICATION
>   df1<-g-1
>   numint<-200
>   l<-numint+1
>   dd<-1e-6
>   coevec<-c(1,rep(c(4,2),numint/2-1),4,1)
>   set.seed(2017)
>   repn<-20000
>   kbpowerf<-function(){
>     df<-sum(nvec)-2*g
>     fcrit<-qf(1-alpha,df1,df)
>     dfkvec<-nvec-1
>     dfk<-sum(dfkvec)
>     cl<-dd
>     cu<-qchisq(1-dd,dfk)
>     intc<-(cu-cl)/numint
>     cvec<-cl+intc*(0:numint)
>     wcpdf<-(intc/3)*coevec*dchisq(cvec,dfk)
>     dfb1<-cumsum(dfkvec[1:g-1])
>     dfb2<-dfkvec[2:g]
>     ep<-0
>     for (i in seq(repn)) {
>       bvec<-rbeta(df1,dfb1/2,dfb2/2)
>       avec<-rep(0,g)
>       avec[1]<-exp(sum(log(bvec)))
>       for (ig in (2:df1)) {
>         avec[ig]<-(1-bvec[ig-1])*exp(sum(log(bvec[ig:df1])))
>       }
>       avec[g]<-1-bvec[df1]
>       oavec<-tausqvec*avec
>       buw<-sum(oavec*beta1vec)/sum(oavec)
>       lamvec<-cvec*sum(oavec*(beta1vec-buw)^2)/sigsq
>       ep<-ep+sum(wcpdf*pf(fcrit,df1,df,lamvec,lower.tail=FALSE))
>     }
>     kbpower<-ep/repn
>   }
>   kbpower<-kbpowerf()
>   return(list(sample_size=nvec,attained_power=kbpower))
> }
> 
> Can you please advise,

There is no "rvec" anywhere in the code that you provided, so the error
is coming from somewhere else.

I ran your code and got:

> $sample_size
> [1] 25 10 15
> 
> $attained_power
> [1] 0.8404461

No error.

Perhaps try running your code in a "clean" workspace.

cheers,

Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From m|@ojpm @end|ng |rom gm@||@com  Tue Apr 20 03:28:13 2021
From: m|@ojpm @end|ng |rom gm@||@com (John)
Date: Tue, 20 Apr 2021 09:28:13 +0800
Subject: [R] The program can't stop when searches over all files under
 folders and subfolders
Message-ID: <CABcx46DZEAtvhn6sVUan0+No34EOy4Y7vks_fk4OOCYNpAaicQ@mail.gmail.com>

Hi,

  I tried to convert all wma file to mp3 by av library and then I delete
the wma file. Even after all files are converted to mp3, the program is
still running. Is there anything wrong in this program?


################
library(av)

all_files <- list.files(path = ".", pattern = '*.wma', all.files = FALSE,
           full.names = FALSE, recursive = TRUE,
           ignore.case = FALSE, include.dirs = FALSE, no.. = FALSE)

for(i in all_files)
{
  av_audio_convert(
    audio = i,
    output = gsub(".wma", ".mp3", i),
    format = NULL,
    channels = NULL,
    sample_rate = NULL,
    start_time = NULL,
    total_time = NULL,
    verbose = TRUE
  )
  file.remove(i)
}

	[[alternative HTML version deleted]]


From @v|gro@@ @end|ng |rom ver|zon@net  Tue Apr 20 03:46:56 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Mon, 19 Apr 2021 21:46:56 -0400
Subject: [R] 
 What is an alternative to expand.grid if create a long vector?
In-Reply-To: <de6a2a44-d297-3c92-513e-b3f6e91d47eb@sapo.pt>
References: <CA+bivFgnf4cC1sZzKv2fm9769PO2HRXX9NRyhh4NJNWDUTHqxA@mail.gmail.com>
 <de6a2a44-d297-3c92-513e-b3f6e91d47eb@sapo.pt>
Message-ID: <02ac01d73587$0bf79130$23e6b390$@verizon.net>

Just some thoughts I am considering about the issue of how to make giant objects in memory without making them giant or all in memory.

As stupid as this sounds, when things get really big, it can mean not only processing your data in smaller amounts but using other techniques than asking expand.grid to create all possible combinations in advance.

Some languages like python allow generators that yield one item at a time and are called until exhausted, which sounds more like your usage. A single function remains resident in memory and each time it is called it uses the resident values in a calculation and returns the next. That approach may not work well with the way expand.grid works.

So a less efficient way would be to write your own deeply nested loop that generates one set of ten or so variables each time through the deepest nested loop that you can use one at a time. Alternatively, you can use such a loop to write a line at a time in something like a .CSV format and later read N lines at a time from the file or even have multiple programs work in parallel by taking their own allocations after ignoring the lines not meant for them, or some other method.

Deeply nested loops in R tend to be slow, as I have found out, which is indeed why I switched to using pmap() on a data.frame made using expand.grid first. But if your needs are exorbitant and you have limited memory, ....

Can you squeeze some memory out of your design? Your data seems highly repetitive and if you really want to store something like this in a column:
	c(seq(0.001, 1, length.out = 100))

The size of that, for comparison, is:

object.size(seq(0.001, 1, length.out = 100))
848 bytes

So it is 8 bytes per number plus some overhead.

Then consider storing something like that another way. First, the c() wrapper around the above is redundant, albeit harmless. Why not store this:
	1L:100L

object.size(1L:100L)
448 bytes

So, four bytes per number plus some overhead.

That stores integers between 1 and 100 and in your case that means that later you can divide by a thousand or so to get the number you want each time but not store a full double-precision number.

And if you use factors, it may take less space. I note some of your other values pick different starting and ending points but in all cases you ask for 100 equally-spaced values to be calculated by seq() which is fine but you could simply record a factor with umpteen specific values as either doubles or integers and if expand.grid honors that, it would use less space in any final output.  My experiments (not shown here) suggest you can easily cut sizes in half and perhaps more with judicious usage.

Perhaps finding or writing a more efficient loop in a C or C++ function would allow a way to loop through all possibilities more efficiently and provide a function for it to call on each iteration. Depending on your need, that can do a calculation using local variables and perhaps add a line to an output file, or add another set of values to a vector or other data structure that gets returned at the end of processing.

One possibility to consider is using an on-line resource, perhaps paying a fee, that will run your R program for you in an environment with more allowed resources like memory:

 https://rstudio.cloud/

Some of the professional options allow 8 GB of memory and perhaps 4 CPU. You can, of course, configure your own machine to have more memory or perhaps allocate lots more swap space and allow your process to abuse it. 

There are many possible solutions but also consider if the sizes and amounts you are working on are realistic. I worked on a project a while ago where I generated a huge amount of instances with 500 iterations per instance and was asked to bump that up to 10,000 per instance (20 times as much) just to show the results were similar and that 500 had been enough. It ran for DAYS and luckily the rest of the project went back to more manageable numbers.

So, back to your scenario, I wonder if the regularity of your data would allow interesting games to be played. Imagine smaller combinations of say 10 levels each and for each row in the resulting data.frame, expand that out again so the number 2,3,4 (using just three for illustration) becomes (2:29, 3:39, 4:49) and is given to expand.grid to make a smaller local one-use expansion table to use. Your original giant problem is converted to making a modest table that for each row expands to a second modest table that is used and immediately discarded and replaced by a similar table. So for ten variables, instead of making 100^10 variations all at once, you might make 10^10 variations and iterate on rows of that and make another 10^10 size table and do your processing on each row of that and then remove that table and replace it till done. In theory, you can use that in additional stages and cut memory use sharply albeit perhaps increasing CPU usage substantially.
 


-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Rui Barradas	
Sent: Monday, April 19, 2021 12:02 PM
To: Shah Alam <dr.alamsolangi at gmail.com>; r-help mailing list <r-help at r-project.org>
Subject: Re: [R] What is an alternative to expand.grid if create a long vector?

Hello,

If you want to process the data by rows, then maybe you should consider a custom function that divides the problem in small chunks and process one chunk at a time.

But even so, at 8 bytes per double, 100^10 rows is

(100^10*8)/(1024^4)  # Tera bytes
#[1] 727595761

It will take you a very, very long time to process.

Revise the problem?

Hope this helps,

Rui Barradas

?s 13:35 de 19/04/21, Shah Alam escreveu:
> Dear All,
> 
> I would like to know that is there any problem in *expand.grid* 
> function or it is a limitation of this function.
> 
> I am trying to create a combination of elements using expand.grid function.
> 
> A <- expand.grid(
> c(seq(0.001, 0.1, length.out = 100)),
> c(seq(0.0001, 0.001, length.out = 100)), c(seq(0.38, 0.42, length.out 
> = 100)), c(seq(0.12, 0.18, length.out = 100)))
> 
> Four combinations work fine. However, If I increase the combinations 
> up to ten. The following error appears.
> 
>   A <- expand.grid(
> c(seq(0.001, 1, length.out = 100)),
> c(seq(0.0001, 0.001, length.out = 100)), c(seq(0.38, 0.42, length.out 
> = 100)), c(seq(0.12, 0.18, length.out = 100)), c(seq(0.01, 0.04, 
> length.out = 100)), c(seq(0.0001, 0.001, length.out = 100)), 
> c(seq(0.0001, 0.001, length.out = 100)), c(seq(0.001, 0.01, length.out 
> = 100)), c(seq(0.01, 0.3, length.out = 100))
> )
> 
> *Error in rep.int <http://rep.int>(rep.int <http://rep.int>(seq_len(nx),
> rep.int <http://rep.int>(rep.fac, nx)), orep) :   invalid 'times' value*
> 
> After reducing the length to 10. It produced a different type of error
> 
> A <- expand.grid(
> c(seq(0.001, 0.005, length.out = 10)), c(seq(0.0001, 0.0005, 
> length.out = 10)), c(seq(0.38, 0.42, length.out = 5)), c(seq(0.12, 
> 0.18, length.out = 7)), c(seq(0.01, 0.04, length.out = 5)), 
> c(seq(0.0001, 0.001, length.out = 10)), c(seq(0.0001, 0.001, 
> length.out = 10)), c(seq(0.001, 0.01, length.out = 10)), c(seq(0.1, 
> 0.8, length.out = 8))
> )
> 
> *Error: cannot allocate vector of size 1.0 Gb*
> 
> What is an alternative to expand.grid if create a long vector based on 
> 10 elements?
> 
> With kind regards,
> Shah Alam
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From drj|m|emon @end|ng |rom gm@||@com  Tue Apr 20 06:29:24 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Tue, 20 Apr 2021 14:29:24 +1000
Subject: [R] The program can't stop when searches over all files under
 folders and subfolders
In-Reply-To: <CABcx46DZEAtvhn6sVUan0+No34EOy4Y7vks_fk4OOCYNpAaicQ@mail.gmail.com>
References: <CABcx46DZEAtvhn6sVUan0+No34EOy4Y7vks_fk4OOCYNpAaicQ@mail.gmail.com>
Message-ID: <CA+8X3fVMVwdQijPj8_T5_PxEo_g8EDDOjNKassKCMj2QeR=3Fg@mail.gmail.com>

Hi John,
If the program is still running, I can only guess that the function is
not exiting properly. If this happened to me, I would run "top" in a
terminal window and see if that process number was actually doing
anything or had gone zombie.

Jim

On Tue, Apr 20, 2021 at 11:28 AM John <miaojpm at gmail.com> wrote:
>
> Hi,
>
>   I tried to convert all wma file to mp3 by av library and then I delete
> the wma file. Even after all files are converted to mp3, the program is
> still running. Is there anything wrong in this program?
>
>
> ################
> library(av)
>
> all_files <- list.files(path = ".", pattern = '*.wma', all.files = FALSE,
>            full.names = FALSE, recursive = TRUE,
>            ignore.case = FALSE, include.dirs = FALSE, no.. = FALSE)
>
> for(i in all_files)
> {
>   av_audio_convert(
>     audio = i,
>     output = gsub(".wma", ".mp3", i),
>     format = NULL,
>     channels = NULL,
>     sample_rate = NULL,
>     start_time = NULL,
>     total_time = NULL,
>     verbose = TRUE
>   )
>   file.remove(i)
> }
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Tue Apr 20 07:43:57 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Tue, 20 Apr 2021 06:43:57 +0100
Subject: [R] The program can't stop when searches over all files under
 folders and subfolders
In-Reply-To: <CA+8X3fVMVwdQijPj8_T5_PxEo_g8EDDOjNKassKCMj2QeR=3Fg@mail.gmail.com>
References: <CABcx46DZEAtvhn6sVUan0+No34EOy4Y7vks_fk4OOCYNpAaicQ@mail.gmail.com>
 <CA+8X3fVMVwdQijPj8_T5_PxEo_g8EDDOjNKassKCMj2QeR=3Fg@mail.gmail.com>
Message-ID: <c5e9d8bb-9dbf-cdb4-2250-f4a28b76787e@sapo.pt>

Hello,

The following will probably not solve the problem but I would

1. use pattern = "\\.wma$" in list.files;
2. use sub, not gsub, in

sub("\\.wma$", ".mp3", i)


Hope this helps,

Rui Barradas

?s 05:29 de 20/04/21, Jim Lemon escreveu:
> Hi John,
> If the program is still running, I can only guess that the function is
> not exiting properly. If this happened to me, I would run "top" in a
> terminal window and see if that process number was actually doing
> anything or had gone zombie.
> 
> Jim
> 
> On Tue, Apr 20, 2021 at 11:28 AM John <miaojpm at gmail.com> wrote:
>>
>> Hi,
>>
>>    I tried to convert all wma file to mp3 by av library and then I delete
>> the wma file. Even after all files are converted to mp3, the program is
>> still running. Is there anything wrong in this program?
>>
>>
>> ################
>> library(av)
>>
>> all_files <- list.files(path = ".", pattern = '*.wma', all.files = FALSE,
>>             full.names = FALSE, recursive = TRUE,
>>             ignore.case = FALSE, include.dirs = FALSE, no.. = FALSE)
>>
>> for(i in all_files)
>> {
>>    av_audio_convert(
>>      audio = i,
>>      output = gsub(".wma", ".mp3", i),
>>      format = NULL,
>>      channels = NULL,
>>      sample_rate = NULL,
>>      start_time = NULL,
>>      total_time = NULL,
>>      verbose = TRUE
>>    )
>>    file.remove(i)
>> }
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From rhe|p @end|ng |rom eoo@@dd@@n|  Tue Apr 20 09:00:42 2021
From: rhe|p @end|ng |rom eoo@@dd@@n| (Jan van der Laan)
Date: Tue, 20 Apr 2021 09:00:42 +0200
Subject: [R] 
 What is an alternative to expand.grid if create a long vector?
In-Reply-To: <02ac01d73587$0bf79130$23e6b390$@verizon.net>
References: <CA+bivFgnf4cC1sZzKv2fm9769PO2HRXX9NRyhh4NJNWDUTHqxA@mail.gmail.com>
 <de6a2a44-d297-3c92-513e-b3f6e91d47eb@sapo.pt>
 <02ac01d73587$0bf79130$23e6b390$@verizon.net>
Message-ID: <459ae5c5-eb33-624e-ed84-5cbc6fb65f36@eoos.dds.nl>


But even if you could have a generator that is superefficient and 
perform an calculation that is superfast the number of elements is 
ridiculously large.

If we take 1 nanosec per element; the computation would still take:

 > (100^10)*1E-9/3600
[1] 27777778

hours, or

 > (100^10)*1E-9/3600/24/365
[1] 3170.979

years.

--
Jan








On 20-04-2021 03:46, Avi Gross via R-help wrote:
> Just some thoughts I am considering about the issue of how to make giant objects in memory without making them giant or all in memory.
> 
> As stupid as this sounds, when things get really big, it can mean not only processing your data in smaller amounts but using other techniques than asking expand.grid to create all possible combinations in advance.
> 
> Some languages like python allow generators that yield one item at a time and are called until exhausted, which sounds more like your usage. A single function remains resident in memory and each time it is called it uses the resident values in a calculation and returns the next. That approach may not work well with the way expand.grid works.
> 
> So a less efficient way would be to write your own deeply nested loop that generates one set of ten or so variables each time through the deepest nested loop that you can use one at a time. Alternatively, you can use such a loop to write a line at a time in something like a .CSV format and later read N lines at a time from the file or even have multiple programs work in parallel by taking their own allocations after ignoring the lines not meant for them, or some other method.
> 
> Deeply nested loops in R tend to be slow, as I have found out, which is indeed why I switched to using pmap() on a data.frame made using expand.grid first. But if your needs are exorbitant and you have limited memory, ....
> 
> Can you squeeze some memory out of your design? Your data seems highly repetitive and if you really want to store something like this in a column:
> 	c(seq(0.001, 1, length.out = 100))
> 
> The size of that, for comparison, is:
> 
> object.size(seq(0.001, 1, length.out = 100))
> 848 bytes
> 
> So it is 8 bytes per number plus some overhead.
> 
> Then consider storing something like that another way. First, the c() wrapper around the above is redundant, albeit harmless. Why not store this:
> 	1L:100L
> 
> object.size(1L:100L)
> 448 bytes
> 
> So, four bytes per number plus some overhead.
> 
> That stores integers between 1 and 100 and in your case that means that later you can divide by a thousand or so to get the number you want each time but not store a full double-precision number.
> 
> And if you use factors, it may take less space. I note some of your other values pick different starting and ending points but in all cases you ask for 100 equally-spaced values to be calculated by seq() which is fine but you could simply record a factor with umpteen specific values as either doubles or integers and if expand.grid honors that, it would use less space in any final output.  My experiments (not shown here) suggest you can easily cut sizes in half and perhaps more with judicious usage.
> 
> Perhaps finding or writing a more efficient loop in a C or C++ function would allow a way to loop through all possibilities more efficiently and provide a function for it to call on each iteration. Depending on your need, that can do a calculation using local variables and perhaps add a line to an output file, or add another set of values to a vector or other data structure that gets returned at the end of processing.
> 
> One possibility to consider is using an on-line resource, perhaps paying a fee, that will run your R program for you in an environment with more allowed resources like memory:
> 
>   https://rstudio.cloud/
> 
> Some of the professional options allow 8 GB of memory and perhaps 4 CPU. You can, of course, configure your own machine to have more memory or perhaps allocate lots more swap space and allow your process to abuse it.
> 
> There are many possible solutions but also consider if the sizes and amounts you are working on are realistic. I worked on a project a while ago where I generated a huge amount of instances with 500 iterations per instance and was asked to bump that up to 10,000 per instance (20 times as much) just to show the results were similar and that 500 had been enough. It ran for DAYS and luckily the rest of the project went back to more manageable numbers.
> 
> So, back to your scenario, I wonder if the regularity of your data would allow interesting games to be played. Imagine smaller combinations of say 10 levels each and for each row in the resulting data.frame, expand that out again so the number 2,3,4 (using just three for illustration) becomes (2:29, 3:39, 4:49) and is given to expand.grid to make a smaller local one-use expansion table to use. Your original giant problem is converted to making a modest table that for each row expands to a second modest table that is used and immediately discarded and replaced by a similar table. So for ten variables, instead of making 100^10 variations all at once, you might make 10^10 variations and iterate on rows of that and make another 10^10 size table and do your processing on each row of that and then remove that table and replace it till done. In theory, you can use that in additional stages and cut memory use sharply albeit perhaps increasing CPU usage substantially.
>   
> 
> 
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Rui Barradas	
> Sent: Monday, April 19, 2021 12:02 PM
> To: Shah Alam <dr.alamsolangi at gmail.com>; r-help mailing list <r-help at r-project.org>
> Subject: Re: [R] What is an alternative to expand.grid if create a long vector?
> 
> Hello,
> 
> If you want to process the data by rows, then maybe you should consider a custom function that divides the problem in small chunks and process one chunk at a time.
> 
> But even so, at 8 bytes per double, 100^10 rows is
> 
> (100^10*8)/(1024^4)  # Tera bytes
> #[1] 727595761
> 
> It will take you a very, very long time to process.
> 
> Revise the problem?
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 13:35 de 19/04/21, Shah Alam escreveu:
>> Dear All,
>>
>> I would like to know that is there any problem in *expand.grid*
>> function or it is a limitation of this function.
>>
>> I am trying to create a combination of elements using expand.grid function.
>>
>> A <- expand.grid(
>> c(seq(0.001, 0.1, length.out = 100)),
>> c(seq(0.0001, 0.001, length.out = 100)), c(seq(0.38, 0.42, length.out
>> = 100)), c(seq(0.12, 0.18, length.out = 100)))
>>
>> Four combinations work fine. However, If I increase the combinations
>> up to ten. The following error appears.
>>
>>    A <- expand.grid(
>> c(seq(0.001, 1, length.out = 100)),
>> c(seq(0.0001, 0.001, length.out = 100)), c(seq(0.38, 0.42, length.out
>> = 100)), c(seq(0.12, 0.18, length.out = 100)), c(seq(0.01, 0.04,
>> length.out = 100)), c(seq(0.0001, 0.001, length.out = 100)),
>> c(seq(0.0001, 0.001, length.out = 100)), c(seq(0.001, 0.01, length.out
>> = 100)), c(seq(0.01, 0.3, length.out = 100))
>> )
>>
>> *Error in rep.int <http://rep.int>(rep.int <http://rep.int>(seq_len(nx),
>> rep.int <http://rep.int>(rep.fac, nx)), orep) :   invalid 'times' value*
>>
>> After reducing the length to 10. It produced a different type of error
>>
>> A <- expand.grid(
>> c(seq(0.001, 0.005, length.out = 10)), c(seq(0.0001, 0.0005,
>> length.out = 10)), c(seq(0.38, 0.42, length.out = 5)), c(seq(0.12,
>> 0.18, length.out = 7)), c(seq(0.01, 0.04, length.out = 5)),
>> c(seq(0.0001, 0.001, length.out = 10)), c(seq(0.0001, 0.001,
>> length.out = 10)), c(seq(0.001, 0.01, length.out = 10)), c(seq(0.1,
>> 0.8, length.out = 8))
>> )
>>
>> *Error: cannot allocate vector of size 1.0 Gb*
>>
>> What is an alternative to expand.grid if create a long vector based on
>> 10 elements?
>>
>> With kind regards,
>> Shah Alam
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From petr@p|k@| @end|ng |rom prechez@@cz  Tue Apr 20 09:02:56 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Tue, 20 Apr 2021 07:02:56 +0000
Subject: [R] 
 What is an alternative to expand.grid if create a long vector?
In-Reply-To: <CA+bivFjYFxjTkMOM5t=ufW0+t47H2qXtm1H_F2bBu9GFqo+sYA@mail.gmail.com>
References: <CA+bivFgnf4cC1sZzKv2fm9769PO2HRXX9NRyhh4NJNWDUTHqxA@mail.gmail.com>
 <cee8264b02674750a9bb95b86a9e08fc@SRVEXCHCM1302.precheza.cz>
 <CA+bivFjYFxjTkMOM5t=ufW0+t47H2qXtm1H_F2bBu9GFqo+sYA@mail.gmail.com>
Message-ID: <83ea8abe215b4462aebe9bfe500e3675@SRVEXCHCM1302.precheza.cz>

Hi



Keep your mails on the list. Actually you did not say much about your data and 
the way how do you want to model them. There are plenty of modelling functions 
in R starting with e.g. lm but I am not aware of a procedure in which you just 
design your explanatory variables to set plausible model. But I am not expert 
in statistics and this list is not ment for solving statistical problems.



Cheers

Petr





From: Shah Alam <dr.alamsolangi at gmail.com>
Sent: Monday, April 19, 2021 5:20 PM
To: PIKAL Petr <petr.pikal at precheza.cz>
Subject: Re: [R] What is an alternative to expand.grid if create a long 
vector?



Dear Petr,



Thanks for your response. I am designing a model with 10 unknown parameters. 
generating the combination of unknown parameters will be used in the model to 
estimate the set of vectors that fits well to actual data. Is there any other 
was to do it? I also used randomLHS function from lhs package. But, it did not 
serve the purpose.



Best regards,

Shah Alam





On Mon, 19 Apr 2021 at 16:07, PIKAL Petr <petr.pikal at precheza.cz 
<mailto:petr.pikal at precheza.cz> > wrote:

Hi

Actually expand.grid produces data frame and not vector. And dimension of
the data frame is "big"

> dim(A)
[1] 100000000         4
> str(A)
'data.frame':   100000000 obs. of  4 variables:
 $ Var1: num  0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008 0.009 0.01 ...
 $ Var2: num  1e-04 1e-04 1e-04 1e-04 1e-04 1e-04 1e-04 1e-04 1e-04 1e-04
...
 $ Var3: num  0.38 0.38 0.38 0.38 0.38 0.38 0.38 0.38 0.38 0.38 ...
 $ Var4: num  0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 ...
 - attr(*, "out.attrs")=List of 2
  ..$ dim     : int [1:4] 100 100 100 100
  ..$ dimnames:List of 4
  .. ..$ Var1: chr [1:100] "Var1=0.001" "Var1=0.002" "Var1=0.003"
"Var1=0.004" ...
  .. ..$ Var2: chr [1:100] "Var2=0.0001000000" "Var2=0.0001090909"
"Var2=0.0001181818" "Var2=0.0001272727" ...
  .. ..$ Var3: chr [1:100] "Var3=0.3800000" "Var3=0.3804040"
"Var3=0.3808081" "Var3=0.3812121" ...
  .. ..$ Var4: chr [1:100] "Var4=0.1200000" "Var4=0.1206061"
"Var4=0.1212121" "Var4=0.1218182" ...
>

in case of 4 sequences 1e8 rows, 4 columns
in case of 10 sequences 1e20 rows and 10 columns
in your last example 1.4e8 rows and 10 columns which probably cross the
memory capacity of your PC.

Maybe you could increase memory of you PC. If I am correct to store the
first you need about 3.2GB, to strore the last 11.2 GB.

May I ask what you want to do with such a big object?

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org 
> <mailto:r-help-bounces at r-project.org> > On Behalf Of Shah Alam
> Sent: Monday, April 19, 2021 2:36 PM
> To: r-help mailing list <r-help at r-project.org <mailto:r-help at r-project.org> 
>  >
> Subject: [R] What is an alternative to expand.grid if create a long
vector?
>
> Dear All,
>
> I would like to know that is there any problem in *expand.grid* function
or it
> is a limitation of this function.
>
> I am trying to create a combination of elements using expand.grid
function.
>
> A <- expand.grid(
> c(seq(0.001, 0.1, length.out = 100)),
> c(seq(0.0001, 0.001, length.out = 100)), c(seq(0.38, 0.42, length.out =
100)),
> c(seq(0.12, 0.18, length.out = 100)))
>
> Four combinations work fine. However, If I increase the combinations up to
> ten. The following error appears.
>
>  A <- expand.grid(
> c(seq(0.001, 1, length.out = 100)),
> c(seq(0.0001, 0.001, length.out = 100)), c(seq(0.38, 0.42, length.out =
100)),
> c(seq(0.12, 0.18, length.out = 100)), c(seq(0.01, 0.04, length.out =
100)),
> c(seq(0.0001, 0.001, length.out = 100)), c(seq(0.0001, 0.001, length.out =
> 100)), c(seq(0.001, 0.01, length.out = 100)), c(seq(0.01, 0.3, length.out
= 100))
> )
>
> *Error in rep.int <http://rep.int>  <http://rep.int>(rep.int 
> <http://rep.int>  <http://rep.int>(seq_len(nx),
> rep.int <http://rep.int>  <http://rep.int>(rep.fac, nx)), orep) :   invalid 
> 'times' value*
>
> After reducing the length to 10. It produced a different type of error
>
> A <- expand.grid(
> c(seq(0.001, 0.005, length.out = 10)),
> c(seq(0.0001, 0.0005, length.out = 10)), c(seq(0.38, 0.42, length.out =
5)),
> c(seq(0.12, 0.18, length.out = 7)), c(seq(0.01, 0.04, length.out = 5)),
> c(seq(0.0001, 0.001, length.out = 10)), c(seq(0.0001, 0.001, length.out =
10)),
> c(seq(0.001, 0.01, length.out = 10)), c(seq(0.1, 0.8, length.out = 8))
> )
>
> *Error: cannot allocate vector of size 1.0 Gb*
>
> What is an alternative to expand.grid if create a long vector based on 10
> elements?
>
> With kind regards,
> Shah Alam
>
>       [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org <mailto:R-help at r-project.org>  mailing list -- To 
> UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.


From rhe|p @end|ng |rom eoo@@dd@@n|  Tue Apr 20 09:42:33 2021
From: rhe|p @end|ng |rom eoo@@dd@@n| (Jan van der Laan)
Date: Tue, 20 Apr 2021 09:42:33 +0200
Subject: [R] 
 What is an alternative to expand.grid if create a long vector?
In-Reply-To: <83ea8abe215b4462aebe9bfe500e3675@SRVEXCHCM1302.precheza.cz>
References: <CA+bivFgnf4cC1sZzKv2fm9769PO2HRXX9NRyhh4NJNWDUTHqxA@mail.gmail.com>
 <cee8264b02674750a9bb95b86a9e08fc@SRVEXCHCM1302.precheza.cz>
 <CA+bivFjYFxjTkMOM5t=ufW0+t47H2qXtm1H_F2bBu9GFqo+sYA@mail.gmail.com>
 <83ea8abe215b4462aebe9bfe500e3675@SRVEXCHCM1302.precheza.cz>
Message-ID: <8d09c82b-bcbe-c4db-ba58-94e8210035ec@eoos.dds.nl>


This is an optimisation problem that you are trying to solve using a 
grid search. There are numerous methods for optimisation, see 
https://cran.r-project.org/web/views/Optimization.html for and overview 
for R. It really depends on the exact problem what method is appropriate.

As Petr said helping you decide which method to use does not fit on this 
list. Perhaps de overview linked to above (and the terms 'grid search' 
and 'optimization') can help you find an appropriate method.

HTH,
Jan


On 20-04-2021 09:02, PIKAL Petr wrote:
> Hi
> 
> 
> 
> Keep your mails on the list. Actually you did not say much about your data and
> the way how do you want to model them. There are plenty of modelling functions
> in R starting with e.g. lm but I am not aware of a procedure in which you just
> design your explanatory variables to set plausible model. But I am not expert
> in statistics and this list is not ment for solving statistical problems.
> 
> 
> 
> Cheers
> 
> Petr
> 
> 
> 
> 
> 
> From: Shah Alam <dr.alamsolangi at gmail.com>
> Sent: Monday, April 19, 2021 5:20 PM
> To: PIKAL Petr <petr.pikal at precheza.cz>
> Subject: Re: [R] What is an alternative to expand.grid if create a long
> vector?
> 
> 
> 
> Dear Petr,
> 
> 
> 
> Thanks for your response. I am designing a model with 10 unknown parameters.
> generating the combination of unknown parameters will be used in the model to
> estimate the set of vectors that fits well to actual data. Is there any other
> was to do it? I also used randomLHS function from lhs package. But, it did not
> serve the purpose.
> 
> 
> 
> Best regards,
> 
> Shah Alam
> 
> 
> 
> 
> 
> On Mon, 19 Apr 2021 at 16:07, PIKAL Petr <petr.pikal at precheza.cz
> <mailto:petr.pikal at precheza.cz> > wrote:
> 
> Hi
> 
> Actually expand.grid produces data frame and not vector. And dimension of
> the data frame is "big"
> 
>> dim(A)
> [1] 100000000         4
>> str(A)
> 'data.frame':   100000000 obs. of  4 variables:
>   $ Var1: num  0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008 0.009 0.01 ...
>   $ Var2: num  1e-04 1e-04 1e-04 1e-04 1e-04 1e-04 1e-04 1e-04 1e-04 1e-04
> ...
>   $ Var3: num  0.38 0.38 0.38 0.38 0.38 0.38 0.38 0.38 0.38 0.38 ...
>   $ Var4: num  0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 ...
>   - attr(*, "out.attrs")=List of 2
>    ..$ dim     : int [1:4] 100 100 100 100
>    ..$ dimnames:List of 4
>    .. ..$ Var1: chr [1:100] "Var1=0.001" "Var1=0.002" "Var1=0.003"
> "Var1=0.004" ...
>    .. ..$ Var2: chr [1:100] "Var2=0.0001000000" "Var2=0.0001090909"
> "Var2=0.0001181818" "Var2=0.0001272727" ...
>    .. ..$ Var3: chr [1:100] "Var3=0.3800000" "Var3=0.3804040"
> "Var3=0.3808081" "Var3=0.3812121" ...
>    .. ..$ Var4: chr [1:100] "Var4=0.1200000" "Var4=0.1206061"
> "Var4=0.1212121" "Var4=0.1218182" ...
>>
> 
> in case of 4 sequences 1e8 rows, 4 columns
> in case of 10 sequences 1e20 rows and 10 columns
> in your last example 1.4e8 rows and 10 columns which probably cross the
> memory capacity of your PC.
> 
> Maybe you could increase memory of you PC. If I am correct to store the
> first you need about 3.2GB, to strore the last 11.2 GB.
> 
> May I ask what you want to do with such a big object?
> 
> Cheers
> Petr
> 
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org
>> <mailto:r-help-bounces at r-project.org> > On Behalf Of Shah Alam
>> Sent: Monday, April 19, 2021 2:36 PM
>> To: r-help mailing list <r-help at r-project.org <mailto:r-help at r-project.org>
>>   >
>> Subject: [R] What is an alternative to expand.grid if create a long
> vector?
>>
>> Dear All,
>>
>> I would like to know that is there any problem in *expand.grid* function
> or it
>> is a limitation of this function.
>>
>> I am trying to create a combination of elements using expand.grid
> function.
>>
>> A <- expand.grid(
>> c(seq(0.001, 0.1, length.out = 100)),
>> c(seq(0.0001, 0.001, length.out = 100)), c(seq(0.38, 0.42, length.out =
> 100)),
>> c(seq(0.12, 0.18, length.out = 100)))
>>
>> Four combinations work fine. However, If I increase the combinations up to
>> ten. The following error appears.
>>
>>   A <- expand.grid(
>> c(seq(0.001, 1, length.out = 100)),
>> c(seq(0.0001, 0.001, length.out = 100)), c(seq(0.38, 0.42, length.out =
> 100)),
>> c(seq(0.12, 0.18, length.out = 100)), c(seq(0.01, 0.04, length.out =
> 100)),
>> c(seq(0.0001, 0.001, length.out = 100)), c(seq(0.0001, 0.001, length.out =
>> 100)), c(seq(0.001, 0.01, length.out = 100)), c(seq(0.01, 0.3, length.out
> = 100))
>> )
>>
>> *Error in rep.int <http://rep.int>  <http://rep.int>(rep.int
>> <http://rep.int>  <http://rep.int>(seq_len(nx),
>> rep.int <http://rep.int>  <http://rep.int>(rep.fac, nx)), orep) :   invalid
>> 'times' value*
>>
>> After reducing the length to 10. It produced a different type of error
>>
>> A <- expand.grid(
>> c(seq(0.001, 0.005, length.out = 10)),
>> c(seq(0.0001, 0.0005, length.out = 10)), c(seq(0.38, 0.42, length.out =
> 5)),
>> c(seq(0.12, 0.18, length.out = 7)), c(seq(0.01, 0.04, length.out = 5)),
>> c(seq(0.0001, 0.001, length.out = 10)), c(seq(0.0001, 0.001, length.out =
> 10)),
>> c(seq(0.001, 0.01, length.out = 10)), c(seq(0.1, 0.8, length.out = 8))
>> )
>>
>> *Error: cannot allocate vector of size 1.0 Gb*
>>
>> What is an alternative to expand.grid if create a long vector based on 10
>> elements?
>>
>> With kind regards,
>> Shah Alam
>>
>>        [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org <mailto:R-help at r-project.org>  mailing list -- To
>> UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-
>> guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From m|ch@e|@w||||@m@on @end|ng |rom kc|@@c@uk  Tue Apr 20 11:18:04 2021
From: m|ch@e|@w||||@m@on @end|ng |rom kc|@@c@uk (Williamson, Michael)
Date: Tue, 20 Apr 2021 09:18:04 +0000
Subject: [R] mgcv: bam warning messages and non-convergence
Message-ID: <7C67C7A2-60E9-48E3-98A7-C5F664A2A014@kcl.ac.uk>

I have a large dataset of 118225 observations from 16 columns and as such I?ve been using bam, rather than gam, for my analyses.

The response variable I?m using is count data but it?s overdispersed, and as such, I thought I?d use a negative binomial model. I have 5 explanatory variables, which are biologically important. Two are numerical and 3 are categorical. I?ve only applied a smoother to the first numerical explanatory variable, because, from some prior analyses I found that TL had edf values of 1.01 and was therefore linear. I also have included categorical two random effects in the model.

m3 <- bam(deg ~ s(SE_score) + TL + species + sex + season + year +
            s(code, bs = 're') + s(monthyear, bs = 're'),
          family=nb(), data=node_dat, method = "REML")

th <- m3$family$getTheta(TRUE) #extracts theta

m3 <- bam(deg ~ s(SE_score) + TL + species + sex + season + year +
            s(code, bs = 're') + s(monthyear, bs = 're'),
          family=nb(th), data=node_dat, method = "REML")

summary(m3)

However I?m getting this warning and I can?t find out what it means

There were 32 warnings (use warnings() to see them)
> warnings()
Warning messages:
1: In pmax(1, y)/mu :
  longer object length is not a multiple of shorter object length
2: In y * log(pmax(1, y)/mu) :
  longer object length is not a multiple of shorter object length

Is this an issue? The model converges, and I?ve checked overdispersion again and get this value

> E3 <- resid(m3, type = "pearson")
> sum(E3^2)/m3$df.res
[1] 0.7436045

So this suggests there is some under dispersion now? Also the model summary gives

> summary(m3)

Family: Negative Binomial(0.055)
Link function: log

I?ve read that the 0.055 is also a measure of dispersion so which one is correct?

I was confused about all this and I have a lot of zeros in my data (about 96%) so I thought I?d also try an zero inflated poisson, however is does not converge.

m4 <- bam(deg ~ s(SE_score) + TL + species + sex + season + year +
                  s(code, bs = 're') + s(monthyear, bs = 're'),
                family=ziP(), data=node_dat, method = "REML")

Warning message:
In bgam.fit(G, mf, chunk.size, gp, scale, gamma, method = method,  :
  algorithm did not converge

Is there any reason why it does not onverge? And maybe a zero inflated negative binomial would better but I?m not sure how to undertake that.

I know there?s a lot here but any help would be appreciated.

Many thanks,

Mike



Michael Williamson
London NERC DTP Candidate

Email: michael.williamson at kcl.ac.uk<mailto:michael.williamson at kcl.ac.uk> Phone: +447764836592 Skype: mikejwilliamson Twitter: @mjw_marine Website: www.thenetlab.uk<https://eur03.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.thenetlab.uk%2F&data=01%7C01%7Cmichael.williamson%40kcl.ac.uk%7C07c592826b364b249c9208d84e5dbc12%7C8370cf1416f34c16b83c724071654356%7C0&sdata=vaibGznfTGGiS7l0lHuRaQ3w4fnEQGaXIfgQ34OrhG4%3D&reserved=0>

Most recent paper:
Williamson, M. J. et al. (2021). Analysing detection gaps in acoustic telemetry data to infer differential movement patterns in fish. Ecology and Evolution, 11, 2717-2730. https://doi.org/10.1002/ece3.7226




	[[alternative HTML version deleted]]


From tr|ng @end|ng |rom gvdnet@dk  Tue Apr 20 18:05:40 2021
From: tr|ng @end|ng |rom gvdnet@dk (Troels Ring)
Date: Tue, 20 Apr 2021 18:05:40 +0200
Subject: [R] problems in knitting to html
Message-ID: <3ff653af-e771-286c-c4d9-dc4a75717020@gvdnet.dk>

Dear friends - newly installed windows 10 and R version 4.0.5 
(2021-03-31) -- "Shake and Throw" and newest version of RStudio I tend 
to get an error when knitting to html.

The message I get is ("applications-of-charge-balance-160421.rmd" is my 
file name)

/output file: applications-of-charge-balance-160421.knit.md//
/

/then (in my translated Danish) //
/

/Error in file(con,?? "w") : cannot open connection/

/call: <Anonymous> ... extract_preserve_chunks -> write_utf8 -> 
writeLines -> file//
/

/In file(con, "w") ://
//? cannot open file 'applications-of-charge-balance-160421.utf8.md': 
Invalid argument//
//run aborted/

But when I then simply try again it works well with no troubles.

I wonder what error I have done?

All best wishes

Troels Ring,
Aalborg, Denmark



	[[alternative HTML version deleted]]


From x|e @end|ng |rom y|hu|@n@me  Tue Apr 20 18:08:38 2021
From: x|e @end|ng |rom y|hu|@n@me (Yihui Xie)
Date: Tue, 20 Apr 2021 11:08:38 -0500
Subject: [R] problems in knitting to html
In-Reply-To: <3ff653af-e771-286c-c4d9-dc4a75717020@gvdnet.dk>
References: <3ff653af-e771-286c-c4d9-dc4a75717020@gvdnet.dk>
Message-ID: <CANROs4f_ZPdH_v05Cv+Hy+Gk0T4e0mZSVvU46wiVg1X-B8K7Dw@mail.gmail.com>

Could you provide a minimal reproducible example along with your
xfun::session_info('rmarkdown')? Thanks!

Regards,
Yihui
--
https://yihui.org

On Tue, Apr 20, 2021 at 11:06 AM Troels Ring <tring at gvdnet.dk> wrote:
>
> Dear friends - newly installed windows 10 and R version 4.0.5
> (2021-03-31) -- "Shake and Throw" and newest version of RStudio I tend
> to get an error when knitting to html.
>
> The message I get is ("applications-of-charge-balance-160421.rmd" is my
> file name)
>
> /output file: applications-of-charge-balance-160421.knit.md//
> /
>
> /then (in my translated Danish) //
> /
>
> /Error in file(con,   "w") : cannot open connection/
>
> /call: <Anonymous> ... extract_preserve_chunks -> write_utf8 ->
> writeLines -> file//
> /
>
> /In file(con, "w") ://
> //  cannot open file 'applications-of-charge-balance-160421.utf8.md':
> Invalid argument//
> //run aborted/
>
> But when I then simply try again it works well with no troubles.
>
> I wonder what error I have done?
>
> All best wishes
>
> Troels Ring,
> Aalborg, Denmark
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From tr|ng @end|ng |rom gvdnet@dk  Tue Apr 20 18:42:50 2021
From: tr|ng @end|ng |rom gvdnet@dk (Troels Ring)
Date: Tue, 20 Apr 2021 18:42:50 +0200
Subject: [R] problems in knitting to html
In-Reply-To: <3ff653af-e771-286c-c4d9-dc4a75717020@gvdnet.dk>
References: <3ff653af-e771-286c-c4d9-dc4a75717020@gvdnet.dk>
Message-ID: <249caa29-ae60-93bb-5215-c50a73b2cc5b@gvdnet.dk>

Thanks a lot - the error is not constant so I? have not tried a minimal 
example yet but? the info is below, thanks a lot

Troels

xfun::session_info('rmarkdown') R version 4.0.5 (2021-03-31) Platform: 
x86_64-w64-mingw32/x64 (64-bit) Running under: Windows 10 x64 (build 
19042), RStudio 1.4.1106 Locale: LC_COLLATE=Danish_Denmark.1252 
LC_CTYPE=Danish_Denmark.1252 LC_MONETARY=Danish_Denmark.1252 
LC_NUMERIC=C LC_TIME=Danish_Denmark.1252 Package version: 
base64enc_0.1.3 digest_0.6.27 evaluate_0.14 glue_1.4.2 graphics_4.0.5 
grDevices_4.0.5 highr_0.8 htmltools_0.5.1.1 jsonlite_1.7.2 knitr_1.31 
magrittr_2.0.1 markdown_1.1 methods_4.0.5 mime_0.10 rlang_0.4.10 
rmarkdown_2.7 stats_4.0.5 stringi_1.5.3 stringr_1.4.0 tinytex_0.31 
tools_4.0.5 utils_4.0.5 xfun_0.22 yaml_2.2.1 Pandoc version: 2.11.4


Den 20-04-2021 kl. 18:08 skrev Yihui Xie:
> Could you provide a minimal reproducible example along with your
> xfun::session_info('rmarkdown')? Thanks!
>
> Regards,
> Yihui
> --
> https://yihui.org
>
> On Tue, Apr 20, 2021 at 11:06 AM Troels Ring <tring at gvdnet.dk> wrote:
>> Dear friends - newly installed windows 10 and R version 4.0.5
>> (2021-03-31) -- "Shake and Throw" and newest version of RStudio I tend
>> to get an error when knitting to html.
>>
>> The message I get is ("applications-of-charge-balance-160421.rmd" is my
>> file name)
>>
>> /output file: applications-of-charge-balance-160421.knit.md//
>> /
>>
>> /then (in my translated Danish) //
>> /
>>
>> /Error in file(con,   "w") : cannot open connection/
>>
>> /call: <Anonymous> ... extract_preserve_chunks -> write_utf8 ->
>> writeLines -> file//
>> /
>>
>> /In file(con, "w") ://
>> //  cannot open file 'applications-of-charge-balance-160421.utf8.md':
>> Invalid argument//
>> //run aborted/
>>
>> But when I then simply try again it works well with no troubles.
>>
>> I wonder what error I have done?
>>
>> All best wishes
>>
>> Troels Ring,
>> Aalborg, Denmark
>>
>>
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Tue Apr 20 19:32:27 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Tue, 20 Apr 2021 10:32:27 -0700
Subject: [R] problems in knitting to html
In-Reply-To: <249caa29-ae60-93bb-5215-c50a73b2cc5b@gvdnet.dk>
References: <3ff653af-e771-286c-c4d9-dc4a75717020@gvdnet.dk>
 <249caa29-ae60-93bb-5215-c50a73b2cc5b@gvdnet.dk>
Message-ID: <6D954D90-7B2B-43D3-BFFA-FE6E369B11B3@dcn.davis.ca.us>

I would encourage you to make _any_ kind of example that _ever_ has had this problem when asking for help on an intermittent error.

Also, are you running this in a cloud-backed directory such as OneDrive or Dropbox? These kinds of software can acquire exclusive access to intermediate files in an attempt to back them up rapidly, which can lead to race conditions between knitr and that software. Anti-virus software can also create this kind of issue.

On April 20, 2021 9:42:50 AM PDT, Troels Ring <tring at gvdnet.dk> wrote:
>Thanks a lot - the error is not constant so I? have not tried a minimal
>
>example yet but? the info is below, thanks a lot
>
>Troels
>
>xfun::session_info('rmarkdown') R version 4.0.5 (2021-03-31) Platform: 
>x86_64-w64-mingw32/x64 (64-bit) Running under: Windows 10 x64 (build 
>19042), RStudio 1.4.1106 Locale: LC_COLLATE=Danish_Denmark.1252 
>LC_CTYPE=Danish_Denmark.1252 LC_MONETARY=Danish_Denmark.1252 
>LC_NUMERIC=C LC_TIME=Danish_Denmark.1252 Package version: 
>base64enc_0.1.3 digest_0.6.27 evaluate_0.14 glue_1.4.2 graphics_4.0.5 
>grDevices_4.0.5 highr_0.8 htmltools_0.5.1.1 jsonlite_1.7.2 knitr_1.31 
>magrittr_2.0.1 markdown_1.1 methods_4.0.5 mime_0.10 rlang_0.4.10 
>rmarkdown_2.7 stats_4.0.5 stringi_1.5.3 stringr_1.4.0 tinytex_0.31 
>tools_4.0.5 utils_4.0.5 xfun_0.22 yaml_2.2.1 Pandoc version: 2.11.4
>
>
>Den 20-04-2021 kl. 18:08 skrev Yihui Xie:
>> Could you provide a minimal reproducible example along with your
>> xfun::session_info('rmarkdown')? Thanks!
>>
>> Regards,
>> Yihui
>> --
>> https://yihui.org
>>
>> On Tue, Apr 20, 2021 at 11:06 AM Troels Ring <tring at gvdnet.dk> wrote:
>>> Dear friends - newly installed windows 10 and R version 4.0.5
>>> (2021-03-31) -- "Shake and Throw" and newest version of RStudio I
>tend
>>> to get an error when knitting to html.
>>>
>>> The message I get is ("applications-of-charge-balance-160421.rmd" is
>my
>>> file name)
>>>
>>> /output file: applications-of-charge-balance-160421.knit.md//
>>> /
>>>
>>> /then (in my translated Danish) //
>>> /
>>>
>>> /Error in file(con,   "w") : cannot open connection/
>>>
>>> /call: <Anonymous> ... extract_preserve_chunks -> write_utf8 ->
>>> writeLines -> file//
>>> /
>>>
>>> /In file(con, "w") ://
>>> //  cannot open file
>'applications-of-charge-balance-160421.utf8.md':
>>> Invalid argument//
>>> //run aborted/
>>>
>>> But when I then simply try again it works well with no troubles.
>>>
>>> I wonder what error I have done?
>>>
>>> All best wishes
>>>
>>> Troels Ring,
>>> Aalborg, Denmark
>>>
>>>
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From x|e @end|ng |rom y|hu|@n@me  Tue Apr 20 19:48:40 2021
From: x|e @end|ng |rom y|hu|@n@me (Yihui Xie)
Date: Tue, 20 Apr 2021 12:48:40 -0500
Subject: [R] problems in knitting to html
In-Reply-To: <249caa29-ae60-93bb-5215-c50a73b2cc5b@gvdnet.dk>
References: <3ff653af-e771-286c-c4d9-dc4a75717020@gvdnet.dk>
 <249caa29-ae60-93bb-5215-c50a73b2cc5b@gvdnet.dk>
Message-ID: <CANROs4fpBJ-WgM4ptY1iJY+Kmpm2Q1y4goyJNNp2SV=VGy22=A@mail.gmail.com>

It's hard to tell what's going on without a reproducible example.
Perhaps it was because of ant-virus software or a network drive as
Jeff guessed.

The development version of rmarkdown
(https://github.com/rstudio/rmarkdown) will no longer generate the
intermediate *.utf8.md file. I'm not sure if that would help. You may
try remotes::install_github('rstudio/rmarkdown').

Regards,
Yihui
--
https://yihui.org

On Tue, Apr 20, 2021 at 11:42 AM Troels Ring <tring at gvdnet.dk> wrote:
>
> Thanks a lot - the error is not constant so I  have not tried a minimal example yet but  the info is below, thanks a lot
>
> Troels
>
> xfun::session_info('rmarkdown')
> R version 4.0.5 (2021-03-31)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 10 x64 (build 19042), RStudio 1.4.1106
>
> Locale:
>   LC_COLLATE=Danish_Denmark.1252  LC_CTYPE=Danish_Denmark.1252    LC_MONETARY=Danish_Denmark.1252
> LC_NUMERIC=C                    LC_TIME=Danish_Denmark.1252
>
> Package version:
>   base64enc_0.1.3   digest_0.6.27     evaluate_0.14     glue_1.4.2        graphics_4.0.5    grDevices_4.0.5
> highr_0.8         htmltools_0.5.1.1 jsonlite_1.7.2    knitr_1.31        magrittr_2.0.1    markdown_1.1
> methods_4.0.5     mime_0.10         rlang_0.4.10      rmarkdown_2.7     stats_4.0.5       stringi_1.5.3
> stringr_1.4.0     tinytex_0.31      tools_4.0.5       utils_4.0.5       xfun_0.22         yaml_2.2.1
>
> Pandoc version: 2.11.4
>
>
>
> Den 20-04-2021 kl. 18:08 skrev Yihui Xie:
>
> Could you provide a minimal reproducible example along with your
> xfun::session_info('rmarkdown')? Thanks!
>
> Regards,
> Yihui
> --
> https://yihui.org
>
> On Tue, Apr 20, 2021 at 11:06 AM Troels Ring <tring at gvdnet.dk> wrote:
>
> Dear friends - newly installed windows 10 and R version 4.0.5
> (2021-03-31) -- "Shake and Throw" and newest version of RStudio I tend
> to get an error when knitting to html.
>
> The message I get is ("applications-of-charge-balance-160421.rmd" is my
> file name)
>
> /output file: applications-of-charge-balance-160421.knit.md//
> /
>
> /then (in my translated Danish) //
> /
>
> /Error in file(con,   "w") : cannot open connection/
>
> /call: <Anonymous> ... extract_preserve_chunks -> write_utf8 ->
> writeLines -> file//
> /
>
> /In file(con, "w") ://
> //  cannot open file 'applications-of-charge-balance-160421.utf8.md':
> Invalid argument//
> //run aborted/
>
> But when I then simply try again it works well with no troubles.
>
> I wonder what error I have done?
>
> All best wishes
>
> Troels Ring,
> Aalborg, Denmark
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From tr|ng @end|ng |rom gvdnet@dk  Tue Apr 20 20:15:47 2021
From: tr|ng @end|ng |rom gvdnet@dk (Troels Ring)
Date: Tue, 20 Apr 2021 20:15:47 +0200
Subject: [R] problems in knitting to html
In-Reply-To: <249caa29-ae60-93bb-5215-c50a73b2cc5b@gvdnet.dk>
References: <3ff653af-e771-286c-c4d9-dc4a75717020@gvdnet.dk>
 <249caa29-ae60-93bb-5215-c50a73b2cc5b@gvdnet.dk>
Message-ID: <0c54ca39-219d-f20a-615c-738858f2dce5@gvdnet.dk>

Thanks a lot to Jeff and Yihui -? it seems that only fairly large rmd 
files have this problem, and yes, dropbox is running. So next time it 
happens I'll remove it out of dropbox to see what happens. Otherwise 
I'll try the development version, thanks Yihui!

BW

Troels


Den 20-04-2021 kl. 19:48 skrev Yihui Xie:
> It's hard to tell what's going on without a reproducible example.
> Perhaps it was because of ant-virus software or a network drive as
> Jeff guessed.
>
> The development version of rmarkdown
> (https://github.com/rstudio/rmarkdown) will no longer generate the
> intermediate *.utf8.md file. I'm not sure if that would help. You may
> try remotes::install_github('rstudio/rmarkdown').
>
> Regards,
> Yihui
> --
> https://yihui.org
>
> On Tue, Apr 20, 2021 at 11:42 AM Troels Ring <tring at gvdnet.dk> wrote:
>> Thanks a lot - the error is not constant so I  have not tried a minimal example yet but  the info is below, thanks a lot
>>
>> Troels
>>
>> xfun::session_info('rmarkdown')
>> R version 4.0.5 (2021-03-31)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> Running under: Windows 10 x64 (build 19042), RStudio 1.4.1106
>>
>> Locale:
>>    LC_COLLATE=Danish_Denmark.1252  LC_CTYPE=Danish_Denmark.1252    LC_MONETARY=Danish_Denmark.1252
>> LC_NUMERIC=C                    LC_TIME=Danish_Denmark.1252
>>
>> Package version:
>>    base64enc_0.1.3   digest_0.6.27     evaluate_0.14     glue_1.4.2        graphics_4.0.5    grDevices_4.0.5
>> highr_0.8         htmltools_0.5.1.1 jsonlite_1.7.2    knitr_1.31        magrittr_2.0.1    markdown_1.1
>> methods_4.0.5     mime_0.10         rlang_0.4.10      rmarkdown_2.7     stats_4.0.5       stringi_1.5.3
>> stringr_1.4.0     tinytex_0.31      tools_4.0.5       utils_4.0.5       xfun_0.22         yaml_2.2.1
>>
>> Pandoc version: 2.11.4
>>
>>
>>
>> Den 20-04-2021 kl. 18:08 skrev Yihui Xie:
>>
>> Could you provide a minimal reproducible example along with your
>> xfun::session_info('rmarkdown')? Thanks!
>>
>> Regards,
>> Yihui
>> --
>> https://yihui.org
>>
>> On Tue, Apr 20, 2021 at 11:06 AM Troels Ring <tring at gvdnet.dk> wrote:
>>
>> Dear friends - newly installed windows 10 and R version 4.0.5
>> (2021-03-31) -- "Shake and Throw" and newest version of RStudio I tend
>> to get an error when knitting to html.
>>
>> The message I get is ("applications-of-charge-balance-160421.rmd" is my
>> file name)
>>
>> /output file: applications-of-charge-balance-160421.knit.md//
>> /
>>
>> /then (in my translated Danish) //
>> /
>>
>> /Error in file(con,   "w") : cannot open connection/
>>
>> /call: <Anonymous> ... extract_preserve_chunks -> write_utf8 ->
>> writeLines -> file//
>> /
>>
>> /In file(con, "w") ://
>> //  cannot open file 'applications-of-charge-balance-160421.utf8.md':
>> Invalid argument//
>> //run aborted/
>>
>> But when I then simply try again it works well with no troubles.
>>
>> I wonder what error I have done?
>>
>> All best wishes
>>
>> Troels Ring,
>> Aalborg, Denmark
>>
>>
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From jj@me@on @end|ng |rom terpm@||@umd@edu  Tue Apr 20 18:32:52 2021
From: jj@me@on @end|ng |rom terpm@||@umd@edu (N. Jordan Jameson)
Date: Tue, 20 Apr 2021 12:32:52 -0400
Subject: [R] R versions > 4.0.2 fail to start in Windows 64-bit
Message-ID: <CANCw-JUW6nhjYfQ-et5r_JPB9i5hCxoEU460xQueuwMnyo18dg@mail.gmail.com>

I have a 64-bit Windows machine and I've installed R versions 4.0.0 through
4.0.5 and only versions 4.0.2 and below will successfully start. This
morning I installed 4.0.5, and when I start R, the R-gui starts for less
than a second and then disappears. I tried to open R using RStudio and I
got the following messages:

`The R session failed to start.` and ` The R session process exited with
code -1073740791`

The log for this error is:

```
ERROR system error 10053 (An established connection was aborted by the
software in your host machine) [request-uri: /events/get_events];

OCCURRED AT void __thiscall rstudio::session::HttpConnectionImpl<class
rstudio_boost::asio::ip::tcp>::sendResponse(const class
rstudio::core::http::Response &)
src/cpp/session/http/SessionWin32HttpConnectionListener.cpp:113;

LOGGED FROM: void __thiscall rstudio::session::HttpConnectionImpl<class
rstudio_boost::asio::ip::tcp>::sendResponse(const class
rstudio::core::http::Response &)
src/cpp/session/http/SessionWin32HttpConnectionListener.cpp:118
```
I'm not sure what is going on, but this same thing happens with R 4.0.3 and
R 4.0.4, but not with R 4.0.2. I would like to use the most recent version
of R if possible, but for now I am stuck with 4.0.2.

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed Apr 21 05:39:46 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Tue, 20 Apr 2021 20:39:46 -0700
Subject: [R] R versions > 4.0.2 fail to start in Windows 64-bit
In-Reply-To: <CANCw-JUW6nhjYfQ-et5r_JPB9i5hCxoEU460xQueuwMnyo18dg@mail.gmail.com>
References: <CANCw-JUW6nhjYfQ-et5r_JPB9i5hCxoEU460xQueuwMnyo18dg@mail.gmail.com>
Message-ID: <E66BCF90-3A33-4896-86F2-1D96E614DB2C@dcn.davis.ca.us>

Not a problem here. Generally this kind of thing happens when anti-virus software gets aggressive.

On April 20, 2021 9:32:52 AM PDT, "N. Jordan Jameson" <jjameson at terpmail.umd.edu> wrote:
>I have a 64-bit Windows machine and I've installed R versions 4.0.0
>through
>4.0.5 and only versions 4.0.2 and below will successfully start. This
>morning I installed 4.0.5, and when I start R, the R-gui starts for
>less
>than a second and then disappears. I tried to open R using RStudio and
>I
>got the following messages:
>
>`The R session failed to start.` and ` The R session process exited
>with
>code -1073740791`
>
>The log for this error is:
>
>```
>ERROR system error 10053 (An established connection was aborted by the
>software in your host machine) [request-uri: /events/get_events];
>
>OCCURRED AT void __thiscall rstudio::session::HttpConnectionImpl<class
>rstudio_boost::asio::ip::tcp>::sendResponse(const class
>rstudio::core::http::Response &)
>src/cpp/session/http/SessionWin32HttpConnectionListener.cpp:113;
>
>LOGGED FROM: void __thiscall rstudio::session::HttpConnectionImpl<class
>rstudio_boost::asio::ip::tcp>::sendResponse(const class
>rstudio::core::http::Response &)
>src/cpp/session/http/SessionWin32HttpConnectionListener.cpp:118
>```
>I'm not sure what is going on, but this same thing happens with R 4.0.3
>and
>R 4.0.4, but not with R 4.0.2. I would like to use the most recent
>version
>of R if possible, but for now I am stuck with 4.0.2.
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From g@@@uu| @end|ng |rom gm@||@com  Wed Apr 21 10:08:26 2021
From: g@@@uu| @end|ng |rom gm@||@com (ani jaya)
Date: Wed, 21 Apr 2021 17:08:26 +0900
Subject: [R] Occurrence by season
Message-ID: <CAHXS41z82eiqBoYswKDpEUE-tfwPaDrOcc20X2F9Z8xix4d3NQ@mail.gmail.com>

Dear r community,

I have a data frame that shows the month of occurrence of the maximum
value on let say 10 stations in 30 years.  I want to make percentages
based on seasons (DJF, MAM, JJA, and SON). I can do that by the code
below but only when we put season by JFM, AMJ, ...(or 123; 456;
789;..).
I believe it is not that hard to put 12 in front of 1 but my mind stuck.

If someone can help me, I would be appreciated.

Thank you in advance

Ani


freqw<-matrix(NA, 4,10)
for(j in 1:4){
  for(i in 1:10){
      freqw[j,i]<-sum(table(when[i+1])[(j*3-2):(j*3)],na.rm=T)
  }
}
freqw<-freqw/30*100


> dput(when)
structure(list(Group.1 = structure(1:30, .Label = c("1985", "1986",
"1987", "1988", "1989", "1990", "1991", "1992", "1993", "1994",
"1995", "1996", "1997", "1998", "1999", "2000", "2001", "2002",
"2003", "2004", "2005", "2006", "2007", "2008", "2009", "2010",
"2011", "2012", "2013", "2014"), class = "factor"), V1 = c(8L,
1L, 1L, 12L, 12L, 1L, 4L, 1L, 2L, 3L, 7L, 4L, 1L, 6L, 2L, 2L,
11L, 4L, 2L, 2L, 12L, 6L, 2L, 2L, 6L, 3L, 6L, 4L, 7L, 1L), V2 = c(1L,
1L, 1L, 1L, 12L, 12L, 4L, 1L, 2L, 2L, 4L, 1L, 11L, 1L, 1L, 3L,
3L, 1L, 12L, 2L, 5L, 2L, 12L, 2L, 1L, 5L, 10L, 4L, 12L, 1L),
    V3 = c(4L, 1L, 12L, 12L, 2L, 4L, 1L, 5L, 1L, 1L, 2L, 2L,
    1L, 1L, 2L, 2L, 4L, 1L, 2L, 12L, 3L, 2L, 12L, 4L, 6L, 4L,
    2L, 3L, 5L, 1L), V4 = c(1L, 12L, 12L, 3L, 2L, 12L, 7L, 2L,
    12L, 1L, 12L, 2L, 1L, 12L, 1L, 10L, 7L, 1L, 1L, 3L, 10L,
    12L, 12L, 12L, 5L, 12L, 3L, 2L, 12L, 1L), V5 = c(1L, 12L,
    12L, 3L, 2L, 12L, 7L, 2L, 12L, 3L, 4L, 12L, 5L, 2L, 1L, 1L,
    2L, 5L, 2L, 2L, 3L, 2L, 10L, 3L, 1L, 1L, 4L, 1L, 4L, 6L),
    V6 = c(12L, 1L, 12L, 2L, 1L, 12L, 3L, 1L, 4L, 12L, 6L, 12L,
    1L, 7L, 2L, 2L, 1L, 1L, 12L, 12L, 12L, 3L, 12L, 2L, 1L, 9L,
    12L, 1L, 4L, 12L), V7 = c(5L, 2L, 6L, 12L, 3L, 4L, 12L, 12L,
    6L, 2L, 11L, 12L, 2L, 5L, 11L, 4L, 3L, 4L, 1L, 12L, 10L,
    3L, 10L, 3L, 3L, 9L, 1L, 3L, 12L, 11L), V8 = c(4L, 5L, 5L,
    8L, 7L, 12L, 1L, 3L, 2L, 5L, 2L, 4L, 1L, 4L, 1L, 6L, 6L,
    2L, 3L, 5L, 4L, 1L, 3L, 12L, 4L, 12L, 12L, 3L, 6L, 7L), V9 = c(3L,
    2L, 3L, 11L, 7L, 2L, 4L, 4L, 5L, 6L, 6L, 3L, 4L, 6L, 1L,
    9L, 9L, 12L, 3L, 12L, 5L, 6L, 3L, 7L, 4L, 8L, 2L, 2L, 6L,
    6L), V10 = c(5L, 10L, 3L, 6L, 6L, 5L, 5L, 6L, 5L, 6L, 12L,
    6L, 7L, 2L, 1L, 6L, 4L, 5L, 4L, 2L, 7L, 6L, 7L, 7L, 2L, 7L,
    3L, 6L, 7L, 6L)), row.names = c(NA, -30L), class = "data.frame")


From er|cjberger @end|ng |rom gm@||@com  Wed Apr 21 10:47:55 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Wed, 21 Apr 2021 11:47:55 +0300
Subject: [R] Occurrence by season
In-Reply-To: <CAHXS41z82eiqBoYswKDpEUE-tfwPaDrOcc20X2F9Z8xix4d3NQ@mail.gmail.com>
References: <CAHXS41z82eiqBoYswKDpEUE-tfwPaDrOcc20X2F9Z8xix4d3NQ@mail.gmail.com>
Message-ID: <CAGgJW76kRxjXB4d2vXz2JOWc8Y3u2J3eyCS8Smr2Fh48GKhp0g@mail.gmail.com>

Hi Ani,
Before the for loops add the following line

when[,-1] <- when[,-1]%%12 + 1

This changes the month numbering so that Dec becomes 1, Jan becomes 2, etc
Then your for loop does what you want.

HTH,
Eric




On Wed, Apr 21, 2021 at 11:09 AM ani jaya <gaaauul at gmail.com> wrote:

> Dear r community,
>
> I have a data frame that shows the month of occurrence of the maximum
> value on let say 10 stations in 30 years.  I want to make percentages
> based on seasons (DJF, MAM, JJA, and SON). I can do that by the code
> below but only when we put season by JFM, AMJ, ...(or 123; 456;
> 789;..).
> I believe it is not that hard to put 12 in front of 1 but my mind stuck.
>
> If someone can help me, I would be appreciated.
>
> Thank you in advance
>
> Ani
>
>
> freqw<-matrix(NA, 4,10)
> for(j in 1:4){
>   for(i in 1:10){
>       freqw[j,i]<-sum(table(when[i+1])[(j*3-2):(j*3)],na.rm=T)
>   }
> }
> freqw<-freqw/30*100
>
>
> > dput(when)
> structure(list(Group.1 = structure(1:30, .Label = c("1985", "1986",
> "1987", "1988", "1989", "1990", "1991", "1992", "1993", "1994",
> "1995", "1996", "1997", "1998", "1999", "2000", "2001", "2002",
> "2003", "2004", "2005", "2006", "2007", "2008", "2009", "2010",
> "2011", "2012", "2013", "2014"), class = "factor"), V1 = c(8L,
> 1L, 1L, 12L, 12L, 1L, 4L, 1L, 2L, 3L, 7L, 4L, 1L, 6L, 2L, 2L,
> 11L, 4L, 2L, 2L, 12L, 6L, 2L, 2L, 6L, 3L, 6L, 4L, 7L, 1L), V2 = c(1L,
> 1L, 1L, 1L, 12L, 12L, 4L, 1L, 2L, 2L, 4L, 1L, 11L, 1L, 1L, 3L,
> 3L, 1L, 12L, 2L, 5L, 2L, 12L, 2L, 1L, 5L, 10L, 4L, 12L, 1L),
>     V3 = c(4L, 1L, 12L, 12L, 2L, 4L, 1L, 5L, 1L, 1L, 2L, 2L,
>     1L, 1L, 2L, 2L, 4L, 1L, 2L, 12L, 3L, 2L, 12L, 4L, 6L, 4L,
>     2L, 3L, 5L, 1L), V4 = c(1L, 12L, 12L, 3L, 2L, 12L, 7L, 2L,
>     12L, 1L, 12L, 2L, 1L, 12L, 1L, 10L, 7L, 1L, 1L, 3L, 10L,
>     12L, 12L, 12L, 5L, 12L, 3L, 2L, 12L, 1L), V5 = c(1L, 12L,
>     12L, 3L, 2L, 12L, 7L, 2L, 12L, 3L, 4L, 12L, 5L, 2L, 1L, 1L,
>     2L, 5L, 2L, 2L, 3L, 2L, 10L, 3L, 1L, 1L, 4L, 1L, 4L, 6L),
>     V6 = c(12L, 1L, 12L, 2L, 1L, 12L, 3L, 1L, 4L, 12L, 6L, 12L,
>     1L, 7L, 2L, 2L, 1L, 1L, 12L, 12L, 12L, 3L, 12L, 2L, 1L, 9L,
>     12L, 1L, 4L, 12L), V7 = c(5L, 2L, 6L, 12L, 3L, 4L, 12L, 12L,
>     6L, 2L, 11L, 12L, 2L, 5L, 11L, 4L, 3L, 4L, 1L, 12L, 10L,
>     3L, 10L, 3L, 3L, 9L, 1L, 3L, 12L, 11L), V8 = c(4L, 5L, 5L,
>     8L, 7L, 12L, 1L, 3L, 2L, 5L, 2L, 4L, 1L, 4L, 1L, 6L, 6L,
>     2L, 3L, 5L, 4L, 1L, 3L, 12L, 4L, 12L, 12L, 3L, 6L, 7L), V9 = c(3L,
>     2L, 3L, 11L, 7L, 2L, 4L, 4L, 5L, 6L, 6L, 3L, 4L, 6L, 1L,
>     9L, 9L, 12L, 3L, 12L, 5L, 6L, 3L, 7L, 4L, 8L, 2L, 2L, 6L,
>     6L), V10 = c(5L, 10L, 3L, 6L, 6L, 5L, 5L, 6L, 5L, 6L, 12L,
>     6L, 7L, 2L, 1L, 6L, 4L, 5L, 4L, 2L, 7L, 6L, 7L, 7L, 2L, 7L,
>     3L, 6L, 7L, 6L)), row.names = c(NA, -30L), class = "data.frame")
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From w||||@mwdun|@p @end|ng |rom gm@||@com  Wed Apr 21 16:58:49 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Wed, 21 Apr 2021 07:58:49 -0700
Subject: [R] R versions > 4.0.2 fail to start in Windows 64-bit
In-Reply-To: <CANCw-JUW6nhjYfQ-et5r_JPB9i5hCxoEU460xQueuwMnyo18dg@mail.gmail.com>
References: <CANCw-JUW6nhjYfQ-et5r_JPB9i5hCxoEU460xQueuwMnyo18dg@mail.gmail.com>
Message-ID: <CAHqSRuSRbwdNud7HA+jdY=hVJx1Pbs_XEKFUwrNdmswNV2MetA@mail.gmail.com>

Does this happen when you start R with the --vanilla flag?  When you remove
or rename ./.RData?

-Bill

On Tue, Apr 20, 2021 at 8:37 PM N. Jordan Jameson <jjameson at terpmail.umd.edu>
wrote:

> I have a 64-bit Windows machine and I've installed R versions 4.0.0 through
> 4.0.5 and only versions 4.0.2 and below will successfully start. This
> morning I installed 4.0.5, and when I start R, the R-gui starts for less
> than a second and then disappears. I tried to open R using RStudio and I
> got the following messages:
>
> `The R session failed to start.` and ` The R session process exited with
> code -1073740791`
>
> The log for this error is:
>
> ```
> ERROR system error 10053 (An established connection was aborted by the
> software in your host machine) [request-uri: /events/get_events];
>
> OCCURRED AT void __thiscall rstudio::session::HttpConnectionImpl<class
> rstudio_boost::asio::ip::tcp>::sendResponse(const class
> rstudio::core::http::Response &)
> src/cpp/session/http/SessionWin32HttpConnectionListener.cpp:113;
>
> LOGGED FROM: void __thiscall rstudio::session::HttpConnectionImpl<class
> rstudio_boost::asio::ip::tcp>::sendResponse(const class
> rstudio::core::http::Response &)
> src/cpp/session/http/SessionWin32HttpConnectionListener.cpp:118
> ```
> I'm not sure what is going on, but this same thing happens with R 4.0.3 and
> R 4.0.4, but not with R 4.0.2. I would like to use the most recent version
> of R if possible, but for now I am stuck with 4.0.2.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Wed Apr 21 20:36:26 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 21 Apr 2021 11:36:26 -0700
Subject: [R] Occurrence by season
In-Reply-To: <CAGgJW76kRxjXB4d2vXz2JOWc8Y3u2J3eyCS8Smr2Fh48GKhp0g@mail.gmail.com>
References: <CAHXS41z82eiqBoYswKDpEUE-tfwPaDrOcc20X2F9Z8xix4d3NQ@mail.gmail.com>
 <CAGgJW76kRxjXB4d2vXz2JOWc8Y3u2J3eyCS8Smr2Fh48GKhp0g@mail.gmail.com>
Message-ID: <CAGxFJbRW1=KjRqbdf53R0ts_5dVBQSektY-qWPKhMXmLGZybSw@mail.gmail.com>

Simpler, and no loops needed per column:
## this makes the idea clear
> x <- 1:12
> (x %% 12) %/% 3 ## first modulo, then integer divide
 [1] 0 0 1 1 1 2 2 2 3 3 3 0

## add 1 if you prefer 1 to 4. Better yet, probably, is to turn it into a
factor:
> f <- factor(c("win","spr","sum","fal")[x+1])
> f
 [1] win win spr spr spr sum sum sum fal fal fal win
Levels: fal spr sum win

## see ?factor if you want to alter the ordering of the levels (e.g. for
graphics, nice tables of results, etc.)

Cheers,

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Wed, Apr 21, 2021 at 1:48 AM Eric Berger <ericjberger at gmail.com> wrote:

> Hi Ani,
> Before the for loops add the following line
>
> when[,-1] <- when[,-1]%%12 + 1
>
> This changes the month numbering so that Dec becomes 1, Jan becomes 2, etc
> Then your for loop does what you want.
>
> HTH,
> Eric
>
>
>
>
> On Wed, Apr 21, 2021 at 11:09 AM ani jaya <gaaauul at gmail.com> wrote:
>
> > Dear r community,
> >
> > I have a data frame that shows the month of occurrence of the maximum
> > value on let say 10 stations in 30 years.  I want to make percentages
> > based on seasons (DJF, MAM, JJA, and SON). I can do that by the code
> > below but only when we put season by JFM, AMJ, ...(or 123; 456;
> > 789;..).
> > I believe it is not that hard to put 12 in front of 1 but my mind stuck.
> >
> > If someone can help me, I would be appreciated.
> >
> > Thank you in advance
> >
> > Ani
> >
> >
> > freqw<-matrix(NA, 4,10)
> > for(j in 1:4){
> >   for(i in 1:10){
> >       freqw[j,i]<-sum(table(when[i+1])[(j*3-2):(j*3)],na.rm=T)
> >   }
> > }
> > freqw<-freqw/30*100
> >
> >
> > > dput(when)
> > structure(list(Group.1 = structure(1:30, .Label = c("1985", "1986",
> > "1987", "1988", "1989", "1990", "1991", "1992", "1993", "1994",
> > "1995", "1996", "1997", "1998", "1999", "2000", "2001", "2002",
> > "2003", "2004", "2005", "2006", "2007", "2008", "2009", "2010",
> > "2011", "2012", "2013", "2014"), class = "factor"), V1 = c(8L,
> > 1L, 1L, 12L, 12L, 1L, 4L, 1L, 2L, 3L, 7L, 4L, 1L, 6L, 2L, 2L,
> > 11L, 4L, 2L, 2L, 12L, 6L, 2L, 2L, 6L, 3L, 6L, 4L, 7L, 1L), V2 = c(1L,
> > 1L, 1L, 1L, 12L, 12L, 4L, 1L, 2L, 2L, 4L, 1L, 11L, 1L, 1L, 3L,
> > 3L, 1L, 12L, 2L, 5L, 2L, 12L, 2L, 1L, 5L, 10L, 4L, 12L, 1L),
> >     V3 = c(4L, 1L, 12L, 12L, 2L, 4L, 1L, 5L, 1L, 1L, 2L, 2L,
> >     1L, 1L, 2L, 2L, 4L, 1L, 2L, 12L, 3L, 2L, 12L, 4L, 6L, 4L,
> >     2L, 3L, 5L, 1L), V4 = c(1L, 12L, 12L, 3L, 2L, 12L, 7L, 2L,
> >     12L, 1L, 12L, 2L, 1L, 12L, 1L, 10L, 7L, 1L, 1L, 3L, 10L,
> >     12L, 12L, 12L, 5L, 12L, 3L, 2L, 12L, 1L), V5 = c(1L, 12L,
> >     12L, 3L, 2L, 12L, 7L, 2L, 12L, 3L, 4L, 12L, 5L, 2L, 1L, 1L,
> >     2L, 5L, 2L, 2L, 3L, 2L, 10L, 3L, 1L, 1L, 4L, 1L, 4L, 6L),
> >     V6 = c(12L, 1L, 12L, 2L, 1L, 12L, 3L, 1L, 4L, 12L, 6L, 12L,
> >     1L, 7L, 2L, 2L, 1L, 1L, 12L, 12L, 12L, 3L, 12L, 2L, 1L, 9L,
> >     12L, 1L, 4L, 12L), V7 = c(5L, 2L, 6L, 12L, 3L, 4L, 12L, 12L,
> >     6L, 2L, 11L, 12L, 2L, 5L, 11L, 4L, 3L, 4L, 1L, 12L, 10L,
> >     3L, 10L, 3L, 3L, 9L, 1L, 3L, 12L, 11L), V8 = c(4L, 5L, 5L,
> >     8L, 7L, 12L, 1L, 3L, 2L, 5L, 2L, 4L, 1L, 4L, 1L, 6L, 6L,
> >     2L, 3L, 5L, 4L, 1L, 3L, 12L, 4L, 12L, 12L, 3L, 6L, 7L), V9 = c(3L,
> >     2L, 3L, 11L, 7L, 2L, 4L, 4L, 5L, 6L, 6L, 3L, 4L, 6L, 1L,
> >     9L, 9L, 12L, 3L, 12L, 5L, 6L, 3L, 7L, 4L, 8L, 2L, 2L, 6L,
> >     6L), V10 = c(5L, 10L, 3L, 6L, 6L, 5L, 5L, 6L, 5L, 6L, 12L,
> >     6L, 7L, 2L, 1L, 6L, 4L, 5L, 4L, 2L, 7L, 6L, 7L, 7L, 2L, 7L,
> >     3L, 6L, 7L, 6L)), row.names = c(NA, -30L), class = "data.frame")
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From j@b@y@t194 @end|ng |rom gm@||@com  Wed Apr 21 09:14:21 2021
From: j@b@y@t194 @end|ng |rom gm@||@com (javad bayat)
Date: Wed, 21 Apr 2021 11:44:21 +0430
Subject: [R] Fwd: Create new polygon from a polygon
In-Reply-To: <CANTxAm+asxvo2A2hXXLLPm1uFu5Tc1=bqUu6xidNioeJ82ScLw@mail.gmail.com>
References: <CANTxAm+asxvo2A2hXXLLPm1uFu5Tc1=bqUu6xidNioeJ82ScLw@mail.gmail.com>
Message-ID: <CANTxAmLBPwtecxi=N9-MrrBkwwNRCy+JeebMT6sqoxQGMRKrbQ@mail.gmail.com>

---------- Forwarded message ---------
From: javad bayat <j.bayat194 at gmail.com>
Date: Fri, Apr 16, 2021 at 9:00 AM
Subject: Create new polygon from a polygon
To: <R-help-owner at r-project.org>


Dear all;
I have a polygon and I want to divide it into 2 new polygons. The first one
must be 54 percent of the initial polygon area and the remaining area (46
percent of the area) for the second polygon. Is there any way to do this?

"
library(rgdal)
S_P = readOGR(".","Polygon")
proj4string(S_P) <- CRS("+proj=utm +zone=39 +datum=WGS84")

"
Sincerely

-- 
Best Regards
Javad Bayat
M.Sc. Environment Engineering
Alternative Mail: bayat194 at yahoo.com


-- 
Best Regards
Javad Bayat
M.Sc. Environment Engineering
Alternative Mail: bayat194 at yahoo.com

	[[alternative HTML version deleted]]


From jeremy@roos m@iii@g oii gm@ii@com  Wed Apr 21 22:19:33 2021
From: jeremy@roos m@iii@g oii gm@ii@com (jeremy@roos m@iii@g oii gm@ii@com)
Date: Wed, 21 Apr 2021 22:19:33 +0200
Subject: [R] [R-pkgs] gmgm: Gaussian Mixture Graphical Model Learning and
 Inference
In-Reply-To: <006401d736ea$edd02f90$c9708eb0$@gmail.com>
References: <006401d736ea$edd02f90$c9708eb0$@gmail.com>
Message-ID: <006b01d736eb$a51f5ef0$ef5e1cd0$@gmail.com>

Dear R users,

 

I am happy to announce that gmgm 1.0.2 is available on CRAN:

https://cran.r-project.org/package=gmgm

 

gmgm provides a complete framework to create, manipulate, learn the
structure and the parameters, and perform inference in Gaussian mixture
graphical models, which include Bayesian networks and dynamic Bayesian
networks (their temporal extension) whose local probability distributions
are described by Gaussian mixture models.

 

The related GitHub project and an example of use of this package can be
found at:

https://github.com/jeremyroos/gmgm

 

Please feel free to contact me for more details or to report any issue.

 

Best regards,

J?r?my Roos


	[[alternative HTML version deleted]]


-------------- next part --------------
_______________________________________________
R-packages mailing list
R-packages at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-packages

From m|n@h@|| @end|ng |rom um|ch@edu  Thu Apr 22 10:45:41 2021
From: m|n@h@|| @end|ng |rom um|ch@edu (Greg Minshall)
Date: Thu, 22 Apr 2021 11:45:41 +0300
Subject: [R] Fwd: Create new polygon from a polygon
In-Reply-To: Your message of "Wed, 21 Apr 2021 11:44:21 +0430."
 <CANTxAmLBPwtecxi=N9-MrrBkwwNRCy+JeebMT6sqoxQGMRKrbQ@mail.gmail.com>
Message-ID: <1116032.1619081141@apollo2.minshall.org>

Javad,

you might think of asking in the r-sig-geo e-mail list?
: r-sig-geo at r-project.org

cheers.


From m@rn@@w@g|ey @end|ng |rom gm@||@com  Fri Apr 23 01:45:35 2021
From: m@rn@@w@g|ey @end|ng |rom gm@||@com (Marna Wagley)
Date: Thu, 22 Apr 2021 16:45:35 -0700
Subject: [R] Conditional extraction of values in a data.frame in r
Message-ID: <CAMwU6B2KhioN3HoA+hGEk9wuWwspu7fByhk4vJtzbZgvS_trdQ@mail.gmail.com>

Hi R Users,
I have been struggling to extract the data based on conditional values in
different columns. I have a very big dataset (rows) and a couple of
columns. here an example of the dataset is:

daT<-structure(list(ID = c("id1", "id2", "id3", "id4", "id5", "id6",

"id7"), First_detectiondate = c("7/21/2015", "5/19/2015", "5/27/2015",

NA, "9/25/2015", NA, NA), Second_detectiondate = c(NA, NA, "6/1/2015",

"5/29/2015", NA, NA, "4/17/2015"), third_detectiondate = c(NA,

"5/21/2015", "6/20/2015", NA, NA, "", NA)), class = "data.frame", row.names
= c(NA,

-7L))


head(daT)


I wanted to put conditions such as: if any of the columns of 2.3.4 has a
date, get the date which was latest. If there is no date, put NA. and I was
looking for the output as shown in the following table.


output<-structure(list(ID = c("id1", "id2", "id3", "id4", "id5", "id6",

"id7"), First_detectiondate = c("7/21/2015", "5/19/2015", "5/27/2015",

NA, "9/25/2015", NA, NA), Second_detectiondate = c(NA, NA, "6/1/2015",

"5/29/2015", NA, NA, "4/17/2015"), third_detectiondate = c(NA,

"5/21/2015", "6/20/2015", NA, NA, "", NA), output1 = c("7/21/2015",

"5/21/2015", "6/20/2015", "5/29/2015", "9/25/2015", NA, "4/17/2015"

)), class = "data.frame", row.names = c(NA, -7L))

head(output)



Is there a way to get the table similar to the table "output"?


Thank you very much for your help.


Sincerely,


MW

	[[alternative HTML version deleted]]


From g@@@uu| @end|ng |rom gm@||@com  Fri Apr 23 02:42:13 2021
From: g@@@uu| @end|ng |rom gm@||@com (ani jaya)
Date: Fri, 23 Apr 2021 09:42:13 +0900
Subject: [R] Occurrence by season
In-Reply-To: <CAGxFJbRW1=KjRqbdf53R0ts_5dVBQSektY-qWPKhMXmLGZybSw@mail.gmail.com>
References: <CAHXS41z82eiqBoYswKDpEUE-tfwPaDrOcc20X2F9Z8xix4d3NQ@mail.gmail.com>
 <CAGgJW76kRxjXB4d2vXz2JOWc8Y3u2J3eyCS8Smr2Fh48GKhp0g@mail.gmail.com>
 <CAGxFJbRW1=KjRqbdf53R0ts_5dVBQSektY-qWPKhMXmLGZybSw@mail.gmail.com>
Message-ID: <CAHXS41yTACgj6SWWkiSeZ_KBxfiRORoPZ-Pd=DcQOTatV=8uHQ@mail.gmail.com>

Thank you very much Mr. Eric and Mr. Bert.
It was really helpful.


Best,
Ani

On Thu, Apr 22, 2021 at 3:36 AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> Simpler, and no loops needed per column:
> ## this makes the idea clear
> > x <- 1:12
> > (x %% 12) %/% 3 ## first modulo, then integer divide
>  [1] 0 0 1 1 1 2 2 2 3 3 3 0
>
> ## add 1 if you prefer 1 to 4. Better yet, probably, is to turn it into a factor:
> > f <- factor(c("win","spr","sum","fal")[x+1])
> > f
>  [1] win win spr spr spr sum sum sum fal fal fal win
> Levels: fal spr sum win
>
> ## see ?factor if you want to alter the ordering of the levels (e.g. for graphics, nice tables of results, etc.)
>
> Cheers,
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
>
> On Wed, Apr 21, 2021 at 1:48 AM Eric Berger <ericjberger at gmail.com> wrote:
>>
>> Hi Ani,
>> Before the for loops add the following line
>>
>> when[,-1] <- when[,-1]%%12 + 1
>>
>> This changes the month numbering so that Dec becomes 1, Jan becomes 2, etc
>> Then your for loop does what you want.
>>
>> HTH,
>> Eric
>>
>>
>>
>>
>> On Wed, Apr 21, 2021 at 11:09 AM ani jaya <gaaauul at gmail.com> wrote:
>>
>> > Dear r community,
>> >
>> > I have a data frame that shows the month of occurrence of the maximum
>> > value on let say 10 stations in 30 years.  I want to make percentages
>> > based on seasons (DJF, MAM, JJA, and SON). I can do that by the code
>> > below but only when we put season by JFM, AMJ, ...(or 123; 456;
>> > 789;..).
>> > I believe it is not that hard to put 12 in front of 1 but my mind stuck.
>> >
>> > If someone can help me, I would be appreciated.
>> >
>> > Thank you in advance
>> >
>> > Ani
>> >
>> >
>> > freqw<-matrix(NA, 4,10)
>> > for(j in 1:4){
>> >   for(i in 1:10){
>> >       freqw[j,i]<-sum(table(when[i+1])[(j*3-2):(j*3)],na.rm=T)
>> >   }
>> > }
>> > freqw<-freqw/30*100
>> >
>> >
>> > > dput(when)
>> > structure(list(Group.1 = structure(1:30, .Label = c("1985", "1986",
>> > "1987", "1988", "1989", "1990", "1991", "1992", "1993", "1994",
>> > "1995", "1996", "1997", "1998", "1999", "2000", "2001", "2002",
>> > "2003", "2004", "2005", "2006", "2007", "2008", "2009", "2010",
>> > "2011", "2012", "2013", "2014"), class = "factor"), V1 = c(8L,
>> > 1L, 1L, 12L, 12L, 1L, 4L, 1L, 2L, 3L, 7L, 4L, 1L, 6L, 2L, 2L,
>> > 11L, 4L, 2L, 2L, 12L, 6L, 2L, 2L, 6L, 3L, 6L, 4L, 7L, 1L), V2 = c(1L,
>> > 1L, 1L, 1L, 12L, 12L, 4L, 1L, 2L, 2L, 4L, 1L, 11L, 1L, 1L, 3L,
>> > 3L, 1L, 12L, 2L, 5L, 2L, 12L, 2L, 1L, 5L, 10L, 4L, 12L, 1L),
>> >     V3 = c(4L, 1L, 12L, 12L, 2L, 4L, 1L, 5L, 1L, 1L, 2L, 2L,
>> >     1L, 1L, 2L, 2L, 4L, 1L, 2L, 12L, 3L, 2L, 12L, 4L, 6L, 4L,
>> >     2L, 3L, 5L, 1L), V4 = c(1L, 12L, 12L, 3L, 2L, 12L, 7L, 2L,
>> >     12L, 1L, 12L, 2L, 1L, 12L, 1L, 10L, 7L, 1L, 1L, 3L, 10L,
>> >     12L, 12L, 12L, 5L, 12L, 3L, 2L, 12L, 1L), V5 = c(1L, 12L,
>> >     12L, 3L, 2L, 12L, 7L, 2L, 12L, 3L, 4L, 12L, 5L, 2L, 1L, 1L,
>> >     2L, 5L, 2L, 2L, 3L, 2L, 10L, 3L, 1L, 1L, 4L, 1L, 4L, 6L),
>> >     V6 = c(12L, 1L, 12L, 2L, 1L, 12L, 3L, 1L, 4L, 12L, 6L, 12L,
>> >     1L, 7L, 2L, 2L, 1L, 1L, 12L, 12L, 12L, 3L, 12L, 2L, 1L, 9L,
>> >     12L, 1L, 4L, 12L), V7 = c(5L, 2L, 6L, 12L, 3L, 4L, 12L, 12L,
>> >     6L, 2L, 11L, 12L, 2L, 5L, 11L, 4L, 3L, 4L, 1L, 12L, 10L,
>> >     3L, 10L, 3L, 3L, 9L, 1L, 3L, 12L, 11L), V8 = c(4L, 5L, 5L,
>> >     8L, 7L, 12L, 1L, 3L, 2L, 5L, 2L, 4L, 1L, 4L, 1L, 6L, 6L,
>> >     2L, 3L, 5L, 4L, 1L, 3L, 12L, 4L, 12L, 12L, 3L, 6L, 7L), V9 = c(3L,
>> >     2L, 3L, 11L, 7L, 2L, 4L, 4L, 5L, 6L, 6L, 3L, 4L, 6L, 1L,
>> >     9L, 9L, 12L, 3L, 12L, 5L, 6L, 3L, 7L, 4L, 8L, 2L, 2L, 6L,
>> >     6L), V10 = c(5L, 10L, 3L, 6L, 6L, 5L, 5L, 6L, 5L, 6L, 12L,
>> >     6L, 7L, 2L, 1L, 6L, 4L, 5L, 4L, 2L, 7L, 6L, 7L, 7L, 2L, 7L,
>> >     3L, 6L, 7L, 6L)), row.names = c(NA, -30L), class = "data.frame")
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide
>> > http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>> >
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From drj|m|emon @end|ng |rom gm@||@com  Fri Apr 23 02:58:54 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Fri, 23 Apr 2021 10:58:54 +1000
Subject: [R] Conditional extraction of values in a data.frame in r
In-Reply-To: <CAMwU6B2KhioN3HoA+hGEk9wuWwspu7fByhk4vJtzbZgvS_trdQ@mail.gmail.com>
References: <CAMwU6B2KhioN3HoA+hGEk9wuWwspu7fByhk4vJtzbZgvS_trdQ@mail.gmail.com>
Message-ID: <CA+8X3fXoUrez9-TbNDv5NPi-1pONxzaFz9vL8jDuzTxkjhv9Nw@mail.gmail.com>

Hi Marna,
This may be what you want:

get_latest<-function(x,format="%m/%d/%Y") {
 x<-unlist(x)
 x[nchar(x)==0]<-NA
 if(all(is.na(x))) return(NA)
 else return(format(max(as.Date(x,format),na.rm=TRUE),format))
}
daT$output1<-apply(daT[,2:4],1,get_latest)

The empty value in daT gave a bit of trouble. I have written it to
accept and return character dates.

Jim

On Fri, Apr 23, 2021 at 9:46 AM Marna Wagley <marna.wagley at gmail.com> wrote:
>
> Hi R Users,
> I have been struggling to extract the data based on conditional values in
> different columns. I have a very big dataset (rows) and a couple of
> columns. here an example of the dataset is:
>
> daT<-structure(list(ID = c("id1", "id2", "id3", "id4", "id5", "id6",
>
> "id7"), First_detectiondate = c("7/21/2015", "5/19/2015", "5/27/2015",
>
> NA, "9/25/2015", NA, NA), Second_detectiondate = c(NA, NA, "6/1/2015",
>
> "5/29/2015", NA, NA, "4/17/2015"), third_detectiondate = c(NA,
>
> "5/21/2015", "6/20/2015", NA, NA, "", NA)), class = "data.frame", row.names
> = c(NA,
>
> -7L))
>
>
> head(daT)
>
>
> I wanted to put conditions such as: if any of the columns of 2.3.4 has a
> date, get the date which was latest. If there is no date, put NA. and I was
> looking for the output as shown in the following table.
>
>
> output<-structure(list(ID = c("id1", "id2", "id3", "id4", "id5", "id6",
>
> "id7"), First_detectiondate = c("7/21/2015", "5/19/2015", "5/27/2015",
>
> NA, "9/25/2015", NA, NA), Second_detectiondate = c(NA, NA, "6/1/2015",
>
> "5/29/2015", NA, NA, "4/17/2015"), third_detectiondate = c(NA,
>
> "5/21/2015", "6/20/2015", NA, NA, "", NA), output1 = c("7/21/2015",
>
> "5/21/2015", "6/20/2015", "5/29/2015", "9/25/2015", NA, "4/17/2015"
>
> )), class = "data.frame", row.names = c(NA, -7L))
>
> head(output)
>
>
>
> Is there a way to get the table similar to the table "output"?
>
>
> Thank you very much for your help.
>
>
> Sincerely,
>
>
> MW
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Fri Apr 23 03:25:05 2021
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Thu, 22 Apr 2021 20:25:05 -0500
Subject: [R] input string ... cannot be translated to UTF-8,
 is it valid in 'ANSI_X3.4-1968'?
Message-ID: <05d5dca9-283d-d1d5-a807-311ac0b05afb@effectivedefense.org>

Hello:


	  What if anything should I do regarding notes from either "load" or 
"attach" that, "input string ... cannot be translated to UTF-8, is it 
valid in 'ANSI_X3.4-1968'?"?


	  I'm running R 4.0.5 under macOS 11.2.3;  see "sessionInfo()" and 
detailed instructions below on the precise file I dowloaded from the web 
and tried to read.


	  I may be able to get what I want just ignoring this.  However, I'd 
like to know how to fix this.


	  Thanks,
	  Spencer Graves


sessionInfo()
R version 4.0.5 (2021-03-31)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur 10.16

Matrix products: default
LAPACK: 
/Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
  [1] compiler_4.0.5    htmltools_0.5.1.1 tools_4.0.5       yaml_2.2.1 

  [5] tinytex_0.31      rmarkdown_2.7     knitr_1.31 
digest_0.6.27
  [9] xfun_0.22         rlang_0.4.10      evaluate_0.14
 > search()
  [1] ".GlobalEnv"                "file:NAVCO 1.3 List.RData"
  [3] "file:NAVCO 1.3 List.RData" "tools:rstudio"
  [5] "package:stats"             "package:graphics"
  [7] "package:grDevices"         "package:utils"
  [9] "package:datasets"          "package:methods"
[11] "Autoloads"                 "package:base"


*** To get the file I used for this, I went to 
"https://www.ericachenoweth.com/research".  From there I clicked 
"Version 1.3".  This took me to


https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/ON9XND


I then clicked the "Download" icon to the right of "NAVCO 1.3 List.tab". 
  This gave me 5 "Download Options", one of which was "RData Format";  I 
selected that.  This downloaded "NAVCO 1.3 List.RData", which I moved to 
getwd().  Then I did 'load("NAVCO 1.3 List.RData")' and 'attach("NAVCO 
1.3 List.RData")'.  Both of those gave me 8 repetitions of a message 
like "input string ... cannot be translated to UTF-8, is it valid in 
'ANSI_X3.4-1968'?" with different values substituted for "...".


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Apr 23 05:07:30 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 22 Apr 2021 23:07:30 -0400
Subject: [R] input string ... cannot be translated to UTF-8,
 is it valid in 'ANSI_X3.4-1968'?
In-Reply-To: <05d5dca9-283d-d1d5-a807-311ac0b05afb@effectivedefense.org>
References: <05d5dca9-283d-d1d5-a807-311ac0b05afb@effectivedefense.org>
Message-ID: <e03b748c-414b-cc64-083b-5e4e2f5a82e8@gmail.com>

On 22/04/2021 9:25 p.m., Spencer Graves wrote:
> Hello:
> 
> 
> 	  What if anything should I do regarding notes from either "load" or
> "attach" that, "input string ... cannot be translated to UTF-8, is it
> valid in 'ANSI_X3.4-1968'?"?

First, ANSI_X3.4-1968  is an official name for for a version of Ascii. 
It appears in the file near the start, where I believe it records the 
native encoding in place when the file was written, so readers using a 
different encoding can translate.

Your actual file appears to have been encoded in UTF-8, but not marked 
as such.  You're lucky you read it on macOS, where UTF-8 is the native 
encoding, since the reader probably recognized the bytes weren't ascii 
bytes (and warned you about that), then just left them alone.  If you 
read that file on Windows you'd likely get junk for those entries.

For your interest, here's a dump of the start of your file, after 
gunzipping it:

00000000  52 44 58 33 0a 58 0a 00  00 00 03 00 03 06 00 00 
|RDX3.X..........|
00000010  03 05 00 00 00 00 0e 41  4e 53 49 5f 58 33 2e 34 
|.......ANSI_X3.4|
00000020  2d 31 39 36 38 00 00 04  02 00 00 00 01 00 04 00 
|-1968...........|
00000030  09 00 00 00 01 78 00 00  03 13 00 00 00 10 00 00 
|.....x..........|
00000040  02 0e 00 00 02 6e 40 90  0c 00 00 00 00 00 40 90 
|.....n at .......@.|
00000050  44 00 00 00 00 00 40 10  00 00 00 00 00 00 40 7c 
|D..... at .......@||

Duncan Murdoch

> 
> 
> 	  I'm running R 4.0.5 under macOS 11.2.3;  see "sessionInfo()" and
> detailed instructions below on the precise file I dowloaded from the web
> and tried to read.
> 
> 
> 	  I may be able to get what I want just ignoring this.  However, I'd
> like to know how to fix this.
> 
> 
> 	  Thanks,
> 	  Spencer Graves
> 
> 
> sessionInfo()
> R version 4.0.5 (2021-03-31)
> Platform: x86_64-apple-darwin17.0 (64-bit)
> Running under: macOS Big Sur 10.16
> 
> Matrix products: default
> LAPACK:
> /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
> 
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> loaded via a namespace (and not attached):
>    [1] compiler_4.0.5    htmltools_0.5.1.1 tools_4.0.5       yaml_2.2.1
> 
>    [5] tinytex_0.31      rmarkdown_2.7     knitr_1.31
> digest_0.6.27
>    [9] xfun_0.22         rlang_0.4.10      evaluate_0.14
>   > search()
>    [1] ".GlobalEnv"                "file:NAVCO 1.3 List.RData"
>    [3] "file:NAVCO 1.3 List.RData" "tools:rstudio"
>    [5] "package:stats"             "package:graphics"
>    [7] "package:grDevices"         "package:utils"
>    [9] "package:datasets"          "package:methods"
> [11] "Autoloads"                 "package:base"
> 
> 
> *** To get the file I used for this, I went to
> "https://www.ericachenoweth.com/research".  From there I clicked
> "Version 1.3".  This took me to
> 
> 
> https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/ON9XND
> 
> 
> I then clicked the "Download" icon to the right of "NAVCO 1.3 List.tab".
>    This gave me 5 "Download Options", one of which was "RData Format";  I
> selected that.  This downloaded "NAVCO 1.3 List.RData", which I moved to
> getwd().  Then I did 'load("NAVCO 1.3 List.RData")' and 'attach("NAVCO
> 1.3 List.RData")'.  Both of those gave me 8 repetitions of a message
> like "input string ... cannot be translated to UTF-8, is it valid in
> 'ANSI_X3.4-1968'?" with different values substituted for "...".
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From @unyong@k|m @end|ng |rom ke||ogg@northwe@tern@edu  Fri Apr 23 15:28:38 2021
From: @unyong@k|m @end|ng |rom ke||ogg@northwe@tern@edu (Sun Yong Kim)
Date: Fri, 23 Apr 2021 13:28:38 +0000
Subject: [R] Query
Message-ID: <CH2PR05MB701628A5C8ECFCCFA4EA49CDDA459@CH2PR05MB7016.namprd05.prod.outlook.com>

Hi

I have been trying to circulate a question but my question keeps getting rejected. Let me try again via email. The message is below:

I am trying to change the tick size for IRF graphs that I created using the following code below:

par(mfrow=c(2,3))
IRF_F2 <- irf(SVARmod1, impulse="deltaw2",
          response=c("Belgium","France","Germany","Italy","Netherlands"),
n.ahead=60)
plot(IRF_F2,ylim=c(-0.5,0.3), plot.type="single", main="US Wealth Share
Shock")

The code gives me the following IRFs I have attached to this email. However the tick intervals is way too small and I want to change it to intervals of 10. I was thinking something like:

par(mfrow=c(2,3))
IRF_F2 <- irf(SVARmod1, impulse="deltaw2",

response=c("Belgium","France","Germany","Italy","Netherlands"),
n.ahead=60)
plot(IRF_F2,ylim=c(-0.5,0.3), plot.type="single", main="US Wealth
Share Shock", xaxt="n")
axis(side= 1, at = c(10, 20, 30, 40, 50, 60))

But it doesn't work. Any suggestions on how to reduce the tick interval?

-------------- next part --------------
A non-text attachment was scrubbed...
Name: Bond IRFs (Euro Zone) FINAL.png
Type: image/png
Size: 67577 bytes
Desc: Bond IRFs (Euro Zone) FINAL.png
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20210423/7df20fa3/attachment.png>

From tr@xp|@yer @end|ng |rom gm@||@com  Fri Apr 23 20:11:53 2021
From: tr@xp|@yer @end|ng |rom gm@||@com (=?UTF-8?Q?Martin_M=C3=B8ller_Skarbiniks_Pedersen?=)
Date: Fri, 23 Apr 2021 20:11:53 +0200
Subject: [R] ggplot2::geom_path() in a loop problems.
Message-ID: <CAGAA5bfvyOTi0r-zVVNGLjMfnveo+g82_-DW8RQu6z1+hMomww@mail.gmail.com>

Hi,

I have some problems understanding how to use geom_path() inside a loop.
I know the code below is a bit silly but it is just a MRE
( https://stackoverflow.com/help/minimal-reproducible-example )

p1 looks like I expect however p2 only contains the last square. I
expected p2 to be the same as p1.

Any hints what is going on?
Regards
Martin

library(ggplot2)

df <- data.frame(x = c(0,25,0,-25,0), y = c(25,0,-25,0,25))

p1 <- ggplot()
p1 <- p1 + geom_path(data = df,aes(x = x/1, y = y/1))
p1 <- p1 + geom_path(data = df,aes(x = x/2, y = y/2))
p1 <- p1 + xlim(-30,30)
p1 <- p1 + ylim(-30,30)
p1


p2 <- ggplot()
for (idx in 1:2) {
  p2 <- p2 + geom_path(data = df,aes(x = x/idx, y = y/idx))
}
p2 <- p2 + xlim(-30,30)
p2 <- p2 + ylim(-30,30)
p2

	[[alternative HTML version deleted]]


From tr@xp|@yer @end|ng |rom gm@||@com  Fri Apr 23 23:20:21 2021
From: tr@xp|@yer @end|ng |rom gm@||@com (=?UTF-8?Q?Martin_M=C3=B8ller_Skarbiniks_Pedersen?=)
Date: Fri, 23 Apr 2021 23:20:21 +0200
Subject: [R] ggplot2::geom_path() in a loop problems.
In-Reply-To: <CAGAA5bfvyOTi0r-zVVNGLjMfnveo+g82_-DW8RQu6z1+hMomww@mail.gmail.com>
References: <CAGAA5bfvyOTi0r-zVVNGLjMfnveo+g82_-DW8RQu6z1+hMomww@mail.gmail.com>
Message-ID: <CAGAA5bf_uF19ZeWT9hO_ZVF_UCj+10204JDH7LtnW5uXBXLjbw@mail.gmail.com>

On Fri, 23 Apr 2021 at 20:11, Martin M?ller Skarbiniks Pedersen <
traxplayer at gmail.com> wrote:
>
> Hi,
>
> I have some problems understanding how to use geom_path() inside a loop.
> I know the code below is a bit silly but it is just a MRE
> ( https://stackoverflow.com/help/minimal-reproducible-example )
>
> p1 looks like I expect however p2 only contains the last square. I
> expected p2 to be the same as p1.
>
> Any hints what is going on?
> Regards
> Martin
>
> library(ggplot2)
>
> df <- data.frame(x = c(0,25,0,-25,0), y = c(25,0,-25,0,25))
>
> p1 <- ggplot()
> p1 <- p1 + geom_path(data = df,aes(x = x/1, y = y/1))
> p1 <- p1 + geom_path(data = df,aes(x = x/2, y = y/2))
> p1 <- p1 + xlim(-30,30)
> p1 <- p1 + ylim(-30,30)
> p1
>
>
> p2 <- ggplot()
> for (idx in 1:2) {
>   p2 <- p2 + geom_path(data = df,aes(x = x/idx, y = y/idx))
> }
> p2 <- p2 + xlim(-30,30)
> p2 <- p2 + ylim(-30,30)
> p2


And the same strange effect if I write it like this:


p3 <- ggplot()
idx <- 1
p3 <- p3 + geom_path(data = df,aes(x = x/idx, y = y/idx))
idx <- 2
p3 <- p3 + geom_path(data = df,aes(x = x/idx, y = y/idx))
p3 <- p3 + xlim(-30,30)
p3 <- p3 + ylim(-30,30)
p3

	[[alternative HTML version deleted]]


From tr@xp|@yer @end|ng |rom gm@||@com  Sat Apr 24 23:17:33 2021
From: tr@xp|@yer @end|ng |rom gm@||@com (=?UTF-8?Q?Martin_M=C3=B8ller_Skarbiniks_Pedersen?=)
Date: Sat, 24 Apr 2021 23:17:33 +0200
Subject: [R] Still puzzled about different graph
Message-ID: <CAGAA5bfz-4iqODetKu0FjE4D7kzuJFf4Q1K=zAVzW-fhsAPVBA@mail.gmail.com>

Hi,

  Any ideas why I don't get the same graph out of p1 and p3?

 I have also posted it in the rstudio community without luck.
https://community.rstudio.com/t/ggplot2-geom-path-in-a-loop/102716/2

library(ggplot2)

df <- data.frame(x = c(0,25,0,-25,0), y = c(25,0,-25,0,25))
p1 <- ggplot()
p1 <- p1 + geom_path(data = df,aes(x = x/1, y = y/1))
p1 <- p1 + geom_path(data = df,aes(x = x/2, y = y/2))
p1 <- p1 + xlim(-30,30)
p1 <- p1 + ylim(-30,30)
p1

df <- data.frame(x = c(0,25,0,-25,0), y = c(25,0,-25,0,25))
p3 <- ggplot()
idx <- 1
p3 <- p3 + geom_path(data = df,aes(x = x/idx, y = y/idx))
idx <- 2
p3 <- p3 + geom_path(data = df,aes(x = x/idx, y = y/idx))
p3 <- p3 + xlim(-30,30)
p3 <- p3 + ylim(-30,30)
p3

	[[alternative HTML version deleted]]


From tr@xp|@yer @end|ng |rom gm@||@com  Sat Apr 24 23:21:01 2021
From: tr@xp|@yer @end|ng |rom gm@||@com (=?UTF-8?Q?Martin_M=C3=B8ller_Skarbiniks_Pedersen?=)
Date: Sat, 24 Apr 2021 23:21:01 +0200
Subject: [R] ggplot2::geom_path() in a loop problems.
In-Reply-To: <1958478645.4028110.1619203858479.JavaMail.zimbra@psyctc.org>
References: <CAGAA5bfvyOTi0r-zVVNGLjMfnveo+g82_-DW8RQu6z1+hMomww@mail.gmail.com>
 <1958478645.4028110.1619203858479.JavaMail.zimbra@psyctc.org>
Message-ID: <CAGAA5bdJaBwo6ZpfwZQhG201wfrMg+3-hwVRT6k5bF8-0Y=Q9A@mail.gmail.com>

On Fri, 23 Apr 2021 at 20:51, Chris Evans <chrishold at psyctc.org> wrote:
>
> I may be quite wrong but isn't the for loop in the second example simply
overwriting/replacing the first p2 with the second whereas the p1 version
is adding the paths to p1.
>
> (If you see what I mean, I don't think I have expressed that very well.)
>
> Very best (all),
>
> Chris


Hi Chris,
  Thanks for your email. However I don't think that is the problem.
  Same problem here:

library(ggplot2)

df <- data.frame(x = c(0,25,0,-25,0), y = c(25,0,-25,0,25))
p1 <- ggplot()
p1 <- p1 + geom_path(data = df,aes(x = x/1, y = y/1))
p1 <- p1 + geom_path(data = df,aes(x = x/2, y = y/2))
p1 <- p1 + xlim(-30,30)
p1 <- p1 + ylim(-30,30)
p1

df <- data.frame(x = c(0,25,0,-25,0), y = c(25,0,-25,0,25))
p3 <- ggplot()
idx <- 1
p3 <- p3 + geom_path(data = df,aes(x = x/idx, y = y/idx))
idx <- 2
p3 <- p3 + geom_path(data = df,aes(x = x/idx, y = y/idx))
p3 <- p3 + xlim(-30,30)
p3 <- p3 + ylim(-30,30)
p3

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Apr 24 23:36:14 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 24 Apr 2021 17:36:14 -0400
Subject: [R] Still puzzled about different graph
In-Reply-To: <CAGAA5bfz-4iqODetKu0FjE4D7kzuJFf4Q1K=zAVzW-fhsAPVBA@mail.gmail.com>
References: <CAGAA5bfz-4iqODetKu0FjE4D7kzuJFf4Q1K=zAVzW-fhsAPVBA@mail.gmail.com>
Message-ID: <f47b4200-8fac-b408-a878-909823a57b85@gmail.com>

On 24/04/2021 5:17 p.m., Martin M?ller Skarbiniks Pedersen wrote:
> Hi,
> 
>    Any ideas why I don't get the same graph out of p1 and p3?
> 
>   I have also posted it in the rstudio community without luck.
> https://community.rstudio.com/t/ggplot2-geom-path-in-a-loop/102716/2
> 
> library(ggplot2)
> 
> df <- data.frame(x = c(0,25,0,-25,0), y = c(25,0,-25,0,25))
> p1 <- ggplot()
> p1 <- p1 + geom_path(data = df,aes(x = x/1, y = y/1))
> p1 <- p1 + geom_path(data = df,aes(x = x/2, y = y/2))
> p1 <- p1 + xlim(-30,30)
> p1 <- p1 + ylim(-30,30)
> p1
> 
> df <- data.frame(x = c(0,25,0,-25,0), y = c(25,0,-25,0,25))
> p3 <- ggplot()
> idx <- 1
> p3 <- p3 + geom_path(data = df,aes(x = x/idx, y = y/idx))
> idx <- 2
> p3 <- p3 + geom_path(data = df,aes(x = x/idx, y = y/idx))
> p3 <- p3 + xlim(-30,30)
> p3 <- p3 + ylim(-30,30)
> p3
> 

I don't know where it says this in the docs, but generally speaking 
ggplot2 graphs don't evaluate everything until you print them.  So I'd 
expect p3's two geom_path components to be identical, even though you 
changed idx.

I think you can force evaluation before printing (using ggplot_build), 
but I don't think you can modify the graph after that, so you'll need 
two different variables instead of changing idx.

Duncan Murdoch


From tr@xp|@yer @end|ng |rom gm@||@com  Sun Apr 25 00:27:31 2021
From: tr@xp|@yer @end|ng |rom gm@||@com (=?UTF-8?Q?Martin_M=C3=B8ller_Skarbiniks_Pedersen?=)
Date: Sun, 25 Apr 2021 00:27:31 +0200
Subject: [R] Still puzzled about different graph
In-Reply-To: <f47b4200-8fac-b408-a878-909823a57b85@gmail.com>
References: <CAGAA5bfz-4iqODetKu0FjE4D7kzuJFf4Q1K=zAVzW-fhsAPVBA@mail.gmail.com>
 <f47b4200-8fac-b408-a878-909823a57b85@gmail.com>
Message-ID: <CAGAA5bcKPdEvUSKT_=kh9LTkXWJo4WmvCfsHvqRr_UYktKoniA@mail.gmail.com>

>
> I don't know where it says this in the docs, but generally speaking
> ggplot2 graphs don't evaluate everything until you print them.  So I'd
> expect p3's two geom_path components to be identical, even though you
> changed idx.
>
> I think you can force evaluation before printing (using ggplot_build),
> but I don't think you can modify the graph after that, so you'll need
> two different variables instead of changing idx.
>
> Duncan Murdoch


Thanks. Now I understand the problem and can find a solution.

Regards
Martin

	[[alternative HTML version deleted]]


From Den|@@Cou@|ne@u @end|ng |rom uott@w@@c@  Sat Apr 24 16:05:40 2021
From: Den|@@Cou@|ne@u @end|ng |rom uott@w@@c@ (Denis Cousineau)
Date: Sat, 24 Apr 2021 14:05:40 +0000
Subject: [R] [R-pkgs] superb (version 0.9.5.0) released to CRAN
Message-ID: <YQXPR0101MB08238462CC29689B25D6BE269C449@YQXPR0101MB0823.CANPRD01.PROD.OUTLOOK.COM>

Dear all, 

we are happy to announce that the package ``superb`` is now available on CRAN. 
https://CRAN.R-project.org/package=superb  

``superb`` (Summary statistics Plots with adjusted Error Bars) is a package that produces
plots of summary statistics with adjusted error bars. These bars are adjusted to
allow pairwise comparisons in both between and within-subject design (Baguley, 2012; https://doi.org/10.3758%2Fs13428-011-0123-7). 

The latest version 0.9.5.0 (Codename "95% confident") is a spin-off of the package 
``MeanPlot`` for Mathematica 10.0 and above (Cousineau, 2017; https://doi.org/10.5709/acp-0214-z).

With simple adjustments, you get raw confidence intervals or standard errors, but also
intervals adjusted for within-subject-designs and more.

The plots created are ggplot objects that can be fully customized for your purpose. The package generates advanced plots such as raincloud plots and violin plots, for example:
 

Examples for the usage of the main function ``superbPlot()``, the documentation of all functions, as well as vignettes can be found at 
https://dcousin3.github.io/superb/

If you notice a bug or have suggestions for improvements, please submit an issue with a minimal reproducible example at 
https://github.com/dcousin3/superb/issues/

A complete text describing the ``superb`` framework and philosophy is currently under 
considerations as Advances in Methods and Practices in Psychological Sciences.

Best, 
Denis Cousineau


Recipient of the 2021 mid-career award from the Canadian Society for Brain, Behavior and Cognitive Sciences
2020 APA Distinguished Scientific Awards for an Early Career Contribution to Psychology to M.-A. Goulet 
2016 R. Duncan Luce Outstanding Paper award for Learning curves as strong evidence for testing models: The case of EBRW

_______________________________________________
R-packages mailing list
R-packages at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-packages


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sun Apr 25 01:46:00 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sat, 24 Apr 2021 16:46:00 -0700
Subject: [R] ggplot2::geom_path() in a loop problems.
In-Reply-To: <CAGAA5bdJaBwo6ZpfwZQhG201wfrMg+3-hwVRT6k5bF8-0Y=Q9A@mail.gmail.com>
References: <CAGAA5bfvyOTi0r-zVVNGLjMfnveo+g82_-DW8RQu6z1+hMomww@mail.gmail.com>
 <1958478645.4028110.1619203858479.JavaMail.zimbra@psyctc.org>
 <CAGAA5bdJaBwo6ZpfwZQhG201wfrMg+3-hwVRT6k5bF8-0Y=Q9A@mail.gmail.com>
Message-ID: <224AA617-2198-42AC-B60C-D9B9912F1577@dcn.davis.ca.us>

Sigh. Don't do this. Setup your data frame with all the data you want to plot and give it to one geom. Use group columns such as factors (e.g. color, size, linetype, etc) to distinguish them.

Using multiple geoms with different mappings is usually a recipe for disappointment. It also fails to create legible legends.

On April 24, 2021 2:21:01 PM PDT, "Martin M?ller Skarbiniks Pedersen" <traxplayer at gmail.com> wrote:
>On Fri, 23 Apr 2021 at 20:51, Chris Evans <chrishold at psyctc.org> wrote:
>>
>> I may be quite wrong but isn't the for loop in the second example
>simply
>overwriting/replacing the first p2 with the second whereas the p1
>version
>is adding the paths to p1.
>>
>> (If you see what I mean, I don't think I have expressed that very
>well.)
>>
>> Very best (all),
>>
>> Chris
>
>
>Hi Chris,
>  Thanks for your email. However I don't think that is the problem.
>  Same problem here:
>
>library(ggplot2)
>
>df <- data.frame(x = c(0,25,0,-25,0), y = c(25,0,-25,0,25))
>p1 <- ggplot()
>p1 <- p1 + geom_path(data = df,aes(x = x/1, y = y/1))
>p1 <- p1 + geom_path(data = df,aes(x = x/2, y = y/2))
>p1 <- p1 + xlim(-30,30)
>p1 <- p1 + ylim(-30,30)
>p1
>
>df <- data.frame(x = c(0,25,0,-25,0), y = c(25,0,-25,0,25))
>p3 <- ggplot()
>idx <- 1
>p3 <- p3 + geom_path(data = df,aes(x = x/idx, y = y/idx))
>idx <- 2
>p3 <- p3 + geom_path(data = df,aes(x = x/idx, y = y/idx))
>p3 <- p3 + xlim(-30,30)
>p3 <- p3 + ylim(-30,30)
>p3
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From |@rry@john@on @end|ng |rom cobbcountycour|er@com  Sun Apr 25 16:52:28 2021
From: |@rry@john@on @end|ng |rom cobbcountycour|er@com (Larry Johnson)
Date: Sun, 25 Apr 2021 14:52:28 +0000
Subject: [R] help finding a starting point to diagnose inability to install
 or update packages
Message-ID: <MW3PR18MB35937E9C16EA3551831C5FCEFD439@MW3PR18MB3593.namprd18.prod.outlook.com>

Hi. Short version.  tidyverse disappeared from my packages, and won't install.  The initial failure stated I had an outdated broom package, but updates are failing too, not just on broom, but on all packages, and there is no meaningful error output on the installation failures.

I typically use RStudio on Fedora 33, but the problem I'm about to describe occurs whether I use RStudio or the text version.

To give you overview, here is the output from sessionInfo:


> sessionInfo()
R version 4.0.4 (2021-02-15)
Platform: x86_64-redhat-linux-gnu (64-bit)
Running under: Fedora 33 (Workstation Edition)

Matrix products: default
BLAS/LAPACK: /usr/lib64/libflexiblas.so.3.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base

loaded via a namespace (and not attached):
 [1] htmlwidgets_1.5.3   colorspace_2.0-0    scales_1.1.1        compiler_4.0.4
 [5] magrittr_2.0.1      R6_2.5.0            leaflet_2.0.4.1     htmltools_0.5.1.1
 [9] tools_4.0.4         crosstalk_1.1.1     digest_0.6.27       lifecycle_1.0.0
[13] munsell_0.5.0       rlang_0.4.10        CoprManager_0.3.7.1
>

After trying complete reinstalls of R, RStudio, and the CRAN repositories here's the last error messages I've gotten in my attempts to install and load tidyverse:


> install.packages(c("broom", "callr", "cli", "cpp11", "dbplyr", "haven", "highr", "knitr", "pillar", "processx", "RcppArmadillo", "reprex", "tibble", "tinytex", "vctrs", "viridis", "viridisLite", "withr"))
Install system packages...
> install.packages("tidyverse")
Install system packages...
> library(tidyverse)
Error: package or namespace load failed for ?tidyverse? in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]):
 namespace ?broom? 0.7.5 is being loaded, but >= 0.7.6 is required

Attempts to install or update broom fail with no output.

I've been searching for similar reports of failure here in these archives, on the RStudio forums, and on the internet and have found nothing that's a seamless match.  If I can't find anything I'll check out filing a bug report (I've never done it with R before).

Any help with a starting point in diagnosing this will be appreciated.

Thanks,


?Larry Johnson

Editor and Publisher

Cobb County Courier

404-664-2034

http://cobbcountycourier.com

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Apr 25 18:41:27 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 25 Apr 2021 12:41:27 -0400
Subject: [R] 
 help finding a starting point to diagnose inability to install
 or update packages
In-Reply-To: <MW3PR18MB35937E9C16EA3551831C5FCEFD439@MW3PR18MB3593.namprd18.prod.outlook.com>
References: <MW3PR18MB35937E9C16EA3551831C5FCEFD439@MW3PR18MB3593.namprd18.prod.outlook.com>
Message-ID: <36f82ca3-aebd-b6c0-6cc7-53a56c7acac1@gmail.com>

On 25/04/2021 10:52 a.m., Larry Johnson wrote:
> Hi. Short version.  tidyverse disappeared from my packages, and won't install.  The initial failure stated I had an outdated broom package, but updates are failing too, not just on broom, but on all packages, and there is no meaningful error output on the installation failures.
> 
> I typically use RStudio on Fedora 33, but the problem I'm about to describe occurs whether I use RStudio or the text version.
> 
> To give you overview, here is the output from sessionInfo:
> 
> 
>> sessionInfo()
> R version 4.0.4 (2021-02-15)
> Platform: x86_64-redhat-linux-gnu (64-bit)
> Running under: Fedora 33 (Workstation Edition)
> 
> Matrix products: default
> BLAS/LAPACK: /usr/lib64/libflexiblas.so.3.0
> 
> locale:
>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] stats     graphics  grDevices datasets  utils     methods   base
> 
> loaded via a namespace (and not attached):
>   [1] htmlwidgets_1.5.3   colorspace_2.0-0    scales_1.1.1        compiler_4.0.4
>   [5] magrittr_2.0.1      R6_2.5.0            leaflet_2.0.4.1     htmltools_0.5.1.1
>   [9] tools_4.0.4         crosstalk_1.1.1     digest_0.6.27       lifecycle_1.0.0
> [13] munsell_0.5.0       rlang_0.4.10        CoprManager_0.3.7.1
>>
> 
> After trying complete reinstalls of R, RStudio, and the CRAN repositories here's the last error messages I've gotten in my attempts to install and load tidyverse:
> 
> 
>> install.packages(c("broom", "callr", "cli", "cpp11", "dbplyr", "haven", "highr", "knitr", "pillar", "processx", "RcppArmadillo", "reprex", "tibble", "tinytex", "vctrs", "viridis", "viridisLite", "withr"))
> Install system packages...
>> install.packages("tidyverse")
> Install system packages...
>> library(tidyverse)
> Error: package or namespace load failed for ?tidyverse? in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]):
>   namespace ?broom? 0.7.5 is being loaded, but >= 0.7.6 is required
> 
> Attempts to install or update broom fail with no output.
> 
> I've been searching for similar reports of failure here in these archives, on the RStudio forums, and on the internet and have found nothing that's a seamless match.  If I can't find anything I'll check out filing a bug report (I've never done it with R before).
> 
> Any help with a starting point in diagnosing this will be appreciated.

Are you using install_github(), or otherwise installing non-CRAN 
versions?  If so, stop doing that. First, run update.packages(ask=FALSE)
to make sure you are up to date.  Then delete any package that is newer 
than the CRAN version, and reinstall it using the basic install.packages().

Here's code to compare versions:

CRAN <- available.packages()
here <- installed.packages()
for (i in seq_len(nrow(here))) {
   if (here[i, "Package"] %in% rownames(CRAN) &&
       package_version(here[i, "Version"]) >
         package_version(CRAN[here[i, "Package"], "Version"]))
     cat(here[i, c("Package", "Version")], "\n", sep=" " )
}

Duncan Murdoch


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sun Apr 25 18:47:21 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sun, 25 Apr 2021 09:47:21 -0700
Subject: [R] 
 help finding a starting point to diagnose inability to install
 or update packages
In-Reply-To: <MW3PR18MB35937E9C16EA3551831C5FCEFD439@MW3PR18MB3593.namprd18.prod.outlook.com>
References: <MW3PR18MB35937E9C16EA3551831C5FCEFD439@MW3PR18MB3593.namprd18.prod.outlook.com>
Message-ID: <BD5D3D64-CACB-448C-9A94-432A9F264889@dcn.davis.ca.us>

These are all contributed packages... don't file a bug report on R. Also, tidyverse is a rediculously sprawling meta-package that seems prone to faulty dependency data.

If you have a oroblem getting the right version of broom then focus on solving that. One possibility is that your CRAN mirror is not up-to-date.. try a different one or wait a few days for the updates to prooagate. Sometimes all it takes is to update or re-install the offending package. If you want to push the envelope you can use devtools::install_github or similar to bypass CRAN, but it is possible that that version had a problem identified in the CRAN review that you might have trouble with.

Whst is your options("repos") set to?

On April 25, 2021 7:52:28 AM PDT, Larry Johnson <larry.johnson at cobbcountycourier.com> wrote:
>Hi. Short version.  tidyverse disappeared from my packages, and won't
>install.  The initial failure stated I had an outdated broom package,
>but updates are failing too, not just on broom, but on all packages,
>and there is no meaningful error output on the installation failures.
>
>I typically use RStudio on Fedora 33, but the problem I'm about to
>describe occurs whether I use RStudio or the text version.
>
>To give you overview, here is the output from sessionInfo:
>
>
>> sessionInfo()
>R version 4.0.4 (2021-02-15)
>Platform: x86_64-redhat-linux-gnu (64-bit)
>Running under: Fedora 33 (Workstation Edition)
>
>Matrix products: default
>BLAS/LAPACK: /usr/lib64/libflexiblas.so.3.0
>
>locale:
> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C
>[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
>attached base packages:
>[1] stats     graphics  grDevices datasets  utils     methods   base
>
>loaded via a namespace (and not attached):
>[1] htmlwidgets_1.5.3   colorspace_2.0-0    scales_1.1.1       
>compiler_4.0.4
>[5] magrittr_2.0.1      R6_2.5.0            leaflet_2.0.4.1    
>htmltools_0.5.1.1
>[9] tools_4.0.4         crosstalk_1.1.1     digest_0.6.27      
>lifecycle_1.0.0
>[13] munsell_0.5.0       rlang_0.4.10        CoprManager_0.3.7.1
>>
>
>After trying complete reinstalls of R, RStudio, and the CRAN
>repositories here's the last error messages I've gotten in my attempts
>to install and load tidyverse:
>
>
>> install.packages(c("broom", "callr", "cli", "cpp11", "dbplyr",
>"haven", "highr", "knitr", "pillar", "processx", "RcppArmadillo",
>"reprex", "tibble", "tinytex", "vctrs", "viridis", "viridisLite",
>"withr"))
>Install system packages...
>> install.packages("tidyverse")
>Install system packages...
>> library(tidyverse)
>Error: package or namespace load failed for ?tidyverse? in
>loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), versionCheck =
>vI[[j]]):
> namespace ?broom? 0.7.5 is being loaded, but >= 0.7.6 is required
>
>Attempts to install or update broom fail with no output.
>
>I've been searching for similar reports of failure here in these
>archives, on the RStudio forums, and on the internet and have found
>nothing that's a seamless match.  If I can't find anything I'll check
>out filing a bug report (I've never done it with R before).
>
>Any help with a starting point in diagnosing this will be appreciated.
>
>Thanks,
>
>
>?Larry Johnson
>
>Editor and Publisher
>
>Cobb County Courier
>
>404-664-2034
>
>http://cobbcountycourier.com
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From jrkr|de@u @end|ng |rom gm@||@com  Sun Apr 25 19:30:33 2021
From: jrkr|de@u @end|ng |rom gm@||@com (John Kane)
Date: Sun, 25 Apr 2021 13:30:33 -0400
Subject: [R] Query
In-Reply-To: <CH2PR05MB701628A5C8ECFCCFA4EA49CDDA459@CH2PR05MB7016.namprd05.prod.outlook.com>
References: <CH2PR05MB701628A5C8ECFCCFA4EA49CDDA459@CH2PR05MB7016.namprd05.prod.outlook.com>
Message-ID: <CAKZQJMDvuQQktSri=M8x7g384gsjVihv5133-LUJebjbAaOHxA@mail.gmail.com>

What package has the irf function?

On Fri, 23 Apr 2021 at 09:34, Sun Yong Kim
<sunyong.kim at kellogg.northwestern.edu> wrote:
>
> Hi
>
> I have been trying to circulate a question but my question keeps getting rejected. Let me try again via email. The message is below:
>
> I am trying to change the tick size for IRF graphs that I created using the following code below:
>
> par(mfrow=c(2,3))
> IRF_F2 <- irf(SVARmod1, impulse="deltaw2",
>           response=c("Belgium","France","Germany","Italy","Netherlands"),
> n.ahead=60)
> plot(IRF_F2,ylim=c(-0.5,0.3), plot.type="single", main="US Wealth Share
> Shock")
>
> The code gives me the following IRFs I have attached to this email. However the tick intervals is way too small and I want to change it to intervals of 10. I was thinking something like:
>
> par(mfrow=c(2,3))
> IRF_F2 <- irf(SVARmod1, impulse="deltaw2",
>
> response=c("Belgium","France","Germany","Italy","Netherlands"),
> n.ahead=60)
> plot(IRF_F2,ylim=c(-0.5,0.3), plot.type="single", main="US Wealth
> Share Shock", xaxt="n")
> axis(side= 1, at = c(10, 20, 30, 40, 50, 60))
>
> But it doesn't work. Any suggestions on how to reduce the tick interval?
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
John Kane
Kingston ON Canada


From jrkr|de@u @end|ng |rom gm@||@com  Sun Apr 25 19:46:55 2021
From: jrkr|de@u @end|ng |rom gm@||@com (John Kane)
Date: Sun, 25 Apr 2021 13:46:55 -0400
Subject: [R] input string ... cannot be translated to UTF-8,
 is it valid in 'ANSI_X3.4-1968'?
In-Reply-To: <e03b748c-414b-cc64-083b-5e4e2f5a82e8@gmail.com>
References: <05d5dca9-283d-d1d5-a807-311ac0b05afb@effectivedefense.org>
 <e03b748c-414b-cc64-083b-5e4e2f5a82e8@gmail.com>
Message-ID: <CAKZQJMBauBBJZ1_H42L3kEfBnNujnVkm4JvNcszUa69Tp7+yVw@mail.gmail.com>

The tab format seems to read in with no problem.

On Thu, 22 Apr 2021 at 23:08, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>
> On 22/04/2021 9:25 p.m., Spencer Graves wrote:
> > Hello:
> >
> >
> >         What if anything should I do regarding notes from either "load" or
> > "attach" that, "input string ... cannot be translated to UTF-8, is it
> > valid in 'ANSI_X3.4-1968'?"?
>
> First, ANSI_X3.4-1968  is an official name for for a version of Ascii.
> It appears in the file near the start, where I believe it records the
> native encoding in place when the file was written, so readers using a
> different encoding can translate.
>
> Your actual file appears to have been encoded in UTF-8, but not marked
> as such.  You're lucky you read it on macOS, where UTF-8 is the native
> encoding, since the reader probably recognized the bytes weren't ascii
> bytes (and warned you about that), then just left them alone.  If you
> read that file on Windows you'd likely get junk for those entries.
>
> For your interest, here's a dump of the start of your file, after
> gunzipping it:
>
> 00000000  52 44 58 33 0a 58 0a 00  00 00 03 00 03 06 00 00
> |RDX3.X..........|
> 00000010  03 05 00 00 00 00 0e 41  4e 53 49 5f 58 33 2e 34
> |.......ANSI_X3.4|
> 00000020  2d 31 39 36 38 00 00 04  02 00 00 00 01 00 04 00
> |-1968...........|
> 00000030  09 00 00 00 01 78 00 00  03 13 00 00 00 10 00 00
> |.....x..........|
> 00000040  02 0e 00 00 02 6e 40 90  0c 00 00 00 00 00 40 90
> |.....n at .......@.|
> 00000050  44 00 00 00 00 00 40 10  00 00 00 00 00 00 40 7c
> |D..... at .......@||
>
> Duncan Murdoch
>
> >
> >
> >         I'm running R 4.0.5 under macOS 11.2.3;  see "sessionInfo()" and
> > detailed instructions below on the precise file I dowloaded from the web
> > and tried to read.
> >
> >
> >         I may be able to get what I want just ignoring this.  However, I'd
> > like to know how to fix this.
> >
> >
> >         Thanks,
> >         Spencer Graves
> >
> >
> > sessionInfo()
> > R version 4.0.5 (2021-03-31)
> > Platform: x86_64-apple-darwin17.0 (64-bit)
> > Running under: macOS Big Sur 10.16
> >
> > Matrix products: default
> > LAPACK:
> > /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
> >
> > locale:
> > [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
> >
> > attached base packages:
> > [1] stats     graphics  grDevices utils     datasets  methods   base
> >
> > loaded via a namespace (and not attached):
> >    [1] compiler_4.0.5    htmltools_0.5.1.1 tools_4.0.5       yaml_2.2.1
> >
> >    [5] tinytex_0.31      rmarkdown_2.7     knitr_1.31
> > digest_0.6.27
> >    [9] xfun_0.22         rlang_0.4.10      evaluate_0.14
> >   > search()
> >    [1] ".GlobalEnv"                "file:NAVCO 1.3 List.RData"
> >    [3] "file:NAVCO 1.3 List.RData" "tools:rstudio"
> >    [5] "package:stats"             "package:graphics"
> >    [7] "package:grDevices"         "package:utils"
> >    [9] "package:datasets"          "package:methods"
> > [11] "Autoloads"                 "package:base"
> >
> >
> > *** To get the file I used for this, I went to
> > "https://www.ericachenoweth.com/research".  From there I clicked
> > "Version 1.3".  This took me to
> >
> >
> > https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/ON9XND
> >
> >
> > I then clicked the "Download" icon to the right of "NAVCO 1.3 List.tab".
> >    This gave me 5 "Download Options", one of which was "RData Format";  I
> > selected that.  This downloaded "NAVCO 1.3 List.RData", which I moved to
> > getwd().  Then I did 'load("NAVCO 1.3 List.RData")' and 'attach("NAVCO
> > 1.3 List.RData")'.  Both of those gave me 8 repetitions of a message
> > like "input string ... cannot be translated to UTF-8, is it valid in
> > 'ANSI_X3.4-1968'?" with different values substituted for "...".
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
John Kane
Kingston ON Canada


From |@rry@john@on @end|ng |rom cobbcountycour|er@com  Sun Apr 25 23:50:46 2021
From: |@rry@john@on @end|ng |rom cobbcountycour|er@com (Larry Johnson)
Date: Sun, 25 Apr 2021 21:50:46 +0000
Subject: [R] 
 help finding a starting point to diagnose inability to install
 or update packages
In-Reply-To: <36f82ca3-aebd-b6c0-6cc7-53a56c7acac1@gmail.com>
References: <MW3PR18MB35937E9C16EA3551831C5FCEFD439@MW3PR18MB3593.namprd18.prod.outlook.com>,
 <36f82ca3-aebd-b6c0-6cc7-53a56c7acac1@gmail.com>
Message-ID: <MW3PR18MB3593E5EC644658BECF2329B3FD439@MW3PR18MB3593.namprd18.prod.outlook.com>

It was pointed out to me by Jeff Newmiller that I should have been hitting "reply all" so that others could see the thread and make comment, corrections, or benefit from any solution.

So, I'm going to summarize the end result.

Duncan Murdoch walked me through some diagnostic steps, and what ultimately worked was to run

remove.packages("broom")
install.packages("broom")

and then repeat that for each of the four packages that attempts to load tidyverse indicated had dependency issues (I know that last sentence was ungrammatical, but you probably get my drift).

I'd still like to know why updating packages in bulk isn't working for me, but I can move ahead for now, and I'll figure out how to fix that later.

So thanks Duncan.


?Larry Johnson

Editor and Publisher

Cobb County Courier

404-664-2034

http://cobbcountycourier.com

________________________________
From: Duncan Murdoch <murdoch.duncan at gmail.com>
Sent: Sunday, April 25, 2021 12:41 PM
To: Larry Johnson <larry.johnson at cobbcountycourier.com>; r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] help finding a starting point to diagnose inability to install or update packages

On 25/04/2021 10:52 a.m., Larry Johnson wrote:
> Hi. Short version.  tidyverse disappeared from my packages, and won't install.  The initial failure stated I had an outdated broom package, but updates are failing too, not just on broom, but on all packages, and there is no meaningful error output on the installation failures.
>
> I typically use RStudio on Fedora 33, but the problem I'm about to describe occurs whether I use RStudio or the text version.
>
> To give you overview, here is the output from sessionInfo:
>
>
>> sessionInfo()
> R version 4.0.4 (2021-02-15)
> Platform: x86_64-redhat-linux-gnu (64-bit)
> Running under: Fedora 33 (Workstation Edition)
>
> Matrix products: default
> BLAS/LAPACK: /usr/lib64/libflexiblas.so.3.0
>
> locale:
>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices datasets  utils     methods   base
>
> loaded via a namespace (and not attached):
>   [1] htmlwidgets_1.5.3   colorspace_2.0-0    scales_1.1.1        compiler_4.0.4
>   [5] magrittr_2.0.1      R6_2.5.0            leaflet_2.0.4.1     htmltools_0.5.1.1
>   [9] tools_4.0.4         crosstalk_1.1.1     digest_0.6.27       lifecycle_1.0.0
> [13] munsell_0.5.0       rlang_0.4.10        CoprManager_0.3.7.1
>>
>
> After trying complete reinstalls of R, RStudio, and the CRAN repositories here's the last error messages I've gotten in my attempts to install and load tidyverse:
>
>
>> install.packages(c("broom", "callr", "cli", "cpp11", "dbplyr", "haven", "highr", "knitr", "pillar", "processx", "RcppArmadillo", "reprex", "tibble", "tinytex", "vctrs", "viridis", "viridisLite", "withr"))
> Install system packages...
>> install.packages("tidyverse")
> Install system packages...
>> library(tidyverse)
> Error: package or namespace load failed for ?tidyverse? in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]):
>   namespace ?broom? 0.7.5 is being loaded, but >= 0.7.6 is required
>
> Attempts to install or update broom fail with no output.
>
> I've been searching for similar reports of failure here in these archives, on the RStudio forums, and on the internet and have found nothing that's a seamless match.  If I can't find anything I'll check out filing a bug report (I've never done it with R before).
>
> Any help with a starting point in diagnosing this will be appreciated.

Are you using install_github(), or otherwise installing non-CRAN
versions?  If so, stop doing that. First, run update.packages(ask=FALSE)
to make sure you are up to date.  Then delete any package that is newer
than the CRAN version, and reinstall it using the basic install.packages().

Here's code to compare versions:

CRAN <- available.packages()
here <- installed.packages()
for (i in seq_len(nrow(here))) {
   if (here[i, "Package"] %in% rownames(CRAN) &&
       package_version(here[i, "Version"]) >
         package_version(CRAN[here[i, "Package"], "Version"]))
     cat(here[i, c("Package", "Version")], "\n", sep=" " )
}

Duncan Murdoch

	[[alternative HTML version deleted]]


From h@w|ckh@m @end|ng |rom gm@||@com  Mon Apr 26 01:14:13 2021
From: h@w|ckh@m @end|ng |rom gm@||@com (Hadley Wickham)
Date: Sun, 25 Apr 2021 18:14:13 -0500
Subject: [R] 
 help finding a starting point to diagnose inability to install
 or update packages
In-Reply-To: <MW3PR18MB3593E5EC644658BECF2329B3FD439@MW3PR18MB3593.namprd18.prod.outlook.com>
References: <MW3PR18MB35937E9C16EA3551831C5FCEFD439@MW3PR18MB3593.namprd18.prod.outlook.com>
 <36f82ca3-aebd-b6c0-6cc7-53a56c7acac1@gmail.com>
 <MW3PR18MB3593E5EC644658BECF2329B3FD439@MW3PR18MB3593.namprd18.prod.outlook.com>
Message-ID: <CABdHhvGdEs=EttzjRemxQxOYWVe8WZLjJAgd8Ek6etiPuNQdwg@mail.gmail.com>

If this happens again in the future, you might try the development
version of pak:

install.packages("pak", repos = "https://r-lib.github.io/p/pak/dev/")
pak::pak("tidyverse")

pak automatically diagnoses a number of common problems that causes
install.packages() to fail.

Hadley

On Sun, Apr 25, 2021 at 4:51 PM Larry Johnson
<larry.johnson at cobbcountycourier.com> wrote:
>
> It was pointed out to me by Jeff Newmiller that I should have been hitting "reply all" so that others could see the thread and make comment, corrections, or benefit from any solution.
>
> So, I'm going to summarize the end result.
>
> Duncan Murdoch walked me through some diagnostic steps, and what ultimately worked was to run
>
> remove.packages("broom")
> install.packages("broom")
>
> and then repeat that for each of the four packages that attempts to load tidyverse indicated had dependency issues (I know that last sentence was ungrammatical, but you probably get my drift).
>
> I'd still like to know why updating packages in bulk isn't working for me, but I can move ahead for now, and I'll figure out how to fix that later.
>
> So thanks Duncan.
>
>
> Larry Johnson
>
> Editor and Publisher
>
> Cobb County Courier
>
> 404-664-2034
>
> http://cobbcountycourier.com
>
> ________________________________
> From: Duncan Murdoch <murdoch.duncan at gmail.com>
> Sent: Sunday, April 25, 2021 12:41 PM
> To: Larry Johnson <larry.johnson at cobbcountycourier.com>; r-help at r-project.org <r-help at r-project.org>
> Subject: Re: [R] help finding a starting point to diagnose inability to install or update packages
>
> On 25/04/2021 10:52 a.m., Larry Johnson wrote:
> > Hi. Short version.  tidyverse disappeared from my packages, and won't install.  The initial failure stated I had an outdated broom package, but updates are failing too, not just on broom, but on all packages, and there is no meaningful error output on the installation failures.
> >
> > I typically use RStudio on Fedora 33, but the problem I'm about to describe occurs whether I use RStudio or the text version.
> >
> > To give you overview, here is the output from sessionInfo:
> >
> >
> >> sessionInfo()
> > R version 4.0.4 (2021-02-15)
> > Platform: x86_64-redhat-linux-gnu (64-bit)
> > Running under: Fedora 33 (Workstation Edition)
> >
> > Matrix products: default
> > BLAS/LAPACK: /usr/lib64/libflexiblas.so.3.0
> >
> > locale:
> >   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> >   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> >   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> >   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
> >   [9] LC_ADDRESS=C               LC_TELEPHONE=C
> > [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> >
> > attached base packages:
> > [1] stats     graphics  grDevices datasets  utils     methods   base
> >
> > loaded via a namespace (and not attached):
> >   [1] htmlwidgets_1.5.3   colorspace_2.0-0    scales_1.1.1        compiler_4.0.4
> >   [5] magrittr_2.0.1      R6_2.5.0            leaflet_2.0.4.1     htmltools_0.5.1.1
> >   [9] tools_4.0.4         crosstalk_1.1.1     digest_0.6.27       lifecycle_1.0.0
> > [13] munsell_0.5.0       rlang_0.4.10        CoprManager_0.3.7.1
> >>
> >
> > After trying complete reinstalls of R, RStudio, and the CRAN repositories here's the last error messages I've gotten in my attempts to install and load tidyverse:
> >
> >
> >> install.packages(c("broom", "callr", "cli", "cpp11", "dbplyr", "haven", "highr", "knitr", "pillar", "processx", "RcppArmadillo", "reprex", "tibble", "tinytex", "vctrs", "viridis", "viridisLite", "withr"))
> > Install system packages...
> >> install.packages("tidyverse")
> > Install system packages...
> >> library(tidyverse)
> > Error: package or namespace load failed for ?tidyverse? in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]):
> >   namespace ?broom? 0.7.5 is being loaded, but >= 0.7.6 is required
> >
> > Attempts to install or update broom fail with no output.
> >
> > I've been searching for similar reports of failure here in these archives, on the RStudio forums, and on the internet and have found nothing that's a seamless match.  If I can't find anything I'll check out filing a bug report (I've never done it with R before).
> >
> > Any help with a starting point in diagnosing this will be appreciated.
>
> Are you using install_github(), or otherwise installing non-CRAN
> versions?  If so, stop doing that. First, run update.packages(ask=FALSE)
> to make sure you are up to date.  Then delete any package that is newer
> than the CRAN version, and reinstall it using the basic install.packages().
>
> Here's code to compare versions:
>
> CRAN <- available.packages()
> here <- installed.packages()
> for (i in seq_len(nrow(here))) {
>    if (here[i, "Package"] %in% rownames(CRAN) &&
>        package_version(here[i, "Version"]) >
>          package_version(CRAN[here[i, "Package"], "Version"]))
>      cat(here[i, c("Package", "Version")], "\n", sep=" " )
> }
>
> Duncan Murdoch
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
http://hadley.nz


From |@rry@john@on @end|ng |rom cobbcountycour|er@com  Mon Apr 26 01:24:02 2021
From: |@rry@john@on @end|ng |rom cobbcountycour|er@com (Larry Johnson)
Date: Sun, 25 Apr 2021 23:24:02 +0000
Subject: [R] 
 help finding a starting point to diagnose inability to install
 or update packages
In-Reply-To: <CABdHhvGdEs=EttzjRemxQxOYWVe8WZLjJAgd8Ek6etiPuNQdwg@mail.gmail.com>
References: <MW3PR18MB35937E9C16EA3551831C5FCEFD439@MW3PR18MB3593.namprd18.prod.outlook.com>
 <36f82ca3-aebd-b6c0-6cc7-53a56c7acac1@gmail.com>
 <MW3PR18MB3593E5EC644658BECF2329B3FD439@MW3PR18MB3593.namprd18.prod.outlook.com>,
 <CABdHhvGdEs=EttzjRemxQxOYWVe8WZLjJAgd8Ek6etiPuNQdwg@mail.gmail.com>
Message-ID: <MW3PR18MB35934B9895FF6FD4AB39D556FD439@MW3PR18MB3593.namprd18.prod.outlook.com>

I'll put that in my notes.  Thanks!


?Larry Johnson

Editor and Publisher

Cobb County Courier

404-664-2034

http://cobbcountycourier.com

________________________________
From: Hadley Wickham <h.wickham at gmail.com>
Sent: Sunday, April 25, 2021 7:14 PM
To: Larry Johnson <larry.johnson at cobbcountycourier.com>
Cc: Duncan Murdoch <murdoch.duncan at gmail.com>; r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] help finding a starting point to diagnose inability to install or update packages

If this happens again in the future, you might try the development
version of pak:

install.packages("pak", repos = "https://r-lib.github.io/p/pak/dev/")
pak::pak("tidyverse")

pak automatically diagnoses a number of common problems that causes
install.packages() to fail.

Hadley

On Sun, Apr 25, 2021 at 4:51 PM Larry Johnson
<larry.johnson at cobbcountycourier.com> wrote:
>
> It was pointed out to me by Jeff Newmiller that I should have been hitting "reply all" so that others could see the thread and make comment, corrections, or benefit from any solution.
>
> So, I'm going to summarize the end result.
>
> Duncan Murdoch walked me through some diagnostic steps, and what ultimately worked was to run
>
> remove.packages("broom")
> install.packages("broom")
>
> and then repeat that for each of the four packages that attempts to load tidyverse indicated had dependency issues (I know that last sentence was ungrammatical, but you probably get my drift).
>
> I'd still like to know why updating packages in bulk isn't working for me, but I can move ahead for now, and I'll figure out how to fix that later.
>
> So thanks Duncan.
>
>
> Larry Johnson
>
> Editor and Publisher
>
> Cobb County Courier
>
> 404-664-2034
>
> http://cobbcountycourier.com
>
> ________________________________
> From: Duncan Murdoch <murdoch.duncan at gmail.com>
> Sent: Sunday, April 25, 2021 12:41 PM
> To: Larry Johnson <larry.johnson at cobbcountycourier.com>; r-help at r-project.org <r-help at r-project.org>
> Subject: Re: [R] help finding a starting point to diagnose inability to install or update packages
>
> On 25/04/2021 10:52 a.m., Larry Johnson wrote:
> > Hi. Short version.  tidyverse disappeared from my packages, and won't install.  The initial failure stated I had an outdated broom package, but updates are failing too, not just on broom, but on all packages, and there is no meaningful error output on the installation failures.
> >
> > I typically use RStudio on Fedora 33, but the problem I'm about to describe occurs whether I use RStudio or the text version.
> >
> > To give you overview, here is the output from sessionInfo:
> >
> >
> >> sessionInfo()
> > R version 4.0.4 (2021-02-15)
> > Platform: x86_64-redhat-linux-gnu (64-bit)
> > Running under: Fedora 33 (Workstation Edition)
> >
> > Matrix products: default
> > BLAS/LAPACK: /usr/lib64/libflexiblas.so.3.0
> >
> > locale:
> >   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> >   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> >   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> >   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
> >   [9] LC_ADDRESS=C               LC_TELEPHONE=C
> > [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> >
> > attached base packages:
> > [1] stats     graphics  grDevices datasets  utils     methods   base
> >
> > loaded via a namespace (and not attached):
> >   [1] htmlwidgets_1.5.3   colorspace_2.0-0    scales_1.1.1        compiler_4.0.4
> >   [5] magrittr_2.0.1      R6_2.5.0            leaflet_2.0.4.1     htmltools_0.5.1.1
> >   [9] tools_4.0.4         crosstalk_1.1.1     digest_0.6.27       lifecycle_1.0.0
> > [13] munsell_0.5.0       rlang_0.4.10        CoprManager_0.3.7.1
> >>
> >
> > After trying complete reinstalls of R, RStudio, and the CRAN repositories here's the last error messages I've gotten in my attempts to install and load tidyverse:
> >
> >
> >> install.packages(c("broom", "callr", "cli", "cpp11", "dbplyr", "haven", "highr", "knitr", "pillar", "processx", "RcppArmadillo", "reprex", "tibble", "tinytex", "vctrs", "viridis", "viridisLite", "withr"))
> > Install system packages...
> >> install.packages("tidyverse")
> > Install system packages...
> >> library(tidyverse)
> > Error: package or namespace load failed for ?tidyverse? in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]):
> >   namespace ?broom? 0.7.5 is being loaded, but >= 0.7.6 is required
> >
> > Attempts to install or update broom fail with no output.
> >
> > I've been searching for similar reports of failure here in these archives, on the RStudio forums, and on the internet and have found nothing that's a seamless match.  If I can't find anything I'll check out filing a bug report (I've never done it with R before).
> >
> > Any help with a starting point in diagnosing this will be appreciated.
>
> Are you using install_github(), or otherwise installing non-CRAN
> versions?  If so, stop doing that. First, run update.packages(ask=FALSE)
> to make sure you are up to date.  Then delete any package that is newer
> than the CRAN version, and reinstall it using the basic install.packages().
>
> Here's code to compare versions:
>
> CRAN <- available.packages()
> here <- installed.packages()
> for (i in seq_len(nrow(here))) {
>    if (here[i, "Package"] %in% rownames(CRAN) &&
>        package_version(here[i, "Version"]) >
>          package_version(CRAN[here[i, "Package"], "Version"]))
>      cat(here[i, c("Package", "Version")], "\n", sep=" " )
> }
>
> Duncan Murdoch
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



--
http://hadley.nz

	[[alternative HTML version deleted]]


From phii m@iii@g oii phiiipsmith@c@  Mon Apr 26 02:39:56 2021
From: phii m@iii@g oii phiiipsmith@c@ (phii m@iii@g oii phiiipsmith@c@)
Date: Sun, 25 Apr 2021 20:39:56 -0400
Subject: [R] Writing a function that calls the gt() function
Message-ID: <eaaeb9bec596b345b60b8f4c04511f09@philipsmith.ca>

I am trying to write a function that produces a table using the gt() 
function. My reprex succeeds in producing a simple table by transposing 
a data frame and creating a table from it. But when I try to convert 
this code into a function, in order to generalize for a variety of 
different data frames, I get stuck trying to blank-out the first column 
name and make the other column names bold. How can I refer to the 
columns properly in the cols_label() function in a general way? Any help 
much appreciated. Phil

\library(gt)
library(tidyverse)

# Create example data frame
blank <- c("colnam1","colnam2","colnam3","colnam4","colnam5")
rownam1 <- 1:5
rownam2 <- rnorm(5)
df <- data.frame(blank=blank,rownam1=rownam1,rownam2=rownam2)

# Transpose the data frame and prepare it for gt()
tbl_df <- as.data.frame(t(df))
hold <- rownames(tbl_df)
colnam <- tbl_df[1,]
colnames(tbl_df) <- colnam
tbl_df <- tbl_df[2:nrow(tbl_df),]
rownames(tbl_df) <- NULL
tbl_df <- mutate(tbl_df,blank=hold[2:length(hold)])
tbl_df <- select(tbl_df,blank,everything())

# Create the gt() table - this works
gt_tbl <- gt(data=tbl_df)
gt_tbl <- tab_options(gt_tbl,table.font.size=24,
     container.width = 900)
gt_tbl <- tab_header(gt_tbl,
     title=md(html(paste0("**","Example title","**"))))
gt_tbl <- cols_align(gt_tbl,
     align=c("left"),
     columns=vars(`blank`))
gt_tbl <- cols_label(gt_tbl,
     blank="",
     colnam1=md("**colnam1**"),
     colnam2=md("**colnam2**"),
     colnam3=md("**colnam3**"),
     colnam4=md("**colnam4**"),
     colnam5=md("**colnam5**"))
gt_tbl

# Now do the same = with a function
tblfunc <- function(df) {
   gt_tbl <- gt(data=df)
   gt_tbl <- tab_options(gt_tbl,table.font.size=24,
       container.width = 900)
   gt_tbl <- tab_header(gt_tbl,
       title=md(html(paste0("**","Example title","**"))))
   gt_tbl <- cols_align(gt_tbl,
       align=c("left"),
       columns=vars(`blank`))
   gt_tbl <- cols_label(gt_tbl,
     ????)
}


From @unyong@k|m @end|ng |rom ke||ogg@northwe@tern@edu  Sun Apr 25 19:31:45 2021
From: @unyong@k|m @end|ng |rom ke||ogg@northwe@tern@edu (Sun Yong Kim)
Date: Sun, 25 Apr 2021 17:31:45 +0000
Subject: [R] Query
In-Reply-To: <CAKZQJMDvuQQktSri=M8x7g384gsjVihv5133-LUJebjbAaOHxA@mail.gmail.com>
References: <CH2PR05MB701628A5C8ECFCCFA4EA49CDDA459@CH2PR05MB7016.namprd05.prod.outlook.com>,
 <CAKZQJMDvuQQktSri=M8x7g384gsjVihv5133-LUJebjbAaOHxA@mail.gmail.com>
Message-ID: <CH2PR05MB70164FE352DCE451CBD2B556DA439@CH2PR05MB7016.namprd05.prod.outlook.com>

vars package
________________________________
From: John Kane <jrkrideau at gmail.com>
Sent: Sunday, April 25, 2021 12:30 PM
To: Sun Yong Kim <sunyong.kim at kellogg.northwestern.edu>
Cc: r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] Query

What package has the irf function?

On Fri, 23 Apr 2021 at 09:34, Sun Yong Kim
<sunyong.kim at kellogg.northwestern.edu> wrote:
>
> Hi
>
> I have been trying to circulate a question but my question keeps getting rejected. Let me try again via email. The message is below:
>
> I am trying to change the tick size for IRF graphs that I created using the following code below:
>
> par(mfrow=c(2,3))
> IRF_F2 <- irf(SVARmod1, impulse="deltaw2",
>           response=c("Belgium","France","Germany","Italy","Netherlands"),
> n.ahead=60)
> plot(IRF_F2,ylim=c(-0.5,0.3), plot.type="single", main="US Wealth Share
> Shock")
>
> The code gives me the following IRFs I have attached to this email. However the tick intervals is way too small and I want to change it to intervals of 10. I was thinking something like:
>
> par(mfrow=c(2,3))
> IRF_F2 <- irf(SVARmod1, impulse="deltaw2",
>
> response=c("Belgium","France","Germany","Italy","Netherlands"),
> n.ahead=60)
> plot(IRF_F2,ylim=c(-0.5,0.3), plot.type="single", main="US Wealth
> Share Shock", xaxt="n")
> axis(side= 1, at = c(10, 20, 30, 40, 50, 60))
>
> But it doesn't work. Any suggestions on how to reduce the tick interval?
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Dq0X2DkFhyF93HkjWTBQKhk!ANzmkRglqFkZT0F8ICLJH_RiaYVwyaJXw8dNqctnUZELgnK40ZBoSLhCQEnOFFw68r29nt9j0mkpJ2fB$
> PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Dq0X2DkFhyF93HkjWTBQKhk!ANzmkRglqFkZT0F8ICLJH_RiaYVwyaJXw8dNqctnUZELgnK40ZBoSLhCQEnOFFw68r29nt9j0kVB9796$
> and provide commented, minimal, self-contained, reproducible code.



--
John Kane
Kingston ON Canada

	[[alternative HTML version deleted]]


From drj|m|emon @end|ng |rom gm@||@com  Mon Apr 26 11:03:05 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Mon, 26 Apr 2021 19:03:05 +1000
Subject: [R] Query
In-Reply-To: <CH2PR05MB70164FE352DCE451CBD2B556DA439@CH2PR05MB7016.namprd05.prod.outlook.com>
References: <CH2PR05MB701628A5C8ECFCCFA4EA49CDDA459@CH2PR05MB7016.namprd05.prod.outlook.com>
 <CAKZQJMDvuQQktSri=M8x7g384gsjVihv5133-LUJebjbAaOHxA@mail.gmail.com>
 <CH2PR05MB70164FE352DCE451CBD2B556DA439@CH2PR05MB7016.namprd05.prod.outlook.com>
Message-ID: <CA+8X3fUrrauLZJKtK_K_qT-RHAg56UtT0bCH4g8P=Yt1zO+5mA@mail.gmail.com>

Hi SunYong,
The docs are not exactly clear on this, but you might try adding
axes=FALSE instead of xaxt="n" and then calling both axes separately.

Jim


On Mon, Apr 26, 2021 at 5:28 PM Sun Yong Kim
<sunyong.kim at kellogg.northwestern.edu> wrote:
>
> vars package
> ________________________________
> From: John Kane <jrkrideau at gmail.com>
> Sent: Sunday, April 25, 2021 12:30 PM
> To: Sun Yong Kim <sunyong.kim at kellogg.northwestern.edu>
> Cc: r-help at r-project.org <r-help at r-project.org>
> Subject: Re: [R] Query
>
> What package has the irf function?
>
> On Fri, 23 Apr 2021 at 09:34, Sun Yong Kim
> <sunyong.kim at kellogg.northwestern.edu> wrote:
> >
> > Hi
> >
> > I have been trying to circulate a question but my question keeps getting rejected. Let me try again via email. The message is below:
> >
> > I am trying to change the tick size for IRF graphs that I created using the following code below:
> >
> > par(mfrow=c(2,3))
> > IRF_F2 <- irf(SVARmod1, impulse="deltaw2",
> >           response=c("Belgium","France","Germany","Italy","Netherlands"),
> > n.ahead=60)
> > plot(IRF_F2,ylim=c(-0.5,0.3), plot.type="single", main="US Wealth Share
> > Shock")
> >
> > The code gives me the following IRFs I have attached to this email. However the tick intervals is way too small and I want to change it to intervals of 10. I was thinking something like:
> >
> > par(mfrow=c(2,3))
> > IRF_F2 <- irf(SVARmod1, impulse="deltaw2",
> >
> > response=c("Belgium","France","Germany","Italy","Netherlands"),
> > n.ahead=60)
> > plot(IRF_F2,ylim=c(-0.5,0.3), plot.type="single", main="US Wealth
> > Share Shock", xaxt="n")
> > axis(side= 1, at = c(10, 20, 30, 40, 50, 60))
> >
> > But it doesn't work. Any suggestions on how to reduce the tick interval?
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Dq0X2DkFhyF93HkjWTBQKhk!ANzmkRglqFkZT0F8ICLJH_RiaYVwyaJXw8dNqctnUZELgnK40ZBoSLhCQEnOFFw68r29nt9j0mkpJ2fB$
> > PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Dq0X2DkFhyF93HkjWTBQKhk!ANzmkRglqFkZT0F8ICLJH_RiaYVwyaJXw8dNqctnUZELgnK40ZBoSLhCQEnOFFw68r29nt9j0kVB9796$
> > and provide commented, minimal, self-contained, reproducible code.
>
>
>
> --
> John Kane
> Kingston ON Canada
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Apr 26 14:13:06 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 26 Apr 2021 13:13:06 +0100
Subject: [R] Query
In-Reply-To: <CH2PR05MB70164FE352DCE451CBD2B556DA439@CH2PR05MB7016.namprd05.prod.outlook.com>
References: <CH2PR05MB701628A5C8ECFCCFA4EA49CDDA459@CH2PR05MB7016.namprd05.prod.outlook.com>
 <CAKZQJMDvuQQktSri=M8x7g384gsjVihv5133-LUJebjbAaOHxA@mail.gmail.com>
 <CH2PR05MB70164FE352DCE451CBD2B556DA439@CH2PR05MB7016.namprd05.prod.outlook.com>
Message-ID: <501ac817-98eb-8442-f17e-2bb7f4d77df2@sapo.pt>

Hello,

What you are trying to do is not possible without editing the plot 
method for objects of class "varirf". See its code with


getAnywhere("plot.varirf")


Argument axes = FALSE is set in the code followed by explicit calls to 
axis(1, etc) and axis(2, etc).

Contact the

maintainer("vars")

?


Hope this helps,

Rui Barradas


?s 18:31 de 25/04/21, Sun Yong Kim escreveu:
> vars package
> ________________________________
> From: John Kane <jrkrideau at gmail.com>
> Sent: Sunday, April 25, 2021 12:30 PM
> To: Sun Yong Kim <sunyong.kim at kellogg.northwestern.edu>
> Cc: r-help at r-project.org <r-help at r-project.org>
> Subject: Re: [R] Query
> 
> What package has the irf function?
> 
> On Fri, 23 Apr 2021 at 09:34, Sun Yong Kim
> <sunyong.kim at kellogg.northwestern.edu> wrote:
>>
>> Hi
>>
>> I have been trying to circulate a question but my question keeps getting rejected. Let me try again via email. The message is below:
>>
>> I am trying to change the tick size for IRF graphs that I created using the following code below:
>>
>> par(mfrow=c(2,3))
>> IRF_F2 <- irf(SVARmod1, impulse="deltaw2",
>>            response=c("Belgium","France","Germany","Italy","Netherlands"),
>> n.ahead=60)
>> plot(IRF_F2,ylim=c(-0.5,0.3), plot.type="single", main="US Wealth Share
>> Shock")
>>
>> The code gives me the following IRFs I have attached to this email. However the tick intervals is way too small and I want to change it to intervals of 10. I was thinking something like:
>>
>> par(mfrow=c(2,3))
>> IRF_F2 <- irf(SVARmod1, impulse="deltaw2",
>>
>> response=c("Belgium","France","Germany","Italy","Netherlands"),
>> n.ahead=60)
>> plot(IRF_F2,ylim=c(-0.5,0.3), plot.type="single", main="US Wealth
>> Share Shock", xaxt="n")
>> axis(side= 1, at = c(10, 20, 30, 40, 50, 60))
>>
>> But it doesn't work. Any suggestions on how to reduce the tick interval?
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Dq0X2DkFhyF93HkjWTBQKhk!ANzmkRglqFkZT0F8ICLJH_RiaYVwyaJXw8dNqctnUZELgnK40ZBoSLhCQEnOFFw68r29nt9j0mkpJ2fB$
>> PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Dq0X2DkFhyF93HkjWTBQKhk!ANzmkRglqFkZT0F8ICLJH_RiaYVwyaJXw8dNqctnUZELgnK40ZBoSLhCQEnOFFw68r29nt9j0kVB9796$
>> and provide commented, minimal, self-contained, reproducible code.
> 
> 
> 
> --
> John Kane
> Kingston ON Canada
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From re|chm@nj @end|ng |rom @bcg|ob@|@net  Mon Apr 26 20:26:03 2021
From: re|chm@nj @end|ng |rom @bcg|ob@|@net (Jeff Reichman)
Date: Mon, 26 Apr 2021 13:26:03 -0500
Subject: [R] Converting Date Time values
References: <000001d73ac9$9e82aac0$db880040$.ref@sbcglobal.net>
Message-ID: <000001d73ac9$9e82aac0$db880040$@sbcglobal.net>

r-help

 

Generally speaking is it better to convert date/time values to "POSIXlt" and
"POSIXct" objects?

 

Jeff Reichman

 


	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Mon Apr 26 20:37:26 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 26 Apr 2021 11:37:26 -0700
Subject: [R] Converting Date Time values
In-Reply-To: <000001d73ac9$9e82aac0$db880040$@sbcglobal.net>
References: <000001d73ac9$9e82aac0$db880040$.ref@sbcglobal.net>
 <000001d73ac9$9e82aac0$db880040$@sbcglobal.net>
Message-ID: <CAGxFJbQDnHQq5jfbn1D=H-9aYvi1xj7buz4hyOPFJ87NopUwvQ@mail.gmail.com>

Did you mean to use "or" instead of "and" in your query?

If so, no comment. If "and," then yes, as that allows a great deal of
functionality (ordering, comparisons, time-date arithmetic, etc.) that
would otherwise be painful or require special packages. IMO only, of course.


Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Mon, Apr 26, 2021 at 11:26 AM Jeff Reichman <reichmanj at sbcglobal.net>
wrote:

> r-help
>
>
>
> Generally speaking is it better to convert date/time values to "POSIXlt"
> and
> "POSIXct" objects?
>
>
>
> Jeff Reichman
>
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From re|chm@nj @end|ng |rom @bcg|ob@|@net  Mon Apr 26 21:08:45 2021
From: re|chm@nj @end|ng |rom @bcg|ob@|@net (Jeff Reichman)
Date: Mon, 26 Apr 2021 14:08:45 -0500
Subject: [R] Converting Date Time values
In-Reply-To: <CAGxFJbQDnHQq5jfbn1D=H-9aYvi1xj7buz4hyOPFJ87NopUwvQ@mail.gmail.com>
References: <000001d73ac9$9e82aac0$db880040$.ref@sbcglobal.net>
 <000001d73ac9$9e82aac0$db880040$@sbcglobal.net>
 <CAGxFJbQDnHQq5jfbn1D=H-9aYvi1xj7buz4hyOPFJ87NopUwvQ@mail.gmail.com>
Message-ID: <000601d73acf$94c0e5f0$be42b1d0$@sbcglobal.net>

Whoops happy fingers yes I meant ?or?

 

From: Bert Gunter <bgunter.4567 at gmail.com> 
Sent: Monday, April 26, 2021 1:37 PM
To: reichmanj at sbcglobal.net
Cc: R-help <R-help at r-project.org>
Subject: Re: [R] Converting Date Time values

 

Did you mean to use "or" instead of "and" in your query?

 

If so, no comment. If "and," then yes, as that allows a great deal of functionality (ordering, comparisons, time-date arithmetic, etc.) that would otherwise be painful or require special packages. IMO only, of course.

 




Bert Gunter

"The trouble with having an open mind is that people keep coming along and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

 

 

On Mon, Apr 26, 2021 at 11:26 AM Jeff Reichman <reichmanj at sbcglobal.net <mailto:reichmanj at sbcglobal.net> > wrote:

r-help



Generally speaking is it better to convert date/time values to "POSIXlt" and
"POSIXct" objects?



Jeff Reichman




        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org <mailto:R-help at r-project.org>  mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


	[[alternative HTML version deleted]]


From d@v|d@@teven@ @end|ng |rom u@u@edu  Mon Apr 26 21:27:22 2021
From: d@v|d@@teven@ @end|ng |rom u@u@edu (David K Stevens)
Date: Mon, 26 Apr 2021 13:27:22 -0600
Subject: [R] [EXT]  Converting Date Time values
In-Reply-To: <000001d73ac9$9e82aac0$db880040$@sbcglobal.net>
References: <000001d73ac9$9e82aac0$db880040$.ref@sbcglobal.net>
 <000001d73ac9$9e82aac0$db880040$@sbcglobal.net>
Message-ID: <69127ade-eb18-084f-51a0-996d49141412@usu.edu>

I use both routinely, depending on the need. 'ct' is great for 
representing date/time holistically (2021-04-26 13:21:27) and is numeric 
under the hood in seconds since the big bang (just kidding), kind of 
like julian seconds. 'lt' is a list of 7 elements that often require 
manipulation (e.g. lt$mon = month of the year starting with Jan = 0) but 
it's great for extracting values like day of the year, day of the week, 
etc. w/o having to do it yourself - saves a heap of error-fraught 
coding. One draw back is the handling of daylight savings shifts. In 
March, an hour gets lost (jumps from 0159 to 0300) and in October you 
get an hour twice, so if you're using code that requires 1 hour steps, 
you get hiccups twice/year, so that requires special handling. Don't 
overlook 'strptime' to convert non-standard dates (e.g. '4/26/21' isn't 
recognized by as.POSIXct but strptime can do the conversions for you.)

David Stevens

On 4/26/2021 12:26 PM, Jeff Reichman wrote:
> r-help
>
>
>
> Generally speaking is it better to convert date/time values to "POSIXlt" and
> "POSIXct" objects?
>
>
>
> Jeff Reichman
>
>
>
>
>          [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
> CAUTION: This email originated from outside of USU. If this appears to be a USU employee, beware of impersonators. Do not click links, reply, download images, or open attachments unless you verify the sender?s identity and know the content is safe.
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Apr 26 21:31:37 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 26 Apr 2021 15:31:37 -0400
Subject: [R] Converting Date Time values
In-Reply-To: <000601d73acf$94c0e5f0$be42b1d0$@sbcglobal.net>
References: <000001d73ac9$9e82aac0$db880040$.ref@sbcglobal.net>
 <000001d73ac9$9e82aac0$db880040$@sbcglobal.net>
 <CAGxFJbQDnHQq5jfbn1D=H-9aYvi1xj7buz4hyOPFJ87NopUwvQ@mail.gmail.com>
 <000601d73acf$94c0e5f0$be42b1d0$@sbcglobal.net>
Message-ID: <b80ff7bb-d3d2-d4d1-f3db-102c8bcc4105@gmail.com>

On 26/04/2021 3:08 p.m., Jeff Reichman wrote:
> Whoops happy fingers yes I meant ?or?
> 

POSIXct are easier to work with as data (e.g. a column in a dataframe). 
  POSIXlt is easier to work with as dates & times, and has a bigger range.

See details of the comparison in the ?POSIXt help page.

Duncan Murdoch


From drj|m|emon @end|ng |rom gm@||@com  Wed Apr 28 07:28:29 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Wed, 28 Apr 2021 15:28:29 +1000
Subject: [R] [R-pkg-devel] creating a function that creates a figure
In-Reply-To: <Nxzrm9-bg1IPz7ubqYaBgtNa49eNH228HzbLxSEaU7NPcSRN9CRJhrwbI_u9XcXFa9moE1iGBL-SQQijrTeLCIXX6KZaIpICoDfY-bQK3LI=@protonmail.com>
References: <Nxzrm9-bg1IPz7ubqYaBgtNa49eNH228HzbLxSEaU7NPcSRN9CRJhrwbI_u9XcXFa9moE1iGBL-SQQijrTeLCIXX6KZaIpICoDfY-bQK3LI=@protonmail.com>
Message-ID: <CA+8X3fUFJOTrMhRVJEEgA8yydg2xM7hAO3jRhsNMZwmrPwNmog@mail.gmail.com>

Hi Matthew,
The conventional way to document a function that doesn't return a value is:

\value{nil}

in the .Rd file. In the arguments section, if your data frames are
named as "d1" and "d2",

\item{d1,d2}{Two data frames.}

Add any relevant information such as whether they must be conformable.

Jim

On Wed, Apr 28, 2021 at 3:11 PM csmatyi <csmatyi at protonmail.com> wrote:
>
> Hello all,
>
> Normally, when you write a function in R, it returns a value. That way it is easy to write an .Rd file for this function.
>
> However, I have written a function that does no such thing. Rather, it takes as input two data frames, and creates a figure. But doesn't return anything.
>
> In R package language, how do I write the examples in the .R file when I need to define the input variable first as a data frame? I can't just write it as
>
> add(1,2) which returns 3.
>
> Any help?
>
> Thanks so much,
> Matthew
>
> Sent with [ProtonMail](https://protonmail.com) Secure Email.
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From m@015k3113 @end|ng |rom b|ueyonder@co@uk  Thu Apr 29 17:40:42 2021
From: m@015k3113 @end|ng |rom b|ueyonder@co@uk (e-mail ma015k3113)
Date: Thu, 29 Apr 2021 16:40:42 +0100 (BST)
Subject: [R] Help understanding loop behaviour
Message-ID: <679279936.579089.1619710842379@mail2.virginmedia.com>

I am trying to understand how loops in operate. I have a simple dataframe xx which is as follows

COMPANY_NUMBER   NUMBER_OF_YEARS
 
#0070837                             3
#0070837                             3
#0070837                             3
1000403                               4
1000403                               4
1000403                               4
1000403                               4
10029943                             3
10029943                             3
10029943                             3
10037980                             4
10037980                             4
10037980                             4
10037980                             4
10057418                             3
10057418                             3

10057418                             3
1009550                               4
1009550                               4
1009550                               4
1009550                               4
The code I have written is

while (i <= nrow(xx1) )

{

for (j in 1:xx1$NUMBER_OF_YEARS[i])
{
xx1$I[i] <- i
xx1$J[j] <- j
xx1$NUMBER_OF_YEARS_j[j] <- xx1$NUMBER_OF_YEARS[j]
}
i=i + (xx1$NUMBER_OF_YEARS[i] )
}
After running the code I want my dataframe to look like

|COMPANY_NUMBER |NUMBER_OF_YEARS| | I| |J|

|#0070837 |3| |1| |1|
|#0070837 |3| |1| |2|
|#0070837 |3| |3| |3|
|1000403 |4| |1| |1|
|1000403 |4| |1| |2|
|1000403 |4| |1| |3|
|1000403 |4| |4| |4|
|10029943 |3| |1| |1|
|10029943 |3| |1| |2|
|10029943 |3| |3| |3|
|10037980 |4| |1| |1|
|10037980 |4| |1| |2|
|10037980 |4| |1| |3|
|10037980 |4| |4| |4|
|10057418 |3| |1| |1|
|10057418 |3| |1| |1|
|10057418 |3| |1| |1|
|1009550 |4| |1| |1|
|1009550 |4| |1| |2|
|1009550 |4| |1| |3|
|1009550 |4| |4| |4|


I get the correct value of I but in the wrong row but the vaule of J is correct in the first iteration and then it goes to 1

Any help will be greatly appreciated
	[[alternative HTML version deleted]]


From T||m@nn_F@u| @end|ng |rom t-on||ne@de  Thu Apr 29 21:22:44 2021
From: T||m@nn_F@u| @end|ng |rom t-on||ne@de (Tilmann Faul)
Date: Thu, 29 Apr 2021 21:22:44 +0200
Subject: [R] Date Time, as.POSIXct used locale, strange plot behavior
Message-ID: <682e04e1-3dba-4d33-4ae6-ce351d671848@t-online.de>

Hy,

stumbled over the following problem while plotting DateTime Objects.

plot(as.POSIXct(c("2021-04-21 00:00:00", "2021-04-21 23:59:59")), c(0,
1), type='l')

arrows(as.POSIXct("2021-04-21 00:00:00", tz="CEST"),
       0.3,
       as.POSIXct("2021-04-21 00:00:00", tz="CEST"),
       0.2,
       length=0.07, angle=15)

# arrow at 02:00, why?

arrows(as.POSIXct("2021-04-21 00:00:00"),
       0.3,
       as.POSIXct("2021-04-21 00:00:00"),
       0.2,
       length=0.07, angle=15, col='red')

# arrow at 00:00 as expected

as.POSIXct(c("2021-04-21 00:00:00", "2021-04-21 23:59:59"))[1]
# [1] "2021-04-21 CEST"
as.POSIXct("2021-04-21 00:00:00", tz="CEST")
# [1] "2021-04-21 CEST"
as.POSIXct("2021-04-21 00:00:00")
# [1] "2021-04-21 CEST"

all representations on my system are the same, why is the plot location
of the arrows different??
I am located in Germany, my locale:
Sys.getlocale()
[1]
"LC_CTYPE=de_DE.UTF-8;LC_NUMERIC=C;LC_TIME=de_DE.UTF-8;LC_COLLATE=de_DE.UTF-8;LC_MONETARY=de_DE.UTF-8;LC_MESSAGES=de_DE.UTF-8;LC_PAPER=de_DE.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=de_DE.UTF-8;LC_IDENTIFICATION=C"

Any Idea?

Best regards
Tilmann


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Apr 29 23:19:37 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 29 Apr 2021 14:19:37 -0700
Subject: [R] Date Time, as.POSIXct used locale, strange plot behavior
In-Reply-To: <682e04e1-3dba-4d33-4ae6-ce351d671848@t-online.de>
References: <682e04e1-3dba-4d33-4ae6-ce351d671848@t-online.de>
Message-ID: <CBCDE09C-1DB7-47EF-A4FC-C3960FFF32A2@dcn.davis.ca.us>

What is your TZ environment variable set to? That's what time conversion defaults to  ?DateTimeClasses

Also, I am not sure CEST is a valid timezone designation... it can be system dependent, but using one of the elements listed in ?OlsonNames.

On April 29, 2021 12:22:44 PM PDT, Tilmann Faul <Tilmann_Faul at t-online.de> wrote:
>Hy,
>
>stumbled over the following problem while plotting DateTime Objects.
>
>plot(as.POSIXct(c("2021-04-21 00:00:00", "2021-04-21 23:59:59")), c(0,
>1), type='l')
>
>arrows(as.POSIXct("2021-04-21 00:00:00", tz="CEST"),
>       0.3,
>       as.POSIXct("2021-04-21 00:00:00", tz="CEST"),
>       0.2,
>       length=0.07, angle=15)
>
># arrow at 02:00, why?
>
>arrows(as.POSIXct("2021-04-21 00:00:00"),
>       0.3,
>       as.POSIXct("2021-04-21 00:00:00"),
>       0.2,
>       length=0.07, angle=15, col='red')
>
># arrow at 00:00 as expected
>
>as.POSIXct(c("2021-04-21 00:00:00", "2021-04-21 23:59:59"))[1]
># [1] "2021-04-21 CEST"
>as.POSIXct("2021-04-21 00:00:00", tz="CEST")
># [1] "2021-04-21 CEST"
>as.POSIXct("2021-04-21 00:00:00")
># [1] "2021-04-21 CEST"
>
>all representations on my system are the same, why is the plot location
>of the arrows different??
>I am located in Germany, my locale:
>Sys.getlocale()
>[1]
>"LC_CTYPE=de_DE.UTF-8;LC_NUMERIC=C;LC_TIME=de_DE.UTF-8;LC_COLLATE=de_DE.UTF-8;LC_MONETARY=de_DE.UTF-8;LC_MESSAGES=de_DE.UTF-8;LC_PAPER=de_DE.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=de_DE.UTF-8;LC_IDENTIFICATION=C"
>
>Any Idea?
>
>Best regards
>Tilmann
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From petr@p|k@| @end|ng |rom prechez@@cz  Fri Apr 30 08:43:35 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Fri, 30 Apr 2021 06:43:35 +0000
Subject: [R] Help understanding loop behaviour
In-Reply-To: <679279936.579089.1619710842379@mail2.virginmedia.com>
References: <679279936.579089.1619710842379@mail2.virginmedia.com>
Message-ID: <d8928cb5659247418c219b49fa1f15fb@SRVEXCHCM1302.precheza.cz>

Hi

Your code is hardly readable as you used HTML formating (not recommended) so
I used another (split) approach.

Third column seems to be simple 

#make list
lll <- split(as.factor(COMPANY_NUMBER), COMPANY_NUMBER)

#calculate sequences
as.numeric(unlist(lapply(lll, function(x) 1:length(x))))
should give you third column

The second column seems to be calculated this way.
lapply(lll, function(x) c(rep(1, length(x)-1), max(length(x))))

I believe others could come with simpler solutions.

BTW why result for
10057418 
Should be different?

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of e-mail
> ma015k3113 via R-help
> Sent: Thursday, April 29, 2021 5:41 PM
> To: r-help at r-project.org
> Subject: [R] Help understanding loop behaviour
> 
> I am trying to understand how loops in operate. I have a simple dataframe
xx
> which is as follows
> 
> COMPANY_NUMBER   NUMBER_OF_YEARS
> 
> #0070837                             3
> #0070837                             3
> #0070837                             3
> 1000403                               4
> 1000403                               4
> 1000403                               4
> 1000403                               4
> 10029943                             3
> 10029943                             3
> 10029943                             3
> 10037980                             4
> 10037980                             4
> 10037980                             4
> 10037980                             4
> 10057418                             3
> 10057418                             3
> 
> 10057418                             3
> 1009550                               4
> 1009550                               4
> 1009550                               4
> 1009550                               4
> The code I have written is
> 
> while (i <= nrow(xx1) )
> 
> {
> 
> for (j in 1:xx1$NUMBER_OF_YEARS[i])
> {
> xx1$I[i] <- i
> xx1$J[j] <- j
> xx1$NUMBER_OF_YEARS_j[j] <- xx1$NUMBER_OF_YEARS[j] } i=i +
> (xx1$NUMBER_OF_YEARS[i] ) } After running the code I want my dataframe
> to look like
> 
> |COMPANY_NUMBER |NUMBER_OF_YEARS| | I| |J|
> 
> |#0070837 |3| |1| |1|
> |#0070837 |3| |1| |2|
> |#0070837 |3| |3| |3|
> |1000403 |4| |1| |1|
> |1000403 |4| |1| |2|
> |1000403 |4| |1| |3|
> |1000403 |4| |4| |4|
> |10029943 |3| |1| |1|
> |10029943 |3| |1| |2|
> |10029943 |3| |3| |3|
> |10037980 |4| |1| |1|
> |10037980 |4| |1| |2|
> |10037980 |4| |1| |3|
> |10037980 |4| |4| |4|
> |10057418 |3| |1| |1|
> |10057418 |3| |1| |1|
> |10057418 |3| |1| |1|
> |1009550 |4| |1| |1|
> |1009550 |4| |1| |2|
> |1009550 |4| |1| |3|
> |1009550 |4| |4| |4|
> 
> 
> I get the correct value of I but in the wrong row but the vaule of J is
correct in
> the first iteration and then it goes to 1
> 
> Any help will be greatly appreciated
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

From petr@p|k@| @end|ng |rom prechez@@cz  Fri Apr 30 09:04:21 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Fri, 30 Apr 2021 07:04:21 +0000
Subject: [R] Date Time, as.POSIXct used locale, strange plot behavior
In-Reply-To: <CBCDE09C-1DB7-47EF-A4FC-C3960FFF32A2@dcn.davis.ca.us>
References: <682e04e1-3dba-4d33-4ae6-ce351d671848@t-online.de>
 <CBCDE09C-1DB7-47EF-A4FC-C3960FFF32A2@dcn.davis.ca.us>
Message-ID: <703ac6dd00e7454bb257c65dcb565c9b@SRVEXCHCM1302.precheza.cz>

Hi.

It should be probably CET not CEST.

arrows(as.POSIXct("2021-04-21 00:00:00", tz="CEST"),
       0.3,
       as.POSIXct("2021-04-21 00:00:00", tz="CEST"),
       0.2,
       length=0.07, angle=15)


arrows(as.POSIXct("2021-04-21 00:00:00", tz="CET"),
       0.3,
       as.POSIXct("2021-04-21 00:00:00", tz="CET"),
       0.2,
       length=0.07, angle=15)

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Jeff Newmiller
> Sent: Thursday, April 29, 2021 11:20 PM
> To: r-help at r-project.org; Tilmann Faul <Tilmann_Faul at t-online.de>
> Subject: Re: [R] Date Time, as.POSIXct used locale, strange plot behavior
> 
> What is your TZ environment variable set to? That's what time conversion
> defaults to  ?DateTimeClasses
> 
> Also, I am not sure CEST is a valid timezone designation... it can be
system
> dependent, but using one of the elements listed in ?OlsonNames.
> 
> On April 29, 2021 12:22:44 PM PDT, Tilmann Faul <Tilmann_Faul at t-online.de>
> wrote:
> >Hy,
> >
> >stumbled over the following problem while plotting DateTime Objects.
> >
> >plot(as.POSIXct(c("2021-04-21 00:00:00", "2021-04-21 23:59:59")), c(0,
> >1), type='l')
> >
> >arrows(as.POSIXct("2021-04-21 00:00:00", tz="CEST"),
> >       0.3,
> >       as.POSIXct("2021-04-21 00:00:00", tz="CEST"),
> >       0.2,
> >       length=0.07, angle=15)
> >
> ># arrow at 02:00, why?
> >
> >arrows(as.POSIXct("2021-04-21 00:00:00"),
> >       0.3,
> >       as.POSIXct("2021-04-21 00:00:00"),
> >       0.2,
> >       length=0.07, angle=15, col='red')
> >
> ># arrow at 00:00 as expected
> >
> >as.POSIXct(c("2021-04-21 00:00:00", "2021-04-21 23:59:59"))[1] # [1]
> >"2021-04-21 CEST"
> >as.POSIXct("2021-04-21 00:00:00", tz="CEST") # [1] "2021-04-21 CEST"
> >as.POSIXct("2021-04-21 00:00:00")
> ># [1] "2021-04-21 CEST"
> >
> >all representations on my system are the same, why is the plot location
> >of the arrows different??
> >I am located in Germany, my locale:
> >Sys.getlocale()
> >[1]
> >"LC_CTYPE=de_DE.UTF-8;LC_NUMERIC=C;LC_TIME=de_DE.UTF-
> 8;LC_COLLATE=de_DE.UTF-8;LC_MONETARY=de_DE.UTF-
> 8;LC_MESSAGES=de_DE.UTF-8;LC_PAPER=de_DE.UTF-
> 8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=de_D
> E.UTF-8;LC_IDENTIFICATION=C"
> >
> >Any Idea?
> >
> >Best regards
> >Tilmann
> >
> >______________________________________________
> >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >https://stat.ethz.ch/mailman/listinfo/r-help
> >PLEASE do read the posting guide
> >http://www.R-project.org/posting-guide.html
> >and provide commented, minimal, self-contained, reproducible code.
> 
> --
> Sent from my phone. Please excuse my brevity.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

From T||m@nn_F@u| @end|ng |rom t-on||ne@de  Fri Apr 30 09:50:50 2021
From: T||m@nn_F@u| @end|ng |rom t-on||ne@de (Tilmann Faul)
Date: Fri, 30 Apr 2021 09:50:50 +0200
Subject: [R] Date Time, as.POSIXct used locale, strange plot behavior
In-Reply-To: <CBCDE09C-1DB7-47EF-A4FC-C3960FFF32A2@dcn.davis.ca.us>
References: <682e04e1-3dba-4d33-4ae6-ce351d671848@t-online.de>
 <CBCDE09C-1DB7-47EF-A4FC-C3960FFF32A2@dcn.davis.ca.us>
Message-ID: <2dff15c0-ed56-e80d-20df-15912e33220d@t-online.de>

Dear Jeff,

Thanks for your answer.
Sys.timezone()  gives
[1] "Europe/Berlin"
I tried "Europe/Berlin" as tz argument, giving the same result als using
"CEST" (Central European Summer Time).
It seems to me, that using as.POSIXct without tz argument defaults to tz
UTC and with tz argument, either "CEST" or "Europ/Berlin" uses the
European tz, regarding the plot.
Never the less i do not understand why all of them have the same time
printout on my system.

as.POSIXct("2021-04-21 00:00:00", tz="CEST")
# [1] "2021-04-21 CEST"
as.POSIXct("2021-04-21 00:00:00", tz="Europ/Berlin")
# [1] "2021-04-21 Europ"
as.POSIXct("2021-04-21 00:00:00")
# [1] "2021-04-21 CEST"

Can someone comment on that, please?

best Regards
Tilmann

On 29.04.21 23:19, Jeff Newmiller wrote:
> What is your TZ environment variable set to? That's what time conversion defaults to  ?DateTimeClasses
> 
> Also, I am not sure CEST is a valid timezone designation... it can be system dependent, but using one of the elements listed in ?OlsonNames.
> 
> On April 29, 2021 12:22:44 PM PDT, Tilmann Faul <Tilmann_Faul at t-online.de> wrote:
>> Hy,
>>
>> stumbled over the following problem while plotting DateTime Objects.
>>
>> plot(as.POSIXct(c("2021-04-21 00:00:00", "2021-04-21 23:59:59")), c(0,
>> 1), type='l')
>>
>> arrows(as.POSIXct("2021-04-21 00:00:00", tz="CEST"),
>>       0.3,
>>       as.POSIXct("2021-04-21 00:00:00", tz="CEST"),
>>       0.2,
>>       length=0.07, angle=15)
>>
>> # arrow at 02:00, why?
>>
>> arrows(as.POSIXct("2021-04-21 00:00:00"),
>>       0.3,
>>       as.POSIXct("2021-04-21 00:00:00"),
>>       0.2,
>>       length=0.07, angle=15, col='red')
>>
>> # arrow at 00:00 as expected
>>
>> as.POSIXct(c("2021-04-21 00:00:00", "2021-04-21 23:59:59"))[1]
>> # [1] "2021-04-21 CEST"
>> as.POSIXct("2021-04-21 00:00:00", tz="CEST")
>> # [1] "2021-04-21 CEST"
>> as.POSIXct("2021-04-21 00:00:00")
>> # [1] "2021-04-21 CEST"
>>
>> all representations on my system are the same, why is the plot location
>> of the arrows different??
>> I am located in Germany, my locale:
>> Sys.getlocale()
>> [1]
>> "LC_CTYPE=de_DE.UTF-8;LC_NUMERIC=C;LC_TIME=de_DE.UTF-8;LC_COLLATE=de_DE.UTF-8;LC_MONETARY=de_DE.UTF-8;LC_MESSAGES=de_DE.UTF-8;LC_PAPER=de_DE.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=de_DE.UTF-8;LC_IDENTIFICATION=C"
>>
>> Any Idea?
>>
>> Best regards
>> Tilmann
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>


From e@ @end|ng |rom enr|co@chum@nn@net  Fri Apr 30 11:17:23 2021
From: e@ @end|ng |rom enr|co@chum@nn@net (Enrico Schumann)
Date: Fri, 30 Apr 2021 11:17:23 +0200
Subject: [R] Date Time, as.POSIXct used locale, strange plot behavior
In-Reply-To: <2dff15c0-ed56-e80d-20df-15912e33220d@t-online.de> (Tilmann
 Faul's message of "Fri, 30 Apr 2021 09:50:50 +0200")
References: <682e04e1-3dba-4d33-4ae6-ce351d671848@t-online.de>
 <CBCDE09C-1DB7-47EF-A4FC-C3960FFF32A2@dcn.davis.ca.us>
 <2dff15c0-ed56-e80d-20df-15912e33220d@t-online.de>
Message-ID: <87y2d0t9lo.fsf@enricoschumann.net>

On Fri, 30 Apr 2021, Tilmann Faul writes:

> Dear Jeff,
>
> Thanks for your answer.
> Sys.timezone()  gives
> [1] "Europe/Berlin"
> I tried "Europe/Berlin" as tz argument, giving the same result als using
> "CEST" (Central European Summer Time).
> It seems to me, that using as.POSIXct without tz argument defaults to tz
> UTC and with tz argument, either "CEST" or "Europ/Berlin" uses the
> European tz, regarding the plot.
> Never the less i do not understand why all of them have the same time
> printout on my system.
>
> as.POSIXct("2021-04-21 00:00:00", tz="CEST")
> # [1] "2021-04-21 CEST"
> as.POSIXct("2021-04-21 00:00:00", tz="Europ/Berlin")
> # [1] "2021-04-21 Europ"
> as.POSIXct("2021-04-21 00:00:00")
> # [1] "2021-04-21 CEST"
>
> Can someone comment on that, please?
>
> best Regards
> Tilmann

Timezone names in general are not portable (i.e. not
safe to use).  You may always specify a timezone name,
but it may be ignored:

    as.POSIXct("2021-04-21 00:00:00", tz = "PartyTime")
    ## "2021-04-21 PartyTime"

So just because your system prints "CEST", it does not
mean it has recognised it as a timezone. (To make it
even more complicated: your system may display a time
as "CEST", meaning a time in Central European Summer
Time, but still not accept "CEST" as _input_ for a
timezone name.)

'POSIXct' represents time as a number (seconds since
1970). To compare the results of different calls, it is
easier to compare those numbers.

    dput(as.POSIXct("2021-04-21 00:00:00", tz="CEST"))
    ## structure(1618963200, class = c("POSIXct", "POSIXt"), tzone = "CEST")
    dput(as.POSIXct("2021-04-21 00:00:00", tz="PartyTime"))
    ## structure(1618963200, class = c("POSIXct", "POSIXt"), tzone = "PartyTime")

    dput(as.POSIXct("2021-04-21 00:00:00", tz="Europe/Berlin"))
    ## structure(1618956000, class = c("POSIXct", "POSIXt"), tzone = "Europe/Berlin")
    dput(as.POSIXct("2021-04-21 00:00:00"))
    ## structure(1618956000, class = c("POSIXct", "POSIXt"), tzone = "")

So in your case, "CEST" is (most likely) not recognised
as a valid input for a timezone name, and hence it is
ignored, but still displayed.

HTH
    Enrico


> On 29.04.21 23:19, Jeff Newmiller wrote:
>> What is your TZ environment variable set to? That's what time conversion defaults to  ?DateTimeClasses
>> 
>> Also, I am not sure CEST is a valid timezone designation... it can be system dependent, but using one of the elements listed in ?OlsonNames.
>> 
>> On April 29, 2021 12:22:44 PM PDT, Tilmann Faul <Tilmann_Faul at t-online.de> wrote:
>>> Hy,
>>>
>>> stumbled over the following problem while plotting DateTime Objects.
>>>
>>> plot(as.POSIXct(c("2021-04-21 00:00:00", "2021-04-21 23:59:59")), c(0,
>>> 1), type='l')
>>>
>>> arrows(as.POSIXct("2021-04-21 00:00:00", tz="CEST"),
>>>       0.3,
>>>       as.POSIXct("2021-04-21 00:00:00", tz="CEST"),
>>>       0.2,
>>>       length=0.07, angle=15)
>>>
>>> # arrow at 02:00, why?
>>>
>>> arrows(as.POSIXct("2021-04-21 00:00:00"),
>>>       0.3,
>>>       as.POSIXct("2021-04-21 00:00:00"),
>>>       0.2,
>>>       length=0.07, angle=15, col='red')
>>>
>>> # arrow at 00:00 as expected
>>>
>>> as.POSIXct(c("2021-04-21 00:00:00", "2021-04-21 23:59:59"))[1]
>>> # [1] "2021-04-21 CEST"
>>> as.POSIXct("2021-04-21 00:00:00", tz="CEST")
>>> # [1] "2021-04-21 CEST"
>>> as.POSIXct("2021-04-21 00:00:00")
>>> # [1] "2021-04-21 CEST"
>>>
>>> all representations on my system are the same, why is the plot location
>>> of the arrows different??
>>> I am located in Germany, my locale:
>>> Sys.getlocale()
>>> [1]
>>> "LC_CTYPE=de_DE.UTF-8;LC_NUMERIC=C;LC_TIME=de_DE.UTF-8;LC_COLLATE=de_DE.UTF-8;LC_MONETARY=de_DE.UTF-8;LC_MESSAGES=de_DE.UTF-8;LC_PAPER=de_DE.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=de_DE.UTF-8;LC_IDENTIFICATION=C"
>>>
>>> Any Idea?
>>>
>>> Best regards
>>> Tilmann
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Enrico Schumann
Lucerne, Switzerland
http://enricoschumann.net


From drj|m|emon @end|ng |rom gm@||@com  Fri Apr 30 11:45:17 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Fri, 30 Apr 2021 19:45:17 +1000
Subject: [R] Help understanding loop behaviour
In-Reply-To: <679279936.579089.1619710842379@mail2.virginmedia.com>
References: <679279936.579089.1619710842379@mail2.virginmedia.com>
Message-ID: <CA+8X3fVm3mhCTP3z=Uzn2GJL21-iawt-c205T6+nJzFEBO=hzQ@mail.gmail.com>

Hi email,
If you want what you described, try this:

xx<-read.table(text="COMPANY_NUMBER NUMBER_OF_YEARS
0070837  3
0070837  3
0070837  3
1000403  4
1000403  4
1000403  4
1000403  4
10029943  3
10029943  3
10029943  3
10037980  4
10037980  4
10037980  4
10037980  4
10057418  3
10057418  3
10057418  3
1009550  4
1009550  4
1009550  4
1009550  4",
header=TRUE,stringsAsFactors=FALSE)
xx$I<-NA
xx$J<-NA
row_count<-1
for(row in 1:nrow(xx)) {
 if(row == nrow(xx) || xx$COMPANY_NUMBER[row]==xx$COMPANY_NUMBER[row+1]) {
  xx$I[row]<-1
  xx$J[row]<-row_count
  row_count<-row_count+1
 } else {
  xx$I[row]<-xx$J[row]<-xx$NUMBER_OF_YEARS[row]
  row_count<-1
 }
}
xx

Like Petr, I am assuming that you want company 10057418 treated the
same as the others. If not, let us know why. I am also adssuming that
the first three rows should _not_ have a "#" at the beginning, which
means that they will be discarded.

Jim

On Fri, Apr 30, 2021 at 1:41 AM e-mail ma015k3113 via R-help
<r-help at r-project.org> wrote:
>
> I am trying to understand how loops in operate. I have a simple dataframe xx which is as follows
>
> COMPANY_NUMBER   NUMBER_OF_YEARS
>
> #0070837                             3
> #0070837                             3
> #0070837                             3
> 1000403                               4
> 1000403                               4
> 1000403                               4
> 1000403                               4
> 10029943                             3
> 10029943                             3
> 10029943                             3
> 10037980                             4
> 10037980                             4
> 10037980                             4
> 10037980                             4
> 10057418                             3
> 10057418                             3
>
> 10057418                             3
> 1009550                               4
> 1009550                               4
> 1009550                               4
> 1009550                               4
> The code I have written is
>
> while (i <= nrow(xx1) )
>
> {
>
> for (j in 1:xx1$NUMBER_OF_YEARS[i])
> {
> xx1$I[i] <- i
> xx1$J[j] <- j
> xx1$NUMBER_OF_YEARS_j[j] <- xx1$NUMBER_OF_YEARS[j]
> }
> i=i + (xx1$NUMBER_OF_YEARS[i] )
> }
> After running the code I want my dataframe to look like
>
> |COMPANY_NUMBER |NUMBER_OF_YEARS| | I| |J|
>
> |#0070837 |3| |1| |1|
> |#0070837 |3| |1| |2|
> |#0070837 |3| |3| |3|
> |1000403 |4| |1| |1|
> |1000403 |4| |1| |2|
> |1000403 |4| |1| |3|
> |1000403 |4| |4| |4|
> |10029943 |3| |1| |1|
> |10029943 |3| |1| |2|
> |10029943 |3| |3| |3|
> |10037980 |4| |1| |1|
> |10037980 |4| |1| |2|
> |10037980 |4| |1| |3|
> |10037980 |4| |4| |4|
> |10057418 |3| |1| |1|
> |10057418 |3| |1| |1|
> |10057418 |3| |1| |1|
> |1009550 |4| |1| |1|
> |1009550 |4| |1| |2|
> |1009550 |4| |1| |3|
> |1009550 |4| |4| |4|
>
>
> I get the correct value of I but in the wrong row but the vaule of J is correct in the first iteration and then it goes to 1
>
> Any help will be greatly appreciated
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From T||m@nn_F@u| @end|ng |rom t-on||ne@de  Fri Apr 30 12:00:06 2021
From: T||m@nn_F@u| @end|ng |rom t-on||ne@de (Tilmann Faul)
Date: Fri, 30 Apr 2021 12:00:06 +0200
Subject: [R] Date Time, as.POSIXct used locale, strange plot behavior
In-Reply-To: <87y2d0t9lo.fsf@enricoschumann.net>
References: <682e04e1-3dba-4d33-4ae6-ce351d671848@t-online.de>
 <CBCDE09C-1DB7-47EF-A4FC-C3960FFF32A2@dcn.davis.ca.us>
 <2dff15c0-ed56-e80d-20df-15912e33220d@t-online.de>
 <87y2d0t9lo.fsf@enricoschumann.net>
Message-ID: <3746b772-4f9d-706a-0ede-9fd054bffede@t-online.de>

Dear Enrico,

Thanks a lot, that clarifies the topic for me.
Checking the numeric representation i was not aware of.

Best Regards
Tilmann

On 30.04.21 11:17, Enrico Schumann wrote:
> On Fri, 30 Apr 2021, Tilmann Faul writes:
> 
>> Dear Jeff,
>>
>> Thanks for your answer.
>> Sys.timezone()  gives
>> [1] "Europe/Berlin"
>> I tried "Europe/Berlin" as tz argument, giving the same result als using
>> "CEST" (Central European Summer Time).
>> It seems to me, that using as.POSIXct without tz argument defaults to tz
>> UTC and with tz argument, either "CEST" or "Europ/Berlin" uses the
>> European tz, regarding the plot.
>> Never the less i do not understand why all of them have the same time
>> printout on my system.
>>
>> as.POSIXct("2021-04-21 00:00:00", tz="CEST")
>> # [1] "2021-04-21 CEST"
>> as.POSIXct("2021-04-21 00:00:00", tz="Europ/Berlin")
>> # [1] "2021-04-21 Europ"
>> as.POSIXct("2021-04-21 00:00:00")
>> # [1] "2021-04-21 CEST"
>>
>> Can someone comment on that, please?
>>
>> best Regards
>> Tilmann
> 
> Timezone names in general are not portable (i.e. not
> safe to use).  You may always specify a timezone name,
> but it may be ignored:
> 
>     as.POSIXct("2021-04-21 00:00:00", tz = "PartyTime")
>     ## "2021-04-21 PartyTime"
> 
> So just because your system prints "CEST", it does not
> mean it has recognised it as a timezone. (To make it
> even more complicated: your system may display a time
> as "CEST", meaning a time in Central European Summer
> Time, but still not accept "CEST" as _input_ for a
> timezone name.)
> 
> 'POSIXct' represents time as a number (seconds since
> 1970). To compare the results of different calls, it is
> easier to compare those numbers.
> 
>     dput(as.POSIXct("2021-04-21 00:00:00", tz="CEST"))
>     ## structure(1618963200, class = c("POSIXct", "POSIXt"), tzone = "CEST")
>     dput(as.POSIXct("2021-04-21 00:00:00", tz="PartyTime"))
>     ## structure(1618963200, class = c("POSIXct", "POSIXt"), tzone = "PartyTime")
> 
>     dput(as.POSIXct("2021-04-21 00:00:00", tz="Europe/Berlin"))
>     ## structure(1618956000, class = c("POSIXct", "POSIXt"), tzone = "Europe/Berlin")
>     dput(as.POSIXct("2021-04-21 00:00:00"))
>     ## structure(1618956000, class = c("POSIXct", "POSIXt"), tzone = "")
> 
> So in your case, "CEST" is (most likely) not recognised
> as a valid input for a timezone name, and hence it is
> ignored, but still displayed.
> 
> HTH
>     Enrico
> 
> 
>> On 29.04.21 23:19, Jeff Newmiller wrote:
>>> What is your TZ environment variable set to? That's what time conversion defaults to  ?DateTimeClasses
>>>
>>> Also, I am not sure CEST is a valid timezone designation... it can be system dependent, but using one of the elements listed in ?OlsonNames.
>>>
>>> On April 29, 2021 12:22:44 PM PDT, Tilmann Faul <Tilmann_Faul at t-online.de> wrote:
>>>> Hy,
>>>>
>>>> stumbled over the following problem while plotting DateTime Objects.
>>>>
>>>> plot(as.POSIXct(c("2021-04-21 00:00:00", "2021-04-21 23:59:59")), c(0,
>>>> 1), type='l')
>>>>
>>>> arrows(as.POSIXct("2021-04-21 00:00:00", tz="CEST"),
>>>>       0.3,
>>>>       as.POSIXct("2021-04-21 00:00:00", tz="CEST"),
>>>>       0.2,
>>>>       length=0.07, angle=15)
>>>>
>>>> # arrow at 02:00, why?
>>>>
>>>> arrows(as.POSIXct("2021-04-21 00:00:00"),
>>>>       0.3,
>>>>       as.POSIXct("2021-04-21 00:00:00"),
>>>>       0.2,
>>>>       length=0.07, angle=15, col='red')
>>>>
>>>> # arrow at 00:00 as expected
>>>>
>>>> as.POSIXct(c("2021-04-21 00:00:00", "2021-04-21 23:59:59"))[1]
>>>> # [1] "2021-04-21 CEST"
>>>> as.POSIXct("2021-04-21 00:00:00", tz="CEST")
>>>> # [1] "2021-04-21 CEST"
>>>> as.POSIXct("2021-04-21 00:00:00")
>>>> # [1] "2021-04-21 CEST"
>>>>
>>>> all representations on my system are the same, why is the plot location
>>>> of the arrows different??
>>>> I am located in Germany, my locale:
>>>> Sys.getlocale()
>>>> [1]
>>>> "LC_CTYPE=de_DE.UTF-8;LC_NUMERIC=C;LC_TIME=de_DE.UTF-8;LC_COLLATE=de_DE.UTF-8;LC_MONETARY=de_DE.UTF-8;LC_MESSAGES=de_DE.UTF-8;LC_PAPER=de_DE.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=de_DE.UTF-8;LC_IDENTIFICATION=C"
>>>>
>>>> Any Idea?
>>>>
>>>> Best regards
>>>> Tilmann
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>


From petr@p|k@| @end|ng |rom prechez@@cz  Fri Apr 30 12:49:25 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Fri, 30 Apr 2021 10:49:25 +0000
Subject: [R] Help understanding loop behaviour
In-Reply-To: <CA+8X3fVm3mhCTP3z=Uzn2GJL21-iawt-c205T6+nJzFEBO=hzQ@mail.gmail.com>
References: <679279936.579089.1619710842379@mail2.virginmedia.com>
 <CA+8X3fVm3mhCTP3z=Uzn2GJL21-iawt-c205T6+nJzFEBO=hzQ@mail.gmail.com>
Message-ID: <b1031b55f1904a408de7aa67b19d9e6f@SRVEXCHCM1302.precheza.cz>

Hallo,

Sorry, my suggestion did not worked in your case correctly as split used
natural factor ordering.

So using Jim's data, this results in desired output.

#prepare factor in original ordering
ff <- factor(xx[,1], levels=unique(xx[,1]))
lll <- split(xx$COMPANY_NUMBER, ff)
xx$I <- unlist(lapply(lll, function(x) c(rep(1, length(x)-1),
max(length(x)))),use.names=FALSE)
xx$J <- unlist(lapply(lll, function(x) 1:length(x)), use.names=FALSE)
> xx
   COMPANY_NUMBER NUMBER_OF_YEARS I J
1           70837               3 1 1
2           70837               3 1 2
3           70837               3 3 3
4         1000403               4 1 1
5         1000403               4 1 2
6         1000403               4 1 3
7         1000403               4 4 4
8        10029943               3 1 1
9        10029943               3 1 2
10       10029943               3 3 3
11       10037980               4 1 1
12       10037980               4 1 2
13       10037980               4 1 3
14       10037980               4 4 4
15       10057418               3 1 1
16       10057418               3 1 2
17       10057418               3 3 3
18        1009550               4 1 1
19        1009550               4 1 2
20        1009550               4 1 3
21        1009550               4 4 4

Cheers.
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Jim Lemon
> Sent: Friday, April 30, 2021 11:45 AM
> To: e-mail ma015k3113 <ma015k3113 at blueyonder.co.uk>; r-help mailing list
> <r-help at r-project.org>
> Subject: Re: [R] Help understanding loop behaviour
> 
> Hi email,
> If you want what you described, try this:
> 
> xx<-read.table(text="COMPANY_NUMBER NUMBER_OF_YEARS
> 0070837  3
> 0070837  3
> 0070837  3
> 1000403  4
> 1000403  4
> 1000403  4
> 1000403  4
> 10029943  3
> 10029943  3
> 10029943  3
> 10037980  4
> 10037980  4
> 10037980  4
> 10037980  4
> 10057418  3
> 10057418  3
> 10057418  3
> 1009550  4
> 1009550  4
> 1009550  4
> 1009550  4",
> header=TRUE,stringsAsFactors=FALSE)
> xx$I<-NA
> xx$J<-NA
> row_count<-1
> for(row in 1:nrow(xx)) {
>  if(row == nrow(xx) ||
> xx$COMPANY_NUMBER[row]==xx$COMPANY_NUMBER[row+1]) {
>   xx$I[row]<-1
>   xx$J[row]<-row_count
>   row_count<-row_count+1
>  } else {
>   xx$I[row]<-xx$J[row]<-xx$NUMBER_OF_YEARS[row]
>   row_count<-1
>  }
> }
> xx
> 
> Like Petr, I am assuming that you want company 10057418 treated the same
> as the others. If not, let us know why. I am also adssuming that the first
three
> rows should _not_ have a "#" at the beginning, which means that they will
be
> discarded.
> 
> Jim
> 
> On Fri, Apr 30, 2021 at 1:41 AM e-mail ma015k3113 via R-help <r-help at r-
> project.org> wrote:
> >
> > I am trying to understand how loops in operate. I have a simple
> > dataframe xx which is as follows
> >
> > COMPANY_NUMBER   NUMBER_OF_YEARS
> >
> > #0070837                             3
> > #0070837                             3
> > #0070837                             3
> > 1000403                               4
> > 1000403                               4
> > 1000403                               4
> > 1000403                               4
> > 10029943                             3
> > 10029943                             3
> > 10029943                             3
> > 10037980                             4
> > 10037980                             4
> > 10037980                             4
> > 10037980                             4
> > 10057418                             3
> > 10057418                             3
> >
> > 10057418                             3
> > 1009550                               4
> > 1009550                               4
> > 1009550                               4
> > 1009550                               4
> > The code I have written is
> >
> > while (i <= nrow(xx1) )
> >
> > {
> >
> > for (j in 1:xx1$NUMBER_OF_YEARS[i])
> > {
> > xx1$I[i] <- i
> > xx1$J[j] <- j
> > xx1$NUMBER_OF_YEARS_j[j] <- xx1$NUMBER_OF_YEARS[j] } i=i +
> > (xx1$NUMBER_OF_YEARS[i] ) } After running the code I want my
> dataframe
> > to look like
> >
> > |COMPANY_NUMBER |NUMBER_OF_YEARS| | I| |J|
> >
> > |#0070837 |3| |1| |1|
> > |#0070837 |3| |1| |2|
> > |#0070837 |3| |3| |3|
> > |1000403 |4| |1| |1|
> > |1000403 |4| |1| |2|
> > |1000403 |4| |1| |3|
> > |1000403 |4| |4| |4|
> > |10029943 |3| |1| |1|
> > |10029943 |3| |1| |2|
> > |10029943 |3| |3| |3|
> > |10037980 |4| |1| |1|
> > |10037980 |4| |1| |2|
> > |10037980 |4| |1| |3|
> > |10037980 |4| |4| |4|
> > |10057418 |3| |1| |1|
> > |10057418 |3| |1| |1|
> > |10057418 |3| |1| |1|
> > |1009550 |4| |1| |1|
> > |1009550 |4| |1| |2|
> > |1009550 |4| |1| |3|
> > |1009550 |4| |4| |4|
> >
> >
> > I get the correct value of I but in the wrong row but the vaule of J
> > is correct in the first iteration and then it goes to 1
> >
> > Any help will be greatly appreciated
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Fri Apr 30 19:36:58 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Fri, 30 Apr 2021 18:36:58 +0100
Subject: [R] Help understanding loop behaviour
In-Reply-To: <b1031b55f1904a408de7aa67b19d9e6f@SRVEXCHCM1302.precheza.cz>
References: <679279936.579089.1619710842379@mail2.virginmedia.com>
 <CA+8X3fVm3mhCTP3z=Uzn2GJL21-iawt-c205T6+nJzFEBO=hzQ@mail.gmail.com>
 <b1031b55f1904a408de7aa67b19d9e6f@SRVEXCHCM1302.precheza.cz>
Message-ID: <2b419e1d-292c-e826-5810-c224d9d9e112@sapo.pt>

Hello,

For column J, ave/seq_along seems to be the simplest. For column I, ave 
is also a good option, it avoids split/lapply.


xx$I <- ave(xx$NUMBER_OF_YEARS, xx$COMPANY_NUMBER, FUN = function(x){
   c(rep(1, length(x) - 1), max(length(x)))
})

xx$J <- ave(xx$NUMBER_OF_YEARS, xx$COMPANY_NUMBER, FUN = seq_along)


Hope this helps,

?s 11:49 de 30/04/21, PIKAL Petr escreveu:
> Hallo,
> 
> Sorry, my suggestion did not worked in your case correctly as split used
> natural factor ordering.
> 
> So using Jim's data, this results in desired output.
> 
> #prepare factor in original ordering
> ff <- factor(xx[,1], levels=unique(xx[,1]))
> lll <- split(xx$COMPANY_NUMBER, ff)
> xx$I <- unlist(lapply(lll, function(x) c(rep(1, length(x)-1),
> max(length(x)))),use.names=FALSE)
> xx$J <- unlist(lapply(lll, function(x) 1:length(x)), use.names=FALSE)
>> xx
>     COMPANY_NUMBER NUMBER_OF_YEARS I J
> 1           70837               3 1 1
> 2           70837               3 1 2
> 3           70837               3 3 3
> 4         1000403               4 1 1
> 5         1000403               4 1 2
> 6         1000403               4 1 3
> 7         1000403               4 4 4
> 8        10029943               3 1 1
> 9        10029943               3 1 2
> 10       10029943               3 3 3
> 11       10037980               4 1 1
> 12       10037980               4 1 2
> 13       10037980               4 1 3
> 14       10037980               4 4 4
> 15       10057418               3 1 1
> 16       10057418               3 1 2
> 17       10057418               3 3 3
> 18        1009550               4 1 1
> 19        1009550               4 1 2
> 20        1009550               4 1 3
> 21        1009550               4 4 4
> 
> Cheers.
> Petr
> 
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Jim Lemon
>> Sent: Friday, April 30, 2021 11:45 AM
>> To: e-mail ma015k3113 <ma015k3113 at blueyonder.co.uk>; r-help mailing list
>> <r-help at r-project.org>
>> Subject: Re: [R] Help understanding loop behaviour
>>
>> Hi email,
>> If you want what you described, try this:
>>
>> xx<-read.table(text="COMPANY_NUMBER NUMBER_OF_YEARS
>> 0070837  3
>> 0070837  3
>> 0070837  3
>> 1000403  4
>> 1000403  4
>> 1000403  4
>> 1000403  4
>> 10029943  3
>> 10029943  3
>> 10029943  3
>> 10037980  4
>> 10037980  4
>> 10037980  4
>> 10037980  4
>> 10057418  3
>> 10057418  3
>> 10057418  3
>> 1009550  4
>> 1009550  4
>> 1009550  4
>> 1009550  4",
>> header=TRUE,stringsAsFactors=FALSE)
>> xx$I<-NA
>> xx$J<-NA
>> row_count<-1
>> for(row in 1:nrow(xx)) {
>>   if(row == nrow(xx) ||
>> xx$COMPANY_NUMBER[row]==xx$COMPANY_NUMBER[row+1]) {
>>    xx$I[row]<-1
>>    xx$J[row]<-row_count
>>    row_count<-row_count+1
>>   } else {
>>    xx$I[row]<-xx$J[row]<-xx$NUMBER_OF_YEARS[row]
>>    row_count<-1
>>   }
>> }
>> xx
>>
>> Like Petr, I am assuming that you want company 10057418 treated the same
>> as the others. If not, let us know why. I am also adssuming that the first
> three
>> rows should _not_ have a "#" at the beginning, which means that they will
> be
>> discarded.
>>
>> Jim
>>
>> On Fri, Apr 30, 2021 at 1:41 AM e-mail ma015k3113 via R-help <r-help at r-
>> project.org> wrote:
>>>
>>> I am trying to understand how loops in operate. I have a simple
>>> dataframe xx which is as follows
>>>
>>> COMPANY_NUMBER   NUMBER_OF_YEARS
>>>
>>> #0070837                             3
>>> #0070837                             3
>>> #0070837                             3
>>> 1000403                               4
>>> 1000403                               4
>>> 1000403                               4
>>> 1000403                               4
>>> 10029943                             3
>>> 10029943                             3
>>> 10029943                             3
>>> 10037980                             4
>>> 10037980                             4
>>> 10037980                             4
>>> 10037980                             4
>>> 10057418                             3
>>> 10057418                             3
>>>
>>> 10057418                             3
>>> 1009550                               4
>>> 1009550                               4
>>> 1009550                               4
>>> 1009550                               4
>>> The code I have written is
>>>
>>> while (i <= nrow(xx1) )
>>>
>>> {
>>>
>>> for (j in 1:xx1$NUMBER_OF_YEARS[i])
>>> {
>>> xx1$I[i] <- i
>>> xx1$J[j] <- j
>>> xx1$NUMBER_OF_YEARS_j[j] <- xx1$NUMBER_OF_YEARS[j] } i=i +
>>> (xx1$NUMBER_OF_YEARS[i] ) } After running the code I want my
>> dataframe
>>> to look like
>>>
>>> |COMPANY_NUMBER |NUMBER_OF_YEARS| | I| |J|
>>>
>>> |#0070837 |3| |1| |1|
>>> |#0070837 |3| |1| |2|
>>> |#0070837 |3| |3| |3|
>>> |1000403 |4| |1| |1|
>>> |1000403 |4| |1| |2|
>>> |1000403 |4| |1| |3|
>>> |1000403 |4| |4| |4|
>>> |10029943 |3| |1| |1|
>>> |10029943 |3| |1| |2|
>>> |10029943 |3| |3| |3|
>>> |10037980 |4| |1| |1|
>>> |10037980 |4| |1| |2|
>>> |10037980 |4| |1| |3|
>>> |10037980 |4| |4| |4|
>>> |10057418 |3| |1| |1|
>>> |10057418 |3| |1| |1|
>>> |10057418 |3| |1| |1|
>>> |1009550 |4| |1| |1|
>>> |1009550 |4| |1| |2|
>>> |1009550 |4| |1| |3|
>>> |1009550 |4| |4| |4|
>>>
>>>
>>> I get the correct value of I but in the wrong row but the vaule of J
>>> is correct in the first iteration and then it goes to 1
>>>
>>> Any help will be greatly appreciated
>>>          [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-
>> guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Fri Apr 30 20:46:48 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 30 Apr 2021 11:46:48 -0700
Subject: [R] Help understanding loop behaviour
In-Reply-To: <2b419e1d-292c-e826-5810-c224d9d9e112@sapo.pt>
References: <679279936.579089.1619710842379@mail2.virginmedia.com>
 <CA+8X3fVm3mhCTP3z=Uzn2GJL21-iawt-c205T6+nJzFEBO=hzQ@mail.gmail.com>
 <b1031b55f1904a408de7aa67b19d9e6f@SRVEXCHCM1302.precheza.cz>
 <2b419e1d-292c-e826-5810-c224d9d9e112@sapo.pt>
Message-ID: <CAGxFJbSkp59-qXn67kHcZvUbYwgf_qk8iYzszVXxtUYKo1U=zw@mail.gmail.com>

There is something wrong here I believe -- see inline below:

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Fri, Apr 30, 2021 at 10:37 AM Rui Barradas <ruipbarradas at sapo.pt> wrote:

> Hello,
>
> For column J, ave/seq_along seems to be the simplest. For column I, ave
> is also a good option, it avoids split/lapply.
>
>
> xx$I <- ave(xx$NUMBER_OF_YEARS, xx$COMPANY_NUMBER, FUN = function(x){
>    c(rep(1, length(x) - 1), max(length(x)))  ### ???
> })
>
> **********
length() returns a single integer, so max(length(x)) makes no sense
************************************


> xx$J <- ave(xx$NUMBER_OF_YEARS, xx$COMPANY_NUMBER, FUN = seq_along)
>
>
> Hope this helps,
>
> ?s 11:49 de 30/04/21, PIKAL Petr escreveu:
> > Hallo,
> >
> > Sorry, my suggestion did not worked in your case correctly as split used
> > natural factor ordering.
> >
> > So using Jim's data, this results in desired output.
> >
> > #prepare factor in original ordering
> > ff <- factor(xx[,1], levels=unique(xx[,1]))
> > lll <- split(xx$COMPANY_NUMBER, ff)
> > xx$I <- unlist(lapply(lll, function(x) c(rep(1, length(x)-1),
> > max(length(x)))),use.names=FALSE)
> > xx$J <- unlist(lapply(lll, function(x) 1:length(x)), use.names=FALSE)
> >> xx
> >     COMPANY_NUMBER NUMBER_OF_YEARS I J
> > 1           70837               3 1 1
> > 2           70837               3 1 2
> > 3           70837               3 3 3
> > 4         1000403               4 1 1
> > 5         1000403               4 1 2
> > 6         1000403               4 1 3
> > 7         1000403               4 4 4
> > 8        10029943               3 1 1
> > 9        10029943               3 1 2
> > 10       10029943               3 3 3
> > 11       10037980               4 1 1
> > 12       10037980               4 1 2
> > 13       10037980               4 1 3
> > 14       10037980               4 4 4
> > 15       10057418               3 1 1
> > 16       10057418               3 1 2
> > 17       10057418               3 3 3
> > 18        1009550               4 1 1
> > 19        1009550               4 1 2
> > 20        1009550               4 1 3
> > 21        1009550               4 4 4
> >
> > Cheers.
> > Petr
> >
> >> -----Original Message-----
> >> From: R-help <r-help-bounces at r-project.org> On Behalf Of Jim Lemon
> >> Sent: Friday, April 30, 2021 11:45 AM
> >> To: e-mail ma015k3113 <ma015k3113 at blueyonder.co.uk>; r-help mailing
> list
> >> <r-help at r-project.org>
> >> Subject: Re: [R] Help understanding loop behaviour
> >>
> >> Hi email,
> >> If you want what you described, try this:
> >>
> >> xx<-read.table(text="COMPANY_NUMBER NUMBER_OF_YEARS
> >> 0070837  3
> >> 0070837  3
> >> 0070837  3
> >> 1000403  4
> >> 1000403  4
> >> 1000403  4
> >> 1000403  4
> >> 10029943  3
> >> 10029943  3
> >> 10029943  3
> >> 10037980  4
> >> 10037980  4
> >> 10037980  4
> >> 10037980  4
> >> 10057418  3
> >> 10057418  3
> >> 10057418  3
> >> 1009550  4
> >> 1009550  4
> >> 1009550  4
> >> 1009550  4",
> >> header=TRUE,stringsAsFactors=FALSE)
> >> xx$I<-NA
> >> xx$J<-NA
> >> row_count<-1
> >> for(row in 1:nrow(xx)) {
> >>   if(row == nrow(xx) ||
> >> xx$COMPANY_NUMBER[row]==xx$COMPANY_NUMBER[row+1]) {
> >>    xx$I[row]<-1
> >>    xx$J[row]<-row_count
> >>    row_count<-row_count+1
> >>   } else {
> >>    xx$I[row]<-xx$J[row]<-xx$NUMBER_OF_YEARS[row]
> >>    row_count<-1
> >>   }
> >> }
> >> xx
> >>
> >> Like Petr, I am assuming that you want company 10057418 treated the same
> >> as the others. If not, let us know why. I am also adssuming that the
> first
> > three
> >> rows should _not_ have a "#" at the beginning, which means that they
> will
> > be
> >> discarded.
> >>
> >> Jim
> >>
> >> On Fri, Apr 30, 2021 at 1:41 AM e-mail ma015k3113 via R-help <r-help at r-
> >> project.org> wrote:
> >>>
> >>> I am trying to understand how loops in operate. I have a simple
> >>> dataframe xx which is as follows
> >>>
> >>> COMPANY_NUMBER   NUMBER_OF_YEARS
> >>>
> >>> #0070837                             3
> >>> #0070837                             3
> >>> #0070837                             3
> >>> 1000403                               4
> >>> 1000403                               4
> >>> 1000403                               4
> >>> 1000403                               4
> >>> 10029943                             3
> >>> 10029943                             3
> >>> 10029943                             3
> >>> 10037980                             4
> >>> 10037980                             4
> >>> 10037980                             4
> >>> 10037980                             4
> >>> 10057418                             3
> >>> 10057418                             3
> >>>
> >>> 10057418                             3
> >>> 1009550                               4
> >>> 1009550                               4
> >>> 1009550                               4
> >>> 1009550                               4
> >>> The code I have written is
> >>>
> >>> while (i <= nrow(xx1) )
> >>>
> >>> {
> >>>
> >>> for (j in 1:xx1$NUMBER_OF_YEARS[i])
> >>> {
> >>> xx1$I[i] <- i
> >>> xx1$J[j] <- j
> >>> xx1$NUMBER_OF_YEARS_j[j] <- xx1$NUMBER_OF_YEARS[j] } i=i +
> >>> (xx1$NUMBER_OF_YEARS[i] ) } After running the code I want my
> >> dataframe
> >>> to look like
> >>>
> >>> |COMPANY_NUMBER |NUMBER_OF_YEARS| | I| |J|
> >>>
> >>> |#0070837 |3| |1| |1|
> >>> |#0070837 |3| |1| |2|
> >>> |#0070837 |3| |3| |3|
> >>> |1000403 |4| |1| |1|
> >>> |1000403 |4| |1| |2|
> >>> |1000403 |4| |1| |3|
> >>> |1000403 |4| |4| |4|
> >>> |10029943 |3| |1| |1|
> >>> |10029943 |3| |1| |2|
> >>> |10029943 |3| |3| |3|
> >>> |10037980 |4| |1| |1|
> >>> |10037980 |4| |1| |2|
> >>> |10037980 |4| |1| |3|
> >>> |10037980 |4| |4| |4|
> >>> |10057418 |3| |1| |1|
> >>> |10057418 |3| |1| |1|
> >>> |10057418 |3| |1| |1|
> >>> |1009550 |4| |1| |1|
> >>> |1009550 |4| |1| |2|
> >>> |1009550 |4| |1| |3|
> >>> |1009550 |4| |4| |4|
> >>>
> >>>
> >>> I get the correct value of I but in the wrong row but the vaule of J
> >>> is correct in the first iteration and then it goes to 1
> >>>
> >>> Any help will be greatly appreciated
> >>>          [[alternative HTML version deleted]]
> >>>
> >>> ______________________________________________
> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>> PLEASE do read the posting guide
> >>> http://www.R-project.org/posting-guide.html
> >>> and provide commented, minimal, self-contained, reproducible code.
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide http://www.R-project.org/posting-
> >> guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


