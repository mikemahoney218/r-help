From ev@@|eun|@@en @end|ng |rom gm@||@com  Tue Nov  1 20:50:56 2022
From: ev@@|eun|@@en @end|ng |rom gm@||@com (Eva Maria Leunissen)
Date: Wed, 2 Nov 2022 08:50:56 +1300
Subject: [R] Unsubscribe from mailing list please
Message-ID: <CAFSxBJ7hU_6kD3rRpNKxUJSK-TEb-BR7FktoMgiTeQhUhCdP5w@mail.gmail.com>

Hi,

Could I please unsubscribe from the R-help mailing list?

Thanks

Eva

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Tue Nov  1 20:53:47 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 1 Nov 2022 12:53:47 -0700
Subject: [R] Unsubscribe from mailing list please
In-Reply-To: <CAFSxBJ7hU_6kD3rRpNKxUJSK-TEb-BR7FktoMgiTeQhUhCdP5w@mail.gmail.com>
References: <CAFSxBJ7hU_6kD3rRpNKxUJSK-TEb-BR7FktoMgiTeQhUhCdP5w@mail.gmail.com>
Message-ID: <CAGxFJbRyCUAeTSstTfXQ-WNOCp7j24ciC22ydqq8=n0CFK1k8Q@mail.gmail.com>

Follow the instructions in the UNSUBSCRIBE link below to unsubscribe.
-- Bert

On Tue, Nov 1, 2022 at 12:51 PM Eva Maria Leunissen <eva.leunissen at gmail.com>
wrote:

> Hi,
>
> Could I please unsubscribe from the R-help mailing list?
>
> Thanks
>
> Eva
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From drj|m|emon @end|ng |rom gm@||@com  Tue Nov  1 20:55:53 2022
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Wed, 2 Nov 2022 06:55:53 +1100
Subject: [R] Unsubscribe from mailing list please
In-Reply-To: <CAFSxBJ7hU_6kD3rRpNKxUJSK-TEb-BR7FktoMgiTeQhUhCdP5w@mail.gmail.com>
References: <CAFSxBJ7hU_6kD3rRpNKxUJSK-TEb-BR7FktoMgiTeQhUhCdP5w@mail.gmail.com>
Message-ID: <CA+8X3fXWhb-gA1Bf0F9YoYh_xNLX0-iY-cF0SdkvFDzxJvDrBw@mail.gmail.com>

Hi Eva,
As it says in the footer, go here:

https://stat.ethz.ch/mailman/listinfo/r-help

Jim

On Wed, Nov 2, 2022 at 6:51 AM Eva Maria Leunissen
<eva.leunissen at gmail.com> wrote:
>
> Hi,
>
> Could I please unsubscribe from the R-help mailing list?
>
> Thanks
>
> Eva
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From deep@y@n@@@rk@r @end|ng |rom gm@||@com  Wed Nov  2 08:48:22 2022
From: deep@y@n@@@rk@r @end|ng |rom gm@||@com (Deepayan Sarkar)
Date: Wed, 2 Nov 2022 13:18:22 +0530
Subject: [R] pairwise.var.test
In-Reply-To: <1072047486.2250763.1667174402828@mail.yahoo.com>
References: <2106973898.2175278.1667158279204.ref@mail.yahoo.com>
 <2106973898.2175278.1667158279204@mail.yahoo.com>
 <CA+8X3fW18ikb5aXkLC5HrFZo5N93sG=OmdM3i940Nr+3wsgvGA@mail.gmail.com>
 <b1a0082d-8d00-24e4-11a7-3f13572660ce@sapo.pt>
 <1072047486.2250763.1667174402828@mail.yahoo.com>
Message-ID: <CADfFDC6htyoPMaW2c0O+No4XfBhgbSczyEBfnmT9pMJ1qoXjCw@mail.gmail.com>

On Mon, Oct 31, 2022 at 5:30 AM Thomas Subia via R-help
<r-help at r-project.org> wrote:
>
> Colleagues,
>
> Thank you all for the timely suggestions. That is appreciated.
>
> What I am really looking for a way to identify difference in group level variance by using multiple comparison intervals. Minitab displays those results in a graph.
>
> This method is described in:
> https://support.minitab.com/en-us/minitab/20/media/pdfs/translate/Multiple_Comparisons_Method_Test_for_Equal_Variances.pdf
>
> I was hoping that R had something similar.

Perhaps you are looking for something like the plot produced by

example(TukeyHSD)

For this you would need confidence intervals for each pairwise
comparison, not just the p-values. Once you have those, recreating the
plot should not be difficult, but I don't know if there is any package
that already does this for you. E.g., car::leveneTest() etc. are
designed for multiple groups and won't give you confidence intervals.

Best,
-Deepayan

>
> I tried a Google search on this but to no avail.
>
> Thomas Subia
>
>
>
>
>
>
> On Sunday, October 30, 2022 at 03:44:54 PM PDT, Rui Barradas <ruipbarradas at sapo.pt> wrote:
>
>
>
>
>
> ?s 21:47 de 30/10/2022, Jim Lemon escreveu:
> > Hi Thomas,
> > I have assumed the format of your p-value matrix. This may require
> > some adjustment.
> >
> >    A          B          C        D          E          F
> > A 1          0.7464    0.0187    0.0865      0.0122      0.4693
> > B 0.7464    1          0.0358    0.1502      0.0173      0.3240
> > C 0.0187    0.0358    1        0.5131      0.7185      0.0050
> > D 0.0865    0.1502    0.5131    1          0.3240      0.0173
> > E 0.0122    0.0173    0.7185    0.3240      1          0.0029
> > F 0.4693    0.3240    0.0050    0.0173      0.0029      1
> >
> > pvar.mat<-as.matrix(read.table(text=
> >  "1          0.7464    0.0187    0.0865      0.0122      0.4693
> >  0.7464    1          0.0358    0.1502      0.0173      0.3240
> >  0.0187    0.0358    1        0.5131      0.7185      0.0050
> >  0.0865    0.1502    0.5131    1          0.3240      0.0173
> >  0.0122    0.0173    0.7185    0.3240      1          0.0029
> >  0.4693    0.3240    0.0050    0.0173      0.0029      1",
> >  stringsAsFactors=FALSE))
> > rownames(pvar.mat)<-colnames(pvar.mat)<-LETTERS[1:6]
> > pvar.col<-matrix(NA,nrow=6,ncol=6)
> > pvar.col[pvar.mat < 1]<-"red"
> > pvar.col[pvar.mat < 0.05]<-"orange"
> > pvar.col[pvar.mat < 0.01]<-"green"
> > library(plotrix)
> > par(mar=c(6,4,4,2))
> > color2D.matplot(pvar.mat,cellcolors=pvar.col,
> >  main="P-values for matrix",axes=FALSE)
> > axis(1,at=seq(0.5,5.5,by=1),labels=LETTERS[1:6])
> > axis(2,at=seq(0.5,5.5,by=1),labels=rev(LETTERS[1:6]))
> > color.legend(0,-1.3,2.5,-0.7,c("NA","NS","<0.05","<0.01"),
> >  rect.col=c(NA,"red","orange","green"))
> >
> > Jim
> >
> > On Mon, Oct 31, 2022 at 6:34 AM Thomas Subia via R-help
> > <r-help at r-project.org> wrote:
> >>
> >> Colleagues,
> >>
> >> The RVAideMemoire package has a pairwise variance test which one can use to identify variance differences between group levels.
> >>
> >> Using the example from this package, pairwise.var.test(InsectSprays$count,InsectSprays$spray), we get this output:
> >>
> >>      Pairwise comparisons using F tests to compare two variances
> >>
> >> data:  InsectSprays$count and InsectSprays$spray
> >>
> >>    A              B            C            D            E
> >> B 0.7464    -              -              -              -
> >> C 0.0187    0.0358    -      -      -
> >> D 0.0865    0.1502    0.5131    -            -
> >> E 0.0122    0.0173    0.7185    0.3240    -
> >> F 0.4693    0.3240    0.0050    0.0173    0.0029
> >>
> >> P value adjustment method: fdr
> >>
> >> Is there a way to graph the pairwise variance differences so that users can easily identify the statistically significant variance differences between group levels?
> >>
> >> I can do this using Minitab but I'd prefer using R for this.
> >>
> >> Thomas Subia
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
>
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
>
> Hello,
>
> With Jim's data creation code, here is a ggplot graph.
>
> First coerce to data.frame, then reshape to long format.
> Now bin the p-values with the cutpoints 0.01, 0.05 and 1. This is dne
> with ?findInterval.
>
> The colors are assigned in the plot code, based on the binned p.values
> above.
>
>
> library(ggplot2)
>
> pvar.mat |> as.data.frame() -> pvar.df
> pvar.df$id <- row.names(pvar.df)
>
> pvar.df |> tidyr::pivot_longer(-id, values_to = "p.value") -> pvar.long
> i <- findInterval(pvar.long$p.value, c(0, 0.01, 0.05, 1))
> pvar.long$p.value <- c("<0.01", "<0.05", "NS", "NA")[i]
> clrs <- setNames(c("green", "blue", "lightgrey", "white"),
>                   c("<0.01", "<0.05", "NS", "NA"))
>
> ggplot(pvar.long, aes(id, name, fill = p.value)) +
>   geom_tile() +
>   scale_y_discrete(limits = rev) +
>   scale_fill_manual(values = clrs) +
>   theme_bw()
>
>
> Hope this helps,
>
> Rui Barradas
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Nov  4 08:40:00 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 4 Nov 2022 10:40:00 +0300
Subject: [R] R-package imputeTS / warning messages
In-Reply-To: <a50e3024-bebe-1648-3a96-7c425ca7cc09@infolink.com.br>
References: <a50e3024-bebe-1648-3a96-7c425ca7cc09@infolink.com.br>
Message-ID: <20221104104000.68dd9310@Tarkus>

Dear Paulo Barata,

On Wed, 26 Oct 2022 11:27:54 -0300
Paulo Barata <pb at infolink.com.br> wrote:

> In stats::StructTS(data, ...) :
>    possible convergence problem: 'optim' gave code = 52 and message
> ?ERROR: ABNORMAL_TERMINATION_IN_LNSRCH?
> 
> The function StructTS is called by the function na_kalman of the 
> imputeTS package.

Since you're not getting replies here, it might help to contact
maintainer('imputeTS').

I think that ABNORMAL_TERMINATION_IN_LNSRCH happens when the line
search part of the L-BFGS-B algorithm determines that the directional
derivative of the function being optimised along the direction of the
previous step turns out to be positive, meaning that the step direction
was bad in the first place. There may be many reasons for this to
happen.

It might also help to look at the optimisation process by passing the
optim.control = list(trace = 3) argument (available levels are 1 to 6,
with 6 being very verbose).

-- 
Best regards,
Ivan


From @@ch@ndh|@| @end|ng |rom bt|nternet@com  Thu Nov  3 20:08:27 2022
From: @@ch@ndh|@| @end|ng |rom bt|nternet@com (Amarjit Chandhial)
Date: Thu, 3 Nov 2022 19:08:27 +0000 (GMT)
Subject: [R] Associate a .R file with the RGui
Message-ID: <3095309c.153f5.1843ee50418.Webtop.109@btinternet.com>


Hi,


My OS is Windows 11 Pro 64-Bit, I have R 4.2.2 and RStudio installed.

If I double-click on a .R file in File Explorer the OS gives me the 
option of opening the .R in RStudio, or Look for an app in the Microsoft 
Store, or More Apps. Similarly with a right-click.

I would like to associate a .R file with the RGui, not RStudio, thus 
when I double-click on a .R file in File Explorer the .R file opens in 
the R Editor in RGui.

On my PC R 4.2.2 is located in "C:/Program Files/R/R-4.2.2/etc"

Please can someone provide step-by-step instructions on how to 
associate?


thanks,
Amarjit

	[[alternative HTML version deleted]]


From @kw@|mmo @end|ng |rom gm@||@com  Fri Nov  4 10:08:50 2022
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Fri, 4 Nov 2022 05:08:50 -0400
Subject: [R] Associate a .R file with the RGui
In-Reply-To: <3095309c.153f5.1843ee50418.Webtop.109@btinternet.com>
References: <3095309c.153f5.1843ee50418.Webtop.109@btinternet.com>
Message-ID: <CAPcHnpRXz6vgf9M93quk48pudJ+9ntb-2hiTryE3itrB80X-ow@mail.gmail.com>

In an R session, run this:

writeLines(normalizePath(R.home("bin")))

Right click your .R file > Open with > Choose another app > Check the box
"Always use this app to open .R files" > Look for another app on this PC
Paste the directory found above, then select "Rgui.exe"

On Fri, Nov 4, 2022, 04:49 Amarjit Chandhial via R-help <
r-help at r-project.org> wrote:

>
> Hi,
>
>
> My OS is Windows 11 Pro 64-Bit, I have R 4.2.2 and RStudio installed.
>
> If I double-click on a .R file in File Explorer the OS gives me the
> option of opening the .R in RStudio, or Look for an app in the Microsoft
> Store, or More Apps. Similarly with a right-click.
>
> I would like to associate a .R file with the RGui, not RStudio, thus
> when I double-click on a .R file in File Explorer the .R file opens in
> the R Editor in RGui.
>
> On my PC R 4.2.2 is located in "C:/Program Files/R/R-4.2.2/etc"
>
> Please can someone provide step-by-step instructions on how to
> associate?
>
>
> thanks,
> Amarjit
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From petr@p|k@| @end|ng |rom prechez@@cz  Fri Nov  4 12:28:47 2022
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Fri, 4 Nov 2022 11:28:47 +0000
Subject: [R] Associate a .R file with the RGui
In-Reply-To: <CAPcHnpRXz6vgf9M93quk48pudJ+9ntb-2hiTryE3itrB80X-ow@mail.gmail.com>
References: <3095309c.153f5.1843ee50418.Webtop.109@btinternet.com>
 <CAPcHnpRXz6vgf9M93quk48pudJ+9ntb-2hiTryE3itrB80X-ow@mail.gmail.com>
Message-ID: <29273f33bf3a48bf924134053aacc871@SRVEXCHCM1302.precheza.cz>

Hi 

another option is to use SendTo folder. This was easy to find in older
Windows versions. Now the easiest way is:

Press the Windows Key + R to trigger the Run window. At the Open field in
the window, type shell:SendTo and then click OK

And SendTo folder should open.

You can then add link to any application here so add RGui link

After that, rightclick on file .RData file and menu with option SendTo opens
with RGui one of the options.

I learned it before ages and it is quite usefull not only in this case.

Here is link to another explanation.

https://www.pcmag.com/how-to/how-to-customize-the-send-to-menu-in-windows

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Andrew Simmons
> Sent: Friday, November 4, 2022 10:09 AM
> To: Amarjit Chandhial <a.chandhial at btinternet.com>
> Cc: R-help Mailing List <r-help at r-project.org>
> Subject: Re: [R] Associate a .R file with the RGui
> 
> In an R session, run this:
> 
> writeLines(normalizePath(R.home("bin")))
> 
> Right click your .R file > Open with > Choose another app > Check the box
> "Always use this app to open .R files" > Look for another app on this PC
Paste
> the directory found above, then select "Rgui.exe"
> 
> On Fri, Nov 4, 2022, 04:49 Amarjit Chandhial via R-help < r-help at r-
> project.org> wrote:
> 
> >
> > Hi,
> >
> >
> > My OS is Windows 11 Pro 64-Bit, I have R 4.2.2 and RStudio installed.
> >
> > If I double-click on a .R file in File Explorer the OS gives me the
> > option of opening the .R in RStudio, or Look for an app in the
> > Microsoft Store, or More Apps. Similarly with a right-click.
> >
> > I would like to associate a .R file with the RGui, not RStudio, thus
> > when I double-click on a .R file in File Explorer the .R file opens in
> > the R Editor in RGui.
> >
> > On my PC R 4.2.2 is located in "C:/Program Files/R/R-4.2.2/etc"
> >
> > Please can someone provide step-by-step instructions on how to
> > associate?
> >
> >
> > thanks,
> > Amarjit
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

From petr@p|k@| @end|ng |rom prechez@@cz  Fri Nov  4 13:19:09 2022
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Fri, 4 Nov 2022 12:19:09 +0000
Subject: [R] data frame returned from sapply but vector expected
Message-ID: <eba27eb500454f08b5d7c647f3c4cb64@SRVEXCHCM1302.precheza.cz>

Hallo all

 

I found a strange problem for coding if part of list is NULL. 

In this case, sapply result is ***list of data frames*** but if there is no
NULL leaf, the result is ***list of vectors***. 

I tried simplify option but it did not help me neither I found anything in
help page. 

 

The code is part of bigger project where I fill list by reading in data and
if it fails, the leaf is set to NULL. Then the the boxplot is created simply
by

boxplot(sapply(mylist2, "[", "b")) and the user is asked to select if values
should be rbinded or not.

 

Is it possible to perform some *apply without getting data frame as result
in case NULL leaf?

 

Here is an example (without boxplot)

 

df1 <- data.frame(a=rnorm(5), b=runif(5), c=rlnorm(5))

df2 <- data.frame(a=rnorm(5), b=runif(5), c=rlnorm(5))

mylist1 <- list(df1,df2, df3)

mylist2 <- list(NULL,df2, df3)

> str(sapply(mylist1, "[", "b"))

List of 3

$ b: num [1:5] 0.387 0.69 0.876 0.836 0.819

$ b: num [1:5] 0.01733 0.46055 0.19421 0.11609 0.00789

$ b: num [1:5] 0.593 0.478 0.299 0.185 0.847

> str(sapply(mylist2, "[", "b"))

List of 3

$ : NULL

$ :'data.frame':       5 obs. of  1 variable:

  ..$ b: num [1:5] 0.01733 0.46055 0.19421 0.11609 0.00789

$ :'data.frame':       5 obs. of  1 variable:

  ..$ b: num [1:5] 0.593 0.478 0.299 0.185 0.847

 

S pozdravem | Best Regards

RNDr. Petr PIKAL
Vedouc? V?zkumu a v?voje | Research Manager

PRECHEZA a.s.
n?b?. Dr. Edvarda Bene?e 1170/24 | 750 02 P?erov | Czech Republic
Tel: +420 581 252 256 | GSM: +420 724 008 364
 <mailto:petr.pikal at precheza.cz> petr.pikal at precheza.cz |
<https://www.precheza.cz/> www.precheza.cz

Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch
partner? PRECHEZA a.s. jsou zve?ejn?ny na:
<https://www.precheza.cz/zasady-ochrany-osobnich-udaju/>
https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information about
processing and protection of business partner's personal data are available
on website:
<https://www.precheza.cz/en/personal-data-protection-principles/>
https://www.precheza.cz/en/personal-data-protection-principles/

D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn?
a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en? odpov?dnosti:
<https://www.precheza.cz/01-dovetek/> https://www.precheza.cz/01-dovetek/ |
This email and any documents attached to it may be confidential and are
subject to the legally binding disclaimer:
<https://www.precheza.cz/en/01-disclaimer/>
https://www.precheza.cz/en/01-disclaimer/

 


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Nov  4 13:30:27 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 4 Nov 2022 15:30:27 +0300
Subject: [R] data frame returned from sapply but vector expected
In-Reply-To: <eba27eb500454f08b5d7c647f3c4cb64@SRVEXCHCM1302.precheza.cz>
References: <eba27eb500454f08b5d7c647f3c4cb64@SRVEXCHCM1302.precheza.cz>
Message-ID: <20221104153027.58376688@Tarkus>

On Fri, 4 Nov 2022 12:19:09 +0000
PIKAL Petr <petr.pikal at precheza.cz> wrote:

> > str(sapply(mylist2, "[", "b"))  
> 
> List of 3
> 
> $ : NULL
> 
> $ :'data.frame':       5 obs. of  1 variable:
> 
>   ..$ b: num [1:5] 0.01733 0.46055 0.19421 0.11609 0.00789
> 
> $ :'data.frame':       5 obs. of  1 variable:
> 
>   ..$ b: num [1:5] 0.593 0.478 0.299 0.185 0.847

Is sapply(mylist2, `[[`, 'b') closer to what you'd like to see, i.e. a
list of vectors or NULLs?

-- 
Best regards,
Ivan


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Nov  4 13:36:46 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 4 Nov 2022 15:36:46 +0300
Subject: [R] data frame returned from sapply but vector expected
In-Reply-To: <20221104153027.58376688@Tarkus>
References: <eba27eb500454f08b5d7c647f3c4cb64@SRVEXCHCM1302.precheza.cz>
 <20221104153027.58376688@Tarkus>
Message-ID: <20221104153646.54abd951@Tarkus>

On Fri, 4 Nov 2022 15:30:27 +0300
Ivan Krylov <krylov.r00t at gmail.com> wrote:

> sapply(mylist2, `[[`, 'b')

Wait, that would simplify the return value into a matrix when there are
no NULLs. But lapply(mylist2, `[[`, 'b') should work in both cases,
which in my opinion goes to show the dangers of using simplifying
functions in to-be-library code.

Sorry for the double-post!

-- 
Best regards,
Ivan


From petr@p|k@| @end|ng |rom prechez@@cz  Fri Nov  4 13:57:04 2022
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Fri, 4 Nov 2022 12:57:04 +0000
Subject: [R] data frame returned from sapply but vector expected
In-Reply-To: <20221104153646.54abd951@Tarkus>
References: <eba27eb500454f08b5d7c647f3c4cb64@SRVEXCHCM1302.precheza.cz>
 <20221104153027.58376688@Tarkus> <20221104153646.54abd951@Tarkus>
Message-ID: <991e2310edb8478ebdc4e570330fbf0c@SRVEXCHCM1302.precheza.cz>

Hallo Ivan

Thanks, yes it seems to be working. I thought also removing NULL by

mylist2[sapply(mylist2, is.null)] <- NULL

but your approach is probably better (in any case simpler)

Thanks again.

Petr

> -----Original Message-----
> From: Ivan Krylov <krylov.r00t at gmail.com>
> Sent: Friday, November 4, 2022 1:37 PM
> To: PIKAL Petr <petr.pikal at precheza.cz>
> Cc: R-help Mailing List <r-help at r-project.org>
> Subject: Re: [R] data frame returned from sapply but vector expected
> 
> On Fri, 4 Nov 2022 15:30:27 +0300
> Ivan Krylov <krylov.r00t at gmail.com> wrote:
> 
> > sapply(mylist2, `[[`, 'b')
> 
> Wait, that would simplify the return value into a matrix when there are no
> NULLs. But lapply(mylist2, `[[`, 'b') should work in both cases, which in
my
> opinion goes to show the dangers of using simplifying functions in
to-be-library
> code.
> 
> Sorry for the double-post!
> 
> --
> Best regards,
> Ivan

From @k@h@y_e4 @end|ng |rom hotm@||@com  Fri Nov  4 20:35:11 2022
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Fri, 4 Nov 2022 19:35:11 +0000
Subject: [R] on parallel processing...
Message-ID: <PU4P216MB1568536BCB9BF18690898F1BC83B9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

Dear members,
                              I want to send the same function with different arguments to different processors. This solution was provided in Stack Overflow https://stackoverflow.com/questions/25045998/send-function-calls-with-different-arguments-to-different-processors-in-r-using
[https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon at 2.png?v=73d79a89bded]<https://stackoverflow.com/questions/25045998/send-function-calls-with-different-arguments-to-different-processors-in-r-using>
Send function calls with different arguments to different processors in R using parallel package - Stack Overflow<https://stackoverflow.com/questions/25045998/send-function-calls-with-different-arguments-to-different-processors-in-r-using>
Teams. Q&A for work. Connect and share knowledge within a single location that is structured and easy to search. Learn more about Teams
stackoverflow.com
I have a 48 core processor. My question is, how do i loop through the cores without explicitly mentioning the core numbers?
Will this work?



library(parallel)
cl <- makeCluster(4)
clusterExport(cl, "foo")
cores <- seq_along(cl)
r <- clusterApply(cl[cores], cores, function(core) {

  for(i in 1:48) {

      if (core ==i) {

        foo( x[i] )

}
}
})

Many thanks in advance......

Thanking you,
Your sincerely,
AKSHAY M KULKARNI

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Nov  4 20:54:10 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 04 Nov 2022 12:54:10 -0700
Subject: [R] on parallel processing...
In-Reply-To: <PU4P216MB1568536BCB9BF18690898F1BC83B9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
References: <PU4P216MB1568536BCB9BF18690898F1BC83B9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
Message-ID: <2358A5EA-B207-4A02-97DF-2AB97962CF3B@dcn.davis.ca.us>

You don't specify processors. Just invoke the worker functions with the relevant packages and they will be allocated according to how you defined the cluster object... typically automatically. Processors are usually specified (to the cluster object) according to IP address. Cores within the processors are allocated according to how many processes are created.

Maybe you should read some documentation (vignettes), and/or look into R-sig-hpc (https://stat.ethz.ch/mailman/listinfo/r-sig-hpc). This is probably not the best place to pursue this.

On November 4, 2022 12:35:11 PM PDT, akshay kulkarni <akshay_e4 at hotmail.com> wrote:
>Dear members,
>                              I want to send the same function with different arguments to different processors. This solution was provided in Stack Overflow https://stackoverflow.com/questions/25045998/send-function-calls-with-different-arguments-to-different-processors-in-r-using
>[https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon at 2.png?v=73d79a89bded]<https://stackoverflow.com/questions/25045998/send-function-calls-with-different-arguments-to-different-processors-in-r-using>
>Send function calls with different arguments to different processors in R using parallel package - Stack Overflow<https://stackoverflow.com/questions/25045998/send-function-calls-with-different-arguments-to-different-processors-in-r-using>
>Teams. Q&A for work. Connect and share knowledge within a single location that is structured and easy to search. Learn more about Teams
>stackoverflow.com
>I have a 48 core processor. My question is, how do i loop through the cores without explicitly mentioning the core numbers?
>Will this work?
>
>
>
>library(parallel)
>cl <- makeCluster(4)
>clusterExport(cl, "foo")
>cores <- seq_along(cl)
>r <- clusterApply(cl[cores], cores, function(core) {
>
>  for(i in 1:48) {
>
>      if (core ==i) {
>
>        foo( x[i] )
>
>}
>}
>})
>
>Many thanks in advance......
>
>Thanking you,
>Your sincerely,
>AKSHAY M KULKARNI
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From @k@h@y_e4 @end|ng |rom hotm@||@com  Fri Nov  4 21:12:12 2022
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Fri, 4 Nov 2022 20:12:12 +0000
Subject: [R] on parallel processing...
In-Reply-To: <2358A5EA-B207-4A02-97DF-2AB97962CF3B@dcn.davis.ca.us>
References: <PU4P216MB1568536BCB9BF18690898F1BC83B9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <2358A5EA-B207-4A02-97DF-2AB97962CF3B@dcn.davis.ca.us>
Message-ID: <PU4P216MB1568EA9317DF386626A39645C83B9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

dear Jeff,
                 Yeah, you are right.....just went through the documentation and found out that clusterApplyLB() from parallel package does the job... Thanks again....

THanking you,
Yours sincerely
AKSHAY M KULKARNI
________________________________
From: Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
Sent: Saturday, November 5, 2022 1:24 AM
To: r-help at r-project.org <r-help at r-project.org>; akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
Subject: Re: [R] on parallel processing...

You don't specify processors. Just invoke the worker functions with the relevant packages and they will be allocated according to how you defined the cluster object... typically automatically. Processors are usually specified (to the cluster object) according to IP address. Cores within the processors are allocated according to how many processes are created.

Maybe you should read some documentation (vignettes), and/or look into R-sig-hpc (https://stat.ethz.ch/mailman/listinfo/r-sig-hpc). This is probably not the best place to pursue this.

On November 4, 2022 12:35:11 PM PDT, akshay kulkarni <akshay_e4 at hotmail.com> wrote:
>Dear members,
>                              I want to send the same function with different arguments to different processors. This solution was provided in Stack Overflow https://stackoverflow.com/questions/25045998/send-function-calls-with-different-arguments-to-different-processors-in-r-using
>[https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon at 2.png?v=73d79a89bded]<https://stackoverflow.com/questions/25045998/send-function-calls-with-different-arguments-to-different-processors-in-r-using>
>Send function calls with different arguments to different processors in R using parallel package - Stack Overflow<https://stackoverflow.com/questions/25045998/send-function-calls-with-different-arguments-to-different-processors-in-r-using>
>Teams. Q&A for work. Connect and share knowledge within a single location that is structured and easy to search. Learn more about Teams
>stackoverflow.com
>I have a 48 core processor. My question is, how do i loop through the cores without explicitly mentioning the core numbers?
>Will this work?
>
>
>
>library(parallel)
>cl <- makeCluster(4)
>clusterExport(cl, "foo")
>cores <- seq_along(cl)
>r <- clusterApply(cl[cores], cores, function(core) {
>
>  for(i in 1:48) {
>
>      if (core ==i) {
>
>        foo( x[i] )
>
>}
>}
>})
>
>Many thanks in advance......
>
>Thanking you,
>Your sincerely,
>AKSHAY M KULKARNI
>
>       [[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

--
Sent from my phone. Please excuse my brevity.

	[[alternative HTML version deleted]]


From T|||@ny@Duh| @end|ng |rom tu|t@@edu  Fri Nov  4 16:13:54 2022
From: T|||@ny@Duh| @end|ng |rom tu|t@@edu (Duhl, Tiffany R.)
Date: Fri, 4 Nov 2022 15:13:54 +0000
Subject: [R] Selecting a minimum value of an attribute associated with point
 values neighboring a given point and assigning it as a new attribute
Message-ID: <BN6PR05MB35887EFE01222DBF7C359AAB903B9@BN6PR05MB3588.namprd05.prod.outlook.com>

Hello,

I have sets of spatial points with LAT, LON coords (unprojected, WGS84 datum) and several value attributes associated with each point, from numerous csv files (with an average of 6,000-9,000 points in each file) as shown in the following example:

data<- read.csv("R_find_pts_testdata.csv")

> data
    ID      Date         Time        LAT            LON           Conc    Leg.Speed    CO2  H2O BC61 Hr Min Sec
1   76 4/19/2021 21:25:38 42.40066 -70.98802 99300   0.0 mph 428.39 9.57  578 21  25  38
2   77 4/19/2021 21:25:39 42.40066 -70.98802 96730   0.0 mph 428.04 9.57  617 21  25  39
3   79 4/19/2021 21:25:41 42.40066 -70.98802 98800   0.2 mph 427.10 9.57 1027 21  25  41
4   80 4/19/2021 21:25:42 42.40066 -70.98802 96510     2 mph 427.99 9.58 1381 21  25  42
5   81 4/19/2021 21:25:43 42.40067 -70.98801 95540     3 mph 427.99 9.58 1271 21  25  43
6   82 4/19/2021 21:25:44 42.40068 -70.98799 94720     4 mph 427.20 9.57  910 21  25  44
7   83 4/19/2021 21:25:45 42.40069 -70.98797 94040     5 mph 427.18 9.57  652 21  25  45
8   84 4/19/2021 21:25:46 42.40072 -70.98795 95710     7 mph 427.07 9.57  943 21  25  46
9   85 4/19/2021 21:25:47 42.40074 -70.98792 96200     8 mph 427.44 9.56  650 21  25  47
10  86 4/19/2021 21:25:48 42.40078 -70.98789 93750    10 mph 428.76 9.57  761 21  25  48
11  87 4/19/2021 21:25:49 42.40081 -70.98785 93360    11 mph 429.25 9.56 1158 21  25  49
12  88 4/19/2021 21:25:50 42.40084 -70.98781 94340    12 mph 429.56 9.57  107 21  25  50
13  89 4/19/2021 21:25:51 42.40087 -70.98775 92780    12 mph 428.62 9.56  720 21  25  51


What I want to do is, for each point, identify all points within 50m of that point, find the minimum value of the "Conc" attribute of each nearby set of points (including the original point) and then create a new variable ("Conc_min") and assign this minimum value to a new variable added to "data".

So far, I have the following code:

library(spdep)
library(sf)

setwd("C:\\mydirectory\\")
data<- read.csv("R_find_pts_testdata.csv")

#make sure the data is a data frame
pts <- data.frame(data)

#create spatial data frame and define projection
pts_coords <- cbind(pts$LON, pts$LAT)
data_pts <- SpatialPointsDataFrame(coords= pts_coords,
data=pts, proj4string = CRS("+proj=longlat +datum=WGS84"))

#Re-project to WGS 84 / UTM zone 18N, so the analysis is in units of m
ptsUTM  <- sf::st_as_sf(data_pts, coords = c("LAT", "LON"), remove = F)%>% st_transform(32618)

#create 50 m buffer around each point then intersect with points and finally find neighbors within the buffers
pts_buf <- sf::st_buffer(ptsUTM, 50)
coords  <- sf::st_coordinates(ptsUTM)
int <- sf::st_intersects(pts_buf, ptsUTM)
x   <- spdep::dnearneigh(coords, 0, 50)

Now at this point, I'm not sure what to either the "int" (a sgbp list) or "x" (nb object) objects (or even if I need them both)

> int
Sparse geometry binary predicate list of length 974, where the predicate was `intersects'
first 10 elements:
 1: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
 2: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
 3: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
 4: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
 5: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
 6: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
 7: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
 8: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
 9: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...

> x
Neighbour list object:
Number of regions: 974
Number of nonzero links: 34802
Percentage nonzero weights: 3.668481
Average number of links: 35.73101

One thought is that maybe I don't need the dnearneigh function and can instead convert "int" into a dataframe and somehow merge or associate (perhaps with an inner join) the ID fields of the buffered and intersecting points and then compute the minimum value of "Conc" grouping by ID:

> as.data.frame(int)
    row.id col.id
1        1      1
2        1      2
3        1      3
4        1      4
5        1      5
6        1      6
7        1      7
8        1      8
9        1      9
10       1     10
11       1     11
12       1     12
13       1     13
14       1     14
15       1     15
16       1     16
17       1     17
18       1     18
19       2      1
20       2      2
21       2      3
22       2      4
23       2      5
24       2      6
25       2      7
26       2      8
27       2      9
28       2     10


So in the above example I'd like to take the minimum of "Conc" among the col.id points grouped with row.id 1 (i.e., col.ids 1-18) and assign the  minimum value of this group as a new variable in data (Data$Conc_min), and do the same for row.id 2 and all the rest of the rows.

I'm just not sure how to do this and I appreciate any help folks might have on this matter!

Many thanks,
-Tiffany

	[[alternative HTML version deleted]]


From @|gbert @end|ng |rom w|w|@hu-ber||n@de  Sat Nov  5 09:04:23 2022
From: @|gbert @end|ng |rom w|w|@hu-ber||n@de (Sigbert Klinke)
Date: Sat, 5 Nov 2022 09:04:23 +0100
Subject: [R] rio: list of extensions for supported formats
Message-ID: <419a5ed0-ac91-65c0-838f-a05307f9bbc0@wiwi.hu-berlin.de>

Hi,

is there a function in the package rio to get the file extensions listed 
in the vignette under supported formats?

Thanks Sigbert


From @@ch@ndh|@| @end|ng |rom bt|nternet@com  Sat Nov  5 14:47:54 2022
From: @@ch@ndh|@| @end|ng |rom bt|nternet@com (Amarjit Chandhial)
Date: Sat, 5 Nov 2022 13:47:54 +0000 (GMT)
Subject: [R] Associate a .R file with the RGui
Message-ID: <6c894531.98c9.184480c446a.Webtop.100@btinternet.com>




Hi Andrew/Petr,


Thanks for the replies.

In R Console if I run:

R.home("bin")

I get the following

"C:/PROGRA~1/R/R-42~1.2/bin/x64"

which is where

Rgui.exe is (within the x64 folder there are 13 files in total: 8 . exe 
and 5 .dll).


In file Explorer if I right-click on a .R file -> Open With -> R for 
Windows GUI Front-End

RGui (64-bit) opens but the .R file does not appear in the editor.


Amarjit


------ Original Message ------
From: "Andrew Simmons" <akwsimmo at gmail.com>
To: "Amarjit Chandhial" <a.chandhial at btinternet.com>
Cc: "R-help Mailing List" <r-help at r-project.org>
Sent: Friday, 4 Nov, 2022 At 09:08
Subject: Re: [R] Associate a .R file with the RGui

In an R session, run this:

writeLines(normalizePath(R.home("bin")))


Right click your .R file > Open with > Choose another app > Check the 
box "Always use this app to open .R files" > Look for another app on 
this PC
Paste the directory found above, then select "Rgui.exe"


On Fri, Nov 4, 2022, 04:49 Amarjit Chandhial via R-help 
<r-help at r-project.org <mailto:r-help at r-project.org> > wrote:

  Hi,


  My OS is Windows 11 Pro 64-Bit, I have R 4.2.2 and RStudio installed.

  If I double-click on a .R file in File Explorer the OS gives me the
  option of opening the .R in RStudio, or Look for an app in the 
Microsoft
  Store, or More Apps. Similarly with a right-click.

  I would like to associate a .R file with the RGui, not RStudio, thus
  when I double-click on a .R file in File Explorer the .R file opens in
  the R Editor in RGui.

  On my PC R 4.2.2 is located in "C:/Program Files/R/R-4.2.2/etc"

  Please can someone provide step-by-step instructions on how to
  associate?


  thanks,
  Amarjit

          [[alternative HTML version deleted]]

  ______________________________________________
  R-help at r-project.org <mailto:R-help at r-project.org>  mailing list -- To 
UNSUBSCRIBE and more, see
  https://stat.ethz.ch/mailman/listinfo/r-help 
<https://stat.ethz.ch/mailman/listinfo/r-help>
  PLEASE do read the posting guide 
http://www.R-project.org/posting-guide.html 
<http://www.R-project.org/posting-guide.html>
  and provide commented, minimal, self-contained, reproducible code.




	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sat Nov  5 16:03:49 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sat, 05 Nov 2022 08:03:49 -0700
Subject: [R] Associate a .R file with the RGui
In-Reply-To: <6c894531.98c9.184480c446a.Webtop.100@btinternet.com>
References: <6c894531.98c9.184480c446a.Webtop.100@btinternet.com>
Message-ID: <8F61167A-345F-4615-9C55-1C486A8DE0B1@dcn.davis.ca.us>

RGui is not an editor. It is a console (aka REPL, https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop).

When using RGui, it is up to you to edit your R file in an external editor like Notepad++ and copy paste code snippets or use source("yourfile.R") as desired.

On November 5, 2022 6:47:54 AM PDT, Amarjit Chandhial via R-help <r-help at r-project.org> wrote:
>
>
>
>Hi Andrew/Petr,
>
>
>Thanks for the replies.
>
>In R Console if I run:
>
>R.home("bin")
>
>I get the following
>
>"C:/PROGRA~1/R/R-42~1.2/bin/x64"
>
>which is where
>
>Rgui.exe is (within the x64 folder there are 13 files in total: 8 . exe 
>and 5 .dll).
>
>
>In file Explorer if I right-click on a .R file -> Open With -> R for 
>Windows GUI Front-End
>
>RGui (64-bit) opens but the .R file does not appear in the editor.
>
>
>Amarjit
>
>
>------ Original Message ------
>From: "Andrew Simmons" <akwsimmo at gmail.com>
>To: "Amarjit Chandhial" <a.chandhial at btinternet.com>
>Cc: "R-help Mailing List" <r-help at r-project.org>
>Sent: Friday, 4 Nov, 2022 At 09:08
>Subject: Re: [R] Associate a .R file with the RGui
>
>In an R session, run this:
>
>writeLines(normalizePath(R.home("bin")))
>
>
>Right click your .R file > Open with > Choose another app > Check the 
>box "Always use this app to open .R files" > Look for another app on 
>this PC
>Paste the directory found above, then select "Rgui.exe"
>
>
>On Fri, Nov 4, 2022, 04:49 Amarjit Chandhial via R-help 
><r-help at r-project.org <mailto:r-help at r-project.org> > wrote:
>
>  Hi,
>
>
>  My OS is Windows 11 Pro 64-Bit, I have R 4.2.2 and RStudio installed.
>
>  If I double-click on a .R file in File Explorer the OS gives me the
>  option of opening the .R in RStudio, or Look for an app in the 
>Microsoft
>  Store, or More Apps. Similarly with a right-click.
>
>  I would like to associate a .R file with the RGui, not RStudio, thus
>  when I double-click on a .R file in File Explorer the .R file opens in
>  the R Editor in RGui.
>
>  On my PC R 4.2.2 is located in "C:/Program Files/R/R-4.2.2/etc"
>
>  Please can someone provide step-by-step instructions on how to
>  associate?
>
>
>  thanks,
>  Amarjit
>
>          [[alternative HTML version deleted]]
>
>  ______________________________________________
>  R-help at r-project.org <mailto:R-help at r-project.org>  mailing list -- To 
>UNSUBSCRIBE and more, see
>  https://stat.ethz.ch/mailman/listinfo/r-help 
><https://stat.ethz.ch/mailman/listinfo/r-help>
>  PLEASE do read the posting guide 
>http://www.R-project.org/posting-guide.html 
><http://www.R-project.org/posting-guide.html>
>  and provide commented, minimal, self-contained, reproducible code.
>
>
>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From bgunter@4567 @end|ng |rom gm@||@com  Sat Nov  5 16:08:31 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 5 Nov 2022 08:08:31 -0700
Subject: [R] 
 Selecting a minimum value of an attribute associated with point
 values neighboring a given point and assigning it as a new attribute
In-Reply-To: <BN6PR05MB35887EFE01222DBF7C359AAB903B9@BN6PR05MB3588.namprd05.prod.outlook.com>
References: <BN6PR05MB35887EFE01222DBF7C359AAB903B9@BN6PR05MB3588.namprd05.prod.outlook.com>
Message-ID: <CAGxFJbSkg9zAqk0dGcr3qJe2z2C04NEZFdHN8hWQA3oSbfHukQ@mail.gmail.com>

Probably better posted on R-sig-geo.

-- Bert

On Sat, Nov 5, 2022 at 12:36 AM Duhl, Tiffany R. <Tiffany.Duhl at tufts.edu>
wrote:

> Hello,
>
> I have sets of spatial points with LAT, LON coords (unprojected, WGS84
> datum) and several value attributes associated with each point, from
> numerous csv files (with an average of 6,000-9,000 points in each file) as
> shown in the following example:
>
> data<- read.csv("R_find_pts_testdata.csv")
>
> > data
>     ID      Date         Time        LAT            LON           Conc
> Leg.Speed    CO2  H2O BC61 Hr Min Sec
> 1   76 4/19/2021 21:25:38 42.40066 -70.98802 99300   0.0 mph 428.39 9.57
> 578 21  25  38
> 2   77 4/19/2021 21:25:39 42.40066 -70.98802 96730   0.0 mph 428.04 9.57
> 617 21  25  39
> 3   79 4/19/2021 21:25:41 42.40066 -70.98802 98800   0.2 mph 427.10 9.57
> 1027 21  25  41
> 4   80 4/19/2021 21:25:42 42.40066 -70.98802 96510     2 mph 427.99 9.58
> 1381 21  25  42
> 5   81 4/19/2021 21:25:43 42.40067 -70.98801 95540     3 mph 427.99 9.58
> 1271 21  25  43
> 6   82 4/19/2021 21:25:44 42.40068 -70.98799 94720     4 mph 427.20 9.57
> 910 21  25  44
> 7   83 4/19/2021 21:25:45 42.40069 -70.98797 94040     5 mph 427.18 9.57
> 652 21  25  45
> 8   84 4/19/2021 21:25:46 42.40072 -70.98795 95710     7 mph 427.07 9.57
> 943 21  25  46
> 9   85 4/19/2021 21:25:47 42.40074 -70.98792 96200     8 mph 427.44 9.56
> 650 21  25  47
> 10  86 4/19/2021 21:25:48 42.40078 -70.98789 93750    10 mph 428.76 9.57
> 761 21  25  48
> 11  87 4/19/2021 21:25:49 42.40081 -70.98785 93360    11 mph 429.25 9.56
> 1158 21  25  49
> 12  88 4/19/2021 21:25:50 42.40084 -70.98781 94340    12 mph 429.56 9.57
> 107 21  25  50
> 13  89 4/19/2021 21:25:51 42.40087 -70.98775 92780    12 mph 428.62 9.56
> 720 21  25  51
>
>
> What I want to do is, for each point, identify all points within 50m of
> that point, find the minimum value of the "Conc" attribute of each nearby
> set of points (including the original point) and then create a new variable
> ("Conc_min") and assign this minimum value to a new variable added to
> "data".
>
> So far, I have the following code:
>
> library(spdep)
> library(sf)
>
> setwd("C:\\mydirectory\\")
> data<- read.csv("R_find_pts_testdata.csv")
>
> #make sure the data is a data frame
> pts <- data.frame(data)
>
> #create spatial data frame and define projection
> pts_coords <- cbind(pts$LON, pts$LAT)
> data_pts <- SpatialPointsDataFrame(coords= pts_coords,
> data=pts, proj4string = CRS("+proj=longlat +datum=WGS84"))
>
> #Re-project to WGS 84 / UTM zone 18N, so the analysis is in units of m
> ptsUTM  <- sf::st_as_sf(data_pts, coords = c("LAT", "LON"), remove = F)%>%
> st_transform(32618)
>
> #create 50 m buffer around each point then intersect with points and
> finally find neighbors within the buffers
> pts_buf <- sf::st_buffer(ptsUTM, 50)
> coords  <- sf::st_coordinates(ptsUTM)
> int <- sf::st_intersects(pts_buf, ptsUTM)
> x   <- spdep::dnearneigh(coords, 0, 50)
>
> Now at this point, I'm not sure what to either the "int" (a sgbp list) or
> "x" (nb object) objects (or even if I need them both)
>
> > int
> Sparse geometry binary predicate list of length 974, where the predicate
> was `intersects'
> first 10 elements:
>  1: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>  2: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>  3: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>  4: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>  5: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>  6: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>  7: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>  8: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>  9: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>
> > x
> Neighbour list object:
> Number of regions: 974
> Number of nonzero links: 34802
> Percentage nonzero weights: 3.668481
> Average number of links: 35.73101
>
> One thought is that maybe I don't need the dnearneigh function and can
> instead convert "int" into a dataframe and somehow merge or associate
> (perhaps with an inner join) the ID fields of the buffered and intersecting
> points and then compute the minimum value of "Conc" grouping by ID:
>
> > as.data.frame(int)
>     row.id col.id
> 1        1      1
> 2        1      2
> 3        1      3
> 4        1      4
> 5        1      5
> 6        1      6
> 7        1      7
> 8        1      8
> 9        1      9
> 10       1     10
> 11       1     11
> 12       1     12
> 13       1     13
> 14       1     14
> 15       1     15
> 16       1     16
> 17       1     17
> 18       1     18
> 19       2      1
> 20       2      2
> 21       2      3
> 22       2      4
> 23       2      5
> 24       2      6
> 25       2      7
> 26       2      8
> 27       2      9
> 28       2     10
>
>
> So in the above example I'd like to take the minimum of "Conc" among the
> col.id points grouped with row.id 1 (i.e., col.ids 1-18) and assign the
> minimum value of this group as a new variable in data (Data$Conc_min), and
> do the same for row.id 2 and all the rest of the rows.
>
> I'm just not sure how to do this and I appreciate any help folks might
> have on this matter!
>
> Many thanks,
> -Tiffany
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @@ch@ndh|@| @end|ng |rom bt|nternet@com  Sat Nov  5 17:58:49 2022
From: @@ch@ndh|@| @end|ng |rom bt|nternet@com (Amarjit Chandhial)
Date: Sat, 5 Nov 2022 16:58:49 +0000
Subject: [R] Associate a .R file with the RGui
In-Reply-To: <8F61167A-345F-4615-9C55-1C486A8DE0B1@dcn.davis.ca.us>
References: <6c894531.98c9.184480c446a.Webtop.100@btinternet.com>
 <8F61167A-345F-4615-9C55-1C486A8DE0B1@dcn.davis.ca.us>
Message-ID: <69B40FD3-25AC-4180-9DC4-737C82BBFA85@btinternet.com>

Hi Jeff,


Please see my original question.


Thanks,
Amarjiit 



> On 5 Nov 2022, at 15:03, Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
> 
> RGui is not an editor. It is a console (aka REPL, https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop).
> 
> When using RGui, it is up to you to edit your R file in an external editor like Notepad++ and copy paste code snippets or use source("yourfile.R") as desired.
> 
>> On November 5, 2022 6:47:54 AM PDT, Amarjit Chandhial via R-help <r-help at r-project.org> wrote:
>> 
>> 
>> 
>> Hi Andrew/Petr,
>> 
>> 
>> Thanks for the replies.
>> 
>> In R Console if I run:
>> 
>> R.home("bin")
>> 
>> I get the following
>> 
>> "C:/PROGRA~1/R/R-42~1.2/bin/x64"
>> 
>> which is where
>> 
>> Rgui.exe is (within the x64 folder there are 13 files in total: 8 . exe 
>> and 5 .dll).
>> 
>> 
>> In file Explorer if I right-click on a .R file -> Open With -> R for 
>> Windows GUI Front-End
>> 
>> RGui (64-bit) opens but the .R file does not appear in the editor.
>> 
>> 
>> Amarjit
>> 
>> 
>> ------ Original Message ------
>> From: "Andrew Simmons" <akwsimmo at gmail.com>
>> To: "Amarjit Chandhial" <a.chandhial at btinternet.com>
>> Cc: "R-help Mailing List" <r-help at r-project.org>
>> Sent: Friday, 4 Nov, 2022 At 09:08
>> Subject: Re: [R] Associate a .R file with the RGui
>> 
>> In an R session, run this:
>> 
>> writeLines(normalizePath(R.home("bin")))
>> 
>> 
>> Right click your .R file > Open with > Choose another app > Check the 
>> box "Always use this app to open .R files" > Look for another app on 
>> this PC
>> Paste the directory found above, then select "Rgui.exe"
>> 
>> 
>> On Fri, Nov 4, 2022, 04:49 Amarjit Chandhial via R-help 
>> <r-help at r-project.org <mailto:r-help at r-project.org> > wrote:
>> 
>> Hi,
>> 
>> 
>> My OS is Windows 11 Pro 64-Bit, I have R 4.2.2 and RStudio installed.
>> 
>> If I double-click on a .R file in File Explorer the OS gives me the
>> option of opening the .R in RStudio, or Look for an app in the 
>> Microsoft
>> Store, or More Apps. Similarly with a right-click.
>> 
>> I would like to associate a .R file with the RGui, not RStudio, thus
>> when I double-click on a .R file in File Explorer the .R file opens in
>> the R Editor in RGui.
>> 
>> On my PC R 4.2.2 is located in "C:/Program Files/R/R-4.2.2/etc"
>> 
>> Please can someone provide step-by-step instructions on how to
>> associate?
>> 
>> 
>> thanks,
>> Amarjit
>> 
>>         [[alternative HTML version deleted]]
>> 
>> ______________________________________________
>> R-help at r-project.org <mailto:R-help at r-project.org>  mailing list -- To 
>> UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help 
>> <https://stat.ethz.ch/mailman/listinfo/r-help>
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html 
>> <http://www.R-project.org/posting-guide.html>
>> and provide commented, minimal, self-contained, reproducible code.
>> 
>> 
>> 
>> 
>>    [[alternative HTML version deleted]]
>> 
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> -- 
> Sent from my phone. Please excuse my brevity.


From th|erry@ze|| @end|ng |rom gm@||@com  Sat Nov  5 18:36:52 2022
From: th|erry@ze|| @end|ng |rom gm@||@com (Thierry Zell)
Date: Sat, 5 Nov 2022 13:36:52 -0400
Subject: [R] Is this *always* the intended R^2 value for no intercept in lm?
Message-ID: <CALAJGyCDBnYiaEFfOOBtkvWgxaSb=+hE1beDk6AOBFaoLswYPw@mail.gmail.com>

I am puzzled by the computation of R^2 with intercept omitted that is
already illustrated by the following example taken from help("lm")

## Annette Dobson (1990) "An Introduction to Generalized Linear Models".
## Page 9: Plant Weight Data.
ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
weight <- c(ctl, trt)
lm.D9 <- lm(weight ~ group)
lm.D90 <- lm(weight ~ group - 1) # omitting intercept

The calculations for the R^2 for both models  are consistent with the
help("summary.lm") description:
"y* is the mean of y[i] if there is an intercept and zero otherwise."
Which causes a dramatic difference in the resulting R^2 values.

r2.D9 <- summary(lm.D9)$r.squared
r2.D90 <- summary(lm.D90)$r.squared

all.equal(r2.D9, 0.0730775989903856) #TRUE
all.equal(r2.D90, 0.981783272435264) #TRUE

This is counter-intuitive to say the least since the two models have
identical predictions and both models could be described more
accurately as two intercepts rather than zero. I see three
possibilities:

1. This is the intended result, in which case no fix is required, but
I?d be curious to understand the argument better.
2. This is an unfortunate outcome but not worth fixing as the user can
easily compute the correct R^2. In this case, I'd suggest that this
unintuitive behavior should be explicitly called out in the
documentation.
3. This is a bug worth fixing.

I look forward to hearing the community?s opinion on this.
Thanks in advance!


From jrkr|de@u @end|ng |rom gm@||@com  Sat Nov  5 20:39:21 2022
From: jrkr|de@u @end|ng |rom gm@||@com (John Kane)
Date: Sat, 5 Nov 2022 15:39:21 -0400
Subject: [R] rio: list of extensions for supported formats
In-Reply-To: <419a5ed0-ac91-65c0-838f-a05307f9bbc0@wiwi.hu-berlin.de>
References: <419a5ed0-ac91-65c0-838f-a05307f9bbc0@wiwi.hu-berlin.de>
Message-ID: <CAKZQJMCRtXHy1TtfyGXpK8cZk_38roeBDidabRvWt6r2RNCGZw@mail.gmail.com>

nnnnnnnnnnnnnnnno idea but there is a list here
https://thomasleeper.com/rio/articles/rio.html

On Sat, 5 Nov 2022 at 04:04, Sigbert Klinke <sigbert at wiwi.hu-berlin.de>
wrote:

> Hi,
>
> is there a function in the package rio to get the file extensions listed
> in the vignette under supported formats?
>
> Thanks Sigbert
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


-- 
John Kane
Kingston ON Canada

	[[alternative HTML version deleted]]


From jrkr|de@u @end|ng |rom gm@||@com  Sat Nov  5 20:40:00 2022
From: jrkr|de@u @end|ng |rom gm@||@com (John Kane)
Date: Sat, 5 Nov 2022 15:40:00 -0400
Subject: [R] rio: list of extensions for supported formats
In-Reply-To: <CAKZQJMCRtXHy1TtfyGXpK8cZk_38roeBDidabRvWt6r2RNCGZw@mail.gmail.com>
References: <419a5ed0-ac91-65c0-838f-a05307f9bbc0@wiwi.hu-berlin.de>
 <CAKZQJMCRtXHy1TtfyGXpK8cZk_38roeBDidabRvWt6r2RNCGZw@mail.gmail.com>
Message-ID: <CAKZQJMAD8nGBdcuqYydajKhwe0KjZtYsC5MYDH5s03SezG5DUw@mail.gmail.com>

Cat was being helpful.

On Sat, 5 Nov 2022 at 15:39, John Kane <jrkrideau at gmail.com> wrote:

> nnnnnnnnnnnnnnnno idea but there is a list here
> https://thomasleeper.com/rio/articles/rio.html
>
> On Sat, 5 Nov 2022 at 04:04, Sigbert Klinke <sigbert at wiwi.hu-berlin.de>
> wrote:
>
>> Hi,
>>
>> is there a function in the package rio to get the file extensions listed
>> in the vignette under supported formats?
>>
>> Thanks Sigbert
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>
>
> --
> John Kane
> Kingston ON Canada
>


-- 
John Kane
Kingston ON Canada

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Sat Nov  5 20:40:35 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 5 Nov 2022 12:40:35 -0700
Subject: [R] 
 Is this *always* the intended R^2 value for no intercept in lm?
In-Reply-To: <CALAJGyCDBnYiaEFfOOBtkvWgxaSb=+hE1beDk6AOBFaoLswYPw@mail.gmail.com>
References: <CALAJGyCDBnYiaEFfOOBtkvWgxaSb=+hE1beDk6AOBFaoLswYPw@mail.gmail.com>
Message-ID: <CAGxFJbQTzxLtALLdcChx0dBhGRuEBvZBTrmebqVSmEqxNBE2ag@mail.gmail.com>

FAQ 7.41
and
https://stackoverflow.com/questions/57415793/r-squared-in-lm-for-zero-intercept-model

(among numerous others that could no doubt be found with a bit of
searching).

In short, the "null models" against which you are comparing the fitted
model are different with and without an intercept.

--Bert



On Sat, Nov 5, 2022 at 11:52 AM Thierry Zell <thierry.zell at gmail.com> wrote:

> I am puzzled by the computation of R^2 with intercept omitted that is
> already illustrated by the following example taken from help("lm")
>
> ## Annette Dobson (1990) "An Introduction to Generalized Linear Models".
> ## Page 9: Plant Weight Data.
> ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
> trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
> group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
> weight <- c(ctl, trt)
> lm.D9 <- lm(weight ~ group)
> lm.D90 <- lm(weight ~ group - 1) # omitting intercept
>
> The calculations for the R^2 for both models  are consistent with the
> help("summary.lm") description:
> "y* is the mean of y[i] if there is an intercept and zero otherwise."
> Which causes a dramatic difference in the resulting R^2 values.
>
> r2.D9 <- summary(lm.D9)$r.squared
> r2.D90 <- summary(lm.D90)$r.squared
>
> all.equal(r2.D9, 0.0730775989903856) #TRUE
> all.equal(r2.D90, 0.981783272435264) #TRUE
>
> This is counter-intuitive to say the least since the two models have
> identical predictions and both models could be described more
> accurately as two intercepts rather than zero. I see three
> possibilities:
>
> 1. This is the intended result, in which case no fix is required, but
> I?d be curious to understand the argument better.
> 2. This is an unfortunate outcome but not worth fixing as the user can
> easily compute the correct R^2. In this case, I'd suggest that this
> unintuitive behavior should be explicitly called out in the
> documentation.
> 3. This is a bug worth fixing.
>
> I look forward to hearing the community?s opinion on this.
> Thanks in advance!
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From dw|n@em|u@ @end|ng |rom comc@@t@net  Sun Nov  6 01:40:40 2022
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Sat, 5 Nov 2022 17:40:40 -0700
Subject: [R] Associate a .R file with the RGui
In-Reply-To: <69B40FD3-25AC-4180-9DC4-737C82BBFA85@btinternet.com>
References: <6c894531.98c9.184480c446a.Webtop.100@btinternet.com>
 <8F61167A-345F-4615-9C55-1C486A8DE0B1@dcn.davis.ca.us>
 <69B40FD3-25AC-4180-9DC4-737C82BBFA85@btinternet.com>
Message-ID: <4da62093-4035-7401-2d80-d47cc319a468@comcast.net>


On 11/5/22 09:58, Amarjit Chandhial via R-help wrote:
> Hi Jeff,
>
>
> Please see my original question.

You were told that RGui is not an editor.

Are you implying that your initial message contained an implicit request 
for instructions on how to get R code in an .R file to be opened 
automagically when double-clicked or to have "open in <some editor>" 
appear when right-clicked? (I didn't see that clearly expressed.)

If you want something else to happen with a file that has a .R extension 
when double-clicked or right-clicked in a GUI file manager, then you 
need to configure your OS to do whatever else it is that you expect. 
This is not really an R question. It's an OS question. There are many 
editors that can also bring up R consoles when the right? key combo is 
pressed. They do require some study for their specific actions, but this 
is not really the place to get guidance on the fine details.

-- 

David.

>
>
> Thanks,
> Amarjiit
>
>
>
>> On 5 Nov 2022, at 15:03, Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
>>
>> RGui is not an editor. It is a console (aka REPL, https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop).
>>
>> When using RGui, it is up to you to edit your R file in an external editor like Notepad++ and copy paste code snippets or use source("yourfile.R") as desired.
>>
>>> On November 5, 2022 6:47:54 AM PDT, Amarjit Chandhial via R-help <r-help at r-project.org> wrote:
>>>
>>>
>>>
>>> Hi Andrew/Petr,
>>>
>>>
>>> Thanks for the replies.
>>>
>>> In R Console if I run:
>>>
>>> R.home("bin")
>>>
>>> I get the following
>>>
>>> "C:/PROGRA~1/R/R-42~1.2/bin/x64"
>>>
>>> which is where
>>>
>>> Rgui.exe is (within the x64 folder there are 13 files in total: 8 . exe
>>> and 5 .dll).
>>>
>>>
>>> In file Explorer if I right-click on a .R file -> Open With -> R for
>>> Windows GUI Front-End
>>>
>>> RGui (64-bit) opens but the .R file does not appear in the editor.
>>>
>>>
>>> Amarjit
>>>
>>>
>>> ------ Original Message ------
>>> From: "Andrew Simmons" <akwsimmo at gmail.com>
>>> To: "Amarjit Chandhial" <a.chandhial at btinternet.com>
>>> Cc: "R-help Mailing List" <r-help at r-project.org>
>>> Sent: Friday, 4 Nov, 2022 At 09:08
>>> Subject: Re: [R] Associate a .R file with the RGui
>>>
>>> In an R session, run this:
>>>
>>> writeLines(normalizePath(R.home("bin")))
>>>
>>>
>>> Right click your .R file > Open with > Choose another app > Check the
>>> box "Always use this app to open .R files" > Look for another app on
>>> this PC
>>> Paste the directory found above, then select "Rgui.exe"
>>>
>>>
>>> On Fri, Nov 4, 2022, 04:49 Amarjit Chandhial via R-help
>>> <r-help at r-project.org <mailto:r-help at r-project.org> > wrote:
>>>
>>> Hi,
>>>
>>>
>>> My OS is Windows 11 Pro 64-Bit, I have R 4.2.2 and RStudio installed.
>>>
>>> If I double-click on a .R file in File Explorer the OS gives me the
>>> option of opening the .R in RStudio, or Look for an app in the
>>> Microsoft
>>> Store, or More Apps. Similarly with a right-click.
>>>
>>> I would like to associate a .R file with the RGui, not RStudio, thus
>>> when I double-click on a .R file in File Explorer the .R file opens in
>>> the R Editor in RGui.
>>>
>>> On my PC R 4.2.2 is located in "C:/Program Files/R/R-4.2.2/etc"
>>>
>>> Please can someone provide step-by-step instructions on how to
>>> associate?
>>>
>>>
>>> thanks,
>>> Amarjit
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org <mailto:R-help at r-project.org>  mailing list -- To
>>> UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> <https://stat.ethz.ch/mailman/listinfo/r-help>
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> <http://www.R-project.org/posting-guide.html>
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>>
>>>
>>>
>>>     [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>> -- 
>> Sent from my phone. Please excuse my brevity.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @@ch@ndh|@| @end|ng |rom bt|nternet@com  Sun Nov  6 09:17:21 2022
From: @@ch@ndh|@| @end|ng |rom bt|nternet@com (Amarjit Chandhial)
Date: Sun, 6 Nov 2022 08:17:21 +0000
Subject: [R] Associate a .R file with the RGui
In-Reply-To: <4da62093-4035-7401-2d80-d47cc319a468@comcast.net>
References: <6c894531.98c9.184480c446a.Webtop.100@btinternet.com>
 <8F61167A-345F-4615-9C55-1C486A8DE0B1@dcn.davis.ca.us>
 <69B40FD3-25AC-4180-9DC4-737C82BBFA85@btinternet.com>
 <4da62093-4035-7401-2d80-d47cc319a468@comcast.net>
Message-ID: <5C67C76C-039A-4B61-A9D1-AABD02F4A06D@btinternet.com>

David,

Thanks.

Amarjiit 


> On 6 Nov 2022, at 00:40, David Winsemius <dwinsemius at comcast.net> wrote:
> 
> 
>> On 11/5/22 09:58, Amarjit Chandhial via R-help wrote:
>> Hi Jeff,
>> 
>> 
>> Please see my original question.
> 
> You were told that RGui is not an editor.
> 
> Are you implying that your initial message contained an implicit request for instructions on how to get R code in an .R file to be opened automagically when double-clicked or to have "open in <some editor>" appear when right-clicked? (I didn't see that clearly expressed.)
> 
> If you want something else to happen with a file that has a .R extension when double-clicked or right-clicked in a GUI file manager, then you need to configure your OS to do whatever else it is that you expect. This is not really an R question. It's an OS question. There are many editors that can also bring up R consoles when the right  key combo is pressed. They do require some study for their specific actions, but this is not really the place to get guidance on the fine details.
> 
> -- 
> 
> David.
> 
>> 
>> 
>> Thanks,
>> Amarjiit
>> 
>> 
>> 
>>> On 5 Nov 2022, at 15:03, Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
>>> 
>>> RGui is not an editor. It is a console (aka REPL, https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop).
>>> 
>>> When using RGui, it is up to you to edit your R file in an external editor like Notepad++ and copy paste code snippets or use source("yourfile.R") as desired.
>>> 
>>>> On November 5, 2022 6:47:54 AM PDT, Amarjit Chandhial via R-help <r-help at r-project.org> wrote:
>>>> 
>>>> 
>>>> 
>>>> Hi Andrew/Petr,
>>>> 
>>>> 
>>>> Thanks for the replies.
>>>> 
>>>> In R Console if I run:
>>>> 
>>>> R.home("bin")
>>>> 
>>>> I get the following
>>>> 
>>>> "C:/PROGRA~1/R/R-42~1.2/bin/x64"
>>>> 
>>>> which is where
>>>> 
>>>> Rgui.exe is (within the x64 folder there are 13 files in total: 8 . exe
>>>> and 5 .dll).
>>>> 
>>>> 
>>>> In file Explorer if I right-click on a .R file -> Open With -> R for
>>>> Windows GUI Front-End
>>>> 
>>>> RGui (64-bit) opens but the .R file does not appear in the editor.
>>>> 
>>>> 
>>>> Amarjit
>>>> 
>>>> 
>>>> ------ Original Message ------
>>>> From: "Andrew Simmons" <akwsimmo at gmail.com>
>>>> To: "Amarjit Chandhial" <a.chandhial at btinternet.com>
>>>> Cc: "R-help Mailing List" <r-help at r-project.org>
>>>> Sent: Friday, 4 Nov, 2022 At 09:08
>>>> Subject: Re: [R] Associate a .R file with the RGui
>>>> 
>>>> In an R session, run this:
>>>> 
>>>> writeLines(normalizePath(R.home("bin")))
>>>> 
>>>> 
>>>> Right click your .R file > Open with > Choose another app > Check the
>>>> box "Always use this app to open .R files" > Look for another app on
>>>> this PC
>>>> Paste the directory found above, then select "Rgui.exe"
>>>> 
>>>> 
>>>> On Fri, Nov 4, 2022, 04:49 Amarjit Chandhial via R-help
>>>> <r-help at r-project.org <mailto:r-help at r-project.org> > wrote:
>>>> 
>>>> Hi,
>>>> 
>>>> 
>>>> My OS is Windows 11 Pro 64-Bit, I have R 4.2.2 and RStudio installed.
>>>> 
>>>> If I double-click on a .R file in File Explorer the OS gives me the
>>>> option of opening the .R in RStudio, or Look for an app in the
>>>> Microsoft
>>>> Store, or More Apps. Similarly with a right-click.
>>>> 
>>>> I would like to associate a .R file with the RGui, not RStudio, thus
>>>> when I double-click on a .R file in File Explorer the .R file opens in
>>>> the R Editor in RGui.
>>>> 
>>>> On my PC R 4.2.2 is located in "C:/Program Files/R/R-4.2.2/etc"
>>>> 
>>>> Please can someone provide step-by-step instructions on how to
>>>> associate?
>>>> 
>>>> 
>>>> thanks,
>>>> Amarjit
>>>> 
>>>>         [[alternative HTML version deleted]]
>>>> 
>>>> ______________________________________________
>>>> R-help at r-project.org <mailto:R-help at r-project.org>  mailing list -- To
>>>> UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> <https://stat.ethz.ch/mailman/listinfo/r-help>
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> <http://www.R-project.org/posting-guide.html>
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>> 
>>>> 
>>>> 
>>>> 
>>>>    [[alternative HTML version deleted]]
>>>> 
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>> -- 
>>> Sent from my phone. Please excuse my brevity.
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sun Nov  6 16:15:57 2022
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sun, 6 Nov 2022 16:15:57 +0100
Subject: [R] Associate a .R file with the RGui
In-Reply-To: <4da62093-4035-7401-2d80-d47cc319a468@comcast.net>
References: <6c894531.98c9.184480c446a.Webtop.100@btinternet.com>
 <8F61167A-345F-4615-9C55-1C486A8DE0B1@dcn.davis.ca.us>
 <69B40FD3-25AC-4180-9DC4-737C82BBFA85@btinternet.com>
 <4da62093-4035-7401-2d80-d47cc319a468@comcast.net>
Message-ID: <85b95db6-b62e-14f3-2f6f-1d38734efe81@statistik.tu-dortmund.de>



On 06.11.2022 01:40, David Winsemius wrote:
> 
> On 11/5/22 09:58, Amarjit Chandhial via R-help wrote:
>> Hi Jeff,
>>
>>
>> Please see my original question.
> 
> You were told that RGui is not an editor.
> 
> Are you implying that your initial message contained an implicit request 
> for instructions on how to get R code in an .R file to be opened 
> automagically when double-clicked or to have "open in <some editor>" 
> appear when right-clicked? (I didn't see that clearly expressed.)
> 
> If you want something else to happen with a file that has a .R extension 
> when double-clicked or right-clicked in a GUI file manager, then you 
> need to configure your OS to do whatever else it is that you expect. 
> This is not really an R question. It's an OS question. There are many 
> editors that can also bring up R consoles when the right? key combo is 
> pressed. They do require some study for their specific actions, but this 
> is not really the place to get guidance on the fine details.
> 

Friends, RGui contains an editor. It allows to send lines / code blocks 
to the R concole. We know users who need braille displays use the RGui 
internal editor as that apparently cooperates better with braille 
displays + R as many other editors.
And as it does not hide half of R by its own functions, I'd pefer that 
over some very popular other editors if I had no other choice.


To answer the OP's question, R does not have a built in way to get this 
task directly done, but searching the web suggests a rather simple way 
(well,m a hack as starting R with other command args may fail now, but 
you can extend this and look for a specific naming scheme):

<https://stat.ethz.ch/pipermail/r-help/2007-August/138064.html>

let is adapt this for the recent version of R:


1. Add the line

if ( length(z <- commandArgs(TRUE)) ) utils::file.edit(z[1])

to the Rprofile.site file; and

2. Edit the registry to associate the .R extension with the command

C:\Program Files\R\R-4.2.2\bin\x64\Rgui.exe --args "%1"


I think we should implement this in R anyway.

Best,
Uwe Ligges


From er|cjberger @end|ng |rom gm@||@com  Sun Nov  6 16:19:51 2022
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Sun, 6 Nov 2022 17:19:51 +0200
Subject: [R] 
 Selecting a minimum value of an attribute associated with point
 values neighboring a given point and assigning it as a new attribute
In-Reply-To: <CAGxFJbSkg9zAqk0dGcr3qJe2z2C04NEZFdHN8hWQA3oSbfHukQ@mail.gmail.com>
References: <BN6PR05MB35887EFE01222DBF7C359AAB903B9@BN6PR05MB3588.namprd05.prod.outlook.com>
 <CAGxFJbSkg9zAqk0dGcr3qJe2z2C04NEZFdHN8hWQA3oSbfHukQ@mail.gmail.com>
Message-ID: <CAGgJW767Ein1S+MSywb57B2UtmE0EJodDVokPEx5_-c5BTFR1Q@mail.gmail.com>

Hi Tiffany,
Here is some code that might help with your problem. I solve a "toy"
problem that is conceptually the same.
Part 1 sets up my toy problem. You would have to replace Part 1 with
your real case. The main point is to define
a function f(i, j, data) which returns 0 or 1 depending on whether the
observations in rows i and j in your dataset 'data'
are within your cutoff distance (i.e. 50m).

You can then use Part 2 almost without changes (except for changing
'myData' to the correct name of your data).

I hope this helps,
Eric

library(dplyr)

## PART 1: create fake data for minimal example
set.seed(123) ## for reproducibility
N <- 5       ## replace by number of locations (approx 9000 in your case)
MAX_DISTANCE <- 2  ## 50 in your case
myData <- data.frame(x=rnorm(N),y=rnorm(N),Conc=sample(1:N,N))

## The function which you must re-define for your actual case.
f <- function(i,j,a) {
 dist <- sqrt(sum((a[i,1:2] - a[j,1:2])^2)) ## Euclidean distance
 as.integer(dist < MAX_DISTANCE)
}

## PART 2: You can use this code on the real data with f() defined appropriately
A <- matrix(0,N,N)
## get the indices (j,k) where j < k (as columns in a data.frame)
idx <- expand.grid(v,v) |> rename(j=Var1,k=Var2) |> filter(j < k)
u <- sapply(1:nrow(idx),\(i){ j <- idx$j[i]; k <- idx$k[i]; A[j,k] <<-
f(j,k,myData) })
B <- A + t(A) + diag(N)
C <- diag(myData$Conc)
D <- B %*% C
D[D==0] <- NA
myData$Conc_min <- apply(D,MAR=1,\(v){min(v,na.rm=TRUE)})
print(head(myData))


On Sat, Nov 5, 2022 at 5:14 PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> Probably better posted on R-sig-geo.
>
> -- Bert
>
> On Sat, Nov 5, 2022 at 12:36 AM Duhl, Tiffany R. <Tiffany.Duhl at tufts.edu>
> wrote:
>
> > Hello,
> >
> > I have sets of spatial points with LAT, LON coords (unprojected, WGS84
> > datum) and several value attributes associated with each point, from
> > numerous csv files (with an average of 6,000-9,000 points in each file) as
> > shown in the following example:
> >
> > data<- read.csv("R_find_pts_testdata.csv")
> >
> > > data
> >     ID      Date         Time        LAT            LON           Conc
> > Leg.Speed    CO2  H2O BC61 Hr Min Sec
> > 1   76 4/19/2021 21:25:38 42.40066 -70.98802 99300   0.0 mph 428.39 9.57
> > 578 21  25  38
> > 2   77 4/19/2021 21:25:39 42.40066 -70.98802 96730   0.0 mph 428.04 9.57
> > 617 21  25  39
> > 3   79 4/19/2021 21:25:41 42.40066 -70.98802 98800   0.2 mph 427.10 9.57
> > 1027 21  25  41
> > 4   80 4/19/2021 21:25:42 42.40066 -70.98802 96510     2 mph 427.99 9.58
> > 1381 21  25  42
> > 5   81 4/19/2021 21:25:43 42.40067 -70.98801 95540     3 mph 427.99 9.58
> > 1271 21  25  43
> > 6   82 4/19/2021 21:25:44 42.40068 -70.98799 94720     4 mph 427.20 9.57
> > 910 21  25  44
> > 7   83 4/19/2021 21:25:45 42.40069 -70.98797 94040     5 mph 427.18 9.57
> > 652 21  25  45
> > 8   84 4/19/2021 21:25:46 42.40072 -70.98795 95710     7 mph 427.07 9.57
> > 943 21  25  46
> > 9   85 4/19/2021 21:25:47 42.40074 -70.98792 96200     8 mph 427.44 9.56
> > 650 21  25  47
> > 10  86 4/19/2021 21:25:48 42.40078 -70.98789 93750    10 mph 428.76 9.57
> > 761 21  25  48
> > 11  87 4/19/2021 21:25:49 42.40081 -70.98785 93360    11 mph 429.25 9.56
> > 1158 21  25  49
> > 12  88 4/19/2021 21:25:50 42.40084 -70.98781 94340    12 mph 429.56 9.57
> > 107 21  25  50
> > 13  89 4/19/2021 21:25:51 42.40087 -70.98775 92780    12 mph 428.62 9.56
> > 720 21  25  51
> >
> >
> > What I want to do is, for each point, identify all points within 50m of
> > that point, find the minimum value of the "Conc" attribute of each nearby
> > set of points (including the original point) and then create a new variable
> > ("Conc_min") and assign this minimum value to a new variable added to
> > "data".
> >
> > So far, I have the following code:
> >
> > library(spdep)
> > library(sf)
> >
> > setwd("C:\\mydirectory\\")
> > data<- read.csv("R_find_pts_testdata.csv")
> >
> > #make sure the data is a data frame
> > pts <- data.frame(data)
> >
> > #create spatial data frame and define projection
> > pts_coords <- cbind(pts$LON, pts$LAT)
> > data_pts <- SpatialPointsDataFrame(coords= pts_coords,
> > data=pts, proj4string = CRS("+proj=longlat +datum=WGS84"))
> >
> > #Re-project to WGS 84 / UTM zone 18N, so the analysis is in units of m
> > ptsUTM  <- sf::st_as_sf(data_pts, coords = c("LAT", "LON"), remove = F)%>%
> > st_transform(32618)
> >
> > #create 50 m buffer around each point then intersect with points and
> > finally find neighbors within the buffers
> > pts_buf <- sf::st_buffer(ptsUTM, 50)
> > coords  <- sf::st_coordinates(ptsUTM)
> > int <- sf::st_intersects(pts_buf, ptsUTM)
> > x   <- spdep::dnearneigh(coords, 0, 50)
> >
> > Now at this point, I'm not sure what to either the "int" (a sgbp list) or
> > "x" (nb object) objects (or even if I need them both)
> >
> > > int
> > Sparse geometry binary predicate list of length 974, where the predicate
> > was `intersects'
> > first 10 elements:
> >  1: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >  2: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >  3: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >  4: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >  5: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >  6: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >  7: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >  8: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >  9: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >
> > > x
> > Neighbour list object:
> > Number of regions: 974
> > Number of nonzero links: 34802
> > Percentage nonzero weights: 3.668481
> > Average number of links: 35.73101
> >
> > One thought is that maybe I don't need the dnearneigh function and can
> > instead convert "int" into a dataframe and somehow merge or associate
> > (perhaps with an inner join) the ID fields of the buffered and intersecting
> > points and then compute the minimum value of "Conc" grouping by ID:
> >
> > > as.data.frame(int)
> >     row.id col.id
> > 1        1      1
> > 2        1      2
> > 3        1      3
> > 4        1      4
> > 5        1      5
> > 6        1      6
> > 7        1      7
> > 8        1      8
> > 9        1      9
> > 10       1     10
> > 11       1     11
> > 12       1     12
> > 13       1     13
> > 14       1     14
> > 15       1     15
> > 16       1     16
> > 17       1     17
> > 18       1     18
> > 19       2      1
> > 20       2      2
> > 21       2      3
> > 22       2      4
> > 23       2      5
> > 24       2      6
> > 25       2      7
> > 26       2      8
> > 27       2      9
> > 28       2     10
> >
> >
> > So in the above example I'd like to take the minimum of "Conc" among the
> > col.id points grouped with row.id 1 (i.e., col.ids 1-18) and assign the
> > minimum value of this group as a new variable in data (Data$Conc_min), and
> > do the same for row.id 2 and all the rest of the rows.
> >
> > I'm just not sure how to do this and I appreciate any help folks might
> > have on this matter!
> >
> > Many thanks,
> > -Tiffany
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From er|cjberger @end|ng |rom gm@||@com  Sun Nov  6 16:27:46 2022
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Sun, 6 Nov 2022 17:27:46 +0200
Subject: [R] 
 Selecting a minimum value of an attribute associated with point
 values neighboring a given point and assigning it as a new attribute
In-Reply-To: <CAGgJW767Ein1S+MSywb57B2UtmE0EJodDVokPEx5_-c5BTFR1Q@mail.gmail.com>
References: <BN6PR05MB35887EFE01222DBF7C359AAB903B9@BN6PR05MB3588.namprd05.prod.outlook.com>
 <CAGxFJbSkg9zAqk0dGcr3qJe2z2C04NEZFdHN8hWQA3oSbfHukQ@mail.gmail.com>
 <CAGgJW767Ein1S+MSywb57B2UtmE0EJodDVokPEx5_-c5BTFR1Q@mail.gmail.com>
Message-ID: <CAGgJW77yY0_GDQWEAxzSdRh0N3kXgj9zrSEYUzuVsFnHyeE=aA@mail.gmail.com>

Whoops ... left out a line in Part 2. Resending with the correction

## PART 2: You can use this code on the real data with f() defined appropriately
A <- matrix(0,N,N)
v <- 1:N
## get the indices (j,k) where j < k (as columns in a data.frame)
idx <- expand.grid(v,v) |> rename(j=Var1,k=Var2) |> filter(j < k)
u <- sapply(1:nrow(idx),
           \(i){ j <- idx$j[i]; k <- idx$k[i]; A[j,k] <<- f(j,k,myData) })
B <- A + t(A) + diag(N)
C <- diag(myData$Conc)
D <- B %*% C
D[D==0] <- NA
myData$Conc_min <- apply(D,MAR=1,\(v){min(v,na.rm=TRUE)})
print(head(myData))

On Sun, Nov 6, 2022 at 5:19 PM Eric Berger <ericjberger at gmail.com> wrote:
>
> Hi Tiffany,
> Here is some code that might help with your problem. I solve a "toy"
> problem that is conceptually the same.
> Part 1 sets up my toy problem. You would have to replace Part 1 with
> your real case. The main point is to define
> a function f(i, j, data) which returns 0 or 1 depending on whether the
> observations in rows i and j in your dataset 'data'
> are within your cutoff distance (i.e. 50m).
>
> You can then use Part 2 almost without changes (except for changing
> 'myData' to the correct name of your data).
>
> I hope this helps,
> Eric
>
> library(dplyr)
>
> ## PART 1: create fake data for minimal example
> set.seed(123) ## for reproducibility
> N <- 5       ## replace by number of locations (approx 9000 in your case)
> MAX_DISTANCE <- 2  ## 50 in your case
> myData <- data.frame(x=rnorm(N),y=rnorm(N),Conc=sample(1:N,N))
>
> ## The function which you must re-define for your actual case.
> f <- function(i,j,a) {
>  dist <- sqrt(sum((a[i,1:2] - a[j,1:2])^2)) ## Euclidean distance
>  as.integer(dist < MAX_DISTANCE)
> }
>
> ## PART 2: You can use this code on the real data with f() defined appropriately
> A <- matrix(0,N,N)
> ## get the indices (j,k) where j < k (as columns in a data.frame)
> idx <- expand.grid(v,v) |> rename(j=Var1,k=Var2) |> filter(j < k)
> u <- sapply(1:nrow(idx),\(i){ j <- idx$j[i]; k <- idx$k[i]; A[j,k] <<-
> f(j,k,myData) })
> B <- A + t(A) + diag(N)
> C <- diag(myData$Conc)
> D <- B %*% C
> D[D==0] <- NA
> myData$Conc_min <- apply(D,MAR=1,\(v){min(v,na.rm=TRUE)})
> print(head(myData))
>
>
> On Sat, Nov 5, 2022 at 5:14 PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >
> > Probably better posted on R-sig-geo.
> >
> > -- Bert
> >
> > On Sat, Nov 5, 2022 at 12:36 AM Duhl, Tiffany R. <Tiffany.Duhl at tufts.edu>
> > wrote:
> >
> > > Hello,
> > >
> > > I have sets of spatial points with LAT, LON coords (unprojected, WGS84
> > > datum) and several value attributes associated with each point, from
> > > numerous csv files (with an average of 6,000-9,000 points in each file) as
> > > shown in the following example:
> > >
> > > data<- read.csv("R_find_pts_testdata.csv")
> > >
> > > > data
> > >     ID      Date         Time        LAT            LON           Conc
> > > Leg.Speed    CO2  H2O BC61 Hr Min Sec
> > > 1   76 4/19/2021 21:25:38 42.40066 -70.98802 99300   0.0 mph 428.39 9.57
> > > 578 21  25  38
> > > 2   77 4/19/2021 21:25:39 42.40066 -70.98802 96730   0.0 mph 428.04 9.57
> > > 617 21  25  39
> > > 3   79 4/19/2021 21:25:41 42.40066 -70.98802 98800   0.2 mph 427.10 9.57
> > > 1027 21  25  41
> > > 4   80 4/19/2021 21:25:42 42.40066 -70.98802 96510     2 mph 427.99 9.58
> > > 1381 21  25  42
> > > 5   81 4/19/2021 21:25:43 42.40067 -70.98801 95540     3 mph 427.99 9.58
> > > 1271 21  25  43
> > > 6   82 4/19/2021 21:25:44 42.40068 -70.98799 94720     4 mph 427.20 9.57
> > > 910 21  25  44
> > > 7   83 4/19/2021 21:25:45 42.40069 -70.98797 94040     5 mph 427.18 9.57
> > > 652 21  25  45
> > > 8   84 4/19/2021 21:25:46 42.40072 -70.98795 95710     7 mph 427.07 9.57
> > > 943 21  25  46
> > > 9   85 4/19/2021 21:25:47 42.40074 -70.98792 96200     8 mph 427.44 9.56
> > > 650 21  25  47
> > > 10  86 4/19/2021 21:25:48 42.40078 -70.98789 93750    10 mph 428.76 9.57
> > > 761 21  25  48
> > > 11  87 4/19/2021 21:25:49 42.40081 -70.98785 93360    11 mph 429.25 9.56
> > > 1158 21  25  49
> > > 12  88 4/19/2021 21:25:50 42.40084 -70.98781 94340    12 mph 429.56 9.57
> > > 107 21  25  50
> > > 13  89 4/19/2021 21:25:51 42.40087 -70.98775 92780    12 mph 428.62 9.56
> > > 720 21  25  51
> > >
> > >
> > > What I want to do is, for each point, identify all points within 50m of
> > > that point, find the minimum value of the "Conc" attribute of each nearby
> > > set of points (including the original point) and then create a new variable
> > > ("Conc_min") and assign this minimum value to a new variable added to
> > > "data".
> > >
> > > So far, I have the following code:
> > >
> > > library(spdep)
> > > library(sf)
> > >
> > > setwd("C:\\mydirectory\\")
> > > data<- read.csv("R_find_pts_testdata.csv")
> > >
> > > #make sure the data is a data frame
> > > pts <- data.frame(data)
> > >
> > > #create spatial data frame and define projection
> > > pts_coords <- cbind(pts$LON, pts$LAT)
> > > data_pts <- SpatialPointsDataFrame(coords= pts_coords,
> > > data=pts, proj4string = CRS("+proj=longlat +datum=WGS84"))
> > >
> > > #Re-project to WGS 84 / UTM zone 18N, so the analysis is in units of m
> > > ptsUTM  <- sf::st_as_sf(data_pts, coords = c("LAT", "LON"), remove = F)%>%
> > > st_transform(32618)
> > >
> > > #create 50 m buffer around each point then intersect with points and
> > > finally find neighbors within the buffers
> > > pts_buf <- sf::st_buffer(ptsUTM, 50)
> > > coords  <- sf::st_coordinates(ptsUTM)
> > > int <- sf::st_intersects(pts_buf, ptsUTM)
> > > x   <- spdep::dnearneigh(coords, 0, 50)
> > >
> > > Now at this point, I'm not sure what to either the "int" (a sgbp list) or
> > > "x" (nb object) objects (or even if I need them both)
> > >
> > > > int
> > > Sparse geometry binary predicate list of length 974, where the predicate
> > > was `intersects'
> > > first 10 elements:
> > >  1: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >  2: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >  3: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >  4: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >  5: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >  6: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >  7: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >  8: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >  9: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >
> > > > x
> > > Neighbour list object:
> > > Number of regions: 974
> > > Number of nonzero links: 34802
> > > Percentage nonzero weights: 3.668481
> > > Average number of links: 35.73101
> > >
> > > One thought is that maybe I don't need the dnearneigh function and can
> > > instead convert "int" into a dataframe and somehow merge or associate
> > > (perhaps with an inner join) the ID fields of the buffered and intersecting
> > > points and then compute the minimum value of "Conc" grouping by ID:
> > >
> > > > as.data.frame(int)
> > >     row.id col.id
> > > 1        1      1
> > > 2        1      2
> > > 3        1      3
> > > 4        1      4
> > > 5        1      5
> > > 6        1      6
> > > 7        1      7
> > > 8        1      8
> > > 9        1      9
> > > 10       1     10
> > > 11       1     11
> > > 12       1     12
> > > 13       1     13
> > > 14       1     14
> > > 15       1     15
> > > 16       1     16
> > > 17       1     17
> > > 18       1     18
> > > 19       2      1
> > > 20       2      2
> > > 21       2      3
> > > 22       2      4
> > > 23       2      5
> > > 24       2      6
> > > 25       2      7
> > > 26       2      8
> > > 27       2      9
> > > 28       2     10
> > >
> > >
> > > So in the above example I'd like to take the minimum of "Conc" among the
> > > col.id points grouped with row.id 1 (i.e., col.ids 1-18) and assign the
> > > minimum value of this group as a new variable in data (Data$Conc_min), and
> > > do the same for row.id 2 and all the rest of the rows.
> > >
> > > I'm just not sure how to do this and I appreciate any help folks might
> > > have on this matter!
> > >
> > > Many thanks,
> > > -Tiffany
> > >
> > >         [[alternative HTML version deleted]]
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide
> > > http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> > >
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.


From @@ch@ndh|@| @end|ng |rom bt|nternet@com  Sun Nov  6 17:21:23 2022
From: @@ch@ndh|@| @end|ng |rom bt|nternet@com (Amarjit Chandhial)
Date: Sun, 6 Nov 2022 16:21:23 +0000 (GMT)
Subject: [R] Associate a .R file with the RGui
Message-ID: <34bacfdd.1275e.1844dbf23cd.Webtop.107@btinternet.com>




Hi Uwe,


RGui does have advantages vs. RStudio, and vice-versa.

RStudio is much faster than it used to be.

I currently have .R files associated with RStudio, i.e. in File Explorer 
if I double-click on a .R file it opens in the editor in RStudio as an R 
script.

In File Explorer if I right-click on a .R file, Open with, I get the 
options: R for Windows GUI Front-end or RStudio or Search the Microsoft 
Store or choose another app.
If I choose R for Windows GUI Front-end, RGui (64-bit) opens, but no .R 
file, in the editor.
If I choose RStudio the .R file opens in the editor in RStudio as an R 
script.

 From the adaptation, if I choose R for Windows GUI Front-end, will the 
.R file open in RGui (64-bit) within the editor?


I have a new Windows PC and maybe, at least for the time being, it's 
best for me to have them associated with RStudio.

Although, yes, I agree, it should be naturally implemented in R, having 
installed RStudio.


thanks,
Amarjit




------ Original Message ------
From: "Uwe Ligges" <ligges at statistik.tu-dortmund.de>
To: "David Winsemius" <dwinsemius at comcast.net>; "Amarjit Chandhial" 
<a.chandhial at btinternet.com>; "Jeff Newmiller" 
<jdnewmil at dcn.davis.ca.us>
Cc: "Amarjit Chandhial via R-help" <r-help at r-project.org>
Sent: Sunday, 6 Nov, 2022 At 15:15
Subject: Re: [R] Associate a .R file with the RGui


  On 06.11.2022 01:40, David Winsemius wrote:

  On 11/5/22 09:58, Amarjit Chandhial via R-help wrote:
  Hi Jeff,


  Please see my original question.

  You were told that RGui is not an editor.

  Are you implying that your initial message contained an implicit 
request for instructions on how to get R code in an .R file to be opened 
automagically when double-clicked or to have "open in <some editor>" 
appear when right-clicked? (I didn't see that clearly expressed.)

  If you want something else to happen with a file that has a .R 
extension when double-clicked or right-clicked in a GUI file manager, 
then you need to configure your OS to do whatever else it is that you 
expect. This is not really an R question. It's an OS question. There are 
many editors that can also bring up R consoles when the right  key combo 
is pressed. They do require some study for their specific actions, but 
this is not really the place to get guidance on the fine details.


  Friends, RGui contains an editor. It allows to send lines / code 
blocks to the R concole. We know users who need braille displays use the 
RGui internal editor as that apparently cooperates better with braille 
displays + R as many other editors.
  And as it does not hide half of R by its own functions, I'd pefer that 
over some very popular other editors if I had no other choice.


  To answer the OP's question, R does not have a built in way to get 
this task directly done, but searching the web suggests a rather simple 
way (well,m a hack as starting R with other command args may fail now, 
but you can extend this and look for a specific naming scheme):

  <https://stat.ethz.ch/pipermail/r-help/2007-August/138064.html 
<https://stat.ethz.ch/pipermail/r-help/2007-August/138064.html> >

  let is adapt this for the recent version of R:


  1. Add the line

  if ( length(z <- commandArgs(TRUE)) ) utils::file.edit(z[1])

  to the Rprofile.site file; and

  2. Edit the registry to associate the .R extension with the command

  C:\Program Files\R\R-4.2.2\bin\x64\Rgui.exe --args "%1"


  I think we should implement this in R anyway.

  Best,
  Uwe Ligges







	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sun Nov  6 18:19:36 2022
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sun, 6 Nov 2022 18:19:36 +0100
Subject: [R] Associate a .R file with the RGui
In-Reply-To: <34bacfdd.1275e.1844dbf23cd.Webtop.107@btinternet.com>
References: <34bacfdd.1275e.1844dbf23cd.Webtop.107@btinternet.com>
Message-ID: <ff45beb8-bdb2-4b0b-d7a7-2c985c58cb49@statistik.tu-dortmund.de>



On 06.11.2022 17:21, Amarjit Chandhial via R-help wrote:
> 
> 
> 
> Hi Uwe,
> 
> 
> RGui does have advantages vs. RStudio, and vice-versa.
> 
> RStudio is much faster than it used to be.
> 
> I currently have .R files associated with RStudio, i.e. in File Explorer
> if I double-click on a .R file it opens in the editor in RStudio as an R
> script.
> 
> In File Explorer if I right-click on a .R file, Open with, I get the
> options: R for Windows GUI Front-end or RStudio or Search the Microsoft
> Store or choose another app.
> If I choose R for Windows GUI Front-end, RGui (64-bit) opens, but no .R
> file, in the editor.
> If I choose RStudio the .R file opens in the editor in RStudio as an R
> script.
> 
>   From the adaptation, if I choose R for Windows GUI Front-end, will the
> .R file open in RGui (64-bit) within the editor?

Yes.


> 
> 
> I have a new Windows PC and maybe, at least for the time being, it's
> best for me to have them associated with RStudio.
> 
> Although, yes, I agree, it should be naturally implemented in R, having
> installed RStudio.

I meant to implement that one can choose the internal editor to open .R 
files. File associations can be set by RStudio, too, but that is not an 
R(-core) matter.

Best,
Uwe Ligges



> 
> thanks,
> Amarjit
> 
> 
> 
> 
> ------ Original Message ------
> From: "Uwe Ligges" <ligges at statistik.tu-dortmund.de>
> To: "David Winsemius" <dwinsemius at comcast.net>; "Amarjit Chandhial"
> <a.chandhial at btinternet.com>; "Jeff Newmiller"
> <jdnewmil at dcn.davis.ca.us>
> Cc: "Amarjit Chandhial via R-help" <r-help at r-project.org>
> Sent: Sunday, 6 Nov, 2022 At 15:15
> Subject: Re: [R] Associate a .R file with the RGui
> 
> 
>    On 06.11.2022 01:40, David Winsemius wrote:
> 
>    On 11/5/22 09:58, Amarjit Chandhial via R-help wrote:
>    Hi Jeff,
> 
> 
>    Please see my original question.
> 
>    You were told that RGui is not an editor.
> 
>    Are you implying that your initial message contained an implicit
> request for instructions on how to get R code in an .R file to be opened
> automagically when double-clicked or to have "open in <some editor>"
> appear when right-clicked? (I didn't see that clearly expressed.)
> 
>    If you want something else to happen with a file that has a .R
> extension when double-clicked or right-clicked in a GUI file manager,
> then you need to configure your OS to do whatever else it is that you
> expect. This is not really an R question. It's an OS question. There are
> many editors that can also bring up R consoles when the right  key combo
> is pressed. They do require some study for their specific actions, but
> this is not really the place to get guidance on the fine details.
> 
> 
>    Friends, RGui contains an editor. It allows to send lines / code
> blocks to the R concole. We know users who need braille displays use the
> RGui internal editor as that apparently cooperates better with braille
> displays + R as many other editors.
>    And as it does not hide half of R by its own functions, I'd pefer that
> over some very popular other editors if I had no other choice.
> 
> 
>    To answer the OP's question, R does not have a built in way to get
> this task directly done, but searching the web suggests a rather simple
> way (well,m a hack as starting R with other command args may fail now,
> but you can extend this and look for a specific naming scheme):
> 
>    <https://stat.ethz.ch/pipermail/r-help/2007-August/138064.html
> <https://stat.ethz.ch/pipermail/r-help/2007-August/138064.html> >
> 
>    let is adapt this for the recent version of R:
> 
> 
>    1. Add the line
> 
>    if ( length(z <- commandArgs(TRUE)) ) utils::file.edit(z[1])
> 
>    to the Rprofile.site file; and
> 
>    2. Edit the registry to associate the .R extension with the command
> 
>    C:\Program Files\R\R-4.2.2\bin\x64\Rgui.exe --args "%1"
> 
> 
>    I think we should implement this in R anyway.
> 
>    Best,
>    Uwe Ligges
> 
> 
> 
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @@ch@ndh|@| @end|ng |rom bt|nternet@com  Sun Nov  6 19:43:12 2022
From: @@ch@ndh|@| @end|ng |rom bt|nternet@com (Amarjit Chandhial)
Date: Sun, 6 Nov 2022 18:43:12 +0000 (GMT)
Subject: [R] Associate a .R file with the RGui
In-Reply-To: <ff45beb8-bdb2-4b0b-d7a7-2c985c58cb49@statistik.tu-dortmund.de>
References: <34bacfdd.1275e.1844dbf23cd.Webtop.107@btinternet.com>
 <ff45beb8-bdb2-4b0b-d7a7-2c985c58cb49@statistik.tu-dortmund.de>
Message-ID: <166d95ad.1a1a4.1844e40fb34.Webtop.84@btinternet.com>




Hi Uwe,



I can do 1.


   1. Add the line
    if ( length(z <- commandArgs(TRUE)) ) utils::file.edit(z[1])
    to the Rprofile.site file; and

My Rprofile.site file is: "C:/PROGRA~1/R/R-42~1.2/etc/Rprofile.site"

How do I do 2, step-by-step?

    2. Edit the registry to associate the .R extension with the command
    C:\Program Files\R\R-4.2.2\bin\x64\Rgui.exe --args "%1"



Amarjit



------ Original Message ------
From: "Uwe Ligges" <ligges at statistik.tu-dortmund.de>
To: "Amarjit Chandhial" <a.chandhial at btinternet.com>; "David Winsemius" 
<dwinsemius at comcast.net>; "Jeff Newmiller" <jdnewmil at dcn.davis.ca.us>
Cc: "Amarjit Chandhial via R-help" <r-help at r-project.org>
Sent: Sunday, 6 Nov, 2022 At 17:19
Subject: Re: [R] Associate a .R file with the RGui

On 06.11.2022 17:21, Amarjit Chandhial via R-help wrote:

Hi Uwe,

RGui does have advantages vs. RStudio, and vice-versa.
RStudio is much faster than it used to be.
I currently have .R files associated with RStudio, i.e. in File Explorer
if I double-click on a .R file it opens in the editor in RStudio as an R
script.
In File Explorer if I right-click on a .R file, Open with, I get the
options: R for Windows GUI Front-end or RStudio or Search the Microsoft
Store or choose another app.
If I choose R for Windows GUI Front-end, RGui (64-bit) opens, but no .R
file, in the editor.
If I choose RStudio the .R file opens in the editor in RStudio as an R
script.
   From the adaptation, if I choose R for Windows GUI Front-end, will 
the
.R file open in RGui (64-bit) within the editor?
Yes.


I have a new Windows PC and maybe, at least for the time being, it's
best for me to have them associated with RStudio.
Although, yes, I agree, it should be naturally implemented in R, having
installed RStudio.
I meant to implement that one can choose the internal editor to open .R 
files. File associations can be set by RStudio, too, but that is not an 
R(-core) matter.
Best,
Uwe Ligges


thanks,
Amarjit


------ Original Message ------
From: "Uwe Ligges" <ligges at statistik.tu-dortmund.de>
To: "David Winsemius" <dwinsemius at comcast.net>; "Amarjit Chandhial"
<a.chandhial at btinternet.com>; "Jeff Newmiller"
<jdnewmil at dcn.davis.ca.us>
Cc: "Amarjit Chandhial via R-help" <r-help at r-project.org>
Sent: Sunday, 6 Nov, 2022 At 15:15
Subject: Re: [R] Associate a .R file with the RGui

    On 06.11.2022 01:40, David Winsemius wrote:
    On 11/5/22 09:58, Amarjit Chandhial via R-help wrote:
    Hi Jeff,

    Please see my original question.
    You were told that RGui is not an editor.
    Are you implying that your initial message contained an implicit
request for instructions on how to get R code in an .R file to be opened
automagically when double-clicked or to have "open in <some editor>"
appear when right-clicked? (I didn't see that clearly expressed.)
    If you want something else to happen with a file that has a .R
extension when double-clicked or right-clicked in a GUI file manager,
then you need to configure your OS to do whatever else it is that you
expect. This is not really an R question. It's an OS question. There are
many editors that can also bring up R consoles when the right  key combo
is pressed. They do require some study for their specific actions, but
this is not really the place to get guidance on the fine details.

    Friends, RGui contains an editor. It allows to send lines / code
blocks to the R concole. We know users who need braille displays use the
RGui internal editor as that apparently cooperates better with braille
displays + R as many other editors.
    And as it does not hide half of R by its own functions, I'd pefer 
that
over some very popular other editors if I had no other choice.

    To answer the OP's question, R does not have a built in way to get
this task directly done, but searching the web suggests a rather simple
way (well,m a hack as starting R with other command args may fail now,
but you can extend this and look for a specific naming scheme):
    <https://stat.ethz.ch/pipermail/r-help/2007-August/138064.html 
<https://stat.ethz.ch/pipermail/r-help/2007-August/138064.html>
<https://stat.ethz.ch/pipermail/r-help/2007-August/138064.html 
<https://stat.ethz.ch/pipermail/r-help/2007-August/138064.html> > >
    let is adapt this for the recent version of R:

    1. Add the line
    if ( length(z <- commandArgs(TRUE)) ) utils::file.edit(z[1])
    to the Rprofile.site file; and
    2. Edit the registry to associate the .R extension with the command
    C:\Program Files\R\R-4.2.2\bin\x64\Rgui.exe --args "%1"

    I think we should implement this in R anyway.
    Best,
    Uwe Ligges



	[[alternative HTML version deleted]]
______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help 
<https://stat.ethz.ch/mailman/listinfo/r-help>
PLEASE do read the posting guide 
http://www.R-project.org/posting-guide.html 
<http://www.R-project.org/posting-guide.html>
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From n|ckmwr@y @end|ng |rom gm@||@com  Mon Nov  7 00:34:46 2022
From: n|ckmwr@y @end|ng |rom gm@||@com (Nick Wray)
Date: Sun, 6 Nov 2022 23:34:46 +0000
Subject: [R] (no subject)
Message-ID: <CABxY9BMoH17OD1e5eLRN8H0SNv1=LJKtRoRGeABLzAtxVxcw=w@mail.gmail.com>

Hello - I am using the MICE package to impute missing values - the input
data are up to six vectors of parallel hourly temperature measurements for
Scottish weather stations across a calendar year. None of the vectors have
more than 5% NAs as I have filtered ones with more out.  Most of the sets
work fine with MICE but with a few I get an error message:

This data set, which generated the error message has five columns

iter imp variable
  1   1  986Error in terms.formula(tmp, simplify = TRUE) :
  invalid term in model formula


986 is the station number which is the column name here for the first
column.  The third to fifth columns don't have any NAs and the first and
second have fewer than 1% - but they do have the NAs concentrated as
strings of 20 or so near the beginning of the data set.

I am puzzled as to why certain datasets, which don't seem very different
from the others provoke the error message - the only thing which I am
wondering is whether MICE has a problem with a too large concentration of
the NAs in particular regions but I can't find any reference to this in the
literature.  Has anyone else come across this as a problem, and if so, what
did they do about it?  Thanks Nick Wray

	[[alternative HTML version deleted]]


From dw|n@em|u@ @end|ng |rom comc@@t@net  Mon Nov  7 07:46:56 2022
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Sun, 6 Nov 2022 22:46:56 -0800
Subject: [R] 
 Is this *always* the intended R^2 value for no intercept in lm?
In-Reply-To: <CAGxFJbQTzxLtALLdcChx0dBhGRuEBvZBTrmebqVSmEqxNBE2ag@mail.gmail.com>
References: <CAGxFJbQTzxLtALLdcChx0dBhGRuEBvZBTrmebqVSmEqxNBE2ag@mail.gmail.com>
Message-ID: <C45C714C-B662-48B8-AC65-5DD6793DA5DB@comcast.net>

To Thierry; When you omit an intercept you require that the line in multivariate space that represents the ?predictions? go through the (0,0,0,?) I.e. the origin. It?s a fairly restrictive requirement. There IS an intercept, even though it?s not explicitly seen in the model. If it?s not required by theory in your domain of investigation, you are advised to avoid such a practice.

? 
David. 

Sent from my iPhone

> On Nov 5, 2022, at 12:41 PM, Bert Gunter <bgunter.4567 at gmail.com> wrote:
> 
> ?FAQ 7.41
> and
> https://stackoverflow.com/questions/57415793/r-squared-in-lm-for-ero-intercept-model
> 
> (among numerous others that could no doubt be found with a bit of
> searching).
> 
> In short, the "null models" against which you are comparing the fitted
> model are different with and without an intercept.
> 
> --Bert
> 
> 
> 
>> On Sat, Nov 5, 2022 at 11:52 AM Thierry Zell <thierry.zell at gmail.com> wrote:
>> 
>> I am puzzled by the computation of R^2 with intercept omitted that is
>> already illustrated by the following example taken from help("lm")
>> 
>> ## Annette Dobson (1990) "An Introduction to Generalized Linear Models".
>> ## Page 9: Plant Weight Data.
>> ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
>> trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
>> group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
>> weight <- c(ctl, trt)
>> lm.D9 <- lm(weight ~ group)
>> lm.D90 <- lm(weight ~ group - 1) # omitting intercept
>> 
>> The calculations for the R^2 for both models  are consistent with the
>> help("summary.lm") description:
>> "y* is the mean of y[i] if there is an intercept and zero otherwise."
>> Which causes a dramatic difference in the resulting R^2 values.
>> 
>> r2.D9 <- summary(lm.D9)$r.squared
>> r2.D90 <- summary(lm.D90)$r.squared
>> 
>> all.equal(r2.D9, 0.0730775989903856) #TRUE
>> all.equal(r2.D90, 0.981783272435264) #TRUE
>> 
>> This is counter-intuitive to say the least since the two models have
>> identical predictions and both models could be described more
>> accurately as two intercepts rather than zero. I see three
>> possibilities:
>> 
>> 1. This is the intended result, in which case no fix is required, but
>> I?d be curious to understand the argument better.
>> 2. This is an unfortunate outcome but not worth fixing as the user can
>> easily compute the correct R^2. In this case, I'd suggest that this
>> unintuitive behavior should be explicitly called out in the
>> documentation.
>> 3. This is a bug worth fixing.
>> 
>> I look forward to hearing the community?s opinion on this.
>> Thanks in advance!
>> 
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>> 
> 
>    [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kry|ov@r00t @end|ng |rom gm@||@com  Mon Nov  7 09:20:58 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Mon, 7 Nov 2022 11:20:58 +0300
Subject: [R] (no subject)
In-Reply-To: <CABxY9BMoH17OD1e5eLRN8H0SNv1=LJKtRoRGeABLzAtxVxcw=w@mail.gmail.com>
References: <CABxY9BMoH17OD1e5eLRN8H0SNv1=LJKtRoRGeABLzAtxVxcw=w@mail.gmail.com>
Message-ID: <20221107112058.0bd0d8ea@Tarkus>

On Sun, 6 Nov 2022 23:34:46 +0000
Nick Wray <nickmwray at gmail.com> wrote:

> Most of the sets work fine with MICE but with a few I get an error
> message:
> 
> This data set, which generated the error message has five columns
> 
> iter imp variable
>   1   1  986Error in terms.formula(tmp, simplify = TRUE) :
>   invalid term in model formula

Currently, there doesn't seem to be any issues [*] related to your
problem, so you could be the first to report it. (This does look like a
bug in mice; at the very least, the error message could be improved.)
How could the maintainer reproduce your problem in order to debug it?
[**]

traceback() and options(error = recover) are invaluable when trying to
find out what is going on before a crash (see ?traceback, ?recover and
?browser for more information; also the free book R Inferno [***]).

For example, if you set options(error = recover) and then reproduce the
crash, you'll be able to print(tmp) at the time of the crash and see
the term that terms.formula is having a problem with. The next step
would be finding out how this formula came to be, and so on.

> 	[[alternative HTML version deleted]]

Please post in plain text to R mailing lists. This particular message
came through mostly fine, but in many cases, the plain text version
automatically generated by the sender's mailer from the user-composed
HTML version makes for very unpleasant reading.

-- 
Best regards,
Ivan

[*]
https://github.com/amices/mice/issues?q=invalid+term+in+model+formula

[**]
See also: https://www.chiark.greenend.org.uk/~sgtatham/bugs.html

[***]
https://www.burns-stat.com/documents/books/the-r-inferno/


From T|||@ny@Duh| @end|ng |rom tu|t@@edu  Sun Nov  6 17:40:18 2022
From: T|||@ny@Duh| @end|ng |rom tu|t@@edu (Duhl, Tiffany R.)
Date: Sun, 6 Nov 2022 16:40:18 +0000
Subject: [R] [External] Re: Selecting a minimum value of an attribute
 associated with point values neighboring a given point and assigning it as
 a new attribute
In-Reply-To: <CAGgJW77yY0_GDQWEAxzSdRh0N3kXgj9zrSEYUzuVsFnHyeE=aA@mail.gmail.com>
References: <BN6PR05MB35887EFE01222DBF7C359AAB903B9@BN6PR05MB3588.namprd05.prod.outlook.com>
 <CAGxFJbSkg9zAqk0dGcr3qJe2z2C04NEZFdHN8hWQA3oSbfHukQ@mail.gmail.com>
 <CAGgJW767Ein1S+MSywb57B2UtmE0EJodDVokPEx5_-c5BTFR1Q@mail.gmail.com>
 <CAGgJW77yY0_GDQWEAxzSdRh0N3kXgj9zrSEYUzuVsFnHyeE=aA@mail.gmail.com>
Message-ID: <BN6PR05MB3588015F46997E64D5F8F138903D9@BN6PR05MB3588.namprd05.prod.outlook.com>

Thanks so much Eric!

 I'm going to play around with your toy code (pun intended) & see if I can make it work for my application.

Cheers,
-Tiffany
________________________________
From: Eric Berger <ericjberger at gmail.com>
Sent: Sunday, November 6, 2022 10:27 AM
To: Bert Gunter <bgunter.4567 at gmail.com>
Cc: Duhl, Tiffany R. <Tiffany.Duhl at tufts.edu>; R-help <R-help at r-project.org>
Subject: [External] Re: [R] Selecting a minimum value of an attribute associated with point values neighboring a given point and assigning it as a new attribute

Whoops ... left out a line in Part 2. Resending with the correction

## PART 2: You can use this code on the real data with f() defined appropriately
A <- matrix(0,N,N)
v <- 1:N
## get the indices (j,k) where j < k (as columns in a data.frame)
idx <- expand.grid(v,v) |> rename(j=Var1,k=Var2) |> filter(j < k)
u <- sapply(1:nrow(idx),
           \(i){ j <- idx$j[i]; k <- idx$k[i]; A[j,k] <<- f(j,k,myData) })
B <- A + t(A) + diag(N)
C <- diag(myData$Conc)
D <- B %*% C
D[D==0] <- NA
myData$Conc_min <- apply(D,MAR=1,\(v){min(v,na.rm=TRUE)})
print(head(myData))

On Sun, Nov 6, 2022 at 5:19 PM Eric Berger <ericjberger at gmail.com> wrote:
>
> Hi Tiffany,
> Here is some code that might help with your problem. I solve a "toy"
> problem that is conceptually the same.
> Part 1 sets up my toy problem. You would have to replace Part 1 with
> your real case. The main point is to define
> a function f(i, j, data) which returns 0 or 1 depending on whether the
> observations in rows i and j in your dataset 'data'
> are within your cutoff distance (i.e. 50m).
>
> You can then use Part 2 almost without changes (except for changing
> 'myData' to the correct name of your data).
>
> I hope this helps,
> Eric
>
> library(dplyr)
>
> ## PART 1: create fake data for minimal example
> set.seed(123) ## for reproducibility
> N <- 5       ## replace by number of locations (approx 9000 in your case)
> MAX_DISTANCE <- 2  ## 50 in your case
> myData <- data.frame(x=rnorm(N),y=rnorm(N),Conc=sample(1:N,N))
>
> ## The function which you must re-define for your actual case.
> f <- function(i,j,a) {
>  dist <- sqrt(sum((a[i,1:2] - a[j,1:2])^2)) ## Euclidean distance
>  as.integer(dist < MAX_DISTANCE)
> }
>
> ## PART 2: You can use this code on the real data with f() defined appropriately
> A <- matrix(0,N,N)
> ## get the indices (j,k) where j < k (as columns in a data.frame)
> idx <- expand.grid(v,v) |> rename(j=Var1,k=Var2) |> filter(j < k)
> u <- sapply(1:nrow(idx),\(i){ j <- idx$j[i]; k <- idx$k[i]; A[j,k] <<-
> f(j,k,myData) })
> B <- A + t(A) + diag(N)
> C <- diag(myData$Conc)
> D <- B %*% C
> D[D==0] <- NA
> myData$Conc_min <- apply(D,MAR=1,\(v){min(v,na.rm=TRUE)})
> print(head(myData))
>
>
> On Sat, Nov 5, 2022 at 5:14 PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >
> > Probably better posted on R-sig-geo.
> >
> > -- Bert
> >
> > On Sat, Nov 5, 2022 at 12:36 AM Duhl, Tiffany R. <Tiffany.Duhl at tufts.edu>
> > wrote:
> >
> > > Hello,
> > >
> > > I have sets of spatial points with LAT, LON coords (unprojected, WGS84
> > > datum) and several value attributes associated with each point, from
> > > numerous csv files (with an average of 6,000-9,000 points in each file) as
> > > shown in the following example:
> > >
> > > data<- read.csv("R_find_pts_testdata.csv")
> > >
> > > > data
> > >     ID      Date         Time        LAT            LON           Conc
> > > Leg.Speed    CO2  H2O BC61 Hr Min Sec
> > > 1   76 4/19/2021 21:25:38 42.40066 -70.98802 99300   0.0 mph 428.39 9.57
> > > 578 21  25  38
> > > 2   77 4/19/2021 21:25:39 42.40066 -70.98802 96730   0.0 mph 428.04 9.57
> > > 617 21  25  39
> > > 3   79 4/19/2021 21:25:41 42.40066 -70.98802 98800   0.2 mph 427.10 9.57
> > > 1027 21  25  41
> > > 4   80 4/19/2021 21:25:42 42.40066 -70.98802 96510     2 mph 427.99 9.58
> > > 1381 21  25  42
> > > 5   81 4/19/2021 21:25:43 42.40067 -70.98801 95540     3 mph 427.99 9.58
> > > 1271 21  25  43
> > > 6   82 4/19/2021 21:25:44 42.40068 -70.98799 94720     4 mph 427.20 9.57
> > > 910 21  25  44
> > > 7   83 4/19/2021 21:25:45 42.40069 -70.98797 94040     5 mph 427.18 9.57
> > > 652 21  25  45
> > > 8   84 4/19/2021 21:25:46 42.40072 -70.98795 95710     7 mph 427.07 9.57
> > > 943 21  25  46
> > > 9   85 4/19/2021 21:25:47 42.40074 -70.98792 96200     8 mph 427.44 9.56
> > > 650 21  25  47
> > > 10  86 4/19/2021 21:25:48 42.40078 -70.98789 93750    10 mph 428.76 9.57
> > > 761 21  25  48
> > > 11  87 4/19/2021 21:25:49 42.40081 -70.98785 93360    11 mph 429.25 9.56
> > > 1158 21  25  49
> > > 12  88 4/19/2021 21:25:50 42.40084 -70.98781 94340    12 mph 429.56 9.57
> > > 107 21  25  50
> > > 13  89 4/19/2021 21:25:51 42.40087 -70.98775 92780    12 mph 428.62 9.56
> > > 720 21  25  51
> > >
> > >
> > > What I want to do is, for each point, identify all points within 50m of
> > > that point, find the minimum value of the "Conc" attribute of each nearby
> > > set of points (including the original point) and then create a new variable
> > > ("Conc_min") and assign this minimum value to a new variable added to
> > > "data".
> > >
> > > So far, I have the following code:
> > >
> > > library(spdep)
> > > library(sf)
> > >
> > > setwd("C:\\mydirectory\\")
> > > data<- read.csv("R_find_pts_testdata.csv")
> > >
> > > #make sure the data is a data frame
> > > pts <- data.frame(data)
> > >
> > > #create spatial data frame and define projection
> > > pts_coords <- cbind(pts$LON, pts$LAT)
> > > data_pts <- SpatialPointsDataFrame(coords= pts_coords,
> > > data=pts, proj4string = CRS("+proj=longlat +datum=WGS84"))
> > >
> > > #Re-project to WGS 84 / UTM zone 18N, so the analysis is in units of m
> > > ptsUTM  <- sf::st_as_sf(data_pts, coords = c("LAT", "LON"), remove = F)%>%
> > > st_transform(32618)
> > >
> > > #create 50 m buffer around each point then intersect with points and
> > > finally find neighbors within the buffers
> > > pts_buf <- sf::st_buffer(ptsUTM, 50)
> > > coords  <- sf::st_coordinates(ptsUTM)
> > > int <- sf::st_intersects(pts_buf, ptsUTM)
> > > x   <- spdep::dnearneigh(coords, 0, 50)
> > >
> > > Now at this point, I'm not sure what to either the "int" (a sgbp list) or
> > > "x" (nb object) objects (or even if I need them both)
> > >
> > > > int
> > > Sparse geometry binary predicate list of length 974, where the predicate
> > > was `intersects'
> > > first 10 elements:
> > >  1: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >  2: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >  3: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >  4: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >  5: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >  6: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >  7: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >  8: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >  9: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> > >
> > > > x
> > > Neighbour list object:
> > > Number of regions: 974
> > > Number of nonzero links: 34802
> > > Percentage nonzero weights: 3.668481
> > > Average number of links: 35.73101
> > >
> > > One thought is that maybe I don't need the dnearneigh function and can
> > > instead convert "int" into a dataframe and somehow merge or associate
> > > (perhaps with an inner join) the ID fields of the buffered and intersecting
> > > points and then compute the minimum value of "Conc" grouping by ID:
> > >
> > > > as.data.frame(int)
> > >     row.id col.id
> > > 1        1      1
> > > 2        1      2
> > > 3        1      3
> > > 4        1      4
> > > 5        1      5
> > > 6        1      6
> > > 7        1      7
> > > 8        1      8
> > > 9        1      9
> > > 10       1     10
> > > 11       1     11
> > > 12       1     12
> > > 13       1     13
> > > 14       1     14
> > > 15       1     15
> > > 16       1     16
> > > 17       1     17
> > > 18       1     18
> > > 19       2      1
> > > 20       2      2
> > > 21       2      3
> > > 22       2      4
> > > 23       2      5
> > > 24       2      6
> > > 25       2      7
> > > 26       2      8
> > > 27       2      9
> > > 28       2     10
> > >
> > >
> > > So in the above example I'd like to take the minimum of "Conc" among the
> > > col.id points grouped with row.id 1 (i.e., col.ids 1-18) and assign the
> > > minimum value of this group as a new variable in data (Data$Conc_min), and
> > > do the same for row.id 2 and all the rest of the rows.
> > >
> > > I'm just not sure how to do this and I appreciate any help folks might
> > > have on this matter!
> > >
> > > Many thanks,
> > > -Tiffany
> > >
> > >         [[alternative HTML version deleted]]
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide
> > > http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> > >
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.

Caution: This message originated from outside of the Tufts University organization. Please exercise caution when clicking links or opening attachments. When in doubt, email the TTS Service Desk at it at tufts.edu<mailto:it at tufts.edu> or call them directly at 617-627-3376.


	[[alternative HTML version deleted]]


From t@v|b@r @end|ng |rom gm@||@com  Mon Nov  7 14:11:18 2022
From: t@v|b@r @end|ng |rom gm@||@com (Micha Silver)
Date: Mon, 7 Nov 2022 15:11:18 +0200
Subject: [R] [External] Re: Selecting a minimum value of an attribute
 associated with point values neighboring a given point and assigning it as
 a new attribute
In-Reply-To: <BN6PR05MB3588015F46997E64D5F8F138903D9@BN6PR05MB3588.namprd05.prod.outlook.com>
References: <BN6PR05MB35887EFE01222DBF7C359AAB903B9@BN6PR05MB3588.namprd05.prod.outlook.com>
 <CAGxFJbSkg9zAqk0dGcr3qJe2z2C04NEZFdHN8hWQA3oSbfHukQ@mail.gmail.com>
 <CAGgJW767Ein1S+MSywb57B2UtmE0EJodDVokPEx5_-c5BTFR1Q@mail.gmail.com>
 <CAGgJW77yY0_GDQWEAxzSdRh0N3kXgj9zrSEYUzuVsFnHyeE=aA@mail.gmail.com>
 <BN6PR05MB3588015F46997E64D5F8F138903D9@BN6PR05MB3588.namprd05.prod.outlook.com>
Message-ID: <3247be10-6d5c-12d5-1634-2a9e934f431e@gmail.com>

Eric's solution notwithstanding, here's a more "spatial" approach.


I first create a fictitious set of 1000 points (and save to CSV to 
replicate your workflow)

library(sf)
library(spdep)

# Prepare fictitious data
# Create a data.frame with 1000 random points, and save to CSV
LON <- runif(1000, -70.0, -69.0)
LAT <- runif(1000, 42.0, 43.0)
Conc <- runif(1000, 90000, 100000)
df <- data.frame(LON, LAT, Conc)
csv_file = "/tmp/pts_testdata.csv"
write.csv(df, csv_file)


Now read that CSV back in directly as an sf object (No need for the old 
SpatialPointsDataFrame). THen create a distance matrix for all points, 
which contains indicies to those points within a certain buffer 
distance, just as you did in your example.


# Read back in as sf object, including row index
pts <- st_as_sf(read.csv(csv_file), coords=c('LON', 'LAT'), crs=4326)
dist_matrix <- dnearneigh(pts, 0, 100, use_s2=TRUE) # use_s2 since these 
are lon/lat

Now I prepare a function to get the minimum Conv value among all points 
within the buffer distance to a given single point:
# Function to get minimum Conc values for one row of distance matrix
MinConc <- function(x, lst, pts) {
 ? # x is an index to a single point,
 ? # lst is a list of point indices from distance matrix
 ? # that are within the buffer distance
 ? Concs <- lapply(lst, function(p) {
 ??? pts$Conc[p]
 ? })
 ? return(min(Concs[[1]]))
}

Next run that function on all points to get a list of minimum Conv 
values for all points, and merge back to pts.


# Now apply this function to all points in pts
Conc_min <- lapply(pts$X, function(i){
 ? MinConc(i, dist_matrix[i], pts)
})
Conc_min <- data.frame("Conc_min" = as.integer(Conc_min))

# Add back as new attrib to original points sf object
pts_with_min <- do.call(cbind, c(pts, Conc_min))

HTH,

Micha



On 06/11/2022 18:40, Duhl, Tiffany R. wrote:
> Thanks so much Eric!
>
>   I'm going to play around with your toy code (pun intended) & see if I can make it work for my application.
>
> Cheers,
> -Tiffany
> ________________________________
> From: Eric Berger <ericjberger at gmail.com>
> Sent: Sunday, November 6, 2022 10:27 AM
> To: Bert Gunter <bgunter.4567 at gmail.com>
> Cc: Duhl, Tiffany R. <Tiffany.Duhl at tufts.edu>; R-help <R-help at r-project.org>
> Subject: [External] Re: [R] Selecting a minimum value of an attribute associated with point values neighboring a given point and assigning it as a new attribute
>
> Whoops ... left out a line in Part 2. Resending with the correction
>
> ## PART 2: You can use this code on the real data with f() defined appropriately
> A <- matrix(0,N,N)
> v <- 1:N
> ## get the indices (j,k) where j < k (as columns in a data.frame)
> idx <- expand.grid(v,v) |> rename(j=Var1,k=Var2) |> filter(j < k)
> u <- sapply(1:nrow(idx),
>             \(i){ j <- idx$j[i]; k <- idx$k[i]; A[j,k] <<- f(j,k,myData) })
> B <- A + t(A) + diag(N)
> C <- diag(myData$Conc)
> D <- B %*% C
> D[D==0] <- NA
> myData$Conc_min <- apply(D,MAR=1,\(v){min(v,na.rm=TRUE)})
> print(head(myData))
>
> On Sun, Nov 6, 2022 at 5:19 PM Eric Berger <ericjberger at gmail.com> wrote:
>> Hi Tiffany,
>> Here is some code that might help with your problem. I solve a "toy"
>> problem that is conceptually the same.
>> Part 1 sets up my toy problem. You would have to replace Part 1 with
>> your real case. The main point is to define
>> a function f(i, j, data) which returns 0 or 1 depending on whether the
>> observations in rows i and j in your dataset 'data'
>> are within your cutoff distance (i.e. 50m).
>>
>> You can then use Part 2 almost without changes (except for changing
>> 'myData' to the correct name of your data).
>>
>> I hope this helps,
>> Eric
>>
>> library(dplyr)
>>
>> ## PART 1: create fake data for minimal example
>> set.seed(123) ## for reproducibility
>> N <- 5       ## replace by number of locations (approx 9000 in your case)
>> MAX_DISTANCE <- 2  ## 50 in your case
>> myData <- data.frame(x=rnorm(N),y=rnorm(N),Conc=sample(1:N,N))
>>
>> ## The function which you must re-define for your actual case.
>> f <- function(i,j,a) {
>>   dist <- sqrt(sum((a[i,1:2] - a[j,1:2])^2)) ## Euclidean distance
>>   as.integer(dist < MAX_DISTANCE)
>> }
>>
>> ## PART 2: You can use this code on the real data with f() defined appropriately
>> A <- matrix(0,N,N)
>> ## get the indices (j,k) where j < k (as columns in a data.frame)
>> idx <- expand.grid(v,v) |> rename(j=Var1,k=Var2) |> filter(j < k)
>> u <- sapply(1:nrow(idx),\(i){ j <- idx$j[i]; k <- idx$k[i]; A[j,k] <<-
>> f(j,k,myData) })
>> B <- A + t(A) + diag(N)
>> C <- diag(myData$Conc)
>> D <- B %*% C
>> D[D==0] <- NA
>> myData$Conc_min <- apply(D,MAR=1,\(v){min(v,na.rm=TRUE)})
>> print(head(myData))
>>
>>
>> On Sat, Nov 5, 2022 at 5:14 PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>>> Probably better posted on R-sig-geo.
>>>
>>> -- Bert
>>>
>>> On Sat, Nov 5, 2022 at 12:36 AM Duhl, Tiffany R. <Tiffany.Duhl at tufts.edu>
>>> wrote:
>>>
>>>> Hello,
>>>>
>>>> I have sets of spatial points with LAT, LON coords (unprojected, WGS84
>>>> datum) and several value attributes associated with each point, from
>>>> numerous csv files (with an average of 6,000-9,000 points in each file) as
>>>> shown in the following example:
>>>>
>>>> data<- read.csv("R_find_pts_testdata.csv")
>>>>
>>>>> data
>>>>      ID      Date         Time        LAT            LON           Conc
>>>> Leg.Speed    CO2  H2O BC61 Hr Min Sec
>>>> 1   76 4/19/2021 21:25:38 42.40066 -70.98802 99300   0.0 mph 428.39 9.57
>>>> 578 21  25  38
>>>> 2   77 4/19/2021 21:25:39 42.40066 -70.98802 96730   0.0 mph 428.04 9.57
>>>> 617 21  25  39
>>>> 3   79 4/19/2021 21:25:41 42.40066 -70.98802 98800   0.2 mph 427.10 9.57
>>>> 1027 21  25  41
>>>> 4   80 4/19/2021 21:25:42 42.40066 -70.98802 96510     2 mph 427.99 9.58
>>>> 1381 21  25  42
>>>> 5   81 4/19/2021 21:25:43 42.40067 -70.98801 95540     3 mph 427.99 9.58
>>>> 1271 21  25  43
>>>> 6   82 4/19/2021 21:25:44 42.40068 -70.98799 94720     4 mph 427.20 9.57
>>>> 910 21  25  44
>>>> 7   83 4/19/2021 21:25:45 42.40069 -70.98797 94040     5 mph 427.18 9.57
>>>> 652 21  25  45
>>>> 8   84 4/19/2021 21:25:46 42.40072 -70.98795 95710     7 mph 427.07 9.57
>>>> 943 21  25  46
>>>> 9   85 4/19/2021 21:25:47 42.40074 -70.98792 96200     8 mph 427.44 9.56
>>>> 650 21  25  47
>>>> 10  86 4/19/2021 21:25:48 42.40078 -70.98789 93750    10 mph 428.76 9.57
>>>> 761 21  25  48
>>>> 11  87 4/19/2021 21:25:49 42.40081 -70.98785 93360    11 mph 429.25 9.56
>>>> 1158 21  25  49
>>>> 12  88 4/19/2021 21:25:50 42.40084 -70.98781 94340    12 mph 429.56 9.57
>>>> 107 21  25  50
>>>> 13  89 4/19/2021 21:25:51 42.40087 -70.98775 92780    12 mph 428.62 9.56
>>>> 720 21  25  51
>>>>
>>>>
>>>> What I want to do is, for each point, identify all points within 50m of
>>>> that point, find the minimum value of the "Conc" attribute of each nearby
>>>> set of points (including the original point) and then create a new variable
>>>> ("Conc_min") and assign this minimum value to a new variable added to
>>>> "data".
>>>>
>>>> So far, I have the following code:
>>>>
>>>> library(spdep)
>>>> library(sf)
>>>>
>>>> setwd("C:\\mydirectory\\")
>>>> data<- read.csv("R_find_pts_testdata.csv")
>>>>
>>>> #make sure the data is a data frame
>>>> pts <- data.frame(data)
>>>>
>>>> #create spatial data frame and define projection
>>>> pts_coords <- cbind(pts$LON, pts$LAT)
>>>> data_pts <- SpatialPointsDataFrame(coords= pts_coords,
>>>> data=pts, proj4string = CRS("+proj=longlat +datum=WGS84"))
>>>>
>>>> #Re-project to WGS 84 / UTM zone 18N, so the analysis is in units of m
>>>> ptsUTM  <- sf::st_as_sf(data_pts, coords = c("LAT", "LON"), remove = F)%>%
>>>> st_transform(32618)
>>>>
>>>> #create 50 m buffer around each point then intersect with points and
>>>> finally find neighbors within the buffers
>>>> pts_buf <- sf::st_buffer(ptsUTM, 50)
>>>> coords  <- sf::st_coordinates(ptsUTM)
>>>> int <- sf::st_intersects(pts_buf, ptsUTM)
>>>> x   <- spdep::dnearneigh(coords, 0, 50)
>>>>
>>>> Now at this point, I'm not sure what to either the "int" (a sgbp list) or
>>>> "x" (nb object) objects (or even if I need them both)
>>>>
>>>>> int
>>>> Sparse geometry binary predicate list of length 974, where the predicate
>>>> was `intersects'
>>>> first 10 elements:
>>>>   1: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>   2: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>   3: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>   4: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>   5: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>   6: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>   7: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>   8: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>   9: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>
>>>>> x
>>>> Neighbour list object:
>>>> Number of regions: 974
>>>> Number of nonzero links: 34802
>>>> Percentage nonzero weights: 3.668481
>>>> Average number of links: 35.73101
>>>>
>>>> One thought is that maybe I don't need the dnearneigh function and can
>>>> instead convert "int" into a dataframe and somehow merge or associate
>>>> (perhaps with an inner join) the ID fields of the buffered and intersecting
>>>> points and then compute the minimum value of "Conc" grouping by ID:
>>>>
>>>>> as.data.frame(int)
>>>>      row.id col.id
>>>> 1        1      1
>>>> 2        1      2
>>>> 3        1      3
>>>> 4        1      4
>>>> 5        1      5
>>>> 6        1      6
>>>> 7        1      7
>>>> 8        1      8
>>>> 9        1      9
>>>> 10       1     10
>>>> 11       1     11
>>>> 12       1     12
>>>> 13       1     13
>>>> 14       1     14
>>>> 15       1     15
>>>> 16       1     16
>>>> 17       1     17
>>>> 18       1     18
>>>> 19       2      1
>>>> 20       2      2
>>>> 21       2      3
>>>> 22       2      4
>>>> 23       2      5
>>>> 24       2      6
>>>> 25       2      7
>>>> 26       2      8
>>>> 27       2      9
>>>> 28       2     10
>>>>
>>>>
>>>> So in the above example I'd like to take the minimum of "Conc" among the
>>>> col.id points grouped with row.id 1 (i.e., col.ids 1-18) and assign the
>>>> minimum value of this group as a new variable in data (Data$Conc_min), and
>>>> do the same for row.id 2 and all the rest of the rows.
>>>>
>>>> I'm just not sure how to do this and I appreciate any help folks might
>>>> have on this matter!
>>>>
>>>> Many thanks,
>>>> -Tiffany
>>>>
>>>>          [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
> Caution: This message originated from outside of the Tufts University organization. Please exercise caution when clicking links or opening attachments. When in doubt, email the TTS Service Desk at it at tufts.edu<mailto:it at tufts.edu> or call them directly at 617-627-3376.
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Micha Silver
Ben Gurion Univ.
Sde Boker, Remote Sensing Lab
cell: +972-523-665918


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Mon Nov  7 15:00:18 2022
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Mon, 7 Nov 2022 15:00:18 +0100
Subject: [R] Associate a .R file with the RGui
In-Reply-To: <166d95ad.1a1a4.1844e40fb34.Webtop.84@btinternet.com>
References: <34bacfdd.1275e.1844dbf23cd.Webtop.107@btinternet.com>
 <ff45beb8-bdb2-4b0b-d7a7-2c985c58cb49@statistik.tu-dortmund.de>
 <166d95ad.1a1a4.1844e40fb34.Webtop.84@btinternet.com>
Message-ID: <8633438b-e1e3-5cf9-9e87-8fe197a1bf94@statistik.tu-dortmund.de>



On 06.11.2022 19:43, Amarjit Chandhial wrote:
> 
> Hi Uwe,
> 
> 
> 
> 
> I can do 1.
> 
> 
> 
> 1. Add the line
> 
> if ( length(z <- commandArgs(TRUE)) ) utils::file.edit(z[1])
> 
> to the Rprofile.site file; and
> 
> 
> My Rprofile.site file is: "C:/PROGRA~1/R/R-42~1.2/etc/Rprofile.site"
> 
> 
> 
> How do I do 2, step-by-step?
> 
> 
> 2. Edit the registry to associate the .R extension with the command
> 
> C:\Program Files\R\R-4.2.2\bin\x64\Rgui.exe --args "%1"

If you have not .R file association yet, you can add the line above when 
being asked.
If you have one, simply change the registry key

Computer\HKEY_CLASSES_ROOT\R_auto_file\shell\open\command

There is a standard value as extendable string (REG_EXPAND_SZ) and you 
simply replace its content by

"C:\Program Files\R\R-4.2.2\bin\x64\Rgui.exe" --args "%1"


and in

Computer\HKEY_CLASSES_ROOT\.R

there shoudl be a standard string (REG_SZ)
R_auto_file

Best,
Uwe Ligges





> 
> 
> 
> Amarjit
> 
> 
> 
> 
> 
> 
>     ------ Original Message ------
>     From: "Uwe Ligges" <ligges at statistik.tu-dortmund.de>
>     To: "Amarjit Chandhial" <a.chandhial at btinternet.com>; "David
>     Winsemius" <dwinsemius at comcast.net>; "Jeff Newmiller"
>     <jdnewmil at dcn.davis.ca.us>
>     Cc: "Amarjit Chandhial via R-help" <r-help at r-project.org>
>     Sent: Sunday, 6 Nov, 2022 At 17:19
>     Subject: Re: [R] Associate a .R file with the RGui
> 
> 
> 
>     On 06.11.2022 17:21, Amarjit Chandhial via R-help wrote:
>     			
> 
> 
>     Hi Uwe,
> 
> 
>     RGui does have advantages vs. RStudio, and vice-versa.
> 
>     RStudio is much faster than it used to be.
> 
>     I currently have .R files associated with RStudio, i.e. in File Explorer
>     if I double-click on a .R file it opens in the editor in RStudio as an R
>     script.
> 
>     In File Explorer if I right-click on a .R file, Open with, I get the
>     options: R for Windows GUI Front-end or RStudio or Search the Microsoft
>     Store or choose another app.
>     If I choose R for Windows GUI Front-end, RGui (64-bit) opens, but no .R
>     file, in the editor.
>     If I choose RStudio the .R file opens in the editor in RStudio as an R
>     script.
> 
>      From the adaptation, if I choose R for Windows GUI Front-end, will the
>     .R file open in RGui (64-bit) within the editor?
> 
> 
>     Yes.
> 
> 
>     			
> 
>     I have a new Windows PC and maybe, at least for the time being, it's
>     best for me to have them associated with RStudio.
> 
>     Although, yes, I agree, it should be naturally implemented in R, having
>     installed RStudio.
> 
> 
>     I meant to implement that one can choose the internal editor to open
>     .R files. File associations can be set by RStudio, too, but that is
>     not an R(-core) matter.
> 
>     Best,
>     Uwe Ligges
> 
> 
> 
>     			
>     thanks,
>     Amarjit
> 
> 
> 
> 
>     ------ Original Message ------
>     From: "Uwe Ligges" <ligges at statistik.tu-dortmund.de>
>     To: "David Winsemius" <dwinsemius at comcast.net>; "Amarjit Chandhial"
>     <a.chandhial at btinternet.com>; "Jeff Newmiller"
>     <jdnewmil at dcn.davis.ca.us>
>     Cc: "Amarjit Chandhial via R-help" <r-help at r-project.org>
>     Sent: Sunday, 6 Nov, 2022 At 15:15
>     Subject: Re: [R] Associate a .R file with the RGui
> 
> 
>     On 06.11.2022 01:40, David Winsemius wrote:
> 
>     On 11/5/22 09:58, Amarjit Chandhial via R-help wrote:
>     Hi Jeff,
> 
> 
>     Please see my original question.
> 
>     You were told that RGui is not an editor.
> 
>     Are you implying that your initial message contained an implicit
>     request for instructions on how to get R code in an .R file to be opened
>     automagically when double-clicked or to have "open in <some editor>"
>     appear when right-clicked? (I didn't see that clearly expressed.)
> 
>     If you want something else to happen with a file that has a .R
>     extension when double-clicked or right-clicked in a GUI file manager,
>     then you need to configure your OS to do whatever else it is that you
>     expect. This is not really an R question. It's an OS question. There are
>     many editors that can also bring up R consoles when the right key combo
>     is pressed. They do require some study for their specific actions, but
>     this is not really the place to get guidance on the fine details.
> 
> 
>     Friends, RGui contains an editor. It allows to send lines / code
>     blocks to the R concole. We know users who need braille displays use the
>     RGui internal editor as that apparently cooperates better with braille
>     displays + R as many other editors.
>     And as it does not hide half of R by its own functions, I'd pefer that
>     over some very popular other editors if I had no other choice.
> 
> 
>     To answer the OP's question, R does not have a built in way to get
>     this task directly done, but searching the web suggests a rather simple
>     way (well,m a hack as starting R with other command args may fail now,
>     but you can extend this and look for a specific naming scheme):
> 
>     <https://stat.ethz.ch/pipermail/r-help/2007-August/138064.html
>     <https://stat.ethz.ch/pipermail/r-help/2007-August/138064.html>
>     <https://stat.ethz.ch/pipermail/r-help/2007-August/138064.html
>     <https://stat.ethz.ch/pipermail/r-help/2007-August/138064.html>> >
> 
>     let is adapt this for the recent version of R:
> 
> 
>     1. Add the line
> 
>     if ( length(z <- commandArgs(TRUE)) ) utils::file.edit(z[1])
> 
>     to the Rprofile.site file; and
> 
>     2. Edit the registry to associate the .R extension with the command
> 
>     C:\Program Files\R\R-4.2.2\bin\x64\Rgui.exe --args "%1"
> 
> 
>     I think we should implement this in R anyway.
> 
>     Best,
>     Uwe Ligges
> 
> 
> 
> 
> 
> 
> 
>     [[alternative HTML version deleted]]
> 
>     ______________________________________________
>     R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>     https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>     PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>     and provide commented, minimal, self-contained, reproducible code.
>


From @@ch@ndh|@| @end|ng |rom bt|nternet@com  Mon Nov  7 15:26:02 2022
From: @@ch@ndh|@| @end|ng |rom bt|nternet@com (Amarjit Chandhial)
Date: Mon, 7 Nov 2022 14:26:02 +0000
Subject: [R] Associate a .R file with the RGui
In-Reply-To: <8633438b-e1e3-5cf9-9e87-8fe197a1bf94@statistik.tu-dortmund.de>
References: <34bacfdd.1275e.1844dbf23cd.Webtop.107@btinternet.com>
 <ff45beb8-bdb2-4b0b-d7a7-2c985c58cb49@statistik.tu-dortmund.de>
 <166d95ad.1a1a4.1844e40fb34.Webtop.84@btinternet.com>
 <8633438b-e1e3-5cf9-9e87-8fe197a1bf94@statistik.tu-dortmund.de>
Message-ID: <5717D41F-2BA5-4D8E-9777-05016FD9B916@btinternet.com>


Hi Uwe,


Many Thanks.


Amarjiit 



> On 7 Nov 2022, at 14:00, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:
> 
> 
> 
>> On 06.11.2022 19:43, Amarjit Chandhial wrote:
>> Hi Uwe,
>> I can do 1.
>> 1. Add the line
>> if ( length(z <- commandArgs(TRUE)) ) utils::file.edit(z[1])
>> to the Rprofile.site file; and
>> My Rprofile.site file is: "C:/PROGRA~1/R/R-42~1.2/etc/Rprofile.site"
>> How do I do 2, step-by-step?
>> 2. Edit the registry to associate the .R extension with the command
>> C:\Program Files\R\R-4.2.2\bin\x64\Rgui.exe --args "%1"
> 
> If you have not .R file association yet, you can add the line above when being asked.
> If you have one, simply change the registry key
> 
> Computer\HKEY_CLASSES_ROOT\R_auto_file\shell\open\command
> 
> There is a standard value as extendable string (REG_EXPAND_SZ) and you simply replace its content by
> 
> "C:\Program Files\R\R-4.2.2\bin\x64\Rgui.exe" --args "%1"
> 
> 
> and in
> 
> Computer\HKEY_CLASSES_ROOT\.R
> 
> there shoudl be a standard string (REG_SZ)
> R_auto_file
> 
> Best,
> Uwe Ligges
> 
> 
> 
> 
> 
>> Amarjit
>>    ------ Original Message ------
>>    From: "Uwe Ligges" <ligges at statistik.tu-dortmund.de>
>>    To: "Amarjit Chandhial" <a.chandhial at btinternet.com>; "David
>>    Winsemius" <dwinsemius at comcast.net>; "Jeff Newmiller"
>>    <jdnewmil at dcn.davis.ca.us>
>>    Cc: "Amarjit Chandhial via R-help" <r-help at r-project.org>
>>    Sent: Sunday, 6 Nov, 2022 At 17:19
>>    Subject: Re: [R] Associate a .R file with the RGui
>>    On 06.11.2022 17:21, Amarjit Chandhial via R-help wrote:
>>                
>>    Hi Uwe,
>>    RGui does have advantages vs. RStudio, and vice-versa.
>>    RStudio is much faster than it used to be.
>>    I currently have .R files associated with RStudio, i.e. in File Explorer
>>    if I double-click on a .R file it opens in the editor in RStudio as an R
>>    script.
>>    In File Explorer if I right-click on a .R file, Open with, I get the
>>    options: R for Windows GUI Front-end or RStudio or Search the Microsoft
>>    Store or choose another app.
>>    If I choose R for Windows GUI Front-end, RGui (64-bit) opens, but no .R
>>    file, in the editor.
>>    If I choose RStudio the .R file opens in the editor in RStudio as an R
>>    script.
>>     From the adaptation, if I choose R for Windows GUI Front-end, will the
>>    .R file open in RGui (64-bit) within the editor?
>>    Yes.
>>                
>>    I have a new Windows PC and maybe, at least for the time being, it's
>>    best for me to have them associated with RStudio.
>>    Although, yes, I agree, it should be naturally implemented in R, having
>>    installed RStudio.
>>    I meant to implement that one can choose the internal editor to open
>>    .R files. File associations can be set by RStudio, too, but that is
>>    not an R(-core) matter.
>>    Best,
>>    Uwe Ligges
>>                
>>    thanks,
>>    Amarjit
>>    ------ Original Message ------
>>    From: "Uwe Ligges" <ligges at statistik.tu-dortmund.de>
>>    To: "David Winsemius" <dwinsemius at comcast.net>; "Amarjit Chandhial"
>>    <a.chandhial at btinternet.com>; "Jeff Newmiller"
>>    <jdnewmil at dcn.davis.ca.us>
>>    Cc: "Amarjit Chandhial via R-help" <r-help at r-project.org>
>>    Sent: Sunday, 6 Nov, 2022 At 15:15
>>    Subject: Re: [R] Associate a .R file with the RGui
>>    On 06.11.2022 01:40, David Winsemius wrote:
>>    On 11/5/22 09:58, Amarjit Chandhial via R-help wrote:
>>    Hi Jeff,
>>    Please see my original question.
>>    You were told that RGui is not an editor.
>>    Are you implying that your initial message contained an implicit
>>    request for instructions on how to get R code in an .R file to be opened
>>    automagically when double-clicked or to have "open in <some editor>"
>>    appear when right-clicked? (I didn't see that clearly expressed.)
>>    If you want something else to happen with a file that has a .R
>>    extension when double-clicked or right-clicked in a GUI file manager,
>>    then you need to configure your OS to do whatever else it is that you
>>    expect. This is not really an R question. It's an OS question. There are
>>    many editors that can also bring up R consoles when the right key combo
>>    is pressed. They do require some study for their specific actions, but
>>    this is not really the place to get guidance on the fine details.
>>    Friends, RGui contains an editor. It allows to send lines / code
>>    blocks to the R concole. We know users who need braille displays use the
>>    RGui internal editor as that apparently cooperates better with braille
>>    displays + R as many other editors.
>>    And as it does not hide half of R by its own functions, I'd pefer that
>>    over some very popular other editors if I had no other choice.
>>    To answer the OP's question, R does not have a built in way to get
>>    this task directly done, but searching the web suggests a rather simple
>>    way (well,m a hack as starting R with other command args may fail now,
>>    but you can extend this and look for a specific naming scheme):
>>    <https://stat.ethz.ch/pipermail/r-help/2007-August/138064.html
>>    <https://stat.ethz.ch/pipermail/r-help/2007-August/138064.html>
>>    <https://stat.ethz.ch/pipermail/r-help/2007-August/138064.html
>>    <https://stat.ethz.ch/pipermail/r-help/2007-August/138064.html>> >
>>    let is adapt this for the recent version of R:
>>    1. Add the line
>>    if ( length(z <- commandArgs(TRUE)) ) utils::file.edit(z[1])
>>    to the Rprofile.site file; and
>>    2. Edit the registry to associate the .R extension with the command
>>    C:\Program Files\R\R-4.2.2\bin\x64\Rgui.exe --args "%1"
>>    I think we should implement this in R anyway.
>>    Best,
>>    Uwe Ligges
>>    [[alternative HTML version deleted]]
>>    ______________________________________________
>>    R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>    https://stat.ethz.ch/mailman/listinfo/r-help
>>    <https://stat.ethz.ch/mailman/listinfo/r-help>
>>    PLEASE do read the posting guide
>>    http://www.R-project.org/posting-guide.html
>>    <http://www.R-project.org/posting-guide.html>
>>    and provide commented, minimal, self-contained, reproducible code.


From @k@h@y_e4 @end|ng |rom hotm@||@com  Mon Nov  7 18:17:30 2022
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Mon, 7 Nov 2022 17:17:30 +0000
Subject: [R] print and lapply....
Message-ID: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

Dear members,
                             I have the following code and output:

> TP <- 1:4
> lapply(TP,function(x){print(x);x^2})
[1] 1
[1] 2
[1] 3
[1] 4
[[1]]
[1] 1

[[2]]
[1] 4

[[3]]
[1] 9

[[4]]
[1] 16

How do I make the print function output x along with x^2, i.e not at the beginning but before each of x^2?

Many thanks in advance....

THanking you,
Yours sincerely
AKSHAY M KULKARNI

	[[alternative HTML version deleted]]


From @kw@|mmo @end|ng |rom gm@||@com  Mon Nov  7 18:20:35 2022
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Mon, 7 Nov 2022 12:20:35 -0500
Subject: [R] print and lapply....
In-Reply-To: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
Message-ID: <CAPcHnpRxP9O1_EF81-9-+J+OOTePty3peRXgUVvW=_YYcXrstQ@mail.gmail.com>

put print() around x^2

On Mon, Nov 7, 2022, 12:18 akshay kulkarni <akshay_e4 at hotmail.com> wrote:

> Dear members,
>                              I have the following code and output:
>
> > TP <- 1:4
> > lapply(TP,function(x){print(x);x^2})
> [1] 1
> [1] 2
> [1] 3
> [1] 4
> [[1]]
> [1] 1
>
> [[2]]
> [1] 4
>
> [[3]]
> [1] 9
>
> [[4]]
> [1] 16
>
> How do I make the print function output x along with x^2, i.e not at the
> beginning but before each of x^2?
>
> Many thanks in advance....
>
> THanking you,
> Yours sincerely
> AKSHAY M KULKARNI
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From tebert @end|ng |rom u||@edu  Mon Nov  7 18:37:33 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Mon, 7 Nov 2022 17:37:33 +0000
Subject: [R] print and lapply....
In-Reply-To: <CAPcHnpRxP9O1_EF81-9-+J+OOTePty3peRXgUVvW=_YYcXrstQ@mail.gmail.com>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <CAPcHnpRxP9O1_EF81-9-+J+OOTePty3peRXgUVvW=_YYcXrstQ@mail.gmail.com>
Message-ID: <BN6PR2201MB1553EC96BC36708A4480A7E9CF3C9@BN6PR2201MB1553.namprd22.prod.outlook.com>

Another option is use paste() within print()

lapply(TP,function(x){print(paste("x= ",x, " x^2 = ", x^2))})


Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Andrew Simmons
Sent: Monday, November 7, 2022 12:21 PM
To: akshay kulkarni <akshay_e4 at hotmail.com>
Cc: R help Mailing list <r-help at r-project.org>
Subject: Re: [R] print and lapply....

[External Email]

put print() around x^2

On Mon, Nov 7, 2022, 12:18 akshay kulkarni <akshay_e4 at hotmail.com> wrote:

> Dear members,
>                              I have the following code and output:
>
> > TP <- 1:4
> > lapply(TP,function(x){print(x);x^2})
> [1] 1
> [1] 2
> [1] 3
> [1] 4
> [[1]]
> [1] 1
>
> [[2]]
> [1] 4
>
> [[3]]
> [1] 9
>
> [[4]]
> [1] 16
>
> How do I make the print function output x along with x^2, i.e not at 
> the beginning but before each of x^2?
>
> Many thanks in advance....
>
> THanking you,
> Yours sincerely
> AKSHAY M KULKARNI
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat
> .ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl
> .edu%7C28ae59febb2d43ce03b108dac0e46e79%7C0d4da0f84a314d76ace60a62331e
> 1b84%7C0%7C0%7C638034384601744085%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4w
> LjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C
> &amp;sdata=1D8FQ07q2NcYL8PaJW84PqdUAte3pZJy8XJuJXENbJ4%3D&amp;reserved
> =0
> PLEASE do read the posting guide
> https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r
> -project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%
> 7C28ae59febb2d43ce03b108dac0e46e79%7C0d4da0f84a314d76ace60a62331e1b84%
> 7C0%7C0%7C638034384601744085%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwM
> DAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;
> sdata=aEeZJ8FHVKGX%2BqOJaKskC1onjqKcON2Ux5cj3MimTGw%3D&amp;reserved=0
> and provide commented, minimal, self-contained, reproducible code.
>

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7C28ae59febb2d43ce03b108dac0e46e79%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638034384601744085%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=1D8FQ07q2NcYL8PaJW84PqdUAte3pZJy8XJuJXENbJ4%3D&amp;reserved=0
PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7C28ae59febb2d43ce03b108dac0e46e79%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638034384601744085%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=aEeZJ8FHVKGX%2BqOJaKskC1onjqKcON2Ux5cj3MimTGw%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.


From @k@h@y_e4 @end|ng |rom hotm@||@com  Mon Nov  7 18:38:12 2022
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Mon, 7 Nov 2022 17:38:12 +0000
Subject: [R] print and lapply....
In-Reply-To: <CAPcHnpRxP9O1_EF81-9-+J+OOTePty3peRXgUVvW=_YYcXrstQ@mail.gmail.com>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <CAPcHnpRxP9O1_EF81-9-+J+OOTePty3peRXgUVvW=_YYcXrstQ@mail.gmail.com>
Message-ID: <PU4P216MB156851AA3E94D3486008ACC1C83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

Dear Andrew
                         It doesn't work:

> lapply(TP,function(x){print(x^2)})
[1] 1
[1] 4
[1] 9
[1] 16
[[1]]
[1] 1

[[2]]
[1] 4

[[3]]
[1] 9

[[4]]
[1] 16

Basically, lapply() is implemented by a for loop. So there must be some way right?

tHanking you,
Yours sincerely,
AKSHAY M KULKARNI
________________________________
From: Andrew Simmons <akwsimmo at gmail.com>
Sent: Monday, November 7, 2022 10:50 PM
To: akshay kulkarni <akshay_e4 at hotmail.com>
Cc: R help Mailing list <r-help at r-project.org>
Subject: Re: [R] print and lapply....

put print() around x^2

On Mon, Nov 7, 2022, 12:18 akshay kulkarni <akshay_e4 at hotmail.com<mailto:akshay_e4 at hotmail.com>> wrote:
Dear members,
                             I have the following code and output:

> TP <- 1:4
> lapply(TP,function(x){print(x);x^2})
[1] 1
[1] 2
[1] 3
[1] 4
[[1]]
[1] 1

[[2]]
[1] 4

[[3]]
[1] 9

[[4]]
[1] 16

How do I make the print function output x along with x^2, i.e not at the beginning but before each of x^2?

Many thanks in advance....

THanking you,
Yours sincerely
AKSHAY M KULKARNI

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Mon Nov  7 18:46:05 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 7 Nov 2022 09:46:05 -0800
Subject: [R] print and lapply....
In-Reply-To: <CAPcHnpRxP9O1_EF81-9-+J+OOTePty3peRXgUVvW=_YYcXrstQ@mail.gmail.com>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <CAPcHnpRxP9O1_EF81-9-+J+OOTePty3peRXgUVvW=_YYcXrstQ@mail.gmail.com>
Message-ID: <CAGxFJbSyM8XmQ+8s7mQRChMgJj6+qJO+OD==ML8No8yCA8SjaA@mail.gmail.com>

Well... yes, of course. But assuming the sole purpose is to print the
results and not to save them for further processing, the OP's approach
seems rather painful. My preference would be to vectorize:

> print(cbind(TP, TPsq =TP^2), print.gap = 3)
       TP   TPsq
[1,]    1      1
[2,]    2      4
[3,]    3      9
[4,]    4     16

See ?print.default for details

-- Bert


On Mon, Nov 7, 2022 at 9:20 AM Andrew Simmons <akwsimmo at gmail.com> wrote:
>
> put print() around x^2
>
> On Mon, Nov 7, 2022, 12:18 akshay kulkarni <akshay_e4 at hotmail.com> wrote:
>
> > Dear members,
> >                              I have the following code and output:
> >
> > > TP <- 1:4
> > > lapply(TP,function(x){print(x);x^2})
> > [1] 1
> > [1] 2
> > [1] 3
> > [1] 4
> > [[1]]
> > [1] 1
> >
> > [[2]]
> > [1] 4
> >
> > [[3]]
> > [1] 9
> >
> > [[4]]
> > [1] 16
> >
> > How do I make the print function output x along with x^2, i.e not at the
> > beginning but before each of x^2?
> >
> > Many thanks in advance....
> >
> > THanking you,
> > Yours sincerely
> > AKSHAY M KULKARNI
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @k@h@y_e4 @end|ng |rom hotm@||@com  Mon Nov  7 18:49:14 2022
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Mon, 7 Nov 2022 17:49:14 +0000
Subject: [R] print and lapply....
In-Reply-To: <BN6PR2201MB1553EC96BC36708A4480A7E9CF3C9@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <CAPcHnpRxP9O1_EF81-9-+J+OOTePty3peRXgUVvW=_YYcXrstQ@mail.gmail.com>
 <BN6PR2201MB1553EC96BC36708A4480A7E9CF3C9@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <PU4P216MB15688E0E68644C2515587FF3C83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

Dear Tim,
                   Actually, I am replacing a big for loop by the lapply() function, and report the progress:

lapply(TP, function(i) { BODY; print(i)})

Can you please adjust your solution in this light?

THanking you,
Yours sincerely,
AKSHAY M KULKARNI
________________________________
From: Ebert,Timothy Aaron <tebert at ufl.edu>
Sent: Monday, November 7, 2022 11:07 PM
To: Andrew Simmons <akwsimmo at gmail.com>; akshay kulkarni <akshay_e4 at hotmail.com>
Cc: R help Mailing list <r-help at r-project.org>
Subject: RE: [R] print and lapply....

Another option is use paste() within print()

lapply(TP,function(x){print(paste("x= ",x, " x^2 = ", x^2))})


Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Andrew Simmons
Sent: Monday, November 7, 2022 12:21 PM
To: akshay kulkarni <akshay_e4 at hotmail.com>
Cc: R help Mailing list <r-help at r-project.org>
Subject: Re: [R] print and lapply....

[External Email]

put print() around x^2

On Mon, Nov 7, 2022, 12:18 akshay kulkarni <akshay_e4 at hotmail.com> wrote:

> Dear members,
>                              I have the following code and output:
>
> > TP <- 1:4
> > lapply(TP,function(x){print(x);x^2})
> [1] 1
> [1] 2
> [1] 3
> [1] 4
> [[1]]
> [1] 1
>
> [[2]]
> [1] 4
>
> [[3]]
> [1] 9
>
> [[4]]
> [1] 16
>
> How do I make the print function output x along with x^2, i.e not at
> the beginning but before each of x^2?
>
> Many thanks in advance....
>
> THanking you,
> Yours sincerely
> AKSHAY M KULKARNI
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat
> .ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl
> .edu%7C28ae59febb2d43ce03b108dac0e46e79%7C0d4da0f84a314d76ace60a62331e
> 1b84%7C0%7C0%7C638034384601744085%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4w
> LjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C
> &amp;sdata=1D8FQ07q2NcYL8PaJW84PqdUAte3pZJy8XJuJXENbJ4%3D&amp;reserved
> =0
> PLEASE do read the posting guide
> https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r
> -project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%
> 7C28ae59febb2d43ce03b108dac0e46e79%7C0d4da0f84a314d76ace60a62331e1b84%
> 7C0%7C0%7C638034384601744085%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwM
> DAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;
> sdata=aEeZJ8FHVKGX%2BqOJaKskC1onjqKcON2Ux5cj3MimTGw%3D&amp;reserved=0
> and provide commented, minimal, self-contained, reproducible code.
>

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7C28ae59febb2d43ce03b108dac0e46e79%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638034384601744085%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=1D8FQ07q2NcYL8PaJW84PqdUAte3pZJy8XJuJXENbJ4%3D&amp;reserved=0
PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7C28ae59febb2d43ce03b108dac0e46e79%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638034384601744085%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=aEeZJ8FHVKGX%2BqOJaKskC1onjqKcON2Ux5cj3MimTGw%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From @kw@|mmo @end|ng |rom gm@||@com  Mon Nov  7 18:57:46 2022
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Mon, 7 Nov 2022 12:57:46 -0500
Subject: [R] print and lapply....
In-Reply-To: <PU4P216MB156851AA3E94D3486008ACC1C83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <CAPcHnpRxP9O1_EF81-9-+J+OOTePty3peRXgUVvW=_YYcXrstQ@mail.gmail.com>
 <PU4P216MB156851AA3E94D3486008ACC1C83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
Message-ID: <CAPcHnpTb3PQt+y7mm+71w9oUeB9C9TOB_VHO7EFpdg_H+Rbf2w@mail.gmail.com>

I meant something like:

TP <- 1:4
lapply(TP, function(x) {
    print(x)
    print(x^2)
})

You may wish to add cat("\n") after print(x^2) so that your results
from each iteration are separated.
You may also wish to add invisible() around lapply() if you're not
saving / / using the return list in any way.

On Mon, Nov 7, 2022 at 12:38 PM akshay kulkarni <akshay_e4 at hotmail.com> wrote:
>
> Dear Andrew
>                          It doesn't work:
>
> > lapply(TP,function(x){print(x^2)})
> [1] 1
> [1] 4
> [1] 9
> [1] 16
> [[1]]
> [1] 1
>
> [[2]]
> [1] 4
>
> [[3]]
> [1] 9
>
> [[4]]
> [1] 16
>
> Basically, lapply() is implemented by a for loop. So there must be some way right?
>
> tHanking you,
> Yours sincerely,
> AKSHAY M KULKARNI
> ________________________________
> From: Andrew Simmons <akwsimmo at gmail.com>
> Sent: Monday, November 7, 2022 10:50 PM
> To: akshay kulkarni <akshay_e4 at hotmail.com>
> Cc: R help Mailing list <r-help at r-project.org>
> Subject: Re: [R] print and lapply....
>
> put print() around x^2
>
> On Mon, Nov 7, 2022, 12:18 akshay kulkarni <akshay_e4 at hotmail.com> wrote:
>
> Dear members,
>                              I have the following code and output:
>
> > TP <- 1:4
> > lapply(TP,function(x){print(x);x^2})
> [1] 1
> [1] 2
> [1] 3
> [1] 4
> [[1]]
> [1] 1
>
> [[2]]
> [1] 4
>
> [[3]]
> [1] 9
>
> [[4]]
> [1] 16
>
> How do I make the print function output x along with x^2, i.e not at the beginning but before each of x^2?
>
> Many thanks in advance....
>
> THanking you,
> Yours sincerely
> AKSHAY M KULKARNI
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @k@h@y_e4 @end|ng |rom hotm@||@com  Mon Nov  7 19:10:10 2022
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Mon, 7 Nov 2022 18:10:10 +0000
Subject: [R] print and lapply....
In-Reply-To: <CAGxFJbSyM8XmQ+8s7mQRChMgJj6+qJO+OD==ML8No8yCA8SjaA@mail.gmail.com>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <CAPcHnpRxP9O1_EF81-9-+J+OOTePty3peRXgUVvW=_YYcXrstQ@mail.gmail.com>
 <CAGxFJbSyM8XmQ+8s7mQRChMgJj6+qJO+OD==ML8No8yCA8SjaA@mail.gmail.com>
Message-ID: <PU4P216MB15688AD15B43427708CE42AEC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

Dear Bert,
                   Actually, I am replacing a big for loop by the lapply() function, and report the progress:

lapply(TP, function(i) { BODY; print(i)})

Can you please adjust your solution in this light?

THanking you,
Yours sincerely,
AKSHAY M KULKARNI
________________________________
From: Bert Gunter <bgunter.4567 at gmail.com>
Sent: Monday, November 7, 2022 11:16 PM
To: Andrew Simmons <akwsimmo at gmail.com>
Cc: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
Subject: Re: [R] print and lapply....

Well... yes, of course. But assuming the sole purpose is to print the
results and not to save them for further processing, the OP's approach
seems rather painful. My preference would be to vectorize:

> print(cbind(TP, TPsq =TP^2), print.gap = 3)
       TP   TPsq
[1,]    1      1
[2,]    2      4
[3,]    3      9
[4,]    4     16

See ?print.default for details

-- Bert


On Mon, Nov 7, 2022 at 9:20 AM Andrew Simmons <akwsimmo at gmail.com> wrote:
>
> put print() around x^2
>
> On Mon, Nov 7, 2022, 12:18 akshay kulkarni <akshay_e4 at hotmail.com> wrote:
>
> > Dear members,
> >                              I have the following code and output:
> >
> > > TP <- 1:4
> > > lapply(TP,function(x){print(x);x^2})
> > [1] 1
> > [1] 2
> > [1] 3
> > [1] 4
> > [[1]]
> > [1] 1
> >
> > [[2]]
> > [1] 4
> >
> > [[3]]
> > [1] 9
> >
> > [[4]]
> > [1] 16
> >
> > How do I make the print function output x along with x^2, i.e not at the
> > beginning but before each of x^2?
> >
> > Many thanks in advance....
> >
> > THanking you,
> > Yours sincerely
> > AKSHAY M KULKARNI
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Nov  7 19:29:37 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 7 Nov 2022 18:29:37 +0000
Subject: [R] print and lapply....
In-Reply-To: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
Message-ID: <85d70330-d644-9ad6-1c6f-e6ef21c4cd7f@sapo.pt>

?s 17:17 de 07/11/2022, akshay kulkarni escreveu:
> Dear members,
>                               I have the following code and output:
> 
>> TP <- 1:4
>> lapply(TP,function(x){print(x);x^2})
> [1] 1
> [1] 2
> [1] 3
> [1] 4
> [[1]]
> [1] 1
> 
> [[2]]
> [1] 4
> 
> [[3]]
> [1] 9
> 
> [[4]]
> [1] 16
> 
> How do I make the print function output x along with x^2, i.e not at the beginning but before each of x^2?
> 
> Many thanks in advance....
> 
> THanking you,
> Yours sincerely
> AKSHAY M KULKARNI
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Here are two options, with ?cat and with ?message.


TP <- 1:4
lapply(TP, function(x){
   cat("x =", x, "x^2 =", x^2, "\n")
})

lapply(TP, function(x){
   msg <- paste("x =", x, "x^2 =", x^2)
   message(msg)
})


Hope this helps,

Rui Barradas


From @k@h@y_e4 @end|ng |rom hotm@||@com  Mon Nov  7 19:33:39 2022
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Mon, 7 Nov 2022 18:33:39 +0000
Subject: [R] print and lapply....
In-Reply-To: <85d70330-d644-9ad6-1c6f-e6ef21c4cd7f@sapo.pt>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <85d70330-d644-9ad6-1c6f-e6ef21c4cd7f@sapo.pt>
Message-ID: <PU4P216MB1568124CE102CB3A02D058F1C83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

Dear Rui,
                   Actually, I am replacing a big for loop by the lapply() function, and report the progress:

lapply(TP, function(i) { BODY; print(i)})

Can you please adjust your solution in this light?

THanking you,
Yours sincerely,
AKSHAY M KULKARNI
________________________________
From: Rui Barradas <ruipbarradas at sapo.pt>
Sent: Monday, November 7, 2022 11:59 PM
To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
Subject: Re: [R] print and lapply....

?s 17:17 de 07/11/2022, akshay kulkarni escreveu:
> Dear members,
>                               I have the following code and output:
>
>> TP <- 1:4
>> lapply(TP,function(x){print(x);x^2})
> [1] 1
> [1] 2
> [1] 3
> [1] 4
> [[1]]
> [1] 1
>
> [[2]]
> [1] 4
>
> [[3]]
> [1] 9
>
> [[4]]
> [1] 16
>
> How do I make the print function output x along with x^2, i.e not at the beginning but before each of x^2?
>
> Many thanks in advance....
>
> THanking you,
> Yours sincerely
> AKSHAY M KULKARNI
>
>        [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Here are two options, with ?cat and with ?message.


TP <- 1:4
lapply(TP, function(x){
   cat("x =", x, "x^2 =", x^2, "\n")
})

lapply(TP, function(x){
   msg <- paste("x =", x, "x^2 =", x^2)
   message(msg)
})


Hope this helps,

Rui Barradas



	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Nov  7 19:54:32 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 7 Nov 2022 18:54:32 +0000
Subject: [R] print and lapply....
In-Reply-To: <PU4P216MB1568124CE102CB3A02D058F1C83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <85d70330-d644-9ad6-1c6f-e6ef21c4cd7f@sapo.pt>
 <PU4P216MB1568124CE102CB3A02D058F1C83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
Message-ID: <28f820bf-feef-b45f-a2e2-400374efe20f@sapo.pt>

?s 18:33 de 07/11/2022, akshay kulkarni escreveu:
> Dear Rui,
>                     Actually, I am replacing a big for loop by the lapply() function, and report the progress:
> 
> lapply(TP, function(i) { BODY; print(i)})
> 
> Can you please adjust your solution in this light?
> 
> THanking you,
> Yours sincerely,
> AKSHAY M KULKARNI
> ________________________________
> From: Rui Barradas <ruipbarradas at sapo.pt>
> Sent: Monday, November 7, 2022 11:59 PM
> To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
> Subject: Re: [R] print and lapply....
> 
> ?s 17:17 de 07/11/2022, akshay kulkarni escreveu:
>> Dear members,
>>                                I have the following code and output:
>>
>>> TP <- 1:4
>>> lapply(TP,function(x){print(x);x^2})
>> [1] 1
>> [1] 2
>> [1] 3
>> [1] 4
>> [[1]]
>> [1] 1
>>
>> [[2]]
>> [1] 4
>>
>> [[3]]
>> [1] 9
>>
>> [[4]]
>> [1] 16
>>
>> How do I make the print function output x along with x^2, i.e not at the beginning but before each of x^2?
>>
>> Many thanks in advance....
>>
>> THanking you,
>> Yours sincerely
>> AKSHAY M KULKARNI
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> Hello,
> 
> Here are two options, with ?cat and with ?message.
> 
> 
> TP <- 1:4
> lapply(TP, function(x){
>     cat("x =", x, "x^2 =", x^2, "\n")
> })
> 
> lapply(TP, function(x){
>     msg <- paste("x =", x, "x^2 =", x^2)
>     message(msg)
> })
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> 
> 
Hello,


What do you want the lapply loop to return? If you have a BODY doing 
computations, do you want the lapply to return those values and report 
the progress?

I have chosen cat or message over print because

  - cat returns invisible(NULL),
  - message returns invisible()
  - print returns a value, what it prints.

Can you adapt the code below to your use case?



TP <- 1:4
lapply(TP, function(x, verbose = TRUE){
   # BODY
   y <- rnorm(100, mean = x)

   # show progress
   if(verbose)
     cat("x =", x, "x^2 =", x^2, "\n")

   #return value
   c(x = x, mean = mean(y))
})

lapply(TP, function(x, verbose = TRUE){
   # BODY
   y <- rnorm(100, mean = x)

   # show progress
   if(verbose) {
     msg <- paste("x =", x, "x^2 =", x^2)
     message(msg)
   }

   #return value
   c(x = x, mean = mean(y))
})



Hope this helps,

Rui Barradas


From @k@h@y_e4 @end|ng |rom hotm@||@com  Mon Nov  7 20:22:21 2022
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Mon, 7 Nov 2022 19:22:21 +0000
Subject: [R] print and lapply....
In-Reply-To: <28f820bf-feef-b45f-a2e2-400374efe20f@sapo.pt>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <85d70330-d644-9ad6-1c6f-e6ef21c4cd7f@sapo.pt>
 <PU4P216MB1568124CE102CB3A02D058F1C83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <28f820bf-feef-b45f-a2e2-400374efe20f@sapo.pt>
Message-ID: <PU4P216MB1568284562B6403E256F76DDC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

Dear Rui,
                 THanks for your reply...The point is the loop is a scraping code, and in your examples you have assumed that the body acts on i, the loop variable. Can you adapt your code to JUST PRINT the loop variable i ?

By the by, I think I have stumbled upon the answer: The lapply() caches the result, and prints the output of the function in question  immediately after printing the final i. The i's get printed serially, as the function progresses....

> lapply(1:4,function(x){print(x);Sys.sleep(x^2);x^2})
[1] 1
[1] 2
[1] 3
[1] 4
[[1]]
[1] 1

[[2]]
[1] 4

[[3]]
[1] 9

[[4]]
[1] 16

Here x^2 's print only after 4 is printed on the console....

tHanks anyways for your reply....

THanking you,
Yours sincerely,
AKSHAY M KULKARNI
________________________________
From: Rui Barradas <ruipbarradas at sapo.pt>
Sent: Tuesday, November 8, 2022 12:24 AM
To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
Subject: Re: [R] print and lapply....

?s 18:33 de 07/11/2022, akshay kulkarni escreveu:
> Dear Rui,
>                     Actually, I am replacing a big for loop by the lapply() function, and report the progress:
>
> lapply(TP, function(i) { BODY; print(i)})
>
> Can you please adjust your solution in this light?
>
> THanking you,
> Yours sincerely,
> AKSHAY M KULKARNI
> ________________________________
> From: Rui Barradas <ruipbarradas at sapo.pt>
> Sent: Monday, November 7, 2022 11:59 PM
> To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
> Subject: Re: [R] print and lapply....
>
> ?s 17:17 de 07/11/2022, akshay kulkarni escreveu:
>> Dear members,
>>                                I have the following code and output:
>>
>>> TP <- 1:4
>>> lapply(TP,function(x){print(x);x^2})
>> [1] 1
>> [1] 2
>> [1] 3
>> [1] 4
>> [[1]]
>> [1] 1
>>
>> [[2]]
>> [1] 4
>>
>> [[3]]
>> [1] 9
>>
>> [[4]]
>> [1] 16
>>
>> How do I make the print function output x along with x^2, i.e not at the beginning but before each of x^2?
>>
>> Many thanks in advance....
>>
>> THanking you,
>> Yours sincerely
>> AKSHAY M KULKARNI
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> Hello,
>
> Here are two options, with ?cat and with ?message.
>
>
> TP <- 1:4
> lapply(TP, function(x){
>     cat("x =", x, "x^2 =", x^2, "\n")
> })
>
> lapply(TP, function(x){
>     msg <- paste("x =", x, "x^2 =", x^2)
>     message(msg)
> })
>
>
> Hope this helps,
>
> Rui Barradas
>
>
>
Hello,


What do you want the lapply loop to return? If you have a BODY doing
computations, do you want the lapply to return those values and report
the progress?

I have chosen cat or message over print because

  - cat returns invisible(NULL),
  - message returns invisible()
  - print returns a value, what it prints.

Can you adapt the code below to your use case?



TP <- 1:4
lapply(TP, function(x, verbose = TRUE){
   # BODY
   y <- rnorm(100, mean = x)

   # show progress
   if(verbose)
     cat("x =", x, "x^2 =", x^2, "\n")

   #return value
   c(x = x, mean = mean(y))
})

lapply(TP, function(x, verbose = TRUE){
   # BODY
   y <- rnorm(100, mean = x)

   # show progress
   if(verbose) {
     msg <- paste("x =", x, "x^2 =", x^2)
     message(msg)
   }

   #return value
   c(x = x, mean = mean(y))
})



Hope this helps,

Rui Barradas


	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Mon Nov  7 21:45:30 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 7 Nov 2022 12:45:30 -0800
Subject: [R] print and lapply....
In-Reply-To: <PU4P216MB1568284562B6403E256F76DDC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <85d70330-d644-9ad6-1c6f-e6ef21c4cd7f@sapo.pt>
 <PU4P216MB1568124CE102CB3A02D058F1C83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <28f820bf-feef-b45f-a2e2-400374efe20f@sapo.pt>
 <PU4P216MB1568284562B6403E256F76DDC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
Message-ID: <CAGxFJbTF4KDzQq3PQBXhpLx87gWszVPy6Wta6XK1XdOwriWcHA@mail.gmail.com>

" The lapply() caches the result, and prints the output of the
function in question  immediately after printing the final i. "

I don't believe you understand how lists or lapply works. You seem to
be trying to intuit from empirical behavior. Bad idea, if so. You need
to read the docs or spend time with suitable tutorials.

Consider:
lapply produces a **list,** each component of which is the result of
applying a function, FUN, to the components of its first argument
(here 1:4), which is itself a list. Results are **not** cached in the
sense you seem to think they are. The list object that is produced by
the function is **only** printed if you ask it to be (via cat, print,
or whatever) or, by default, if the result is unassigned. The default
printing can be turned off via the invisible() function.

So:

> res <- lapply(TP, function(x){
+    print(x)
+    x^2}
+    )
[1] 1
[1] 2
[1] 3
[1] 4
[1] 5
## Nothing printed, but the results are the components of **list**
res, which can be printed on the console by print(res) or simply:

> res ## note the list syntax below
[[1]]
[1] 1

[[2]]
[1] 4

[[3]]
[1] 9

[[4]]
[1] 16

[[5]]
[1] 25

Now can you explain what happens here:

> invisible(lapply(TP, function(x){
+    print(x)
+    x^2}
+    ))
[1] 1
[1] 2
[1] 3
[1] 4
[1] 5
> ## results not printed; nothing assigned. Where can you find them? (See below)

or here:

> lapply(TP, function(x){
+    print(x)
+    x^2}
+    )
[1] 1
[1] 2
[1] 3
[1] 4
[1] 5
[[1]]
[1] 1

[[2]]
[1] 4

[[3]]
[1] 9

[[4]]
[1] 16

[[5]]
[1] 25

## How could you recover the results of the lapply and not just look
at the console printout if the results have not been assigned?
## Hint:  See ?.Last.value

-- Bert

On Mon, Nov 7, 2022 at 11:22 AM akshay kulkarni <akshay_e4 at hotmail.com> wrote:
>
> Dear Rui,
>                  THanks for your reply...The point is the loop is a scraping code, and in your examples you have assumed that the body acts on i, the loop variable. Can you adapt your code to JUST PRINT the loop variable i ?
>
> By the by, I think I have stumbled upon the answer: The lapply() caches the result, and prints the output of the function in question  immediately after printing the final i. The i's get printed serially, as the function progresses....
>
> > lapply(1:4,function(x){print(x);Sys.sleep(x^2);x^2})
> [1] 1
> [1] 2
> [1] 3
> [1] 4
> [[1]]
> [1] 1
>
> [[2]]
> [1] 4
>
> [[3]]
> [1] 9
>
> [[4]]
> [1] 16
>
> Here x^2 's print only after 4 is printed on the console....
>
> tHanks anyways for your reply....
>
> THanking you,
> Yours sincerely,
> AKSHAY M KULKARNI
> ________________________________
> From: Rui Barradas <ruipbarradas at sapo.pt>
> Sent: Tuesday, November 8, 2022 12:24 AM
> To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
> Subject: Re: [R] print and lapply....
>
> ?s 18:33 de 07/11/2022, akshay kulkarni escreveu:
> > Dear Rui,
> >                     Actually, I am replacing a big for loop by the lapply() function, and report the progress:
> >
> > lapply(TP, function(i) { BODY; print(i)})
> >
> > Can you please adjust your solution in this light?
> >
> > THanking you,
> > Yours sincerely,
> > AKSHAY M KULKARNI
> > ________________________________
> > From: Rui Barradas <ruipbarradas at sapo.pt>
> > Sent: Monday, November 7, 2022 11:59 PM
> > To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
> > Subject: Re: [R] print and lapply....
> >
> > ?s 17:17 de 07/11/2022, akshay kulkarni escreveu:
> >> Dear members,
> >>                                I have the following code and output:
> >>
> >>> TP <- 1:4
> >>> lapply(TP,function(x){print(x);x^2})
> >> [1] 1
> >> [1] 2
> >> [1] 3
> >> [1] 4
> >> [[1]]
> >> [1] 1
> >>
> >> [[2]]
> >> [1] 4
> >>
> >> [[3]]
> >> [1] 9
> >>
> >> [[4]]
> >> [1] 16
> >>
> >> How do I make the print function output x along with x^2, i.e not at the beginning but before each of x^2?
> >>
> >> Many thanks in advance....
> >>
> >> THanking you,
> >> Yours sincerely
> >> AKSHAY M KULKARNI
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> > Hello,
> >
> > Here are two options, with ?cat and with ?message.
> >
> >
> > TP <- 1:4
> > lapply(TP, function(x){
> >     cat("x =", x, "x^2 =", x^2, "\n")
> > })
> >
> > lapply(TP, function(x){
> >     msg <- paste("x =", x, "x^2 =", x^2)
> >     message(msg)
> > })
> >
> >
> > Hope this helps,
> >
> > Rui Barradas
> >
> >
> >
> Hello,
>
>
> What do you want the lapply loop to return? If you have a BODY doing
> computations, do you want the lapply to return those values and report
> the progress?
>
> I have chosen cat or message over print because
>
>   - cat returns invisible(NULL),
>   - message returns invisible()
>   - print returns a value, what it prints.
>
> Can you adapt the code below to your use case?
>
>
>
> TP <- 1:4
> lapply(TP, function(x, verbose = TRUE){
>    # BODY
>    y <- rnorm(100, mean = x)
>
>    # show progress
>    if(verbose)
>      cat("x =", x, "x^2 =", x^2, "\n")
>
>    #return value
>    c(x = x, mean = mean(y))
> })
>
> lapply(TP, function(x, verbose = TRUE){
>    # BODY
>    y <- rnorm(100, mean = x)
>
>    # show progress
>    if(verbose) {
>      msg <- paste("x =", x, "x^2 =", x^2)
>      message(msg)
>    }
>
>    #return value
>    c(x = x, mean = mean(y))
> })
>
>
>
> Hope this helps,
>
> Rui Barradas
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From tebert @end|ng |rom u||@edu  Mon Nov  7 21:45:42 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Mon, 7 Nov 2022 20:45:42 +0000
Subject: [R] print and lapply....
In-Reply-To: <PU4P216MB15688AD15B43427708CE42AEC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <CAPcHnpRxP9O1_EF81-9-+J+OOTePty3peRXgUVvW=_YYcXrstQ@mail.gmail.com>
 <CAGxFJbSyM8XmQ+8s7mQRChMgJj6+qJO+OD==ML8No8yCA8SjaA@mail.gmail.com>
 <PU4P216MB15688AD15B43427708CE42AEC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
Message-ID: <BN6PR2201MB155366AA16C4F596735677B8CF3C9@BN6PR2201MB1553.namprd22.prod.outlook.com>

Dear Akshay,
    I think we have provided several solutions to the question asked. Can you please adjust your question to more closely align with what you need. It would be nice if you can provide sufficient detail so that we can see how you have adapted our solutions and how these have not quite addressed this problem. 

Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of akshay kulkarni
Sent: Monday, November 7, 2022 1:10 PM
To: Bert Gunter <bgunter.4567 at gmail.com>; Andrew Simmons <akwsimmo at gmail.com>
Cc: R help Mailing list <r-help at r-project.org>
Subject: Re: [R] print and lapply....

[External Email]

Dear Bert,
                   Actually, I am replacing a big for loop by the lapply() function, and report the progress:

lapply(TP, function(i) { BODY; print(i)})

Can you please adjust your solution in this light?

THanking you,
Yours sincerely,
AKSHAY M KULKARNI
________________________________
From: Bert Gunter <bgunter.4567 at gmail.com>
Sent: Monday, November 7, 2022 11:16 PM
To: Andrew Simmons <akwsimmo at gmail.com>
Cc: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
Subject: Re: [R] print and lapply....

Well... yes, of course. But assuming the sole purpose is to print the results and not to save them for further processing, the OP's approach seems rather painful. My preference would be to vectorize:

> print(cbind(TP, TPsq =TP^2), print.gap = 3)
       TP   TPsq
[1,]    1      1
[2,]    2      4
[3,]    3      9
[4,]    4     16

See ?print.default for details

-- Bert


On Mon, Nov 7, 2022 at 9:20 AM Andrew Simmons <akwsimmo at gmail.com> wrote:
>
> put print() around x^2
>
> On Mon, Nov 7, 2022, 12:18 akshay kulkarni <akshay_e4 at hotmail.com> wrote:
>
> > Dear members,
> >                              I have the following code and output:
> >
> > > TP <- 1:4
> > > lapply(TP,function(x){print(x);x^2})
> > [1] 1
> > [1] 2
> > [1] 3
> > [1] 4
> > [[1]]
> > [1] 1
> >
> > [[2]]
> > [1] 4
> >
> > [[3]]
> > [1] 9
> >
> > [[4]]
> > [1] 16
> >
> > How do I make the print function output x along with x^2, i.e not at 
> > the beginning but before each of x^2?
> >
> > Many thanks in advance....
> >
> > THanking you,
> > Yours sincerely
> > AKSHAY M KULKARNI
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fst
> > at.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%4
> > 0ufl.edu%7Cb726a89349ed4860265708dac0eb5d0a%7C0d4da0f84a314d76ace60a
> > 62331e1b84%7C0%7C0%7C638034414365456384%7CUnknown%7CTWFpbGZsb3d8eyJW
> > IjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C300
> > 0%7C%7C%7C&amp;sdata=dQk1JPxWI4D0D6%2FSoC8LWw56749ulaFrGQc6affgBeM%3
> > D&amp;reserved=0
> > PLEASE do read the posting guide
> > https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww
> > .r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.
> > edu%7Cb726a89349ed4860265708dac0eb5d0a%7C0d4da0f84a314d76ace60a62331
> > e1b84%7C0%7C0%7C638034414365456384%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiM
> > C4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%
> > 7C%7C&amp;sdata=KDskHBxmxe0DV9XO7GvkESemUNTq2w%2BT%2Fro%2Bgb4DS2w%3D
> > &amp;reserved=0 and provide commented, minimal, self-contained, 
> > reproducible code.
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat
> .ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl
> .edu%7Cb726a89349ed4860265708dac0eb5d0a%7C0d4da0f84a314d76ace60a62331e
> 1b84%7C0%7C0%7C638034414365456384%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4w
> LjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C
> &amp;sdata=dQk1JPxWI4D0D6%2FSoC8LWw56749ulaFrGQc6affgBeM%3D&amp;reserv
> ed=0 PLEASE do read the posting guide 
> https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r
> -project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%
> 7Cb726a89349ed4860265708dac0eb5d0a%7C0d4da0f84a314d76ace60a62331e1b84%
> 7C0%7C0%7C638034414365612626%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwM
> DAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;
> sdata=OxZmpA4ORbfUq0gqM8ebZvK5bQTaiCwo0Y1ekn%2F3zBE%3D&amp;reserved=0
> and provide commented, minimal, self-contained, reproducible code.

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7Cb726a89349ed4860265708dac0eb5d0a%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638034414365612626%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=OCyLwP3YBC3kfih9kaX6vEbPdzvAq1a48LeDRyqlYd0%3D&amp;reserved=0
PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7Cb726a89349ed4860265708dac0eb5d0a%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638034414365612626%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=OxZmpA4ORbfUq0gqM8ebZvK5bQTaiCwo0Y1ekn%2F3zBE%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Nov  7 21:50:03 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 7 Nov 2022 20:50:03 +0000
Subject: [R] print and lapply....
In-Reply-To: <PU4P216MB1568284562B6403E256F76DDC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <85d70330-d644-9ad6-1c6f-e6ef21c4cd7f@sapo.pt>
 <PU4P216MB1568124CE102CB3A02D058F1C83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <28f820bf-feef-b45f-a2e2-400374efe20f@sapo.pt>
 <PU4P216MB1568284562B6403E256F76DDC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
Message-ID: <77cc1472-cb84-e953-f978-ebecaca7c4a9@sapo.pt>

?s 19:22 de 07/11/2022, akshay kulkarni escreveu:
> Dear Rui,
>                   THanks for your reply...The point is the loop is a scraping code, and in your examples you have assumed that the body acts on i, the loop variable. Can you adapt your code to JUST PRINT the loop variable i ?
> 
> By the by, I think I have stumbled upon the answer: The lapply() caches the result, and prints the output of the function in question  immediately after printing the final i. The i's get printed serially, as the function progresses....
> 
>> lapply(1:4,function(x){print(x);Sys.sleep(x^2);x^2})
> [1] 1
> [1] 2
> [1] 3
> [1] 4
> [[1]]
> [1] 1
> 
> [[2]]
> [1] 4
> 
> [[3]]
> [1] 9
> 
> [[4]]
> [1] 16
> 
> Here x^2 's print only after 4 is printed on the console....
> 
> tHanks anyways for your reply....
> 
> THanking you,
> Yours sincerely,
> AKSHAY M KULKARNI
> ________________________________
> From: Rui Barradas <ruipbarradas at sapo.pt>
> Sent: Tuesday, November 8, 2022 12:24 AM
> To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
> Subject: Re: [R] print and lapply....
> 
> ?s 18:33 de 07/11/2022, akshay kulkarni escreveu:
>> Dear Rui,
>>                      Actually, I am replacing a big for loop by the lapply() function, and report the progress:
>>
>> lapply(TP, function(i) { BODY; print(i)})
>>
>> Can you please adjust your solution in this light?
>>
>> THanking you,
>> Yours sincerely,
>> AKSHAY M KULKARNI
>> ________________________________
>> From: Rui Barradas <ruipbarradas at sapo.pt>
>> Sent: Monday, November 7, 2022 11:59 PM
>> To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
>> Subject: Re: [R] print and lapply....
>>
>> ?s 17:17 de 07/11/2022, akshay kulkarni escreveu:
>>> Dear members,
>>>                                 I have the following code and output:
>>>
>>>> TP <- 1:4
>>>> lapply(TP,function(x){print(x);x^2})
>>> [1] 1
>>> [1] 2
>>> [1] 3
>>> [1] 4
>>> [[1]]
>>> [1] 1
>>>
>>> [[2]]
>>> [1] 4
>>>
>>> [[3]]
>>> [1] 9
>>>
>>> [[4]]
>>> [1] 16
>>>
>>> How do I make the print function output x along with x^2, i.e not at the beginning but before each of x^2?
>>>
>>> Many thanks in advance....
>>>
>>> THanking you,
>>> Yours sincerely
>>> AKSHAY M KULKARNI
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>> Hello,
>>
>> Here are two options, with ?cat and with ?message.
>>
>>
>> TP <- 1:4
>> lapply(TP, function(x){
>>      cat("x =", x, "x^2 =", x^2, "\n")
>> })
>>
>> lapply(TP, function(x){
>>      msg <- paste("x =", x, "x^2 =", x^2)
>>      message(msg)
>> })
>>
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>>
>>
> Hello,
> 
> 
> What do you want the lapply loop to return? If you have a BODY doing
> computations, do you want the lapply to return those values and report
> the progress?
> 
> I have chosen cat or message over print because
> 
>    - cat returns invisible(NULL),
>    - message returns invisible()
>    - print returns a value, what it prints.
> 
> Can you adapt the code below to your use case?
> 
> 
> 
> TP <- 1:4
> lapply(TP, function(x, verbose = TRUE){
>     # BODY
>     y <- rnorm(100, mean = x)
> 
>     # show progress
>     if(verbose)
>       cat("x =", x, "x^2 =", x^2, "\n")
> 
>     #return value
>     c(x = x, mean = mean(y))
> })
> 
> lapply(TP, function(x, verbose = TRUE){
>     # BODY
>     y <- rnorm(100, mean = x)
> 
>     # show progress
>     if(verbose) {
>       msg <- paste("x =", x, "x^2 =", x^2)
>       message(msg)
>     }
> 
>     #return value
>     c(x = x, mean = mean(y))
> })
> 
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> 
Hello,

No, the x^2 are not printed after the i's. The x^2 are the function's 
return values. The function prints the i's, then returns x^2.

As for your problem, it is now more clerar.
I would write a function accepting a url to take care of scraping and 
call it in the lapply loop. The progress report can be in the loop, like 
below.

This is a complete working example, scraping the Wikipedia list of 
countries by GDP. The urls are in a list (it's always the same, I'm not 
complicating things) and in a real scraping function I would wrap 
tryCatch around it, just in case.

First the function, then the urls list, then the lapply loop.



library(rvest)

scrape <- function(url) {
   page <- read_html(url)
   gdp <- page |>
     html_element(".wikitable") |>
     html_table() |>
     as.data.frame()
   names(gdp) <- unlist(gdp[1,, drop = TRUE])
   gdp <- gdp[-1,]
   row.names(gdp) <- NULL

   #return value
   gdp
}

wiki_gdp_url <- 
"https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)"
urls_list <- list(wiki_gdp_url, wiki_gdp_url)
TP <- seq_along(urls_list)

TP
# [1] 1 2

df_list <- lapply(TP, \(i) {
   URL <- urls_list[[i]]
   data <- scrape(URL)
   # show progress
   message("iteration: ", i)
   #return value
   data
})

str(df_list)


Hope this helps,

Rui Barradas


From er|cjberger @end|ng |rom gm@||@com  Tue Nov  8 07:52:10 2022
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Tue, 8 Nov 2022 08:52:10 +0200
Subject: [R] [External] Re: Selecting a minimum value of an attribute
 associated with point values neighboring a given point and assigning it as
 a new attribute
In-Reply-To: <3247be10-6d5c-12d5-1634-2a9e934f431e@gmail.com>
References: <BN6PR05MB35887EFE01222DBF7C359AAB903B9@BN6PR05MB3588.namprd05.prod.outlook.com>
 <CAGxFJbSkg9zAqk0dGcr3qJe2z2C04NEZFdHN8hWQA3oSbfHukQ@mail.gmail.com>
 <CAGgJW767Ein1S+MSywb57B2UtmE0EJodDVokPEx5_-c5BTFR1Q@mail.gmail.com>
 <CAGgJW77yY0_GDQWEAxzSdRh0N3kXgj9zrSEYUzuVsFnHyeE=aA@mail.gmail.com>
 <BN6PR05MB3588015F46997E64D5F8F138903D9@BN6PR05MB3588.namprd05.prod.outlook.com>
 <3247be10-6d5c-12d5-1634-2a9e934f431e@gmail.com>
Message-ID: <CAGgJW76LXFdbQFuqE1b-HCrQKNn08DB7voOGzN0cnkromYK0NQ@mail.gmail.com>

## Some further comments and approaches, divided into 3 sections
##
## Section 1: Micha's modified code
## Section 2: Eric's modified code:
##    a) uses Micha's dist_matrix from dnearneigh instead of the f() function
##    b) add check that it gets the same solution as Micha's modified code
## Section 3: Solution explicitly using a graph (via package igraph)

## ###########################################################

## Section 1: Micha's modified code
##
## Major change: OP wanted the Min Conc value
##               to include the Conc of the point itself
## Minor Changes: no need to write/read csv file;
##                change MAX_DIST to 50 for fewer neighbors

library(sf)
library(spdep)

## Prepare fictitious data
## Create a data.frame with n random points
set.seed(234) ## for reproducibility
N <- 1000L

LON <- runif(N, -70.0, -69.0)
LAT <- runif(N, 42.0, 43.0)
Conc <- runif(N, 90000, 100000)
df <- data.frame(LON, LAT, Conc)

## Create a distance matrix for all points,
## which contains indices to those points within
## a certain buffer distance, just as you did in your example.

MAX_DIST <- 50
pts <- st_as_sf(df, coords=c('LON', 'LAT'), crs=4326)
dist_matrix <- dnearneigh(pts, 0, MAX_DIST, use_s2=TRUE)

cat("Average number of neighbors within cutoff = ",
    mean(unlist(lapply(dist_matrix,length))),"\n")

## Function to get minimum Conc values for one row of distance matrix
MinConc <- function(x, lst, pts) {
    ## x is an index to a single point,
    ## lst is a list of point indices from distance matrix
    ## that are within the buffer distance
    Concs <- lapply(lst, function(p) {
        pts$Conc[p]
    })
    ## return(min(c(Concs[[1]])) - ## original code - forgets to
include the point itself
    return(min(c(Concs[[1]], pts$Conc[x]))) ## modified code
}

## Now apply this function to all points in pts
Conc_min <- lapply(1:N, function(i) {
  MinConc(i, dist_matrix[i], pts)
})

Conc_min <- data.frame("Conc_min" = as.numeric(Conc_min))

# Add back as new attrib to original points sf object
pts_with_min <- do.call(cbind, c(pts, Conc_min))

## ###########################################################

## Section 2: Eric's modified code:

A <- matrix(0,N,N)
z <- sapply(1:N, \(i) A[i, dist_matrix[[i]]] <<- 1) ## z is ignored
B <- A + diag(N)
C <- diag(Conc)
D <- B %*% C
D[D==0] <- NA
Conc_min.eric <- apply(D,MAR=1,\(v) min(v,na.rm=TRUE) )
test <- identical(Conc_min$Conc_min, Conc_min.eric)
cat("test = ", test, "\n")

## ###########################################################

## Section 3: Solution explicitly using a graph (via package igraph)

## For those with some familiarity with graphs, the matrix 'B' is
## an adjacency matrix. This suggests using graphs explicitly to solve
## the problem. Here is how to rewrite my code using graphs.

library(igraph)
g <- graph_from_adjacency_matrix(B,"undirected")
g <- set_vertex_attr(g, "Conc", 1:N, Conc )

Conc_min.igraph <- sapply(1:N, \(i) min(vertex_attr(g,"Conc",neighbors(g,i))))
test.igraph <- identical(Conc_min$Conc_min, Conc_min.igraph)
cat("test.igraph = ", test.igraph, "\n")

Eric

On Mon, Nov 7, 2022 at 3:11 PM Micha Silver <tsvibar at gmail.com> wrote:
>
> Eric's solution notwithstanding, here's a more "spatial" approach.
>
>
> I first create a fictitious set of 1000 points (and save to CSV to
> replicate your workflow)
>
> library(sf)
> library(spdep)
>
> # Prepare fictitious data
> # Create a data.frame with 1000 random points, and save to CSV
> LON <- runif(1000, -70.0, -69.0)
> LAT <- runif(1000, 42.0, 43.0)
> Conc <- runif(1000, 90000, 100000)
> df <- data.frame(LON, LAT, Conc)
> csv_file = "/tmp/pts_testdata.csv"
> write.csv(df, csv_file)
>
>
> Now read that CSV back in directly as an sf object (No need for the old
> SpatialPointsDataFrame). THen create a distance matrix for all points,
> which contains indicies to those points within a certain buffer
> distance, just as you did in your example.
>
>
> # Read back in as sf object, including row index
> pts <- st_as_sf(read.csv(csv_file), coords=c('LON', 'LAT'), crs=4326)
> dist_matrix <- dnearneigh(pts, 0, 100, use_s2=TRUE) # use_s2 since these
> are lon/lat
>
> Now I prepare a function to get the minimum Conv value among all points
> within the buffer distance to a given single point:
> # Function to get minimum Conc values for one row of distance matrix
> MinConc <- function(x, lst, pts) {
>    # x is an index to a single point,
>    # lst is a list of point indices from distance matrix
>    # that are within the buffer distance
>    Concs <- lapply(lst, function(p) {
>      pts$Conc[p]
>    })
>    return(min(Concs[[1]]))
> }
>
> Next run that function on all points to get a list of minimum Conv
> values for all points, and merge back to pts.
>
>
> # Now apply this function to all points in pts
> Conc_min <- lapply(pts$X, function(i){
>    MinConc(i, dist_matrix[i], pts)
> })
> Conc_min <- data.frame("Conc_min" = as.integer(Conc_min))
>
> # Add back as new attrib to original points sf object
> pts_with_min <- do.call(cbind, c(pts, Conc_min))
>
> HTH,
>
> Micha
>
>
>
> On 06/11/2022 18:40, Duhl, Tiffany R. wrote:
> > Thanks so much Eric!
> >
> >   I'm going to play around with your toy code (pun intended) & see if I can make it work for my application.
> >
> > Cheers,
> > -Tiffany
> > ________________________________
> > From: Eric Berger <ericjberger at gmail.com>
> > Sent: Sunday, November 6, 2022 10:27 AM
> > To: Bert Gunter <bgunter.4567 at gmail.com>
> > Cc: Duhl, Tiffany R. <Tiffany.Duhl at tufts.edu>; R-help <R-help at r-project.org>
> > Subject: [External] Re: [R] Selecting a minimum value of an attribute associated with point values neighboring a given point and assigning it as a new attribute
> >
> > Whoops ... left out a line in Part 2. Resending with the correction
> >
> > ## PART 2: You can use this code on the real data with f() defined appropriately
> > A <- matrix(0,N,N)
> > v <- 1:N
> > ## get the indices (j,k) where j < k (as columns in a data.frame)
> > idx <- expand.grid(v,v) |> rename(j=Var1,k=Var2) |> filter(j < k)
> > u <- sapply(1:nrow(idx),
> >             \(i){ j <- idx$j[i]; k <- idx$k[i]; A[j,k] <<- f(j,k,myData) })
> > B <- A + t(A) + diag(N)
> > C <- diag(myData$Conc)
> > D <- B %*% C
> > D[D==0] <- NA
> > myData$Conc_min <- apply(D,MAR=1,\(v){min(v,na.rm=TRUE)})
> > print(head(myData))
> >
> > On Sun, Nov 6, 2022 at 5:19 PM Eric Berger <ericjberger at gmail.com> wrote:
> >> Hi Tiffany,
> >> Here is some code that might help with your problem. I solve a "toy"
> >> problem that is conceptually the same.
> >> Part 1 sets up my toy problem. You would have to replace Part 1 with
> >> your real case. The main point is to define
> >> a function f(i, j, data) which returns 0 or 1 depending on whether the
> >> observations in rows i and j in your dataset 'data'
> >> are within your cutoff distance (i.e. 50m).
> >>
> >> You can then use Part 2 almost without changes (except for changing
> >> 'myData' to the correct name of your data).
> >>
> >> I hope this helps,
> >> Eric
> >>
> >> library(dplyr)
> >>
> >> ## PART 1: create fake data for minimal example
> >> set.seed(123) ## for reproducibility
> >> N <- 5       ## replace by number of locations (approx 9000 in your case)
> >> MAX_DISTANCE <- 2  ## 50 in your case
> >> myData <- data.frame(x=rnorm(N),y=rnorm(N),Conc=sample(1:N,N))
> >>
> >> ## The function which you must re-define for your actual case.
> >> f <- function(i,j,a) {
> >>   dist <- sqrt(sum((a[i,1:2] - a[j,1:2])^2)) ## Euclidean distance
> >>   as.integer(dist < MAX_DISTANCE)
> >> }
> >>
> >> ## PART 2: You can use this code on the real data with f() defined appropriately
> >> A <- matrix(0,N,N)
> >> ## get the indices (j,k) where j < k (as columns in a data.frame)
> >> idx <- expand.grid(v,v) |> rename(j=Var1,k=Var2) |> filter(j < k)
> >> u <- sapply(1:nrow(idx),\(i){ j <- idx$j[i]; k <- idx$k[i]; A[j,k] <<-
> >> f(j,k,myData) })
> >> B <- A + t(A) + diag(N)
> >> C <- diag(myData$Conc)
> >> D <- B %*% C
> >> D[D==0] <- NA
> >> myData$Conc_min <- apply(D,MAR=1,\(v){min(v,na.rm=TRUE)})
> >> print(head(myData))
> >>
> >>
> >> On Sat, Nov 5, 2022 at 5:14 PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >>> Probably better posted on R-sig-geo.
> >>>
> >>> -- Bert
> >>>
> >>> On Sat, Nov 5, 2022 at 12:36 AM Duhl, Tiffany R. <Tiffany.Duhl at tufts.edu>
> >>> wrote:
> >>>
> >>>> Hello,
> >>>>
> >>>> I have sets of spatial points with LAT, LON coords (unprojected, WGS84
> >>>> datum) and several value attributes associated with each point, from
> >>>> numerous csv files (with an average of 6,000-9,000 points in each file) as
> >>>> shown in the following example:
> >>>>
> >>>> data<- read.csv("R_find_pts_testdata.csv")
> >>>>
> >>>>> data
> >>>>      ID      Date         Time        LAT            LON           Conc
> >>>> Leg.Speed    CO2  H2O BC61 Hr Min Sec
> >>>> 1   76 4/19/2021 21:25:38 42.40066 -70.98802 99300   0.0 mph 428.39 9.57
> >>>> 578 21  25  38
> >>>> 2   77 4/19/2021 21:25:39 42.40066 -70.98802 96730   0.0 mph 428.04 9.57
> >>>> 617 21  25  39
> >>>> 3   79 4/19/2021 21:25:41 42.40066 -70.98802 98800   0.2 mph 427.10 9.57
> >>>> 1027 21  25  41
> >>>> 4   80 4/19/2021 21:25:42 42.40066 -70.98802 96510     2 mph 427.99 9.58
> >>>> 1381 21  25  42
> >>>> 5   81 4/19/2021 21:25:43 42.40067 -70.98801 95540     3 mph 427.99 9.58
> >>>> 1271 21  25  43
> >>>> 6   82 4/19/2021 21:25:44 42.40068 -70.98799 94720     4 mph 427.20 9.57
> >>>> 910 21  25  44
> >>>> 7   83 4/19/2021 21:25:45 42.40069 -70.98797 94040     5 mph 427.18 9.57
> >>>> 652 21  25  45
> >>>> 8   84 4/19/2021 21:25:46 42.40072 -70.98795 95710     7 mph 427.07 9.57
> >>>> 943 21  25  46
> >>>> 9   85 4/19/2021 21:25:47 42.40074 -70.98792 96200     8 mph 427.44 9.56
> >>>> 650 21  25  47
> >>>> 10  86 4/19/2021 21:25:48 42.40078 -70.98789 93750    10 mph 428.76 9.57
> >>>> 761 21  25  48
> >>>> 11  87 4/19/2021 21:25:49 42.40081 -70.98785 93360    11 mph 429.25 9.56
> >>>> 1158 21  25  49
> >>>> 12  88 4/19/2021 21:25:50 42.40084 -70.98781 94340    12 mph 429.56 9.57
> >>>> 107 21  25  50
> >>>> 13  89 4/19/2021 21:25:51 42.40087 -70.98775 92780    12 mph 428.62 9.56
> >>>> 720 21  25  51
> >>>>
> >>>>
> >>>> What I want to do is, for each point, identify all points within 50m of
> >>>> that point, find the minimum value of the "Conc" attribute of each nearby
> >>>> set of points (including the original point) and then create a new variable
> >>>> ("Conc_min") and assign this minimum value to a new variable added to
> >>>> "data".
> >>>>
> >>>> So far, I have the following code:
> >>>>
> >>>> library(spdep)
> >>>> library(sf)
> >>>>
> >>>> setwd("C:\\mydirectory\\")
> >>>> data<- read.csv("R_find_pts_testdata.csv")
> >>>>
> >>>> #make sure the data is a data frame
> >>>> pts <- data.frame(data)
> >>>>
> >>>> #create spatial data frame and define projection
> >>>> pts_coords <- cbind(pts$LON, pts$LAT)
> >>>> data_pts <- SpatialPointsDataFrame(coords= pts_coords,
> >>>> data=pts, proj4string = CRS("+proj=longlat +datum=WGS84"))
> >>>>
> >>>> #Re-project to WGS 84 / UTM zone 18N, so the analysis is in units of m
> >>>> ptsUTM  <- sf::st_as_sf(data_pts, coords = c("LAT", "LON"), remove = F)%>%
> >>>> st_transform(32618)
> >>>>
> >>>> #create 50 m buffer around each point then intersect with points and
> >>>> finally find neighbors within the buffers
> >>>> pts_buf <- sf::st_buffer(ptsUTM, 50)
> >>>> coords  <- sf::st_coordinates(ptsUTM)
> >>>> int <- sf::st_intersects(pts_buf, ptsUTM)
> >>>> x   <- spdep::dnearneigh(coords, 0, 50)
> >>>>
> >>>> Now at this point, I'm not sure what to either the "int" (a sgbp list) or
> >>>> "x" (nb object) objects (or even if I need them both)
> >>>>
> >>>>> int
> >>>> Sparse geometry binary predicate list of length 974, where the predicate
> >>>> was `intersects'
> >>>> first 10 elements:
> >>>>   1: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>   2: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>   3: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>   4: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>   5: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>   6: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>   7: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>   8: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>   9: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>
> >>>>> x
> >>>> Neighbour list object:
> >>>> Number of regions: 974
> >>>> Number of nonzero links: 34802
> >>>> Percentage nonzero weights: 3.668481
> >>>> Average number of links: 35.73101
> >>>>
> >>>> One thought is that maybe I don't need the dnearneigh function and can
> >>>> instead convert "int" into a dataframe and somehow merge or associate
> >>>> (perhaps with an inner join) the ID fields of the buffered and intersecting
> >>>> points and then compute the minimum value of "Conc" grouping by ID:
> >>>>
> >>>>> as.data.frame(int)
> >>>>      row.id col.id
> >>>> 1        1      1
> >>>> 2        1      2
> >>>> 3        1      3
> >>>> 4        1      4
> >>>> 5        1      5
> >>>> 6        1      6
> >>>> 7        1      7
> >>>> 8        1      8
> >>>> 9        1      9
> >>>> 10       1     10
> >>>> 11       1     11
> >>>> 12       1     12
> >>>> 13       1     13
> >>>> 14       1     14
> >>>> 15       1     15
> >>>> 16       1     16
> >>>> 17       1     17
> >>>> 18       1     18
> >>>> 19       2      1
> >>>> 20       2      2
> >>>> 21       2      3
> >>>> 22       2      4
> >>>> 23       2      5
> >>>> 24       2      6
> >>>> 25       2      7
> >>>> 26       2      8
> >>>> 27       2      9
> >>>> 28       2     10
> >>>>
> >>>>
> >>>> So in the above example I'd like to take the minimum of "Conc" among the
> >>>> col.id points grouped with row.id 1 (i.e., col.ids 1-18) and assign the
> >>>> minimum value of this group as a new variable in data (Data$Conc_min), and
> >>>> do the same for row.id 2 and all the rest of the rows.
> >>>>
> >>>> I'm just not sure how to do this and I appreciate any help folks might
> >>>> have on this matter!
> >>>>
> >>>> Many thanks,
> >>>> -Tiffany
> >>>>
> >>>>          [[alternative HTML version deleted]]
> >>>>
> >>>> ______________________________________________
> >>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>>> PLEASE do read the posting guide
> >>>> http://www.R-project.org/posting-guide.html
> >>>> and provide commented, minimal, self-contained, reproducible code.
> >>>>
> >>>          [[alternative HTML version deleted]]
> >>>
> >>> ______________________________________________
> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >>> and provide commented, minimal, self-contained, reproducible code.
> > Caution: This message originated from outside of the Tufts University organization. Please exercise caution when clicking links or opening attachments. When in doubt, email the TTS Service Desk at it at tufts.edu<mailto:it at tufts.edu> or call them directly at 617-627-3376.
> >
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> --
> Micha Silver
> Ben Gurion Univ.
> Sde Boker, Remote Sensing Lab
> cell: +972-523-665918
>


From @k@h@y_e4 @end|ng |rom hotm@||@com  Tue Nov  8 15:44:31 2022
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Tue, 8 Nov 2022 14:44:31 +0000
Subject: [R] print and lapply....
In-Reply-To: <CAGxFJbTF4KDzQq3PQBXhpLx87gWszVPy6Wta6XK1XdOwriWcHA@mail.gmail.com>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <85d70330-d644-9ad6-1c6f-e6ef21c4cd7f@sapo.pt>
 <PU4P216MB1568124CE102CB3A02D058F1C83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <28f820bf-feef-b45f-a2e2-400374efe20f@sapo.pt>
 <PU4P216MB1568284562B6403E256F76DDC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <CAGxFJbTF4KDzQq3PQBXhpLx87gWszVPy6Wta6XK1XdOwriWcHA@mail.gmail.com>
Message-ID: <PU4P216MB1568C694EEABC190FB8A3B06C83F9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

Dear Bert,
                     Amazing! Very informative...THanks a lot.
________________________________
From: Bert Gunter <bgunter.4567 at gmail.com>
Sent: Tuesday, November 8, 2022 2:15 AM
To: akshay kulkarni <akshay_e4 at hotmail.com>
Cc: Rui Barradas <ruipbarradas at sapo.pt>; R help Mailing list <r-help at r-project.org>
Subject: Re: [R] print and lapply....

" The lapply() caches the result, and prints the output of the
function in question  immediately after printing the final i. "

I don't believe you understand how lists or lapply works. You seem to
be trying to intuit from empirical behavior. Bad idea, if so. You need
to read the docs or spend time with suitable tutorials.

Consider:
lapply produces a **list,** each component of which is the result of
applying a function, FUN, to the components of its first argument
(here 1:4), which is itself a list. Results are **not** cached in the
sense you seem to think they are. The list object that is produced by
the function is **only** printed if you ask it to be (via cat, print,
or whatever) or, by default, if the result is unassigned. The default
printing can be turned off via the invisible() function.

So:

> res <- lapply(TP, function(x){
+    print(x)
+    x^2}
+    )
[1] 1
[1] 2
[1] 3
[1] 4
[1] 5
## Nothing printed, but the results are the components of **list**
res, which can be printed on the console by print(res) or simply:

> res ## note the list syntax below
[[1]]
[1] 1

[[2]]
[1] 4

[[3]]
[1] 9

[[4]]
[1] 16

[[5]]
[1] 25

Now can you explain what happens here:

> invisible(lapply(TP, function(x){
+    print(x)
+    x^2}
+    ))
[1] 1
[1] 2
[1] 3
[1] 4
[1] 5
> ## results not printed; nothing assigned. Where can you find them? (See below)

or here:

> lapply(TP, function(x){
+    print(x)
+    x^2}
+    )
[1] 1
[1] 2
[1] 3
[1] 4
[1] 5
[[1]]
[1] 1

[[2]]
[1] 4

[[3]]
[1] 9

[[4]]
[1] 16

[[5]]
[1] 25

## How could you recover the results of the lapply and not just look
at the console printout if the results have not been assigned?
## Hint:  See ?.Last.value

-- Bert

On Mon, Nov 7, 2022 at 11:22 AM akshay kulkarni <akshay_e4 at hotmail.com> wrote:
>
> Dear Rui,
>                  THanks for your reply...The point is the loop is a scraping code, and in your examples you have assumed that the body acts on i, the loop variable. Can you adapt your code to JUST PRINT the loop variable i ?
>
> By the by, I think I have stumbled upon the answer: The lapply() caches the result, and prints the output of the function in question  immediately after printing the final i. The i's get printed serially, as the function progresses....
>
> > lapply(1:4,function(x){print(x);Sys.sleep(x^2);x^2})
> [1] 1
> [1] 2
> [1] 3
> [1] 4
> [[1]]
> [1] 1
>
> [[2]]
> [1] 4
>
> [[3]]
> [1] 9
>
> [[4]]
> [1] 16
>
> Here x^2 's print only after 4 is printed on the console....
>
> tHanks anyways for your reply....
>
> THanking you,
> Yours sincerely,
> AKSHAY M KULKARNI
> ________________________________
> From: Rui Barradas <ruipbarradas at sapo.pt>
> Sent: Tuesday, November 8, 2022 12:24 AM
> To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
> Subject: Re: [R] print and lapply....
>
> ?s 18:33 de 07/11/2022, akshay kulkarni escreveu:
> > Dear Rui,
> >                     Actually, I am replacing a big for loop by the lapply() function, and report the progress:
> >
> > lapply(TP, function(i) { BODY; print(i)})
> >
> > Can you please adjust your solution in this light?
> >
> > THanking you,
> > Yours sincerely,
> > AKSHAY M KULKARNI
> > ________________________________
> > From: Rui Barradas <ruipbarradas at sapo.pt>
> > Sent: Monday, November 7, 2022 11:59 PM
> > To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
> > Subject: Re: [R] print and lapply....
> >
> > ?s 17:17 de 07/11/2022, akshay kulkarni escreveu:
> >> Dear members,
> >>                                I have the following code and output:
> >>
> >>> TP <- 1:4
> >>> lapply(TP,function(x){print(x);x^2})
> >> [1] 1
> >> [1] 2
> >> [1] 3
> >> [1] 4
> >> [[1]]
> >> [1] 1
> >>
> >> [[2]]
> >> [1] 4
> >>
> >> [[3]]
> >> [1] 9
> >>
> >> [[4]]
> >> [1] 16
> >>
> >> How do I make the print function output x along with x^2, i.e not at the beginning but before each of x^2?
> >>
> >> Many thanks in advance....
> >>
> >> THanking you,
> >> Yours sincerely
> >> AKSHAY M KULKARNI
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> > Hello,
> >
> > Here are two options, with ?cat and with ?message.
> >
> >
> > TP <- 1:4
> > lapply(TP, function(x){
> >     cat("x =", x, "x^2 =", x^2, "\n")
> > })
> >
> > lapply(TP, function(x){
> >     msg <- paste("x =", x, "x^2 =", x^2)
> >     message(msg)
> > })
> >
> >
> > Hope this helps,
> >
> > Rui Barradas
> >
> >
> >
> Hello,
>
>
> What do you want the lapply loop to return? If you have a BODY doing
> computations, do you want the lapply to return those values and report
> the progress?
>
> I have chosen cat or message over print because
>
>   - cat returns invisible(NULL),
>   - message returns invisible()
>   - print returns a value, what it prints.
>
> Can you adapt the code below to your use case?
>
>
>
> TP <- 1:4
> lapply(TP, function(x, verbose = TRUE){
>    # BODY
>    y <- rnorm(100, mean = x)
>
>    # show progress
>    if(verbose)
>      cat("x =", x, "x^2 =", x^2, "\n")
>
>    #return value
>    c(x = x, mean = mean(y))
> })
>
> lapply(TP, function(x, verbose = TRUE){
>    # BODY
>    y <- rnorm(100, mean = x)
>
>    # show progress
>    if(verbose) {
>      msg <- paste("x =", x, "x^2 =", x^2)
>      message(msg)
>    }
>
>    #return value
>    c(x = x, mean = mean(y))
> })
>
>
>
> Hope this helps,
>
> Rui Barradas
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From @k@h@y_e4 @end|ng |rom hotm@||@com  Tue Nov  8 15:47:21 2022
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Tue, 8 Nov 2022 14:47:21 +0000
Subject: [R] print and lapply....
In-Reply-To: <77cc1472-cb84-e953-f978-ebecaca7c4a9@sapo.pt>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <85d70330-d644-9ad6-1c6f-e6ef21c4cd7f@sapo.pt>
 <PU4P216MB1568124CE102CB3A02D058F1C83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <28f820bf-feef-b45f-a2e2-400374efe20f@sapo.pt>
 <PU4P216MB1568284562B6403E256F76DDC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <77cc1472-cb84-e953-f978-ebecaca7c4a9@sapo.pt>
Message-ID: <PU4P216MB1568B071D6953887BFF56AB5C83F9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

Dear Rui,
                  The replies from you, Bert, Tim and solved my problem. My last question: what if I put print inside the body of the function passed on to lapply, instead of separately in the function argument of apply? Is this what you insinuated in your reply?

THanking you,
yours sincerely,
AKSHAY M KULKARNI
________________________________
From: Rui Barradas <ruipbarradas at sapo.pt>
Sent: Tuesday, November 8, 2022 2:20 AM
To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
Subject: Re: [R] print and lapply....

?s 19:22 de 07/11/2022, akshay kulkarni escreveu:
> Dear Rui,
>                   THanks for your reply...The point is the loop is a scraping code, and in your examples you have assumed that the body acts on i, the loop variable. Can you adapt your code to JUST PRINT the loop variable i ?
>
> By the by, I think I have stumbled upon the answer: The lapply() caches the result, and prints the output of the function in question  immediately after printing the final i. The i's get printed serially, as the function progresses....
>
>> lapply(1:4,function(x){print(x);Sys.sleep(x^2);x^2})
> [1] 1
> [1] 2
> [1] 3
> [1] 4
> [[1]]
> [1] 1
>
> [[2]]
> [1] 4
>
> [[3]]
> [1] 9
>
> [[4]]
> [1] 16
>
> Here x^2 's print only after 4 is printed on the console....
>
> tHanks anyways for your reply....
>
> THanking you,
> Yours sincerely,
> AKSHAY M KULKARNI
> ________________________________
> From: Rui Barradas <ruipbarradas at sapo.pt>
> Sent: Tuesday, November 8, 2022 12:24 AM
> To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
> Subject: Re: [R] print and lapply....
>
> ?s 18:33 de 07/11/2022, akshay kulkarni escreveu:
>> Dear Rui,
>>                      Actually, I am replacing a big for loop by the lapply() function, and report the progress:
>>
>> lapply(TP, function(i) { BODY; print(i)})
>>
>> Can you please adjust your solution in this light?
>>
>> THanking you,
>> Yours sincerely,
>> AKSHAY M KULKARNI
>> ________________________________
>> From: Rui Barradas <ruipbarradas at sapo.pt>
>> Sent: Monday, November 7, 2022 11:59 PM
>> To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
>> Subject: Re: [R] print and lapply....
>>
>> ?s 17:17 de 07/11/2022, akshay kulkarni escreveu:
>>> Dear members,
>>>                                 I have the following code and output:
>>>
>>>> TP <- 1:4
>>>> lapply(TP,function(x){print(x);x^2})
>>> [1] 1
>>> [1] 2
>>> [1] 3
>>> [1] 4
>>> [[1]]
>>> [1] 1
>>>
>>> [[2]]
>>> [1] 4
>>>
>>> [[3]]
>>> [1] 9
>>>
>>> [[4]]
>>> [1] 16
>>>
>>> How do I make the print function output x along with x^2, i.e not at the beginning but before each of x^2?
>>>
>>> Many thanks in advance....
>>>
>>> THanking you,
>>> Yours sincerely
>>> AKSHAY M KULKARNI
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>> Hello,
>>
>> Here are two options, with ?cat and with ?message.
>>
>>
>> TP <- 1:4
>> lapply(TP, function(x){
>>      cat("x =", x, "x^2 =", x^2, "\n")
>> })
>>
>> lapply(TP, function(x){
>>      msg <- paste("x =", x, "x^2 =", x^2)
>>      message(msg)
>> })
>>
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>>
>>
> Hello,
>
>
> What do you want the lapply loop to return? If you have a BODY doing
> computations, do you want the lapply to return those values and report
> the progress?
>
> I have chosen cat or message over print because
>
>    - cat returns invisible(NULL),
>    - message returns invisible()
>    - print returns a value, what it prints.
>
> Can you adapt the code below to your use case?
>
>
>
> TP <- 1:4
> lapply(TP, function(x, verbose = TRUE){
>     # BODY
>     y <- rnorm(100, mean = x)
>
>     # show progress
>     if(verbose)
>       cat("x =", x, "x^2 =", x^2, "\n")
>
>     #return value
>     c(x = x, mean = mean(y))
> })
>
> lapply(TP, function(x, verbose = TRUE){
>     # BODY
>     y <- rnorm(100, mean = x)
>
>     # show progress
>     if(verbose) {
>       msg <- paste("x =", x, "x^2 =", x^2)
>       message(msg)
>     }
>
>     #return value
>     c(x = x, mean = mean(y))
> })
>
>
>
> Hope this helps,
>
> Rui Barradas
>
>
Hello,

No, the x^2 are not printed after the i's. The x^2 are the function's
return values. The function prints the i's, then returns x^2.

As for your problem, it is now more clerar.
I would write a function accepting a url to take care of scraping and
call it in the lapply loop. The progress report can be in the loop, like
below.

This is a complete working example, scraping the Wikipedia list of
countries by GDP. The urls are in a list (it's always the same, I'm not
complicating things) and in a real scraping function I would wrap
tryCatch around it, just in case.

First the function, then the urls list, then the lapply loop.



library(rvest)

scrape <- function(url) {
   page <- read_html(url)
   gdp <- page |>
     html_element(".wikitable") |>
     html_table() |>
     as.data.frame()
   names(gdp) <- unlist(gdp[1,, drop = TRUE])
   gdp <- gdp[-1,]
   row.names(gdp) <- NULL

   #return value
   gdp
}

wiki_gdp_url <-
"https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)"
urls_list <- list(wiki_gdp_url, wiki_gdp_url)
TP <- seq_along(urls_list)

TP
# [1] 1 2

df_list <- lapply(TP, \(i) {
   URL <- urls_list[[i]]
   data <- scrape(URL)
   # show progress
   message("iteration: ", i)
   #return value
   data
})

str(df_list)


Hope this helps,

Rui Barradas


	[[alternative HTML version deleted]]


From @k@h@y_e4 @end|ng |rom hotm@||@com  Tue Nov  8 15:48:44 2022
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Tue, 8 Nov 2022 14:48:44 +0000
Subject: [R] print and lapply....
In-Reply-To: <BN6PR2201MB155366AA16C4F596735677B8CF3C9@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <CAPcHnpRxP9O1_EF81-9-+J+OOTePty3peRXgUVvW=_YYcXrstQ@mail.gmail.com>
 <CAGxFJbSyM8XmQ+8s7mQRChMgJj6+qJO+OD==ML8No8yCA8SjaA@mail.gmail.com>
 <PU4P216MB15688AD15B43427708CE42AEC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <BN6PR2201MB155366AA16C4F596735677B8CF3C9@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <PU4P216MB1568C75ADFFA7722DBE33C61C83F9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

Dear Tim,
                   I think the recent replies from you, Bert and Rui cleared everything ...
THanks a lot..

Thanking you,
Yours sincerely,
AKSHAY M KULKARNI
________________________________
From: Ebert,Timothy Aaron <tebert at ufl.edu>
Sent: Tuesday, November 8, 2022 2:15 AM
To: akshay kulkarni <akshay_e4 at hotmail.com>; Bert Gunter <bgunter.4567 at gmail.com>; Andrew Simmons <akwsimmo at gmail.com>
Cc: R help Mailing list <r-help at r-project.org>
Subject: RE: [R] print and lapply....

Dear Akshay,
    I think we have provided several solutions to the question asked. Can you please adjust your question to more closely align with what you need. It would be nice if you can provide sufficient detail so that we can see how you have adapted our solutions and how these have not quite addressed this problem.

Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of akshay kulkarni
Sent: Monday, November 7, 2022 1:10 PM
To: Bert Gunter <bgunter.4567 at gmail.com>; Andrew Simmons <akwsimmo at gmail.com>
Cc: R help Mailing list <r-help at r-project.org>
Subject: Re: [R] print and lapply....

[External Email]

Dear Bert,
                   Actually, I am replacing a big for loop by the lapply() function, and report the progress:

lapply(TP, function(i) { BODY; print(i)})

Can you please adjust your solution in this light?

THanking you,
Yours sincerely,
AKSHAY M KULKARNI
________________________________
From: Bert Gunter <bgunter.4567 at gmail.com>
Sent: Monday, November 7, 2022 11:16 PM
To: Andrew Simmons <akwsimmo at gmail.com>
Cc: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
Subject: Re: [R] print and lapply....

Well... yes, of course. But assuming the sole purpose is to print the results and not to save them for further processing, the OP's approach seems rather painful. My preference would be to vectorize:

> print(cbind(TP, TPsq =TP^2), print.gap = 3)
       TP   TPsq
[1,]    1      1
[2,]    2      4
[3,]    3      9
[4,]    4     16

See ?print.default for details

-- Bert


On Mon, Nov 7, 2022 at 9:20 AM Andrew Simmons <akwsimmo at gmail.com> wrote:
>
> put print() around x^2
>
> On Mon, Nov 7, 2022, 12:18 akshay kulkarni <akshay_e4 at hotmail.com> wrote:
>
> > Dear members,
> >                              I have the following code and output:
> >
> > > TP <- 1:4
> > > lapply(TP,function(x){print(x);x^2})
> > [1] 1
> > [1] 2
> > [1] 3
> > [1] 4
> > [[1]]
> > [1] 1
> >
> > [[2]]
> > [1] 4
> >
> > [[3]]
> > [1] 9
> >
> > [[4]]
> > [1] 16
> >
> > How do I make the print function output x along with x^2, i.e not at
> > the beginning but before each of x^2?
> >
> > Many thanks in advance....
> >
> > THanking you,
> > Yours sincerely
> > AKSHAY M KULKARNI
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fst
> > at.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%4
> > 0ufl.edu%7Cb726a89349ed4860265708dac0eb5d0a%7C0d4da0f84a314d76ace60a
> > 62331e1b84%7C0%7C0%7C638034414365456384%7CUnknown%7CTWFpbGZsb3d8eyJW
> > IjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C300
> > 0%7C%7C%7C&amp;sdata=dQk1JPxWI4D0D6%2FSoC8LWw56749ulaFrGQc6affgBeM%3
> > D&amp;reserved=0
> > PLEASE do read the posting guide
> > https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww
> > .r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.
> > edu%7Cb726a89349ed4860265708dac0eb5d0a%7C0d4da0f84a314d76ace60a62331
> > e1b84%7C0%7C0%7C638034414365456384%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiM
> > C4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%
> > 7C%7C&amp;sdata=KDskHBxmxe0DV9XO7GvkESemUNTq2w%2BT%2Fro%2Bgb4DS2w%3D
> > &amp;reserved=0 and provide commented, minimal, self-contained,
> > reproducible code.
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat
> .ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl
> .edu%7Cb726a89349ed4860265708dac0eb5d0a%7C0d4da0f84a314d76ace60a62331e
> 1b84%7C0%7C0%7C638034414365456384%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4w
> LjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C
> &amp;sdata=dQk1JPxWI4D0D6%2FSoC8LWw56749ulaFrGQc6affgBeM%3D&amp;reserv
> ed=0 PLEASE do read the posting guide
> https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r
> -project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%
> 7Cb726a89349ed4860265708dac0eb5d0a%7C0d4da0f84a314d76ace60a62331e1b84%
> 7C0%7C0%7C638034414365612626%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwM
> DAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;
> sdata=OxZmpA4ORbfUq0gqM8ebZvK5bQTaiCwo0Y1ekn%2F3zBE%3D&amp;reserved=0
> and provide commented, minimal, self-contained, reproducible code.

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7Cb726a89349ed4860265708dac0eb5d0a%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638034414365612626%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=OCyLwP3YBC3kfih9kaX6vEbPdzvAq1a48LeDRyqlYd0%3D&amp;reserved=0
PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7Cb726a89349ed4860265708dac0eb5d0a%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638034414365612626%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=OxZmpA4ORbfUq0gqM8ebZvK5bQTaiCwo0Y1ekn%2F3zBE%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Tue Nov  8 16:21:56 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Tue, 8 Nov 2022 15:21:56 +0000
Subject: [R] print and lapply....
In-Reply-To: <PU4P216MB1568B071D6953887BFF56AB5C83F9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <85d70330-d644-9ad6-1c6f-e6ef21c4cd7f@sapo.pt>
 <PU4P216MB1568124CE102CB3A02D058F1C83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <28f820bf-feef-b45f-a2e2-400374efe20f@sapo.pt>
 <PU4P216MB1568284562B6403E256F76DDC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <77cc1472-cb84-e953-f978-ebecaca7c4a9@sapo.pt>
 <PU4P216MB1568B071D6953887BFF56AB5C83F9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
Message-ID: <4228c15d-4dfb-34be-2ce8-ee3241f03e19@sapo.pt>

?s 14:47 de 08/11/2022, akshay kulkarni escreveu:
> Dear Rui,
>                    The replies from you, Bert, Tim and solved my problem. My last question: what if I put print inside the body of the function passed on to lapply, instead of separately in the function argument of apply? Is this what you insinuated in your reply?
> 
> THanking you,
> yours sincerely,
> AKSHAY M KULKARNI
> ________________________________
> From: Rui Barradas <ruipbarradas at sapo.pt>
> Sent: Tuesday, November 8, 2022 2:20 AM
> To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
> Subject: Re: [R] print and lapply....
> 
> ?s 19:22 de 07/11/2022, akshay kulkarni escreveu:
>> Dear Rui,
>>                    THanks for your reply...The point is the loop is a scraping code, and in your examples you have assumed that the body acts on i, the loop variable. Can you adapt your code to JUST PRINT the loop variable i ?
>>
>> By the by, I think I have stumbled upon the answer: The lapply() caches the result, and prints the output of the function in question  immediately after printing the final i. The i's get printed serially, as the function progresses....
>>
>>> lapply(1:4,function(x){print(x);Sys.sleep(x^2);x^2})
>> [1] 1
>> [1] 2
>> [1] 3
>> [1] 4
>> [[1]]
>> [1] 1
>>
>> [[2]]
>> [1] 4
>>
>> [[3]]
>> [1] 9
>>
>> [[4]]
>> [1] 16
>>
>> Here x^2 's print only after 4 is printed on the console....
>>
>> tHanks anyways for your reply....
>>
>> THanking you,
>> Yours sincerely,
>> AKSHAY M KULKARNI
>> ________________________________
>> From: Rui Barradas <ruipbarradas at sapo.pt>
>> Sent: Tuesday, November 8, 2022 12:24 AM
>> To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
>> Subject: Re: [R] print and lapply....
>>
>> ?s 18:33 de 07/11/2022, akshay kulkarni escreveu:
>>> Dear Rui,
>>>                       Actually, I am replacing a big for loop by the lapply() function, and report the progress:
>>>
>>> lapply(TP, function(i) { BODY; print(i)})
>>>
>>> Can you please adjust your solution in this light?
>>>
>>> THanking you,
>>> Yours sincerely,
>>> AKSHAY M KULKARNI
>>> ________________________________
>>> From: Rui Barradas <ruipbarradas at sapo.pt>
>>> Sent: Monday, November 7, 2022 11:59 PM
>>> To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
>>> Subject: Re: [R] print and lapply....
>>>
>>> ?s 17:17 de 07/11/2022, akshay kulkarni escreveu:
>>>> Dear members,
>>>>                                  I have the following code and output:
>>>>
>>>>> TP <- 1:4
>>>>> lapply(TP,function(x){print(x);x^2})
>>>> [1] 1
>>>> [1] 2
>>>> [1] 3
>>>> [1] 4
>>>> [[1]]
>>>> [1] 1
>>>>
>>>> [[2]]
>>>> [1] 4
>>>>
>>>> [[3]]
>>>> [1] 9
>>>>
>>>> [[4]]
>>>> [1] 16
>>>>
>>>> How do I make the print function output x along with x^2, i.e not at the beginning but before each of x^2?
>>>>
>>>> Many thanks in advance....
>>>>
>>>> THanking you,
>>>> Yours sincerely
>>>> AKSHAY M KULKARNI
>>>>
>>>>           [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>> Hello,
>>>
>>> Here are two options, with ?cat and with ?message.
>>>
>>>
>>> TP <- 1:4
>>> lapply(TP, function(x){
>>>       cat("x =", x, "x^2 =", x^2, "\n")
>>> })
>>>
>>> lapply(TP, function(x){
>>>       msg <- paste("x =", x, "x^2 =", x^2)
>>>       message(msg)
>>> })
>>>
>>>
>>> Hope this helps,
>>>
>>> Rui Barradas
>>>
>>>
>>>
>> Hello,
>>
>>
>> What do you want the lapply loop to return? If you have a BODY doing
>> computations, do you want the lapply to return those values and report
>> the progress?
>>
>> I have chosen cat or message over print because
>>
>>     - cat returns invisible(NULL),
>>     - message returns invisible()
>>     - print returns a value, what it prints.
>>
>> Can you adapt the code below to your use case?
>>
>>
>>
>> TP <- 1:4
>> lapply(TP, function(x, verbose = TRUE){
>>      # BODY
>>      y <- rnorm(100, mean = x)
>>
>>      # show progress
>>      if(verbose)
>>        cat("x =", x, "x^2 =", x^2, "\n")
>>
>>      #return value
>>      c(x = x, mean = mean(y))
>> })
>>
>> lapply(TP, function(x, verbose = TRUE){
>>      # BODY
>>      y <- rnorm(100, mean = x)
>>
>>      # show progress
>>      if(verbose) {
>>        msg <- paste("x =", x, "x^2 =", x^2)
>>        message(msg)
>>      }
>>
>>      #return value
>>      c(x = x, mean = mean(y))
>> })
>>
>>
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>>
> Hello,
> 
> No, the x^2 are not printed after the i's. The x^2 are the function's
> return values. The function prints the i's, then returns x^2.
> 
> As for your problem, it is now more clerar.
> I would write a function accepting a url to take care of scraping and
> call it in the lapply loop. The progress report can be in the loop, like
> below.
> 
> This is a complete working example, scraping the Wikipedia list of
> countries by GDP. The urls are in a list (it's always the same, I'm not
> complicating things) and in a real scraping function I would wrap
> tryCatch around it, just in case.
> 
> First the function, then the urls list, then the lapply loop.
> 
> 
> 
> library(rvest)
> 
> scrape <- function(url) {
>     page <- read_html(url)
>     gdp <- page |>
>       html_element(".wikitable") |>
>       html_table() |>
>       as.data.frame()
>     names(gdp) <- unlist(gdp[1,, drop = TRUE])
>     gdp <- gdp[-1,]
>     row.names(gdp) <- NULL
> 
>     #return value
>     gdp
> }
> 
> wiki_gdp_url <-
> "https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)"
> urls_list <- list(wiki_gdp_url, wiki_gdp_url)
> TP <- seq_along(urls_list)
> 
> TP
> # [1] 1 2
> 
> df_list <- lapply(TP, \(i) {
>     URL <- urls_list[[i]]
>     data <- scrape(URL)
>     # show progress
>     message("iteration: ", i)
>     #return value
>     data
> })
> 
> str(df_list)
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> 
Hello,

Yes, you can put it in the function. I have separated the function from 
printing the progress because I thought it might make things more clear, 
that's all.

Hope this helps,

Rui Barradas


From @k@h@y_e4 @end|ng |rom hotm@||@com  Tue Nov  8 16:23:55 2022
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Tue, 8 Nov 2022 15:23:55 +0000
Subject: [R] print and lapply....
In-Reply-To: <4228c15d-4dfb-34be-2ce8-ee3241f03e19@sapo.pt>
References: <PU4P216MB1568A360DA25F1A43E00F62AC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <85d70330-d644-9ad6-1c6f-e6ef21c4cd7f@sapo.pt>
 <PU4P216MB1568124CE102CB3A02D058F1C83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <28f820bf-feef-b45f-a2e2-400374efe20f@sapo.pt>
 <PU4P216MB1568284562B6403E256F76DDC83C9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <77cc1472-cb84-e953-f978-ebecaca7c4a9@sapo.pt>
 <PU4P216MB1568B071D6953887BFF56AB5C83F9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <4228c15d-4dfb-34be-2ce8-ee3241f03e19@sapo.pt>
Message-ID: <PU4P216MB15682DD6A2516A6DFBAD8BBCC83F9@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

Dear Rui,
                  THanks a lot!

THanking you,
Yours sincerely
AKSHAY M KULKARNI
________________________________
From: Rui Barradas <ruipbarradas at sapo.pt>
Sent: Tuesday, November 8, 2022 8:51 PM
To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
Subject: Re: [R] print and lapply....

?s 14:47 de 08/11/2022, akshay kulkarni escreveu:
> Dear Rui,
>                    The replies from you, Bert, Tim and solved my problem. My last question: what if I put print inside the body of the function passed on to lapply, instead of separately in the function argument of apply? Is this what you insinuated in your reply?
>
> THanking you,
> yours sincerely,
> AKSHAY M KULKARNI
> ________________________________
> From: Rui Barradas <ruipbarradas at sapo.pt>
> Sent: Tuesday, November 8, 2022 2:20 AM
> To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
> Subject: Re: [R] print and lapply....
>
> ?s 19:22 de 07/11/2022, akshay kulkarni escreveu:
>> Dear Rui,
>>                    THanks for your reply...The point is the loop is a scraping code, and in your examples you have assumed that the body acts on i, the loop variable. Can you adapt your code to JUST PRINT the loop variable i ?
>>
>> By the by, I think I have stumbled upon the answer: The lapply() caches the result, and prints the output of the function in question  immediately after printing the final i. The i's get printed serially, as the function progresses....
>>
>>> lapply(1:4,function(x){print(x);Sys.sleep(x^2);x^2})
>> [1] 1
>> [1] 2
>> [1] 3
>> [1] 4
>> [[1]]
>> [1] 1
>>
>> [[2]]
>> [1] 4
>>
>> [[3]]
>> [1] 9
>>
>> [[4]]
>> [1] 16
>>
>> Here x^2 's print only after 4 is printed on the console....
>>
>> tHanks anyways for your reply....
>>
>> THanking you,
>> Yours sincerely,
>> AKSHAY M KULKARNI
>> ________________________________
>> From: Rui Barradas <ruipbarradas at sapo.pt>
>> Sent: Tuesday, November 8, 2022 12:24 AM
>> To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
>> Subject: Re: [R] print and lapply....
>>
>> ?s 18:33 de 07/11/2022, akshay kulkarni escreveu:
>>> Dear Rui,
>>>                       Actually, I am replacing a big for loop by the lapply() function, and report the progress:
>>>
>>> lapply(TP, function(i) { BODY; print(i)})
>>>
>>> Can you please adjust your solution in this light?
>>>
>>> THanking you,
>>> Yours sincerely,
>>> AKSHAY M KULKARNI
>>> ________________________________
>>> From: Rui Barradas <ruipbarradas at sapo.pt>
>>> Sent: Monday, November 7, 2022 11:59 PM
>>> To: akshay kulkarni <akshay_e4 at hotmail.com>; R help Mailing list <r-help at r-project.org>
>>> Subject: Re: [R] print and lapply....
>>>
>>> ?s 17:17 de 07/11/2022, akshay kulkarni escreveu:
>>>> Dear members,
>>>>                                  I have the following code and output:
>>>>
>>>>> TP <- 1:4
>>>>> lapply(TP,function(x){print(x);x^2})
>>>> [1] 1
>>>> [1] 2
>>>> [1] 3
>>>> [1] 4
>>>> [[1]]
>>>> [1] 1
>>>>
>>>> [[2]]
>>>> [1] 4
>>>>
>>>> [[3]]
>>>> [1] 9
>>>>
>>>> [[4]]
>>>> [1] 16
>>>>
>>>> How do I make the print function output x along with x^2, i.e not at the beginning but before each of x^2?
>>>>
>>>> Many thanks in advance....
>>>>
>>>> THanking you,
>>>> Yours sincerely
>>>> AKSHAY M KULKARNI
>>>>
>>>>           [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>> Hello,
>>>
>>> Here are two options, with ?cat and with ?message.
>>>
>>>
>>> TP <- 1:4
>>> lapply(TP, function(x){
>>>       cat("x =", x, "x^2 =", x^2, "\n")
>>> })
>>>
>>> lapply(TP, function(x){
>>>       msg <- paste("x =", x, "x^2 =", x^2)
>>>       message(msg)
>>> })
>>>
>>>
>>> Hope this helps,
>>>
>>> Rui Barradas
>>>
>>>
>>>
>> Hello,
>>
>>
>> What do you want the lapply loop to return? If you have a BODY doing
>> computations, do you want the lapply to return those values and report
>> the progress?
>>
>> I have chosen cat or message over print because
>>
>>     - cat returns invisible(NULL),
>>     - message returns invisible()
>>     - print returns a value, what it prints.
>>
>> Can you adapt the code below to your use case?
>>
>>
>>
>> TP <- 1:4
>> lapply(TP, function(x, verbose = TRUE){
>>      # BODY
>>      y <- rnorm(100, mean = x)
>>
>>      # show progress
>>      if(verbose)
>>        cat("x =", x, "x^2 =", x^2, "\n")
>>
>>      #return value
>>      c(x = x, mean = mean(y))
>> })
>>
>> lapply(TP, function(x, verbose = TRUE){
>>      # BODY
>>      y <- rnorm(100, mean = x)
>>
>>      # show progress
>>      if(verbose) {
>>        msg <- paste("x =", x, "x^2 =", x^2)
>>        message(msg)
>>      }
>>
>>      #return value
>>      c(x = x, mean = mean(y))
>> })
>>
>>
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>>
> Hello,
>
> No, the x^2 are not printed after the i's. The x^2 are the function's
> return values. The function prints the i's, then returns x^2.
>
> As for your problem, it is now more clerar.
> I would write a function accepting a url to take care of scraping and
> call it in the lapply loop. The progress report can be in the loop, like
> below.
>
> This is a complete working example, scraping the Wikipedia list of
> countries by GDP. The urls are in a list (it's always the same, I'm not
> complicating things) and in a real scraping function I would wrap
> tryCatch around it, just in case.
>
> First the function, then the urls list, then the lapply loop.
>
>
>
> library(rvest)
>
> scrape <- function(url) {
>     page <- read_html(url)
>     gdp <- page |>
>       html_element(".wikitable") |>
>       html_table() |>
>       as.data.frame()
>     names(gdp) <- unlist(gdp[1,, drop = TRUE])
>     gdp <- gdp[-1,]
>     row.names(gdp) <- NULL
>
>     #return value
>     gdp
> }
>
> wiki_gdp_url <-
> "https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)"
> urls_list <- list(wiki_gdp_url, wiki_gdp_url)
> TP <- seq_along(urls_list)
>
> TP
> # [1] 1 2
>
> df_list <- lapply(TP, \(i) {
>     URL <- urls_list[[i]]
>     data <- scrape(URL)
>     # show progress
>     message("iteration: ", i)
>     #return value
>     data
> })
>
> str(df_list)
>
>
> Hope this helps,
>
> Rui Barradas
>
>
Hello,

Yes, you can put it in the function. I have separated the function from
printing the progress because I thought it might make things more clear,
that's all.

Hope this helps,

Rui Barradas


	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Wed Nov  9 07:22:18 2022
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Wed, 9 Nov 2022 08:22:18 +0200
Subject: [R] [External] Re: Selecting a minimum value of an attribute
 associated with point values neighboring a given point and assigning it as
 a new attribute
In-Reply-To: <BN6PR05MB3588DCB2A66A6048CD9D7645903E9@BN6PR05MB3588.namprd05.prod.outlook.com>
References: <BN6PR05MB35887EFE01222DBF7C359AAB903B9@BN6PR05MB3588.namprd05.prod.outlook.com>
 <CAGxFJbSkg9zAqk0dGcr3qJe2z2C04NEZFdHN8hWQA3oSbfHukQ@mail.gmail.com>
 <CAGgJW767Ein1S+MSywb57B2UtmE0EJodDVokPEx5_-c5BTFR1Q@mail.gmail.com>
 <CAGgJW77yY0_GDQWEAxzSdRh0N3kXgj9zrSEYUzuVsFnHyeE=aA@mail.gmail.com>
 <BN6PR05MB3588015F46997E64D5F8F138903D9@BN6PR05MB3588.namprd05.prod.outlook.com>
 <3247be10-6d5c-12d5-1634-2a9e934f431e@gmail.com>
 <BN6PR05MB3588DCB2A66A6048CD9D7645903E9@BN6PR05MB3588.namprd05.prod.outlook.com>
Message-ID: <CAGgJW74vd+et3_ShdyXxL8bxWUknviy3i2kAfumAL79+_1JeaQ@mail.gmail.com>

Hi Tiffany,
You can replace

Conc_min <- lapply(1:N, function(i) { ...

by

Conc_min <- lapply(seq_len(nrow(pts)), function(i) { ..

Best,
Eric

On Wed, Nov 9, 2022 at 4:38 AM Duhl, Tiffany R. <Tiffany.Duhl at tufts.edu> wrote:
>
> First off, thanks SO much Eric and Micha for your help on this problem!  I think Micha's spatially-oriented solution with Eric's slight modifications will work best for my application but there is one snag (see the commented section near the end of the following code)-- basically I don't know how to apply the lapply operator to a list with a variable length (namely the length of my input csv files) rather than the fixed length that Eric used:
>
> library(sf)
> library(spdep)
> data<- read.csv("R_find_pts_testdata.csv")
>
> MAX_DIST <- 0.05  #50 m in km, the units of dnearneigh when coords are in degrees
> pts <- st_as_sf(data, coords=c('LON', 'LAT'), crs=4326)
> dist_matrix <- dnearneigh(pts, 0, MAX_DIST, use_s2=TRUE)
>
> #Micha's function to get the minimum Conc value among all points
> #within the buffer distance to a given single point:
> # Function to get minimum Conc values for one row of distance matrix
>
> MinConc <- function(x, lst, pts) {
>    Concs <- lapply(lst, function(p) {
>      pts$Conc[p]
>    })
>    return(min(Concs[[1]]))
> }
>
> # above, x is an index to a single point, lst is a list of point indices
> #from distance matrix within the buffer distance
>
> #Next run function on all points to get list of minimum Conc
> #values for all points, and merge back to pts.
> #...modified by Eric to include original point
>
> return(min(c(Concs[[1]], pts$Conc[x])))
>
> # Now apply this function to all points in pts
> ###This is where the problem is, I think:
> ###Eric had used N <- 1000L and later
> ###Conc_min <- lapply(1:N, function(i) {
> ### MinConc(i, dist_matrix[i], pts)})
> ###But I need the length of the list the function is applied to
> ###to be variable, depending on the length of the input csv file
> ###unlike the dummy variable dataframe that Eric used with a set length
> ###So I changed the "x" argument in lapply to "pts$X" but that generates an empty list
>
> Conc_min <- lapply(pts$X, function(i){
>    MinConc(i, dist_matrix[i], pts)
> #})
> Conc_min <- data.frame("Conc_min" = as.integer(Conc_min))
>
> # Add back as new attrib to original points sf object
> pts_with_min <- do.call(cbind, c(pts, Conc_min))
>
>
>
> Many thanks again for your help on this!
> Best regards,
> -Tiffany
> ________________________________
> From: Micha Silver <tsvibar at gmail.com>
> Sent: Monday, November 7, 2022 8:11 AM
> To: Duhl, Tiffany R. <Tiffany.Duhl at tufts.edu>; Eric Berger <ericjberger at gmail.com>
> Cc: R-help <R-help at r-project.org>
> Subject: Re: [R] [External] Re: Selecting a minimum value of an attribute associated with point values neighboring a given point and assigning it as a new attribute
>
> Eric's solution notwithstanding, here's a more "spatial" approach.
>
>
> I first create a fictitious set of 1000 points (and save to CSV to
> replicate your workflow)
>
> library(sf)
> library(spdep)
>
> # Prepare fictitious data
> # Create a data.frame with 1000 random points, and save to CSV
> LON <- runif(1000, -70.0, -69.0)
> LAT <- runif(1000, 42.0, 43.0)
> Conc <- runif(1000, 90000, 100000)
> df <- data.frame(LON, LAT, Conc)
> csv_file = "/tmp/pts_testdata.csv"
> write.csv(df, csv_file)
>
>
> Now read that CSV back in directly as an sf object (No need for the old
> SpatialPointsDataFrame). THen create a distance matrix for all points,
> which contains indicies to those points within a certain buffer
> distance, just as you did in your example.
>
>
> # Read back in as sf object, including row index
> pts <- st_as_sf(read.csv(csv_file), coords=c('LON', 'LAT'), crs=4326)
> dist_matrix <- dnearneigh(pts, 0, 100, use_s2=TRUE) # use_s2 since these
> are lon/lat
>
> Now I prepare a function to get the minimum Conv value among all points
> within the buffer distance to a given single point:
> # Function to get minimum Conc values for one row of distance matrix
> MinConc <- function(x, lst, pts) {
>    # x is an index to a single point,
>    # lst is a list of point indices from distance matrix
>    # that are within the buffer distance
>    Concs <- lapply(lst, function(p) {
>      pts$Conc[p]
>    })
>    return(min(Concs[[1]]))
> }
>
> Next run that function on all points to get a list of minimum Conv
> values for all points, and merge back to pts.
>
>
> # Now apply this function to all points in pts
> Conc_min <- lapply(pts$X, function(i){
>    MinConc(i, dist_matrix[i], pts)
> })
> Conc_min <- data.frame("Conc_min" = as.integer(Conc_min))
>
> # Add back as new attrib to original points sf object
> pts_with_min <- do.call(cbind, c(pts, Conc_min))
>
> HTH,
>
> Micha
>
>
>
> On 06/11/2022 18:40, Duhl, Tiffany R. wrote:
> > Thanks so much Eric!
> >
> >   I'm going to play around with your toy code (pun intended) & see if I can make it work for my application.
> >
> > Cheers,
> > -Tiffany
> > ________________________________
> > From: Eric Berger <ericjberger at gmail.com>
> > Sent: Sunday, November 6, 2022 10:27 AM
> > To: Bert Gunter <bgunter.4567 at gmail.com>
> > Cc: Duhl, Tiffany R. <Tiffany.Duhl at tufts.edu>; R-help <R-help at r-project.org>
> > Subject: [External] Re: [R] Selecting a minimum value of an attribute associated with point values neighboring a given point and assigning it as a new attribute
> >
> > Whoops ... left out a line in Part 2. Resending with the correction
> >
> > ## PART 2: You can use this code on the real data with f() defined appropriately
> > A <- matrix(0,N,N)
> > v <- 1:N
> > ## get the indices (j,k) where j < k (as columns in a data.frame)
> > idx <- expand.grid(v,v) |> rename(j=Var1,k=Var2) |> filter(j < k)
> > u <- sapply(1:nrow(idx),
> >             \(i){ j <- idx$j[i]; k <- idx$k[i]; A[j,k] <<- f(j,k,myData) })
> > B <- A + t(A) + diag(N)
> > C <- diag(myData$Conc)
> > D <- B %*% C
> > D[D==0] <- NA
> > myData$Conc_min <- apply(D,MAR=1,\(v){min(v,na.rm=TRUE)})
> > print(head(myData))
> >
> > On Sun, Nov 6, 2022 at 5:19 PM Eric Berger <ericjberger at gmail.com> wrote:
> >> Hi Tiffany,
> >> Here is some code that might help with your problem. I solve a "toy"
> >> problem that is conceptually the same.
> >> Part 1 sets up my toy problem. You would have to replace Part 1 with
> >> your real case. The main point is to define
> >> a function f(i, j, data) which returns 0 or 1 depending on whether the
> >> observations in rows i and j in your dataset 'data'
> >> are within your cutoff distance (i.e. 50m).
> >>
> >> You can then use Part 2 almost without changes (except for changing
> >> 'myData' to the correct name of your data).
> >>
> >> I hope this helps,
> >> Eric
> >>
> >> library(dplyr)
> >>
> >> ## PART 1: create fake data for minimal example
> >> set.seed(123) ## for reproducibility
> >> N <- 5       ## replace by number of locations (approx 9000 in your case)
> >> MAX_DISTANCE <- 2  ## 50 in your case
> >> myData <- data.frame(x=rnorm(N),y=rnorm(N),Conc=sample(1:N,N))
> >>
> >> ## The function which you must re-define for your actual case.
> >> f <- function(i,j,a) {
> >>   dist <- sqrt(sum((a[i,1:2] - a[j,1:2])^2)) ## Euclidean distance
> >>   as.integer(dist < MAX_DISTANCE)
> >> }
> >>
> >> ## PART 2: You can use this code on the real data with f() defined appropriately
> >> A <- matrix(0,N,N)
> >> ## get the indices (j,k) where j < k (as columns in a data.frame)
> >> idx <- expand.grid(v,v) |> rename(j=Var1,k=Var2) |> filter(j < k)
> >> u <- sapply(1:nrow(idx),\(i){ j <- idx$j[i]; k <- idx$k[i]; A[j,k] <<-
> >> f(j,k,myData) })
> >> B <- A + t(A) + diag(N)
> >> C <- diag(myData$Conc)
> >> D <- B %*% C
> >> D[D==0] <- NA
> >> myData$Conc_min <- apply(D,MAR=1,\(v){min(v,na.rm=TRUE)})
> >> print(head(myData))
> >>
> >>
> >> On Sat, Nov 5, 2022 at 5:14 PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >>> Probably better posted on R-sig-geo.
> >>>
> >>> -- Bert
> >>>
> >>> On Sat, Nov 5, 2022 at 12:36 AM Duhl, Tiffany R. <Tiffany.Duhl at tufts.edu>
> >>> wrote:
> >>>
> >>>> Hello,
> >>>>
> >>>> I have sets of spatial points with LAT, LON coords (unprojected, WGS84
> >>>> datum) and several value attributes associated with each point, from
> >>>> numerous csv files (with an average of 6,000-9,000 points in each file) as
> >>>> shown in the following example:
> >>>>
> >>>> data<- read.csv("R_find_pts_testdata.csv")
> >>>>
> >>>>> data
> >>>>      ID      Date         Time        LAT            LON           Conc
> >>>> Leg.Speed    CO2  H2O BC61 Hr Min Sec
> >>>> 1   76 4/19/2021 21:25:38 42.40066 -70.98802 99300   0.0 mph 428.39 9.57
> >>>> 578 21  25  38
> >>>> 2   77 4/19/2021 21:25:39 42.40066 -70.98802 96730   0.0 mph 428.04 9.57
> >>>> 617 21  25  39
> >>>> 3   79 4/19/2021 21:25:41 42.40066 -70.98802 98800   0.2 mph 427.10 9.57
> >>>> 1027 21  25  41
> >>>> 4   80 4/19/2021 21:25:42 42.40066 -70.98802 96510     2 mph 427.99 9.58
> >>>> 1381 21  25  42
> >>>> 5   81 4/19/2021 21:25:43 42.40067 -70.98801 95540     3 mph 427.99 9.58
> >>>> 1271 21  25  43
> >>>> 6   82 4/19/2021 21:25:44 42.40068 -70.98799 94720     4 mph 427.20 9.57
> >>>> 910 21  25  44
> >>>> 7   83 4/19/2021 21:25:45 42.40069 -70.98797 94040     5 mph 427.18 9.57
> >>>> 652 21  25  45
> >>>> 8   84 4/19/2021 21:25:46 42.40072 -70.98795 95710     7 mph 427.07 9.57
> >>>> 943 21  25  46
> >>>> 9   85 4/19/2021 21:25:47 42.40074 -70.98792 96200     8 mph 427.44 9.56
> >>>> 650 21  25  47
> >>>> 10  86 4/19/2021 21:25:48 42.40078 -70.98789 93750    10 mph 428.76 9.57
> >>>> 761 21  25  48
> >>>> 11  87 4/19/2021 21:25:49 42.40081 -70.98785 93360    11 mph 429.25 9.56
> >>>> 1158 21  25  49
> >>>> 12  88 4/19/2021 21:25:50 42.40084 -70.98781 94340    12 mph 429.56 9.57
> >>>> 107 21  25  50
> >>>> 13  89 4/19/2021 21:25:51 42.40087 -70.98775 92780    12 mph 428.62 9.56
> >>>> 720 21  25  51
> >>>>
> >>>>
> >>>> What I want to do is, for each point, identify all points within 50m of
> >>>> that point, find the minimum value of the "Conc" attribute of each nearby
> >>>> set of points (including the original point) and then create a new variable
> >>>> ("Conc_min") and assign this minimum value to a new variable added to
> >>>> "data".
> >>>>
> >>>> So far, I have the following code:
> >>>>
> >>>> library(spdep)
> >>>> library(sf)
> >>>>
> >>>> setwd("C:\\mydirectory\\")
> >>>> data<- read.csv("R_find_pts_testdata.csv")
> >>>>
> >>>> #make sure the data is a data frame
> >>>> pts <- data.frame(data)
> >>>>
> >>>> #create spatial data frame and define projection
> >>>> pts_coords <- cbind(pts$LON, pts$LAT)
> >>>> data_pts <- SpatialPointsDataFrame(coords= pts_coords,
> >>>> data=pts, proj4string = CRS("+proj=longlat +datum=WGS84"))
> >>>>
> >>>> #Re-project to WGS 84 / UTM zone 18N, so the analysis is in units of m
> >>>> ptsUTM  <- sf::st_as_sf(data_pts, coords = c("LAT", "LON"), remove = F)%>%
> >>>> st_transform(32618)
> >>>>
> >>>> #create 50 m buffer around each point then intersect with points and
> >>>> finally find neighbors within the buffers
> >>>> pts_buf <- sf::st_buffer(ptsUTM, 50)
> >>>> coords  <- sf::st_coordinates(ptsUTM)
> >>>> int <- sf::st_intersects(pts_buf, ptsUTM)
> >>>> x   <- spdep::dnearneigh(coords, 0, 50)
> >>>>
> >>>> Now at this point, I'm not sure what to either the "int" (a sgbp list) or
> >>>> "x" (nb object) objects (or even if I need them both)
> >>>>
> >>>>> int
> >>>> Sparse geometry binary predicate list of length 974, where the predicate
> >>>> was `intersects'
> >>>> first 10 elements:
> >>>>   1: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>   2: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>   3: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>   4: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>   5: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>   6: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>   7: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>   8: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>   9: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
> >>>>
> >>>>> x
> >>>> Neighbour list object:
> >>>> Number of regions: 974
> >>>> Number of nonzero links: 34802
> >>>> Percentage nonzero weights: 3.668481
> >>>> Average number of links: 35.73101
> >>>>
> >>>> One thought is that maybe I don't need the dnearneigh function and can
> >>>> instead convert "int" into a dataframe and somehow merge or associate
> >>>> (perhaps with an inner join) the ID fields of the buffered and intersecting
> >>>> points and then compute the minimum value of "Conc" grouping by ID:
> >>>>
> >>>>> as.data.frame(int)
> >>>>      row.id col.id
> >>>> 1        1      1
> >>>> 2        1      2
> >>>> 3        1      3
> >>>> 4        1      4
> >>>> 5        1      5
> >>>> 6        1      6
> >>>> 7        1      7
> >>>> 8        1      8
> >>>> 9        1      9
> >>>> 10       1     10
> >>>> 11       1     11
> >>>> 12       1     12
> >>>> 13       1     13
> >>>> 14       1     14
> >>>> 15       1     15
> >>>> 16       1     16
> >>>> 17       1     17
> >>>> 18       1     18
> >>>> 19       2      1
> >>>> 20       2      2
> >>>> 21       2      3
> >>>> 22       2      4
> >>>> 23       2      5
> >>>> 24       2      6
> >>>> 25       2      7
> >>>> 26       2      8
> >>>> 27       2      9
> >>>> 28       2     10
> >>>>
> >>>>
> >>>> So in the above example I'd like to take the minimum of "Conc" among the
> >>>> col.id points grouped with row.id 1 (i.e., col.ids 1-18) and assign the
> >>>> minimum value of this group as a new variable in data (Data$Conc_min), and
> >>>> do the same for row.id 2 and all the rest of the rows.
> >>>>
> >>>> I'm just not sure how to do this and I appreciate any help folks might
> >>>> have on this matter!
> >>>>
> >>>> Many thanks,
> >>>> -Tiffany
> >>>>
> >>>>          [[alternative HTML version deleted]]
> >>>>
> >>>> ______________________________________________
> >>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>>> PLEASE do read the posting guide
> >>>> http://www.R-project.org/posting-guide.html
> >>>> and provide commented, minimal, self-contained, reproducible code.
> >>>>
> >>>          [[alternative HTML version deleted]]
> >>>
> >>> ______________________________________________
> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >>> and provide commented, minimal, self-contained, reproducible code.
> > Caution: This message originated from outside of the Tufts University organization. Please exercise caution when clicking links or opening attachments. When in doubt, email the TTS Service Desk at it at tufts.edu<mailto:it at tufts.edu> or call them directly at 617-627-3376.
> >
> >
> >        [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> --
> Micha Silver
> Ben Gurion Univ.
> Sde Boker, Remote Sensing Lab
> cell: +972-523-665918
>


From T|||@ny@Duh| @end|ng |rom tu|t@@edu  Wed Nov  9 03:38:15 2022
From: T|||@ny@Duh| @end|ng |rom tu|t@@edu (Duhl, Tiffany R.)
Date: Wed, 9 Nov 2022 02:38:15 +0000
Subject: [R] [External] Re: Selecting a minimum value of an attribute
 associated with point values neighboring a given point and assigning it as
 a new attribute
In-Reply-To: <3247be10-6d5c-12d5-1634-2a9e934f431e@gmail.com>
References: <BN6PR05MB35887EFE01222DBF7C359AAB903B9@BN6PR05MB3588.namprd05.prod.outlook.com>
 <CAGxFJbSkg9zAqk0dGcr3qJe2z2C04NEZFdHN8hWQA3oSbfHukQ@mail.gmail.com>
 <CAGgJW767Ein1S+MSywb57B2UtmE0EJodDVokPEx5_-c5BTFR1Q@mail.gmail.com>
 <CAGgJW77yY0_GDQWEAxzSdRh0N3kXgj9zrSEYUzuVsFnHyeE=aA@mail.gmail.com>
 <BN6PR05MB3588015F46997E64D5F8F138903D9@BN6PR05MB3588.namprd05.prod.outlook.com>
 <3247be10-6d5c-12d5-1634-2a9e934f431e@gmail.com>
Message-ID: <BN6PR05MB3588DCB2A66A6048CD9D7645903E9@BN6PR05MB3588.namprd05.prod.outlook.com>

First off, thanks SO much Eric and Micha for your help on this problem!  I think Micha's spatially-oriented solution with Eric's slight modifications will work best for my application but there is one snag (see the commented section near the end of the following code)-- basically I don't know how to apply the lapply operator to a list with a variable length (namely the length of my input csv files) rather than the fixed length that Eric used:

library(sf)
library(spdep)
data<- read.csv("R_find_pts_testdata.csv")

MAX_DIST <- 0.05  #50 m in km, the units of dnearneigh when coords are in degrees
pts <- st_as_sf(data, coords=c('LON', 'LAT'), crs=4326)
dist_matrix <- dnearneigh(pts, 0, MAX_DIST, use_s2=TRUE)

#Micha's function to get the minimum Conc value among all points
#within the buffer distance to a given single point:
# Function to get minimum Conc values for one row of distance matrix

MinConc <- function(x, lst, pts) {
   Concs <- lapply(lst, function(p) {
     pts$Conc[p]
   })
   return(min(Concs[[1]]))
}

# above, x is an index to a single point, lst is a list of point indices
#from distance matrix within the buffer distance

#Next run function on all points to get list of minimum Conc
#values for all points, and merge back to pts.
#...modified by Eric to include original point

return(min(c(Concs[[1]], pts$Conc[x])))

# Now apply this function to all points in pts
###This is where the problem is, I think:
###Eric had used N <- 1000L and later
###Conc_min <- lapply(1:N, function(i) {
### MinConc(i, dist_matrix[i], pts)})
###But I need the length of the list the function is applied to
###to be variable, depending on the length of the input csv file
###unlike the dummy variable dataframe that Eric used with a set length
###So I changed the "x" argument in lapply to "pts$X" but that generates an empty list

Conc_min <- lapply(pts$X, function(i){
   MinConc(i, dist_matrix[i], pts)
#})
Conc_min <- data.frame("Conc_min" = as.integer(Conc_min))

# Add back as new attrib to original points sf object
pts_with_min <- do.call(cbind, c(pts, Conc_min))



Many thanks again for your help on this!
Best regards,
-Tiffany
________________________________
From: Micha Silver <tsvibar at gmail.com>
Sent: Monday, November 7, 2022 8:11 AM
To: Duhl, Tiffany R. <Tiffany.Duhl at tufts.edu>; Eric Berger <ericjberger at gmail.com>
Cc: R-help <R-help at r-project.org>
Subject: Re: [R] [External] Re: Selecting a minimum value of an attribute associated with point values neighboring a given point and assigning it as a new attribute

Eric's solution notwithstanding, here's a more "spatial" approach.


I first create a fictitious set of 1000 points (and save to CSV to
replicate your workflow)

library(sf)
library(spdep)

# Prepare fictitious data
# Create a data.frame with 1000 random points, and save to CSV
LON <- runif(1000, -70.0, -69.0)
LAT <- runif(1000, 42.0, 43.0)
Conc <- runif(1000, 90000, 100000)
df <- data.frame(LON, LAT, Conc)
csv_file = "/tmp/pts_testdata.csv"
write.csv(df, csv_file)


Now read that CSV back in directly as an sf object (No need for the old
SpatialPointsDataFrame). THen create a distance matrix for all points,
which contains indicies to those points within a certain buffer
distance, just as you did in your example.


# Read back in as sf object, including row index
pts <- st_as_sf(read.csv(csv_file), coords=c('LON', 'LAT'), crs=4326)
dist_matrix <- dnearneigh(pts, 0, 100, use_s2=TRUE) # use_s2 since these
are lon/lat

Now I prepare a function to get the minimum Conv value among all points
within the buffer distance to a given single point:
# Function to get minimum Conc values for one row of distance matrix
MinConc <- function(x, lst, pts) {
   # x is an index to a single point,
   # lst is a list of point indices from distance matrix
   # that are within the buffer distance
   Concs <- lapply(lst, function(p) {
     pts$Conc[p]
   })
   return(min(Concs[[1]]))
}

Next run that function on all points to get a list of minimum Conv
values for all points, and merge back to pts.


# Now apply this function to all points in pts
Conc_min <- lapply(pts$X, function(i){
   MinConc(i, dist_matrix[i], pts)
})
Conc_min <- data.frame("Conc_min" = as.integer(Conc_min))

# Add back as new attrib to original points sf object
pts_with_min <- do.call(cbind, c(pts, Conc_min))

HTH,

Micha



On 06/11/2022 18:40, Duhl, Tiffany R. wrote:
> Thanks so much Eric!
>
>   I'm going to play around with your toy code (pun intended) & see if I can make it work for my application.
>
> Cheers,
> -Tiffany
> ________________________________
> From: Eric Berger <ericjberger at gmail.com>
> Sent: Sunday, November 6, 2022 10:27 AM
> To: Bert Gunter <bgunter.4567 at gmail.com>
> Cc: Duhl, Tiffany R. <Tiffany.Duhl at tufts.edu>; R-help <R-help at r-project.org>
> Subject: [External] Re: [R] Selecting a minimum value of an attribute associated with point values neighboring a given point and assigning it as a new attribute
>
> Whoops ... left out a line in Part 2. Resending with the correction
>
> ## PART 2: You can use this code on the real data with f() defined appropriately
> A <- matrix(0,N,N)
> v <- 1:N
> ## get the indices (j,k) where j < k (as columns in a data.frame)
> idx <- expand.grid(v,v) |> rename(j=Var1,k=Var2) |> filter(j < k)
> u <- sapply(1:nrow(idx),
>             \(i){ j <- idx$j[i]; k <- idx$k[i]; A[j,k] <<- f(j,k,myData) })
> B <- A + t(A) + diag(N)
> C <- diag(myData$Conc)
> D <- B %*% C
> D[D==0] <- NA
> myData$Conc_min <- apply(D,MAR=1,\(v){min(v,na.rm=TRUE)})
> print(head(myData))
>
> On Sun, Nov 6, 2022 at 5:19 PM Eric Berger <ericjberger at gmail.com> wrote:
>> Hi Tiffany,
>> Here is some code that might help with your problem. I solve a "toy"
>> problem that is conceptually the same.
>> Part 1 sets up my toy problem. You would have to replace Part 1 with
>> your real case. The main point is to define
>> a function f(i, j, data) which returns 0 or 1 depending on whether the
>> observations in rows i and j in your dataset 'data'
>> are within your cutoff distance (i.e. 50m).
>>
>> You can then use Part 2 almost without changes (except for changing
>> 'myData' to the correct name of your data).
>>
>> I hope this helps,
>> Eric
>>
>> library(dplyr)
>>
>> ## PART 1: create fake data for minimal example
>> set.seed(123) ## for reproducibility
>> N <- 5       ## replace by number of locations (approx 9000 in your case)
>> MAX_DISTANCE <- 2  ## 50 in your case
>> myData <- data.frame(x=rnorm(N),y=rnorm(N),Conc=sample(1:N,N))
>>
>> ## The function which you must re-define for your actual case.
>> f <- function(i,j,a) {
>>   dist <- sqrt(sum((a[i,1:2] - a[j,1:2])^2)) ## Euclidean distance
>>   as.integer(dist < MAX_DISTANCE)
>> }
>>
>> ## PART 2: You can use this code on the real data with f() defined appropriately
>> A <- matrix(0,N,N)
>> ## get the indices (j,k) where j < k (as columns in a data.frame)
>> idx <- expand.grid(v,v) |> rename(j=Var1,k=Var2) |> filter(j < k)
>> u <- sapply(1:nrow(idx),\(i){ j <- idx$j[i]; k <- idx$k[i]; A[j,k] <<-
>> f(j,k,myData) })
>> B <- A + t(A) + diag(N)
>> C <- diag(myData$Conc)
>> D <- B %*% C
>> D[D==0] <- NA
>> myData$Conc_min <- apply(D,MAR=1,\(v){min(v,na.rm=TRUE)})
>> print(head(myData))
>>
>>
>> On Sat, Nov 5, 2022 at 5:14 PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>>> Probably better posted on R-sig-geo.
>>>
>>> -- Bert
>>>
>>> On Sat, Nov 5, 2022 at 12:36 AM Duhl, Tiffany R. <Tiffany.Duhl at tufts.edu>
>>> wrote:
>>>
>>>> Hello,
>>>>
>>>> I have sets of spatial points with LAT, LON coords (unprojected, WGS84
>>>> datum) and several value attributes associated with each point, from
>>>> numerous csv files (with an average of 6,000-9,000 points in each file) as
>>>> shown in the following example:
>>>>
>>>> data<- read.csv("R_find_pts_testdata.csv")
>>>>
>>>>> data
>>>>      ID      Date         Time        LAT            LON           Conc
>>>> Leg.Speed    CO2  H2O BC61 Hr Min Sec
>>>> 1   76 4/19/2021 21:25:38 42.40066 -70.98802 99300   0.0 mph 428.39 9.57
>>>> 578 21  25  38
>>>> 2   77 4/19/2021 21:25:39 42.40066 -70.98802 96730   0.0 mph 428.04 9.57
>>>> 617 21  25  39
>>>> 3   79 4/19/2021 21:25:41 42.40066 -70.98802 98800   0.2 mph 427.10 9.57
>>>> 1027 21  25  41
>>>> 4   80 4/19/2021 21:25:42 42.40066 -70.98802 96510     2 mph 427.99 9.58
>>>> 1381 21  25  42
>>>> 5   81 4/19/2021 21:25:43 42.40067 -70.98801 95540     3 mph 427.99 9.58
>>>> 1271 21  25  43
>>>> 6   82 4/19/2021 21:25:44 42.40068 -70.98799 94720     4 mph 427.20 9.57
>>>> 910 21  25  44
>>>> 7   83 4/19/2021 21:25:45 42.40069 -70.98797 94040     5 mph 427.18 9.57
>>>> 652 21  25  45
>>>> 8   84 4/19/2021 21:25:46 42.40072 -70.98795 95710     7 mph 427.07 9.57
>>>> 943 21  25  46
>>>> 9   85 4/19/2021 21:25:47 42.40074 -70.98792 96200     8 mph 427.44 9.56
>>>> 650 21  25  47
>>>> 10  86 4/19/2021 21:25:48 42.40078 -70.98789 93750    10 mph 428.76 9.57
>>>> 761 21  25  48
>>>> 11  87 4/19/2021 21:25:49 42.40081 -70.98785 93360    11 mph 429.25 9.56
>>>> 1158 21  25  49
>>>> 12  88 4/19/2021 21:25:50 42.40084 -70.98781 94340    12 mph 429.56 9.57
>>>> 107 21  25  50
>>>> 13  89 4/19/2021 21:25:51 42.40087 -70.98775 92780    12 mph 428.62 9.56
>>>> 720 21  25  51
>>>>
>>>>
>>>> What I want to do is, for each point, identify all points within 50m of
>>>> that point, find the minimum value of the "Conc" attribute of each nearby
>>>> set of points (including the original point) and then create a new variable
>>>> ("Conc_min") and assign this minimum value to a new variable added to
>>>> "data".
>>>>
>>>> So far, I have the following code:
>>>>
>>>> library(spdep)
>>>> library(sf)
>>>>
>>>> setwd("C:\\mydirectory\\")
>>>> data<- read.csv("R_find_pts_testdata.csv")
>>>>
>>>> #make sure the data is a data frame
>>>> pts <- data.frame(data)
>>>>
>>>> #create spatial data frame and define projection
>>>> pts_coords <- cbind(pts$LON, pts$LAT)
>>>> data_pts <- SpatialPointsDataFrame(coords= pts_coords,
>>>> data=pts, proj4string = CRS("+proj=longlat +datum=WGS84"))
>>>>
>>>> #Re-project to WGS 84 / UTM zone 18N, so the analysis is in units of m
>>>> ptsUTM  <- sf::st_as_sf(data_pts, coords = c("LAT", "LON"), remove = F)%>%
>>>> st_transform(32618)
>>>>
>>>> #create 50 m buffer around each point then intersect with points and
>>>> finally find neighbors within the buffers
>>>> pts_buf <- sf::st_buffer(ptsUTM, 50)
>>>> coords  <- sf::st_coordinates(ptsUTM)
>>>> int <- sf::st_intersects(pts_buf, ptsUTM)
>>>> x   <- spdep::dnearneigh(coords, 0, 50)
>>>>
>>>> Now at this point, I'm not sure what to either the "int" (a sgbp list) or
>>>> "x" (nb object) objects (or even if I need them both)
>>>>
>>>>> int
>>>> Sparse geometry binary predicate list of length 974, where the predicate
>>>> was `intersects'
>>>> first 10 elements:
>>>>   1: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>   2: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>   3: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>   4: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>   5: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>   6: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>   7: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>   8: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>   9: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
>>>>
>>>>> x
>>>> Neighbour list object:
>>>> Number of regions: 974
>>>> Number of nonzero links: 34802
>>>> Percentage nonzero weights: 3.668481
>>>> Average number of links: 35.73101
>>>>
>>>> One thought is that maybe I don't need the dnearneigh function and can
>>>> instead convert "int" into a dataframe and somehow merge or associate
>>>> (perhaps with an inner join) the ID fields of the buffered and intersecting
>>>> points and then compute the minimum value of "Conc" grouping by ID:
>>>>
>>>>> as.data.frame(int)
>>>>      row.id col.id
>>>> 1        1      1
>>>> 2        1      2
>>>> 3        1      3
>>>> 4        1      4
>>>> 5        1      5
>>>> 6        1      6
>>>> 7        1      7
>>>> 8        1      8
>>>> 9        1      9
>>>> 10       1     10
>>>> 11       1     11
>>>> 12       1     12
>>>> 13       1     13
>>>> 14       1     14
>>>> 15       1     15
>>>> 16       1     16
>>>> 17       1     17
>>>> 18       1     18
>>>> 19       2      1
>>>> 20       2      2
>>>> 21       2      3
>>>> 22       2      4
>>>> 23       2      5
>>>> 24       2      6
>>>> 25       2      7
>>>> 26       2      8
>>>> 27       2      9
>>>> 28       2     10
>>>>
>>>>
>>>> So in the above example I'd like to take the minimum of "Conc" among the
>>>> col.id points grouped with row.id 1 (i.e., col.ids 1-18) and assign the
>>>> minimum value of this group as a new variable in data (Data$Conc_min), and
>>>> do the same for row.id 2 and all the rest of the rows.
>>>>
>>>> I'm just not sure how to do this and I appreciate any help folks might
>>>> have on this matter!
>>>>
>>>> Many thanks,
>>>> -Tiffany
>>>>
>>>>          [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
> Caution: This message originated from outside of the Tufts University organization. Please exercise caution when clicking links or opening attachments. When in doubt, email the TTS Service Desk at it at tufts.edu<mailto:it at tufts.edu> or call them directly at 617-627-3376.
>
>
>        [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

--
Micha Silver
Ben Gurion Univ.
Sde Boker, Remote Sensing Lab
cell: +972-523-665918


	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Wed Nov  9 09:27:30 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Wed, 9 Nov 2022 11:27:30 +0300
Subject: [R] [External] Re: Selecting a minimum value of an attribute
 associated with point values neighboring a given point and assigning it as
 a new attribute
In-Reply-To: <BN6PR05MB3588DCB2A66A6048CD9D7645903E9@BN6PR05MB3588.namprd05.prod.outlook.com>
References: <BN6PR05MB35887EFE01222DBF7C359AAB903B9@BN6PR05MB3588.namprd05.prod.outlook.com>
 <CAGxFJbSkg9zAqk0dGcr3qJe2z2C04NEZFdHN8hWQA3oSbfHukQ@mail.gmail.com>
 <CAGgJW767Ein1S+MSywb57B2UtmE0EJodDVokPEx5_-c5BTFR1Q@mail.gmail.com>
 <CAGgJW77yY0_GDQWEAxzSdRh0N3kXgj9zrSEYUzuVsFnHyeE=aA@mail.gmail.com>
 <BN6PR05MB3588015F46997E64D5F8F138903D9@BN6PR05MB3588.namprd05.prod.outlook.com>
 <3247be10-6d5c-12d5-1634-2a9e934f431e@gmail.com>
 <BN6PR05MB3588DCB2A66A6048CD9D7645903E9@BN6PR05MB3588.namprd05.prod.outlook.com>
Message-ID: <20221109112730.58e405fa@Tarkus>

? Wed, 9 Nov 2022 02:38:15 +0000
"Duhl, Tiffany R." <Tiffany.Duhl at tufts.edu> ?????:

> MinConc <- function(x, lst, pts) {
>    Concs <- lapply(lst, function(p) {
>      pts$Conc[p]
>    })
>    return(min(Concs[[1]]))
> }

This function doesn't seem to use its first argument, x. Moreover,
its return value seems to only depend on the first element of its
second argument, lst.

> ###But I need the length of the list the function is applied to
> ###to be variable, depending on the length of the input csv file
> ###unlike the dummy variable dataframe that Eric used with a set
> ###length
> ###So I changed the "x" argument in lapply to "pts$X" but
> ###that generates an empty list
> 
> Conc_min <- lapply(pts$X, function(i){
>    MinConc(i, dist_matrix[i], pts)
> })

So instead of doing extra work to obtain the list indices (use
seq_along if you do need them) and to subset the one-element lists
returned by dist_matrix[i] (use dist_matrix[[i]] to get the value
instead of one-element list containing the value), it should be
possible to perform

Conc_min <- sapply(
 dist_matrix,
 function(neighbours) min(pts$Conc[neighbours])
)

This assumes that dist_matrix is of the same length as pts$X.

Admittedly, the example above can't consider each point by itself,
which isn't mentioned in dist_matrix (as far as I'm aware), so to
include the original point, we can run

mapply(
 function(point, neighbours) min(pts$Conc[point], pts$Conc[neighbours]),
 seq_along(pts$X), dist_matrix
)

-- 
Best regards,
Ivan


From @h@e|ebrown @end|ng |rom gm@||@com  Wed Nov  9 14:17:06 2022
From: @h@e|ebrown @end|ng |rom gm@||@com (Shael Brown)
Date: Wed, 9 Nov 2022 09:17:06 -0400
Subject: [R] [R-pkgs] TDApplied version 2.0.0
Message-ID: <CAESJsLuT6TdnaUATFV6pddbzxSLBqbQgGLGdmynwQoK9dZ_JRA@mail.gmail.com>

Dear R users,

I am very excited to announce TDApplied version 2.0.0 is now available on
CRAN, with some significant improvements to the previous version.

Topological data analysis is a powerful tool for finding non-linear global
structure in whole datasets. 'TDApplied' aims to bridge topological data
analysis with data, statistical and machine learning practitioners so that
more analyses may benefit from the power of topological data analysis. The
main tool of topological data analysis is persistent homology, which
computes a shape descriptor of a dataset, called a persistence diagram.

There are five goals of this package:

(1) convert persistence diagrams computed using the two main R packages for
topological data analysis into a data frame,
(2) implement fast versions of both distance and kernel calculations
    for pairs of persistence diagrams,
(3) provide methods for machine learning and inference for persistence
diagrams which scale well,
(4) deliver a fast implementation of persistent homology via a python
interface, and
(5) contribute tools for the interpretation of persistence diagrams.

For details and examples please check out the github page
https://github.com/shaelebrown/TDApplied or the README file on CRAN
https://cran.r-project.org/web/packages/TDApplied/readme/README.html

I sincerely hope that you will enjoy using this updated version and that it
helps the field of topological data analysis progress in both academia and
industry.

Best regards,
Shael

	[[alternative HTML version deleted]]

_______________________________________________
R-packages mailing list
R-packages at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-packages


From er|nm@hodge@@ @end|ng |rom gm@||@com  Fri Nov 11 02:45:50 2022
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Thu, 10 Nov 2022 18:45:50 -0700
Subject: [R] Plotting a triangular prism
Message-ID: <CACxE24kOTD4W_5D1Q4z-6T=TVPc4fJtshnpo+JXygArA72v6=w@mail.gmail.com>

Hello!

I?m trying to draw a triangular prism.  I have used rgl, plot3d, and it?s
still not working as I would like.

Has anyone done this, please?

Thanks for any help.

Sincerely,
Erin
-- 
Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From dw|n@em|u@ @end|ng |rom comc@@t@net  Fri Nov 11 06:32:09 2022
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Thu, 10 Nov 2022 21:32:09 -0800
Subject: [R] Plotting a triangular prism
In-Reply-To: <CACxE24kOTD4W_5D1Q4z-6T=TVPc4fJtshnpo+JXygArA72v6=w@mail.gmail.com>
References: <CACxE24kOTD4W_5D1Q4z-6T=TVPc4fJtshnpo+JXygArA72v6=w@mail.gmail.com>
Message-ID: <A0472FAD-E586-4982-B9F5-1D1EAEFF6E59@comcast.net>

One might think that after all these years you would have understood that ?it?s not working? is an excessively imprecise description of, well, anything. 

Also html is deprecated severely on Rhelp. 

? 
David. 

Sent from my iPhone

> On Nov 10, 2022, at 5:46 PM, Erin Hodgess <erinm.hodgess at gmail.com> wrote:
> 
> ?Hello!
> 
> I?m trying to draw a triangular prism.  I have used rgl, plot3d, and it?s
> still not working as I would like.
> 
> Has anyone done this, please?
> 
> Thanks for any help.
> 
> Sincerely,
> Erin
> -- 
> Erin Hodgess, PhD
> mailto: erinm.hodgess at gmail.com
> 
>    [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From drj|m|emon @end|ng |rom gm@||@com  Fri Nov 11 07:56:20 2022
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Fri, 11 Nov 2022 17:56:20 +1100
Subject: [R] Plotting a triangular prism
In-Reply-To: <A0472FAD-E586-4982-B9F5-1D1EAEFF6E59@comcast.net>
References: <CACxE24kOTD4W_5D1Q4z-6T=TVPc4fJtshnpo+JXygArA72v6=w@mail.gmail.com>
 <A0472FAD-E586-4982-B9F5-1D1EAEFF6E59@comcast.net>
Message-ID: <CA+8X3fU09PSn+FbMXJuaU2WEqoyD8oNYe+3aS=05J-USizFghg@mail.gmail.com>

Hi Erin,
If you want a realistic 3D prism, I would use something like POVRay or
other rendering software. You have to know your geometry, but you can
get a very realistic image. I suspect that you want more than just a
picture of a prism, so you can then generate a PNG image and use it as
a layer in a composite image in something like the GIMP.

Jim

> > On Nov 10, 2022, at 5:46 PM, Erin Hodgess <erinm.hodgess at gmail.com> wrote:
> >
> > ?Hello!
> >
> > I?m trying to draw a triangular prism.  I have used rgl, plot3d, and it?s
> > still not working as I would like.
> >
> > Has anyone done this, please?
> >
> > Thanks for any help.
> >
> > Sincerely,
> > Erin


From er|nm@hodge@@ @end|ng |rom gm@||@com  Fri Nov 11 14:57:24 2022
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Fri, 11 Nov 2022 06:57:24 -0700
Subject: [R] Plotting a triangular prism
In-Reply-To: <CA+8X3fU09PSn+FbMXJuaU2WEqoyD8oNYe+3aS=05J-USizFghg@mail.gmail.com>
References: <CACxE24kOTD4W_5D1Q4z-6T=TVPc4fJtshnpo+JXygArA72v6=w@mail.gmail.com>
 <A0472FAD-E586-4982-B9F5-1D1EAEFF6E59@comcast.net>
 <CA+8X3fU09PSn+FbMXJuaU2WEqoyD8oNYe+3aS=05J-USizFghg@mail.gmail.com>
Message-ID: <CACxE24mLPku2gUEZd8oxoYFPr-GM_pgaFpcz2JcPutPva1YdYA@mail.gmail.com>

Great, thank you!

Sincerely,
Erin

On Thu, Nov 10, 2022 at 11:56 PM Jim Lemon <drjimlemon at gmail.com> wrote:

> Hi Erin,
> If you want a realistic 3D prism, I would use something like POVRay or
> other rendering software. You have to know your geometry, but you can
> get a very realistic image. I suspect that you want more than just a
> picture of a prism, so you can then generate a PNG image and use it as
> a layer in a composite image in something like the GIMP.
>
> Jim
>
> > > On Nov 10, 2022, at 5:46 PM, Erin Hodgess <erinm.hodgess at gmail.com>
> wrote:
> > >
> > > ?Hello!
> > >
> > > I?m trying to draw a triangular prism.  I have used rgl, plot3d, and
> it?s
> > > still not working as I would like.
> > >
> > > Has anyone done this, please?
> > >
> > > Thanks for any help.
> > >
> > > Sincerely,
> > > Erin
>
-- 
Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From tebert @end|ng |rom u||@edu  Fri Nov 11 15:39:54 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Fri, 11 Nov 2022 14:39:54 +0000
Subject: [R] Plotting a triangular prism
In-Reply-To: <CACxE24kOTD4W_5D1Q4z-6T=TVPc4fJtshnpo+JXygArA72v6=w@mail.gmail.com>
References: <CACxE24kOTD4W_5D1Q4z-6T=TVPc4fJtshnpo+JXygArA72v6=w@mail.gmail.com>
Message-ID: <BN6PR2201MB1553449E9551D3DC5B5A6704CF009@BN6PR2201MB1553.namprd22.prod.outlook.com>

Hi Erin,
   Note that the HTML version was deleted in RHelp. Whatever was there was not seen by anyone else.
   Not sure this is what you want, but try "mixture designs in R" as a google search. There are a number of options therein. 

Regards,
Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Erin Hodgess
Sent: Thursday, November 10, 2022 8:46 PM
To: r-help at r-project.org
Subject: [R] Plotting a triangular prism

[External Email]

Hello!

I'm trying to draw a triangular prism.  I have used rgl, plot3d, and it's still not working as I would like.

Has anyone done this, please?

Thanks for any help.

Sincerely,
Erin
--
Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7Ccfbe4571548b4011129008dac38689c2%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638037279861726183%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=dQLlGf5Uf236fx75pj1PyyxV%2Fth6PWIoDxMQqfjzhYk%3D&amp;reserved=0
PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7Ccfbe4571548b4011129008dac38689c2%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638037279861726183%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=cvvGeOQDrPdZ7iRm8lPRKRiS4PF2q%2F4hdJYnUw34hQs%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.


From georgebr|d@94 @end|ng |rom gm@||@com  Fri Nov 11 22:17:14 2022
From: georgebr|d@94 @end|ng |rom gm@||@com (George Brida)
Date: Fri, 11 Nov 2022 22:17:14 +0100
Subject: [R] Logistic regression for large data
Message-ID: <CAA6O3ziAbEHc3-zAu6Rw7UzuxeJNqroSbe04O_r--wrTj=yvZQ@mail.gmail.com>

Dear R users,

I have a database  called Base.csv   (attached to this email) which
contains 13 columns and 8257 rows and whose the first 8 columns are dummy
variables which take 1 or 0. The problem is when I wrote the following
instructions to do a logistic regression , R runs for hours and hours
without giving an output:

Base=read.csv("C:\\Users\\HP\\Desktop\\New\\Base.csv",header=FALSE,sep=";")
fit_1=glm(Base[,2]~Base[,1]+Base[,10]+Base[,11]+Base[,12]+Base[,13],family=binomial(link="logit"))

Apparently, there is not enough memory to have the requested output. Is
there any other function for logistic regression that handle large data and
return output in reasonable time.

Many thanks

Kind regards

George

From dw|n@em|u@ @end|ng |rom comc@@t@net  Sat Nov 12 08:36:01 2022
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Fri, 11 Nov 2022 23:36:01 -0800
Subject: [R] Logistic regression for large data
In-Reply-To: <CAA6O3ziAbEHc3-zAu6Rw7UzuxeJNqroSbe04O_r--wrTj=yvZQ@mail.gmail.com>
References: <CAA6O3ziAbEHc3-zAu6Rw7UzuxeJNqroSbe04O_r--wrTj=yvZQ@mail.gmail.com>
Message-ID: <3D3BBAC8-7D6F-4AB9-B7D6-6A754E21BFBE@comcast.net>

That?s not a large data set. Something else besides memory limits is going on. You should post output of summary(Base). 

? 
David
Sent from my iPhone

> On Nov 11, 2022, at 11:29 PM, George Brida <georgebrida94 at gmail.com> wrote:
> 
> ?Dear R users,
> 
> I have a database  called Base.csv   (attached to this email) which
> contains 13 columns and 8257 rows and whose the first 8 columns are dummy
> variables which take 1 or 0. The problem is when I wrote the following
> instructions to do a logistic regression , R runs for hours and hours
> without giving an output:
> 
> Base=read.csv("C:\\Users\\HP\\Desktop\\New\\Base.csv",header=FALSE,sep=";")
> fit_1=glm(Base[,2]~Base[,1]+Base[,10]+Base[,11]+Base[,12]+Base[,13],family=binomial(link="logit"))
> 
> Apparently, there is not enough memory to have the requested output. Is
> there any other function for logistic regression that handle large data and
> return output in reasonable time.
> 
> Many thanks
> 
> Kind regards
> 
> George
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From tebert @end|ng |rom u||@edu  Sat Nov 12 14:37:03 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Sat, 12 Nov 2022 13:37:03 +0000
Subject: [R] Logistic regression for large data
In-Reply-To: <CAA6O3ziAbEHc3-zAu6Rw7UzuxeJNqroSbe04O_r--wrTj=yvZQ@mail.gmail.com>
References: <CAA6O3ziAbEHc3-zAu6Rw7UzuxeJNqroSbe04O_r--wrTj=yvZQ@mail.gmail.com>
Message-ID: <BN6PR2201MB15538F30F924C2F830756F4ECF039@BN6PR2201MB1553.namprd22.prod.outlook.com>

Hi George,
   I did not get an attachment.
   My first step would be to try simplifying things. Do all of these work?

fit_1=glm(Base[,2]~Base[,1],family=binomial(link="logit"))
fit_1=glm(Base[,2]~Base[,10],family=binomial(link="logit"))
fit_1=glm(Base[,2]~Base[,11],family=binomial(link="logit"))
fit_1=glm(Base[,2]~Base[,12],family=binomial(link="logit"))
fit_1=glm(Base[,2]~Base[,13],family=binomial(link="logit"))

This is not a large dataset. That said, if your computer is nearly out of memory, even a small dataset might be too much. It might have plenty of physical memory, but also lots of (open files, cookies, applications, other stuff) that eat memory.

Regards,
Tim



-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of George Brida
Sent: Friday, November 11, 2022 4:17 PM
To: r-help at r-project.org
Subject: [R] Logistic regression for large data

[External Email]

Dear R users,

I have a database  called Base.csv   (attached to this email) which
contains 13 columns and 8257 rows and whose the first 8 columns are dummy variables which take 1 or 0. The problem is when I wrote the following instructions to do a logistic regression , R runs for hours and hours without giving an output:

Base=read.csv("C:\\Users\\HP\\Desktop\\New\\Base.csv",header=FALSE,sep=";")
fit_1=glm(Base[,2]~Base[,1]+Base[,10]+Base[,11]+Base[,12]+Base[,13],family=binomial(link="logit"))

Apparently, there is not enough memory to have the requested output. Is there any other function for logistic regression that handle large data and return output in reasonable time.

Many thanks

Kind regards

George
______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7Cb0af80b8620648fcc1ab08dac47fb19e%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638038350110240752%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&amp;sdata=oxeFwGCpH%2B9Ha%2BDFaWRygEcvOJ2O6AngSKNhMwE%2FczI%3D&amp;reserved=0
PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7Cb0af80b8620648fcc1ab08dac47fb19e%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638038350110240752%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&amp;sdata=FtLW709kbnkMLzylkRRtR1Y%2Fw5oehodb0dmS8DqwGig%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.


From gpetr|@ @end|ng |rom u@rk@edu  Sat Nov 12 21:04:57 2022
From: gpetr|@ @end|ng |rom u@rk@edu (Giovanni Petris)
Date: Sat, 12 Nov 2022 20:04:57 +0000
Subject: [R] How to make a deep copy of a list?
Message-ID: <SN4PR0401MB3549D2490609EBE15BDDD7FDC3039@SN4PR0401MB3549.namprd04.prod.outlook.com>

Hello everybody,

Does anybody know how to obtain a deep copy of a list?

The context is the following. I am passing a list to a function which, in turn, passes it to compiled C code via .Call. The problem is that the C code modifies elements of the list so that, after the R function returns, I end up with a modified version of the list argument. I believe passing to the function a deep copy of the list argument would solve my problem.

Thank you in advance for the help!

Giovanni

--
Giovanni Petris
Professor and Director of Statistics
Department of Mathematical Sciences
University of Arkansas
Fayetteville, AR 72701
USA



	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sat Nov 12 21:19:36 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sat, 12 Nov 2022 12:19:36 -0800
Subject: [R] How to make a deep copy of a list?
In-Reply-To: <SN4PR0401MB3549D2490609EBE15BDDD7FDC3039@SN4PR0401MB3549.namprd04.prod.outlook.com>
References: <SN4PR0401MB3549D2490609EBE15BDDD7FDC3039@SN4PR0401MB3549.namprd04.prod.outlook.com>
Message-ID: <6211589B-7312-4B33-956C-9BDA89E9F033@dcn.davis.ca.us>

Or modifying the C code to conform with the usual functional copy-on-write paradigm used throughout most of R.

On November 12, 2022 12:04:57 PM PST, Giovanni Petris <gpetris at uark.edu> wrote:
>Hello everybody,
>
>Does anybody know how to obtain a deep copy of a list?
>
>The context is the following. I am passing a list to a function which, in turn, passes it to compiled C code via .Call. The problem is that the C code modifies elements of the list so that, after the R function returns, I end up with a modified version of the list argument. I believe passing to the function a deep copy of the list argument would solve my problem.
>
>Thank you in advance for the help!
>
>Giovanni
>
>--
>Giovanni Petris
>Professor and Director of Statistics
>Department of Mathematical Sciences
>University of Arkansas
>Fayetteville, AR 72701
>USA
>
>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From kry|ov@r00t @end|ng |rom gm@||@com  Sat Nov 12 21:20:03 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sat, 12 Nov 2022 23:20:03 +0300
Subject: [R] How to make a deep copy of a list?
In-Reply-To: <SN4PR0401MB3549D2490609EBE15BDDD7FDC3039@SN4PR0401MB3549.namprd04.prod.outlook.com>
References: <SN4PR0401MB3549D2490609EBE15BDDD7FDC3039@SN4PR0401MB3549.namprd04.prod.outlook.com>
Message-ID: <20221112232003.31242f93@Tarkus>

? Sat, 12 Nov 2022 20:04:57 +0000
Giovanni Petris <gpetris at uark.edu> ?????:

> The problem is that the C code modifies elements of the list so that,
> after the R function returns, I end up with a modified version of the
> list argument. I believe passing to the function a deep copy of the
> list argument would solve my problem.

Is it an option to change the C code? I think that the fault lies with
it, not with its caller. Except when using reference types, it should
be safe to make the assumption that variables in R are passed as if by
copy.

In the interest of getting a quick workaround, does
unserialize(serialize(L, NULL)) help? I would expect that to work unless
your list contains something like environments.

-- 
Best regards,
Ivan


From d@t@|owe @end|ng |rom po@teo@de  Fri Nov 11 18:27:55 2022
From: d@t@|owe @end|ng |rom po@teo@de (Lowe Wilsson)
Date: Fri, 11 Nov 2022 17:27:55 +0000
Subject: [R] [R-pkgs] synr: Analyze stimulus-color consistency test data
Message-ID: <eecad148a1987e4f8b053b564c614158@posteo.de>

 Dear fellow useRs,

synr is an R package for working with data resulting from so-called
consistency tests, aimed at studying associations between stimuli and
colors. A simple example of such an association is if someone
experiences the color blue when hearing a particular word, or seeing the
letter 7 as red even if it is printed in black. The package, like
consistency tests, is especially relevant for synesthesia research but
may be of use to others researching color experiences. Yet others might
be interested in how the package utilizes the DBSCAN clustering
algorithm to evaluate variation in 3D space point coordinates.

You can learn more in an article just published in Behavior Research
Methods, "synr: An R package for handling synesthesia consistency test
data": https://rdcu.be/cZrrh [1]

The package itself also includes comprehensive vignettes explaining its
use. CRAN link: https://cran.r-project.org/web/packages/synr/index.html
[2]

Issue reports and contributions are very welcome on GitHub:
https://github.com/datalowe/synr [3] I've also created a GitHub page
with Packrat which includes nicely-formatted versions of the vignettes:
https://datalowe.github.io/synr [4]

I hope you'll find the package useful!

Sincerely,
Lowe Wilsson 

Links:
------
[1] https://rdcu.be/cZrrh
[2] https://cran.r-project.org/web/packages/synr/index.html
[3] https://github.com/datalowe/synr
[4] https://datalowe.github.io/synr

	[[alternative HTML version deleted]]

_______________________________________________
R-packages mailing list
R-packages at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-packages


From n|ckmwr@y @end|ng |rom gm@||@com  Mon Nov 14 14:04:31 2022
From: n|ckmwr@y @end|ng |rom gm@||@com (Nick Wray)
Date: Mon, 14 Nov 2022 13:04:31 +0000
Subject: [R] Rate of Reading into R from net
Message-ID: <CABxY9BPdUBp_jxQHi9+u4h_1fMgLd862SkoQQff7jw6jHKOqYA@mail.gmail.com>

Hello I am trying read  nc rainfall  files directly from the UK centre for
hydrology and ecology website -
hourly:about 300Mb
https://catalogue.ceh.ac.uk/datastore/eidchub/fc9423d6-3d54-467f-bb2b-fc7357a3941f/
and daily about 90Mb
https://catalogue.ceh.ac.uk/datastore/eidchub/2ab15bf0-ad08-415c-ba64-831168be7293/precip/

I can download them "by hand" no problem using the ncdf4 package but
there's lots and I wanted to streamline the process

code I've used (which works for "by hand" downloading) is (for example)

nc_data<-nc_open("
https://catalogue.ceh.ac.uk/datastore/eidchub/2ab15bf0-ad08-415c-ba64-831168be7293/precip/chess-met_precip_gb_1km_daily_19610301-19610331.nc
")

However, when I run this I don't get an error message but R just sits there
with the little red circle (at least 30 minutes for the 90Mb files)

What I'm wondering is two things - a)is the data in fact downloading but
it's just taking ages and I need to let it run and go and have a coffee
                                                   b)is there (I can't find
anything) within R which allows me to monitor the progress of the download,
if in fact it is taking place?
Thanks Nick Wray

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Mon Nov 14 14:25:31 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Mon, 14 Nov 2022 16:25:31 +0300
Subject: [R] Rate of Reading into R from net
In-Reply-To: <CABxY9BPdUBp_jxQHi9+u4h_1fMgLd862SkoQQff7jw6jHKOqYA@mail.gmail.com>
References: <CABxY9BPdUBp_jxQHi9+u4h_1fMgLd862SkoQQff7jw6jHKOqYA@mail.gmail.com>
Message-ID: <20221114162531.7df503b8@arachnoid>

? Mon, 14 Nov 2022 13:04:31 +0000
Nick Wray <nickmwray at gmail.com> ?????:

> nc_data<-nc_open("
> https://catalogue.ceh.ac.uk/datastore/eidchub/2ab15bf0-ad08-415c-ba64-831168be7293/precip/chess-met_precip_gb_1km_daily_19610301-19610331.nc
> ")
> 
> However, when I run this I don't get an error message but R just sits
> there with the little red circle (at least 30 minutes for the 90Mb
> files)

Not sure why it just sits there, but looking at the package source
code, I can see that ncdf4::nc_open eventually forwards its arguments
to the nc_open function from the netcdf library:

https://github.com/cran/ncdf4/blob/1.19/R/ncdf4.R#L568
https://github.com/cran/ncdf4/blob/1.19/src/ncdf.c#L862
https://docs.unidata.ucar.edu/netcdf-c/current/group__datasets.html#gaccbdb128a1640e204831256dbbc24d3e

netcdf does support some form of remote file access, but only
OPeNDAP-compatible URLs are supposed to work. Your links ask me to log
in, which may mean that they won't work with netcdf. It might be easier
to use one of the R packages that let you work with libcurl and give
them the cookies from your browser in order to download the files
first, then access them.

See also: https://stackoverflow.com/a/70368135

What does ncdump say about these URLs?

-- 
Best regards,
Ivan

[1] 


From e@ @end|ng |rom enr|co@chum@nn@net  Mon Nov 14 14:37:58 2022
From: e@ @end|ng |rom enr|co@chum@nn@net (Enrico Schumann)
Date: Mon, 14 Nov 2022 14:37:58 +0100
Subject: [R] Rate of Reading into R from net
In-Reply-To: <CABxY9BPdUBp_jxQHi9+u4h_1fMgLd862SkoQQff7jw6jHKOqYA@mail.gmail.com>
 (Nick Wray's message of "Mon, 14 Nov 2022 13:04:31 +0000")
References: <CABxY9BPdUBp_jxQHi9+u4h_1fMgLd862SkoQQff7jw6jHKOqYA@mail.gmail.com>
Message-ID: <877czxbqrt.fsf@enricoschumann.net>

On Mon, 14 Nov 2022, Nick Wray writes:

> Hello I am trying read  nc rainfall  files directly from the UK centre for
> hydrology and ecology website -
> hourly:about 300Mb
> https://catalogue.ceh.ac.uk/datastore/eidchub/fc9423d6-3d54-467f-bb2b-fc7357a3941f/
> and daily about 90Mb
> https://catalogue.ceh.ac.uk/datastore/eidchub/2ab15bf0-ad08-415c-ba64-831168be7293/precip/
>
> I can download them "by hand" no problem using the ncdf4 package but
> there's lots and I wanted to streamline the process
>
> code I've used (which works for "by hand" downloading) is (for example)
>
> nc_data<-nc_open("
> https://catalogue.ceh.ac.uk/datastore/eidchub/2ab15bf0-ad08-415c-ba64-831168be7293/precip/chess-met_precip_gb_1km_daily_19610301-19610331.nc
> ")
>
> However, when I run this I don't get an error message but R just sits there
> with the little red circle (at least 30 minutes for the 90Mb files)
>
> What I'm wondering is two things - a)is the data in fact downloading but
> it's just taking ages and I need to let it run and go and have a coffee
>                                                    b)is there (I can't find
> anything) within R which allows me to monitor the progress of the download,
> if in fact it is taking place?
> Thanks Nick Wray
>

Have you tried 'download.file'?  It should provide a
progress bar if the file size is known.  I'd first
download the file, and then read it.


-- 
Enrico Schumann
Lucerne, Switzerland
http://enricoschumann.net


From w||||@mwdun|@p @end|ng |rom gm@||@com  Mon Nov 14 16:44:45 2022
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Mon, 14 Nov 2022 07:44:45 -0800
Subject: [R] Logistic regression for large data
In-Reply-To: <CAA6O3ziAbEHc3-zAu6Rw7UzuxeJNqroSbe04O_r--wrTj=yvZQ@mail.gmail.com>
References: <CAA6O3ziAbEHc3-zAu6Rw7UzuxeJNqroSbe04O_r--wrTj=yvZQ@mail.gmail.com>
Message-ID: <CAHqSRuQRDMPNbHk0C_iTCUb5mJhNh9tVg0jd-czJB+paOLjp3Q@mail.gmail.com>

summary(Base)

would show if one of columns of Base was read as character data instead of
the expected numeric.  That could cause an explosion in the number of dummy
variables, hence a huge design matrix.

-Bill


On Fri, Nov 11, 2022 at 11:30 PM George Brida <georgebrida94 at gmail.com>
wrote:

> Dear R users,
>
> I have a database  called Base.csv   (attached to this email) which
> contains 13 columns and 8257 rows and whose the first 8 columns are dummy
> variables which take 1 or 0. The problem is when I wrote the following
> instructions to do a logistic regression , R runs for hours and hours
> without giving an output:
>
> Base=read.csv("C:\\Users\\HP\\Desktop\\New\\Base.csv",header=FALSE,sep=";")
>
> fit_1=glm(Base[,2]~Base[,1]+Base[,10]+Base[,11]+Base[,12]+Base[,13],family=binomial(link="logit"))
>
> Apparently, there is not enough memory to have the requested output. Is
> there any other function for logistic regression that handle large data and
> return output in reasonable time.
>
> Many thanks
>
> Kind regards
>
> George
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From r@g|@11 @end|ng |rom hotm@||@com  Tue Nov 15 00:22:51 2022
From: r@g|@11 @end|ng |rom hotm@||@com (Ragia .)
Date: Mon, 14 Nov 2022 23:22:51 +0000
Subject: [R] ubuntu 22
Message-ID: <PAXP194MB1502217BBC0B17AC3EDF9297B3059@PAXP194MB1502.EURP194.PROD.OUTLOOK.COM>


  dear group ,
cant install r base into ubuntu 22.
the msg is
The following packages have unmet dependencies:
 r-base-core : Depends: libicu70 (>= 70.1-1~) but it is not installable
               Recommends: r-recommended but it is not going to be installed
               Recommends: r-doc-html but it is not going to be installed
E: Unable to correct problems, you have held broken packages.
thanks in advance

	[[alternative HTML version deleted]]


From dw|n@em|u@ @end|ng |rom comc@@t@net  Tue Nov 15 00:53:58 2022
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Mon, 14 Nov 2022 15:53:58 -0800
Subject: [R] unmet dependency for r-base-core ... was Re:  ubuntu 22
In-Reply-To: <PAXP194MB1502217BBC0B17AC3EDF9297B3059@PAXP194MB1502.EURP194.PROD.OUTLOOK.COM>
References: <PAXP194MB1502217BBC0B17AC3EDF9297B3059@PAXP194MB1502.EURP194.PROD.OUTLOOK.COM>
Message-ID: <95531558-04de-2279-a465-e74cfa5e3e76@comcast.net>


On 11/14/22 15:22, Ragia . wrote:
>    dear group ,
> cant install r base into ubuntu 22.
> the msg is
> The following packages have unmet dependencies:
>   r-base-core : Depends: libicu70 (>= 70.1-1~) but it is not installable


Have you tried looking up the package that would contain libicu70?? I 
had no problem locating a copy of libicu70_70.1-2_amd64.deb 
<https://ubuntu.pkgs.org/22.04/ubuntu-main-amd64/libicu70_70.1-2_amd64.deb.html> 
with search terms: "libicu70 ubuntu 22".


>                 Recommends: r-recommended but it is not going to be installed
>                 Recommends: r-doc-html but it is not going to be installed
> E: Unable to correct problems, you have held broken packages.
> thanks in advance
>
> 	[[alternative HTML version deleted]]


Do note that Rhelp is a plain text mailing list. And further note that 
the proper mailing list (also plain text) would have been R-SIG-debian.


-- 

David.

>
> ______________________________________________
> R-help at r-project.org  mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guidehttp://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Tue Nov 15 00:58:22 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Mon, 14 Nov 2022 15:58:22 -0800
Subject: [R] ubuntu 22
In-Reply-To: <PAXP194MB1502217BBC0B17AC3EDF9297B3059@PAXP194MB1502.EURP194.PROD.OUTLOOK.COM>
References: <PAXP194MB1502217BBC0B17AC3EDF9297B3059@PAXP194MB1502.EURP194.PROD.OUTLOOK.COM>
Message-ID: <930ECF3E-940B-4A9B-B4BB-147E2DFDB63E@dcn.davis.ca.us>

Seems like a problem with your system package manager repository configuration. Maybe better pursued on the R-sig-debian mailing list (Ubuntu is derived from Debian). Be sure to describe exactly what you did (e.g. which web page instructions did you follow).

On November 14, 2022 3:22:51 PM PST, "Ragia ." <ragia11 at hotmail.com> wrote:
>
>  dear group ,
>cant install r base into ubuntu 22.
>the msg is
>The following packages have unmet dependencies:
> r-base-core : Depends: libicu70 (>= 70.1-1~) but it is not installable
>               Recommends: r-recommended but it is not going to be installed
>               Recommends: r-doc-html but it is not going to be installed
>E: Unable to correct problems, you have held broken packages.
>thanks in advance
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


