From rmh @end|ng |rom temp|e@edu  Fri Mar  1 00:12:14 2024
From: rmh @end|ng |rom temp|e@edu (Richard M. Heiberger)
Date: Thu, 29 Feb 2024 23:12:14 +0000
Subject: [R] [External]  converting MATLAB -> R | element-wise operation
In-Reply-To: <297DC7D4-CD0A-4EE9-A733-BDF59B86A8E4@gmail.com>
References: <8ec0980a-1988-484d-bd30-6837f5467e1a@gmail.com>
 <393E5DD9-BFA1-44E2-A0B3-F3FD1BB29729@dcn.davis.ca.us>
 <297DC7D4-CD0A-4EE9-A733-BDF59B86A8E4@gmail.com>
Message-ID: <B07BE572-BFAA-4EC3-8D69-28AE94330FB5@temple.edu>

I decided to do a direct comparison of transpose and sweep.


library(microbenchmark)

NN <- matrix(c(1, 2, 3, 4, 5, 6), nrow = 2, byrow = TRUE)  # Example matrix
lambda <- c(2, 3, 4)  # Example vector
colNN <- t(NN)

microbenchmark(
  sweep     = sweep(NN, 2, lambda, "/"),
  transpose = t(t(NN)/lambda),
  colNN     = colNN/lambda
)


Unit: nanoseconds
      expr   min    lq     mean median      uq   max neval cld
     sweep 13817 14145 15115.06  14350 14657.5 75932   100 a  
 transpose  1845  1927  2151.68   2132  2214.0  7093   100  b 
     colNN    82   123   141.86    123   164.0   492   100   c

Note that transpose is much faster than sweep because it is doing less work,
I believe essentially just changing the order of indexing.

Using the natural sequencing for column-ordered matrices is much much faster.

> On Feb 28, 2024, at 18:43, peter dalgaard <pdalgd at gmail.com> wrote:
> 
>> rbind(1:3,4:6)/t(matrix(c(2,3,4), 3,2))


From |eo@m@d@ @end|ng |rom @yon|c@eu  Fri Mar  1 01:28:18 2024
From: |eo@m@d@ @end|ng |rom @yon|c@eu (Leo Mada)
Date: Fri, 1 Mar 2024 00:28:18 +0000
Subject: [R] Clustering Functions used by Reverse-Dependencies
In-Reply-To: <20240228113619.676990bc@Tarkus>
References: <VI1P192MB0095C4BE0EB8BE16FAABD3D884542@VI1P192MB0095.EURP192.PROD.OUTLOOK.COM>
 <20240228113619.676990bc@Tarkus>
Message-ID: <VI1P192MB0095BC51A36ACA9F44314602845F2@VI1P192MB0095.EURP192.PROD.OUTLOOK.COM>

Dear Ivan,

Thank you very much for this interesting information.

Regarding:
"For well-behaved packages that declare their dependencies correctly,
parsing the NAMESPACE for importFrom() and import() calls should give
you the explicit imports."

I did learn something new (I am not very experienced in package writing). Unfortunately, Roxygen2 as of the current version still suggests to use the pkg::fname approach:
"If you are using just a few functions from another package, we recommending adding the package to the Imports: field of the DESCRIPTION file and calling the functions explicitly using ::, e.g., pkg::fun()."
https://roxygen2.r-lib.org/articles/namespace.html

Regarding analysing the actual code: it is good to know that CMD check has also some functionality. I will look into it, when I find some free time.

tools:::.check_packages_used is a few pages of code. On the other hand, the help page for codetools::checkUsage is quite cryptic. But it's good to know at least where to look.

Sincerely,

Leonard

________________________________
From: Ivan Krylov <ikrylov at disroot.org>
Sent: Wednesday, February 28, 2024 10:36 AM
To: Leo Mada via R-help <r-help at r-project.org>
Cc: Leo Mada <leo.mada at syonic.eu>
Subject: Re: [R] Clustering Functions used by Reverse-Dependencies

? Sat, 24 Feb 2024 03:08:26 +0000
Leo Mada via R-help <r-help at r-project.org> ?????:

> Are there any tools to extract the function names called by
> reverse-dependencies?

For well-behaved packages that declare their dependencies correctly,
parsing the NAMESPACE for importFrom() and import() calls should give
you the explicit imports. (What if the package imports the whole
dependency? The safe assumption is that all functions are used, but it
comes with false positives. You could also walk the package code
looking for function names that may belong to the imported package, but
that may involve both false positives and false negatives.)

For the rest of the imports and uses of weak dependencies, you'll have
to walk the package code looking for the uses of the `::` operator. See
how R CMD check walks the package code in functions
tools:::.check_packages_used and codetools::checkUsage.

A less-well-behaved package can always load a namespace during runtime
and choose the functions to call depending on the phase of the moon or
weather on Jupiter. For these, like for the halting problem, there's no
general solution: the package could be written to say, "if Leonard's
function says I'm about to call foo::bar, I won't do it, otherwise I
will".

--
Best regards,
Ivan

	[[alternative HTML version deleted]]


From rmh @end|ng |rom temp|e@edu  Fri Mar  1 04:12:02 2024
From: rmh @end|ng |rom temp|e@edu (Richard M. Heiberger)
Date: Fri, 1 Mar 2024 03:12:02 +0000
Subject: [R] [External]  converting MATLAB -> R | element-wise operation
In-Reply-To: <B07BE572-BFAA-4EC3-8D69-28AE94330FB5@temple.edu>
References: <8ec0980a-1988-484d-bd30-6837f5467e1a@gmail.com>
 <393E5DD9-BFA1-44E2-A0B3-F3FD1BB29729@dcn.davis.ca.us>
 <297DC7D4-CD0A-4EE9-A733-BDF59B86A8E4@gmail.com>
 <B07BE572-BFAA-4EC3-8D69-28AE94330FB5@temple.edu>
Message-ID: <65420ED3-7098-46BF-9213-B349B210E6FE@temple.edu>

I added two more rows

library(microbenchmark)

NN <- matrix(c(1, 2, 3, 4, 5, 6), nrow = 2, byrow = TRUE)  # Example matrix
lambda <- c(2, 3, 4)  # Example vector
colNN <- t(NN)
matlam <- matrix(lambda, byrow=TRUE, nrow=2, ncol=3)

microbenchmark(
  sweep     = sweep(NN, 2, lambda, "/"),
  transpose = t(t(NN)/lambda),
  colNN     = colNN/lambda,
  fullsize  = NN / matrix(lambda, byrow=TRUE, nrow=2, ncol=3),
  rowlam  = NN / matlam
)

Unit: nanoseconds
      expr   min    lq     mean  median      uq   max neval cld
     sweep 12546 12792 13919.91 12997.0 13325.0 85608   100 a
 transpose  1640  1763  1986.04  1947.5  2050.0  7462   100  b
     colNN    82    82   161.13   123.0   123.0  3854   100   c
  fullsize   738   820   932.34   881.5   963.5  2829   100  bc
    rowlam    82   123   168.92   164.0   164.0   820   100   c

reshaping the denominator to the correct size in advance is very helpful if you will be doing this division more than once.



> On Feb 29, 2024, at 18:12, Richard M. Heiberger <rmh at temple.edu> wrote:
>
> I decided to do a direct comparison of transpose and sweep.
>
>
> library(microbenchmark)
>
> NN <- matrix(c(1, 2, 3, 4, 5, 6), nrow = 2, byrow = TRUE)  # Example matrix
> lambda <- c(2, 3, 4)  # Example vector
> colNN <- t(NN)
>
> microbenchmark(
>  sweep     = sweep(NN, 2, lambda, "/"),
>  transpose = t(t(NN)/lambda),
>  colNN     = colNN/lambda
> )
>
>
> Unit: nanoseconds
>      expr   min    lq     mean median      uq   max neval cld
>     sweep 13817 14145 15115.06  14350 14657.5 75932   100 a
> transpose  1845  1927  2151.68   2132  2214.0  7093   100  b
>     colNN    82   123   141.86    123   164.0   492   100   c
>
> Note that transpose is much faster than sweep because it is doing less work,
> I believe essentially just changing the order of indexing.
>
> Using the natural sequencing for column-ordered matrices is much much faster.
>
>> On Feb 28, 2024, at 18:43, peter dalgaard <pdalgd at gmail.com> wrote:
>>
>>> rbind(1:3,4:6)/t(matrix(c(2,3,4), 3,2))
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.r-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ev@n@cooch @end|ng |rom gm@||@com  Fri Mar  1 02:40:00 2024
From: ev@n@cooch @end|ng |rom gm@||@com (Evan Cooch)
Date: Thu, 29 Feb 2024 20:40:00 -0500
Subject: [R] [External]  converting MATLAB -> R | element-wise operation
In-Reply-To: <B07BE572-BFAA-4EC3-8D69-28AE94330FB5@temple.edu>
References: <8ec0980a-1988-484d-bd30-6837f5467e1a@gmail.com>
 <393E5DD9-BFA1-44E2-A0B3-F3FD1BB29729@dcn.davis.ca.us>
 <297DC7D4-CD0A-4EE9-A733-BDF59B86A8E4@gmail.com>
 <B07BE572-BFAA-4EC3-8D69-28AE94330FB5@temple.edu>
Message-ID: <cd30267e-a990-46b7-a158-8bc9a3e34232@gmail.com>

Very interesting - thanks! Most of my problems are not limited by 
compute speed, but its clear that for some sorts of compute-intensive 
problems, sweep might be a limiting approach.

On 2/29/2024 6:12 PM, Richard M. Heiberger wrote:
> I decided to do a direct comparison of transpose and sweep.
>
>
> library(microbenchmark)
>
> NN <- matrix(c(1, 2, 3, 4, 5, 6), nrow = 2, byrow = TRUE)  # Example matrix
> lambda <- c(2, 3, 4)  # Example vector
> colNN <- t(NN)
>
> microbenchmark(
>    sweep     = sweep(NN, 2, lambda, "/"),
>    transpose = t(t(NN)/lambda),
>    colNN     = colNN/lambda
> )
>
>
> Unit: nanoseconds
>        expr   min    lq     mean median      uq   max neval cld
>       sweep 13817 14145 15115.06  14350 14657.5 75932   100 a
>   transpose  1845  1927  2151.68   2132  2214.0  7093   100  b
>       colNN    82   123   141.86    123   164.0   492   100   c
>
> Note that transpose is much faster than sweep because it is doing less work,
> I believe essentially just changing the order of indexing.
>
> Using the natural sequencing for column-ordered matrices is much much faster.
>
>> On Feb 28, 2024, at 18:43, peter dalgaard<pdalgd at gmail.com>  wrote:
>>
>>> rbind(1:3,4:6)/t(matrix(c(2,3,4), 3,2))
>

	[[alternative HTML version deleted]]


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Fri Mar  1 09:49:19 2024
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Fri, 1 Mar 2024 09:49:19 +0100
Subject: [R] converting MATLAB -> R | element-wise operation
In-Reply-To: <20240228174227.38c5a060@dep59159.uniwa.uwa.edu.au>
References: <8ec0980a-1988-484d-bd30-6837f5467e1a@gmail.com>
 <393E5DD9-BFA1-44E2-A0B3-F3FD1BB29729@dcn.davis.ca.us>
 <20240228174227.38c5a060@dep59159.uniwa.uwa.edu.au>
Message-ID: <26081.38543.928756.456074@stat.math.ethz.ch>

>>>>> Berwin A Turlach 
>>>>>     on Wed, 28 Feb 2024 17:42:27 +0800 writes:

    > On Tue, 27 Feb 2024 13:51:25 -0800 Jeff Newmiller via
    > R-help <r-help at r-project.org> wrote:

    >> The fundamental data type in Matlab is a matrix... they
    >> don't have vectors, they have Nx1 matrices and 1xM
    >> matrices.

    > Also known as column vectors and row vectors.  :)
 
    >> Vectors don't have any concept of "row" vs. "column".

    > They do in (numerical) linear algebra.  And MATLAB was
    > written by numerical analysts for numerical analysts. :-)
    > So they distinguish between row and column vectors.

    > GAUSS also distinguishes between row and column vectors.

There are *vectors* and they belong to a vector space and that's it.
(and yes, arrays of a given rank and dimensions also are
 elements of a vector space, and hence matrices are, and then
 indeed, a 3x1 matrix and a 1x3 matrix are *not* members of the
 same vector space -- even though the two vector spaces are
 isomorphic to each other)

The matlab induced --> applied linear algebra / math
"column- and row-vectors"  have been convenient because then
everything is a matrix (or scalar), and that fits well with a
product called "matlab" which is short for "matrix lab(oratory)".
BUT they are  mathematically confusing and therefore in my view
very undesirable terminology.

I'm very very strongly with Jeff that "the only" consistent
language would be to call them 1-row matrix and 1-column matrix,
because that's what they are, well defined and perfect within 
the well defined math realm of linear algebra.

Yes, matrix-vector calculus , scalar products, bilinear forms, ...
can be generalized in such ways that 1-row matrices and 1-column
matrices can be treated equivalently to vectors and vice versa
.. and that is sometimes convenient. 

Still, the "column-vector"  and "row-vector"  terms have
lead to much confusion in my view,
because really  Nx1  or  1xM  are dimensions of matrices and
*not* of any vectors  ..


    > R (and S) does not distinguish between row and column
    > vectors, and is in this aspect quite unique among the
    > groups of vector-oriented programming languages (AFAICT).

I agree. And that's good -- because "vectors are vectors" aka
"a rank-1 array is a rank-1 array is a rank-1 array" (Richard O'Keefe)

    > But treating every vector as a column vector, together
    > with the recycling rule, allows for the easy coding of the
    > matrix/vector calculations that one (mostly) comes across
    > in statistical computing.  For the rare occasion when this
    > is not true the sweep() command is provided, typically
    > remembered once one was bitten by the lack of distinction
    > between row and column vectors. :)

    > Cheers,
    > 	Berwin

Martin


From |@go@g|ne @end|ng |rom @jd@e@  Fri Mar  1 12:36:46 2024
From: |@go@g|ne @end|ng |rom @jd@e@ (=?UTF-8?Q?Iago_Gin=C3=A9_V=C3=A1zquez?=)
Date: Fri, 1 Mar 2024 12:36:46 +0100
Subject: [R] gsub issue with consecutive pattern finds
Message-ID: <ce1383d4-8339-47a3-b56c-11c4759e905a@sjd.es>

Hi all,

I tested next command:

gsub("([aeiouAEIOU])([aeiouAEIOU])", "\\1_\\2", "aerioue")

with the following output:

[1] "a_eri_ou_e"

So, there are two consecutive vowels where an underscore is not added.

May it be a bug? Is it expected (bug or not)? Is there any chance to get 
what I want (an underscore between each pair of consecutive vowels)?


Thank you!

Best regards,

Iago

	[[alternative HTML version deleted]]


From |kw@|mmo @end|ng |rom gm@||@com  Fri Mar  1 12:49:02 2024
From: |kw@|mmo @end|ng |rom gm@||@com (Iris Simmons)
Date: Fri, 1 Mar 2024 06:49:02 -0500
Subject: [R] gsub issue with consecutive pattern finds
In-Reply-To: <ce1383d4-8339-47a3-b56c-11c4759e905a@sjd.es>
References: <ce1383d4-8339-47a3-b56c-11c4759e905a@sjd.es>
Message-ID: <CADNULg-j9WNxR1CK6ajSY0jGGk-f+83Bhf2rLtV0PSBH3YTXuQ@mail.gmail.com>

Hi Iago,


This is not a bug. It is expected. Patterns may not overlap. However, there
is a way to get the result you want using perl:

```R
gsub("([aeiouAEIOU])(?=[aeiouAEIOU])", "\\1_", "aerioue", perl = TRUE)
```

The specific change I made is called a positive lookahead, you can read
more about it here:

https://www.regular-expressions.info/lookaround.html

It's a way to check for a piece of text without consuming it in the match.

Also, since you don't care about character case, it might be more legible
to add ignore.case = TRUE and remove the upper case characters:

```R
gsub("([aeiou])(?=[aeiou])", "\\1_", "aerioue", perl = TRUE, ignore.case =
TRUE)

## or

gsub("(?i)([aeiou])(?=[aeiou])", "\\1_", "aerioue", perl = TRUE)
```

I hope this helps!


On Fri, Mar 1, 2024, 06:37 Iago Gin? V?zquez <iago.gine at sjd.es> wrote:

> Hi all,
>
> I tested next command:
>
> gsub("([aeiouAEIOU])([aeiouAEIOU])", "\\1_\\2", "aerioue")
>
> with the following output:
>
> [1] "a_eri_ou_e"
>
> So, there are two consecutive vowels where an underscore is not added.
>
> May it be a bug? Is it expected (bug or not)? Is there any chance to get
> what I want (an underscore between each pair of consecutive vowels)?
>
>
> Thank you!
>
> Best regards,
>
> Iago
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From |@go@g|ne @end|ng |rom @jd@e@  Fri Mar  1 12:52:23 2024
From: |@go@g|ne @end|ng |rom @jd@e@ (=?UTF-8?Q?Iago_Gin=C3=A9_V=C3=A1zquez?=)
Date: Fri, 1 Mar 2024 12:52:23 +0100
Subject: [R] gsub issue with consecutive pattern finds
In-Reply-To: <CADNULg-j9WNxR1CK6ajSY0jGGk-f+83Bhf2rLtV0PSBH3YTXuQ@mail.gmail.com>
References: <ce1383d4-8339-47a3-b56c-11c4759e905a@sjd.es>
 <CADNULg-j9WNxR1CK6ajSY0jGGk-f+83Bhf2rLtV0PSBH3YTXuQ@mail.gmail.com>
Message-ID: <ad6609e8-a49a-469c-9986-d9c043a5c339@sjd.es>

Hi Iris,

Thank you. Further, very nice solution.

Best,

Iago

On 01/03/2024 12:49, Iris Simmons wrote:
> Hi Iago,
>
>
> This is not a bug. It is expected. Patterns may not overlap. However, there
> is a way to get the result you want using perl:
>
> ```R
> gsub("([aeiouAEIOU])(?=[aeiouAEIOU])", "\\1_", "aerioue", perl = TRUE)
> ```
>
> The specific change I made is called a positive lookahead, you can read
> more about it here:
>
> https://www.regular-expressions.info/lookaround.html
>
> It's a way to check for a piece of text without consuming it in the match.
>
> Also, since you don't care about character case, it might be more legible
> to add ignore.case = TRUE and remove the upper case characters:
>
> ```R
> gsub("([aeiou])(?=[aeiou])", "\\1_", "aerioue", perl = TRUE, ignore.case =
> TRUE)
>
> ## or
>
> gsub("(?i)([aeiou])(?=[aeiou])", "\\1_", "aerioue", perl = TRUE)
> ```
>
> I hope this helps!
>
>
> On Fri, Mar 1, 2024, 06:37 Iago Gin? V?zquez<iago.gine at sjd.es>  wrote:
>
>> Hi all,
>>
>> I tested next command:
>>
>> gsub("([aeiouAEIOU])([aeiouAEIOU])", "\\1_\\2", "aerioue")
>>
>> with the following output:
>>
>> [1] "a_eri_ou_e"
>>
>> So, there are two consecutive vowels where an underscore is not added.
>>
>> May it be a bug? Is it expected (bug or not)? Is there any chance to get
>> what I want (an underscore between each pair of consecutive vowels)?
>>
>>
>> Thank you!
>>
>> Best regards,
>>
>> Iago
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org  mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
	[[alternative HTML version deleted]]


From btyner @end|ng |rom gm@||@com  Fri Mar  1 16:46:53 2024
From: btyner @end|ng |rom gm@||@com (Benjamin Tyner)
Date: Fri, 1 Mar 2024 10:46:53 -0500
Subject: [R] installation: while running make,
 unable to run pdflatex on 'NEWS.tex'
Message-ID: <505bdcfd-4dbc-4f78-8b90-58dad3c478d9@gmail.com>


A kind member of R-core suggested this is due to a misconfiguration on 
my system, and to post it to the mailing list for troubleshooting.

When trying to build R version 4.3.3, in at least two places during the 
process it gives LaTeX errors of the form:

(example 1)

    you should 'make docs' now ...
    make[1]: Entering directory '/home/btyner/R-4.3.3/doc'
    creating doc/NEWS
    creating doc/NEWS.pdf
    Error in texi2dvi(file = file, pdf = TRUE, clean = clean, quiet =
    quiet, :
    unable to run pdflatex on 'NEWS.tex'
    LaTeX errors:
    ! LaTeX Error: File `pdftexcmds.sty' not found.

    Type X to quit or <RETURN> to proceed,
    or enter new name. (Default extension: sty)

    ! Emergency stop.
    <read *>

    l.108 RequirePackage{pdftexcmds}[2018/09/10]
    ^^M
    ! ==> Fatal error occurred, no output PDF file produced!
    Calls: <Anonymous> -> texi2pdf -> texi2dvi
    Execution halted
    make[1]: /*/ [Makefile:74: NEWS.pdf] Error 1
    make[1]: Leaving directory '/home/btyner/R-4.3.3/doc'
    make: [Makefile:73: docs] Error 2 (ignored)

(example 2)

    make[1]: Entering directory '/home/btyner/R-4.3.3/src/library'
    building/updating vignettes for package 'grid' ...
    building/updating vignettes for package 'parallel' ...
    building/updating vignettes for package 'utils' ...
    building/updating vignettes for package 'stats' ...
    processing 'reshape.Rnw'
    Error: compiling TeX file 'reshape.tex' failed with message:
    unable to run pdflatex on 'reshape.tex'
    LaTeX errors:
    ! LaTeX Error: File `pdftexcmds.sty' not found.

    Type X to quit or <RETURN> to proceed,
    or enter new name. (Default extension: sty)

    ! Emergency stop.
    <read *>

    l.108 RequirePackage{pdftexcmds}[2018/09/10]
    ^^M
    ! ==> Fatal error occurred, no output PDF file produced!
    Execution halted
    make[1]: ** [Makefile:103: vignettes] Error 1
    make[1]: Leaving directory '/home/btyner/R-4.3.3/src/library'
    make: ** [Makefile:81: vignettes] Error 2

here is my |pdflatex --version| info:

    pdfTeX 3.141592653-2.6-1.40.22 (TeX Live 2022/dev/Debian)
    kpathsea version 6.3.4/dev
    Compiled with libpng 1.6.37; using libpng 1.6.37
    Compiled with zlib 1.2.11; using zlib 1.2.11
    Compiled with xpdf version 4.03

my platform info:

    Platform: x86_64-pc-linux-gnu (64-bit)
    Running under: Ubuntu 22.04.4 LTS

I installed from this file with corresponding md5sum

    R-4.3.3.tar.xz 5602f5996107c346dba12a16e866d2e2

The specific commands I ran which led to the error were:

    wget https://cran.r-project.org/src/base/R-4/R-4.3.3.tar.xz
    mkdir R433
    tar xJf R-4.3.3.tar.xz
    cd R-4.3.3
    ./configure --prefix=/home/btyner/R433
    make

Happy to provide any additional information needed.


From btyner @end|ng |rom gm@||@com  Fri Mar  1 16:54:08 2024
From: btyner @end|ng |rom gm@||@com (Benjamin Tyner)
Date: Fri, 1 Mar 2024 10:54:08 -0500
Subject: [R] dput(..., file = stderr())
Message-ID: <3b322636-1fce-45cf-bbd1-d5388664ae51@gmail.com>

Curious to know if this warning is expected behavior, and if so, what is 
the recommended way instead:

     > dput(letters, file = stderr())
    c("a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l",
    "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y",
    "z")
    Warning message:
    In dput(letters, file = stderr()) : wrote too few characters

(I ask because it doesn't happen when using file = stdout())


From bgunter@4567 @end|ng |rom gm@||@com  Fri Mar  1 16:57:33 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 1 Mar 2024 07:57:33 -0800
Subject: [R] gsub issue with consecutive pattern finds
In-Reply-To: <ad6609e8-a49a-469c-9986-d9c043a5c339@sjd.es>
References: <ce1383d4-8339-47a3-b56c-11c4759e905a@sjd.es>
 <CADNULg-j9WNxR1CK6ajSY0jGGk-f+83Bhf2rLtV0PSBH3YTXuQ@mail.gmail.com>
 <ad6609e8-a49a-469c-9986-d9c043a5c339@sjd.es>
Message-ID: <CAGxFJbTXW5us+ARwMOWgJkQGSSc-SX0A8zn2zxR2bK8S8gAb5A@mail.gmail.com>

Here's another *incorrect* way to do it -- incorrect because it will
not always work, unlike Iris's correct solution. But it does not
require PERL type matching. The idea: separate the two vowels in the
regex by a character that you know cannot appear (if there is such)
and match it optionally, e.g. with '*" repetition specifier. I used
"?" for the optional character below (which must be escaped).

>    gsub("([aeiouAEIOU])\\?*([aeiouAEIOU])", "\\1_\\2", "aerioue")
[1] "a_eri_ou_e"

Cheers,
Bert


On Fri, Mar 1, 2024 at 3:59?AM Iago Gin? V?zquez <iago.gine at sjd.es> wrote:
>
> Hi Iris,
>
> Thank you. Further, very nice solution.
>
> Best,
>
> Iago
>
> On 01/03/2024 12:49, Iris Simmons wrote:
> > Hi Iago,
> >
> >
> > This is not a bug. It is expected. Patterns may not overlap. However, there
> > is a way to get the result you want using perl:
> >
> > ```R
> > gsub("([aeiouAEIOU])(?=[aeiouAEIOU])", "\\1_", "aerioue", perl = TRUE)
> > ```
> >
> > The specific change I made is called a positive lookahead, you can read
> > more about it here:
> >
> > https://www.regular-expressions.info/lookaround.html
> >
> > It's a way to check for a piece of text without consuming it in the match.
> >
> > Also, since you don't care about character case, it might be more legible
> > to add ignore.case = TRUE and remove the upper case characters:
> >
> > ```R
> > gsub("([aeiou])(?=[aeiou])", "\\1_", "aerioue", perl = TRUE, ignore.case =
> > TRUE)
> >
> > ## or
> >
> > gsub("(?i)([aeiou])(?=[aeiou])", "\\1_", "aerioue", perl = TRUE)
> > ```
> >
> > I hope this helps!
> >
> >
> > On Fri, Mar 1, 2024, 06:37 Iago Gin? V?zquez<iago.gine at sjd.es>  wrote:
> >
> >> Hi all,
> >>
> >> I tested next command:
> >>
> >> gsub("([aeiouAEIOU])([aeiouAEIOU])", "\\1_\\2", "aerioue")
> >>
> >> with the following output:
> >>
> >> [1] "a_eri_ou_e"
> >>
> >> So, there are two consecutive vowels where an underscore is not added.
> >>
> >> May it be a bug? Is it expected (bug or not)? Is there any chance to get
> >> what I want (an underscore between each pair of consecutive vowels)?
> >>
> >>
> >> Thank you!
> >>
> >> Best regards,
> >>
> >> Iago
> >>
> >>          [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-help at r-project.org  mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> >> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Fri Mar  1 17:00:01 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 1 Mar 2024 08:00:01 -0800
Subject: [R] gsub issue with consecutive pattern finds
In-Reply-To: <CAGxFJbTXW5us+ARwMOWgJkQGSSc-SX0A8zn2zxR2bK8S8gAb5A@mail.gmail.com>
References: <ce1383d4-8339-47a3-b56c-11c4759e905a@sjd.es>
 <CADNULg-j9WNxR1CK6ajSY0jGGk-f+83Bhf2rLtV0PSBH3YTXuQ@mail.gmail.com>
 <ad6609e8-a49a-469c-9986-d9c043a5c339@sjd.es>
 <CAGxFJbTXW5us+ARwMOWgJkQGSSc-SX0A8zn2zxR2bK8S8gAb5A@mail.gmail.com>
Message-ID: <CAGxFJbQN3=CNMY9TfWaNikG+=4=Da5QK088XBrJj3L6AkWcDFw@mail.gmail.com>

Oh, wait a second. I misread your original post. Please ignore my
truly incorrect suggestion.

-- Bert

On Fri, Mar 1, 2024 at 7:57?AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> Here's another *incorrect* way to do it -- incorrect because it will
> not always work, unlike Iris's correct solution. But it does not
> require PERL type matching. The idea: separate the two vowels in the
> regex by a character that you know cannot appear (if there is such)
> and match it optionally, e.g. with '*" repetition specifier. I used
> "?" for the optional character below (which must be escaped).
>
> >    gsub("([aeiouAEIOU])\\?*([aeiouAEIOU])", "\\1_\\2", "aerioue")
> [1] "a_eri_ou_e"
>
> Cheers,
> Bert
>
>
> On Fri, Mar 1, 2024 at 3:59?AM Iago Gin? V?zquez <iago.gine at sjd.es> wrote:
> >
> > Hi Iris,
> >
> > Thank you. Further, very nice solution.
> >
> > Best,
> >
> > Iago
> >
> > On 01/03/2024 12:49, Iris Simmons wrote:
> > > Hi Iago,
> > >
> > >
> > > This is not a bug. It is expected. Patterns may not overlap. However, there
> > > is a way to get the result you want using perl:
> > >
> > > ```R
> > > gsub("([aeiouAEIOU])(?=[aeiouAEIOU])", "\\1_", "aerioue", perl = TRUE)
> > > ```
> > >
> > > The specific change I made is called a positive lookahead, you can read
> > > more about it here:
> > >
> > > https://www.regular-expressions.info/lookaround.html
> > >
> > > It's a way to check for a piece of text without consuming it in the match.
> > >
> > > Also, since you don't care about character case, it might be more legible
> > > to add ignore.case = TRUE and remove the upper case characters:
> > >
> > > ```R
> > > gsub("([aeiou])(?=[aeiou])", "\\1_", "aerioue", perl = TRUE, ignore.case =
> > > TRUE)
> > >
> > > ## or
> > >
> > > gsub("(?i)([aeiou])(?=[aeiou])", "\\1_", "aerioue", perl = TRUE)
> > > ```
> > >
> > > I hope this helps!
> > >
> > >
> > > On Fri, Mar 1, 2024, 06:37 Iago Gin? V?zquez<iago.gine at sjd.es>  wrote:
> > >
> > >> Hi all,
> > >>
> > >> I tested next command:
> > >>
> > >> gsub("([aeiouAEIOU])([aeiouAEIOU])", "\\1_\\2", "aerioue")
> > >>
> > >> with the following output:
> > >>
> > >> [1] "a_eri_ou_e"
> > >>
> > >> So, there are two consecutive vowels where an underscore is not added.
> > >>
> > >> May it be a bug? Is it expected (bug or not)? Is there any chance to get
> > >> what I want (an underscore between each pair of consecutive vowels)?
> > >>
> > >>
> > >> Thank you!
> > >>
> > >> Best regards,
> > >>
> > >> Iago
> > >>
> > >>          [[alternative HTML version deleted]]
> > >>
> > >> ______________________________________________
> > >> R-help at r-project.org  mailing list -- To UNSUBSCRIBE and more, see
> > >> https://stat.ethz.ch/mailman/listinfo/r-help
> > >> PLEASE do read the posting guide
> > >> http://www.R-project.org/posting-guide.html
> > >> and provide commented, minimal, self-contained, reproducible code.
> > >>
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.


From rmh @end|ng |rom temp|e@edu  Fri Mar  1 17:10:53 2024
From: rmh @end|ng |rom temp|e@edu (Richard M. Heiberger)
Date: Fri, 1 Mar 2024 16:10:53 +0000
Subject: [R] [External]  dput(..., file = stderr())
In-Reply-To: <3b322636-1fce-45cf-bbd1-d5388664ae51@gmail.com>
References: <3b322636-1fce-45cf-bbd1-d5388664ae51@gmail.com>
Message-ID: <01A7EDC4-079C-438D-AC0F-90B4A52216BA@temple.edu>

I see the same thing in a fresh R session

> dput(letters, file = stderr())
c("a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", 
"m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", 
"z")
Warning message:
In dput(letters, file = stderr()) : wrote too few characters
> dput(letters, file = stdout())
c("a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", 
"m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", 
"z")
> version
               _                                          
platform       aarch64-apple-darwin20                     
arch           aarch64                                    
os             darwin20                                   
system         aarch64, darwin20                          
status         Patched                                    
major          4                                          
minor          3.2                                        
year           2024                                       
month          01                                         
day            23                                         
svn rev        85822                                      
language       R                                          
version.string R version 4.3.2 Patched (2024-01-23 r85822)
nickname       Eye Holes                                  
> 



> On Mar 1, 2024, at 10:54, Benjamin Tyner <btyner at gmail.com> wrote:
> 
> dput(letters, file = stderr())


From |kry|ov @end|ng |rom d|@root@org  Fri Mar  1 19:00:10 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Fri, 1 Mar 2024 21:00:10 +0300
Subject: [R] dput(..., file = stderr())
In-Reply-To: <3b322636-1fce-45cf-bbd1-d5388664ae51@gmail.com>
References: <3b322636-1fce-45cf-bbd1-d5388664ae51@gmail.com>
Message-ID: <20240301210010.2a970745@Tarkus>

? Fri, 1 Mar 2024 10:54:08 -0500
Benjamin Tyner <btyner at gmail.com> ?????:

>      > dput(letters, file = stderr())  
>     c("a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l",
>     "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y",
>     "z")
>     Warning message:
>     In dput(letters, file = stderr()) : wrote too few characters

Sounds like a bug.

This is where the warning is produced:

    int res = Rconn_printf(con, "%s\n", CHAR(STRING_ELT(tval, i)));
    if(!havewarned &&
       res < strlen(CHAR(STRING_ELT(tval, i))) + 1) {
	warning(_("wrote too few characters"));
	havewarned = TRUE;
    }

At this point, `res` is 0, and CHAR(STRING_ELT(tval, i)) is what you'd
expect:

(gdb) x /s (void*)(STRING_ELT(tval, i))+48
0x5555561bf0a8: "c(\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\",
\"h\", \"i\", \"j\", \"k\", \"l\", "

`res` is 0 because that's what (con->vfprintf)(...) returns:

2813    static int stderr_vfprintf(Rconnection con, const char *format, va_list ap)
2814    {
2815        REvprintf(format, ap);
2816        return 0;
2817    }

Why doesn't it warn for stdout()? Doesn't stdout_vfprintf(...) behave
the same? That's because stdout() (connection #1) is special for dput(),
and instead of going through the connection system, it goes straight for
Rprintf():

426         else { // ifile == 1 : "Stdout"
427             for (int i = 0; i < LENGTH(tval); i++)
428                 Rprintf("%s\n", CHAR(STRING_ELT(tval, i)));
429         }

Not sure what the right fix is. There may be code depending on
(con->vfprintf)(...) returning 0.

-- 
Best regards,
Ivan


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Mar  1 23:43:36 2024
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 01 Mar 2024 14:43:36 -0800
Subject: [R] installation: while running make,
 unable to run pdflatex on 'NEWS.tex'
In-Reply-To: <505bdcfd-4dbc-4f78-8b90-58dad3c478d9@gmail.com>
References: <505bdcfd-4dbc-4f78-8b90-58dad3c478d9@gmail.com>
Message-ID: <CBB5F436-DFF9-49FE-BF57-658B15F75940@dcn.davis.ca.us>

This really is all LaTeX errors, not R errors. Both examples complain that pdftexcmds.sty is not installed. Most "sty" files are in LaTeX packages. Each LaTeX distribution has its own way to install packages ... but the difficulty is usually on the same order of difficulty as installing R packages from CRAN... that is, pretty easy. But you need to read about _your_ TeX system for details. I use Google to figure out which package has the given file in it... it is usually the same as whatever comes before ".sty", but not always.

On March 1, 2024 7:46:53 AM PST, Benjamin Tyner <btyner at gmail.com> wrote:
>
>A kind member of R-core suggested this is due to a misconfiguration on my system, and to post it to the mailing list for troubleshooting.
>
>When trying to build R version 4.3.3, in at least two places during the process it gives LaTeX errors of the form:
>
>(example 1)
>
>   you should 'make docs' now ...
>   make[1]: Entering directory '/home/btyner/R-4.3.3/doc'
>   creating doc/NEWS
>   creating doc/NEWS.pdf
>   Error in texi2dvi(file = file, pdf = TRUE, clean = clean, quiet =
>   quiet, :
>   unable to run pdflatex on 'NEWS.tex'
>   LaTeX errors:
>   ! LaTeX Error: File `pdftexcmds.sty' not found.
>
>   Type X to quit or <RETURN> to proceed,
>   or enter new name. (Default extension: sty)
>
>   ! Emergency stop.
>   <read *>
>
>   l.108 RequirePackage{pdftexcmds}[2018/09/10]
>   ^^M
>   ! ==> Fatal error occurred, no output PDF file produced!
>   Calls: <Anonymous> -> texi2pdf -> texi2dvi
>   Execution halted
>   make[1]: /*/ [Makefile:74: NEWS.pdf] Error 1
>   make[1]: Leaving directory '/home/btyner/R-4.3.3/doc'
>   make: [Makefile:73: docs] Error 2 (ignored)
>
>(example 2)
>
>   make[1]: Entering directory '/home/btyner/R-4.3.3/src/library'
>   building/updating vignettes for package 'grid' ...
>   building/updating vignettes for package 'parallel' ...
>   building/updating vignettes for package 'utils' ...
>   building/updating vignettes for package 'stats' ...
>   processing 'reshape.Rnw'
>   Error: compiling TeX file 'reshape.tex' failed with message:
>   unable to run pdflatex on 'reshape.tex'
>   LaTeX errors:
>   ! LaTeX Error: File `pdftexcmds.sty' not found.
>
>   Type X to quit or <RETURN> to proceed,
>   or enter new name. (Default extension: sty)
>
>   ! Emergency stop.
>   <read *>
>
>   l.108 RequirePackage{pdftexcmds}[2018/09/10]
>   ^^M
>   ! ==> Fatal error occurred, no output PDF file produced!
>   Execution halted
>   make[1]: ** [Makefile:103: vignettes] Error 1
>   make[1]: Leaving directory '/home/btyner/R-4.3.3/src/library'
>   make: ** [Makefile:81: vignettes] Error 2
>
>here is my |pdflatex --version| info:
>
>   pdfTeX 3.141592653-2.6-1.40.22 (TeX Live 2022/dev/Debian)
>   kpathsea version 6.3.4/dev
>   Compiled with libpng 1.6.37; using libpng 1.6.37
>   Compiled with zlib 1.2.11; using zlib 1.2.11
>   Compiled with xpdf version 4.03
>
>my platform info:
>
>   Platform: x86_64-pc-linux-gnu (64-bit)
>   Running under: Ubuntu 22.04.4 LTS
>
>I installed from this file with corresponding md5sum
>
>   R-4.3.3.tar.xz 5602f5996107c346dba12a16e866d2e2
>
>The specific commands I ran which led to the error were:
>
>   wget https://cran.r-project.org/src/base/R-4/R-4.3.3.tar.xz
>   mkdir R433
>   tar xJf R-4.3.3.tar.xz
>   cd R-4.3.3
>   ./configure --prefix=/home/btyner/R433
>   make
>
>Happy to provide any additional information needed.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From |kry|ov @end|ng |rom d|@root@org  Sat Mar  2 08:42:28 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Sat, 2 Mar 2024 10:42:28 +0300
Subject: [R] installation: while running make,
 unable to run pdflatex on 'NEWS.tex'
In-Reply-To: <505bdcfd-4dbc-4f78-8b90-58dad3c478d9@gmail.com>
References: <505bdcfd-4dbc-4f78-8b90-58dad3c478d9@gmail.com>
Message-ID: <20240302104228.470cf687@Tarkus>

? Fri, 1 Mar 2024 10:46:53 -0500
Benjamin Tyner <btyner at gmail.com> ?????:

> my platform info:
> 
>     Platform: x86_64-pc-linux-gnu (64-bit)
>     Running under: Ubuntu 22.04.4 LTS

Quick things first: have you installed all the build-dependencies? apt
build-dep r-base (maybe with --install-suggests? haven't tried that in
a while) should do that. In particular, the build dependencies include
texlive-fonts-extra and texlive-latex-extra. That's a lot of packages,
but some of them are required to compile LaTeX documents produced by R.

>     you should 'make docs' now ...
>     make[1]: Entering directory '/home/btyner/R-4.3.3/doc'
>     creating doc/NEWS
>     creating doc/NEWS.pdf
>     Error in texi2dvi(file = file, pdf = TRUE, clean = clean, quiet =
>     quiet, :
>     unable to run pdflatex on 'NEWS.tex'
>     LaTeX errors:
>     ! LaTeX Error: File `pdftexcmds.sty' not found.

Can you compile a minimal LaTeX document? Something like:

\documentclass{article}
\begin{document}
\[ \mathbf{y} = \mathbf{X} \beta \]
\end{document}

Does tools::texi2pdf('THISFILE.tex') fail with a similar error message?

-- 
Best regards,
Ivan


From r@oknz @end|ng |rom gm@||@com  Sat Mar  2 10:02:13 2024
From: r@oknz @end|ng |rom gm@||@com (Richard O'Keefe)
Date: Sat, 2 Mar 2024 22:02:13 +1300
Subject: [R] Initializing vector and matrices
In-Reply-To: <CH3PR22MB4514525EE09B576456BB56B7CF5F2@CH3PR22MB4514.namprd22.prod.outlook.com>
References: <656696ba-0785-4068-b7a1-8a751b0ed7d9@ntu.edu.tw>
 <CABcYAdJoxtVyngjG6g0qTFd3F9O1P+ZKGJGCOcK16bQ9NV2dSg@mail.gmail.com>
 <CH3PR22MB4514525EE09B576456BB56B7CF5F2@CH3PR22MB4514.namprd22.prod.outlook.com>
Message-ID: <CABcYAdKKbPXy4FoPA=H2k8KY1yhB2bCJuv5xJg+yvFe4WdD73w@mail.gmail.com>

The matrix equivalent of
  x <- ...
  v <- ...
  x[length(x)+1] <- v
is
  m <- ...
  r <- ...
  m <- rbind(m, r)
or
  m <- ...
  k <- ...
  m <- cbind(m, c)

A vector or matrix so constructed never has "holes" in it.
It's better to think of CONSTRUCTING vectors and matrices rather than
INITIALISING them,
because always being fully defined is important.

It would be really really helpful to have a clearer idea of what you
are trying to do.

On Fri, 1 Mar 2024 at 03:31, Ebert,Timothy Aaron <tebert at ufl.edu> wrote:
>
> You could declare a matrix much larger than you intend to use. This works with a few megabytes of data. It is not very efficient, so scaling up may become a problem.
> m22 <- matrix(NA, 1:600000, ncol=6)
>
> It does not work to add a new column to the matrix, as in you get an error if you try m22[ , 7] but convert to data frame and add a column
>
> m23 <- data.frame(m22)
> m23$x7 <- 12
>
> The only penalty that I know of to having unused space in a matrix is the amount of memory it takes. One side effect is that your program may have a mistake that you would normally catch with a subscript out of bounds error but with the extra space it now runs without errors.
>
> Tim
>
>
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Richard O'Keefe
> Sent: Thursday, February 29, 2024 5:29 AM
> To: Steven Yen <styen at ntu.edu.tw>
> Cc: R-help Mailing List <r-help at r-project.org>
> Subject: Re: [R] Initializing vector and matrices
>
> [External Email]
>
> x <- numeric(0)
> for (...) {
>     x[length(x)+1] <- ...
> }
> works.
> You can build a matrix by building a vector one element at a time this way, and then reshaping it at the end.  That only works if you don't need it to be a matrix at all times.
> Another approach is to build a list of rows.  It's not a matrix, but a list of rows can be a *ragged* matrix with rows of varying length.
>
> On Wed, 28 Feb 2024 at 21:57, Steven Yen <styen at ntu.edu.tw> wrote:
> >
> > Is there as way to initialize a vector (matrix) with an unknown length
> > (dimension)? NULL does not seem to work. The lines below work with a
> > vector of length 4 and a matrix of 4 x 4. What if I do not know
> > initially the length/dimension of the vector/matrix?
> >
> > All I want is to add up (accumulate)  the vector and matrix as I go
> > through the loop.
> >
> > Or, are there other ways to accumulate such vectors and matrices?
> >
> >  > x<-rep(0,4)  # this works but I like to leave the length open  >
> > for (i in 1:3){
> > +  x1<-1:4
> > +  x<-x+x1
> > + }
> >  > x
> > [1]  3  6  9 12
> >
> >  > y = 0*matrix(1:16, nrow = 4, ncol = 4); # this works but I like to
> > leave the dimension open
> >       [,1] [,2] [,3] [,4]
> > [1,]    0    0    0    0
> > [2,]    0    0    0    0
> > [3,]    0    0    0    0
> > [4,]    0    0    0    0
> >  > for (i in 1:3){
> > +   y1<-matrix(17:32, nrow = 4, ncol = 4)
> > +   y<-y+y1
> > + }
> >  > y
> >       [,1] [,2] [,3] [,4]
> > [1,]   51   63   75   87
> > [2,]   54   66   78   90
> > [3,]   57   69   81   93
> > [4,]   60   72   84   96
> >  >
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat/
> > .ethz.ch%2Fmailman%2Flistinfo%2Fr-help&data=05%7C02%7Ctebert%40ufl.edu
> > %7Cdbccaccf29674b10b17308dc39114d38%7C0d4da0f84a314d76ace60a62331e1b84
> > %7C0%7C0%7C638447993707432549%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAw
> > MDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=
> > PtWjcDOnwO7PArVOSdgYbpz8ksjDPK%2Bn9ySyhwQC0gE%3D&reserved=0
> > PLEASE do read the posting guide
> > http://www.r/
> > -project.org%2Fposting-guide.html&data=05%7C02%7Ctebert%40ufl.edu%7Cdb
> > ccaccf29674b10b17308dc39114d38%7C0d4da0f84a314d76ace60a62331e1b84%7C0%
> > 7C0%7C638447993707438911%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiL
> > CJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=Igb16
> > CBYgG21HLEDH4I4gfjjFBa3KjDFK8yEZUmBo8s%3D&reserved=0
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.r-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From r@oknz @end|ng |rom gm@||@com  Sat Mar  2 10:39:28 2024
From: r@oknz @end|ng |rom gm@||@com (Richard O'Keefe)
Date: Sat, 2 Mar 2024 22:39:28 +1300
Subject: [R] installation: while running make,
 unable to run pdflatex on 'NEWS.tex'
In-Reply-To: <505bdcfd-4dbc-4f78-8b90-58dad3c478d9@gmail.com>
References: <505bdcfd-4dbc-4f78-8b90-58dad3c478d9@gmail.com>
Message-ID: <CABcYAdL6hT3=iX1QHkdN7S6AMpGBctym1jSh52i8WpwT8PMTPg@mail.gmail.com>

On my system, pdftexcmds.sty can be found in
/usr/share/texlive/texmf-dist/tex/generic/pdftexcmds/pdftexcmds.sty
A quick poking around with 'apt' and 'dpkg-query -L' told me that this
comes from the
texlive-latex-recommended
Ubuntu package.  So on my system, if I didn't already have this,
sudo apt install texlive-latex-recommended
should fix the problem.

On Sat, 2 Mar 2024 at 04:47, Benjamin Tyner <btyner at gmail.com> wrote:
>
>
> A kind member of R-core suggested this is due to a misconfiguration on
> my system, and to post it to the mailing list for troubleshooting.
>
> When trying to build R version 4.3.3, in at least two places during the
> process it gives LaTeX errors of the form:
>
> (example 1)
>
>     you should 'make docs' now ...
>     make[1]: Entering directory '/home/btyner/R-4.3.3/doc'
>     creating doc/NEWS
>     creating doc/NEWS.pdf
>     Error in texi2dvi(file = file, pdf = TRUE, clean = clean, quiet =
>     quiet, :
>     unable to run pdflatex on 'NEWS.tex'
>     LaTeX errors:
>     ! LaTeX Error: File `pdftexcmds.sty' not found.
>
>     Type X to quit or <RETURN> to proceed,
>     or enter new name. (Default extension: sty)
>
>     ! Emergency stop.
>     <read *>
>
>     l.108 RequirePackage{pdftexcmds}[2018/09/10]
>     ^^M
>     ! ==> Fatal error occurred, no output PDF file produced!
>     Calls: <Anonymous> -> texi2pdf -> texi2dvi
>     Execution halted
>     make[1]: /*/ [Makefile:74: NEWS.pdf] Error 1
>     make[1]: Leaving directory '/home/btyner/R-4.3.3/doc'
>     make: [Makefile:73: docs] Error 2 (ignored)
>
> (example 2)
>
>     make[1]: Entering directory '/home/btyner/R-4.3.3/src/library'
>     building/updating vignettes for package 'grid' ...
>     building/updating vignettes for package 'parallel' ...
>     building/updating vignettes for package 'utils' ...
>     building/updating vignettes for package 'stats' ...
>     processing 'reshape.Rnw'
>     Error: compiling TeX file 'reshape.tex' failed with message:
>     unable to run pdflatex on 'reshape.tex'
>     LaTeX errors:
>     ! LaTeX Error: File `pdftexcmds.sty' not found.
>
>     Type X to quit or <RETURN> to proceed,
>     or enter new name. (Default extension: sty)
>
>     ! Emergency stop.
>     <read *>
>
>     l.108 RequirePackage{pdftexcmds}[2018/09/10]
>     ^^M
>     ! ==> Fatal error occurred, no output PDF file produced!
>     Execution halted
>     make[1]: ** [Makefile:103: vignettes] Error 1
>     make[1]: Leaving directory '/home/btyner/R-4.3.3/src/library'
>     make: ** [Makefile:81: vignettes] Error 2
>
> here is my |pdflatex --version| info:
>
>     pdfTeX 3.141592653-2.6-1.40.22 (TeX Live 2022/dev/Debian)
>     kpathsea version 6.3.4/dev
>     Compiled with libpng 1.6.37; using libpng 1.6.37
>     Compiled with zlib 1.2.11; using zlib 1.2.11
>     Compiled with xpdf version 4.03
>
> my platform info:
>
>     Platform: x86_64-pc-linux-gnu (64-bit)
>     Running under: Ubuntu 22.04.4 LTS
>
> I installed from this file with corresponding md5sum
>
>     R-4.3.3.tar.xz 5602f5996107c346dba12a16e866d2e2
>
> The specific commands I ran which led to the error were:
>
>     wget https://cran.r-project.org/src/base/R-4/R-4.3.3.tar.xz
>     mkdir R433
>     tar xJf R-4.3.3.tar.xz
>     cd R-4.3.3
>     ./configure --prefix=/home/btyner/R433
>     make
>
> Happy to provide any additional information needed.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From btyner @end|ng |rom gm@||@com  Sat Mar  2 15:06:21 2024
From: btyner @end|ng |rom gm@||@com (Benjamin Tyner)
Date: Sat, 2 Mar 2024 09:06:21 -0500
Subject: [R] installation: while running make,
 unable to run pdflatex on 'NEWS.tex'
In-Reply-To: <20240302104228.470cf687@Tarkus>
References: <505bdcfd-4dbc-4f78-8b90-58dad3c478d9@gmail.com>
 <20240302104228.470cf687@Tarkus>
Message-ID: <7e808784-0ecf-422e-b21d-03c5e4b8ec73@gmail.com>

Thank you Ivan and Richard...

Short version: a simple "sudo apt install texlive" fixed it.

Longer version (attempt at a post-mortem): previously (back on 
2023-11-05) on this same system I built R version 4.3.2; and 
/home/btyner/R432/lib/R/doc/NEWS.pdf does exist (and is a valid pdf with 
48 pages) from that same install. Likewise before that on 2023-07-02 I 
built R version 4.3.1 and the NEWS.pdf is fine (47 pages) there too.

Still not sure how it happened that my system lost track of the 
necessary texlive add-ons at some point between 2023-11-05 and now, but 
running "sudo apt install texlive" made it clear that 
texlive-latex-recommended was indeed one of the culprits as suggested by 
Richard.

    The following additional packages will be installed:
     ? fonts-texgyre tex-gyre texlive-fonts-recommended
    texlive-latex-recommended tipa
    Suggested packages:
     ? texlive-fonts-recommended-doc texlive-latex-recommended-doc
    texlive-luatex texlive-pstricks tipa-doc
    The following NEW packages will be installed:
     ? fonts-texgyre tex-gyre texlive texlive-fonts-recommended
    texlive-latex-recommended tipa

In an attempt to figure out what might have happened after 2023-11-05,

    zgrep texlive /var/log/dpkg.log.*.gz

revealed some texlive related activity back on 2023-11-23 but no 
indication that anything was removed...

    /var/log/dpkg.log.4.gz:2023-11-23 11:02:55 install
    texlive-binaries:amd64 <none> 2021.20210626.59705-1ubuntu0.1
    /var/log/dpkg.log.4.gz:2023-11-23 11:02:55 status half-installed
    texlive-binaries:amd64 2021.20210626.59705-1ubuntu0.1
    /var/log/dpkg.log.4.gz:2023-11-23 11:02:56 status unpacked
    texlive-binaries:amd64 2021.20210626.59705-1ubuntu0.1
    /var/log/dpkg.log.4.gz:2023-11-23 11:02:56 install texlive-base:all
    <none> 2021.20220204-1
    /var/log/dpkg.log.4.gz:2023-11-23 11:02:56 status half-installed
    texlive-base:all 2021.20220204-1
    /var/log/dpkg.log.4.gz:2023-11-23 11:03:02 status unpacked
    texlive-base:all 2021.20220204-1
    /var/log/dpkg.log.4.gz:2023-11-23 11:03:02 install
    texlive-latex-base:all <none> 2021.20220204-1
    /var/log/dpkg.log.4.gz:2023-11-23 11:03:02 status half-installed
    texlive-latex-base:all 2021.20220204-1
    /var/log/dpkg.log.4.gz:2023-11-23 11:03:04 status unpacked
    texlive-latex-base:all 2021.20220204-1
    /var/log/dpkg.log.4.gz:2023-11-23 11:03:05 configure
    texlive-binaries:amd64 2021.20210626.59705-1ubuntu0.1 <none>
    /var/log/dpkg.log.4.gz:2023-11-23 11:03:05 status unpacked
    texlive-binaries:amd64 2021.20210626.59705-1ubuntu0.1
    /var/log/dpkg.log.4.gz:2023-11-23 11:03:05 status half-configured
    texlive-binaries:amd64 2021.20210626.59705-1ubuntu0.1
    /var/log/dpkg.log.4.gz:2023-11-23 11:03:05 status installed
    texlive-binaries:amd64 2021.20210626.59705-1ubuntu0.1
    /var/log/dpkg.log.4.gz:2023-11-23 11:03:05 configure
    texlive-base:all 2021.20220204-1 <none>
    /var/log/dpkg.log.4.gz:2023-11-23 11:03:05 status unpacked
    texlive-base:all 2021.20220204-1
    /var/log/dpkg.log.4.gz:2023-11-23 11:03:05 status half-configured
    texlive-base:all 2021.20220204-1
    /var/log/dpkg.log.4.gz:2023-11-23 11:03:09 status installed
    texlive-base:all 2021.20220204-1
    /var/log/dpkg.log.4.gz:2023-11-23 11:03:09 configure
    texlive-latex-base:all 2021.20220204-1 <none>
    /var/log/dpkg.log.4.gz:2023-11-23 11:03:09 status unpacked
    texlive-latex-base:all 2021.20220204-1
    /var/log/dpkg.log.4.gz:2023-11-23 11:03:09 status half-configured
    texlive-latex-base:all 2021.20220204-1
    /var/log/dpkg.log.4.gz:2023-11-23 11:03:09 status installed
    texlive-latex-base:all 2021.20220204-1

One more thing:

    HISTTIMEFORMAT="%Y-%m-%d %T " history | grep texlive

revealed that I ran "sudo apt install texlive-latex-base" back on 
2024-02-19, so maybe that had something to do with it. Sadly the shell 
history does not exist prior to that date.


On 3/2/24 02:42, Ivan Krylov wrote:
> ? Fri, 1 Mar 2024 10:46:53 -0500
> Benjamin Tyner <btyner at gmail.com> ?????:
>
>> my platform info:
>>
>>      Platform: x86_64-pc-linux-gnu (64-bit)
>>      Running under: Ubuntu 22.04.4 LTS
> Quick things first: have you installed all the build-dependencies? apt
> build-dep r-base (maybe with --install-suggests? haven't tried that in
> a while) should do that. In particular, the build dependencies include
> texlive-fonts-extra and texlive-latex-extra. That's a lot of packages,
> but some of them are required to compile LaTeX documents produced by R.
>
>>      you should 'make docs' now ...
>>      make[1]: Entering directory '/home/btyner/R-4.3.3/doc'
>>      creating doc/NEWS
>>      creating doc/NEWS.pdf
>>      Error in texi2dvi(file = file, pdf = TRUE, clean = clean, quiet =
>>      quiet, :
>>      unable to run pdflatex on 'NEWS.tex'
>>      LaTeX errors:
>>      ! LaTeX Error: File `pdftexcmds.sty' not found.
> Can you compile a minimal LaTeX document? Something like:
>
> \documentclass{article}
> \begin{document}
> \[ \mathbf{y} = \mathbf{X} \beta \]
> \end{document}
>
> Does tools::texi2pdf('THISFILE.tex') fail with a similar error message?
>


From bgunter@4567 @end|ng |rom gm@||@com  Sat Mar  2 18:53:41 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 2 Mar 2024 09:53:41 -0800
Subject: [R] Initializing vector and matrices
In-Reply-To: <CABcYAdKKbPXy4FoPA=H2k8KY1yhB2bCJuv5xJg+yvFe4WdD73w@mail.gmail.com>
References: <656696ba-0785-4068-b7a1-8a751b0ed7d9@ntu.edu.tw>
 <CABcYAdJoxtVyngjG6g0qTFd3F9O1P+ZKGJGCOcK16bQ9NV2dSg@mail.gmail.com>
 <CH3PR22MB4514525EE09B576456BB56B7CF5F2@CH3PR22MB4514.namprd22.prod.outlook.com>
 <CABcYAdKKbPXy4FoPA=H2k8KY1yhB2bCJuv5xJg+yvFe4WdD73w@mail.gmail.com>
Message-ID: <CAGxFJbQq9XhkviMEmXmTjfvXtajFyO1Q+SDWojqonWj0=gAj7g@mail.gmail.com>

"It would be really really helpful to have a clearer idea of what you
are trying to do."

Amen!

But in R, "constructing" objects by extending them piece by piece is
generally very inefficient (e.g.
https://r-craft.org/growing-objects-and-loop-memory-pre-allocation/),
although sometimes?/often? unavoidable (hence the relevance of your
comment above). R generally prefers to take a "whole object" point of
view ( see R books by Chambers, et. al.) and provides code for basic
operations like vector/matrix, etc. construction to do so. When this
is not possible, I suspect "optimal" efficient strategies for
allocating space to build objects gets you into the weeds of how R
works.

Cheers,
Bert




On Sat, Mar 2, 2024 at 1:02?AM Richard O'Keefe <raoknz at gmail.com> wrote:
>
> The matrix equivalent of
>   x <- ...
>   v <- ...
>   x[length(x)+1] <- v
> is
>   m <- ...
>   r <- ...
>   m <- rbind(m, r)
> or
>   m <- ...
>   k <- ...
>   m <- cbind(m, c)
>
> A vector or matrix so constructed never has "holes" in it.
> It's better to think of CONSTRUCTING vectors and matrices rather than
> INITIALISING them,
> because always being fully defined is important.
>
> It would be really really helpful to have a clearer idea of what you
> are trying to do.
>
> On Fri, 1 Mar 2024 at 03:31, Ebert,Timothy Aaron <tebert at ufl.edu> wrote:
> >
> > You could declare a matrix much larger than you intend to use. This works with a few megabytes of data. It is not very efficient, so scaling up may become a problem.
> > m22 <- matrix(NA, 1:600000, ncol=6)
> >
> > It does not work to add a new column to the matrix, as in you get an error if you try m22[ , 7] but convert to data frame and add a column
> >
> > m23 <- data.frame(m22)
> > m23$x7 <- 12
> >
> > The only penalty that I know of to having unused space in a matrix is the amount of memory it takes. One side effect is that your program may have a mistake that you would normally catch with a subscript out of bounds error but with the extra space it now runs without errors.
> >
> > Tim
> >
> >
> >
> > -----Original Message-----
> > From: R-help <r-help-bounces at r-project.org> On Behalf Of Richard O'Keefe
> > Sent: Thursday, February 29, 2024 5:29 AM
> > To: Steven Yen <styen at ntu.edu.tw>
> > Cc: R-help Mailing List <r-help at r-project.org>
> > Subject: Re: [R] Initializing vector and matrices
> >
> > [External Email]
> >
> > x <- numeric(0)
> > for (...) {
> >     x[length(x)+1] <- ...
> > }
> > works.
> > You can build a matrix by building a vector one element at a time this way, and then reshaping it at the end.  That only works if you don't need it to be a matrix at all times.
> > Another approach is to build a list of rows.  It's not a matrix, but a list of rows can be a *ragged* matrix with rows of varying length.
> >
> > On Wed, 28 Feb 2024 at 21:57, Steven Yen <styen at ntu.edu.tw> wrote:
> > >
> > > Is there as way to initialize a vector (matrix) with an unknown length
> > > (dimension)? NULL does not seem to work. The lines below work with a
> > > vector of length 4 and a matrix of 4 x 4. What if I do not know
> > > initially the length/dimension of the vector/matrix?
> > >
> > > All I want is to add up (accumulate)  the vector and matrix as I go
> > > through the loop.
> > >
> > > Or, are there other ways to accumulate such vectors and matrices?
> > >
> > >  > x<-rep(0,4)  # this works but I like to leave the length open  >
> > > for (i in 1:3){
> > > +  x1<-1:4
> > > +  x<-x+x1
> > > + }
> > >  > x
> > > [1]  3  6  9 12
> > >
> > >  > y = 0*matrix(1:16, nrow = 4, ncol = 4); # this works but I like to
> > > leave the dimension open
> > >       [,1] [,2] [,3] [,4]
> > > [1,]    0    0    0    0
> > > [2,]    0    0    0    0
> > > [3,]    0    0    0    0
> > > [4,]    0    0    0    0
> > >  > for (i in 1:3){
> > > +   y1<-matrix(17:32, nrow = 4, ncol = 4)
> > > +   y<-y+y1
> > > + }
> > >  > y
> > >       [,1] [,2] [,3] [,4]
> > > [1,]   51   63   75   87
> > > [2,]   54   66   78   90
> > > [3,]   57   69   81   93
> > > [4,]   60   72   84   96
> > >  >
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat/
> > > .ethz.ch%2Fmailman%2Flistinfo%2Fr-help&data=05%7C02%7Ctebert%40ufl.edu
> > > %7Cdbccaccf29674b10b17308dc39114d38%7C0d4da0f84a314d76ace60a62331e1b84
> > > %7C0%7C0%7C638447993707432549%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAw
> > > MDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=
> > > PtWjcDOnwO7PArVOSdgYbpz8ksjDPK%2Bn9ySyhwQC0gE%3D&reserved=0
> > > PLEASE do read the posting guide
> > > http://www.r/
> > > -project.org%2Fposting-guide.html&data=05%7C02%7Ctebert%40ufl.edu%7Cdb
> > > ccaccf29674b10b17308dc39114d38%7C0d4da0f84a314d76ace60a62331e1b84%7C0%
> > > 7C0%7C638447993707438911%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiL
> > > CJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=Igb16
> > > CBYgG21HLEDH4I4gfjjFBa3KjDFK8yEZUmBo8s%3D&reserved=0
> > > and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.r-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sat Mar  2 19:52:50 2024
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sat, 02 Mar 2024 10:52:50 -0800
Subject: [R] Initializing vector and matrices
In-Reply-To: <CAGxFJbQq9XhkviMEmXmTjfvXtajFyO1Q+SDWojqonWj0=gAj7g@mail.gmail.com>
References: <656696ba-0785-4068-b7a1-8a751b0ed7d9@ntu.edu.tw>
 <CABcYAdJoxtVyngjG6g0qTFd3F9O1P+ZKGJGCOcK16bQ9NV2dSg@mail.gmail.com>
 <CH3PR22MB4514525EE09B576456BB56B7CF5F2@CH3PR22MB4514.namprd22.prod.outlook.com>
 <CABcYAdKKbPXy4FoPA=H2k8KY1yhB2bCJuv5xJg+yvFe4WdD73w@mail.gmail.com>
 <CAGxFJbQq9XhkviMEmXmTjfvXtajFyO1Q+SDWojqonWj0=gAj7g@mail.gmail.com>
Message-ID: <2F0D9571-1B14-4759-A4AE-94B4E223B3C7@dcn.davis.ca.us>

To be fair, these replies no longer include the original question, which was IMO really quite clear (if misguided), and was actually targeted at understanding pre-allocation for better performance. Richard's suggestion to store the along-the-way constructed vectors in a list and examine the lengths of the elements of that list after it is completely constructed if it is really desired to force vectors of varying lengths into a matrix seems appropriate. The possibly-misguided part is in the thought that vectors of different lengths belong in a matrix at all... leaving them in a list seems more likely to be appropriate.

OP: Avoid mis-using NA to "fill out" the end of uniform-length vectors. Each index position in a vector should represent some information... if you are throwing NAs or zeros in willy-nilly then you are not taking care to assign meaning to those positions, and likely wasting memory and time doing so. If you were taking such care, then any appropriate NAs would already be present in the vectors before you put them into the matrix, and the original question would not have crossed OPs mind because the vectors world already be of the same length. NA means that information for a specific position is "unknown", not "space filler".

Now if OP wants better guidance on restructuring their analysis, then certainly sharing those details would help the discussion move away from the original misguided question... but that would be another thread to answer the question that should have been asked.

On March 2, 2024 9:53:41 AM PST, Bert Gunter <bgunter.4567 at gmail.com> wrote:
>"It would be really really helpful to have a clearer idea of what you
>are trying to do."
>
>Amen!
>
>But in R, "constructing" objects by extending them piece by piece is
>generally very inefficient (e.g.
>https://r-craft.org/growing-objects-and-loop-memory-pre-allocation/),
>although sometimes?/often? unavoidable (hence the relevance of your
>comment above). R generally prefers to take a "whole object" point of
>view ( see R books by Chambers, et. al.) and provides code for basic
>operations like vector/matrix, etc. construction to do so. When this
>is not possible, I suspect "optimal" efficient strategies for
>allocating space to build objects gets you into the weeds of how R
>works.
>
>Cheers,
>Bert
>
>
>
>
>On Sat, Mar 2, 2024 at 1:02?AM Richard O'Keefe <raoknz at gmail.com> wrote:
>>
>> The matrix equivalent of
>>   x <- ...
>>   v <- ...
>>   x[length(x)+1] <- v
>> is
>>   m <- ...
>>   r <- ...
>>   m <- rbind(m, r)
>> or
>>   m <- ...
>>   k <- ...
>>   m <- cbind(m, c)
>>
>> A vector or matrix so constructed never has "holes" in it.
>> It's better to think of CONSTRUCTING vectors and matrices rather than
>> INITIALISING them,
>> because always being fully defined is important.
>>
>> It would be really really helpful to have a clearer idea of what you
>> are trying to do.
>>
>> On Fri, 1 Mar 2024 at 03:31, Ebert,Timothy Aaron <tebert at ufl.edu> wrote:
>> >
>> > You could declare a matrix much larger than you intend to use. This works with a few megabytes of data. It is not very efficient, so scaling up may become a problem.
>> > m22 <- matrix(NA, 1:600000, ncol=6)
>> >
>> > It does not work to add a new column to the matrix, as in you get an error if you try m22[ , 7] but convert to data frame and add a column
>> >
>> > m23 <- data.frame(m22)
>> > m23$x7 <- 12
>> >
>> > The only penalty that I know of to having unused space in a matrix is the amount of memory it takes. One side effect is that your program may have a mistake that you would normally catch with a subscript out of bounds error but with the extra space it now runs without errors.
>> >
>> > Tim
>> >
>> >
>> >
>> > -----Original Message-----
>> > From: R-help <r-help-bounces at r-project.org> On Behalf Of Richard O'Keefe
>> > Sent: Thursday, February 29, 2024 5:29 AM
>> > To: Steven Yen <styen at ntu.edu.tw>
>> > Cc: R-help Mailing List <r-help at r-project.org>
>> > Subject: Re: [R] Initializing vector and matrices
>> >
>> > [External Email]
>> >
>> > x <- numeric(0)
>> > for (...) {
>> >     x[length(x)+1] <- ...
>> > }
>> > works.
>> > You can build a matrix by building a vector one element at a time this way, and then reshaping it at the end.  That only works if you don't need it to be a matrix at all times.
>> > Another approach is to build a list of rows.  It's not a matrix, but a list of rows can be a *ragged* matrix with rows of varying length.
>> >
>> > On Wed, 28 Feb 2024 at 21:57, Steven Yen <styen at ntu.edu.tw> wrote:
>> > >
>> > > Is there as way to initialize a vector (matrix) with an unknown length
>> > > (dimension)? NULL does not seem to work. The lines below work with a
>> > > vector of length 4 and a matrix of 4 x 4. What if I do not know
>> > > initially the length/dimension of the vector/matrix?
>> > >
>> > > All I want is to add up (accumulate)  the vector and matrix as I go
>> > > through the loop.
>> > >
>> > > Or, are there other ways to accumulate such vectors and matrices?
>> > >
>> > >  > x<-rep(0,4)  # this works but I like to leave the length open  >
>> > > for (i in 1:3){
>> > > +  x1<-1:4
>> > > +  x<-x+x1
>> > > + }
>> > >  > x
>> > > [1]  3  6  9 12
>> > >
>> > >  > y = 0*matrix(1:16, nrow = 4, ncol = 4); # this works but I like to
>> > > leave the dimension open
>> > >       [,1] [,2] [,3] [,4]
>> > > [1,]    0    0    0    0
>> > > [2,]    0    0    0    0
>> > > [3,]    0    0    0    0
>> > > [4,]    0    0    0    0
>> > >  > for (i in 1:3){
>> > > +   y1<-matrix(17:32, nrow = 4, ncol = 4)
>> > > +   y<-y+y1
>> > > + }
>> > >  > y
>> > >       [,1] [,2] [,3] [,4]
>> > > [1,]   51   63   75   87
>> > > [2,]   54   66   78   90
>> > > [3,]   57   69   81   93
>> > > [4,]   60   72   84   96
>> > >  >
>> > >
>> > > ______________________________________________
>> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > > https://stat/
>> > > .ethz.ch%2Fmailman%2Flistinfo%2Fr-help&data=05%7C02%7Ctebert%40ufl.edu
>> > > %7Cdbccaccf29674b10b17308dc39114d38%7C0d4da0f84a314d76ace60a62331e1b84
>> > > %7C0%7C0%7C638447993707432549%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAw
>> > > MDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=
>> > > PtWjcDOnwO7PArVOSdgYbpz8ksjDPK%2Bn9ySyhwQC0gE%3D&reserved=0
>> > > PLEASE do read the posting guide
>> > > http://www.r/
>> > > -project.org%2Fposting-guide.html&data=05%7C02%7Ctebert%40ufl.edu%7Cdb
>> > > ccaccf29674b10b17308dc39114d38%7C0d4da0f84a314d76ace60a62331e1b84%7C0%
>> > > 7C0%7C638447993707438911%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiL
>> > > CJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=Igb16
>> > > CBYgG21HLEDH4I4gfjjFBa3KjDFK8yEZUmBo8s%3D&reserved=0
>> > > and provide commented, minimal, self-contained, reproducible code.
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide http://www.r-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From d@curt|@ @end|ng |rom uc|@@c@uk  Mon Mar  4 16:25:21 2024
From: d@curt|@ @end|ng |rom uc|@@c@uk (Curtis, David)
Date: Mon, 4 Mar 2024 15:25:21 +0000
Subject: [R] Default t test in R is Welch's test, not Student's,
 and can be very problematic
Message-ID: <AM7PR01MB662659E29C5A31B6C81D415FDC232@AM7PR01MB6626.eurprd01.prod.exchangelabs.com>

Hi all.

I'm just writing to draw your attention to this paper, which is Open Access:

Curtis, D. Welch?s t test is more sensitive to real world violations of distributional assumptions than student?s t test but logistic regression is more robust than either. Stat Papers (2024). https://doi.org/10.1007/s00362-024-01531-7
https://link.springer.com/article/10.1007/s00362-024-01531-7?utm_source=rct_congratemailt&utm_medium=email&utm_campaign=oa_20240304&utm_content=10.1007/s00362-024-01531-7

I hadn't really noticed that the default implementation of the t test in R uses Welch's method rather than Student's. I know some people prefer Welch's method but the paper describes how it can be systematically biased and produce extremely low p values in real world scenarios.

If you agree with me, you might want to consider generally using Student's test instead, by using t.test(x, y, var.equal = TRUE).

Code to demonstrate the problem and play around with different scenarios, as described in the paper, is at: https://github.com/davenomiddlenamecurtis/TestTTest

Regards


  *   Dave Curtis

--
Professor David Curtis MD PhD
UCL Genetics Institute
University College London



	[[alternative HTML version deleted]]


From m@rong|u@|u|g| @end|ng |rom gm@||@com  Tue Mar  5 13:16:41 2024
From: m@rong|u@|u|g| @end|ng |rom gm@||@com (Luigi Marongiu)
Date: Tue, 5 Mar 2024 13:16:41 +0100
Subject: [R] How to invert axis within defined range with ggplot2
 scale_y_reverse?
Message-ID: <CAMk+s2RKKTAcLYBLN2zDJ+rcEhEWO80TDwo7VrpT-tavd-KetQ@mail.gmail.com>

Hello,
I am drawing some data with ggplot2 and would like to reverse the
order of the y axis and set a custom range for it.
I can do the former but when I add the key `limits` to
`scale_y_reverse` I get an error as shows below and, worse, no data
shown in the plot.
How can I properly set a reverse y scale with a defined range in ggplot2?
Thank you

```
A <- rep(c(0, 3, 6, 12, 24), 3)
B <- c(rep(0,5), rep(1,5), rep(2,5))
V <- c(27.5,    27.01,    27.75,    27.98,    27.4,    25.69,
26.17,    27.78,    26.08,
       24.97,    23.18,    21.78,    22.49,    21.85,    22.2)
df <- data.frame(Conc = A, Time = B, Value = V)
df$Conc = as.factor(df$Conc)
df$Time = as.factor(df$Time)
library(ggplot2)

ggplot(df, aes(x=Time, y=Value, colour=Conc, group=Conc)) +
  geom_line() +
  scale_y_reverse(limits = c(20,30)) +
  geom_point(size=6) +
  scale_colour_manual(values = COLS)

> Warning messages:
1: Removed 15 rows containing missing values (`geom_line()`).
2: Removed 15 rows containing missing values (`geom_point()`).
```


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Mar  5 14:43:20 2024
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 5 Mar 2024 08:43:20 -0500
Subject: [R] How to invert axis within defined range with ggplot2
 scale_y_reverse?
In-Reply-To: <CAMk+s2RKKTAcLYBLN2zDJ+rcEhEWO80TDwo7VrpT-tavd-KetQ@mail.gmail.com>
References: <CAMk+s2RKKTAcLYBLN2zDJ+rcEhEWO80TDwo7VrpT-tavd-KetQ@mail.gmail.com>
Message-ID: <17e3e485-96a2-4860-ad22-7c566331a6ba@gmail.com>

On 05/03/2024 7:16 a.m., Luigi Marongiu wrote:
> A <- rep(c(0, 3, 6, 12, 24), 3)
> B <- c(rep(0,5), rep(1,5), rep(2,5))
> V <- c(27.5,    27.01,    27.75,    27.98,    27.4,    25.69,
> 26.17,    27.78,    26.08,
>         24.97,    23.18,    21.78,    22.49,    21.85,    22.2)
> df <- data.frame(Conc = A, Time = B, Value = V)
> df$Conc = as.factor(df$Conc)
> df$Time = as.factor(df$Time)
> library(ggplot2)
> 
> ggplot(df, aes(x=Time, y=Value, colour=Conc, group=Conc)) +
>    geom_line() +
>    scale_y_reverse(limits = c(20,30)) +
>    geom_point(size=6) +
>    scale_colour_manual(values = COLS)

The limits should be `c(30,20)`.

Duncan Murdoch


From m@rong|u@|u|g| @end|ng |rom gm@||@com  Tue Mar  5 15:45:16 2024
From: m@rong|u@|u|g| @end|ng |rom gm@||@com (Luigi Marongiu)
Date: Tue, 5 Mar 2024 15:45:16 +0100
Subject: [R] How to invert axis within defined range with ggplot2
 scale_y_reverse?
In-Reply-To: <17e3e485-96a2-4860-ad22-7c566331a6ba@gmail.com>
References: <CAMk+s2RKKTAcLYBLN2zDJ+rcEhEWO80TDwo7VrpT-tavd-KetQ@mail.gmail.com>
 <17e3e485-96a2-4860-ad22-7c566331a6ba@gmail.com>
Message-ID: <CAMk+s2RFA7jFkWPvub2Usa8gA=07hK55jh-tykKrM+2jh7F6Ng@mail.gmail.com>

Thank you. I though the values would have been reversed automatically.
Case closed then

On Tue, Mar 5, 2024 at 2:43?PM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>
> On 05/03/2024 7:16 a.m., Luigi Marongiu wrote:
> > A <- rep(c(0, 3, 6, 12, 24), 3)
> > B <- c(rep(0,5), rep(1,5), rep(2,5))
> > V <- c(27.5,    27.01,    27.75,    27.98,    27.4,    25.69,
> > 26.17,    27.78,    26.08,
> >         24.97,    23.18,    21.78,    22.49,    21.85,    22.2)
> > df <- data.frame(Conc = A, Time = B, Value = V)
> > df$Conc = as.factor(df$Conc)
> > df$Time = as.factor(df$Time)
> > library(ggplot2)
> >
> > ggplot(df, aes(x=Time, y=Value, colour=Conc, group=Conc)) +
> >    geom_line() +
> >    scale_y_reverse(limits = c(20,30)) +
> >    geom_point(size=6) +
> >    scale_colour_manual(values = COLS)
>
> The limits should be `c(30,20)`.
>
> Duncan Murdoch



-- 
Best regards,
Luigi


From |kry|ov @end|ng |rom d|@root@org  Fri Mar  8 13:57:59 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Fri, 8 Mar 2024 15:57:59 +0300
Subject: [R] Function environments serialize to a lot of data until they
 don't
Message-ID: <20240308155759.35b22dbc@Tarkus>

Hello R-help,

I've noticed that my 'parallel' jobs take too much memory to store and
transfer to the cluster workers. I've managed to trace it to the
following:

# `payload` is being written to the cluster worker.
# The function FUN had been created as a closure inside my package:
payload$data$args$FUN
# function (l, ...) 
# withCallingHandlers(fun(l$x, ...), error = .wraperr(l$name))
# <bytecode: 0x5644a9f08a90>
# <environment: 0x5644aa841ad8>

# The function seems to bring a lot of captured data with it.
e <- environment(payload$data$args$FUN)
length(serialize(e, NULL))
# [1] 738202878      
parent.env(e)
# <environment: namespace:mypackage>

# The parent environment has a name, so it all must be right here.
# What is it?

ls(e, all.names = TRUE)
# [1] "fun"
length(serialize(e$fun, NULL))
# [1] 317

# The only object in the environment is small!
# Where is the 700 megabytes of data?

length(serialize(e, NULL))
# [1] 536
length(serialize(payload$data$args$FUN, NULL))
# [1] 1722

And once I've observed `fun`, the environment becomes very small and
now can be serialized in a very compact manner.

I managed to work around it by forcing the promise and explicitly
putting `fun` in a small environment when constructing the closure:

.wrapfun <- function(fun) {
 e <- new.env(parent = loadNamespace('mypackage'))
 e$fun <- fun
 # NOTE: a naive return(function(...)) could serialize to 700
 # megabytes due to `fun` seemingly being a promise (?). Once the
 # promise is resolved, suddenly `fun` is much more compact.
 ret <- function(l, ...) withCallingHandlers(
  fun(l$x, ...),
  error = .wraperr(l$name)
 )
 environment(ret) <- e
 ret
}

Is this analysis correct? Could a simple f <- force(fun) have sufficed?
Where can I read more about this type of problems?

If this really is due to promises, what would be the downsides of
forcing them during serialization?

-- 
Best regards,
Ivan


From iuke-tier@ey m@iii@g oii uiow@@edu  Fri Mar  8 22:46:52 2024
From: iuke-tier@ey m@iii@g oii uiow@@edu (iuke-tier@ey m@iii@g oii uiow@@edu)
Date: Fri, 8 Mar 2024 15:46:52 -0600 (CST)
Subject: [R] [External] Function environments serialize to a lot of data
 until they don't
In-Reply-To: <20240308155759.35b22dbc@Tarkus>
References: <20240308155759.35b22dbc@Tarkus>
Message-ID: <46be207d-48a9-c12-517a-226713790c9@uiowa.edu>

On Fri, 8 Mar 2024, Ivan Krylov via R-help wrote:

> Hello R-help,
>
> I've noticed that my 'parallel' jobs take too much memory to store and
> transfer to the cluster workers. I've managed to trace it to the
> following:
>
> # `payload` is being written to the cluster worker.
> # The function FUN had been created as a closure inside my package:
> payload$data$args$FUN
> # function (l, ...)
> # withCallingHandlers(fun(l$x, ...), error = .wraperr(l$name))
> # <bytecode: 0x5644a9f08a90>
> # <environment: 0x5644aa841ad8>
>
> # The function seems to bring a lot of captured data with it.
> e <- environment(payload$data$args$FUN)
> length(serialize(e, NULL))
> # [1] 738202878
> parent.env(e)
> # <environment: namespace:mypackage>
>
> # The parent environment has a name, so it all must be right here.
> # What is it?
>
> ls(e, all.names = TRUE)
> # [1] "fun"
> length(serialize(e$fun, NULL))
> # [1] 317
>
> # The only object in the environment is small!
> # Where is the 700 megabytes of data?
>
> length(serialize(e, NULL))
> # [1] 536
> length(serialize(payload$data$args$FUN, NULL))
> # [1] 1722
>
> And once I've observed `fun`, the environment becomes very small and
> now can be serialized in a very compact manner.
>
> I managed to work around it by forcing the promise and explicitly
> putting `fun` in a small environment when constructing the closure:
>
> .wrapfun <- function(fun) {
> e <- new.env(parent = loadNamespace('mypackage'))
> e$fun <- fun
> # NOTE: a naive return(function(...)) could serialize to 700
> # megabytes due to `fun` seemingly being a promise (?). Once the
> # promise is resolved, suddenly `fun` is much more compact.
> ret <- function(l, ...) withCallingHandlers(
>  fun(l$x, ...),
>  error = .wraperr(l$name)
> )
> environment(ret) <- e
> ret
> }

Creating and setting environments is brittle and easy to get wrong. I
prefer to use a combination of proper lexical scoping, regular
assignments, and force() as I do below.

> Is this analysis correct? Could a simple f <- force(fun) have sufficed?
> Where can I read more about this type of problems?

Just force(fun), without the assignment, should be enough, or even
just fun, as in

    function(fun) { fun; <do something with fun> }

Using force() make the intent clearer.

Closures or formulas capturing large amount of data is something you
have to be careful about with serialization in general and distributed
memory computing in R in particular. There is a little on it in the
parallel vignette. I know I have talked and written about it in
various places but can't remember a specific reference right now.

I usually define a top level function to create any closures I want to
transmit and make sure they only capture what they need. A common
pattern is provided by a simple function for creating a normal
log-likelihood:

     mkLL <- function(x) {
 	m <- mean(x)
 	s <- sd(x)
 	function(y) sum(dnorm(y, m, s, log = TRUE))
     }

This avoids recomputing the mean and sd on every call. It is fine for
use within a single process, and the fact that the original data is
available in the environment might even be useful for debugging:

     ll <- mkLL(rnorm(10))
     environment(ll)$x
     ##  [1] -0.09202453  0.78901912 -0.66744232  1.36061149  1.50768816
     ##  [6] -2.60754997  0.68727212  0.31557476  2.02027688 -1.42361769

But it does prevent the data from being garbage-collected until
the returned result is no longer reachable. A more GC-friendly, and
serialization-friendly definition is

     mkLL <- function(x) {
 	m <- mean(x)
 	s <- sd(x)
 	x <- NULL  ## not needed anymore; remove from the result's enclosing env
 	function(y) sum(dnorm(y, m, s, log = TRUE))
     }

     ll <- mkLL(rnorm(1e7))
     length(serialize(ll, NULL))
     ## [1] 734

If you prefer to calculate the mean and sd yourself you could use

     mkLL1 <- function(m, s) function(x) sum(dnorm(x, m, s, log = TRUE))

Until the result is called for the first time the evaluation of the
arguments will be delayed, i.e. encoded in promises that record the
expression to evaluate and the environment in which to evaluate
it:

     f <- function(n) {
         x <- rnorm(n)
         mkLL1(mean(x), sd(x))
     }
     ll <- f(1e7)
     length(serialize(ll, NULL))
     ## [1] 80002223

Once the arguments are evaluated, the expressions are still needed for
substitute() and such, but the environment is not, so it is dropped,
and if the promise environment can no longer be reached it can be
garbage-collected, It will also no longer appear in a serialization:

     ll(1)
     ## [1] -1.419588
     length(serialize(ll, NULL))
     ## [1] 3537

Having a reference to a large environment is not much of an issue
within a single process, but can be in a distributed memory parallel
computing context.  To avoid this you can force evaluation of the
promises:

     mkLL1 <- function(m, s) {
 	force(m)
 	force(s)
 	function(x) sum(dnorm(x, m, s, log = TRUE))
     }
     ll <- f(1e7)
     length(serialize(ll, NULL))
     ## [1] 2146

The possibility of inadvertently transferring too much data is an
issue in distributed memory computing in general, so there are various
tools that help. A very simple tool available in the snow package for
snow clusters is snow.time(), which can produce some summary times and
a Gantt chart (patterned after ones produced by xpvm and xmpi). For
example, going back to the first definition of mkLL1 you can try

     mkLL1 <- function(m, s) function(x) sum(dnorm(x, m, s, log = TRUE))
     ll <- f(1e7)
     library(snow)
     cl <- makeCluster(2, type = "SOCK")
     tm <- snow.time(clusterCall(cl, ll, 1))
     print(tm)
     plot(tm)
     stopCluster(cl)

snow.time() is not very sophisticated, not very well tested, and may
be a bit brittle. It has not been not ported to the parallel package,
but it looks like most of the plumbing is there so porting it might
not be too hard.

>
> If this really is due to promises, what would be the downsides of
> forcing them during serialization?

Many. Think NSE, defaults that assume something happens in the body
before the are evaluated ...

Best,

luke

-- 
Luke Tierney
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:   luke-tierney at uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From |kry|ov @end|ng |rom d|@root@org  Mon Mar 11 22:17:29 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Tue, 12 Mar 2024 00:17:29 +0300
Subject: [R] [External] Function environments serialize to a lot of data
 until they don't
In-Reply-To: <46be207d-48a9-c12-517a-226713790c9@uiowa.edu>
References: <20240308155759.35b22dbc@Tarkus>
 <46be207d-48a9-c12-517a-226713790c9@uiowa.edu>
Message-ID: <20240312001729.4ef019a0@Tarkus>

Dear Luke,

Thank you for the detailed explanation of the power of force()! It does
solve my problem in a much more reliable manner than setting function
environments manually.

On Fri, 8 Mar 2024 15:46:52 -0600 (CST)
luke-tierney at uiowa.edu wrote:

> Having a reference to a large environment is not much of an issue
> within a single process, but can be in a distributed memory parallel
> computing context.  To avoid this you can force evaluation of the
> promises:
> 
>      mkLL1 <- function(m, s) {
>  	force(m)
>  	force(s)
>  	function(x) sum(dnorm(x, m, s, log = TRUE))
>      }
>      ll <- f(1e7)
>      length(serialize(ll, NULL))
>      ## [1] 2146

I think this also illustrates the danger of letting side effects come
near function arguments. A promise to read a file could survive on a
cluster node and result in a lot of head-scratching. A promise to write
to the connection number N, which coincides with a connection open on
the cluster node, could even do some damage. This is definitely
something to remember when creating closures.

> A very simple tool available in the snow package for snow clusters is
> snow.time(), which can produce some summary times and a Gantt chart
> (patterned after ones produced by xpvm and xmpi).

I can see the snow.time() plot being useful. Thank you for letting me
know about it!

-- 
Best regards,
Ivan


From m@r@g@rc|@1 @end|ng |rom @|umno@@uchceu@e@  Tue Mar 12 08:43:08 2024
From: m@r@g@rc|@1 @end|ng |rom @|umno@@uchceu@e@ (=?Windows-1252?Q?Maria_Del_Mar_Garc=EDa_Zamora?=)
Date: Tue, 12 Mar 2024 07:43:08 +0000
Subject: [R] Problem with R coding
Message-ID: <PR1PR07MB58845D9076232F2E9F69904AF82B2@PR1PR07MB5884.eurprd07.prod.outlook.com>

Hello,

This is the error that appears when I try to load library(Rcmdr). I am using R version 4.3.3. I have tried to upload the packages, uninstall them and intalling them again and nothing.
Loading required package: splines
Loading required package: RcmdrMisc
Loading required package: car
Loading required package: carData
Loading required package: sandwich
Loading required package: effects
lattice theme set by effectsTheme()
See ?effectsTheme for details.
Error: package or namespace load failed for ?Rcmdr?:
 .onLoad failed in loadNamespace() for 'tcltk2', details:
  call: file.exists("~/.Rtk2theme")
  error: file name conversion problem -- name too long?

Once this appears I use path.expand('~') and this is R's answer:
[1] "C:\\Users\\marga\\OneDrive - Fundaci\xf3n Universitaria San Pablo CEU\\Documentos"

The thing is that in spanish we use accents, so this word (Fundaci\xf3n) really is Fundaci?n, but I can't change it.

I have tried to start R from CDM using: C:\Users\marga>set R_USER=C:\Users\marga\R_USER

C:\Users\marga>"C:\Users\marga\Desktop\R-4.3.3\bin\R.exe" CMD Rgui

At the beginning this worked but right now a message saying that this app cannot be used and that I have to ask the software company (photo attached)

What should I do?

Thanks,

Mar


[https://www.uchceu.es/img/externos/correo/ceu_uch.gif]<https://www.uchceu.es/>

Maria Del Mar Garc?a Zamora
Alumno UCHCEU -
Universidad CEU Cardenal Herrera
-
Tel.
www.uchceu.es<https://www.uchceu.es/>

[https://www.uchceu.es/img/logos/wur.jpg]
[https://www.uchceu.es/img/externos/correo/medio_ambiente.gif] Por favor, piensa en el medio ambiente antes de imprimir este contenido



[http://www.uchceu.es/img/externos/correo/ceu_uch.gif]<http://www.uchceu.es/>

Maria Del Mar Garc?a Zamora

www.uchceu.es<http://www.uchceu.es/>

[http://www.uchceu.es/img/externos/correo/medio_ambiente.gif] Por favor, piensa en el medio ambiente antes de imprimir este contenido




Este mensaje y sus archivos adjuntos, enviados desde FUNDACI?N UNIVERSITARIA SAN PABLO-CEU, pueden contener informaci?n confidencial y est? destinado a ser le?do s?lo por la persona a la que va dirigido, por lo que queda prohibida la difusi?n, copia o utilizaci?n de dicha informaci?n por terceros. Si usted lo recibiera por error, por favor, notif?quelo al remitente y destruya el mensaje y cualquier documento adjunto que pudiera contener. Cualquier informaci?n, opini?n, conclusi?n, recomendaci?n, etc. contenida en el presente mensaje no relacionada con la actividad de FUNDACI?N UNIVERSITARIA SAN PABLO-CEU, y/o emitida por persona no autorizada para ello, deber? considerarse como no proporcionada ni aprobada por FUNDACI?N UNIVERSITARIA SAN PABLO-CEU, que pone los medios a su alcance para garantizar la seguridad y ausencia de errores en la correspondencia electr?nica, pero no puede asegurar la inexistencia de virus o la no alteraci?n de los documentos transmitidos electr?nicamente, por lo que declina cualquier responsabilidad a este respecto.

This message and its attachments, sent from FUNDACI?N UNIVERSITARIA SAN PABLO-CEU, may contain confidential information and is intended to be read only by the person it is directed. Therefore any disclosure, copying or use by third parties of this information is prohibited. If you receive this in error, please notify the sender and destroy the message and any attachments may contain. Any information, opinion, conclusion, recommendation,... contained in this message and which is unrelated to the business activity of FUNDACI?N UNIVERSITARIA SAN PABLO-CEU and/or issued by unauthorized personnel, shall be considered unapproved by FUNDACI?N UNIVERSITARIA SAN PABLO-CEU. FUNDACI?N UNIVERSITARIA SAN PABLO-CEU implements control measures to ensure, as far as possible, the security and reliability of all its electronic correspondence. However, FUNDACI?N UNIVERSITARIA SAN PABLO-CEU does not guarantee that emails are virus-free or that documents have not be altered, and does not take responsibility in this respect.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: Captura de pantalla 2024-03-11 192201.png
Type: image/png
Size: 192628 bytes
Desc: Captura de pantalla 2024-03-11 192201.png
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20240312/dd91092d/attachment.png>

From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Tue Mar 12 10:38:04 2024
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Tue, 12 Mar 2024 09:38:04 +0000
Subject: [R] Problem with R coding
In-Reply-To: <PR1PR07MB58845D9076232F2E9F69904AF82B2@PR1PR07MB5884.eurprd07.prod.outlook.com>
References: <PR1PR07MB58845D9076232F2E9F69904AF82B2@PR1PR07MB5884.eurprd07.prod.outlook.com>
Message-ID: <76955f35-1f68-458c-855d-d09028ca4bf1@sapo.pt>

?s 07:43 de 12/03/2024, Maria Del Mar Garc?a Zamora escreveu:
> Hello,
> 
> This is the error that appears when I try to load library(Rcmdr). I am using R version 4.3.3. I have tried to upload the packages, uninstall them and intalling them again and nothing.
> Loading required package: splines
> Loading required package: RcmdrMisc
> Loading required package: car
> Loading required package: carData
> Loading required package: sandwich
> Loading required package: effects
> lattice theme set by effectsTheme()
> See ?effectsTheme for details.
> Error: package or namespace load failed for ?Rcmdr?:
>   .onLoad failed in loadNamespace() for 'tcltk2', details:
>    call: file.exists("~/.Rtk2theme")
>    error: file name conversion problem -- name too long?
> 
> Once this appears I use path.expand('~') and this is R's answer:
> [1] "C:\\Users\\marga\\OneDrive - Fundaci\xf3n Universitaria San Pablo CEU\\Documentos"
> 
> The thing is that in spanish we use accents, so this word (Fundaci\xf3n) really is Fundaci?n, but I can't change it.
> 
> I have tried to start R from CDM using: C:\Users\marga>set R_USER=C:\Users\marga\R_USER
> 
> C:\Users\marga>"C:\Users\marga\Desktop\R-4.3.3\bin\R.exe" CMD Rgui
> 
> At the beginning this worked but right now a message saying that this app cannot be used and that I have to ask the software company (photo attached)
> 
> What should I do?
> 
> Thanks,
> 
> Mar
> 
> 
> [https://www.uchceu.es/img/externos/correo/ceu_uch.gif]<https://www.uchceu.es/>
> 
> Maria Del Mar Garc?a Zamora
> Alumno UCHCEU -
> Universidad CEU Cardenal Herrera
> -
> Tel.
> www.uchceu.es<https://www.uchceu.es/>
> 
> [https://www.uchceu.es/img/logos/wur.jpg]
> [https://www.uchceu.es/img/externos/correo/medio_ambiente.gif] Por favor, piensa en el medio ambiente antes de imprimir este contenido
> 
> 
> 
> [http://www.uchceu.es/img/externos/correo/ceu_uch.gif]<http://www.uchceu.es/>
> 
> Maria Del Mar Garc?a Zamora
> 
> www.uchceu.es<http://www.uchceu.es/>
> 
> [http://www.uchceu.es/img/externos/correo/medio_ambiente.gif] Por favor, piensa en el medio ambiente antes de imprimir este contenido
> 
> 
> 
> 
> Este mensaje y sus archivos adjuntos, enviados desde FUNDACI?N UNIVERSITARIA SAN PABLO-CEU, pueden contener informaci?n confidencial y est? destinado a ser le?do s?lo por la persona a la que va dirigido, por lo que queda prohibida la difusi?n, copia o utilizaci?n de dicha informaci?n por terceros. Si usted lo recibiera por error, por favor, notif?quelo al remitente y destruya el mensaje y cualquier documento adjunto que pudiera contener. Cualquier informaci?n, opini?n, conclusi?n, recomendaci?n, etc. contenida en el presente mensaje no relacionada con la actividad de FUNDACI?N UNIVERSITARIA SAN PABLO-CEU, y/o emitida por persona no autorizada para ello, deber? considerarse como no proporcionada ni aprobada por FUNDACI?N UNIVERSITARIA SAN PABLO-CEU, que pone los medios a su alcance para garantizar la seguridad y ausencia de errores en la correspondencia electr?nica, pero no puede asegurar la inexistencia de virus o la no alteraci?n de los documentos transmitidos electr?nicamente, por lo que declina cualquier responsabilidad a este respecto.
> 
> This message and its attachments, sent from FUNDACI?N UNIVERSITARIA SAN PABLO-CEU, may contain confidential information and is intended to be read only by the person it is directed. Therefore any disclosure, copying or use by third parties of this information is prohibited. If you receive this in error, please notify the sender and destroy the message and any attachments may contain. Any information, opinion, conclusion, recommendation,... contained in this message and which is unrelated to the business activity of FUNDACI?N UNIVERSITARIA SAN PABLO-CEU and/or issued by unauthorized personnel, shall be considered unapproved by FUNDACI?N UNIVERSITARIA SAN PABLO-CEU. FUNDACI?N UNIVERSITARIA SAN PABLO-CEU implements control measures to ensure, as far as possible, the security and reliability of all its electronic correspondence. However, FUNDACI?N UNIVERSITARIA SAN PABLO-CEU does not guarantee that emails are virus-free or that documents have not be altered, and does not take responsibility in this respect.
> 
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

First of all, try running Rgui only, no R.exe CMD. Just Rgui.exe or
C:\Users\marga\Desktop\R-4.3.3\bin\Rgui.exe
Then, in Rgui, try loading Rcmdr

library(Rcmdr)


Also, do you have R in your Windows PATH variable? The directory to put 
in PATH should be

C:\Users\marga\Desktop\R-4.3.3\bin

so that Windows can find R.exe and Rgui.exe without the full path name.

Hope this helps,

Rui Barradas



-- 
Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.
www.avg.com

From |kry|ov @end|ng |rom d|@root@org  Tue Mar 12 10:49:10 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Tue, 12 Mar 2024 12:49:10 +0300
Subject: [R] Problem with R coding
In-Reply-To: <PR1PR07MB58845D9076232F2E9F69904AF82B2@PR1PR07MB5884.eurprd07.prod.outlook.com>
References: <PR1PR07MB58845D9076232F2E9F69904AF82B2@PR1PR07MB5884.eurprd07.prod.outlook.com>
Message-ID: <20240312124910.3d4f8968@arachnoid>

? Tue, 12 Mar 2024 07:43:08 +0000
Maria Del Mar Garc?a Zamora <mar.garcia1 at alumnos.uchceu.es> ?????:

> Error: package or namespace load failed for ?Rcmdr?:
>  .onLoad failed in loadNamespace() for 'tcltk2', details:
>   call: file.exists("~/.Rtk2theme")
>   error: file name conversion problem -- name too long?
> 
> Once this appears I use path.expand('~') and this is R's answer:
> [1] "C:\\Users\\marga\\OneDrive - Fundaci\xf3n Universitaria San
> Pablo CEU\\Documentos"

We've seen this problem before:
https://stat.ethz.ch/pipermail/r-help/2023-December/478732.html

The workaround that should help is to set the R_USER environment
variable to C:\Users\marga before launching R.

Please let me know if you're willing to debug R. (This will likely
involve compiling R from source with debugging symbols enabled and
stepping through the code.) There are no places in the Windows code
where R gets the conversion obviously wrong. I don't have OneDrive and I
wasn't able to convince R to return an invalid R_USER path without it.
I'm halfway convinced this is due to a bug in OneDrive itself.

-- 
Best regards,
Ivan


From |kry|ov @end|ng |rom d|@root@org  Tue Mar 12 11:40:38 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Tue, 12 Mar 2024 13:40:38 +0300
Subject: [R] Problem with R coding
In-Reply-To: <PR1PR07MB58845D9076232F2E9F69904AF82B2@PR1PR07MB5884.eurprd07.prod.outlook.com>
References: <PR1PR07MB58845D9076232F2E9F69904AF82B2@PR1PR07MB5884.eurprd07.prod.outlook.com>
Message-ID: <20240312134038.546a8a27@arachnoid>

Dear Maria,

I'm sorry for somehow completely missing the second half of your
message where you say that you've already tried the workaround.

? Tue, 12 Mar 2024 07:43:08 +0000
Maria Del Mar Garc?a Zamora <mar.garcia1 at alumnos.uchceu.es> ?????:

> I have tried to start R from CDM using: C:\Users\marga>set
> R_USER=C:\Users\marga\R_USER
> 
> C:\Users\marga>"C:\Users\marga\Desktop\R-4.3.3\bin\R.exe" CMD Rgui  
> 
> At the beginning this worked but right now a message saying that this
> app cannot be used and that I have to ask the software company (photo
> attached)

Glad to know the workaround helped. It sounds like your Windows
10 is set up in a user-hostile way.

It may help to visit the Windows Security settings and make an
exception for C:\Users\marga\Desktop\R-4.3.3\bin\R.exe. An approximate
instruction can be found at
<https://habr.com/en/companies/hetmansoftware/articles/549410/>, but it
might be the case that your university IT must take a look at it before
allowing you to run R on your computer.

Feel free to disregard this advice if someone with more Windows
experience shows up.

-- 
Best regards,
Ivan


From po|c1410 @end|ng |rom gm@||@com  Tue Mar 12 15:57:28 2024
From: po|c1410 @end|ng |rom gm@||@com (CALUM POLWART)
Date: Tue, 12 Mar 2024 14:57:28 +0000
Subject: [R] Problem with R coding
In-Reply-To: <20240312134038.546a8a27@arachnoid>
References: <PR1PR07MB58845D9076232F2E9F69904AF82B2@PR1PR07MB5884.eurprd07.prod.outlook.com>
 <20240312134038.546a8a27@arachnoid>
Message-ID: <CA+etgPmArWrCqm5T9vrCzt2F62-rhp-KmAdtywhSnxPq1=aKjg@mail.gmail.com>

That's almost certainly going to be either the utf-8 character in the path
OR the use of one drive which isn't really a subfolder as I understand it.

When I've had these issues in the past, I've been able to mount a drive
(say U:/ ) which sites further down /up the folder tree so that R just
called "U:/RCodeFolder/Rfile.R"

Is that possible with an C drive?

On Tue, 12 Mar 2024, 10:40 Ivan Krylov via R-help, <r-help at r-project.org>
wrote:

> Dear Maria,
>
> I'm sorry for somehow completely missing the second half of your
> message where you say that you've already tried the workaround.
>
> ? Tue, 12 Mar 2024 07:43:08 +0000
> Maria Del Mar Garc?a Zamora <mar.garcia1 at alumnos.uchceu.es> ?????:
>
> > I have tried to start R from CDM using: C:\Users\marga>set
> > R_USER=C:\Users\marga\R_USER
> >
> > C:\Users\marga>"C:\Users\marga\Desktop\R-4.3.3\bin\R.exe" CMD Rgui
> >
> > At the beginning this worked but right now a message saying that this
> > app cannot be used and that I have to ask the software company (photo
> > attached)
>
> Glad to know the workaround helped. It sounds like your Windows
> 10 is set up in a user-hostile way.
>
> It may help to visit the Windows Security settings and make an
> exception for C:\Users\marga\Desktop\R-4.3.3\bin\R.exe. An approximate
> instruction can be found at
> <https://habr.com/en/companies/hetmansoftware/articles/549410/>, but it
> might be the case that your university IT must take a look at it before
> allowing you to run R on your computer.
>
> Feel free to disregard this advice if someone with more Windows
> experience shows up.
>
> --
> Best regards,
> Ivan
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From |kw@|mmo @end|ng |rom gm@||@com  Tue Mar 12 16:52:37 2024
From: |kw@|mmo @end|ng |rom gm@||@com (Iris Simmons)
Date: Tue, 12 Mar 2024 11:52:37 -0400
Subject: [R] Problem with R coding
In-Reply-To: <PR1PR07MB58845D9076232F2E9F69904AF82B2@PR1PR07MB5884.eurprd07.prod.outlook.com>
References: <PR1PR07MB58845D9076232F2E9F69904AF82B2@PR1PR07MB5884.eurprd07.prod.outlook.com>
Message-ID: <CADNULg-XZB9QEqt7kfctjWQHbfjaFHE53PVBScqZ49fy9e48SA@mail.gmail.com>

Hi Maria,


I had something similar on my Windows work laptop at some point where the
home directory was something containing non ASCII characters. The easy
solution is to copy said directly from the file explorer into
utils::shortPathName, and then set that as the home directory. In my case,

> writeLines(utils::shortPathName(r"(C:\Users\iris\OneDrive - Organization
Name Non ASCII\Documents)"))
C:\Users\iris\ONEDRI~1\DOCUME~1

and then in the control panel, then user accounts (twice), then Change My
Environment Variables, enter the variable name HOME and the directory that
was produced by R. Now the HOME directory contains all ASCII characters so
everything works as expected.


I hope this helps!



On Tue, Mar 12, 2024, 04:49 Maria Del Mar Garc?a Zamora <
mar.garcia1 at alumnos.uchceu.es> wrote:

> Hello,
>
> This is the error that appears when I try to load library(Rcmdr). I am
> using R version 4.3.3. I have tried to upload the packages, uninstall them
> and intalling them again and nothing.
> Loading required package: splines
> Loading required package: RcmdrMisc
> Loading required package: car
> Loading required package: carData
> Loading required package: sandwich
> Loading required package: effects
> lattice theme set by effectsTheme()
> See ?effectsTheme for details.
> Error: package or namespace load failed for ?Rcmdr?:
>  .onLoad failed in loadNamespace() for 'tcltk2', details:
>   call: file.exists("~/.Rtk2theme")
>   error: file name conversion problem -- name too long?
>
> Once this appears I use path.expand('~') and this is R's answer:
> [1] "C:\\Users\\marga\\OneDrive - Fundaci\xf3n Universitaria San Pablo
> CEU\\Documentos"
>
> The thing is that in spanish we use accents, so this word (Fundaci\xf3n)
> really is Fundaci?n, but I can't change it.
>
> I have tried to start R from CDM using: C:\Users\marga>set
> R_USER=C:\Users\marga\R_USER
>
> C:\Users\marga>"C:\Users\marga\Desktop\R-4.3.3\bin\R.exe" CMD Rgui
>
> At the beginning this worked but right now a message saying that this app
> cannot be used and that I have to ask the software company (photo attached)
>
> What should I do?
>
> Thanks,
>
> Mar
>
>
> [https://www.uchceu.es/img/externos/correo/ceu_uch.gif]<
> https://www.uchceu.es/>
>
> Maria Del Mar Garc?a Zamora
> Alumno UCHCEU -
> Universidad CEU Cardenal Herrera
> -
> Tel.
> www.uchceu.es<https://www.uchceu.es/>
>
> [https://www.uchceu.es/img/logos/wur.jpg]
> [https://www.uchceu.es/img/externos/correo/medio_ambiente.gif] Por favor,
> piensa en el medio ambiente antes de imprimir este contenido
>
>
>
> [http://www.uchceu.es/img/externos/correo/ceu_uch.gif]<
> http://www.uchceu.es/>
>
> Maria Del Mar Garc?a Zamora
>
> www.uchceu.es<http://www.uchceu.es/>
>
> [http://www.uchceu.es/img/externos/correo/medio_ambiente.gif] Por favor,
> piensa en el medio ambiente antes de imprimir este contenido
>
>
>
>
> Este mensaje y sus archivos adjuntos, enviados desde FUNDACI?N
> UNIVERSITARIA SAN PABLO-CEU, pueden contener informaci?n confidencial y
> est? destinado a ser le?do s?lo por la persona a la que va dirigido, por lo
> que queda prohibida la difusi?n, copia o utilizaci?n de dicha informaci?n
> por terceros. Si usted lo recibiera por error, por favor, notif?quelo al
> remitente y destruya el mensaje y cualquier documento adjunto que pudiera
> contener. Cualquier informaci?n, opini?n, conclusi?n, recomendaci?n, etc.
> contenida en el presente mensaje no relacionada con la actividad de
> FUNDACI?N UNIVERSITARIA SAN PABLO-CEU, y/o emitida por persona no
> autorizada para ello, deber? considerarse como no proporcionada ni aprobada
> por FUNDACI?N UNIVERSITARIA SAN PABLO-CEU, que pone los medios a su alcance
> para garantizar la seguridad y ausencia de errores en la correspondencia
> electr?nica, pero no puede asegurar la inexistencia de virus o la no
> alteraci?n de los documentos transmitidos electr?nicamente, por lo que
> declina cualquier responsabilidad a este respecto.
>
> This message and its attachments, sent from FUNDACI?N UNIVERSITARIA SAN
> PABLO-CEU, may contain confidential information and is intended to be read
> only by the person it is directed. Therefore any disclosure, copying or use
> by third parties of this information is prohibited. If you receive this in
> error, please notify the sender and destroy the message and any attachments
> may contain. Any information, opinion, conclusion, recommendation,...
> contained in this message and which is unrelated to the business activity
> of FUNDACI?N UNIVERSITARIA SAN PABLO-CEU and/or issued by unauthorized
> personnel, shall be considered unapproved by FUNDACI?N UNIVERSITARIA SAN
> PABLO-CEU. FUNDACI?N UNIVERSITARIA SAN PABLO-CEU implements control
> measures to ensure, as far as possible, the security and reliability of all
> its electronic correspondence. However, FUNDACI?N UNIVERSITARIA SAN
> PABLO-CEU does not guarantee that emails are virus-free or that documents
> have not be altered, and does not take responsibility in this respect.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Tue Mar 12 17:08:42 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Tue, 12 Mar 2024 19:08:42 +0300
Subject: [R] Problem with R coding
In-Reply-To: <CA+etgPmArWrCqm5T9vrCzt2F62-rhp-KmAdtywhSnxPq1=aKjg@mail.gmail.com>
References: <PR1PR07MB58845D9076232F2E9F69904AF82B2@PR1PR07MB5884.eurprd07.prod.outlook.com>
 <20240312134038.546a8a27@arachnoid>
 <CA+etgPmArWrCqm5T9vrCzt2F62-rhp-KmAdtywhSnxPq1=aKjg@mail.gmail.com>
Message-ID: <20240312190842.04f1b4d9@arachnoid>

? Tue, 12 Mar 2024 14:57:28 +0000
CALUM POLWART <polc1410 at gmail.com> ?????:

> That's almost certainly going to be either the utf-8 character in the
> path

The problem, as diagnosed by Maria in the first post of the thread, is
that the user home directory as known to R is stored in the ANSI
encoding instead of UTF-8, despite the session charset should be UTF-8
as Maria's Windows is sufficiently new [*]. As soon as any bit of R
tries to perform an encoding conversion using this path (for example,
file.exists() converting it from UTF-8 to UCS-2 in order to interact
with Windows filesystem APIs), the conversion fails. Since tcltk2 uses
file.exists('~/...') in its .onLoad, the package and any of its hard
dependencies are now broken.

Normally, this path is determined automatically to be something like
C:\Users\username\Documents. With OneDrive taking over, it turns out to
be something else and for some reason in the wrong encoding (ANSI but
marked as native == UTF-8).

The function that determines this path lives in src/gnuwin32/shext.c
(char *getRUser(void)). It starts by looking at the environment
variable R_USER, which is why in order to override OneDrive, the user
has to set it first (in the command line or system settings). If that
fails, R tries the environment variable HOME (which is usually set on
Windows, isn't it?), consults SHGetKnownFolderPath(FOLDERID_Documents)
(which returns the result as a wchar_t[] to be manually converted to
UTF-8 by R), consults a few more environment variables, and finally
tries to use the current directory. There is likely no easy way to use
`subst` to give a different home drive to R.

If I set %HOME% or even %R_USER% to a non-ASCII path without setting up
OneDrive, R works normally, so getenv() must be able to return
UTF-8-encoded variables. I don't see how ShellGetPersonalDirectory()
could fail in this manner. My remaining hypothesis is that OneDrive
somehow causes getenv("HOME") to return "C:\\Users\\marga\\OneDrive
- Fundaci?n Universitaria San Pablo CEU\\Documentos" in ANSI instead of
UTF-8.

If anyone here has OneDrive set up in this manner and can debug R,
a trace of what getRUser() actually does would be very useful.

-- 
Best regards,
Ivan

[*]
https://blog.r-project.org/2020/05/02/utf-8-support-on-windows/index.html
https://blog.r-project.org/2022/11/07/issues-while-switching-r-to-utf-8-and-ucrt-on-windows/index.html


From bog@@o@chr|@to|er @end|ng |rom gm@||@com  Wed Mar 13 14:31:59 2024
From: bog@@o@chr|@to|er @end|ng |rom gm@||@com (Christofer Bogaso)
Date: Wed, 13 Mar 2024 19:01:59 +0530
Subject: [R] Generating mouse click and hold using R
Message-ID: <CA+dpOJkqWXT4REkd9a_MXzW7DVEV+mhQDXz3ho=B31cVTWez6w@mail.gmail.com>

Hi,

I wonder if R can provide any functionality where I need simulate
mouse click in windows machine at certain coordinate on screen and
hold the click for certain seconds e.g. for 5 seconds

Really appreciate if I can have someone suggestion how above can be
simulated with R

Thanks and regards,


From |kry|ov @end|ng |rom d|@root@org  Wed Mar 13 14:51:48 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Wed, 13 Mar 2024 16:51:48 +0300
Subject: [R] Generating mouse click and hold using R
In-Reply-To: <CA+dpOJkqWXT4REkd9a_MXzW7DVEV+mhQDXz3ho=B31cVTWez6w@mail.gmail.com>
References: <CA+dpOJkqWXT4REkd9a_MXzW7DVEV+mhQDXz3ho=B31cVTWez6w@mail.gmail.com>
Message-ID: <20240313165148.4d2d3798@arachnoid>

? Wed, 13 Mar 2024 19:01:59 +0530
Christofer Bogaso <bogaso.christofer at gmail.com> ?????:

> I need simulate mouse click in windows machine at certain coordinate
> on screen and hold the click for certain seconds e.g. for 5 seconds

There's no interface for this in base R. It's always possible to write
some Windows API code to do that and call it from R using .Call()
(SendInput() is relatively easy to use [*]), but that takes effort and
knowledge of C.

What I suggest to do instead is to write an AutoHotKey script, making
use of the Click function [**] and taking arguments from the command
line [***], and then launch that script using system2(). AutoHotKey is
free software (GPLv2), designed specifically to automate other programs
and should be much easier to use correctly than C.

-- 
Best regards,
Ivan

[*]
https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-sendinput

[**]
https://www.autohotkey.com/docs/v2/lib/Click.htm

[***]
https://www.autohotkey.com/docs/v2/Scripts.htm#cmd


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed Mar 13 14:52:03 2024
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 13 Mar 2024 06:52:03 -0700
Subject: [R] Generating mouse click and hold using R
In-Reply-To: <CA+dpOJkqWXT4REkd9a_MXzW7DVEV+mhQDXz3ho=B31cVTWez6w@mail.gmail.com>
References: <CA+dpOJkqWXT4REkd9a_MXzW7DVEV+mhQDXz3ho=B31cVTWez6w@mail.gmail.com>
Message-ID: <3D3AE246-4D03-4EDA-8038-DCA51641FCC4@dcn.davis.ca.us>

No idea if the package below would work. This package is MSWindows only. Since this was readily found using a search engine, you should have mentioned that you already found this and why it didn't work for you when you posted.

https://cran.r-project.org/web/packages/KeyboardSimulator/readme/README.html
https://stat.ethz.ch/R-manual/R-devel/library/base/html/Sys.sleep.html


On March 13, 2024 6:31:59 AM PDT, Christofer Bogaso <bogaso.christofer at gmail.com> wrote:
>Hi,
>
>I wonder if R can provide any functionality where I need simulate
>mouse click in windows machine at certain coordinate on screen and
>hold the click for certain seconds e.g. for 5 seconds
>
>Really appreciate if I can have someone suggestion how above can be
>simulated with R
>
>Thanks and regards,
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From bog@@o@chr|@to|er @end|ng |rom gm@||@com  Wed Mar 13 16:29:07 2024
From: bog@@o@chr|@to|er @end|ng |rom gm@||@com (Christofer Bogaso)
Date: Wed, 13 Mar 2024 20:59:07 +0530
Subject: [R] refresh.console() function?
Message-ID: <CA+dpOJ=ep-4Qguig-vdg=2dd6YyD-OQG40Q=Va9SugrTxRrUtg@mail.gmail.com>

Hi,

I run a lengthy for loop and I want to display loop status for each
step in my loop.

I previously heard of a R function namely refresh.console() which
would print the status within the loop as it progresses.

However I see this

> help.search("refresh.console")

No vignettes or demos or help files found with alias or concept or

title matching ?refresh.console? using regular expression matching.

Could you please help me find the correct function name?


From e@ @end|ng |rom enr|co@chum@nn@net  Wed Mar 13 16:34:49 2024
From: e@ @end|ng |rom enr|co@chum@nn@net (Enrico Schumann)
Date: Wed, 13 Mar 2024 16:34:49 +0100
Subject: [R] refresh.console() function?
In-Reply-To: <CA+dpOJ=ep-4Qguig-vdg=2dd6YyD-OQG40Q=Va9SugrTxRrUtg@mail.gmail.com>
 (Christofer Bogaso's message of "Wed, 13 Mar 2024 20:59:07 +0530")
References: <CA+dpOJ=ep-4Qguig-vdg=2dd6YyD-OQG40Q=Va9SugrTxRrUtg@mail.gmail.com>
Message-ID: <877ci6cfhi.fsf@enricoschumann.net>

On Wed, 13 Mar 2024, Christofer Bogaso writes:

> Hi,
>
> I run a lengthy for loop and I want to display loop status for each
> step in my loop.
>
> I previously heard of a R function namely refresh.console() which
> would print the status within the loop as it progresses.
>
> However I see this
>
>> help.search("refresh.console")
>
> No vignettes or demos or help files found with alias or concept or
>
> title matching ?refresh.console? using regular expression matching.
>
> Could you please help me find the correct function name?
>

?flush.console

... but you'll need to print/message/cat/... explicitly in the
loop, or the output won't be shown.  [Also, options(warn=1) might
be useful.]


-- 
Enrico Schumann
Lucerne, Switzerland
http://enricoschumann.net


From deep@y@n@@@rk@r @end|ng |rom gm@||@com  Wed Mar 13 16:40:09 2024
From: deep@y@n@@@rk@r @end|ng |rom gm@||@com (Deepayan Sarkar)
Date: Wed, 13 Mar 2024 21:10:09 +0530
Subject: [R] refresh.console() function?
In-Reply-To: <CA+dpOJ=ep-4Qguig-vdg=2dd6YyD-OQG40Q=Va9SugrTxRrUtg@mail.gmail.com>
References: <CA+dpOJ=ep-4Qguig-vdg=2dd6YyD-OQG40Q=Va9SugrTxRrUtg@mail.gmail.com>
Message-ID: <CADfFDC6cN+Y2og1SNZQ8a6j8zp+CudvmWBrMv_LL+1zM5f6HMQ@mail.gmail.com>

Perhaps you mean

https://search.r-project.org/R/refmans/utils/html/flush.console.html

Best,
Deepayan


On Wed, 13 Mar, 2024, 8:59 pm Christofer Bogaso, <
bogaso.christofer at gmail.com> wrote:

> Hi,
>
> I run a lengthy for loop and I want to display loop status for each
> step in my loop.
>
> I previously heard of a R function namely refresh.console() which
> would print the status within the loop as it progresses.
>
> However I see this
>
> > help.search("refresh.console")
>
> No vignettes or demos or help files found with alias or concept or
>
> title matching ?refresh.console? using regular expression matching.
>
> Could you please help me find the correct function name?
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


