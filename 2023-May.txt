From @|mon@wood @end|ng |rom b@th@edu  Mon May  1 11:19:24 2023
From: @|mon@wood @end|ng |rom b@th@edu (Simon Wood)
Date: Mon, 1 May 2023 10:19:24 +0100
Subject: [R] NaN response with gam (mgcv library)
In-Reply-To: <196943759.2974360.1682888582130@mail.yahoo.com>
References: <196943759.2974360.1682888582130.ref@mail.yahoo.com>
 <196943759.2974360.1682888582130@mail.yahoo.com>
Message-ID: <8bb52f0b-3dd6-78ce-1338-e90db6ca8f3c@bath.edu>

try...

sum(residuals(model1)^2)

On 30/04/2023 22:03, varin sacha via R-help wrote:
> Dear R-experts,
>
> Here below my R code. I get a NaN response for gam with mgcv library. How to solve that problem?
> Many thanks.
>
> #########################################################
> library(mgcv)
>   
> y=c(23,24,34,40,42,43,54,34,52,54,23,32,35,45,46,54,34,36,37,48)
> x1=c(0.1,0.3,0.5,0.7,0.8,0.9,0.1,0.7,0.67,0.98,0.56,0.54,0.34,0.12,0.47,0.52,0.87,0.56,0.71,0.6)
> x2=c(9,7,5,3,2,1,1,2,8,9,6,3,1,5,6,7,3,1,3,5)
> x3=c(11,10,13,15,10,9,14,16,18,19,20,9,13,12,14,17,21,19,23,12)
>   
> model=lm(y~x1+x2+x3)
> model1=gam(y ~ s(x1, bs = 'cr', k = 3) + s(x2, bs = 'cr', k = 3)+ s(x3, bs = 'cr', k = 3))
>   
>   
> #Calculate MSE
>  ?model_summ=summary(model)
>  ?mean(model_summ$residuals^2)
>   
>   
>  ?#Calculate MSE
>  ?model_summ=summary(model1)
>  ?mean(model_summ$residuals^2)
> #########################################################
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Simon Wood, School of Mathematics, University of Edinburgh,
https://www.maths.ed.ac.uk/~swood34/


From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Mon May  1 22:09:39 2023
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Mon, 1 May 2023 20:09:39 +0000 (UTC)
Subject: [R] NaN response with gam (mgcv library)
In-Reply-To: <8bb52f0b-3dd6-78ce-1338-e90db6ca8f3c@bath.edu>
References: <196943759.2974360.1682888582130.ref@mail.yahoo.com>
 <196943759.2974360.1682888582130@mail.yahoo.com>
 <8bb52f0b-3dd6-78ce-1338-e90db6ca8f3c@bath.edu>
Message-ID: <1871035915.1053686.1682971779336@mail.yahoo.com>

Dear Simon,

Thanks ! It works !

Best,







Le lundi 1 mai 2023 ? 11:19:26 UTC+2, Simon Wood <simon.wood at bath.edu> a ?crit : 





try...

sum(residuals(model1)^2)

On 30/04/2023 22:03, varin sacha via R-help wrote:
> Dear R-experts,
>
> Here below my R code. I get a NaN response for gam with mgcv library. How to solve that problem?
> Many thanks.
>
> #########################################################
> library(mgcv)
>? 
> y=c(23,24,34,40,42,43,54,34,52,54,23,32,35,45,46,54,34,36,37,48)
> x1=c(0.1,0.3,0.5,0.7,0.8,0.9,0.1,0.7,0.67,0.98,0.56,0.54,0.34,0.12,0.47,0.52,0.87,0.56,0.71,0.6)
> x2=c(9,7,5,3,2,1,1,2,8,9,6,3,1,5,6,7,3,1,3,5)
> x3=c(11,10,13,15,10,9,14,16,18,19,20,9,13,12,14,17,21,19,23,12)
>? 
> model=lm(y~x1+x2+x3)
> model1=gam(y ~ s(x1, bs = 'cr', k = 3) + s(x2, bs = 'cr', k = 3)+ s(x3, bs = 'cr', k = 3))
>? 
>? 
> #Calculate MSE
>? ?model_summ=summary(model)
>? ?mean(model_summ$residuals^2)
>? 
>? 
>? ?#Calculate MSE
>? ?model_summ=summary(model1)
>? ?mean(model_summ$residuals^2)
> #########################################################
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Simon Wood, School of Mathematics, University of Edinburgh,
https://www.maths.ed.ac.uk/~swood34/


From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Mon May  1 22:16:51 2023
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Mon, 1 May 2023 20:16:51 +0000 (UTC)
Subject: [R] 2 bands (confidence and prediction) on the same GAM plot?
References: <180938894.3419606.1682972211961.ref@mail.yahoo.com>
Message-ID: <180938894.3419606.1682972211961@mail.yahoo.com>

Dear R-experts,

Here below my R code (toy example) working! The only thing missing is in my GAM plot: I would like to get on the same graph the 2 bands (prediction and confidence bands) like in my lm model graph!
Is it possible? How to get that?


##############################################################################
#Data
a=c(23,43,23,45,46,56,76,87,98,73,36,48,100,134,21,12,25,43,21,73,48,57,69)
x1=c(0.1,0.3,0.4,0.7,0.1,0.5,0.9,0.1,0.2,0.3,0.4,0.5,0.9,0.5,0.76,0.45,0.98,0.23,0.41,0.38,0.36,0.67,0.89)
x2=c(1.2,2.1,1.8,1.6,1.9,2.9,4.9,5.2,6.4,2.7,8.9,6.7,4.5,3.8,4.5,9.8,6.7,8,5,9,4.7,6.98,9.9)
?
data=data.frame(a,x1,x2)
?
#Fit lm model
model=lm(a~x1+x2)
?
#add predictions
pred.int=predict(model, interval="prediction")
mydata=cbind(data,pred.int)
?
#regression line + Cis for x1
library("ggplot2")
p=ggplot(mydata,aes(x1,a)) + geom_point() + stat_smooth(method=lm)
?
#add prediction intervals for x1
p + geom_line(aes(y=lwr),color="red",linetype="dashed") + geom_line(aes(y=upr),color="red", linetype="dashed")
?
#regression line + Cis for x2
library("ggplot2")
p=ggplot(mydata,aes(x2,a)) + geom_point() + stat_smooth(method=lm)
?
#add prediction intervals for x2
p + geom_line(aes(y=lwr),color="red",linetype="dashed") + geom_line(aes(y=upr),color="red", linetype="dashed")
?

###GAM
##libraries
library(ggplot2)
library(mgcv)
?
##fit and plot
model1=gam(a~s(x1)+s(x2))
plot(model1, pages=1,residuals=TRUE,all.terms=TRUE,shade=TRUE,shade.col=2)
##############################################################################


From up@n@nd@@p@n| @end|ng |rom gm@||@com  Tue May  2 10:57:24 2023
From: up@n@nd@@p@n| @end|ng |rom gm@||@com (Upananda Pani)
Date: Tue, 2 May 2023 14:27:24 +0530
Subject: [R] Reg: Help regarding ggplot2
Message-ID: <CAEezrQR3NNtW3-Y_n=eZ-BRwU3xV71UXQFEGY1hwEo60simhLA@mail.gmail.com>

Dear All,

I have a dataset which contains date and 12 other countries data. I
have extracted the data as xts object.

I am not able to recall all the series in the Y axis. My data set
looks like this

index      crepub finland france germany italy netherlands norway poland
  <date>      <dbl>   <dbl>  <dbl>   <dbl> <dbl>       <dbl>  <dbl>  <dbl>
1 2005-01-03   1.21   0.615   1.90    3.01 0.346       0.509  1.05    1.13
2 2005-01-04   1.18   0.615   1.85    2.89 0.346       0.509  0.889   1.12
3 2005-01-05   1.15   0.615   1.81    2.78 0.346       0.509  0.785   1.09
4 2005-01-06   1.11   0.615   1.76    2.67 0.346       0.509  0.711   1.06
5 2005-01-07   1.08   0.615   1.72    2.57 0.346       0.509  0.661   1.02
6 2005-01-10   1.04   0.615   1.69    2.48 0.346       0.509  0.630   1.01

My code for the same is as follows

ggplot(data=data_vol3, aes(x=index, y=data_vol3$usa)+
  geom_line())

Any help in this regard will be highly appreciated

With regards,
Upananda Pani


From chr|@ho|d @end|ng |rom p@yctc@org  Tue May  2 11:37:43 2023
From: chr|@ho|d @end|ng |rom p@yctc@org (Chris Evans)
Date: Tue, 2 May 2023 11:37:43 +0200
Subject: [R] Reg: Help regarding ggplot2
In-Reply-To: <CAEezrQR3NNtW3-Y_n=eZ-BRwU3xV71UXQFEGY1hwEo60simhLA@mail.gmail.com>
References: <CAEezrQR3NNtW3-Y_n=eZ-BRwU3xV71UXQFEGY1hwEo60simhLA@mail.gmail.com>
Message-ID: <6b2026ec-c923-db89-3af9-36936aa72cea@psyctc.org>

It's not clear what you want but ...

On 02/05/2023 10:57, Upananda Pani wrote:
> Dear All,
>
> I have a dataset which contains date and 12 other countries data. I
> have extracted the data as xts object.
>
> I am not able to recall all the series in the Y axis. My data set
> looks like this
>
> index crepub finland france germany italy netherlands norway poland
> <date> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
> 1 2005-01-03 1.21 0.615 1.90 3.01 0.346 0.509 1.05 1.13
> 2 2005-01-04 1.18 0.615 1.85 2.89 0.346 0.509 0.889 1.12
> 3 2005-01-05 1.15 0.615 1.81 2.78 0.346 0.509 0.785 1.09
> 4 2005-01-06 1.11 0.615 1.76 2.67 0.346 0.509 0.711 1.06
> 5 2005-01-07 1.08 0.615 1.72 2.57 0.346 0.509 0.661 1.02
> 6 2005-01-10 1.04 0.615 1.69 2.48 0.346 0.509 0.630 1.01
>
> My code for the same is as follows
>
> ggplot(data=data_vol3, aes(x=index, y=data_vol3$usa)+
> geom_line())

Well you don't need to say that the y data are from data_vol3, your data 
= declaration says that.

I wonder if what you want is:

library(tidyverse)

tribble(
 ? ~rowN, ~index, ~crepub, ~finland, ~france, ~germany, ~italy, 
~netherlands, ~norway, ~poland,
 ? 1, "2005-01-03", 1.21, 0.615, 1.90, 3.01, 0.346, 0.509, 1.05, 1.13,
 ? 2, "2005-01-04", 1.18, 0.615, 1.85, 2.89, 0.346, 0.509, 0.889, 1.12,
 ? 3, "2005-01-05", 1.15, 0.615, 1.81, 2.78, 0.346, 0.509, 0.785, 1.09,
 ? 4, "2005-01-06", 1.11, 0.615, 1.76, 2.67, 0.346, 0.509, 0.711, 1.06,
 ? 5, "2005-01-07", 1.08, 0.615, 1.72, 2.57, 0.346, 0.509, 0.661, 1.02,
 ? 6, "2005-01-10", 1.04, 0.615, 1.69, 2.48, 0.346, 0.509, 0.630, 1.01) 
-> data_vol3

### please give us data using dput in future: saves us having to do 
something like that to reclaim it!

### pivot that longer to make it easy to get country data as separate lines

data_vol3 %>%? select(-rowN) %>%
 ? pivot_longer(cols = -index, # as you want to pivot the other 
variables/columns
 ?????????????? names_to = "countries") -> tibDataVol3Long

ggplot(data = tibDataVol3Long,
 ?????? aes(x = index, y = value,
 ???????????? ### now get the grouping and use it for a colour legend
 ???????????? group = countries, colour = countries)) +
 ? geom_line()

> Any help in this regard will be highly appreciated
>
> With regards,
> Upananda Pani
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
-- 
Chris Evans (he/him)
Visiting Professor, UDLA, Quito, Ecuador & Honorary Professor, 
University of Roehampton, London, UK.
Work web site: https://www.psyctc.org/psyctc/
CORE site: http://www.coresystemtrust.org.uk/
Personal site: https://www.psyctc.org/pelerinage2016/
Emeetings (Thursdays): 
<https://www.psyctc.org/pelerinage2016/>https://www.psyctc.org/psyctc/booking-meetings-with-me/
(Beware: French time, generally an hour ahead of UK)
<https://ombook.psyctc.org/book>
	[[alternative HTML version deleted]]


From o||v|er@crouzet @end|ng |rom un|v-n@nte@@|r  Tue May  2 11:57:15 2023
From: o||v|er@crouzet @end|ng |rom un|v-n@nte@@|r (Olivier Crouzet)
Date: Tue, 2 May 2023 11:57:15 +0200
Subject: [R] Reg: Help regarding ggplot2
In-Reply-To: <CAEezrQR3NNtW3-Y_n=eZ-BRwU3xV71UXQFEGY1hwEo60simhLA@mail.gmail.com>
References: <CAEezrQR3NNtW3-Y_n=eZ-BRwU3xV71UXQFEGY1hwEo60simhLA@mail.gmail.com>
Message-ID: <20230502115715.72f78310aef3f0fecf7fec88@univ-nantes.fr>

Dear Upananda,

to complement the current response to your question, your data
source looks like a "wide table" while you would certainly need them to
be organised as a "long table", or to speak differently as a "tidy
table". You should read this source in order to get a grasp on these
issues:

https://tidyr.tidyverse.org/articles/tidy-data.html

Please note that the etiquette on this list states that example data
should conform to some constraints that your message does not conform
to (you shoud therefore also read the posting guide:
http://www.R-project.org/posting-guide.html).

Yours. 
Olivier.

On Tue, 2 May 2023 14:27:24 +0530 Upananda
Pani <upananda.pani at gmail.com> wrote:

> Dear All,
> 
> I have a dataset which contains date and 12 other countries data. I
> have extracted the data as xts object.
> 
> I am not able to recall all the series in the Y axis. My data set
> looks like this
> 
> index      crepub finland france germany italy netherlands norway
> poland <date>      <dbl>   <dbl>  <dbl>   <dbl> <dbl>       <dbl>
> <dbl>  <dbl> 1 2005-01-03   1.21   0.615   1.90    3.01 0.346
> 0.509  1.05    1.13 2 2005-01-04   1.18   0.615   1.85    2.89
> 0.346       0.509  0.889   1.12 3 2005-01-05   1.15   0.615   1.81
> 2.78 0.346       0.509  0.785   1.09 4 2005-01-06   1.11   0.615
> 1.76    2.67 0.346       0.509  0.711   1.06 5 2005-01-07   1.08
> 0.615   1.72    2.57 0.346       0.509  0.661   1.02 6 2005-01-10
> 1.04   0.615   1.69    2.48 0.346       0.509  0.630   1.01
> 
> My code for the same is as follows
> 
> ggplot(data=data_vol3, aes(x=index, y=data_vol3$usa)+
>   geom_line())
> 
> Any help in this regard will be highly appreciated
> 
> With regards,
> Upananda Pani
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html and provide commented,
> minimal, self-contained, reproducible code.


-- 
  Olivier Crouzet, PhD
  http://olivier.ghostinthemachine.space
  /Ma?tre de Conf?rences/
  @LLING - Laboratoire de Linguistique de Nantes
    UMR6310 CNRS / Universit? de Nantes


From tebert @end|ng |rom u||@edu  Tue May  2 12:35:21 2023
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Tue, 2 May 2023 10:35:21 +0000
Subject: [R] Reg: Help regarding ggplot2
In-Reply-To: <CAEezrQR3NNtW3-Y_n=eZ-BRwU3xV71UXQFEGY1hwEo60simhLA@mail.gmail.com>
References: <CAEezrQR3NNtW3-Y_n=eZ-BRwU3xV71UXQFEGY1hwEo60simhLA@mail.gmail.com>
Message-ID: <SN4PR22MB28249A3B96CA2731F898F441CF6F9@SN4PR22MB2824.namprd22.prod.outlook.com>

Reorganize the data so that you have three columns
Something more like this:

Date                      Country      Value
2005-01-03          Crepub        1.21

You ggplot statement has a mistake. The geom_line() should be outside the ggplot() call.

You might then have a ggplot statement like
ggplot(data=data_vol3, aes(x=Country, y=Value)) + geom_line()

Just make sure that the data type(s) are what they need to be. Country is non-numeric, and I am not sure geom_line() will like that. I am not sure why one might draw a line connecting categorical items.


Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Upananda Pani
Sent: Tuesday, May 2, 2023 4:57 AM
To: r-help <r-help at r-project.org>
Subject: [R] Reg: Help regarding ggplot2

[External Email]

Dear All,

I have a dataset which contains date and 12 other countries data. I have extracted the data as xts object.

I am not able to recall all the series in the Y axis. My data set looks like this

index      crepub finland france germany italy netherlands norway poland
  <date>      <dbl>   <dbl>  <dbl>   <dbl> <dbl>       <dbl>  <dbl>  <dbl>
1 2005-01-03   1.21   0.615   1.90    3.01 0.346       0.509  1.05    1.13
2 2005-01-04   1.18   0.615   1.85    2.89 0.346       0.509  0.889   1.12
3 2005-01-05   1.15   0.615   1.81    2.78 0.346       0.509  0.785   1.09
4 2005-01-06   1.11   0.615   1.76    2.67 0.346       0.509  0.711   1.06
5 2005-01-07   1.08   0.615   1.72    2.57 0.346       0.509  0.661   1.02
6 2005-01-10   1.04   0.615   1.69    2.48 0.346       0.509  0.630   1.01

My code for the same is as follows

ggplot(data=data_vol3, aes(x=index, y=data_vol3$usa)+
  geom_line())

Any help in this regard will be highly appreciated

With regards,
Upananda Pani

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.r-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From up@n@nd@@p@n| @end|ng |rom gm@||@com  Tue May  2 13:14:25 2023
From: up@n@nd@@p@n| @end|ng |rom gm@||@com (Upananda Pani)
Date: Tue, 2 May 2023 16:44:25 +0530
Subject: [R] Reg: Help regarding ggplot2
In-Reply-To: <AS4P192MB1600E40FF1D55DC501756599C36F9@AS4P192MB1600.EURP192.PROD.OUTLOOK.COM>
References: <CAEezrQR3NNtW3-Y_n=eZ-BRwU3xV71UXQFEGY1hwEo60simhLA@mail.gmail.com>
 <AS4P192MB1600E40FF1D55DC501756599C36F9@AS4P192MB1600.EURP192.PROD.OUTLOOK.COM>
Message-ID: <CAEezrQQhbmx9Y=RegDS8_wW-NDcNq_Y_2vC8gwsviFMofJRS=w@mail.gmail.com>

Hi Thomas,

Thanks for your help. I need to plot all other countries as well.

Thanks for your time

With sincere regards,
Upananda

On Tue, May 2, 2023 at 3:01?PM Thomas.Rose <Thomas.Rose at daad-alumni.de>
wrote:

> Dear Upananda,
>
> I see a misplaced bracket in your code, and there is no need in aes() to
> call the dataframe explicitly. Does this work?
>
> ggplot(data = data_vol3, aes(x = index, y = usa)) +
>   geom_line()
>
> Best wishes,
> Thomas
>
> ------------------------------
> *Von:* R-help <r-help-bounces at r-project.org> im Auftrag von Upananda Pani
> <upananda.pani at gmail.com>
> *Gesendet:* Dienstag, 2. Mai 2023 10:57
> *An:* r-help <r-help at r-project.org>
> *Betreff:* [R] Reg: Help regarding ggplot2
>
> Dear All,
>
> I have a dataset which contains date and 12 other countries data. I
> have extracted the data as xts object.
>
> I am not able to recall all the series in the Y axis. My data set
> looks like this
>
> index      crepub finland france germany italy netherlands norway poland
>   <date>      <dbl>   <dbl>  <dbl>   <dbl> <dbl>       <dbl>  <dbl>  <dbl>
> 1 2005-01-03   1.21   0.615   1.90    3.01 0.346       0.509  1.05    1.13
> 2 2005-01-04   1.18   0.615   1.85    2.89 0.346       0.509  0.889   1.12
> 3 2005-01-05   1.15   0.615   1.81    2.78 0.346       0.509  0.785   1.09
> 4 2005-01-06   1.11   0.615   1.76    2.67 0.346       0.509  0.711   1.06
> 5 2005-01-07   1.08   0.615   1.72    2.57 0.346       0.509  0.661   1.02
> 6 2005-01-10   1.04   0.615   1.69    2.48 0.346       0.509  0.630   1.01
>
> My code for the same is as follows
>
> ggplot(data=data_vol3, aes(x=index, y=data_vol3$usa)+
>   geom_line())
>
> Any help in this regard will be highly appreciated
>
> With regards,
> Upananda Pani
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From up@n@nd@@p@n| @end|ng |rom gm@||@com  Tue May  2 13:44:01 2023
From: up@n@nd@@p@n| @end|ng |rom gm@||@com (Upananda Pani)
Date: Tue, 2 May 2023 17:14:01 +0530
Subject: [R] Reg: Help regarding ggplot2
In-Reply-To: <6b2026ec-c923-db89-3af9-36936aa72cea@psyctc.org>
References: <CAEezrQR3NNtW3-Y_n=eZ-BRwU3xV71UXQFEGY1hwEo60simhLA@mail.gmail.com>
 <6b2026ec-c923-db89-3af9-36936aa72cea@psyctc.org>
Message-ID: <CAEezrQQ4ktuU89yFfq6R_ZpQZ23rV8aEtynp5bOBkdAO2GT=hw@mail.gmail.com>

Hi Chris,

Thank for your solutions and time. I am getting the following error
while trying to execute the code you suggested.

Error in select(., -rowN) : unused argument (-rowN)

Regards,
Upananda

On Tue, May 2, 2023 at 3:08?PM Chris Evans via R-help
<r-help at r-project.org> wrote:
>
> It's not clear what you want but ...
>
> On 02/05/2023 10:57, Upananda Pani wrote:
> > Dear All,
> >
> > I have a dataset which contains date and 12 other countries data. I
> > have extracted the data as xts object.
> >
> > I am not able to recall all the series in the Y axis. My data set
> > looks like this
> >
> > index crepub finland france germany italy netherlands norway poland
> > <date> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
> > 1 2005-01-03 1.21 0.615 1.90 3.01 0.346 0.509 1.05 1.13
> > 2 2005-01-04 1.18 0.615 1.85 2.89 0.346 0.509 0.889 1.12
> > 3 2005-01-05 1.15 0.615 1.81 2.78 0.346 0.509 0.785 1.09
> > 4 2005-01-06 1.11 0.615 1.76 2.67 0.346 0.509 0.711 1.06
> > 5 2005-01-07 1.08 0.615 1.72 2.57 0.346 0.509 0.661 1.02
> > 6 2005-01-10 1.04 0.615 1.69 2.48 0.346 0.509 0.630 1.01
> >
> > My code for the same is as follows
> >
> > ggplot(data=data_vol3, aes(x=index, y=data_vol3$usa)+
> > geom_line())
>
> Well you don't need to say that the y data are from data_vol3, your data
> = declaration says that.
>
> I wonder if what you want is:
>
> library(tidyverse)
>
> tribble(
>    ~rowN, ~index, ~crepub, ~finland, ~france, ~germany, ~italy,
> ~netherlands, ~norway, ~poland,
>    1, "2005-01-03", 1.21, 0.615, 1.90, 3.01, 0.346, 0.509, 1.05, 1.13,
>    2, "2005-01-04", 1.18, 0.615, 1.85, 2.89, 0.346, 0.509, 0.889, 1.12,
>    3, "2005-01-05", 1.15, 0.615, 1.81, 2.78, 0.346, 0.509, 0.785, 1.09,
>    4, "2005-01-06", 1.11, 0.615, 1.76, 2.67, 0.346, 0.509, 0.711, 1.06,
>    5, "2005-01-07", 1.08, 0.615, 1.72, 2.57, 0.346, 0.509, 0.661, 1.02,
>    6, "2005-01-10", 1.04, 0.615, 1.69, 2.48, 0.346, 0.509, 0.630, 1.01)
> -> data_vol3
>
> ### please give us data using dput in future: saves us having to do
> something like that to reclaim it!
>
> ### pivot that longer to make it easy to get country data as separate lines
>
> data_vol3 %>%  select(-rowN) %>%
>    pivot_longer(cols = -index, # as you want to pivot the other
> variables/columns
>                 names_to = "countries") -> tibDataVol3Long
>
> ggplot(data = tibDataVol3Long,
>         aes(x = index, y = value,
>               ### now get the grouping and use it for a colour legend
>               group = countries, colour = countries)) +
>    geom_line()
>
> > Any help in this regard will be highly appreciated
> >
> > With regards,
> > Upananda Pani
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> --
> Chris Evans (he/him)
> Visiting Professor, UDLA, Quito, Ecuador & Honorary Professor,
> University of Roehampton, London, UK.
> Work web site: https://www.psyctc.org/psyctc/
> CORE site: http://www.coresystemtrust.org.uk/
> Personal site: https://www.psyctc.org/pelerinage2016/
> Emeetings (Thursdays):
> <https://www.psyctc.org/pelerinage2016/>https://www.psyctc.org/psyctc/booking-meetings-with-me/
> (Beware: French time, generally an hour ahead of UK)
> <https://ombook.psyctc.org/book>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From up@n@nd@@p@n| @end|ng |rom gm@||@com  Tue May  2 17:50:06 2023
From: up@n@nd@@p@n| @end|ng |rom gm@||@com (Upananda Pani)
Date: Tue, 2 May 2023 21:20:06 +0530
Subject: [R] Reg: Help regarding ggplot2
In-Reply-To: <2362548d-dbdf-b902-e8cc-819991f712e4@psyctc.org>
References: <CAEezrQR3NNtW3-Y_n=eZ-BRwU3xV71UXQFEGY1hwEo60simhLA@mail.gmail.com>
 <6b2026ec-c923-db89-3af9-36936aa72cea@psyctc.org>
 <CAEezrQQ4ktuU89yFfq6R_ZpQZ23rV8aEtynp5bOBkdAO2GT=hw@mail.gmail.com>
 <2362548d-dbdf-b902-e8cc-819991f712e4@psyctc.org>
Message-ID: <CAEezrQT2XTJqbSSMSUm0Dc=TFchCgR2ZQDGCwqM+zG8=CTAtzg@mail.gmail.com>

Hi Chrish,

I am grateful to you for your reply. Your code is working fine.
Moreover, you have guided me how to improve my knowledge, I appreciate
it. I will be very careful next time.
The data which i am working on is given below:

dput(head(data_vol3))
structure(list(index = structure(c(12786, 12787, 12788, 12789,
12790, 12793), tzone = "UTC", tclass = "Date", class = "Date"),
    crepub = c(1.20601312, 1.176601845, 1.14945752, 1.112667506,
    1.076184043, 1.042147848), finland = c(0.614973309, 0.615008409,
    0.615034446, 0.615053761, 0.615068089, 0.615078717), france = c(1.896830857,
    1.849908737, 1.807150091, 1.763296422, 1.719573044, 1.690600819
    ), germany = c(3.01041925, 2.892518667, 2.780918603, 2.672356826,
    2.567306135, 2.479892045), italy = c(0.345659867, 0.345675874,
    0.345686934, 0.345694578, 0.34569986, 0.34570351), netherlands =
c(0.509263785,
    0.509279495, 0.509289967, 0.509296947, 0.509301605, 0.509304705
    ), norway = c(1.052509528, 0.889357215, 0.784607722, 0.710551664,
    0.661473027, 0.629951323), poland = c(1.127163733, 1.12432629,
    1.087704091, 1.056705592, 1.024417693, 1.007962456), slovakia =
c(0.715652234,
    0.706087191, 0.706077173, 0.706104559, 0.70622666, 0.706098981
    ), slovenia = c(0.831886154, 0.831945994, 0.832003445, 0.832058602,
    0.832111556, 0.832162397), uk = c(1.504813191, 1.463648326,
    1.424235397, 1.38618692, 1.349628127, 1.318653737), usa = c(1.521675109,
    1.488286869, 1.451778376, 1.418378195, 1.384742397, 1.363477506
    )), row.names = c(NA, -6L), class = c("tbl_df", "tbl", "data.frame"
))

As there are some countries which are having higher volatilities than
countries with lower, is there any suggestion to improve the graph?

Looking forward to your suggestion in this regard.

With sincere regards,
Upananda Pani


On Tue, May 2, 2023 at 6:14?PM Chris Evans <chrishold at psyctc.org> wrote:
>
> I suspect that you have tried to pass your own data into the pivot_longer() function and your data probably doesn't have the rowN variable.
>
> First try running the whole of what I sent you.  It definitively works for me.  It gives me the attached graph.
>
> My code, using tribble() to read in the data you sent us, creates a rowN variable to save me the trouble of deleting those row numbers one by one.  Then I drop that variable with that select(-rowN) line.
>
> Assuming that works for you running my code on that tiny dataset, and that you are trying to use the code on your full data frame, called data_vol3 then try this:
>
> data_vol3 %>%
>   # select(-rowN) %>% # I have commented out this line
>   pivot_longer(cols = -index, # as you want to pivot the other variables/columns
>                names_to = "countries") -> tibDataVol3Long
>
> ggplot(data = tibDataVol3Long,
>        aes(x = index, y = value, group = countries, colour = countries)) +
>   geom_line()
>
> This is a very good illustration of why you should supply data using dput(data), dput(head(data)) if you have a large dataset. I know it doesn't feel a very sympathetic piece of advice, but I think you need to spend some days working on your understanding of R, ggplot and the tidyverse realm of R.  You can use ggplot() without using much of the tidyverse but they are designed to complement each other and the more I understand of the tidyverse way of doing things, the better I use ggplot().
>
> On 02/05/2023 13:44, Upananda Pani wrote:
>
> Hi Chris,
>
> Thank for your solutions and time. I am getting the following error
> while trying to execute the code you suggested.
>
> Error in select(., -rowN) : unused argument (-rowN)
>
> Regards,
> Upananda
>
> On Tue, May 2, 2023 at 3:08?PM Chris Evans via R-help
> <r-help at r-project.org> wrote:
>
> It's not clear what you want but ...
>
> On 02/05/2023 10:57, Upananda Pani wrote:
>
> Dear All,
>
> I have a dataset which contains date and 12 other countries data. I
> have extracted the data as xts object.
>
> I am not able to recall all the series in the Y axis. My data set
> looks like this
>
> index crepub finland france germany italy netherlands norway poland
> <date> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
> 1 2005-01-03 1.21 0.615 1.90 3.01 0.346 0.509 1.05 1.13
> 2 2005-01-04 1.18 0.615 1.85 2.89 0.346 0.509 0.889 1.12
> 3 2005-01-05 1.15 0.615 1.81 2.78 0.346 0.509 0.785 1.09
> 4 2005-01-06 1.11 0.615 1.76 2.67 0.346 0.509 0.711 1.06
> 5 2005-01-07 1.08 0.615 1.72 2.57 0.346 0.509 0.661 1.02
> 6 2005-01-10 1.04 0.615 1.69 2.48 0.346 0.509 0.630 1.01
>
> My code for the same is as follows
>
> ggplot(data=data_vol3, aes(x=index, y=data_vol3$usa)+
> geom_line())
>
> Well you don't need to say that the y data are from data_vol3, your data
> = declaration says that.
>
> I wonder if what you want is:
>
> library(tidyverse)
>
> tribble(
>    ~rowN, ~index, ~crepub, ~finland, ~france, ~germany, ~italy,
> ~netherlands, ~norway, ~poland,
>    1, "2005-01-03", 1.21, 0.615, 1.90, 3.01, 0.346, 0.509, 1.05, 1.13,
>    2, "2005-01-04", 1.18, 0.615, 1.85, 2.89, 0.346, 0.509, 0.889, 1.12,
>    3, "2005-01-05", 1.15, 0.615, 1.81, 2.78, 0.346, 0.509, 0.785, 1.09,
>    4, "2005-01-06", 1.11, 0.615, 1.76, 2.67, 0.346, 0.509, 0.711, 1.06,
>    5, "2005-01-07", 1.08, 0.615, 1.72, 2.57, 0.346, 0.509, 0.661, 1.02,
>    6, "2005-01-10", 1.04, 0.615, 1.69, 2.48, 0.346, 0.509, 0.630, 1.01)
> -> data_vol3
>
> ### please give us data using dput in future: saves us having to do
> something like that to reclaim it!
>
> ### pivot that longer to make it easy to get country data as separate lines
>
> data_vol3 %>%  select(-rowN) %>%
>    pivot_longer(cols = -index, # as you want to pivot the other
> variables/columns
>                 names_to = "countries") -> tibDataVol3Long
>
> ggplot(data = tibDataVol3Long,
>         aes(x = index, y = value,
>               ### now get the grouping and use it for a colour legend
>               group = countries, colour = countries)) +
>    geom_line()
>
> Any help in this regard will be highly appreciated
>
> With regards,
> Upananda Pani
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
> --
> Chris Evans (he/him)
> Visiting Professor, UDLA, Quito, Ecuador & Honorary Professor,
> University of Roehampton, London, UK.
> Work web site: https://www.psyctc.org/psyctc/
> CORE site: http://www.coresystemtrust.org.uk/
> Personal site: https://www.psyctc.org/pelerinage2016/
> Emeetings (Thursdays):
> <https://www.psyctc.org/pelerinage2016/>https://www.psyctc.org/psyctc/booking-meetings-with-me/
> (Beware: French time, generally an hour ahead of UK)
> <https://ombook.psyctc.org/book>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
> --
> Chris Evans (he/him)
> Visiting Professor, UDLA, Quito, Ecuador & Honorary Professor, University of Roehampton, London, UK.
> Work web site: https://www.psyctc.org/psyctc/
> CORE site: http://www.coresystemtrust.org.uk/
> Personal site: https://www.psyctc.org/pelerinage2016/
> Emeetings (Thursdays): https://www.psyctc.org/psyctc/booking-meetings-with-me/
> (Beware: French time, generally an hour ahead of UK)


From me @end|ng |rom n@nx@me  Mon May  1 22:36:17 2023
From: me @end|ng |rom n@nx@me (Nan Xiao)
Date: Mon, 01 May 2023 16:36:17 -0400
Subject: [R] [R-pkgs] gsDesign2 1.0.8 is released
Message-ID: <8e6617ab-a4aa-4a9c-927d-133e0cd846e5@app.fastmail.com>

Dear all,

A new version of gsDesign2 (1.0.8) is now on CRAN (https://cran.r-project.org/package=gsDesign2). gsDesign2 enables fixed or group sequential design under non-proportional hazards and supports highly flexible enrollment, time-to-event, and time-to-dropout assumptions.

The key improvements in this version include refined naming conventions for options in the info_scale argument adhering to the tidyverse design guide, and bug fixes for computing the futility bounds. Please see the changelog (https://merck.github.io/gsDesign2/news/) for details.

As the gsDesign2 package is still in its early stages, we're eager to continue refining its features and performance. We invite you to try out this new version and share your insights with us. Your feedback is invaluable in helping us develop a tool that meets the evolving needs of users.

Cheers,
-Nan

_______________________________________________
R-packages mailing list
R-packages at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-packages


From Thom@@@Ro@e @end|ng |rom d@@d-@|umn|@de  Tue May  2 11:31:14 2023
From: Thom@@@Ro@e @end|ng |rom d@@d-@|umn|@de (Thomas.Rose)
Date: Tue, 2 May 2023 09:31:14 +0000
Subject: [R] Reg: Help regarding ggplot2
In-Reply-To: <CAEezrQR3NNtW3-Y_n=eZ-BRwU3xV71UXQFEGY1hwEo60simhLA@mail.gmail.com>
References: <CAEezrQR3NNtW3-Y_n=eZ-BRwU3xV71UXQFEGY1hwEo60simhLA@mail.gmail.com>
Message-ID: <AS4P192MB1600E40FF1D55DC501756599C36F9@AS4P192MB1600.EURP192.PROD.OUTLOOK.COM>

Dear Upananda,

I see a misplaced bracket in your code, and there is no need in aes() to call the dataframe explicitly. Does this work?

ggplot(data = data_vol3, aes(x = index, y = usa)) +
  geom_line()

Best wishes,
Thomas

________________________________
Von: R-help <r-help-bounces at r-project.org> im Auftrag von Upananda Pani <upananda.pani at gmail.com>
Gesendet: Dienstag, 2. Mai 2023 10:57
An: r-help <r-help at r-project.org>
Betreff: [R] Reg: Help regarding ggplot2

Dear All,

I have a dataset which contains date and 12 other countries data. I
have extracted the data as xts object.

I am not able to recall all the series in the Y axis. My data set
looks like this

index      crepub finland france germany italy netherlands norway poland
  <date>      <dbl>   <dbl>  <dbl>   <dbl> <dbl>       <dbl>  <dbl>  <dbl>
1 2005-01-03   1.21   0.615   1.90    3.01 0.346       0.509  1.05    1.13
2 2005-01-04   1.18   0.615   1.85    2.89 0.346       0.509  0.889   1.12
3 2005-01-05   1.15   0.615   1.81    2.78 0.346       0.509  0.785   1.09
4 2005-01-06   1.11   0.615   1.76    2.67 0.346       0.509  0.711   1.06
5 2005-01-07   1.08   0.615   1.72    2.57 0.346       0.509  0.661   1.02
6 2005-01-10   1.04   0.615   1.69    2.48 0.346       0.509  0.630   1.01

My code for the same is as follows

ggplot(data=data_vol3, aes(x=index, y=data_vol3$usa)+
  geom_line())

Any help in this regard will be highly appreciated

With regards,
Upananda Pani

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From chr|@ho|d @end|ng |rom p@yctc@org  Tue May  2 18:27:05 2023
From: chr|@ho|d @end|ng |rom p@yctc@org (Chris Evans)
Date: Tue, 2 May 2023 18:27:05 +0200
Subject: [R] Reg: Help regarding ggplot2
In-Reply-To: <CAEezrQT2XTJqbSSMSUm0Dc=TFchCgR2ZQDGCwqM+zG8=CTAtzg@mail.gmail.com>
References: <CAEezrQR3NNtW3-Y_n=eZ-BRwU3xV71UXQFEGY1hwEo60simhLA@mail.gmail.com>
 <6b2026ec-c923-db89-3af9-36936aa72cea@psyctc.org>
 <CAEezrQQ4ktuU89yFfq6R_ZpQZ23rV8aEtynp5bOBkdAO2GT=hw@mail.gmail.com>
 <2362548d-dbdf-b902-e8cc-819991f712e4@psyctc.org>
 <CAEezrQT2XTJqbSSMSUm0Dc=TFchCgR2ZQDGCwqM+zG8=CTAtzg@mail.gmail.com>
Message-ID: <fe449922-c6f2-51bb-e299-14207f67da48@psyctc.org>

I'm only seeing six dates, by the look of them five at one day intervals 
and the last three days later.? According to my calendar those were 
weekdays in 2005.? I don't see much "volatility" there and that's not a 
term I'm familiar with, I suspect it's econometric.? I don't know what 
you're looking for and I think we're starting to get into issues about 
interpretation of data not issues about using R so off list.? I think 
you need statistical or econometric support from somewhere.

Good luck!

Chris

On 02/05/2023 17:50, Upananda Pani wrote:
> Hi Chrish,
>
> I am grateful to you for your reply. Your code is working fine.
> Moreover, you have guided me how to improve my knowledge, I appreciate
> it. I will be very careful next time.
> The data which i am working on is given below:
>
> dput(head(data_vol3))
> structure(list(index = structure(c(12786, 12787, 12788, 12789,
> 12790, 12793), tzone = "UTC", tclass = "Date", class = "Date"),
>      crepub = c(1.20601312, 1.176601845, 1.14945752, 1.112667506,
>      1.076184043, 1.042147848), finland = c(0.614973309, 0.615008409,
>      0.615034446, 0.615053761, 0.615068089, 0.615078717), france = c(1.896830857,
>      1.849908737, 1.807150091, 1.763296422, 1.719573044, 1.690600819
>      ), germany = c(3.01041925, 2.892518667, 2.780918603, 2.672356826,
>      2.567306135, 2.479892045), italy = c(0.345659867, 0.345675874,
>      0.345686934, 0.345694578, 0.34569986, 0.34570351), netherlands =
> c(0.509263785,
>      0.509279495, 0.509289967, 0.509296947, 0.509301605, 0.509304705
>      ), norway = c(1.052509528, 0.889357215, 0.784607722, 0.710551664,
>      0.661473027, 0.629951323), poland = c(1.127163733, 1.12432629,
>      1.087704091, 1.056705592, 1.024417693, 1.007962456), slovakia =
> c(0.715652234,
>      0.706087191, 0.706077173, 0.706104559, 0.70622666, 0.706098981
>      ), slovenia = c(0.831886154, 0.831945994, 0.832003445, 0.832058602,
>      0.832111556, 0.832162397), uk = c(1.504813191, 1.463648326,
>      1.424235397, 1.38618692, 1.349628127, 1.318653737), usa = c(1.521675109,
>      1.488286869, 1.451778376, 1.418378195, 1.384742397, 1.363477506
>      )), row.names = c(NA, -6L), class = c("tbl_df", "tbl", "data.frame"
> ))
>
> As there are some countries which are having higher volatilities than
> countries with lower, is there any suggestion to improve the graph?
>
> Looking forward to your suggestion in this regard.
>
> With sincere regards,
> Upananda Pani
>
>
> On Tue, May 2, 2023 at 6:14?PM Chris Evans<chrishold at psyctc.org>  wrote:
>> I suspect that you have tried to pass your own data into the pivot_longer() function and your data probably doesn't have the rowN variable.
>>
>> First try running the whole of what I sent you.  It definitively works for me.  It gives me the attached graph.
>>
>> My code, using tribble() to read in the data you sent us, creates a rowN variable to save me the trouble of deleting those row numbers one by one.  Then I drop that variable with that select(-rowN) line.
>>
>> Assuming that works for you running my code on that tiny dataset, and that you are trying to use the code on your full data frame, called data_vol3 then try this:
>>
>> data_vol3 %>%
>>    # select(-rowN) %>% # I have commented out this line
>>    pivot_longer(cols = -index, # as you want to pivot the other variables/columns
>>                 names_to = "countries") -> tibDataVol3Long
>>
>> ggplot(data = tibDataVol3Long,
>>         aes(x = index, y = value, group = countries, colour = countries)) +
>>    geom_line()
>>
>> This is a very good illustration of why you should supply data using dput(data), dput(head(data)) if you have a large dataset. I know it doesn't feel a very sympathetic piece of advice, but I think you need to spend some days working on your understanding of R, ggplot and the tidyverse realm of R.  You can use ggplot() without using much of the tidyverse but they are designed to complement each other and the more I understand of the tidyverse way of doing things, the better I use ggplot().
>>
>> On 02/05/2023 13:44, Upananda Pani wrote:
>>
>> Hi Chris,
>>
>> Thank for your solutions and time. I am getting the following error
>> while trying to execute the code you suggested.
>>
>> Error in select(., -rowN) : unused argument (-rowN)
>>
>> Regards,
>> Upananda
>>
>> On Tue, May 2, 2023 at 3:08?PM Chris Evans via R-help
>> <r-help at r-project.org>  wrote:
>>
>> It's not clear what you want but ...
>>
>> On 02/05/2023 10:57, Upananda Pani wrote:
>>
>> Dear All,
>>
>> I have a dataset which contains date and 12 other countries data. I
>> have extracted the data as xts object.
>>
>> I am not able to recall all the series in the Y axis. My data set
>> looks like this
>>
>> index crepub finland france germany italy netherlands norway poland
>> <date> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
>> 1 2005-01-03 1.21 0.615 1.90 3.01 0.346 0.509 1.05 1.13
>> 2 2005-01-04 1.18 0.615 1.85 2.89 0.346 0.509 0.889 1.12
>> 3 2005-01-05 1.15 0.615 1.81 2.78 0.346 0.509 0.785 1.09
>> 4 2005-01-06 1.11 0.615 1.76 2.67 0.346 0.509 0.711 1.06
>> 5 2005-01-07 1.08 0.615 1.72 2.57 0.346 0.509 0.661 1.02
>> 6 2005-01-10 1.04 0.615 1.69 2.48 0.346 0.509 0.630 1.01
>>
>> My code for the same is as follows
>>
>> ggplot(data=data_vol3, aes(x=index, y=data_vol3$usa)+
>> geom_line())
>>
>> Well you don't need to say that the y data are from data_vol3, your data
>> = declaration says that.
>>
>> I wonder if what you want is:
>>
>> library(tidyverse)
>>
>> tribble(
>>     ~rowN, ~index, ~crepub, ~finland, ~france, ~germany, ~italy,
>> ~netherlands, ~norway, ~poland,
>>     1, "2005-01-03", 1.21, 0.615, 1.90, 3.01, 0.346, 0.509, 1.05, 1.13,
>>     2, "2005-01-04", 1.18, 0.615, 1.85, 2.89, 0.346, 0.509, 0.889, 1.12,
>>     3, "2005-01-05", 1.15, 0.615, 1.81, 2.78, 0.346, 0.509, 0.785, 1.09,
>>     4, "2005-01-06", 1.11, 0.615, 1.76, 2.67, 0.346, 0.509, 0.711, 1.06,
>>     5, "2005-01-07", 1.08, 0.615, 1.72, 2.57, 0.346, 0.509, 0.661, 1.02,
>>     6, "2005-01-10", 1.04, 0.615, 1.69, 2.48, 0.346, 0.509, 0.630, 1.01)
>> -> data_vol3
>>
>> ### please give us data using dput in future: saves us having to do
>> something like that to reclaim it!
>>
>> ### pivot that longer to make it easy to get country data as separate lines
>>
>> data_vol3 %>%  select(-rowN) %>%
>>     pivot_longer(cols = -index, # as you want to pivot the other
>> variables/columns
>>                  names_to = "countries") -> tibDataVol3Long
>>
>> ggplot(data = tibDataVol3Long,
>>          aes(x = index, y = value,
>>                ### now get the grouping and use it for a colour legend
>>                group = countries, colour = countries)) +
>>     geom_line()
>>
>> Any help in this regard will be highly appreciated
>>
>> With regards,
>> Upananda Pani
>>
>> ______________________________________________
>> R-help at r-project.org  mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> --
>> Chris Evans (he/him)
>> Visiting Professor, UDLA, Quito, Ecuador & Honorary Professor,
>> University of Roehampton, London, UK.
>> Work web site:https://www.psyctc.org/psyctc/
>> CORE site:http://www.coresystemtrust.org.uk/
>> Personal site:https://www.psyctc.org/pelerinage2016/
>> Emeetings (Thursdays):
>> <https://www.psyctc.org/pelerinage2016/>https://www.psyctc.org/psyctc/booking-meetings-with-me/
>> (Beware: French time, generally an hour ahead of UK)
>> <https://ombook.psyctc.org/book>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org  mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guidehttp://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> --
>> Chris Evans (he/him)
>> Visiting Professor, UDLA, Quito, Ecuador & Honorary Professor, University of Roehampton, London, UK.
>> Work web site:https://www.psyctc.org/psyctc/
>> CORE site:http://www.coresystemtrust.org.uk/
>> Personal site:https://www.psyctc.org/pelerinage2016/
>> Emeetings (Thursdays):https://www.psyctc.org/psyctc/booking-meetings-with-me/
>> (Beware: French time, generally an hour ahead of UK)
-- 
Chris Evans (he/him)
Visiting Professor, UDLA, Quito, Ecuador & Honorary Professor, 
University of Roehampton, London, UK.
Work web site: https://www.psyctc.org/psyctc/
CORE site: http://www.coresystemtrust.org.uk/
Personal site: https://www.psyctc.org/pelerinage2016/
Emeetings (Thursdays): 
<https://www.psyctc.org/pelerinage2016/>https://www.psyctc.org/psyctc/booking-meetings-with-me/
(Beware: French time, generally an hour ahead of UK)
<https://ombook.psyctc.org/book>
	[[alternative HTML version deleted]]


From m|@thour| @end|ng |rom y@hoo@gr  Tue May  2 21:23:04 2023
From: m|@thour| @end|ng |rom y@hoo@gr (Maria Lathouri)
Date: Tue, 2 May 2023 19:23:04 +0000 (UTC)
Subject: [R] Error in percentage stacked barplot
References: <2006719832.4245163.1683055384501.ref@mail.yahoo.com>
Message-ID: <2006719832.4245163.1683055384501@mail.yahoo.com>

Dear all,?
I am trying to plot the following table in stacked barplot in percentages and also horizontal.
Component? ? ? Sample 1? ? ? Sample 2? ? ? Sample 3CaO????????????????? ? 45????????????? ? 52????????????? ? 48SiO2????????????????? ?25????????????? ? 22????????????? ? 18Al2O3?????????????????15????????????? ? 11????????????? ? 14TiO2? ? ? ? ? ? ? ? ? ? ?6? ? ? ? ? ? ? ? ? 5? ? ? ? ? ? ? ? 6? ? ??Na2O????????????????? ? 5????????????????? 4????????????? ? 5CuO? ? ? ? ? ? ? ? ? ? ? 3? ? ? ? ? ? ? ? ? 3? ? ? ? ? ? ? ? 5? ? ? ? ?Cl?????????????????????????1????????????????? 3? ? ? ? ? ? ? ? 4
When I tried the following functionbarplot(data,
+         main = "Stacked bar chart",
+         sub = "Subtitle",
+         xlab = "X-lab",
+         ylab = "Y-lab",
+         axes = TRUE, horiz = TRUE)
I got the following error
Error in barplot.default(hellisheidi, main = "Stacked bar chart", sub = "Subtitle",  : 
  'height' must be a vector or a matrix
I also tried barplot(as.matrix(hellisheidi)) but what I was getting was the three stacked columns for Samples 1, 2 and 3 but I was getting an empty column for Component, instead of being the variable in the Samples. 


I was hoping if you could help me on that. 
Thank you very much in advance. 
Kind regards,Maria




-------------- next part --------------
A non-text attachment was scrubbed...
Name: 1683055323500blob.jpg
Type: image/png
Size: 11610 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20230502/e508c126/attachment.png>

From rmh @end|ng |rom temp|e@edu  Tue May  2 21:51:11 2023
From: rmh @end|ng |rom temp|e@edu (Richard M. Heiberger)
Date: Tue, 2 May 2023 19:51:11 +0000
Subject: [R] [External]  Error in percentage stacked barplot
In-Reply-To: <2006719832.4245163.1683055384501@mail.yahoo.com>
References: <2006719832.4245163.1683055384501.ref@mail.yahoo.com>
 <2006719832.4245163.1683055384501@mail.yahoo.com>
Message-ID: <3238A038-876A-42C6-995B-CBF7BDC08C3F@temple.edu>

## you may need to install HH
install.packagess("HH")

library(HH)

hellisheidi <- read.table(text="
Component      Sample1      Sample2      Sample3
CaO                    45                52                48
SiO2                   25                22                18
Al2O3                 15                11                14
TiO2  		      6                  5                6
Na2O                    5                  4                5
CuO                      3        3                5
Cl                         1                  3                4"
, header=TRUE, row.names="Component")

likert(t(hellisheidi), ReferenceZero=.5,
       xlab="X-lab", ylab="Y-lab", main="Stacked bar chart")


> On May 2, 2023, at 15:23, Maria Lathouri via R-help <r-help at r-project.org> wrote:
> 
> Dear all, 
> I am trying to plot the following table in stacked barplot in percentages and also horizontal.
> Component      Sample 1      Sample 2      Sample 3CaO                    45                52                48SiO2                   25                22                18Al2O3                 15                11                14TiO2                     6                  5                6      Na2O                    5                  4                5CuO                      3                  3                5         Cl                         1                  3                4
> When I tried the following functionbarplot(data,
> +         main = "Stacked bar chart",
> +         sub = "Subtitle",
> +         xlab = "X-lab",
> +         ylab = "Y-lab",
> +         axes = TRUE, horiz = TRUE)
> I got the following error
> Error in barplot.default(hellisheidi, main = "Stacked bar chart", sub = "Subtitle",  : 
>  'height' must be a vector or a matrix
> I also tried barplot(as.matrix(hellisheidi)) but what I was getting was the three stacked columns for Samples 1, 2 and 3 but I was getting an empty column for Component, instead of being the variable in the Samples. 
> 
> 
> I was hoping if you could help me on that. 
> Thank you very much in advance. 
> Kind regards,Maria
> 
> 
> 
> <1683055323500blob.jpg>______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m|@thour| @end|ng |rom y@hoo@gr  Wed May  3 10:58:29 2023
From: m|@thour| @end|ng |rom y@hoo@gr (Maria Lathouri)
Date: Wed, 3 May 2023 08:58:29 +0000 (UTC)
Subject: [R] [External]  Error in percentage stacked barplot
In-Reply-To: <3238A038-876A-42C6-995B-CBF7BDC08C3F@temple.edu>
References: <2006719832.4245163.1683055384501.ref@mail.yahoo.com>
 <2006719832.4245163.1683055384501@mail.yahoo.com>
 <3238A038-876A-42C6-995B-CBF7BDC08C3F@temple.edu>
Message-ID: <1098577910.222279.1683104309778@mail.yahoo.com>


Dear Richard,?

Thank you very much for your reply. I went through the code and it worked. I was also able to change the colours.?

I was wondering if I can change the legend position; instead of being in the bottom to be on the left side.?

I tried the following but without any success

strip = FALSE
strip.right = TRUE

likert(t(hellisheidi), ReferenceZero=.5, xlab="X-lab", ylab="Y-lab", main="Stacked bar chart", col=c("#E94E1B", "#F7AA4E", "#BEBEBE", "#6193CE", "#00508C", "#E94E1B", "#BEBEBE"), legend.position="left")

Once again, thank you very much.

Kind regards,
Maria


???? ????? 2 ????? 2023 ???? 08:51:16 ?.?. GMT+1, ? ??????? Richard M. Heiberger <rmh at temple.edu> ??????: 





## you may need to install HH
install.packagess("HH")

library(HH)

hellisheidi <- read.table(text="
Component? ? ? Sample1? ? ? Sample2? ? ? Sample3
CaO? ? ? ? ? ? ? ? ? ? 45? ? ? ? ? ? ? ? 52? ? ? ? ? ? ? ? 48
SiO2? ? ? ? ? ? ? ? ? 25? ? ? ? ? ? ? ? 22? ? ? ? ? ? ? ? 18
Al2O3? ? ? ? ? ? ? ? 15? ? ? ? ? ? ? ? 11? ? ? ? ? ? ? ? 14
TiO2? ??? ??? ? ? ? 6? ? ? ? ? ? ? ? ? 5? ? ? ? ? ? ? ? 6
Na2O? ? ? ? ? ? ? ? ? ? 5? ? ? ? ? ? ? ? ? 4? ? ? ? ? ? ? ? 5
CuO? ? ? ? ? ? ? ? ? ? ? 3? ? ? ? 3? ? ? ? ? ? ? ? 5
Cl? ? ? ? ? ? ? ? ? ? ? ? 1? ? ? ? ? ? ? ? ? 3? ? ? ? ? ? ? ? 4"
, header=TRUE, row.names="Component")

likert(t(hellisheidi), ReferenceZero=.5,
? ? ? xlab="X-lab", ylab="Y-lab", main="Stacked bar chart")


> On May 2, 2023, at 15:23, Maria Lathouri via R-help <r-help at r-project.org> wrote:
> 
> Dear all, 
> I am trying to plot the following table in stacked barplot in percentages and also horizontal.
> Component? ? ? Sample 1? ? ? Sample 2? ? ? Sample 3CaO? ? ? ? ? ? ? ? ? ? 45? ? ? ? ? ? ? ? 52? ? ? ? ? ? ? ? 48SiO2? ? ? ? ? ? ? ? ? 25? ? ? ? ? ? ? ? 22? ? ? ? ? ? ? ? 18Al2O3? ? ? ? ? ? ? ? 15? ? ? ? ? ? ? ? 11? ? ? ? ? ? ? ? 14TiO2? ? ? ? ? ? ? ? ? ? 6? ? ? ? ? ? ? ? ? 5? ? ? ? ? ? ? ? 6? ? ? Na2O? ? ? ? ? ? ? ? ? ? 5? ? ? ? ? ? ? ? ? 4? ? ? ? ? ? ? ? 5CuO? ? ? ? ? ? ? ? ? ? ? 3? ? ? ? ? ? ? ? ? 3? ? ? ? ? ? ? ? 5? ? ? ? Cl? ? ? ? ? ? ? ? ? ? ? ? 1? ? ? ? ? ? ? ? ? 3? ? ? ? ? ? ? ? 4
> When I tried the following functionbarplot(data,
> +? ? ? ? main = "Stacked bar chart",
> +? ? ? ? sub = "Subtitle",
> +? ? ? ? xlab = "X-lab",
> +? ? ? ? ylab = "Y-lab",
> +? ? ? ? axes = TRUE, horiz = TRUE)
> I got the following error
> Error in barplot.default(hellisheidi, main = "Stacked bar chart", sub = "Subtitle",? : 
>? 'height' must be a vector or a matrix
> I also tried barplot(as.matrix(hellisheidi)) but what I was getting was the three stacked columns for Samples 1, 2 and 3 but I was getting an empty column for Component, instead of being the variable in the Samples. 
> 
> 
> I was hoping if you could help me on that. 
> Thank you very much in advance. 
> Kind regards,Maria
> 
> 
> 
> <1683055323500blob.jpg>______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From rmh @end|ng |rom temp|e@edu  Wed May  3 15:57:17 2023
From: rmh @end|ng |rom temp|e@edu (Richard M. Heiberger)
Date: Wed, 3 May 2023 13:57:17 +0000
Subject: [R] [External]  Error in percentage stacked barplot
In-Reply-To: <1098577910.222279.1683104309778@mail.yahoo.com>
References: <2006719832.4245163.1683055384501.ref@mail.yahoo.com>
 <2006719832.4245163.1683055384501@mail.yahoo.com>
 <3238A038-876A-42C6-995B-CBF7BDC08C3F@temple.edu>
 <1098577910.222279.1683104309778@mail.yahoo.com>
Message-ID: <B8CD7642-3C18-4D33-A1C7-2140BB804D3A@temple.edu>

likert is built on the lattice barchart function.
Hence everything in
?panel.barchart
?xyplot
applies.  The legend is constructed with the auto.key argument.

You can move the legend to the left, but that is not a good idea for a horizontal barchart.

likert(t(hellisheidi), ReferenceZero=.5,
        xlab="X-lab", ylab="Y-lab", main="stacked bar chart",
        auto.key=list(space="left", columns=1))

Note that the legend is vertical and the plot is horizontal, making it difficult
to read both simultaneously.

Rich

> On May 3, 2023, at 04:58, Maria Lathouri <mlathouri at yahoo.gr> wrote:
>
>
> Dear Richard,
>
> Thank you very much for your reply. I went through the code and it worked. I was also able to change the colours.
>
> I was wondering if I can change the legend position; instead of being in the bottom to be on the left side.
>
> I tried the following but without any success
>
> strip = FALSE
> strip.right = TRUE
>
> likert(t(hellisheidi), ReferenceZero=.5, xlab="X-lab", ylab="Y-lab", main="Stacked bar chart", col=c("#E94E1B", "#F7AA4E", "#BEBEBE", "#6193CE", "#00508C", "#E94E1B", "#BEBEBE"), legend.position="left")
>
> Once again, thank you very much.
>
> Kind regards,
> Maria
>
>
> ???? ????? 2 ????? 2023 ???? 08:51:16 ?.?. GMT+1, ? ??????? Richard M. Heiberger <rmh at temple.edu> ??????:
>
>
>
>
>
> ## you may need to install HH
> install.packagess("HH")
>
> library(HH)
>
> hellisheidi <- read.table(text="
> Component      Sample1      Sample2      Sample3
> CaO                    45                52                48
> SiO2                  25                22                18
> Al2O3                15                11                14
> TiO2                6                  5                6
> Na2O                    5                  4                5
> CuO                      3        3                5
> Cl                        1                  3                4"
> , header=TRUE, row.names="Component")
>
> likert(t(hellisheidi), ReferenceZero=.5,
>       xlab="X-lab", ylab="Y-lab", main="Stacked bar chart")
>
>
>> On May 2, 2023, at 15:23, Maria Lathouri via R-help <r-help at r-project.org> wrote:
>>
>> Dear all,
>> I am trying to plot the following table in stacked barplot in percentages and also horizontal.
>> Component      Sample 1      Sample 2      Sample 3CaO                    45                52                48SiO2                  25                22                18Al2O3                15                11                14TiO2 6                  5                6      Na2O                    5                  4                5CuO                      3      3                5        Cl                        1                  3                4
>> When I tried the following functionbarplot(data,
>> +        main = "Stacked bar chart",
>> +        sub = "Subtitle",
>> +        xlab = "X-lab",
>> +        ylab = "Y-lab",
>> +        axes = TRUE, horiz = TRUE)
>> I got the following error
>> Error in barplot.default(hellisheidi, main = "Stacked bar chart", sub = "Subtitle",  :
>>   'height' must be a vector or a matrix
>> I also tried barplot(as.matrix(hellisheidi)) but what I was getting was the three stacked columns for Samples 1, 2 and 3 but I was getting an empty column for Component, instead of being the variable in the Samples.
>>
>>
>> I was hoping if you could help me on that.
>> Thank you very much in advance.
>> Kind regards,Maria
>>
>>
>>
>> <1683055323500blob.jpg>______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.r-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.



From r@b364 @end|ng |rom @c@r|etm@||@rutger@@edu  Wed May  3 17:42:28 2023
From: r@b364 @end|ng |rom @c@r|etm@||@rutger@@edu (RIDDHI BABEL)
Date: Wed, 3 May 2023 11:42:28 -0400
Subject: [R] Question about implementing statistical test in R
Message-ID: <CAJXJZ4Z6n575vkxymNBWvdVNfrGb=i7jfJ2aWDp9=6d2YFQn1g@mail.gmail.com>

Hi,

I am a new user and have a stats question that I need help implementing in
R.

I have 4 groups and I want to assess whether there is a statistical
difference between these groups at baseline first in a global comparison
test and then a pairwise comparison test.

There are about 2 continuous variables and 10 categorical variables

For the group wise comparison for continuous variables-I am using the Mann
Whitney test

For the categorical variables-I am using either chi square or Fisher
exact test for both global comparison and pairwise comparison.

What packages should I use to implement this in R? Is there any example
code that I use? I was thinking tbl_summary but don't think that's the
right one.

Would really appreciate any help with this!

Thank you!

	[[alternative HTML version deleted]]


From tebert @end|ng |rom u||@edu  Wed May  3 21:23:46 2023
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Wed, 3 May 2023 19:23:46 +0000
Subject: [R] Question about implementing statistical test in R
In-Reply-To: <CAJXJZ4Z6n575vkxymNBWvdVNfrGb=i7jfJ2aWDp9=6d2YFQn1g@mail.gmail.com>
References: <CAJXJZ4Z6n575vkxymNBWvdVNfrGb=i7jfJ2aWDp9=6d2YFQn1g@mail.gmail.com>
Message-ID: <SN4PR22MB282458C10EE239F40FFCD5C3CF6C9@SN4PR22MB2824.namprd22.prod.outlook.com>

Start with defining your dependent variable and independent variable(s). As an equation like y equals some function of x, the y is the dependent variable. It is often continuous, but does not have to be.

If your continuous variable is the dependent variable and you have one categorical independent variable then the ANOVA would be a general comparison tests determining if there are differences. This can be further broken down by a multiple comparison test. The Tukey test is commonly used if you assume normal distributions. The Kruskal-Wallis test would be the start of a non-parametric approach.


Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of RIDDHI BABEL via R-help
Sent: Wednesday, May 3, 2023 11:42 AM
To: r-help at r-project.org
Subject: [R] Question about implementing statistical test in R

[External Email]

Hi,

I am a new user and have a stats question that I need help implementing in R.

I have 4 groups and I want to assess whether there is a statistical difference between these groups at baseline first in a global comparison test and then a pairwise comparison test.

There are about 2 continuous variables and 10 categorical variables

For the group wise comparison for continuous variables-I am using the Mann Whitney test

For the categorical variables-I am using either chi square or Fisher exact test for both global comparison and pairwise comparison.

What packages should I use to implement this in R? Is there any example code that I use? I was thinking tbl_summary but don't think that's the right one.

Would really appreciate any help with this!

Thank you!

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.r-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From @zz@||n| @end|ng |rom @t@t@un|pd@|t  Thu May  4 10:05:10 2023
From: @zz@||n| @end|ng |rom @t@t@un|pd@|t (Adelchi Azzalini)
Date: Thu, 4 May 2023 10:05:10 +0200
Subject: [R] question about update()
Message-ID: <545716BA-05C4-4C53-92BC-40B23555AF69@stat.unipd.it>

Hi. There must be something about the use of update() which I do not grasp,
as the next exercise indicates.

Suppose that obj is an object returned by a call to lm() or glm().
Next, a new variable xf is constructed using the same dataframe used 
for producing obj. Then

obj$data <- cbind(obj$data, xf=xf)
new.obj <- update(obj, . ~ . + xf) 

generates

Error in eval(predvars, data, env) : object 'xf' not found

Could somebody explain what I got wrong, and how to fix it?

Best regards,

Adelchi Azzalini


From @zz@||n| @end|ng |rom @t@t@un|pd@|t  Thu May  4 10:34:00 2023
From: @zz@||n| @end|ng |rom @t@t@un|pd@|t (Adelchi Azzalini)
Date: Thu, 4 May 2023 10:34:00 +0200
Subject: [R] question about update()
In-Reply-To: <309026bc-6401-4a4c-4912-c06ba71026dd@gmail.com>
References: <545716BA-05C4-4C53-92BC-40B23555AF69@stat.unipd.it>
 <309026bc-6401-4a4c-4912-c06ba71026dd@gmail.com>
Message-ID: <0B6085C3-2530-45D6-B9A1-E16460BE04FF@stat.unipd.it>



> On 4 May 2023, at 10:26, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> On 04/05/2023 4:05 a.m., Adelchi Azzalini via R-help wrote:
>> Hi. There must be something about the use of update() which I do not grasp,
>> as the next exercise indicates.
>> Suppose that obj is an object returned by a call to lm() or glm().
>> Next, a new variable xf is constructed using the same dataframe used
>> for producing obj. Then
>> obj$data <- cbind(obj$data, xf=xf)
>> new.obj <- update(obj, . ~ . + xf)
>> generates
>> Error in eval(predvars, data, env) : object 'xf' not found
>> Could somebody explain what I got wrong, and how to fix it?
> 
> I don't think you should be modifying the obj$data element:  as far as I can see, it's not used during the update, which will just re-evaluate the original call to glm().  So you should modify the dataframe that you passed in when creating obj.
> 

Thanks, Duncan. What you indicate is surely the ideal route. Unfortunately, in my case this is not feasible, because the construction of xf and the update call are within an iterative procedure where xf is changed at each iteration, so that the steps 

obj$data <- cbind(obj$data, xf=xf)
new.obj <- update(obj, . ~ . + xf)
 
must be repeated hundreds of times, each with a different xf.

Adelchi


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu May  4 10:49:06 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 4 May 2023 04:49:06 -0400
Subject: [R] question about update()
In-Reply-To: <0B6085C3-2530-45D6-B9A1-E16460BE04FF@stat.unipd.it>
References: <545716BA-05C4-4C53-92BC-40B23555AF69@stat.unipd.it>
 <309026bc-6401-4a4c-4912-c06ba71026dd@gmail.com>
 <0B6085C3-2530-45D6-B9A1-E16460BE04FF@stat.unipd.it>
Message-ID: <eca72687-d7b6-334e-16d6-44f86a2129c8@gmail.com>

On 04/05/2023 4:34 a.m., Adelchi Azzalini wrote:
> 
> 
>> On 4 May 2023, at 10:26, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>
>> On 04/05/2023 4:05 a.m., Adelchi Azzalini via R-help wrote:
>>> Hi. There must be something about the use of update() which I do not grasp,
>>> as the next exercise indicates.
>>> Suppose that obj is an object returned by a call to lm() or glm().
>>> Next, a new variable xf is constructed using the same dataframe used
>>> for producing obj. Then
>>> obj$data <- cbind(obj$data, xf=xf)
>>> new.obj <- update(obj, . ~ . + xf)
>>> generates
>>> Error in eval(predvars, data, env) : object 'xf' not found
>>> Could somebody explain what I got wrong, and how to fix it?
>>
>> I don't think you should be modifying the obj$data element:  as far as I can see, it's not used during the update, which will just re-evaluate the original call to glm().  So you should modify the dataframe that you passed in when creating obj.
>>
> 
> Thanks, Duncan. What you indicate is surely the ideal route. Unfortunately, in my case this is not feasible, because the construction of xf and the update call are within an iterative procedure where xf is changed at each iteration, so that the steps
> 
> obj$data <- cbind(obj$data, xf=xf)
> new.obj <- update(obj, . ~ . + xf)
>   
> must be repeated hundreds of times, each with a different xf.

Sorry, that doesn't make sense.

You didn't show us complete code, but presumably it's preceded by 
something like this:

   obj <- glm( ..., data = somedata)

So change your modification to this:

   somedata$xf <- xf

That can be done hundreds of times.  This will need to be more elaborate 
if the function doing the iteration has a copy of obj but doesn't have a 
copy of somedata, but there are lots of ways to resolve that.  Without 
seeing complete code, I can't recommend which one to use.

Duncan Murdoch


From berw|n@tur|@ch @end|ng |rom gm@||@com  Thu May  4 11:44:10 2023
From: berw|n@tur|@ch @end|ng |rom gm@||@com (Berwin A Turlach)
Date: Thu, 4 May 2023 17:44:10 +0800
Subject: [R] question about update()
In-Reply-To: <0B6085C3-2530-45D6-B9A1-E16460BE04FF@stat.unipd.it>
References: <545716BA-05C4-4C53-92BC-40B23555AF69@stat.unipd.it>
 <309026bc-6401-4a4c-4912-c06ba71026dd@gmail.com>
 <0B6085C3-2530-45D6-B9A1-E16460BE04FF@stat.unipd.it>
Message-ID: <20230504174410.1b8d0abd@dep59159.uniwa.uwa.edu.au>

G'day Adelchi,

hope all is well with you.

On Thu, 4 May 2023 10:34:00 +0200
Adelchi Azzalini via R-help <r-help at r-project.org> wrote:

> Thanks, Duncan. What you indicate is surely the ideal route.
> Unfortunately, in my case this is not feasible, because the
> construction of xf and the update call are within an iterative
> procedure where xf is changed at each iteration, so that the steps 
> 
> obj$data <- cbind(obj$data, xf=xf)
> new.obj <- update(obj, . ~ . + xf)
>  
> must be repeated hundreds of times, each with a different xf.

If memory serves correctly, update() takes the object that is passed to
it, looks at what the call was that created that object, modifies that
call according to the additional arguments, and finally executes the
modified call.

So there is a lot of manipulations going on in update().  In particular
it would result each time in a call to lm(), glm() or whatever call was
used to create the object.  Inside any of these modelling functions a
lot of symbolic manipulations/calculations are needed too (parsing the
formula, creating the design matrix and response vector from the parsed
formula and data frame, checking if weights are used &c).

If you do the same calculation essentially over and over again, just
with minor modification, all these symbolic manipulations are just time
consuming.

IMHO, you will be better off to bypass update() and just use lm.fit()
(for which lm() is a nice front-end) and glm.fit() (for which glm() is a
nice front-end), or whatever routine does the grunt work of fitting the
model to the data in your application (hopefully, the package creator
used a set up of XXX.fit() to fit the model, called by XXX() that does
all the fancy formula handling).

Cheers,

	Berwin


From @zz@||n| @end|ng |rom @t@t@un|pd@|t  Thu May  4 14:56:02 2023
From: @zz@||n| @end|ng |rom @t@t@un|pd@|t (Adelchi Azzalini)
Date: Thu, 4 May 2023 14:56:02 +0200
Subject: [R] question about update()
In-Reply-To: <20230504174410.1b8d0abd@dep59159.uniwa.uwa.edu.au>
References: <545716BA-05C4-4C53-92BC-40B23555AF69@stat.unipd.it>
 <309026bc-6401-4a4c-4912-c06ba71026dd@gmail.com>
 <0B6085C3-2530-45D6-B9A1-E16460BE04FF@stat.unipd.it>
 <20230504174410.1b8d0abd@dep59159.uniwa.uwa.edu.au>
Message-ID: <8596EA98-2A49-4EF1-B1E9-E36C85765F6A@stat.unipd.it>

Hi, Berwin, good to hear from you, and thanks for the detailed comments and suggestion.

Actually, my current experimental code works in the way that you suggest, calling directly lm.fit and glm.fit.  What I am trying to develop is an ?improved? version of the code for distribution to other people. Hence I wanted to streamline the code, in particular avoiding branches for each fitting procedure (lm.fit, glm.fit and possibly more).  But I am now considering to drop the idea of the ?improved? version, and stick to the direct calls to the fitting functions.

Duncan, thanks for your additional comments. It is true that my original message presented a very simplified picture of the problem, possibly over-simplistic.  If I present the problem in the full version of the code, it would look quite long and messy. If I manage to construct a reasonably simplified version of the code, I shall post the question again.

Best wishes,

Adelchi
 

> On 4 May 2023, at 11:44, Berwin A Turlach <berwin.turlach at gmail.com> wrote:
> 
> G'day Adelchi,
> 
> hope all is well with you.
> 
> On Thu, 4 May 2023 10:34:00 +0200
> Adelchi Azzalini via R-help <r-help at r-project.org> wrote:
> 
>> Thanks, Duncan. What you indicate is surely the ideal route.
>> Unfortunately, in my case this is not feasible, because the
>> construction of xf and the update call are within an iterative
>> procedure where xf is changed at each iteration, so that the steps 
>> 
>> obj$data <- cbind(obj$data, xf=xf)
>> new.obj <- update(obj, . ~ . + xf)
>> 
>> must be repeated hundreds of times, each with a different xf.
> 
> If memory serves correctly, update() takes the object that is passed to
> it, looks at what the call was that created that object, modifies that
> call according to the additional arguments, and finally executes the
> modified call.
> 
> So there is a lot of manipulations going on in update().  In particular
> it would result each time in a call to lm(), glm() or whatever call was
> used to create the object.  Inside any of these modelling functions a
> lot of symbolic manipulations/calculations are needed too (parsing the
> formula, creating the design matrix and response vector from the parsed
> formula and data frame, checking if weights are used &c).
> 
> If you do the same calculation essentially over and over again, just
> with minor modification, all these symbolic manipulations are just time
> consuming.
> 
> IMHO, you will be better off to bypass update() and just use lm.fit()
> (for which lm() is a nice front-end) and glm.fit() (for which glm() is a
> nice front-end), or whatever routine does the grunt work of fitting the
> model to the data in your application (hopefully, the package creator
> used a set up of XXX.fit() to fit the model, called by XXX() that does
> all the fancy formula handling).
> 
> Cheers,
> 
> Berwin
> 


From |eo@m@d@ @end|ng |rom @yon|c@eu  Thu May  4 22:59:33 2023
From: |eo@m@d@ @end|ng |rom @yon|c@eu (Leonard Mada)
Date: Thu, 4 May 2023 23:59:33 +0300
Subject: [R] Regex Split?
Message-ID: <7b1cdbe7-0086-24b4-9da6-369296eadfdc@syonic.eu>

Dear R-Users,

I tried the following 3 Regex expressions in R 4.3:
strsplit("a bc,def, adef ,,gh", " |(?=,)|(?<=,)(?![ ])", perl=T)
# "a"??? "bc"?? ","??? "def"? ","??? ""???? "adef" ","??? "," "gh"

strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?![ ])", perl=T)
# "a"??? "bc"?? ","??? "def"? ","??? ""???? "adef" ","??? "," "gh"

strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?=[^ ])", perl=T)
# "a"??? "bc"?? ","??? "def"? ","??? ""???? "adef" ","??? "," "gh"


Is this correct?


I feel that:
- none should return (after "def"): ",", "";
- the first one could also return "", "," (but probably not; not fully 
sure about this);


Sincerely,


Leonard


From @@@h@@w@ng2017 @end|ng |rom y@ndex@com  Fri May  5 08:24:04 2023
From: @@@h@@w@ng2017 @end|ng |rom y@ndex@com (Jiayue Wang)
Date: Fri, 5 May 2023 14:24:04 +0800
Subject: [R] rgl not plotting properly
Message-ID: <dedac47f-7bcf-ca27-4df6-1ee7027aa10d@yandex.com>

Hi

I can't get rgl working. I installed rgl, loaded it, but it seems all 
plot3d codes have failed:

remotes::install_github("dmurdoch/rgl")
library(rgl)
open3d()
x <- sort(rnorm(1000))
y <- rnorm(1000)
z <- rnorm(1000) + atan2(x, y)
plot3d(x, y, z, col = rainbow(1000))

I see no plotting at all. Am I missing some important system library or 
whatever? I'm using Linux Mint 23. Thanks!

Thanks,
Jiayue


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri May  5 10:45:54 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 5 May 2023 04:45:54 -0400
Subject: [R] rgl not plotting properly
In-Reply-To: <dedac47f-7bcf-ca27-4df6-1ee7027aa10d@yandex.com>
References: <dedac47f-7bcf-ca27-4df6-1ee7027aa10d@yandex.com>
Message-ID: <e109bad1-6099-0a7f-3026-c573b4e6a103@gmail.com>

On 05/05/2023 2:24 a.m., Jiayue Wang wrote:
> Hi
> 
> I can't get rgl working. I installed rgl, loaded it, but it seems all
> plot3d codes have failed:
> 
> remotes::install_github("dmurdoch/rgl")
> library(rgl)
> open3d()
> x <- sort(rnorm(1000))
> y <- rnorm(1000)
> z <- rnorm(1000) + atan2(x, y)
> plot3d(x, y, z, col = rainbow(1000))
> 
> I see no plotting at all. Am I missing some important system library or
> whatever? I'm using Linux Mint 23. Thanks!
> 

If you install the version from CRAN, do you get the same results?

rgl needs X11 on your system.  Do other programs using it work, e.g. try 
running "glxgears" at the terminal, and try running 
"tcltk::tktoplevel()" in R.

BTW, this list isn't for contributed package support, so if it turns out 
that only rgl is failing, it may be best to move the discussion to 
https://github.com/dmurdoch/rgl/issues .

Duncan Murdoch


From kry|ov@r00t @end|ng |rom gm@||@com  Fri May  5 12:24:36 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 5 May 2023 13:24:36 +0300
Subject: [R] Regex Split?
In-Reply-To: <7b1cdbe7-0086-24b4-9da6-369296eadfdc@syonic.eu>
References: <7b1cdbe7-0086-24b4-9da6-369296eadfdc@syonic.eu>
Message-ID: <20230505132436.3dedf9ba@parabola>

On Thu, 4 May 2023 23:59:33 +0300
Leonard Mada via R-help <r-help at r-project.org> wrote:

> strsplit("a bc,def, adef ,,gh", " |(?=,)|(?<=,)(?![ ])", perl=T)
> # "a"??? "bc"?? ","??? "def"? ","??? ""???? "adef" ","??? "," "gh"
> 
> strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?![ ])", perl=T)
> # "a"??? "bc"?? ","??? "def"? ","??? ""???? "adef" ","??? "," "gh"
> 
> strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?=[^ ])",
> perl=T)
> # "a"??? "bc"?? ","??? "def"? ","??? ""???? "adef" ","??? "," "gh"
> 
> 
> Is this correct?

Perl seems to return the results you expect:

$ perl -E '
 say("$_:\n ", join " ", map qq["$_"], split $_, q[a bc,def, adef ,,gh])
 for (
  qr[ |(?=,)|(?<=,)(?![ ])],
  qr[ |(?<! )(?=,)|(?<=,)(?![ ])],
  qr[ |(?<! )(?=,)|(?<=,)(?=[^ ])]
)'
(?^u: |(?=,)|(?<=,)(?![ ])):
 "a" "bc" "," "def" "," "adef" "," "," "gh"
(?^u: |(?<! )(?=,)|(?<=,)(?![ ])):
 "a" "bc" "," "def" "," "adef" "," "," "gh"
(?^u: |(?<! )(?=,)|(?<=,)(?=[^ ])):
 "a" "bc" "," "def" "," "adef" "," "," "gh"

The same thing happens when I ask R to replace the separators instead
of splitting by them:

sapply(setNames(nm = c(
 " |(?=,)|(?<=,)(?![ ])",
 " |(?<! )(?=,)|(?<=,)(?![ ])",
 " |(?<! )(?=,)|(?<=,)(?=[^ ])")
), gsub, '[]', "a bc,def, adef ,,gh", perl = TRUE)
#               |(?=,)|(?<=,)(?![ ])         |(?<! )(?=,)|(?<=,)(?![ ]) 
# "a[]bc[],[]def[],[]adef[],[],[]gh" "a[]bc[],[]def[],[]adef[],[],[]gh" 
#        |(?<! )(?=,)|(?<=,)(?=[^ ]) 
# "a[]bc[],[]def[],[]adef[],[],[]gh" 

I think that something strange happens when the delimeter pattern
matches more than once in the same place:

gsub(
 '(?=<--)|(?<=-->)', '[]', 'split here --><-- split here',
 perl = TRUE
)
# [1] "split here -->[]<-- split here"

(Both Perl's split() and s///g agree with R's gsub() here, although I
would have accepted "split here -->[][]<-- split here" too.)

On the other hand, the following doesn't look right:

strsplit(
 'split here --><-- split here', '(?=<--)|(?<=-->)',
 perl = TRUE
)
# [[1]]
# [1] "split here -->" "<"              "-- split here"

The "<" is definitely not followed by "<--", and the rightmost "--" is
definitely not preceded by "-->".

Perhaps strsplit() incorrectly advances the match position after one
match?

-- 
Best regards,
Ivan


From @@@h@@w@ng2017 @end|ng |rom y@ndex@com  Fri May  5 12:48:45 2023
From: @@@h@@w@ng2017 @end|ng |rom y@ndex@com (Jiayue Wang)
Date: Fri, 5 May 2023 18:48:45 +0800
Subject: [R] rgl not plotting properly
In-Reply-To: <e109bad1-6099-0a7f-3026-c573b4e6a103@gmail.com>
References: <dedac47f-7bcf-ca27-4df6-1ee7027aa10d@yandex.com>
 <e109bad1-6099-0a7f-3026-c573b4e6a103@gmail.com>
Message-ID: <3da8b46f-9215-411f-4ce4-577ee68a3962@yandex.com>

Thanks Duncan. glxgears works at the terminal; tcltk::tktoplevel() 
outputs the following:

$ID
[1] ".1"

$env
<environment: 0x55b4401d9718>

attr(,"class")
[1] "tkwin"

Jiayue

? 5/5/23 16:45, Duncan Murdoch ??:
> On 05/05/2023 2:24 a.m., Jiayue Wang wrote:
>> Hi
>>
>> I can't get rgl working. I installed rgl, loaded it, but it seems all
>> plot3d codes have failed:
>>
>> remotes::install_github("dmurdoch/rgl")
>> library(rgl)
>> open3d()
>> x <- sort(rnorm(1000))
>> y <- rnorm(1000)
>> z <- rnorm(1000) + atan2(x, y)
>> plot3d(x, y, z, col = rainbow(1000))
>>
>> I see no plotting at all. Am I missing some important system library or
>> whatever? I'm using Linux Mint 23. Thanks!
>>
> 
> If you install the version from CRAN, do you get the same results?
> 
> rgl needs X11 on your system.? Do other programs using it work, e.g. try 
> running "glxgears" at the terminal, and try running 
> "tcltk::tktoplevel()" in R.
> 
> BTW, this list isn't for contributed package support, so if it turns out 
> that only rgl is failing, it may be best to move the discussion to 
> https://github.com/dmurdoch/rgl/issues .
> 
> Duncan Murdoch


From t|m@how@rd @end|ng |rom dec@ny@gov  Fri May  5 12:50:37 2023
From: t|m@how@rd @end|ng |rom dec@ny@gov (Howard, Tim G (DEC))
Date: Fri, 5 May 2023 10:50:37 +0000
Subject: [R] Regex Split?
In-Reply-To: <mailman.369326.1.1683280801.26089.r-help@r-project.org>
References: <mailman.369326.1.1683280801.26089.r-help@r-project.org>
Message-ID: <SA1PR09MB7792A61E1F6BC945EC89537FA8729@SA1PR09MB7792.namprd09.prod.outlook.com>

If you only want the character strings, this seems a little simpler:

> strsplit("a bc,def, adef ,,gh", "[ ,]+", perl=T)
[[1]]
[1] "a"    "bc"   "def"  "adef" "gh"  


If you need delimeters (the commas) you could then add them back in again afterwards. 
Tim

------------------------------

Message: 2
Date: Thu, 4 May 2023 23:59:33 +0300
From: Leonard Mada <leo.mada at syonic.eu>
To: R-help Mailing List <r-help at r-project.org>
Subject: [R] Regex Split?
Message-ID: <7b1cdbe7-0086-24b4-9da6-369296eadfdc at syonic.eu>
Content-Type: text/plain; charset="utf-8"; Format="flowed"

Dear R-Users,

I tried the following 3 Regex expressions in R 4.3:
strsplit("a bc,def, adef ,,gh", " |(?=,)|(?<=,)(?![ ])", perl=T)
# "a"??? "bc"?? ","??? "def"? ","??? ""???? "adef" ","??? "," "gh"

strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?![ ])", perl=T)
# "a"??? "bc"?? ","??? "def"? ","??? ""???? "adef" ","??? "," "gh"

strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?=[^ ])", perl=T)
# "a"??? "bc"?? ","??? "def"? ","??? ""???? "adef" ","??? "," "gh"


Is this correct?


I feel that:
- none should return (after "def"): ",", "";
- the first one could also return "", "," (but probably not; not fully
sure about this);


Sincerely,


Leonard




------------------------------



From murdoch@dunc@n @end|ng |rom gm@||@com  Fri May  5 13:15:19 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 5 May 2023 07:15:19 -0400
Subject: [R] rgl not plotting properly
In-Reply-To: <3da8b46f-9215-411f-4ce4-577ee68a3962@yandex.com>
References: <dedac47f-7bcf-ca27-4df6-1ee7027aa10d@yandex.com>
 <e109bad1-6099-0a7f-3026-c573b4e6a103@gmail.com>
 <3da8b46f-9215-411f-4ce4-577ee68a3962@yandex.com>
Message-ID: <37bb448f-5b57-8f2d-2d20-0b8b8a6dbdd3@gmail.com>

On 05/05/2023 6:48 a.m., Jiayue Wang wrote:
> Thanks Duncan. glxgears works at the terminal; tcltk::tktoplevel()
> outputs the following:
> 
> $ID
> [1] ".1"
> 
> $env
> <environment: 0x55b4401d9718>
> 
> attr(,"class")
> [1] "tkwin"
> 
> Jiayue

But no window opens for tcltk::tktoplevel()?  Sounds like R isn't seeing 
your DISPLAY variable.  Does Sys.getenv("DISPLAY") show the same thing 
in R as you see when printing that environment variable (using e.g. 
`echo $DISPLAY`) in the terminal?

Duncan Murdoch

> 
> ? 5/5/23 16:45, Duncan Murdoch ??:
>> On 05/05/2023 2:24 a.m., Jiayue Wang wrote:
>>> Hi
>>>
>>> I can't get rgl working. I installed rgl, loaded it, but it seems all
>>> plot3d codes have failed:
>>>
>>> remotes::install_github("dmurdoch/rgl")
>>> library(rgl)
>>> open3d()
>>> x <- sort(rnorm(1000))
>>> y <- rnorm(1000)
>>> z <- rnorm(1000) + atan2(x, y)
>>> plot3d(x, y, z, col = rainbow(1000))
>>>
>>> I see no plotting at all. Am I missing some important system library or
>>> whatever? I'm using Linux Mint 23. Thanks!
>>>
>>
>> If you install the version from CRAN, do you get the same results?
>>
>> rgl needs X11 on your system.? Do other programs using it work, e.g. try
>> running "glxgears" at the terminal, and try running
>> "tcltk::tktoplevel()" in R.
>>
>> BTW, this list isn't for contributed package support, so if it turns out
>> that only rgl is failing, it may be best to move the discussion to
>> https://github.com/dmurdoch/rgl/issues .
>>
>> Duncan Murdoch


From @@@h@@w@ng2017 @end|ng |rom y@ndex@com  Fri May  5 13:41:58 2023
From: @@@h@@w@ng2017 @end|ng |rom y@ndex@com (Jiayue Wang)
Date: Fri, 5 May 2023 19:41:58 +0800
Subject: [R] rgl not plotting properly
In-Reply-To: <37bb448f-5b57-8f2d-2d20-0b8b8a6dbdd3@gmail.com>
References: <dedac47f-7bcf-ca27-4df6-1ee7027aa10d@yandex.com>
 <e109bad1-6099-0a7f-3026-c573b4e6a103@gmail.com>
 <3da8b46f-9215-411f-4ce4-577ee68a3962@yandex.com>
 <37bb448f-5b57-8f2d-2d20-0b8b8a6dbdd3@gmail.com>
Message-ID: <de70de12-6bf3-f064-3f7b-0d63dee6456d@yandex.com>



? 5/5/23 19:15, Duncan Murdoch ??:
> On 05/05/2023 6:48 a.m., Jiayue Wang wrote:
>> Thanks Duncan. glxgears works at the terminal; tcltk::tktoplevel()
>> outputs the following:
>>
>> $ID
>> [1] ".1"
>>
>> $env
>> <environment: 0x55b4401d9718>
>>
>> attr(,"class")
>> [1] "tkwin"
>>
>> Jiayue
> 
> But no window opens for tcltk::tktoplevel()?? Sounds like R isn't seeing 
> your DISPLAY variable.? Does Sys.getenv("DISPLAY") show the same thing 
> in R as you see when printing that environment variable (using e.g. 
> `echo $DISPLAY`) in the terminal?

Oh yes, a window did open for tcltk::tktoplevel(), I forgot to mention 
it, sorry.
With Sys.getenv("DISPLAY"), I got

[1] ":0"

Jiayue

> Duncan Murdoch
> 
>>
>> ? 5/5/23 16:45, Duncan Murdoch ??:
>>> On 05/05/2023 2:24 a.m., Jiayue Wang wrote:
>>>> Hi
>>>>
>>>> I can't get rgl working. I installed rgl, loaded it, but it seems all
>>>> plot3d codes have failed:
>>>>
>>>> remotes::install_github("dmurdoch/rgl")
>>>> library(rgl)
>>>> open3d()
>>>> x <- sort(rnorm(1000))
>>>> y <- rnorm(1000)
>>>> z <- rnorm(1000) + atan2(x, y)
>>>> plot3d(x, y, z, col = rainbow(1000))
>>>>
>>>> I see no plotting at all. Am I missing some important system library or
>>>> whatever? I'm using Linux Mint 23. Thanks!
>>>>
>>>
>>> If you install the version from CRAN, do you get the same results?
>>>
>>> rgl needs X11 on your system.? Do other programs using it work, e.g. try
>>> running "glxgears" at the terminal, and try running
>>> "tcltk::tktoplevel()" in R.
>>>
>>> BTW, this list isn't for contributed package support, so if it turns out
>>> that only rgl is failing, it may be best to move the discussion to
>>> https://github.com/dmurdoch/rgl/issues .
>>>
>>> Duncan Murdoch
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri May  5 15:08:55 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 5 May 2023 09:08:55 -0400
Subject: [R] rgl not plotting properly
In-Reply-To: <de70de12-6bf3-f064-3f7b-0d63dee6456d@yandex.com>
References: <dedac47f-7bcf-ca27-4df6-1ee7027aa10d@yandex.com>
 <e109bad1-6099-0a7f-3026-c573b4e6a103@gmail.com>
 <3da8b46f-9215-411f-4ce4-577ee68a3962@yandex.com>
 <37bb448f-5b57-8f2d-2d20-0b8b8a6dbdd3@gmail.com>
 <de70de12-6bf3-f064-3f7b-0d63dee6456d@yandex.com>
Message-ID: <14ea542e-7516-66e6-b31a-940b8223421f@gmail.com>

On 05/05/2023 7:41 a.m., Jiayue Wang wrote:
> 
> 
> ? 5/5/23 19:15, Duncan Murdoch ??:
>> On 05/05/2023 6:48 a.m., Jiayue Wang wrote:
>>> Thanks Duncan. glxgears works at the terminal; tcltk::tktoplevel()
>>> outputs the following:
>>>
>>> $ID
>>> [1] ".1"
>>>
>>> $env
>>> <environment: 0x55b4401d9718>
>>>
>>> attr(,"class")
>>> [1] "tkwin"
>>>
>>> Jiayue
>>
>> But no window opens for tcltk::tktoplevel()?? Sounds like R isn't seeing
>> your DISPLAY variable.? Does Sys.getenv("DISPLAY") show the same thing
>> in R as you see when printing that environment variable (using e.g.
>> `echo $DISPLAY`) in the terminal?
> 
> Oh yes, a window did open for tcltk::tktoplevel(), I forgot to mention
> it, sorry.
> With Sys.getenv("DISPLAY"), I got
> 
> [1] ":0"

In that case, it sounds like it's purely an rgl issue, but I don't 
really have anything else to suggest about how to fix it.  There is a 
workaround:  Run the `rglwidget()` function whenever you want to see a 
plot, and it should open in your browser.

Duncan Murdoch


From @@@h@@w@ng2017 @end|ng |rom y@ndex@com  Fri May  5 15:27:03 2023
From: @@@h@@w@ng2017 @end|ng |rom y@ndex@com (Jiayue Wang)
Date: Fri, 5 May 2023 21:27:03 +0800
Subject: [R] rgl not plotting properly
In-Reply-To: <14ea542e-7516-66e6-b31a-940b8223421f@gmail.com>
References: <dedac47f-7bcf-ca27-4df6-1ee7027aa10d@yandex.com>
 <e109bad1-6099-0a7f-3026-c573b4e6a103@gmail.com>
 <3da8b46f-9215-411f-4ce4-577ee68a3962@yandex.com>
 <37bb448f-5b57-8f2d-2d20-0b8b8a6dbdd3@gmail.com>
 <de70de12-6bf3-f064-3f7b-0d63dee6456d@yandex.com>
 <14ea542e-7516-66e6-b31a-940b8223421f@gmail.com>
Message-ID: <aa8530dd-aef0-feb9-5a44-e888e74b6fae@yandex.com>



? 5/5/23 21:08, Duncan Murdoch ??:
> On 05/05/2023 7:41 a.m., Jiayue Wang wrote:
>>
>>
>> ? 5/5/23 19:15, Duncan Murdoch ??:
>>> On 05/05/2023 6:48 a.m., Jiayue Wang wrote:
>>>> Thanks Duncan. glxgears works at the terminal; tcltk::tktoplevel()
>>>> outputs the following:
>>>>
>>>> $ID
>>>> [1] ".1"
>>>>
>>>> $env
>>>> <environment: 0x55b4401d9718>
>>>>
>>>> attr(,"class")
>>>> [1] "tkwin"
>>>>
>>>> Jiayue
>>>
>>> But no window opens for tcltk::tktoplevel()?? Sounds like R isn't seeing
>>> your DISPLAY variable.? Does Sys.getenv("DISPLAY") show the same thing
>>> in R as you see when printing that environment variable (using e.g.
>>> `echo $DISPLAY`) in the terminal?
>>
>> Oh yes, a window did open for tcltk::tktoplevel(), I forgot to mention
>> it, sorry.
>> With Sys.getenv("DISPLAY"), I got
>>
>> [1] ":0"
> 
> In that case, it sounds like it's purely an rgl issue, but I don't 
> really have anything else to suggest about how to fix it.? There is a 
> workaround:? Run the `rglwidget()` function whenever you want to see a 
> plot, and it should open in your browser.
> 

Thanks all the same, Duncan!

Jiayue


From w||||@mwdun|@p @end|ng |rom gm@||@com  Fri May  5 17:19:21 2023
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Fri, 5 May 2023 08:19:21 -0700
Subject: [R] Regex Split?
In-Reply-To: <20230505132436.3dedf9ba@parabola>
References: <7b1cdbe7-0086-24b4-9da6-369296eadfdc@syonic.eu>
 <20230505132436.3dedf9ba@parabola>
Message-ID: <CAHqSRuQGLRCF+yGNJ_WqK+jcx1JPmAA-Hf3yJNYALqdHAEi=+g@mail.gmail.com>

https://bugs.r-project.org/show_bug.cgi?id=16745 (from 2016, still labelled
'UNCONFIRMED") contains some other examples of strsplit misbehaving when
using 0-length perl look-behinds.  E.g.,

> strsplit(split="[[:<:]]", "One, two; three!", perl=TRUE)[[1]]
 [1] "O"  "n"  "e"  ", " "t"  "w"  "o"  "; " "t"  "h"  "r"  "e"  "e"  "!"
> gsub(pattern="[[:<:]]", "#", "One, two; three!", perl=TRUE)
[1] "#One, #two; #three!"

The bug report includes the comment

It may be possible that strsplit is not using the startoffset argument
to pcre_exec

  pcre/pcre/doc/html/pcreapi.html
    A non-zero starting offset is useful when searching for another match
    in the same subject by calling pcre_exec() again after a previous
    success. Setting startoffset differs from just passing over a
    shortened string and setting PCRE_NOTBOL in the case of a pattern that
    begins with any kind of lookbehind.

or it could be something else.



On Fri, May 5, 2023 at 3:25?AM Ivan Krylov <krylov.r00t at gmail.com> wrote:

> On Thu, 4 May 2023 23:59:33 +0300
> Leonard Mada via R-help <r-help at r-project.org> wrote:
>
> > strsplit("a bc,def, adef ,,gh", " |(?=,)|(?<=,)(?![ ])", perl=T)
> > # "a"    "bc"   ","    "def"  ","    ""     "adef" ","    "," "gh"
> >
> > strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?![ ])", perl=T)
> > # "a"    "bc"   ","    "def"  ","    ""     "adef" ","    "," "gh"
> >
> > strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?=[^ ])",
> > perl=T)
> > # "a"    "bc"   ","    "def"  ","    ""     "adef" ","    "," "gh"
> >
> >
> > Is this correct?
>
> Perl seems to return the results you expect:
>
> $ perl -E '
>  say("$_:\n ", join " ", map qq["$_"], split $_, q[a bc,def, adef ,,gh])
>  for (
>   qr[ |(?=,)|(?<=,)(?![ ])],
>   qr[ |(?<! )(?=,)|(?<=,)(?![ ])],
>   qr[ |(?<! )(?=,)|(?<=,)(?=[^ ])]
> )'
> (?^u: |(?=,)|(?<=,)(?![ ])):
>  "a" "bc" "," "def" "," "adef" "," "," "gh"
> (?^u: |(?<! )(?=,)|(?<=,)(?![ ])):
>  "a" "bc" "," "def" "," "adef" "," "," "gh"
> (?^u: |(?<! )(?=,)|(?<=,)(?=[^ ])):
>  "a" "bc" "," "def" "," "adef" "," "," "gh"
>
> The same thing happens when I ask R to replace the separators instead
> of splitting by them:
>
> sapply(setNames(nm = c(
>  " |(?=,)|(?<=,)(?![ ])",
>  " |(?<! )(?=,)|(?<=,)(?![ ])",
>  " |(?<! )(?=,)|(?<=,)(?=[^ ])")
> ), gsub, '[]', "a bc,def, adef ,,gh", perl = TRUE)
> #               |(?=,)|(?<=,)(?![ ])         |(?<! )(?=,)|(?<=,)(?![ ])
> # "a[]bc[],[]def[],[]adef[],[],[]gh" "a[]bc[],[]def[],[]adef[],[],[]gh"
> #        |(?<! )(?=,)|(?<=,)(?=[^ ])
> # "a[]bc[],[]def[],[]adef[],[],[]gh"
>
> I think that something strange happens when the delimeter pattern
> matches more than once in the same place:
>
> gsub(
>  '(?=<--)|(?<=-->)', '[]', 'split here --><-- split here',
>  perl = TRUE
> )
> # [1] "split here -->[]<-- split here"
>
> (Both Perl's split() and s///g agree with R's gsub() here, although I
> would have accepted "split here -->[][]<-- split here" too.)
>
> On the other hand, the following doesn't look right:
>
> strsplit(
>  'split here --><-- split here', '(?=<--)|(?<=-->)',
>  perl = TRUE
> )
> # [[1]]
> # [1] "split here -->" "<"              "-- split here"
>
> The "<" is definitely not followed by "<--", and the rightmost "--" is
> definitely not preceded by "-->".
>
> Perhaps strsplit() incorrectly advances the match position after one
> match?
>
> --
> Best regards,
> Ivan
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Fri May  5 18:30:33 2023
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Fri, 5 May 2023 18:30:33 +0200
Subject: [R] Regex Split?
In-Reply-To: <CAHqSRuQGLRCF+yGNJ_WqK+jcx1JPmAA-Hf3yJNYALqdHAEi=+g@mail.gmail.com>
References: <7b1cdbe7-0086-24b4-9da6-369296eadfdc@syonic.eu>
 <20230505132436.3dedf9ba@parabola>
 <CAHqSRuQGLRCF+yGNJ_WqK+jcx1JPmAA-Hf3yJNYALqdHAEi=+g@mail.gmail.com>
Message-ID: <25685.12073.69777.205774@stat.math.ethz.ch>

>>>>> Bill Dunlap on Fri, 5 May 2023 08:19:21 -0700 writes:

    https://bugs.r-project.org/show_bug.cgi?id=16745 (from 2016, still labelled
     'UNCONFIRMED") contains some other examples of strsplit misbehaving when
    using 0-length perl look-behinds.  E.g.,

Thank you, Bill -- yes, uhmm, ... a bit embarrassing.

I've finally changed the R bugzilla report's state to "CONFIRMED" now,
and also added the "HELPWANTED" keyword.
I think we (R Core) should be sorry to have (forgotten / not
cared about) the issue completely.

It's not hard to at least agree that the current behavior is buggy,
e.g., in the example you show here :

    >> strsplit(split="[[:<:]]", "One, two; three!", perl=TRUE)[[1]]
    > [1] "O"  "n"  "e"  ", " "t"  "w"  "o"  "; " "t"  "h"  "r"  "e"  "e"  "!"
    >> gsub(pattern="[[:<:]]", "#", "One, two; three!", perl=TRUE)
    > [1] "#One, #two; #three!"

[...]
[...]

Maybe this should be continued either on Bugzilla (i.e., the URL above),
or if needed, additionally  on R-devel.

Yes, I also added that we'd grateful for (tested) patches and/or
code reviewers.

Martin


--
Martin Maechler
ETH Zurich  and  R Core team


From |eo@m@d@ @end|ng |rom @yon|c@eu  Fri May  5 21:25:15 2023
From: |eo@m@d@ @end|ng |rom @yon|c@eu (Leonard Mada)
Date: Fri, 5 May 2023 22:25:15 +0300
Subject: [R] Regex Split?
In-Reply-To: <CAHqSRuQGLRCF+yGNJ_WqK+jcx1JPmAA-Hf3yJNYALqdHAEi=+g@mail.gmail.com>
References: <7b1cdbe7-0086-24b4-9da6-369296eadfdc@syonic.eu>
 <20230505132436.3dedf9ba@parabola>
 <CAHqSRuQGLRCF+yGNJ_WqK+jcx1JPmAA-Hf3yJNYALqdHAEi=+g@mail.gmail.com>
Message-ID: <7dd8f04f-ff99-36e2-22ec-7854c133bc27@syonic.eu>

Dear Bill,


Indeed, there are other cases as well - as documented.


Various Regex sites give the warning to avoid the legacy syntax 
"[[:<:]]", so this is the alternative syntax:
strsplit(split="\\b(?=\\w)", "One, two; three!", perl=TRUE)
# "O"? "n"? "e"? ", " "t"? "w"? "o"? "; " "t"? "h"? "r"? "e"? "e" "!"

gsub("\\b(?=\\w)", "#", "One, two; three!", perl=TRUE)
# "#One, #two; #three!"


Sincerely,


Leonard


On 5/5/2023 6:19 PM, Bill Dunlap wrote:
> https://eu01.z.antigena.com/l/BgIBOxsm88PwDTBiTTrQ784MFk2oGZVOA3RMHiarAZuyoEemKrcnpfJeD8X0FgxRDG33qHZho~NriRCbhv9_Ffr3EOfqn2vpaNUAlCDjQ8nOyVUgPM2iGnHi-qpN54kl1YVO_gHimn0m2ZJ68ntGtysras~0mRMDuAgwbTXsQcQ~ 
> (from 2016, still labelled 'UNCONFIRMED") contains some other examples 
> of strsplit misbehaving?when using 0-length perl look-behinds.? E.g.,
>
> > strsplit(split="[[:<:]]", "One, two; three!", perl=TRUE)[[1]]
> ?[1] "O" ?"n" ?"e" ?", " "t" ?"w" ?"o" ?"; " "t" ?"h" ?"r" ?"e" ?"e" ?"!"
> > gsub(pattern="[[:<:]]", "#", "One, two; three!", perl=TRUE)
> [1] "#One, #two; #three!"
>
> The bug report includes the comment
> It may be possible that strsplit is not using the startoffset argument
> to pcre_exec
>
>    pcre/pcre/doc/html/pcreapi.html
>      A non-zero starting offset is useful when searching for another match
>      in the same subject by calling pcre_exec() again after a previous
>      success. Setting startoffset differs from just passing over a
>      shortened string and setting PCRE_NOTBOL in the case of a pattern that
>      begins with any kind of lookbehind.
>
> or it could be something else.
>
>
> On Fri, May 5, 2023 at 3:25?AM Ivan Krylov <krylov.r00t at gmail.com> wrote:
>
>     On Thu, 4 May 2023 23:59:33 +0300
>     Leonard Mada via R-help <r-help at r-project.org> wrote:
>
>     > strsplit("a bc,def, adef ,,gh", " |(?=,)|(?<=,)(?![ ])", perl=T)
>     > # "a"??? "bc"?? ","??? "def"? ","??? ""???? "adef" "," "," "gh"
>     >
>     > strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?![ ])",
>     perl=T)
>     > # "a"??? "bc"?? ","??? "def"? ","??? ""???? "adef" "," "," "gh"
>     >
>     > strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?=[^ ])",
>     > perl=T)
>     > # "a"??? "bc"?? ","??? "def"? ","??? ""???? "adef" "," "," "gh"
>     >
>     >
>     > Is this correct?
>
>     Perl seems to return the results you expect:
>
>     $ perl -E '
>     ?say("$_:\n ", join " ", map qq["$_"], split $_, q[a bc,def, adef
>     ,,gh])
>     ?for (
>     ? qr[ |(?=,)|(?<=,)(?![ ])],
>     ? qr[ |(?<! )(?=,)|(?<=,)(?![ ])],
>     ? qr[ |(?<! )(?=,)|(?<=,)(?=[^ ])]
>     )'
>     (?^u: |(?=,)|(?<=,)(?![ ])):
>     ?"a" "bc" "," "def" "," "adef" "," "," "gh"
>     (?^u: |(?<! )(?=,)|(?<=,)(?![ ])):
>     ?"a" "bc" "," "def" "," "adef" "," "," "gh"
>     (?^u: |(?<! )(?=,)|(?<=,)(?=[^ ])):
>     ?"a" "bc" "," "def" "," "adef" "," "," "gh"
>
>     The same thing happens when I ask R to replace the separators instead
>     of splitting by them:
>
>     sapply(setNames(nm = c(
>     ?" |(?=,)|(?<=,)(?![ ])",
>     ?" |(?<! )(?=,)|(?<=,)(?![ ])",
>     ?" |(?<! )(?=,)|(?<=,)(?=[^ ])")
>     ), gsub, '[]', "a bc,def, adef ,,gh", perl = TRUE)
>     #? ? ? ? ? ? ? ?|(?=,)|(?<=,)(?![ ])? ? ? ? ?|(?<!
>     )(?=,)|(?<=,)(?![ ])
>     # "a[]bc[],[]def[],[]adef[],[],[]gh"
>     "a[]bc[],[]def[],[]adef[],[],[]gh"
>     #? ? ? ? |(?<! )(?=,)|(?<=,)(?=[^ ])
>     # "a[]bc[],[]def[],[]adef[],[],[]gh"
>
>     I think that something strange happens when the delimeter pattern
>     matches more than once in the same place:
>
>     gsub(
>     ?'(?=<--)|(?<=-->)', '[]', 'split here --><-- split here',
>     ?perl = TRUE
>     )
>     # [1] "split here -->[]<-- split here"
>
>     (Both Perl's split() and s///g agree with R's gsub() here, although I
>     would have accepted "split here -->[][]<-- split here" too.)
>
>     On the other hand, the following doesn't look right:
>
>     strsplit(
>     ?'split here --><-- split here', '(?=<--)|(?<=-->)',
>     ?perl = TRUE
>     )
>     # [[1]]
>     # [1] "split here -->" "<"? ? ? ? ? ? ? "-- split here"
>
>     The "<" is definitely not followed by "<--", and the rightmost "--" is
>     definitely not preceded by "-->".
>
>     Perhaps strsplit() incorrectly advances the match position after one
>     match?
>
>     -- 
>     Best regards,
>     Ivan
>
>     ______________________________________________
>     R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>     https://eu01.z.antigena.com/l/WZma5cGVT7M3Pi1uuAoPo_edV2O7qj81C7uavPIJ3LEMXNUs9d2H6DCGBB12hJA-6tmSLDAJFSwSMeHfx9~UdkUSOMRYZx7tgL1P4G1w4VXdaEBqiHCYYXMGh59CijZYZiIc53dOO~~YTK7T17MIVg-A4Mj5av2VVOt4XNt
>
>     PLEASE do read the posting guide
>     https://eu01.z.antigena.com/l/boS91wizs77ZHW7jjYQJGhwKWDd7jhs-Bz84RKSuLO6Wr42WQEw~jCTfuUJGa_hsJ~G48rDp4Yd3YqBk~W12~24~eoBAwV8FTFmlNLCyjnyym8S-Ebcq0yz2IaH5TEYHyBIe7Z52GHo7s2sQIpyl93Js_4_UaWCcc2uXHZs1
>
>     and provide commented, minimal, self-contained, reproducible code.
>
	[[alternative HTML version deleted]]


From @vi@e@gross m@iii@g oii gm@ii@com  Fri May  5 22:20:45 2023
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Fri, 5 May 2023 16:20:45 -0400
Subject: [R] Regex Split?
In-Reply-To: <7b1cdbe7-0086-24b4-9da6-369296eadfdc@syonic.eu>
References: <7b1cdbe7-0086-24b4-9da6-369296eadfdc@syonic.eu>
Message-ID: <007901d97f8f$12c68030$38538090$@gmail.com>

Leonard,

It can be helpful to spell out your intent in English or some of us have to go back to the documentation to remember what some of the operators do.

Your text being searched seems to be an example of items between comas with an optional space after some commas and in one case, nothing between commas.

So what is your goal for the example, and in general? You mention a bit unclearly at the end some of what you expect and I think it would be clearer if you also showed exactly the output you would want.

I saw some other replies that addressed what you wanted and am going to reply in another direction.

Why do things the hard way using things like lookahead or look behind? Would several steps get you the result way more clearly?

For the sake of argument, you either want what reading in a CSV file would supply, or something else. Since you are not simply splitting on commas, it sounds like something else. But what exactly else? Something as simple as this on just a comma produces results including empty strings and embedded leading or trailing spaces:

strsplit("a bc,def, adef ,,gh", ",")
[[1]]
[1] "a bc"   "def"    " adef " ""       "gh"  

That can of course be handled by, for example, trimming the result after unlisting the odd way strsplit returns results:

library("stringr") 
str_squish(unlist(strsplit("a bc,def, adef ,,gh", ",")))

[1] "a bc" "def"  "adef" ""     "gh"  

Now do you want the empty string to be something else, such as an NA? That can be done too with another step.

And a completely different variant can be used to read in your one-line CSV as text using standard overkill tools:

> read.table(text="a bc,def, adef ,,gh", sep=",")
    V1  V2     V3 V4 V5
1 a bc def  adef  NA gh

The above is a vector of texts. But if you simply want to reassemble your initial string cleaned up a bit, you can use paste to put back commas, as in a variation of the earlier example:

> paste(str_squish(unlist(strsplit("a bc,def, adef ,,gh", ","))), collapse=",")
[1] "a bc,def,adef,,gh"

So my question is whether using advanced methods is really necessary for your case, or even particularly efficient. If efficiency matters, often, it is better to use tools without regular expressions such as paste0() when they meet your needs.

Of course, unless I know what you are actually trying to do, my remarks may be not useful. 



-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Leonard Mada via R-help
Sent: Thursday, May 4, 2023 5:00 PM
To: R-help Mailing List <r-help at r-project.org>
Subject: [R] Regex Split?

Dear R-Users,

I tried the following 3 Regex expressions in R 4.3:
strsplit("a bc,def, adef ,,gh", " |(?=,)|(?<=,)(?![ ])", perl=T)
# "a"    "bc"   ","    "def"  ","    ""     "adef" ","    "," "gh"

strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?![ ])", perl=T)
# "a"    "bc"   ","    "def"  ","    ""     "adef" ","    "," "gh"

strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?=[^ ])", perl=T)
# "a"    "bc"   ","    "def"  ","    ""     "adef" ","    "," "gh"


Is this correct?


I feel that:
- none should return (after "def"): ",", "";
- the first one could also return "", "," (but probably not; not fully 
sure about this);


Sincerely,


Leonard

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From |eo@m@d@ @end|ng |rom @yon|c@eu  Fri May  5 23:53:58 2023
From: |eo@m@d@ @end|ng |rom @yon|c@eu (Leonard Mada)
Date: Sat, 6 May 2023 00:53:58 +0300
Subject: [R] Regex Split?
In-Reply-To: <007901d97f8f$12c68030$38538090$@gmail.com>
References: <7b1cdbe7-0086-24b4-9da6-369296eadfdc@syonic.eu>
 <007901d97f8f$12c68030$38538090$@gmail.com>
Message-ID: <1bf9e2a6-db5f-a3ca-0bc4-70d31bb9778c@syonic.eu>

Dear Avi,

Punctuation marks are used in various NLP language models. Preserving 
the "," is therefore useful in such scenarios and Regex are useful to 
accomplish this (especially if you have sufficient experience with such 
expressions).

I observed only an odd behaviour using strsplit: the example string is 
constructed; but it is always wise to test a Regex expression against 
various scenarios. It is usually hard to predict what special cases will 
occur in a specific corpus.

strsplit("a bc,def, adef ,,gh", " |(?=,)|(?<=,)(?![ ])", perl=T)
# "a"? "bc"? ","? "def"? ","? ""? "adef"? ","? ","? "gh"

stringi::stri_split("a bc,def, adef ,,gh", regex=" |(?=,)|(?<=,)(?![ ])")
# "a"??? "bc"?? ","??? "def"? ","??? "adef"? ""???? ","??? "," "gh"

stringi::stri_split("a bc,def, adef ,,gh", regex=" |(?<! 
)(?=,)|(?<=,)(?![ ])")
# "a"??? "bc"?? ","??? "def"? ","??? "adef"? ","??? ","??? "gh"

# Expected:
# "a"? "bc" ? ","? "def" ? ","? "adef"? "," ? ","? "gh"
# see 2nd instance of stringi::stri_split


Sincerely,


Leonard


On 5/5/2023 11:20 PM, avi.e.gross at gmail.com wrote:
> Leonard,
>
> It can be helpful to spell out your intent in English or some of us have to go back to the documentation to remember what some of the operators do.
>
> Your text being searched seems to be an example of items between comas with an optional space after some commas and in one case, nothing between commas.
>
> So what is your goal for the example, and in general? You mention a bit unclearly at the end some of what you expect and I think it would be clearer if you also showed exactly the output you would want.
>
> I saw some other replies that addressed what you wanted and am going to reply in another direction.
>
> Why do things the hard way using things like lookahead or look behind? Would several steps get you the result way more clearly?
>
> For the sake of argument, you either want what reading in a CSV file would supply, or something else. Since you are not simply splitting on commas, it sounds like something else. But what exactly else? Something as simple as this on just a comma produces results including empty strings and embedded leading or trailing spaces:
>
> strsplit("a bc,def, adef ,,gh", ",")
> [[1]]
> [1] "a bc"   "def"    " adef " ""       "gh"
>
> That can of course be handled by, for example, trimming the result after unlisting the odd way strsplit returns results:
>
> library("stringr")
> str_squish(unlist(strsplit("a bc,def, adef ,,gh", ",")))
>
> [1] "a bc" "def"  "adef" ""     "gh"
>
> Now do you want the empty string to be something else, such as an NA? That can be done too with another step.
>
> And a completely different variant can be used to read in your one-line CSV as text using standard overkill tools:
>
>> read.table(text="a bc,def, adef ,,gh", sep=",")
>      V1  V2     V3 V4 V5
> 1 a bc def  adef  NA gh
>
> The above is a vector of texts. But if you simply want to reassemble your initial string cleaned up a bit, you can use paste to put back commas, as in a variation of the earlier example:
>
>> paste(str_squish(unlist(strsplit("a bc,def, adef ,,gh", ","))), collapse=",")
> [1] "a bc,def,adef,,gh"
>
> So my question is whether using advanced methods is really necessary for your case, or even particularly efficient. If efficiency matters, often, it is better to use tools without regular expressions such as paste0() when they meet your needs.
>
> Of course, unless I know what you are actually trying to do, my remarks may be not useful.
>
>
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Leonard Mada via R-help
> Sent: Thursday, May 4, 2023 5:00 PM
> To: R-help Mailing List <r-help at r-project.org>
> Subject: [R] Regex Split?
>
> Dear R-Users,
>
> I tried the following 3 Regex expressions in R 4.3:
> strsplit("a bc,def, adef ,,gh", " |(?=,)|(?<=,)(?![ ])", perl=T)
> # "a"    "bc"   ","    "def"  ","    ""     "adef" ","    "," "gh"
>
> strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?![ ])", perl=T)
> # "a"    "bc"   ","    "def"  ","    ""     "adef" ","    "," "gh"
>
> strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?=[^ ])", perl=T)
> # "a"    "bc"   ","    "def"  ","    ""     "adef" ","    "," "gh"
>
>
> Is this correct?
>
>
> I feel that:
> - none should return (after "def"): ",", "";
> - the first one could also return "", "," (but probably not; not fully
> sure about this);
>
>
> Sincerely,
>
>
> Leonard
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://eu01.z.antigena.com/l/boS91wizs77ZHrpn6fDgE-TZu7JxUnjyNg_9mZDUsLWLylcL-dhQytfeUHheLHZnKJw-VwwfCd_W4XdAukyKenqYPFzSJmP5FrWmF_wepejCrBByUVa66jUF7wKGiA8LnqB49ZUVq-urjKs272Rl-mj-SE1q7--Xj1UXRol3
> PLEASE do read the posting guide https://eu01.z.antigena.com/l/rUS82cEKjOa3tTqQ7yTAXLpuOWG1NttoMdEKDQkk3EZhrLW63rsvJ77vuFxoc44Nwo7BGuQyBzF3bNlYLccamhXBk0shpe_1ZhOeonqIbTm59I58PKOPwwqUt6gLF2fLg3OmstDk7ueraKARO4qpUToOguMdYKyE2_LZnBk7QR
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Sat May  6 00:35:24 2023
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 5 May 2023 15:35:24 -0700
Subject: [R] Regex Split?
In-Reply-To: <1bf9e2a6-db5f-a3ca-0bc4-70d31bb9778c@syonic.eu>
References: <7b1cdbe7-0086-24b4-9da6-369296eadfdc@syonic.eu>
 <007901d97f8f$12c68030$38538090$@gmail.com>
 <1bf9e2a6-db5f-a3ca-0bc4-70d31bb9778c@syonic.eu>
Message-ID: <CAGxFJbTaspRSnfUEM_Pe3JezmzZF1OE3oj8Pgvd1LKMzpyhDiw@mail.gmail.com>

Primarily for my own amusement, here is a way to do what I think you wanted
without look-aheads/behinds

strsplit(gsub("([[:punct:]])"," \\1 ","a bc,def, adef,x; ,,gh"), " +")
[[1]]
 [1] "a"    "bc"   ","    "def"  ","    "adef" ","    "x"    ";"
[10] ","    ","    "gh"

I certainly would *not* claim that it is in any way superior to anything
that has already been suggested -- indeed, probably the contrary. But it's
simple (as am I).

Cheers,
Bert

On Fri, May 5, 2023 at 2:54?PM Leonard Mada via R-help <r-help at r-project.org>
wrote:

> Dear Avi,
>
> Punctuation marks are used in various NLP language models. Preserving
> the "," is therefore useful in such scenarios and Regex are useful to
> accomplish this (especially if you have sufficient experience with such
> expressions).
>
> I observed only an odd behaviour using strsplit: the example string is
> constructed; but it is always wise to test a Regex expression against
> various scenarios. It is usually hard to predict what special cases will
> occur in a specific corpus.
>
> strsplit("a bc,def, adef ,,gh", " |(?=,)|(?<=,)(?![ ])", perl=T)
> # "a"  "bc"  ","  "def"  ","  ""  "adef"  ","  ","  "gh"
>
> stringi::stri_split("a bc,def, adef ,,gh", regex=" |(?=,)|(?<=,)(?![ ])")
> # "a"    "bc"   ","    "def"  ","    "adef"  ""     ","    "," "gh"
>
> stringi::stri_split("a bc,def, adef ,,gh", regex=" |(?<!
> )(?=,)|(?<=,)(?![ ])")
> # "a"    "bc"   ","    "def"  ","    "adef"  ","    ","    "gh"
>
> # Expected:
> # "a"  "bc"   ","  "def"   ","  "adef"  ","   ","  "gh"
> # see 2nd instance of stringi::stri_split
>
>
> Sincerely,
>
>
> Leonard
>
>
> On 5/5/2023 11:20 PM, avi.e.gross at gmail.com wrote:
> > Leonard,
> >
> > It can be helpful to spell out your intent in English or some of us have
> to go back to the documentation to remember what some of the operators do.
> >
> > Your text being searched seems to be an example of items between comas
> with an optional space after some commas and in one case, nothing between
> commas.
> >
> > So what is your goal for the example, and in general? You mention a bit
> unclearly at the end some of what you expect and I think it would be
> clearer if you also showed exactly the output you would want.
> >
> > I saw some other replies that addressed what you wanted and am going to
> reply in another direction.
> >
> > Why do things the hard way using things like lookahead or look behind?
> Would several steps get you the result way more clearly?
> >
> > For the sake of argument, you either want what reading in a CSV file
> would supply, or something else. Since you are not simply splitting on
> commas, it sounds like something else. But what exactly else? Something as
> simple as this on just a comma produces results including empty strings and
> embedded leading or trailing spaces:
> >
> > strsplit("a bc,def, adef ,,gh", ",")
> > [[1]]
> > [1] "a bc"   "def"    " adef " ""       "gh"
> >
> > That can of course be handled by, for example, trimming the result after
> unlisting the odd way strsplit returns results:
> >
> > library("stringr")
> > str_squish(unlist(strsplit("a bc,def, adef ,,gh", ",")))
> >
> > [1] "a bc" "def"  "adef" ""     "gh"
> >
> > Now do you want the empty string to be something else, such as an NA?
> That can be done too with another step.
> >
> > And a completely different variant can be used to read in your one-line
> CSV as text using standard overkill tools:
> >
> >> read.table(text="a bc,def, adef ,,gh", sep=",")
> >      V1  V2     V3 V4 V5
> > 1 a bc def  adef  NA gh
> >
> > The above is a vector of texts. But if you simply want to reassemble
> your initial string cleaned up a bit, you can use paste to put back commas,
> as in a variation of the earlier example:
> >
> >> paste(str_squish(unlist(strsplit("a bc,def, adef ,,gh", ","))),
> collapse=",")
> > [1] "a bc,def,adef,,gh"
> >
> > So my question is whether using advanced methods is really necessary for
> your case, or even particularly efficient. If efficiency matters, often, it
> is better to use tools without regular expressions such as paste0() when
> they meet your needs.
> >
> > Of course, unless I know what you are actually trying to do, my remarks
> may be not useful.
> >
> >
> >
> > -----Original Message-----
> > From: R-help <r-help-bounces at r-project.org> On Behalf Of Leonard Mada
> via R-help
> > Sent: Thursday, May 4, 2023 5:00 PM
> > To: R-help Mailing List <r-help at r-project.org>
> > Subject: [R] Regex Split?
> >
> > Dear R-Users,
> >
> > I tried the following 3 Regex expressions in R 4.3:
> > strsplit("a bc,def, adef ,,gh", " |(?=,)|(?<=,)(?![ ])", perl=T)
> > # "a"    "bc"   ","    "def"  ","    ""     "adef" ","    "," "gh"
> >
> > strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?![ ])", perl=T)
> > # "a"    "bc"   ","    "def"  ","    ""     "adef" ","    "," "gh"
> >
> > strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?=[^ ])", perl=T)
> > # "a"    "bc"   ","    "def"  ","    ""     "adef" ","    "," "gh"
> >
> >
> > Is this correct?
> >
> >
> > I feel that:
> > - none should return (after "def"): ",", "";
> > - the first one could also return "", "," (but probably not; not fully
> > sure about this);
> >
> >
> > Sincerely,
> >
> >
> > Leonard
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >
> https://eu01.z.antigena.com/l/boS91wizs77ZHrpn6fDgE-TZu7JxUnjyNg_9mZDUsLWLylcL-dhQytfeUHheLHZnKJw-VwwfCd_W4XdAukyKenqYPFzSJmP5FrWmF_wepejCrBByUVa66jUF7wKGiA8LnqB49ZUVq-urjKs272Rl-mj-SE1q7--Xj1UXRol3
> > PLEASE do read the posting guide
> https://eu01.z.antigena.com/l/rUS82cEKjOa3tTqQ7yTAXLpuOWG1NttoMdEKDQkk3EZhrLW63rsvJ77vuFxoc44Nwo7BGuQyBzF3bNlYLccamhXBk0shpe_1ZhOeonqIbTm59I58PKOPwwqUt6gLF2fLg3OmstDk7ueraKARO4qpUToOguMdYKyE2_LZnBk7QR
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From |eo@m@d@ @end|ng |rom @yon|c@eu  Sat May  6 01:05:56 2023
From: |eo@m@d@ @end|ng |rom @yon|c@eu (Leonard Mada)
Date: Sat, 6 May 2023 02:05:56 +0300
Subject: [R] Regex Split?
In-Reply-To: <CAGxFJbTaspRSnfUEM_Pe3JezmzZF1OE3oj8Pgvd1LKMzpyhDiw@mail.gmail.com>
References: <7b1cdbe7-0086-24b4-9da6-369296eadfdc@syonic.eu>
 <007901d97f8f$12c68030$38538090$@gmail.com>
 <1bf9e2a6-db5f-a3ca-0bc4-70d31bb9778c@syonic.eu>
 <CAGxFJbTaspRSnfUEM_Pe3JezmzZF1OE3oj8Pgvd1LKMzpyhDiw@mail.gmail.com>
Message-ID: <0d777887-d9e6-a96a-2261-67a702bd8939@syonic.eu>

Dear Bert,

Thank you for the suggestion. Indeed, there are various solutions and 
workarounds. However, there is still a bug in strsplit.

2.) gsub
I would try to avoid gsub on a Wikipedia-sized corpus: using strsplit 
directly should be far more efficient.

3.) Punctuation marks
Abbreviations and "word1-word2" may be a problem:
gsub("(?<ThePunct>[[:punct:]])", "\\1 ", "A.B.C.", perl=T)
# "A. B. C. "

I do not yet have an intuition if the spaces in "A. B. C. " would 
adversely affect the language model. But this goes off-topic.

Sincerely,

Leonard


On 5/6/2023 1:35 AM, Bert Gunter wrote:
> Primarily for my own amusement, here is a way to do what I think you 
> wanted without look-aheads/behinds
>
> strsplit(gsub("([[:punct:]])"," \\1 ","a bc,def, adef,x; ,,gh"), " +")
> [[1]]
> ?[1] "a" ? ?"bc" ? "," ? ?"def" ?"," ? ?"adef" "," ? ?"x" ?";"
> [10] "," ? ?"," ? ?"gh"
>
> I certainly would *not* claim that it is in any way superior to 
> anything that has already been suggested -- indeed, probably the 
> contrary. But it's simple (as am I).
>
> Cheers,
> Bert
>
> On Fri, May 5, 2023 at 2:54?PM Leonard Mada via R-help 
> <r-help at r-project.org> wrote:
>
>     Dear Avi,
>
>     Punctuation marks are used in various NLP language models. Preserving
>     the "," is therefore useful in such scenarios and Regex are useful to
>     accomplish this (especially if you have sufficient experience with
>     such
>     expressions).
>
>     I observed only an odd behaviour using strsplit: the example
>     string is
>     constructed; but it is always wise to test a Regex expression against
>     various scenarios. It is usually hard to predict what special
>     cases will
>     occur in a specific corpus.
>
>     strsplit("a bc,def, adef ,,gh", " |(?=,)|(?<=,)(?![ ])", perl=T)
>     # "a"? "bc"? ","? "def"? ","? ""? "adef"? ","? ","? "gh"
>
>     stringi::stri_split("a bc,def, adef ,,gh", regex="
>     |(?=,)|(?<=,)(?![ ])")
>     # "a"??? "bc"?? ","??? "def"? ","??? "adef"? ""???? ","??? "," "gh"
>
>     stringi::stri_split("a bc,def, adef ,,gh", regex=" |(?<!
>     )(?=,)|(?<=,)(?![ ])")
>     # "a"??? "bc"?? ","??? "def"? ","??? "adef"? ","??? "," "gh"
>
>     # Expected:
>     # "a"? "bc" ? ","? "def" ? ","? "adef"? "," ? ","? "gh"
>     # see 2nd instance of stringi::stri_split
>
>
>     Sincerely,
>
>
>     Leonard
>
>
>     On 5/5/2023 11:20 PM, avi.e.gross at gmail.com wrote:
>     > Leonard,
>     >
>     > It can be helpful to spell out your intent in English or some of
>     us have to go back to the documentation to remember what some of
>     the operators do.
>     >
>     > Your text being searched seems to be an example of items between
>     comas with an optional space after some commas and in one case,
>     nothing between commas.
>     >
>     > So what is your goal for the example, and in general? You
>     mention a bit unclearly at the end some of what you expect and I
>     think it would be clearer if you also showed exactly the output
>     you would want.
>     >
>     > I saw some other replies that addressed what you wanted and am
>     going to reply in another direction.
>     >
>     > Why do things the hard way using things like lookahead or look
>     behind? Would several steps get you the result way more clearly?
>     >
>     > For the sake of argument, you either want what reading in a CSV
>     file would supply, or something else. Since you are not simply
>     splitting on commas, it sounds like something else. But what
>     exactly else? Something as simple as this on just a comma produces
>     results including empty strings and embedded leading or trailing
>     spaces:
>     >
>     > strsplit("a bc,def, adef ,,gh", ",")
>     > [[1]]
>     > [1] "a bc"? ?"def"? ? " adef " ""? ? ? ?"gh"
>     >
>     > That can of course be handled by, for example, trimming the
>     result after unlisting the odd way strsplit returns results:
>     >
>     > library("stringr")
>     > str_squish(unlist(strsplit("a bc,def, adef ,,gh", ",")))
>     >
>     > [1] "a bc" "def"? "adef" ""? ? ?"gh"
>     >
>     > Now do you want the empty string to be something else, such as
>     an NA? That can be done too with another step.
>     >
>     > And a completely different variant can be used to read in your
>     one-line CSV as text using standard overkill tools:
>     >
>     >> read.table(text="a bc,def, adef ,,gh", sep=",")
>     >? ? ? V1? V2? ? ?V3 V4 V5
>     > 1 a bc def? adef? NA gh
>     >
>     > The above is a vector of texts. But if you simply want to
>     reassemble your initial string cleaned up a bit, you can use paste
>     to put back commas, as in a variation of the earlier example:
>     >
>     >> paste(str_squish(unlist(strsplit("a bc,def, adef ,,gh", ","))),
>     collapse=",")
>     > [1] "a bc,def,adef,,gh"
>     >
>     > So my question is whether using advanced methods is really
>     necessary for your case, or even particularly efficient. If
>     efficiency matters, often, it is better to use tools without
>     regular expressions such as paste0() when they meet your needs.
>     >
>     > Of course, unless I know what you are actually trying to do, my
>     remarks may be not useful.
>     >
>     >
>     >
>     > -----Original Message-----
>     > From: R-help <r-help-bounces at r-project.org> On Behalf Of Leonard
>     Mada via R-help
>     > Sent: Thursday, May 4, 2023 5:00 PM
>     > To: R-help Mailing List <r-help at r-project.org>
>     > Subject: [R] Regex Split?
>     >
>     > Dear R-Users,
>     >
>     > I tried the following 3 Regex expressions in R 4.3:
>     > strsplit("a bc,def, adef ,,gh", " |(?=,)|(?<=,)(?![ ])", perl=T)
>     > # "a"? ? "bc"? ?","? ? "def"? ","? ? ""? ? ?"adef" "," "," "gh"
>     >
>     > strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?![ ])",
>     perl=T)
>     > # "a"? ? "bc"? ?","? ? "def"? ","? ? ""? ? ?"adef" "," "," "gh"
>     >
>     > strsplit("a bc,def, adef ,,gh", " |(?<! )(?=,)|(?<=,)(?=[^ ])",
>     perl=T)
>     > # "a"? ? "bc"? ?","? ? "def"? ","? ? ""? ? ?"adef" "," "," "gh"
>     >
>     >
>     > Is this correct?
>     >
>     >
>     > I feel that:
>     > - none should return (after "def"): ",", "";
>     > - the first one could also return "", "," (but probably not; not
>     fully
>     > sure about this);
>     >
>     >
>     > Sincerely,
>     >
>     >
>     > Leonard
>     >
>     > ______________________________________________
>     > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>     >
>     https://eu01.z.antigena.com/l/boS91wizs77ZHrpn6fDgE-TZu7JxUnjyNg_9mZDUsLWLylcL-dhQytfeUHheLHZnKJw-VwwfCd_W4XdAukyKenqYPFzSJmP5FrWmF_wepejCrBByUVa66jUF7wKGiA8LnqB49ZUVq-urjKs272Rl-mj-SE1q7--Xj1UXRol3
>     > PLEASE do read the posting guide
>     https://eu01.z.antigena.com/l/rUS82cEKjOa3tTqQ7yTAXLpuOWG1NttoMdEKDQkk3EZhrLW63rsvJ77vuFxoc44Nwo7BGuQyBzF3bNlYLccamhXBk0shpe_1ZhOeonqIbTm59I58PKOPwwqUt6gLF2fLg3OmstDk7ueraKARO4qpUToOguMdYKyE2_LZnBk7QR
>     > and provide commented, minimal, self-contained, reproducible code.
>
>     ______________________________________________
>     R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>     https://stat.ethz.ch/mailman/listinfo/r-help
>     PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>     and provide commented, minimal, self-contained, reproducible code.
>
	[[alternative HTML version deleted]]


From bobby@kn|ght @end|ng |rom gm@||@com  Mon May  8 03:40:09 2023
From: bobby@kn|ght @end|ng |rom gm@||@com (Robert Knight)
Date: Sun, 7 May 2023 20:40:09 -0500
Subject: [R] Huge differences in Ram Consumption with different versions of
 R on the same scripts
Message-ID: <CAKBFG3Zr5kgb9cTu45PHU=a4rb78upxZPjpQjGoU+PnSwfZBQg@mail.gmail.com>

Hello R Help,

I have some R vignettes that run fpp2 time series regressions.  I have run
these for a long time using R and a 12 core computer system.  I ran each
core using Linux to run a vignette on that core, so that all 12 could work
concurrently.  With 48GB of ram, the ram never filled up. I ran these
regressions for hours, one data set right after the other on each core.
Recently, I switched to Oracle Linux 8 and R 4.2 Now, with the same
scripts, and the same data, the ram fills up and R reserves 4.2GB per
instance in some cases.  This results in all the ram being consumed and the
swap space on the system activating constantly so that the performance is
abysmal. It begins using 12Gb of swap space in addition to the ram
consumed.  It bogs the system so bad that one can't even establish new
terminal sessions.

Is there a way to specify a maximum ram allowance in an R vignette?  If
that?s not possible, what resources can you recommend to help identify the
reason for the change in memory use?  Why would a different version of
R/Linux use 2GB per instance, while another uses 4.4GB? What kind of
troubleshooting or programming techniques should I research for this kind
of concern?
Robert Knight

	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Mon May  8 12:37:20 2023
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Mon, 8 May 2023 13:37:20 +0300
Subject: [R] 
 Huge differences in Ram Consumption with different versions of
 R on the same scripts
In-Reply-To: <CAKBFG3Zr5kgb9cTu45PHU=a4rb78upxZPjpQjGoU+PnSwfZBQg@mail.gmail.com>
References: <CAKBFG3Zr5kgb9cTu45PHU=a4rb78upxZPjpQjGoU+PnSwfZBQg@mail.gmail.com>
Message-ID: <CAGgJW76+3v5OwWGPkUzipF8dR9=r5XLBLYVeqPyvBbd+4oVOnA@mail.gmail.com>

Assuming the vignettes are the same in both cases, try going back to
the system where it worked and introduce a single change? i.e.
a) previous linux system and R 4.2
b) Previous R version and Oracle Linux 8

Repeat the test for a) and b) and if one works fine and the other
fails at least that will narrow down the search.

HTH,
Eric




On Mon, May 8, 2023 at 4:41?AM Robert Knight <bobby.knight at gmail.com> wrote:
>
> Hello R Help,
>
> I have some R vignettes that run fpp2 time series regressions.  I have run
> these for a long time using R and a 12 core computer system.  I ran each
> core using Linux to run a vignette on that core, so that all 12 could work
> concurrently.  With 48GB of ram, the ram never filled up. I ran these
> regressions for hours, one data set right after the other on each core.
> Recently, I switched to Oracle Linux 8 and R 4.2 Now, with the same
> scripts, and the same data, the ram fills up and R reserves 4.2GB per
> instance in some cases.  This results in all the ram being consumed and the
> swap space on the system activating constantly so that the performance is
> abysmal. It begins using 12Gb of swap space in addition to the ram
> consumed.  It bogs the system so bad that one can't even establish new
> terminal sessions.
>
> Is there a way to specify a maximum ram allowance in an R vignette?  If
> that?s not possible, what resources can you recommend to help identify the
> reason for the change in memory use?  Why would a different version of
> R/Linux use 2GB per instance, while another uses 4.4GB? What kind of
> troubleshooting or programming techniques should I research for this kind
> of concern?
> Robert Knight
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Mon May  8 22:10:25 2023
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Mon, 8 May 2023 20:10:25 +0000 (UTC)
Subject: [R] RandomForest tuning the parameters
References: <176227066.1386345.1683576625666.ref@mail.yahoo.com>
Message-ID: <176227066.1386345.1683576625666@mail.yahoo.com>

Dear R-experts,

Here below a toy example with some error messages, especially at the end of the code (Tuning the parameters). Your help to correct my R code would be highly appreciated.


#######################################
#libraries
library(lattice)
library(ggplot2)
library(caret)
library(randomForest)
??
#Data
y=c(23,34,32,12,24,35,45,56,76,87,54,34,23,45,41,13,16,98,35,65,56,67,78,89,87,64,53,31,14,34,45,46,57,69,90,80,70,65,50,45,60,56,87,79,64,34,25,47,61,24,10,13,12,15,46,58,76,89,90,98)
x1=c(4,5,6,7,1,10,19,20,21,14,23,6,5,32,15,12,16,14,2,3,4,5,3,2,1,2,6,7,5,4,3,2,1,3,4,6,7,9,5,4,3,7,10,11,12,13,10,3,2,5,6,9,8,7,4,12,15,16,2,3)
x2=c(0,0,0,1,1,0,1,1,0,1,1,0,0,1,0,0,0,0,0,1,1,1,1,1,0,0,0,1,0,0,1,0,0,0,1,1,0,1,0,0,0,1,1,1,1,0,1,0,1,0,0,1,1,0,0,1,0,0,1,1)
?
y=as.numeric(y)
x1=as.numeric(x1)
x2=as.factor(x2)
?
X=data.frame(x1,x2)
y=y
?
#Split data into training and test sets
index=createDataPartition(y, p=0.75, list=FALSE)
X_train = X[index, ]
X_test = X[-index, ]
y_train= y[index ]
y_test = y[-index ]
?
#Train de model
regr=randomForest (x=X_train, y=y_train, maxnodes=10, ntree=10)

regr<-randomForest(y~x1+x2, data=X_train, proximity=TRUE)
regr
?
#Make prediction
predictions= predict(regr, X_test)
?
result= X_test
result['y'] = y_test
result['prediction'] = predictions
result
?
# Import library for Metrics
library(Metrics)
?
print(paste0('MAE: ' , mae(y_test,predictions) ))
print(paste0('MSE: ' ,caret::postResample(predictions , y_test)['RMSE']^2 ))
print(paste0('R2: ' ,caret::postResample(predictions , y_test)['Rsquared'] ))

?
#Tuning the parameters
N=500 #length(X_train)
X_train_ = X_train[1:N , ]
y_train_ = y_train[1:N]

seed <-7
metric<-'RMSE'

customRF <- list(type = "Regression", library = "randomForest", loop = NULL)

customRF$parameters <- data.frame(parameter = c("maxnodes", "ntree"), class = rep("numeric", 2), label = c("maxnodes", "ntree"))?

customRF$grid <- function(x, y, len = NULL, search = "grid") {}

customRF$fit <- function(x, y, wts, param, lev, last, weights, classProbs, ...) {

?randomForest(x, y, maxnodes = param$maxnodes, ntree=param$ntree, ...)

}

customRF$predict <- function(modelFit, newdata, preProc = NULL, submodels = NULL)

predict(modelFit, newdata)

customRF$prob <- function(modelFit, newdata, preProc = NULL, submodels = NULL)

? predict(modelFit, newdata, type = "prob")

customRF$sort <- function(x) x[order(x[,1]),]

customRF$levels <- function(x) x$classes

?
# Set grid search parameters
control <- trainControl(method="repeatedcv", number=10, repeats=3, search='grid')
?
# Outline the grid of parameters
tunegrid <- expand.grid(.maxnodes=c(10,20,30,50), .ntree=c(100, 200, 300))
set.seed(seed)
?
# Train the model
rf_gridsearch <- train(x=X_train_, y=y_train_, method=customRF, metric=metric, tuneGrid=tunegrid, trControl=control)
?
plot(rf_gridsearch)

rf_gridsearch$bestTune

#################################################


From er|cjberger @end|ng |rom gm@||@com  Tue May  9 05:40:56 2023
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Tue, 9 May 2023 06:40:56 +0300
Subject: [R] RandomForest tuning the parameters
In-Reply-To: <176227066.1386345.1683576625666@mail.yahoo.com>
References: <176227066.1386345.1683576625666.ref@mail.yahoo.com>
 <176227066.1386345.1683576625666@mail.yahoo.com>
Message-ID: <CAGgJW76ie4u3B=U=jaKuOQ6gNt70uKLUt7b=2ocrGitwTAaWVw@mail.gmail.com>

Hi,
One problem you have is with the command:
regr<-randomForest(y~x1+x2, data=X_train, proximity=TRUE)

What you need is something like this:

X2 <- cbind(X,y)
regr<-randomForest(y~x1+x2, data=X2, proximity=TRUE)

HTH,
Eric


On Mon, May 8, 2023 at 11:11?PM varin sacha via R-help
<r-help at r-project.org> wrote:
>
> Dear R-experts,
>
> Here below a toy example with some error messages, especially at the end of the code (Tuning the parameters). Your help to correct my R code would be highly appreciated.
>
>
> #######################################
> #libraries
> library(lattice)
> library(ggplot2)
> library(caret)
> library(randomForest)
>
> #Data
> y=c(23,34,32,12,24,35,45,56,76,87,54,34,23,45,41,13,16,98,35,65,56,67,78,89,87,64,53,31,14,34,45,46,57,69,90,80,70,65,50,45,60,56,87,79,64,34,25,47,61,24,10,13,12,15,46,58,76,89,90,98)
> x1=c(4,5,6,7,1,10,19,20,21,14,23,6,5,32,15,12,16,14,2,3,4,5,3,2,1,2,6,7,5,4,3,2,1,3,4,6,7,9,5,4,3,7,10,11,12,13,10,3,2,5,6,9,8,7,4,12,15,16,2,3)
> x2=c(0,0,0,1,1,0,1,1,0,1,1,0,0,1,0,0,0,0,0,1,1,1,1,1,0,0,0,1,0,0,1,0,0,0,1,1,0,1,0,0,0,1,1,1,1,0,1,0,1,0,0,1,1,0,0,1,0,0,1,1)
>
> y=as.numeric(y)
> x1=as.numeric(x1)
> x2=as.factor(x2)
>
> X=data.frame(x1,x2)
> y=y
>
> #Split data into training and test sets
> index=createDataPartition(y, p=0.75, list=FALSE)
> X_train = X[index, ]
> X_test = X[-index, ]
> y_train= y[index ]
> y_test = y[-index ]
>
> #Train de model
> regr=randomForest (x=X_train, y=y_train, maxnodes=10, ntree=10)
>
> regr<-randomForest(y~x1+x2, data=X_train, proximity=TRUE)
> regr
>
> #Make prediction
> predictions= predict(regr, X_test)
>
> result= X_test
> result['y'] = y_test
> result['prediction'] = predictions
> result
>
> # Import library for Metrics
> library(Metrics)
>
> print(paste0('MAE: ' , mae(y_test,predictions) ))
> print(paste0('MSE: ' ,caret::postResample(predictions , y_test)['RMSE']^2 ))
> print(paste0('R2: ' ,caret::postResample(predictions , y_test)['Rsquared'] ))
>
>
> #Tuning the parameters
> N=500 #length(X_train)
> X_train_ = X_train[1:N , ]
> y_train_ = y_train[1:N]
>
> seed <-7
> metric<-'RMSE'
>
> customRF <- list(type = "Regression", library = "randomForest", loop = NULL)
>
> customRF$parameters <- data.frame(parameter = c("maxnodes", "ntree"), class = rep("numeric", 2), label = c("maxnodes", "ntree"))
>
> customRF$grid <- function(x, y, len = NULL, search = "grid") {}
>
> customRF$fit <- function(x, y, wts, param, lev, last, weights, classProbs, ...) {
>
>  randomForest(x, y, maxnodes = param$maxnodes, ntree=param$ntree, ...)
>
> }
>
> customRF$predict <- function(modelFit, newdata, preProc = NULL, submodels = NULL)
>
> predict(modelFit, newdata)
>
> customRF$prob <- function(modelFit, newdata, preProc = NULL, submodels = NULL)
>
>   predict(modelFit, newdata, type = "prob")
>
> customRF$sort <- function(x) x[order(x[,1]),]
>
> customRF$levels <- function(x) x$classes
>
>
> # Set grid search parameters
> control <- trainControl(method="repeatedcv", number=10, repeats=3, search='grid')
>
> # Outline the grid of parameters
> tunegrid <- expand.grid(.maxnodes=c(10,20,30,50), .ntree=c(100, 200, 300))
> set.seed(seed)
>
> # Train the model
> rf_gridsearch <- train(x=X_train_, y=y_train_, method=customRF, metric=metric, tuneGrid=tunegrid, trControl=control)
>
> plot(rf_gridsearch)
>
> rf_gridsearch$bestTune
>
> #################################################
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From Georg@K|nderm@nn @end|ng |rom gmx@@t  Mon May  8 12:52:59 2023
From: Georg@K|nderm@nn @end|ng |rom gmx@@t (Georg Kindermann)
Date: Mon, 8 May 2023 12:52:59 +0200
Subject: [R] data.frame with a column containing an array
Message-ID: <trinity-2eda1037-de24-4b26-849a-41f0a1104f03-1683543179774@3c-app-gmx-bap03>

Dear list members,

when I create a data.frame containing an array I had expected, that I get a similar result, when subsetting it, like having a matrix in a data.frame. But instead I get only the first element and not all values of the remaining dimensions. Differences are already when creating the data.frame, where I can use `I` in case of a matrix but for an array I am only able to insert it in a second step.

DFA <- data.frame(id = 1:2)
DFA[["ar"]] <- array(1:8, c(2,2,2))

DFA[1,]
#  id ar
#1  1  1

DFM <- data.frame(id = 1:2, M = I(matrix(1:4, 2)))

DFM[1,]
#  id M.1 M.2
#1  1   1   3

The same when trying to use merge, where only the first value is kept.

merge(DFA, data.frame(id = 1))
#  id ar
#1  1  1

merge(DFM, data.frame(id = 1))
#  id M.1 M.2
#1  1   1   3

Is there a way to use an array in a data.frame like I can use a matrix in a data.frame?

I am using R version 4.3.0.

Kind regards,
Georg


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Tue May  9 09:32:56 2023
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Tue, 9 May 2023 08:32:56 +0100
Subject: [R] data.frame with a column containing an array
In-Reply-To: <trinity-2eda1037-de24-4b26-849a-41f0a1104f03-1683543179774@3c-app-gmx-bap03>
References: <trinity-2eda1037-de24-4b26-849a-41f0a1104f03-1683543179774@3c-app-gmx-bap03>
Message-ID: <7daa5b29-0958-eed7-47f2-0b9928ef17b1@sapo.pt>

?s 11:52 de 08/05/2023, Georg Kindermann escreveu:
> Dear list members,
> 
> when I create a data.frame containing an array I had expected, that I get a similar result, when subsetting it, like having a matrix in a data.frame. But instead I get only the first element and not all values of the remaining dimensions. Differences are already when creating the data.frame, where I can use `I` in case of a matrix but for an array I am only able to insert it in a second step.
> 
> DFA <- data.frame(id = 1:2)
> DFA[["ar"]] <- array(1:8, c(2,2,2))
> 
> DFA[1,]
> #  id ar
> #1  1  1
> 
> DFM <- data.frame(id = 1:2, M = I(matrix(1:4, 2)))
> 
> DFM[1,]
> #  id M.1 M.2
> #1  1   1   3
> 
> The same when trying to use merge, where only the first value is kept.
> 
> merge(DFA, data.frame(id = 1))
> #  id ar
> #1  1  1
> 
> merge(DFM, data.frame(id = 1))
> #  id M.1 M.2
> #1  1   1   3
> 
> Is there a way to use an array in a data.frame like I can use a matrix in a data.frame?
> 
> I am using R version 4.3.0.
> 
> Kind regards,
> Georg
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Are you looking for something like this?


DFA <- data.frame(id = 1:2)
DFA[["ar"]] <- array(1:8, c(2,2,2))

DFA$ar[1, , ]
#>      [,1] [,2]
#> [1,]    1    5
#> [2,]    3    7


Hope this helps,

Rui Barradas


From er|cjberger @end|ng |rom gm@||@com  Tue May  9 09:44:25 2023
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Tue, 9 May 2023 10:44:25 +0300
Subject: [R] RandomForest tuning the parameters
In-Reply-To: <CAGgJW76ie4u3B=U=jaKuOQ6gNt70uKLUt7b=2ocrGitwTAaWVw@mail.gmail.com>
References: <176227066.1386345.1683576625666.ref@mail.yahoo.com>
 <176227066.1386345.1683576625666@mail.yahoo.com>
 <CAGgJW76ie4u3B=U=jaKuOQ6gNt70uKLUt7b=2ocrGitwTAaWVw@mail.gmail.com>
Message-ID: <CAGgJW75-_zC7YEG+JbKodaU5=c3r7NsVdUymOL0qy4pY+SbtiQ@mail.gmail.com>

Hi Sacha,
On second thought, perhaps this is more the direction that you want ...

X2 = cbind(X_train,y_train)
colnames(X2)[3] = "y"
regr2<-randomForest(y~x1+x2, data=X2,maxnodes=10, ntree=10)
regr
regr2

#Make prediction
predictions= predict(regr, X_test)
predictions2= predict(regr2, X_test)

HTH,
Eric


On Tue, May 9, 2023 at 6:40?AM Eric Berger <ericjberger at gmail.com> wrote:

> Hi,
> One problem you have is with the command:
> regr<-randomForest(y~x1+x2, data=X_train, proximity=TRUE)
>
> What you need is something like this:
>
> X2 <- cbind(X,y)
> regr<-randomForest(y~x1+x2, data=X2, proximity=TRUE)
>
> HTH,
> Eric
>
>
> On Mon, May 8, 2023 at 11:11?PM varin sacha via R-help
> <r-help at r-project.org> wrote:
> >
> > Dear R-experts,
> >
> > Here below a toy example with some error messages, especially at the end
> of the code (Tuning the parameters). Your help to correct my R code would
> be highly appreciated.
> >
> >
> > #######################################
> > #libraries
> > library(lattice)
> > library(ggplot2)
> > library(caret)
> > library(randomForest)
> >
> > #Data
> >
> y=c(23,34,32,12,24,35,45,56,76,87,54,34,23,45,41,13,16,98,35,65,56,67,78,89,87,64,53,31,14,34,45,46,57,69,90,80,70,65,50,45,60,56,87,79,64,34,25,47,61,24,10,13,12,15,46,58,76,89,90,98)
> >
> x1=c(4,5,6,7,1,10,19,20,21,14,23,6,5,32,15,12,16,14,2,3,4,5,3,2,1,2,6,7,5,4,3,2,1,3,4,6,7,9,5,4,3,7,10,11,12,13,10,3,2,5,6,9,8,7,4,12,15,16,2,3)
> >
> x2=c(0,0,0,1,1,0,1,1,0,1,1,0,0,1,0,0,0,0,0,1,1,1,1,1,0,0,0,1,0,0,1,0,0,0,1,1,0,1,0,0,0,1,1,1,1,0,1,0,1,0,0,1,1,0,0,1,0,0,1,1)
> >
> > y=as.numeric(y)
> > x1=as.numeric(x1)
> > x2=as.factor(x2)
> >
> > X=data.frame(x1,x2)
> > y=y
> >
> > #Split data into training and test sets
> > index=createDataPartition(y, p=0.75, list=FALSE)
> > X_train = X[index, ]
> > X_test = X[-index, ]
> > y_train= y[index ]
> > y_test = y[-index ]
> >
> > #Train de model
> > regr=randomForest (x=X_train, y=y_train, maxnodes=10, ntree=10)
> >
> > regr<-randomForest(y~x1+x2, data=X_train, proximity=TRUE)
> > regr
> >
> > #Make prediction
> > predictions= predict(regr, X_test)
> >
> > result= X_test
> > result['y'] = y_test
> > result['prediction'] = predictions
> > result
> >
> > # Import library for Metrics
> > library(Metrics)
> >
> > print(paste0('MAE: ' , mae(y_test,predictions) ))
> > print(paste0('MSE: ' ,caret::postResample(predictions ,
> y_test)['RMSE']^2 ))
> > print(paste0('R2: ' ,caret::postResample(predictions ,
> y_test)['Rsquared'] ))
> >
> >
> > #Tuning the parameters
> > N=500 #length(X_train)
> > X_train_ = X_train[1:N , ]
> > y_train_ = y_train[1:N]
> >
> > seed <-7
> > metric<-'RMSE'
> >
> > customRF <- list(type = "Regression", library = "randomForest", loop =
> NULL)
> >
> > customRF$parameters <- data.frame(parameter = c("maxnodes", "ntree"),
> class = rep("numeric", 2), label = c("maxnodes", "ntree"))
> >
> > customRF$grid <- function(x, y, len = NULL, search = "grid") {}
> >
> > customRF$fit <- function(x, y, wts, param, lev, last, weights,
> classProbs, ...) {
> >
> >  randomForest(x, y, maxnodes = param$maxnodes, ntree=param$ntree, ...)
> >
> > }
> >
> > customRF$predict <- function(modelFit, newdata, preProc = NULL,
> submodels = NULL)
> >
> > predict(modelFit, newdata)
> >
> > customRF$prob <- function(modelFit, newdata, preProc = NULL, submodels =
> NULL)
> >
> >   predict(modelFit, newdata, type = "prob")
> >
> > customRF$sort <- function(x) x[order(x[,1]),]
> >
> > customRF$levels <- function(x) x$classes
> >
> >
> > # Set grid search parameters
> > control <- trainControl(method="repeatedcv", number=10, repeats=3,
> search='grid')
> >
> > # Outline the grid of parameters
> > tunegrid <- expand.grid(.maxnodes=c(10,20,30,50), .ntree=c(100, 200,
> 300))
> > set.seed(seed)
> >
> > # Train the model
> > rf_gridsearch <- train(x=X_train_, y=y_train_, method=customRF,
> metric=metric, tuneGrid=tunegrid, trControl=control)
> >
> > plot(rf_gridsearch)
> >
> > rf_gridsearch$bestTune
> >
> > #################################################
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From Georg@K|nderm@nn @end|ng |rom gmx@@t  Tue May  9 10:50:42 2023
From: Georg@K|nderm@nn @end|ng |rom gmx@@t (Georg Kindermann)
Date: Tue, 9 May 2023 10:50:42 +0200
Subject: [R] data.frame with a column containing an array
In-Reply-To: <7daa5b29-0958-eed7-47f2-0b9928ef17b1@sapo.pt>
References: <trinity-2eda1037-de24-4b26-849a-41f0a1104f03-1683543179774@3c-app-gmx-bap03>
 <7daa5b29-0958-eed7-47f2-0b9928ef17b1@sapo.pt>
Message-ID: <trinity-00875706-f414-441a-8594-358db7d8f23c-1683622242413@3c-app-gmx-bap56>

Thanks!
?
No, to be consistent with what I get with a matrix I think it should be like:

x <- data.frame(id = DFA$id[1])
x$ar <- DFA$ar[1, , , drop = FALSE]

str(x)
#'data.frame': 1 obs. of 2 variables:
# $ id: int 1
# $ ar: int [1, 1:2, 1:2] 1 3 5 7

Georg
?
?

Gesendet:?Dienstag, 09. Mai 2023 um 09:32 Uhr
Von:?"Rui Barradas" <ruipbarradas at sapo.pt>
An:?"Georg Kindermann" <Georg.Kindermann at gmx.at>, r-help at r-project.org
Betreff:?Re: [R] data.frame with a column containing an array
?s 11:52 de 08/05/2023, Georg Kindermann escreveu:
> Dear list members,
>
> when I create a data.frame containing an array I had expected, that I get a similar result, when subsetting it, like having a matrix in a data.frame. But instead I get only the first element and not all values of the remaining dimensions. Differences are already when creating the data.frame, where I can use `I` in case of a matrix but for an array I am only able to insert it in a second step.
>
> DFA <- data.frame(id = 1:2)
> DFA[["ar"]] <- array(1:8, c(2,2,2))
>
> DFA[1,]
> # id ar
> #1 1 1
>
> DFM <- data.frame(id = 1:2, M = I(matrix(1:4, 2)))
>
> DFM[1,]
> # id M.1 M.2
> #1 1 1 3
>
> The same when trying to use merge, where only the first value is kept.
>
> merge(DFA, data.frame(id = 1))
> # id ar
> #1 1 1
>
> merge(DFM, data.frame(id = 1))
> # id M.1 M.2
> #1 1 1 3
>
> Is there a way to use an array in a data.frame like I can use a matrix in a data.frame?
>
> I am using R version 4.3.0.
>
> Kind regards,
> Georg
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html[http://www.R-project.org/posting-guide.html]
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Are you looking for something like this?


DFA <- data.frame(id = 1:2)
DFA[["ar"]] <- array(1:8, c(2,2,2))

DFA$ar[1, , ]
#> [,1] [,2]
#> [1,] 1 5
#> [2,] 3 7


Hope this helps,

Rui Barradas
?


From z|oto_kruk @end|ng |rom hotm@||@com  Mon May  8 18:24:39 2023
From: z|oto_kruk @end|ng |rom hotm@||@com (=?iso-8859-1?Q?Sebasti=E1n_Kruk_Gencarelli?=)
Date: Mon, 8 May 2023 16:24:39 +0000
Subject: [R] win110 + R 4.3.0 dowload only when method = "wininet"
Message-ID: <IA0PR19MB72890261CF953C010DE9E381F5719@IA0PR19MB7289.namprd19.prod.outlook.com>

Dear R-users,

I updated my R. I installed 4.3.0.

I have Windows 10 Pro.

I can only install/update packages/files if I select method wininet.

For example:

> update.packages(ask='graphics',checkBuilt=TRUE)
--- Please select a CRAN mirror for use in this session ---
Warning message:
In download.file(url, destfile = f, quiet = TRUE) :
  the 'wininet' method is deprecated for http:// and https:// URLs

What can i do?

Thanks in advance,

Sebas.

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Tue May  9 16:56:24 2023
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 9 May 2023 07:56:24 -0700
Subject: [R] data.frame with a column containing an array
In-Reply-To: <trinity-00875706-f414-441a-8594-358db7d8f23c-1683622242413@3c-app-gmx-bap56>
References: <trinity-2eda1037-de24-4b26-849a-41f0a1104f03-1683543179774@3c-app-gmx-bap03>
 <7daa5b29-0958-eed7-47f2-0b9928ef17b1@sapo.pt>
 <trinity-00875706-f414-441a-8594-358db7d8f23c-1683622242413@3c-app-gmx-bap56>
Message-ID: <CAGxFJbS0kn+g+hk7v_NJ+tsKsnEMuxBaHy6yhBkZ1FFKcB=8_Q@mail.gmail.com>

Right ... that's what I thought you meant.

I'm pretty sure -- but not certain -- that columns of matrices are treated
specially by [.data.frame, so that you have to explicitly index a higher
dimensional array, e.g. like this:


subs <- c(1,3)
DFA <- data.frame(id = 1:3)
DFA[["ar"]] <- array(1:12, c(3,2,2))

DFA$ar[match(subs,DFA$id),,]
##yielding:
, , 1

     [,1] [,2]
[1,]    1    4
[2,]    3    6

, , 2

     [,1] [,2]
[1,]    7   10
[2,]    9   12

You might check, e.g. the "data.table" package, to see if it indexes as you
would like with columns that contain arrays.

Alternatively, and perhaps preferably depending on your use case, you may
wish to create a wholly different data structure or just treat the data
frame as a list from the start. Data frames/matrix-like data structures are
convenient and appropriate a lot of the time, but not always. R, like any
flexible programming language, allows you -- even encourages you -- to
create other data structures that fit your needs.

Cheers,
Bert

On Tue, May 9, 2023 at 3:39?AM Georg Kindermann <Georg.Kindermann at gmx.at>
wrote:

> Thanks!
>
> No, to be consistent with what I get with a matrix I think it should be
> like:
>
> x <- data.frame(id = DFA$id[1])
> x$ar <- DFA$ar[1, , , drop = FALSE]
>
> str(x)
> #'data.frame': 1 obs. of 2 variables:
> # $ id: int 1
> # $ ar: int [1, 1:2, 1:2] 1 3 5 7
>
> Georg
>
>
>
> Gesendet: Dienstag, 09. Mai 2023 um 09:32 Uhr
> Von: "Rui Barradas" <ruipbarradas at sapo.pt>
> An: "Georg Kindermann" <Georg.Kindermann at gmx.at>, r-help at r-project.org
> Betreff: Re: [R] data.frame with a column containing an array
> ?s 11:52 de 08/05/2023, Georg Kindermann escreveu:
> > Dear list members,
> >
> > when I create a data.frame containing an array I had expected, that I
> get a similar result, when subsetting it, like having a matrix in a
> data.frame. But instead I get only the first element and not all values of
> the remaining dimensions. Differences are already when creating the
> data.frame, where I can use `I` in case of a matrix but for an array I am
> only able to insert it in a second step.
> >
> > DFA <- data.frame(id = 1:2)
> > DFA[["ar"]] <- array(1:8, c(2,2,2))
> >
> > DFA[1,]
> > # id ar
> > #1 1 1
> >
> > DFM <- data.frame(id = 1:2, M = I(matrix(1:4, 2)))
> >
> > DFM[1,]
> > # id M.1 M.2
> > #1 1 1 3
> >
> > The same when trying to use merge, where only the first value is kept.
> >
> > merge(DFA, data.frame(id = 1))
> > # id ar
> > #1 1 1
> >
> > merge(DFM, data.frame(id = 1))
> > # id M.1 M.2
> > #1 1 1 3
> >
> > Is there a way to use an array in a data.frame like I can use a matrix
> in a data.frame?
> >
> > I am using R version 4.3.0.
> >
> > Kind regards,
> > Georg
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html[http://www.R-project.org/posting-guide.html]
> > and provide commented, minimal, self-contained, reproducible code.
> Hello,
>
> Are you looking for something like this?
>
>
> DFA <- data.frame(id = 1:2)
> DFA[["ar"]] <- array(1:8, c(2,2,2))
>
> DFA$ar[1, , ]
> #> [,1] [,2]
> #> [1,] 1 5
> #> [2,] 3 7
>
>
> Hope this helps,
>
> Rui Barradas
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Tue May  9 19:28:21 2023
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 9 May 2023 10:28:21 -0700
Subject: [R] data.frame with a column containing an array
In-Reply-To: <CAGxFJbS0kn+g+hk7v_NJ+tsKsnEMuxBaHy6yhBkZ1FFKcB=8_Q@mail.gmail.com>
References: <trinity-2eda1037-de24-4b26-849a-41f0a1104f03-1683543179774@3c-app-gmx-bap03>
 <7daa5b29-0958-eed7-47f2-0b9928ef17b1@sapo.pt>
 <trinity-00875706-f414-441a-8594-358db7d8f23c-1683622242413@3c-app-gmx-bap56>
 <CAGxFJbS0kn+g+hk7v_NJ+tsKsnEMuxBaHy6yhBkZ1FFKcB=8_Q@mail.gmail.com>
Message-ID: <CAGxFJbRo3pDD2dLPy4WwM-nbZiLsUKqoDVYAv4ri=FLwyyQAfg@mail.gmail.com>

I think the following may provide a clearer explanation:

subs <- c(1,3)
DFA <- data.frame(id = 1:3)
ar <- array(1:12, c(3,2,2))
## yielding
> ar
, , 1

     [,1] [,2]
[1,]    1    4
[2,]    2    5
[3,]    3    6

, , 2

     [,1] [,2]
[1,]    7   10
[2,]    8   11
[3,]    9   12

## array subscripting gives
> ar[subs,,]
, , 1

     [,1] [,2]
[1,]    1    4
[2,]    3    6

, , 2

     [,1] [,2]
[1,]    7   10
[2,]    9   12

## Now with df's
> DFA[["ar"]] <- ar
>
> DFM <- data.frame(id = 1:3)
> DFM[["M"]] <- matrix(1:6, nc =2)
>
> str(DFM)
'data.frame': 3 obs. of  2 variables:
 $ id: int  1 2 3
 $ M : int [1:3, 1:2] 1 2 3 4 5 6
> str(DFA)
'data.frame': 3 obs. of  2 variables:
 $ id: int  1 2 3
 $ ar: int [1:3, 1:2, 1:2] 1 2 3 4 5 6 7 8 9 10 ...
>
> ## But the data frame print method for these give
> DFM
  id M.1 M.2
1  1   1   4
2  2   2   5
3  3   3   6
> DFA
  id ar.1 ar.2 ar.3 ar.4
1  1    1    4    7   10
2  2    2    5    8   11
3  3    3    6    9   12
>
> ## [.data.frame subscripting gives
> DFA[subs,]
  id ar
1  1  1
3  3  3
> DFM[subs,]
  id M.1 M.2
1  1   1   4
3  3   3   6
>
> ## but  explicit array subscripting of course works
> DFA$ar[match(subs,DFA$id),,]
, , 1

     [,1] [,2]
[1,]    1    4
[2,]    3    6

, , 2

     [,1] [,2]
[1,]    7   10
[2,]    9   12


Cheers,
Bert

On Tue, May 9, 2023 at 7:56?AM Bert Gunter <bgunter.4567 at gmail.com> wrote:

> Right ... that's what I thought you meant.
>
> I'm pretty sure -- but not certain -- that columns of matrices are treated
> specially by [.data.frame, so that you have to explicitly index a higher
> dimensional array, e.g. like this:
>
>
> subs <- c(1,3)
> DFA <- data.frame(id = 1:3)
> DFA[["ar"]] <- array(1:12, c(3,2,2))
>
> DFA$ar[match(subs,DFA$id),,]
> ##yielding:
> , , 1
>
>      [,1] [,2]
> [1,]    1    4
> [2,]    3    6
>
> , , 2
>
>      [,1] [,2]
> [1,]    7   10
> [2,]    9   12
>
> You might check, e.g. the "data.table" package, to see if it indexes as
> you would like with columns that contain arrays.
>
> Alternatively, and perhaps preferably depending on your use case, you may
> wish to create a wholly different data structure or just treat the data
> frame as a list from the start. Data frames/matrix-like data structures are
> convenient and appropriate a lot of the time, but not always. R, like any
> flexible programming language, allows you -- even encourages you -- to
> create other data structures that fit your needs.
>
> Cheers,
> Bert
>
> On Tue, May 9, 2023 at 3:39?AM Georg Kindermann <Georg.Kindermann at gmx.at>
> wrote:
>
>> Thanks!
>>
>> No, to be consistent with what I get with a matrix I think it should be
>> like:
>>
>> x <- data.frame(id = DFA$id[1])
>> x$ar <- DFA$ar[1, , , drop = FALSE]
>>
>> str(x)
>> #'data.frame': 1 obs. of 2 variables:
>> # $ id: int 1
>> # $ ar: int [1, 1:2, 1:2] 1 3 5 7
>>
>> Georg
>>
>>
>>
>> Gesendet: Dienstag, 09. Mai 2023 um 09:32 Uhr
>> Von: "Rui Barradas" <ruipbarradas at sapo.pt>
>> An: "Georg Kindermann" <Georg.Kindermann at gmx.at>, r-help at r-project.org
>> Betreff: Re: [R] data.frame with a column containing an array
>> ?s 11:52 de 08/05/2023, Georg Kindermann escreveu:
>> > Dear list members,
>> >
>> > when I create a data.frame containing an array I had expected, that I
>> get a similar result, when subsetting it, like having a matrix in a
>> data.frame. But instead I get only the first element and not all values of
>> the remaining dimensions. Differences are already when creating the
>> data.frame, where I can use `I` in case of a matrix but for an array I am
>> only able to insert it in a second step.
>> >
>> > DFA <- data.frame(id = 1:2)
>> > DFA[["ar"]] <- array(1:8, c(2,2,2))
>> >
>> > DFA[1,]
>> > # id ar
>> > #1 1 1
>> >
>> > DFM <- data.frame(id = 1:2, M = I(matrix(1:4, 2)))
>> >
>> > DFM[1,]
>> > # id M.1 M.2
>> > #1 1 1 3
>> >
>> > The same when trying to use merge, where only the first value is kept.
>> >
>> > merge(DFA, data.frame(id = 1))
>> > # id ar
>> > #1 1 1
>> >
>> > merge(DFM, data.frame(id = 1))
>> > # id M.1 M.2
>> > #1 1 1 3
>> >
>> > Is there a way to use an array in a data.frame like I can use a matrix
>> in a data.frame?
>> >
>> > I am using R version 4.3.0.
>> >
>> > Kind regards,
>> > Georg
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html[http://www.R-project.org/posting-guide.html]
>> > and provide commented, minimal, self-contained, reproducible code.
>> Hello,
>>
>> Are you looking for something like this?
>>
>>
>> DFA <- data.frame(id = 1:2)
>> DFA[["ar"]] <- array(1:8, c(2,2,2))
>>
>> DFA$ar[1, , ]
>> #> [,1] [,2]
>> #> [1,] 1 5
>> #> [2,] 3 7
>>
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From Georg@K|nderm@nn @end|ng |rom gmx@@t  Tue May  9 19:26:45 2023
From: Georg@K|nderm@nn @end|ng |rom gmx@@t (Georg Kindermann)
Date: Tue, 9 May 2023 19:26:45 +0200
Subject: [R] data.frame with a column containing an array
In-Reply-To: <CAGxFJbS0kn+g+hk7v_NJ+tsKsnEMuxBaHy6yhBkZ1FFKcB=8_Q@mail.gmail.com>
References: <trinity-2eda1037-de24-4b26-849a-41f0a1104f03-1683543179774@3c-app-gmx-bap03>
 <7daa5b29-0958-eed7-47f2-0b9928ef17b1@sapo.pt>
 <trinity-00875706-f414-441a-8594-358db7d8f23c-1683622242413@3c-app-gmx-bap56>
 <CAGxFJbS0kn+g+hk7v_NJ+tsKsnEMuxBaHy6yhBkZ1FFKcB=8_Q@mail.gmail.com>
Message-ID: <trinity-a85ebf26-b258-4213-9e7b-b4b7636a3f2c-1683653205292@3c-app-gmx-bs49>

Thanks!
With data.table I'm not able to create it.

DT <- data.table::data.table(id = 1:2)
DT$ar <- array(1:8, c(2,2,2))
#Error in set(x, j = name, value = value) : 
#  Supplied 8 items to be assigned to 2 items of column 'ar'. If you wish to 'recycle' the RHS please use rep() to make this intent clear to readers of your code.

DFA <- data.frame(id = 1:2)
DFA[["ar"]] <- array(1:8, c(2,2,2))
data.table::as.data.table(DFA)
#Error in setDT(ans, key = key) : 
#  All elements in argument 'x' to 'setDT' must be of same length, but the profile of input lengths (length:frequency) is: [0:1, 2:2]
#The first entry with fewer than 2 entries is 3

But with tibble it works as expected.

TI <- tibble::tibble(id = 1:2, ar = array(1:8, c(2,2,2)))
str(TI[1,])
#tibble [1 ? 2] (S3: tbl_df/tbl/data.frame)
# $ id: int 1
# $ ar: int [1, 1:2, 1:2] 1 3 5 7

But it would be nice if something similar would also work with data.frame.

Georg
?
?
?

Gesendet:?Dienstag, 09. Mai 2023 um 16:56 Uhr
Von:?"Bert Gunter" <bgunter.4567 at gmail.com>
An:?"Georg Kindermann" <Georg.Kindermann at gmx.at>
Cc:?"Rui Barradas" <ruipbarradas at sapo.pt>, r-help at r-project.org
Betreff:?Re: [R] data.frame with a column containing an array

Right ... that's what I thought you meant.
?
I'm pretty sure -- but not certain -- that columns of matrices are treated specially by [.data.frame, so that you have to explicitly index a higher dimensional array, e.g. like this:
?
subs <- c(1,3)
DFA <- data.frame(id = 1:3)
DFA[["ar"]] <- array(1:12, c(3,2,2))

DFA$ar[match(subs,DFA$id),,]
##yielding:
, , 1

? ? ?[,1] [,2]
[1,] ? ?1 ? ?4
[2,] ? ?3 ? ?6

, , 2

? ? ?[,1] [,2]
[1,] ? ?7 ? 10
[2,] ? ?9 ? 12
?
You might check, e.g. the "data.table" package, to see if it indexes as you would like with columns that contain arrays.
?
Alternatively, and perhaps preferably depending on your use case, you may wish to create a wholly different data structure or just treat the data frame as a list from the start. Data frames/matrix-like data structures are convenient and appropriate a lot of the time, but not always. R, like any flexible programming language, allows you -- even encourages you -- to create other data structures that fit your needs.
?
Cheers,
Bert?


From kry|ov@r00t @end|ng |rom gm@||@com  Wed May 10 10:13:42 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Wed, 10 May 2023 11:13:42 +0300
Subject: [R] win110 + R 4.3.0 dowload only when method = "wininet"
In-Reply-To: <IA0PR19MB72890261CF953C010DE9E381F5719@IA0PR19MB7289.namprd19.prod.outlook.com>
References: <IA0PR19MB72890261CF953C010DE9E381F5719@IA0PR19MB7289.namprd19.prod.outlook.com>
Message-ID: <20230510111342.21544331@Tarkus>

On Mon, 8 May 2023 16:24:39 +0000
Sebasti?n Kruk Gencarelli <zloto_kruk at hotmail.com> wrote:

> I have Windows 10 Pro.
> 
> I can only install/update packages/files if I select method wininet.

What kind of proxy does your system use to access the Internet? It's
unfortunate that the default configuration doesn't work any more, but
perhaps libcurl can be taught to recognise this configuration.

-- 
Best regards,
Ivan


