From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Tue Aug  2 09:10:43 2022
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Tue, 2 Aug 2022 09:10:43 +0200
Subject: [R] Predicted values from glm() when linear predictor is NA.
In-Reply-To: <20220728141949.53afcb46@rolf-Latitude-E7470>
References: <20220728122628.4381daa4@rolf-Latitude-E7470>
 <5371d080-d666-f059-c6f8-e3051a0faea2@comcast.net>
 <20220728141949.53afcb46@rolf-Latitude-E7470>
Message-ID: <25320.52723.249947.577244@stat.math.ethz.ch>

>>>>> Rolf Turner 
>>>>>     on Thu, 28 Jul 2022 14:19:49 +1200 writes:

    > On Wed, 27 Jul 2022 18:25:23 -0700 David Winsemius
    > <dwinsemius at comcast.net> wrote:

    > <SNIP>

    >> The NA is most likely caused by aliasing, so some other
    >> combination of factors a perfect surrogate for every case
    >> with that level of the interaction.

    > <SNIP>

    > No, I think it's much simpler than that.  Essentially it
    > boils down to the fact that if y is 1:10 and x is
    > rep(1,10) then

    >     lm(y ~ x)

    > gives a slope estimate of NA.  As it clearly should.

*and*  predict() should surely *not* be NA, either, right ??

You can easily confirm with

 x <- rep(1,7); y <- 1:7; summary(fm <- lm(y~x))
 predict(fm)

which gives all '4'  (= mean(y))

Note that this *is* aliasing:  x is aliased with the intercept,
and it fits entirely your situation:

If a predictor variable is superfluous, i.e., more precisely, a
column of the X design matrix is an exact linear combination of
previous columns,
prediction is no problem at all and gives exactly what you'd get
if you omit that superfluous column/variable.

Are you sure this is not simply your situation?
Martin


    > cheers,
    > Rolf

    > -- 
    > Honorary Research Fellow Department of Statistics
    > University of Auckland Phone: +64-9-373-7599 ext. 88276


From |u||@dmtru @end|ng |rom gm@||@com  Tue Aug  2 11:18:06 2022
From: |u||@dmtru @end|ng |rom gm@||@com (Iulia Dumitru)
Date: Tue, 2 Aug 2022 12:18:06 +0300
Subject: [R] I don't understand the result of `svyboxplot` function from the
 Survey package
Message-ID: <06F1D8CB-79C6-4FAF-B116-709508A3E211@gmail.com>

After following the example given here: https://www.rdocumentation.org/packages/survey/versions/4.1-1/topics/svyhist
for `svyboxplot` I get the result in the attached image. This is a box plot of the `enroll` variable from the stratified dataset `apistrat`, grouped by `stype`: E (elementary school), M (middle school) and H (high school). If I use the `svyby` function to group the data by `stype` and find the mean for each group, I get this result:

> svyby(~enroll, ~stype, dstrat, svymean)
  stype  enroll       se
E     E  416.78 16.41740
H     H 1320.70 91.70781
M     M  832.48 54.52157

Clearly the means are very different from each other. Then why don?t the box plots show this? I don?t know how to interpret the plot. Could someone please offer some insight on this? Thank you!



From @jd@m|co @end|ng |rom gm@||@com  Tue Aug  2 13:49:48 2022
From: @jd@m|co @end|ng |rom gm@||@com (Anthony Damico)
Date: Tue, 2 Aug 2022 07:49:48 -0400
Subject: [R] 
 I don't understand the result of `svyboxplot` function from the
 Survey package
In-Reply-To: <06F1D8CB-79C6-4FAF-B116-709508A3E211@gmail.com>
References: <06F1D8CB-79C6-4FAF-B116-709508A3E211@gmail.com>
Message-ID: <CAOwvMDy4u-rSxsRogzCzQqLq2gpgt4dKdY+cit6MtWHLNCt1iw@mail.gmail.com>

hi, nice catch!  i'm ccing the author of the survey package because this
might be a issue.  when i run ?svyboxplot, i also see all three boxes in
the exact same place..  seems like the svyby() call inside of svyboxplot
does something unexpected when svyquantile gets passed using keep.var=FALSE
and ci=FALSE


library(survey)

data(api)

dstrat <- svydesign(id = ~1, strata = ~stype, weights = ~pw, data =
apistrat, fpc = ~fpc)

# looks OK
svyby(~enroll, ~stype, dstrat, svyquantile, quantiles = c(0, 0.25, 0.5,
0.75, 1), na.rm = TRUE)

# returns each result three times in an unexpected configuration..
svyboxplot then grabs the repeated information from the first six columns
svyby(~enroll, ~stype, dstrat, svyquantile, ci = FALSE, keep.var = FALSE,
quantiles = c(0, 0.25, 0.5, 0.75, 1), na.rm = TRUE)





On Tue, Aug 2, 2022 at 7:30 AM Iulia Dumitru <iuliadmtru at gmail.com> wrote:

> After following the example given here:
> https://www.rdocumentation.org/packages/survey/versions/4.1-1/topics/svyhist
> for `svyboxplot` I get the result in the attached image. This is a box
> plot of the `enroll` variable from the stratified dataset `apistrat`,
> grouped by `stype`: E (elementary school), M (middle school) and H (high
> school). If I use the `svyby` function to group the data by `stype` and
> find the mean for each group, I get this result:
>
> > svyby(~enroll, ~stype, dstrat, svymean)
>   stype  enroll       se
> E     E  416.78 16.41740
> H     H 1320.70 91.70781
> M     M  832.48 54.52157
>
> Clearly the means are very different from each other. Then why don?t the
> box plots show this? I don?t know how to interpret the plot. Could someone
> please offer some insight on this? Thank you!
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From t@|um|ey @end|ng |rom @uck|@nd@@c@nz  Tue Aug  2 23:47:02 2022
From: t@|um|ey @end|ng |rom @uck|@nd@@c@nz (Thomas Lumley)
Date: Tue, 2 Aug 2022 21:47:02 +0000
Subject: [R] 
 I don't understand the result of `svyboxplot` function from the
 Survey package
In-Reply-To: <CAOwvMDy4u-rSxsRogzCzQqLq2gpgt4dKdY+cit6MtWHLNCt1iw@mail.gmail.com>
References: <06F1D8CB-79C6-4FAF-B116-709508A3E211@gmail.com>
 <CAOwvMDy4u-rSxsRogzCzQqLq2gpgt4dKdY+cit6MtWHLNCt1iw@mail.gmail.com>
Message-ID: <SY4PR01MB6735DB272BA7F214D28DB29EA99D9@SY4PR01MB6735.ausprd01.prod.outlook.com>

It's a bug resulting from the new svyquantile() implementation.  It's fixed in the development version, which you can get from r-forge here: https://r-forge.r-project.org/R/?group_id=1788

  -thomas

Thomas Lumley
Professor of Biostatistics

________________________________________
From: Anthony Damico <ajdamico at gmail.com>
Sent: Tuesday, August 2, 2022 11:49 PM
To: Iulia Dumitru
Cc: r-help at r-project.org; Thomas Lumley
Subject: Re: [R] I don't understand the result of `svyboxplot` function from the Survey package

hi, nice catch!  i'm ccing the author of the survey package because this might be a issue.  when i run ?svyboxplot, i also see all three boxes in the exact same place..  seems like the svyby() call inside of svyboxplot does something unexpected when svyquantile gets passed using keep.var=FALSE and ci=FALSE


library(survey)

data(api)

dstrat <- svydesign(id = ~1, strata = ~stype, weights = ~pw, data = apistrat, fpc = ~fpc)

# looks OK
svyby(~enroll, ~stype, dstrat, svyquantile, quantiles = c(0, 0.25, 0.5, 0.75, 1), na.rm = TRUE)

# returns each result three times in an unexpected configuration..  svyboxplot then grabs the repeated information from the first six columns
svyby(~enroll, ~stype, dstrat, svyquantile, ci = FALSE, keep.var = FALSE, quantiles = c(0, 0.25, 0.5, 0.75, 1), na.rm = TRUE)





On Tue, Aug 2, 2022 at 7:30 AM Iulia Dumitru <iuliadmtru at gmail.com<mailto:iuliadmtru at gmail.com>> wrote:
After following the example given here: https://www.rdocumentation.org/packages/survey/versions/4.1-1/topics/svyhist<https://www.rdocumentation.org/packages/survey/versions/4.1-1/topics/svyhist>
for `svyboxplot` I get the result in the attached image. This is a box plot of the `enroll` variable from the stratified dataset `apistrat`, grouped by `stype`: E (elementary school), M (middle school) and H (high school). If I use the `svyby` function to group the data by `stype` and find the mean for each group, I get this result:

> svyby(~enroll, ~stype, dstrat, svymean)
  stype  enroll       se
E     E  416.78 16.41740
H     H 1320.70 91.70781
M     M  832.48 54.52157

Clearly the means are very different from each other. Then why don?t the box plots show this? I don?t know how to interpret the plot. Could someone please offer some insight on this? Thank you!


______________________________________________
R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help<https://stat.ethz.ch/mailman/listinfo/r-help>
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html<http://www.R-project.org/posting-guide.html>
and provide commented, minimal, self-contained, reproducible code.


From s@ski@@grob m@iii@g oii quickii@e@ch  Wed Aug  3 08:37:28 2022
From: s@ski@@grob m@iii@g oii quickii@e@ch (s@ski@@grob m@iii@g oii quickii@e@ch)
Date: Wed, 3 Aug 2022 06:37:28 +0000
Subject: [R] cumulative survival/number of deaths after weighting using
 survey::svykm()
Message-ID: <VI1PR06MB563155E467B4410AB9E2F962FC9C9@VI1PR06MB5631.eurprd06.prod.outlook.com>

Hey guys.
I have a question.
I drew a weighted Kaplan-Meier survival plot using the survey::svykm() function, like this:
```
library(survey)
data(pbc, package="survival")
pbc$randomized <- with(pbc, !is.na(trt) & trt>0)
biasmodel <- glm(randomized~age*edema,data=pbc)
pbc$randprob <- fitted(biasmodel)

dpbc<-svydesign(id=~1, prob=~randprob, strata=~edema, data=subset(pbc,randomized))
s2 <-svykm(Surv(time,status==1) ~ sex, design = dpbc)
```

Now I would like to calculate the survival rates and number of deaths after x months similar to what I would get when using summary(s2, times = 320) on a survfit object. Does anybody know how I can extract these values?
Many thanks in advance!
Saskia

	[[alternative HTML version deleted]]


From ho@@@|nmm @end|ng |rom jun|v@edu  Thu Aug  4 15:30:35 2022
From: ho@@@|nmm @end|ng |rom jun|v@edu (Md. Moyazzem Hossain)
Date: Thu, 4 Aug 2022 14:30:35 +0100
Subject: [R] Need help
Message-ID: <CAO29qn5UwzkmK1LdAfV9B5YsOiOKmVqYbq9-vVSk-26gz8F7yw@mail.gmail.com>

Dear R Experts,

I hope that you are doing well.

I am facing a problem to find out the value of the following function. I
need help in this regard.

#####
a=rnorm(1000, 110, 5)
b = rnorm(1000, -0.3, 0.4)
s = length(a)
lam=0.15
thr=70
r= 10

ff = function(zz){
  inner = vector("numeric", length = s)
     for(k in 1:s){
      inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
          }
  answer = mean(inner)- (1- (1/r))
  return(answer)
  }
########
out=uniroot(ff, lower = 0, upper = 10000 )$root
out

########### Error ########
Error in uniroot(ff, lower = 0, upper = 10000) :
  f.upper = f(upper) is NA

Please help me. Thanks in advance.

Take care.

Hossain

-- 
Best Regards,
Md. Moyazzem Hossain
Associate Professor
Department of Statistics
Jahangirnagar University
Savar, Dhaka-1342, Bangladesh

	[[alternative HTML version deleted]]


From pro|jcn@@h @end|ng |rom gm@||@com  Thu Aug  4 15:40:28 2022
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Thu, 4 Aug 2022 09:40:28 -0400
Subject: [R] Need help
In-Reply-To: <CAO29qn5UwzkmK1LdAfV9B5YsOiOKmVqYbq9-vVSk-26gz8F7yw@mail.gmail.com>
References: <CAO29qn5UwzkmK1LdAfV9B5YsOiOKmVqYbq9-vVSk-26gz8F7yw@mail.gmail.com>
Message-ID: <c6093753-6961-c5f2-4184-ad4f90db2a04@gmail.com>

Have you checked that your function actually crosses zero?

You should also set a seed if you want a reproducible result.

JN

On 2022-08-04 09:30, Md. Moyazzem Hossain wrote:
> Dear R Experts,
> 
> I hope that you are doing well.
> 
> I am facing a problem to find out the value of the following function. I
> need help in this regard.
> 
> #####
> a=rnorm(1000, 110, 5)
> b = rnorm(1000, -0.3, 0.4)
> s = length(a)
> lam=0.15
> thr=70
> r= 10
> 
> ff = function(zz){
>    inner = vector("numeric", length = s)
>       for(k in 1:s){
>        inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
>            }
>    answer = mean(inner)- (1- (1/r))
>    return(answer)
>    }
> ########
> out=uniroot(ff, lower = 0, upper = 10000 )$root
> out
> 
> ########### Error ########
> Error in uniroot(ff, lower = 0, upper = 10000) :
>    f.upper = f(upper) is NA
> 
> Please help me. Thanks in advance.
> 
> Take care.
> 
> Hossain
>


From ho@@@|nmm @end|ng |rom jun|v@edu  Thu Aug  4 15:49:46 2022
From: ho@@@|nmm @end|ng |rom jun|v@edu (Md. Moyazzem Hossain)
Date: Thu, 4 Aug 2022 14:49:46 +0100
Subject: [R] Need help
In-Reply-To: <c6093753-6961-c5f2-4184-ad4f90db2a04@gmail.com>
References: <CAO29qn5UwzkmK1LdAfV9B5YsOiOKmVqYbq9-vVSk-26gz8F7yw@mail.gmail.com>
 <c6093753-6961-c5f2-4184-ad4f90db2a04@gmail.com>
Message-ID: <CAO29qn6kLevZfJt1BrNN4KmcUR2sbFZdz5hZfFsQ-6041f9WCg@mail.gmail.com>

Dear JN,

Thanks.

I do not check whether the function actually crosses zero or not. However,
by assumption, the value would be greater than zero.

Hossain

On Thu, Aug 4, 2022 at 2:40 PM J C Nash <profjcnash at gmail.com> wrote:

> Have you checked that your function actually crosses zero?
>
> You should also set a seed if you want a reproducible result.
>
> JN
>
> On 2022-08-04 09:30, Md. Moyazzem Hossain wrote:
> > Dear R Experts,
> >
> > I hope that you are doing well.
> >
> > I am facing a problem to find out the value of the following function. I
> > need help in this regard.
> >
> > #####
> > a=rnorm(1000, 110, 5)
> > b = rnorm(1000, -0.3, 0.4)
> > s = length(a)
> > lam=0.15
> > thr=70
> > r= 10
> >
> > ff = function(zz){
> >    inner = vector("numeric", length = s)
> >       for(k in 1:s){
> >        inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
> >            }
> >    answer = mean(inner)- (1- (1/r))
> >    return(answer)
> >    }
> > ########
> > out=uniroot(ff, lower = 0, upper = 10000 )$root
> > out
> >
> > ########### Error ########
> > Error in uniroot(ff, lower = 0, upper = 10000) :
> >    f.upper = f(upper) is NA
> >
> > Please help me. Thanks in advance.
> >
> > Take care.
> >
> > Hossain
> >
>


-- 
Best Regards,
Md. Moyazzem Hossain
Associate Professor
Department of Statistics
Jahangirnagar University
Savar, Dhaka-1342, Bangladesh
Website: http://www.juniv.edu/teachers/hossainmm
Research: *[image: Google Scholar]
<https://scholar.google.com/citations?hl=en&user=-U03XCgAAAAJ>* | *ResearchGate
<https://www.researchgate.net/profile/Md_Hossain107>* | *ORCID iD
<https://orcid.org/0000-0003-3593-6936>*

	[[alternative HTML version deleted]]


From j|ox @end|ng |rom mcm@@ter@c@  Thu Aug  4 16:00:58 2022
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Thu, 4 Aug 2022 10:00:58 -0400
Subject: [R] Need help
In-Reply-To: <29425_1659621083_274DpMYL008226_CAO29qn6kLevZfJt1BrNN4KmcUR2sbFZdz5hZfFsQ-6041f9WCg@mail.gmail.com>
References: <CAO29qn5UwzkmK1LdAfV9B5YsOiOKmVqYbq9-vVSk-26gz8F7yw@mail.gmail.com>
 <c6093753-6961-c5f2-4184-ad4f90db2a04@gmail.com>
 <29425_1659621083_274DpMYL008226_CAO29qn6kLevZfJt1BrNN4KmcUR2sbFZdz5hZfFsQ-6041f9WCg@mail.gmail.com>
Message-ID: <3489b6ec-4ad3-d510-8d75-26b85bc8245a@mcmaster.ca>

Dear Hossain,

Did you look at the values that your function returns? As John Nash 
pointed out, these values presumably depend on the random values of a and b.

I tried the following:

set.seed(123) # for reproducibility
a=rnorm(1000, 110, 5)
b = rnorm(1000, -0.3, 0.4)
s = length(a)
lam=0.15
thr=70
r= 10

ff = function(zz){
   inner = vector("numeric", length = s)
   for(k in 1:s){
     inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
   }
   answer = mean(inner)- (1- (1/r))
   return(answer)
}

res <- sapply(0:10000, ff)
res[1:500]
plot(0:150, res[1:151], type="l")


It was quickly clear that ff() produces NaNs for all but the smallest 
values of zz.

Beyond this fact, it's unclear to me what the purpose of the computation 
is. In the short domain where it produces numbers, the function returns 
both negative and positive values (for my values of a and b) -- that is, 
does cross 0 -- and if it did not, it would be nonsense to look for roots.

I hope this helps,
  John


On 2022-08-04 9:49 a.m., Md. Moyazzem Hossain wrote:
> Dear JN,
> 
> Thanks.
> 
> I do not check whether the function actually crosses zero or not. However,
> by assumption, the value would be greater than zero.
> 
> Hossain
> 
> On Thu, Aug 4, 2022 at 2:40 PM J C Nash <profjcnash at gmail.com> wrote:
> 
>> Have you checked that your function actually crosses zero?
>>
>> You should also set a seed if you want a reproducible result.
>>
>> JN
>>
>> On 2022-08-04 09:30, Md. Moyazzem Hossain wrote:
>>> Dear R Experts,
>>>
>>> I hope that you are doing well.
>>>
>>> I am facing a problem to find out the value of the following function. I
>>> need help in this regard.
>>>
>>> #####
>>> a=rnorm(1000, 110, 5)
>>> b = rnorm(1000, -0.3, 0.4)
>>> s = length(a)
>>> lam=0.15
>>> thr=70
>>> r= 10
>>>
>>> ff = function(zz){
>>>     inner = vector("numeric", length = s)
>>>        for(k in 1:s){
>>>         inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
>>>             }
>>>     answer = mean(inner)- (1- (1/r))
>>>     return(answer)
>>>     }
>>> ########
>>> out=uniroot(ff, lower = 0, upper = 10000 )$root
>>> out
>>>
>>> ########### Error ########
>>> Error in uniroot(ff, lower = 0, upper = 10000) :
>>>     f.upper = f(upper) is NA
>>>
>>> Please help me. Thanks in advance.
>>>
>>> Take care.
>>>
>>> Hossain
>>>
>>
> 
> 
-- 
John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://socialsciences.mcmaster.ca/jfox/


From tebert @end|ng |rom u||@edu  Thu Aug  4 16:08:49 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Thu, 4 Aug 2022 14:08:49 +0000
Subject: [R] Need help
In-Reply-To: <CAO29qn6kLevZfJt1BrNN4KmcUR2sbFZdz5hZfFsQ-6041f9WCg@mail.gmail.com>
References: <CAO29qn5UwzkmK1LdAfV9B5YsOiOKmVqYbq9-vVSk-26gz8F7yw@mail.gmail.com>
 <c6093753-6961-c5f2-4184-ad4f90db2a04@gmail.com>
 <CAO29qn6kLevZfJt1BrNN4KmcUR2sbFZdz5hZfFsQ-6041f9WCg@mail.gmail.com>
Message-ID: <BN6PR2201MB1553335262E763DEB4E74B87CF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>

A few issues
1) What does this function do? If you describe the problem and goal there might be a better answer. We appreciate seeing that you have attempted a solution, but you have trapped us all in blindly following your attempt. 

2) This is an error checking phase of programming. Setting the seed is a good idea. Just remember to unset the seed after finishing the debugging phase.

3) In uniroot you call the function, but the function expects an argument (zz) that is not provided, and there is no default.

4) I set.seed(42), and entered ff(12) getting an answer of -0.1468287. Is this the expected result?

Regards,
Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Md. Moyazzem Hossain
Sent: Thursday, August 4, 2022 9:50 AM
To: J C Nash <profjcnash at gmail.com>
Cc: r-help mailing list <r-help at r-project.org>
Subject: Re: [R] Need help

[External Email]

Dear JN,

Thanks.

I do not check whether the function actually crosses zero or not. However, by assumption, the value would be greater than zero.

Hossain

On Thu, Aug 4, 2022 at 2:40 PM J C Nash <profjcnash at gmail.com> wrote:

> Have you checked that your function actually crosses zero?
>
> You should also set a seed if you want a reproducible result.
>
> JN
>
> On 2022-08-04 09:30, Md. Moyazzem Hossain wrote:
> > Dear R Experts,
> >
> > I hope that you are doing well.
> >
> > I am facing a problem to find out the value of the following 
> > function. I need help in this regard.
> >
> > #####
> > a=rnorm(1000, 110, 5)
> > b = rnorm(1000, -0.3, 0.4)
> > s = length(a)
> > lam=0.15
> > thr=70
> > r= 10
> >
> > ff = function(zz){
> >    inner = vector("numeric", length = s)
> >       for(k in 1:s){
> >        inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
> >            }
> >    answer = mean(inner)- (1- (1/r))
> >    return(answer)
> >    }
> > ########
> > out=uniroot(ff, lower = 0, upper = 10000 )$root out
> >
> > ########### Error ########
> > Error in uniroot(ff, lower = 0, upper = 10000) :
> >    f.upper = f(upper) is NA
> >
> > Please help me. Thanks in advance.
> >
> > Take care.
> >
> > Hossain
> >
>


--
Best Regards,
Md. Moyazzem Hossain
Associate Professor
Department of Statistics
Jahangirnagar University
Savar, Dhaka-1342, Bangladesh
Website: https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.juniv.edu%2Fteachers%2Fhossainmm&amp;data=05%7C01%7Ctebert%40ufl.edu%7C5f71ee421f734ed8758b08da762083f7%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952179362158744%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=z%2Bq179lF8MAawyc7KPXgNgGfwC9Sf0dnu34XRJxnpGY%3D&amp;reserved=0
Research: *[image: Google Scholar]
<https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fscholar.google.com%2Fcitations%3Fhl%3Den%26user%3D-U03XCgAAAAJ&amp;data=05%7C01%7Ctebert%40ufl.edu%7C5f71ee421f734ed8758b08da762083f7%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952179362158744%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=N6t1WrH0iRPVvd4L%2FmwqJLNXzFaK1ViPo6v1PrD8gDk%3D&amp;reserved=0>* | *ResearchGate
<https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.researchgate.net%2Fprofile%2FMd_Hossain107&amp;data=05%7C01%7Ctebert%40ufl.edu%7C5f71ee421f734ed8758b08da762083f7%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952179362158744%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=qxDL1f3bKTdxyMYH8cQaxOwCmgclU1PUSB8iS1FdPRQ%3D&amp;reserved=0>* | *ORCID iD
<https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Forcid.org%2F0000-0003-3593-6936&amp;data=05%7C01%7Ctebert%40ufl.edu%7C5f71ee421f734ed8758b08da762083f7%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952179362158744%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=XEb%2BO2pnwNwDDOt0bDgRcIS6MzBd3q%2Bz8xnByUl6Y8w%3D&amp;reserved=0>*

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7C5f71ee421f734ed8758b08da762083f7%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952179362158744%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=g8ytuAGlQp5gAkXSiOkMzs0aurSim4hjX7MGg4dnjd4%3D&amp;reserved=0
PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7C5f71ee421f734ed8758b08da762083f7%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952179362158744%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=GhE0lfrdqQ8fe4YXl3PwxtTAG2SPgG6BYzv5eUXe2UQ%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.


From tebert @end|ng |rom u||@edu  Thu Aug  4 16:27:56 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Thu, 4 Aug 2022 14:27:56 +0000
Subject: [R] Need help
In-Reply-To: <BN6PR2201MB1553335262E763DEB4E74B87CF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <CAO29qn5UwzkmK1LdAfV9B5YsOiOKmVqYbq9-vVSk-26gz8F7yw@mail.gmail.com>
 <c6093753-6961-c5f2-4184-ad4f90db2a04@gmail.com>
 <CAO29qn6kLevZfJt1BrNN4KmcUR2sbFZdz5hZfFsQ-6041f9WCg@mail.gmail.com>
 <BN6PR2201MB1553335262E763DEB4E74B87CF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <BN6PR2201MB155371C158B850FA215EC97ACF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>

I wish I could edit my earlier reply. 
ff(144.43) returns 0.03142121, but ff(144.44) returns NaN.
ff(12) returns -0.1468287

out=uniroot(ff, lower=12, upper =144) does not have errors.
out is a list of 5.
$root is 112
$f.root is 1.09e-08
$iter is 5
$Init.it is NA
$estim.prec is 6.1e-05

Is this working?

Regards,
Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Ebert,Timothy Aaron
Sent: Thursday, August 4, 2022 10:09 AM
To: Md. Moyazzem Hossain <hossainmm at juniv.edu>; J C Nash <profjcnash at gmail.com>
Cc: r-help mailing list <r-help at r-project.org>
Subject: Re: [R] Need help

[External Email]

A few issues
1) What does this function do? If you describe the problem and goal there might be a better answer. We appreciate seeing that you have attempted a solution, but you have trapped us all in blindly following your attempt.

2) This is an error checking phase of programming. Setting the seed is a good idea. Just remember to unset the seed after finishing the debugging phase.

3) In uniroot you call the function, but the function expects an argument (zz) that is not provided, and there is no default.

4) I set.seed(42), and entered ff(12) getting an answer of -0.1468287. Is this the expected result?

Regards,
Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Md. Moyazzem Hossain
Sent: Thursday, August 4, 2022 9:50 AM
To: J C Nash <profjcnash at gmail.com>
Cc: r-help mailing list <r-help at r-project.org>
Subject: Re: [R] Need help

[External Email]

Dear JN,

Thanks.

I do not check whether the function actually crosses zero or not. However, by assumption, the value would be greater than zero.

Hossain

On Thu, Aug 4, 2022 at 2:40 PM J C Nash <profjcnash at gmail.com> wrote:

> Have you checked that your function actually crosses zero?
>
> You should also set a seed if you want a reproducible result.
>
> JN
>
> On 2022-08-04 09:30, Md. Moyazzem Hossain wrote:
> > Dear R Experts,
> >
> > I hope that you are doing well.
> >
> > I am facing a problem to find out the value of the following 
> > function. I need help in this regard.
> >
> > #####
> > a=rnorm(1000, 110, 5)
> > b = rnorm(1000, -0.3, 0.4)
> > s = length(a)
> > lam=0.15
> > thr=70
> > r= 10
> >
> > ff = function(zz){
> >    inner = vector("numeric", length = s)
> >       for(k in 1:s){
> >        inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
> >            }
> >    answer = mean(inner)- (1- (1/r))
> >    return(answer)
> >    }
> > ########
> > out=uniroot(ff, lower = 0, upper = 10000 )$root out
> >
> > ########### Error ########
> > Error in uniroot(ff, lower = 0, upper = 10000) :
> >    f.upper = f(upper) is NA
> >
> > Please help me. Thanks in advance.
> >
> > Take care.
> >
> > Hossain
> >
>


--
Best Regards,
Md. Moyazzem Hossain
Associate Professor
Department of Statistics
Jahangirnagar University
Savar, Dhaka-1342, Bangladesh
Website: https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.juniv.edu%2Fteachers%2Fhossainmm&amp;data=05%7C01%7Ctebert%40ufl.edu%7Ca36bab5860dc491744ea08da762360d7%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952191569778102%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=Vh2lFXXqsLRyKwQES0mlh0LP%2FEtn%2FMfZ56Y9Q1vGRAw%3D&amp;reserved=0
Research: *[image: Google Scholar]
<https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fscholar.google.com%2Fcitations%3Fhl%3Den%26user%3D-U03XCgAAAAJ&amp;data=05%7C01%7Ctebert%40ufl.edu%7Ca36bab5860dc491744ea08da762360d7%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952191569778102%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=st16paDG0HelgvvZZcIlstIEKmayjZFSNdujRJQtFsY%3D&amp;reserved=0>* | *ResearchGate
<https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.researchgate.net%2Fprofile%2FMd_Hossain107&amp;data=05%7C01%7Ctebert%40ufl.edu%7Ca36bab5860dc491744ea08da762360d7%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952191569778102%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=aB9z5UrHElxeTfUVTJB6L8Sj2enqLGWjBuEXXud%2BRyI%3D&amp;reserved=0>* | *ORCID iD
<https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Forcid.org%2F0000-0003-3593-6936&amp;data=05%7C01%7Ctebert%40ufl.edu%7Ca36bab5860dc491744ea08da762360d7%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952191569778102%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=OfjVBjaUn8LaViyL9auEJRxdyx7%2Fs7Du1UPauifNDPs%3D&amp;reserved=0>*

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7Ca36bab5860dc491744ea08da762360d7%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952191569778102%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=YUut6AHh2ON5dCwKO9c9T1rPvRD1rfQirZCEASNWOfg%3D&amp;reserved=0
PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7Ca36bab5860dc491744ea08da762360d7%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952191569778102%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=MKsMalwzucmuzoHVv1BWSPE88zD9bQbsAoHLEESlwSo%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7Ca36bab5860dc491744ea08da762360d7%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952191569778102%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=YUut6AHh2ON5dCwKO9c9T1rPvRD1rfQirZCEASNWOfg%3D&amp;reserved=0
PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7Ca36bab5860dc491744ea08da762360d7%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952191569778102%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=MKsMalwzucmuzoHVv1BWSPE88zD9bQbsAoHLEESlwSo%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.


From tebert @end|ng |rom u||@edu  Thu Aug  4 16:37:56 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Thu, 4 Aug 2022 14:37:56 +0000
Subject: [R] Need help
In-Reply-To: <BN6PR2201MB155371C158B850FA215EC97ACF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <CAO29qn5UwzkmK1LdAfV9B5YsOiOKmVqYbq9-vVSk-26gz8F7yw@mail.gmail.com>
 <c6093753-6961-c5f2-4184-ad4f90db2a04@gmail.com>
 <CAO29qn6kLevZfJt1BrNN4KmcUR2sbFZdz5hZfFsQ-6041f9WCg@mail.gmail.com>
 <BN6PR2201MB1553335262E763DEB4E74B87CF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <BN6PR2201MB155371C158B850FA215EC97ACF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <BN6PR2201MB1553760A52B0CA15CA317BA9CF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>

And one last edit.
Rstudio Environment shows out$root as 112. However, if I then print out$root I get 111.5303 which is much closer to the right answer.  Entering values for ff, I can work out the answer to slightly more than 111.53030196.

Regards,
Tim

-----Original Message-----
From: Ebert,Timothy Aaron <tebert at ufl.edu> 
Sent: Thursday, August 4, 2022 10:28 AM
To: Ebert,Timothy Aaron <tebert at ufl.edu>; Md. Moyazzem Hossain <hossainmm at juniv.edu>; J C Nash <profjcnash at gmail.com>
Cc: r-help mailing list <r-help at r-project.org>
Subject: RE: [R] Need help

I wish I could edit my earlier reply. 
ff(144.43) returns 0.03142121, but ff(144.44) returns NaN.
ff(12) returns -0.1468287

out=uniroot(ff, lower=12, upper =144) does not have errors.
out is a list of 5.
$root is 112
$f.root is 1.09e-08
$iter is 5
$Init.it is NA
$estim.prec is 6.1e-05

Is this working?

Regards,
Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Ebert,Timothy Aaron
Sent: Thursday, August 4, 2022 10:09 AM
To: Md. Moyazzem Hossain <hossainmm at juniv.edu>; J C Nash <profjcnash at gmail.com>
Cc: r-help mailing list <r-help at r-project.org>
Subject: Re: [R] Need help

[External Email]

A few issues
1) What does this function do? If you describe the problem and goal there might be a better answer. We appreciate seeing that you have attempted a solution, but you have trapped us all in blindly following your attempt.

2) This is an error checking phase of programming. Setting the seed is a good idea. Just remember to unset the seed after finishing the debugging phase.

3) In uniroot you call the function, but the function expects an argument (zz) that is not provided, and there is no default.

4) I set.seed(42), and entered ff(12) getting an answer of -0.1468287. Is this the expected result?

Regards,
Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Md. Moyazzem Hossain
Sent: Thursday, August 4, 2022 9:50 AM
To: J C Nash <profjcnash at gmail.com>
Cc: r-help mailing list <r-help at r-project.org>
Subject: Re: [R] Need help

[External Email]

Dear JN,

Thanks.

I do not check whether the function actually crosses zero or not. However, by assumption, the value would be greater than zero.

Hossain

On Thu, Aug 4, 2022 at 2:40 PM J C Nash <profjcnash at gmail.com> wrote:

> Have you checked that your function actually crosses zero?
>
> You should also set a seed if you want a reproducible result.
>
> JN
>
> On 2022-08-04 09:30, Md. Moyazzem Hossain wrote:
> > Dear R Experts,
> >
> > I hope that you are doing well.
> >
> > I am facing a problem to find out the value of the following 
> > function. I need help in this regard.
> >
> > #####
> > a=rnorm(1000, 110, 5)
> > b = rnorm(1000, -0.3, 0.4)
> > s = length(a)
> > lam=0.15
> > thr=70
> > r= 10
> >
> > ff = function(zz){
> >    inner = vector("numeric", length = s)
> >       for(k in 1:s){
> >        inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
> >            }
> >    answer = mean(inner)- (1- (1/r))
> >    return(answer)
> >    }
> > ########
> > out=uniroot(ff, lower = 0, upper = 10000 )$root out
> >
> > ########### Error ########
> > Error in uniroot(ff, lower = 0, upper = 10000) :
> >    f.upper = f(upper) is NA
> >
> > Please help me. Thanks in advance.
> >
> > Take care.
> >
> > Hossain
> >
>


--
Best Regards,
Md. Moyazzem Hossain
Associate Professor
Department of Statistics
Jahangirnagar University
Savar, Dhaka-1342, Bangladesh
Website: https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.juniv.edu%2Fteachers%2Fhossainmm&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=3GVM6FLCtmP9oKjjtVzE0LZpI6LL8ldXknodpFQJUbM%3D&amp;reserved=0
Research: *[image: Google Scholar]
<https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fscholar.google.com%2Fcitations%3Fhl%3Den%26user%3D-U03XCgAAAAJ&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=8EfuEse2%2FnvwuZqvKskGXN4tLnM%2FDTA8XsU7nMma04c%3D&amp;reserved=0>* | *ResearchGate
<https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.researchgate.net%2Fprofile%2FMd_Hossain107&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=IRK69rC%2F251zGT0Kpdo8jfHI1gkQhwoHxzYmozwiYKM%3D&amp;reserved=0>* | *ORCID iD
<https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Forcid.org%2F0000-0003-3593-6936&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=XzQ51GyGR1tEB2iOG90cX9Np8pyeXSDBeeUpC0wDfEc%3D&amp;reserved=0>*

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=VD0EWkp1hKz%2FEKuJsGAsegL9K33y0S1L2O2jDzM6EsM%3D&amp;reserved=0
PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=9wjGhM9eZTIbW6ANRoxzvEI%2BH6tHeSLbGwi7fuACKmE%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=VD0EWkp1hKz%2FEKuJsGAsegL9K33y0S1L2O2jDzM6EsM%3D&amp;reserved=0
PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=9wjGhM9eZTIbW6ANRoxzvEI%2BH6tHeSLbGwi7fuACKmE%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Aug  4 17:24:49 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 4 Aug 2022 16:24:49 +0100
Subject: [R] Need help
In-Reply-To: <BN6PR2201MB1553760A52B0CA15CA317BA9CF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <CAO29qn5UwzkmK1LdAfV9B5YsOiOKmVqYbq9-vVSk-26gz8F7yw@mail.gmail.com>
 <c6093753-6961-c5f2-4184-ad4f90db2a04@gmail.com>
 <CAO29qn6kLevZfJt1BrNN4KmcUR2sbFZdz5hZfFsQ-6041f9WCg@mail.gmail.com>
 <BN6PR2201MB1553335262E763DEB4E74B87CF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <BN6PR2201MB155371C158B850FA215EC97ACF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <BN6PR2201MB1553760A52B0CA15CA317BA9CF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <11045d05-ca3e-44b2-c5db-a23406423d60@sapo.pt>

Hello,

Like others have said, the root does depend on the seed but not by much.
Here is a loop finding the roots for seeds from 1 to 10,000.

I have defined a variable n == 1000 instead of having the calls to rnorm 
depend on a hard-coded constant.



ff <- function(zz){
   inner = vector("numeric", length = s)
   for(k in 1:s){
     inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
   }
   answer = mean(inner) - (1 - (1/r))
   return(answer)
}

n <- 1000
s <- n
lam <- 0.15
thr <- 70
r <- 10

up_lims <- 112.5   # found by trial and error to be nice most
                    # of the time, see mean(ok) below
out_list <- vector("list", length = 1e4)

for(i in seq_along(out_list)) {
   # give the user feedback
   if(i %% 100 == 0) print(i)

   set.seed(i)
   a <- rnorm(n, 110, 5)
   b <- rnorm(n, -0.3, 0.4)

   out_list[[i]] <- tryCatch(
     uniroot(ff, lower = 0, upper = up_lims),
     error = function(e) e
   )
}

ok <- !sapply(out_list, inherits, 'error')
mean(ok)
#[1] 0.9978

root <- sapply(out_list[ok], '[[', 'root')
hist(root)



Hope this helps,

Rui Barradas

?s 15:37 de 04/08/2022, Ebert,Timothy Aaron escreveu:
> And one last edit.
> Rstudio Environment shows out$root as 112. However, if I then print out$root I get 111.5303 which is much closer to the right answer.  Entering values for ff, I can work out the answer to slightly more than 111.53030196.
> 
> Regards,
> Tim
> 
> -----Original Message-----
> From: Ebert,Timothy Aaron <tebert at ufl.edu>
> Sent: Thursday, August 4, 2022 10:28 AM
> To: Ebert,Timothy Aaron <tebert at ufl.edu>; Md. Moyazzem Hossain <hossainmm at juniv.edu>; J C Nash <profjcnash at gmail.com>
> Cc: r-help mailing list <r-help at r-project.org>
> Subject: RE: [R] Need help
> 
> I wish I could edit my earlier reply.
> ff(144.43) returns 0.03142121, but ff(144.44) returns NaN.
> ff(12) returns -0.1468287
> 
> out=uniroot(ff, lower=12, upper =144) does not have errors.
> out is a list of 5.
> $root is 112
> $f.root is 1.09e-08
> $iter is 5
> $Init.it is NA
> $estim.prec is 6.1e-05
> 
> Is this working?
> 
> Regards,
> Tim
> 
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Ebert,Timothy Aaron
> Sent: Thursday, August 4, 2022 10:09 AM
> To: Md. Moyazzem Hossain <hossainmm at juniv.edu>; J C Nash <profjcnash at gmail.com>
> Cc: r-help mailing list <r-help at r-project.org>
> Subject: Re: [R] Need help
> 
> [External Email]
> 
> A few issues
> 1) What does this function do? If you describe the problem and goal there might be a better answer. We appreciate seeing that you have attempted a solution, but you have trapped us all in blindly following your attempt.
> 
> 2) This is an error checking phase of programming. Setting the seed is a good idea. Just remember to unset the seed after finishing the debugging phase.
> 
> 3) In uniroot you call the function, but the function expects an argument (zz) that is not provided, and there is no default.
> 
> 4) I set.seed(42), and entered ff(12) getting an answer of -0.1468287. Is this the expected result?
> 
> Regards,
> Tim
> 
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Md. Moyazzem Hossain
> Sent: Thursday, August 4, 2022 9:50 AM
> To: J C Nash <profjcnash at gmail.com>
> Cc: r-help mailing list <r-help at r-project.org>
> Subject: Re: [R] Need help
> 
> [External Email]
> 
> Dear JN,
> 
> Thanks.
> 
> I do not check whether the function actually crosses zero or not. However, by assumption, the value would be greater than zero.
> 
> Hossain
> 
> On Thu, Aug 4, 2022 at 2:40 PM J C Nash <profjcnash at gmail.com> wrote:
> 
>> Have you checked that your function actually crosses zero?
>>
>> You should also set a seed if you want a reproducible result.
>>
>> JN
>>
>> On 2022-08-04 09:30, Md. Moyazzem Hossain wrote:
>>> Dear R Experts,
>>>
>>> I hope that you are doing well.
>>>
>>> I am facing a problem to find out the value of the following
>>> function. I need help in this regard.
>>>
>>> #####
>>> a=rnorm(1000, 110, 5)
>>> b = rnorm(1000, -0.3, 0.4)
>>> s = length(a)
>>> lam=0.15
>>> thr=70
>>> r= 10
>>>
>>> ff = function(zz){
>>>     inner = vector("numeric", length = s)
>>>        for(k in 1:s){
>>>         inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
>>>             }
>>>     answer = mean(inner)- (1- (1/r))
>>>     return(answer)
>>>     }
>>> ########
>>> out=uniroot(ff, lower = 0, upper = 10000 )$root out
>>>
>>> ########### Error ########
>>> Error in uniroot(ff, lower = 0, upper = 10000) :
>>>     f.upper = f(upper) is NA
>>>
>>> Please help me. Thanks in advance.
>>>
>>> Take care.
>>>
>>> Hossain
>>>
>>
> 
> 
> --
> Best Regards,
> Md. Moyazzem Hossain
> Associate Professor
> Department of Statistics
> Jahangirnagar University
> Savar, Dhaka-1342, Bangladesh
> Website: https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.juniv.edu%2Fteachers%2Fhossainmm&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=3GVM6FLCtmP9oKjjtVzE0LZpI6LL8ldXknodpFQJUbM%3D&amp;reserved=0
> Research: *[image: Google Scholar]
> <https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fscholar.google.com%2Fcitations%3Fhl%3Den%26user%3D-U03XCgAAAAJ&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=8EfuEse2%2FnvwuZqvKskGXN4tLnM%2FDTA8XsU7nMma04c%3D&amp;reserved=0>* | *ResearchGate
> <https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.researchgate.net%2Fprofile%2FMd_Hossain107&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=IRK69rC%2F251zGT0Kpdo8jfHI1gkQhwoHxzYmozwiYKM%3D&amp;reserved=0>* | *ORCID iD
> <https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Forcid.org%2F0000-0003-3593-6936&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=XzQ51GyGR1tEB2iOG90cX9Np8pyeXSDBeeUpC0wDfEc%3D&amp;reserved=0>*
> 
>          [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=VD0EWkp1hKz%2FEKuJsGAsegL9K33y0S1L2O2jDzM6EsM%3D&amp;reserved=0
> PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=9wjGhM9eZTIbW6ANRoxzvEI%2BH6tHeSLbGwi7fuACKmE%3D&amp;reserved=0
> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=VD0EWkp1hKz%2FEKuJsGAsegL9K33y0S1L2O2jDzM6EsM%3D&amp;reserved=0
> PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=9wjGhM9eZTIbW6ANRoxzvEI%2BH6tHeSLbGwi7fuACKmE%3D&amp;reserved=0
> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Aug  4 17:29:28 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 4 Aug 2022 16:29:28 +0100
Subject: [R] Need help
In-Reply-To: <11045d05-ca3e-44b2-c5db-a23406423d60@sapo.pt>
References: <CAO29qn5UwzkmK1LdAfV9B5YsOiOKmVqYbq9-vVSk-26gz8F7yw@mail.gmail.com>
 <c6093753-6961-c5f2-4184-ad4f90db2a04@gmail.com>
 <CAO29qn6kLevZfJt1BrNN4KmcUR2sbFZdz5hZfFsQ-6041f9WCg@mail.gmail.com>
 <BN6PR2201MB1553335262E763DEB4E74B87CF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <BN6PR2201MB155371C158B850FA215EC97ACF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <BN6PR2201MB1553760A52B0CA15CA317BA9CF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <11045d05-ca3e-44b2-c5db-a23406423d60@sapo.pt>
Message-ID: <ba7e23c1-35d8-c45a-6034-248428814d4b@sapo.pt>

And for the sake of completeness


which(!ok)
sapply(out_list[!ok], conditionMessage)

Hope this helps,

Rui Barradas

?s 16:24 de 04/08/2022, Rui Barradas escreveu:
> Hello,
> 
> Like others have said, the root does depend on the seed but not by much.
> Here is a loop finding the roots for seeds from 1 to 10,000.
> 
> I have defined a variable n == 1000 instead of having the calls to rnorm 
> depend on a hard-coded constant.
> 
> 
> 
> ff <- function(zz){
>  ? inner = vector("numeric", length = s)
>  ? for(k in 1:s){
>  ??? inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
>  ? }
>  ? answer = mean(inner) - (1 - (1/r))
>  ? return(answer)
> }
> 
> n <- 1000
> s <- n
> lam <- 0.15
> thr <- 70
> r <- 10
> 
> up_lims <- 112.5?? # found by trial and error to be nice most
>  ?????????????????? # of the time, see mean(ok) below
> out_list <- vector("list", length = 1e4)
> 
> for(i in seq_along(out_list)) {
>  ? # give the user feedback
>  ? if(i %% 100 == 0) print(i)
> 
>  ? set.seed(i)
>  ? a <- rnorm(n, 110, 5)
>  ? b <- rnorm(n, -0.3, 0.4)
> 
>  ? out_list[[i]] <- tryCatch(
>  ??? uniroot(ff, lower = 0, upper = up_lims),
>  ??? error = function(e) e
>  ? )
> }
> 
> ok <- !sapply(out_list, inherits, 'error')
> mean(ok)
> #[1] 0.9978
> 
> root <- sapply(out_list[ok], '[[', 'root')
> hist(root)
> 
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 15:37 de 04/08/2022, Ebert,Timothy Aaron escreveu:
>> And one last edit.
>> Rstudio Environment shows out$root as 112. However, if I then print 
>> out$root I get 111.5303 which is much closer to the right answer.  
>> Entering values for ff, I can work out the answer to slightly more 
>> than 111.53030196.
>>
>> Regards,
>> Tim
>>
>> -----Original Message-----
>> From: Ebert,Timothy Aaron <tebert at ufl.edu>
>> Sent: Thursday, August 4, 2022 10:28 AM
>> To: Ebert,Timothy Aaron <tebert at ufl.edu>; Md. Moyazzem Hossain 
>> <hossainmm at juniv.edu>; J C Nash <profjcnash at gmail.com>
>> Cc: r-help mailing list <r-help at r-project.org>
>> Subject: RE: [R] Need help
>>
>> I wish I could edit my earlier reply.
>> ff(144.43) returns 0.03142121, but ff(144.44) returns NaN.
>> ff(12) returns -0.1468287
>>
>> out=uniroot(ff, lower=12, upper =144) does not have errors.
>> out is a list of 5.
>> $root is 112
>> $f.root is 1.09e-08
>> $iter is 5
>> $Init.it is NA
>> $estim.prec is 6.1e-05
>>
>> Is this working?
>>
>> Regards,
>> Tim
>>
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Ebert,Timothy 
>> Aaron
>> Sent: Thursday, August 4, 2022 10:09 AM
>> To: Md. Moyazzem Hossain <hossainmm at juniv.edu>; J C Nash 
>> <profjcnash at gmail.com>
>> Cc: r-help mailing list <r-help at r-project.org>
>> Subject: Re: [R] Need help
>>
>> [External Email]
>>
>> A few issues
>> 1) What does this function do? If you describe the problem and goal 
>> there might be a better answer. We appreciate seeing that you have 
>> attempted a solution, but you have trapped us all in blindly following 
>> your attempt.
>>
>> 2) This is an error checking phase of programming. Setting the seed is 
>> a good idea. Just remember to unset the seed after finishing the 
>> debugging phase.
>>
>> 3) In uniroot you call the function, but the function expects an 
>> argument (zz) that is not provided, and there is no default.
>>
>> 4) I set.seed(42), and entered ff(12) getting an answer of -0.1468287. 
>> Is this the expected result?
>>
>> Regards,
>> Tim
>>
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Md. Moyazzem 
>> Hossain
>> Sent: Thursday, August 4, 2022 9:50 AM
>> To: J C Nash <profjcnash at gmail.com>
>> Cc: r-help mailing list <r-help at r-project.org>
>> Subject: Re: [R] Need help
>>
>> [External Email]
>>
>> Dear JN,
>>
>> Thanks.
>>
>> I do not check whether the function actually crosses zero or not. 
>> However, by assumption, the value would be greater than zero.
>>
>> Hossain
>>
>> On Thu, Aug 4, 2022 at 2:40 PM J C Nash <profjcnash at gmail.com> wrote:
>>
>>> Have you checked that your function actually crosses zero?
>>>
>>> You should also set a seed if you want a reproducible result.
>>>
>>> JN
>>>
>>> On 2022-08-04 09:30, Md. Moyazzem Hossain wrote:
>>>> Dear R Experts,
>>>>
>>>> I hope that you are doing well.
>>>>
>>>> I am facing a problem to find out the value of the following
>>>> function. I need help in this regard.
>>>>
>>>> #####
>>>> a=rnorm(1000, 110, 5)
>>>> b = rnorm(1000, -0.3, 0.4)
>>>> s = length(a)
>>>> lam=0.15
>>>> thr=70
>>>> r= 10
>>>>
>>>> ff = function(zz){
>>>> ??? inner = vector("numeric", length = s)
>>>> ?????? for(k in 1:s){
>>>> ??????? inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
>>>> ??????????? }
>>>> ??? answer = mean(inner)- (1- (1/r))
>>>> ??? return(answer)
>>>> ??? }
>>>> ########
>>>> out=uniroot(ff, lower = 0, upper = 10000 )$root out
>>>>
>>>> ########### Error ########
>>>> Error in uniroot(ff, lower = 0, upper = 10000) :
>>>> ??? f.upper = f(upper) is NA
>>>>
>>>> Please help me. Thanks in advance.
>>>>
>>>> Take care.
>>>>
>>>> Hossain
>>>>
>>>
>>
>>
>> -- 
>> Best Regards,
>> Md. Moyazzem Hossain
>> Associate Professor
>> Department of Statistics
>> Jahangirnagar University
>> Savar, Dhaka-1342, Bangladesh
>> Website: 
>> https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.juniv.edu%2Fteachers%2Fhossainmm&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=3GVM6FLCtmP9oKjjtVzE0LZpI6LL8ldXknodpFQJUbM%3D&amp;reserved=0 
>>
>> Research: *[image: Google Scholar]
>> <https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fscholar.google.com%2Fcitations%3Fhl%3Den%26user%3D-U03XCgAAAAJ&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=8EfuEse2%2FnvwuZqvKskGXN4tLnM%2FDTA8XsU7nMma04c%3D&amp;reserved=0>* 
>> | *ResearchGate
>> <https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.researchgate.net%2Fprofile%2FMd_Hossain107&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=IRK69rC%2F251zGT0Kpdo8jfHI1gkQhwoHxzYmozwiYKM%3D&amp;reserved=0>* 
>> | *ORCID iD
>> <https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Forcid.org%2F0000-0003-3593-6936&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=XzQ51GyGR1tEB2iOG90cX9Np8pyeXSDBeeUpC0wDfEc%3D&amp;reserved=0>* 
>>
>>
>> ???????? [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=VD0EWkp1hKz%2FEKuJsGAsegL9K33y0S1L2O2jDzM6EsM%3D&amp;reserved=0 
>>
>> PLEASE do read the posting guide 
>> https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=9wjGhM9eZTIbW6ANRoxzvEI%2BH6tHeSLbGwi7fuACKmE%3D&amp;reserved=0 
>>
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=VD0EWkp1hKz%2FEKuJsGAsegL9K33y0S1L2O2jDzM6EsM%3D&amp;reserved=0 
>>
>> PLEASE do read the posting guide 
>> https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=9wjGhM9eZTIbW6ANRoxzvEI%2BH6tHeSLbGwi7fuACKmE%3D&amp;reserved=0 
>>
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From pro|jcn@@h @end|ng |rom gm@||@com  Thu Aug  4 17:32:07 2022
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Thu, 4 Aug 2022 11:32:07 -0400
Subject: [R] Need help
In-Reply-To: <11045d05-ca3e-44b2-c5db-a23406423d60@sapo.pt>
References: <CAO29qn5UwzkmK1LdAfV9B5YsOiOKmVqYbq9-vVSk-26gz8F7yw@mail.gmail.com>
 <c6093753-6961-c5f2-4184-ad4f90db2a04@gmail.com>
 <CAO29qn6kLevZfJt1BrNN4KmcUR2sbFZdz5hZfFsQ-6041f9WCg@mail.gmail.com>
 <BN6PR2201MB1553335262E763DEB4E74B87CF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <BN6PR2201MB155371C158B850FA215EC97ACF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <BN6PR2201MB1553760A52B0CA15CA317BA9CF9F9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <11045d05-ca3e-44b2-c5db-a23406423d60@sapo.pt>
Message-ID: <2634d844-8895-1800-5b0f-d8e4c60d72b7@gmail.com>

FWIW, package Rmpfr has unirootR which Martin Maechler included after I coded a version of zeroin
in pure R at UseR2011. (There was a long session in biostats that was a bit outside my area, and ...)

Sometimes useful when high precision necessary.

JN


On 2022-08-04 11:24, Rui Barradas wrote:
> Hello,
> 
> Like others have said, the root does depend on the seed but not by much.
> Here is a loop finding the roots for seeds from 1 to 10,000.
> 
> I have defined a variable n == 1000 instead of having the calls to rnorm depend on a hard-coded constant.
> 
> 
> 
> ff <- function(zz){
>  ? inner = vector("numeric", length = s)
>  ? for(k in 1:s){
>  ??? inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
>  ? }
>  ? answer = mean(inner) - (1 - (1/r))
>  ? return(answer)
> }
> 
> n <- 1000
> s <- n
> lam <- 0.15
> thr <- 70
> r <- 10
> 
> up_lims <- 112.5?? # found by trial and error to be nice most
>  ?????????????????? # of the time, see mean(ok) below
> out_list <- vector("list", length = 1e4)
> 
> for(i in seq_along(out_list)) {
>  ? # give the user feedback
>  ? if(i %% 100 == 0) print(i)
> 
>  ? set.seed(i)
>  ? a <- rnorm(n, 110, 5)
>  ? b <- rnorm(n, -0.3, 0.4)
> 
>  ? out_list[[i]] <- tryCatch(
>  ??? uniroot(ff, lower = 0, upper = up_lims),
>  ??? error = function(e) e
>  ? )
> }
> 
> ok <- !sapply(out_list, inherits, 'error')
> mean(ok)
> #[1] 0.9978
> 
> root <- sapply(out_list[ok], '[[', 'root')
> hist(root)
> 
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 15:37 de 04/08/2022, Ebert,Timothy Aaron escreveu:
>> And one last edit.
>> Rstudio Environment shows out$root as 112. However, if I then print out$root I get 111.5303 which is much closer to 
>> the right answer.? Entering values for ff, I can work out the answer to slightly more than 111.53030196.
>>
>> Regards,
>> Tim
>>
>> -----Original Message-----
>> From: Ebert,Timothy Aaron <tebert at ufl.edu>
>> Sent: Thursday, August 4, 2022 10:28 AM
>> To: Ebert,Timothy Aaron <tebert at ufl.edu>; Md. Moyazzem Hossain <hossainmm at juniv.edu>; J C Nash <profjcnash at gmail.com>
>> Cc: r-help mailing list <r-help at r-project.org>
>> Subject: RE: [R] Need help
>>
>> I wish I could edit my earlier reply.
>> ff(144.43) returns 0.03142121, but ff(144.44) returns NaN.
>> ff(12) returns -0.1468287
>>
>> out=uniroot(ff, lower=12, upper =144) does not have errors.
>> out is a list of 5.
>> $root is 112
>> $f.root is 1.09e-08
>> $iter is 5
>> $Init.it is NA
>> $estim.prec is 6.1e-05
>>
>> Is this working?
>>
>> Regards,
>> Tim
>>
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Ebert,Timothy Aaron
>> Sent: Thursday, August 4, 2022 10:09 AM
>> To: Md. Moyazzem Hossain <hossainmm at juniv.edu>; J C Nash <profjcnash at gmail.com>
>> Cc: r-help mailing list <r-help at r-project.org>
>> Subject: Re: [R] Need help
>>
>> [External Email]
>>
>> A few issues
>> 1) What does this function do? If you describe the problem and goal there might be a better answer. We appreciate 
>> seeing that you have attempted a solution, but you have trapped us all in blindly following your attempt.
>>
>> 2) This is an error checking phase of programming. Setting the seed is a good idea. Just remember to unset the seed 
>> after finishing the debugging phase.
>>
>> 3) In uniroot you call the function, but the function expects an argument (zz) that is not provided, and there is no 
>> default.
>>
>> 4) I set.seed(42), and entered ff(12) getting an answer of -0.1468287. Is this the expected result?
>>
>> Regards,
>> Tim
>>
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Md. Moyazzem Hossain
>> Sent: Thursday, August 4, 2022 9:50 AM
>> To: J C Nash <profjcnash at gmail.com>
>> Cc: r-help mailing list <r-help at r-project.org>
>> Subject: Re: [R] Need help
>>
>> [External Email]
>>
>> Dear JN,
>>
>> Thanks.
>>
>> I do not check whether the function actually crosses zero or not. However, by assumption, the value would be greater 
>> than zero.
>>
>> Hossain
>>
>> On Thu, Aug 4, 2022 at 2:40 PM J C Nash <profjcnash at gmail.com> wrote:
>>
>>> Have you checked that your function actually crosses zero?
>>>
>>> You should also set a seed if you want a reproducible result.
>>>
>>> JN
>>>
>>> On 2022-08-04 09:30, Md. Moyazzem Hossain wrote:
>>>> Dear R Experts,
>>>>
>>>> I hope that you are doing well.
>>>>
>>>> I am facing a problem to find out the value of the following
>>>> function. I need help in this regard.
>>>>
>>>> #####
>>>> a=rnorm(1000, 110, 5)
>>>> b = rnorm(1000, -0.3, 0.4)
>>>> s = length(a)
>>>> lam=0.15
>>>> thr=70
>>>> r= 10
>>>>
>>>> ff = function(zz){
>>>> ??? inner = vector("numeric", length = s)
>>>> ?????? for(k in 1:s){
>>>> ??????? inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
>>>> ??????????? }
>>>> ??? answer = mean(inner)- (1- (1/r))
>>>> ??? return(answer)
>>>> ??? }
>>>> ########
>>>> out=uniroot(ff, lower = 0, upper = 10000 )$root out
>>>>
>>>> ########### Error ########
>>>> Error in uniroot(ff, lower = 0, upper = 10000) :
>>>> ??? f.upper = f(upper) is NA
>>>>
>>>> Please help me. Thanks in advance.
>>>>
>>>> Take care.
>>>>
>>>> Hossain
>>>>
>>>
>>
>>
>> -- 
>> Best Regards,
>> Md. Moyazzem Hossain
>> Associate Professor
>> Department of Statistics
>> Jahangirnagar University
>> Savar, Dhaka-1342, Bangladesh
>> Website: 
>> https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.juniv.edu%2Fteachers%2Fhossainmm&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=3GVM6FLCtmP9oKjjtVzE0LZpI6LL8ldXknodpFQJUbM%3D&amp;reserved=0 
>>
>> Research: *[image: Google Scholar]
>> <https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fscholar.google.com%2Fcitations%3Fhl%3Den%26user%3D-U03XCgAAAAJ&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=8EfuEse2%2FnvwuZqvKskGXN4tLnM%2FDTA8XsU7nMma04c%3D&amp;reserved=0>* 
>> | *ResearchGate
>> <https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.researchgate.net%2Fprofile%2FMd_Hossain107&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=IRK69rC%2F251zGT0Kpdo8jfHI1gkQhwoHxzYmozwiYKM%3D&amp;reserved=0>* 
>> | *ORCID iD
>> <https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Forcid.org%2F0000-0003-3593-6936&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=XzQ51GyGR1tEB2iOG90cX9Np8pyeXSDBeeUpC0wDfEc%3D&amp;reserved=0>* 
>>
>>
>> ???????? [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=VD0EWkp1hKz%2FEKuJsGAsegL9K33y0S1L2O2jDzM6EsM%3D&amp;reserved=0 
>>
>> PLEASE do read the posting guide 
>> https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=9wjGhM9eZTIbW6ANRoxzvEI%2BH6tHeSLbGwi7fuACKmE%3D&amp;reserved=0 
>>
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=VD0EWkp1hKz%2FEKuJsGAsegL9K33y0S1L2O2jDzM6EsM%3D&amp;reserved=0 
>>
>> PLEASE do read the posting guide 
>> https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7C92190c03aa824920e8a108da76258618%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C637952200791209718%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=9wjGhM9eZTIbW6ANRoxzvEI%2BH6tHeSLbGwi7fuACKmE%3D&amp;reserved=0 
>>
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From @vi@e@gross m@iii@g oii gm@ii@com  Thu Aug  4 18:08:12 2022
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Thu, 4 Aug 2022 12:08:12 -0400
Subject: [R] Need help
In-Reply-To: <00af01d8a81c$37251f40$a56f5dc0$@gmail.com>
References: <CAO29qn5UwzkmK1LdAfV9B5YsOiOKmVqYbq9-vVSk-26gz8F7yw@mail.gmail.com>
 <00af01d8a81c$37251f40$a56f5dc0$@gmail.com>
Message-ID: <00b101d8a81c$66167c90$324375b0$@gmail.com>


Another exceedingly polite questioner. Cultural differences!

I think we can skip discussing if we are doing well, and get to the point.

To start with, I got thrown by these two lines:

a=rnorm(1000, 110, 5)
s = length(a)

This does not relate to the difficulty, but is a sort of sloppy use as a was
created with a request to be 1,000 random numbers. No need to calculate the
length. You could just say 

s <- 1000

We have no idea what the purpose of your function ff is meant to be used for
and what it is normally given as an argument as you seem to just pass the
function as an argument to a stats package function called uniroot. As such,
the function should return values for a given argument that can be evaluated
between lower and upper bounds. OK, it took some time to look things up that
would have been easier had you told us a bit more.
 
But it gets worse as your function references "s" in this line within:

inner = vector("numeric", length = s)

You are not passing s to the function but using it from outside to make an
empty variable of the same length? Similarly, you are putting other
variables like r, lam, thr  in a global environment and using it within the
function. Is this a good design?

As other have pointed out, you should evaluate the function ff to see what
it returns on it's own, not wait for uniroot to fail in calling it.

Your function ff seems to make a vector of 1,000 complicated values based on
the global values including the values in "a" and 'b" that are random then
take the mean of the results with an adjustment.  I have no idea if your
code is modeled after anything in particular or is correct. But I exercised
it in the lower range and it produces reasonable numbers:

sapply(0:10,ff)
 [1] -0.1715207 -0.1693173 -0.1671317 -0.1649635 -0.1628125 -0.1606784
-0.1585609 -0.1564598
 [9] -0.1543749 -0.1523059 -0.1502526

But in the upper range your function returns a NaN or NOT A NUMBER

sapply(9995:10000,ff)
[1] NaN NaN NaN NaN NaN NaN

That would explain the error message.

So you need to look at ff and see how the NaN is introduced perhaps just for
larger numbers. You may have an overflow problem for example where you are
making number too large to fit. Who knows?

What I know is when I make your 10,001 calculations only the first 140 or so
are not Nan. ff(142) and beyond all fail.

> sapply(0:10000,ff) -> temp
> sum(is.nan(temp))
[1] 9859

So it may be obvious to you why zz-thr has such a threshold, but not to me.

I would try to make sure you implemented the algorithm required correctly in
the code and that the range of random numbers you select fits the needs. If
you can get ff() to return only valid numbers, it may be a step. And note
that when I change the mean() function you call to add na.rm=TRUE, it
removes the NaN from the calculation (albeit that should not mean it is now
correct) and a new error shows up:

> ff = function(zz){
+     inner = vector("numeric", length = s)
+     for(k in 1:s){
+         inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
+     }
+     answer = mean(inner, na.rm=TRUE)- (1- (1/r))
+     return(answer)
+ }

> out=uniroot(ff, lower = 0, upper = 10000 )$root out
Error: unexpected symbol in "out=uniroot(ff, lower = 0, upper = 10000 )$root
out"

You left a dangling " out" at the end. You may mean:

out=uniroot(ff, lower = 0, upper = 10000 )$root

My current result is 111.6597 but as noted is meaningless as I threw out
lots of NaN.



-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Md. Moyazzem
Hossain
Sent: Thursday, August 4, 2022 9:31 AM
To: r-help mailing list <r-help at r-project.org>
Subject: [R] Need help

Dear R Experts,

I hope that you are doing well.

I am facing a problem to find out the value of the following function. I
need help in this regard.

#####
a=rnorm(1000, 110, 5)
b = rnorm(1000, -0.3, 0.4)
s = length(a)
lam=0.15
thr=70
r= 10

ff = function(zz){
  inner = vector("numeric", length = s)
     for(k in 1:s){
      inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
          }
  answer = mean(inner)- (1- (1/r))
  return(answer)
  }
########
out=uniroot(ff, lower = 0, upper = 10000 )$root out

########### Error ########
Error in uniroot(ff, lower = 0, upper = 10000) :
  f.upper = f(upper) is NA

Please help me. Thanks in advance.

Take care.

Hossain

--
Best Regards,
Md. Moyazzem Hossain
Associate Professor
Department of Statistics
Jahangirnagar University
Savar, Dhaka-1342, Bangladesh

	[[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From ho@@@|nmm @end|ng |rom jun|v@edu  Thu Aug  4 21:05:34 2022
From: ho@@@|nmm @end|ng |rom jun|v@edu (Md. Moyazzem Hossain)
Date: Thu, 4 Aug 2022 20:05:34 +0100
Subject: [R] Need help
In-Reply-To: <3489b6ec-4ad3-d510-8d75-26b85bc8245a@mcmaster.ca>
References: <CAO29qn5UwzkmK1LdAfV9B5YsOiOKmVqYbq9-vVSk-26gz8F7yw@mail.gmail.com>
 <c6093753-6961-c5f2-4184-ad4f90db2a04@gmail.com>
 <29425_1659621083_274DpMYL008226_CAO29qn6kLevZfJt1BrNN4KmcUR2sbFZdz5hZfFsQ-6041f9WCg@mail.gmail.com>
 <3489b6ec-4ad3-d510-8d75-26b85bc8245a@mcmaster.ca>
Message-ID: <CAO29qn4-hPagCaw05qXt7A8hF+5ZOH7xPDxLkue2z_0=5pK9=g@mail.gmail.com>

Dear John

Thank you very much for your feedback.

Take care.

Hossain

On Thu, Aug 4, 2022 at 3:01 PM John Fox <jfox at mcmaster.ca> wrote:

> Dear Hossain,
>
> Did you look at the values that your function returns? As John Nash
> pointed out, these values presumably depend on the random values of a and
> b.
>
> I tried the following:
>
> set.seed(123) # for reproducibility
> a=rnorm(1000, 110, 5)
> b = rnorm(1000, -0.3, 0.4)
> s = length(a)
> lam=0.15
> thr=70
> r= 10
>
> ff = function(zz){
>    inner = vector("numeric", length = s)
>    for(k in 1:s){
>      inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
>    }
>    answer = mean(inner)- (1- (1/r))
>    return(answer)
> }
>
> res <- sapply(0:10000, ff)
> res[1:500]
> plot(0:150, res[1:151], type="l")
>
>
> It was quickly clear that ff() produces NaNs for all but the smallest
> values of zz.
>
> Beyond this fact, it's unclear to me what the purpose of the computation
> is. In the short domain where it produces numbers, the function returns
> both negative and positive values (for my values of a and b) -- that is,
> does cross 0 -- and if it did not, it would be nonsense to look for roots.
>
> I hope this helps,
>   John
>
>
> On 2022-08-04 9:49 a.m., Md. Moyazzem Hossain wrote:
> > Dear JN,
> >
> > Thanks.
> >
> > I do not check whether the function actually crosses zero or not.
> However,
> > by assumption, the value would be greater than zero.
> >
> > Hossain
> >
> > On Thu, Aug 4, 2022 at 2:40 PM J C Nash <profjcnash at gmail.com> wrote:
> >
> >> Have you checked that your function actually crosses zero?
> >>
> >> You should also set a seed if you want a reproducible result.
> >>
> >> JN
> >>
> >> On 2022-08-04 09:30, Md. Moyazzem Hossain wrote:
> >>> Dear R Experts,
> >>>
> >>> I hope that you are doing well.
> >>>
> >>> I am facing a problem to find out the value of the following function.
> I
> >>> need help in this regard.
> >>>
> >>> #####
> >>> a=rnorm(1000, 110, 5)
> >>> b = rnorm(1000, -0.3, 0.4)
> >>> s = length(a)
> >>> lam=0.15
> >>> thr=70
> >>> r= 10
> >>>
> >>> ff = function(zz){
> >>>     inner = vector("numeric", length = s)
> >>>        for(k in 1:s){
> >>>         inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
> >>>             }
> >>>     answer = mean(inner)- (1- (1/r))
> >>>     return(answer)
> >>>     }
> >>> ########
> >>> out=uniroot(ff, lower = 0, upper = 10000 )$root
> >>> out
> >>>
> >>> ########### Error ########
> >>> Error in uniroot(ff, lower = 0, upper = 10000) :
> >>>     f.upper = f(upper) is NA
> >>>
> >>> Please help me. Thanks in advance.
> >>>
> >>> Take care.
> >>>
> >>> Hossain
> >>>
> >>
> >
> >
> --
> John Fox, Professor Emeritus
> McMaster University
> Hamilton, Ontario, Canada
> web: https://socialsciences.mcmaster.ca/jfox/
>
>

-- 
Best Regards,
Md. Moyazzem Hossain
Associate Professor
Department of Statistics
Jahangirnagar University
Savar, Dhaka-1342, Bangladesh
Website: http://www.juniv.edu/teachers/hossainmm
Research: *[image: Google Scholar]
<https://scholar.google.com/citations?hl=en&user=-U03XCgAAAAJ>* | *ResearchGate
<https://www.researchgate.net/profile/Md_Hossain107>* | *ORCID iD
<https://orcid.org/0000-0003-3593-6936>*

	[[alternative HTML version deleted]]


From r@turner @end|ng |rom @uck|@nd@@c@nz  Fri Aug  5 03:34:13 2022
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Fri, 5 Aug 2022 13:34:13 +1200
Subject: [R] Need help
In-Reply-To: <00b101d8a81c$66167c90$324375b0$@gmail.com>
References: <CAO29qn5UwzkmK1LdAfV9B5YsOiOKmVqYbq9-vVSk-26gz8F7yw@mail.gmail.com>
 <00af01d8a81c$37251f40$a56f5dc0$@gmail.com>
 <00b101d8a81c$66167c90$324375b0$@gmail.com>
Message-ID: <20220805133413.719cda3e@rolf-Latitude-E7470>


On Thu, 4 Aug 2022 12:08:12 -0400
<avi.e.gross at gmail.com> wrote:

> 
> Another exceedingly polite questioner. Cultural differences!
> 
> I think we can skip discussing if we are doing well, and get to the
> point.

<SNIP>

Moreover, it would be considerate to provide a more informative subject
than "Need help".


See fortunes::fortune(285).

cheers,

Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From ho@@@|nmm @end|ng |rom jun|v@edu  Fri Aug  5 21:40:13 2022
From: ho@@@|nmm @end|ng |rom jun|v@edu (Md. Moyazzem Hossain)
Date: Fri, 5 Aug 2022 20:40:13 +0100
Subject: [R] Need help
In-Reply-To: <CAPcHnpRA0YhCG5vg3qFsSb--bGVgca344wAbe0Eh2uY6euGmDw@mail.gmail.com>
References: <CAO29qn5UwzkmK1LdAfV9B5YsOiOKmVqYbq9-vVSk-26gz8F7yw@mail.gmail.com>
 <CAPcHnpTN7te34OZbFRTHqdChjcyfecrVOvah0xnUk0wcvSKzTw@mail.gmail.com>
 <CAO29qn6G4A2SGihVCyyowQ3uPwC=vur6guNk3YPkZXGs=iWJYA@mail.gmail.com>
 <CAPcHnpRA0YhCG5vg3qFsSb--bGVgca344wAbe0Eh2uY6euGmDw@mail.gmail.com>
Message-ID: <CAO29qn7GqP0By8zEQpTH_8rZb_4CPUfby2-x0KVYeDm6GFgd-A@mail.gmail.com>

Dear All,

Thank you very much for all of your help. If anyone feels unhappy with my
words then I apologize.

Actually, I am not an expert user as a result my coding seems to be wrong
on some points. Now, it is working.

I am thankful to all of you for your kind support. Take care.

Hossain



On Fri, Aug 5, 2022 at 4:27 AM Andrew Simmons <akwsimmo at gmail.com> wrote:

> Hello again,
>
>
> Since the GEV distribution and the GPD distribution are similar, I was
> able to make dgpd, pgpd, qgpd, and rgpd with no trouble. You should be able
> to use the same piece of code I gave earlier to install the package, here
> it is again:
>
> install.packages(c("this.path", "essentials"), repos = "
> https://raw.githubusercontent.com/ArcadeAntics/PACKAGES")
>
> I tried to make your code a little nicer and also use 'pgpd', let me know
> if this behaves as expected.
>
> #####
> library(essentials)
> a <- rnorm(1000, 110, 5)
> b <- rnorm(1000, -0.3, 0.4)
> s <- length(a)
> lam <- 0.15
> thr <- 70
> r <- 10
>
> ff <- function(zz) {
>     inner <- numeric(s)
>     for (k in 1:s) {
>         inner[k] <- 1 - lam * pgpd(zz, location = thr, scale = a[k], shape
> = b[k], lower.tail = FALSE)
>     }
>
>
>     # if zz is length 1 (it is for uniroot), it would be much faster to do
> this:
>     # inner <- 1 - lam * pgpd(zz, location = thr, scale = a, shape = b,
> lower.tail = FALSE)
>     #
>     # use whichever you please
>
>     mean(inner) - (1 - 1/r)
> }
> ########
> out <- uniroot(ff, lower = 0, upper = 10000)$root
> out
>
> On Thu, Aug 4, 2022 at 3:17 PM Md. Moyazzem Hossain <hossainmm at juniv.edu>
> wrote:
>
>> Dear Andrew Simmons,
>>
>> Thank you very much.
>>
>> Actually, I want to calculate the predictive return level of GPD and
>> compare it with the return level to see the difference. I have used the
>> following function before but it does not provide the results as expected.
>> It is OK for GEV but not GPD.
>>
>>         inner[k] = pgpd(zz, scale = a[k],  shape = b[k] )
>>
>> Other lines of the code were the same.
>>
>> Please help me to calculate the predictive return level of GPD.
>>
>> Thanks in advance.
>>
>> Hossain
>>
>> On Thu, Aug 4, 2022 at 5:11 PM Andrew Simmons <akwsimmo at gmail.com> wrote:
>>
>>> Is this a GEV distribution by chance? If so, I made functions dgev,
>>> pgev, qgev, and rgev that you can find install with:
>>>
>>> install.packages(c("this.path", "essentials"), repos = "
>>> https://raw.githubusercontent.com/ArcadeAntics/PACKAGES")
>>>
>>> and then in your R script
>>>
>>> library(essentials)
>>> dgev(...) or pgev or qgev as needed
>>>
>>> On Thu, Aug 4, 2022, 09:31 Md. Moyazzem Hossain <hossainmm at juniv.edu>
>>> wrote:
>>>
>>>> Dear R Experts,
>>>>
>>>> I hope that you are doing well.
>>>>
>>>> I am facing a problem to find out the value of the following function. I
>>>> need help in this regard.
>>>>
>>>> #####
>>>> a=rnorm(1000, 110, 5)
>>>> b = rnorm(1000, -0.3, 0.4)
>>>> s = length(a)
>>>> lam=0.15
>>>> thr=70
>>>> r= 10
>>>>
>>>> ff = function(zz){
>>>>   inner = vector("numeric", length = s)
>>>>      for(k in 1:s){
>>>>       inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
>>>>           }
>>>>   answer = mean(inner)- (1- (1/r))
>>>>   return(answer)
>>>>   }
>>>> ########
>>>> out=uniroot(ff, lower = 0, upper = 10000 )$root
>>>> out
>>>>
>>>> ########### Error ########
>>>> Error in uniroot(ff, lower = 0, upper = 10000) :
>>>>   f.upper = f(upper) is NA
>>>>
>>>> Please help me. Thanks in advance.
>>>>
>>>> Take care.
>>>>
>>>> Hossain
>>>>
>>>> --
>>>> Best Regards,
>>>> Md. Moyazzem Hossain
>>>> Associate Professor
>>>> Department of Statistics
>>>> Jahangirnagar University
>>>> Savar, Dhaka-1342, Bangladesh
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>>
>>
>> --
>> Best Regards,
>> Md. Moyazzem Hossain
>> Associate Professor
>> Department of Statistics
>> Jahangirnagar University
>> Savar, Dhaka-1342, Bangladesh
>> Website: http://www.juniv.edu/teachers/hossainmm
>> Research: *[image: Google Scholar]
>> <https://scholar.google.com/citations?hl=en&user=-U03XCgAAAAJ>* | *ResearchGate
>> <https://www.researchgate.net/profile/Md_Hossain107>* | *ORCID iD
>> <https://orcid.org/0000-0003-3593-6936>*
>>
>

-- 
Best Regards,
Md. Moyazzem Hossain
Associate Professor
Department of Statistics
Jahangirnagar University
Savar, Dhaka-1342, Bangladesh
Website: http://www.juniv.edu/teachers/hossainmm
Research: *[image: Google Scholar]
<https://scholar.google.com/citations?hl=en&user=-U03XCgAAAAJ>* | *ResearchGate
<https://www.researchgate.net/profile/Md_Hossain107>* | *ORCID iD
<https://orcid.org/0000-0003-3593-6936>*

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Fri Aug  5 21:58:52 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Fri, 5 Aug 2022 20:58:52 +0100
Subject: [R] Need help
In-Reply-To: <CAO29qn7GqP0By8zEQpTH_8rZb_4CPUfby2-x0KVYeDm6GFgd-A@mail.gmail.com>
References: <CAO29qn5UwzkmK1LdAfV9B5YsOiOKmVqYbq9-vVSk-26gz8F7yw@mail.gmail.com>
 <CAPcHnpTN7te34OZbFRTHqdChjcyfecrVOvah0xnUk0wcvSKzTw@mail.gmail.com>
 <CAO29qn6G4A2SGihVCyyowQ3uPwC=vur6guNk3YPkZXGs=iWJYA@mail.gmail.com>
 <CAPcHnpRA0YhCG5vg3qFsSb--bGVgca344wAbe0Eh2uY6euGmDw@mail.gmail.com>
 <CAO29qn7GqP0By8zEQpTH_8rZb_4CPUfby2-x0KVYeDm6GFgd-A@mail.gmail.com>
Message-ID: <cf052c3a-ebe2-2c02-12c9-b2b9a0b0ae08@sapo.pt>

Hello,

Inline.

?s 20:40 de 05/08/2022, Md. Moyazzem Hossain escreveu:
> Dear All,
> 
> Thank you very much for all of your help. If anyone feels unhappy with my
> words then I apologize.

You're welcome. Anytime. Your question shows a real use case problem and 
those are the good questions.

> 
> Actually, I am not an expert user as a result my coding seems to be wrong
> on some points. Now, it is working.

Glad it helped.

Rui Barradas

> 
> I am thankful to all of you for your kind support. Take care.
> 
> Hossain
> 
> 
> 
> On Fri, Aug 5, 2022 at 4:27 AM Andrew Simmons <akwsimmo at gmail.com> wrote:
> 
>> Hello again,
>>
>>
>> Since the GEV distribution and the GPD distribution are similar, I was
>> able to make dgpd, pgpd, qgpd, and rgpd with no trouble. You should be able
>> to use the same piece of code I gave earlier to install the package, here
>> it is again:
>>
>> install.packages(c("this.path", "essentials"), repos = "
>> https://raw.githubusercontent.com/ArcadeAntics/PACKAGES")
>>
>> I tried to make your code a little nicer and also use 'pgpd', let me know
>> if this behaves as expected.
>>
>> #####
>> library(essentials)
>> a <- rnorm(1000, 110, 5)
>> b <- rnorm(1000, -0.3, 0.4)
>> s <- length(a)
>> lam <- 0.15
>> thr <- 70
>> r <- 10
>>
>> ff <- function(zz) {
>>      inner <- numeric(s)
>>      for (k in 1:s) {
>>          inner[k] <- 1 - lam * pgpd(zz, location = thr, scale = a[k], shape
>> = b[k], lower.tail = FALSE)
>>      }
>>
>>
>>      # if zz is length 1 (it is for uniroot), it would be much faster to do
>> this:
>>      # inner <- 1 - lam * pgpd(zz, location = thr, scale = a, shape = b,
>> lower.tail = FALSE)
>>      #
>>      # use whichever you please
>>
>>      mean(inner) - (1 - 1/r)
>> }
>> ########
>> out <- uniroot(ff, lower = 0, upper = 10000)$root
>> out
>>
>> On Thu, Aug 4, 2022 at 3:17 PM Md. Moyazzem Hossain <hossainmm at juniv.edu>
>> wrote:
>>
>>> Dear Andrew Simmons,
>>>
>>> Thank you very much.
>>>
>>> Actually, I want to calculate the predictive return level of GPD and
>>> compare it with the return level to see the difference. I have used the
>>> following function before but it does not provide the results as expected.
>>> It is OK for GEV but not GPD.
>>>
>>>          inner[k] = pgpd(zz, scale = a[k],  shape = b[k] )
>>>
>>> Other lines of the code were the same.
>>>
>>> Please help me to calculate the predictive return level of GPD.
>>>
>>> Thanks in advance.
>>>
>>> Hossain
>>>
>>> On Thu, Aug 4, 2022 at 5:11 PM Andrew Simmons <akwsimmo at gmail.com> wrote:
>>>
>>>> Is this a GEV distribution by chance? If so, I made functions dgev,
>>>> pgev, qgev, and rgev that you can find install with:
>>>>
>>>> install.packages(c("this.path", "essentials"), repos = "
>>>> https://raw.githubusercontent.com/ArcadeAntics/PACKAGES")
>>>>
>>>> and then in your R script
>>>>
>>>> library(essentials)
>>>> dgev(...) or pgev or qgev as needed
>>>>
>>>> On Thu, Aug 4, 2022, 09:31 Md. Moyazzem Hossain <hossainmm at juniv.edu>
>>>> wrote:
>>>>
>>>>> Dear R Experts,
>>>>>
>>>>> I hope that you are doing well.
>>>>>
>>>>> I am facing a problem to find out the value of the following function. I
>>>>> need help in this regard.
>>>>>
>>>>> #####
>>>>> a=rnorm(1000, 110, 5)
>>>>> b = rnorm(1000, -0.3, 0.4)
>>>>> s = length(a)
>>>>> lam=0.15
>>>>> thr=70
>>>>> r= 10
>>>>>
>>>>> ff = function(zz){
>>>>>    inner = vector("numeric", length = s)
>>>>>       for(k in 1:s){
>>>>>        inner[k]=(1- lam*((1+b[k]*((zz-thr)/a[k]))^(-1/b[k])))
>>>>>            }
>>>>>    answer = mean(inner)- (1- (1/r))
>>>>>    return(answer)
>>>>>    }
>>>>> ########
>>>>> out=uniroot(ff, lower = 0, upper = 10000 )$root
>>>>> out
>>>>>
>>>>> ########### Error ########
>>>>> Error in uniroot(ff, lower = 0, upper = 10000) :
>>>>>    f.upper = f(upper) is NA
>>>>>
>>>>> Please help me. Thanks in advance.
>>>>>
>>>>> Take care.
>>>>>
>>>>> Hossain
>>>>>
>>>>> --
>>>>> Best Regards,
>>>>> Md. Moyazzem Hossain
>>>>> Associate Professor
>>>>> Department of Statistics
>>>>> Jahangirnagar University
>>>>> Savar, Dhaka-1342, Bangladesh
>>>>>
>>>>>          [[alternative HTML version deleted]]
>>>>>
>>>>> ______________________________________________
>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>> PLEASE do read the posting guide
>>>>> http://www.R-project.org/posting-guide.html
>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>>
>>>>
>>>
>>> --
>>> Best Regards,
>>> Md. Moyazzem Hossain
>>> Associate Professor
>>> Department of Statistics
>>> Jahangirnagar University
>>> Savar, Dhaka-1342, Bangladesh
>>> Website: http://www.juniv.edu/teachers/hossainmm
>>> Research: *[image: Google Scholar]
>>> <https://scholar.google.com/citations?hl=en&user=-U03XCgAAAAJ>* | *ResearchGate
>>> <https://www.researchgate.net/profile/Md_Hossain107>* | *ORCID iD
>>> <https://orcid.org/0000-0003-3593-6936>*
>>>
>>
>


From er|nm@hodge@@ @end|ng |rom gm@||@com  Sun Aug  7 02:15:43 2022
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Sat, 6 Aug 2022 20:15:43 -0400
Subject: [R] Reading a CSV file
Message-ID: <CACxE24na6zZ=S5U0jD1VnTvbp38gtGTi-QWejPb_YyYFNO-Obg@mail.gmail.com>

Hello!

Is there a way to read the first line of a CSV file, then skip 4 lines,
then continue reading, please?

I know you can skip from the top, but I don't know if you can read and then
skip.

Thanks,
Erin


Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sun Aug  7 02:51:12 2022
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sun, 7 Aug 2022 02:51:12 +0200
Subject: [R] Reading a CSV file
In-Reply-To: <CACxE24na6zZ=S5U0jD1VnTvbp38gtGTi-QWejPb_YyYFNO-Obg@mail.gmail.com>
References: <CACxE24na6zZ=S5U0jD1VnTvbp38gtGTi-QWejPb_YyYFNO-Obg@mail.gmail.com>
Message-ID: <88b129f8-3d41-ecb6-0c53-3c111f6c236b@statistik.tu-dortmund.de>

csv <- readLines(filename)
read.csv(text = csv[-(2:5)]

Best,
Uwe Ligges


On 07.08.2022 02:15, Erin Hodgess wrote:
> Hello!
> 
> Is there a way to read the first line of a CSV file, then skip 4 lines,
> then continue reading, please?
> 
> I know you can skip from the top, but I don't know if you can read and then
> skip.
> 
> Thanks,
> Erin
> 
> 
> Erin Hodgess, PhD
> mailto: erinm.hodgess at gmail.com
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From er|nm@hodge@@ @end|ng |rom gm@||@com  Sun Aug  7 02:51:34 2022
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Sat, 6 Aug 2022 20:51:34 -0400
Subject: [R] Reading a CSV file
In-Reply-To: <88b129f8-3d41-ecb6-0c53-3c111f6c236b@statistik.tu-dortmund.de>
References: <CACxE24na6zZ=S5U0jD1VnTvbp38gtGTi-QWejPb_YyYFNO-Obg@mail.gmail.com>
 <88b129f8-3d41-ecb6-0c53-3c111f6c236b@statistik.tu-dortmund.de>
Message-ID: <CACxE24k+RNF_peQXuevrWTWQrW0_iEd-yVPpJEVvg1uyHocGXA@mail.gmail.com>

Awesome!  Thanks so much!

On Sat, Aug 6, 2022 at 8:51 PM Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

> csv <- readLines(filename)
> read.csv(text = csv[-(2:5)]
>
> Best,
> Uwe Ligges
>
>
> On 07.08.2022 02:15, Erin Hodgess wrote:
> > Hello!
> >
> > Is there a way to read the first line of a CSV file, then skip 4 lines,
> > then continue reading, please?
> >
> > I know you can skip from the top, but I don't know if you can read and
> then
> > skip.
> >
> > Thanks,
> > Erin
> >
> >
> > Erin Hodgess, PhD
> > mailto: erinm.hodgess at gmail.com
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
-- 
Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From drj|m|emon @end|ng |rom gm@||@com  Sun Aug  7 02:53:33 2022
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Sun, 7 Aug 2022 10:53:33 +1000
Subject: [R] Reading a CSV file
In-Reply-To: <CACxE24na6zZ=S5U0jD1VnTvbp38gtGTi-QWejPb_YyYFNO-Obg@mail.gmail.com>
References: <CACxE24na6zZ=S5U0jD1VnTvbp38gtGTi-QWejPb_YyYFNO-Obg@mail.gmail.com>
Message-ID: <CA+8X3fUoz_UGFE9Lee5ooJWed3FL0urpEy+01egQhEYjmCthTw@mail.gmail.com>

HI Erin,
Just index out the lines in the result vector.

Jim

On Sun, Aug 7, 2022 at 10:16 AM Erin Hodgess <erinm.hodgess at gmail.com> wrote:
>
> Hello!
>
> Is there a way to read the first line of a CSV file, then skip 4 lines,
> then continue reading, please?
>
> I know you can skip from the top, but I don't know if you can read and then
> skip.
>
> Thanks,
> Erin
>
>
> Erin Hodgess, PhD
> mailto: erinm.hodgess at gmail.com
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sun Aug  7 02:59:38 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sat, 06 Aug 2022 17:59:38 -0700
Subject: [R] Reading a CSV file
In-Reply-To: <CACxE24na6zZ=S5U0jD1VnTvbp38gtGTi-QWejPb_YyYFNO-Obg@mail.gmail.com>
References: <CACxE24na6zZ=S5U0jD1VnTvbp38gtGTi-QWejPb_YyYFNO-Obg@mail.gmail.com>
Message-ID: <A23F625C-A8EB-4DF5-8193-818248309A4B@dcn.davis.ca.us>

There is an example here [1] that illustrates one way to accomplish this.

[1] https://jdnewmil.github.io/blog/post/functions-talk/

On August 6, 2022 5:15:43 PM PDT, Erin Hodgess <erinm.hodgess at gmail.com> wrote:
>Hello!
>
>Is there a way to read the first line of a CSV file, then skip 4 lines,
>then continue reading, please?
>
>I know you can skip from the top, but I don't know if you can read and then
>skip.
>
>Thanks,
>Erin
>
>
>Erin Hodgess, PhD
>mailto: erinm.hodgess at gmail.com
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sun Aug  7 03:02:47 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sat, 06 Aug 2022 18:02:47 -0700
Subject: [R] Reading a CSV file
In-Reply-To: <88b129f8-3d41-ecb6-0c53-3c111f6c236b@statistik.tu-dortmund.de>
References: <CACxE24na6zZ=S5U0jD1VnTvbp38gtGTi-QWejPb_YyYFNO-Obg@mail.gmail.com>
 <88b129f8-3d41-ecb6-0c53-3c111f6c236b@statistik.tu-dortmund.de>
Message-ID: <B29D865A-4CD9-4C51-823B-F0ACC9AFB43A@dcn.davis.ca.us>

Nice! (Needs just one more closing paren...)

On August 6, 2022 5:51:12 PM PDT, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:
>csv <- readLines(filename)
>read.csv(text = csv[-(2:5)]
>
>Best,
>Uwe Ligges
>
>
>On 07.08.2022 02:15, Erin Hodgess wrote:
>> Hello!
>> 
>> Is there a way to read the first line of a CSV file, then skip 4 lines,
>> then continue reading, please?
>> 
>> I know you can skip from the top, but I don't know if you can read and then
>> skip.
>> 
>> Thanks,
>> Erin
>> 
>> 
>> Erin Hodgess, PhD
>> mailto: erinm.hodgess at gmail.com
>> 
>> 	[[alternative HTML version deleted]]
>> 
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From er|nm@hodge@@ @end|ng |rom gm@||@com  Sun Aug  7 03:15:16 2022
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Sat, 6 Aug 2022 21:15:16 -0400
Subject: [R] Reading a CSV file
In-Reply-To: <B29D865A-4CD9-4C51-823B-F0ACC9AFB43A@dcn.davis.ca.us>
References: <CACxE24na6zZ=S5U0jD1VnTvbp38gtGTi-QWejPb_YyYFNO-Obg@mail.gmail.com>
 <88b129f8-3d41-ecb6-0c53-3c111f6c236b@statistik.tu-dortmund.de>
 <B29D865A-4CD9-4C51-823B-F0ACC9AFB43A@dcn.davis.ca.us>
Message-ID: <CACxE24mnYNqswQPTjqoEDVG-yEQG9v+toOGTV5Y0q5E+3E6wig@mail.gmail.com>

All of these are so great!  Thanks so much, particularly on a Saturday
night!

Sincerely,
Erin

On Sat, Aug 6, 2022 at 9:02 PM Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
wrote:

> Nice! (Needs just one more closing paren...)
>
> On August 6, 2022 5:51:12 PM PDT, Uwe Ligges <
> ligges at statistik.tu-dortmund.de> wrote:
> >csv <- readLines(filename)
> >read.csv(text = csv[-(2:5)]
> >
> >Best,
> >Uwe Ligges
> >
> >
> >On 07.08.2022 02:15, Erin Hodgess wrote:
> >> Hello!
> >>
> >> Is there a way to read the first line of a CSV file, then skip 4 lines,
> >> then continue reading, please?
> >>
> >> I know you can skip from the top, but I don't know if you can read and
> then
> >> skip.
> >>
> >> Thanks,
> >> Erin
> >>
> >>
> >> Erin Hodgess, PhD
> >> mailto: erinm.hodgess at gmail.com
> >>
> >>      [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >
> >______________________________________________
> >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >https://stat.ethz.ch/mailman/listinfo/r-help
> >PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >and provide commented, minimal, self-contained, reproducible code.
>
> --
> Sent from my phone. Please excuse my brevity.
>
-- 
Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sun Aug  7 03:24:59 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sat, 06 Aug 2022 18:24:59 -0700
Subject: [R] Reading a CSV file
In-Reply-To: <CA+8X3fUoz_UGFE9Lee5ooJWed3FL0urpEy+01egQhEYjmCthTw@mail.gmail.com>
References: <CACxE24na6zZ=S5U0jD1VnTvbp38gtGTi-QWejPb_YyYFNO-Obg@mail.gmail.com>
 <CA+8X3fUoz_UGFE9Lee5ooJWed3FL0urpEy+01egQhEYjmCthTw@mail.gmail.com>
Message-ID: <918124C6-F34A-4D01-95D7-201A804FF18F@dcn.davis.ca.us>

Unfortunately, this can mess with your data types. Uwe's (and my more cluttered) approach doesn't.

On August 6, 2022 5:53:33 PM PDT, Jim Lemon <drjimlemon at gmail.com> wrote:
>HI Erin,
>Just index out the lines in the result vector.
>
>Jim
>
>On Sun, Aug 7, 2022 at 10:16 AM Erin Hodgess <erinm.hodgess at gmail.com> wrote:
>>
>> Hello!
>>
>> Is there a way to read the first line of a CSV file, then skip 4 lines,
>> then continue reading, please?
>>
>> I know you can skip from the top, but I don't know if you can read and then
>> skip.
>>
>> Thanks,
>> Erin
>>
>>
>> Erin Hodgess, PhD
>> mailto: erinm.hodgess at gmail.com
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From @vi@e@gross m@iii@g oii gm@ii@com  Sun Aug  7 06:04:16 2022
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Sun, 7 Aug 2022 00:04:16 -0400
Subject: [R] Reading a CSV file
In-Reply-To: <CACxE24na6zZ=S5U0jD1VnTvbp38gtGTi-QWejPb_YyYFNO-Obg@mail.gmail.com>
References: <CACxE24na6zZ=S5U0jD1VnTvbp38gtGTi-QWejPb_YyYFNO-Obg@mail.gmail.com>
Message-ID: <00a901d8aa12$c337fff0$49a7ffd0$@gmail.com>

Erin,

No explanation of why you want to do that. Are there comments on those
lines, for example?

I see others have replied with things that boils down to reading the entire
file into a data structure with lines, then using indexing of some sort to
eliminate the lines you want to skip and make data from the data structure
rather than the file. . That works, albeit for large files, ...

But there are, as usual, many ways to do things. Some people read in files
on their own and do the comma separation, type checking of columns and so on
and are free to make their own structure, perhaps the hard way. Clearly
skipping lines becomes trivial.

Then  there is the concept of reading it twice with the first pass trivially
picking up just a comma-separated line you can make into a series of headers
and then call something like read.csv and tell it to skip your N lines and
use these names for the columns.

Let me suggest an alternate solution IF you can arrange for the lines you do
not want (and only those) to begin with some comment character like "#" in
my example below:

text <- 'head1, head2
# ignore
# ignore 2
# ignore 3
# ignore 4
1,2
3,2'

hi <- read.csv(text=text, comment.char="#")

The above returns:

head1 head2
1     1     2
2     3     2

It will ignore any number of lines. If the data has anything special like
that, this might be a way to get what you want.

There are other packages like dplyr in the tidyverse with related but
sometimes different functionality and the same effect can be had with a
variation of my technique using read_csv() [note underscore not period]

hi <- text %>%  read_csv(comment="#")

Or use the new pipe symbol if you prefer:

hi <- text |> read_csv(comment="#")

What this gives you perhaps is more options such as a skip_empty_rows=TRUE
option that would remove the lines if blank.

And I tried some rather weird ideas like this:

text <- 'head1, head2
# ignore
# ignore 2 more stuff
# ignore 3, more stuff
# ignore 4
1,2
3,2'

hi <- text |> read_csv(col_types=c(col_integer(), col_integer()))

The idea was to TELL it what type to expect and hope the bad lines become
NA. Well, not quite. It made everything character given the above data that
was no longer suppressing comments:

> hi
# A tibble: 6 ? 2
head1                 head2     
<chr>                 <chr>     
  1 # ignore              NA        
2 # ignore 2 more stuff NA        
3 # ignore 3            more stuff
4 # ignore 4            NA        
5 1                     2         
6 3                     2         
> typeof(hi$head1)
[1] "character"
> typeof(hi$head2)
[1] "character"

But although this seems bad, it opens a door to consider. As long as
whatever is on those 4 lines does not mess things up by say making
additional columns, you probably can read the darn thing in to a tibble or
data.frame and then remove the rows you do not want and convert the columns
from character to whatever you want such as integer or numeric. 

Finally, if you have any control over the file contents, guess what happens
if you place the header line AFTER the four skipped lines like this?

text <- '# ignore
# ignore 2 more stuff
# ignore 3, more stuff
# ignore 4
head1, head2
1,2
3,2'

You now tell it to skip 4 lines AND use a header and it works for me!

read.csv(text=text, header=TRUE, skip=4)

There seems to be many ways to consider and I would not be shocked if some
program that does this data import even allowed you to specify what rows to
ignore more dynamically. 

But perhaps the first solution you got is more dynamic as it allows you to
process the text as a series of lines in all kinds of ways, such as removing
any rows that contain the number 666 or even editing it in some way,
combining data from multiple files, and so on.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Erin Hodgess
Sent: Saturday, August 6, 2022 8:16 PM
To: r-help at r-project.org
Subject: [R] Reading a CSV file

Hello!

Is there a way to read the first line of a CSV file, then skip 4 lines, then
continue reading, please?

I know you can skip from the top, but I don't know if you can read and then
skip.

Thanks,
Erin


Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From @vi@e@gross m@iii@g oii gm@ii@com  Sun Aug  7 06:06:50 2022
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Sun, 7 Aug 2022 00:06:50 -0400
Subject: [R] Reading a CSV file
In-Reply-To: <CA+8X3fUoz_UGFE9Lee5ooJWed3FL0urpEy+01egQhEYjmCthTw@mail.gmail.com>
References: <CACxE24na6zZ=S5U0jD1VnTvbp38gtGTi-QWejPb_YyYFNO-Obg@mail.gmail.com>
 <CA+8X3fUoz_UGFE9Lee5ooJWed3FL0urpEy+01egQhEYjmCthTw@mail.gmail.com>
Message-ID: <00c201d8aa13$1f1aa4d0$5d4fee70$@gmail.com>

Jim,

The resulting column vectors may not come out right as they will not be read
into the same number of columns unless you have the right number of
commas/separators and worse, the result may likely be columns changed to the
same type such as text or float even if you intended integer.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Jim Lemon
Sent: Saturday, August 6, 2022 8:54 PM
To: Erin Hodgess <erinm.hodgess at gmail.com>
Cc: r-help at r-project.org
Subject: Re: [R] Reading a CSV file

HI Erin,
Just index out the lines in the result vector.

Jim

On Sun, Aug 7, 2022 at 10:16 AM Erin Hodgess <erinm.hodgess at gmail.com>
wrote:
>
> Hello!
>
> Is there a way to read the first line of a CSV file, then skip 4 
> lines, then continue reading, please?
>
> I know you can skip from the top, but I don't know if you can read and 
> then skip.
>
> Thanks,
> Erin
>
>
> Erin Hodgess, PhD
> mailto: erinm.hodgess at gmail.com
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From er|nm@hodge@@ @end|ng |rom gm@||@com  Mon Aug  8 19:22:51 2022
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Mon, 8 Aug 2022 13:22:51 -0400
Subject: [R] Odd behavior of a function within apply
Message-ID: <CACxE24m2C3vzwGpYYoWVrLpLcx7jAK1FnnRHorwm-YFwDDzqPg@mail.gmail.com>

Hello!

I have the following data.frame
 dput(test1.df[1:10,8:10])
structure(list(X1_1_HZP1 = c(48160L, 48198L, 80027L, 48161L,
NA, 48911L, NA, 48197L, 48021L, 11355L), X1_1_HBM1_mon = c("December",
"June", "August", "", "", "August", "April", "February", "",
"December"), X1_1_HBM1_yr = c(2014L, 2018L, 2016L, NA, NA, 1985L,
2019L, 1993L, NA, 1990L)), row.names = c(NA, 10L), class = "data.frame")

And the following function:
> dput(count1a)
function (x)
{
    if (typeof(x) == "integer")
        y <- sum(is.na(x))
    if (typeof(x) == "character")
        y <- sum(x == "")
    return(y)
}
When I use the apply function with count1a, I get the following:
 apply(test1.df[1:10,8:10],2,count1a)
    X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
           NA             3            NA
However, when I do use columns 8 and 10, I get the correct response:
 apply(test1.df[1:10,c(8,10)],2,count1a)
   X1_1_HZP1 X1_1_HBM1_yr
           2            3
>
I am really baffled.  If I use count1a on a single column, it works fine.

Any suggestions much appreciated.
Thanks,
Sincerely,
Erin


Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From @kw@|mmo @end|ng |rom gm@||@com  Mon Aug  8 19:29:19 2022
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Mon, 8 Aug 2022 13:29:19 -0400
Subject: [R] Odd behavior of a function within apply
In-Reply-To: <CACxE24m2C3vzwGpYYoWVrLpLcx7jAK1FnnRHorwm-YFwDDzqPg@mail.gmail.com>
References: <CACxE24m2C3vzwGpYYoWVrLpLcx7jAK1FnnRHorwm-YFwDDzqPg@mail.gmail.com>
Message-ID: <CAPcHnpTL_s+YyNGcQZ18+SwOPgOSCTsYY+aBzZr7BrG8VbVyVw@mail.gmail.com>

When you use apply, it converts the input to an array, so all of the
integer columns in your data frame are converted to character class. I
would use lapply, sapply, or vapply instead to do this, I think you just
need to remove the "MARGIN" argument.

On Mon, Aug 8, 2022, 13:25 Erin Hodgess <erinm.hodgess at gmail.com> wrote:

> Hello!
>
> I have the following data.frame
>  dput(test1.df[1:10,8:10])
> structure(list(X1_1_HZP1 = c(48160L, 48198L, 80027L, 48161L,
> NA, 48911L, NA, 48197L, 48021L, 11355L), X1_1_HBM1_mon = c("December",
> "June", "August", "", "", "August", "April", "February", "",
> "December"), X1_1_HBM1_yr = c(2014L, 2018L, 2016L, NA, NA, 1985L,
> 2019L, 1993L, NA, 1990L)), row.names = c(NA, 10L), class = "data.frame")
>
> And the following function:
> > dput(count1a)
> function (x)
> {
>     if (typeof(x) == "integer")
>         y <- sum(is.na(x))
>     if (typeof(x) == "character")
>         y <- sum(x == "")
>     return(y)
> }
> When I use the apply function with count1a, I get the following:
>  apply(test1.df[1:10,8:10],2,count1a)
>     X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
>            NA             3            NA
> However, when I do use columns 8 and 10, I get the correct response:
>  apply(test1.df[1:10,c(8,10)],2,count1a)
>    X1_1_HZP1 X1_1_HBM1_yr
>            2            3
> >
> I am really baffled.  If I use count1a on a single column, it works fine.
>
> Any suggestions much appreciated.
> Thanks,
> Sincerely,
> Erin
>
>
> Erin Hodgess, PhD
> mailto: erinm.hodgess at gmail.com
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From j|ox @end|ng |rom mcm@@ter@c@  Mon Aug  8 19:37:58 2022
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Mon, 8 Aug 2022 13:37:58 -0400
Subject: [R] Odd behavior of a function within apply
In-Reply-To: <9435_1659979524_278HPNvu030617_CACxE24m2C3vzwGpYYoWVrLpLcx7jAK1FnnRHorwm-YFwDDzqPg@mail.gmail.com>
References: <9435_1659979524_278HPNvu030617_CACxE24m2C3vzwGpYYoWVrLpLcx7jAK1FnnRHorwm-YFwDDzqPg@mail.gmail.com>
Message-ID: <565e3f72-a449-753f-ebee-b44d0f62eb2b@mcmaster.ca>

Dear Erin,

The problem is that the data frame gets coerced to a character matrix, 
and the only column with "" entries is the 9th (the second one you 
supplied):

as.matrix(test1.df)
    X1_1_HZP1 X1_1_HBM1_mon X1_1_HBM1_yr
1  "48160"   "December"    "2014"
2  "48198"   "June"        "2018"
3  "80027"   "August"      "2016"
4  "48161"   ""            NA
5  NA        ""            NA
6  "48911"   "August"      "1985"
7  NA        "April"       "2019"
8  "48197"   "February"    "1993"
9  "48021"   ""            NA
10 "11355"   "December"    "1990"

(Here, test1.df only contains the three columns you provided.)

A solution is to use sapply:

 > sapply(test1.df, count1a)
     X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
             2             3             3


I hope this helps,
  John


On 2022-08-08 1:22 p.m., Erin Hodgess wrote:
> Hello!
> 
> I have the following data.frame
>   dput(test1.df[1:10,8:10])
> structure(list(X1_1_HZP1 = c(48160L, 48198L, 80027L, 48161L,
> NA, 48911L, NA, 48197L, 48021L, 11355L), X1_1_HBM1_mon = c("December",
> "June", "August", "", "", "August", "April", "February", "",
> "December"), X1_1_HBM1_yr = c(2014L, 2018L, 2016L, NA, NA, 1985L,
> 2019L, 1993L, NA, 1990L)), row.names = c(NA, 10L), class = "data.frame")
> 
> And the following function:
>> dput(count1a)
> function (x)
> {
>      if (typeof(x) == "integer")
>          y <- sum(is.na(x))
>      if (typeof(x) == "character")
>          y <- sum(x == "")
>      return(y)
> }
> When I use the apply function with count1a, I get the following:
>   apply(test1.df[1:10,8:10],2,count1a)
>      X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
>             NA             3            NA
> However, when I do use columns 8 and 10, I get the correct response:
>   apply(test1.df[1:10,c(8,10)],2,count1a)
>     X1_1_HZP1 X1_1_HBM1_yr
>             2            3
>>
> I am really baffled.  If I use count1a on a single column, it works fine.
> 
> Any suggestions much appreciated.
> Thanks,
> Sincerely,
> Erin
> 
> 
> Erin Hodgess, PhD
> mailto: erinm.hodgess at gmail.com
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
-- 
John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://socialsciences.mcmaster.ca/jfox/


From er|nm@hodge@@ @end|ng |rom gm@||@com  Mon Aug  8 19:38:44 2022
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Mon, 8 Aug 2022 13:38:44 -0400
Subject: [R] Odd behavior of a function within apply
In-Reply-To: <CAPcHnpTL_s+YyNGcQZ18+SwOPgOSCTsYY+aBzZr7BrG8VbVyVw@mail.gmail.com>
References: <CACxE24m2C3vzwGpYYoWVrLpLcx7jAK1FnnRHorwm-YFwDDzqPg@mail.gmail.com>
 <CAPcHnpTL_s+YyNGcQZ18+SwOPgOSCTsYY+aBzZr7BrG8VbVyVw@mail.gmail.com>
Message-ID: <CACxE24kFa=rVDp1txg-XwOvF5hyn7DMmG8TSp8LduP6fiWg8bw@mail.gmail.com>

Great, thank you so much!


Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com


On Mon, Aug 8, 2022 at 1:29 PM Andrew Simmons <akwsimmo at gmail.com> wrote:

> When you use apply, it converts the input to an array, so all of the
> integer columns in your data frame are converted to character class. I
> would use lapply, sapply, or vapply instead to do this, I think you just
> need to remove the "MARGIN" argument.
>
> On Mon, Aug 8, 2022, 13:25 Erin Hodgess <erinm.hodgess at gmail.com> wrote:
>
>> Hello!
>>
>> I have the following data.frame
>>  dput(test1.df[1:10,8:10])
>> structure(list(X1_1_HZP1 = c(48160L, 48198L, 80027L, 48161L,
>> NA, 48911L, NA, 48197L, 48021L, 11355L), X1_1_HBM1_mon = c("December",
>> "June", "August", "", "", "August", "April", "February", "",
>> "December"), X1_1_HBM1_yr = c(2014L, 2018L, 2016L, NA, NA, 1985L,
>> 2019L, 1993L, NA, 1990L)), row.names = c(NA, 10L), class = "data.frame")
>>
>> And the following function:
>> > dput(count1a)
>> function (x)
>> {
>>     if (typeof(x) == "integer")
>>         y <- sum(is.na(x))
>>     if (typeof(x) == "character")
>>         y <- sum(x == "")
>>     return(y)
>> }
>> When I use the apply function with count1a, I get the following:
>>  apply(test1.df[1:10,8:10],2,count1a)
>>     X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
>>            NA             3            NA
>> However, when I do use columns 8 and 10, I get the correct response:
>>  apply(test1.df[1:10,c(8,10)],2,count1a)
>>    X1_1_HZP1 X1_1_HBM1_yr
>>            2            3
>> >
>> I am really baffled.  If I use count1a on a single column, it works fine.
>>
>> Any suggestions much appreciated.
>> Thanks,
>> Sincerely,
>> Erin
>>
>>
>> Erin Hodgess, PhD
>> mailto: erinm.hodgess at gmail.com
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From er|nm@hodge@@ @end|ng |rom gm@||@com  Mon Aug  8 19:41:23 2022
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Mon, 8 Aug 2022 13:41:23 -0400
Subject: [R] Odd behavior of a function within apply
In-Reply-To: <CAPcHnpTL_s+YyNGcQZ18+SwOPgOSCTsYY+aBzZr7BrG8VbVyVw@mail.gmail.com>
References: <CACxE24m2C3vzwGpYYoWVrLpLcx7jAK1FnnRHorwm-YFwDDzqPg@mail.gmail.com>
 <CAPcHnpTL_s+YyNGcQZ18+SwOPgOSCTsYY+aBzZr7BrG8VbVyVw@mail.gmail.com>
Message-ID: <CACxE24nNV2oTKN_MLX_+nqJsVD1SGniS5om62seMZ7TkqiYNrg@mail.gmail.com>

lapply worked perfectly!

Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com


On Mon, Aug 8, 2022 at 1:29 PM Andrew Simmons <akwsimmo at gmail.com> wrote:

> When you use apply, it converts the input to an array, so all of the
> integer columns in your data frame are converted to character class. I
> would use lapply, sapply, or vapply instead to do this, I think you just
> need to remove the "MARGIN" argument.
>
> On Mon, Aug 8, 2022, 13:25 Erin Hodgess <erinm.hodgess at gmail.com> wrote:
>
>> Hello!
>>
>> I have the following data.frame
>>  dput(test1.df[1:10,8:10])
>> structure(list(X1_1_HZP1 = c(48160L, 48198L, 80027L, 48161L,
>> NA, 48911L, NA, 48197L, 48021L, 11355L), X1_1_HBM1_mon = c("December",
>> "June", "August", "", "", "August", "April", "February", "",
>> "December"), X1_1_HBM1_yr = c(2014L, 2018L, 2016L, NA, NA, 1985L,
>> 2019L, 1993L, NA, 1990L)), row.names = c(NA, 10L), class = "data.frame")
>>
>> And the following function:
>> > dput(count1a)
>> function (x)
>> {
>>     if (typeof(x) == "integer")
>>         y <- sum(is.na(x))
>>     if (typeof(x) == "character")
>>         y <- sum(x == "")
>>     return(y)
>> }
>> When I use the apply function with count1a, I get the following:
>>  apply(test1.df[1:10,8:10],2,count1a)
>>     X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
>>            NA             3            NA
>> However, when I do use columns 8 and 10, I get the correct response:
>>  apply(test1.df[1:10,c(8,10)],2,count1a)
>>    X1_1_HZP1 X1_1_HBM1_yr
>>            2            3
>> >
>> I am really baffled.  If I use count1a on a single column, it works fine.
>>
>> Any suggestions much appreciated.
>> Thanks,
>> Sincerely,
>> Erin
>>
>>
>> Erin Hodgess, PhD
>> mailto: erinm.hodgess at gmail.com
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From er|nm@hodge@@ @end|ng |rom gm@||@com  Mon Aug  8 19:41:56 2022
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Mon, 8 Aug 2022 13:41:56 -0400
Subject: [R] Odd behavior of a function within apply
In-Reply-To: <565e3f72-a449-753f-ebee-b44d0f62eb2b@mcmaster.ca>
References: <9435_1659979524_278HPNvu030617_CACxE24m2C3vzwGpYYoWVrLpLcx7jAK1FnnRHorwm-YFwDDzqPg@mail.gmail.com>
 <565e3f72-a449-753f-ebee-b44d0f62eb2b@mcmaster.ca>
Message-ID: <CACxE24nUyFMb2sUneC4efnh11BiCvAdxGt50ZVe_GqyP1o20SQ@mail.gmail.com>

Awesome, thanks so much!!

Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com


On Mon, Aug 8, 2022 at 1:38 PM John Fox <jfox at mcmaster.ca> wrote:

> Dear Erin,
>
> The problem is that the data frame gets coerced to a character matrix,
> and the only column with "" entries is the 9th (the second one you
> supplied):
>
> as.matrix(test1.df)
>     X1_1_HZP1 X1_1_HBM1_mon X1_1_HBM1_yr
> 1  "48160"   "December"    "2014"
> 2  "48198"   "June"        "2018"
> 3  "80027"   "August"      "2016"
> 4  "48161"   ""            NA
> 5  NA        ""            NA
> 6  "48911"   "August"      "1985"
> 7  NA        "April"       "2019"
> 8  "48197"   "February"    "1993"
> 9  "48021"   ""            NA
> 10 "11355"   "December"    "1990"
>
> (Here, test1.df only contains the three columns you provided.)
>
> A solution is to use sapply:
>
>  > sapply(test1.df, count1a)
>      X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
>              2             3             3
>
>
> I hope this helps,
>   John
>
>
> On 2022-08-08 1:22 p.m., Erin Hodgess wrote:
> > Hello!
> >
> > I have the following data.frame
> >   dput(test1.df[1:10,8:10])
> > structure(list(X1_1_HZP1 = c(48160L, 48198L, 80027L, 48161L,
> > NA, 48911L, NA, 48197L, 48021L, 11355L), X1_1_HBM1_mon = c("December",
> > "June", "August", "", "", "August", "April", "February", "",
> > "December"), X1_1_HBM1_yr = c(2014L, 2018L, 2016L, NA, NA, 1985L,
> > 2019L, 1993L, NA, 1990L)), row.names = c(NA, 10L), class = "data.frame")
> >
> > And the following function:
> >> dput(count1a)
> > function (x)
> > {
> >      if (typeof(x) == "integer")
> >          y <- sum(is.na(x))
> >      if (typeof(x) == "character")
> >          y <- sum(x == "")
> >      return(y)
> > }
> > When I use the apply function with count1a, I get the following:
> >   apply(test1.df[1:10,8:10],2,count1a)
> >      X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
> >             NA             3            NA
> > However, when I do use columns 8 and 10, I get the correct response:
> >   apply(test1.df[1:10,c(8,10)],2,count1a)
> >     X1_1_HZP1 X1_1_HBM1_yr
> >             2            3
> >>
> > I am really baffled.  If I use count1a on a single column, it works fine.
> >
> > Any suggestions much appreciated.
> > Thanks,
> > Sincerely,
> > Erin
> >
> >
> > Erin Hodgess, PhD
> > mailto: erinm.hodgess at gmail.com
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> --
> John Fox, Professor Emeritus
> McMaster University
> Hamilton, Ontario, Canada
> web: https://socialsciences.mcmaster.ca/jfox/
>
>

	[[alternative HTML version deleted]]


From er|nm@hodge@@ @end|ng |rom gm@||@com  Mon Aug  8 20:05:23 2022
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Mon, 8 Aug 2022 14:05:23 -0400
Subject: [R] Odd behavior of a function within apply
In-Reply-To: <CACxE24mLEnwUvWACXEt8+EWNnGbgNWEMwndqTrxY=yCfp1oxfA@mail.gmail.com>
References: <9435_1659979524_278HPNvu030617_CACxE24m2C3vzwGpYYoWVrLpLcx7jAK1FnnRHorwm-YFwDDzqPg@mail.gmail.com>
 <565e3f72-a449-753f-ebee-b44d0f62eb2b@mcmaster.ca>
 <CACxE24nUyFMb2sUneC4efnh11BiCvAdxGt50ZVe_GqyP1o20SQ@mail.gmail.com>
 <CACxE24mLEnwUvWACXEt8+EWNnGbgNWEMwndqTrxY=yCfp1oxfA@mail.gmail.com>
Message-ID: <CACxE24kdpGsVX0g6069Y_Lhkx2tN94iBA-Y1WiXTPBy4uDWJAg@mail.gmail.com>

Nailed it!

There were a few "logical" columns in my data.frame.

Thanks for all of the help!
Sincerely,
Erin

Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com


On Mon, Aug 8, 2022 at 1:51 PM Erin Hodgess <erinm.hodgess at gmail.com> wrote:

> OK.  I'm back again.
>
> So my test1.df is 236x390
>
> If I put in the following:
>  lapply(test1.df,count1a)
> Error in FUN(X[[i]], ...) : object 'y' not found
> > lapply(test1.df,count1a)
> Error in FUN(X[[i]], ...) : object 'y' not found
> > sapply(test1.df,count1a)
> Error in FUN(X[[i]], ...) : object 'y' not found
> >
> What am I doing wrong, please?
> Thanks,
> Erin
>
>
> Erin Hodgess, PhD
> mailto: erinm.hodgess at gmail.com
>
>
> On Mon, Aug 8, 2022 at 1:41 PM Erin Hodgess <erinm.hodgess at gmail.com>
> wrote:
>
>> Awesome, thanks so much!!
>>
>> Erin Hodgess, PhD
>> mailto: erinm.hodgess at gmail.com
>>
>>
>> On Mon, Aug 8, 2022 at 1:38 PM John Fox <jfox at mcmaster.ca> wrote:
>>
>>> Dear Erin,
>>>
>>> The problem is that the data frame gets coerced to a character matrix,
>>> and the only column with "" entries is the 9th (the second one you
>>> supplied):
>>>
>>> as.matrix(test1.df)
>>>     X1_1_HZP1 X1_1_HBM1_mon X1_1_HBM1_yr
>>> 1  "48160"   "December"    "2014"
>>> 2  "48198"   "June"        "2018"
>>> 3  "80027"   "August"      "2016"
>>> 4  "48161"   ""            NA
>>> 5  NA        ""            NA
>>> 6  "48911"   "August"      "1985"
>>> 7  NA        "April"       "2019"
>>> 8  "48197"   "February"    "1993"
>>> 9  "48021"   ""            NA
>>> 10 "11355"   "December"    "1990"
>>>
>>> (Here, test1.df only contains the three columns you provided.)
>>>
>>> A solution is to use sapply:
>>>
>>>  > sapply(test1.df, count1a)
>>>      X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
>>>              2             3             3
>>>
>>>
>>> I hope this helps,
>>>   John
>>>
>>>
>>> On 2022-08-08 1:22 p.m., Erin Hodgess wrote:
>>> > Hello!
>>> >
>>> > I have the following data.frame
>>> >   dput(test1.df[1:10,8:10])
>>> > structure(list(X1_1_HZP1 = c(48160L, 48198L, 80027L, 48161L,
>>> > NA, 48911L, NA, 48197L, 48021L, 11355L), X1_1_HBM1_mon = c("December",
>>> > "June", "August", "", "", "August", "April", "February", "",
>>> > "December"), X1_1_HBM1_yr = c(2014L, 2018L, 2016L, NA, NA, 1985L,
>>> > 2019L, 1993L, NA, 1990L)), row.names = c(NA, 10L), class =
>>> "data.frame")
>>> >
>>> > And the following function:
>>> >> dput(count1a)
>>> > function (x)
>>> > {
>>> >      if (typeof(x) == "integer")
>>> >          y <- sum(is.na(x))
>>> >      if (typeof(x) == "character")
>>> >          y <- sum(x == "")
>>> >      return(y)
>>> > }
>>> > When I use the apply function with count1a, I get the following:
>>> >   apply(test1.df[1:10,8:10],2,count1a)
>>> >      X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
>>> >             NA             3            NA
>>> > However, when I do use columns 8 and 10, I get the correct response:
>>> >   apply(test1.df[1:10,c(8,10)],2,count1a)
>>> >     X1_1_HZP1 X1_1_HBM1_yr
>>> >             2            3
>>> >>
>>> > I am really baffled.  If I use count1a on a single column, it works
>>> fine.
>>> >
>>> > Any suggestions much appreciated.
>>> > Thanks,
>>> > Sincerely,
>>> > Erin
>>> >
>>> >
>>> > Erin Hodgess, PhD
>>> > mailto: erinm.hodgess at gmail.com
>>> >
>>> >       [[alternative HTML version deleted]]
>>> >
>>> > ______________________________________________
>>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> > https://stat.ethz.ch/mailman/listinfo/r-help
>>> > PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> > and provide commented, minimal, self-contained, reproducible code.
>>> --
>>> John Fox, Professor Emeritus
>>> McMaster University
>>> Hamilton, Ontario, Canada
>>> web: https://socialsciences.mcmaster.ca/jfox/
>>>
>>>

	[[alternative HTML version deleted]]


From er|nm@hodge@@ @end|ng |rom gm@||@com  Mon Aug  8 19:51:01 2022
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Mon, 8 Aug 2022 13:51:01 -0400
Subject: [R] Odd behavior of a function within apply
In-Reply-To: <CACxE24nUyFMb2sUneC4efnh11BiCvAdxGt50ZVe_GqyP1o20SQ@mail.gmail.com>
References: <9435_1659979524_278HPNvu030617_CACxE24m2C3vzwGpYYoWVrLpLcx7jAK1FnnRHorwm-YFwDDzqPg@mail.gmail.com>
 <565e3f72-a449-753f-ebee-b44d0f62eb2b@mcmaster.ca>
 <CACxE24nUyFMb2sUneC4efnh11BiCvAdxGt50ZVe_GqyP1o20SQ@mail.gmail.com>
Message-ID: <CACxE24mLEnwUvWACXEt8+EWNnGbgNWEMwndqTrxY=yCfp1oxfA@mail.gmail.com>

OK.  I'm back again.

So my test1.df is 236x390

If I put in the following:
 lapply(test1.df,count1a)
Error in FUN(X[[i]], ...) : object 'y' not found
> lapply(test1.df,count1a)
Error in FUN(X[[i]], ...) : object 'y' not found
> sapply(test1.df,count1a)
Error in FUN(X[[i]], ...) : object 'y' not found
>
What am I doing wrong, please?
Thanks,
Erin


Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com


On Mon, Aug 8, 2022 at 1:41 PM Erin Hodgess <erinm.hodgess at gmail.com> wrote:

> Awesome, thanks so much!!
>
> Erin Hodgess, PhD
> mailto: erinm.hodgess at gmail.com
>
>
> On Mon, Aug 8, 2022 at 1:38 PM John Fox <jfox at mcmaster.ca> wrote:
>
>> Dear Erin,
>>
>> The problem is that the data frame gets coerced to a character matrix,
>> and the only column with "" entries is the 9th (the second one you
>> supplied):
>>
>> as.matrix(test1.df)
>>     X1_1_HZP1 X1_1_HBM1_mon X1_1_HBM1_yr
>> 1  "48160"   "December"    "2014"
>> 2  "48198"   "June"        "2018"
>> 3  "80027"   "August"      "2016"
>> 4  "48161"   ""            NA
>> 5  NA        ""            NA
>> 6  "48911"   "August"      "1985"
>> 7  NA        "April"       "2019"
>> 8  "48197"   "February"    "1993"
>> 9  "48021"   ""            NA
>> 10 "11355"   "December"    "1990"
>>
>> (Here, test1.df only contains the three columns you provided.)
>>
>> A solution is to use sapply:
>>
>>  > sapply(test1.df, count1a)
>>      X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
>>              2             3             3
>>
>>
>> I hope this helps,
>>   John
>>
>>
>> On 2022-08-08 1:22 p.m., Erin Hodgess wrote:
>> > Hello!
>> >
>> > I have the following data.frame
>> >   dput(test1.df[1:10,8:10])
>> > structure(list(X1_1_HZP1 = c(48160L, 48198L, 80027L, 48161L,
>> > NA, 48911L, NA, 48197L, 48021L, 11355L), X1_1_HBM1_mon = c("December",
>> > "June", "August", "", "", "August", "April", "February", "",
>> > "December"), X1_1_HBM1_yr = c(2014L, 2018L, 2016L, NA, NA, 1985L,
>> > 2019L, 1993L, NA, 1990L)), row.names = c(NA, 10L), class = "data.frame")
>> >
>> > And the following function:
>> >> dput(count1a)
>> > function (x)
>> > {
>> >      if (typeof(x) == "integer")
>> >          y <- sum(is.na(x))
>> >      if (typeof(x) == "character")
>> >          y <- sum(x == "")
>> >      return(y)
>> > }
>> > When I use the apply function with count1a, I get the following:
>> >   apply(test1.df[1:10,8:10],2,count1a)
>> >      X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
>> >             NA             3            NA
>> > However, when I do use columns 8 and 10, I get the correct response:
>> >   apply(test1.df[1:10,c(8,10)],2,count1a)
>> >     X1_1_HZP1 X1_1_HBM1_yr
>> >             2            3
>> >>
>> > I am really baffled.  If I use count1a on a single column, it works
>> fine.
>> >
>> > Any suggestions much appreciated.
>> > Thanks,
>> > Sincerely,
>> > Erin
>> >
>> >
>> > Erin Hodgess, PhD
>> > mailto: erinm.hodgess at gmail.com
>> >
>> >       [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>> --
>> John Fox, Professor Emeritus
>> McMaster University
>> Hamilton, Ontario, Canada
>> web: https://socialsciences.mcmaster.ca/jfox/
>>
>>

	[[alternative HTML version deleted]]


From dc@r|@on @end|ng |rom t@mu@edu  Tue Aug  9 17:33:11 2022
From: dc@r|@on @end|ng |rom t@mu@edu (David Carlson)
Date: Tue, 9 Aug 2022 10:33:11 -0500
Subject: [R] Odd behavior of a function within apply
In-Reply-To: <CACxE24mLEnwUvWACXEt8+EWNnGbgNWEMwndqTrxY=yCfp1oxfA@mail.gmail.com>
References: <9435_1659979524_278HPNvu030617_CACxE24m2C3vzwGpYYoWVrLpLcx7jAK1FnnRHorwm-YFwDDzqPg@mail.gmail.com>
 <565e3f72-a449-753f-ebee-b44d0f62eb2b@mcmaster.ca>
 <CACxE24nUyFMb2sUneC4efnh11BiCvAdxGt50ZVe_GqyP1o20SQ@mail.gmail.com>
 <CACxE24mLEnwUvWACXEt8+EWNnGbgNWEMwndqTrxY=yCfp1oxfA@mail.gmail.com>
Message-ID: <CAE-dL2r2m+RPkv2etCv3Nt54_OH_OwN8ho=UCb00iS57pkcooA@mail.gmail.com>

Could you have columns that are not character or integer so that y is never
defined in the function?

count1a(1:5/3)
Error in count1a(1:5/3) : object 'y' not found

David Carlson


On Mon, Aug 8, 2022 at 1:35 PM Erin Hodgess <erinm.hodgess at gmail.com> wrote:

> OK.?? I'm back again.?? So my test1.??df is 236x390 If I put in the
> following:?? lapply(test1.??df,count1a) Error in FUN(X[[i]], .??.??.??) :??
> object 'y' not found > lapply(test1.??df,count1a) Error in FUN(X[[i]],
> .??.??.??) :?? object 'y' not found > sapply(test1.??df,count1a)
> ZjQcmQRYFpfptBannerStart
> This Message Is From an External Sender
> This message came from outside your organization.
>
> ZjQcmQRYFpfptBannerEnd
>
> OK.  I'm back again.
>
> So my test1.df is 236x390
>
> If I put in the following:
>  lapply(test1.df,count1a)
> Error in FUN(X[[i]], ...) : object 'y' not found
> > lapply(test1.df,count1a)
> Error in FUN(X[[i]], ...) : object 'y' not found
> > sapply(test1.df,count1a)
> Error in FUN(X[[i]], ...) : object 'y' not found
> >
> What am I doing wrong, please?
> Thanks,
> Erin
>
>
> Erin Hodgess, PhD
> mailto: erinm.hodgess at gmail.com
>
>
> On Mon, Aug 8, 2022 at 1:41 PM Erin Hodgess <erinm.hodgess at gmail.com> wrote:
>
> > Awesome, thanks so much!!
> >
> > Erin Hodgess, PhD
> > mailto: erinm.hodgess at gmail.com
> >
> >
> > On Mon, Aug 8, 2022 at 1:38 PM John Fox <jfox at mcmaster.ca> wrote:
> >
> >> Dear Erin,
> >>
> >> The problem is that the data frame gets coerced to a character matrix,
> >> and the only column with "" entries is the 9th (the second one you
> >> supplied):
> >>
> >> as.matrix(test1.df)
> >>     X1_1_HZP1 X1_1_HBM1_mon X1_1_HBM1_yr
> >> 1  "48160"   "December"    "2014"
> >> 2  "48198"   "June"        "2018"
> >> 3  "80027"   "August"      "2016"
> >> 4  "48161"   ""            NA
> >> 5  NA        ""            NA
> >> 6  "48911"   "August"      "1985"
> >> 7  NA        "April"       "2019"
> >> 8  "48197"   "February"    "1993"
> >> 9  "48021"   ""            NA
> >> 10 "11355"   "December"    "1990"
> >>
> >> (Here, test1.df only contains the three columns you provided.)
> >>
> >> A solution is to use sapply:
> >>
> >>  > sapply(test1.df, count1a)
> >>      X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
> >>              2             3             3
> >>
> >>
> >> I hope this helps,
> >>   John
> >>
> >>
> >> On 2022-08-08 1:22 p.m., Erin Hodgess wrote:
> >> > Hello!
> >> >
> >> > I have the following data.frame
> >> >   dput(test1.df[1:10,8:10])
> >> > structure(list(X1_1_HZP1 = c(48160L, 48198L, 80027L, 48161L,
> >> > NA, 48911L, NA, 48197L, 48021L, 11355L), X1_1_HBM1_mon = c("December",
> >> > "June", "August", "", "", "August", "April", "February", "",
> >> > "December"), X1_1_HBM1_yr = c(2014L, 2018L, 2016L, NA, NA, 1985L,
> >> > 2019L, 1993L, NA, 1990L)), row.names = c(NA, 10L), class = "data.frame")
> >> >
> >> > And the following function:
> >> >> dput(count1a)
> >> > function (x)
> >> > {
> >> >      if (typeof(x) == "integer")
> >> >          y <- sum(is.na(x))
> >> >      if (typeof(x) == "character")
> >> >          y <- sum(x == "")
> >> >      return(y)
> >> > }
> >> > When I use the apply function with count1a, I get the following:
> >> >   apply(test1.df[1:10,8:10],2,count1a)
> >> >      X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
> >> >             NA             3            NA
> >> > However, when I do use columns 8 and 10, I get the correct response:
> >> >   apply(test1.df[1:10,c(8,10)],2,count1a)
> >> >     X1_1_HZP1 X1_1_HBM1_yr
> >> >             2            3
> >> >>
> >> > I am really baffled.  If I use count1a on a single column, it works
> >> fine.
> >> >
> >> > Any suggestions much appreciated.
> >> > Thanks,
> >> > Sincerely,
> >> > Erin
> >> >
> >> >
> >> > Erin Hodgess, PhD
> >> > mailto: erinm.hodgess at gmail.com
> >> >
> >> >       [[alternative HTML version deleted]]
> >> >
> >> > ______________________________________________
> >> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8SJJdx6Uq0p4rpBa4E3DkmQ65UImH48MBvSbrfE$
> >> > PLEASE do read the posting guide
> >> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8SJJdx6Uq0p4rpBa4E3DkmQ65UImH48MdYOqruE$
> >> > and provide commented, minimal, self-contained, reproducible code.
> >> --
> >> John Fox, Professor Emeritus
> >> McMaster University
> >> Hamilton, Ontario, Canada
> >> web: https://urldefense.com/v3/__https://socialsciences.mcmaster.ca/jfox/__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8SJJdx6Uq0p4rpBa4E3DkmQ65UImH48MRU4wu3o$
> >>
> >>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, seehttps://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8SJJdx6Uq0p4rpBa4E3DkmQ65UImH48MBvSbrfE$
> PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8SJJdx6Uq0p4rpBa4E3DkmQ65UImH48MdYOqruE$
> and provide commented, minimal, self-contained, reproducible code.
>
>

	[[alternative HTML version deleted]]


From er|nm@hodge@@ @end|ng |rom gm@||@com  Tue Aug  9 17:35:29 2022
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Tue, 9 Aug 2022 11:35:29 -0400
Subject: [R] Odd behavior of a function within apply
In-Reply-To: <CAE-dL2r2m+RPkv2etCv3Nt54_OH_OwN8ho=UCb00iS57pkcooA@mail.gmail.com>
References: <9435_1659979524_278HPNvu030617_CACxE24m2C3vzwGpYYoWVrLpLcx7jAK1FnnRHorwm-YFwDDzqPg@mail.gmail.com>
 <565e3f72-a449-753f-ebee-b44d0f62eb2b@mcmaster.ca>
 <CACxE24nUyFMb2sUneC4efnh11BiCvAdxGt50ZVe_GqyP1o20SQ@mail.gmail.com>
 <CACxE24mLEnwUvWACXEt8+EWNnGbgNWEMwndqTrxY=yCfp1oxfA@mail.gmail.com>
 <CAE-dL2r2m+RPkv2etCv3Nt54_OH_OwN8ho=UCb00iS57pkcooA@mail.gmail.com>
Message-ID: <CACxE24k7Q2qV1qO9Jd4BfFpsyoRnOkPJ5JK+6LN26goq7bCnWQ@mail.gmail.com>

My ?count1a? function was only looking for types of integers and
characters.  There were a few logical types, which were the source of the
error.

Thanks,
Erin

On Tue, Aug 9, 2022 at 11:33 AM David Carlson <dcarlson at tamu.edu> wrote:

> Could you have columns that are not character or integer so that y is
> never defined in the function?
>
> count1a(1:5/3)
> Error in count1a(1:5/3) : object 'y' not found
>
> David Carlson
>
>
> On Mon, Aug 8, 2022 at 1:35 PM Erin Hodgess <erinm.hodgess at gmail.com>
> wrote:
>
>> OK.?? I'm back again.?? So my test1.??df is 236x390 If I put in the
>> following:?? lapply(test1.??df,count1a) Error in FUN(X[[i]], .??.??.??) :??
>> object 'y' not found > lapply(test1.??df,count1a) Error in FUN(X[[i]],
>> .??.??.??) :?? object 'y' not found > sapply(test1.??df,count1a)
>> ZjQcmQRYFpfptBannerStart
>> This Message Is From an External Sender
>> This message came from outside your organization.
>>
>> ZjQcmQRYFpfptBannerEnd
>>
>> OK.  I'm back again.
>>
>> So my test1.df is 236x390
>>
>> If I put in the following:
>>  lapply(test1.df,count1a)
>> Error in FUN(X[[i]], ...) : object 'y' not found
>> > lapply(test1.df,count1a)
>> Error in FUN(X[[i]], ...) : object 'y' not found
>> > sapply(test1.df,count1a)
>> Error in FUN(X[[i]], ...) : object 'y' not found
>> >
>> What am I doing wrong, please?
>> Thanks,
>> Erin
>>
>>
>> Erin Hodgess, PhD
>> mailto: erinm.hodgess at gmail.com
>>
>>
>> On Mon, Aug 8, 2022 at 1:41 PM Erin Hodgess <erinm.hodgess at gmail.com> wrote:
>>
>> > Awesome, thanks so much!!
>> >
>> > Erin Hodgess, PhD
>> > mailto: erinm.hodgess at gmail.com
>> >
>> >
>> > On Mon, Aug 8, 2022 at 1:38 PM John Fox <jfox at mcmaster.ca> wrote:
>> >
>> >> Dear Erin,
>> >>
>> >> The problem is that the data frame gets coerced to a character matrix,
>> >> and the only column with "" entries is the 9th (the second one you
>> >> supplied):
>> >>
>> >> as.matrix(test1.df)
>> >>     X1_1_HZP1 X1_1_HBM1_mon X1_1_HBM1_yr
>> >> 1  "48160"   "December"    "2014"
>> >> 2  "48198"   "June"        "2018"
>> >> 3  "80027"   "August"      "2016"
>> >> 4  "48161"   ""            NA
>> >> 5  NA        ""            NA
>> >> 6  "48911"   "August"      "1985"
>> >> 7  NA        "April"       "2019"
>> >> 8  "48197"   "February"    "1993"
>> >> 9  "48021"   ""            NA
>> >> 10 "11355"   "December"    "1990"
>> >>
>> >> (Here, test1.df only contains the three columns you provided.)
>> >>
>> >> A solution is to use sapply:
>> >>
>> >>  > sapply(test1.df, count1a)
>> >>      X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
>> >>              2             3             3
>> >>
>> >>
>> >> I hope this helps,
>> >>   John
>> >>
>> >>
>> >> On 2022-08-08 1:22 p.m., Erin Hodgess wrote:
>> >> > Hello!
>> >> >
>> >> > I have the following data.frame
>> >> >   dput(test1.df[1:10,8:10])
>> >> > structure(list(X1_1_HZP1 = c(48160L, 48198L, 80027L, 48161L,
>> >> > NA, 48911L, NA, 48197L, 48021L, 11355L), X1_1_HBM1_mon = c("December",
>> >> > "June", "August", "", "", "August", "April", "February", "",
>> >> > "December"), X1_1_HBM1_yr = c(2014L, 2018L, 2016L, NA, NA, 1985L,
>> >> > 2019L, 1993L, NA, 1990L)), row.names = c(NA, 10L), class = "data.frame")
>> >> >
>> >> > And the following function:
>> >> >> dput(count1a)
>> >> > function (x)
>> >> > {
>> >> >      if (typeof(x) == "integer")
>> >> >          y <- sum(is.na(x))
>> >> >      if (typeof(x) == "character")
>> >> >          y <- sum(x == "")
>> >> >      return(y)
>> >> > }
>> >> > When I use the apply function with count1a, I get the following:
>> >> >   apply(test1.df[1:10,8:10],2,count1a)
>> >> >      X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
>> >> >             NA             3            NA
>> >> > However, when I do use columns 8 and 10, I get the correct response:
>> >> >   apply(test1.df[1:10,c(8,10)],2,count1a)
>> >> >     X1_1_HZP1 X1_1_HBM1_yr
>> >> >             2            3
>> >> >>
>> >> > I am really baffled.  If I use count1a on a single column, it works
>> >> fine.
>> >> >
>> >> > Any suggestions much appreciated.
>> >> > Thanks,
>> >> > Sincerely,
>> >> > Erin
>> >> >
>> >> >
>> >> > Erin Hodgess, PhD
>> >> > mailto: erinm.hodgess at gmail.com
>> >> >
>> >> >       [[alternative HTML version deleted]]
>> >> >
>> >> > ______________________________________________
>> >> > R-help at r-project.org
>>
>>  mailing list -- To UNSUBSCRIBE and more, see
>> >> > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8SJJdx6Uq0p4rpBa4E3DkmQ65UImH48MBvSbrfE$
>> >> > PLEASE do read the posting guide
>> >> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8SJJdx6Uq0p4rpBa4E3DkmQ65UImH48MdYOqruE$
>> >> > and provide commented, minimal, self-contained, reproducible code.
>> >> --
>> >> John Fox, Professor Emeritus
>> >> McMaster University
>> >> Hamilton, Ontario, Canada
>> >> web: https://urldefense.com/v3/__https://socialsciences.mcmaster.ca/jfox/__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8SJJdx6Uq0p4rpBa4E3DkmQ65UImH48MRU4wu3o$
>> >>
>> >>
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, seehttps://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8SJJdx6Uq0p4rpBa4E3DkmQ65UImH48MBvSbrfE$
>> PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8SJJdx6Uq0p4rpBa4E3DkmQ65UImH48MdYOqruE$
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> --
Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From @vi@e@gross m@iii@g oii gm@ii@com  Tue Aug  9 18:55:22 2022
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Tue, 9 Aug 2022 12:55:22 -0400
Subject: [R] Odd behavior of a function within apply
In-Reply-To: <CAE-dL2r2m+RPkv2etCv3Nt54_OH_OwN8ho=UCb00iS57pkcooA@mail.gmail.com>
References: <9435_1659979524_278HPNvu030617_CACxE24m2C3vzwGpYYoWVrLpLcx7jAK1FnnRHorwm-YFwDDzqPg@mail.gmail.com>
 <565e3f72-a449-753f-ebee-b44d0f62eb2b@mcmaster.ca>
 <CACxE24nUyFMb2sUneC4efnh11BiCvAdxGt50ZVe_GqyP1o20SQ@mail.gmail.com>
 <CACxE24mLEnwUvWACXEt8+EWNnGbgNWEMwndqTrxY=yCfp1oxfA@mail.gmail.com>
 <CAE-dL2r2m+RPkv2etCv3Nt54_OH_OwN8ho=UCb00iS57pkcooA@mail.gmail.com>
Message-ID: <00d001d8ac10$d0972450$71c56cf0$@gmail.com>

Yes, David, the function described seems to insist it be of type integer or type character and if the type was double or others might well fail as y would never be initialized.

The goal seems to be to count how many "missing" values are found as in NA if a numeric type or an empty string if character.

But you can have some form of NA in all kinds of object types including character as in this construct:

> x <- c("a", NA, "", "b", "NA)")
> x
[1] "a"   NA    ""    "b"   "NA)"

The above has three useless elements if both NA and "" are considered empty. So logically the condition could be to count NA and IF it is of type character, also count "". 

So rather than play games testing not just is.integer, is.double (or just is.numeric) as well as is.logical and is.raw, all the above can be tested with is.na() first to add up how many Na they contain. If then it is of type character, you can add any blank strings. 

So the algorithm would initialize y to sum(is.na(vec)) and then if the vec is character, add the sum of how many empty strings.

Alternately, the function should deal with what it wants to do if any other type is encountered. You can internally converts many things to integer or character and then operate on them. Or you can return a zero or raise an alarm when given something else.

In this case, simply setting y to zero before using it would make it defined and avoid the error, albeit report nothing found if it was a double or Boolean vector even if it did contain NA.


-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of David Carlson via R-help
Sent: Tuesday, August 9, 2022 11:33 AM
To: Erin Hodgess <erinm.hodgess at gmail.com>
Cc: r-help at r-project.org
Subject: Re: [R] Odd behavior of a function within apply

Could you have columns that are not character or integer so that y is never defined in the function?

count1a(1:5/3)
Error in count1a(1:5/3) : object 'y' not found

David Carlson


On Mon, Aug 8, 2022 at 1:35 PM Erin Hodgess <erinm.hodgess at gmail.com> wrote:

> OK.?? I'm back again.?? So my test1.??df is 236x390 If I put in the 
> following:?? lapply(test1.??df,count1a) Error in FUN(X[[i]], 
> .??.??.??) :?? object 'y' not found > lapply(test1.??df,count1a) Error 
> in FUN(X[[i]],
> .??.??.??) :?? object 'y' not found > sapply(test1.??df,count1a) 
> ZjQcmQRYFpfptBannerStart This Message Is From an External Sender This 
> message came from outside your organization.
>
> ZjQcmQRYFpfptBannerEnd
>
> OK.  I'm back again.
>
> So my test1.df is 236x390
>
> If I put in the following:
>  lapply(test1.df,count1a)
> Error in FUN(X[[i]], ...) : object 'y' not found
> > lapply(test1.df,count1a)
> Error in FUN(X[[i]], ...) : object 'y' not found
> > sapply(test1.df,count1a)
> Error in FUN(X[[i]], ...) : object 'y' not found
> >
> What am I doing wrong, please?
> Thanks,
> Erin
>
>
> Erin Hodgess, PhD
> mailto: erinm.hodgess at gmail.com
>
>
> On Mon, Aug 8, 2022 at 1:41 PM Erin Hodgess <erinm.hodgess at gmail.com> wrote:
>
> > Awesome, thanks so much!!
> >
> > Erin Hodgess, PhD
> > mailto: erinm.hodgess at gmail.com
> >
> >
> > On Mon, Aug 8, 2022 at 1:38 PM John Fox <jfox at mcmaster.ca> wrote:
> >
> >> Dear Erin,
> >>
> >> The problem is that the data frame gets coerced to a character 
> >> matrix, and the only column with "" entries is the 9th (the second 
> >> one you
> >> supplied):
> >>
> >> as.matrix(test1.df)
> >>     X1_1_HZP1 X1_1_HBM1_mon X1_1_HBM1_yr
> >> 1  "48160"   "December"    "2014"
> >> 2  "48198"   "June"        "2018"
> >> 3  "80027"   "August"      "2016"
> >> 4  "48161"   ""            NA
> >> 5  NA        ""            NA
> >> 6  "48911"   "August"      "1985"
> >> 7  NA        "April"       "2019"
> >> 8  "48197"   "February"    "1993"
> >> 9  "48021"   ""            NA
> >> 10 "11355"   "December"    "1990"
> >>
> >> (Here, test1.df only contains the three columns you provided.)
> >>
> >> A solution is to use sapply:
> >>
> >>  > sapply(test1.df, count1a)
> >>      X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
> >>              2             3             3
> >>
> >>
> >> I hope this helps,
> >>   John
> >>
> >>
> >> On 2022-08-08 1:22 p.m., Erin Hodgess wrote:
> >> > Hello!
> >> >
> >> > I have the following data.frame
> >> >   dput(test1.df[1:10,8:10])
> >> > structure(list(X1_1_HZP1 = c(48160L, 48198L, 80027L, 48161L, NA, 
> >> > 48911L, NA, 48197L, 48021L, 11355L), X1_1_HBM1_mon = 
> >> > c("December", "June", "August", "", "", "August", "April", 
> >> > "February", "", "December"), X1_1_HBM1_yr = c(2014L, 2018L, 
> >> > 2016L, NA, NA, 1985L, 2019L, 1993L, NA, 1990L)), row.names = 
> >> > c(NA, 10L), class = "data.frame")
> >> >
> >> > And the following function:
> >> >> dput(count1a)
> >> > function (x)
> >> > {
> >> >      if (typeof(x) == "integer")
> >> >          y <- sum(is.na(x))
> >> >      if (typeof(x) == "character")
> >> >          y <- sum(x == "")
> >> >      return(y)
> >> > }
> >> > When I use the apply function with count1a, I get the following:
> >> >   apply(test1.df[1:10,8:10],2,count1a)
> >> >      X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
> >> >             NA             3            NA
> >> > However, when I do use columns 8 and 10, I get the correct response:
> >> >   apply(test1.df[1:10,c(8,10)],2,count1a)
> >> >     X1_1_HZP1 X1_1_HBM1_yr
> >> >             2            3
> >> >>
> >> > I am really baffled.  If I use count1a on a single column, it 
> >> > works
> >> fine.
> >> >
> >> > Any suggestions much appreciated.
> >> > Thanks,
> >> > Sincerely,
> >> > Erin
> >> >
> >> >
> >> > Erin Hodgess, PhD
> >> > mailto: erinm.hodgess at gmail.com
> >> >
> >> >       [[alternative HTML version deleted]]
> >> >
> >> > ______________________________________________
> >> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> >> > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo
> >> > /r-help__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kd
> >> > RHAy8SJJdx6Uq0p4rpBa4E3DkmQ65UImH48MBvSbrfE$
> >> > PLEASE do read the posting guide
> >> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.
> >> html__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8
> >> SJJdx6Uq0p4rpBa4E3DkmQ65UImH48MdYOqruE$
> >> > and provide commented, minimal, self-contained, reproducible code.
> >> --
> >> John Fox, Professor Emeritus
> >> McMaster University
> >> Hamilton, Ontario, Canada
> >> web: 
> >> https://urldefense.com/v3/__https://socialsciences.mcmaster.ca/jfox
> >> /__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8SJJ
> >> dx6Uq0p4rpBa4E3DkmQ65UImH48MRU4wu3o$
> >>
> >>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________R-help at r-project.org 
> mailing list -- To UNSUBSCRIBE and more, 
> seehttps://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r
> -help__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8SJ
> Jdx6Uq0p4rpBa4E3DkmQ65UImH48MBvSbrfE$
> PLEASE do read the posting guide 
> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.htm
> l__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8SJJdx6
> Uq0p4rpBa4E3DkmQ65UImH48MdYOqruE$ and provide commented, minimal, 
> self-contained, reproducible code.
>
>

	[[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From er|nm@hodge@@ @end|ng |rom gm@||@com  Tue Aug  9 19:04:11 2022
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Tue, 9 Aug 2022 13:04:11 -0400
Subject: [R] Odd behavior of a function within apply
In-Reply-To: <00d001d8ac10$d0972450$71c56cf0$@gmail.com>
References: <9435_1659979524_278HPNvu030617_CACxE24m2C3vzwGpYYoWVrLpLcx7jAK1FnnRHorwm-YFwDDzqPg@mail.gmail.com>
 <565e3f72-a449-753f-ebee-b44d0f62eb2b@mcmaster.ca>
 <CACxE24nUyFMb2sUneC4efnh11BiCvAdxGt50ZVe_GqyP1o20SQ@mail.gmail.com>
 <CACxE24mLEnwUvWACXEt8+EWNnGbgNWEMwndqTrxY=yCfp1oxfA@mail.gmail.com>
 <CAE-dL2r2m+RPkv2etCv3Nt54_OH_OwN8ho=UCb00iS57pkcooA@mail.gmail.com>
 <00d001d8ac10$d0972450$71c56cf0$@gmail.com>
Message-ID: <CACxE24nczvwmpB58+655guHmDE476MFvGUwGRJr78hP48Ei3Fg@mail.gmail.com>

Avi, that?s great!

Thanks

On Tue, Aug 9, 2022 at 12:56 PM <avi.e.gross at gmail.com> wrote:

> Yes, David, the function described seems to insist it be of type integer
> or type character and if the type was double or others might well fail as y
> would never be initialized.
>
> The goal seems to be to count how many "missing" values are found as in NA
> if a numeric type or an empty string if character.
>
> But you can have some form of NA in all kinds of object types including
> character as in this construct:
>
> > x <- c("a", NA, "", "b", "NA)")
> > x
> [1] "a"   NA    ""    "b"   "NA)"
>
> The above has three useless elements if both NA and "" are considered
> empty. So logically the condition could be to count NA and IF it is of type
> character, also count "".
>
> So rather than play games testing not just is.integer, is.double (or just
> is.numeric) as well as is.logical and is.raw, all the above can be tested
> with is.na() first to add up how many Na they contain. If then it is of
> type character, you can add any blank strings.
>
> So the algorithm would initialize y to sum(is.na(vec)) and then if the
> vec is character, add the sum of how many empty strings.
>
> Alternately, the function should deal with what it wants to do if any
> other type is encountered. You can internally converts many things to
> integer or character and then operate on them. Or you can return a zero or
> raise an alarm when given something else.
>
> In this case, simply setting y to zero before using it would make it
> defined and avoid the error, albeit report nothing found if it was a double
> or Boolean vector even if it did contain NA.
>
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of David Carlson
> via R-help
> Sent: Tuesday, August 9, 2022 11:33 AM
> To: Erin Hodgess <erinm.hodgess at gmail.com>
> Cc: r-help at r-project.org
> Subject: Re: [R] Odd behavior of a function within apply
>
> Could you have columns that are not character or integer so that y is
> never defined in the function?
>
> count1a(1:5/3)
> Error in count1a(1:5/3) : object 'y' not found
>
> David Carlson
>
>
> On Mon, Aug 8, 2022 at 1:35 PM Erin Hodgess <erinm.hodgess at gmail.com>
> wrote:
>
> > OK.?? I'm back again.?? So my test1.??df is 236x390 If I put in the
> > following:?? lapply(test1.??df,count1a) Error in FUN(X[[i]],
> > .??.??.??) :?? object 'y' not found > lapply(test1.??df,count1a) Error
> > in FUN(X[[i]],
> > .??.??.??) :?? object 'y' not found > sapply(test1.??df,count1a)
> > ZjQcmQRYFpfptBannerStart This Message Is From an External Sender This
> > message came from outside your organization.
> >
> > ZjQcmQRYFpfptBannerEnd
> >
> > OK.  I'm back again.
> >
> > So my test1.df is 236x390
> >
> > If I put in the following:
> >  lapply(test1.df,count1a)
> > Error in FUN(X[[i]], ...) : object 'y' not found
> > > lapply(test1.df,count1a)
> > Error in FUN(X[[i]], ...) : object 'y' not found
> > > sapply(test1.df,count1a)
> > Error in FUN(X[[i]], ...) : object 'y' not found
> > >
> > What am I doing wrong, please?
> > Thanks,
> > Erin
> >
> >
> > Erin Hodgess, PhD
> > mailto: erinm.hodgess at gmail.com
> >
> >
> > On Mon, Aug 8, 2022 at 1:41 PM Erin Hodgess <erinm.hodgess at gmail.com>
> wrote:
> >
> > > Awesome, thanks so much!!
> > >
> > > Erin Hodgess, PhD
> > > mailto: erinm.hodgess at gmail.com
> > >
> > >
> > > On Mon, Aug 8, 2022 at 1:38 PM John Fox <jfox at mcmaster.ca> wrote:
> > >
> > >> Dear Erin,
> > >>
> > >> The problem is that the data frame gets coerced to a character
> > >> matrix, and the only column with "" entries is the 9th (the second
> > >> one you
> > >> supplied):
> > >>
> > >> as.matrix(test1.df)
> > >>     X1_1_HZP1 X1_1_HBM1_mon X1_1_HBM1_yr
> > >> 1  "48160"   "December"    "2014"
> > >> 2  "48198"   "June"        "2018"
> > >> 3  "80027"   "August"      "2016"
> > >> 4  "48161"   ""            NA
> > >> 5  NA        ""            NA
> > >> 6  "48911"   "August"      "1985"
> > >> 7  NA        "April"       "2019"
> > >> 8  "48197"   "February"    "1993"
> > >> 9  "48021"   ""            NA
> > >> 10 "11355"   "December"    "1990"
> > >>
> > >> (Here, test1.df only contains the three columns you provided.)
> > >>
> > >> A solution is to use sapply:
> > >>
> > >>  > sapply(test1.df, count1a)
> > >>      X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
> > >>              2             3             3
> > >>
> > >>
> > >> I hope this helps,
> > >>   John
> > >>
> > >>
> > >> On 2022-08-08 1:22 p.m., Erin Hodgess wrote:
> > >> > Hello!
> > >> >
> > >> > I have the following data.frame
> > >> >   dput(test1.df[1:10,8:10])
> > >> > structure(list(X1_1_HZP1 = c(48160L, 48198L, 80027L, 48161L, NA,
> > >> > 48911L, NA, 48197L, 48021L, 11355L), X1_1_HBM1_mon =
> > >> > c("December", "June", "August", "", "", "August", "April",
> > >> > "February", "", "December"), X1_1_HBM1_yr = c(2014L, 2018L,
> > >> > 2016L, NA, NA, 1985L, 2019L, 1993L, NA, 1990L)), row.names =
> > >> > c(NA, 10L), class = "data.frame")
> > >> >
> > >> > And the following function:
> > >> >> dput(count1a)
> > >> > function (x)
> > >> > {
> > >> >      if (typeof(x) == "integer")
> > >> >          y <- sum(is.na(x))
> > >> >      if (typeof(x) == "character")
> > >> >          y <- sum(x == "")
> > >> >      return(y)
> > >> > }
> > >> > When I use the apply function with count1a, I get the following:
> > >> >   apply(test1.df[1:10,8:10],2,count1a)
> > >> >      X1_1_HZP1 X1_1_HBM1_mon  X1_1_HBM1_yr
> > >> >             NA             3            NA
> > >> > However, when I do use columns 8 and 10, I get the correct response:
> > >> >   apply(test1.df[1:10,c(8,10)],2,count1a)
> > >> >     X1_1_HZP1 X1_1_HBM1_yr
> > >> >             2            3
> > >> >>
> > >> > I am really baffled.  If I use count1a on a single column, it
> > >> > works
> > >> fine.
> > >> >
> > >> > Any suggestions much appreciated.
> > >> > Thanks,
> > >> > Sincerely,
> > >> > Erin
> > >> >
> > >> >
> > >> > Erin Hodgess, PhD
> > >> > mailto: erinm.hodgess at gmail.com
> > >> >
> > >> >       [[alternative HTML version deleted]]
> > >> >
> > >> > ______________________________________________
> > >> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > >> > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo
> > >> > /r-help__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kd
> > >> > RHAy8SJJdx6Uq0p4rpBa4E3DkmQ65UImH48MBvSbrfE$
> > >> > PLEASE do read the posting guide
> > >> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.
> > >> html__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8
> > >> SJJdx6Uq0p4rpBa4E3DkmQ65UImH48MdYOqruE$
> > >> > and provide commented, minimal, self-contained, reproducible code.
> > >> --
> > >> John Fox, Professor Emeritus
> > >> McMaster University
> > >> Hamilton, Ontario, Canada
> > >> web:
> > >> https://urldefense.com/v3/__https://socialsciences.mcmaster.ca/jfox
> > >> /__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8SJJ
> > >> dx6Uq0p4rpBa4E3DkmQ65UImH48MRU4wu3o$
> > >>
> > >>
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________R-help at r-project.org
> > mailing list -- To UNSUBSCRIBE and more,
> > seehttps://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r
> > -help__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8SJ
> > Jdx6Uq0p4rpBa4E3DkmQ65UImH48MBvSbrfE$
> > PLEASE do read the posting guide
> > https://urldefense.com/v3/__http://www.R-project.org/posting-guide.htm
> > l__;!!KwNVnqRv!CHx9JKnbOObpAt0LltEogLSxDUEl9qJDI6FgqMJBG_kdRHAy8SJJdx6
> > Uq0p4rpBa4E3DkmQ65UImH48MdYOqruE$ and provide commented, minimal,
> > self-contained, reproducible code.
> >
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
-- 
Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Wed Aug 10 13:18:56 2022
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Wed, 10 Aug 2022 07:18:56 -0400
Subject: [R] lattice question
Message-ID: <BL0PR01MB40360688E655910F3A8FC982FA659@BL0PR01MB4036.prod.exchangelabs.com>


I want to merge two panels into one.  Is it possible to do this?

Thanks,
Naresh

library(lattice)
mydf <- data.frame(date = rep(seq.Date(as.Date("2022-08-01"), by = 1,
length.out = 10), 2), name = c(rep("Aa", 10), rep("Bb", 10)),
long = runif(20, 2, 10), short = runif(20, -10, 0))

# This plots data in two panels.  I want all four lines in one panel. 
xyplot(long + short ~ date, groups = name, data = mydf, type = c("l",
"g"))

# This does not work
# No error in R session
# Graph window says: "Error using packet 1
# argument 'subscripts' is missing, with no default"
xyplot(long ~ date, data = mydf, groups = name, type = c("l", "g"),
panel = function(x, y, ..., subscripts) {
  panel.xyplot(x, y, ...)
  panel.xyplot(mydf$date[subscripts], mydf$short[subscripts], ...)})


From deep@y@n@@@rk@r @end|ng |rom gm@||@com  Wed Aug 10 15:37:03 2022
From: deep@y@n@@@rk@r @end|ng |rom gm@||@com (Deepayan Sarkar)
Date: Wed, 10 Aug 2022 19:07:03 +0530
Subject: [R] lattice question
In-Reply-To: <BL0PR01MB40360688E655910F3A8FC982FA659@BL0PR01MB4036.prod.exchangelabs.com>
References: <BL0PR01MB40360688E655910F3A8FC982FA659@BL0PR01MB4036.prod.exchangelabs.com>
Message-ID: <CADfFDC4O+p1FJ5HgmQBqu8mf6kh0fM_Tcmxm_1g64xgVgssfRA@mail.gmail.com>

On Wed, Aug 10, 2022 at 4:53 PM Naresh Gurbuxani
<naresh_gurbuxani at hotmail.com> wrote:
>
>
> I want to merge two panels into one.  Is it possible to do this?
>
> Thanks,
> Naresh
>
> library(lattice)
> mydf <- data.frame(date = rep(seq.Date(as.Date("2022-08-01"), by = 1,
> length.out = 10), 2), name = c(rep("Aa", 10), rep("Bb", 10)),
> long = runif(20, 2, 10), short = runif(20, -10, 0))
>
> # This plots data in two panels.  I want all four lines in one panel.
> xyplot(long + short ~ date, groups = name, data = mydf, type = c("l",
> "g"))

The "extended" formula API (with +) is really only meant as an
alternative to reshape() for simple cases. In your case, you probably
want something like

mydf.long = reshape(mydf, direction = "long", varying = list(c("long",
"short")), v.names = "X", timevar = "G", times = c("long", "short"))

xyplot(X ~ date, groups = interaction(name, G), data = mydf.long, type
= c("l", "g"))

-Deepayan

> # This does not work
> # No error in R session
> # Graph window says: "Error using packet 1
> # argument 'subscripts' is missing, with no default"
> xyplot(long ~ date, data = mydf, groups = name, type = c("l", "g"),
> panel = function(x, y, ..., subscripts) {
>   panel.xyplot(x, y, ...)
>   panel.xyplot(mydf$date[subscripts], mydf$short[subscripts], ...)})
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Wed Aug 10 23:12:14 2022
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Wed, 10 Aug 2022 21:12:14 +0000
Subject: [R] lattice question
In-Reply-To: <CADfFDC4O+p1FJ5HgmQBqu8mf6kh0fM_Tcmxm_1g64xgVgssfRA@mail.gmail.com>
References: <BL0PR01MB40360688E655910F3A8FC982FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CADfFDC4O+p1FJ5HgmQBqu8mf6kh0fM_Tcmxm_1g64xgVgssfRA@mail.gmail.com>
Message-ID: <BL0PR01MB403656FFA1AB68A5A0E6FB65FA659@BL0PR01MB4036.prod.exchangelabs.com>

Deepayan,

Thanks for providing a solution.  While this is close to my goal, I want one more change.  The line type (lty) should be the same for long and short.  The line type should only change according to ?name? group.  So the the graph will have two line types (not four as in your solution).  

Is it possible?

Thanks,
Narrsh

Sent from my iPhone

> On Aug 10, 2022, at 9:37 AM, Deepayan Sarkar <deepayan.sarkar at gmail.com> wrote:
> 
> ?On Wed, Aug 10, 2022 at 4:53 PM Naresh Gurbuxani
> <naresh_gurbuxani at hotmail.com> wrote:
>> 
>> 
>> I want to merge two panels into one.  Is it possible to do this?
>> 
>> Thanks,
>> Naresh
>> 
>> library(lattice)
>> mydf <- data.frame(date = rep(seq.Date(as.Date("2022-08-01"), by = 1,
>> length.out = 10), 2), name = c(rep("Aa", 10), rep("Bb", 10)),
>> long = runif(20, 2, 10), short = runif(20, -10, 0))
>> 
>> # This plots data in two panels.  I want all four lines in one panel.
>> xyplot(long + short ~ date, groups = name, data = mydf, type = c("l",
>> "g"))
> 
> The "extended" formula API (with +) is really only meant as an
> alternative to reshape() for simple cases. In your case, you probably
> want something like
> 
> mydf.long = reshape(mydf, direction = "long", varying = list(c("long",
> "short")), v.names = "X", timevar = "G", times = c("long", "short"))
> 
> xyplot(X ~ date, groups = interaction(name, G), data = mydf.long, type
> = c("l", "g"))
> 
> -Deepayan
> 
>> # This does not work
>> # No error in R session
>> # Graph window says: "Error using packet 1
>> # argument 'subscripts' is missing, with no default"
>> xyplot(long ~ date, data = mydf, groups = name, type = c("l", "g"),
>> panel = function(x, y, ..., subscripts) {
>>  panel.xyplot(x, y, ...)
>>  panel.xyplot(mydf$date[subscripts], mydf$short[subscripts], ...)})
>> 
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.

From bgunter@4567 @end|ng |rom gm@||@com  Wed Aug 10 23:40:23 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 10 Aug 2022 14:40:23 -0700
Subject: [R] lattice question
In-Reply-To: <BL0PR01MB403656FFA1AB68A5A0E6FB65FA659@BL0PR01MB4036.prod.exchangelabs.com>
References: <BL0PR01MB40360688E655910F3A8FC982FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CADfFDC4O+p1FJ5HgmQBqu8mf6kh0fM_Tcmxm_1g64xgVgssfRA@mail.gmail.com>
 <BL0PR01MB403656FFA1AB68A5A0E6FB65FA659@BL0PR01MB4036.prod.exchangelabs.com>
Message-ID: <CAGxFJbRSSVtkZSRY1JBYiePL42HNTWgRW4vcrrfE1h=ZjnDzfg@mail.gmail.com>

I assume you mean two line colors, not types.
Like this?

xyplot(X ~ date, groups = interaction(name,G), data = mydf.long,
       type = c("l", "g"), col.line = c("blue","red"))


Cheers,
Bert

On Wed, Aug 10, 2022 at 2:12 PM Naresh Gurbuxani
<naresh_gurbuxani at hotmail.com> wrote:
>
> Deepayan,
>
> Thanks for providing a solution.  While this is close to my goal, I want one more change.  The line type (lty) should be the same for long and short.  The line type should only change according to ?name? group.  So the the graph will have two line types (not four as in your solution).
>
> Is it possible?
>
> Thanks,
> Narrsh
>
> Sent from my iPhone
>
> > On Aug 10, 2022, at 9:37 AM, Deepayan Sarkar <deepayan.sarkar at gmail.com> wrote:
> >
> > ?On Wed, Aug 10, 2022 at 4:53 PM Naresh Gurbuxani
> > <naresh_gurbuxani at hotmail.com> wrote:
> >>
> >>
> >> I want to merge two panels into one.  Is it possible to do this?
> >>
> >> Thanks,
> >> Naresh
> >>
> >> library(lattice)
> >> mydf <- data.frame(date = rep(seq.Date(as.Date("2022-08-01"), by = 1,
> >> length.out = 10), 2), name = c(rep("Aa", 10), rep("Bb", 10)),
> >> long = runif(20, 2, 10), short = runif(20, -10, 0))
> >>
> >> # This plots data in two panels.  I want all four lines in one panel.
> >> xyplot(long + short ~ date, groups = name, data = mydf, type = c("l",
> >> "g"))
> >
> > The "extended" formula API (with +) is really only meant as an
> > alternative to reshape() for simple cases. In your case, you probably
> > want something like
> >
> > mydf.long = reshape(mydf, direction = "long", varying = list(c("long",
> > "short")), v.names = "X", timevar = "G", times = c("long", "short"))
> >
> > xyplot(X ~ date, groups = interaction(name, G), data = mydf.long, type
> > = c("l", "g"))
> >
> > -Deepayan
> >
> >> # This does not work
> >> # No error in R session
> >> # Graph window says: "Error using packet 1
> >> # argument 'subscripts' is missing, with no default"
> >> xyplot(long ~ date, data = mydf, groups = name, type = c("l", "g"),
> >> panel = function(x, y, ..., subscripts) {
> >>  panel.xyplot(x, y, ...)
> >>  panel.xyplot(mydf$date[subscripts], mydf$short[subscripts], ...)})
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Thu Aug 11 01:57:11 2022
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Wed, 10 Aug 2022 23:57:11 +0000
Subject: [R] lattice question
In-Reply-To: <CAGxFJbRSSVtkZSRY1JBYiePL42HNTWgRW4vcrrfE1h=ZjnDzfg@mail.gmail.com>
References: <BL0PR01MB40360688E655910F3A8FC982FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CADfFDC4O+p1FJ5HgmQBqu8mf6kh0fM_Tcmxm_1g64xgVgssfRA@mail.gmail.com>
 <BL0PR01MB403656FFA1AB68A5A0E6FB65FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CAGxFJbRSSVtkZSRY1JBYiePL42HNTWgRW4vcrrfE1h=ZjnDzfg@mail.gmail.com>
Message-ID: <BL0PR01MB4036724D69DF755E571D1DD7FA659@BL0PR01MB4036.prod.exchangelabs.com>

Actually I meant types (e.g., lty = 1:2).  But colors would also work.  But I do not want to specify these in call to xyplot().

In my actual problem, there are more than two groups.  Moreover, the number of groups changes from case to case.  In my set up, I use trellis.par.set() to set line styles, colors, pch, etc.  

I would the call to xyplot() to automatically use the set options.

Thanks,
Naresh

Sent from my iPhone

> On Aug 10, 2022, at 5:40 PM, Bert Gunter <bgunter.4567 at gmail.com> wrote:
> 
> ?I assume you mean two line colors, not types.
> Like this?
> 
> xyplot(X ~ date, groups = interaction(name,G), data = mydf.long,
>       type = c("l", "g"), col.line = c("blue","red"))
> 
> 
> Cheers,
> Bert
> 
>> On Wed, Aug 10, 2022 at 2:12 PM Naresh Gurbuxani
>> <naresh_gurbuxani at hotmail.com> wrote:
>> 
>> Deepayan,
>> 
>> Thanks for providing a solution.  While this is close to my goal, I want one more change.  The line type (lty) should be the same for long and short.  The line type should only change according to ?name? group.  So the the graph will have two line types (not four as in your solution).
>> 
>> Is it possible?
>> 
>> Thanks,
>> Narrsh
>> 
>> Sent from my iPhone
>> 
>>>> On Aug 10, 2022, at 9:37 AM, Deepayan Sarkar <deepayan.sarkar at gmail.com> wrote:
>>> 
>>> ?On Wed, Aug 10, 2022 at 4:53 PM Naresh Gurbuxani
>>> <naresh_gurbuxani at hotmail.com> wrote:
>>>> 
>>>> 
>>>> I want to merge two panels into one.  Is it possible to do this?
>>>> 
>>>> Thanks,
>>>> Naresh
>>>> 
>>>> library(lattice)
>>>> mydf <- data.frame(date = rep(seq.Date(as.Date("2022-08-01"), by = 1,
>>>> length.out = 10), 2), name = c(rep("Aa", 10), rep("Bb", 10)),
>>>> long = runif(20, 2, 10), short = runif(20, -10, 0))
>>>> 
>>>> # This plots data in two panels.  I want all four lines in one panel.
>>>> xyplot(long + short ~ date, groups = name, data = mydf, type = c("l",
>>>> "g"))
>>> 
>>> The "extended" formula API (with +) is really only meant as an
>>> alternative to reshape() for simple cases. In your case, you probably
>>> want something like
>>> 
>>> mydf.long = reshape(mydf, direction = "long", varying = list(c("long",
>>> "short")), v.names = "X", timevar = "G", times = c("long", "short"))
>>> 
>>> xyplot(X ~ date, groups = interaction(name, G), data = mydf.long, type
>>> = c("l", "g"))
>>> 
>>> -Deepayan
>>> 
>>>> # This does not work
>>>> # No error in R session
>>>> # Graph window says: "Error using packet 1
>>>> # argument 'subscripts' is missing, with no default"
>>>> xyplot(long ~ date, data = mydf, groups = name, type = c("l", "g"),
>>>> panel = function(x, y, ..., subscripts) {
>>>> panel.xyplot(x, y, ...)
>>>> panel.xyplot(mydf$date[subscripts], mydf$short[subscripts], ...)})
>>>> 
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.

From bgunter@4567 @end|ng |rom gm@||@com  Thu Aug 11 04:02:16 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 10 Aug 2022 19:02:16 -0700
Subject: [R] lattice question
In-Reply-To: <BL0PR01MB4036724D69DF755E571D1DD7FA659@BL0PR01MB4036.prod.exchangelabs.com>
References: <BL0PR01MB40360688E655910F3A8FC982FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CADfFDC4O+p1FJ5HgmQBqu8mf6kh0fM_Tcmxm_1g64xgVgssfRA@mail.gmail.com>
 <BL0PR01MB403656FFA1AB68A5A0E6FB65FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CAGxFJbRSSVtkZSRY1JBYiePL42HNTWgRW4vcrrfE1h=ZjnDzfg@mail.gmail.com>
 <BL0PR01MB4036724D69DF755E571D1DD7FA659@BL0PR01MB4036.prod.exchangelabs.com>
Message-ID: <CAGxFJbSkuspyGR1-f=aED+WnR0bEVfxLV_C-pfkA8Xj4yfM9_w@mail.gmail.com>

It is unclear to me how you wish to define and distinguish groups.
Assuming you wish to have separate lines for the interaction as
Deepayan showed, but want the colors (or line types or both) to differ
only by by the "name" factor, then is this what you want?

trellis.par.set(superpose.line = list(lty = 1:6)) ## or other line
types you create
u.names <- unique(mydf.long$name)
xyplot(X ~ date, groups = interaction(name,G), data = mydf.long,
       type = c("l","g"),
       col.line = trellis.par.get("superpose.line")$col[
          seq_along(u.names)],
       lty =  trellis.par.get("superpose.line")$lty[
          seq_along(u.names)]
)

Notes:
1. If this is not what you want, I give up. Others may have better insight.
2. If this is what you want, Deepayan may be able to provide you a
nicer way to do it.
3. If you have more different names than 6 or 7, then you may have to
add more line types or colors to the superpose.line settings. Though I
would think the plot would be pretty much a mess, if so.

Bert


On Wed, Aug 10, 2022 at 4:57 PM Naresh Gurbuxani
<naresh_gurbuxani at hotmail.com> wrote:
>
> Actually I meant types (e.g., lty = 1:2).  But colors would also work.  But I do not want to specify these in call to xyplot().
>
> In my actual problem, there are more than two groups.  Moreover, the number of groups changes from case to case.  In my set up, I use trellis.par.set() to set line styles, colors, pch, etc.
>
> I would the call to xyplot() to automatically use the set options.
>
> Thanks,
> Naresh
>
> Sent from my iPhone
>
> > On Aug 10, 2022, at 5:40 PM, Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >
> > ?I assume you mean two line colors, not types.
> > Like this?
> >
> > xyplot(X ~ date, groups = interaction(name,G), data = mydf.long,
> >       type = c("l", "g"), col.line = c("blue","red"))
> >
> >
> > Cheers,
> > Bert
> >
> >> On Wed, Aug 10, 2022 at 2:12 PM Naresh Gurbuxani
> >> <naresh_gurbuxani at hotmail.com> wrote:
> >>
> >> Deepayan,
> >>
> >> Thanks for providing a solution.  While this is close to my goal, I want one more change.  The line type (lty) should be the same for long and short.  The line type should only change according to ?name? group.  So the the graph will have two line types (not four as in your solution).
> >>
> >> Is it possible?
> >>
> >> Thanks,
> >> Narrsh
> >>
> >> Sent from my iPhone
> >>
> >>>> On Aug 10, 2022, at 9:37 AM, Deepayan Sarkar <deepayan.sarkar at gmail.com> wrote:
> >>>
> >>> ?On Wed, Aug 10, 2022 at 4:53 PM Naresh Gurbuxani
> >>> <naresh_gurbuxani at hotmail.com> wrote:
> >>>>
> >>>>
> >>>> I want to merge two panels into one.  Is it possible to do this?
> >>>>
> >>>> Thanks,
> >>>> Naresh
> >>>>
> >>>> library(lattice)
> >>>> mydf <- data.frame(date = rep(seq.Date(as.Date("2022-08-01"), by = 1,
> >>>> length.out = 10), 2), name = c(rep("Aa", 10), rep("Bb", 10)),
> >>>> long = runif(20, 2, 10), short = runif(20, -10, 0))
> >>>>
> >>>> # This plots data in two panels.  I want all four lines in one panel.
> >>>> xyplot(long + short ~ date, groups = name, data = mydf, type = c("l",
> >>>> "g"))
> >>>
> >>> The "extended" formula API (with +) is really only meant as an
> >>> alternative to reshape() for simple cases. In your case, you probably
> >>> want something like
> >>>
> >>> mydf.long = reshape(mydf, direction = "long", varying = list(c("long",
> >>> "short")), v.names = "X", timevar = "G", times = c("long", "short"))
> >>>
> >>> xyplot(X ~ date, groups = interaction(name, G), data = mydf.long, type
> >>> = c("l", "g"))
> >>>
> >>> -Deepayan
> >>>
> >>>> # This does not work
> >>>> # No error in R session
> >>>> # Graph window says: "Error using packet 1
> >>>> # argument 'subscripts' is missing, with no default"
> >>>> xyplot(long ~ date, data = mydf, groups = name, type = c("l", "g"),
> >>>> panel = function(x, y, ..., subscripts) {
> >>>> panel.xyplot(x, y, ...)
> >>>> panel.xyplot(mydf$date[subscripts], mydf$short[subscripts], ...)})
> >>>>
> >>>> ______________________________________________
> >>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >>>> and provide commented, minimal, self-contained, reproducible code.
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.


From o1b|gtenor @end|ng |rom gm@||@com  Wed Aug 10 18:26:59 2022
From: o1b|gtenor @end|ng |rom gm@||@com (o1bigtenor)
Date: Wed, 10 Aug 2022 11:26:59 -0500
Subject: [R] lattice question
In-Reply-To: <CADfFDC4O+p1FJ5HgmQBqu8mf6kh0fM_Tcmxm_1g64xgVgssfRA@mail.gmail.com>
References: <BL0PR01MB40360688E655910F3A8FC982FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CADfFDC4O+p1FJ5HgmQBqu8mf6kh0fM_Tcmxm_1g64xgVgssfRA@mail.gmail.com>
Message-ID: <CAPpdf59NnXcLKsFRT+bi5vE0bfU=ntc62rUJJqmJETWo2n8M9Q@mail.gmail.com>

On Wed, Aug 10, 2022 at 8:38 AM Deepayan Sarkar
<deepayan.sarkar at gmail.com> wrote:
>
> On Wed, Aug 10, 2022 at 4:53 PM Naresh Gurbuxani
> <naresh_gurbuxani at hotmail.com> wrote:
> >
> >
> > I want to merge two panels into one.  Is it possible to do this?
> >
> > Thanks,
> > Naresh
> >
> > library(lattice)
> > mydf <- data.frame(date = rep(seq.Date(as.Date("2022-08-01"), by = 1,
> > length.out = 10), 2), name = c(rep("Aa", 10), rep("Bb", 10)),
> > long = runif(20, 2, 10), short = runif(20, -10, 0))
> >
> > # This plots data in two panels.  I want all four lines in one panel.
> > xyplot(long + short ~ date, groups = name, data = mydf, type = c("l",
> > "g"))
>
> The "extended" formula API (with +) is really only meant as an
> alternative to reshape() for simple cases. In your case, you probably
> want something like
>
> mydf.long = reshape(mydf, direction = "long", varying = list(c("long",
> "short")), v.names = "X", timevar = "G", times = c("long", "short"))
>
> xyplot(X ~ date, groups = interaction(name, G), data = mydf.long, type
> = c("l", "g"))
>

(In the interest of learning- - ) Why?

Regards


From n|ckmwr@y @end|ng |rom gm@||@com  Thu Aug 11 13:42:26 2022
From: n|ckmwr@y @end|ng |rom gm@||@com (Nick Wray)
Date: Thu, 11 Aug 2022 12:42:26 +0100
Subject: [R] lfstat package
Message-ID: <CABxY9BOruMUfw4+5Gc5saNhUOZRFqBEAWZXTY220Dwt6nqASfA@mail.gmail.com>

Hello - does anyone know whether the lfstat package is still running and if
so, whence it can be downloaded and installed, as it doesn't seem to be
available from CRAN.  I'm trying to get the function dmcurve() for
hydrological double mass curves - perhaps that's now elsewhere although i
can't find it anywhere but in lfstat

thanks Nick Wray

	[[alternative HTML version deleted]]


From co|or|e @end|ng |rom gm@||@com  Thu Aug 11 14:03:06 2022
From: co|or|e @end|ng |rom gm@||@com (Carlos Ortega)
Date: Thu, 11 Aug 2022 14:03:06 +0200
Subject: [R] lfstat package
In-Reply-To: <CABxY9BOruMUfw4+5Gc5saNhUOZRFqBEAWZXTY220Dwt6nqASfA@mail.gmail.com>
References: <CABxY9BOruMUfw4+5Gc5saNhUOZRFqBEAWZXTY220Dwt6nqASfA@mail.gmail.com>
Message-ID: <CAFKNbk+zVS3jQ4JejBwzh1L=9Wr02pwsQkq0LQnXH38HiYEC7Q@mail.gmail.com>

Hi,

Yes, it is not available in CRAN.
You can find packages that have been removed from CRAN here:

   - https://cran.r-project.org/src/contrib/Archive

And in particular "lfstat" is here, with all its historical releases (in
tar.gz format).
You can download from there and install, the version you need.


   - https://cran.r-project.org/src/contrib/Archive/lfstat/


Thanks,
Carlos Ortega.


On Thu, Aug 11, 2022 at 1:42 PM Nick Wray <nickmwray at gmail.com> wrote:

> Hello - does anyone know whether the lfstat package is still running and if
> so, whence it can be downloaded and installed, as it doesn't seem to be
> available from CRAN.  I'm trying to get the function dmcurve() for
> hydrological double mass curves - perhaps that's now elsewhere although i
> can't find it anywhere but in lfstat
>
> thanks Nick Wray
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Thu Aug 11 17:33:38 2022
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Thu, 11 Aug 2022 15:33:38 +0000
Subject: [R] lattice question
In-Reply-To: <CAGxFJbSkuspyGR1-f=aED+WnR0bEVfxLV_C-pfkA8Xj4yfM9_w@mail.gmail.com>
References: <BL0PR01MB40360688E655910F3A8FC982FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CADfFDC4O+p1FJ5HgmQBqu8mf6kh0fM_Tcmxm_1g64xgVgssfRA@mail.gmail.com>
 <BL0PR01MB403656FFA1AB68A5A0E6FB65FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CAGxFJbRSSVtkZSRY1JBYiePL42HNTWgRW4vcrrfE1h=ZjnDzfg@mail.gmail.com>
 <BL0PR01MB4036724D69DF755E571D1DD7FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CAGxFJbSkuspyGR1-f=aED+WnR0bEVfxLV_C-pfkA8Xj4yfM9_w@mail.gmail.com>
Message-ID: <BL0PR01MB403675492C3C426B8607BF8BFA649@BL0PR01MB4036.prod.exchangelabs.com>

Bert,

Thanks for providing this solution.  It produces the desired graph.

To see how I want to distinguish groups, you should look at original data (mydf).  There are two groups (Aa and Bb), each with two time series (long and short).  Long is always positive.  Short is always negative.  Therefore, there is no need to distinguish between long and short.  I only need to distinguish between Aa and Bb.  

I agree that more than six lines in the graph will make it cluttered.  In fact the above exercise is to avoid clutter in the key.  No need to show Aa.long and Aa.short, because long and short are obvious.

Thanks,
Naresh

Sent from my iPhone

> On Aug 10, 2022, at 10:02 PM, Bert Gunter <bgunter.4567 at gmail.com> wrote:
> 
> ?It is unclear to me how you wish to define and distinguish groups.
> Assuming you wish to have separate lines for the interaction as
> Deepayan showed, but want the colors (or line types or both) to differ
> only by by the "name" factor, then is this what you want?
> 
> trellis.par.set(superpose.line = list(lty = 1:6)) ## or other line
> types you create
> u.names <- unique(mydf.long$name)
> xyplot(X ~ date, groups = interaction(name,G), data = mydf.long,
>       type = c("l","g"),
>       col.line = trellis.par.get("superpose.line")$col[
>          seq_along(u.names)],
>       lty =  trellis.par.get("superpose.line")$lty[
>          seq_along(u.names)]
> )
> 
> Notes:
> 1. If this is not what you want, I give up. Others may have better insight.
> 2. If this is what you want, Deepayan may be able to provide you a
> nicer way to do it.
> 3. If you have more different names than 6 or 7, then you may have to
> add more line types or colors to the superpose.line settings. Though I
> would think the plot would be pretty much a mess, if so.
> 
> Bert
> 
> 
>> On Wed, Aug 10, 2022 at 4:57 PM Naresh Gurbuxani
>> <naresh_gurbuxani at hotmail.com> wrote:
>> 
>> Actually I meant types (e.g., lty = 1:2).  But colors would also work.  But I do not want to specify these in call to xyplot().
>> 
>> In my actual problem, there are more than two groups.  Moreover, the number of groups changes from case to case.  In my set up, I use trellis.par.set() to set line styles, colors, pch, etc.
>> 
>> I would the call to xyplot() to automatically use the set options.
>> 
>> Thanks,
>> Naresh
>> 
>> Sent from my iPhone
>> 
>>>> On Aug 10, 2022, at 5:40 PM, Bert Gunter <bgunter.4567 at gmail.com> wrote:
>>> 
>>> ?I assume you mean two line colors, not types.
>>> Like this?
>>> 
>>> xyplot(X ~ date, groups = interaction(name,G), data = mydf.long,
>>>      type = c("l", "g"), col.line = c("blue","red"))
>>> 
>>> 
>>> Cheers,
>>> Bert
>>> 
>>>> On Wed, Aug 10, 2022 at 2:12 PM Naresh Gurbuxani
>>>> <naresh_gurbuxani at hotmail.com> wrote:
>>>> 
>>>> Deepayan,
>>>> 
>>>> Thanks for providing a solution.  While this is close to my goal, I want one more change.  The line type (lty) should be the same for long and short.  The line type should only change according to ?name? group.  So the the graph will have two line types (not four as in your solution).
>>>> 
>>>> Is it possible?
>>>> 
>>>> Thanks,
>>>> Narrsh
>>>> 
>>>> Sent from my iPhone
>>>> 
>>>>>> On Aug 10, 2022, at 9:37 AM, Deepayan Sarkar <deepayan.sarkar at gmail.com> wrote:
>>>>> 
>>>>> ?On Wed, Aug 10, 2022 at 4:53 PM Naresh Gurbuxani
>>>>> <naresh_gurbuxani at hotmail.com> wrote:
>>>>>> 
>>>>>> 
>>>>>> I want to merge two panels into one.  Is it possible to do this?
>>>>>> 
>>>>>> Thanks,
>>>>>> Naresh
>>>>>> 
>>>>>> library(lattice)
>>>>>> mydf <- data.frame(date = rep(seq.Date(as.Date("2022-08-01"), by = 1,
>>>>>> length.out = 10), 2), name = c(rep("Aa", 10), rep("Bb", 10)),
>>>>>> long = runif(20, 2, 10), short = runif(20, -10, 0))
>>>>>> 
>>>>>> # This plots data in two panels.  I want all four lines in one panel.
>>>>>> xyplot(long + short ~ date, groups = name, data = mydf, type = c("l",
>>>>>> "g"))
>>>>> 
>>>>> The "extended" formula API (with +) is really only meant as an
>>>>> alternative to reshape() for simple cases. In your case, you probably
>>>>> want something like
>>>>> 
>>>>> mydf.long = reshape(mydf, direction = "long", varying = list(c("long",
>>>>> "short")), v.names = "X", timevar = "G", times = c("long", "short"))
>>>>> 
>>>>> xyplot(X ~ date, groups = interaction(name, G), data = mydf.long, type
>>>>> = c("l", "g"))
>>>>> 
>>>>> -Deepayan
>>>>> 
>>>>>> # This does not work
>>>>>> # No error in R session
>>>>>> # Graph window says: "Error using packet 1
>>>>>> # argument 'subscripts' is missing, with no default"
>>>>>> xyplot(long ~ date, data = mydf, groups = name, type = c("l", "g"),
>>>>>> panel = function(x, y, ..., subscripts) {
>>>>>> panel.xyplot(x, y, ...)
>>>>>> panel.xyplot(mydf$date[subscripts], mydf$short[subscripts], ...)})
>>>>>> 
>>>>>> ______________________________________________
>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.

From bogu@@chr|@to|er @end|ng |rom gm@||@com  Thu Aug 11 16:50:09 2022
From: bogu@@chr|@to|er @end|ng |rom gm@||@com (bogus christofer)
Date: Thu, 11 Aug 2022 20:20:09 +0530
Subject: [R] Fitted values from AR model
Message-ID: <CAJKTqP7tOuF7TUiiuMpbRQOVwRCXsZVPXe9R7bQhG2O-Wj6HVg@mail.gmail.com>

Hi,

I have below AR model and fitted values from the forecast package

library(forecast)
dta = c(5.0, 11, 16, 23, 36, 58, 29, 20, 10, 8, 3, 0, 0, 2, 11, 27, 47, 63,
60, 39)
fit <- arima(dta, order=c(2,0,0))
fitted(fit)

This gives fitted values as

Time Series:
Start = 1
End = 20
Frequency = 1
 [1] 13.461017  9.073427 18.022166 20.689420 26.352282 38.165635 57.502926
9.812106 15.335303  8.298995 11.543320  6.606999  5.800820  7.502621
9.930962 19.723966 34.045298 49.252447 57.333846 44.615067


However when I compare this result with Python, I see significant
difference particularly in the first few values as below

from statsmodels.tsa.arima.model import ARIMA
dta = [5.0, 11, 16, 23, 36, 58, 29, 20, 10, 8, 3, 0, 0, 2, 11, 27, 47, 63,
60, 39]
fit = ARIMA(dta, order=(2, 0, 0)).fit()
fit.predict()

array([21.24816788, 8.66048306, 18.02197059, 20.68931006,
26.35225759,38.16574655, 57.503278 , 9.81253693, 15.33539514,
8.29894655,11.54316056, 6.60679489, 5.80055038, 7.50232004,
9.93067155,19.72374025, 34.04524337, 49.25265365, 57.3343347 , 44.6157026 ])

Any idea why there are such difference between R and Python results will be
very helpful.

Thanks,

	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Fri Aug 12 10:13:40 2022
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Fri, 12 Aug 2022 11:13:40 +0300
Subject: [R] Fitted values from AR model
In-Reply-To: <CAJKTqP7tOuF7TUiiuMpbRQOVwRCXsZVPXe9R7bQhG2O-Wj6HVg@mail.gmail.com>
References: <CAJKTqP7tOuF7TUiiuMpbRQOVwRCXsZVPXe9R7bQhG2O-Wj6HVg@mail.gmail.com>
Message-ID: <CAGgJW74rxrDzwL2CqKy7c-YmdakRqkn8_1Jm=88_Skd_vZX+JA@mail.gmail.com>

The model that you are fitting to the data is an AR(2) model, which means

y(t) = a0 + a1 * y(t-1) + a2 * y(t-2) + eps(t)                 (1)

The fitting procedure estimates the coefficients a0, a1, a2 (and the
variance of eps).

After the coefficients have been estimated, the fitted values can be
calculated using equation (1) (setting eps(t) = 0)
using
fitted(t) = a0 + a1 * y(t-1) + a2 * y(t-2)

Assuming the series is given for t=1,2,...,20, there is no problem to
apply equation (1) to get the
fitted values for t=3,4,...,20. But there is a problem for t=1 and
t=2. For example, for t=1, equation (1)
says

fitted(1) = a0 + a1 * y(0) + a2 * y(-1)

But there are no values given for y(0) and y(-1). So, either no fitted
values should be given for t=1,2, or some
other method is being used. Apparently, the arima functions in R and
python use different methodology
to generate these two fitted points. (For all the other values, the
fits are extremely close.)

HTH,
Eric

On Thu, Aug 11, 2022 at 9:53 PM bogus christofer
<bogus.christofer at gmail.com> wrote:
>
> Hi,
>
> I have below AR model and fitted values from the forecast package
>
> library(forecast)
> dta = c(5.0, 11, 16, 23, 36, 58, 29, 20, 10, 8, 3, 0, 0, 2, 11, 27, 47, 63,
> 60, 39)
> fit <- arima(dta, order=c(2,0,0))
> fitted(fit)
>
> This gives fitted values as
>
> Time Series:
> Start = 1
> End = 20
> Frequency = 1
>  [1] 13.461017  9.073427 18.022166 20.689420 26.352282 38.165635 57.502926
> 9.812106 15.335303  8.298995 11.543320  6.606999  5.800820  7.502621
> 9.930962 19.723966 34.045298 49.252447 57.333846 44.615067
>
>
> However when I compare this result with Python, I see significant
> difference particularly in the first few values as below
>
> from statsmodels.tsa.arima.model import ARIMA
> dta = [5.0, 11, 16, 23, 36, 58, 29, 20, 10, 8, 3, 0, 0, 2, 11, 27, 47, 63,
> 60, 39]
> fit = ARIMA(dta, order=(2, 0, 0)).fit()
> fit.predict()
>
> array([21.24816788, 8.66048306, 18.02197059, 20.68931006,
> 26.35225759,38.16574655, 57.503278 , 9.81253693, 15.33539514,
> 8.29894655,11.54316056, 6.60679489, 5.80055038, 7.50232004,
> 9.93067155,19.72374025, 34.04524337, 49.25265365, 57.3343347 , 44.6157026 ])
>
> Any idea why there are such difference between R and Python results will be
> very helpful.
>
> Thanks,
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From deep@y@n@@@rk@r @end|ng |rom gm@||@com  Fri Aug 12 14:01:51 2022
From: deep@y@n@@@rk@r @end|ng |rom gm@||@com (Deepayan Sarkar)
Date: Fri, 12 Aug 2022 17:31:51 +0530
Subject: [R] lattice question
In-Reply-To: <BL0PR01MB403675492C3C426B8607BF8BFA649@BL0PR01MB4036.prod.exchangelabs.com>
References: <BL0PR01MB40360688E655910F3A8FC982FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CADfFDC4O+p1FJ5HgmQBqu8mf6kh0fM_Tcmxm_1g64xgVgssfRA@mail.gmail.com>
 <BL0PR01MB403656FFA1AB68A5A0E6FB65FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CAGxFJbRSSVtkZSRY1JBYiePL42HNTWgRW4vcrrfE1h=ZjnDzfg@mail.gmail.com>
 <BL0PR01MB4036724D69DF755E571D1DD7FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CAGxFJbSkuspyGR1-f=aED+WnR0bEVfxLV_C-pfkA8Xj4yfM9_w@mail.gmail.com>
 <BL0PR01MB403675492C3C426B8607BF8BFA649@BL0PR01MB4036.prod.exchangelabs.com>
Message-ID: <CADfFDC5qH_e1dh96pfRAViwt5GEu_shgUh=Fj-2eLV6hZsySDg@mail.gmail.com>

On Thu, Aug 11, 2022 at 9:03 PM Naresh Gurbuxani <
naresh_gurbuxani at hotmail.com> wrote:

> Bert,
>
> Thanks for providing this solution.  It produces the desired graph.
>
> To see how I want to distinguish groups, you should look at original data
> (mydf).  There are two groups (Aa and Bb), each with two time series (long
> and short).  Long is always positive.  Short is always negative.
> Therefore, there is no need to distinguish between long and short.  I only
> need to distinguish between Aa and Bb.
>
> I agree that more than six lines in the graph will make it cluttered.  In
> fact the above exercise is to avoid clutter in the key.  No need to show
> Aa.long and Aa.short, because long and short are obvious.
>

In that case, this alternative approach may be conceptually simpler:

library(latticeExtra)

r <- with(mydf, extendrange(range(long, short)))

plong <- xyplot(long ~ date, groups = name, data = mydf,
                type = "l", grid = TRUE,
                ylim = r)

pshort <- xyplot(short ~ date, groups = name, data = mydf, type = "l")

plong + pshort

The first plot here is the "main" one, so you need to make sure that its
'ylim' is big enough for all the data.

-Deepayan



>
> Thanks,
> Naresh
>
> Sent from my iPhone
>
> > On Aug 10, 2022, at 10:02 PM, Bert Gunter <bgunter.4567 at gmail.com>
> wrote:
> >
> > ?It is unclear to me how you wish to define and distinguish groups.
> > Assuming you wish to have separate lines for the interaction as
> > Deepayan showed, but want the colors (or line types or both) to differ
> > only by by the "name" factor, then is this what you want?
> >
> > trellis.par.set(superpose.line = list(lty = 1:6)) ## or other line
> > types you create
> > u.names <- unique(mydf.long$name)
> > xyplot(X ~ date, groups = interaction(name,G), data = mydf.long,
> >       type = c("l","g"),
> >       col.line = trellis.par.get("superpose.line")$col[
> >          seq_along(u.names)],
> >       lty =  trellis.par.get("superpose.line")$lty[
> >          seq_along(u.names)]
> > )
> >
> > Notes:
> > 1. If this is not what you want, I give up. Others may have better
> insight.
> > 2. If this is what you want, Deepayan may be able to provide you a
> > nicer way to do it.
> > 3. If you have more different names than 6 or 7, then you may have to
> > add more line types or colors to the superpose.line settings. Though I
> > would think the plot would be pretty much a mess, if so.
> >
> > Bert
> >
> >
> >> On Wed, Aug 10, 2022 at 4:57 PM Naresh Gurbuxani
> >> <naresh_gurbuxani at hotmail.com> wrote:
> >>
> >> Actually I meant types (e.g., lty = 1:2).  But colors would also work.
> But I do not want to specify these in call to xyplot().
> >>
> >> In my actual problem, there are more than two groups.  Moreover, the
> number of groups changes from case to case.  In my set up, I use
> trellis.par.set() to set line styles, colors, pch, etc.
> >>
> >> I would the call to xyplot() to automatically use the set options.
> >>
> >> Thanks,
> >> Naresh
> >>
> >> Sent from my iPhone
> >>
> >>>> On Aug 10, 2022, at 5:40 PM, Bert Gunter <bgunter.4567 at gmail.com>
> wrote:
> >>>
> >>> ?I assume you mean two line colors, not types.
> >>> Like this?
> >>>
> >>> xyplot(X ~ date, groups = interaction(name,G), data = mydf.long,
> >>>      type = c("l", "g"), col.line = c("blue","red"))
> >>>
> >>>
> >>> Cheers,
> >>> Bert
> >>>
> >>>> On Wed, Aug 10, 2022 at 2:12 PM Naresh Gurbuxani
> >>>> <naresh_gurbuxani at hotmail.com> wrote:
> >>>>
> >>>> Deepayan,
> >>>>
> >>>> Thanks for providing a solution.  While this is close to my goal, I
> want one more change.  The line type (lty) should be the same for long and
> short.  The line type should only change according to ?name? group.  So the
> the graph will have two line types (not four as in your solution).
> >>>>
> >>>> Is it possible?
> >>>>
> >>>> Thanks,
> >>>> Narrsh
> >>>>
> >>>> Sent from my iPhone
> >>>>
> >>>>>> On Aug 10, 2022, at 9:37 AM, Deepayan Sarkar <
> deepayan.sarkar at gmail.com> wrote:
> >>>>>
> >>>>> ?On Wed, Aug 10, 2022 at 4:53 PM Naresh Gurbuxani
> >>>>> <naresh_gurbuxani at hotmail.com> wrote:
> >>>>>>
> >>>>>>
> >>>>>> I want to merge two panels into one.  Is it possible to do this?
> >>>>>>
> >>>>>> Thanks,
> >>>>>> Naresh
> >>>>>>
> >>>>>> library(lattice)
> >>>>>> mydf <- data.frame(date = rep(seq.Date(as.Date("2022-08-01"), by =
> 1,
> >>>>>> length.out = 10), 2), name = c(rep("Aa", 10), rep("Bb", 10)),
> >>>>>> long = runif(20, 2, 10), short = runif(20, -10, 0))
> >>>>>>
> >>>>>> # This plots data in two panels.  I want all four lines in one
> panel.
> >>>>>> xyplot(long + short ~ date, groups = name, data = mydf, type =
> c("l",
> >>>>>> "g"))
> >>>>>
> >>>>> The "extended" formula API (with +) is really only meant as an
> >>>>> alternative to reshape() for simple cases. In your case, you probably
> >>>>> want something like
> >>>>>
> >>>>> mydf.long = reshape(mydf, direction = "long", varying =
> list(c("long",
> >>>>> "short")), v.names = "X", timevar = "G", times = c("long", "short"))
> >>>>>
> >>>>> xyplot(X ~ date, groups = interaction(name, G), data = mydf.long,
> type
> >>>>> = c("l", "g"))
> >>>>>
> >>>>> -Deepayan
> >>>>>
> >>>>>> # This does not work
> >>>>>> # No error in R session
> >>>>>> # Graph window says: "Error using packet 1
> >>>>>> # argument 'subscripts' is missing, with no default"
> >>>>>> xyplot(long ~ date, data = mydf, groups = name, type = c("l", "g"),
> >>>>>> panel = function(x, y, ..., subscripts) {
> >>>>>> panel.xyplot(x, y, ...)
> >>>>>> panel.xyplot(mydf$date[subscripts], mydf$short[subscripts], ...)})
> >>>>>>
> >>>>>> ______________________________________________
> >>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>>>>> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >>>>>> and provide commented, minimal, self-contained, reproducible code.
> >>>> ______________________________________________
> >>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>>> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >>>> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Fri Aug 12 21:35:57 2022
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Fri, 12 Aug 2022 19:35:57 +0000
Subject: [R] lattice question
In-Reply-To: <CADfFDC5qH_e1dh96pfRAViwt5GEu_shgUh=Fj-2eLV6hZsySDg@mail.gmail.com>
References: <BL0PR01MB40360688E655910F3A8FC982FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CADfFDC4O+p1FJ5HgmQBqu8mf6kh0fM_Tcmxm_1g64xgVgssfRA@mail.gmail.com>
 <BL0PR01MB403656FFA1AB68A5A0E6FB65FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CAGxFJbRSSVtkZSRY1JBYiePL42HNTWgRW4vcrrfE1h=ZjnDzfg@mail.gmail.com>
 <BL0PR01MB4036724D69DF755E571D1DD7FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CAGxFJbSkuspyGR1-f=aED+WnR0bEVfxLV_C-pfkA8Xj4yfM9_w@mail.gmail.com>
 <BL0PR01MB403675492C3C426B8607BF8BFA649@BL0PR01MB4036.prod.exchangelabs.com>
 <CADfFDC5qH_e1dh96pfRAViwt5GEu_shgUh=Fj-2eLV6hZsySDg@mail.gmail.com>
Message-ID: <BL0PR01MB4036DA256D99B5B10B73E3E6FA679@BL0PR01MB4036.prod.exchangelabs.com>

This is the solution I was looking for.  Thanks to Deepayan and Bert for sticking with me.

Naresh

Sent from my iPhone

On Aug 12, 2022, at 8:02 AM, Deepayan Sarkar <deepayan.sarkar at gmail.com> wrote:

?


On Thu, Aug 11, 2022 at 9:03 PM Naresh Gurbuxani <naresh_gurbuxani at hotmail.com<mailto:naresh_gurbuxani at hotmail.com>> wrote:
Bert,

Thanks for providing this solution.  It produces the desired graph.

To see how I want to distinguish groups, you should look at original data (mydf).  There are two groups (Aa and Bb), each with two time series (long and short).  Long is always positive.  Short is always negative.  Therefore, there is no need to distinguish between long and short.  I only need to distinguish between Aa and Bb.

I agree that more than six lines in the graph will make it cluttered.  In fact the above exercise is to avoid clutter in the key.  No need to show Aa.long and Aa.short, because long and short are obvious.

In that case, this alternative approach may be conceptually simpler:

library(latticeExtra)

r <- with(mydf, extendrange(range(long, short)))

plong <- xyplot(long ~ date, groups = name, data = mydf,
                type = "l", grid = TRUE,
                ylim = r)

pshort <- xyplot(short ~ date, groups = name, data = mydf, type = "l")

plong + pshort

The first plot here is the "main" one, so you need to make sure that its 'ylim' is big enough for all the data.

-Deepayan



Thanks,
Naresh

Sent from my iPhone

> On Aug 10, 2022, at 10:02 PM, Bert Gunter <bgunter.4567 at gmail.com<mailto:bgunter.4567 at gmail.com>> wrote:
>
> ?It is unclear to me how you wish to define and distinguish groups.
> Assuming you wish to have separate lines for the interaction as
> Deepayan showed, but want the colors (or line types or both) to differ
> only by by the "name" factor, then is this what you want?
>
> trellis.par.set(superpose.line = list(lty = 1:6)) ## or other line
> types you create
> u.names <- unique(mydf.long$name)
> xyplot(X ~ date, groups = interaction(name,G), data = mydf.long,
>       type = c("l","g"),
>       col.line = trellis.par.get("superpose.line")$col[
>          seq_along(u.names)],
>       lty =  trellis.par.get("superpose.line")$lty[
>          seq_along(u.names)]
> )
>
> Notes:
> 1. If this is not what you want, I give up. Others may have better insight.
> 2. If this is what you want, Deepayan may be able to provide you a
> nicer way to do it.
> 3. If you have more different names than 6 or 7, then you may have to
> add more line types or colors to the superpose.line settings. Though I
> would think the plot would be pretty much a mess, if so.
>
> Bert
>
>
>> On Wed, Aug 10, 2022 at 4:57 PM Naresh Gurbuxani
>> <naresh_gurbuxani at hotmail.com<mailto:naresh_gurbuxani at hotmail.com>> wrote:
>>
>> Actually I meant types (e.g., lty = 1:2).  But colors would also work.  But I do not want to specify these in call to xyplot().
>>
>> In my actual problem, there are more than two groups.  Moreover, the number of groups changes from case to case.  In my set up, I use trellis.par.set() to set line styles, colors, pch, etc.
>>
>> I would the call to xyplot() to automatically use the set options.
>>
>> Thanks,
>> Naresh
>>
>> Sent from my iPhone
>>
>>>> On Aug 10, 2022, at 5:40 PM, Bert Gunter <bgunter.4567 at gmail.com<mailto:bgunter.4567 at gmail.com>> wrote:
>>>
>>> ?I assume you mean two line colors, not types.
>>> Like this?
>>>
>>> xyplot(X ~ date, groups = interaction(name,G), data = mydf.long,
>>>      type = c("l", "g"), col.line = c("blue","red"))
>>>
>>>
>>> Cheers,
>>> Bert
>>>
>>>> On Wed, Aug 10, 2022 at 2:12 PM Naresh Gurbuxani
>>>> <naresh_gurbuxani at hotmail.com<mailto:naresh_gurbuxani at hotmail.com>> wrote:
>>>>
>>>> Deepayan,
>>>>
>>>> Thanks for providing a solution.  While this is close to my goal, I want one more change.  The line type (lty) should be the same for long and short.  The line type should only change according to ?name? group.  So the the graph will have two line types (not four as in your solution).
>>>>
>>>> Is it possible?
>>>>
>>>> Thanks,
>>>> Narrsh
>>>>
>>>> Sent from my iPhone
>>>>
>>>>>> On Aug 10, 2022, at 9:37 AM, Deepayan Sarkar <deepayan.sarkar at gmail.com<mailto:deepayan.sarkar at gmail.com>> wrote:
>>>>>
>>>>> ?On Wed, Aug 10, 2022 at 4:53 PM Naresh Gurbuxani
>>>>> <naresh_gurbuxani at hotmail.com<mailto:naresh_gurbuxani at hotmail.com>> wrote:
>>>>>>
>>>>>>
>>>>>> I want to merge two panels into one.  Is it possible to do this?
>>>>>>
>>>>>> Thanks,
>>>>>> Naresh
>>>>>>
>>>>>> library(lattice)
>>>>>> mydf <- data.frame(date = rep(seq.Date(as.Date("2022-08-01"), by = 1,
>>>>>> length.out = 10), 2), name = c(rep("Aa", 10), rep("Bb", 10)),
>>>>>> long = runif(20, 2, 10), short = runif(20, -10, 0))
>>>>>>
>>>>>> # This plots data in two panels.  I want all four lines in one panel.
>>>>>> xyplot(long + short ~ date, groups = name, data = mydf, type = c("l",
>>>>>> "g"))
>>>>>
>>>>> The "extended" formula API (with +) is really only meant as an
>>>>> alternative to reshape() for simple cases. In your case, you probably
>>>>> want something like
>>>>>
>>>>> mydf.long = reshape(mydf, direction = "long", varying = list(c("long",
>>>>> "short")), v.names = "X", timevar = "G", times = c("long", "short"))
>>>>>
>>>>> xyplot(X ~ date, groups = interaction(name, G), data = mydf.long, type
>>>>> = c("l", "g"))
>>>>>
>>>>> -Deepayan
>>>>>
>>>>>> # This does not work
>>>>>> # No error in R session
>>>>>> # Graph window says: "Error using packet 1
>>>>>> # argument 'subscripts' is missing, with no default"
>>>>>> xyplot(long ~ date, data = mydf, groups = name, type = c("l", "g"),
>>>>>> panel = function(x, y, ..., subscripts) {
>>>>>> panel.xyplot(x, y, ...)
>>>>>> panel.xyplot(mydf$date[subscripts], mydf$short[subscripts], ...)})
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>> ______________________________________________
>>>> R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Fri Aug 12 23:29:14 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 12 Aug 2022 14:29:14 -0700
Subject: [R] lattice question
In-Reply-To: <BL0PR01MB4036DA256D99B5B10B73E3E6FA679@BL0PR01MB4036.prod.exchangelabs.com>
References: <BL0PR01MB40360688E655910F3A8FC982FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CADfFDC4O+p1FJ5HgmQBqu8mf6kh0fM_Tcmxm_1g64xgVgssfRA@mail.gmail.com>
 <BL0PR01MB403656FFA1AB68A5A0E6FB65FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CAGxFJbRSSVtkZSRY1JBYiePL42HNTWgRW4vcrrfE1h=ZjnDzfg@mail.gmail.com>
 <BL0PR01MB4036724D69DF755E571D1DD7FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CAGxFJbSkuspyGR1-f=aED+WnR0bEVfxLV_C-pfkA8Xj4yfM9_w@mail.gmail.com>
 <BL0PR01MB403675492C3C426B8607BF8BFA649@BL0PR01MB4036.prod.exchangelabs.com>
 <CADfFDC5qH_e1dh96pfRAViwt5GEu_shgUh=Fj-2eLV6hZsySDg@mail.gmail.com>
 <BL0PR01MB4036DA256D99B5B10B73E3E6FA679@BL0PR01MB4036.prod.exchangelabs.com>
Message-ID: <CAGxFJbRHTpPEa-0KN+f3Qh264=-+SvVgA9QH80Thf9A8ycG7oQ@mail.gmail.com>

As a private coda -- as it is unlikely to be of general interest --
note that it is easy to do this without resorting to the layering
paradigm through the use of the appropriate panel function and
lattice's argument passing protocol (although I stand in awe of Felix
Andrews's clever code!). Here's a version that uses R's underlying
with() function to control the nonstandard evaluation. I've added a
key and y axis label just to be cute:

with(mydf,xyplot(short ~ date, group = name,
type = c("l","g"),
       y2 =long,
       ylim = extendrange(c(short,long)),
       auto.key = list(lines=TRUE, points = FALSE, space = "right"),
       ylab = "Name",
       panel= function(x,y, y2,...){
          panel.superpose(x,y,...)
          panel.superpose(x,y2,...)
       }))

On Fri, Aug 12, 2022 at 12:35 PM Naresh Gurbuxani
<naresh_gurbuxani at hotmail.com> wrote:
>
> This is the solution I was looking for.  Thanks to Deepayan and Bert for sticking with me.
>
> Naresh
>
> Sent from my iPhone
>
> On Aug 12, 2022, at 8:02 AM, Deepayan Sarkar <deepayan.sarkar at gmail.com> wrote:
>
> ?
>
>
> On Thu, Aug 11, 2022 at 9:03 PM Naresh Gurbuxani <naresh_gurbuxani at hotmail.com> wrote:
>>
>> Bert,
>>
>> Thanks for providing this solution.  It produces the desired graph.
>>
>> To see how I want to distinguish groups, you should look at original data (mydf).  There are two groups (Aa and Bb), each with two time series (long and short).  Long is always positive.  Short is always negative.  Therefore, there is no need to distinguish between long and short.  I only need to distinguish between Aa and Bb.
>>
>> I agree that more than six lines in the graph will make it cluttered.  In fact the above exercise is to avoid clutter in the key.  No need to show Aa.long and Aa.short, because long and short are obvious.
>
>
> In that case, this alternative approach may be conceptually simpler:
>
> library(latticeExtra)
>
> r <- with(mydf, extendrange(range(long, short)))
>
> plong <- xyplot(long ~ date, groups = name, data = mydf,
>                 type = "l", grid = TRUE,
>                 ylim = r)
>
> pshort <- xyplot(short ~ date, groups = name, data = mydf, type = "l")
>
> plong + pshort
>
> The first plot here is the "main" one, so you need to make sure that its 'ylim' is big enough for all the data.
>
> -Deepayan
>
>
>>
>>
>> Thanks,
>> Naresh
>>
>> Sent from my iPhone
>>
>> > On Aug 10, 2022, at 10:02 PM, Bert Gunter <bgunter.4567 at gmail.com> wrote:
>> >
>> > ?It is unclear to me how you wish to define and distinguish groups.
>> > Assuming you wish to have separate lines for the interaction as
>> > Deepayan showed, but want the colors (or line types or both) to differ
>> > only by by the "name" factor, then is this what you want?
>> >
>> > trellis.par.set(superpose.line = list(lty = 1:6)) ## or other line
>> > types you create
>> > u.names <- unique(mydf.long$name)
>> > xyplot(X ~ date, groups = interaction(name,G), data = mydf.long,
>> >       type = c("l","g"),
>> >       col.line = trellis.par.get("superpose.line")$col[
>> >          seq_along(u.names)],
>> >       lty =  trellis.par.get("superpose.line")$lty[
>> >          seq_along(u.names)]
>> > )
>> >
>> > Notes:
>> > 1. If this is not what you want, I give up. Others may have better insight.
>> > 2. If this is what you want, Deepayan may be able to provide you a
>> > nicer way to do it.
>> > 3. If you have more different names than 6 or 7, then you may have to
>> > add more line types or colors to the superpose.line settings. Though I
>> > would think the plot would be pretty much a mess, if so.
>> >
>> > Bert
>> >
>> >
>> >> On Wed, Aug 10, 2022 at 4:57 PM Naresh Gurbuxani
>> >> <naresh_gurbuxani at hotmail.com> wrote:
>> >>
>> >> Actually I meant types (e.g., lty = 1:2).  But colors would also work.  But I do not want to specify these in call to xyplot().
>> >>
>> >> In my actual problem, there are more than two groups.  Moreover, the number of groups changes from case to case.  In my set up, I use trellis.par.set() to set line styles, colors, pch, etc.
>> >>
>> >> I would the call to xyplot() to automatically use the set options.
>> >>
>> >> Thanks,
>> >> Naresh
>> >>
>> >> Sent from my iPhone
>> >>
>> >>>> On Aug 10, 2022, at 5:40 PM, Bert Gunter <bgunter.4567 at gmail.com> wrote:
>> >>>
>> >>> ?I assume you mean two line colors, not types.
>> >>> Like this?
>> >>>
>> >>> xyplot(X ~ date, groups = interaction(name,G), data = mydf.long,
>> >>>      type = c("l", "g"), col.line = c("blue","red"))
>> >>>
>> >>>
>> >>> Cheers,
>> >>> Bert
>> >>>
>> >>>> On Wed, Aug 10, 2022 at 2:12 PM Naresh Gurbuxani
>> >>>> <naresh_gurbuxani at hotmail.com> wrote:
>> >>>>
>> >>>> Deepayan,
>> >>>>
>> >>>> Thanks for providing a solution.  While this is close to my goal, I want one more change.  The line type (lty) should be the same for long and short.  The line type should only change according to ?name? group.  So the the graph will have two line types (not four as in your solution).
>> >>>>
>> >>>> Is it possible?
>> >>>>
>> >>>> Thanks,
>> >>>> Narrsh
>> >>>>
>> >>>> Sent from my iPhone
>> >>>>
>> >>>>>> On Aug 10, 2022, at 9:37 AM, Deepayan Sarkar <deepayan.sarkar at gmail.com> wrote:
>> >>>>>
>> >>>>> ?On Wed, Aug 10, 2022 at 4:53 PM Naresh Gurbuxani
>> >>>>> <naresh_gurbuxani at hotmail.com> wrote:
>> >>>>>>
>> >>>>>>
>> >>>>>> I want to merge two panels into one.  Is it possible to do this?
>> >>>>>>
>> >>>>>> Thanks,
>> >>>>>> Naresh
>> >>>>>>
>> >>>>>> library(lattice)
>> >>>>>> mydf <- data.frame(date = rep(seq.Date(as.Date("2022-08-01"), by = 1,
>> >>>>>> length.out = 10), 2), name = c(rep("Aa", 10), rep("Bb", 10)),
>> >>>>>> long = runif(20, 2, 10), short = runif(20, -10, 0))
>> >>>>>>
>> >>>>>> # This plots data in two panels.  I want all four lines in one panel.
>> >>>>>> xyplot(long + short ~ date, groups = name, data = mydf, type = c("l",
>> >>>>>> "g"))
>> >>>>>
>> >>>>> The "extended" formula API (with +) is really only meant as an
>> >>>>> alternative to reshape() for simple cases. In your case, you probably
>> >>>>> want something like
>> >>>>>
>> >>>>> mydf.long = reshape(mydf, direction = "long", varying = list(c("long",
>> >>>>> "short")), v.names = "X", timevar = "G", times = c("long", "short"))
>> >>>>>
>> >>>>> xyplot(X ~ date, groups = interaction(name, G), data = mydf.long, type
>> >>>>> = c("l", "g"))
>> >>>>>
>> >>>>> -Deepayan
>> >>>>>
>> >>>>>> # This does not work
>> >>>>>> # No error in R session
>> >>>>>> # Graph window says: "Error using packet 1
>> >>>>>> # argument 'subscripts' is missing, with no default"
>> >>>>>> xyplot(long ~ date, data = mydf, groups = name, type = c("l", "g"),
>> >>>>>> panel = function(x, y, ..., subscripts) {
>> >>>>>> panel.xyplot(x, y, ...)
>> >>>>>> panel.xyplot(mydf$date[subscripts], mydf$short[subscripts], ...)})
>> >>>>>>
>> >>>>>> ______________________________________________
>> >>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> >>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>> >>>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> >>>>>> and provide commented, minimal, self-contained, reproducible code.
>> >>>> ______________________________________________
>> >>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> >>>> https://stat.ethz.ch/mailman/listinfo/r-help
>> >>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> >>>> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Fri Aug 12 23:30:56 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 12 Aug 2022 14:30:56 -0700
Subject: [R] lattice question
In-Reply-To: <CAGxFJbRHTpPEa-0KN+f3Qh264=-+SvVgA9QH80Thf9A8ycG7oQ@mail.gmail.com>
References: <BL0PR01MB40360688E655910F3A8FC982FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CADfFDC4O+p1FJ5HgmQBqu8mf6kh0fM_Tcmxm_1g64xgVgssfRA@mail.gmail.com>
 <BL0PR01MB403656FFA1AB68A5A0E6FB65FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CAGxFJbRSSVtkZSRY1JBYiePL42HNTWgRW4vcrrfE1h=ZjnDzfg@mail.gmail.com>
 <BL0PR01MB4036724D69DF755E571D1DD7FA659@BL0PR01MB4036.prod.exchangelabs.com>
 <CAGxFJbSkuspyGR1-f=aED+WnR0bEVfxLV_C-pfkA8Xj4yfM9_w@mail.gmail.com>
 <BL0PR01MB403675492C3C426B8607BF8BFA649@BL0PR01MB4036.prod.exchangelabs.com>
 <CADfFDC5qH_e1dh96pfRAViwt5GEu_shgUh=Fj-2eLV6hZsySDg@mail.gmail.com>
 <BL0PR01MB4036DA256D99B5B10B73E3E6FA679@BL0PR01MB4036.prod.exchangelabs.com>
 <CAGxFJbRHTpPEa-0KN+f3Qh264=-+SvVgA9QH80Thf9A8ycG7oQ@mail.gmail.com>
Message-ID: <CAGxFJbQn2Tm_91tRk+Qp4k+oCy+Ua4171BcfaqNkabAae2S88A@mail.gmail.com>

I hit the wrong button, unfortunately, so others beside Naresh and
Deepayan can safely ignore my "coda".

On Fri, Aug 12, 2022 at 2:29 PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> As a private coda -- as it is unlikely to be of general interest --
> note that it is easy to do this without resorting to the layering
> paradigm through the use of the appropriate panel function and
> lattice's argument passing protocol (although I stand in awe of Felix
> Andrews's clever code!). Here's a version that uses R's underlying
> with() function to control the nonstandard evaluation. I've added a
> key and y axis label just to be cute:
>
> with(mydf,xyplot(short ~ date, group = name,
> type = c("l","g"),
>        y2 =long,
>        ylim = extendrange(c(short,long)),
>        auto.key = list(lines=TRUE, points = FALSE, space = "right"),
>        ylab = "Name",
>        panel= function(x,y, y2,...){
>           panel.superpose(x,y,...)
>           panel.superpose(x,y2,...)
>        }))
>
> On Fri, Aug 12, 2022 at 12:35 PM Naresh Gurbuxani
> <naresh_gurbuxani at hotmail.com> wrote:
> >
> > This is the solution I was looking for.  Thanks to Deepayan and Bert for sticking with me.
> >
> > Naresh
> >
> > Sent from my iPhone
> >
> > On Aug 12, 2022, at 8:02 AM, Deepayan Sarkar <deepayan.sarkar at gmail.com> wrote:
> >
> > ?
> >
> >
> > On Thu, Aug 11, 2022 at 9:03 PM Naresh Gurbuxani <naresh_gurbuxani at hotmail.com> wrote:
> >>
> >> Bert,
> >>
> >> Thanks for providing this solution.  It produces the desired graph.
> >>
> >> To see how I want to distinguish groups, you should look at original data (mydf).  There are two groups (Aa and Bb), each with two time series (long and short).  Long is always positive.  Short is always negative.  Therefore, there is no need to distinguish between long and short.  I only need to distinguish between Aa and Bb.
> >>
> >> I agree that more than six lines in the graph will make it cluttered.  In fact the above exercise is to avoid clutter in the key.  No need to show Aa.long and Aa.short, because long and short are obvious.
> >
> >
> > In that case, this alternative approach may be conceptually simpler:
> >
> > library(latticeExtra)
> >
> > r <- with(mydf, extendrange(range(long, short)))
> >
> > plong <- xyplot(long ~ date, groups = name, data = mydf,
> >                 type = "l", grid = TRUE,
> >                 ylim = r)
> >
> > pshort <- xyplot(short ~ date, groups = name, data = mydf, type = "l")
> >
> > plong + pshort
> >
> > The first plot here is the "main" one, so you need to make sure that its 'ylim' is big enough for all the data.
> >
> > -Deepayan
> >
> >
> >>
> >>
> >> Thanks,
> >> Naresh
> >>
> >> Sent from my iPhone
> >>
> >> > On Aug 10, 2022, at 10:02 PM, Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >> >
> >> > ?It is unclear to me how you wish to define and distinguish groups.
> >> > Assuming you wish to have separate lines for the interaction as
> >> > Deepayan showed, but want the colors (or line types or both) to differ
> >> > only by by the "name" factor, then is this what you want?
> >> >
> >> > trellis.par.set(superpose.line = list(lty = 1:6)) ## or other line
> >> > types you create
> >> > u.names <- unique(mydf.long$name)
> >> > xyplot(X ~ date, groups = interaction(name,G), data = mydf.long,
> >> >       type = c("l","g"),
> >> >       col.line = trellis.par.get("superpose.line")$col[
> >> >          seq_along(u.names)],
> >> >       lty =  trellis.par.get("superpose.line")$lty[
> >> >          seq_along(u.names)]
> >> > )
> >> >
> >> > Notes:
> >> > 1. If this is not what you want, I give up. Others may have better insight.
> >> > 2. If this is what you want, Deepayan may be able to provide you a
> >> > nicer way to do it.
> >> > 3. If you have more different names than 6 or 7, then you may have to
> >> > add more line types or colors to the superpose.line settings. Though I
> >> > would think the plot would be pretty much a mess, if so.
> >> >
> >> > Bert
> >> >
> >> >
> >> >> On Wed, Aug 10, 2022 at 4:57 PM Naresh Gurbuxani
> >> >> <naresh_gurbuxani at hotmail.com> wrote:
> >> >>
> >> >> Actually I meant types (e.g., lty = 1:2).  But colors would also work.  But I do not want to specify these in call to xyplot().
> >> >>
> >> >> In my actual problem, there are more than two groups.  Moreover, the number of groups changes from case to case.  In my set up, I use trellis.par.set() to set line styles, colors, pch, etc.
> >> >>
> >> >> I would the call to xyplot() to automatically use the set options.
> >> >>
> >> >> Thanks,
> >> >> Naresh
> >> >>
> >> >> Sent from my iPhone
> >> >>
> >> >>>> On Aug 10, 2022, at 5:40 PM, Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >> >>>
> >> >>> ?I assume you mean two line colors, not types.
> >> >>> Like this?
> >> >>>
> >> >>> xyplot(X ~ date, groups = interaction(name,G), data = mydf.long,
> >> >>>      type = c("l", "g"), col.line = c("blue","red"))
> >> >>>
> >> >>>
> >> >>> Cheers,
> >> >>> Bert
> >> >>>
> >> >>>> On Wed, Aug 10, 2022 at 2:12 PM Naresh Gurbuxani
> >> >>>> <naresh_gurbuxani at hotmail.com> wrote:
> >> >>>>
> >> >>>> Deepayan,
> >> >>>>
> >> >>>> Thanks for providing a solution.  While this is close to my goal, I want one more change.  The line type (lty) should be the same for long and short.  The line type should only change according to ?name? group.  So the the graph will have two line types (not four as in your solution).
> >> >>>>
> >> >>>> Is it possible?
> >> >>>>
> >> >>>> Thanks,
> >> >>>> Narrsh
> >> >>>>
> >> >>>> Sent from my iPhone
> >> >>>>
> >> >>>>>> On Aug 10, 2022, at 9:37 AM, Deepayan Sarkar <deepayan.sarkar at gmail.com> wrote:
> >> >>>>>
> >> >>>>> ?On Wed, Aug 10, 2022 at 4:53 PM Naresh Gurbuxani
> >> >>>>> <naresh_gurbuxani at hotmail.com> wrote:
> >> >>>>>>
> >> >>>>>>
> >> >>>>>> I want to merge two panels into one.  Is it possible to do this?
> >> >>>>>>
> >> >>>>>> Thanks,
> >> >>>>>> Naresh
> >> >>>>>>
> >> >>>>>> library(lattice)
> >> >>>>>> mydf <- data.frame(date = rep(seq.Date(as.Date("2022-08-01"), by = 1,
> >> >>>>>> length.out = 10), 2), name = c(rep("Aa", 10), rep("Bb", 10)),
> >> >>>>>> long = runif(20, 2, 10), short = runif(20, -10, 0))
> >> >>>>>>
> >> >>>>>> # This plots data in two panels.  I want all four lines in one panel.
> >> >>>>>> xyplot(long + short ~ date, groups = name, data = mydf, type = c("l",
> >> >>>>>> "g"))
> >> >>>>>
> >> >>>>> The "extended" formula API (with +) is really only meant as an
> >> >>>>> alternative to reshape() for simple cases. In your case, you probably
> >> >>>>> want something like
> >> >>>>>
> >> >>>>> mydf.long = reshape(mydf, direction = "long", varying = list(c("long",
> >> >>>>> "short")), v.names = "X", timevar = "G", times = c("long", "short"))
> >> >>>>>
> >> >>>>> xyplot(X ~ date, groups = interaction(name, G), data = mydf.long, type
> >> >>>>> = c("l", "g"))
> >> >>>>>
> >> >>>>> -Deepayan
> >> >>>>>
> >> >>>>>> # This does not work
> >> >>>>>> # No error in R session
> >> >>>>>> # Graph window says: "Error using packet 1
> >> >>>>>> # argument 'subscripts' is missing, with no default"
> >> >>>>>> xyplot(long ~ date, data = mydf, groups = name, type = c("l", "g"),
> >> >>>>>> panel = function(x, y, ..., subscripts) {
> >> >>>>>> panel.xyplot(x, y, ...)
> >> >>>>>> panel.xyplot(mydf$date[subscripts], mydf$short[subscripts], ...)})
> >> >>>>>>
> >> >>>>>> ______________________________________________
> >> >>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> >>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
> >> >>>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >> >>>>>> and provide commented, minimal, self-contained, reproducible code.
> >> >>>> ______________________________________________
> >> >>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> >>>> https://stat.ethz.ch/mailman/listinfo/r-help
> >> >>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >> >>>> and provide commented, minimal, self-contained, reproducible code.


From bogu@@chr|@to|er @end|ng |rom gm@||@com  Sat Aug 13 19:18:41 2022
From: bogu@@chr|@to|er @end|ng |rom gm@||@com (bogus christofer)
Date: Sat, 13 Aug 2022 22:48:41 +0530
Subject: [R] Fitted values from AR model
In-Reply-To: <CAGgJW74rxrDzwL2CqKy7c-YmdakRqkn8_1Jm=88_Skd_vZX+JA@mail.gmail.com>
References: <CAJKTqP7tOuF7TUiiuMpbRQOVwRCXsZVPXe9R7bQhG2O-Wj6HVg@mail.gmail.com>
 <CAGgJW74rxrDzwL2CqKy7c-YmdakRqkn8_1Jm=88_Skd_vZX+JA@mail.gmail.com>
Message-ID: <CAJKTqP6W5MZmdMDBRsPti=+goCAPDw2vDcs5FfrqLk8mxT3Tiw@mail.gmail.com>

Thanks Eric.

Is it possible to know what R uses as the initial values? Are these
configurable?

On Fri, 12 Aug 2022 at 13:44, Eric Berger <ericjberger at gmail.com> wrote:

> The model that you are fitting to the data is an AR(2) model, which means
>
> y(t) = a0 + a1 * y(t-1) + a2 * y(t-2) + eps(t)                 (1)
>
> The fitting procedure estimates the coefficients a0, a1, a2 (and the
> variance of eps).
>
> After the coefficients have been estimated, the fitted values can be
> calculated using equation (1) (setting eps(t) = 0)
> using
> fitted(t) = a0 + a1 * y(t-1) + a2 * y(t-2)
>
> Assuming the series is given for t=1,2,...,20, there is no problem to
> apply equation (1) to get the
> fitted values for t=3,4,...,20. But there is a problem for t=1 and
> t=2. For example, for t=1, equation (1)
> says
>
> fitted(1) = a0 + a1 * y(0) + a2 * y(-1)
>
> But there are no values given for y(0) and y(-1). So, either no fitted
> values should be given for t=1,2, or some
> other method is being used. Apparently, the arima functions in R and
> python use different methodology
> to generate these two fitted points. (For all the other values, the
> fits are extremely close.)
>
> HTH,
> Eric
>
> On Thu, Aug 11, 2022 at 9:53 PM bogus christofer
> <bogus.christofer at gmail.com> wrote:
> >
> > Hi,
> >
> > I have below AR model and fitted values from the forecast package
> >
> > library(forecast)
> > dta = c(5.0, 11, 16, 23, 36, 58, 29, 20, 10, 8, 3, 0, 0, 2, 11, 27, 47,
> 63,
> > 60, 39)
> > fit <- arima(dta, order=c(2,0,0))
> > fitted(fit)
> >
> > This gives fitted values as
> >
> > Time Series:
> > Start = 1
> > End = 20
> > Frequency = 1
> >  [1] 13.461017  9.073427 18.022166 20.689420 26.352282 38.165635
> 57.502926
> > 9.812106 15.335303  8.298995 11.543320  6.606999  5.800820  7.502621
> > 9.930962 19.723966 34.045298 49.252447 57.333846 44.615067
> >
> >
> > However when I compare this result with Python, I see significant
> > difference particularly in the first few values as below
> >
> > from statsmodels.tsa.arima.model import ARIMA
> > dta = [5.0, 11, 16, 23, 36, 58, 29, 20, 10, 8, 3, 0, 0, 2, 11, 27, 47,
> 63,
> > 60, 39]
> > fit = ARIMA(dta, order=(2, 0, 0)).fit()
> > fit.predict()
> >
> > array([21.24816788, 8.66048306, 18.02197059, 20.68931006,
> > 26.35225759,38.16574655, 57.503278 , 9.81253693, 15.33539514,
> > 8.29894655,11.54316056, 6.60679489, 5.80055038, 7.50232004,
> > 9.93067155,19.72374025, 34.04524337, 49.25265365, 57.3343347 ,
> 44.6157026 ])
> >
> > Any idea why there are such difference between R and Python results will
> be
> > very helpful.
> >
> > Thanks,
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Sat Aug 13 20:46:40 2022
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Sat, 13 Aug 2022 21:46:40 +0300
Subject: [R] Fitted values from AR model
In-Reply-To: <CAJKTqP6W5MZmdMDBRsPti=+goCAPDw2vDcs5FfrqLk8mxT3Tiw@mail.gmail.com>
References: <CAJKTqP7tOuF7TUiiuMpbRQOVwRCXsZVPXe9R7bQhG2O-Wj6HVg@mail.gmail.com>
 <CAGgJW74rxrDzwL2CqKy7c-YmdakRqkn8_1Jm=88_Skd_vZX+JA@mail.gmail.com>
 <CAJKTqP6W5MZmdMDBRsPti=+goCAPDw2vDcs5FfrqLk8mxT3Tiw@mail.gmail.com>
Message-ID: <CAGgJW769CYbkpyZkmRu06YcusYArpVyYR+mua7vOf4n-Oh0EiQ@mail.gmail.com>

I have not looked into this. R is open source so you can download the
source code and look at it to try and figure it out.
I do not know if the values are configurable.

If you assume that Equation (1) is applicable for t=1 and t=2, then
you can back out values for y(0) and y(1).
Explicitly, if you enter

> fit

you will get the coefficients of the fit: ar1, ar2 and 'intercept'. In
the notation I used in Equation (1) these map to

a1 = ar1, a2 = ar2 and    a0 = intercept / (1 - ar1 - ar2 )

You then have

fitted(2) = a0 + a1 * y(1) + a2 * y(0)

All the values in this expression are known except for y(0), so you
can back out y(0).
Finally

fitted(1) = a0 + a1 * y(0) + a2 * y(-1)

Again, all the values are known except for y(-1) so you can back out y(-1).

I did this manually and got a0 = 7.502621, y(0) = 7.932861 and y(-1) =
6.475706, but I could easily have made a mistake so you
might want to try this yourself.

Best,
Eric


On Sat, Aug 13, 2022 at 8:18 PM bogus christofer
<bogus.christofer at gmail.com> wrote:
>
> Thanks Eric.
>
> Is it possible to know what R uses as the initial values? Are these configurable?
>
> On Fri, 12 Aug 2022 at 13:44, Eric Berger <ericjberger at gmail.com> wrote:
>>
>> The model that you are fitting to the data is an AR(2) model, which means
>>
>> y(t) = a0 + a1 * y(t-1) + a2 * y(t-2) + eps(t)                 (1)
>>
>> The fitting procedure estimates the coefficients a0, a1, a2 (and the
>> variance of eps).
>>
>> After the coefficients have been estimated, the fitted values can be
>> calculated using equation (1) (setting eps(t) = 0)
>> using
>> fitted(t) = a0 + a1 * y(t-1) + a2 * y(t-2)
>>
>> Assuming the series is given for t=1,2,...,20, there is no problem to
>> apply equation (1) to get the
>> fitted values for t=3,4,...,20. But there is a problem for t=1 and
>> t=2. For example, for t=1, equation (1)
>> says
>>
>> fitted(1) = a0 + a1 * y(0) + a2 * y(-1)
>>
>> But there are no values given for y(0) and y(-1). So, either no fitted
>> values should be given for t=1,2, or some
>> other method is being used. Apparently, the arima functions in R and
>> python use different methodology
>> to generate these two fitted points. (For all the other values, the
>> fits are extremely close.)
>>
>> HTH,
>> Eric
>>
>> On Thu, Aug 11, 2022 at 9:53 PM bogus christofer
>> <bogus.christofer at gmail.com> wrote:
>> >
>> > Hi,
>> >
>> > I have below AR model and fitted values from the forecast package
>> >
>> > library(forecast)
>> > dta = c(5.0, 11, 16, 23, 36, 58, 29, 20, 10, 8, 3, 0, 0, 2, 11, 27, 47, 63,
>> > 60, 39)
>> > fit <- arima(dta, order=c(2,0,0))
>> > fitted(fit)
>> >
>> > This gives fitted values as
>> >
>> > Time Series:
>> > Start = 1
>> > End = 20
>> > Frequency = 1
>> >  [1] 13.461017  9.073427 18.022166 20.689420 26.352282 38.165635 57.502926
>> > 9.812106 15.335303  8.298995 11.543320  6.606999  5.800820  7.502621
>> > 9.930962 19.723966 34.045298 49.252447 57.333846 44.615067
>> >
>> >
>> > However when I compare this result with Python, I see significant
>> > difference particularly in the first few values as below
>> >
>> > from statsmodels.tsa.arima.model import ARIMA
>> > dta = [5.0, 11, 16, 23, 36, 58, 29, 20, 10, 8, 3, 0, 0, 2, 11, 27, 47, 63,
>> > 60, 39]
>> > fit = ARIMA(dta, order=(2, 0, 0)).fit()
>> > fit.predict()
>> >
>> > array([21.24816788, 8.66048306, 18.02197059, 20.68931006,
>> > 26.35225759,38.16574655, 57.503278 , 9.81253693, 15.33539514,
>> > 8.29894655,11.54316056, 6.60679489, 5.80055038, 7.50232004,
>> > 9.93067155,19.72374025, 34.04524337, 49.25265365, 57.3343347 , 44.6157026 ])
>> >
>> > Any idea why there are such difference between R and Python results will be
>> > very helpful.
>> >
>> > Thanks,
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.


