From ttm|gue|tt @end|ng |rom gm@||@com  Wed Feb  1 04:16:54 2023
From: ttm|gue|tt @end|ng |rom gm@||@com (Michael Milton)
Date: Wed, 1 Feb 2023 14:16:54 +1100
Subject: [R] dyn.load(now = FALSE) not actually lazy?
Message-ID: <CAPZyOoJdGJ6yYhtmTyCR3v+=6H6XprxSsEG5bKwNbOTPqoJdTA@mail.gmail.com>

On Linux, if I have a .so file that has a dependency on another .so, and I
`dyn.load(now=FALSE)` the first one, R seems to try to resolve the symbols
immediately, causing the load to fail.

For example, I have `libtorch` installed on my HPC. Note that it links to
various libs such as `libcudart.so` and `libmkl_intel_lp64.so.2` which
aren't currently in my library path:

?  ~ ldd
/stornext/System/data/nvidia/libtorch-gpu/libtorch-gpu-1.12.1/lib/libtorch_cpu.so
        linux-vdso.so.1 =>  (0x00007ffcab58c000)
        libgomp.so.1 =>
/stornext/System/data/apps/gcc/gcc-11.2.0/lib64/libgomp.so.1
(0x00007f8cb22bf000)
        libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f8cb20a3000)
        libc10.so =>
/stornext/System/data/nvidia/libtorch-gpu/libtorch-gpu-1.12.1/lib/libc10.so
(0x00007f8cb1e2d000)
        libnuma.so.1 => /lib64/libnuma.so.1 (0x00007f8cb1c21000)
        librt.so.1 => /lib64/librt.so.1 (0x00007f8cb1a19000)
        libgcc_s.so.1 =>
/stornext/System/data/apps/gcc/gcc-11.2.0/lib64/libgcc_s.so.1
(0x00007f8cb1801000)
        libdl.so.2 => /lib64/libdl.so.2 (0x00007f8cb15fd000)
        libmkl_intel_lp64.so.2 => not found
        libmkl_gnu_thread.so.2 => not found
        libmkl_core.so.2 => not found
        libm.so.6 => /lib64/libm.so.6 (0x00007f8cb12fb000)
        libcudart.so.11.0 => not found

Then in R, if I try to load that same file:

>
dyn.load("/stornext/System/data/nvidia/libtorch-gpu/libtorch-gpu-1.12.1/lib/libtorch_cpu.so",
now=FALSE)
Error in
dyn.load("/stornext/System/data/nvidia/libtorch-gpu/libtorch-gpu-1.12.1/lib/libtorch_cpu.so",
 :
  unable to load shared object
'/stornext/System/data/nvidia/libtorch-gpu/libtorch-gpu-1.12.1/lib/libtorch_cpu.so':
  libmkl_intel_lp64.so.2: cannot open shared object file: No such file or
directory

Is this a bug in the `dyn.load` implementation for R? If not, why is it
behaving like this? What should I do about it?

For reference, I'm on CentOS 7, with Linux
kernel 3.10.0-1160.81.1.el7.x86_64.

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Feb  1 10:42:21 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 1 Feb 2023 04:42:21 -0500
Subject: [R] dyn.load(now = FALSE) not actually lazy?
In-Reply-To: <CAPZyOoJdGJ6yYhtmTyCR3v+=6H6XprxSsEG5bKwNbOTPqoJdTA@mail.gmail.com>
References: <CAPZyOoJdGJ6yYhtmTyCR3v+=6H6XprxSsEG5bKwNbOTPqoJdTA@mail.gmail.com>
Message-ID: <f28795b0-fa8a-fbb8-2fd5-9321734a9174@gmail.com>

According to the help page for dyn.load, I think this is within the 
allowed behaviour:

"now:
a logical controlling whether all symbols are resolved (and relocated) 
immediately the library is loaded or deferred until they are used. This 
control is useful for developers testing whether a library is complete 
and has all the necessary symbols, and for users to ignore missing 
symbols. Whether this has any effect is system-dependent."

It appears to be intended for a DLL that doesn't define all the symbols 
that your program will use, not for a DLL that has external references 
that can't be resolved.  And there's that last sentence.

I think for what you want, you'd have to write the DLL (i.e. libtorch) 
in such a way that it does delayed loading of its dependencies.

Duncan Murdoch

On 31/01/2023 10:16 p.m., Michael Milton wrote:
> On Linux, if I have a .so file that has a dependency on another .so, and I
> `dyn.load(now=FALSE)` the first one, R seems to try to resolve the symbols
> immediately, causing the load to fail.
> 
> For example, I have `libtorch` installed on my HPC. Note that it links to
> various libs such as `libcudart.so` and `libmkl_intel_lp64.so.2` which
> aren't currently in my library path:
> 
> ?  ~ ldd
> /stornext/System/data/nvidia/libtorch-gpu/libtorch-gpu-1.12.1/lib/libtorch_cpu.so
>          linux-vdso.so.1 =>  (0x00007ffcab58c000)
>          libgomp.so.1 =>
> /stornext/System/data/apps/gcc/gcc-11.2.0/lib64/libgomp.so.1
> (0x00007f8cb22bf000)
>          libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f8cb20a3000)
>          libc10.so =>
> /stornext/System/data/nvidia/libtorch-gpu/libtorch-gpu-1.12.1/lib/libc10.so
> (0x00007f8cb1e2d000)
>          libnuma.so.1 => /lib64/libnuma.so.1 (0x00007f8cb1c21000)
>          librt.so.1 => /lib64/librt.so.1 (0x00007f8cb1a19000)
>          libgcc_s.so.1 =>
> /stornext/System/data/apps/gcc/gcc-11.2.0/lib64/libgcc_s.so.1
> (0x00007f8cb1801000)
>          libdl.so.2 => /lib64/libdl.so.2 (0x00007f8cb15fd000)
>          libmkl_intel_lp64.so.2 => not found
>          libmkl_gnu_thread.so.2 => not found
>          libmkl_core.so.2 => not found
>          libm.so.6 => /lib64/libm.so.6 (0x00007f8cb12fb000)
>          libcudart.so.11.0 => not found
> 
> Then in R, if I try to load that same file:
> 
>>
> dyn.load("/stornext/System/data/nvidia/libtorch-gpu/libtorch-gpu-1.12.1/lib/libtorch_cpu.so",
> now=FALSE)
> Error in
> dyn.load("/stornext/System/data/nvidia/libtorch-gpu/libtorch-gpu-1.12.1/lib/libtorch_cpu.so",
>   :
>    unable to load shared object
> '/stornext/System/data/nvidia/libtorch-gpu/libtorch-gpu-1.12.1/lib/libtorch_cpu.so':
>    libmkl_intel_lp64.so.2: cannot open shared object file: No such file or
> directory
> 
> Is this a bug in the `dyn.load` implementation for R? If not, why is it
> behaving like this? What should I do about it?
> 
> For reference, I'm on CentOS 7, with Linux
> kernel 3.10.0-1160.81.1.el7.x86_64.
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kry|ov@r00t @end|ng |rom gm@||@com  Wed Feb  1 11:05:46 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Wed, 1 Feb 2023 13:05:46 +0300
Subject: [R] dyn.load(now = FALSE) not actually lazy?
In-Reply-To: <CAPZyOoJdGJ6yYhtmTyCR3v+=6H6XprxSsEG5bKwNbOTPqoJdTA@mail.gmail.com>
References: <CAPZyOoJdGJ6yYhtmTyCR3v+=6H6XprxSsEG5bKwNbOTPqoJdTA@mail.gmail.com>
Message-ID: <20230201130546.7b8abeba@arachnoid>

? Wed, 1 Feb 2023 14:16:54 +1100
Michael Milton <ttmigueltt at gmail.com> ?????:

> Is this a bug in the `dyn.load` implementation for R? If not, why is
> it behaving like this? What should I do about it?

On Unix-like systems, dyn.load forwards its arguments to dlopen(). It
should be possible to confirm with a debugger that R passes RTLD_NOW to
dlopen() when calling dyn.load(now = TRUE) and RTLD_LAZY when calling
dyn.load(now = FALSE).

I don't know for sure why the symbols are being resolved despite you
asked the linker not to. Did something in the system set the
LD_BIND_NOW environment variable? Do any of the libraries in the
dependency tree have any constructors (C++ or
__attribute__((constructor)) or otherwise mentioned in .ini* sections)
that rely on MKL being available at initialisation time?

If you launch R with the environment variable LD_DEBUG=libs set, the
debugging output may shine some light on the problem.

-- 
Best regards,
Ivan


From n|ckmwr@y @end|ng |rom gm@||@com  Wed Feb  1 17:07:51 2023
From: n|ckmwr@y @end|ng |rom gm@||@com (Nick Wray)
Date: Wed, 1 Feb 2023 16:07:51 +0000
Subject: [R] Detpack package
Message-ID: <CABxY9BP_j4Orh8WJv3k30egpTd7X-ins4Zbdq4FJBe9vtwsapA@mail.gmail.com>

Hello   I've successfully installed the package "Detpack" and remembered to
call it via library()  But when I try to use the functions i get this:


chi2testuniform(vals, 0.05)

Error in chi2testuniform(vals, 0.05) :
  could not find function "chi2testuniform"


And yet this function (amongst other which also are not recognised) are all
listed on the CRAN page:
http://cran.nexr.com/web/packages/detpack/detpack.pdf

I can't remember anything like this happening before - as far as I can see
I don't need to load or write anything else before executing the function
and I can't find references to any problems with this package on the net
Can anyone cast light on what's happening?  Thanks Nick Wray

	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Wed Feb  1 17:29:26 2023
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Wed, 1 Feb 2023 18:29:26 +0200
Subject: [R] Detpack package
In-Reply-To: <CABxY9BP_j4Orh8WJv3k30egpTd7X-ins4Zbdq4FJBe9vtwsapA@mail.gmail.com>
References: <CABxY9BP_j4Orh8WJv3k30egpTd7X-ins4Zbdq4FJBe9vtwsapA@mail.gmail.com>
Message-ID: <CAGgJW74mKv3zoOVqDDhi_FLQ-42VkwzbmH5t4=1D3gskgJ7OQQ@mail.gmail.com>

Detpack or detpack?

What happens when you try detpack::chi2testuniform(...) ?


On Wed, Feb 1, 2023 at 6:08 PM Nick Wray <nickmwray at gmail.com> wrote:

> Hello   I've successfully installed the package "Detpack" and remembered to
> call it via library()  But when I try to use the functions i get this:
>
>
> chi2testuniform(vals, 0.05)
>
> Error in chi2testuniform(vals, 0.05) :
>   could not find function "chi2testuniform"
>
>
> And yet this function (amongst other which also are not recognised) are all
> listed on the CRAN page:
> http://cran.nexr.com/web/packages/detpack/detpack.pdf
>
> I can't remember anything like this happening before - as far as I can see
> I don't need to load or write anything else before executing the function
> and I can't find references to any problems with this package on the net
> Can anyone cast light on what's happening?  Thanks Nick Wray
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From n|ckmwr@y @end|ng |rom gm@||@com  Wed Feb  1 17:41:15 2023
From: n|ckmwr@y @end|ng |rom gm@||@com (Nick Wray)
Date: Wed, 1 Feb 2023 16:41:15 +0000
Subject: [R] Detpack package
In-Reply-To: <CAGgJW74mKv3zoOVqDDhi_FLQ-42VkwzbmH5t4=1D3gskgJ7OQQ@mail.gmail.com>
References: <CABxY9BP_j4Orh8WJv3k30egpTd7X-ins4Zbdq4FJBe9vtwsapA@mail.gmail.com>
 <CAGgJW74mKv3zoOVqDDhi_FLQ-42VkwzbmH5t4=1D3gskgJ7OQQ@mail.gmail.com>
Message-ID: <CABxY9BOKrt6mRubbpi_sT2og45Q9kjPZozyRCejw_3VWbtRNbA@mail.gmail.com>

I did use "detpack" ie not with a capital

detpack::chi2testuniform(vals,0.05)
gives this:

Error: 'chi2testuniform' is not an exported object from 'namespace:detpack'
??
Thanks Nick


On Wed, 1 Feb 2023 at 16:29, Eric Berger <ericjberger at gmail.com> wrote:

> Detpack or detpack?
>
> What happens when you try detpack::chi2testuniform(...) ?
>
>
> On Wed, Feb 1, 2023 at 6:08 PM Nick Wray <nickmwray at gmail.com> wrote:
>
>> Hello   I've successfully installed the package "Detpack" and remembered
>> to
>> call it via library()  But when I try to use the functions i get this:
>>
>>
>> chi2testuniform(vals, 0.05)
>>
>> Error in chi2testuniform(vals, 0.05) :
>>   could not find function "chi2testuniform"
>>
>>
>> And yet this function (amongst other which also are not recognised) are
>> all
>> listed on the CRAN page:
>> http://cran.nexr.com/web/packages/detpack/detpack.pdf
>>
>> I can't remember anything like this happening before - as far as I can see
>> I don't need to load or write anything else before executing the function
>> and I can't find references to any problems with this package on the net
>> Can anyone cast light on what's happening?  Thanks Nick Wray
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Feb  1 18:32:43 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 1 Feb 2023 12:32:43 -0500
Subject: [R] Detpack package
In-Reply-To: <CABxY9BOKrt6mRubbpi_sT2og45Q9kjPZozyRCejw_3VWbtRNbA@mail.gmail.com>
References: <CABxY9BP_j4Orh8WJv3k30egpTd7X-ins4Zbdq4FJBe9vtwsapA@mail.gmail.com>
 <CAGgJW74mKv3zoOVqDDhi_FLQ-42VkwzbmH5t4=1D3gskgJ7OQQ@mail.gmail.com>
 <CABxY9BOKrt6mRubbpi_sT2og45Q9kjPZozyRCejw_3VWbtRNbA@mail.gmail.com>
Message-ID: <734b74e7-494d-e0d6-0ea7-dab9962e4d54@gmail.com>

On 01/02/2023 11:41 a.m., Nick Wray wrote:
> I did use "detpack" ie not with a capital
> 
> detpack::chi2testuniform(vals,0.05)
> gives this:
> 
> Error: 'chi2testuniform' is not an exported object from 'namespace:detpack'
> ??
> Thanks Nick
> 

The only exports from detpack are these:

   > library(detpack)
   > ls(2)
   [1] "det.construct" "det.cut"       "det.de"        "det.leafs" 
"det.query"     "det.rnd"       "det1"
   [8] "det2"

It looks as though the author of detpack documented chi2testuniform, but 
forgot to export it.  You can see the source of the version on CRAN here:

   https://github.com/cran/detpack

The author used Roxygen2, but apparently forgot to say @export before 
that function (and some others).  The package tests perfectly OK on 
CRAN, because none of the examples made it into the help pages, where 
they would have failed.

Duncan Murdoch


From ttm|gue|tt @end|ng |rom gm@||@com  Thu Feb  2 03:35:39 2023
From: ttm|gue|tt @end|ng |rom gm@||@com (Michael Milton)
Date: Thu, 2 Feb 2023 13:35:39 +1100
Subject: [R] dyn.load(now = FALSE) not actually lazy?
In-Reply-To: <20230201130546.7b8abeba@arachnoid>
References: <CAPZyOoJdGJ6yYhtmTyCR3v+=6H6XprxSsEG5bKwNbOTPqoJdTA@mail.gmail.com>
 <20230201130546.7b8abeba@arachnoid>
Message-ID: <CAPZyOo+JJeYW9VAVy_Lcyoa9zWxyOAj8cKetKwf5Pm_i6pPQxw@mail.gmail.com>

Hi Ivan,

Thanks for the suggestion.

I found that libpqwalreceiver.so, which is part of pgsql-15.1, made for a
simpler example of my issue. So, using your advice, I ran the following in
my shell:
LD_DEBUG=libs R -e
'dyn.load("/stornext/System/data/tools/pgsql/pgsql-15.1/lib/libpqwalreceiver.so",
now=FALSE)'

I have attached the relevant part of the output from this command below.
The gist of it is that, indeed, R starts to look for dependent libraries
even if now=FALSE. Maybe it is the case that, as Duncan suggests, this is
intended behaviour? But I think it's not ideal behaviour because otherwise
it requires you to topologically sort all library dependencies and load
them in the optimal order, which is very difficult to do. Is there someone
involved in R development who can explain this behaviour to me?

Cheers.

***

>
dyn.load("/stornext/System/data/tools/pgsql/pgsql-15.1/lib/libpqwalreceiver.so",
now=FALSE)
      1655:     find library=libpq.so.5 [0]; searching
      1655:      search
path=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64:/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib:/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib:/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib:/usr/local/lib64:/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server:/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib
        (LD_LIBRARY_PATH)
      1655:       trying
file=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64/libpq.so.5
      1655:       trying
file=/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib/libpq.so.5
      1655:       trying
file=/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib/libpq.so.5
      1655:       trying
file=/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib/libpq.so.5
      1655:       trying file=/usr/local/lib64/libpq.so.5
      1655:       trying
file=/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server/libpq.so.5
      1655:       trying
file=/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib/libpq.so.5
      1655:      search
path=/usr/pgsql-15/lib/tls/x86_64:/usr/pgsql-15/lib/tls:/usr/pgsql-15/lib/x86_64:/usr/pgsql-15/lib
             (RUNPATH from file
/stornext/System/data/tools/pgsql/pgsql-15.1/lib/libpqwalreceiver.so)
      1655:       trying file=/usr/pgsql-15/lib/tls/x86_64/libpq.so.5
      1655:       trying file=/usr/pgsql-15/lib/tls/libpq.so.5
      1655:       trying file=/usr/pgsql-15/lib/x86_64/libpq.so.5
      1655:       trying file=/usr/pgsql-15/lib/libpq.so.5
      1655:      search cache=/etc/ld.so.cache
      1655:       trying file=/lib64/libpq.so.5
      1655:
      1655:     find library=libssl.so.10 [0]; searching
      1655:      search
path=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64:/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib:/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib:/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib:/usr/local/lib64:/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server:/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib
        (LD_LIBRARY_PATH)
      1655:       trying
file=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64/libssl.so.10
      1655:       trying
file=/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib/libssl.so.10
      1655:       trying
file=/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib/libssl.so.10
      1655:       trying
file=/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib/libssl.so.10
      1655:       trying file=/usr/local/lib64/libssl.so.10
      1655:       trying
file=/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server/libssl.so.10
      1655:       trying
file=/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib/libssl.so.10
      1655:      search cache=/etc/ld.so.cache
      1655:       trying file=/lib64/libssl.so.10
      1655:
      1655:     find library=libcrypto.so.10 [0]; searching
      1655:      search
path=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64:/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib:/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib:/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib:/usr/local/lib64:/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server:/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib
        (LD_LIBRARY_PATH)
      1655:       trying
file=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64/libcrypto.so.10
      1655:       trying
file=/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib/libcrypto.so.10
      1655:       trying
file=/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib/libcrypto.so.10
      1655:       trying
file=/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib/libcrypto.so.10
      1655:       trying file=/usr/local/lib64/libcrypto.so.10
      1655:       trying
file=/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server/libcrypto.so.10
      1655:       trying
file=/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib/libcrypto.so.10
      1655:      search cache=/etc/ld.so.cache
      1655:       trying file=/lib64/libcrypto.so.10
      1655:
      1655:     find library=libkrb5.so.3 [0]; searching
      1655:      search
path=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64:/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib:/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib:/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib:/usr/local/lib64:/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server:/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib
        (LD_LIBRARY_PATH)
      1655:       trying
file=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64/libkrb5.so.3
      1655:       trying
file=/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib/libkrb5.so.3
      1655:       trying
file=/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib/libkrb5.so.3
      1655:       trying
file=/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib/libkrb5.so.3
      1655:       trying file=/usr/local/lib64/libkrb5.so.3
      1655:       trying
file=/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server/libkrb5.so.3
      1655:       trying
file=/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib/libkrb5.so.3
      1655:      search cache=/etc/ld.so.cache
      1655:       trying file=/lib64/libkrb5.so.3
      1655:
      1655:     find library=libcom_err.so.2 [0]; searching
      1655:      search
path=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64:/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib:/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib:/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib:/usr/local/lib64:/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server:/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib
        (LD_LIBRARY_PATH)
      1655:       trying
file=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64/libcom_err.so.2
      1655:       trying
file=/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib/libcom_err.so.2
      1655:       trying
file=/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib/libcom_err.so.2
      1655:       trying
file=/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib/libcom_err.so.2
      1655:       trying file=/usr/local/lib64/libcom_err.so.2
      1655:       trying
file=/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server/libcom_err.so.2
      1655:       trying
file=/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib/libcom_err.so.2
      1655:      search cache=/etc/ld.so.cache
      1655:       trying file=/lib64/libcom_err.so.2
      1655:
      1655:     find library=libgssapi_krb5.so.2 [0]; searching
      1655:      search
path=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64:/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib:/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib:/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib:/usr/local/lib64:/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server:/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib
        (LD_LIBRARY_PATH)
      1655:       trying
file=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64/libgssapi_krb5.so.2
      1655:       trying
file=/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib/libgssapi_krb5.so.2
      1655:       trying
file=/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib/libgssapi_krb5.so.2
      1655:       trying
file=/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib/libgssapi_krb5.so.2
      1655:       trying file=/usr/local/lib64/libgssapi_krb5.so.2
      1655:       trying
file=/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server/libgssapi_krb5.so.2
      1655:       trying
file=/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib/libgssapi_krb5.so.2
      1655:      search cache=/etc/ld.so.cache
      1655:       trying file=/lib64/libgssapi_krb5.so.2
      1655:
      1655:     find library=libldap_r-2.4.so.2 [0]; searching
      1655:      search
path=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64:/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib:/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib:/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib:/usr/local/lib64:/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server:/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib
        (LD_LIBRARY_PATH)
      1655:       trying
file=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64/libldap_r-2.4.so.2
      1655:       trying
file=/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib/libldap_r-2.4.so.2
      1655:       trying
file=/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib/libldap_r-2.4.so.2
      1655:       trying
file=/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib/libldap_r-2.4.so.2
      1655:       trying file=/usr/local/lib64/libldap_r-2.4.so.2
      1655:       trying
file=/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server/libldap_r-2.4.so.2
      1655:       trying
file=/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib/libldap_r-2.4.so.2
D_LIBRARY_PATH)
      1655:       trying
file=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64/libplc4.so
      1655:       trying
file=/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib/libplc4.so
      1655:       trying
file=/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib/libplc4.so
      1655:       trying
file=/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib/libplc4.so
      1655:       trying file=/usr/local/lib64/libplc4.so
      1655:       trying
file=/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server/libplc4.so
      1655:       trying
file=/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib/libplc4.so
      1655:      search cache=/etc/ld.so.cache
      1655:       trying file=/lib64/libplc4.so
      1655:
      1655:     find library=libnspr4.so [0]; searching
      1655:      search
path=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64:/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib:/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib:/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib:/usr/local/lib64:/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server:/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib
        (LD_LIBRARY_PATH)
      1655:       trying
file=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64/libnspr4.so
      1655:       trying
file=/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib/libnspr4.so
      1655:       trying
file=/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib/libnspr4.so
      1655:       trying
file=/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib/libnspr4.so
      1655:       trying file=/usr/local/lib64/libnspr4.so
      1655:       trying
file=/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server/libnspr4.so
      1655:       trying
file=/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib/libnspr4.so
      1655:      search cache=/etc/ld.so.cache
      1655:       trying file=/lib64/libnspr4.so
      1655:
      1655:     find library=libselinux.so.1 [0]; searching
      1655:      search
path=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64:/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib:/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib:/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib:/usr/local/lib64:/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server:/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib
        (LD_LIBRARY_PATH)
      1655:       trying
file=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64/libselinux.so.1
      1655:       trying
file=/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib/libselinux.so.1
      1655:       trying
file=/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib/libselinux.so.1
      1655:       trying
file=/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib/libselinux.so.1
      1655:       trying file=/usr/local/lib64/libselinux.so.1
      1655:       trying
file=/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server/libselinux.so.1
      1655:       trying
file=/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib/libselinux.so.1
      1655:      search cache=/etc/ld.so.cache
      1655:       trying file=/lib64/libselinux.so.1
      1655:
      1655:     find library=libpcre.so.1 [0]; searching
      1655:      search
path=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64:/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib:/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib:/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib:/usr/local/lib64:/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server:/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib
        (LD_LIBRARY_PATH)
      1655:       trying
file=/stornext/System/data/apps/gcc/gcc-11.1.0/lib64/libpcre.so.1
      1655:       trying
file=/stornext/System/data/apps/pcre2/pcre2-10.36-gcc-11.1.0/lib/libpcre.so.1
      1655:       trying
file=/stornext/System/data/tools/openSSL/openSSL-1.1.1n/lib/libpcre.so.1
      1655:       trying
file=/stornext/System/data/apps/R/R-4.2.1/lib64/R/lib/libpcre.so.1
      1655:       trying file=/usr/local/lib64/libpcre.so.1
      1655:       trying
file=/stornext/System/data/tools/openjdk/openjdk-13.0.2/lib/server/libpcre.so.1
      1655:       trying
file=/stornext/System/data/apps/hdf5/hdf5-1.8.20/lib/libpcre.so.1
      1655:      search cache=/etc/ld.so.cache
      1655:       trying file=/lib64/libpcre.so.1
      1655:
      1655:
/stornext/System/data/tools/pgsql/pgsql-15.1/lib/libpqwalreceiver.so:
error: symbol lookup error: undefined symbol: work_mem (fatal)
Error in
dyn.load("/stornext/System/data/tools/pgsql/pgsql-15.1/lib/libpqwalreceiver.so",
 :
  unable to load shared object
'/stornext/System/data/tools/pgsql/pgsql-15.1/lib/libpqwalreceiver.so':
  /stornext/System/data/tools/pgsql/pgsql-15.1/lib/libpqwalreceiver.so:
undefined symbol: work_mem
Execution halted

On Wed, Feb 1, 2023 at 9:05 PM Ivan Krylov <krylov.r00t at gmail.com> wrote:

> ? Wed, 1 Feb 2023 14:16:54 +1100
> Michael Milton <ttmigueltt at gmail.com> ?????:
>
> > Is this a bug in the `dyn.load` implementation for R? If not, why is
> > it behaving like this? What should I do about it?
>
> On Unix-like systems, dyn.load forwards its arguments to dlopen(). It
> should be possible to confirm with a debugger that R passes RTLD_NOW to
> dlopen() when calling dyn.load(now = TRUE) and RTLD_LAZY when calling
> dyn.load(now = FALSE).
>
> I don't know for sure why the symbols are being resolved despite you
> asked the linker not to. Did something in the system set the
> LD_BIND_NOW environment variable? Do any of the libraries in the
> dependency tree have any constructors (C++ or
> __attribute__((constructor)) or otherwise mentioned in .ini* sections)
> that rely on MKL being available at initialisation time?
>
> If you launch R with the environment variable LD_DEBUG=libs set, the
> debugging output may shine some light on the problem.
>
> --
> Best regards,
> Ivan
>

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Thu Feb  2 10:10:25 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Thu, 2 Feb 2023 12:10:25 +0300
Subject: [R] dyn.load(now = FALSE) not actually lazy?
In-Reply-To: <CAPZyOo+JJeYW9VAVy_Lcyoa9zWxyOAj8cKetKwf5Pm_i6pPQxw@mail.gmail.com>
References: <CAPZyOoJdGJ6yYhtmTyCR3v+=6H6XprxSsEG5bKwNbOTPqoJdTA@mail.gmail.com>
 <20230201130546.7b8abeba@arachnoid>
 <CAPZyOo+JJeYW9VAVy_Lcyoa9zWxyOAj8cKetKwf5Pm_i6pPQxw@mail.gmail.com>
Message-ID: <20230202121025.62464120@arachnoid>

? Thu, 2 Feb 2023 13:35:39 +1100
Michael Milton <ttmigueltt at gmail.com> ?????:

> The gist of it is that, indeed, R starts to look for dependent
> libraries even if now=FALSE.

I don't think that R does that. Here's a program that should do the
same thing that R does when you call dyn.load(now = FALSE):

#include <dlfcn.h>
#include <stdio.h>

int main(int argc, char ** argv) {
	if (argc != 2) {
		printf("Usage: %s path/to/library.so\n", argv[0]);
		return -1;
	}

	void * ptr = dlopen(argv[1], RTLD_LAZY);
	if (!ptr) {
		printf("%s\n", dlerror());
		return 1;
	}

	dlclose(ptr);
	return 0;
}

Link it with -ldl. If you launch it with LD_DEBUG=all (see also: the
output when you launch something with LD_DEBUG=help), it should give you
even more information about the shared object loading process.

> /stornext/System/data/tools/pgsql/pgsql-15.1/lib/libpqwalreceiver.so:
> error: symbol lookup error: undefined symbol: work_mem (fatal)

I think I have an explanation for this. work_mem turns out to be a
global variable, not a function:

https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/include/miscadmin.h;h=96b3a1e1a0770bdbc25701b5a41e2001a7222b3b;hb=117d2604c2a59eb853e894410b94b4c453f8bd43#l261
https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/utils/init/globals.c;h=1b1d8142548aaf1234fcf1fc92753b9a8b8b3537;hb=117d2604c2a59eb853e894410b94b4c453f8bd43#l125

Indeed, libpqwalreceiver includes the header where the variable is
declared and accesses it:

https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/replication/libpqwalreceiver/libpqwalreceiver.c;h=560ec974fa71444f1cb90e5098cef3c712e5b758;hb=117d2604c2a59eb853e894410b94b4c453f8bd43#l968

I guess that there's no way for the dynamic loader to postpone the
resolution of an import that's a variable, because it has to be a
pointer where the code should be able to read and write data. For
functions, there's stubs in the procedure linkage table that can
resolve the symbol later because they are functions and can do anything.

I could be wrong about my explanation. If you'd like to learn more
about this topic, one way to do that would be to start with Ulrich
Drepper's articles: https://akkadia.org/drepper/dsohowto.pdf

-- 
Best regards,
Ivan


From ho@@@|nmm @end|ng |rom jun|v@edu  Thu Feb  2 15:28:30 2023
From: ho@@@|nmm @end|ng |rom jun|v@edu (Md. Moyazzem Hossain)
Date: Thu, 2 Feb 2023 14:28:30 +0000
Subject: [R] Error: Invalid parent values
Message-ID: <CAO29qn5DiANH_EQkqqz50wCcJS5-=Bsqe6n4aBW=76-QKhp3sQ@mail.gmail.com>

Hi,

I hope that you are doing well.

I am Md Hossain, trying to fit the ARIMAX model in RJAGS. However, I got an
error message while I ran the code. Initially, I am using data obtained
from R-package then I will implement it into real data.

The code and error message are given below.

library(rjags)
#### load the data
data("mtcars")

#### select the response and predictor variables
y <- mtcars$mpg
x <- mtcars[,c("wt","qsec")]

### write the JAGS model code
jags_arimax_model <- "
model {
  beta0 ~ dnorm(0,0.0001)
  beta1 ~ dnorm(0,0.0001)
  beta2 ~ dnorm(0,0.0001)
  phi ~ dnorm(0,0.0001)
  tau ~ dgamma(0.001,0.001)

  #####
  beta0a[1] <- beta0
  beta1a[1] <- beta1
  beta2a[1] <- beta2
  phia[1] <- phi

  mu[1] <- beta0a + beta1a * x[1,1] + beta2a * x[1,2] + phia * y[2]
  ypred[1] ~ dnorm(mu[1], tau)

  ######
  for (i in 2:length(y)) {
  mu[i] <- beta0 + beta1 * x[i,1] + beta2 * x[i,2] + phi * y[i-1]
    ypred[i] ~ dnorm(mu[i], tau)
      }
  }
"

####Fit the Bayesian ARIMAX model using JAGS:

jags_arimax_fit <- jags.model(textConnection(jags_arimax_model), data =
list(y = y, x = x)  )

update(jags_arimax_fit, n.iter=2000, thin=1)

####
output_arimax=coda.samples(model=jags_arimax_fit, variable.names="ypred",
n.iter=2000, thin=5)

However, I got the following error message.


*Error in update.jags(model, n.iter, ...) : Error in node ypred[1]Invalid
parent values*

Please help me in this regard.

Thanks in advance.

Hossain

	[[alternative HTML version deleted]]


From ngre||er @end|ng |rom |q@h@rv@rd@edu  Wed Feb  1 18:49:30 2023
From: ngre||er @end|ng |rom |q@h@rv@rd@edu (Greifer, Noah)
Date: Wed, 1 Feb 2023 12:49:30 -0500
Subject: [R] [R-pkgs] {clarify}: Simulation-Based Inference for Regression
 Models
Message-ID: <CALABNevL7o=4hmB2v2G2PQmeCUcX7oa7YuPMfZ_Q6Az2RoL-pQ@mail.gmail.com>

Hello everyone,

Our new package {clarify} has been released. {clarify} provides
simulation-based inference as an alternative to the delta method for
interpretable quantities derived from model parameters, like average
marginal effects, dose-response functions, and predictions at
representative values. Also provided are methods for combining such
quantities across multiply imputed datasets.

Those of you who have used Clarify for Stata or the retired R package
{Zelig} will find similar and expanded capabilities in {clarify}.

Install {clarify} using
install.packages("clarify")

CRAN page:
https://cran.r-project.org/package=clarify

{clarify} website:
https://iqss.github.io/clarify/

Thank you!

-- 
Noah Greifer, Ph.D.
*Statistical Consultant and Programmer*
*Institute for Quantitative Social Science | Harvard University*
Pronouns: he/him

	[[alternative HTML version deleted]]

_______________________________________________
R-packages mailing list
R-packages at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-packages


From n|ckmwr@y @end|ng |rom gm@||@com  Fri Feb  3 23:02:06 2023
From: n|ckmwr@y @end|ng |rom gm@||@com (Nick Wray)
Date: Fri, 3 Feb 2023 22:02:06 +0000
Subject: [R] Lazy-load corrupt?
Message-ID: <CABxY9BNVKjvLs+KjnitqpCnNfdVN_sd3pEeqsdT705REJ2YckA@mail.gmail.com>

Hello  When trying to call various packages eg
library(raster)
library(sp)
library(rgdal)

I get this error message:
Loading required package: sp
Error: package or namespace load failed for ?sp? in get0(name, envir =
where, mode = "function", inherits = FALSE):
 lazy-load database 'C:/PROGRA~1/R/R-42~1.1/library/base/R/base.rdb' is
corrupt
Error: package ?sp? could not be loaded
In addition: Warning messages:
1: package ?raster? was built under R version 4.2.2
2: package ?sp? was built under R version 4.2.2
3: In get0(name, envir = where, mode = "function", inherits = FALSE) :
  restarting interrupted promise evaluation
4: In get0(name, envir = where, mode = "function", inherits = FALSE) :
  internal error -3 in R_decompress1


Other packages load fine (and the packages above load OK on my spare
laptop) but I'm imagining that this means that I have to uninstall my
current R and reinstall the latest version - but before I go through all
that can anyone confirm that that is indeed what I need to do or is there
some other problem?

Thanks Nick Wray

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Fri Feb  3 23:14:56 2023
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 3 Feb 2023 14:14:56 -0800
Subject: [R] Lazy-load corrupt?
In-Reply-To: <CABxY9BNVKjvLs+KjnitqpCnNfdVN_sd3pEeqsdT705REJ2YckA@mail.gmail.com>
References: <CABxY9BNVKjvLs+KjnitqpCnNfdVN_sd3pEeqsdT705REJ2YckA@mail.gmail.com>
Message-ID: <CAGxFJbTXs1b86Hh5ZTsZ9RneovYXCyhkaezkN2PSkhhfd17ibA@mail.gmail.com>

Sorry -- I am too ignorant to answer your query.

But, just curious: Is there a good reason why you would *not* want to
install the latest version of R and your packages?

Cheers,
Bert

On Fri, Feb 3, 2023 at 2:02 PM Nick Wray <nickmwray at gmail.com> wrote:

> Hello  When trying to call various packages eg
> library(raster)
> library(sp)
> library(rgdal)
>
> I get this error message:
> Loading required package: sp
> Error: package or namespace load failed for ?sp? in get0(name, envir =
> where, mode = "function", inherits = FALSE):
>  lazy-load database 'C:/PROGRA~1/R/R-42~1.1/library/base/R/base.rdb' is
> corrupt
> Error: package ?sp? could not be loaded
> In addition: Warning messages:
> 1: package ?raster? was built under R version 4.2.2
> 2: package ?sp? was built under R version 4.2.2
> 3: In get0(name, envir = where, mode = "function", inherits = FALSE) :
>   restarting interrupted promise evaluation
> 4: In get0(name, envir = where, mode = "function", inherits = FALSE) :
>   internal error -3 in R_decompress1
>
>
> Other packages load fine (and the packages above load OK on my spare
> laptop) but I'm imagining that this means that I have to uninstall my
> current R and reinstall the latest version - but before I go through all
> that can anyone confirm that that is indeed what I need to do or is there
> some other problem?
>
> Thanks Nick Wray
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From h@w|ckh@m @end|ng |rom gm@||@com  Sat Feb  4 21:48:17 2023
From: h@w|ckh@m @end|ng |rom gm@||@com (Hadley Wickham)
Date: Sat, 4 Feb 2023 14:48:17 -0600
Subject: [R] Lazy-load corrupt?
In-Reply-To: <CABxY9BNVKjvLs+KjnitqpCnNfdVN_sd3pEeqsdT705REJ2YckA@mail.gmail.com>
References: <CABxY9BNVKjvLs+KjnitqpCnNfdVN_sd3pEeqsdT705REJ2YckA@mail.gmail.com>
Message-ID: <CABdHhvGDXUfypBP79=eieq8+B975hjRT7bcCFL5ta6URV9_RSA@mail.gmail.com>

This often indicates you need to restart R.
Hadley

On Friday, February 3, 2023, Nick Wray <nickmwray at gmail.com> wrote:

> Hello  When trying to call various packages eg
> library(raster)
> library(sp)
> library(rgdal)
>
> I get this error message:
> Loading required package: sp
> Error: package or namespace load failed for ?sp? in get0(name, envir =
> where, mode = "function", inherits = FALSE):
>  lazy-load database 'C:/PROGRA~1/R/R-42~1.1/library/base/R/base.rdb' is
> corrupt
> Error: package ?sp? could not be loaded
> In addition: Warning messages:
> 1: package ?raster? was built under R version 4.2.2
> 2: package ?sp? was built under R version 4.2.2
> 3: In get0(name, envir = where, mode = "function", inherits = FALSE) :
>   restarting interrupted promise evaluation
> 4: In get0(name, envir = where, mode = "function", inherits = FALSE) :
>   internal error -3 in R_decompress1
>
>
> Other packages load fine (and the packages above load OK on my spare
> laptop) but I'm imagining that this means that I have to uninstall my
> current R and reinstall the latest version - but before I go through all
> that can anyone confirm that that is indeed what I need to do or is there
> some other problem?
>
> Thanks Nick Wray
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/
> posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


-- 
http://hadley.nz

	[[alternative HTML version deleted]]


From up@n@nd@@p@n| @end|ng |rom gm@||@com  Sun Feb  5 15:07:03 2023
From: up@n@nd@@p@n| @end|ng |rom gm@||@com (Upananda Pani)
Date: Sun, 5 Feb 2023 19:37:03 +0530
Subject: [R] Extracting data using subset function
Message-ID: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>

Dear All,

I want to create a vector p and extract first 20 observations using subset
function based on logical condition.

My code is below

p <- 0:100

I know i can extract the first 20 observations using the following command.

q <- p[1:20]

But I want to extract the first 20 observations using subset function which
requires a logical condition. I am not able to frame the logical condition.

The code should be

q <- subset(p, logical condition)

I am not able to do it. Please let me know what you think.

Best regards,
Upananda

	[[alternative HTML version deleted]]


From cry@n @end|ng |rom b|ngh@mton@edu  Sun Feb  5 15:21:31 2023
From: cry@n @end|ng |rom b|ngh@mton@edu (Chris Ryan)
Date: Sun, 05 Feb 2023 09:21:31 -0500
Subject: [R] Extracting data using subset function
In-Reply-To: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
Message-ID: <EA11D990-835A-436A-8AA6-E43440422D4E@binghamton.edu>

Is this a homework problem?

--Chris Ryan
-- 
Sent from my Android device with K-9 Mail. Please excuse my brevity.

On February 5, 2023 9:07:03 AM EST, Upananda Pani <upananda.pani at gmail.com> wrote:
>Dear All,
>
>I want to create a vector p and extract first 20 observations using subset
>function based on logical condition.
>
>My code is below
>
>p <- 0:100
>
>I know i can extract the first 20 observations using the following command.
>
>q <- p[1:20]
>
>But I want to extract the first 20 observations using subset function which
>requires a logical condition. I am not able to frame the logical condition.
>
>The code should be
>
>q <- subset(p, logical condition)
>
>I am not able to do it. Please let me know what you think.
>
>Best regards,
>Upananda
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.


From up@n@nd@@p@n| @end|ng |rom gm@||@com  Sun Feb  5 19:33:58 2023
From: up@n@nd@@p@n| @end|ng |rom gm@||@com (Upananda Pani)
Date: Mon, 6 Feb 2023 00:03:58 +0530
Subject: [R] Extracting data using subset function
In-Reply-To: <EA11D990-835A-436A-8AA6-E43440422D4E@binghamton.edu>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
 <EA11D990-835A-436A-8AA6-E43440422D4E@binghamton.edu>
Message-ID: <CAEezrQQA4U8NuZBHQhHL63CZg9EzQMZzDh0bB8jRGYZ_LTKOAg@mail.gmail.com>

No i am teaching Econometrics and learning R. I am not a student.

Thank you
Upananda

On Sun, 5 Feb, 2023, 19:51 Chris Ryan via R-help, <r-help at r-project.org>
wrote:

> Is this a homework problem?
>
> --Chris Ryan
> --
> Sent from my Android device with K-9 Mail. Please excuse my brevity.
>
> On February 5, 2023 9:07:03 AM EST, Upananda Pani <upananda.pani at gmail.com>
> wrote:
> >Dear All,
> >
> >I want to create a vector p and extract first 20 observations using subset
> >function based on logical condition.
> >
> >My code is below
> >
> >p <- 0:100
> >
> >I know i can extract the first 20 observations using the following
> command.
> >
> >q <- p[1:20]
> >
> >But I want to extract the first 20 observations using subset function
> which
> >requires a logical condition. I am not able to frame the logical
> condition.
> >
> >The code should be
> >
> >q <- subset(p, logical condition)
> >
> >I am not able to do it. Please let me know what you think.
> >
> >Best regards,
> >Upananda
> >
> >       [[alternative HTML version deleted]]
> >
> >______________________________________________
> >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >https://stat.ethz.ch/mailman/listinfo/r-help
> >PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ek@@u@cb @end|ng |rom kyu@hu-u@org  Sun Feb  5 19:44:07 2023
From: ek@@u@cb @end|ng |rom kyu@hu-u@org (=?UTF-8?B?57KV6LC36Iux5LiA?=)
Date: Mon, 6 Feb 2023 03:44:07 +0900
Subject: [R] Extracting data using subset function
In-Reply-To: <CAEezrQQA4U8NuZBHQhHL63CZg9EzQMZzDh0bB8jRGYZ_LTKOAg@mail.gmail.com>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
 <EA11D990-835A-436A-8AA6-E43440422D4E@binghamton.edu>
 <CAEezrQQA4U8NuZBHQhHL63CZg9EzQMZzDh0bB8jRGYZ_LTKOAg@mail.gmail.com>
Message-ID: <CAOGFfEdh66+qobWKg-arXuf=3ipPAT=BYU2rifyXm=NjpXNA6g@mail.gmail.com>

Do you mean something like the following?  Here the first elements are
selected by subset function.

> x1
[1] 9 8 7 6 5 4 3
> z1
[1]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE
> subset(x1,z1)
[1] 9 8 7

2023?2?6?(?) 3:34 Upananda Pani <upananda.pani at gmail.com>:
>
> No i am teaching Econometrics and learning R. I am not a student.
>
> Thank you
> Upananda
>
> On Sun, 5 Feb, 2023, 19:51 Chris Ryan via R-help, <r-help at r-project.org>
> wrote:
>
> > Is this a homework problem?
> >
> > --Chris Ryan
> > --
> > Sent from my Android device with K-9 Mail. Please excuse my brevity.
> >
> > On February 5, 2023 9:07:03 AM EST, Upananda Pani <upananda.pani at gmail.com>
> > wrote:
> > >Dear All,
> > >
> > >I want to create a vector p and extract first 20 observations using subset
> > >function based on logical condition.
> > >
> > >My code is below
> > >
> > >p <- 0:100
> > >
> > >I know i can extract the first 20 observations using the following
> > command.
> > >
> > >q <- p[1:20]
> > >
> > >But I want to extract the first 20 observations using subset function
> > which
> > >requires a logical condition. I am not able to frame the logical
> > condition.
> > >
> > >The code should be
> > >
> > >q <- subset(p, logical condition)
> > >
> > >I am not able to do it. Please let me know what you think.
> > >
> > >Best regards,
> > >Upananda
> > >
> > >       [[alternative HTML version deleted]]
> > >
> > >______________________________________________
> > >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > >https://stat.ethz.ch/mailman/listinfo/r-help
> > >PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > >and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From up@n@nd@@p@n| @end|ng |rom gm@||@com  Sun Feb  5 20:32:24 2023
From: up@n@nd@@p@n| @end|ng |rom gm@||@com (Upananda Pani)
Date: Mon, 6 Feb 2023 01:02:24 +0530
Subject: [R] Extracting data using subset function
In-Reply-To: <CAOGFfEdh66+qobWKg-arXuf=3ipPAT=BYU2rifyXm=NjpXNA6g@mail.gmail.com>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
 <EA11D990-835A-436A-8AA6-E43440422D4E@binghamton.edu>
 <CAEezrQQA4U8NuZBHQhHL63CZg9EzQMZzDh0bB8jRGYZ_LTKOAg@mail.gmail.com>
 <CAOGFfEdh66+qobWKg-arXuf=3ipPAT=BYU2rifyXm=NjpXNA6g@mail.gmail.com>
Message-ID: <CAEezrQTUXbJGfFEHiREYVFPqvrGW=BK7ikU1FyTGX91MhwHOGA@mail.gmail.com>

How you have defined z1?

On Mon, 6 Feb, 2023, 00:14 ????, <ekasuscb at kyushu-u.org> wrote:

> Do you mean something like the following?  Here the first elements are
> selected by subset function.
>
> > x1
> [1] 9 8 7 6 5 4 3
> > z1
> [1]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE
> > subset(x1,z1)
> [1] 9 8 7
>
> 2023?2?6?(?) 3:34 Upananda Pani <upananda.pani at gmail.com>:
> >
> > No i am teaching Econometrics and learning R. I am not a student.
> >
> > Thank you
> > Upananda
> >
> > On Sun, 5 Feb, 2023, 19:51 Chris Ryan via R-help, <r-help at r-project.org>
> > wrote:
> >
> > > Is this a homework problem?
> > >
> > > --Chris Ryan
> > > --
> > > Sent from my Android device with K-9 Mail. Please excuse my brevity.
> > >
> > > On February 5, 2023 9:07:03 AM EST, Upananda Pani <
> upananda.pani at gmail.com>
> > > wrote:
> > > >Dear All,
> > > >
> > > >I want to create a vector p and extract first 20 observations using
> subset
> > > >function based on logical condition.
> > > >
> > > >My code is below
> > > >
> > > >p <- 0:100
> > > >
> > > >I know i can extract the first 20 observations using the following
> > > command.
> > > >
> > > >q <- p[1:20]
> > > >
> > > >But I want to extract the first 20 observations using subset function
> > > which
> > > >requires a logical condition. I am not able to frame the logical
> > > condition.
> > > >
> > > >The code should be
> > > >
> > > >q <- subset(p, logical condition)
> > > >
> > > >I am not able to do it. Please let me know what you think.
> > > >
> > > >Best regards,
> > > >Upananda
> > > >
> > > >       [[alternative HTML version deleted]]
> > > >
> > > >______________________________________________
> > > >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > >https://stat.ethz.ch/mailman/listinfo/r-help
> > > >PLEASE do read the posting guide
> > > http://www.R-project.org/posting-guide.html
> > > >and provide commented, minimal, self-contained, reproducible code.
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide
> > > http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> > >
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From up@n@nd@@p@n| @end|ng |rom gm@||@com  Sun Feb  5 20:33:16 2023
From: up@n@nd@@p@n| @end|ng |rom gm@||@com (Upananda Pani)
Date: Mon, 6 Feb 2023 01:03:16 +0530
Subject: [R] Extracting data using subset function
In-Reply-To: <6c3103c3-af4c-bd5b-789a-b047ca43baad@ugr.es>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
 <6c3103c3-af4c-bd5b-789a-b047ca43baad@ugr.es>
Message-ID: <CAEezrQScP8T_rWcZXCVEq37QhZCVXM9Z68G517m6e+4zEPRtEA@mail.gmail.com>

Thank you. It means we can not use the subset function here.

Regards

On Mon, 6 Feb, 2023, 00:53 Andr?s Gonz?lez Carmona, <andresgc at ugr.es> wrote:

> From ?subset:
> Warning
>
> This is a convenience function intended for use interactively. For
> programming it is better to use the standard subsetting functions like [
> <http://127.0.0.1:21786/library/base/help/%5B>, and in particular the
> non-standard evaluation of argument subset can have unanticipated
> consequences.
>
> El 05/02/2023 a las 15:07, Upananda Pani escribi?:
>
> Dear All,
>
> I want to create a vector p and extract first 20 observations using subset
> function based on logical condition.
>
> My code is below
>
> p <- 0:100
>
> I know i can extract the first 20 observations using the following command.
>
> q <- p[1:20]
>
> But I want to extract the first 20 observations using subset function which
> requires a logical condition. I am not able to frame the logical condition.
>
> The code should be
>
> q <- subset(p, logical condition)
>
> I am not able to do it. Please let me know what you think.
>
> Best regards,
> Upananda
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, seehttps://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHaOp9Qxs4D7d5e10hj3YQ8EuaFc8qbnkynoP5dEA$
> PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHaOp9Qxs4D7d5e10hj3YQ8EuaFc8qbnkwuss43hA$
> and provide commented, minimal, self-contained, reproducible code.
>
> --
> * Andr?s Gonz?lez Carmona *
>

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sun Feb  5 20:57:08 2023
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sun, 05 Feb 2023 11:57:08 -0800
Subject: [R] Extracting data using subset function
In-Reply-To: <CAEezrQScP8T_rWcZXCVEq37QhZCVXM9Z68G517m6e+4zEPRtEA@mail.gmail.com>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
 <6c3103c3-af4c-bd5b-789a-b047ca43baad@ugr.es>
 <CAEezrQScP8T_rWcZXCVEq37QhZCVXM9Z68G517m6e+4zEPRtEA@mail.gmail.com>
Message-ID: <90C83E63-4EF3-42B3-AC2A-0F1AD9640FC8@dcn.davis.ca.us>

No, it means what it says: it is best used interactively rather than in functions. That is not saying you cannot use it... merely that you should probably use it interactively.

The fact is, though, that integer indexing is much simpler and clearer for your particular example than subset is.

q <- p[1:20]
q2 <- subset( p, 1:100 <= 20) # 1:100 are positions

On February 5, 2023 11:33:16 AM PST, Upananda Pani <upananda.pani at gmail.com> wrote:
>Thank you. It means we can not use the subset function here.
>
>Regards
>
>On Mon, 6 Feb, 2023, 00:53 Andr?s Gonz?lez Carmona, <andresgc at ugr.es> wrote:
>
>> From ?subset:
>> Warning
>>
>> This is a convenience function intended for use interactively. For
>> programming it is better to use the standard subsetting functions like [
>> <http://127.0.0.1:21786/library/base/help/%5B>, and in particular the
>> non-standard evaluation of argument subset can have unanticipated
>> consequences.
>>
>> El 05/02/2023 a las 15:07, Upananda Pani escribi?:
>>
>> Dear All,
>>
>> I want to create a vector p and extract first 20 observations using subset
>> function based on logical condition.
>>
>> My code is below
>>
>> p <- 0:100
>>
>> I know i can extract the first 20 observations using the following command.
>>
>> q <- p[1:20]
>>
>> But I want to extract the first 20 observations using subset function which
>> requires a logical condition. I am not able to frame the logical condition.
>>
>> The code should be
>>
>> q <- subset(p, logical condition)
>>
>> I am not able to do it. Please let me know what you think.
>>
>> Best regards,
>> Upananda
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, seehttps://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHaOp9Qxs4D7d5e10hj3YQ8EuaFc8qbnkynoP5dEA$
>> PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHaOp9Qxs4D7d5e10hj3YQ8EuaFc8qbnkwuss43hA$
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> --
>> * Andr?s Gonz?lez Carmona *
>>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From r@turner @end|ng |rom @uck|@nd@@c@nz  Sun Feb  5 20:59:35 2023
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Mon, 6 Feb 2023 08:59:35 +1300
Subject: [R] Extracting data using subset function
In-Reply-To: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
Message-ID: <20230206085935.2b0576f1@rolf-Latitude-E7470>

On Sun, 5 Feb 2023 19:37:03 +0530
Upananda Pani <upananda.pani at gmail.com> wrote:

> Dear All,
> 
> I want to create a vector p and extract first 20 observations using
> subset function based on logical condition.
> 
> My code is below
> 
> p <- 0:100
> 
> I know i can extract the first 20 observations using the following
> command.
> 
> q <- p[1:20]
> 
> But I want to extract the first 20 observations using subset function
> which requires a logical condition. I am not able to frame the
> logical condition.
> 
> The code should be
> 
> q <- subset(p, logical condition)
> 
> I am not able to do it. Please let me know what you think.

I think that you are manufacturing an unnecessary difficulty.  If you
want the first 20 entries of p, use p[1:20]!!!

However, if you obdurately *insist* on using subset() you could do

    subset(p,(1:length(p)) <= 20)

This works, but makes a mountain out of a molehill.

cheers,

Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Stats. Dep't. phone: +64-9-373-7599 ext. 89622
Home phone: +64-9-480-4619


From up@n@nd@@p@n| @end|ng |rom gm@||@com  Sun Feb  5 21:10:46 2023
From: up@n@nd@@p@n| @end|ng |rom gm@||@com (Upananda Pani)
Date: Mon, 6 Feb 2023 01:40:46 +0530
Subject: [R] Extracting data using subset function
In-Reply-To: <90C83E63-4EF3-42B3-AC2A-0F1AD9640FC8@dcn.davis.ca.us>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
 <6c3103c3-af4c-bd5b-789a-b047ca43baad@ugr.es>
 <CAEezrQScP8T_rWcZXCVEq37QhZCVXM9Z68G517m6e+4zEPRtEA@mail.gmail.com>
 <90C83E63-4EF3-42B3-AC2A-0F1AD9640FC8@dcn.davis.ca.us>
Message-ID: <CAEezrQQxDY8__xv3DbY5QPiE_sA+U1Sb_KYowoT7Jbc7wSJ=nQ@mail.gmail.com>

Hi Jeff,

Thanks for your reply. What do you exactly mean by "interactively"?  Would
you please give me an example?
Upananda

On Mon, Feb 6, 2023 at 1:27 AM Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
wrote:

> No, it means what it says: it is best used interactively rather than in
> functions. That is not saying you cannot use it... merely that you should
> probably use it interactively.
>
> The fact is, though, that integer indexing is much simpler and clearer for
> your particular example than subset is.
>
> q <- p[1:20]
> q2 <- subset( p, 1:100 <= 20) # 1:100 are positions
>
> On February 5, 2023 11:33:16 AM PST, Upananda Pani <
> upananda.pani at gmail.com> wrote:
> >Thank you. It means we can not use the subset function here.
> >
> >Regards
> >
> >On Mon, 6 Feb, 2023, 00:53 Andr?s Gonz?lez Carmona, <andresgc at ugr.es>
> wrote:
> >
> >> From ?subset:
> >> Warning
> >>
> >> This is a convenience function intended for use interactively. For
> >> programming it is better to use the standard subsetting functions like [
> >> <http://127.0.0.1:21786/library/base/help/%5B>, and in particular the
> >> non-standard evaluation of argument subset can have unanticipated
> >> consequences.
> >>
> >> El 05/02/2023 a las 15:07, Upananda Pani escribi?:
> >>
> >> Dear All,
> >>
> >> I want to create a vector p and extract first 20 observations using
> subset
> >> function based on logical condition.
> >>
> >> My code is below
> >>
> >> p <- 0:100
> >>
> >> I know i can extract the first 20 observations using the following
> command.
> >>
> >> q <- p[1:20]
> >>
> >> But I want to extract the first 20 observations using subset function
> which
> >> requires a logical condition. I am not able to frame the logical
> condition.
> >>
> >> The code should be
> >>
> >> q <- subset(p, logical condition)
> >>
> >> I am not able to do it. Please let me know what you think.
> >>
> >> Best regards,
> >> Upananda
> >>
> >>      [[alternative HTML version deleted]]
> >>
> >> ______________________________________________R-help at r-project.org
> mailing list -- To UNSUBSCRIBE and more, seehttps://
> urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHaOp9Qxs4D7d5e10hj3YQ8EuaFc8qbnkynoP5dEA$
> >> PLEASE do read the posting guide
> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHaOp9Qxs4D7d5e10hj3YQ8EuaFc8qbnkwuss43hA$
> >> and provide commented, minimal, self-contained, reproducible code.
> >>
> >> --
> >> * Andr?s Gonz?lez Carmona *
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> >______________________________________________
> >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >https://stat.ethz.ch/mailman/listinfo/r-help
> >PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >and provide commented, minimal, self-contained, reproducible code.
>
> --
> Sent from my phone. Please excuse my brevity.
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Feb  5 21:13:54 2023
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 5 Feb 2023 15:13:54 -0500
Subject: [R] Extracting data using subset function
In-Reply-To: <20230206085935.2b0576f1@rolf-Latitude-E7470>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
 <20230206085935.2b0576f1@rolf-Latitude-E7470>
Message-ID: <ee0cc57a-2c1d-dbf9-0ee8-6cd7c603e48c@gmail.com>

On 05/02/2023 2:59 p.m., Rolf Turner wrote:
> On Sun, 5 Feb 2023 19:37:03 +0530
> Upananda Pani <upananda.pani at gmail.com> wrote:
> 
>> Dear All,
>>
>> I want to create a vector p and extract first 20 observations using
>> subset function based on logical condition.
>>
>> My code is below
>>
>> p <- 0:100
>>
>> I know i can extract the first 20 observations using the following
>> command.
>>
>> q <- p[1:20]
>>
>> But I want to extract the first 20 observations using subset function
>> which requires a logical condition. I am not able to frame the
>> logical condition.
>>
>> The code should be
>>
>> q <- subset(p, logical condition)
>>
>> I am not able to do it. Please let me know what you think.
> 
> I think that you are manufacturing an unnecessary difficulty.  If you
> want the first 20 entries of p, use p[1:20]!!!
> 
> However, if you obdurately *insist* on using subset() you could do
> 
>      subset(p,(1:length(p)) <= 20)
> 
> This works, but makes a mountain out of a molehill.

Just to build the mountain a little higher, I would use

   subset(p, seq_along(p) <= 20)

You should generally avoid expressions like "1:length(p)", because they 
don't do what you would expect in the unusual case that p is length 0.

Even in cases where you know p is not length 0, it's a good habit to get 
into so that in the future you don't get surprised.

Duncan Murdoch


From up@n@nd@@p@n| @end|ng |rom gm@||@com  Sun Feb  5 21:16:00 2023
From: up@n@nd@@p@n| @end|ng |rom gm@||@com (Upananda Pani)
Date: Mon, 6 Feb 2023 01:46:00 +0530
Subject: [R] Extracting data using subset function
In-Reply-To: <20230206085935.2b0576f1@rolf-Latitude-E7470>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
 <20230206085935.2b0576f1@rolf-Latitude-E7470>
Message-ID: <CAEezrQReqJFS9g2xjnnDv=ZtDyb3dq+hLedCh5S9PHsekENbWg@mail.gmail.com>

Hi Rolf,

Thank you so much. I was just curious to know that. I am glad that i got
the input from all of you.

I am grateful to you  for clarifying.

With sincere gratitude,
Upananda

On Mon, Feb 6, 2023 at 1:29 AM Rolf Turner <r.turner at auckland.ac.nz> wrote:

> On Sun, 5 Feb 2023 19:37:03 +0530
> Upananda Pani <upananda.pani at gmail.com> wrote:
>
> > Dear All,
> >
> > I want to create a vector p and extract first 20 observations using
> > subset function based on logical condition.
> >
> > My code is below
> >
> > p <- 0:100
> >
> > I know i can extract the first 20 observations using the following
> > command.
> >
> > q <- p[1:20]
> >
> > But I want to extract the first 20 observations using subset function
> > which requires a logical condition. I am not able to frame the
> > logical condition.
> >
> > The code should be
> >
> > q <- subset(p, logical condition)
> >
> > I am not able to do it. Please let me know what you think.
>
> I think that you are manufacturing an unnecessary difficulty.  If you
> want the first 20 entries of p, use p[1:20]!!!
>
> However, if you obdurately *insist* on using subset() you could do
>
>     subset(p,(1:length(p)) <= 20)
>
> This works, but makes a mountain out of a molehill.
>
> cheers,
>
> Rolf Turner
>
> --
> Honorary Research Fellow
> Department of Statistics
> University of Auckland
> Stats. Dep't. phone: +64-9-373-7599 ext. 89622
> Home phone: +64-9-480-4619
>
>

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sun Feb  5 21:29:03 2023
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sun, 05 Feb 2023 12:29:03 -0800
Subject: [R] Extracting data using subset function
In-Reply-To: <CAEezrQQxDY8__xv3DbY5QPiE_sA+U1Sb_KYowoT7Jbc7wSJ=nQ@mail.gmail.com>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
 <6c3103c3-af4c-bd5b-789a-b047ca43baad@ugr.es>
 <CAEezrQScP8T_rWcZXCVEq37QhZCVXM9Z68G517m6e+4zEPRtEA@mail.gmail.com>
 <90C83E63-4EF3-42B3-AC2A-0F1AD9640FC8@dcn.davis.ca.us>
 <CAEezrQQxDY8__xv3DbY5QPiE_sA+U1Sb_KYowoT7Jbc7wSJ=nQ@mail.gmail.com>
Message-ID: <5EEA2A5A-A505-480B-A620-7CA8F2750D01@dcn.davis.ca.us>

I will not (re-)define the basic terms used in describing how R is used... do read [1] for that.

[1] https://cran.r-project.org/doc/manuals/r-release/R-intro.html#Writing-your-own-functions, also via RShowDoc("R-intro"), in particular contrast section 1.5 vs section 10.

On February 5, 2023 12:10:46 PM PST, Upananda Pani <upananda.pani at gmail.com> wrote:
>Hi Jeff,
>
>Thanks for your reply. What do you exactly mean by "interactively"?  Would
>you please give me an example?
>Upananda
>
>On Mon, Feb 6, 2023 at 1:27 AM Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
>wrote:
>
>> No, it means what it says: it is best used interactively rather than in
>> functions. That is not saying you cannot use it... merely that you should
>> probably use it interactively.
>>
>> The fact is, though, that integer indexing is much simpler and clearer for
>> your particular example than subset is.
>>
>> q <- p[1:20]
>> q2 <- subset( p, 1:100 <= 20) # 1:100 are positions
>>
>> On February 5, 2023 11:33:16 AM PST, Upananda Pani <
>> upananda.pani at gmail.com> wrote:
>> >Thank you. It means we can not use the subset function here.
>> >
>> >Regards
>> >
>> >On Mon, 6 Feb, 2023, 00:53 Andr?s Gonz?lez Carmona, <andresgc at ugr.es>
>> wrote:
>> >
>> >> From ?subset:
>> >> Warning
>> >>
>> >> This is a convenience function intended for use interactively. For
>> >> programming it is better to use the standard subsetting functions like [
>> >> <http://127.0.0.1:21786/library/base/help/%5B>, and in particular the
>> >> non-standard evaluation of argument subset can have unanticipated
>> >> consequences.
>> >>
>> >> El 05/02/2023 a las 15:07, Upananda Pani escribi?:
>> >>
>> >> Dear All,
>> >>
>> >> I want to create a vector p and extract first 20 observations using
>> subset
>> >> function based on logical condition.
>> >>
>> >> My code is below
>> >>
>> >> p <- 0:100
>> >>
>> >> I know i can extract the first 20 observations using the following
>> command.
>> >>
>> >> q <- p[1:20]
>> >>
>> >> But I want to extract the first 20 observations using subset function
>> which
>> >> requires a logical condition. I am not able to frame the logical
>> condition.
>> >>
>> >> The code should be
>> >>
>> >> q <- subset(p, logical condition)
>> >>
>> >> I am not able to do it. Please let me know what you think.
>> >>
>> >> Best regards,
>> >> Upananda
>> >>
>> >>      [[alternative HTML version deleted]]
>> >>
>> >> ______________________________________________R-help at r-project.org
>> mailing list -- To UNSUBSCRIBE and more, seehttps://
>> urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHaOp9Qxs4D7d5e10hj3YQ8EuaFc8qbnkynoP5dEA$
>> >> PLEASE do read the posting guide
>> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHaOp9Qxs4D7d5e10hj3YQ8EuaFc8qbnkwuss43hA$
>> >> and provide commented, minimal, self-contained, reproducible code.
>> >>
>> >> --
>> >> * Andr?s Gonz?lez Carmona *
>> >>
>> >
>> >       [[alternative HTML version deleted]]
>> >
>> >______________________________________________
>> >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> >https://stat.ethz.ch/mailman/listinfo/r-help
>> >PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> >and provide commented, minimal, self-contained, reproducible code.
>>
>> --
>> Sent from my phone. Please excuse my brevity.
>>

-- 
Sent from my phone. Please excuse my brevity.


From @vi@e@gross m@iii@g oii gm@ii@com  Sun Feb  5 22:12:19 2023
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Sun, 5 Feb 2023 16:12:19 -0500
Subject: [R] Extracting data using subset function
In-Reply-To: <CAEezrQScP8T_rWcZXCVEq37QhZCVXM9Z68G517m6e+4zEPRtEA@mail.gmail.com>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
 <6c3103c3-af4c-bd5b-789a-b047ca43baad@ugr.es>
 <CAEezrQScP8T_rWcZXCVEq37QhZCVXM9Z68G517m6e+4zEPRtEA@mail.gmail.com>
Message-ID: <009c01d939a6$881b86c0$98529440$@gmail.com>

A major question is why you ask how to use the subset function rather than asking how to get your job done.

As you note, the simple way to get the first N items is to use indexing. If you absolutely positively insist on using subset, place your data into something like a data.frame and add a column and use that.

Say you have N items, so that length() or nrow() return N. You can add a column called index whose entries are 1:N and do your subset to get all rows where the condition is "index <= N" or something like that. 

If you want just the first N (not N at a time in several tries) simply used head(data, N) and that gets you the first N.

And if you are interested in learning other packages like dplyr in the tidyverse, it has oodles of ways to select based on row numbers. One example is top_n(...) and another is slice(first, last)  and in some contexts such as the filter() function, there is a sort of internal function you can use called n() that contains the index of the entry within any grouping so filter(mydata, n() <= 20) might get what you want.

Note that the above requires care as some things work on vectors and others assume a data.frame, albeit you can make a data.frame containing a single vector.


-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Upananda Pani
Sent: Sunday, February 5, 2023 2:33 PM
To: Andr?s Gonz?lez Carmona <andresgc at ugr.es>
Cc: r-help <r-help at r-project.org>
Subject: Re: [R] Extracting data using subset function

Thank you. It means we can not use the subset function here.

Regards

On Mon, 6 Feb, 2023, 00:53 Andr?s Gonz?lez Carmona, <andresgc at ugr.es> wrote:

> From ?subset:
> Warning
>
> This is a convenience function intended for use interactively. For 
> programming it is better to use the standard subsetting functions like 
> [ <http://127.0.0.1:21786/library/base/help/%5B>, and in particular 
> the non-standard evaluation of argument subset can have unanticipated 
> consequences.
>
> El 05/02/2023 a las 15:07, Upananda Pani escribi?:
>
> Dear All,
>
> I want to create a vector p and extract first 20 observations using 
> subset function based on logical condition.
>
> My code is below
>
> p <- 0:100
>
> I know i can extract the first 20 observations using the following command.
>
> q <- p[1:20]
>
> But I want to extract the first 20 observations using subset function 
> which requires a logical condition. I am not able to frame the logical condition.
>
> The code should be
>
> q <- subset(p, logical condition)
>
> I am not able to do it. Please let me know what you think.
>
> Best regards,
> Upananda
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________R-help at r-project.org 
> mailing list -- To UNSUBSCRIBE and more, 
> seehttps://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r
> -help__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHa
> Op9Qxs4D7d5e10hj3YQ8EuaFc8qbnkynoP5dEA$
> PLEASE do read the posting guide 
> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.htm
> l__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHaOp9Q
> xs4D7d5e10hj3YQ8EuaFc8qbnkwuss43hA$
> and provide commented, minimal, self-contained, reproducible code.
>
> --
> * Andr?s Gonz?lez Carmona *
>

	[[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From drj|m|emon @end|ng |rom gm@||@com  Sun Feb  5 22:17:58 2023
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Mon, 6 Feb 2023 08:17:58 +1100
Subject: [R] Extracting data using subset function
In-Reply-To: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
Message-ID: <CA+8X3fVM4HxT7RKA8c=SYx1vtGAU=CQfM5raKJsZCZz5nc8BQA@mail.gmail.com>

Hi Upananda,
As a couple of respondents noted, you only need the logical statement,
not subset().

You did "frame the logical condition" in your example, for if you use
the extraction operator "[" this will work:
subset(p,(1:length(p)) <= 20)
as Jeff already pointed out. Obviously it is easier to write:
p[(1:length(p)) <= 20]

Let's say you want to select the odd numbers in p:
p<-1:10
as.logical(p%%2)
[1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE
p[as.logical(p%%2)]
[1] 1 3 5 7 9
The as.logical() has to be included as the extractor function tries
use integers as indices

So the problem is really to reduce your selection criteria to a vector
of TRUER/FALSE values.

Jim

On Mon, Feb 6, 2023 at 1:07 AM Upananda Pani <upananda.pani at gmail.com> wrote:
>
> Dear All,
>
> I want to create a vector p and extract first 20 observations using subset
> function based on logical condition.
>
> My code is below
>
> p <- 0:100
>
> I know i can extract the first 20 observations using the following command.
>
> q <- p[1:20]
>
> But I want to extract the first 20 observations using subset function which
> requires a logical condition. I am not able to frame the logical condition.
>
> The code should be
>
> q <- subset(p, logical condition)
>
> I am not able to do it. Please let me know what you think.
>
> Best regards,
> Upananda
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sun Feb  5 22:18:45 2023
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sun, 5 Feb 2023 22:18:45 +0100
Subject: [R] Extracting data using subset function
In-Reply-To: <009c01d939a6$881b86c0$98529440$@gmail.com>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
 <6c3103c3-af4c-bd5b-789a-b047ca43baad@ugr.es>
 <CAEezrQScP8T_rWcZXCVEq37QhZCVXM9Z68G517m6e+4zEPRtEA@mail.gmail.com>
 <009c01d939a6$881b86c0$98529440$@gmail.com>
Message-ID: <860f6cbb-b1dc-f2b3-9652-1fa5f79bff6e@statistik.tu-dortmund.de>

I tend not to teach subset() as indexing is needed anyway and hence 
subset() is just an extra level of cpmplexity that is not needed.
Also note what ?subset warns about.

Best,
Uwe Ligges


On 05.02.2023 22:12, avi.e.gross at gmail.com wrote:
> A major question is why you ask how to use the subset function rather than asking how to get your job done.
> 
> As you note, the simple way to get the first N items is to use indexing. If you absolutely positively insist on using subset, place your data into something like a data.frame and add a column and use that.
> 
> Say you have N items, so that length() or nrow() return N. You can add a column called index whose entries are 1:N and do your subset to get all rows where the condition is "index <= N" or something like that.
> 
> If you want just the first N (not N at a time in several tries) simply used head(data, N) and that gets you the first N.
> 
> And if you are interested in learning other packages like dplyr in the tidyverse, it has oodles of ways to select based on row numbers. One example is top_n(...) and another is slice(first, last)  and in some contexts such as the filter() function, there is a sort of internal function you can use called n() that contains the index of the entry within any grouping so filter(mydata, n() <= 20) might get what you want.
> 
> Note that the above requires care as some things work on vectors and others assume a data.frame, albeit you can make a data.frame containing a single vector.
> 
> 
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Upananda Pani
> Sent: Sunday, February 5, 2023 2:33 PM
> To: Andr?s Gonz?lez Carmona <andresgc at ugr.es>
> Cc: r-help <r-help at r-project.org>
> Subject: Re: [R] Extracting data using subset function
> 
> Thank you. It means we can not use the subset function here.
> 
> Regards
> 
> On Mon, 6 Feb, 2023, 00:53 Andr?s Gonz?lez Carmona, <andresgc at ugr.es> wrote:
> 
>>  From ?subset:
>> Warning
>>
>> This is a convenience function intended for use interactively. For
>> programming it is better to use the standard subsetting functions like
>> [ <http://127.0.0.1:21786/library/base/help/%5B>, and in particular
>> the non-standard evaluation of argument subset can have unanticipated
>> consequences.
>>
>> El 05/02/2023 a las 15:07, Upananda Pani escribi?:
>>
>> Dear All,
>>
>> I want to create a vector p and extract first 20 observations using
>> subset function based on logical condition.
>>
>> My code is below
>>
>> p <- 0:100
>>
>> I know i can extract the first 20 observations using the following command.
>>
>> q <- p[1:20]
>>
>> But I want to extract the first 20 observations using subset function
>> which requires a logical condition. I am not able to frame the logical condition.
>>
>> The code should be
>>
>> q <- subset(p, logical condition)
>>
>> I am not able to do it. Please let me know what you think.
>>
>> Best regards,
>> Upananda
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________R-help at r-project.org
>> mailing list -- To UNSUBSCRIBE and more,
>> seehttps://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r
>> -help__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHa
>> Op9Qxs4D7d5e10hj3YQ8EuaFc8qbnkynoP5dEA$
>> PLEASE do read the posting guide
>> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.htm
>> l__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHaOp9Q
>> xs4D7d5e10hj3YQ8EuaFc8qbnkwuss43hA$
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> --
>> * Andr?s Gonz?lez Carmona *
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sun Feb  5 23:14:55 2023
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sun, 5 Feb 2023 22:14:55 +0000
Subject: [R] Extracting data using subset function
In-Reply-To: <CAEezrQScP8T_rWcZXCVEq37QhZCVXM9Z68G517m6e+4zEPRtEA@mail.gmail.com>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
 <6c3103c3-af4c-bd5b-789a-b047ca43baad@ugr.es>
 <CAEezrQScP8T_rWcZXCVEq37QhZCVXM9Z68G517m6e+4zEPRtEA@mail.gmail.com>
Message-ID: <2d94e736-d4d5-1c11-1d68-c426facd6635@sapo.pt>

?s 19:33 de 05/02/2023, Upananda Pani escreveu:
> Thank you. It means we can not use the subset function here.
> 
> Regards
> 
> On Mon, 6 Feb, 2023, 00:53 Andr?s Gonz?lez Carmona, <andresgc at ugr.es> wrote:
> 
>>  From ?subset:
>> Warning
>>
>> This is a convenience function intended for use interactively. For
>> programming it is better to use the standard subsetting functions like [
>> <http://127.0.0.1:21786/library/base/help/%5B>, and in particular the
>> non-standard evaluation of argument subset can have unanticipated
>> consequences.
>>
>> El 05/02/2023 a las 15:07, Upananda Pani escribi?:
>>
>> Dear All,
>>
>> I want to create a vector p and extract first 20 observations using subset
>> function based on logical condition.
>>
>> My code is below
>>
>> p <- 0:100
>>
>> I know i can extract the first 20 observations using the following command.
>>
>> q <- p[1:20]
>>
>> But I want to extract the first 20 observations using subset function which
>> requires a logical condition. I am not able to frame the logical condition.
>>
>> The code should be
>>
>> q <- subset(p, logical condition)
>>
>> I am not able to do it. Please let me know what you think.
>>
>> Best regards,
>> Upananda
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, seehttps://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHaOp9Qxs4D7d5e10hj3YQ8EuaFc8qbnkynoP5dEA$
>> PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHaOp9Qxs4D7d5e10hj3YQ8EuaFc8qbnkwuss43hA$
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> --
>> * Andr?s Gonz?lez Carmona *
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Yes you can:


subset(p, p %in% 1:20)
# [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20


Hope this helps,

Rui Barradas


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sun Feb  5 23:17:23 2023
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sun, 5 Feb 2023 22:17:23 +0000
Subject: [R] Extracting data using subset function
In-Reply-To: <2d94e736-d4d5-1c11-1d68-c426facd6635@sapo.pt>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
 <6c3103c3-af4c-bd5b-789a-b047ca43baad@ugr.es>
 <CAEezrQScP8T_rWcZXCVEq37QhZCVXM9Z68G517m6e+4zEPRtEA@mail.gmail.com>
 <2d94e736-d4d5-1c11-1d68-c426facd6635@sapo.pt>
Message-ID: <130e37a3-d650-afca-e658-d9b8baccb78b@sapo.pt>

?s 22:14 de 05/02/2023, Rui Barradas escreveu:
> ?s 19:33 de 05/02/2023, Upananda Pani escreveu:
>> Thank you. It means we can not use the subset function here.
>>
>> Regards
>>
>> On Mon, 6 Feb, 2023, 00:53 Andr?s Gonz?lez Carmona, <andresgc at ugr.es> 
>> wrote:
>>
>>> ?From ?subset:
>>> Warning
>>>
>>> This is a convenience function intended for use interactively. For
>>> programming it is better to use the standard subsetting functions like [
>>> <http://127.0.0.1:21786/library/base/help/%5B>, and in particular the
>>> non-standard evaluation of argument subset can have unanticipated
>>> consequences.
>>>
>>> El 05/02/2023 a las 15:07, Upananda Pani escribi?:
>>>
>>> Dear All,
>>>
>>> I want to create a vector p and extract first 20 observations using 
>>> subset
>>> function based on logical condition.
>>>
>>> My code is below
>>>
>>> p <- 0:100
>>>
>>> I know i can extract the first 20 observations using the following 
>>> command.
>>>
>>> q <- p[1:20]
>>>
>>> But I want to extract the first 20 observations using subset function 
>>> which
>>> requires a logical condition. I am not able to frame the logical 
>>> condition.
>>>
>>> The code should be
>>>
>>> q <- subset(p, logical condition)
>>>
>>> I am not able to do it. Please let me know what you think.
>>>
>>> Best regards,
>>> Upananda
>>>
>>> ????[[alternative HTML version deleted]]
>>>
>>> ______________________________________________R-help at r-project.org 
>>> mailing list -- To UNSUBSCRIBE and more, 
>>> seehttps://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHaOp9Qxs4D7d5e10hj3YQ8EuaFc8qbnkynoP5dEA$
>>> PLEASE do read the posting guide 
>>> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHaOp9Qxs4D7d5e10hj3YQ8EuaFc8qbnkwuss43hA$
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>> -- 
>>> * Andr?s Gonz?lez Carmona *
>>>
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> Hello,
> 
> Yes you can:
> 
> 
> subset(p, p %in% 1:20)
> # [1]? 1? 2? 3? 4? 5? 6? 7? 8? 9 10 11 12 13 14 15 16 17 18 19 20
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

But a much more natural the *first* n observations is with function head.


head(p, n = 20)
# [1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19


Hope this helps,

Rui Barradas


From r@turner @end|ng |rom @uck|@nd@@c@nz  Sun Feb  5 23:18:05 2023
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Mon, 6 Feb 2023 11:18:05 +1300
Subject: [R] Extracting data using subset function
In-Reply-To: <ee0cc57a-2c1d-dbf9-0ee8-6cd7c603e48c@gmail.com>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
 <20230206085935.2b0576f1@rolf-Latitude-E7470>
 <ee0cc57a-2c1d-dbf9-0ee8-6cd7c603e48c@gmail.com>
Message-ID: <20230206111805.63f46b75@rolf-Latitude-E7470>


On Sun, 5 Feb 2023 15:13:54 -0500
Duncan Murdoch <murdoch.duncan at gmail.com> wrote:

<SNIP>
> 
> Just to build the mountain a little higher, I would use
> 
>    subset(p, seq_along(p) <= 20)
> 
> You should generally avoid expressions like "1:length(p)", because
> they don't do what you would expect in the unusual case that p is
> length 0.
> 
> Even in cases where you know p is not length 0, it's a good habit to
> get into so that in the future you don't get surprised.

Aaarrrggghhh.  That was a dumb-dumb on my part.  As Burns said to
Ripley (fortunes::fortune(26)), good catch.

Thanks.

cheers,

Rolf

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Stats. Dep't. phone: +64-9-373-7599 ext. 89622
Home phone: +64-9-480-4619


From @vi@e@gross m@iii@g oii gm@ii@com  Sun Feb  5 23:59:42 2023
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Sun, 5 Feb 2023 17:59:42 -0500
Subject: [R] Extracting data using subset function
In-Reply-To: <CAEezrQScP8T_rWcZXCVEq37QhZCVXM9Z68G517m6e+4zEPRtEA@mail.gmail.com>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
 <6c3103c3-af4c-bd5b-789a-b047ca43baad@ugr.es>
 <CAEezrQScP8T_rWcZXCVEq37QhZCVXM9Z68G517m6e+4zEPRtEA@mail.gmail.com>
Message-ID: <009f01d939b5$887a71d0$996f5570$@gmail.com>

In reading the post again, it sounds like the question is how to create a logical condition that translates as 1:N is TRUE. Someone hinted along those lines. 

So one WAY I might suggest is you construct a logical vector as shown below. I give an example of a bunch of 9 primes and you want only the first 5.

> vec <- c(1,2,3,5,7,11,13,17, 19)
> length(vec)
[1] 9
> N <- 5
> choose <- rep(TRUE, N)
> choose
[1] TRUE TRUE TRUE TRUE TRUE
> subset(vec, choose)        # will fail as the remaining are recycled or assumed to be true
[1]  1  2  3  5  7 11 13 17 19
> tot = length(vec)
> choose <- c(rep(TRUE, N), rep(FALSE, tot - N))
> choose
[1]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE
> subset(vec, choose)
[1] 1 2 3 5 7

The end shows you need to create N Boolean TRUE values and tot-N FALSE to make a vector of the same length as the first so everything is indexed.

Does something like this meet your needs?

Realistically, the above technique generalizes to more complex cases decently. But sometimes, head(0 and other things I mentioned earlier work quite well.


-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Upananda Pani
Sent: Sunday, February 5, 2023 2:33 PM
To: Andr?s Gonz?lez Carmona <andresgc at ugr.es>
Cc: r-help <r-help at r-project.org>
Subject: Re: [R] Extracting data using subset function

Thank you. It means we can not use the subset function here.

Regards

On Mon, 6 Feb, 2023, 00:53 Andr?s Gonz?lez Carmona, <andresgc at ugr.es> wrote:

> From ?subset:
> Warning
>
> This is a convenience function intended for use interactively. For 
> programming it is better to use the standard subsetting functions like 
> [ <http://127.0.0.1:21786/library/base/help/%5B>, and in particular 
> the non-standard evaluation of argument subset can have unanticipated 
> consequences.
>
> El 05/02/2023 a las 15:07, Upananda Pani escribi?:
>
> Dear All,
>
> I want to create a vector p and extract first 20 observations using 
> subset function based on logical condition.
>
> My code is below
>
> p <- 0:100
>
> I know i can extract the first 20 observations using the following command.
>
> q <- p[1:20]
>
> But I want to extract the first 20 observations using subset function 
> which requires a logical condition. I am not able to frame the logical condition.
>
> The code should be
>
> q <- subset(p, logical condition)
>
> I am not able to do it. Please let me know what you think.
>
> Best regards,
> Upananda
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________R-help at r-project.org 
> mailing list -- To UNSUBSCRIBE and more, 
> seehttps://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r
> -help__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHa
> Op9Qxs4D7d5e10hj3YQ8EuaFc8qbnkynoP5dEA$
> PLEASE do read the posting guide 
> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.htm
> l__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHaOp9Q
> xs4D7d5e10hj3YQ8EuaFc8qbnkwuss43hA$
> and provide commented, minimal, self-contained, reproducible code.
>
> --
> * Andr?s Gonz?lez Carmona *
>

	[[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From up@n@nd@@p@n| @end|ng |rom gm@||@com  Mon Feb  6 10:14:06 2023
From: up@n@nd@@p@n| @end|ng |rom gm@||@com (Upananda Pani)
Date: Mon, 6 Feb 2023 14:44:06 +0530
Subject: [R] Extracting data using subset function
In-Reply-To: <009f01d939b5$887a71d0$996f5570$@gmail.com>
References: <CAEezrQRWrA4VEFxH7rbq0LT3=buT030pfi15UQ7X7i1VCFyoDw@mail.gmail.com>
 <6c3103c3-af4c-bd5b-789a-b047ca43baad@ugr.es>
 <CAEezrQScP8T_rWcZXCVEq37QhZCVXM9Z68G517m6e+4zEPRtEA@mail.gmail.com>
 <009f01d939b5$887a71d0$996f5570$@gmail.com>
Message-ID: <CAEezrQSuFq+gr_DAxM8-0shCSDm81+cctaTKKgjFpDFwYJj6tQ@mail.gmail.com>

Hi Avi,

Thanks a lot. This worked well.

My sincere gratitude to you for teaching me. I am also grateful to
previous forum contributors, who have given me the various dimensions to
think and solve the problem. It has really helped to enhance my
understanding of subsetting function.

Thank you once again to all of you.

Regards,
Upananda Pani

On Mon, Feb 6, 2023 at 4:29 AM <avi.e.gross at gmail.com> wrote:

> In reading the post again, it sounds like the question is how to create a
> logical condition that translates as 1:N is TRUE. Someone hinted along
> those lines.
>
> So one WAY I might suggest is you construct a logical vector as shown
> below. I give an example of a bunch of 9 primes and you want only the first
> 5.
>
> > vec <- c(1,2,3,5,7,11,13,17, 19)
> > length(vec)
> [1] 9
> > N <- 5
> > choose <- rep(TRUE, N)
> > choose
> [1] TRUE TRUE TRUE TRUE TRUE
> > subset(vec, choose)        # will fail as the remaining are recycled or
> assumed to be true
> [1]  1  2  3  5  7 11 13 17 19
> > tot = length(vec)
> > choose <- c(rep(TRUE, N), rep(FALSE, tot - N))
> > choose
> [1]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE
> > subset(vec, choose)
> [1] 1 2 3 5 7
>
> The end shows you need to create N Boolean TRUE values and tot-N FALSE to
> make a vector of the same length as the first so everything is indexed.
>
> Does something like this meet your needs?
>
> Realistically, the above technique generalizes to more complex cases
> decently. But sometimes, head(0 and other things I mentioned earlier work
> quite well.
>
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Upananda Pani
> Sent: Sunday, February 5, 2023 2:33 PM
> To: Andr?s Gonz?lez Carmona <andresgc at ugr.es>
> Cc: r-help <r-help at r-project.org>
> Subject: Re: [R] Extracting data using subset function
>
> Thank you. It means we can not use the subset function here.
>
> Regards
>
> On Mon, 6 Feb, 2023, 00:53 Andr?s Gonz?lez Carmona, <andresgc at ugr.es>
> wrote:
>
> > From ?subset:
> > Warning
> >
> > This is a convenience function intended for use interactively. For
> > programming it is better to use the standard subsetting functions like
> > [ <http://127.0.0.1:21786/library/base/help/%5B>, and in particular
> > the non-standard evaluation of argument subset can have unanticipated
> > consequences.
> >
> > El 05/02/2023 a las 15:07, Upananda Pani escribi?:
> >
> > Dear All,
> >
> > I want to create a vector p and extract first 20 observations using
> > subset function based on logical condition.
> >
> > My code is below
> >
> > p <- 0:100
> >
> > I know i can extract the first 20 observations using the following
> command.
> >
> > q <- p[1:20]
> >
> > But I want to extract the first 20 observations using subset function
> > which requires a logical condition. I am not able to frame the logical
> condition.
> >
> > The code should be
> >
> > q <- subset(p, logical condition)
> >
> > I am not able to do it. Please let me know what you think.
> >
> > Best regards,
> > Upananda
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________R-help at r-project.org
> > mailing list -- To UNSUBSCRIBE and more,
> > seehttps://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r
> > -help__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHa
> > Op9Qxs4D7d5e10hj3YQ8EuaFc8qbnkynoP5dEA$
> > PLEASE do read the posting guide
> > https://urldefense.com/v3/__http://www.R-project.org/posting-guide.htm
> > l__;!!D9dNQwwGXtA!SLdwTGqSfhwUo4CfbUJFeL7hETw64hOG8MQ0FK_o5YdnvVHaOp9Q
> > xs4D7d5e10hj3YQ8EuaFc8qbnkwuss43hA$
> > and provide commented, minimal, self-contained, reproducible code.
> >
> > --
> > * Andr?s Gonz?lez Carmona *
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
>

	[[alternative HTML version deleted]]


From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Tue Feb  7 13:51:50 2023
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Tue, 7 Feb 2023 07:51:50 -0500
Subject: [R] preserve class in apply function
References: <IA1P223MB0499BDE8B29D9ED97029AEE0FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
Message-ID: <IA1P223MB049955F19238028D7A818CB2FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>


> Consider a data.frame whose different columns have numeric, character,
> and factor data.  In apply function, R seems to pass all elements of a
> row as character.  Is it possible to preserve numeric class?
> 
>> mydf <- data.frame(x = rnorm(10), y = runif(10))
>> apply(mydf, 1, function(row) {row["x"] + row["y"]})
> [1]  0.60150197 -0.74201827  0.80476392 -0.59729280 -0.02980335  0.31351909
> [7] -0.63575990  0.22670658  0.55696314  0.39587314
>> mydf[, "z"] <- sample(letters[1:3], 10, replace = TRUE)
>> apply(mydf, 1, function(row) {row["x"] + row["y"]})
> Error in row["x"] + row["y"] (from #1) : non-numeric argument to binary operator
>> apply(mydf, 1, function(row) {as.numeric(row["x"]) + as.numeric(row["y"])})
> [1]  0.60150194 -0.74201826  0.80476394 -0.59729282 -0.02980338  0.31351912
> [7] -0.63575991  0.22670663  0.55696309  0.39587311
>> apply(mydf[,c("x", "y")], 1, function(row) {row["x"] + row["y"]})
> [1]  0.60150197 -0.74201827  0.80476392 -0.59729280 -0.02980335  0.31351909
> [7] -0.63575990  0.22670658  0.55696314  0.39587314


From @kw@|mmo @end|ng |rom gm@||@com  Tue Feb  7 14:02:48 2023
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Tue, 7 Feb 2023 08:02:48 -0500
Subject: [R] preserve class in apply function
In-Reply-To: <IA1P223MB049955F19238028D7A818CB2FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
References: <IA1P223MB0499BDE8B29D9ED97029AEE0FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
 <IA1P223MB049955F19238028D7A818CB2FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
Message-ID: <CAPcHnpRq2ush1xaV0hqK99SbJ43Z3pyxFYGJhnz978t12Rc9eg@mail.gmail.com>

It is not possible, apply() converts its argument to an array. You might be
able to use split() and lapply() to solve your problem.

On Tue, Feb 7, 2023, 07:52 Naresh Gurbuxani <naresh_gurbuxani at hotmail.com>
wrote:

>
> > Consider a data.frame whose different columns have numeric, character,
> > and factor data.  In apply function, R seems to pass all elements of a
> > row as character.  Is it possible to preserve numeric class?
> >
> >> mydf <- data.frame(x = rnorm(10), y = runif(10))
> >> apply(mydf, 1, function(row) {row["x"] + row["y"]})
> > [1]  0.60150197 -0.74201827  0.80476392 -0.59729280 -0.02980335
> 0.31351909
> > [7] -0.63575990  0.22670658  0.55696314  0.39587314
> >> mydf[, "z"] <- sample(letters[1:3], 10, replace = TRUE)
> >> apply(mydf, 1, function(row) {row["x"] + row["y"]})
> > Error in row["x"] + row["y"] (from #1) : non-numeric argument to binary
> operator
> >> apply(mydf, 1, function(row) {as.numeric(row["x"]) +
> as.numeric(row["y"])})
> > [1]  0.60150194 -0.74201826  0.80476394 -0.59729282 -0.02980338
> 0.31351912
> > [7] -0.63575991  0.22670663  0.55696309  0.39587311
> >> apply(mydf[,c("x", "y")], 1, function(row) {row["x"] + row["y"]})
> > [1]  0.60150197 -0.74201827  0.80476392 -0.59729280 -0.02980335
> 0.31351909
> > [7] -0.63575990  0.22670658  0.55696314  0.39587314
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Tue Feb  7 14:05:07 2023
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Tue, 7 Feb 2023 13:05:07 +0000
Subject: [R] preserve class in apply function
In-Reply-To: <IA1P223MB049955F19238028D7A818CB2FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
References: <IA1P223MB0499BDE8B29D9ED97029AEE0FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
 <IA1P223MB049955F19238028D7A818CB2FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
Message-ID: <e0170fdb-e416-c8c5-2f7e-329e2fec5865@sapo.pt>

?s 12:51 de 07/02/2023, Naresh Gurbuxani escreveu:
> 
>> Consider a data.frame whose different columns have numeric, character,
>> and factor data.  In apply function, R seems to pass all elements of a
>> row as character.  Is it possible to preserve numeric class?
>>
>>> mydf <- data.frame(x = rnorm(10), y = runif(10))
>>> apply(mydf, 1, function(row) {row["x"] + row["y"]})
>> [1]  0.60150197 -0.74201827  0.80476392 -0.59729280 -0.02980335  0.31351909
>> [7] -0.63575990  0.22670658  0.55696314  0.39587314
>>> mydf[, "z"] <- sample(letters[1:3], 10, replace = TRUE)
>>> apply(mydf, 1, function(row) {row["x"] + row["y"]})
>> Error in row["x"] + row["y"] (from #1) : non-numeric argument to binary operator
>>> apply(mydf, 1, function(row) {as.numeric(row["x"]) + as.numeric(row["y"])})
>> [1]  0.60150194 -0.74201826  0.80476394 -0.59729282 -0.02980338  0.31351912
>> [7] -0.63575991  0.22670663  0.55696309  0.39587311
>>> apply(mydf[,c("x", "y")], 1, function(row) {row["x"] + row["y"]})
>> [1]  0.60150197 -0.74201827  0.80476392 -0.59729280 -0.02980335  0.31351909
>> [7] -0.63575990  0.22670658  0.55696314  0.39587314
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

The last form,


apply(mydf[,c("x", "y")], 1, function(row) {row["x"] + row["y"]})


is the right one. If your data has columns of a mix of classes, then the 
rows which are vectors are coerced to the greatest common denominator 
class.
 From ?c:


Details
The output type is determined from the highest type of the components in 
the hierarchy NULL < raw < logical < integer < double < complex < 
character < list < expression.



Also, since you have a data.frame the following is another possible way:


apply(mydf[c("x", "y")], 1, function(row) {row["x"] + row["y"]})


This doesn't work with matrices.

Hope this helps,

Rui Barradas


From petr@p|k@| @end|ng |rom prechez@@cz  Tue Feb  7 14:31:41 2023
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Tue, 7 Feb 2023 13:31:41 +0000
Subject: [R] preserve class in apply function
In-Reply-To: <IA1P223MB049955F19238028D7A818CB2FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
References: <IA1P223MB0499BDE8B29D9ED97029AEE0FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
 <IA1P223MB049955F19238028D7A818CB2FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
Message-ID: <2acf27581f5c4638af1d1efa7781a77d@SRVEXCHCM1302.precheza.cz>

Hi Naresh

If you wanted to automate the function a bit you can use sapply to find
numeric columns
ind <- sapply(mydf, is.numeric)

and use it in apply construct
apply(mydf[,ind], 1, function(row) sum(row))
 [1]  2.13002569  0.63305300  1.48420429  0.13523859  1.17515873 -0.98531131
 [7]  0.47044467  0.23914494  0.26504430  0.02037657

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Naresh Gurbuxani
> Sent: Tuesday, February 7, 2023 1:52 PM
> To: r-help at r-project.org
> Subject: [R] preserve class in apply function
> 
> 
> > Consider a data.frame whose different columns have numeric, character,
> > and factor data.  In apply function, R seems to pass all elements of a
> > row as character.  Is it possible to preserve numeric class?
> >
> >> mydf <- data.frame(x = rnorm(10), y = runif(10))
> >> apply(mydf, 1, function(row) {row["x"] + row["y"]})
> > [1]  0.60150197 -0.74201827  0.80476392 -0.59729280 -0.02980335
> 0.31351909
> > [7] -0.63575990  0.22670658  0.55696314  0.39587314
> >> mydf[, "z"] <- sample(letters[1:3], 10, replace = TRUE)
> >> apply(mydf, 1, function(row) {row["x"] + row["y"]})
> > Error in row["x"] + row["y"] (from #1) : non-numeric argument to binary
> operator
> >> apply(mydf, 1, function(row) {as.numeric(row["x"]) +
> as.numeric(row["y"])})
> > [1]  0.60150194 -0.74201826  0.80476394 -0.59729282 -0.02980338
> 0.31351912
> > [7] -0.63575991  0.22670663  0.55696309  0.39587311
> >> apply(mydf[,c("x", "y")], 1, function(row) {row["x"] + row["y"]})
> > [1]  0.60150197 -0.74201827  0.80476392 -0.59729280 -0.02980335
> 0.31351909
> > [7] -0.63575990  0.22670658  0.55696314  0.39587314
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Tue Feb  7 21:29:21 2023
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Tue, 7 Feb 2023 20:29:21 +0000
Subject: [R] preserve class in apply function
In-Reply-To: <2acf27581f5c4638af1d1efa7781a77d@SRVEXCHCM1302.precheza.cz>
References: <IA1P223MB0499BDE8B29D9ED97029AEE0FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
 <IA1P223MB049955F19238028D7A818CB2FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
 <2acf27581f5c4638af1d1efa7781a77d@SRVEXCHCM1302.precheza.cz>
Message-ID: <IA1P223MB0499EBE7CABD9B4F2CA67CC7FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>

Thanks for all the responses.  I need to use some text columns to determine method applied to numeric columns. 

Split seems to be the way to go.

Sent from my iPhone

> On Feb 7, 2023, at 8:31 AM, PIKAL Petr <petr.pikal at precheza.cz> wrote:
> 
> ?Hi Naresh
> 
> If you wanted to automate the function a bit you can use sapply to find
> numeric columns
> ind <- sapply(mydf, is.numeric)
> 
> and use it in apply construct
> apply(mydf[,ind], 1, function(row) sum(row))
> [1]  2.13002569  0.63305300  1.48420429  0.13523859  1.17515873 -0.98531131
> [7]  0.47044467  0.23914494  0.26504430  0.02037657
> 
> Cheers
> Petr
> 
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Naresh Gurbuxani
>> Sent: Tuesday, February 7, 2023 1:52 PM
>> To: r-help at r-project.org
>> Subject: [R] preserve class in apply function
>> 
>> 
>>> Consider a data.frame whose different columns have numeric, character,
>>> and factor data.  In apply function, R seems to pass all elements of a
>>> row as character.  Is it possible to preserve numeric class?
>>> 
>>>> mydf <- data.frame(x = rnorm(10), y = runif(10))
>>>> apply(mydf, 1, function(row) {row["x"] + row["y"]})
>>> [1]  0.60150197 -0.74201827  0.80476392 -0.59729280 -0.02980335
>> 0.31351909
>>> [7] -0.63575990  0.22670658  0.55696314  0.39587314
>>>> mydf[, "z"] <- sample(letters[1:3], 10, replace = TRUE)
>>>> apply(mydf, 1, function(row) {row["x"] + row["y"]})
>>> Error in row["x"] + row["y"] (from #1) : non-numeric argument to binary
>> operator
>>>> apply(mydf, 1, function(row) {as.numeric(row["x"]) +
>> as.numeric(row["y"])})
>>> [1]  0.60150194 -0.74201826  0.80476394 -0.59729282 -0.02980338
>> 0.31351912
>>> [7] -0.63575991  0.22670663  0.55696309  0.39587311
>>>> apply(mydf[,c("x", "y")], 1, function(row) {row["x"] + row["y"]})
>>> [1]  0.60150197 -0.74201827  0.80476392 -0.59729280 -0.02980335
>> 0.31351909
>>> [7] -0.63575990  0.22670658  0.55696314  0.39587314
>> 
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.

From t@n@@@ @end|ng |rom gm@||@com  Tue Feb  7 21:57:02 2023
From: t@n@@@ @end|ng |rom gm@||@com (Bogdan Tanasa)
Date: Tue, 7 Feb 2023 12:57:02 -0800
Subject: [R] overlaying two graphs / plots /lines
Message-ID: <CA+JEM03Pom9Y6vRLzrfNp=P-e4uonr1CN2eLAdpgHTdNgpNwTg@mail.gmail.com>

 Dear all,

Any suggestions on how I could overlay two or more graphs / plots / lines
that have different sizes and the x axes have different breakpoints.

One dataframe is : A :

on x axis : 1 , 7, 9, 20, etc ... (100 elements)
on y axis : 39, 91, 100, 3, etc ... (100 elements)


The other dataframe is : B :

on x axis : 10, 21, 67, 99, 200 etc .. (200 elements).
on y axis :  9, 0, 89, 1000, 90, 1001. ... (200 elements).

Thanks a lot,

Bogdan

	[[alternative HTML version deleted]]


From drj|m|emon @end|ng |rom gm@||@com  Tue Feb  7 22:18:41 2023
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Wed, 8 Feb 2023 08:18:41 +1100
Subject: [R] overlaying two graphs / plots /lines
In-Reply-To: <CA+JEM03Pom9Y6vRLzrfNp=P-e4uonr1CN2eLAdpgHTdNgpNwTg@mail.gmail.com>
References: <CA+JEM03Pom9Y6vRLzrfNp=P-e4uonr1CN2eLAdpgHTdNgpNwTg@mail.gmail.com>
Message-ID: <CA+8X3fVYxE7=c_m1+FeruH1nKC1jpXJJ76t0055-w8s7My8RGA@mail.gmail.com>

Hi Bogdan,
Try this:

A<-data.frame(x=c(1,7,9,20),
 y=c(39,91,100,3))
B<-data.frame(x=c(10,21,67,99,200),
 y=c(9,89,1000,90,1001)) # one value omitted to equalize the rows
xrange<-range(c(unlist(A$x),unlist(B$x)))
yrange<-range(c(unlist(A$y),unlist(B$y)))
plot(A,type="l",xlim=xrange,ylim=yrange,col="red")
lines(B,lty=2,col="blue")
legend(150,400,c("A","B"),lty=1:2,col=c("red","blue"))

There are other tricks to deal with the differences in range between A and B.

Jim

On Wed, Feb 8, 2023 at 7:57 AM Bogdan Tanasa <tanasa at gmail.com> wrote:
>
>  Dear all,
>
> Any suggestions on how I could overlay two or more graphs / plots / lines
> that have different sizes and the x axes have different breakpoints.
>
> One dataframe is : A :
>
> on x axis : 1 , 7, 9, 20, etc ... (100 elements)
> on y axis : 39, 91, 100, 3, etc ... (100 elements)
>
>
> The other dataframe is : B :
>
> on x axis : 10, 21, 67, 99, 200 etc .. (200 elements).
> on y axis :  9, 0, 89, 1000, 90, 1001. ... (200 elements).
>
> Thanks a lot,
>
> Bogdan
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Tue Feb  7 22:34:49 2023
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Tue, 7 Feb 2023 21:34:49 +0000
Subject: [R] overlaying two graphs / plots /lines
In-Reply-To: <CA+8X3fVYxE7=c_m1+FeruH1nKC1jpXJJ76t0055-w8s7My8RGA@mail.gmail.com>
References: <CA+JEM03Pom9Y6vRLzrfNp=P-e4uonr1CN2eLAdpgHTdNgpNwTg@mail.gmail.com>
 <CA+8X3fVYxE7=c_m1+FeruH1nKC1jpXJJ76t0055-w8s7My8RGA@mail.gmail.com>
Message-ID: <9d24355d-e00b-60ea-8217-350fd423e2cb@sapo.pt>

?s 21:18 de 07/02/2023, Jim Lemon escreveu:
> Hi Bogdan,
> Try this:
> 
> A<-data.frame(x=c(1,7,9,20),
>   y=c(39,91,100,3))
> B<-data.frame(x=c(10,21,67,99,200),
>   y=c(9,89,1000,90,1001)) # one value omitted to equalize the rows
> xrange<-range(c(unlist(A$x),unlist(B$x)))
> yrange<-range(c(unlist(A$y),unlist(B$y)))
> plot(A,type="l",xlim=xrange,ylim=yrange,col="red")
> lines(B,lty=2,col="blue")
> legend(150,400,c("A","B"),lty=1:2,col=c("red","blue"))
> 
> There are other tricks to deal with the differences in range between A and B.
> 
> Jim
> 
> On Wed, Feb 8, 2023 at 7:57 AM Bogdan Tanasa <tanasa at gmail.com> wrote:
>>
>>   Dear all,
>>
>> Any suggestions on how I could overlay two or more graphs / plots / lines
>> that have different sizes and the x axes have different breakpoints.
>>
>> One dataframe is : A :
>>
>> on x axis : 1 , 7, 9, 20, etc ... (100 elements)
>> on y axis : 39, 91, 100, 3, etc ... (100 elements)
>>
>>
>> The other dataframe is : B :
>>
>> on x axis : 10, 21, 67, 99, 200 etc .. (200 elements).
>> on y axis :  9, 0, 89, 1000, 90, 1001. ... (200 elements).
>>
>> Thanks a lot,
>>
>> Bogdan
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Here is a ggplot way.
I'll use the same data.

On each data.frame, create an id column, saying which df it is.


A<-data.frame(x=c(1,7,9,20),
               y=c(39,91,100,3))
B<-data.frame(x=c(10,21,67,99,200),
               y=c(9,89,1000,90,1001)) # one value omitted to equalize 
the rows

suppressPackageStartupMessages({
   library(dplyr)
   library(ggplot2)
})

bind_rows(
   A %>% mutate(id = "A"),
   B %>% mutate(id = "B")
)
#>     x    y id
#> 1   1   39  A
#> 2   7   91  A
#> 3   9  100  A
#> 4  20    3  A
#> 5  10    9  B
#> 6  21   89  B
#> 7  67 1000  B
#> 8  99   90  B
#> 9 200 1001  B


To do this in a pipe doesn't change the original data.
Then pipe the result to ggplot separating the lines by mapping id to 
color. ggplot will automatically take care of the axis ranges.


bind_rows(
   A %>% mutate(id = "A"),
   B %>% mutate(id = "B")
) %>%
   ggplot(aes(x, y, colour = id)) +
   geom_line() +
   theme_bw()


Hope this helps,

Rui Barradas


From t@n@@@ @end|ng |rom gm@||@com  Wed Feb  8 00:39:34 2023
From: t@n@@@ @end|ng |rom gm@||@com (Bogdan Tanasa)
Date: Tue, 7 Feb 2023 15:39:34 -0800
Subject: [R] overlaying two graphs / plots /lines
In-Reply-To: <9d24355d-e00b-60ea-8217-350fd423e2cb@sapo.pt>
References: <CA+JEM03Pom9Y6vRLzrfNp=P-e4uonr1CN2eLAdpgHTdNgpNwTg@mail.gmail.com>
 <CA+8X3fVYxE7=c_m1+FeruH1nKC1jpXJJ76t0055-w8s7My8RGA@mail.gmail.com>
 <9d24355d-e00b-60ea-8217-350fd423e2cb@sapo.pt>
Message-ID: <CA+JEM02yPcUKQ0zeUXoA0LLTeqp=O0jUh4yerNgexqHxJ79bMg@mail.gmail.com>

Thanks a lot Rui and Jim. Works great !

On Tue, Feb 7, 2023, 1:34 PM Rui Barradas <ruipbarradas at sapo.pt> wrote:

> ?s 21:18 de 07/02/2023, Jim Lemon escreveu:
> > Hi Bogdan,
> > Try this:
> >
> > A<-data.frame(x=c(1,7,9,20),
> >   y=c(39,91,100,3))
> > B<-data.frame(x=c(10,21,67,99,200),
> >   y=c(9,89,1000,90,1001)) # one value omitted to equalize the rows
> > xrange<-range(c(unlist(A$x),unlist(B$x)))
> > yrange<-range(c(unlist(A$y),unlist(B$y)))
> > plot(A,type="l",xlim=xrange,ylim=yrange,col="red")
> > lines(B,lty=2,col="blue")
> > legend(150,400,c("A","B"),lty=1:2,col=c("red","blue"))
> >
> > There are other tricks to deal with the differences in range between A
> and B.
> >
> > Jim
> >
> > On Wed, Feb 8, 2023 at 7:57 AM Bogdan Tanasa <tanasa at gmail.com> wrote:
> >>
> >>   Dear all,
> >>
> >> Any suggestions on how I could overlay two or more graphs / plots /
> lines
> >> that have different sizes and the x axes have different breakpoints.
> >>
> >> One dataframe is : A :
> >>
> >> on x axis : 1 , 7, 9, 20, etc ... (100 elements)
> >> on y axis : 39, 91, 100, 3, etc ... (100 elements)
> >>
> >>
> >> The other dataframe is : B :
> >>
> >> on x axis : 10, 21, 67, 99, 200 etc .. (200 elements).
> >> on y axis :  9, 0, 89, 1000, 90, 1001. ... (200 elements).
> >>
> >> Thanks a lot,
> >>
> >> Bogdan
> >>
> >>          [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> Hello,
>
> Here is a ggplot way.
> I'll use the same data.
>
> On each data.frame, create an id column, saying which df it is.
>
>
> A<-data.frame(x=c(1,7,9,20),
>                y=c(39,91,100,3))
> B<-data.frame(x=c(10,21,67,99,200),
>                y=c(9,89,1000,90,1001)) # one value omitted to equalize
> the rows
>
> suppressPackageStartupMessages({
>    library(dplyr)
>    library(ggplot2)
> })
>
> bind_rows(
>    A %>% mutate(id = "A"),
>    B %>% mutate(id = "B")
> )
> #>     x    y id
> #> 1   1   39  A
> #> 2   7   91  A
> #> 3   9  100  A
> #> 4  20    3  A
> #> 5  10    9  B
> #> 6  21   89  B
> #> 7  67 1000  B
> #> 8  99   90  B
> #> 9 200 1001  B
>
>
> To do this in a pipe doesn't change the original data.
> Then pipe the result to ggplot separating the lines by mapping id to
> color. ggplot will automatically take care of the axis ranges.
>
>
> bind_rows(
>    A %>% mutate(id = "A"),
>    B %>% mutate(id = "B")
> ) %>%
>    ggplot(aes(x, y, colour = id)) +
>    geom_line() +
>    theme_bw()
>
>
> Hope this helps,
>
> Rui Barradas
>
>

	[[alternative HTML version deleted]]


From JH@rm@e @end|ng |rom roku@com  Wed Feb  8 17:10:00 2023
From: JH@rm@e @end|ng |rom roku@com (Jorgen Harmse)
Date: Wed, 8 Feb 2023 16:10:00 +0000
Subject: [R] preserve class in apply function
In-Reply-To: <mailman.368902.1.1675854001.441.r-help@r-project.org>
References: <mailman.368902.1.1675854001.441.r-help@r-project.org>
Message-ID: <MW4PR01MB6465C313BF052F76705BC345DCD89@MW4PR01MB6465.prod.exchangelabs.com>

What are you trying to do? Why use apply when there is already a vector addition operation?
df$x+df$y or as.numeric(df$x)+as.numeric(df$y) or rowSums(as.numeric(df[c('x','y')])).

As noted in other answers, apply will coerce your data frame to a matrix, and all entries of a matrix must have the same type.

Regards,
Jorgen Harmse.

Message: 1
Date: Tue, 7 Feb 2023 07:51:50 -0500
From: Naresh Gurbuxani <naresh_gurbuxani at hotmail.com>
To: "r-help at r-project.org" <r-help at R-project.org>
Subject: [R] preserve class in apply function
Message-ID:
        <IA1P223MB049955F19238028D7A818CB2FADB9 at IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>

Content-Type: text/plain; charset="us-ascii"


> Consider a data.frame whose different columns have numeric, character,
> and factor data.  In apply function, R seems to pass all elements of a
> row as character.  Is it possible to preserve numeric class?
>
>> mydf <- data.frame(x = rnorm(10), y = runif(10))
>> apply(mydf, 1, function(row) {row["x"] + row["y"]})
> [1]  0.60150197 -0.74201827  0.80476392 -0.59729280 -0.02980335  0.31351909
> [7] -0.63575990  0.22670658  0.55696314  0.39587314
>> mydf[, "z"] <- sample(letters[1:3], 10, replace = TRUE)
>> apply(mydf, 1, function(row) {row["x"] + row["y"]})
> Error in row["x"] + row["y"] (from #1) : non-numeric argument to binary operator
>> apply(mydf, 1, function(row) {as.numeric(row["x"]) + as.numeric(row["y"])})
> [1]  0.60150194 -0.74201826  0.80476394 -0.59729282 -0.02980338  0.31351912
> [7] -0.63575991  0.22670663  0.55696309  0.39587311
>> apply(mydf[,c("x", "y")], 1, function(row) {row["x"] + row["y"]})
> [1]  0.60150197 -0.74201827  0.80476392 -0.59729280 -0.02980335  0.31351909
> [7] -0.63575990  0.22670658  0.55696314  0.39587314





	[[alternative HTML version deleted]]


From t@n@@@ @end|ng |rom gm@||@com  Wed Feb  8 17:35:28 2023
From: t@n@@@ @end|ng |rom gm@||@com (Bogdan Tanasa)
Date: Wed, 8 Feb 2023 08:35:28 -0800
Subject: [R] identify the distribution of the data
Message-ID: <CA+JEM02OBiBuhAdWz4gL-7E-cEjZo_iEdoGzSxMr9HvrYA0t6w@mail.gmail.com>

Dear all,

I do have dataframes with numerical values such as 1,9, 20, 51, 100 etc

Which way do you recommend to use in order to identify the type of the
distribution of the data (normal, poisson, bernoulli, exponential,
log-normal etc ..)

Thanks so much,

Bogdan

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Wed Feb  8 17:59:31 2023
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 8 Feb 2023 08:59:31 -0800
Subject: [R] identify the distribution of the data
In-Reply-To: <CA+JEM02OBiBuhAdWz4gL-7E-cEjZo_iEdoGzSxMr9HvrYA0t6w@mail.gmail.com>
References: <CA+JEM02OBiBuhAdWz4gL-7E-cEjZo_iEdoGzSxMr9HvrYA0t6w@mail.gmail.com>
Message-ID: <CAGxFJbQ5OF=e_vLbGyx+VZNTHz-YJoNNmL3ufnMM6veSP=5iHA@mail.gmail.com>

1. This is a statistical question, which usually is inappropriate here:
this list is about R language (including packages) programming.

2. IMO (so others may disagree), your question indicates a profound
misunderstanding of basic statistical issues. While maybe you phrased it
poorly or I misunderstand, but "identify the type of distribution" is
basically a meaningless query. Explaining why this is so and what may be
more meaningful would require a deep dive into statistics. You might try
referencing a basic statistical text and/or online tutorials. Try searching
on "Goodness of fit", "statistical modeling" or the like.

Cheers,
Bert

On Wed, Feb 8, 2023 at 8:35 AM Bogdan Tanasa <tanasa at gmail.com> wrote:

> Dear all,
>
> I do have dataframes with numerical values such as 1,9, 20, 51, 100 etc
>
> Which way do you recommend to use in order to identify the type of the
> distribution of the data (normal, poisson, bernoulli, exponential,
> log-normal etc ..)
>
> Thanks so much,
>
> Bogdan
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From tebert @end|ng |rom u||@edu  Wed Feb  8 19:06:04 2023
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Wed, 8 Feb 2023 18:06:04 +0000
Subject: [R] identify the distribution of the data
In-Reply-To: <CAGxFJbQ5OF=e_vLbGyx+VZNTHz-YJoNNmL3ufnMM6veSP=5iHA@mail.gmail.com>
References: <CA+JEM02OBiBuhAdWz4gL-7E-cEjZo_iEdoGzSxMr9HvrYA0t6w@mail.gmail.com>
 <CAGxFJbQ5OF=e_vLbGyx+VZNTHz-YJoNNmL3ufnMM6veSP=5iHA@mail.gmail.com>
Message-ID: <SN4PR22MB282473FF2F9E5E99FEAA54A8CFD89@SN4PR22MB2824.namprd22.prod.outlook.com>

IMO) The best approach is to develop a good understanding of the individual processes that resulted in the observed values. The blend of those processes then results in the distribution of the observed values. This is seldom done, and often not possible to do. The alternatives depend on why you are doing this. 

0) Sometime the nature of the data suggest a distribution. You list integer values. If all observations are integer (counts for example) then Poisson may be appropriate. With two values then maybe the Binomial distribution. Continuous data might be normally distributed (Gaussian distribution). If I roll one six-sided die many times I will have a uniform distribution (assuming a fair die). I could then try the same task but roll 2 dice and add the result. I still have discrete values, but the shape is closer to Gaussian. The distribution looks more and more Gaussian as I add more dice together in each roll. 
 
1) Try a simulation. Draw 5 values from a normal distribution, make a histogram. Then do it again. Is it easy to see that both samples are from the same distribution? Personally, the answer is no. So increase the sample size until you are happy with a decision that any two draws are from the same distribution. For my part, at 1 million most people would not be able to detect any difference between the two histograms. This helps calibrate the people. How does your sample size compare to your choice in this exercise?

2) Given that you have sufficient data (see above), can you see the distribution in your data? Is that good enough?

3) Are you doing this as part of following the assumptions of statistical models? In such tests for normality, we tend to assume that a failure to reject the null hypothesis is sufficient proof that the null hypothesis is true. However, in most other cases we are told that a failure to reject the null hypothesis is not sufficient to prove the null hypothesis. You need to work this out, but the importance, consequences, and alternatives of testing model assumptions is a large body of literature with (sometimes) widely divergent viewpoints. 

4) There are hundreds of distributions. https://cran.r-project.org/web/views/Distributions.html but the common distributions are seen in sites like this one:  https://www.stat.umn.edu/geyer/old/5101/rlook.html. Given so many choices, you can probably find one that will fit your data reasonably well. Depending on how many data points you have will determine the reliability of that answer. Is that really informative to the problem you are trying to solve? Answering "what distribution do these data follow?" is not usually the goal.

Regards,
Tim
 

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Bert Gunter
Sent: Wednesday, February 8, 2023 12:00 PM
To: Bogdan Tanasa <tanasa at gmail.com>
Cc: r-help <r-help at r-project.org>
Subject: Re: [R] identify the distribution of the data

[External Email]

1. This is a statistical question, which usually is inappropriate here:
this list is about R language (including packages) programming.

2. IMO (so others may disagree), your question indicates a profound misunderstanding of basic statistical issues. While maybe you phrased it poorly or I misunderstand, but "identify the type of distribution" is basically a meaningless query. Explaining why this is so and what may be more meaningful would require a deep dive into statistics. You might try referencing a basic statistical text and/or online tutorials. Try searching on "Goodness of fit", "statistical modeling" or the like.

Cheers,
Bert

On Wed, Feb 8, 2023 at 8:35 AM Bogdan Tanasa <tanasa at gmail.com> wrote:

> Dear all,
>
> I do have dataframes with numerical values such as 1,9, 20, 51, 100 
> etc
>
> Which way do you recommend to use in order to identify the type of the 
> distribution of the data (normal, poisson, bernoulli, exponential, 
> log-normal etc ..)
>
> Thanks so much,
>
> Bogdan
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat
> .ethz.ch%2Fmailman%2Flistinfo%2Fr-help&data=05%7C01%7Ctebert%40ufl.edu
> %7Cfe002d446d0d4d722f1408db09f5e78f%7C0d4da0f84a314d76ace60a62331e1b84
> %7C0%7C0%7C638114724007457767%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAw
> MDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sda
> ta=GrZd0ZRFfnvbXzZKvJy7XUkRN4IsJOykuN5xTliR4sY%3D&reserved=0
> PLEASE do read the posting guide
> https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r
> -project.org%2Fposting-guide.html&data=05%7C01%7Ctebert%40ufl.edu%7Cfe
> 002d446d0d4d722f1408db09f5e78f%7C0d4da0f84a314d76ace60a62331e1b84%7C0%
> 7C0%7C638114724007457767%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiL
> CJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=Fz
> GMCrWD2aA2zBxcAKXQQEcbD1%2FILkTPB3jjCypcIfI%3D&reserved=0
> and provide commented, minimal, self-contained, reproducible code.
>

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&data=05%7C01%7Ctebert%40ufl.edu%7Cfe002d446d0d4d722f1408db09f5e78f%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638114724007457767%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=GrZd0ZRFfnvbXzZKvJy7XUkRN4IsJOykuN5xTliR4sY%3D&reserved=0
PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&data=05%7C01%7Ctebert%40ufl.edu%7Cfe002d446d0d4d722f1408db09f5e78f%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638114724007457767%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=FzGMCrWD2aA2zBxcAKXQQEcbD1%2FILkTPB3jjCypcIfI%3D&reserved=0
and provide commented, minimal, self-contained, reproducible code.


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Wed Feb  8 19:24:44 2023
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Wed, 8 Feb 2023 12:24:44 -0600
Subject: [R] identify the distribution of the data
In-Reply-To: <SN4PR22MB282473FF2F9E5E99FEAA54A8CFD89@SN4PR22MB2824.namprd22.prod.outlook.com>
References: <CA+JEM02OBiBuhAdWz4gL-7E-cEjZo_iEdoGzSxMr9HvrYA0t6w@mail.gmail.com>
 <CAGxFJbQ5OF=e_vLbGyx+VZNTHz-YJoNNmL3ufnMM6veSP=5iHA@mail.gmail.com>
 <SN4PR22MB282473FF2F9E5E99FEAA54A8CFD89@SN4PR22MB2824.namprd22.prod.outlook.com>
Message-ID: <0f699ded-bf4c-e1e0-646c-285eb9c1b392@effectivedefense.org>



On 2/8/23 12:06 PM, Ebert,Timothy Aaron wrote:
> IMO) The best approach is to develop a good understanding of the individual processes that resulted in the observed values. The blend of those processes then results in the distribution of the observed values. This is seldom done, and often not possible to do. The alternatives depend on why you are doing this.
> 
> 0) Sometime the nature of the data suggest a distribution. You list integer values. If all observations are integer (counts for example) then Poisson may be appropriate. With two values then maybe the Binomial distribution. Continuous data might be normally distributed (Gaussian distribution). If I roll one six-sided die many times I will have a uniform distribution (assuming a fair die). I could then try the same task but roll 2 dice and add the result. I still have discrete values, but the shape is closer to Gaussian. The distribution looks more and more Gaussian as I add more dice together in each roll.


	  I concur:  The application will often suggest a distribution, e.g., 
Poisson, binomial or negative binomial for nonnegative integers, Weibull 
for lifetime data, etc.


	  I love normal probability plots -- the qqnorm function.  This can 
identify outliers or multimodality or the need for a transformation. 
Continuous data that are always positive are often log-normal -- or a 
mixture of log-normals.


x <- rnorm(100)
X <- exp(x)
qqnorm(X, datax=TRUE, log='x')


	  The central limit theorem says that the distribution of almost any 
sum of random variables will be more nearly normal than the 
distributions of individual summands.  It also says that almost any 
product of positive random variables will be more nearly log-normal than 
the distributions of individual components of the product.  This 
application to products is less well known and occasionally controversial.


https://en.wikipedia.org/wiki/Gibrat%27s_law


	  Spencer Graves
	
>   
> 1) Try a simulation. Draw 5 values from a normal distribution, make a histogram. Then do it again. Is it easy to see that both samples are from the same distribution? Personally, the answer is no. So increase the sample size until you are happy with a decision that any two draws are from the same distribution. For my part, at 1 million most people would not be able to detect any difference between the two histograms. This helps calibrate the people. How does your sample size compare to your choice in this exercise?
> 
> 2) Given that you have sufficient data (see above), can you see the distribution in your data? Is that good enough?
> 
> 3) Are you doing this as part of following the assumptions of statistical models? In such tests for normality, we tend to assume that a failure to reject the null hypothesis is sufficient proof that the null hypothesis is true. However, in most other cases we are told that a failure to reject the null hypothesis is not sufficient to prove the null hypothesis. You need to work this out, but the importance, consequences, and alternatives of testing model assumptions is a large body of literature with (sometimes) widely divergent viewpoints.
> 
> 4) There are hundreds of distributions. https://cran.r-project.org/web/views/Distributions.html but the common distributions are seen in sites like this one:  https://www.stat.umn.edu/geyer/old/5101/rlook.html. Given so many choices, you can probably find one that will fit your data reasonably well. Depending on how many data points you have will determine the reliability of that answer. Is that really informative to the problem you are trying to solve? Answering "what distribution do these data follow?" is not usually the goal.
> 
> Regards,
> Tim
>   
> 
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Bert Gunter
> Sent: Wednesday, February 8, 2023 12:00 PM
> To: Bogdan Tanasa <tanasa at gmail.com>
> Cc: r-help <r-help at r-project.org>
> Subject: Re: [R] identify the distribution of the data
> 
> [External Email]
> 
> 1. This is a statistical question, which usually is inappropriate here:
> this list is about R language (including packages) programming.
> 
> 2. IMO (so others may disagree), your question indicates a profound misunderstanding of basic statistical issues. While maybe you phrased it poorly or I misunderstand, but "identify the type of distribution" is basically a meaningless query. Explaining why this is so and what may be more meaningful would require a deep dive into statistics. You might try referencing a basic statistical text and/or online tutorials. Try searching on "Goodness of fit", "statistical modeling" or the like.
> 
> Cheers,
> Bert
> 
> On Wed, Feb 8, 2023 at 8:35 AM Bogdan Tanasa <tanasa at gmail.com> wrote:
> 
>> Dear all,
>>
>> I do have dataframes with numerical values such as 1,9, 20, 51, 100
>> etc
>>
>> Which way do you recommend to use in order to identify the type of the
>> distribution of the data (normal, poisson, bernoulli, exponential,
>> log-normal etc ..)
>>
>> Thanks so much,
>>
>> Bogdan
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat
>> .ethz.ch%2Fmailman%2Flistinfo%2Fr-help&data=05%7C01%7Ctebert%40ufl.edu
>> %7Cfe002d446d0d4d722f1408db09f5e78f%7C0d4da0f84a314d76ace60a62331e1b84
>> %7C0%7C0%7C638114724007457767%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAw
>> MDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sda
>> ta=GrZd0ZRFfnvbXzZKvJy7XUkRN4IsJOykuN5xTliR4sY%3D&reserved=0
>> PLEASE do read the posting guide
>> https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r
>> -project.org%2Fposting-guide.html&data=05%7C01%7Ctebert%40ufl.edu%7Cfe
>> 002d446d0d4d722f1408db09f5e78f%7C0d4da0f84a314d76ace60a62331e1b84%7C0%
>> 7C0%7C638114724007457767%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiL
>> CJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=Fz
>> GMCrWD2aA2zBxcAKXQQEcbD1%2FILkTPB3jjCypcIfI%3D&reserved=0
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
>          [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&data=05%7C01%7Ctebert%40ufl.edu%7Cfe002d446d0d4d722f1408db09f5e78f%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638114724007457767%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=GrZd0ZRFfnvbXzZKvJy7XUkRN4IsJOykuN5xTliR4sY%3D&reserved=0
> PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&data=05%7C01%7Ctebert%40ufl.edu%7Cfe002d446d0d4d722f1408db09f5e78f%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638114724007457767%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=FzGMCrWD2aA2zBxcAKXQQEcbD1%2FILkTPB3jjCypcIfI%3D&reserved=0
> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @vi@e@gross m@iii@g oii gm@ii@com  Wed Feb  8 20:36:01 2023
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Wed, 8 Feb 2023 14:36:01 -0500
Subject: [R] preserve class in apply function
In-Reply-To: <IA1P223MB0499EBE7CABD9B4F2CA67CC7FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
References: <IA1P223MB0499BDE8B29D9ED97029AEE0FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
 <IA1P223MB049955F19238028D7A818CB2FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
 <2acf27581f5c4638af1d1efa7781a77d@SRVEXCHCM1302.precheza.cz>
 <IA1P223MB0499EBE7CABD9B4F2CA67CC7FADB9@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
Message-ID: <005e01d93bf4$93bce730$bb36b590$@gmail.com>



Naresh,

This is a common case where the answer to a question is to ask the right question.

Your question was how to make apply work. My question is how can you get the functionality you want done in some version of R.

Apply is a tool and it is only one of many tools and may be the wrong one for your task. 

For a data.frame there can be lots of tools you may investigate both in vase R and add-on packages like dplyr in the tidyverse.

As has been pointed out, a side-effect of apply is to make a matrix and R automagically figures out what the most specific kind of data type it can handle.

So solutions range from not including any columns that are not numeric, if that makes sense, to accepting they are all going to be of type character and in the function you apply, convert them individually back to what you want.

One straightforward solution is to make a loop indexed to the number of rows in your data.frame and process the variables in each row using [] notation. Not fast, but you see what you have. 

Another is functions like pmap() in the purr package. Yet another might be the rowwise() function in the dplyr package.

It depends on what you want to do. Note with multiple columns, sometimes your function may need to use a ... to receive them.
-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Naresh Gurbuxani
Sent: Tuesday, February 7, 2023 3:29 PM
To: PIKAL Petr <petr.pikal at precheza.cz>
Cc: r-help at r-project.org
Subject: Re: [R] preserve class in apply function

Thanks for all the responses.  I need to use some text columns to determine method applied to numeric columns. 

Split seems to be the way to go.

Sent from my iPhone

> On Feb 7, 2023, at 8:31 AM, PIKAL Petr <petr.pikal at precheza.cz> wrote:
> 
> ?Hi Naresh
> 
> If you wanted to automate the function a bit you can use sapply to 
> find numeric columns ind <- sapply(mydf, is.numeric)
> 
> and use it in apply construct
> apply(mydf[,ind], 1, function(row) sum(row)) [1]  2.13002569  
> 0.63305300  1.48420429  0.13523859  1.17515873 -0.98531131 [7]  
> 0.47044467  0.23914494  0.26504430  0.02037657
> 
> Cheers
> Petr
> 
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Naresh 
>> Gurbuxani
>> Sent: Tuesday, February 7, 2023 1:52 PM
>> To: r-help at r-project.org
>> Subject: [R] preserve class in apply function
>> 
>> 
>>> Consider a data.frame whose different columns have numeric, 
>>> character, and factor data.  In apply function, R seems to pass all 
>>> elements of a row as character.  Is it possible to preserve numeric class?
>>> 
>>>> mydf <- data.frame(x = rnorm(10), y = runif(10)) apply(mydf, 1, 
>>>> function(row) {row["x"] + row["y"]})
>>> [1]  0.60150197 -0.74201827  0.80476392 -0.59729280 -0.02980335
>> 0.31351909
>>> [7] -0.63575990  0.22670658  0.55696314  0.39587314
>>>> mydf[, "z"] <- sample(letters[1:3], 10, replace = TRUE) apply(mydf, 
>>>> 1, function(row) {row["x"] + row["y"]})
>>> Error in row["x"] + row["y"] (from #1) : non-numeric argument to 
>>> binary
>> operator
>>>> apply(mydf, 1, function(row) {as.numeric(row["x"]) +
>> as.numeric(row["y"])})
>>> [1]  0.60150194 -0.74201826  0.80476394 -0.59729282 -0.02980338
>> 0.31351912
>>> [7] -0.63575991  0.22670663  0.55696309  0.39587311
>>>> apply(mydf[,c("x", "y")], 1, function(row) {row["x"] + row["y"]})
>>> [1]  0.60150197 -0.74201827  0.80476392 -0.59729280 -0.02980335
>> 0.31351909
>>> [7] -0.63575990  0.22670658  0.55696314  0.39587314
>> 
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From @vi@e@gross m@iii@g oii gm@ii@com  Wed Feb  8 20:41:34 2023
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Wed, 8 Feb 2023 14:41:34 -0500
Subject: [R] preserve class in apply function
In-Reply-To: <MW4PR01MB6465C313BF052F76705BC345DCD89@MW4PR01MB6465.prod.exchangelabs.com>
References: <mailman.368902.1.1675854001.441.r-help@r-project.org>
 <MW4PR01MB6465C313BF052F76705BC345DCD89@MW4PR01MB6465.prod.exchangelabs.com>
Message-ID: <006001d93bf5$5a30e380$0e92aa80$@gmail.com>

Jorgen is correct that for many purposes, viewing a data.frame as a
collection of vectors of the same length allows you to code fairly complex
logic using whichever vectors you want and result in a vector answer, either
externally or as a new column. Text columns used to make some decisions in
the function are also usable using vectorized functions like ifelse(cond,
when_true, when_false).

And, although much can be done in base R, people often use the
dplyr/tidyverse function of mutate() to do such calculations in a slightly
less wordy way.

You may be looking at apply() as a way to operate one row at a time when an
R paradigm is to be able to operate on all rows sort of at once.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Jorgen Harmse via
R-help
Sent: Wednesday, February 8, 2023 11:10 AM
To: r-help at r-project.org; naresh_gurbuxani at hotmail.com
Subject: Re: [R] preserve class in apply function

What are you trying to do? Why use apply when there is already a vector
addition operation?
df$x+df$y or as.numeric(df$x)+as.numeric(df$y) or
rowSums(as.numeric(df[c('x','y')])).

As noted in other answers, apply will coerce your data frame to a matrix,
and all entries of a matrix must have the same type.

Regards,
Jorgen Harmse.

Message: 1
Date: Tue, 7 Feb 2023 07:51:50 -0500
From: Naresh Gurbuxani <naresh_gurbuxani at hotmail.com>
To: "r-help at r-project.org" <r-help at R-project.org>
Subject: [R] preserve class in apply function
Message-ID:
 
<IA1P223MB049955F19238028D7A818CB2FADB9 at IA1P223MB0499.NAMP223.PROD.OUTLOOK.C
OM>

Content-Type: text/plain; charset="us-ascii"


> Consider a data.frame whose different columns have numeric, character, 
> and factor data.  In apply function, R seems to pass all elements of a 
> row as character.  Is it possible to preserve numeric class?
>
>> mydf <- data.frame(x = rnorm(10), y = runif(10)) apply(mydf, 1, 
>> function(row) {row["x"] + row["y"]})
> [1]  0.60150197 -0.74201827  0.80476392 -0.59729280 -0.02980335  
> 0.31351909 [7] -0.63575990  0.22670658  0.55696314  0.39587314
>> mydf[, "z"] <- sample(letters[1:3], 10, replace = TRUE) apply(mydf, 
>> 1, function(row) {row["x"] + row["y"]})
> Error in row["x"] + row["y"] (from #1) : non-numeric argument to 
> binary operator
>> apply(mydf, 1, function(row) {as.numeric(row["x"]) + 
>> as.numeric(row["y"])})
> [1]  0.60150194 -0.74201826  0.80476394 -0.59729282 -0.02980338  
> 0.31351912 [7] -0.63575991  0.22670663  0.55696309  0.39587311
>> apply(mydf[,c("x", "y")], 1, function(row) {row["x"] + row["y"]})
> [1]  0.60150197 -0.74201827  0.80476392 -0.59729280 -0.02980335  
> 0.31351909 [7] -0.63575990  0.22670658  0.55696314  0.39587314





	[[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


