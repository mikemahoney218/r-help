From |eo@m@d@ @end|ng |rom @yon|c@eu  Sat Jun  1 18:16:23 2024
From: |eo@m@d@ @end|ng |rom @yon|c@eu (Leo Mada)
Date: Sat, 1 Jun 2024 16:16:23 +0000
Subject: [R] Tools to modify highlighted areas in pdf documents?
Message-ID: <DBAP192MB095675B1E0FD76CD59E9155384FD2@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>

Dear R-Users,

Are there any packages that enable the modifications of highlighted areas / annotations in pdf documents?

It seems feasible - I have explored some R code (see below). However, I would rather avoid to reinvent the wheel.

The problem:
When highlighting pdf-documents with Microsoft Edge, the bounding box is sometimes misplaced, and quite ugly so. It also lacks the ability to draw lines or arrows.

On the other hand, I did not get used to Acrobat Reader: it usually involves much more effort to add specific highlights. Lines can be drawn, but are NOT straight!

Are there tools to change the size/position of highlights?
Or to add highlights and underline words?
 Changing position/size manually by editing the data in the pdf-document is possible. Changing the color is more trickier (somehow possible in Microsoft Edger; though the direct approach to rewrite the actual stream is better). Maybe there are some tools to do it?

Some R code is below.

Sincerely,

Leonard
#########

library(zip)

con = file("_some_pdf_.pdf", "rb")

NL = 0
# - very dirty hack;
# - assumes Annotations are in the last fragment/chunk;
while(TRUE) {
    tmp = readBin(con, "raw", 1024*128 + 515);
??????if(length(tmp) == 0) break;
??????x = tmp;
??????# isNL = (x == 10) | (x == 13);
??????isNL = (x == 13);
??????isNL = isNL & (x[which(isNL) + 1] == 10);
    NL = NL + sum(isNL);
}

close(con)

idP = which(isNL)

idS = 935; # will vary with pdf and Annotations and ...;
nLast = 4; # usually 2 chunks
idx = idP[seq(idS, length.out = nLast)]

# Check: Right position?
# tmp = x[seq(idx[1] + 2, idx[1 + 2] - 1)]
# intToUtf8(tmp)

tmp = inflate(x[seq(idx[1] + 2, idx[nLast] - 1)])
intToUtf8(tmp$output)

# Output of inflate: an Example
# "/GS gs .56078434 .87058824 .97647059 rg\n
# 337.298 183.836 m 364.322 183.836 l 364.322 171.83 l 337.298 171.83 l h f\n"

# Note: /BBox[ 337.298 171.83 364.322 183.836]

The raw pdf data:

1948 0 obj
<</AP<</N 1949 0 R >>/C[ 0.560784 0.870588 0.976471]/CA 1/F 4/PDFIUM_HasGeneratedAP true/QuadPoints[ 337.298 186 364.322 186 337.298 174.6 364.322 174.6]/Rect[ 337.298 174.6 364.322 186]/Subtype/Highlight/Type/Annot>>
endobj
1949 0 obj
<</BBox[ 337.298 171.83 364.322 183.836]/Filter/FlateDecode/FormType 1/Length 86/Matrix[ 1 0 0 1 0 0]/Resources<</ExtGState<</GS<</AIS false/BM/Multiply/CA 1/Type/ExtGState/ca 1>>>>>>/Subtype/Form/Type/XObject>>stream
x?E??
?0 ??)~??
?????P@?K?"??t?????j?C???T#?B??z?
W?H??9(A????
K?????_i??mz dR?
endstream
endobj


	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Sat Jun  1 20:23:28 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 1 Jun 2024 11:23:28 -0700
Subject: [R] Tools to modify highlighted areas in pdf documents?
In-Reply-To: <DBAP192MB095675B1E0FD76CD59E9155384FD2@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>
References: <DBAP192MB095675B1E0FD76CD59E9155384FD2@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>
Message-ID: <CAGxFJbTLa+NcvWd5eHzQCfxMrBU3pRnc=zQ33O8XhW9OzeKcUQ@mail.gmail.com>

Search!

on rseek.org, the query "modify pdf documents in R" brought up the staplr
package. A quick web search with the same query brought up the pdftools
package.

These were cursory efforts, so you may well find more. You will have to
determine whether and to what degree any meet your needs.

-- Bert

On Sat, Jun 1, 2024 at 9:16?AM Leo Mada via R-help <r-help at r-project.org>
wrote:

> Dear R-Users,
>
> Are there any packages that enable the modifications of highlighted areas
> / annotations in pdf documents?
>
> It seems feasible - I have explored some R code (see below). However, I
> would rather avoid to reinvent the wheel.
>
> The problem:
> When highlighting pdf-documents with Microsoft Edge, the bounding box is
> sometimes misplaced, and quite ugly so. It also lacks the ability to draw
> lines or arrows.
>
> On the other hand, I did not get used to Acrobat Reader: it usually
> involves much more effort to add specific highlights. Lines can be drawn,
> but are NOT straight!
>
> Are there tools to change the size/position of highlights?
> Or to add highlights and underline words?
>  Changing position/size manually by editing the data in the pdf-document
> is possible. Changing the color is more trickier (somehow possible in
> Microsoft Edger; though the direct approach to rewrite the actual stream is
> better). Maybe there are some tools to do it?
>
> Some R code is below.
>
> Sincerely,
>
> Leonard
> #########
>
> library(zip)
>
> con = file("_some_pdf_.pdf", "rb")
>
> NL = 0
> # - very dirty hack;
> # - assumes Annotations are in the last fragment/chunk;
> while(TRUE) {
>     tmp = readBin(con, "raw", 1024*128 + 515);
> if(length(tmp) == 0) break;
> x = tmp;
> # isNL = (x == 10) | (x == 13);
> isNL = (x == 13);
> isNL = isNL & (x[which(isNL) + 1] == 10);
>     NL = NL + sum(isNL);
> }
>
> close(con)
>
> idP = which(isNL)
>
> idS = 935; # will vary with pdf and Annotations and ...;
> nLast = 4; # usually 2 chunks
> idx = idP[seq(idS, length.out = nLast)]
>
> # Check: Right position?
> # tmp = x[seq(idx[1] + 2, idx[1 + 2] - 1)]
> # intToUtf8(tmp)
>
> tmp = inflate(x[seq(idx[1] + 2, idx[nLast] - 1)])
> intToUtf8(tmp$output)
>
> # Output of inflate: an Example
> # "/GS gs .56078434 .87058824 .97647059 rg\n
> # 337.298 183.836 m 364.322 183.836 l 364.322 171.83 l 337.298 171.83 l h
> f\n"
>
> # Note: /BBox[ 337.298 171.83 364.322 183.836]
>
> The raw pdf data:
>
> 1948 0 obj
> <</AP<</N 1949 0 R >>/C[ 0.560784 0.870588 0.976471]/CA 1/F
> 4/PDFIUM_HasGeneratedAP true/QuadPoints[ 337.298 186 364.322 186 337.298
> 174.6 364.322 174.6]/Rect[ 337.298 174.6 364.322
> 186]/Subtype/Highlight/Type/Annot>>
> endobj
> 1949 0 obj
> <</BBox[ 337.298 171.83 364.322 183.836]/Filter/FlateDecode/FormType
> 1/Length 86/Matrix[ 1 0 0 1 0 0]/Resources<</ExtGState<</GS<</AIS
> false/BM/Multiply/CA 1/Type/ExtGState/ca
> 1>>>>>>/Subtype/Form/Type/XObject>>stream
> x?E??
> ?0  ??)~ ?? ??? ? P@ ?K?"??t???? j?C? ?T#?B??z?
> W?H?? 9(A? ?
> K????? _ i??mz dR ?
> endstream
> endobj
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From |eo@m@d@ @end|ng |rom @yon|c@eu  Sun Jun  2 01:19:56 2024
From: |eo@m@d@ @end|ng |rom @yon|c@eu (Leo Mada)
Date: Sat, 1 Jun 2024 23:19:56 +0000
Subject: [R] Tools to modify highlighted areas in pdf documents?
In-Reply-To: <CAGxFJbTLa+NcvWd5eHzQCfxMrBU3pRnc=zQ33O8XhW9OzeKcUQ@mail.gmail.com>
References: <DBAP192MB095675B1E0FD76CD59E9155384FD2@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>
 <CAGxFJbTLa+NcvWd5eHzQCfxMrBU3pRnc=zQ33O8XhW9OzeKcUQ@mail.gmail.com>
Message-ID: <DBAP192MB09567BB9DA765EEB0649CDB784FD2@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>

Dear Bert,

Thank you very much for the response.

I was aware of pdftools - but did not recall any such functionality. I have checked again (both pdftools, qpdf and the 3rd one): unfortunately, they do not implement such functionality. There might be other packages, which I missed.

However, the functionality is feasible. I will add a few more details - maybe someone picks up the task.

It is possible to edit manually the pdf-file, though it is quite cumbersome to find the right annotation.

1. One needs to edit the values both in the \QuadPoints and the \Rect in the \AP object.

2. Modifying the color is trickier:
\C() encodes the color and \CA the alpha channel (= 1): but neither Acrobat, nor MIcrosoft Edge update the color. The value of the color encoded in the stream is used instead.

It is possible to "trick" Edge: modify the \C color and set "\ca 1" (in the stream block) to a lower value (e.g. "\ca 0.99"). MS Edge will then accept the modified color (but Acrobat ignores it). Changing the value in the stream is the actual solution.

Note: non-rectangular shapes can be specified as well.

I hope that some of the referenced packages pick up this task.

Sincerely,

Leonard

________________________________
From: Bert Gunter <bgunter.4567 at gmail.com>
Sent: Saturday, June 1, 2024 9:23 PM
To: Leo Mada <leo.mada at syonic.eu>
Cc: r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] Tools to modify highlighted areas in pdf documents?

Search!

on rseek.org<http://rseek.org>, the query "modify pdf documents in R" brought up the staplr package. A quick web search with the same query brought up the pdftools package.

These were cursory efforts, so you may well find more. You will have to determine whether and to what degree any meet your needs.

-- Bert

On Sat, Jun 1, 2024 at 9:16?AM Leo Mada via R-help <r-help at r-project.org<mailto:r-help at r-project.org>> wrote:
Dear R-Users,

Are there any packages that enable the modifications of highlighted areas / annotations in pdf documents?

It seems feasible - I have explored some R code (see below). However, I would rather avoid to reinvent the wheel.

The problem:
When highlighting pdf-documents with Microsoft Edge, the bounding box is sometimes misplaced, and quite ugly so. It also lacks the ability to draw lines or arrows.

On the other hand, I did not get used to Acrobat Reader: it usually involves much more effort to add specific highlights. Lines can be drawn, but are NOT straight!

Are there tools to change the size/position of highlights?
Or to add highlights and underline words?
 Changing position/size manually by editing the data in the pdf-document is possible. Changing the color is more trickier (somehow possible in Microsoft Edger; though the direct approach to rewrite the actual stream is better). Maybe there are some tools to do it?

Some R code is below.

Sincerely,

Leonard
#########

library(zip)

con = file("_some_pdf_.pdf", "rb")

NL = 0
# - very dirty hack;
# - assumes Annotations are in the last fragment/chunk;
while(TRUE) {
    tmp = readBin(con, "raw", 1024*128 + 515);
if(length(tmp) == 0) break;
x = tmp;
# isNL = (x == 10) | (x == 13);
isNL = (x == 13);
isNL = isNL & (x[which(isNL) + 1] == 10);
    NL = NL + sum(isNL);
}

close(con)

idP = which(isNL)

idS = 935; # will vary with pdf and Annotations and ...;
nLast = 4; # usually 2 chunks
idx = idP[seq(idS, length.out = nLast)]

# Check: Right position?
# tmp = x[seq(idx[1] + 2, idx[1 + 2] - 1)]
# intToUtf8(tmp)

tmp = inflate(x[seq(idx[1] + 2, idx[nLast] - 1)])
intToUtf8(tmp$output)

# Output of inflate: an Example
# "/GS gs .56078434 .87058824 .97647059 rg\n
# 337.298 183.836 m 364.322 183.836 l 364.322 171.83 l 337.298 171.83 l h f\n"

# Note: /BBox[ 337.298 171.83 364.322 183.836]

The raw pdf data:

1948 0 obj
<</AP<</N 1949 0 R >>/C[ 0.560784 0.870588 0.976471]/CA 1/F 4/PDFIUM_HasGeneratedAP true/QuadPoints[ 337.298 186 364.322 186 337.298 174.6 364.322 174.6]/Rect[ 337.298 174.6 364.322 186]/Subtype/Highlight/Type/Annot>>
endobj
1949 0 obj
<</BBox[ 337.298 171.83 364.322 183.836]/Filter/FlateDecode/FormType 1/Length 86/Matrix[ 1 0 0 1 0 0]/Resources<</ExtGState<</GS<</AIS false/BM/Multiply/CA 1/Type/ExtGState/ca 1>>>>>>/Subtype/Form/Type/XObject>>stream
x?E??
?0  ??)~ ?? ??? ? P@ ?K?"??t???? j?C? ?T#?B??z?
W?H?? 9(A????
K????? _ i??mz dR ?
endstream
endobj


        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From @h@dee@@@ht@r| @end|ng |rom gm@||@com  Sun Jun  2 00:31:27 2024
From: @h@dee@@@ht@r| @end|ng |rom gm@||@com (Shadee Ashtari)
Date: Sat, 1 Jun 2024 15:31:27 -0700
Subject: [R] R code for overlapping variables -- count
Message-ID: <CAFMWFxDjNSAwB21ZyZ4JSJ_CT96t438v24smX_qSkb7TNBjhhg@mail.gmail.com>

Hi!

I am trying to find the code for how to get counts for intersectional
variables. For example, I have three unique categorical variables --
"Female," "USA," and "MidIncome" -- and I'm trying to see how many people I
have at the intersection of the three.

Thank you so much,
Shadee

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Jun  2 11:55:28 2024
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 2 Jun 2024 05:55:28 -0400
Subject: [R] R code for overlapping variables -- count
In-Reply-To: <CAFMWFxDjNSAwB21ZyZ4JSJ_CT96t438v24smX_qSkb7TNBjhhg@mail.gmail.com>
References: <CAFMWFxDjNSAwB21ZyZ4JSJ_CT96t438v24smX_qSkb7TNBjhhg@mail.gmail.com>
Message-ID: <91c837fa-1c68-4766-888c-afda779f8b99@gmail.com>

On 2024-06-01 6:31 p.m., Shadee Ashtari wrote:
> Hi!
> 
> I am trying to find the code for how to get counts for intersectional
> variables. For example, I have three unique categorical variables --
> "Female," "USA," and "MidIncome" -- and I'm trying to see how many people I
> have at the intersection of the three.

It depends on how those are stored.  Could you put together a little 
dataframe containing sample data, run `dput()` on it, and post the 
result here?

Duncan Murdoch


From |kry|ov @end|ng |rom d|@root@org  Sun Jun  2 19:02:38 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Sun, 2 Jun 2024 20:02:38 +0300
Subject: [R] Tools to modify highlighted areas in pdf documents?
In-Reply-To: <DBAP192MB095675B1E0FD76CD59E9155384FD2@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>
References: <DBAP192MB095675B1E0FD76CD59E9155384FD2@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>
Message-ID: <20240602200238.1f57909d@Tarkus>

? Sat, 1 Jun 2024 16:16:23 +0000
Leo Mada via R-help <r-help at r-project.org> ?????:

> When highlighting pdf-documents with Microsoft Edge, the bounding box
> is sometimes misplaced, and quite ugly so. It also lacks the ability
> to draw lines or arrows.
> 
> On the other hand, I did not get used to Acrobat Reader: it usually
> involves much more effort to add specific highlights. Lines can be
> drawn, but are NOT straight!

Sorry for answering a different question, but have you considered using
a different PDF viewer + annotation application? Okular
<https://okular.kde.org/> is free and available on Windows (including
from outside Microsoft store). Its annotation features include all
kinds of highlights, arrows and lines, both straight and
arbitrarily-shaped, quickly available from the "annotations" panel.

-- 
Best regards,
Ivan


From |eo@m@d@ @end|ng |rom @yon|c@eu  Sun Jun  2 19:34:35 2024
From: |eo@m@d@ @end|ng |rom @yon|c@eu (Leo Mada)
Date: Sun, 2 Jun 2024 17:34:35 +0000
Subject: [R] R code for overlapping variables -- count
Message-ID: <DBAP192MB0956787CE5BE81D0A6FD4FA284FE2@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>

Dear Shadee,

If you have a data.frame with the following columns:

n = 100; # population size
x = data.frame(
??????Sex = sample(c("M","F"), n, T),
??????Country = sample(c("AA", "BB", "US"), n, T),
??????Income  = as.factor(sample(1:3, n, T))
)

# Dummy variable
ONE = rep(1, nrow(x))

r = aggregate(ONE ~ Sex + Income + Country, length, data = x)
r = r[, c("Country", "Income", "Sex")]
print(r)

It is possible to write more simple code, if you need only the particular combination of variables (which you specified in your mail). But this is the more general approach.

Note: you may want to use "sum" instead of "length", e.g. if you have a column specifying the number of individuals in that category.


Hope this helps,

Leonard


	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sun Jun  2 19:40:51 2024
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sun, 2 Jun 2024 18:40:51 +0100
Subject: [R] R code for overlapping variables -- count
In-Reply-To: <DBAP192MB0956787CE5BE81D0A6FD4FA284FE2@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>
References: <DBAP192MB0956787CE5BE81D0A6FD4FA284FE2@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>
Message-ID: <6b70be1b-0688-443b-b6a8-4ff077734860@sapo.pt>

?s 18:34 de 02/06/2024, Leo Mada via R-help escreveu:
> Dear Shadee,
> 
> If you have a data.frame with the following columns:
> 
> n = 100; # population size
> x = data.frame(
> ??????Sex = sample(c("M","F"), n, T),
> ??????Country = sample(c("AA", "BB", "US"), n, T),
> ??????Income  = as.factor(sample(1:3, n, T))
> )
> 
> # Dummy variable
> ONE = rep(1, nrow(x))
> 
> r = aggregate(ONE ~ Sex + Income + Country, length, data = x)
> r = r[, c("Country", "Income", "Sex")]
> print(r)
> 
> It is possible to write more simple code, if you need only the particular combination of variables (which you specified in your mail). But this is the more general approach.
> 
> Note: you may want to use "sum" instead of "length", e.g. if you have a column specifying the number of individuals in that category.
> 
> 
> Hope this helps,
> 
> Leonard
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

The following is simpler.


r2 <- xtabs(~ ., x) |> as.data.frame()
r2[-4L] # or r2[names(r2) != "Freq"]


Hope this helps,

Rui Barradas


-- 
Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.
www.avg.com


From |eo@m@d@ @end|ng |rom @yon|c@eu  Sun Jun  2 19:41:00 2024
From: |eo@m@d@ @end|ng |rom @yon|c@eu (Leo Mada)
Date: Sun, 2 Jun 2024 17:41:00 +0000
Subject: [R] R code for overlapping variables -- count
In-Reply-To: <DBAP192MB0956787CE5BE81D0A6FD4FA284FE2@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>
References: <DBAP192MB0956787CE5BE81D0A6FD4FA284FE2@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>
Message-ID: <DBAP192MB09562DB092CFE2F72559116584FE2@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>

Correcting a small glitch - see new code.

________________________________
From: Leo Mada <leo.mada at syonic.eu>
Sent: Sunday, June 2, 2024 8:34 PM
To: Shadee Ashtari <shadee.ashtari at gmail.com>
Cc: r-help at r-project.org <r-help at r-project.org>
Subject: [R] R code for overlapping variables -- count

Dear Shadee,

If you have a data.frame with the following columns:

n = 100; # population size
x = data.frame(
??????Sex = sample(c("M","F"), n, T),
??????Country = sample(c("AA", "BB", "US"), n, T),
??????Income  = as.factor(sample(1:3, n, T))
)

# Dummy variable
ONE = rep(1, nrow(x))

# corrected
r = aggregate(ONE ~ Sex + Income + Country, length, data = x)
r = r[, c("Country", "Income", "Sex", "ONE")]
names(r)[4] = "Count"
print(r)

It is possible to write more simple code, if you need only the particular combination of variables (which you specified in your mail). But this is the more general approach.

Note: you may want to use "sum" instead of "length", e.g. if you have a column specifying the number of individuals in that category.


Hope this helps,

Leonard


	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sun Jun  2 19:47:18 2024
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sun, 2 Jun 2024 18:47:18 +0100
Subject: [R] R code for overlapping variables -- count
In-Reply-To: <6b70be1b-0688-443b-b6a8-4ff077734860@sapo.pt>
References: <DBAP192MB0956787CE5BE81D0A6FD4FA284FE2@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>
 <6b70be1b-0688-443b-b6a8-4ff077734860@sapo.pt>
Message-ID: <21a5c8f3-d914-45d4-aa7e-2fb5e7ef2b5a@sapo.pt>

?s 18:40 de 02/06/2024, Rui Barradas escreveu:
> ?s 18:34 de 02/06/2024, Leo Mada via R-help escreveu:
>> Dear Shadee,
>>
>> If you have a data.frame with the following columns:
>>
>> n = 100; # population size
>> x = data.frame(
>> ??????Sex = sample(c("M","F"), n, T),
>> ??????Country = sample(c("AA", "BB", "US"), n, T),
>> ??????Income? = as.factor(sample(1:3, n, T))
>> )
>>
>> # Dummy variable
>> ONE = rep(1, nrow(x))
>>
>> r = aggregate(ONE ~ Sex + Income + Country, length, data = x)
>> r = r[, c("Country", "Income", "Sex")]
>> print(r)
>>
>> It is possible to write more simple code, if you need only the 
>> particular combination of variables (which you specified in your 
>> mail). But this is the more general approach.
>>
>> Note: you may want to use "sum" instead of "length", e.g. if you have 
>> a column specifying the number of individuals in that category.
>>
>>
>> Hope this helps,
>>
>> Leonard
>>
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> Hello,
> 
> The following is simpler.
> 
> 
> r2 <- xtabs(~ ., x) |> as.data.frame()
> r2[-4L] # or r2[names(r2) != "Freq"]
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> 
Hello,

This is the same solution but the code to keep only the columns in the 
original data set is better. And it's a MRE.


n <- 100; # population size
x <- data.frame(
   Sex = sample(c("M","F"), n, T),
   Country = sample(c("AA", "BB", "US"), n, T),
   Income  = as.factor(sample(1:3, n, T))
)

r2 <- xtabs(~ ., x) |> as.data.frame()
# no need for constants, find the columns
# to keep from the data
r2[names(r2) %in% names(x)]


Hope this helps,

Rui Barradas


-- 
Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.
www.avg.com


From pd@|gd @end|ng |rom gm@||@com  Mon Jun  3 11:01:52 2024
From: pd@|gd @end|ng |rom gm@||@com (peter dalgaard)
Date: Mon, 3 Jun 2024 11:01:52 +0200
Subject: [R] R code for overlapping variables -- count
In-Reply-To: <CAFMWFxDjNSAwB21ZyZ4JSJ_CT96t438v24smX_qSkb7TNBjhhg@mail.gmail.com>
References: <CAFMWFxDjNSAwB21ZyZ4JSJ_CT96t438v24smX_qSkb7TNBjhhg@mail.gmail.com>
Message-ID: <150215D9-317F-469C-A1A5-55F5BB571C50@gmail.com>

If they are binary (0/1 dummies), can't you just "&" them as in 

table(Female & USA & MidIncome)

(or sum() if you don't care about the number of 0s)

-pd

> On 2 Jun 2024, at 00:31 , Shadee Ashtari <shadee.ashtari at gmail.com> wrote:
> 
> Hi!
> 
> I am trying to find the code for how to get counts for intersectional
> variables. For example, I have three unique categorical variables --
> "Female," "USA," and "MidIncome" -- and I'm trying to see how many people I
> have at the intersection of the three.
> 
> Thank you so much,
> Shadee
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From tebert @end|ng |rom u||@edu  Mon Jun  3 13:12:41 2024
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Mon, 3 Jun 2024 11:12:41 +0000
Subject: [R] R code for overlapping variables -- count
In-Reply-To: <150215D9-317F-469C-A1A5-55F5BB571C50@gmail.com>
References: <CAFMWFxDjNSAwB21ZyZ4JSJ_CT96t438v24smX_qSkb7TNBjhhg@mail.gmail.com>
 <150215D9-317F-469C-A1A5-55F5BB571C50@gmail.com>
Message-ID: <CH3PR22MB4514EFC627EC55EF1E856B1CCFFF2@CH3PR22MB4514.namprd22.prod.outlook.com>

One could make dummy variables if the existing variables are otherwise. If Female is a variable that includes other options (no-response, non-binary, ...) then recode it using dummy.female and the others would be similarly named.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of peter dalgaard
Sent: Monday, June 3, 2024 5:02 AM
To: Shadee Ashtari <shadee.ashtari at gmail.com>
Cc: r-help at r-project.org
Subject: Re: [R] R code for overlapping variables -- count

[External Email]

If they are binary (0/1 dummies), can't you just "&" them as in

table(Female & USA & MidIncome)

(or sum() if you don't care about the number of 0s)

-pd

> On 2 Jun 2024, at 00:31 , Shadee Ashtari <shadee.ashtari at gmail.com> wrote:
>
> Hi!
>
> I am trying to find the code for how to get counts for intersectional
> variables. For example, I have three unique categorical variables --
> "Female," "USA," and "MidIncome" -- and I'm trying to see how many
> people I have at the intersection of the three.
>
> Thank you so much,
> Shadee
>
>       [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat/
> .ethz.ch%2Fmailman%2Flistinfo%2Fr-help&data=05%7C02%7Ctebert%40ufl.edu
> %7C66abf8af810348ed21b408dc83abdfd6%7C0d4da0f84a314d76ace60a62331e1b84
> %7C0%7C0%7C638530021430818928%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAw
> MDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=
> a2oUZzOdXDHnzPA3Oo98DIp%2BFIqpg5o1fT0fcE%2BvkQI%3D&reserved=0
> PLEASE do read the posting guide
> http://www.r/
> -project.org%2Fposting-guide.html&data=05%7C02%7Ctebert%40ufl.edu%7C66
> abf8af810348ed21b408dc83abdfd6%7C0d4da0f84a314d76ace60a62331e1b84%7C0%
> 7C0%7C638530021430825783%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiL
> CJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=L2I%2
> BxXV3kHZUwflUx0%2BGrakGbbOV6AWV7dul7%2FyuIBU%3D&reserved=0
> and provide commented, minimal, self-contained, reproducible code.

--
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.r-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From gb@rc@ro|| @end|ng |rom gm@||@com  Sat Jun  1 13:27:16 2024
From: gb@rc@ro|| @end|ng |rom gm@||@com (Giulio Barcaroli)
Date: Sat, 1 Jun 2024 13:27:16 +0200
Subject: [R] [R-pkgs] QGA 1.0 is released
Message-ID: <7ce4d41b-92e3-435c-a9e8-2e238f74c52e@gmail.com>

Dear R users,

I am pleased to announce that QGA 1.0 is now available on CRAN.

QGA implements the Quantum Genetic Algorithm, as proposed by Han and Kim 
in 2000, and is an R implementation derived from the Python one by 
Lahoz-Beltra in 2016.

Under this approach, each solution is represented as a sequence of 
(qu)bits. Simulating the quantum paradigm, these qubits are in a 
superposition state: when measuring them, they collapse in a 0 or 1 
state. After measurement, the solution's fitness is calculated as in 
usual genetic algorithms.

The evolution at each iteration is oriented by the application of two 
quantum gates to the amplitudes of the qubits: (1) a rotation gate 
(always); (2) a Pauli-X gate (optionally). The rotation is based on the 
theta angle values: higher values allow a quicker evolution, and lower 
values avoid local maxima. The Pauli-X gate is equivalent to the 
classical mutation operator and determines the swap between alfa and 
beta amplitudes of a given qubit.

The package has been developed in such a way as to permit a complete 
separation between the 'engine', and the particular problem subject to 
combinatorial optimization. This is evident in the available examples, 
that come with the package, illustrating the application of QGA to 
different problems: knapsack, traveler salesman, and clustering.

Thank you, kind regards,

Giulio Barcaroli

	[[alternative HTML version deleted]]

_______________________________________________
R-packages mailing list
R-packages at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-packages


From |eo@m@d@ @end|ng |rom @yon|c@eu  Mon Jun  3 20:50:19 2024
From: |eo@m@d@ @end|ng |rom @yon|c@eu (Leo Mada)
Date: Mon, 3 Jun 2024 18:50:19 +0000
Subject: [R] Tools to modify highlighted areas in pdf documents?
In-Reply-To: <20240602200238.1f57909d@Tarkus>
References: <DBAP192MB095675B1E0FD76CD59E9155384FD2@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>
 <20240602200238.1f57909d@Tarkus>
Message-ID: <DBAP192MB09566488E091E5FCE6EB7B3C84FF2@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>

Dear Ivan,

Thank you very much for the hint. I have started to test it.

- it offers more colours and types of highlighting than MS Edge;
- it seems to have better word-boundary detection than MS Edge (but I haven't tested all the cases yet);


There are some nit-picks:
- I wish it had a better default color-pallet;
- the vertical positioning continues to be sometimes sub-optimal: editing manually the coordinates may be still useful;

Returning to R:
1. Some of the pdf-packages could implement some of the annotation-functionality as well.

2. It would be useful to be able to export the annotations and import/merge them in another document. I have spotted errors in various articles; such a functionality would be handy, if a new version of those articles gets published.

Sincerely,

Leonard
________________________________
From: Ivan Krylov <ikrylov at disroot.org>
Sent: Sunday, June 2, 2024 8:02 PM
To: Leo Mada via R-help <r-help at r-project.org>
Cc: Leo Mada <leo.mada at syonic.eu>
Subject: Re: [R] Tools to modify highlighted areas in pdf documents?

? Sat, 1 Jun 2024 16:16:23 +0000
Leo Mada via R-help <r-help at r-project.org> ?????:

> When highlighting pdf-documents with Microsoft Edge, the bounding box
> is sometimes misplaced, and quite ugly so. It also lacks the ability
> to draw lines or arrows.
>
> On the other hand, I did not get used to Acrobat Reader: it usually
> involves much more effort to add specific highlights. Lines can be
> drawn, but are NOT straight!

Sorry for answering a different question, but have you considered using
a different PDF viewer + annotation application? Okular
<https://eu01.z.antigena.com/l/iZmB5crNT773HTSUSt2S6McW6mdP5phHyzgXromFHINsN6Uo6BMnSdZK0kmSK~aLduXw-YpIAWy-DV9bac-5U3grBsLdYxuX7aMmbxQjKSLGCqTyJG54WQ2W7oaR2NEPTWiFotbkB4_eQTzHI3L-cAgOgsS4exJ4ie4BHLt > is free and available on Windows (including
from outside Microsoft store). Its annotation features include all
kinds of highlights, arrows and lines, both straight and
arbitrarily-shaped, quickly available from the "annotations" panel.

--
Best regards,
Ivan

	[[alternative HTML version deleted]]


From |@rz@dghoo@h| @end|ng |rom gm@||@com  Tue Jun  4 12:49:25 2024
From: |@rz@dghoo@h| @end|ng |rom gm@||@com (Farzad Ghooshi)
Date: Tue, 4 Jun 2024 14:19:25 +0330
Subject: [R] nc file
Message-ID: <CAJz8DZjHoSAd+isS=iydaNZq3KH+xedZBbK58s98bZyqHNcqwA@mail.gmail.com>

Hello
I am a PhD student in ecology.
The subject of my thesis is climate change and agricultural systems
modeling. One of the software used in this research is R.
As you know, nc files show climate variables by year in general for the
whole world.
With what command line can I isolate an nc file climate variable for a
specific location?

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Tue Jun  4 15:00:42 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Tue, 4 Jun 2024 09:00:42 -0400
Subject: [R] nc file
In-Reply-To: <CAJz8DZjHoSAd+isS=iydaNZq3KH+xedZBbK58s98bZyqHNcqwA@mail.gmail.com>
References: <CAJz8DZjHoSAd+isS=iydaNZq3KH+xedZBbK58s98bZyqHNcqwA@mail.gmail.com>
Message-ID: <db88b451-ae43-4ea4-a92d-c6f5e91fac96@gmail.com>

    This question is unfortunately too vague for us to help you.  A 
little bit of web-searching turned up this tutorial: maybe that will help?

https://rpubs.com/boyerag/297592

On 2024-06-04 6:49 a.m., Farzad Ghooshi wrote:
> Hello
> I am a PhD student in ecology.
> The subject of my thesis is climate change and agricultural systems
> modeling. One of the software used in this research is R.
> As you know, nc files show climate variables by year in general for the
> whole world.
> With what command line can I isolate an nc file climate variable for a
> specific location?
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From Roger@B|v@nd @end|ng |rom nhh@no  Wed Jun  5 14:20:35 2024
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Wed, 5 Jun 2024 12:20:35 +0000
Subject: [R] nc file
Message-ID: <SV0P279MB0475FC860C2457917D12C1C1EEF92@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>

The link suggested by Ben is over 7 years old, so using the CRAN Task View: https://cran.r-project.org/web/views/Spatial.html, which is up-to-date, and https://rspatial.org/index.html, because the terra package has largely replaced the raster package. Please consider following up on the R-sig-geo mailing list: https://stat.ethz.ch/mailman/listinfo/r-sig-geo.

Hope this helps,

Roger

--
Roger Bivand
Emeritus Professor
Norwegian School of Economics
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway
Roger.Bivand at nhh.no

From |b@rnh@rt055 @end|ng |rom gm@||@com  Thu Jun  6 02:07:19 2024
From: |b@rnh@rt055 @end|ng |rom gm@||@com (I B)
Date: Wed, 5 Jun 2024 19:07:19 -0500
Subject: [R] R Shiny Help - Trouble passing user input columns to emmeans
 after ANOVA analysis
Message-ID: <CAPJbgronjQqxC57TqRmWnd4VzmWtRs=qLdw1QxKRb1Boo-Zf=Q@mail.gmail.com>

Hello everybody,

I have experience coding with R, but am brand new to R Shiny. I am trying
to produce an application that will allow users to upload their own
dataset, select columns they want an ANOVA analysis run on, and generate
graphs that will allow users to view their results. However, I am getting
the following error: *"Argument is of length zero."*

Being new to Shiny, I am having trouble passing the user input column to an
emmeans argument in order to do a post hoc analysis, and using that
information to produce a graph. Can somebody help me with this? *The code
for my dataset and application are provided below; copying and pasting
directly into R should generate the reproducible example.*

In my application, the following columns should be selected after uploading
the dataset:

   - Select response variable: "ndvi"
   - Select first independent variable: "genotype"
   - Select second independent variable: "rate"
   - Select random variable: "rep"

For this example, the final two drop-down selections should be:

   - "Which variable would you like to graph? "genotype"
   - "Which ANOVA model do you want to graph? "Main effects model"

Any help would be great. Thank you so much!

Sincerely,
Isaac Barnhart, PhD


*Here is my dataset:*

data <- data.frame(rep =
c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3),
                   genotype =
c('a','a','a','a','b','b','b','b','c','c','c','c','a','a','a','a','b','b','b','b','c','c','c','c','a','a','a','a','b','b','b','b','c','c','c','c'),
                   rate =
c('1x','2x','4x','8x','1x','2x','4x','8x','1x','2x','4x','8x','1x','2x','4x','8x','1x','2x','4x','8x','1x','2x','4x','8x','1x','2x','4x','8x','1x','2x','4x','8x','1x','2x','4x','8x'),
                   ndvi =
c(0.584947811,0.642112121,0.654116902,0.785068313,0.79665163,0.674549249,0.958911611,0.547077528,0.613315552,0.768646411,0.97107949,0.680942649,0.520576242,0.723920266,0.868779972,0.834257732,0.554506685,0.520458208,0.617282262,0.80128067,0.875192693,0.572153151,0.850305042,0.500760522,0.796305833,0.643719779,0.590512435,0.522884966,0.905197544,0.663792758,0.690415735,0.975449466,0.621379163,0.734904647,0.812023395,0.928144532))


*Here is my code:*

library(shiny)
library(ggplot2)
library(tidyverse)
library(emmeans)
library(DHARMa)
library(lme4)

ui <- fluidPage(
  fileInput("file1", "Choose .csv or .xlsx file",
            accept = c("text/csv",
                       "text/comma-separated-values",
                       ".csv",
                       ".xlsx")),
  textOutput("data_info"),
  verbatimTextOutput("data_head"),
  uiOutput("column_selector_1"),
  uiOutput("column_selector_2"),
  uiOutput("column_selector_3"),
  uiOutput("column_selector_4"),
  textOutput("dist_info"),
  plotOutput("dist"),
  textOutput("str_info"),
  verbatimTextOutput("selected_columns"),
  textOutput("two_way_anova"),
  verbatimTextOutput("model_summary"),
  textOutput("main_effects"),
  verbatimTextOutput("model_summary_ME"),
  textOutput("mod_diagnostic"),
  plotOutput("diagnostic_plot"),
  uiOutput("graph"),
  uiOutput("model_selection"),
  plotOutput("graph_plot")
)

server <- function(input, output, session) {
  # Open file
  req(data <- reactive({
    infile <- input$file1
    if (is.null(infile)) {
      return(NULL)
    }
    read.csv(infile$datapath, header = TRUE)
  }))

  # Preview data
  output$data_info <- renderText({
    req(data())
    "Preview of the data uploaded:"
  })

  output$data_head <- renderPrint({
    req(data())
    head(data(), 20)
  })

  # Select response variable
  output$column_selector_1 <- renderUI({
    req(data())
    selectInput("column1","Select response variable", choices =
names(data()))
    })

  # Select first independent variable
  output$column_selector_2 <- renderUI({
    req(data())
    selectInput("column2", "Select first independent variable", choices =
names(data()))
  })

  # Select second independent variable
  output$column_selector_3 <- renderUI({
    req(data())
    selectInput("column3", "Select second independent variable", choices =
names(data()))
  })

  # Select random variable
  output$column_selector_4 <- renderUI({
    req(data())
    selectInput("column4", "Select random variable", choices =
names(data()))
  })

  # Assigning user inputs to correct variables
  selected_columns <- reactive({
    req(data(), input$column1, input$column2, input$column3, input$column4)
    list(
      dependent = data()[[input$column1]],
      independent1 = as.factor(data()[[input$column2]]),
      independent2 = as.factor(data()[[input$column3]]),
      random = as.factor(data()[[input$column4]]),

      # Define column names for later use
      column1 <- input$column1,
      column2 <- input$column2,
      column3 <- input$column3,
      column4 <- input$column4
    )
  })

  # Instructional text
  output$dist_info <- renderText({
    req(data())
    "The graph below shows the shape of response variable distribution"
  })


  # Distribution plot
  output$dist <- renderPlot({
    req(selected_columns())
    cols <- selected_columns()
    plot(density(cols$dependent), main = "Distribution Plot")
  })

  # Instructional text
  output$str_info <- renderText({
    req(data())
    "The code below verifies that our data are in the correct structure for
ANOVA analyses. All independent variables should be changed to 'Factor'. "
  })

  # Verifies that columns are in the correct structure
  output$selected_columns <- renderPrint({
    cols <- selected_columns()
    str(cols)
  })

  # Instructional text
  output$two_way_anova <- renderText({
    req(data())
    "Two-way ANOVA with interaction"
  })

  # Build ANOVA model with two-way interaction
  interaction_model <- reactive({
    cols <- selected_columns()
    req(cols)
    data <- data()
    data$dep <- cols$dependent
    data$indep1 <- cols$independent1
    data$indep2 <- cols$independent2
    data$rand <- cols$random
    lmer(dep ~ indep1 * indep2 + (1|rand), data = data)
  })

  # Run two-way ANOVA model with interaction
  output$model_summary <- renderPrint({
    req(interaction_model())
    Anova(interaction_model(), type = c("III"))
  })

  # Build main effects ANOVA model
  main_effects_model <- reactive({
    cols <- selected_columns()
    req(cols)
    data <- data()
    data$dep <- cols$dependent
    data$indep1 <- cols$independent1
    data$indep2 <- cols$independent2
    data$rand <- cols$random
    lmer(dep ~ indep1 + indep2 + (1|rand), data = data)
  })

  # Instructional text
  output$main_effects <- renderText({
    req(data())
    "Two-way ANOVA, main effects"
  })

  # Run two-way main effects model
  output$model_summary_ME <- renderPrint({
    req(main_effects_model())
    Anova(main_effects_model(), type = c("III"))
  })


  output$mod_diagnostic <- renderText({
    req(main_effects_model())
    "Below, the `DHARMa` package is used to check model assumptions. If
assumptions are not met, then data transformations may be needed before
proceeding."
  })

  output$diagnostic_plot <- renderPlot({
    req(interaction_model())
    plotQQunif(interaction_model())
  })

  output$graph <- renderUI({
    req(data(), input$column2, input$column3)
    selectInput("graph", "Which variable would you like to graph?", choices
= c(input$column2, input$column3, "interaction"))
  })

  output$model_selection <- renderUI({
    req(main_effects_model(), interaction_model())
    selectInput("model_selection", "Which ANOVA model do you want to
graph?", choices = c("Main effects model", "Interaction model"))
  })

  # Create a reactive expression to store the selected graph variable
  selected_graph <- reactive({
    input$graph
  })

  # Create a reactive expression to store the selected model
  selected_model <- reactive({
    input$model_selection
  })

  # Render the plot based on the selected variables
  output$graph_plot <- renderPlot({
    req(data(), selected_graph(), selected_model())
    cols <- selected_columns()

    if (selected_graph() == cols$column2 | selected_model() == "Main
effects model") {

      # Mean separation: First column
      mod_means_cotr1 <- emmeans(main_effects_model(), pairwise ~
cols$column2,
                                adjust = 'tukey',
                                type = 'response')

      mod_means1 <- multcomp::cld(object = mod_means_cotr1$emmeans,
                                 LETTERS = "letters")

      # Graph: First column
      ggplot(mod_means1, aes_string(x = cols$column2, y = cols_column1))+
        geom_bar(stat="identity", width = 0.6, position = "dodge", col =
"black", fill = "purple3")+
        geom_errorbar(aes(ymin = emmean, ymax = emmean + SE), width = 0.3,
position = position_dodge(0.6))+
        xlab(cols$column2)+
        ylab(cols$column1)+
        theme(plot.title=element_text(hjust=0.5, size = 20),
              plot.subtitle = element_text(hjust = 0.5, size = 15),
              axis.text = element_text(size = 17),
              axis.title = element_text(size = 20))+
        geom_text(aes(label=.group, y=emmean + SE), vjust = -0.9, size = 8)
+
        #ylim(0, 105)+
        scale_x_discrete(labels = function(x) str_wrap(x, width = 7))


    }
  })

}
shinyApp(ui, server)

	[[alternative HTML version deleted]]


From ju||en@jo|y @end|ng |rom |n@erm@|r  Thu Jun  6 10:45:20 2024
From: ju||en@jo|y @end|ng |rom |n@erm@|r (Julien JOLY)
Date: Thu, 6 Jun 2024 08:45:20 +0000
Subject: [R] Bug report for package foreign anf functon write.foreign
Message-ID: <faf69f4017b64e84aa6fa75f399c8e5d@inserm.fr>

Dear all,

First of all, I thank you for the creation of the package.

I write this message concerning the write.foreign() function from the foreign package and a bug that I discovered.
When we want to save our dataset as a .sas file, the limit of variable names character is 8 by default. In SAS this limit is 32 character and an argument in the function, validvarname, can theorically switch the default from 8 to 32 by selecting validvarname = "V7".

However, it did not work and show the error "Cannot uniquely abbreviate format names to conform to eight-character limit and not ending in a digit" that show the limit is still 8 characters.

By looking at the script at https://github.com/cran/foreign/blob/master/R/writeForeignSAS.R , I realized that the line 39, in the function make.SAS.formats, can be the reason of the nonfunctioning argument :
"if(any(nchar(x) > 8L) || any(duplicated(x)))" which is correct if the length of the variable has a limit of 8, but it does not take in consideration when the limit is at 32 defined by validvarnames = "V7".

A solution can be to add the argument validvarname in the definition of the function and add these few lines :
  validvarname <- match.arg(validvarname)
  nmax <- if(validvarname == "V7") 32L else 8L
  if(any(nchar(x) > nmax) || any(duplicated(x)))


I hope I send the message to the good place and that it will help you improve the package.

Kind regards,



Julien Joly

Biostatisticien et Data manager





	[[alternative HTML version deleted]]


From kev|n@thorpe @end|ng |rom utoronto@c@  Thu Jun  6 16:35:44 2024
From: kev|n@thorpe @end|ng |rom utoronto@c@ (Kevin Thorpe)
Date: Thu, 6 Jun 2024 14:35:44 +0000
Subject: [R] Bug report for package foreign anf functon write.foreign
In-Reply-To: <faf69f4017b64e84aa6fa75f399c8e5d@inserm.fr>
References: <faf69f4017b64e84aa6fa75f399c8e5d@inserm.fr>
Message-ID: <E299C946-CB74-4598-9FF3-0C2C03AA3191@utoronto.ca>

I haven?t used this function in a long time, but it sounds like the issue is the format names for the formats catalog, not the variable names.

You might try the haven package as it can create SAS datasets directly, although there are limitations (I think).

> On Jun 6, 2024, at 4:45?AM, Julien JOLY <julien.joly at inserm.fr> wrote:
> 
> [Vous ne recevez pas souvent de courriers de julien.joly at inserm.fr. D?couvrez pourquoi ceci est important ? https://aka.ms/LearnAboutSenderIdentification ]
> 
> Dear all,
> 
> First of all, I thank you for the creation of the package.
> 
> I write this message concerning the write.foreign() function from the foreign package and a bug that I discovered.
> When we want to save our dataset as a .sas file, the limit of variable names character is 8 by default. In SAS this limit is 32 character and an argument in the function, validvarname, can theorically switch the default from 8 to 32 by selecting validvarname = "V7".
> 
> However, it did not work and show the error "Cannot uniquely abbreviate format names to conform to eight-character limit and not ending in a digit" that show the limit is still 8 characters.
> 
> By looking at the script at https://github.com/cran/foreign/blob/master/R/writeForeignSAS.R , I realized that the line 39, in the function make.SAS.formats, can be the reason of the nonfunctioning argument :
> "if(any(nchar(x) > 8L) || any(duplicated(x)))" which is correct if the length of the variable has a limit of 8, but it does not take in consideration when the limit is at 32 defined by validvarnames = "V7".
> 
> A solution can be to add the argument validvarname in the definition of the function and add these few lines :
>  validvarname <- match.arg(validvarname)
>  nmax <- if(validvarname == "V7") 32L else 8L
>  if(any(nchar(x) > nmax) || any(duplicated(x)))
> 
> 
> I hope I send the message to the good place and that it will help you improve the package.
> 
> Kind regards,
> 
> 
> 
> Julien Joly
> 
> Biostatisticien et Data manager
> 
> 
> 
> 
> 
>        [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


-- 
Kevin E. Thorpe
Assistant Professor, Dalla Lana School of Public Health
University of Toronto
email: kevin.thorpe at utoronto.ca  Tel: 416-946-8083



From yo@u@yurr@mend| @end|ng |rom gm@||@com  Thu Jun  6 10:37:38 2024
From: yo@u@yurr@mend| @end|ng |rom gm@||@com (Yosu Yurramendi)
Date: Thu, 6 Jun 2024 10:37:38 +0200
Subject: [R] What is the HEX code for "transparent" color?
Message-ID: <CADg5kN3dTkDWj6buW5FV2ujpu3JLF4YUFSbzj7_Rw=y2EkMoqA@mail.gmail.com>

What is the HEX code for "transparent" color?
I've tried "00000000" "FFFFFF00" "FFFFFFFF", but they don't work.
Thanks

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Thu Jun  6 16:49:19 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 6 Jun 2024 07:49:19 -0700
Subject: [R] 
 R Shiny Help - Trouble passing user input columns to emmeans
 after ANOVA analysis
In-Reply-To: <CAPJbgronjQqxC57TqRmWnd4VzmWtRs=qLdw1QxKRb1Boo-Zf=Q@mail.gmail.com>
References: <CAPJbgronjQqxC57TqRmWnd4VzmWtRs=qLdw1QxKRb1Boo-Zf=Q@mail.gmail.com>
Message-ID: <CAGxFJbQnyNGAO5pQikOzNLC5OfsgkdL3d=Z-rxka35St_O==rA@mail.gmail.com>

Wrong list. Shiny is software from an external provider, POSIT (formerly
RStudio) and not part of R, itself. They have a community support site at:

https://forum.posit.co/?_gl=1*bh848i*_ga*MTY2NjcwNzQ4LjE3MTYyMzkzODQ.*_ga_2C0WZ1JHG0*MTcxNzY4NTExNi4yLjAuMTcxNzY4NTExNi4wLjAuMA
..

Cheers,
Bert

On Thu, Jun 6, 2024 at 12:09?AM I B <ibarnhart055 at gmail.com> wrote:

> Hello everybody,
>
> I have experience coding with R, but am brand new to R Shiny. I am trying
> to produce an application that will allow users to upload their own
> dataset, select columns they want an ANOVA analysis run on, and generate
> graphs that will allow users to view their results. However, I am getting
> the following error: *"Argument is of length zero."*
>
> Being new to Shiny, I am having trouble passing the user input column to an
> emmeans argument in order to do a post hoc analysis, and using that
> information to produce a graph. Can somebody help me with this? *The code
> for my dataset and application are provided below; copying and pasting
> directly into R should generate the reproducible example.*
>
> In my application, the following columns should be selected after uploading
> the dataset:
>
>    - Select response variable: "ndvi"
>    - Select first independent variable: "genotype"
>    - Select second independent variable: "rate"
>    - Select random variable: "rep"
>
> For this example, the final two drop-down selections should be:
>
>    - "Which variable would you like to graph? "genotype"
>    - "Which ANOVA model do you want to graph? "Main effects model"
>
> Any help would be great. Thank you so much!
>
> Sincerely,
> Isaac Barnhart, PhD
>
>
> *Here is my dataset:*
>
> data <- data.frame(rep =
> c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3),
>                    genotype =
>
> c('a','a','a','a','b','b','b','b','c','c','c','c','a','a','a','a','b','b','b','b','c','c','c','c','a','a','a','a','b','b','b','b','c','c','c','c'),
>                    rate =
>
> c('1x','2x','4x','8x','1x','2x','4x','8x','1x','2x','4x','8x','1x','2x','4x','8x','1x','2x','4x','8x','1x','2x','4x','8x','1x','2x','4x','8x','1x','2x','4x','8x','1x','2x','4x','8x'),
>                    ndvi =
>
> c(0.584947811,0.642112121,0.654116902,0.785068313,0.79665163,0.674549249,0.958911611,0.547077528,0.613315552,0.768646411,0.97107949,0.680942649,0.520576242,0.723920266,0.868779972,0.834257732,0.554506685,0.520458208,0.617282262,0.80128067,0.875192693,0.572153151,0.850305042,0.500760522,0.796305833,0.643719779,0.590512435,0.522884966,0.905197544,0.663792758,0.690415735,0.975449466,0.621379163,0.734904647,0.812023395,0.928144532))
>
>
> *Here is my code:*
>
> library(shiny)
> library(ggplot2)
> library(tidyverse)
> library(emmeans)
> library(DHARMa)
> library(lme4)
>
> ui <- fluidPage(
>   fileInput("file1", "Choose .csv or .xlsx file",
>             accept = c("text/csv",
>                        "text/comma-separated-values",
>                        ".csv",
>                        ".xlsx")),
>   textOutput("data_info"),
>   verbatimTextOutput("data_head"),
>   uiOutput("column_selector_1"),
>   uiOutput("column_selector_2"),
>   uiOutput("column_selector_3"),
>   uiOutput("column_selector_4"),
>   textOutput("dist_info"),
>   plotOutput("dist"),
>   textOutput("str_info"),
>   verbatimTextOutput("selected_columns"),
>   textOutput("two_way_anova"),
>   verbatimTextOutput("model_summary"),
>   textOutput("main_effects"),
>   verbatimTextOutput("model_summary_ME"),
>   textOutput("mod_diagnostic"),
>   plotOutput("diagnostic_plot"),
>   uiOutput("graph"),
>   uiOutput("model_selection"),
>   plotOutput("graph_plot")
> )
>
> server <- function(input, output, session) {
>   # Open file
>   req(data <- reactive({
>     infile <- input$file1
>     if (is.null(infile)) {
>       return(NULL)
>     }
>     read.csv(infile$datapath, header = TRUE)
>   }))
>
>   # Preview data
>   output$data_info <- renderText({
>     req(data())
>     "Preview of the data uploaded:"
>   })
>
>   output$data_head <- renderPrint({
>     req(data())
>     head(data(), 20)
>   })
>
>   # Select response variable
>   output$column_selector_1 <- renderUI({
>     req(data())
>     selectInput("column1","Select response variable", choices =
> names(data()))
>     })
>
>   # Select first independent variable
>   output$column_selector_2 <- renderUI({
>     req(data())
>     selectInput("column2", "Select first independent variable", choices =
> names(data()))
>   })
>
>   # Select second independent variable
>   output$column_selector_3 <- renderUI({
>     req(data())
>     selectInput("column3", "Select second independent variable", choices =
> names(data()))
>   })
>
>   # Select random variable
>   output$column_selector_4 <- renderUI({
>     req(data())
>     selectInput("column4", "Select random variable", choices =
> names(data()))
>   })
>
>   # Assigning user inputs to correct variables
>   selected_columns <- reactive({
>     req(data(), input$column1, input$column2, input$column3, input$column4)
>     list(
>       dependent = data()[[input$column1]],
>       independent1 = as.factor(data()[[input$column2]]),
>       independent2 = as.factor(data()[[input$column3]]),
>       random = as.factor(data()[[input$column4]]),
>
>       # Define column names for later use
>       column1 <- input$column1,
>       column2 <- input$column2,
>       column3 <- input$column3,
>       column4 <- input$column4
>     )
>   })
>
>   # Instructional text
>   output$dist_info <- renderText({
>     req(data())
>     "The graph below shows the shape of response variable distribution"
>   })
>
>
>   # Distribution plot
>   output$dist <- renderPlot({
>     req(selected_columns())
>     cols <- selected_columns()
>     plot(density(cols$dependent), main = "Distribution Plot")
>   })
>
>   # Instructional text
>   output$str_info <- renderText({
>     req(data())
>     "The code below verifies that our data are in the correct structure for
> ANOVA analyses. All independent variables should be changed to 'Factor'. "
>   })
>
>   # Verifies that columns are in the correct structure
>   output$selected_columns <- renderPrint({
>     cols <- selected_columns()
>     str(cols)
>   })
>
>   # Instructional text
>   output$two_way_anova <- renderText({
>     req(data())
>     "Two-way ANOVA with interaction"
>   })
>
>   # Build ANOVA model with two-way interaction
>   interaction_model <- reactive({
>     cols <- selected_columns()
>     req(cols)
>     data <- data()
>     data$dep <- cols$dependent
>     data$indep1 <- cols$independent1
>     data$indep2 <- cols$independent2
>     data$rand <- cols$random
>     lmer(dep ~ indep1 * indep2 + (1|rand), data = data)
>   })
>
>   # Run two-way ANOVA model with interaction
>   output$model_summary <- renderPrint({
>     req(interaction_model())
>     Anova(interaction_model(), type = c("III"))
>   })
>
>   # Build main effects ANOVA model
>   main_effects_model <- reactive({
>     cols <- selected_columns()
>     req(cols)
>     data <- data()
>     data$dep <- cols$dependent
>     data$indep1 <- cols$independent1
>     data$indep2 <- cols$independent2
>     data$rand <- cols$random
>     lmer(dep ~ indep1 + indep2 + (1|rand), data = data)
>   })
>
>   # Instructional text
>   output$main_effects <- renderText({
>     req(data())
>     "Two-way ANOVA, main effects"
>   })
>
>   # Run two-way main effects model
>   output$model_summary_ME <- renderPrint({
>     req(main_effects_model())
>     Anova(main_effects_model(), type = c("III"))
>   })
>
>
>   output$mod_diagnostic <- renderText({
>     req(main_effects_model())
>     "Below, the `DHARMa` package is used to check model assumptions. If
> assumptions are not met, then data transformations may be needed before
> proceeding."
>   })
>
>   output$diagnostic_plot <- renderPlot({
>     req(interaction_model())
>     plotQQunif(interaction_model())
>   })
>
>   output$graph <- renderUI({
>     req(data(), input$column2, input$column3)
>     selectInput("graph", "Which variable would you like to graph?", choices
> = c(input$column2, input$column3, "interaction"))
>   })
>
>   output$model_selection <- renderUI({
>     req(main_effects_model(), interaction_model())
>     selectInput("model_selection", "Which ANOVA model do you want to
> graph?", choices = c("Main effects model", "Interaction model"))
>   })
>
>   # Create a reactive expression to store the selected graph variable
>   selected_graph <- reactive({
>     input$graph
>   })
>
>   # Create a reactive expression to store the selected model
>   selected_model <- reactive({
>     input$model_selection
>   })
>
>   # Render the plot based on the selected variables
>   output$graph_plot <- renderPlot({
>     req(data(), selected_graph(), selected_model())
>     cols <- selected_columns()
>
>     if (selected_graph() == cols$column2 | selected_model() == "Main
> effects model") {
>
>       # Mean separation: First column
>       mod_means_cotr1 <- emmeans(main_effects_model(), pairwise ~
> cols$column2,
>                                 adjust = 'tukey',
>                                 type = 'response')
>
>       mod_means1 <- multcomp::cld(object = mod_means_cotr1$emmeans,
>                                  LETTERS = "letters")
>
>       # Graph: First column
>       ggplot(mod_means1, aes_string(x = cols$column2, y = cols_column1))+
>         geom_bar(stat="identity", width = 0.6, position = "dodge", col =
> "black", fill = "purple3")+
>         geom_errorbar(aes(ymin = emmean, ymax = emmean + SE), width = 0.3,
> position = position_dodge(0.6))+
>         xlab(cols$column2)+
>         ylab(cols$column1)+
>         theme(plot.title=element_text(hjust=0.5, size = 20),
>               plot.subtitle = element_text(hjust = 0.5, size = 15),
>               axis.text = element_text(size = 17),
>               axis.title = element_text(size = 20))+
>         geom_text(aes(label=.group, y=emmean + SE), vjust = -0.9, size = 8)
> +
>         #ylim(0, 105)+
>         scale_x_discrete(labels = function(x) str_wrap(x, width = 7))
>
>
>     }
>   })
>
> }
> shinyApp(ui, server)
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Thu Jun  6 17:05:33 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Thu, 6 Jun 2024 18:05:33 +0300
Subject: [R] 
 R Shiny Help - Trouble passing user input columns to emmeans
 after ANOVA analysis
In-Reply-To: <CAPJbgronjQqxC57TqRmWnd4VzmWtRs=qLdw1QxKRb1Boo-Zf=Q@mail.gmail.com>
References: <CAPJbgronjQqxC57TqRmWnd4VzmWtRs=qLdw1QxKRb1Boo-Zf=Q@mail.gmail.com>
Message-ID: <20240606180533.17593520@arachnoid>

? Wed, 5 Jun 2024 19:07:19 -0500
I B <ibarnhart055 at gmail.com> ?????:

> However, I am getting the following error: *"Argument is of length
> zero."*

>     if (selected_graph() == cols$column2 | selected_model() == "Main
> effects model") {

The error must be coming from here.

At least one of selected_graph(), cols$column2, selected_model() is a
zero-length object (maybe NULL) at this point, which makes the result
of the whole expression zero-length too. if (...) only accepts logical
scalars, hence the error.

-- 
Best regards,
Ivan


From 538280 @end|ng |rom gm@||@com  Thu Jun  6 17:08:06 2024
From: 538280 @end|ng |rom gm@||@com (Greg Snow)
Date: Thu, 6 Jun 2024 09:08:06 -0600
Subject: [R] What is the HEX code for "transparent" color?
In-Reply-To: <CADg5kN3dTkDWj6buW5FV2ujpu3JLF4YUFSbzj7_Rw=y2EkMoqA@mail.gmail.com>
References: <CADg5kN3dTkDWj6buW5FV2ujpu3JLF4YUFSbzj7_Rw=y2EkMoqA@mail.gmail.com>
Message-ID: <CAFEqCdwvCV3ky2JxiXpuXnX6uokMOinkLzi7PZPjcBK2oeYKwQ@mail.gmail.com>

You need a "#" at the beginning of the string to specify that it is a
hex code for the color.  Try "#00000000".

On Thu, Jun 6, 2024 at 9:07?AM Yosu Yurramendi
<yosu.yurramendi at gmail.com> wrote:
>
> What is the HEX code for "transparent" color?
> I've tried "00000000" "FFFFFF00" "FFFFFFFF", but they don't work.
> Thanks
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
Gregory (Greg) L. Snow Ph.D.
538280 at gmail.com


From bobby@kn|ght @end|ng |rom gm@||@com  Thu Jun  6 17:34:43 2024
From: bobby@kn|ght @end|ng |rom gm@||@com (Robert Knight)
Date: Thu, 6 Jun 2024 11:34:43 -0400
Subject: [R] What is the HEX code for "transparent" color?
In-Reply-To: <CADg5kN3dTkDWj6buW5FV2ujpu3JLF4YUFSbzj7_Rw=y2EkMoqA@mail.gmail.com>
References: <CADg5kN3dTkDWj6buW5FV2ujpu3JLF4YUFSbzj7_Rw=y2EkMoqA@mail.gmail.com>
Message-ID: <CAKBFG3YutD714tUtt5nUFw96p368fLXWyve3nL_LO7iVvRUfyw@mail.gmail.com>

You would give an existing color a new name and modify the new name's
alpha.  Then refer to the color by the new name instead of using HEX.

On Thu, Jun 6, 2024, 11:07?AM Yosu Yurramendi <yosu.yurramendi at gmail.com>
wrote:

> What is the HEX code for "transparent" color?
> I've tried "00000000" "FFFFFF00" "FFFFFFFF", but they don't work.
> Thanks
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Jun  6 18:41:55 2024
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 6 Jun 2024 12:41:55 -0400
Subject: [R] What is the HEX code for "transparent" color?
In-Reply-To: <CADg5kN3dTkDWj6buW5FV2ujpu3JLF4YUFSbzj7_Rw=y2EkMoqA@mail.gmail.com>
References: <CADg5kN3dTkDWj6buW5FV2ujpu3JLF4YUFSbzj7_Rw=y2EkMoqA@mail.gmail.com>
Message-ID: <dc5818fe-ca44-4d24-903f-16a6cd96b9f4@gmail.com>

On 2024-06-06 4:37 a.m., Yosu Yurramendi wrote:
> What is the HEX code for "transparent" color?
> I've tried "00000000" "FFFFFF00" "FFFFFFFF", but they don't work.

If the other answers don't solve your problem, you should give us some 
context.  Not all graphics functions in R can handle transparency, so 
please show us some reproducible code for what you are trying.

Duncan Murdoch


From rk @end|ng |rom rk@|y|  Thu Jun  6 17:24:21 2024
From: rk @end|ng |rom rk@|y| (Robert Knight)
Date: Thu, 06 Jun 2024 11:24:21 -0400
Subject: [R] What is the HEX code for "transparent" color?
In-Reply-To: <CAFEqCdwvCV3ky2JxiXpuXnX6uokMOinkLzi7PZPjcBK2oeYKwQ@mail.gmail.com>
References: <CADg5kN3dTkDWj6buW5FV2ujpu3JLF4YUFSbzj7_Rw=y2EkMoqA@mail.gmail.com>
 <CAFEqCdwvCV3ky2JxiXpuXnX6uokMOinkLzi7PZPjcBK2oeYKwQ@mail.gmail.com>
Message-ID: <C419D04D-D029-4D77-9679-A0066202800A@rk.fyi>

You would set the alpha of an existing color and give it a new name and then refer to it by name rather than using HEX codes. 

On June 6, 2024 11:08:06 AM EDT, Greg Snow <538280 at gmail.com> wrote:
>You need a "#" at the beginning of the string to specify that it is a
>hex code for the color.  Try "#00000000".
>
>On Thu, Jun 6, 2024 at 9:07?AM Yosu Yurramendi
><yosu.yurramendi at gmail.com> wrote:
>>
>> What is the HEX code for "transparent" color?
>> I've tried "00000000" "FFFFFF00" "FFFFFFFF", but they don't work.
>> Thanks
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
>
>
>-- 
>Gregory (Greg) L. Snow Ph.D.
>538280 at gmail.com
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Robert Knight
tel 270-306-1658
fax (270) 288-0474
rk at rk.fyi
	[[alternative HTML version deleted]]


From r@u @end|ng |rom demogr@mpg@de  Fri Jun  7 16:34:12 2024
From: r@u @end|ng |rom demogr@mpg@de (Roland Rau)
Date: Fri, 7 Jun 2024 16:34:12 +0200
Subject: [R] What is the HEX code for "transparent" color?
In-Reply-To: <dc5818fe-ca44-4d24-903f-16a6cd96b9f4@gmail.com>
References: <CADg5kN3dTkDWj6buW5FV2ujpu3JLF4YUFSbzj7_Rw=y2EkMoqA@mail.gmail.com>
 <dc5818fe-ca44-4d24-903f-16a6cd96b9f4@gmail.com>
Message-ID: <188970f1-3cfa-44f1-a7bf-3ec310722f6e@demogr.mpg.de>

On 6/6/24 18:41, Duncan Murdoch wrote:
> On 2024-06-06 4:37 a.m., Yosu Yurramendi wrote:
>> What is the HEX code for "transparent" color?
>> I've tried "00000000" "FFFFFF00" "FFFFFFFF", but they don't work.
> 
> If the other answers don't solve your problem, you should give us some 
> context.? Not all graphics functions in R can handle transparency, so 
> please show us some reproducible code for what you are trying.
> 
> Duncan Murdoch
> 

I usually use the alpha argument of the rgb() function for transparency.
Does this code snippet help to give you an idea how it works.

plot(1, 1, type="n", xlim=c(0,10), ylim=c(0,10))
rect(xleft=0, xright=7.5, ybottom=0, ytop=7.5,
      col=rgb(0, 0, 1, alpha=0.5))
rect(xleft=2.5, xright=10, ybottom=2.5, ytop=10,
      col=rgb(1, 0, 0, alpha=0.5))

Please check
?rgb
Especially the "Details" section should be helpful where you will find a 
list of devices which are supported or not supported.

I hope this helps a bit.

All the best,
Roland


--
This mail has been sent through the MPI for Demographic ...{{dropped:2}}


From j@ork|n @end|ng |rom @om@um@ry|@nd@edu  Sat Jun  8 19:37:53 2024
From: j@ork|n @end|ng |rom @om@um@ry|@nd@edu (Sorkin, John)
Date: Sat, 8 Jun 2024 17:37:53 +0000
Subject: [R] Can't compute row means of two columns of a dataframe.
Message-ID: <DM6PR03MB50491504249460658C306971E2C42@DM6PR03MB5049.namprd03.prod.outlook.com>

I have a data frame with three columns, TotalInches, Low20, High20. For each row of the dataset, I am trying to compute the mean of Low20 and High20. 

xxxz <- structure(list(TotalInches = 
                 c(58, 59, 60, 61, 62, 63, 64, 65, 
                   66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76), Low20 = c(84, 87, 
                   90, 93, 96, 99, 102, 106, 109, 112, 116, 119, 122, 126, 129, 
                   133, 137, 141, 144), High20 = c(111, 115, 119, 123, 127, 131, 
                   135, 140, 144, 148, 153, 157, 162, 167, 171, 176, 181, 186, 191
                   )), class = "data.frame", row.names = c(NA, -19L))
xxxz
str(xxxz)
xxxz$Average20 <- by(xxxz[,c("Low20","High20")],xxxz[,"TotalInches"],mean)
warnings()

When I run the code above, I don't get the means by row. I get the following warning messages, one for each row of the dataframe.

Warning messages:
1: In mean.default(data[x, , drop = FALSE], ...) :
  argument is not numeric or logical: returning NA
2: In mean.default(data[x, , drop = FALSE], ...) :
  argument is not numeric or logical: returning NA

 Can someone tell my what I am doing wrong, and how I can compute the row means?

Thank you,
John

John David Sorkin M.D., Ph.D.
Professor of Medicine, University of Maryland School of Medicine;
Associate Director for Biostatistics and Informatics, Baltimore VA Medical Center Geriatrics Research, Education, and Clinical Center;?
PI?Biostatistics and Informatics Core, University of Maryland School of Medicine Claude D. Pepper Older Americans Independence Center;
Senior Statistician University of Maryland Center for Vascular Research;

Division of Gerontology and Paliative Care,
10 North Greene Street
GRECC (BT/18/GR)
Baltimore, MD 21201-1524
Cell phone 443-418-5382




From bgunter@4567 @end|ng |rom gm@||@com  Sat Jun  8 19:47:50 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 8 Jun 2024 10:47:50 -0700
Subject: [R] Can't compute row means of two columns of a dataframe.
In-Reply-To: <DM6PR03MB50491504249460658C306971E2C42@DM6PR03MB5049.namprd03.prod.outlook.com>
References: <DM6PR03MB50491504249460658C306971E2C42@DM6PR03MB5049.namprd03.prod.outlook.com>
Message-ID: <CAGxFJbTky3cF=JroVqC_3MWk2-1j2nRht4+hgq3nDkhk6kVF_A@mail.gmail.com>

Use apply(), not by().

xxxz$av20 <- apply(xxxz[,c("Low20","High20")],1, mean)

-- Bert

On Sat, Jun 8, 2024 at 10:38?AM Sorkin, John <jsorkin at som.umaryland.edu>
wrote:

> I have a data frame with three columns, TotalInches, Low20, High20. For
> each row of the dataset, I am trying to compute the mean of Low20 and
> High20.
>
> xxxz <- structure(list(TotalInches =
>                  c(58, 59, 60, 61, 62, 63, 64, 65,
>                    66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76), Low20 =
> c(84, 87,
>                    90, 93, 96, 99, 102, 106, 109, 112, 116, 119, 122, 126,
> 129,
>                    133, 137, 141, 144), High20 = c(111, 115, 119, 123,
> 127, 131,
>                    135, 140, 144, 148, 153, 157, 162, 167, 171, 176, 181,
> 186, 191
>                    )), class = "data.frame", row.names = c(NA, -19L))
> xxxz
> str(xxxz)
> xxxz$Average20 <- by(xxxz[,c("Low20","High20")],xxxz[,"TotalInches"],mean)
> warnings()
>
> When I run the code above, I don't get the means by row. I get the
> following warning messages, one for each row of the dataframe.
>
> Warning messages:
> 1: In mean.default(data[x, , drop = FALSE], ...) :
>   argument is not numeric or logical: returning NA
> 2: In mean.default(data[x, , drop = FALSE], ...) :
>   argument is not numeric or logical: returning NA
>
>  Can someone tell my what I am doing wrong, and how I can compute the row
> means?
>
> Thank you,
> John
>
> John David Sorkin M.D., Ph.D.
> Professor of Medicine, University of Maryland School of Medicine;
> Associate Director for Biostatistics and Informatics, Baltimore VA Medical
> Center Geriatrics Research, Education, and Clinical Center;
> PI Biostatistics and Informatics Core, University of Maryland School of
> Medicine Claude D. Pepper Older Americans Independence Center;
> Senior Statistician University of Maryland Center for Vascular Research;
>
> Division of Gerontology and Paliative Care,
> 10 North Greene Street
> GRECC (BT/18/GR)
> Baltimore, MD 21201-1524
> Cell phone 443-418-5382
>
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Sat Jun  8 19:57:55 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 8 Jun 2024 10:57:55 -0700
Subject: [R] Can't compute row means of two columns of a dataframe.
In-Reply-To: <CAGxFJbTky3cF=JroVqC_3MWk2-1j2nRht4+hgq3nDkhk6kVF_A@mail.gmail.com>
References: <DM6PR03MB50491504249460658C306971E2C42@DM6PR03MB5049.namprd03.prod.outlook.com>
 <CAGxFJbTky3cF=JroVqC_3MWk2-1j2nRht4+hgq3nDkhk6kVF_A@mail.gmail.com>
Message-ID: <CAGxFJbRpzHJh=2OhePypOyrUNhkB6YOaMH70W1SSc7DMGMXmfg@mail.gmail.com>

Incidentally, FWIW, for means, rowMeans() is a lot faster:

xxxz$av20 <- rowMeans(xxxz[,c("Low20","High20")])

Bert



On Sat, Jun 8, 2024 at 10:47?AM Bert Gunter <bgunter.4567 at gmail.com> wrote:

> Use apply(), not by().
>
> xxxz$av20 <- apply(xxxz[,c("Low20","High20")],1, mean)
>
> -- Bert
>
> On Sat, Jun 8, 2024 at 10:38?AM Sorkin, John <jsorkin at som.umaryland.edu>
> wrote:
>
>> I have a data frame with three columns, TotalInches, Low20, High20. For
>> each row of the dataset, I am trying to compute the mean of Low20 and
>> High20.
>>
>> xxxz <- structure(list(TotalInches =
>>                  c(58, 59, 60, 61, 62, 63, 64, 65,
>>                    66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76), Low20 =
>> c(84, 87,
>>                    90, 93, 96, 99, 102, 106, 109, 112, 116, 119, 122,
>> 126, 129,
>>                    133, 137, 141, 144), High20 = c(111, 115, 119, 123,
>> 127, 131,
>>                    135, 140, 144, 148, 153, 157, 162, 167, 171, 176, 181,
>> 186, 191
>>                    )), class = "data.frame", row.names = c(NA, -19L))
>> xxxz
>> str(xxxz)
>> xxxz$Average20 <- by(xxxz[,c("Low20","High20")],xxxz[,"TotalInches"],mean)
>> warnings()
>>
>> When I run the code above, I don't get the means by row. I get the
>> following warning messages, one for each row of the dataframe.
>>
>> Warning messages:
>> 1: In mean.default(data[x, , drop = FALSE], ...) :
>>   argument is not numeric or logical: returning NA
>> 2: In mean.default(data[x, , drop = FALSE], ...) :
>>   argument is not numeric or logical: returning NA
>>
>>  Can someone tell my what I am doing wrong, and how I can compute the row
>> means?
>>
>> Thank you,
>> John
>>
>> John David Sorkin M.D., Ph.D.
>> Professor of Medicine, University of Maryland School of Medicine;
>> Associate Director for Biostatistics and Informatics, Baltimore VA
>> Medical Center Geriatrics Research, Education, and Clinical Center;
>> PI Biostatistics and Informatics Core, University of Maryland School of
>> Medicine Claude D. Pepper Older Americans Independence Center;
>> Senior Statistician University of Maryland Center for Vascular Research;
>>
>> Division of Gerontology and Paliative Care,
>> 10 North Greene Street
>> GRECC (BT/18/GR)
>> Baltimore, MD 21201-1524
>> Cell phone 443-418-5382
>>
>>
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From @vi@e@gross m@iii@g oii gm@ii@com  Sat Jun  8 20:15:46 2024
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Sat, 8 Jun 2024 14:15:46 -0400
Subject: [R] Can't compute row means of two columns of a dataframe.
In-Reply-To: <DM6PR03MB50491504249460658C306971E2C42@DM6PR03MB5049.namprd03.prod.outlook.com>
References: <DM6PR03MB50491504249460658C306971E2C42@DM6PR03MB5049.namprd03.prod.outlook.com>
Message-ID: <005001dab9cf$e2596850$a70c38f0$@gmail.com>

John,

Maybe you can clarify what you want the output to look like. It took me a
while to realize what you may want as it is NOT properly described as
wanting rowsums.

There is a standard function called rowMeans() that probably does what you
want if you want the mean of all rows as in:

> rowMeans(xxxz)
 [1]  84.33333  87.00000  89.66667  92.33333  95.00000  97.66667 100.33333
103.66667 106.33333 109.00000 112.33333 115.00000
[13] 118.00000 121.33333 124.00000 127.33333 130.66667 134.00000 137.00000

It does not add the means to the original data.frame if you wanted it there
but that is easy enough to do.

> xxxz$Average20 <-rowMeans(xxxz)
> head(xxxz)
  TotalInches Low20 High20 Average20
1          58    84    111  84.33333
2          59    87    115  87.00000
3          60    90    119  89.66667
4          61    93    123  92.33333
5          62    96    127  95.00000
6          63    99    131  97.66667

Your construct is more complex and it looks like you want to do this to a
subset of two columns. Again, straightforward:

xxxz$Average20 <-rowMeans(xxxz[, c("Low20", "High20")])

And I probably would do this using a dplyr mutate but that is outside the
scope.

This does not help explain your error, so let me look at what you are trying
to do.


What  did you expect to use by() for in the second argument? You seem to be
giving it INDICES of the first column entries. What is that for?

by(xxxz[,c("Low20","High20")],
   xxxz[,"TotalInches"],
   mean)

The documentation suggest this is for splitting by factors. I do not  see
there are multiple instances of some TotalInches so why is this needed for
some kind of grouping?

My guess is you are using the wrong function or the wrong way for your
needs. The warnings may relate to that.


-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Sorkin, John
Sent: Saturday, June 8, 2024 1:38 PM
To: r-help at r-project.org (r-help at r-project.org) <r-help at r-project.org>
Subject: [R] Can't compute row means of two columns of a dataframe.

I have a data frame with three columns, TotalInches, Low20, High20. For each
row of the dataset, I am trying to compute the mean of Low20 and High20. 

xxxz <- structure(list(TotalInches = 
                 c(58, 59, 60, 61, 62, 63, 64, 65, 
                   66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76), Low20 =
c(84, 87, 
                   90, 93, 96, 99, 102, 106, 109, 112, 116, 119, 122, 126,
129, 
                   133, 137, 141, 144), High20 = c(111, 115, 119, 123, 127,
131, 
                   135, 140, 144, 148, 153, 157, 162, 167, 171, 176, 181,
186, 191
                   )), class = "data.frame", row.names = c(NA, -19L))
xxxz
str(xxxz)
xxxz$Average20 <- by(xxxz[,c("Low20","High20")],xxxz[,"TotalInches"],mean)
warnings()

When I run the code above, I don't get the means by row. I get the following
warning messages, one for each row of the dataframe.

Warning messages:
1: In mean.default(data[x, , drop = FALSE], ...) :
  argument is not numeric or logical: returning NA
2: In mean.default(data[x, , drop = FALSE], ...) :
  argument is not numeric or logical: returning NA

 Can someone tell my what I am doing wrong, and how I can compute the row
means?

Thank you,
John

John David Sorkin M.D., Ph.D.
Professor of Medicine, University of Maryland School of Medicine;
Associate Director for Biostatistics and Informatics, Baltimore VA Medical
Center Geriatrics Research, Education, and Clinical Center;?
PI?Biostatistics and Informatics Core, University of Maryland School of
Medicine Claude D. Pepper Older Americans Independence Center;
Senior Statistician University of Maryland Center for Vascular Research;

Division of Gerontology and Paliative Care,
10 North Greene Street
GRECC (BT/18/GR)
Baltimore, MD 21201-1524
Cell phone 443-418-5382



______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From tebert @end|ng |rom u||@edu  Sat Jun  8 22:05:48 2024
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Sat, 8 Jun 2024 20:05:48 +0000
Subject: [R] Can't compute row means of two columns of a dataframe.
In-Reply-To: <DM6PR03MB50491504249460658C306971E2C42@DM6PR03MB5049.namprd03.prod.outlook.com>
References: <DM6PR03MB50491504249460658C306971E2C42@DM6PR03MB5049.namprd03.prod.outlook.com>
Message-ID: <CH3PR22MB4514D97F81FDC8D9A3F73413CFC42@CH3PR22MB4514.namprd22.prod.outlook.com>

Can this problem be made more direct?

xxxz$Average.20 <- (xxxz$Low20 + xxxz$High20)/2

That is literally the mean of two columns. Functions can be useful if there will be more columns, but with just two this seems easier.

I will point out that the average daily temperature based on the midpoint between minimum and maximum contains a fair bit of error because that is only roughly how heating and cooling respond. I admit that sometimes there are no other choices and we work with available data.

Tim


-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Sorkin, John
Sent: Saturday, June 8, 2024 1:38 PM
To: r-help at r-project.org (r-help at r-project.org) <r-help at r-project.org>
Subject: [R] Can't compute row means of two columns of a dataframe.

[External Email]

I have a data frame with three columns, TotalInches, Low20, High20. For each row of the dataset, I am trying to compute the mean of Low20 and High20.

xxxz <- structure(list(TotalInches =
                 c(58, 59, 60, 61, 62, 63, 64, 65,
                   66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76), Low20 = c(84, 87,
                   90, 93, 96, 99, 102, 106, 109, 112, 116, 119, 122, 126, 129,
                   133, 137, 141, 144), High20 = c(111, 115, 119, 123, 127, 131,
                   135, 140, 144, 148, 153, 157, 162, 167, 171, 176, 181, 186, 191
                   )), class = "data.frame", row.names = c(NA, -19L)) xxxz
str(xxxz)
xxxz$Average20 <- by(xxxz[,c("Low20","High20")],xxxz[,"TotalInches"],mean)
warnings()

When I run the code above, I don't get the means by row. I get the following warning messages, one for each row of the dataframe.

Warning messages:
1: In mean.default(data[x, , drop = FALSE], ...) :
  argument is not numeric or logical: returning NA
2: In mean.default(data[x, , drop = FALSE], ...) :
  argument is not numeric or logical: returning NA

 Can someone tell my what I am doing wrong, and how I can compute the row means?

Thank you,
John

John David Sorkin M.D., Ph.D.
Professor of Medicine, University of Maryland School of Medicine; Associate Director for Biostatistics and Informatics, Baltimore VA Medical Center Geriatrics Research, Education, and Clinical Center; PI Biostatistics and Informatics Core, University of Maryland School of Medicine Claude D. Pepper Older Americans Independence Center; Senior Statistician University of Maryland Center for Vascular Research;

Division of Gerontology and Paliative Care,
10 North Greene Street
GRECC (BT/18/GR)
Baltimore, MD 21201-1524
Cell phone 443-418-5382



______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.r-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From tebert @end|ng |rom u||@edu  Sun Jun  9 04:19:25 2024
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Sun, 9 Jun 2024 02:19:25 +0000
Subject: [R] Can't compute row means of two columns of a dataframe.
In-Reply-To: <005001dab9cf$e2596850$a70c38f0$@gmail.com>
References: <DM6PR03MB50491504249460658C306971E2C42@DM6PR03MB5049.namprd03.prod.outlook.com>
 <005001dab9cf$e2596850$a70c38f0$@gmail.com>
Message-ID: <CH3PR22MB451454252F08CDF63DB9B7E8CFC52@CH3PR22MB4514.namprd22.prod.outlook.com>

Would this work?

xxxz$Average20 <- (xxxz$Low20 + xxxz$High20)/2

I tried this earlier but it does not appear to have gone through.

Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of avi.e.gross at gmail.com
Sent: Saturday, June 8, 2024 2:16 PM
To: 'Sorkin, John' <jsorkin at som.umaryland.edu>; r-help at r-project.org
Subject: Re: [R] Can't compute row means of two columns of a dataframe.

[External Email]

John,

Maybe you can clarify what you want the output to look like. It took me a while to realize what you may want as it is NOT properly described as wanting rowsums.

There is a standard function called rowMeans() that probably does what you want if you want the mean of all rows as in:

> rowMeans(xxxz)
 [1]  84.33333  87.00000  89.66667  92.33333  95.00000  97.66667 100.33333
103.66667 106.33333 109.00000 112.33333 115.00000 [13] 118.00000 121.33333 124.00000 127.33333 130.66667 134.00000 137.00000

It does not add the means to the original data.frame if you wanted it there but that is easy enough to do.

> xxxz$Average20 <-rowMeans(xxxz)
> head(xxxz)
  TotalInches Low20 High20 Average20
1          58    84    111  84.33333
2          59    87    115  87.00000
3          60    90    119  89.66667
4          61    93    123  92.33333
5          62    96    127  95.00000
6          63    99    131  97.66667

Your construct is more complex and it looks like you want to do this to a subset of two columns. Again, straightforward:

xxxz$Average20 <-rowMeans(xxxz[, c("Low20", "High20")])

And I probably would do this using a dplyr mutate but that is outside the scope.

This does not help explain your error, so let me look at what you are trying to do.


What  did you expect to use by() for in the second argument? You seem to be giving it INDICES of the first column entries. What is that for?

by(xxxz[,c("Low20","High20")],
   xxxz[,"TotalInches"],
   mean)

The documentation suggest this is for splitting by factors. I do not  see there are multiple instances of some TotalInches so why is this needed for some kind of grouping?

My guess is you are using the wrong function or the wrong way for your needs. The warnings may relate to that.


-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Sorkin, John
Sent: Saturday, June 8, 2024 1:38 PM
To: r-help at r-project.org (r-help at r-project.org) <r-help at r-project.org>
Subject: [R] Can't compute row means of two columns of a dataframe.

I have a data frame with three columns, TotalInches, Low20, High20. For each row of the dataset, I am trying to compute the mean of Low20 and High20.

xxxz <- structure(list(TotalInches =
                 c(58, 59, 60, 61, 62, 63, 64, 65,
                   66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76), Low20 = c(84, 87,
                   90, 93, 96, 99, 102, 106, 109, 112, 116, 119, 122, 126, 129,
                   133, 137, 141, 144), High20 = c(111, 115, 119, 123, 127, 131,
                   135, 140, 144, 148, 153, 157, 162, 167, 171, 176, 181, 186, 191
                   )), class = "data.frame", row.names = c(NA, -19L)) xxxz
str(xxxz)
xxxz$Average20 <- by(xxxz[,c("Low20","High20")],xxxz[,"TotalInches"],mean)
warnings()

When I run the code above, I don't get the means by row. I get the following warning messages, one for each row of the dataframe.

Warning messages:
1: In mean.default(data[x, , drop = FALSE], ...) :
  argument is not numeric or logical: returning NA
2: In mean.default(data[x, , drop = FALSE], ...) :
  argument is not numeric or logical: returning NA

 Can someone tell my what I am doing wrong, and how I can compute the row means?

Thank you,
John

John David Sorkin M.D., Ph.D.
Professor of Medicine, University of Maryland School of Medicine; Associate Director for Biostatistics and Informatics, Baltimore VA Medical Center Geriatrics Research, Education, and Clinical Center; PI Biostatistics and Informatics Core, University of Maryland School of Medicine Claude D. Pepper Older Americans Independence Center; Senior Statistician University of Maryland Center for Vascular Research;

Division of Gerontology and Paliative Care,
10 North Greene Street
GRECC (BT/18/GR)
Baltimore, MD 21201-1524
Cell phone 443-418-5382



______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.r-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.r-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From v@|kremk @end|ng |rom gm@||@com  Sun Jun  9 22:39:19 2024
From: v@|kremk @end|ng |rom gm@||@com (Val)
Date: Sun, 9 Jun 2024 15:39:19 -0500
Subject: [R] Format
Message-ID: <CAJOiR6arjoEf27aW8u54so27Tx-PsYRvGvB1TAj8OiAwS9dB_A@mail.gmail.com>

HI all,

My
I am trying to convert character date (mm/dd/yy)  to YYYY-mm-dd date
format in one of the columns of my data file.

The first few lines of the data file looks like as follow

 head(Atest,10);dim(Atest)
      ddate
1  19/08/21
2  30/04/18
3  28/08/21
4  11/10/21
5  07/09/21
6  15/08/21
7  03/09/21
8  23/07/18
9  17/08/20
10 23/09/20
[1] 1270076       1

I am using the following different scenarios but none of them resulted
the desired result.

library(data.table)
library(stringr)
library(lubridate)
        Atest$ddate1 <- as.Date((Atest$ddate), format = "%m/%d/%y")
        Atest$ddate2 <- mdy((Atest$ddate))
        Atest$ddate3 <= as.Date(as.character(Atest$ddate),format="%m/%d/%y")
        Atest$ddate4 <- as.Date(as.character(Atest$ddate),"%m/%d/%y")
        Atest$ddate5 <- lubridate::mdy(Atest$ddate)

> head(Atest,3)
     ddate     ddate1 ddate2 ddate4 ddate5
1 19/08/21   <NA>   <NA>   <NA>   <NA>
2 30/04/18   <NA>   <NA>   <NA>   <NA>
3 28/08/21   <NA>   <NA>   <NA>   <NA>


Any help why I am not getting the desired result.
Thank you,


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sun Jun  9 22:45:26 2024
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sun, 9 Jun 2024 21:45:26 +0100
Subject: [R] Format
In-Reply-To: <CAJOiR6arjoEf27aW8u54so27Tx-PsYRvGvB1TAj8OiAwS9dB_A@mail.gmail.com>
References: <CAJOiR6arjoEf27aW8u54so27Tx-PsYRvGvB1TAj8OiAwS9dB_A@mail.gmail.com>
Message-ID: <e4e86e65-b628-4714-8d94-ae1a32e39f14@sapo.pt>

?s 21:39 de 09/06/2024, Val escreveu:
> HI all,
> 
> My
> I am trying to convert character date (mm/dd/yy)  to YYYY-mm-dd date
> format in one of the columns of my data file.
> 
> The first few lines of the data file looks like as follow
> 
>   head(Atest,10);dim(Atest)
>        ddate
> 1  19/08/21
> 2  30/04/18
> 3  28/08/21
> 4  11/10/21
> 5  07/09/21
> 6  15/08/21
> 7  03/09/21
> 8  23/07/18
> 9  17/08/20
> 10 23/09/20
> [1] 1270076       1
> 
> I am using the following different scenarios but none of them resulted
> the desired result.
> 
> library(data.table)
> library(stringr)
> library(lubridate)
>          Atest$ddate1 <- as.Date((Atest$ddate), format = "%m/%d/%y")
>          Atest$ddate2 <- mdy((Atest$ddate))
>          Atest$ddate3 <= as.Date(as.character(Atest$ddate),format="%m/%d/%y")
>          Atest$ddate4 <- as.Date(as.character(Atest$ddate),"%m/%d/%y")
>          Atest$ddate5 <- lubridate::mdy(Atest$ddate)
> 
>> head(Atest,3)
>       ddate     ddate1 ddate2 ddate4 ddate5
> 1 19/08/21   <NA>   <NA>   <NA>   <NA>
> 2 30/04/18   <NA>   <NA>   <NA>   <NA>
> 3 28/08/21   <NA>   <NA>   <NA>   <NA>
> 
> 
> Any help why I am not getting the desired result.
> Thank you,
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Day is clearly first, format "%m/%d/%y" assumes a month 19 in 19/08/21.
Try

as.Date(Atest$ddate, format = "%d/%m/%y")


Hope this helps,

Rui Barradas


-- 
Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.
www.avg.com


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Jun  9 22:54:54 2024
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 9 Jun 2024 16:54:54 -0400
Subject: [R] Format
In-Reply-To: <CAJOiR6arjoEf27aW8u54so27Tx-PsYRvGvB1TAj8OiAwS9dB_A@mail.gmail.com>
References: <CAJOiR6arjoEf27aW8u54so27Tx-PsYRvGvB1TAj8OiAwS9dB_A@mail.gmail.com>
Message-ID: <3ac0b669-2c9e-4dc5-bcd8-2845e879bc77@gmail.com>

On 2024-06-09 4:39 p.m., Val wrote:
> HI all,
> 
> My
> I am trying to convert character date (mm/dd/yy)  to YYYY-mm-dd date
> format in one of the columns of my data file.
> 
> The first few lines of the data file looks like as follow
> 
>   head(Atest,10);dim(Atest)
>        ddate
> 1  19/08/21
> 2  30/04/18

Those aren't legal months in the first entry.  Your format looks like it 
should be "%d/%m/%y".

Duncan Murdoch


From er|cjberger @end|ng |rom gm@||@com  Mon Jun 10 10:02:25 2024
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Mon, 10 Jun 2024 11:02:25 +0300
Subject: [R] Format
In-Reply-To: <3ac0b669-2c9e-4dc5-bcd8-2845e879bc77@gmail.com>
References: <CAJOiR6arjoEf27aW8u54so27Tx-PsYRvGvB1TAj8OiAwS9dB_A@mail.gmail.com>
 <3ac0b669-2c9e-4dc5-bcd8-2845e879bc77@gmail.com>
Message-ID: <CAGgJW760FTEApEoK10cgC34UwS_Cax1xMvg0Qym7Mh3JgrDiMw@mail.gmail.com>

Since you are loading lubridate it is enough to do

Atest$ddate1 <- dmy(Atest$ddate)



On Sun, Jun 9, 2024 at 11:59?PM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>
> On 2024-06-09 4:39 p.m., Val wrote:
> > HI all,
> >
> > My
> > I am trying to convert character date (mm/dd/yy)  to YYYY-mm-dd date
> > format in one of the columns of my data file.
> >
> > The first few lines of the data file looks like as follow
> >
> >   head(Atest,10);dim(Atest)
> >        ddate
> > 1  19/08/21
> > 2  30/04/18
>
> Those aren't legal months in the first entry.  Your format looks like it
> should be "%d/%m/%y".
>
> Duncan Murdoch
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From roy@mende|@@ohn @end|ng |rom no@@@gov  Tue Jun 11 15:32:53 2024
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Tue, 11 Jun 2024 06:32:53 -0700
Subject: [R] Fwd: Webinar: How to access ERDDAP data using R
References: <CAGtfGWShx9DQNjxLfNmHcHCdhbD=fgXz3Qo3B38MGC+zwrFcww@mail.gmail.com>
Message-ID: <65BC70C3-A27E-4411-8B1C-2EC28AE5810D@noaa.gov>



> 
>  	
>  
>  <https://goosocean.us15.list-manage.com/track/click?u=75c69bf185fb2be069850f6ee&id=fd7c35981e&e=3b244e9fac>
>  
> Note	 | 	June 2024
>  
>  
>  	
>  	
> Webinar announcement
>  
> How to access ERDDAP data using R
>  
>  
> 
>  
> 	 	20 June 2024 | 18:00 CEST
>  	See what time it is for you <https://goosocean.us15.list-manage.com/track/click?u=75c69bf185fb2be069850f6ee&id=dbf44ac3d6&e=3b244e9fac>
> 	 	Online
>  
> This seminar will demonstrating the use of ERDDAP? in R. Demonstrating the use of multiple ERDDAP? servers to pull together collocated datasets, extracting detailed metadata, and accessing ERDDAP? hosted data using R.
> 
> This webinar is a follow up from the webinar ?How to ERDDAP?? using python.
> 
> Future Seminars:
> July - Using ERDDAP to track usage metrics
> August - Abstracting across ERDDAP
> September - Writing Data into ERDDAP
> 
> Webinar registration <https://goosocean.us15.list-manage.com/track/click?u=75c69bf185fb2be069850f6ee&id=e9575a2093&e=3b244e9fac>
> Flyer <https://goosocean.us15.list-manage.com/track/click?u=75c69bf185fb2be069850f6ee&id=8717d0af8d&e=3b244e9fac>
> Access previous ERDDAP webinars here <https://goosocean.us15.list-manage.com/track/click?u=75c69bf185fb2be069850f6ee&id=e3b756ef29&e=3b244e9fac>.
>  	
>  
> Register
>  <https://goosocean.us15.list-manage.com/track/click?u=75c69bf185fb2be069850f6ee&id=f8b460fc54&e=3b244e9fac>
>  
>  
>  
>  
>  
>  	
> 
>  	
> 
>  	
> 
>  	
> 
>  
> The Global Ocean Observing System is sponsored by
> the Intergovernmental Oceanographic Commission of UNESCO,
> the World Meteorological Organization, the United Nations Environment 
> Programme, and the International Science Council.
> 
> Global Ocean Observing System 
> Intergovernmental Oceanographic Commission
> UNESCO
> 7 place de Fontenoy
> 75352 Paris 07-SP
> France
> 
> goos at unesco.org <mailto:goos at unesco.org>
> 
> For inquiries about the GOOS mailing list please contact 
> Laura Stukonyt? l.stukonyte at unesco.org <mailto:l.stukonyte at unesco.org>
>  
>  
> You are receiving this email because you are a member of the 
> Global Ocean Observing Community.
> 
> Unsubscribe <https://goosocean.us15.list-manage.com/unsubscribe?u=75c69bf185fb2be069850f6ee&id=7f482bccaa&t=b&e=3b244e9fac&c=e459de2052> ann-christine.zinkann at noaa.gov <mailto:ann-christine.zinkann at noaa.gov> from this list 
> Update subscription preferences <https://goosocean.us15.list-manage.com/profile?u=75c69bf185fb2be069850f6ee&id=7f482bccaa&e=3b244e9fac&c=e459de2052>
> View email in browser <https://mailchi.mp/goosocean/webinar-how-to-access-erddap-data-using-r?e=3b244e9fac>
> 
> ? 2024 Global Ocean Observing System. All rights reserved.
>  
>  
> 
> 
> 
> -- 
> 
> 
> 
> 
> Ann-Christine Zinkann, PhD (she/her)
> Program Manager
> National Oceanic and Atmospheric Administration <https://www.noaa.gov/>
> Global Ocean Monitoring & Observing Program <http://globalocean.noaa.gov/>
> and Cooperative Programs for the Advancement of Earth System Science <https://cpaess.ucar.edu/>, University Corporation for Atmospheric Research
> 803.904.8291 | ann-christine.zinkann at noaa.gov <mailto:email at noaa.gov>
**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


	[[alternative HTML version deleted]]


From m|ev|n@ @end|ng |rom purdue@edu  Tue Jun 11 20:44:08 2024
From: m|ev|n@ @end|ng |rom purdue@edu (Levine, Michael)
Date: Tue, 11 Jun 2024 18:44:08 +0000
Subject: [R] Integration of functions with a vector argument
Message-ID: <PH0PR22MB2860E3ABD206953D15F31EFAC5C72@PH0PR22MB2860.namprd22.prod.outlook.com>

Hello all,

I have a question concerning integration of a function of a multivariate argument with respect to one or more variables in r.  Let us say we have a function

F <- function(x){ body of the function}

Where x is, in general, a d by 1 vector with d>1.  Now I want to integrate out some of the coordinates of x, e.g. x[1] or x[2] or both of them etc. I'm well aware of how to integrate out e.g. y if a function is defined as f <- function (x,y) {body of the function} where y is a scalar.
However, it seems to be quite difficult to do the same if the function is defined with a vector argument x. At the very least, I haven't seen any good examples of this being done.
Any suggestions?

Yours sincerely,
Michael

Michael Levine
Associate Professor, Statistics

Department of Statistics
Purdue University
250 North University Street
West Lafayette, IN 47907 USA

email: mlevins at purdue.edu
Phone: +1-765-496-7571
Fax:   +1-765-494-0558
URL:   www.stat.purdue.edu/~mlevins

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Wed Jun 12 12:41:19 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Wed, 12 Jun 2024 13:41:19 +0300
Subject: [R] Integration of functions with a vector argument
In-Reply-To: <PH0PR22MB2860E3ABD206953D15F31EFAC5C72@PH0PR22MB2860.namprd22.prod.outlook.com>
References: <PH0PR22MB2860E3ABD206953D15F31EFAC5C72@PH0PR22MB2860.namprd22.prod.outlook.com>
Message-ID: <20240612134119.72e4cab6@Tarkus>

? Tue, 11 Jun 2024 18:44:08 +0000
"Levine, Michael" <mlevins at purdue.edu> ?????:

> Let us say we have a function
> 
> F <- function(x){ body of the function}
> 
> Where x is, in general, a d by 1 vector with d>1.  Now I want to
> integrate out some of the coordinates of x, e.g. x[1] or x[2] or both
> of them etc. I'm well aware of how to integrate out e.g. y if a
> function is defined as f <- function (x,y) {body of the function}
> where y is a scalar.

The reason integrate() wants a separate function argument for the
integration coordinate is so that it could give the function a vector
of different values of the variable and receive a vector of the same
length containing the corresponding values of the function.

If the problem is small enough to make performance considerations
irrelevant, you can use Vectorize to make a function compatible with
integrate() from your function F:

x <- x0
z <- z0
Fiy <- Vectorize(function(y) F(c(x, y, z)))
integrate(Fiy, ymin, ymax)

The resulting function Fiy will accept a vector of values for y and
translate it into multiple calls to F with a three-element vector
argument as it expects.

Achieving better performance will require rewriting the function F to
be "vectorised", i.e. to accept vectors for arguments and return a
vector of the same length.

-- 
Best regards,
Ivan


From ycd|ng @end|ng |rom coh@org  Wed Jun 12 18:28:29 2024
From: ycd|ng @end|ng |rom coh@org (Yuan Chun Ding)
Date: Wed, 12 Jun 2024 16:28:29 +0000
Subject: [R] my R code worked well when running the first 1000 lines of R
 code
In-Reply-To: <MN2PR02MB6911CD6439B0FAA8614FD204D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
References: <MN2PR02MB6911CD6439B0FAA8614FD204D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
Message-ID: <MN2PR02MB691189F9B5F75D42B81E2162D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>

Hi R users,

The following code worked well to summarize four data groups in a dataframe for three variables (t_depth, t_alt_count, t_alt_ratio), 12 columns of summary, see attached.
However, after running another 2000 lines of R codes using functions from more than 10 other R  libraries, then it only generated one column of summary.
Do you know why?

Thank you,

Yuan Chun Ding

summary_anno1148ft <- anno1148ft %>%
  pivot_longer(c(t_depth, t_alt_count, t_alt_ratio), names_to = "measure") %>%
  group_by(dat, measure) %>%
  summarize(minimum = min(value,na.rm=T),
            q25 = quantile(value, probs = 0.25,na.rm=T),
            med = median(value,na.rm=T),
            q75 = quantile(value, probs = 0.75,na.rm=T),
            maximum = max(value,na.rm=T),
            average = mean(value,na.rm=T),
            #standard_deviation = sd(value),
            .groups = "drop"
  )
summary_anno1148ft <-t(summary_anno1148ft)



----------------------------------------------------------------------
------------------------------------------------------------
-SECURITY/CONFIDENTIALITY WARNING-  

This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to receive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)
------------------------------------------------------------

From bgunter@4567 @end|ng |rom gm@||@com  Wed Jun 12 19:49:13 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 12 Jun 2024 10:49:13 -0700
Subject: [R] 
 my R code worked well when running the first 1000 lines of R code
In-Reply-To: <MN2PR02MB691189F9B5F75D42B81E2162D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
References: <MN2PR02MB6911CD6439B0FAA8614FD204D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
 <MN2PR02MB691189F9B5F75D42B81E2162D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
Message-ID: <CAGxFJbQuZeozK-CAf2sARq-OAfP1YuTDHK3MhaK+MRa+Esf0+g@mail.gmail.com>

I am assuming from your message that *exactly* the same code you show was
rerun and yielded different results. If that be so, I doubt that this can
be answered without knowing what that other R code did -- and perhaps not
even then -- and/or whether any of that code changed your data frame.
Another guess is that one of those other R packages may have replaced the
summarize method you used with another (customized) method.

Hopefully, someone else may have more insight than I, though.

-- Bert

On Wed, Jun 12, 2024 at 9:28?AM Yuan Chun Ding via R-help <
r-help at r-project.org> wrote:

> Hi R users,
>
> The following code worked well to summarize four data groups in a
> dataframe for three variables (t_depth, t_alt_count, t_alt_ratio), 12
> columns of summary, see attached.
> However, after running another 2000 lines of R codes using functions from
> more than 10 other R  libraries, then it only generated one column of
> summary.
> Do you know why?
>
> Thank you,
>
> Yuan Chun Ding
>
> summary_anno1148ft <- anno1148ft %>%
>   pivot_longer(c(t_depth, t_alt_count, t_alt_ratio), names_to = "measure")
> %>%
>   group_by(dat, measure) %>%
>   summarize(minimum = min(value,na.rm=T),
>             q25 = quantile(value, probs = 0.25,na.rm=T),
>             med = median(value,na.rm=T),
>             q75 = quantile(value, probs = 0.75,na.rm=T),
>             maximum = max(value,na.rm=T),
>             average = mean(value,na.rm=T),
>             #standard_deviation = sd(value),
>             .groups = "drop"
>   )
> summary_anno1148ft <-t(summary_anno1148ft)
>
>
>
> ----------------------------------------------------------------------
> ------------------------------------------------------------
> -SECURITY/CONFIDENTIALITY WARNING-
>
> This message and any attachments are intended solely for the individual or
> entity to which they are addressed. This communication may contain
> information that is privileged, confidential, or exempt from disclosure
> under applicable law (e.g., personal health information, research data,
> financial information). Because this e-mail has been sent without
> encryption, individuals other than the intended recipient may be able to
> view the information, forward it to others or tamper with the information
> without the knowledge or consent of the sender. If you are not the intended
> recipient, or the employee or person responsible for delivering the message
> to the intended recipient, any dissemination, distribution or copying of
> the communication is strictly prohibited. If you received the communication
> in error, please notify the sender immediately by replying to this message
> and deleting the message and any accompanying files from your system. If,
> due to the security risks, you do not wish to receive further
> communications via e-mail, please reply to this message and inform the
> sender that you do not wish to receive further e-mail from the sender.
> (LCP301)
> ------------------------------------------------------------
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From tebert @end|ng |rom u||@edu  Wed Jun 12 19:51:15 2024
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Wed, 12 Jun 2024 17:51:15 +0000
Subject: [R] 
 my R code worked well when running the first 1000 lines of R code
In-Reply-To: <MN2PR02MB691189F9B5F75D42B81E2162D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
References: <MN2PR02MB6911CD6439B0FAA8614FD204D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
 <MN2PR02MB691189F9B5F75D42B81E2162D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
Message-ID: <CH3PR22MB4514F7E69519D18D94D7981DCFC02@CH3PR22MB4514.namprd22.prod.outlook.com>

Hi Yuan,
   When you load some packages do you get messages saying that some function is being masked? What can happen is that one package has a function with the same name as another package. The conflict is resolved by having one package mask the other. However, this can cause conflicts if your code uses the function in a way that is only supported in the masked package.

Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Yuan Chun Ding via R-help
Sent: Wednesday, June 12, 2024 12:28 PM
To: r-help at R-project.org (r-help at r-project.org) <r-help at r-project.org>
Subject: [R] my R code worked well when running the first 1000 lines of R code

[External Email]

Hi R users,

The following code worked well to summarize four data groups in a dataframe for three variables (t_depth, t_alt_count, t_alt_ratio), 12 columns of summary, see attached.
However, after running another 2000 lines of R codes using functions from more than 10 other R  libraries, then it only generated one column of summary.
Do you know why?

Thank you,

Yuan Chun Ding

summary_anno1148ft <- anno1148ft %>%
  pivot_longer(c(t_depth, t_alt_count, t_alt_ratio), names_to = "measure") %>%
  group_by(dat, measure) %>%
  summarize(minimum = min(value,na.rm=T),
            q25 = quantile(value, probs = 0.25,na.rm=T),
            med = median(value,na.rm=T),
            q75 = quantile(value, probs = 0.75,na.rm=T),
            maximum = max(value,na.rm=T),
            average = mean(value,na.rm=T),
            #standard_deviation = sd(value),
            .groups = "drop"
  )
summary_anno1148ft <-t(summary_anno1148ft)



----------------------------------------------------------------------
------------------------------------------------------------
-SECURITY/CONFIDENTIALITY WARNING-

This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to receive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)
------------------------------------------------------------
______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.r-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From po|c1410 @end|ng |rom gm@||@com  Wed Jun 12 19:52:27 2024
From: po|c1410 @end|ng |rom gm@||@com (CALUM POLWART)
Date: Wed, 12 Jun 2024 18:52:27 +0100
Subject: [R] 
 my R code worked well when running the first 1000 lines of R code
In-Reply-To: <MN2PR02MB691189F9B5F75D42B81E2162D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
References: <MN2PR02MB6911CD6439B0FAA8614FD204D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
 <MN2PR02MB691189F9B5F75D42B81E2162D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
Message-ID: <CA+etgPmKDa9Fn9DFVHmJyEBMiFF9JnkM27y1pwAvQ8N+nLEkTw@mail.gmail.com>

I sometimes think people on this list are quite rude to posters.

I'm afraid I'm likely to join in with some rudeness?

1. "Here is some code that works but also doesn't" is probably not going to
get you an answer
2. I provide no information about the data it works on or doesn't
3. I tell you I'm using a load of dependencies, but don't tell you what
4. I refer to 2000 lines of code but probably means 2000 lines of data?

So. Please post a question someone can actually answer.

If the question is "why might code fail on a 2000 line dataset when it
works on 1000 line dataset" then here are some thoughts:

* Is the 1000 lines being run as dataset[1:1000,] or is it dataset1 and
dataset2 ?
* Is there a structural difference in the datasets - i.e. numbers,
characters or factors as columns. Often import functions guess a column
type by reading the first 500/1000 lines. If the data has numbers in column
1 for 1-1000 but on line 1999 has a letter... The data type may vary.

On Wed, 12 Jun 2024, 17:28 Yuan Chun Ding via R-help, <r-help at r-project.org>
wrote:

> Hi R users,
>
> The following code worked well to summarize four data groups in a
> dataframe for three variables (t_depth, t_alt_count, t_alt_ratio), 12
> columns of summary, see attached.
> However, after running another 2000 lines of R codes using functions from
> more than 10 other R  libraries, then it only generated one column of
> summary.
> Do you know why?
>
> Thank you,
>
> Yuan Chun Ding
>
> summary_anno1148ft <- anno1148ft %>%
>   pivot_longer(c(t_depth, t_alt_count, t_alt_ratio), names_to = "measure")
> %>%
>   group_by(dat, measure) %>%
>   summarize(minimum = min(value,na.rm=T),
>             q25 = quantile(value, probs = 0.25,na.rm=T),
>             med = median(value,na.rm=T),
>             q75 = quantile(value, probs = 0.75,na.rm=T),
>             maximum = max(value,na.rm=T),
>             average = mean(value,na.rm=T),
>             #standard_deviation = sd(value),
>             .groups = "drop"
>   )
> summary_anno1148ft <-t(summary_anno1148ft)
>
>
>
> ----------------------------------------------------------------------
> ------------------------------------------------------------
> -SECURITY/CONFIDENTIALITY WARNING-
>
> This message and any attachments are intended solely for the individual or
> entity to which they are addressed. This communication may contain
> information that is privileged, confidential, or exempt from disclosure
> under applicable law (e.g., personal health information, research data,
> financial information). Because this e-mail has been sent without
> encryption, individuals other than the intended recipient may be able to
> view the information, forward it to others or tamper with the information
> without the knowledge or consent of the sender. If you are not the intended
> recipient, or the employee or person responsible for delivering the message
> to the intended recipient, any dissemination, distribution or copying of
> the communication is strictly prohibited. If you received the communication
> in error, please notify the sender immediately by replying to this message
> and deleting the message and any accompanying files from your system. If,
> due to the security risks, you do not wish to receive further
> communications via e-mail, please reply to this message and inform the
> sender that you do not wish to receive further e-mail from the sender.
> (LCP301)
> ------------------------------------------------------------
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ycd|ng @end|ng |rom coh@org  Wed Jun 12 20:03:25 2024
From: ycd|ng @end|ng |rom coh@org (Yuan Chun Ding)
Date: Wed, 12 Jun 2024 18:03:25 +0000
Subject: [R] 
 my R code worked well when running the first 1000 lines of R code
In-Reply-To: <CA+etgPmKDa9Fn9DFVHmJyEBMiFF9JnkM27y1pwAvQ8N+nLEkTw@mail.gmail.com>
References: <MN2PR02MB6911CD6439B0FAA8614FD204D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
 <MN2PR02MB691189F9B5F75D42B81E2162D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CA+etgPmKDa9Fn9DFVHmJyEBMiFF9JnkM27y1pwAvQ8N+nLEkTw@mail.gmail.com>
Message-ID: <MN2PR02MB6911C2E5109A13CF47B39B7AD4C02@MN2PR02MB6911.namprd02.prod.outlook.com>

I am sorry that I know I should provide a dataset that allows to replicate my problem.

It is a research dataset and quite large, so I can not share.

Both Bert and Tim guessed my problem correctly.  I also thought about the conflicting issue between different packages and function masking.
I just hope to that someone has similar experience, so providing me suggestion.

For conflicting issue,

What I tried  was to add dplyr::pivot_longer or tidyr:: pivot_longer, but still not resolved the problem.



I will restart from the first line my code, it will work again and then I will track down.



Thank you,

Ding


From: CALUM POLWART <polc1410 at gmail.com>
Sent: Wednesday, June 12, 2024 10:52 AM
To: Yuan Chun Ding <ycding at coh.org>
Cc: r-help at r-project.org
Subject: Re: [R] my R code worked well when running the first 1000 lines of R code

I sometimes think people on this list are quite rude to posters. I'm afraid I'm likely to join in with some rudeness? 1. "Here is some code that works but also doesn't" is probably not going to get you an answer 2. I provide


I sometimes think people on this list are quite rude to posters.

I'm afraid I'm likely to join in with some rudeness?

1. "Here is some code that works but also doesn't" is probably not going to get you an answer
2. I provide no information about the data it works on or doesn't
3. I tell you I'm using a load of dependencies, but don't tell you what
4. I refer to 2000 lines of code but probably means 2000 lines of data?

So. Please post a question someone can actually answer.

If the question is "why might code fail on a 2000 line dataset when it works on 1000 line dataset" then here are some thoughts:

* Is the 1000 lines being run as dataset[1:1000,] or is it dataset1 and dataset2 ?
* Is there a structural difference in the datasets - i.e. numbers, characters or factors as columns. Often import functions guess a column type by reading the first 500/1000 lines. If the data has numbers in column 1 for 1-1000 but on line 1999 has a letter... The data type may vary.

On Wed, 12 Jun 2024, 17:28 Yuan Chun Ding via R-help, <r-help at r-project.org<mailto:r-help at r-project.org>> wrote:
Hi R users,

The following code worked well to summarize four data groups in a dataframe for three variables (t_depth, t_alt_count, t_alt_ratio), 12 columns of summary, see attached.
However, after running another 2000 lines of R codes using functions from more than 10 other R  libraries, then it only generated one column of summary.
Do you know why?

Thank you,

Yuan Chun Ding

summary_anno1148ft <- anno1148ft %>%
  pivot_longer(c(t_depth, t_alt_count, t_alt_ratio), names_to = "measure") %>%
  group_by(dat, measure) %>%
  summarize(minimum = min(value,na.rm=T),
            q25 = quantile(value, probs = 0.25,na.rm=T),
            med = median(value,na.rm=T),
            q75 = quantile(value, probs = 0.75,na.rm=T),
            maximum = max(value,na.rm=T),
            average = mean(value,na.rm=T),
            #standard_deviation = sd(value),
            .groups = "drop"
  )
summary_anno1148ft <-t(summary_anno1148ft)



----------------------------------------------------------------------
------------------------------------------------------------
-SECURITY/CONFIDENTIALITY WARNING-

This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to receive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)
------------------------------------------------------------
______________________________________________
R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!p3fE1cCl7_IxAOT0Fvr1vPWF3xDeYl1FCDaqXi4Z6HH7tOMmDULawS8DAa7XcG5s5PrfqmeMC0XA$>
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html<https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!p3fE1cCl7_IxAOT0Fvr1vPWF3xDeYl1FCDaqXi4Z6HH7tOMmDULawS8DAa7XcG5s5Prfqhxs3su7$>
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Jun 12 20:29:19 2024
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 12 Jun 2024 19:29:19 +0100
Subject: [R] 
 my R code worked well when running the first 1000 lines of R code
In-Reply-To: <MN2PR02MB6911C2E5109A13CF47B39B7AD4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
References: <MN2PR02MB6911CD6439B0FAA8614FD204D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
 <MN2PR02MB691189F9B5F75D42B81E2162D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CA+etgPmKDa9Fn9DFVHmJyEBMiFF9JnkM27y1pwAvQ8N+nLEkTw@mail.gmail.com>
 <MN2PR02MB6911C2E5109A13CF47B39B7AD4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
Message-ID: <a546c235-40f0-423a-b31e-35189ac3436a@sapo.pt>

Hello,

Inline.

?s 19:03 de 12/06/2024, Yuan Chun Ding via R-help escreveu:
> I am sorry that I know I should provide a dataset that allows to replicate my problem.
> 
> It is a research dataset and quite large, so I can not share.
> 
> Both Bert and Tim guessed my problem correctly.  I also thought about the conflicting issue between different packages and function masking.
> I just hope to that someone has similar experience, so providing me suggestion.
> 
> For conflicting issue,
> 
> What I tried  was to add dplyr::pivot_longer or tidyr:: pivot_longer, 


Do that to all functions comming from contributed packages. At least to 
those.


summary_anno1148ft <- anno1148ft %>%
   tidyr::pivot_longer(c(t_depth, t_alt_count, t_alt_ratio), names_to = 
"measure") %>%
   dplyr::group_by(dat, measure) %>%
   dplyr::summarize(minimum = min(value,na.rm=T),
                    q25 = quantile(value, probs = 0.25,na.rm=T),
                    med = median(value,na.rm=T),
                    q75 = quantile(value, probs = 0.75,na.rm=T),
                    maximum = max(value,na.rm=T),
                    average = mean(value,na.rm=T),
                    #standard_deviation = sd(value),
                    .groups = "drop"
   )


Or, simpler, no need to group_by anymore. It can be done in summarise.


summary_anno1148ft <- anno1148ft %>%
   tidyr::pivot_longer(c(t_depth, t_alt_count, t_alt_ratio), names_to = 
"measure") %>%
   dplyr::summarize(minimum = min(value,na.rm=T),
                    q25 = quantile(value, probs = 0.25,na.rm=T),
                    med = median(value,na.rm=T),
                    q75 = quantile(value, probs = 0.75,na.rm=T),
                    maximum = max(value,na.rm=T),
                    average = mean(value,na.rm=T),
                    #standard_deviation = sd(value),
                    .by = c(dat, measure),
                    .groups = "drop"
   )



This is only a guess, the question cannot really be answered.


Hope this helps,

Rui Barradas

but still not resolved the problem.
> 
> 
> 
> I will restart from the first line my code, it will work again and then I will track down.
> 
> 
> 
> Thank you,
> 
> Ding
> 
> 
> From: CALUM POLWART <polc1410 at gmail.com>
> Sent: Wednesday, June 12, 2024 10:52 AM
> To: Yuan Chun Ding <ycding at coh.org>
> Cc: r-help at r-project.org
> Subject: Re: [R] my R code worked well when running the first 1000 lines of R code
> 
> I sometimes think people on this list are quite rude to posters. I'm afraid I'm likely to join in with some rudeness? 1. "Here is some code that works but also doesn't" is probably not going to get you an answer 2. I provide
> 
> 
> I sometimes think people on this list are quite rude to posters.
> 
> I'm afraid I'm likely to join in with some rudeness?
> 
> 1. "Here is some code that works but also doesn't" is probably not going to get you an answer
> 2. I provide no information about the data it works on or doesn't
> 3. I tell you I'm using a load of dependencies, but don't tell you what
> 4. I refer to 2000 lines of code but probably means 2000 lines of data?
> 
> So. Please post a question someone can actually answer.
> 
> If the question is "why might code fail on a 2000 line dataset when it works on 1000 line dataset" then here are some thoughts:
> 
> * Is the 1000 lines being run as dataset[1:1000,] or is it dataset1 and dataset2 ?
> * Is there a structural difference in the datasets - i.e. numbers, characters or factors as columns. Often import functions guess a column type by reading the first 500/1000 lines. If the data has numbers in column 1 for 1-1000 but on line 1999 has a letter... The data type may vary.
> 
> On Wed, 12 Jun 2024, 17:28 Yuan Chun Ding via R-help, <r-help at r-project.org<mailto:r-help at r-project.org>> wrote:
> Hi R users,
> 
> The following code worked well to summarize four data groups in a dataframe for three variables (t_depth, t_alt_count, t_alt_ratio), 12 columns of summary, see attached.
> However, after running another 2000 lines of R codes using functions from more than 10 other R  libraries, then it only generated one column of summary.
> Do you know why?
> 
> Thank you,
> 
> Yuan Chun Ding
> 
> summary_anno1148ft <- anno1148ft %>%
>    pivot_longer(c(t_depth, t_alt_count, t_alt_ratio), names_to = "measure") %>%
>    group_by(dat, measure) %>%
>    summarize(minimum = min(value,na.rm=T),
>              q25 = quantile(value, probs = 0.25,na.rm=T),
>              med = median(value,na.rm=T),
>              q75 = quantile(value, probs = 0.75,na.rm=T),
>              maximum = max(value,na.rm=T),
>              average = mean(value,na.rm=T),
>              #standard_deviation = sd(value),
>              .groups = "drop"
>    )
> summary_anno1148ft <-t(summary_anno1148ft)
> 
> 
> 
> ----------------------------------------------------------------------
> ------------------------------------------------------------
> -SECURITY/CONFIDENTIALITY WARNING-
> 
> This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to rec
>   eive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)
> ------------------------------------------------------------
> ______________________________________________
> R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!p3fE1cCl7_IxAOT0Fvr1vPWF3xDeYl1FCDaqXi4Z6HH7tOMmDULawS8DAa7XcG5s5PrfqmeMC0XA$>
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html<https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!p3fE1cCl7_IxAOT0Fvr1vPWF3xDeYl1FCDaqXi4Z6HH7tOMmDULawS8DAa7XcG5s5Prfqhxs3su7$>
> and provide commented, minimal, self-contained, reproducible code.
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.
www.avg.com

From ycd|ng @end|ng |rom coh@org  Wed Jun 12 21:44:42 2024
From: ycd|ng @end|ng |rom coh@org (Yuan Chun Ding)
Date: Wed, 12 Jun 2024 19:44:42 +0000
Subject: [R] 
 my R code worked well when running the first 1000 lines of R code
In-Reply-To: <a546c235-40f0-423a-b31e-35189ac3436a@sapo.pt>
References: <MN2PR02MB6911CD6439B0FAA8614FD204D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
 <MN2PR02MB691189F9B5F75D42B81E2162D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CA+etgPmKDa9Fn9DFVHmJyEBMiFF9JnkM27y1pwAvQ8N+nLEkTw@mail.gmail.com>
 <MN2PR02MB6911C2E5109A13CF47B39B7AD4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
 <a546c235-40f0-423a-b31e-35189ac3436a@sapo.pt>
Message-ID: <MN2PR02MB6911011387ED3D5FEFE1FA40D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>

Hi Rui,

Thank you very much!


Yes, I verified using real data, it worked correctly as expected after adding tidyr:: to the pivot_longer function and dplyr:: to the group_by and summarize
Function.

I did not know how to assign the tidyr and dplyr to the three functions because I do not really understand well the three functions and just got the code from a google search.

I also tried your simplified code, but got the following error
Error in `dplyr::summarize()`:
! Can't supply both `.by` and `.groups`.
Run `rlang::last_trace()` to see where the error occurred.

Ding

From: Rui Barradas <ruipbarradas at sapo.pt>
Sent: Wednesday, June 12, 2024 11:29 AM
To: Yuan Chun Ding <ycding at coh.org>; CALUM POLWART <polc1410 at gmail.com>
Cc: r-help at r-project.org
Subject: Re: [R] my R code worked well when running the first 1000 lines of R code

Hello, Inline. ?s 19:?03 de 12/06/2024, Yuan Chun Ding via R-help escreveu: > I am sorry that I know I should provide a dataset that allows to replicate my problem. > > It is a research dataset and quite large, so I can not share. >


Hello,



Inline.



?s 19:03 de 12/06/2024, Yuan Chun Ding via R-help escreveu:

> I am sorry that I know I should provide a dataset that allows to replicate my problem.

>

> It is a research dataset and quite large, so I can not share.

>

> Both Bert and Tim guessed my problem correctly.  I also thought about the conflicting issue between different packages and function masking.

> I just hope to that someone has similar experience, so providing me suggestion.

>

> For conflicting issue,

>

> What I tried  was to add dplyr::pivot_longer or tidyr:: pivot_longer,





Do that to all functions comming from contributed packages. At least to

those.





summary_anno1148ft <- anno1148ft %>%

   tidyr::pivot_longer(c(t_depth, t_alt_count, t_alt_ratio), names_to =

"measure") %>%

   dplyr::group_by(dat, measure) %>%

   dplyr::summarize(minimum = min(value,na.rm=T),

                    q25 = quantile(value, probs = 0.25,na.rm=T),

                    med = median(value,na.rm=T),

                    q75 = quantile(value, probs = 0.75,na.rm=T),

                    maximum = max(value,na.rm=T),

                    average = mean(value,na.rm=T),

                    #standard_deviation = sd(value),

                    .groups = "drop"

   )





Or, simpler, no need to group_by anymore. It can be done in summarise.





summary_anno1148ft <- anno1148ft %>%

   tidyr::pivot_longer(c(t_depth, t_alt_count, t_alt_ratio), names_to =

"measure") %>%

   dplyr::summarize(minimum = min(value,na.rm=T),

                    q25 = quantile(value, probs = 0.25,na.rm=T),

                    med = median(value,na.rm=T),

                    q75 = quantile(value, probs = 0.75,na.rm=T),

                    maximum = max(value,na.rm=T),

                    average = mean(value,na.rm=T),

                    #standard_deviation = sd(value),

                    .by = c(dat, measure),

                    .groups = "drop"

   )







This is only a guess, the question cannot really be answered.





Hope this helps,



Rui Barradas



but still not resolved the problem.

>

>

>

> I will restart from the first line my code, it will work again and then I will track down.

>

>

>

> Thank you,

>

> Ding

>

>

> From: CALUM POLWART <polc1410 at gmail.com<mailto:polc1410 at gmail.com>>

> Sent: Wednesday, June 12, 2024 10:52 AM

> To: Yuan Chun Ding <ycding at coh.org<mailto:ycding at coh.org>>

> Cc: r-help at r-project.org<mailto:r-help at r-project.org>

> Subject: Re: [R] my R code worked well when running the first 1000 lines of R code

>

> I sometimes think people on this list are quite rude to posters. I'm afraid I'm likely to join in with some rudeness? 1. "Here is some code that works but also doesn't" is probably not going to get you an answer 2. I provide

>

>

> I sometimes think people on this list are quite rude to posters.

>

> I'm afraid I'm likely to join in with some rudeness?

>

> 1. "Here is some code that works but also doesn't" is probably not going to get you an answer

> 2. I provide no information about the data it works on or doesn't

> 3. I tell you I'm using a load of dependencies, but don't tell you what

> 4. I refer to 2000 lines of code but probably means 2000 lines of data?

>

> So. Please post a question someone can actually answer.

>

> If the question is "why might code fail on a 2000 line dataset when it works on 1000 line dataset" then here are some thoughts:

>

> * Is the 1000 lines being run as dataset[1:1000,] or is it dataset1 and dataset2 ?

> * Is there a structural difference in the datasets - i.e. numbers, characters or factors as columns. Often import functions guess a column type by reading the first 500/1000 lines. If the data has numbers in column 1 for 1-1000 but on line 1999 has a letter... The data type may vary.

>

> On Wed, 12 Jun 2024, 17:28 Yuan Chun Ding via R-help, <r-help at r-project.org<mailto:r-help at r-project.org<mailto:r-help at r-project.org%3cmailto:r-help at r-project.org>>> wrote:

> Hi R users,

>

> The following code worked well to summarize four data groups in a dataframe for three variables (t_depth, t_alt_count, t_alt_ratio), 12 columns of summary, see attached.

> However, after running another 2000 lines of R codes using functions from more than 10 other R  libraries, then it only generated one column of summary.

> Do you know why?

>

> Thank you,

>

> Yuan Chun Ding

>

> summary_anno1148ft <- anno1148ft %>%

>    pivot_longer(c(t_depth, t_alt_count, t_alt_ratio), names_to = "measure") %>%

>    group_by(dat, measure) %>%

>    summarize(minimum = min(value,na.rm=T),

>              q25 = quantile(value, probs = 0.25,na.rm=T),

>              med = median(value,na.rm=T),

>              q75 = quantile(value, probs = 0.75,na.rm=T),

>              maximum = max(value,na.rm=T),

>              average = mean(value,na.rm=T),

>              #standard_deviation = sd(value),

>              .groups = "drop"

>    )

> summary_anno1148ft <-t(summary_anno1148ft)

>

>

>

> ----------------------------------------------------------------------

> ------------------------------------------------------------

> -SECURITY/CONFIDENTIALITY WARNING-

>

> This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to rec

>   eive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)

> ------------------------------------------------------------

> ______________________________________________

> R-help at r-project.org<mailto:R-help at r-project.org<mailto:R-help at r-project.org%3cmailto:R-help at r-project.org>> mailing list -- To UNSUBSCRIBE and more, see

> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96oo-fbT4$<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96oo-fbT4$><https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!p3fE1cCl7_IxAOT0Fvr1vPWF3xDeYl1FCDaqXi4Z6HH7tOMmDULawS8DAa7XcG5s5PrfqmeMC0XA$><https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!p3fE1cCl7_IxAOT0Fvr1vPWF3xDeYl1FCDaqXi4Z6HH7tOMmDULawS8DAa7XcG5s5PrfqmeMC0XA$%3e%3e>

><https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!p3fE1cCl7_IxAOT0Fvr1vPWF3xDeYl1FCDaqXi4Z6HH7tOMmDULawS8DAa7XcG5s5PrfqmeMC0XA$%3e%3e>PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96vULyBu0$<https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96vULyBu0$><https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!p3fE1cCl7_IxAOT0Fvr1vPWF3xDeYl1FCDaqXi4Z6HH7tOMmDULawS8DAa7XcG5s5Prfqhxs3su7$><https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!p3fE1cCl7_IxAOT0Fvr1vPWF3xDeYl1FCDaqXi4Z6HH7tOMmDULawS8DAa7XcG5s5Prfqhxs3su7$%3e%3e>

><https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!p3fE1cCl7_IxAOT0Fvr1vPWF3xDeYl1FCDaqXi4Z6HH7tOMmDULawS8DAa7XcG5s5Prfqhxs3su7$%3e%3e>and provide commented, minimal, self-contained, reproducible code.

>

>             [[alternative HTML version deleted]]

>

> ______________________________________________

> R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see

> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96oo-fbT4$<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96oo-fbT4$>

> PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96vULyBu0$<https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96vULyBu0$>

> and provide commented, minimal, self-contained, reproducible code.







--

Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.

https://urldefense.com/v3/__http://www.avg.com__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96HZLrJxM$<https://urldefense.com/v3/__http:/www.avg.com__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96HZLrJxM$>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Jun 12 23:05:28 2024
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 12 Jun 2024 22:05:28 +0100
Subject: [R] 
 my R code worked well when running the first 1000 lines of R code
In-Reply-To: <MN2PR02MB6911011387ED3D5FEFE1FA40D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
References: <MN2PR02MB6911CD6439B0FAA8614FD204D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
 <MN2PR02MB691189F9B5F75D42B81E2162D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
 <CA+etgPmKDa9Fn9DFVHmJyEBMiFF9JnkM27y1pwAvQ8N+nLEkTw@mail.gmail.com>
 <MN2PR02MB6911C2E5109A13CF47B39B7AD4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
 <a546c235-40f0-423a-b31e-35189ac3436a@sapo.pt>
 <MN2PR02MB6911011387ED3D5FEFE1FA40D4C02@MN2PR02MB6911.namprd02.prod.outlook.com>
Message-ID: <3c450436-237c-44b7-ae8f-b6a21dead3b6@sapo.pt>

?s 20:44 de 12/06/2024, Yuan Chun Ding escreveu:
> Hi Rui,
> 
> Thank you very much!
> 
> 
> Yes, I verified using real data, it worked correctly as expected after adding tidyr:: to the pivot_longer function and dplyr:: to the group_by and summarize
> Function.
> 
> I did not know how to assign the tidyr and dplyr to the three functions because I do not really understand well the three functions and just got the code from a google search.
> 
> I also tried your simplified code, but got the following error
> Error in `dplyr::summarize()`:
> ! Can't supply both `.by` and `.groups`.
> Run `rlang::last_trace()` to see where the error occurred.
> 
> Ding
> 
> From: Rui Barradas <ruipbarradas at sapo.pt>
> Sent: Wednesday, June 12, 2024 11:29 AM
> To: Yuan Chun Ding <ycding at coh.org>; CALUM POLWART <polc1410 at gmail.com>
> Cc: r-help at r-project.org
> Subject: Re: [R] my R code worked well when running the first 1000 lines of R code
> 
> Hello, Inline. ?s 19:?03 de 12/06/2024, Yuan Chun Ding via R-help escreveu: > I am sorry that I know I should provide a dataset that allows to replicate my problem. > > It is a research dataset and quite large, so I can not share. >
> 
> 
> Hello,
> 
> 
> 
> Inline.
> 
> 
> 
> ?s 19:03 de 12/06/2024, Yuan Chun Ding via R-help escreveu:
> 
>> I am sorry that I know I should provide a dataset that allows to replicate my problem.
> 
>>
> 
>> It is a research dataset and quite large, so I can not share.
> 
>>
> 
>> Both Bert and Tim guessed my problem correctly.  I also thought about the conflicting issue between different packages and function masking.
> 
>> I just hope to that someone has similar experience, so providing me suggestion.
> 
>>
> 
>> For conflicting issue,
> 
>>
> 
>> What I tried  was to add dplyr::pivot_longer or tidyr:: pivot_longer,
> 
> 
> 
> 
> 
> Do that to all functions comming from contributed packages. At least to
> 
> those.
> 
> 
> 
> 
> 
> summary_anno1148ft <- anno1148ft %>%
> 
>     tidyr::pivot_longer(c(t_depth, t_alt_count, t_alt_ratio), names_to =
> 
> "measure") %>%
> 
>     dplyr::group_by(dat, measure) %>%
> 
>     dplyr::summarize(minimum = min(value,na.rm=T),
> 
>                      q25 = quantile(value, probs = 0.25,na.rm=T),
> 
>                      med = median(value,na.rm=T),
> 
>                      q75 = quantile(value, probs = 0.75,na.rm=T),
> 
>                      maximum = max(value,na.rm=T),
> 
>                      average = mean(value,na.rm=T),
> 
>                      #standard_deviation = sd(value),
> 
>                      .groups = "drop"
> 
>     )
> 
> 
> 
> 
> 
> Or, simpler, no need to group_by anymore. It can be done in summarise.
> 
> 
> 
> 
> 
> summary_anno1148ft <- anno1148ft %>%
> 
>     tidyr::pivot_longer(c(t_depth, t_alt_count, t_alt_ratio), names_to =
> 
> "measure") %>%
> 
>     dplyr::summarize(minimum = min(value,na.rm=T),
> 
>                      q25 = quantile(value, probs = 0.25,na.rm=T),
> 
>                      med = median(value,na.rm=T),
> 
>                      q75 = quantile(value, probs = 0.75,na.rm=T),
> 
>                      maximum = max(value,na.rm=T),
> 
>                      average = mean(value,na.rm=T),
> 
>                      #standard_deviation = sd(value),
> 
>                      .by = c(dat, measure),
> 
>                      .groups = "drop"
> 
>     )
> 
> 
> 
> 
> 
> 
> 
> This is only a guess, the question cannot really be answered.
> 
> 
> 
> 
> 
> Hope this helps,
> 
> 
> 
> Rui Barradas
> 
> 
> 
> but still not resolved the problem.
> 
>>
> 
>>
> 
>>
> 
>> I will restart from the first line my code, it will work again and then I will track down.
> 
>>
> 
>>
> 
>>
> 
>> Thank you,
> 
>>
> 
>> Ding
> 
>>
> 
>>
> 
>> From: CALUM POLWART <polc1410 at gmail.com<mailto:polc1410 at gmail.com>>
> 
>> Sent: Wednesday, June 12, 2024 10:52 AM
> 
>> To: Yuan Chun Ding <ycding at coh.org<mailto:ycding at coh.org>>
> 
>> Cc: r-help at r-project.org<mailto:r-help at r-project.org>
> 
>> Subject: Re: [R] my R code worked well when running the first 1000 lines of R code
> 
>>
> 
>> I sometimes think people on this list are quite rude to posters. I'm afraid I'm likely to join in with some rudeness? 1. "Here is some code that works but also doesn't" is probably not going to get you an answer 2. I provide
> 
>>
> 
>>
> 
>> I sometimes think people on this list are quite rude to posters.
> 
>>
> 
>> I'm afraid I'm likely to join in with some rudeness?
> 
>>
> 
>> 1. "Here is some code that works but also doesn't" is probably not going to get you an answer
> 
>> 2. I provide no information about the data it works on or doesn't
> 
>> 3. I tell you I'm using a load of dependencies, but don't tell you what
> 
>> 4. I refer to 2000 lines of code but probably means 2000 lines of data?
> 
>>
> 
>> So. Please post a question someone can actually answer.
> 
>>
> 
>> If the question is "why might code fail on a 2000 line dataset when it works on 1000 line dataset" then here are some thoughts:
> 
>>
> 
>> * Is the 1000 lines being run as dataset[1:1000,] or is it dataset1 and dataset2 ?
> 
>> * Is there a structural difference in the datasets - i.e. numbers, characters or factors as columns. Often import functions guess a column type by reading the first 500/1000 lines. If the data has numbers in column 1 for 1-1000 but on line 1999 has a letter... The data type may vary.
> 
>>
> 
>> On Wed, 12 Jun 2024, 17:28 Yuan Chun Ding via R-help, <r-help at r-project.org<mailto:r-help at r-project.org<mailto:r-help at r-project.org%3cmailto:r-help at r-project.org>>> wrote:
> 
>> Hi R users,
> 
>>
> 
>> The following code worked well to summarize four data groups in a dataframe for three variables (t_depth, t_alt_count, t_alt_ratio), 12 columns of summary, see attached.
> 
>> However, after running another 2000 lines of R codes using functions from more than 10 other R  libraries, then it only generated one column of summary.
> 
>> Do you know why?
> 
>>
> 
>> Thank you,
> 
>>
> 
>> Yuan Chun Ding
> 
>>
> 
>> summary_anno1148ft <- anno1148ft %>%
> 
>>     pivot_longer(c(t_depth, t_alt_count, t_alt_ratio), names_to = "measure") %>%
> 
>>     group_by(dat, measure) %>%
> 
>>     summarize(minimum = min(value,na.rm=T),
> 
>>               q25 = quantile(value, probs = 0.25,na.rm=T),
> 
>>               med = median(value,na.rm=T),
> 
>>               q75 = quantile(value, probs = 0.75,na.rm=T),
> 
>>               maximum = max(value,na.rm=T),
> 
>>               average = mean(value,na.rm=T),
> 
>>               #standard_deviation = sd(value),
> 
>>               .groups = "drop"
> 
>>     )
> 
>> summary_anno1148ft <-t(summary_anno1148ft)
> 
>>
> 
>>
> 
>>
> 
>> ----------------------------------------------------------------------
> 
>> ------------------------------------------------------------
> 
>> -SECURITY/CONFIDENTIALITY WARNING-
> 
>>
> 
>> This message and any attachments are intended solely for the individual or entity to which they are addressed. This communication may contain information that is privileged, confidential, or exempt from disclosure under applicable law (e.g., personal health information, research data, financial information). Because this e-mail has been sent without encryption, individuals other than the intended recipient may be able to view the information, forward it to others or tamper with the information without the knowledge or consent of the sender. If you are not the intended recipient, or the employee or person responsible for delivering the message to the intended recipient, any dissemination, distribution or copying of the communication is strictly prohibited. If you received the communication in error, please notify the sender immediately by replying to this message and deleting the message and any accompanying files from your system. If, due to the security risks, you do not wish to rec
> 
>>    eive further communications via e-mail, please reply to this message and inform the sender that you do not wish to receive further e-mail from the sender. (LCP301)
> 
>> ------------------------------------------------------------
> 
>> ______________________________________________
> 
>> R-help at r-project.org<mailto:R-help at r-project.org<mailto:R-help at r-project.org%3cmailto:R-help at r-project.org>> mailing list -- To UNSUBSCRIBE and more, see
> 
>> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96oo-fbT4$<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96oo-fbT4$><https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!p3fE1cCl7_IxAOT0Fvr1vPWF3xDeYl1FCDaqXi4Z6HH7tOMmDULawS8DAa7XcG5s5PrfqmeMC0XA$><https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!p3fE1cCl7_IxAOT0Fvr1vPWF3xDeYl1FCDaqXi4Z6HH7tOMmDULawS8DAa7XcG5s5PrfqmeMC0XA$%3e%3e>
> 
>> <https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!p3fE1cCl7_IxAOT0Fvr1vPWF3xDeYl1FCDaqXi4Z6HH7tOMmDULawS8DAa7XcG5s5PrfqmeMC0XA$%3e%3e>PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96vULyBu0$<https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96vULyBu0$><https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!p3fE1cCl7_IxAOT0Fvr1vPWF3xDeYl1FCDaqXi4Z6HH7tOMmDULawS8DAa7XcG5s5Prfqhxs3su7$><https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!p3fE1cCl7_IxAOT0Fvr1vPWF3xDeYl1FCDaqXi4Z6HH7tOMmDULawS8DAa7XcG5s5Prfqhxs3su7$%3e%3e>
> 
>> <https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!p3fE1cCl7_IxAOT0Fvr1vPWF3xDeYl1FCDaqXi4Z6HH7tOMmDULawS8DAa7XcG5s5Prfqhxs3su7$%3e%3e>and provide commented, minimal, self-contained, reproducible code.
> 
>>
> 
>>              [[alternative HTML version deleted]]
> 
>>
> 
>> ______________________________________________
> 
>> R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
> 
>> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96oo-fbT4$<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-help__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96oo-fbT4$>
> 
>> PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96vULyBu0$<https://urldefense.com/v3/__http:/www.R-project.org/posting-guide.html__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96vULyBu0$>
> 
>> and provide commented, minimal, self-contained, reproducible code.
> 
> 
> 
> 
> 
> 
> 
> --
> 
> Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.
> 
> https://urldefense.com/v3/__http://www.avg.com__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96HZLrJxM$<https://urldefense.com/v3/__http:/www.avg.com__;!!Fou38LsQmgU!qBSbNdG-bXB3-5NwyJJVkk858HEh8_gmTcZHf_3vfKCIqyMknkkQfhlzNv_fE08UMpxyjkKoih96HZLrJxM$>
> 
Hello,

Remove .groups from summarise and it should work, .groups is only needed 
if you group the data with group_by, not used in the 2nd example.

Hope this helps,

Rui Barradas


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed Jun 12 12:14:23 2024
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 12 Jun 2024 03:14:23 -0700
Subject: [R] Integration of functions with a vector argument
In-Reply-To: <PH0PR22MB2860E3ABD206953D15F31EFAC5C72@PH0PR22MB2860.namprd22.prod.outlook.com>
References: <PH0PR22MB2860E3ABD206953D15F31EFAC5C72@PH0PR22MB2860.namprd22.prod.outlook.com>
Message-ID: <483F442F-5229-4645-883D-15A796F83FC6@dcn.davis.ca.us>

How do you integrate perpendicular to a plane if you don't have a concept of 3d? In that direction the plane is just a point.

Vectors in R do not have any concept of "n by 1"... they are like a string of beads. When you take a column out of a matrix `a` using indexing b <- a[,j] the resulting vector can only be indexed along its length as b[i]. Such a vector is indistinguishable in structure from a[i,] which originated from a row.

So I would say you are tilting at windmills. If you want you can write a[, j, drop=FALSE] to end up with an n by 1 matrix... but that is not a vector, it is a matrix. I have reservations about the value of "integrating out" along a row in an n by 1 matrix... seems like a degenerate case and you would be better off not creating the n by 1 matrix in the first place. But then I left Matlab behind a long time ago.


On June 11, 2024 11:44:08 AM PDT, "Levine, Michael" <mlevins at purdue.edu> wrote:
>Hello all,
>
>I have a question concerning integration of a function of a multivariate argument with respect to one or more variables in r.  Let us say we have a function
>
>F <- function(x){ body of the function}
>
>Where x is, in general, a d by 1 vector with d>1.  Now I want to integrate out some of the coordinates of x, e.g. x[1] or x[2] or both of them etc. I'm well aware of how to integrate out e.g. y if a function is defined as f <- function (x,y) {body of the function} where y is a scalar.
>However, it seems to be quite difficult to do the same if the function is defined with a vector argument x. At the very least, I haven't seen any good examples of this being done.
>Any suggestions?
>
>Yours sincerely,
>Michael
>
>Michael Levine
>Associate Professor, Statistics
>
>Department of Statistics
>Purdue University
>250 North University Street
>West Lafayette, IN 47907 USA
>
>email: mlevins at purdue.edu
>Phone: +1-765-496-7571
>Fax:   +1-765-494-0558
>URL:   www.stat.purdue.edu/~mlevins
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From |kry|ov @end|ng |rom d|@root@org  Thu Jun 13 12:21:21 2024
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Thu, 13 Jun 2024 13:21:21 +0300
Subject: [R] Integration of functions with a vector argument
In-Reply-To: <PH0PR22MB28605CCF2898AD2EC336DCCBC5C02@PH0PR22MB2860.namprd22.prod.outlook.com>
References: <PH0PR22MB2860E3ABD206953D15F31EFAC5C72@PH0PR22MB2860.namprd22.prod.outlook.com>
 <20240612134119.72e4cab6@Tarkus>
 <PH0PR22MB28605CCF2898AD2EC336DCCBC5C02@PH0PR22MB2860.namprd22.prod.outlook.com>
Message-ID: <20240613132121.1847edee@arachnoid>

? Wed, 12 Jun 2024 23:42:18 +0000
"Levine, Michael" <mlevins at purdue.edu> ?????:

> f.int1 <- function(x,y) {Vectorize (function(y) f(c(x,y),H=H,j=j))}

Vectorize returns a callable function(y), so wrapping it in a
function(x,y) will not work. Since you'd like to integrate over y, we
can perform the same transformation manually using vapply:

# A version of f(...) that can be integrated over y
f.int1 <- function(y, x, H, j)
 vapply(y, function(y) f(c(x,y), H = H, j = j), numeric(1))

The same transformation can be performed using Vectorize as follows:

f.int1 <- Vectorize(
 function(y, x, H, j) f(c(x,y), H = H, j = j),
 vectorize.args = 'y'
)

>     mrg.d1 <- function(x){
>     integrate(f.int1,lower=-3,upper=3)$value
>     }

We can then integrate f.int1 over y, making sure to pass the remaining
scalar parameters to the function:

# mrg.d1(x, H, j) = ? f(y,x,H,j) dy from -3 to 3
mrg.d1 <- function(x, H, j)
 integrate(f.int1, lower=-3, upper=3, x = x, H = H, j = j)$value

> mrg.cdf1 <- function(x){
>     integrate(mrg.d1,lower=-Inf,upper=x)$value
>     }

Unfortunately, mrg.d1 is once again not vectorised and may give wrong
answers or raise exceptions with non-scalar x. We can now perform the
same transformation so that the function would work with integrate():

# Version of mrg.d1 integratable over x
mrg.d1.int <- function(x, H, j)
 vapply(x, mrg.d1, numeric(1), H = H, j = j)

Here, instead of having to combine arguments like in f.int1, we can
just use vapply() to call the original mrg.d1 for every scalar element
inside the vector x given to mrg.d1.int. Alternatively,

mrg.d1.int <- Vectorize(mrg.d1, 'x')

A vectorised function can then be integrated:

# mrg.cdf1(x, H, j) = ? mrg.d1(x', H, j) dx' from -? to x
mrg.cdf1 <- function(x, H, j)
 integrate(mrg.d1.int, lower=-Inf, upper=x, H = H, j = j)$value

This double nested loop (produced by Vectorize() and mapply() or
manually with vapply()) may be not very fast. If you rewrite your
function f to accept matrices containing values of (x, y) for many
evaluations of the function and to return vectors of the resulting
values, you'll be able to use the CRAN package 'cubature'
<https://CRAN.R-project.org/package=cubature> to integrate it over
multiple variables at once.

-- 
Best regards,
Ivan


From m|ev|n@ @end|ng |rom purdue@edu  Thu Jun 13 01:42:18 2024
From: m|ev|n@ @end|ng |rom purdue@edu (Levine, Michael)
Date: Wed, 12 Jun 2024 23:42:18 +0000
Subject: [R] Integration of functions with a vector argument
In-Reply-To: <20240612134119.72e4cab6@Tarkus>
References: <PH0PR22MB2860E3ABD206953D15F31EFAC5C72@PH0PR22MB2860.namprd22.prod.outlook.com>
 <20240612134119.72e4cab6@Tarkus>
Message-ID: <PH0PR22MB28605CCF2898AD2EC336DCCBC5C02@PH0PR22MB2860.namprd22.prod.outlook.com>

Dear Ivan,

Thank you very much for your suggestions. I understand what you are saying. I am afraid I didn't explain well enough what was needed, however.  Let us again restrict ourselves to the case of two dimensions. Then, what I have is a bivariate density function f(x,y) and my intention is to obtain f(x) by integrating out y. However, I don't only need to know the value of the marginal density f(x) at one point - I need to integrate it again to obtain the marginal cumulative density function F(x) as a next step. Thus, I also need to pass x as an additional parameter before integration, and this is what makes the problem more difficult.

I tried to do the following (here H and j are additional arguments needed to obtain the estimated bivariate density function):

f.int1 <- function(x,y) {Vectorize (function(y) f(c(x,y),H=H,j=j))}
    mrg.d1 <- function(x){
    integrate(f.int1,lower=-3,upper=3)$value
    }
mrg.cdf1 <- function(x){
    integrate(mrg.d1,lower=-Inf,upper=x)$value
    }

I received the following error message:


Error in integrate(f.int1, lower = -3, upper = 3) :
  evaluation of function gave a result of wrong length


How would you go about performing this task?

Yours sincerely,
Michael

Michael Levine
Associate Professor, Statistics

Department of Statistics
Purdue University
250 North University Street
West Lafayette, IN 47907 USA

email: mlevins at purdue.edu
Phone: +1-765-496-7571
Fax:   +1-765-494-0558
URL:   www.stat.purdue.edu/~mlevins
________________________________
From: Ivan Krylov <ikrylov at disroot.org>
Sent: Wednesday, June 12, 2024 6:41 AM
To: Levine, Michael <mlevins at purdue.edu>
Cc: r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] Integration of functions with a vector argument

[You don't often get email from ikrylov at disroot.org. Learn why this is important at https://aka.ms/LearnAboutSenderIdentification ]

---- External Email: Use caution with attachments, links, or sharing data ----


? Tue, 11 Jun 2024 18:44:08 +0000
"Levine, Michael" <mlevins at purdue.edu> ?????:

> Let us say we have a function
>
> F <- function(x){ body of the function}
>
> Where x is, in general, a d by 1 vector with d>1.  Now I want to
> integrate out some of the coordinates of x, e.g. x[1] or x[2] or both
> of them etc. I'm well aware of how to integrate out e.g. y if a
> function is defined as f <- function (x,y) {body of the function}
> where y is a scalar.

The reason integrate() wants a separate function argument for the
integration coordinate is so that it could give the function a vector
of different values of the variable and receive a vector of the same
length containing the corresponding values of the function.

If the problem is small enough to make performance considerations
irrelevant, you can use Vectorize to make a function compatible with
integrate() from your function F:

x <- x0
z <- z0
Fiy <- Vectorize(function(y) F(c(x, y, z)))
integrate(Fiy, ymin, ymax)

The resulting function Fiy will accept a vector of values for y and
translate it into multiple calls to F with a three-element vector
argument as it expects.

Achieving better performance will require rewriting the function F to
be "vectorised", i.e. to accept vectors for arguments and return a
vector of the same length.

--
Best regards,
Ivan

	[[alternative HTML version deleted]]


From |r@nce@c@@p@ncotto @end|ng |rom un|more@|t  Thu Jun 13 16:42:19 2024
From: |r@nce@c@@p@ncotto @end|ng |rom un|more@|t (Francesca PANCOTTO)
Date: Thu, 13 Jun 2024 16:42:19 +0200
Subject: [R] Create a numeric series in an efficient way
Message-ID: <CAMXoJ=+0go0uA1NKJ+0HaW5v7HcxsmGBJ8o0v=7RNJX_uHv3bA@mail.gmail.com>

Dear Contributors
I am trying to create a numeric series with repeated numbers, not difficult
task, but I do not seem to find an efficient way.

This is my solution

blocB <- c(rep(x = 1, times = 84), rep(x = 2, times = 84), rep(x = 3, times
= 84), rep(x = 4, times = 84), rep(x = 5, times = 84), rep(x = 6, times =
84), rep(x = 7, times = 84), rep(x = 8, times = 84), rep(x = 9, times =
84), rep(x = 10, times = 84), rep(x = 11, times = 84), rep(x = 12, times =
84), rep(x = 13, times = 84))

which works but it is super silly and I need to create different variables
similar to this, changing the value of the repetition, 84 in this case.
Thanks for any help.


F.

	[[alternative HTML version deleted]]


From |r@nce@c@@p@ncotto @end|ng |rom un|more@|t  Thu Jun 13 20:21:58 2024
From: |r@nce@c@@p@ncotto @end|ng |rom un|more@|t (Francesca PANCOTTO)
Date: Thu, 13 Jun 2024 20:21:58 +0200
Subject: [R] Create a numeric series in an efficient way
In-Reply-To: <CAMXoJ=+0go0uA1NKJ+0HaW5v7HcxsmGBJ8o0v=7RNJX_uHv3bA@mail.gmail.com>
References: <CAMXoJ=+0go0uA1NKJ+0HaW5v7HcxsmGBJ8o0v=7RNJX_uHv3bA@mail.gmail.com>
Message-ID: <CAMXoJ=JhO4gg900tNxcCVas7uWA7q3JZa2+rVJLv+kq-XavHYg@mail.gmail.com>

I apologize, I solved the problem, sorry for that.
f.



Il giorno gio 13 giu 2024 alle ore 16:42 Francesca PANCOTTO <
francesca.pancotto at unimore.it> ha scritto:

> Dear Contributors
> I am trying to create a numeric series with repeated numbers, not
> difficult task, but I do not seem to find an efficient way.
>
> This is my solution
>
> blocB <- c(rep(x = 1, times = 84), rep(x = 2, times = 84), rep(x = 3,
> times = 84), rep(x = 4, times = 84), rep(x = 5, times = 84), rep(x = 6,
> times = 84), rep(x = 7, times = 84), rep(x = 8, times = 84), rep(x = 9,
> times = 84), rep(x = 10, times = 84), rep(x = 11, times = 84), rep(x = 12,
> times = 84), rep(x = 13, times = 84))
>
> which works but it is super silly and I need to create different variables
> similar to this, changing the value of the repetition, 84 in this case.
> Thanks for any help.
>
>
> F.
>

	[[alternative HTML version deleted]]


From tebert @end|ng |rom u||@edu  Fri Jun 14 00:54:37 2024
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Thu, 13 Jun 2024 22:54:37 +0000
Subject: [R] Create a numeric series in an efficient way
In-Reply-To: <CAMXoJ=JhO4gg900tNxcCVas7uWA7q3JZa2+rVJLv+kq-XavHYg@mail.gmail.com>
References: <CAMXoJ=+0go0uA1NKJ+0HaW5v7HcxsmGBJ8o0v=7RNJX_uHv3bA@mail.gmail.com>
 <CAMXoJ=JhO4gg900tNxcCVas7uWA7q3JZa2+rVJLv+kq-XavHYg@mail.gmail.com>
Message-ID: <CH3PR22MB451402988381A3792FAD5073CFC12@CH3PR22MB4514.namprd22.prod.outlook.com>

Maybe this was your solution?

blocC <- c(rep(x=c(1:13), times=84))
blocC <- arrange(.data = data.frame(blocC), blocC)

The second line sorts, but that may not be needed depending on application. The object class is also different in the sorted solution.

Tim
-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Francesca PANCOTTO via R-help
Sent: Thursday, June 13, 2024 2:22 PM
To: r-help at r-project.org
Subject: Re: [R] Create a numeric series in an efficient way

[External Email]

I apologize, I solved the problem, sorry for that.
f.



Il giorno gio 13 giu 2024 alle ore 16:42 Francesca PANCOTTO < francesca.pancotto at unimore.it> ha scritto:

> Dear Contributors
> I am trying to create a numeric series with repeated numbers, not
> difficult task, but I do not seem to find an efficient way.
>
> This is my solution
>
> blocB <- c(rep(x = 1, times = 84), rep(x = 2, times = 84), rep(x = 3,
> times = 84), rep(x = 4, times = 84), rep(x = 5, times = 84), rep(x =
> 6, times = 84), rep(x = 7, times = 84), rep(x = 8, times = 84), rep(x
> = 9, times = 84), rep(x = 10, times = 84), rep(x = 11, times = 84),
> rep(x = 12, times = 84), rep(x = 13, times = 84))
>
> which works but it is super silly and I need to create different
> variables similar to this, changing the value of the repetition, 84 in this case.
> Thanks for any help.
>
>
> F.
>

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.r-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Fri Jun 14 03:13:00 2024
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 13 Jun 2024 18:13:00 -0700
Subject: [R] Create a numeric series in an efficient way
In-Reply-To: <CH3PR22MB451402988381A3792FAD5073CFC12@CH3PR22MB4514.namprd22.prod.outlook.com>
References: <CAMXoJ=+0go0uA1NKJ+0HaW5v7HcxsmGBJ8o0v=7RNJX_uHv3bA@mail.gmail.com>
 <CAMXoJ=JhO4gg900tNxcCVas7uWA7q3JZa2+rVJLv+kq-XavHYg@mail.gmail.com>
 <CH3PR22MB451402988381A3792FAD5073CFC12@CH3PR22MB4514.namprd22.prod.outlook.com>
Message-ID: <CAGxFJbTnA0n=s+YAwmQs1zcDRPJHqCRaEN0rgkt5WoXLb5-3wg@mail.gmail.com>

Nope. She would have wanted the 'each' argument = 84. See ?rep.

-- Bert



On Thu, Jun 13, 2024 at 3:54?PM Ebert,Timothy Aaron <tebert at ufl.edu> wrote:

> Maybe this was your solution?
>
> blocC <- c(rep(x=c(1:13), times=84))
> blocC <- arrange(.data = data.frame(blocC), blocC)
>
> The second line sorts, but that may not be needed depending on
> application. The object class is also different in the sorted solution.
>
> Tim
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Francesca
> PANCOTTO via R-help
> Sent: Thursday, June 13, 2024 2:22 PM
> To: r-help at r-project.org
> Subject: Re: [R] Create a numeric series in an efficient way
>
> [External Email]
>
> I apologize, I solved the problem, sorry for that.
> f.
>
>
>
> Il giorno gio 13 giu 2024 alle ore 16:42 Francesca PANCOTTO <
> francesca.pancotto at unimore.it> ha scritto:
>
> > Dear Contributors
> > I am trying to create a numeric series with repeated numbers, not
> > difficult task, but I do not seem to find an efficient way.
> >
> > This is my solution
> >
> > blocB <- c(rep(x = 1, times = 84), rep(x = 2, times = 84), rep(x = 3,
> > times = 84), rep(x = 4, times = 84), rep(x = 5, times = 84), rep(x =
> > 6, times = 84), rep(x = 7, times = 84), rep(x = 8, times = 84), rep(x
> > = 9, times = 84), rep(x = 10, times = 84), rep(x = 11, times = 84),
> > rep(x = 12, times = 84), rep(x = 13, times = 84))
> >
> > which works but it is super silly and I need to create different
> > variables similar to this, changing the value of the repetition, 84 in
> this case.
> > Thanks for any help.
> >
> >
> > F.
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.r-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


