From @v|@e@gro@@ @end|ng |rom gm@||@com  Sat Oct  1 01:01:28 2022
From: @v|@e@gro@@ @end|ng |rom gm@||@com (Avi Gross)
Date: Fri, 30 Sep 2022 19:01:28 -0400
Subject: [R] Reading very large text files into R
In-Reply-To: <BN6PR2201MB15533DA430761C7B4A46AD15CF569@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <CABxY9BMk+Y82OV8Rcaoe-r+GeheN9ji6hvGpjVjejKD0h0=E+A@mail.gmail.com>
 <CABcYAdKtUWnUdpMBOZ6R_EajctOtVAHa=DUd6X4ytEr9H_acVQ@mail.gmail.com>
 <BN6PR2201MB155318FFE325C623BE53AAC2CF569@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <004e01d8d501$12d6f2f0$3884d8d0$@gmail.com>
 <BN6PR2201MB15533DA430761C7B4A46AD15CF569@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <CABaFrRZkz8td3gzznUbSkmy=F5gacnCigGkGpnpiY7xiwKDMBQ@mail.gmail.com>

Those are valid reasons as examining data and cleaning or fixing it is a
major thing to do before making an analysis or plots. Indeed, an extra
column caused by something in an earlier column mat have messed up all
columns to the right.

My point was about replicating a problem like this may require many more
lines from the file.

On Fri, Sep 30, 2022, 5:58 PM Ebert,Timothy Aaron <tebert at ufl.edu> wrote:

> The point was more to figure out why most lines have 15 values and some
> give an error indicating that there are 16. Are there notes, or an extra
> comma? Some weather stations fail and give interesting data at, before, or
> after failure. Are the problem lines indicating machine failure? Typically
> code does not randomly enter extra data. Most answers appear to assume that
> the 16th column has been entered at the end of the data, but no evidence
> indicates this is true. If there is an initial value at the beginning of
> the row, then all of the data for that row will be in error if the "16"
> value is deleted. I am just paranoid enough to suggest looking at one case
> to make sure all is as assumed.
>    Another way to address the problem is to test the data. Are there
> temperatures less than -100 C or greater than 60 C? Why would one ever get
> such a thing? Machine error, or a column misaligned so that humidity values
> are in the temperature column.
>
> Tim
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of
> avi.e.gross at gmail.com
> Sent: Friday, September 30, 2022 3:16 PM
> Cc: r-help at r-project.org
> Subject: Re: [R] Reading very large text files into R
>
> [External Email]
>
> Tim and others,
>
> A point to consider is that there are various algorithms in the functions
> used to read in formatted data into data.frame form and they vary. Some do
> a look-ahead of some size to determine things and if they find a column
> that LOOKS LIKE all integers for say the first thousand lines, they go and
> read in that column as integer. If the first floating point value is
> thousands of lines further along, things may go wrong.
>
> So asking for line/row 16 to have an extra 16th entry/column may work fine
> for an algorithm that looks ahead and concludes there are 16 columns
> throughout. Yet a file where the first time a sixteenth entry is seen is at
> line/row 31,459 may well just set the algorithm to expect exactly 15
> columns and then be surprised as noted above.
>
> I have stayed out of this discussion and others have supplied pretty much
> what I would have said. I also see the data as flawed and ask which rows
> are the valid ones. If a sixteenth column is allowed, it would be better if
> all other rows had an empty sixteenth column. If not allowed, none should
> have it.
>
> The approach I might take, again as others have noted, is to preprocess
> the data file using some form of stream editor such as AWK that
> automagically reads in a line at a time and parses lines into a collection
> of tokens based on what separates them such as a comma. You can then either
> write out just the first 15 to the output stream if your choice is to
> ignore a spurious sixteenth, or write out all sixteen for every line, with
> the last being some form of null most of the time. And, of course, to be
> more general, you could make two passes through the file with the first one
> determining the maximum number of entries as well as what the most common
> number of entries is, and a second pass using that info to normalize the
> file the way you want. And note some of what was mentioned could often be
> done in this preprocessing such as removing any columns you do not want to
> read into R later. Do note such filters may need to handle edge cases like
> skipping comment lines or treating the row of headers differently.
>
> As some have shown, you can create your own filters within a language like
> R too and either read in lines and pre-process them as discussed or
> continue on to making your own data.frame and skip the read.table() type of
> functionality. For very large files, though, having multiple variations in
> memory at once may be an issue, especially if they are not removed and
> further processing and analysis continues.
>
> Perhaps it might be sensible to contact those maintaining the data and
> point out the anomaly and ask if their files might be saved alternately in
> a format that can be used without anomalies.
>
> Avi
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Ebert,Timothy
> Aaron
> Sent: Friday, September 30, 2022 7:27 AM
> To: Richard O'Keefe <raoknz at gmail.com>; Nick Wray <nickmwray at gmail.com>
> Cc: r-help at r-project.org
> Subject: Re: [R] Reading very large text files into R
>
> Hi Nick,
>    Can you post one line of data with 15 entries followed by the next line
> of data with 16 entries?
>
> Tim
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>
> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7C3d75da30d3744c13847308daa3184c98%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638001622016765705%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=5w0Yrih%2Fxf09zpgabscAzMTVzcw4nhjNKX5%2FgWEPVWk%3D&amp;reserved=0
> PLEASE do read the posting guide
> https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7C3d75da30d3744c13847308daa3184c98%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638001622016765705%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=K4ddCaLbSB5XU8TELCMhDEFsG4drevbeRp2YKPxY2ag%3D&amp;reserved=0
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From tebert @end|ng |rom u||@edu  Sat Oct  1 01:43:01 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Fri, 30 Sep 2022 23:43:01 +0000
Subject: [R] Reading very large text files into R
In-Reply-To: <CABaFrRZkz8td3gzznUbSkmy=F5gacnCigGkGpnpiY7xiwKDMBQ@mail.gmail.com>
References: <CABxY9BMk+Y82OV8Rcaoe-r+GeheN9ji6hvGpjVjejKD0h0=E+A@mail.gmail.com>
 <CABcYAdKtUWnUdpMBOZ6R_EajctOtVAHa=DUd6X4ytEr9H_acVQ@mail.gmail.com>
 <BN6PR2201MB155318FFE325C623BE53AAC2CF569@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <004e01d8d501$12d6f2f0$3884d8d0$@gmail.com>
 <BN6PR2201MB15533DA430761C7B4A46AD15CF569@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CABaFrRZkz8td3gzznUbSkmy=F5gacnCigGkGpnpiY7xiwKDMBQ@mail.gmail.com>
Message-ID: <BN6PR2201MB1553B86BFEE83B5EDD382CD9CF569@BN6PR2201MB1553.namprd22.prod.outlook.com>

Truth

Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Avi Gross
Sent: Friday, September 30, 2022 7:01 PM
Cc: R help Mailing list <r-help at r-project.org>
Subject: Re: [R] Reading very large text files into R

[External Email]

Those are valid reasons as examining data and cleaning or fixing it is a major thing to do before making an analysis or plots. Indeed, an extra column caused by something in an earlier column mat have messed up all columns to the right.

My point was about replicating a problem like this may require many more lines from the file.

On Fri, Sep 30, 2022, 5:58 PM Ebert,Timothy Aaron <tebert at ufl.edu> wrote:

> The point was more to figure out why most lines have 15 values and 
> some give an error indicating that there are 16. Are there notes, or 
> an extra comma? Some weather stations fail and give interesting data 
> at, before, or after failure. Are the problem lines indicating machine 
> failure? Typically code does not randomly enter extra data. Most 
> answers appear to assume that the 16th column has been entered at the 
> end of the data, but no evidence indicates this is true. If there is 
> an initial value at the beginning of the row, then all of the data for that row will be in error if the "16"
> value is deleted. I am just paranoid enough to suggest looking at one 
> case to make sure all is as assumed.
>    Another way to address the problem is to test the data. Are there 
> temperatures less than -100 C or greater than 60 C? Why would one ever 
> get such a thing? Machine error, or a column misaligned so that 
> humidity values are in the temperature column.
>
> Tim
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of 
> avi.e.gross at gmail.com
> Sent: Friday, September 30, 2022 3:16 PM
> Cc: r-help at r-project.org
> Subject: Re: [R] Reading very large text files into R
>
> [External Email]
>
> Tim and others,
>
> A point to consider is that there are various algorithms in the 
> functions used to read in formatted data into data.frame form and they 
> vary. Some do a look-ahead of some size to determine things and if 
> they find a column that LOOKS LIKE all integers for say the first 
> thousand lines, they go and read in that column as integer. If the 
> first floating point value is thousands of lines further along, things may go wrong.
>
> So asking for line/row 16 to have an extra 16th entry/column may work 
> fine for an algorithm that looks ahead and concludes there are 16 
> columns throughout. Yet a file where the first time a sixteenth entry 
> is seen is at line/row 31,459 may well just set the algorithm to 
> expect exactly 15 columns and then be surprised as noted above.
>
> I have stayed out of this discussion and others have supplied pretty 
> much what I would have said. I also see the data as flawed and ask 
> which rows are the valid ones. If a sixteenth column is allowed, it 
> would be better if all other rows had an empty sixteenth column. If 
> not allowed, none should have it.
>
> The approach I might take, again as others have noted, is to 
> preprocess the data file using some form of stream editor such as AWK 
> that automagically reads in a line at a time and parses lines into a 
> collection of tokens based on what separates them such as a comma. You 
> can then either write out just the first 15 to the output stream if 
> your choice is to ignore a spurious sixteenth, or write out all 
> sixteen for every line, with the last being some form of null most of 
> the time. And, of course, to be more general, you could make two 
> passes through the file with the first one determining the maximum 
> number of entries as well as what the most common number of entries 
> is, and a second pass using that info to normalize the file the way 
> you want. And note some of what was mentioned could often be done in 
> this preprocessing such as removing any columns you do not want to 
> read into R later. Do note such filters may need to handle edge cases like skipping comment lines or treating the row of headers differently.
>
> As some have shown, you can create your own filters within a language 
> like R too and either read in lines and pre-process them as discussed 
> or continue on to making your own data.frame and skip the read.table() 
> type of functionality. For very large files, though, having multiple 
> variations in memory at once may be an issue, especially if they are 
> not removed and further processing and analysis continues.
>
> Perhaps it might be sensible to contact those maintaining the data and 
> point out the anomaly and ask if their files might be saved 
> alternately in a format that can be used without anomalies.
>
> Avi
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Ebert,Timothy 
> Aaron
> Sent: Friday, September 30, 2022 7:27 AM
> To: Richard O'Keefe <raoknz at gmail.com>; Nick Wray 
> <nickmwray at gmail.com>
> Cc: r-help at r-project.org
> Subject: Re: [R] Reading very large text files into R
>
> Hi Nick,
>    Can you post one line of data with 15 entries followed by the next 
> line of data with 16 entries?
>
> Tim
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>
> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat
> .ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl
> .edu%7C5044822c1b7f45f2b5f408daa337cc46%7C0d4da0f84a314d76ace60a62331e
> 1b84%7C0%7C0%7C638001757304040018%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4w
> LjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C
> &amp;sdata=s1Vx7PfKdb12NTQFAsGPQ5k8oXBylcFyD30xtAnHqYQ%3D&amp;reserved
> =0
> PLEASE do read the posting guide
> https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r
> -project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%
> 7C5044822c1b7f45f2b5f408daa337cc46%7C0d4da0f84a314d76ace60a62331e1b84%
> 7C0%7C0%7C638001757304040018%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwM
> DAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;
> sdata=Q3cceHqosMsjflLn5cPgBE58EGdE%2B7riPYhubX%2BwEL8%3D&amp;reserved=
> 0 and provide commented, minimal, self-contained, reproducible code.
>

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7C5044822c1b7f45f2b5f408daa337cc46%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638001757304040018%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=s1Vx7PfKdb12NTQFAsGPQ5k8oXBylcFyD30xtAnHqYQ%3D&amp;reserved=0
PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7C5044822c1b7f45f2b5f408daa337cc46%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638001757304040018%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=Q3cceHqosMsjflLn5cPgBE58EGdE%2B7riPYhubX%2BwEL8%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.


From dr@@|@m@o|@ng| @end|ng |rom gm@||@com  Sat Oct  1 14:53:00 2022
From: dr@@|@m@o|@ng| @end|ng |rom gm@||@com (Shah Alam)
Date: Sat, 1 Oct 2022 14:53:00 +0200
Subject: [R] could not find function "flexsurvreg"
Message-ID: <CA+bivFj5M5HeVawxZXeZ4S9JgZUAY2eF8DCUb_JXyNiNoLk59A@mail.gmail.com>

Dear All,
I am analyzing trial data for survival. During the loading of the R package
"flexsurv", the following error message appeared.

"Loading required package: survival
Error: package or namespace load failed for ?flexsurv? in loadNamespace(j
<- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]):
 there is no package called ?lifecycle?

Despite installing lifecycle package, loading lifecycle package results in
the following error message:

Error in library(lifecycle) : there is no package called ?lifecycle?

Moreover, the flexsurvreg function in the flexsurv library also produces an
error:

Error in flexsurvreg(Surv(Time, Event) ~ 1, anc = NULL, data = data1,  :
  could not find function "flexsurvreg"

Several times I have installed and uninstalled packages, re-started R, but
the error persists.

Could anyone help me with the flexsurv package, why is it not working?

Best regards,
Shah

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Oct  1 15:29:15 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 1 Oct 2022 14:29:15 +0100
Subject: [R] could not find function "flexsurvreg"
In-Reply-To: <CA+bivFj5M5HeVawxZXeZ4S9JgZUAY2eF8DCUb_JXyNiNoLk59A@mail.gmail.com>
References: <CA+bivFj5M5HeVawxZXeZ4S9JgZUAY2eF8DCUb_JXyNiNoLk59A@mail.gmail.com>
Message-ID: <2975651c-bf02-4f2c-a44d-9f49b7f84deb@sapo.pt>

Hello,

Not knowing which system you have, here is a way that usually works.

1. If you are using an IDE sych as RStudio or RGui, save your work and 
exit. This is because when the packages' namepaces are loaded, the 
shared libs, if they exist, are blocked,

2. Open a terminal window
3. Run

R -q -e "install.packages(c('lifecycle', 'flexsurv'))"


The packages should now be installed.


Hope this helps,

Rui Barradas

?s 13:53 de 01/10/2022, Shah Alam escreveu:
> Dear All,
> I am analyzing trial data for survival. During the loading of the R package
> "flexsurv", the following error message appeared.
> 
> "Loading required package: survival
> Error: package or namespace load failed for ?flexsurv? in loadNamespace(j
> <- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]):
>   there is no package called ?lifecycle?
> 
> Despite installing lifecycle package, loading lifecycle package results in
> the following error message:
> 
> Error in library(lifecycle) : there is no package called ?lifecycle?
> 
> Moreover, the flexsurvreg function in the flexsurv library also produces an
> error:
> 
> Error in flexsurvreg(Surv(Time, Event) ~ 1, anc = NULL, data = data1,  :
>    could not find function "flexsurvreg"
> 
> Several times I have installed and uninstalled packages, re-started R, but
> the error persists.
> 
> Could anyone help me with the flexsurv package, why is it not working?
> 
> Best regards,
> Shah
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From t@r|qkh@@|r| @end|ng |rom gm@||@com  Sun Oct  2 14:06:02 2022
From: t@r|qkh@@|r| @end|ng |rom gm@||@com (Tariq Khasiri)
Date: Sun, 2 Oct 2022 07:06:02 -0500
Subject: [R] Help with steam graph
Message-ID: <CAFy_oHAn0RGPVXG=ypbxHM_idX08=c94QOh+gpqwXVEEKYnuSw@mail.gmail.com>

Hi, i'm trying to create a steamgraph with the following data by creating a
unit indicator by combing the year and month. But, I'm getting error as :

Error in `group_by()`:
! Must group by variables found in `.data`.
? Column `com_num` is not found.
Run `rlang::last_error()` to see where the error occurred.

### Packages needed for the code
devtools::install_github("hrbrmstr/streamgraph")

library(tidyverse)
library(ggplot2)
library(dplyr)
library(steamgraph)

### Code ( The following code can be found on creator's account
https://hrbrmstr.github.io/streamgraph/  )

dat %>%
select(year, month, company, share, com_num) %>%
  tidyr::gather(company, share, -year) %>%
  group_by(year, com_num) %>%
  tally(wt=share) %>%
  ungroup %>%
  streamgraph("com_num", "n", "year") %>%
  sg_axis_x(0.8) %>%
  sg_fill_brewer("PuOr") %>%
  sg_legend(show=TRUE, label="Share: ")


### data is like the following

dput(dat)
structure(list(year = c(2018, 2019, 2019, 2019, 2019, 2019, 2019,
2019, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017,
2017, 2017, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,
2018, 2018, 2018, 2019, 2019, 2019, 2019, 2019), month = c(12,
1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1,
2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5), company = c("ABC",
"ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "FGH", "FGH",
"FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
"FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
"FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH"
), share = c(20, 16.5, 15, 15.5, 15.5, 16, 17, 16.5, 61, 55,
53, 53, 54, 53, 58, 54, 50, 47, 55, 50, 52, 51, 51.5, 52, 53,
54, 55, 53, 54, 50, 42, 48, 41, 40, 39, 36.5, 35), com_name = c(1,
1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)), row.names = c(NA,
-37L), spec = structure(list(cols = list(year = structure(list(), class =
c("collector_double",
"collector")), month = structure(list(), class = c("collector_double",
"collector")), company = structure(list(), class = c("collector_character",
"collector")), share = structure(list(), class = c("collector_double",
"collector")), com_name = structure(list(), class = c("collector_double",
"collector"))), default = structure(list(), class = c("collector_guess",
"collector")), delim = ","), class = "col_spec"), problems = <pointer:
0x7fd732028680>, class = c("spec_tbl_df",
"tbl_df", "tbl", "data.frame"))

	[[alternative HTML version deleted]]


From m@@c|@@|mone99 @end|ng |rom gm@||@com  Sun Oct  2 12:56:44 2022
From: m@@c|@@|mone99 @end|ng |rom gm@||@com (Simone Mascia)
Date: Sun, 2 Oct 2022 12:56:44 +0200
Subject: [R] Robust standard error
Message-ID: <CAPkN0fY32F=b=RFsTuCnDytg4i=++CkB_Bw7VLN+i=0rvaBQtQ@mail.gmail.com>

Is there a way to estimate Robust standard errors when using a nls()
function? I'm trying to fit some data to a complicated model and everything
works fine with nls() but I also wanted to obtain a robust estimate of my
errors.

I tried "coeftest(m, vcov=sandwich)" and it seems to work, but so does
"coeftest(m, vcov = NeweyWest(m, lag = 4))" or "coeftest(m, vcov =
kernHAC(m, kernel = "Bartlett", bw = 5, prewhite = FALSE, adjust =
FALSE))". They return different error estimates so I wanted you to help me
understand what I should do, if I'm doing something wrong and other stuff.

Thank you

	[[alternative HTML version deleted]]


From dw|n@em|u@ @end|ng |rom comc@@t@net  Sun Oct  2 16:11:55 2022
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Sun, 2 Oct 2022 07:11:55 -0700
Subject: [R] Help with steam graph
In-Reply-To: <CAFy_oHAn0RGPVXG=ypbxHM_idX08=c94QOh+gpqwXVEEKYnuSw@mail.gmail.com>
References: <CAFy_oHAn0RGPVXG=ypbxHM_idX08=c94QOh+gpqwXVEEKYnuSw@mail.gmail.com>
Message-ID: <0073C340-0152-48CF-BB4B-1890BFD1DDF3@comcast.net>

I don?t see a column with the name ?com_num?, so the error message makes complete sense. 

? 
David

Sent from my iPhone

> On Oct 2, 2022, at 5:06 AM, Tariq Khasiri <tariqkhasiri at gmail.com> wrote:
> 
> ?Hi, i'm trying to create a steamgraph with the following data by creating a
> unit indicator by combing the year and month. But, I'm getting error as :
> 
> Error in `group_by()`:
> ! Must group by variables found in `.data`.
> ? Column `com_num` is not found.
> Run `rlang::last_error()` to see where the error occurred.
> 
> ### Packages needed for the code
> devtools::install_github("hrbrmstr/streamgraph")
> 
> library(tidyverse)
> library(ggplot2)
> library(dplyr)
> library(steamgraph)
> 
> ### Code ( The following code can be found on creator's account
> https://hrbrmstr.github.io/streamgraph/  )
> 
> dat %>%
> select(year, month, company, share, com_num) %>%
>  tidyr::gather(company, share, -year) %>%
>  group_by(year, com_num) %>%
>  tally(wt=share) %>%
>  ungroup %>%
>  streamgraph("com_num", "n", "year") %>%
>  sg_axis_x(0.8) %>%
>  sg_fill_brewer("PuOr") %>%
>  sg_legend(show=TRUE, label="Share: ")
> 
> 
> ### data is like the following
> 
> dput(dat)
> structure(list(year = c(2018, 2019, 2019, 2019, 2019, 2019, 2019,
> 2019, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017,
> 2017, 2017, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,
> 2018, 2018, 2018, 2019, 2019, 2019, 2019, 2019), month = c(12,
> 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1,
> 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5), company = c("ABC",
> "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "FGH", "FGH",
> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH"
> ), share = c(20, 16.5, 15, 15.5, 15.5, 16, 17, 16.5, 61, 55,
> 53, 53, 54, 53, 58, 54, 50, 47, 55, 50, 52, 51, 51.5, 52, 53,
> 54, 55, 53, 54, 50, 42, 48, 41, 40, 39, 36.5, 35), com_name = c(1,
> 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
> 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)), row.names = c(NA,
> -37L), spec = structure(list(cols = list(year = structure(list(), class =
> c("collector_double",
> "collector")), month = structure(list(), class = c("collector_double",
> "collector")), company = structure(list(), class = c("collector_character",
> "collector")), share = structure(list(), class = c("collector_double",
> "collector")), com_name = structure(list(), class = c("collector_double",
> "collector"))), default = structure(list(), class = c("collector_guess",
> "collector")), delim = ","), class = "col_spec"), problems = <pointer:
> 0x7fd732028680>, class = c("spec_tbl_df",
> "tbl_df", "tbl", "data.frame"))
> 
>    [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Sun Oct  2 16:43:00 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sun, 2 Oct 2022 07:43:00 -0700
Subject: [R] Robust standard error
In-Reply-To: <CAPkN0fY32F=b=RFsTuCnDytg4i=++CkB_Bw7VLN+i=0rvaBQtQ@mail.gmail.com>
References: <CAPkN0fY32F=b=RFsTuCnDytg4i=++CkB_Bw7VLN+i=0rvaBQtQ@mail.gmail.com>
Message-ID: <CAGxFJbSTKN5C4SbGh4XRNTe95WArNd2m5XaE1gi8YgfC4ajnrg@mail.gmail.com>

You may get a helpful response here, but generally speaking, this list is
about R **programming**, and statistical issues/tutorials are off topic.
You might try
https://stackoverflow.com/questions/tagged/statistics
if you don't get adequate help here.

-- Bert

On Sun, Oct 2, 2022 at 6:42 AM Simone Mascia <masciasimone99 at gmail.com>
wrote:

> Is there a way to estimate Robust standard errors when using a nls()
> function? I'm trying to fit some data to a complicated model and everything
> works fine with nls() but I also wanted to obtain a robust estimate of my
> errors.
>
> I tried "coeftest(m, vcov=sandwich)" and it seems to work, but so does
> "coeftest(m, vcov = NeweyWest(m, lag = 4))" or "coeftest(m, vcov =
> kernHAC(m, kernel = "Bartlett", bw = 5, prewhite = FALSE, adjust =
> FALSE))". They return different error estimates so I wanted you to help me
> understand what I should do, if I'm doing something wrong and other stuff.
>
> Thank you
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From e@ @end|ng |rom enr|co@chum@nn@net  Sun Oct  2 17:59:32 2022
From: e@ @end|ng |rom enr|co@chum@nn@net (Enrico Schumann)
Date: Sun, 02 Oct 2022 17:59:32 +0200
Subject: [R] Robust standard error
In-Reply-To: <CAGxFJbSTKN5C4SbGh4XRNTe95WArNd2m5XaE1gi8YgfC4ajnrg@mail.gmail.com>
 (Bert Gunter's message of "Sun, 2 Oct 2022 07:43:00 -0700")
References: <CAPkN0fY32F=b=RFsTuCnDytg4i=++CkB_Bw7VLN+i=0rvaBQtQ@mail.gmail.com>
 <CAGxFJbSTKN5C4SbGh4XRNTe95WArNd2m5XaE1gi8YgfC4ajnrg@mail.gmail.com>
Message-ID: <87lepykyhn.fsf@enricoschumann.net>

On Sun, 02 Oct 2022, Bert Gunter writes:

> On Sun, Oct 2, 2022 at 6:42 AM Simone Mascia <masciasimone99 at gmail.com>
> wrote:
>
>> Is there a way to estimate Robust standard errors when using a nls()
>> function? I'm trying to fit some data to a complicated model and everything
>> works fine with nls() but I also wanted to obtain a robust estimate of my
>> errors.
>>
>> I tried "coeftest(m, vcov=sandwich)" and it seems to work, but so does
>> "coeftest(m, vcov = NeweyWest(m, lag = 4))" or "coeftest(m, vcov =
>> kernHAC(m, kernel = "Bartlett", bw = 5, prewhite = FALSE, adjust =
>> FALSE))". They return different error estimates so I wanted you to help me
>> understand what I should do, if I'm doing something wrong and other stuff.
>>
>> Thank you
>>
>
> You may get a helpful response here, but generally speaking, this list is
> about R **programming**, and statistical issues/tutorials are off topic.
> You might try
> https://stackoverflow.com/questions/tagged/statistics
> if you don't get adequate help here.
>
> -- Bert
>

Additionally, there is also
https://stat.ethz.ch/mailman/listinfo/R-sig-Robust .

-- 
Enrico Schumann
Lucerne, Switzerland
http://enricoschumann.net


From t@r|qkh@@|r| @end|ng |rom gm@||@com  Sun Oct  2 19:03:51 2022
From: t@r|qkh@@|r| @end|ng |rom gm@||@com (Tariq Khasiri)
Date: Sun, 2 Oct 2022 12:03:51 -0500
Subject: [R] Help with steam graph
In-Reply-To: <0073C340-0152-48CF-BB4B-1890BFD1DDF3@comcast.net>
References: <CAFy_oHAn0RGPVXG=ypbxHM_idX08=c94QOh+gpqwXVEEKYnuSw@mail.gmail.com>
 <0073C340-0152-48CF-BB4B-1890BFD1DDF3@comcast.net>
Message-ID: <CAFy_oHCNXkHGOXGixzyee74TRKsxjeaozwuR2Y2OY4T4236Kag@mail.gmail.com>

Actually in my main data the column name is com_num ( where mistakenly I
pasted the sample data here under the com_name ). So, when I run the
command successfully this is the error shows up -

    ?
  1. ??... %>% sg_legend(show = TRUE, label = "Share: ")
  2. ??streamgraph::sg_legend(., show = TRUE, label = "Share: ")
  3. ??streamgraph::sg_fill_brewer(., "PuOr")
  4. ??streamgraph::sg_axis_x(., 0.8)
  5. ??streamgraph::streamgraph(., "com_num", "n", "year")
  6. ? ??base::data.frame(data)
  7. ??dplyr::ungroup(.)
  8. ??dplyr::tally(., wt = share)
  9. ??dplyr::group_by(., year, com_num)
 10. ??dplyr:::group_by.data.frame(., year, com_num)
 11.   ??dplyr::group_by_prepare(.data, ..., .add = .add, caller_env =
caller_env())
 12.     ??rlang::abort(bullets, call = error_call)

Any suggestions on how I can fix it ??

On Sun, 2 Oct 2022 at 09:12, David Winsemius <dwinsemius at comcast.net> wrote:

> I don?t see a column with the name ?com_num?, so the error message makes
> complete sense.
>
> ?
> David
>
> Sent from my iPhone
>
> > On Oct 2, 2022, at 5:06 AM, Tariq Khasiri <tariqkhasiri at gmail.com>
> wrote:
> >
> > ?Hi, i'm trying to create a steamgraph with the following data by
> creating a
> > unit indicator by combing the year and month. But, I'm getting error as :
> >
> > Error in `group_by()`:
> > ! Must group by variables found in `.data`.
> > ? Column `com_num` is not found.
> > Run `rlang::last_error()` to see where the error occurred.
> >
> > ### Packages needed for the code
> > devtools::install_github("hrbrmstr/streamgraph")
> >
> > library(tidyverse)
> > library(ggplot2)
> > library(dplyr)
> > library(steamgraph)
> >
> > ### Code ( The following code can be found on creator's account
> > https://hrbrmstr.github.io/streamgraph/  )
> >
> > dat %>%
> > select(year, month, company, share, com_num) %>%
> >  tidyr::gather(company, share, -year) %>%
> >  group_by(year, com_num) %>%
> >  tally(wt=share) %>%
> >  ungroup %>%
> >  streamgraph("com_num", "n", "year") %>%
> >  sg_axis_x(0.8) %>%
> >  sg_fill_brewer("PuOr") %>%
> >  sg_legend(show=TRUE, label="Share: ")
> >
> >
> > ### data is like the following
> >
> > dput(dat)
> > structure(list(year = c(2018, 2019, 2019, 2019, 2019, 2019, 2019,
> > 2019, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017,
> > 2017, 2017, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,
> > 2018, 2018, 2018, 2019, 2019, 2019, 2019, 2019), month = c(12,
> > 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1,
> > 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5), company = c("ABC",
> > "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "FGH", "FGH",
> > "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
> > "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
> > "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH"
> > ), share = c(20, 16.5, 15, 15.5, 15.5, 16, 17, 16.5, 61, 55,
> > 53, 53, 54, 53, 58, 54, 50, 47, 55, 50, 52, 51, 51.5, 52, 53,
> > 54, 55, 53, 54, 50, 42, 48, 41, 40, 39, 36.5, 35), com_name = c(1,
> > 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
> > 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)), row.names = c(NA,
> > -37L), spec = structure(list(cols = list(year = structure(list(), class =
> > c("collector_double",
> > "collector")), month = structure(list(), class = c("collector_double",
> > "collector")), company = structure(list(), class =
> c("collector_character",
> > "collector")), share = structure(list(), class = c("collector_double",
> > "collector")), com_name = structure(list(), class = c("collector_double",
> > "collector"))), default = structure(list(), class = c("collector_guess",
> > "collector")), delim = ","), class = "col_spec"), problems = <pointer:
> > 0x7fd732028680>, class = c("spec_tbl_df",
> > "tbl_df", "tbl", "data.frame"))
> >
> >    [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
>

	[[alternative HTML version deleted]]


From tebert @end|ng |rom u||@edu  Sun Oct  2 23:27:10 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Sun, 2 Oct 2022 21:27:10 +0000
Subject: [R] Robust standard error
In-Reply-To: <87lepykyhn.fsf@enricoschumann.net>
References: <CAPkN0fY32F=b=RFsTuCnDytg4i=++CkB_Bw7VLN+i=0rvaBQtQ@mail.gmail.com>
 <CAGxFJbSTKN5C4SbGh4XRNTe95WArNd2m5XaE1gi8YgfC4ajnrg@mail.gmail.com>
 <87lepykyhn.fsf@enricoschumann.net>
Message-ID: <BN6PR2201MB1553F98BC7B6CD7D3134E849CF589@BN6PR2201MB1553.namprd22.prod.outlook.com>

Most computer code will take a pile of numbers and return a pile of numbers. Reading the documentation should help you figure out where each measure is appropriate. It all depends on the purpose of a specific method and its assumptions and how those relate to your data, application, and model assumptions. It is important to know that information because it could change if you change your model or find other questions to ask of your data. There is no universal right answer.

Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Enrico Schumann
Sent: Sunday, October 2, 2022 12:00 PM
To: Simone Mascia <masciasimone99 at gmail.com>
Cc: r-help at r-project.org
Subject: Re: [R] Robust standard error

[External Email]

On Sun, 02 Oct 2022, Bert Gunter writes:

> On Sun, Oct 2, 2022 at 6:42 AM Simone Mascia 
> <masciasimone99 at gmail.com>
> wrote:
>
>> Is there a way to estimate Robust standard errors when using a nls() 
>> function? I'm trying to fit some data to a complicated model and 
>> everything works fine with nls() but I also wanted to obtain a robust 
>> estimate of my errors.
>>
>> I tried "coeftest(m, vcov=sandwich)" and it seems to work, but so 
>> does "coeftest(m, vcov = NeweyWest(m, lag = 4))" or "coeftest(m, vcov 
>> = kernHAC(m, kernel = "Bartlett", bw = 5, prewhite = FALSE, adjust = 
>> FALSE))". They return different error estimates so I wanted you to 
>> help me understand what I should do, if I'm doing something wrong and other stuff.
>>
>> Thank you
>>
>
> You may get a helpful response here, but generally speaking, this list 
> is about R **programming**, and statistical issues/tutorials are off topic.
> You might try
> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstac
> koverflow.com%2Fquestions%2Ftagged%2Fstatistics&amp;data=05%7C01%7Cteb
> ert%40ufl.edu%7C86352d688e094b941f6108daa48f2bb0%7C0d4da0f84a314d76ace
> 60a62331e1b84%7C0%7C0%7C638003232071609206%7CUnknown%7CTWFpbGZsb3d8eyJ
> WIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000
> %7C%7C%7C&amp;sdata=yFTdmRZyRqZd9F3XNsg12IvYlnWE2P6TTkRvNL6U4ZI%3D&amp
> ;reserved=0
> if you don't get adequate help here.
>
> -- Bert
>

Additionally, there is also
https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2FR-sig-Robust&amp;data=05%7C01%7Ctebert%40ufl.edu%7C86352d688e094b941f6108daa48f2bb0%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638003232071609206%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=WJY8zHOxsMLUv1uiHJ91q04mGVvkPi0Kg%2BYydMZMKhs%3D&amp;reserved=0 .

--
Enrico Schumann
Lucerne, Switzerland
https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fenricoschumann.net%2F&amp;data=05%7C01%7Ctebert%40ufl.edu%7C86352d688e094b941f6108daa48f2bb0%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638003232071609206%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=nntdbtWzMra1ZsSrTR2ZEuDNndB6J5GJ%2B1WSC%2Bhweqo%3D&amp;reserved=0

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=05%7C01%7Ctebert%40ufl.edu%7C86352d688e094b941f6108daa48f2bb0%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638003232071609206%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=6J1gU7dtTJexvDxujaA10nKYYxypFk1CMjN8qc8NQZM%3D&amp;reserved=0
PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=05%7C01%7Ctebert%40ufl.edu%7C86352d688e094b941f6108daa48f2bb0%7C0d4da0f84a314d76ace60a62331e1b84%7C0%7C0%7C638003232071609206%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=qd99tAhjS4vz7SemhzyXKvpSDG%2FZD%2FtQ4BYbCtt%2Fsu8%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.


From t@r|qkh@@|r| @end|ng |rom gm@||@com  Mon Oct  3 01:04:24 2022
From: t@r|qkh@@|r| @end|ng |rom gm@||@com (Tariq Khasiri)
Date: Sun, 2 Oct 2022 18:04:24 -0500
Subject: [R] Creating a year-month indicator and groupby with category
Message-ID: <CAFy_oHDGR7cnNwcTW3mNknKvHhRz+LC4v4XSeKrKEOUjMTcsmA@mail.gmail.com>

Hello,

I have the following data. I want to show in a line plot how each different
company is earning over the timeline of my data sample.

I'm not sure how I can create the *year-month indicator* to plot it nicely
in my horizontal axis out of my dataset.

After creating the *year-month* indicator ( which will be in my x axis) I
want to create a dataframe where I can groupby companies over the
year-month indicator by putting *share *in the y axis as variables.

### data is like the following

dput(dat)
structure(list(year = c(2018, 2019, 2019, 2019, 2019, 2019, 2019,
2019, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017,
2017, 2017, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,
2018, 2018, 2018, 2019, 2019, 2019, 2019, 2019), month = c(12,
1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1,
2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5), company = c("ABC",
"ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "FGH", "FGH",
"FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
"FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
"FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH"
), share = c(20, 16.5, 15, 15.5, 15.5, 16, 17, 16.5, 61, 55,
53, 53, 54, 53, 58, 54, 50, 47, 55, 50, 52, 51, 51.5, 52, 53,
54, 55, 53, 54, 50, 42, 48, 41, 40, 39, 36.5, 35), com_name = c(1,
1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)), row.names = c(NA,
-37L), spec = structure(list(cols = list(year = structure(list(), class =
c("collector_double",
"collector")), month = structure(list(), class = c("collector_double",
"collector")), company = structure(list(), class = c("collector_character",
"collector")), share = structure(list(), class = c("collector_double",
"collector")), com_name = structure(list(), class = c("collector_double",
"collector"))), default = structure(list(), class = c("collector_guess",
"collector")), delim = ","), class = "col_spec"), problems = <pointer:
0x7fd732028680>, class = c("spec_tbl_df",
"tbl_df", "tbl", "data.frame"))

	[[alternative HTML version deleted]]


From dw|n@em|u@ @end|ng |rom comc@@t@net  Mon Oct  3 04:33:37 2022
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Sun, 2 Oct 2022 19:33:37 -0700
Subject: [R] Help with steam graph
In-Reply-To: <CAFy_oHCNXkHGOXGixzyee74TRKsxjeaozwuR2Y2OY4T4236Kag@mail.gmail.com>
References: <CAFy_oHAn0RGPVXG=ypbxHM_idX08=c94QOh+gpqwXVEEKYnuSw@mail.gmail.com>
 <0073C340-0152-48CF-BB4B-1890BFD1DDF3@comcast.net>
 <CAFy_oHCNXkHGOXGixzyee74TRKsxjeaozwuR2Y2OY4T4236Kag@mail.gmail.com>
Message-ID: <1129c7dc-e5ba-3938-663b-85aeedf0e9ce@comcast.net>

I think you are being dishonest. That code does not appear on hrbrmstr's 
vignette at least in a form that I recognize.

When I run your code from the first posting with all the instances of 
`com_num` replaced by `com_name` and removing the `pointer` entry in dat 
which throws an error when trying to define dat, I get

Error in `group_by()`: ! Must group by variables found in `.data`. ? 
Column `com_name` is not found. So I "rewind the process to the point 
where the error is reported and find

> dat %>%+ select(year, month, company, share, com_name) %>% + 
tidyr::gather(company, share, -year) # A tibble: 148 ? 3 year company 
share <dbl> <chr> <chr> 1 2018 month 12 2 2019 month 1 3 2019 month 2 4 
2019 month 3 5 2019 month 4 6 2019 month 5 7 2019 month 6 8 2019 month 7 
9 2017 month 1 10 2017 month 2 # ? with 138 more rows # ? Use `print(n = 
...)` to see more rows So the "gathering" process seems to have removed 
the `com_name` column. Can exit R without saving your workspace and then 
construct a series of R commands that will create a reproducible 
example? -- David.

On 10/2/22 10:03, Tariq Khasiri wrote:
> Actually in my main data the column name is com_num ( where 
> mistakenly?I pasted the sample data here under the com_name ). So, 
> when I run the command successfully?this is the error shows up -
>
> ? ? ?
> ? 1. ??... %>% sg_legend(show = TRUE, label = "Share: ")
> ? 2. ??streamgraph::sg_legend(., show = TRUE, label = "Share: ")
> ? 3. ??streamgraph::sg_fill_brewer(., "PuOr")
> ? 4. ??streamgraph::sg_axis_x(., 0.8)
> ? 5. ??streamgraph::streamgraph(., "com_num", "n", "year")
> ? 6. ? ??base::data.frame(data)
> ? 7. ??dplyr::ungroup(.)
> ? 8. ??dplyr::tally(., wt = share)
> ? 9. ??dplyr::group_by(., year, com_num)
> ?10. ??dplyr:::group_by.data.frame(., year, com_num)
> ?11. ? ??dplyr::group_by_prepare(.data, ..., .add = .add, caller_env = 
> caller_env())
> ?12. ? ? ??rlang::abort(bullets, call = error_call)
>
> Any suggestions on how I can fix it ??
>
> On Sun, 2 Oct 2022 at 09:12, David Winsemius <dwinsemius at comcast.net> 
> wrote:
>
>     I don?t see a column with the name ?com_num?, so the error message
>     makes complete sense.
>
>     ?
>     David
>
>     Sent from my iPhone
>
>     > On Oct 2, 2022, at 5:06 AM, Tariq Khasiri
>     <tariqkhasiri at gmail.com> wrote:
>     >
>     > ?Hi, i'm trying to create a steamgraph with the following data
>     by creating a
>     > unit indicator by combing the year and month. But, I'm getting
>     error as :
>     >
>     > Error in `group_by()`:
>     > ! Must group by variables found in `.data`.
>     > ? Column `com_num` is not found.
>     > Run `rlang::last_error()` to see where the error occurred.
>     >
>     > ### Packages needed for the code
>     > devtools::install_github("hrbrmstr/streamgraph")
>     >
>     > library(tidyverse)
>     > library(ggplot2)
>     > library(dplyr)
>     > library(steamgraph)
>     >
>     > ### Code ( The following code can be found on creator's account
>     > https://hrbrmstr.github.io/streamgraph/ )
>     >
>     > dat %>%
>     > select(year, month, company, share, com_num) %>%
>     >? tidyr::gather(company, share, -year) %>%
>     >? group_by(year, com_num) %>%
>     >? tally(wt=share) %>%
>     >? ungroup %>%
>     >? streamgraph("com_num", "n", "year") %>%
>     >? sg_axis_x(0.8) %>%
>     >? sg_fill_brewer("PuOr") %>%
>     >? sg_legend(show=TRUE, label="Share: ")
>     >
>     >
>     > ### data is like the following
>     >
>     > dput(dat)
>     > structure(list(year = c(2018, 2019, 2019, 2019, 2019, 2019, 2019,
>     > 2019, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017,
>     > 2017, 2017, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,
>     > 2018, 2018, 2018, 2019, 2019, 2019, 2019, 2019), month = c(12,
>     > 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1,
>     > 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5), company =
>     c("ABC",
>     > "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "FGH", "FGH",
>     > "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
>     > "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
>     > "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH"
>     > ), share = c(20, 16.5, 15, 15.5, 15.5, 16, 17, 16.5, 61, 55,
>     > 53, 53, 54, 53, 58, 54, 50, 47, 55, 50, 52, 51, 51.5, 52, 53,
>     > 54, 55, 53, 54, 50, 42, 48, 41, 40, 39, 36.5, 35), com_name = c(1,
>     > 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
>     > 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)), row.names = c(NA,
>     > -37L), spec = structure(list(cols = list(year =
>     structure(list(), class =
>     > c("collector_double",
>     > "collector")), month = structure(list(), class =
>     c("collector_double",
>     > "collector")), company = structure(list(), class =
>     c("collector_character",
>     > "collector")), share = structure(list(), class =
>     c("collector_double",
>     > "collector")), com_name = structure(list(), class =
>     c("collector_double",
>     > "collector"))), default = structure(list(), class =
>     c("collector_guess",
>     > "collector")), delim = ","), class = "col_spec"), problems =
>     <pointer:
>     > 0x7fd732028680>, class = c("spec_tbl_df",
>     > "tbl_df", "tbl", "data.frame"))
>     >
>     >? ? [[alternative HTML version deleted]]
>     >
>     > ______________________________________________
>     > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>     > https://stat.ethz.ch/mailman/listinfo/r-help
>     > PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>     > and provide commented, minimal, self-contained, reproducible code.
>


From |eo@m@d@ @end|ng |rom @yon|c@eu  Mon Oct  3 05:05:56 2022
From: |eo@m@d@ @end|ng |rom @yon|c@eu (Leonard Mada)
Date: Mon, 3 Oct 2022 06:05:56 +0300
Subject: [R] [External Help] Multivariate Polynomials in R
Message-ID: <b3d455f8-4446-6417-cc1e-b746842bc78e@syonic.eu>

Dear R Users,

I have written some R code for multivariate polynomials in R. I am 
looking forward for some help in redesigning and improving the code.

Although this code was not planned initially to be released as a 
package, the functionality has become quite versatile over time. I will 
provide some examples below. If anyone is interested in multivariate 
polynomials and has some spare time, or has some students interested to 
learn some interesting math, feel free to contact me.

The immediate focus should be on:
1) Writing/improving the automatic tests;
2) Redesigning the code (and build an R package);

As the code has grown in size, I am very cautious to change anything, 
until proper tests are written. I have started to write some test code 
(the link to the GitHub page is below), but I am not yet very confident 
how to properly write the tests and also lack the time as well. I will 
appreciate any expertise and help on this topic.

Ultimately, I hope to be able to focus more on the math topics. I will 
post a separate call for some of these topics.

CODE DETAILS

The source files are on GitHub:
https://github.com/discoleo/R/blob/master/Math/Polynomials.Helper.R
- (all) files named Polynomials.Helper.XXX.R are needed; (~ 25 files, 
including the test files);
- if requested, I can also upload a zip file with all these source files;
- the code started as some helper scripts (which is why all those files 
are mixed with other files);

The multivariate polynomials are stored as data.frames and R's 
aggregate() function is the workhorse: but it proved sufficiently fast 
and the code works well even with polynomials with > 10,000 monomials. I 
have some older Java code which used a TreeMap (sorted map), but I do 
not maintain that code anymore. I was very reserved initially regarding 
the efficiency of the data frame; but it worked well! And it proved very 
useful for sub-setting specific monomials!

I have attached some concrete examples below.

Sincerely,

Leonard


### Examples

source("Polynomials.Helper.R")
# - requires also the other Helper scripts;
# - not strictly needed (but are loaded automatically):
#?? library(polynom)
#?? library(pracma)

### Example 1:
n = 2; # Power "n" will be evaluated automatically
p1 = toPoly.pm("x^n*y + b*z - R")
p2 = toPoly.pm("y^n*z + b*x - R")
p3 = toPoly.pm("z^n*x + b*y - R")

pR = solve.lpm(p1, p2, p3, xn=c("z", "y"))
str(pR) # 124 monomials
# tweaking manually can improve the results;
pR = solve.lpm(p1, p2, p3, xn=c("y", "z"))
str(pR)
# pR[[2]]$Rez: 19 monomials: much better;

pR2 = div.pm(pR[[2]]$Rez, "x^3 + b*x - R", "x")
# Divisible!
str(pR2)
# Order 12 polynomial in x (24 monomials);

### Note:
# - the P[12] contains the distinct roots:
#?? it is the minimal order polynomial;
# - the trivial solution (x^3 + b*x = R) was removed;
# - this is the naive way to solve this system (but good as Demo);

# print the coefficients of x;
# (will be used inside the function coeff.S3Ht below)
pR2 = pR2$Rez;
pR2$coeff = - pR2$coeff; # positive leading coeff;
toCoeff(pR2, "x")

### Quick Check
solve.S3Ht = function(R, b) {
 ?? ?coeff = coeff.S3Ht(R, b);
 ?? ?x = roots(coeff); # library(pracma)
 ?? ?# Note: pracma uses leading to free coeff;
 ?? ?z = b*x^11 - R*x^10 - 2*R^2*b*x^5 + 2*R^2*b^2*x^3 + R*b^4*x^2 - R*b^5;
 ?? ?z = z / (- R^2*x^6 - R*b^2*x^5 + 3*R*b^3*x^3 - b^6);
 ?? ?y = (R - z^2*x) / b;
 ?? ?sol = cbind(x, y, z);
 ?? ?return(sol);
}
coeff.S3Ht = function(R, b) {
 ?? ?coeff = c(b^2, - 2*R*b, R^2 - b^3, 3*R*b^2,
 ?? ???? - 3*R^2*b + b^4, R^3 - 4*R*b^3,
 ?? ???? 2*R^2*b^2 - b^5, 5*R*b^4,
 ?? ???? R^4 - R^2*b^3 + b^6, - 3*R^3*b^2 - 3*R*b^5,
 ?? ???? - R^4*b + 3*R^2*b^4 - b^7,
 ?? ???? 2*R^3*b^3 - R*b^6,
 ?? ???? - R^2*b^5 + b^8);
 ?? ?return(coeff);
}

R = 5; b = -2;
sol = solve.S3Ht(R, b)
# all 12 sets of solutions:
x = sol[,1]; y = sol[,2]; z = sol[,3];

### Test:
x^2*y + b*z
y^2*z + b*x
z^2*x + b*y

id = 1;
eval.pm(p1, list(x=x[id], y=y[id], z=z[id], b=b, R=R))


##############

### Example 2:

n = 5
p1 = toPoly.pm("(x + a)^n + (y + a)^n - R1")
p2 = toPoly.pm("(x + b)*(y + b) - R2")

# Very Naive way to solve:
pR = solve.pm(p1, p2, "y")
str(pR)
table(pR$Rez$x)
# Order 10 with 109 monomials;
# [very naive!]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Oct  3 07:47:41 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 3 Oct 2022 06:47:41 +0100
Subject: [R] Creating a year-month indicator and groupby with category
In-Reply-To: <CAFy_oHDGR7cnNwcTW3mNknKvHhRz+LC4v4XSeKrKEOUjMTcsmA@mail.gmail.com>
References: <CAFy_oHDGR7cnNwcTW3mNknKvHhRz+LC4v4XSeKrKEOUjMTcsmA@mail.gmail.com>
Message-ID: <3a22c0a7-3459-3982-0ff1-cd5df22b842a@sapo.pt>

Hello,

First of all, I'll repost the data at end because the OP posted with a 
pointer ref:

problems = <pointer: 0x7fd732028680>

and this must be removed for the dput output to run.
Suggestion: coerce to class "data.frame" and post the output of


dput(as.data.frame(dat))


Now the plot.
Here are two plots of share by date, grouped by company. One with base R 
graphics and the other one with package ggplot2.

Create a date/time column to be used by both plots.


dat$date <- with(dat, ISOdate(year, month, 1))


1) Base R plot.


ylim <- range(dat$share) + c(0, 2)  # make room for the legend on top
comp <- unique(dat$company)         # draw each line in a loop on companies

# open a blank plot witth all the data,
# setting the ylim as explained above
plot(share ~ date, dat, type = "n", ylim = ylim)
for(i in seq_along(comp)) {
   lines(share ~ date, subset(dat, company == comp[i]), col = i)
}
legend("top", legend = comp, col = seq_along(comp), lty = "solid", horiz 
= TRUE)


2) ggplot2 plot.


library(ggplot2)

ggplot(dat, aes(date, share, color = company)) +
   geom_line() +
   scale_x_datetime(date_labels = "%Y-%m") +
   scale_color_manual(values = c(ABC = "black", FGH = "red")) +
   theme_bw()


3) The data, reposted with the new pipe operator introduced in R 4.1.0 
to make it look modern and slightly edited.


dat |> as.data.frame() |> dput()
dat <-
structure(list(year = c(2018, 2019, 2019, 2019, 2019, 2019, 2019,
2019, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017,
2017, 2017, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,
2018, 2018, 2018, 2019, 2019, 2019, 2019, 2019), month = c(12,
1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1,
2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5), company = c("ABC",
"ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "FGH", "FGH",
"FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
"FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
"FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH"
), share = c(20, 16.5, 15, 15.5, 15.5, 16, 17, 16.5, 61, 55,
53, 53, 54, 53, 58, 54, 50, 47, 55, 50, 52, 51, 51.5, 52, 53,
54, 55, 53, 54, 50, 42, 48, 41, 40, 39, 36.5, 35), com_name = c(1,
1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2), date = 
structure(c(1543665600,
1546344000, 1549022400, 1551441600, 1554120000, 1556712000, 1559390400,
1561982400, 1483272000, 1485950400, 1488369600, 1491048000, 1493640000,
1496318400, 1498910400, 1501588800, 1504267200, 1506859200, 1509537600,
1512129600, 1514808000, 1517486400, 1519905600, 1522584000, 1525176000,
1527854400, 1530446400, 1533124800, 1535803200, 1538395200, 1541073600,
1543665600, 1546344000, 1549022400, 1551441600, 1554120000, 1556712000
), class = c("POSIXct", "POSIXt"), tzone = "GMT")),
row.names = c(NA, -37L), class = "data.frame")


Hope this helps,

Rui Barradas

?s 00:04 de 03/10/2022, Tariq Khasiri escreveu:
> Hello,
> 
> I have the following data. I want to show in a line plot how each different
> company is earning over the timeline of my data sample.
> 
> I'm not sure how I can create the *year-month indicator* to plot it nicely
> in my horizontal axis out of my dataset.
> 
> After creating the *year-month* indicator ( which will be in my x axis) I
> want to create a dataframe where I can groupby companies over the
> year-month indicator by putting *share *in the y axis as variables.
> 
> ### data is like the following
> 
> dput(dat)
> structure(list(year = c(2018, 2019, 2019, 2019, 2019, 2019, 2019,
> 2019, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017,
> 2017, 2017, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,
> 2018, 2018, 2018, 2019, 2019, 2019, 2019, 2019), month = c(12,
> 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1,
> 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5), company = c("ABC",
> "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "FGH", "FGH",
> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH"
> ), share = c(20, 16.5, 15, 15.5, 15.5, 16, 17, 16.5, 61, 55,
> 53, 53, 54, 53, 58, 54, 50, 47, 55, 50, 52, 51, 51.5, 52, 53,
> 54, 55, 53, 54, 50, 42, 48, 41, 40, 39, 36.5, 35), com_name = c(1,
> 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
> 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)), row.names = c(NA,
> -37L), spec = structure(list(cols = list(year = structure(list(), class =
> c("collector_double",
> "collector")), month = structure(list(), class = c("collector_double",
> "collector")), company = structure(list(), class = c("collector_character",
> "collector")), share = structure(list(), class = c("collector_double",
> "collector")), com_name = structure(list(), class = c("collector_double",
> "collector"))), default = structure(list(), class = c("collector_guess",
> "collector")), delim = ","), class = "col_spec"), problems = <pointer:
> 0x7fd732028680>, class = c("spec_tbl_df",
> "tbl_df", "tbl", "data.frame"))
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From drj|m|emon @end|ng |rom gm@||@com  Mon Oct  3 09:45:40 2022
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Mon, 3 Oct 2022 18:45:40 +1100
Subject: [R] Creating a year-month indicator and groupby with category
In-Reply-To: <CAFy_oHDGR7cnNwcTW3mNknKvHhRz+LC4v4XSeKrKEOUjMTcsmA@mail.gmail.com>
References: <CAFy_oHDGR7cnNwcTW3mNknKvHhRz+LC4v4XSeKrKEOUjMTcsmA@mail.gmail.com>
Message-ID: <CA+8X3fUzVS1zKi0BaJoq2ZJC0cgXgPj_rXFNq9vVBpo7HCXojA@mail.gmail.com>

Hi Tariq,
There were a couple of glitches in your data structure. Here's an
example of a simple plot:

dat<-structure(list(year = c(2018, 2019, 2019, 2019, 2019, 2019, 2019,
2019, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017,
2017, 2017, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,
2018, 2018, 2018, 2019, 2019, 2019, 2019, 2019), month = c(12,
1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1,
2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5), company = c("ABC",
"ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "FGH", "FGH",
"FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
"FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
"FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH"
), share = c(20, 16.5, 15, 15.5, 15.5, 16, 17, 16.5, 61, 55,
53, 53, 54, 53, 58, 54, 50, 47, 55, 50, 52, 51, 51.5, 52, 53,
54, 55, 53, 54, 50, 42, 48, 41, 40, 39, 36.5, 35), com_name = c(1,
1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)), row.names = c(NA,
-37L), spec = structure(list(cols = list(year = structure(list(), class =
c("collector_double",
"collector")), month = structure(list(), class = c("collector_double",
"collector")), company = structure(list(), class = c("collector_character",
"collector")), share = structure(list(), class = c("collector_double",
"collector")), com_name = structure(list(), class = c("collector_double",
"collector"))), default = structure(list(), class = c("collector_guess",
"collector")), delim = ","), class = "col_spec"), class = c("spec_tbl_df",
"tbl_df", "tbl", "data.frame"))
# convert year and month fields to dates about the middle of each month
dat$date<-as.Date(paste(dat$year,dat$month,15,sep="-"),"%Y-%m-%d")
# plot the values for one company
plot(dat$date[dat$company=="ABC"],dat$share[dat$company=="ABC"],
 main="Plot of dat",xlab="Year",ylab="Share",
 xlim=range(dat$date),ylim=range(dat$share),
 type="l",col="red")
# add a line for the other one
lines(dat$date[dat$company=="FGH"],dat$share[dat$company=="FGH"],col="green")
# get the x plot limits as they are date values
xspan<-par("usr")[1:2]
# place a legend about in the middle of the plot
legend(xspan[1]+diff(xspan)*0.3,35,c("ABC","FGH"),lty=1,col=c("red","green"))

There are many more elegant ways to plot something like this.

Jim

On Mon, Oct 3, 2022 at 10:05 AM Tariq Khasiri <tariqkhasiri at gmail.com> wrote:
>
> Hello,
>
> I have the following data. I want to show in a line plot how each different
> company is earning over the timeline of my data sample.
>
> I'm not sure how I can create the *year-month indicator* to plot it nicely
> in my horizontal axis out of my dataset.
>
> After creating the *year-month* indicator ( which will be in my x axis) I
> want to create a dataframe where I can groupby companies over the
> year-month indicator by putting *share *in the y axis as variables.
>
> ### data is like the following
>
> dput(dat)
> structure(list(year = c(2018, 2019, 2019, 2019, 2019, 2019, 2019,
> 2019, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017,
> 2017, 2017, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,
> 2018, 2018, 2018, 2019, 2019, 2019, 2019, 2019), month = c(12,
> 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1,
> 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5), company = c("ABC",
> "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "FGH", "FGH",
> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH"
> ), share = c(20, 16.5, 15, 15.5, 15.5, 16, 17, 16.5, 61, 55,
> 53, 53, 54, 53, 58, 54, 50, 47, 55, 50, 52, 51, 51.5, 52, 53,
> 54, 55, 53, 54, 50, 42, 48, 41, 40, 39, 36.5, 35), com_name = c(1,
> 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
> 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)), row.names = c(NA,
> -37L), spec = structure(list(cols = list(year = structure(list(), class =
> c("collector_double",
> "collector")), month = structure(list(), class = c("collector_double",
> "collector")), company = structure(list(), class = c("collector_character",
> "collector")), share = structure(list(), class = c("collector_double",
> "collector")), com_name = structure(list(), class = c("collector_double",
> "collector"))), default = structure(list(), class = c("collector_guess",
> "collector")), delim = ","), class = "col_spec"), problems = <pointer:
> 0x7fd732028680>, class = c("spec_tbl_df",
> "tbl_df", "tbl", "data.frame"))
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From y@ngk@|9999 @end|ng |rom y@hoo@com  Mon Oct  3 17:51:04 2022
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Mon, 3 Oct 2022 15:51:04 +0000 (UTC)
Subject: [R] automatic convert list to dataframe
References: <667635225.2169008.1664812264411.ref@mail.yahoo.com>
Message-ID: <667635225.2169008.1664812264411@mail.yahoo.com>

Hi R team,
I can use rio package to read excel file into R as a list. The excel file content multiple sheets (30 - 40 data sheets). I can convert each data elements into dataframe manually. I have multiple excel files with multiple data sheets. I need to load them into R and do the comparison for same sheet name from difference excel file. My current code is:
 library(rio)? ?setwd ("C:/temp")
filenames <- gsub("\\.xlsx$","", list.files(pattern="\\.xlsx$"))
for(i in filenames){
? assign(i, import_list(paste0(i, ".xlsx", sep="")))
}
file1_dx1? ? ?<-? file1[["dx1"]]

file1_dx2? ? ?<-? file1[["dx2"]]

file1_dx3? ? ?<-? file1[["dx3"]]

file2_dx1? ? ?<-? file1[["dx1"]]

file2_dx2? ? ?<-? file1[["dx2"]]
......

I hope the code can?automatic converting the list (may have 30 - 40 lists) by adding file name (such as: filename_sheetname) and put it in for loop


Thank you,
Kai




	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Oct  3 19:14:19 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 3 Oct 2022 18:14:19 +0100
Subject: [R] automatic convert list to dataframe
In-Reply-To: <667635225.2169008.1664812264411@mail.yahoo.com>
References: <667635225.2169008.1664812264411.ref@mail.yahoo.com>
 <667635225.2169008.1664812264411@mail.yahoo.com>
Message-ID: <ddf82083-4b7e-24d6-e31e-2c868004f391@sapo.pt>

Hello,


list2env(file1, envir = .GlobalEnv)


will create data.frames dx1, dx2, etc, in the global environment.
If you really need the names file1_dx1, file1_dx2, etc, you can first 
change the names


names(file1) <- paste("file1", names(file1), sep = "_")


and then run list2env like above.

Hope this helps,

Rui Barradas

?s 16:51 de 03/10/2022, Kai Yang via R-help escreveu:
> Hi R team,
> I can use rio package to read excel file into R as a list. The excel file content multiple sheets (30 - 40 data sheets). I can convert each data elements into dataframe manually. I have multiple excel files with multiple data sheets. I need to load them into R and do the comparison for same sheet name from difference excel file. My current code is:
>   library(rio)? ?setwd ("C:/temp")
> filenames <- gsub("\\.xlsx$","", list.files(pattern="\\.xlsx$"))
> for(i in filenames){
>  ? assign(i, import_list(paste0(i, ".xlsx", sep="")))
> }
> file1_dx1? ? ?<-? file1[["dx1"]]
> 
> file1_dx2? ? ?<-? file1[["dx2"]]
> 
> file1_dx3? ? ?<-? file1[["dx3"]]
> 
> file2_dx1? ? ?<-? file1[["dx1"]]
> 
> file2_dx2? ? ?<-? file1[["dx2"]]
> ......
> 
> I hope the code can?automatic converting the list (may have 30 - 40 lists) by adding file name (such as: filename_sheetname) and put it in for loop
> 
> 
> Thank you,
> Kai
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From y@ngk@|9999 @end|ng |rom y@hoo@com  Mon Oct  3 19:38:43 2022
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Mon, 3 Oct 2022 17:38:43 +0000 (UTC)
Subject: [R] automatic convert list to dataframe
In-Reply-To: <ddf82083-4b7e-24d6-e31e-2c868004f391@sapo.pt>
References: <667635225.2169008.1664812264411.ref@mail.yahoo.com>
 <667635225.2169008.1664812264411@mail.yahoo.com>
 <ddf82083-4b7e-24d6-e31e-2c868004f391@sapo.pt>
Message-ID: <1293770278.2201006.1664818723656@mail.yahoo.com>

 Hi Rui,
list2env(file1, envir = .GlobalEnv) is worked very well. Thank you.

But when?I tried to put the sample code? into for loop. I got error message:
for(i in filenames){
? assign(i, import_list(paste0(i, ".xlsx", sep="")))
? names(i) <- paste(i, names(i), sep = "_")
? list2env(names(i), envir = .GlobalEnv)
}
Error in list2env(names(i), envir = .GlobalEnv) :?? first argument must be a named list

It seems I cannot put names(i) into for loop,?Could you please help me to debug it?
Thank you,Kai    On Monday, October 3, 2022 at 10:14:25 AM PDT, Rui Barradas <ruipbarradas at sapo.pt> wrote:  
 
 Hello,


list2env(file1, envir = .GlobalEnv)


will create data.frames dx1, dx2, etc, in the global environment.
If you really need the names file1_dx1, file1_dx2, etc, you can first 
change the names


names(file1) <- paste("file1", names(file1), sep = "_")


and then run list2env like above.

Hope this helps,

Rui Barradas

?s 16:51 de 03/10/2022, Kai Yang via R-help escreveu:
> Hi R team,
> I can use rio package to read excel file into R as a list. The excel file content multiple sheets (30 - 40 data sheets). I can convert each data elements into dataframe manually. I have multiple excel files with multiple data sheets. I need to load them into R and do the comparison for same sheet name from difference excel file. My current code is:
>? library(rio)? ?setwd ("C:/temp")
> filenames <- gsub("\\.xlsx$","", list.files(pattern="\\.xlsx$"))
> for(i in filenames){
>? ? assign(i, import_list(paste0(i, ".xlsx", sep="")))
> }
> file1_dx1? ? ?<-? file1[["dx1"]]
> 
> file1_dx2? ? ?<-? file1[["dx2"]]
> 
> file1_dx3? ? ?<-? file1[["dx3"]]
> 
> file2_dx1? ? ?<-? file1[["dx1"]]
> 
> file2_dx2? ? ?<-? file1[["dx2"]]
> ......
> 
> I hope the code can?automatic converting the list (may have 30 - 40 lists) by adding file name (such as: filename_sheetname) and put it in for loop
> 
> 
> Thank you,
> Kai
> 
> 
> 
> 
> ??? [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
  
	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Oct  3 21:08:57 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 3 Oct 2022 20:08:57 +0100
Subject: [R] automatic convert list to dataframe
In-Reply-To: <1293770278.2201006.1664818723656@mail.yahoo.com>
References: <667635225.2169008.1664812264411.ref@mail.yahoo.com>
 <667635225.2169008.1664812264411@mail.yahoo.com>
 <ddf82083-4b7e-24d6-e31e-2c868004f391@sapo.pt>
 <1293770278.2201006.1664818723656@mail.yahoo.com>
Message-ID: <4a102d90-352b-9c07-a83d-7dc9c3054be3@sapo.pt>

Hello,

If in each iteration i is a list, try removing the call to names().
Try, in the loop,


list2env(i, envir = .GlobalEnv)


The error message is telling that list2env's first argument must be a 
named list and names(i) is an unnamed vector, it's i that's the named 
list (you even changed its names in the previous instruction).

Hope this helps,

Rui Barradas

?s 18:38 de 03/10/2022, Kai Yang escreveu:
>   Hi Rui,
> list2env(file1, envir = .GlobalEnv) is worked very well. Thank you.
> 
> But when?I tried to put the sample code? into for loop. I got error message:
> for(i in filenames){
>  ? assign(i, import_list(paste0(i, ".xlsx", sep="")))
>  ? names(i) <- paste(i, names(i), sep = "_")
>  ? list2env(names(i), envir = .GlobalEnv)
> }
> Error in list2env(names(i), envir = .GlobalEnv) :?? first argument must be a named list
> 
> It seems I cannot put names(i) into for loop,?Could you please help me to debug it?
> Thank you,Kai    On Monday, October 3, 2022 at 10:14:25 AM PDT, Rui Barradas <ruipbarradas at sapo.pt> wrote:
>   
>   Hello,
> 
> 
> list2env(file1, envir = .GlobalEnv)
> 
> 
> will create data.frames dx1, dx2, etc, in the global environment.
> If you really need the names file1_dx1, file1_dx2, etc, you can first
> change the names
> 
> 
> names(file1) <- paste("file1", names(file1), sep = "_")
> 
> 
> and then run list2env like above.
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 16:51 de 03/10/2022, Kai Yang via R-help escreveu:
>> Hi R team,
>> I can use rio package to read excel file into R as a list. The excel file content multiple sheets (30 - 40 data sheets). I can convert each data elements into dataframe manually. I have multiple excel files with multiple data sheets. I need to load them into R and do the comparison for same sheet name from difference excel file. My current code is:
>>  ? library(rio)? ?setwd ("C:/temp")
>> filenames <- gsub("\\.xlsx$","", list.files(pattern="\\.xlsx$"))
>> for(i in filenames){
>>  ? ? assign(i, import_list(paste0(i, ".xlsx", sep="")))
>> }
>> file1_dx1? ? ?<-? file1[["dx1"]]
>>
>> file1_dx2? ? ?<-? file1[["dx2"]]
>>
>> file1_dx3? ? ?<-? file1[["dx3"]]
>>
>> file2_dx1? ? ?<-? file1[["dx1"]]
>>
>> file2_dx2? ? ?<-? file1[["dx2"]]
>> ......
>>
>> I hope the code can?automatic converting the list (may have 30 - 40 lists) by adding file name (such as: filename_sheetname) and put it in for loop
>>
>>
>> Thank you,
>> Kai
>>
>>
>>
>>
>>  ??? [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>


From y@ngk@|9999 @end|ng |rom y@hoo@com  Mon Oct  3 21:51:11 2022
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Mon, 3 Oct 2022 19:51:11 +0000 (UTC)
Subject: [R] automatic convert list to dataframe
In-Reply-To: <4a102d90-352b-9c07-a83d-7dc9c3054be3@sapo.pt>
References: <667635225.2169008.1664812264411.ref@mail.yahoo.com>
 <667635225.2169008.1664812264411@mail.yahoo.com>
 <ddf82083-4b7e-24d6-e31e-2c868004f391@sapo.pt>
 <1293770278.2201006.1664818723656@mail.yahoo.com>
 <4a102d90-352b-9c07-a83d-7dc9c3054be3@sapo.pt>
Message-ID: <97481848.2244592.1664826671871@mail.yahoo.com>

 Hi Rui,
I copied "list2env(i, envir = .GlobalEnv)" to the code, but I got the same error message of "first argument must be a named list". Maybe list2env cannot put in loop? the code works very well outside of for loop.
One more thing, the difference file may have same sheet name. that's why I want to add file name in front of sheet name to avoid overwriting. It still works well outside of loop, but doesn't work in loop. I don't know how to fix the problems.
Thank you,
Kai

    On Monday, October 3, 2022 at 12:09:04 PM PDT, Rui Barradas <ruipbarradas at sapo.pt> wrote:  
 
 Hello,

If in each iteration i is a list, try removing the call to names().
Try, in the loop,


list2env(i, envir = .GlobalEnv)


The error message is telling that list2env's first argument must be a 
named list and names(i) is an unnamed vector, it's i that's the named 
list (you even changed its names in the previous instruction).

Hope this helps,

Rui Barradas

?s 18:38 de 03/10/2022, Kai Yang escreveu:
>? Hi Rui,
> list2env(file1, envir = .GlobalEnv) is worked very well. Thank you.
> 
> But when?I tried to put the sample code? into for loop. I got error message:
> for(i in filenames){
>? ? assign(i, import_list(paste0(i, ".xlsx", sep="")))
>? ? names(i) <- paste(i, names(i), sep = "_")
>? ? list2env(names(i), envir = .GlobalEnv)
> }
> Error in list2env(names(i), envir = .GlobalEnv) :?? first argument must be a named list
> 
> It seems I cannot put names(i) into for loop,?Could you please help me to debug it?
> Thank you,Kai? ? On Monday, October 3, 2022 at 10:14:25 AM PDT, Rui Barradas <ruipbarradas at sapo.pt> wrote:
>? 
>? Hello,
> 
> 
> list2env(file1, envir = .GlobalEnv)
> 
> 
> will create data.frames dx1, dx2, etc, in the global environment.
> If you really need the names file1_dx1, file1_dx2, etc, you can first
> change the names
> 
> 
> names(file1) <- paste("file1", names(file1), sep = "_")
> 
> 
> and then run list2env like above.
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 16:51 de 03/10/2022, Kai Yang via R-help escreveu:
>> Hi R team,
>> I can use rio package to read excel file into R as a list. The excel file content multiple sheets (30 - 40 data sheets). I can convert each data elements into dataframe manually. I have multiple excel files with multiple data sheets. I need to load them into R and do the comparison for same sheet name from difference excel file. My current code is:
>>? ? library(rio)? ?setwd ("C:/temp")
>> filenames <- gsub("\\.xlsx$","", list.files(pattern="\\.xlsx$"))
>> for(i in filenames){
>>? ? ? assign(i, import_list(paste0(i, ".xlsx", sep="")))
>> }
>> file1_dx1? ? ?<-? file1[["dx1"]]
>>
>> file1_dx2? ? ?<-? file1[["dx2"]]
>>
>> file1_dx3? ? ?<-? file1[["dx3"]]
>>
>> file2_dx1? ? ?<-? file1[["dx1"]]
>>
>> file2_dx2? ? ?<-? file1[["dx2"]]
>> ......
>>
>> I hope the code can?automatic converting the list (may have 30 - 40 lists) by adding file name (such as: filename_sheetname) and put it in for loop
>>
>>
>> Thank you,
>> Kai
>>
>>
>>
>>
>>? ??? [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>? ? 
  
	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Tue Oct  4 00:04:12 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 3 Oct 2022 23:04:12 +0100
Subject: [R] automatic convert list to dataframe
In-Reply-To: <97481848.2244592.1664826671871@mail.yahoo.com>
References: <667635225.2169008.1664812264411.ref@mail.yahoo.com>
 <667635225.2169008.1664812264411@mail.yahoo.com>
 <ddf82083-4b7e-24d6-e31e-2c868004f391@sapo.pt>
 <1293770278.2201006.1664818723656@mail.yahoo.com>
 <4a102d90-352b-9c07-a83d-7dc9c3054be3@sapo.pt>
 <97481848.2244592.1664826671871@mail.yahoo.com>
Message-ID: <9ce3b94f-6533-5ecb-bc35-584d6877526a@sapo.pt>

Hello,

Here are two more attempts at solving the problem.

1. Instead of having 30-40 data.frames per file in the globalenv, not a 
good idea, the following code will create as many lists as you have 
files and each list is a list of df's.


temp_list <- vector("list", length = length(filenames))
for(i in seq_along(filenames)){
   xlfile <- filenames[i]
   temp_list[[i]] <- import_list(paste0(xlfile, ".xlsx"))
}
list2env(temp_list, envir = .GlobalEnv)
rm(temp_list)

Now you can access the data with code like


file1$dx1       # a data.frame, first sheet in excel file1
file1[["dx1"]]  # equivalent


2. I cannot see a reason why the following shouldn't work. It creates 
lots of data.frames in the globalenv, 30-40 per file. This makes the 
globalenv messy and is not recommended.


temp_list <- vector("list", length = length(filenames))
for(i in seq_along(filenames)){
   # import the data
   xlfile <- filenames[i]
   temp_list[[i]] <- import_list(paste0(xlfile, ".xlsx"))
   # now take care of the names
   new_names <- paste(xlfile, names(temp_list[[i]]), sep = "_")
   names(temp_list[[i]]) <- new_names
   # create the current data.frames in the globalenv
   list2env(temp_list[[i]], envir = .GlobalEnv)
}
rm(temp_list)


Hope this helps,

Rui Barradas


?s 20:51 de 03/10/2022, Kai Yang escreveu:
>   Hi Rui,
> I copied "list2env(i, envir = .GlobalEnv)" to the code, but I got the same error message of "first argument must be a named list". Maybe list2env cannot put in loop? the code works very well outside of for loop.
> One more thing, the difference file may have same sheet name. that's why I want to add file name in front of sheet name to avoid overwriting. It still works well outside of loop, but doesn't work in loop. I don't know how to fix the problems.
> Thank you,
> Kai
> 
>      On Monday, October 3, 2022 at 12:09:04 PM PDT, Rui Barradas <ruipbarradas at sapo.pt> wrote:
>   
>   Hello,
> 
> If in each iteration i is a list, try removing the call to names().
> Try, in the loop,
> 
> 
> list2env(i, envir = .GlobalEnv)
> 
> 
> The error message is telling that list2env's first argument must be a
> named list and names(i) is an unnamed vector, it's i that's the named
> list (you even changed its names in the previous instruction).
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 18:38 de 03/10/2022, Kai Yang escreveu:
>>  ? Hi Rui,
>> list2env(file1, envir = .GlobalEnv) is worked very well. Thank you.
>>
>> But when?I tried to put the sample code? into for loop. I got error message:
>> for(i in filenames){
>>  ? ? assign(i, import_list(paste0(i, ".xlsx", sep="")))
>>  ? ? names(i) <- paste(i, names(i), sep = "_")
>>  ? ? list2env(names(i), envir = .GlobalEnv)
>> }
>> Error in list2env(names(i), envir = .GlobalEnv) :?? first argument must be a named list
>>
>> It seems I cannot put names(i) into for loop,?Could you please help me to debug it?
>> Thank you,Kai? ? On Monday, October 3, 2022 at 10:14:25 AM PDT, Rui Barradas <ruipbarradas at sapo.pt> wrote:
>>    
>>  ? Hello,
>>
>>
>> list2env(file1, envir = .GlobalEnv)
>>
>>
>> will create data.frames dx1, dx2, etc, in the global environment.
>> If you really need the names file1_dx1, file1_dx2, etc, you can first
>> change the names
>>
>>
>> names(file1) <- paste("file1", names(file1), sep = "_")
>>
>>
>> and then run list2env like above.
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>> ?s 16:51 de 03/10/2022, Kai Yang via R-help escreveu:
>>> Hi R team,
>>> I can use rio package to read excel file into R as a list. The excel file content multiple sheets (30 - 40 data sheets). I can convert each data elements into dataframe manually. I have multiple excel files with multiple data sheets. I need to load them into R and do the comparison for same sheet name from difference excel file. My current code is:
>>>  ? ? library(rio)? ?setwd ("C:/temp")
>>> filenames <- gsub("\\.xlsx$","", list.files(pattern="\\.xlsx$"))
>>> for(i in filenames){
>>>  ? ? ? assign(i, import_list(paste0(i, ".xlsx", sep="")))
>>> }
>>> file1_dx1? ? ?<-? file1[["dx1"]]
>>>
>>> file1_dx2? ? ?<-? file1[["dx2"]]
>>>
>>> file1_dx3? ? ?<-? file1[["dx3"]]
>>>
>>> file2_dx1? ? ?<-? file1[["dx1"]]
>>>
>>> file2_dx2? ? ?<-? file1[["dx2"]]
>>> ......
>>>
>>> I hope the code can?automatic converting the list (may have 30 - 40 lists) by adding file name (such as: filename_sheetname) and put it in for loop
>>>
>>>
>>> Thank you,
>>> Kai
>>>
>>>
>>>
>>>
>>>  ? ??? [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>      
>


From t@r|qkh@@|r| @end|ng |rom gm@||@com  Tue Oct  4 00:30:46 2022
From: t@r|qkh@@|r| @end|ng |rom gm@||@com (Tariq Khasiri)
Date: Mon, 3 Oct 2022 17:30:46 -0500
Subject: [R] Creating a year-month indicator and groupby with category
In-Reply-To: <CA+8X3fUzVS1zKi0BaJoq2ZJC0cgXgPj_rXFNq9vVBpo7HCXojA@mail.gmail.com>
References: <CAFy_oHDGR7cnNwcTW3mNknKvHhRz+LC4v4XSeKrKEOUjMTcsmA@mail.gmail.com>
 <CA+8X3fUzVS1zKi0BaJoq2ZJC0cgXgPj_rXFNq9vVBpo7HCXojA@mail.gmail.com>
Message-ID: <CAFy_oHDaT-a=G_PrE768Xhk56MA3JwSqWOYGvogtDoQfF6F7+Q@mail.gmail.com>

Thanks everyone for being so kind and patient with me throughout the
process! Mr. Barradas and Mr. Lemon, very generous of you for taking the
time and patience to go over my code and data , and taking the time to give
me meaningful feedback!

With your help and suggestion, I was successful in making a graph from my
data. In my main data I have four companies, and just making the graph
process a little more advanced. However after writing the command , I get
the error that I have 4 values but gave only 2 values. Would anyone kindly
guide me what's the mistake and how I can rectify this?

Data is the same. But my main data has 4 companies whereas in R project I
just gave 2 only for convenience.

#### Code needed to execute it #########

library(tidyverse)
library(showtext)
library(usefunc)
library(patchwork)
library(cowplot)
library(rcartocolor)
library(zoo)

# load fonts
font_add_google(name = "Bungee Shade", family = "bungee")
font_add_google(name = "Dosis", family = "dosis")
showtext_auto()

# set colours
f_cols = c("#008080", "#329999", "#66b2b2",
           "#7fbfbf", "#99cccc", "#cce5e5")
m_cols = c("#4b0082", "#6e329b", "#9366b4",
           "#a57fc0", "#b799cd", "#dbcce6")

dat$YearMonth <- as.yearmon(paste(dat$year, " ", dat$month), "%Y %m")

# plot of share of companies per year
p1 <- ggplot(data = dat,
             mapping = aes(x = YearMonth, y = share, colour = company)) +
  geom_line() +
  geom_point(size = 1) +
  scale_colour_manual("", values = c(f_cols[1], m_cols[1]), labels = c("F",
"M" , "C" , "G")) +
  scale_y_continuous(limits = c(0, 80)) +
  coord_cartesian(expand = F) +
  labs(x = "Year",
       y = "Share of Companies") +
  theme(legend.position = c(0.1, 0.9),
        legend.title = element_blank(),
        legend.text = element_text(family = "dosis", size = 14),
        panel.background = element_rect(fill = "#FAFAFA", colour =
"#FAFAFA"),
        plot.background = element_rect(fill = "#FAFAFA", colour =
"#FAFAFA"),
        legend.background = element_rect(fill = "transparent", colour =
"transparent"),
        legend.key = element_rect(fill = "transparent", colour =
"transparent"),
        axis.title.y = element_text(margin = margin(0, 20, 0, 0), family =
"dosis"),
        axis.text = element_text(family = "dosis"),
        plot.margin = unit(c(0.5, 0.8, 0.5, 0.5), "cm"),
        panel.grid.major = element_line(colour = "#DEDEDE"),
        panel.grid.minor = element_blank())
p1

The error is saying :

??ggplot2 (local) FUN(X[[i]], ...)
  7.         ??base::unlist(...)
  8.         ??base::lapply(scales$scales, function(scale) scale$map_df(df
= df))
  9.           ??ggplot2 (local) FUN(X[[i]], ...)
 10.             ??scale$map_df(df = df)
 11.               ??ggplot2 (local) f(..., self = self)
 12.                 ??base::lapply(aesthetics, function(j)
self$map(df[[j]]))
 13.                   ??ggplot2 (local) FUN(X[[i]], ...)
 14.                     ??self$map(df[[j]])
 15.                       ??ggplot2 (local) f(..., self = self)
 16.                         ??self$palette(n)
 17.                           ??ggplot2 (local) f(...)
 18.                             ??rlang::abort(glue("Insufficient values
in manual scale. {n} needed but only {length(values)} provided."))

On Mon, 3 Oct 2022 at 02:45, Jim Lemon <drjimlemon at gmail.com> wrote:

> Hi Tariq,
> There were a couple of glitches in your data structure. Here's an
> example of a simple plot:
>
> dat<-structure(list(year = c(2018, 2019, 2019, 2019, 2019, 2019, 2019,
> 2019, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017,
> 2017, 2017, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,
> 2018, 2018, 2018, 2019, 2019, 2019, 2019, 2019), month = c(12,
> 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1,
> 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5), company = c("ABC",
> "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "FGH", "FGH",
> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH"
> ), share = c(20, 16.5, 15, 15.5, 15.5, 16, 17, 16.5, 61, 55,
> 53, 53, 54, 53, 58, 54, 50, 47, 55, 50, 52, 51, 51.5, 52, 53,
> 54, 55, 53, 54, 50, 42, 48, 41, 40, 39, 36.5, 35), com_name = c(1,
> 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
> 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)), row.names = c(NA,
> -37L), spec = structure(list(cols = list(year = structure(list(), class =
> c("collector_double",
> "collector")), month = structure(list(), class = c("collector_double",
> "collector")), company = structure(list(), class = c("collector_character",
> "collector")), share = structure(list(), class = c("collector_double",
> "collector")), com_name = structure(list(), class = c("collector_double",
> "collector"))), default = structure(list(), class = c("collector_guess",
> "collector")), delim = ","), class = "col_spec"), class = c("spec_tbl_df",
> "tbl_df", "tbl", "data.frame"))
> # convert year and month fields to dates about the middle of each month
> dat$date<-as.Date(paste(dat$year,dat$month,15,sep="-"),"%Y-%m-%d")
> # plot the values for one company
> plot(dat$date[dat$company=="ABC"],dat$share[dat$company=="ABC"],
>  main="Plot of dat",xlab="Year",ylab="Share",
>  xlim=range(dat$date),ylim=range(dat$share),
>  type="l",col="red")
> # add a line for the other one
>
> lines(dat$date[dat$company=="FGH"],dat$share[dat$company=="FGH"],col="green")
> # get the x plot limits as they are date values
> xspan<-par("usr")[1:2]
> # place a legend about in the middle of the plot
>
> legend(xspan[1]+diff(xspan)*0.3,35,c("ABC","FGH"),lty=1,col=c("red","green"))
>
> There are many more elegant ways to plot something like this.
>
> Jim
>
> On Mon, Oct 3, 2022 at 10:05 AM Tariq Khasiri <tariqkhasiri at gmail.com>
> wrote:
> >
> > Hello,
> >
> > I have the following data. I want to show in a line plot how each
> different
> > company is earning over the timeline of my data sample.
> >
> > I'm not sure how I can create the *year-month indicator* to plot it
> nicely
> > in my horizontal axis out of my dataset.
> >
> > After creating the *year-month* indicator ( which will be in my x axis) I
> > want to create a dataframe where I can groupby companies over the
> > year-month indicator by putting *share *in the y axis as variables.
> >
> > ### data is like the following
> >
> > dput(dat)
> > structure(list(year = c(2018, 2019, 2019, 2019, 2019, 2019, 2019,
> > 2019, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017,
> > 2017, 2017, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,
> > 2018, 2018, 2018, 2019, 2019, 2019, 2019, 2019), month = c(12,
> > 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1,
> > 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5), company = c("ABC",
> > "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "FGH", "FGH",
> > "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
> > "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
> > "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH"
> > ), share = c(20, 16.5, 15, 15.5, 15.5, 16, 17, 16.5, 61, 55,
> > 53, 53, 54, 53, 58, 54, 50, 47, 55, 50, 52, 51, 51.5, 52, 53,
> > 54, 55, 53, 54, 50, 42, 48, 41, 40, 39, 36.5, 35), com_name = c(1,
> > 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
> > 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)), row.names = c(NA,
> > -37L), spec = structure(list(cols = list(year = structure(list(), class =
> > c("collector_double",
> > "collector")), month = structure(list(), class = c("collector_double",
> > "collector")), company = structure(list(), class =
> c("collector_character",
> > "collector")), share = structure(list(), class = c("collector_double",
> > "collector")), com_name = structure(list(), class = c("collector_double",
> > "collector"))), default = structure(list(), class = c("collector_guess",
> > "collector")), delim = ","), class = "col_spec"), problems = <pointer:
> > 0x7fd732028680>, class = c("spec_tbl_df",
> > "tbl_df", "tbl", "data.frame"))
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Tue Oct  4 00:41:34 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 3 Oct 2022 15:41:34 -0700
Subject: [R] automatic convert list to dataframe
In-Reply-To: <9ce3b94f-6533-5ecb-bc35-584d6877526a@sapo.pt>
References: <667635225.2169008.1664812264411.ref@mail.yahoo.com>
 <667635225.2169008.1664812264411@mail.yahoo.com>
 <ddf82083-4b7e-24d6-e31e-2c868004f391@sapo.pt>
 <1293770278.2201006.1664818723656@mail.yahoo.com>
 <4a102d90-352b-9c07-a83d-7dc9c3054be3@sapo.pt>
 <97481848.2244592.1664826671871@mail.yahoo.com>
 <9ce3b94f-6533-5ecb-bc35-584d6877526a@sapo.pt>
Message-ID: <CAGxFJbT-xm49epvu1cU2cffpD4u1FMaLe=Y031PGg97kTU+aTg@mail.gmail.com>

... But why not dispense with multiple files, name juggling, and
environments by simply putting everything in one list of lists (lists are
recursive structures!):

all_files <- lapply(filenames, function(nm)import_list(nm,...))
names(all_files) <- filenames
## Note: the ... are any optional parameters to import_list() that may be
needed.
## Perhaps none.

all_files will then be a single list, each of whose components is a list of
data frames for all the sheets in the file. I would think that such a list
could easily be accessed and manipulated via list indexing and
*apply-family functions. Just seems like a more straightforward approach to
me (assuming I haven't misunderstood, of course).

Bert




On Mon, Oct 3, 2022 at 3:04 PM Rui Barradas <ruipbarradas at sapo.pt> wrote:

> Hello,
>
> Here are two more attempts at solving the problem.
>
> 1. Instead of having 30-40 data.frames per file in the globalenv, not a
> good idea, the following code will create as many lists as you have
> files and each list is a list of df's.
>
>
> temp_list <- vector("list", length = length(filenames))
> for(i in seq_along(filenames)){
>    xlfile <- filenames[i]
>    temp_list[[i]] <- import_list(paste0(xlfile, ".xlsx"))
> }
> list2env(temp_list, envir = .GlobalEnv)
> rm(temp_list)
>
> Now you can access the data with code like
>
>
> file1$dx1       # a data.frame, first sheet in excel file1
> file1[["dx1"]]  # equivalent
>
>
> 2. I cannot see a reason why the following shouldn't work. It creates
> lots of data.frames in the globalenv, 30-40 per file. This makes the
> globalenv messy and is not recommended.
>
>
> temp_list <- vector("list", length = length(filenames))
> for(i in seq_along(filenames)){
>    # import the data
>    xlfile <- filenames[i]
>    temp_list[[i]] <- import_list(paste0(xlfile, ".xlsx"))
>    # now take care of the names
>    new_names <- paste(xlfile, names(temp_list[[i]]), sep = "_")
>    names(temp_list[[i]]) <- new_names
>    # create the current data.frames in the globalenv
>    list2env(temp_list[[i]], envir = .GlobalEnv)
> }
> rm(temp_list)
>
>
> Hope this helps,
>
> Rui Barradas
>
>
> ?s 20:51 de 03/10/2022, Kai Yang escreveu:
> >   Hi Rui,
> > I copied "list2env(i, envir = .GlobalEnv)" to the code, but I got the
> same error message of "first argument must be a named list". Maybe list2env
> cannot put in loop? the code works very well outside of for loop.
> > One more thing, the difference file may have same sheet name. that's why
> I want to add file name in front of sheet name to avoid overwriting. It
> still works well outside of loop, but doesn't work in loop. I don't know
> how to fix the problems.
> > Thank you,
> > Kai
> >
> >      On Monday, October 3, 2022 at 12:09:04 PM PDT, Rui Barradas <
> ruipbarradas at sapo.pt> wrote:
> >
> >   Hello,
> >
> > If in each iteration i is a list, try removing the call to names().
> > Try, in the loop,
> >
> >
> > list2env(i, envir = .GlobalEnv)
> >
> >
> > The error message is telling that list2env's first argument must be a
> > named list and names(i) is an unnamed vector, it's i that's the named
> > list (you even changed its names in the previous instruction).
> >
> > Hope this helps,
> >
> > Rui Barradas
> >
> > ?s 18:38 de 03/10/2022, Kai Yang escreveu:
> >>    Hi Rui,
> >> list2env(file1, envir = .GlobalEnv) is worked very well. Thank you.
> >>
> >> But when I tried to put the sample code  into for loop. I got error
> message:
> >> for(i in filenames){
> >>      assign(i, import_list(paste0(i, ".xlsx", sep="")))
> >>      names(i) <- paste(i, names(i), sep = "_")
> >>      list2env(names(i), envir = .GlobalEnv)
> >> }
> >> Error in list2env(names(i), envir = .GlobalEnv) :   first argument must
> be a named list
> >>
> >> It seems I cannot put names(i) into for loop, Could you please help me
> to debug it?
> >> Thank you,Kai    On Monday, October 3, 2022 at 10:14:25 AM PDT, Rui
> Barradas <ruipbarradas at sapo.pt> wrote:
> >>
> >>    Hello,
> >>
> >>
> >> list2env(file1, envir = .GlobalEnv)
> >>
> >>
> >> will create data.frames dx1, dx2, etc, in the global environment.
> >> If you really need the names file1_dx1, file1_dx2, etc, you can first
> >> change the names
> >>
> >>
> >> names(file1) <- paste("file1", names(file1), sep = "_")
> >>
> >>
> >> and then run list2env like above.
> >>
> >> Hope this helps,
> >>
> >> Rui Barradas
> >>
> >> ?s 16:51 de 03/10/2022, Kai Yang via R-help escreveu:
> >>> Hi R team,
> >>> I can use rio package to read excel file into R as a list. The excel
> file content multiple sheets (30 - 40 data sheets). I can convert each data
> elements into dataframe manually. I have multiple excel files with multiple
> data sheets. I need to load them into R and do the comparison for same
> sheet name from difference excel file. My current code is:
> >>>      library(rio)   setwd ("C:/temp")
> >>> filenames <- gsub("\\.xlsx$","", list.files(pattern="\\.xlsx$"))
> >>> for(i in filenames){
> >>>        assign(i, import_list(paste0(i, ".xlsx", sep="")))
> >>> }
> >>> file1_dx1     <-  file1[["dx1"]]
> >>>
> >>> file1_dx2     <-  file1[["dx2"]]
> >>>
> >>> file1_dx3     <-  file1[["dx3"]]
> >>>
> >>> file2_dx1     <-  file1[["dx1"]]
> >>>
> >>> file2_dx2     <-  file1[["dx2"]]
> >>> ......
> >>>
> >>> I hope the code can automatic converting the list (may have 30 - 40
> lists) by adding file name (such as: filename_sheetname) and put it in for
> loop
> >>>
> >>>
> >>> Thank you,
> >>> Kai
> >>>
> >>>
> >>>
> >>>
> >>>        [[alternative HTML version deleted]]
> >>>
> >>> ______________________________________________
> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >>> and provide commented, minimal, self-contained, reproducible code.
> >>
> >
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From y@ngk@|9999 @end|ng |rom y@hoo@com  Tue Oct  4 01:08:14 2022
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Mon, 3 Oct 2022 23:08:14 +0000 (UTC)
Subject: [R] automatic convert list to dataframe
In-Reply-To: <CAGxFJbT-xm49epvu1cU2cffpD4u1FMaLe=Y031PGg97kTU+aTg@mail.gmail.com>
References: <667635225.2169008.1664812264411.ref@mail.yahoo.com>
 <667635225.2169008.1664812264411@mail.yahoo.com>
 <ddf82083-4b7e-24d6-e31e-2c868004f391@sapo.pt>
 <1293770278.2201006.1664818723656@mail.yahoo.com>
 <4a102d90-352b-9c07-a83d-7dc9c3054be3@sapo.pt>
 <97481848.2244592.1664826671871@mail.yahoo.com>
 <9ce3b94f-6533-5ecb-bc35-584d6877526a@sapo.pt>
 <CAGxFJbT-xm49epvu1cU2cffpD4u1FMaLe=Y031PGg97kTU+aTg@mail.gmail.com>
Message-ID: <1316789341.2303013.1664838494147@mail.yahoo.com>

 Hello Rui and Bert,
This is a great help! Thank you both!
Here is my job assignment: boss accumulate many years excel reports from same lab. Each report contents multiple data sheets. Those sheets may/may not updated, and some sheets are new. Good news is, the same testing result data will be saved in a data sheet and assign the same sheet name with same fields name, but does not in same file. Boss wants me to get non.duplicate data for difference testing from those excel files. So, I want to load all data into R and assign each data frame name as filename_sheetname. I use the 2nd suggestion from Rui to get this step done! Thanks Rui again. This method save a lot of time for me. Now, I can combine data frames (same _sheetname) together and remove duplicate.
Best,
Kai
    On Monday, October 3, 2022 at 03:41:45 PM PDT, Bert Gunter <bgunter.4567 at gmail.com> wrote:  
 
 ... But why not dispense with multiple files, name juggling, and environments by simply putting everything in one list of lists (lists are recursive structures!):

all_files <- lapply(filenames, function(nm)import_list(nm,...))names(all_files) <- filenames
## Note: the ... are any optional parameters to import_list() that may be needed. 
## Perhaps none.

all_files will then be a single list, each of whose components is a list of data frames for all the sheets in the file. I would think that such a list could easily be accessed and manipulated via list indexing and *apply-family functions. Just seems like a more straightforward approach to me (assuming I haven't misunderstood, of course).
Bert




On Mon, Oct 3, 2022 at 3:04 PM Rui Barradas <ruipbarradas at sapo.pt> wrote:

Hello,

Here are two more attempts at solving the problem.

1. Instead of having 30-40 data.frames per file in the globalenv, not a 
good idea, the following code will create as many lists as you have 
files and each list is a list of df's.


temp_list <- vector("list", length = length(filenames))
for(i in seq_along(filenames)){
? ?xlfile <- filenames[i]
? ?temp_list[[i]] <- import_list(paste0(xlfile, ".xlsx"))
}
list2env(temp_list, envir = .GlobalEnv)
rm(temp_list)

Now you can access the data with code like


file1$dx1? ? ? ?# a data.frame, first sheet in excel file1
file1[["dx1"]]? # equivalent


2. I cannot see a reason why the following shouldn't work. It creates 
lots of data.frames in the globalenv, 30-40 per file. This makes the 
globalenv messy and is not recommended.


temp_list <- vector("list", length = length(filenames))
for(i in seq_along(filenames)){
? ?# import the data
? ?xlfile <- filenames[i]
? ?temp_list[[i]] <- import_list(paste0(xlfile, ".xlsx"))
? ?# now take care of the names
? ?new_names <- paste(xlfile, names(temp_list[[i]]), sep = "_")
? ?names(temp_list[[i]]) <- new_names
? ?# create the current data.frames in the globalenv
? ?list2env(temp_list[[i]], envir = .GlobalEnv)
}
rm(temp_list)


Hope this helps,

Rui Barradas


?s 20:51 de 03/10/2022, Kai Yang escreveu:
>? ?Hi Rui,
> I copied "list2env(i, envir = .GlobalEnv)" to the code, but I got the same error message of "first argument must be a named list". Maybe list2env cannot put in loop? the code works very well outside of for loop.
> One more thing, the difference file may have same sheet name. that's why I want to add file name in front of sheet name to avoid overwriting. It still works well outside of loop, but doesn't work in loop. I don't know how to fix the problems.
> Thank you,
> Kai
> 
>? ? ? On Monday, October 3, 2022 at 12:09:04 PM PDT, Rui Barradas <ruipbarradas at sapo.pt> wrote:
>? ?
>? ?Hello,
> 
> If in each iteration i is a list, try removing the call to names().
> Try, in the loop,
> 
> 
> list2env(i, envir = .GlobalEnv)
> 
> 
> The error message is telling that list2env's first argument must be a
> named list and names(i) is an unnamed vector, it's i that's the named
> list (you even changed its names in the previous instruction).
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 18:38 de 03/10/2022, Kai Yang escreveu:
>>? ? Hi Rui,
>> list2env(file1, envir = .GlobalEnv) is worked very well. Thank you.
>>
>> But when?I tried to put the sample code? into for loop. I got error message:
>> for(i in filenames){
>>? ? ? assign(i, import_list(paste0(i, ".xlsx", sep="")))
>>? ? ? names(i) <- paste(i, names(i), sep = "_")
>>? ? ? list2env(names(i), envir = .GlobalEnv)
>> }
>> Error in list2env(names(i), envir = .GlobalEnv) :?? first argument must be a named list
>>
>> It seems I cannot put names(i) into for loop,?Could you please help me to debug it?
>> Thank you,Kai? ? On Monday, October 3, 2022 at 10:14:25 AM PDT, Rui Barradas <ruipbarradas at sapo.pt> wrote:
>>? ? 
>>? ? Hello,
>>
>>
>> list2env(file1, envir = .GlobalEnv)
>>
>>
>> will create data.frames dx1, dx2, etc, in the global environment.
>> If you really need the names file1_dx1, file1_dx2, etc, you can first
>> change the names
>>
>>
>> names(file1) <- paste("file1", names(file1), sep = "_")
>>
>>
>> and then run list2env like above.
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>> ?s 16:51 de 03/10/2022, Kai Yang via R-help escreveu:
>>> Hi R team,
>>> I can use rio package to read excel file into R as a list. The excel file content multiple sheets (30 - 40 data sheets). I can convert each data elements into dataframe manually. I have multiple excel files with multiple data sheets. I need to load them into R and do the comparison for same sheet name from difference excel file. My current code is:
>>>? ? ? library(rio)? ?setwd ("C:/temp")
>>> filenames <- gsub("\\.xlsx$","", list.files(pattern="\\.xlsx$"))
>>> for(i in filenames){
>>>? ? ? ? assign(i, import_list(paste0(i, ".xlsx", sep="")))
>>> }
>>> file1_dx1? ? ?<-? file1[["dx1"]]
>>>
>>> file1_dx2? ? ?<-? file1[["dx2"]]
>>>
>>> file1_dx3? ? ?<-? file1[["dx3"]]
>>>
>>> file2_dx1? ? ?<-? file1[["dx1"]]
>>>
>>> file2_dx2? ? ?<-? file1[["dx2"]]
>>> ......
>>>
>>> I hope the code can?automatic converting the list (may have 30 - 40 lists) by adding file name (such as: filename_sheetname) and put it in for loop
>>>
>>>
>>> Thank you,
>>> Kai
>>>
>>>
>>>
>>>
>>>? ? ??? [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>? ? ? 
>

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

  
	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Tue Oct  4 08:23:29 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Tue, 4 Oct 2022 07:23:29 +0100
Subject: [R] Creating a year-month indicator and groupby with category
In-Reply-To: <CAFy_oHDaT-a=G_PrE768Xhk56MA3JwSqWOYGvogtDoQfF6F7+Q@mail.gmail.com>
References: <CAFy_oHDGR7cnNwcTW3mNknKvHhRz+LC4v4XSeKrKEOUjMTcsmA@mail.gmail.com>
 <CA+8X3fUzVS1zKi0BaJoq2ZJC0cgXgPj_rXFNq9vVBpo7HCXojA@mail.gmail.com>
 <CAFy_oHDaT-a=G_PrE768Xhk56MA3JwSqWOYGvogtDoQfF6F7+Q@mail.gmail.com>
Message-ID: <7e07b891-b085-910d-0c32-c6ad693b9cb4@sapo.pt>

Hello,

The error comes from having 2 colors and 4 labels in


scale_colour_manual("", values = c(f_cols[1], m_cols[1]), labels = 
c("F", "M" , "C" , "G"))


You need the same number of colors and labels. For instance, though 
they're probably not the colors you want the following vector has 4 
colors and the plot code doesn't give an error.


values = c(f_cols[1], m_cols[1], f_cols[2], m_cols[2])



Besides, why are you defining 2 colors vectors with 6 colors each if you 
only have 4 companies?

Hope this helps,

Rui Barradas

?s 23:30 de 03/10/2022, Tariq Khasiri escreveu:
> Thanks everyone for being so kind and patient with me throughout the
> process! Mr. Barradas and Mr. Lemon, very generous of you for taking the
> time and patience to go over my code and data , and taking the time to give
> me meaningful feedback!
> 
> With your help and suggestion, I was successful in making a graph from my
> data. In my main data I have four companies, and just making the graph
> process a little more advanced. However after writing the command , I get
> the error that I have 4 values but gave only 2 values. Would anyone kindly
> guide me what's the mistake and how I can rectify this?
> 
> Data is the same. But my main data has 4 companies whereas in R project I
> just gave 2 only for convenience.
> 
> #### Code needed to execute it #########
> 
> library(tidyverse)
> library(showtext)
> library(usefunc)
> library(patchwork)
> library(cowplot)
> library(rcartocolor)
> library(zoo)
> 
> # load fonts
> font_add_google(name = "Bungee Shade", family = "bungee")
> font_add_google(name = "Dosis", family = "dosis")
> showtext_auto()
> 
> # set colours
> f_cols = c("#008080", "#329999", "#66b2b2",
>             "#7fbfbf", "#99cccc", "#cce5e5")
> m_cols = c("#4b0082", "#6e329b", "#9366b4",
>             "#a57fc0", "#b799cd", "#dbcce6")
> 
> dat$YearMonth <- as.yearmon(paste(dat$year, " ", dat$month), "%Y %m")
> 
> # plot of share of companies per year
> p1 <- ggplot(data = dat,
>               mapping = aes(x = YearMonth, y = share, colour = company)) +
>    geom_line() +
>    geom_point(size = 1) +
>    scale_colour_manual("", values = c(f_cols[1], m_cols[1]), labels = c("F",
> "M" , "C" , "G")) +
>    scale_y_continuous(limits = c(0, 80)) +
>    coord_cartesian(expand = F) +
>    labs(x = "Year",
>         y = "Share of Companies") +
>    theme(legend.position = c(0.1, 0.9),
>          legend.title = element_blank(),
>          legend.text = element_text(family = "dosis", size = 14),
>          panel.background = element_rect(fill = "#FAFAFA", colour =
> "#FAFAFA"),
>          plot.background = element_rect(fill = "#FAFAFA", colour =
> "#FAFAFA"),
>          legend.background = element_rect(fill = "transparent", colour =
> "transparent"),
>          legend.key = element_rect(fill = "transparent", colour =
> "transparent"),
>          axis.title.y = element_text(margin = margin(0, 20, 0, 0), family =
> "dosis"),
>          axis.text = element_text(family = "dosis"),
>          plot.margin = unit(c(0.5, 0.8, 0.5, 0.5), "cm"),
>          panel.grid.major = element_line(colour = "#DEDEDE"),
>          panel.grid.minor = element_blank())
> p1
> 
> The error is saying :
> 
> ??ggplot2 (local) FUN(X[[i]], ...)
>    7.         ??base::unlist(...)
>    8.         ??base::lapply(scales$scales, function(scale) scale$map_df(df
> = df))
>    9.           ??ggplot2 (local) FUN(X[[i]], ...)
>   10.             ??scale$map_df(df = df)
>   11.               ??ggplot2 (local) f(..., self = self)
>   12.                 ??base::lapply(aesthetics, function(j)
> self$map(df[[j]]))
>   13.                   ??ggplot2 (local) FUN(X[[i]], ...)
>   14.                     ??self$map(df[[j]])
>   15.                       ??ggplot2 (local) f(..., self = self)
>   16.                         ??self$palette(n)
>   17.                           ??ggplot2 (local) f(...)
>   18.                             ??rlang::abort(glue("Insufficient values
> in manual scale. {n} needed but only {length(values)} provided."))
> 
> On Mon, 3 Oct 2022 at 02:45, Jim Lemon <drjimlemon at gmail.com> wrote:
> 
>> Hi Tariq,
>> There were a couple of glitches in your data structure. Here's an
>> example of a simple plot:
>>
>> dat<-structure(list(year = c(2018, 2019, 2019, 2019, 2019, 2019, 2019,
>> 2019, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017,
>> 2017, 2017, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,
>> 2018, 2018, 2018, 2019, 2019, 2019, 2019, 2019), month = c(12,
>> 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1,
>> 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5), company = c("ABC",
>> "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "FGH", "FGH",
>> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
>> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
>> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH"
>> ), share = c(20, 16.5, 15, 15.5, 15.5, 16, 17, 16.5, 61, 55,
>> 53, 53, 54, 53, 58, 54, 50, 47, 55, 50, 52, 51, 51.5, 52, 53,
>> 54, 55, 53, 54, 50, 42, 48, 41, 40, 39, 36.5, 35), com_name = c(1,
>> 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
>> 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)), row.names = c(NA,
>> -37L), spec = structure(list(cols = list(year = structure(list(), class =
>> c("collector_double",
>> "collector")), month = structure(list(), class = c("collector_double",
>> "collector")), company = structure(list(), class = c("collector_character",
>> "collector")), share = structure(list(), class = c("collector_double",
>> "collector")), com_name = structure(list(), class = c("collector_double",
>> "collector"))), default = structure(list(), class = c("collector_guess",
>> "collector")), delim = ","), class = "col_spec"), class = c("spec_tbl_df",
>> "tbl_df", "tbl", "data.frame"))
>> # convert year and month fields to dates about the middle of each month
>> dat$date<-as.Date(paste(dat$year,dat$month,15,sep="-"),"%Y-%m-%d")
>> # plot the values for one company
>> plot(dat$date[dat$company=="ABC"],dat$share[dat$company=="ABC"],
>>   main="Plot of dat",xlab="Year",ylab="Share",
>>   xlim=range(dat$date),ylim=range(dat$share),
>>   type="l",col="red")
>> # add a line for the other one
>>
>> lines(dat$date[dat$company=="FGH"],dat$share[dat$company=="FGH"],col="green")
>> # get the x plot limits as they are date values
>> xspan<-par("usr")[1:2]
>> # place a legend about in the middle of the plot
>>
>> legend(xspan[1]+diff(xspan)*0.3,35,c("ABC","FGH"),lty=1,col=c("red","green"))
>>
>> There are many more elegant ways to plot something like this.
>>
>> Jim
>>
>> On Mon, Oct 3, 2022 at 10:05 AM Tariq Khasiri <tariqkhasiri at gmail.com>
>> wrote:
>>>
>>> Hello,
>>>
>>> I have the following data. I want to show in a line plot how each
>> different
>>> company is earning over the timeline of my data sample.
>>>
>>> I'm not sure how I can create the *year-month indicator* to plot it
>> nicely
>>> in my horizontal axis out of my dataset.
>>>
>>> After creating the *year-month* indicator ( which will be in my x axis) I
>>> want to create a dataframe where I can groupby companies over the
>>> year-month indicator by putting *share *in the y axis as variables.
>>>
>>> ### data is like the following
>>>
>>> dput(dat)
>>> structure(list(year = c(2018, 2019, 2019, 2019, 2019, 2019, 2019,
>>> 2019, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2017,
>>> 2017, 2017, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018,
>>> 2018, 2018, 2018, 2019, 2019, 2019, 2019, 2019), month = c(12,
>>> 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1,
>>> 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5), company = c("ABC",
>>> "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "ABC", "FGH", "FGH",
>>> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
>>> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH",
>>> "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH", "FGH"
>>> ), share = c(20, 16.5, 15, 15.5, 15.5, 16, 17, 16.5, 61, 55,
>>> 53, 53, 54, 53, 58, 54, 50, 47, 55, 50, 52, 51, 51.5, 52, 53,
>>> 54, 55, 53, 54, 50, 42, 48, 41, 40, 39, 36.5, 35), com_name = c(1,
>>> 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
>>> 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)), row.names = c(NA,
>>> -37L), spec = structure(list(cols = list(year = structure(list(), class =
>>> c("collector_double",
>>> "collector")), month = structure(list(), class = c("collector_double",
>>> "collector")), company = structure(list(), class =
>> c("collector_character",
>>> "collector")), share = structure(list(), class = c("collector_double",
>>> "collector")), com_name = structure(list(), class = c("collector_double",
>>> "collector"))), default = structure(list(), class = c("collector_guess",
>>> "collector")), delim = ","), class = "col_spec"), problems = <pointer:
>>> 0x7fd732028680>, class = c("spec_tbl_df",
>>> "tbl_df", "tbl", "data.frame"))
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From Er|c@RhonC@|deron @end|ng |rom pennmed|c|ne@upenn@edu  Tue Oct  4 15:36:59 2022
From: Er|c@RhonC@|deron @end|ng |rom pennmed|c|ne@upenn@edu (Rhon Calderon, Eric)
Date: Tue, 4 Oct 2022 13:36:59 +0000
Subject: [R] Help executing R on High Performance Cluster
Message-ID: <MN2PR04MB6400AA8141307B71683D51F8CB5A9@MN2PR04MB6400.namprd04.prod.outlook.com>

Hi,

I need some help executing recently downloaded R on my HPC.

Here is the script I used to install R on my HPC module:


wget https://cran.r-project.org/src/base-prerelease/R-devel.tar.gz

tar -xvf R-devel.tar.gz

cd /home/ericrhon/labsoftware/R-devel/

./configure --prefix=/home/ericrhon/labsoftware/R-devel -with-recommended-packages=no --without-x --with-cairo --with-libpng --with-libtiff --with-jpeglib --enable-R-shlib --with-pcre1

make

make install

After I installed, I tried to run /home/ericrhon/labsoftware/R-devel/R. But I get the next error:


/home/ericrhon/labsoftware/R-devel/bin/exec/R: line 272: /home/ericrhon/labsoftware/R-devel/bin/exec/R: Argument list too long

/home/ericrhon/labsoftware/R-devel/bin/exec/R: line 272: /home/ericrhon/labsoftware/R-devel/bin/exec/R: Success

Here is the exec script of R, line 272 is highlighted:


#!/bin/sh

# Shell wrapper for R executable.


R_HOME_DIR="/home/ericrhon/labsoftware/R-devel"

if test "${R_HOME_DIR}" = "/home/ericrhon/labsoftware/shared_Renv/versions/R-devel/lib64/R"; then

   case "linux-gnu" in

   linux*)

     run_arch=`uname -m`

     case "$run_arch" in

        x86_64|mips64|ppc64|powerpc64|sparc64|s390x)

          libnn=lib64

          libnn_fallback=lib

        ;;

        *)

          libnn=lib

          libnn_fallback=lib64

        ;;

     esac

     if [ -x "/home/ericrhon/labsoftware/shared_Renv/versions/R-devel/${libnn}/R/bin/exec/R" ]; then

        R_HOME_DIR="/home/ericrhon/labsoftware/shared_Renv/versions/R-devel/${libnn}/R"

     elif [ -x "/home/ericrhon/labsoftware/shared_Renv/versions/R-devel/${libnn_fallback}/R/bin/exec/R" ]; then

        R_HOME_DIR="/home/ericrhon/labsoftware/shared_Renv/versions/R-devel/${libnn_fallback}/R"

     ## else -- leave alone (might be a sub-arch)

     fi

     ;;

  esac

fi


if test -n "${R_HOME}" && \

   test "${R_HOME}" != "${R_HOME_DIR}"; then

  echo "WARNING: ignoring environment value of R_HOME"

fi

R_HOME="${R_HOME_DIR}"

export R_HOME

R_SHARE_DIR="${R_HOME_DIR}/share"

export R_SHARE_DIR

R_INCLUDE_DIR="${R_HOME_DIR}/include"

export R_INCLUDE_DIR

R_DOC_DIR="${R_HOME_DIR}/doc"

export R_DOC_DIR


# Since this script can be called recursively, we allow R_ARCH to

# be overridden from the environment.

# This script is shared by parallel installs, so nothing in it should

# depend on the sub-architecture except the default here.

: ${R_ARCH=}


usage="

Usage: R [options] [< infile] [> outfile]

   or: R CMD command [arguments]


Start R, a system for statistical computation and graphics, with the

specified options, or invoke an R tool via the 'R CMD' interface.


Options:

  -h, --help            Print short help message and exit

  --version             Print version info and exit

  --encoding=ENC        Specify encoding to be used for stdin

  --encoding ENC

  RHOME                                  Print path to R home directory and exit

  --save                Do save workspace at the end of the session

  --no-save             Don't save it

  --no-environ          Don't read the site and user environment files

  --no-site-file        Don't read the site-wide Rprofile

  --no-init-file        Don't read the user R profile

  --restore             Do restore previously saved objects at startup

  --no-restore-data     Don't restore previously saved objects

  --no-restore-history  Don't restore the R history file

  --no-restore          Don't restore anything

  --vanilla                     Combine --no-save, --no-restore, --no-site-file,

                                    --no-init-file and --no-environ

  --no-readline         Don't use readline for command-line editing

  --max-ppsize=N        Set max size of protect stack to N

  --min-nsize=N         Set min number of fixed size obj's (\"cons cells\") to N

  --min-vsize=N         Set vector heap minimum to N bytes; '4M' = 4 MegaB

  -q, --quiet           Don't print startup message

  --silent              Same as --quiet

  -s, --no-echo         Make R run as quietly as possible

  --interactive         Force an interactive session

  --verbose             Print more information about progress

  -d, --debugger=NAME   Run R through debugger NAME

  --debugger-args=ARGS  Pass ARGS as arguments to the debugger

  -g TYPE, --gui=TYPE   Use TYPE as GUI; possible values are 'X11' (default)

                                    and 'Tk'.

  --arch=NAME            Specify a sub-architecture

  --args                Skip the rest of the command line

  -f FILE, --file=FILE  Take input from 'FILE'

  -e EXPR               Execute 'EXPR' and exit


FILE may contain spaces but not shell metacharacters.


Commands:

  BATCH                                   Run R in batch mode

  COMPILE                   Compile files for use with R

  SHLIB                         Build shared library for dynamic loading

  INSTALL                     Install add-on packages

  REMOVE                    Remove add-on packages

  build                          Build add-on packages

  check                         Check add-on packages

  LINK                           Front-end for creating executable programs

  Rprof                         Post-process R profiling files

  Rdconv                      Convert Rd format to various other formats

  Rd2pdf                      Convert Rd format to PDF

  Rd2txt                       Convert Rd format to pretty text

  Stangle                      Extract S/R code from Sweave documentation

  Sweave                      Process Sweave documentation

  Rdiff                           Diff R output ignoring headers etc

  config            Obtain configuration information about R

  javareconf                 Update the Java configuration variables

  rtags                 Create Emacs-style tag files from C, R, and Rd files


Please use 'R CMD command --help' to obtain further information about

the usage of 'command'.


Options --arch, --no-environ, --no-init-file, --no-site-file and --vanilla

can be placed between R and CMD, to apply to R processes run by 'command'


Report bugs at <https://bugs.R-project.org>."


## some systems have a more portable sed, e.g. /usr/xpg4/bin/sed on Solaris,

## so make sure that is used.

SED=/usr/bin/sed

export SED


error () {

  echo "ERROR: $*" >&2

  exit 1

}


### Argument loop

args=

debugger=

debugger_args=

gui=

while test -n "${1}"; do

  case ${1} in

    RHOME|--print-home)

      echo "${R_HOME}"; exit 0 ;;

    CMD)

      shift;

      export R_ARCH

      . "${R_HOME}/etc${R_ARCH}/ldpaths"

      exec sh "${R_HOME}/bin/Rcmd" "${@}" ;;

    -g|--gui)

      if test -n "`echo ${2} | ${SED} 's/^-.*//'`"; then

            gui="${2}"

        args="${args} ${1} ${2}"

            shift

      else

            error "option '${1}' requires an argument"

      fi

      ;;

    --gui=*)

      gui=`echo "${1}" | ${SED} -e 's/[^=]*=//'`

      args="${args} ${1}"

      ;;

    -d|--debugger)

      if test -n "`echo ${2} | ${SED} 's/^-.*//'`"; then

            debugger="${2}"; shift

      else

            error "option '${1}' requires an argument"

      fi

      ;;

    --debugger=*)

      debugger=`echo "${1}" | ${SED} -e 's/[^=]*=//'` ;;

    --debugger-args=*)

      debugger_args=`echo "${1}" | ${SED} -e 's/[^=]*=//'` ;;

    -h|--help)

      echo "${usage}"; exit 0 ;;

    --args)

      break ;;

    --arch)

      if test -n "`echo ${2} | ${SED} 's/^-.*//'`"; then

            R_ARCH="/${2}"

        shift

      else

        error "option '${1}' requires an argument"

      fi

      ## check sub-architecture here for a better error message

      if ! test -d ${R_HOME}/etc${R_ARCH}; then

        error "sub-architecture '${1}' is not installed"

      fi

      ;;

    --arch=*)

      r_arch=`echo "${1}" | ${SED} -e 's/[^=]*=//'`

      R_ARCH="/${r_arch}"

      ## check sub-architecture here for a better error message

      if ! test -d ${R_HOME}/etc${R_ARCH}; then

        error "sub-architecture '${r_arch}' is not installed"

      fi

      ;;

    -e)

      TAB=`printf "\t"`

      if test -n "`echo ${2} | ${SED} 's/^-.*//'`"; then

            a=`(echo "${2}" && echo) | ${SED} -e 's/ /~+~/g' | \

          ${SED} -e :a -e N -e '$!ba' -e 's/\n/~n~/g' -e 's/~n~$//g' -e "s/$TAB/~t~/g"`

        shift

      else

            error "option '${1}' requires a non-empty argument"

      fi

      args="${args} -e $a"

      ;;

    -f)

      if test -n "`echo ${2} | ${SED} 's/^-.*//'`"; then

            a=`echo "${2}" | ${SED} -e 's/ /~+~/g'`; shift

      else

            error "option '${1}' requires a filename argument"

      fi

      args="${args} -f $a"

      ;;

    --file=*)

      a=`echo "${1}" | ${SED} -e 's/[^=]*=//' | ${SED} -e 's/ /~+~/g'`

      args="${args} --file=$a"

      ;;

    --no-environ)

      R_ENVIRON=''

      export R_ENVIRON

      R_ENVIRON_USER=''

      export R_ENVIRON_USER

      args="${args} ${1}"

      ;;

    --no-site-file)

      R_PROFILE=''

      export R_PROFILE

      args="${args} ${1}"

      ;;

    --no-init-file)

      R_PROFILE_USER=''

      export R_PROFILE_USER

      args="${args} ${1}"

      ;;

    --vanilla)

      R_ENVIRON=''

      export R_ENVIRON

      R_ENVIRON_USER=''

      export R_ENVIRON_USER

      R_PROFILE=''

      export R_PROFILE

      R_PROFILE_USER=''

      export R_PROFILE_USER

      args="${args} ${1}"

      ;;

    *)

      args="${args} ${1}" ;;

  esac

  shift

done


. "${R_HOME}/etc${R_ARCH}/ldpaths"


R_binary="${R_HOME}/bin/exec${R_ARCH}/R"

export R_ARCH


case "${gui}" in

Tk|tk|X11|x11)

  ;;

"")

  ;;

*)

  error "unknown GUI ${gui}"

esac


## R_HOME may have moved, so check

if test -x "${R_HOME}"; then

  :

else

  error "R_HOME ('${R_HOME}') not found"

fi


## Startup
if test -z "${debugger}"; then
  exec "${R_binary}"  ${args} "${@}"

else

  ## Ideally, we would like the debugger to start R with additional

  ## ('inferior') arguments, but not all debuggers can do this.  We know

  ## about valgrind and some versions of GDB , and deal with these.

  ## Otherwise, to be on the safe side, we disregard non-debugger

  ## command line args.

  args_ok=no

  case "`${debugger} --version 2>/dev/null`" in

    "GNU gdb"*)

      if ${debugger} --help 2>/dev/null | \

          grep ' *--args' >/dev/null; then

            args_ok=yes

            debugger_args="${debugger_args} --args"

      fi

      ;;

    valgrind*)

      args_ok=yes

      ;;

  esac

  if test -n "${args}${*}" && test "${args_ok}" = no; then

    args=`expr "${args} ${*}" : " *\(.*\)"`

    echo "*** Further command line arguments ('${args}') disregarded"

    echo "*** (maybe use 'run ${args}' from *inside* ${debugger})"

    echo ""

    exec ${debugger} ${debugger_args} "${R_binary}"

  else

    exec ${debugger} ${debugger_args} "${R_binary}" ${args} "${@}"

  fi

fi


### Local Variables: ***

### mode: sh ***

### sh-indentation: 2 ***

### End: ***


Could you please help me? I have been trying to load it unsuccessfully.

Thanks.

Eric



	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Tue Oct  4 16:27:36 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Tue, 4 Oct 2022 17:27:36 +0300
Subject: [R] Help executing R on High Performance Cluster
In-Reply-To: <MN2PR04MB6400AA8141307B71683D51F8CB5A9@MN2PR04MB6400.namprd04.prod.outlook.com>
References: <MN2PR04MB6400AA8141307B71683D51F8CB5A9@MN2PR04MB6400.namprd04.prod.outlook.com>
Message-ID: <20221004172736.637bca14@arachnoid>

Hi Eric!

? Tue, 4 Oct 2022 13:36:59 +0000
"Rhon Calderon, Eric" <Eric.RhonCalderon at pennmedicine.upenn.edu> ?????:

> cd /home/ericrhon/labsoftware/R-devel/

> ./configure --prefix=/home/ericrhon/labsoftware/R-devel

I'm not sure, but the reason for the confusing behaviour could be
that the installation prefix is set to be the same as the directory
where you had unpacked the source code. This may have caused file path
conflicts and maybe some kind of recursion when building the final
executable path.

R can run straight from the build directory, without installation.
If you start from scratch, does bin/R work without `make install`? If
not, do you get any useful output if you run bin/R under sh -x?

(Additionally, R supports building away from the source code directory.
For example, if you navigate to the source code directory, then run
mkdir build && cd build && ../configure $CONFIGURE_ARGUMENTS, the build
will be mostly self-contained to that directory, which may be useful
when experimenting.)

Why are you building R with --with-recommended-packages=no?

R is supposed to be easy to build and start working with, but there may
be important details to consider, especially on an HPC, in the "R
installation and administration" guide:
https://cran.r-project.org/doc/manuals/r-release/R-admin.html

> Here is the exec script of R, line 272 is highlighted:
<...>
>	[[alternative HTML version deleted]]

This mailing list strips the HTML version of the e-mails; here's what
we see: https://stat.ethz.ch/pipermail/r-help/2022-October/475956.html

One way to link to R source code is to use the GitHub mirror:
https://github.com/r-devel/r-svn

-- 
Best regards,
Ivan


From petr@p|k@| @end|ng |rom prechez@@cz  Tue Oct  4 13:01:14 2022
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Tue, 4 Oct 2022 11:01:14 +0000
Subject: [R] R version 4.2.1 install.packages does not work with IE proxy
 setting
Message-ID: <344ae947626245a392ebba421f73e483@SRVEXCHCM1302.precheza.cz>

Dear all

After we installed new R version R 4.2.1 installing packages through IE
proxy setting is compromised with warning that R could not connect to server
(tested in vanilla R).

> chooseCRANmirror()
Warning: failed to download mirrors file (cannot open URL
'https://cran.r-project.org/CRAN_mirrors.csv'); using local file
'D:/programy/R/doc/CRAN_mirrors.csv'
Warning message:
In download.file(url, destfile = f, quiet = TRUE) :
  URL 'https://cran.r-project.org/CRAN_mirrors.csv': status was 'Couldn't
connect to server'

So install.packages("whatever") also ends with similar warnings.

When using directly (without proxy need) install.packages works as expected.

In R4.1.0 version it works as expected, without any warnings and packages
could be installed smoothly.

Is it known issue with this version? 
Could it be due to somehow corrupted installation?
Should we set something differently for this new R version

Best regards
Petr

From kry|ov@r00t @end|ng |rom gm@||@com  Tue Oct  4 17:42:56 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Tue, 4 Oct 2022 18:42:56 +0300
Subject: [R] 
 R version 4.2.1 install.packages does not work with IE proxy setting
In-Reply-To: <344ae947626245a392ebba421f73e483@SRVEXCHCM1302.precheza.cz>
References: <344ae947626245a392ebba421f73e483@SRVEXCHCM1302.precheza.cz>
Message-ID: <20221004184256.7ce13c60@arachnoid>

On Tue, 4 Oct 2022 11:01:14 +0000
PIKAL Petr <petr.pikal at precheza.cz> wrote:

> After we installed new R version R 4.2.1 installing packages through
> IE proxy setting is compromised with warning that R could not connect
> to server (tested in vanilla R).

R 4.1 deprecated the use of download.file(method = 'wininet'). R 4.2
switched the default download method to 'libcurl' and started giving
warnings for 'wininet' and http[s]:// URLs.

A workaround to get it working right now would be to set
options(download.file.method = 'wininet') and live with the resulting
warnings while R downloads the files, but a next version of R may
remove 'wininet' support altogether.

In order to get it working with the 'libcurl' method, you'll need to
provide some environment variables to curl:
https://stat.ethz.ch/pipermail/r-help/2022-September/475917.html

Not sure if libcurl would accept a patch to discover the Windows proxy
settings automatically, but I don't think it does that now.

-- 
Best regards,
Ivan


From M@|@@_D@S||v@ @end|ng |rom h@dm@h@rv@rd@edu  Tue Oct  4 17:58:20 2022
From: M@|@@_D@S||v@ @end|ng |rom h@dm@h@rv@rd@edu (Da Silva, Maisa Monseff Rodrigues)
Date: Tue, 4 Oct 2022 15:58:20 +0000
Subject: [R] R version 4.2.1 (2022-06-23),
 RStudio 2022.07.2 "Spotted Wakerobin" Release (e7373ef8,
 2022-09-06) for macOS, macOS Monterey version 12.6. Error: SVN not found
Message-ID: <BYAPR07MB5447FD6F319350E1EDDAA2D5AA5A9@BYAPR07MB5447.namprd07.prod.outlook.com>

Hello.
Thank you for helping me.
I am starting my Bioinformatics pathway, and came across a problem im stuck with, even after trying different things:

When in RStudio, I was able to install Git, but SVN remains "not found".
I tried installing SVN through HomeBrew and downloaded Xcode's Command Lines from Apple Developer (as instructed on https://support.rstudio.com/hc/en-us/articles/200532077?version=2022.07.2%2B576&mode=desktop).
After those steps, I restarted R and continue to see "not found" for SVN (git is working fine).
When on mac terminal,

"svn --version" prints

svn, version 1.14.2 (r1899510)

   compiled Oct  3 2022, 21:23:39 on x86_64-apple-darwin21.6.0


"svn info" prints

svn: E155007: '/Users/maisamonseff' is not a working copy

Could you point out what it is I am doing wrong?


Thank you in advance,

Maisa Monseff Rodrigues da Silva
MD - Endocrinologist - University S?o Paulo (Brazil)
PhD Student University S?o Paulo (BR) / Harvard (USA)

________________________________
CONFIDENTIALITY NOTICE: This message and any attached do...{{dropped:11}}


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Tue Oct  4 19:18:22 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Tue, 04 Oct 2022 10:18:22 -0700
Subject: [R] R version 4.2.1 (2022-06-23),
 RStudio 2022.07.2 "Spotted Wakerobin" Release (e7373ef8,
 2022-09-06) for macOS, macOS Monterey version 12.6. Error: SVN not found
In-Reply-To: <BYAPR07MB5447FD6F319350E1EDDAA2D5AA5A9@BYAPR07MB5447.namprd07.prod.outlook.com>
References: <BYAPR07MB5447FD6F319350E1EDDAA2D5AA5A9@BYAPR07MB5447.namprd07.prod.outlook.com>
Message-ID: <8A776EC5-00FF-4F1A-A7CA-909331FB0463@dcn.davis.ca.us>

>Could you point out what it is I am doing wrong?

... wrong... posting questions about SVN and RStudio in a forum about R? Do read the Posting Guide before posting. There are specialty mailing lists mentioned there that _might_ be relevant, but it seems to me that you need to learn how to use SVN before you learn how to use it with RStudio, and neither of those tools are on their own relevant in any of the R mailing lists.

I don't use a Mac, but I believe you may encounter difficulties using it related to the fact that everything homebrew tools do has permissions restrictions related to homebrew so mixing in non-homebrew tools may not work.

Try perhaps StackOverflow or Reddit?

On October 4, 2022 8:58:20 AM PDT, "Da Silva, Maisa Monseff Rodrigues" <Maisa_DaSilva at hsdm.harvard.edu> wrote:
>Hello.
>Thank you for helping me.
>I am starting my Bioinformatics pathway, and came across a problem im stuck with, even after trying different things:
>
>When in RStudio, I was able to install Git, but SVN remains "not found".
>I tried installing SVN through HomeBrew and downloaded Xcode's Command Lines from Apple Developer (as instructed on https://support.rstudio.com/hc/en-us/articles/200532077?version=2022.07.2%2B576&mode=desktop).
>After those steps, I restarted R and continue to see "not found" for SVN (git is working fine).
>When on mac terminal,
>
>"svn --version" prints
>
>svn, version 1.14.2 (r1899510)
>
>   compiled Oct  3 2022, 21:23:39 on x86_64-apple-darwin21.6.0
>
>
>"svn info" prints
>
>svn: E155007: '/Users/maisamonseff' is not a working copy
>
>Could you point out what it is I am doing wrong?
>
>
>Thank you in advance,
>
>Maisa Monseff Rodrigues da Silva
>MD - Endocrinologist - University S?o Paulo (Brazil)
>PhD Student University S?o Paulo (BR) / Harvard (USA)
>
>________________________________
>CONFIDENTIALITY NOTICE: This message and any attached do...{{dropped:11}}
>

-- 
Sent from my phone. Please excuse my brevity.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Tue Oct  4 19:32:55 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Tue, 4 Oct 2022 18:32:55 +0100
Subject: [R] R version 4.2.1 (2022-06-23),
 RStudio 2022.07.2 "Spotted Wakerobin" Release (e7373ef8,
 2022-09-06) for macOS, macOS Monterey version 12.6. Error: SVN not found
In-Reply-To: <8A776EC5-00FF-4F1A-A7CA-909331FB0463@dcn.davis.ca.us>
References: <BYAPR07MB5447FD6F319350E1EDDAA2D5AA5A9@BYAPR07MB5447.namprd07.prod.outlook.com>
 <8A776EC5-00FF-4F1A-A7CA-909331FB0463@dcn.davis.ca.us>
Message-ID: <72780772-4b53-ee0c-d220-2c33d2bbdc18@sapo.pt>

Hello,

Post to R-SIG-Mac [1], the R help mailing list for Mac related questions?

[1] https://stat.ethz.ch/mailman/listinfo/r-sig-mac

Hope this helps,

Rui Barradas

?s 18:18 de 04/10/2022, Jeff Newmiller escreveu:
>> Could you point out what it is I am doing wrong?
> 
> ... wrong... posting questions about SVN and RStudio in a forum about R? Do read the Posting Guide before posting. There are specialty mailing lists mentioned there that _might_ be relevant, but it seems to me that you need to learn how to use SVN before you learn how to use it with RStudio, and neither of those tools are on their own relevant in any of the R mailing lists.
> 
> I don't use a Mac, but I believe you may encounter difficulties using it related to the fact that everything homebrew tools do has permissions restrictions related to homebrew so mixing in non-homebrew tools may not work.
> 
> Try perhaps StackOverflow or Reddit?
> 
> On October 4, 2022 8:58:20 AM PDT, "Da Silva, Maisa Monseff Rodrigues" <Maisa_DaSilva at hsdm.harvard.edu> wrote:
>> Hello.
>> Thank you for helping me.
>> I am starting my Bioinformatics pathway, and came across a problem im stuck with, even after trying different things:
>>
>> When in RStudio, I was able to install Git, but SVN remains "not found".
>> I tried installing SVN through HomeBrew and downloaded Xcode's Command Lines from Apple Developer (as instructed on https://support.rstudio.com/hc/en-us/articles/200532077?version=2022.07.2%2B576&mode=desktop).
>> After those steps, I restarted R and continue to see "not found" for SVN (git is working fine).
>> When on mac terminal,
>>
>> "svn --version" prints
>>
>> svn, version 1.14.2 (r1899510)
>>
>>    compiled Oct  3 2022, 21:23:39 on x86_64-apple-darwin21.6.0
>>
>>
>> "svn info" prints
>>
>> svn: E155007: '/Users/maisamonseff' is not a working copy
>>
>> Could you point out what it is I am doing wrong?
>>
>>
>> Thank you in advance,
>>
>> Maisa Monseff Rodrigues da Silva
>> MD - Endocrinologist - University S?o Paulo (Brazil)
>> PhD Student University S?o Paulo (BR) / Harvard (USA)
>>
>> ________________________________
>> CONFIDENTIALITY NOTICE: This message and any attached do...{{dropped:11}}
>>
>


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Tue Oct  4 20:30:34 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Tue, 04 Oct 2022 11:30:34 -0700
Subject: [R] R version 4.2.1 (2022-06-23),
 RStudio 2022.07.2 "Spotted Wakerobin" Release (e7373ef8,
 2022-09-06) for macOS, macOS Monterey version 12.6. Error: SVN not found
In-Reply-To: <72780772-4b53-ee0c-d220-2c33d2bbdc18@sapo.pt>
References: <BYAPR07MB5447FD6F319350E1EDDAA2D5AA5A9@BYAPR07MB5447.namprd07.prod.outlook.com>
 <8A776EC5-00FF-4F1A-A7CA-909331FB0463@dcn.davis.ca.us>
 <72780772-4b53-ee0c-d220-2c33d2bbdc18@sapo.pt>
Message-ID: <49AC5E23-F7DE-408A-A164-C9579840255B@dcn.davis.ca.us>

Possibly, but the question is actually not about R, so probably not...

On October 4, 2022 10:32:55 AM PDT, Rui Barradas <ruipbarradas at sapo.pt> wrote:
>Hello,
>
>Post to R-SIG-Mac [1], the R help mailing list for Mac related questions?
>
>[1] https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>
>Hope this helps,
>
>Rui Barradas
>
>?s 18:18 de 04/10/2022, Jeff Newmiller escreveu:
>>> Could you point out what it is I am doing wrong?
>> 
>> ... wrong... posting questions about SVN and RStudio in a forum about R? Do read the Posting Guide before posting. There are specialty mailing lists mentioned there that _might_ be relevant, but it seems to me that you need to learn how to use SVN before you learn how to use it with RStudio, and neither of those tools are on their own relevant in any of the R mailing lists.
>> 
>> I don't use a Mac, but I believe you may encounter difficulties using it related to the fact that everything homebrew tools do has permissions restrictions related to homebrew so mixing in non-homebrew tools may not work.
>> 
>> Try perhaps StackOverflow or Reddit?
>> 
>> On October 4, 2022 8:58:20 AM PDT, "Da Silva, Maisa Monseff Rodrigues" <Maisa_DaSilva at hsdm.harvard.edu> wrote:
>>> Hello.
>>> Thank you for helping me.
>>> I am starting my Bioinformatics pathway, and came across a problem im stuck with, even after trying different things:
>>> 
>>> When in RStudio, I was able to install Git, but SVN remains "not found".
>>> I tried installing SVN through HomeBrew and downloaded Xcode's Command Lines from Apple Developer (as instructed on https://support.rstudio.com/hc/en-us/articles/200532077?version=2022.07.2%2B576&mode=desktop).
>>> After those steps, I restarted R and continue to see "not found" for SVN (git is working fine).
>>> When on mac terminal,
>>> 
>>> "svn --version" prints
>>> 
>>> svn, version 1.14.2 (r1899510)
>>> 
>>>    compiled Oct  3 2022, 21:23:39 on x86_64-apple-darwin21.6.0
>>> 
>>> 
>>> "svn info" prints
>>> 
>>> svn: E155007: '/Users/maisamonseff' is not a working copy
>>> 
>>> Could you point out what it is I am doing wrong?
>>> 
>>> 
>>> Thank you in advance,
>>> 
>>> Maisa Monseff Rodrigues da Silva
>>> MD - Endocrinologist - University S?o Paulo (Brazil)
>>> PhD Student University S?o Paulo (BR) / Harvard (USA)
>>> 
>>> ________________________________
>>> CONFIDENTIALITY NOTICE: This message and any attached do...{{dropped:11}}
>>> 
>> 

-- 
Sent from my phone. Please excuse my brevity.


