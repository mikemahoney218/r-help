From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Fri Apr  1 00:08:35 2022
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Thu, 31 Mar 2022 22:08:35 +0000 (UTC)
Subject: [R] pcalg library : estimated DAG graph
References: <2065726392.779530.1648764515413.ref@mail.yahoo.com>
Message-ID: <2065726392.779530.1648764515413@mail.yahoo.com>

Dear R-experts,

Here below my R code working but I don't know how I can get the graph (estimated DAG). 
If you could help me to get the graph, many thanks.


###################
library(pcalg)

x1<-c(508,413,426,500,568,372,484,512,529,322,544,586,480,561,567,488,450,548,526,561,435,567,537,521,516,407,531,374,406,595,460,420,453,562,530)

x2<-c(531,491,353,522,341,493,431,565,530,441,403,498,552,513,513,403,445,424,529,486,519,492,397,579,479,511,535,504,465,520,517,528,542,483,499) 

x3<-c(541,451,510,649,329,464,511,609,643,530,568,366,371,442,611,437,445,589,605,456,437,179,540,580,587,540,505,310,542,488,525,483,200,517,513)

x4<-c(488,473,449,564,447,593,420,685,597,534,608,389,557,385,564,449,530,615,502,510,412,321,509,480,469,594,506,431,555,567,491,414,359,418,468) 

x5<-c(487,430,419,583,469,369,540,637,563,328,498,448,356,552,521,417,513,570,530,594,372,537,469,454,554,518,550,384,533,594,467,471,590,552,556)

x6<-c(511,452,432,563,431,458,477,601,572,431,524,458,463,491,555,439,477,549,539,521,435,419,490,523,521,514,525,401,500,553,492,463,429,506,513) 

X=cbind(x1,x2,x3,x4,x5,x6)

res1=lingam(X,verbose=TRUE)
cat("estimated DAG:/n")
as(res1,"amat")
res1
###################

?


From bgunter@4567 @end|ng |rom gm@||@com  Fri Apr  1 00:28:44 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 31 Mar 2022 15:28:44 -0700
Subject: [R] pcalg library : estimated DAG graph
In-Reply-To: <2065726392.779530.1648764515413@mail.yahoo.com>
References: <2065726392.779530.1648764515413.ref@mail.yahoo.com>
 <2065726392.779530.1648764515413@mail.yahoo.com>
Message-ID: <CAGxFJbTAb7PL=Z8LnUj9Zwjy8VOP47tczGu1oVA_WENXwCxjTA@mail.gmail.com>

Getting help here on non-standard packages -- there are tens of thousands
-- is technically off topic (see the Posting Guide linked below) and hence
you should not be surprised if you do not get a useful reply, though you
may, of course.

You might have better luck posting on r-sig-networks,
https://stat.ethz.ch/mailman/listinfo/r-sig-networks, as it says on its
homepage that this SIG is specifically for those interested in "graph-
related software" within R.

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Thu, Mar 31, 2022 at 3:06 PM varin sacha via R-help <r-help at r-project.org>
wrote:

> Dear R-experts,
>
> Here below my R code working but I don't know how I can get the graph
> (estimated DAG).
> If you could help me to get the graph, many thanks.
>
>
> ###################
> library(pcalg)
>
>
> x1<-c(508,413,426,500,568,372,484,512,529,322,544,586,480,561,567,488,450,548,526,561,435,567,537,521,516,407,531,374,406,595,460,420,453,562,530)
>
> x2<-c(531,491,353,522,341,493,431,565,530,441,403,498,552,513,513,403,445,424,529,486,519,492,397,579,479,511,535,504,465,520,517,528,542,483,499)
>
>
>
> x3<-c(541,451,510,649,329,464,511,609,643,530,568,366,371,442,611,437,445,589,605,456,437,179,540,580,587,540,505,310,542,488,525,483,200,517,513)
>
> x4<-c(488,473,449,564,447,593,420,685,597,534,608,389,557,385,564,449,530,615,502,510,412,321,509,480,469,594,506,431,555,567,491,414,359,418,468)
>
>
>
> x5<-c(487,430,419,583,469,369,540,637,563,328,498,448,356,552,521,417,513,570,530,594,372,537,469,454,554,518,550,384,533,594,467,471,590,552,556)
>
> x6<-c(511,452,432,563,431,458,477,601,572,431,524,458,463,491,555,439,477,549,539,521,435,419,490,523,521,514,525,401,500,553,492,463,429,506,513)
>
>
> X=cbind(x1,x2,x3,x4,x5,x6)
>
> res1=lingam(X,verbose=TRUE)
> cat("estimated DAG:/n")
> as(res1,"amat")
> res1
> ###################
>
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From petr@p|k@| @end|ng |rom prechez@@cz  Fri Apr  1 07:24:58 2022
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Fri, 1 Apr 2022 05:24:58 +0000
Subject: [R] pcalg library : estimated DAG graph
In-Reply-To: <2065726392.779530.1648764515413@mail.yahoo.com>
References: <2065726392.779530.1648764515413.ref@mail.yahoo.com>
 <2065726392.779530.1648764515413@mail.yahoo.com>
Message-ID: <4bb323d6da7b4af086fae5bb995586c1@SRVEXCHCM1302.precheza.cz>

Hallo

It is not obvious what is your problem. You maybe should go through some 
articles about functions in the package.
https://pdfs.semanticscholar.org/aee5/cca63aad422c96ee637b5561bb051724d76c.pdf?_ga=2.241710466.1872226166.1648790330-1600227915.1617009045

or maybe you do not have Rgraphviz package installed as required by plotting 
functions of the package.

R> stopifnot(require(Rgraphviz))# needed for all our graph plots

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of varin sacha via
> R-help
> Sent: Friday, April 1, 2022 12:09 AM
> To: r-help at r-project.org
> Subject: [R] pcalg library : estimated DAG graph
>
> Dear R-experts,
>
> Here below my R code working but I don't know how I can get the graph
> (estimated DAG).
> If you could help me to get the graph, many thanks.
>
>
> ###################
> library(pcalg)
>
> x1<-
> c(508,413,426,500,568,372,484,512,529,322,544,586,480,561,567,488,450,
> 548,526,561,435,567,537,521,516,407,531,374,406,595,460,420,453,562,53
> 0)
>
> x2<-
> c(531,491,353,522,341,493,431,565,530,441,403,498,552,513,513,403,445,
> 424,529,486,519,492,397,579,479,511,535,504,465,520,517,528,542,483,49
> 9)
>
> x3<-
> c(541,451,510,649,329,464,511,609,643,530,568,366,371,442,611,437,445,
> 589,605,456,437,179,540,580,587,540,505,310,542,488,525,483,200,517,51
> 3)
>
> x4<-
> c(488,473,449,564,447,593,420,685,597,534,608,389,557,385,564,449,530,
> 615,502,510,412,321,509,480,469,594,506,431,555,567,491,414,359,418,46
> 8)
>
> x5<-
> c(487,430,419,583,469,369,540,637,563,328,498,448,356,552,521,417,513,
> 570,530,594,372,537,469,454,554,518,550,384,533,594,467,471,590,552,55
> 6)
>
> x6<-
> c(511,452,432,563,431,458,477,601,572,431,524,458,463,491,555,439,477,
> 549,539,521,435,419,490,523,521,514,525,401,500,553,492,463,429,506,51
> 3)
>
> X=cbind(x1,x2,x3,x4,x5,x6)
>
> res1=lingam(X,verbose=TRUE)
> cat("estimated DAG:/n")
> as(res1,"amat")
> res1
> ###################
>
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

From p@tr|ck@g|r@udoux @end|ng |rom un|v-|comte@|r  Fri Apr  1 08:12:28 2022
From: p@tr|ck@g|r@udoux @end|ng |rom un|v-|comte@|r (Patrick Giraudoux)
Date: Fri, 1 Apr 2022 08:12:28 +0200
Subject: [R] readxl, read_excel: how colon (:) is read ?
Message-ID: <04b39c28-a42e-1a91-c446-82d53eb873b8@univ-fcomte.fr>

I have a unexpected behaviour reading times with colon from an Excel 
file, using the package readxl.

In an Excel sheet, I have a column with times in hours:minutes, e.g:

Arrival_time
13:39
13:51

When read from R with readxl::read_excel, this gives a tibble column 
with full date by defaut being the last day of 1899. OK. Why not, I know 
that POSIX variables are starting in 1900 after R doc (however I wonder 
why here the defaut is one day before January 1, 1900

> tmp$Arrival_time  [1] "1899-12-31 13:39:00 UTC" "1899-12-31 13:51:00 UTC"

Well, this is not exactly what I want to. I do not care about the year 
and the day... Therefore I decided to import this column as "text" 
explicitely (in order to manage it within R then). And this is what I 
get now:

> read_excel("saisie_data_durban_rapaces_LPO.xlsx",sheet=2,col_types="text")  > tmp$Arrival_time [1] "0.56875000000000009" "0.57708333333333328"

Can someone tell me what happens ?

I would really appreciate to understand the trick...


	[[alternative HTML version deleted]]


From @kw@|mmo @end|ng |rom gm@||@com  Fri Apr  1 08:26:33 2022
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Fri, 1 Apr 2022 02:26:33 -0400
Subject: [R] readxl, read_excel: how colon (:) is read ?
In-Reply-To: <04b39c28-a42e-1a91-c446-82d53eb873b8@univ-fcomte.fr>
References: <04b39c28-a42e-1a91-c446-82d53eb873b8@univ-fcomte.fr>
Message-ID: <CAPcHnpTpPt90Y-T6HZSTNhoq=RFf=RLjn__PV-Xusc_ATdN0LA@mail.gmail.com>

Probably (but not entirely sure), Excel is storing your text as a number of
days, so 13:38 is a little more than half a day. Open your spreadsheet in
excel and save those columns as text instead of times, that (should) fix
your issue.

On Fri, Apr 1, 2022, 02:12 Patrick Giraudoux <
patrick.giraudoux at univ-fcomte.fr> wrote:

> I have a unexpected behaviour reading times with colon from an Excel
> file, using the package readxl.
>
> In an Excel sheet, I have a column with times in hours:minutes, e.g:
>
> Arrival_time
> 13:39
> 13:51
>
> When read from R with readxl::read_excel, this gives a tibble column
> with full date by defaut being the last day of 1899. OK. Why not, I know
> that POSIX variables are starting in 1900 after R doc (however I wonder
> why here the defaut is one day before January 1, 1900
>
> > tmp$Arrival_time  [1] "1899-12-31 13:39:00 UTC" "1899-12-31 13:51:00 UTC"
>
> Well, this is not exactly what I want to. I do not care about the year
> and the day... Therefore I decided to import this column as "text"
> explicitely (in order to manage it within R then). And this is what I
> get now:
>
> >
> read_excel("saisie_data_durban_rapaces_LPO.xlsx",sheet=2,col_types="text")
> > tmp$Arrival_time [1] "0.56875000000000009" "0.57708333333333328"
>
> Can someone tell me what happens ?
>
> I would really appreciate to understand the trick...
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From p@tr|ck@g|r@udoux @end|ng |rom un|v-|comte@|r  Fri Apr  1 08:34:12 2022
From: p@tr|ck@g|r@udoux @end|ng |rom un|v-|comte@|r (Patrick Giraudoux)
Date: Fri, 1 Apr 2022 08:34:12 +0200
Subject: [R] readxl, read_excel: how colon (:) is read ?
In-Reply-To: <CAPcHnpTpPt90Y-T6HZSTNhoq=RFf=RLjn__PV-Xusc_ATdN0LA@mail.gmail.com>
References: <04b39c28-a42e-1a91-c446-82d53eb873b8@univ-fcomte.fr>
 <CAPcHnpTpPt90Y-T6HZSTNhoq=RFf=RLjn__PV-Xusc_ATdN0LA@mail.gmail.com>
Message-ID: <203cebec-5609-e41e-c4f9-1b5882058734@univ-fcomte.fr>

Absolutely correct ! I checked in Excel and when I change the format to 
"text", then I get in Excel the same fractional numbers as those 
obtained importing text from R... Hence the issue comes from Excel 
itself. Will find a way to change this format to text in Excel without 
avoiding such conversion...
Thanks Andrew !

Le 01/04/2022 ? 08:26, Andrew Simmons a ?crit?:
> Probably (but not entirely sure), Excel is storing your text as a 
> number of days, so 13:38 is a little more than half a day. Open your 
> spreadsheet in excel and save those columns as text instead of times, 
> that (should) fix your issue.
>
> On Fri, Apr 1, 2022, 02:12 Patrick Giraudoux 
> <patrick.giraudoux at univ-fcomte.fr> wrote:
>
>     I have a unexpected behaviour reading times with colon from an Excel
>     file, using the package readxl.
>
>     In an Excel sheet, I have a column with times in hours:minutes, e.g:
>
>     Arrival_time
>     13:39
>     13:51
>
>     When read from R with readxl::read_excel, this gives a tibble column
>     with full date by defaut being the last day of 1899. OK. Why not,
>     I know
>     that POSIX variables are starting in 1900 after R doc (however I
>     wonder
>     why here the defaut is one day before January 1, 1900
>
>     > tmp$Arrival_time? [1] "1899-12-31 13:39:00 UTC" "1899-12-31
>     13:51:00 UTC"
>
>     Well, this is not exactly what I want to. I do not care about the
>     year
>     and the day... Therefore I decided to import this column as "text"
>     explicitely (in order to manage it within R then). And this is what I
>     get now:
>
>     >
>     read_excel("saisie_data_durban_rapaces_LPO.xlsx",sheet=2,col_types="text")
>     > tmp$Arrival_time [1] "0.56875000000000009" "0.57708333333333328"
>
>     Can someone tell me what happens ?
>
>     I would really appreciate to understand the trick...
>
>
>     ? ? ? ? [[alternative HTML version deleted]]
>
>     ______________________________________________
>     R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>     https://stat.ethz.ch/mailman/listinfo/r-help
>     PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>     and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Apr  1 08:40:48 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 31 Mar 2022 23:40:48 -0700
Subject: [R] readxl, read_excel: how colon (:) is read ?
In-Reply-To: <04b39c28-a42e-1a91-c446-82d53eb873b8@univ-fcomte.fr>
References: <04b39c28-a42e-1a91-c446-82d53eb873b8@univ-fcomte.fr>
Message-ID: <DA8615A6-D08B-425C-9DBD-D5B118A75F2B@dcn.davis.ca.us>

Both R and Excel assume a date is associated with every time object. In Excel, when you show a date it is an integer number of days since 1899-12-31 (due to a mistake made early in programming it). Whenever you show a time, it it merely displaying the time portion (fraction of a day) of a date/time. The date part of that value may or may not be 1899-12-31.

With this in mind, you are tilting at windmills hoping to import a "pure time" because no such thing exists in either program. You can choose to render a `POSIXct` as showing only the time portion when you convert it to character if you so choose.

On March 31, 2022 11:12:28 PM PDT, Patrick Giraudoux <patrick.giraudoux at univ-fcomte.fr> wrote:
>I have a unexpected behaviour reading times with colon from an Excel 
>file, using the package readxl.
>
>In an Excel sheet, I have a column with times in hours:minutes, e.g:
>
>Arrival_time
>13:39
>13:51
>
>When read from R with readxl::read_excel, this gives a tibble column 
>with full date by defaut being the last day of 1899. OK. Why not, I know 
>that POSIX variables are starting in 1900 after R doc (however I wonder 
>why here the defaut is one day before January 1, 1900
>
>> tmp$Arrival_time  [1] "1899-12-31 13:39:00 UTC" "1899-12-31 13:51:00 UTC"
>
>Well, this is not exactly what I want to. I do not care about the year 
>and the day... Therefore I decided to import this column as "text" 
>explicitely (in order to manage it within R then). And this is what I 
>get now:
>
>> read_excel("saisie_data_durban_rapaces_LPO.xlsx",sheet=2,col_types="text")  > tmp$Arrival_time [1] "0.56875000000000009" "0.57708333333333328"
>
>Can someone tell me what happens ?
>
>I would really appreciate to understand the trick...
>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From p@tr|ck@g|r@udoux @end|ng |rom un|v-|comte@|r  Fri Apr  1 08:41:42 2022
From: p@tr|ck@g|r@udoux @end|ng |rom un|v-|comte@|r (Patrick Giraudoux)
Date: Fri, 1 Apr 2022 08:41:42 +0200
Subject: [R] readxl, read_excel: how colon (:) is read ?
In-Reply-To: <203cebec-5609-e41e-c4f9-1b5882058734@univ-fcomte.fr>
References: <04b39c28-a42e-1a91-c446-82d53eb873b8@univ-fcomte.fr>
 <CAPcHnpTpPt90Y-T6HZSTNhoq=RFf=RLjn__PV-Xusc_ATdN0LA@mail.gmail.com>
 <203cebec-5609-e41e-c4f9-1b5882058734@univ-fcomte.fr>
Message-ID: <54a0a66a-91a3-b245-8dd6-c2601824837b@univ-fcomte.fr>

This can be made using the TEXT (TEXTE in the French version) function 
of Excel, hence:

TEXT(M2;"HH:MM")

Changes the time into text, and it can be imported from R as wanted.



Le 01/04/2022 ? 08:34, Patrick Giraudoux a ?crit?:
> Absolutely correct ! I checked in Excel and when I change the format 
> to "text", then I get in Excel the same fractional numbers as those 
> obtained importing text from R... Hence the issue comes from Excel 
> itself. Will find a way to change this format to text in Excel without 
> avoiding such conversion...
> Thanks Andrew !
>
> Le 01/04/2022 ? 08:26, Andrew Simmons a ?crit?:
>> Probably (but not entirely sure), Excel is storing your text as a 
>> number of days, so 13:38 is a little more than half a day. Open your 
>> spreadsheet in excel and save those columns as text instead of times, 
>> that (should) fix your issue.
>>
>> On Fri, Apr 1, 2022, 02:12 Patrick Giraudoux 
>> <patrick.giraudoux at univ-fcomte.fr> wrote:
>>
>>     I have a unexpected behaviour reading times with colon from an Excel
>>     file, using the package readxl.
>>
>>     In an Excel sheet, I have a column with times in hours:minutes, e.g:
>>
>>     Arrival_time
>>     13:39
>>     13:51
>>
>>     When read from R with readxl::read_excel, this gives a tibble column
>>     with full date by defaut being the last day of 1899. OK. Why not,
>>     I know
>>     that POSIX variables are starting in 1900 after R doc (however I
>>     wonder
>>     why here the defaut is one day before January 1, 1900
>>
>>     > tmp$Arrival_time? [1] "1899-12-31 13:39:00 UTC" "1899-12-31
>>     13:51:00 UTC"
>>
>>     Well, this is not exactly what I want to. I do not care about the
>>     year
>>     and the day... Therefore I decided to import this column as "text"
>>     explicitely (in order to manage it within R then). And this is
>>     what I
>>     get now:
>>
>>     >
>>     read_excel("saisie_data_durban_rapaces_LPO.xlsx",sheet=2,col_types="text")
>>     > tmp$Arrival_time [1] "0.56875000000000009" "0.57708333333333328"
>>
>>     Can someone tell me what happens ?
>>
>>     I would really appreciate to understand the trick...
>>
>>
>>     ? ? ? ? [[alternative HTML version deleted]]
>>
>>     ______________________________________________
>>     R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>     https://stat.ethz.ch/mailman/listinfo/r-help
>>     PLEASE do read the posting guide
>>     http://www.R-project.org/posting-guide.html
>>     <http://www.R-project.org/posting-guide.html>
>>     and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From p@tr|ck@g|r@udoux @end|ng |rom un|v-|comte@|r  Fri Apr  1 08:46:05 2022
From: p@tr|ck@g|r@udoux @end|ng |rom un|v-|comte@|r (Patrick Giraudoux)
Date: Fri, 1 Apr 2022 08:46:05 +0200
Subject: [R] readxl, read_excel: how colon (:) is read ?
In-Reply-To: <DA8615A6-D08B-425C-9DBD-D5B118A75F2B@dcn.davis.ca.us>
References: <04b39c28-a42e-1a91-c446-82d53eb873b8@univ-fcomte.fr>
 <DA8615A6-D08B-425C-9DBD-D5B118A75F2B@dcn.davis.ca.us>
Message-ID: <a833a236-2ce3-9dfe-9aeb-ad29bfb152c6@univ-fcomte.fr>

Le 01/04/2022 ? 08:40, Jeff Newmiller a ?crit?:
> Both R and Excel assume a date is associated with every time object. In Excel, when you show a date it is an integer number of days since 1899-12-31 (due to a mistake made early in programming it). Whenever you show a time, it it merely displaying the time portion (fraction of a day) of a date/time. The date part of that value may or may not be 1899-12-31.
>
> With this in mind, you are tilting at windmills hoping to import a "pure time" because no such thing exists in either program. You can choose to render a `POSIXct` as showing only the time portion when you convert it to character if you so choose.

Thanks for the infos. Yes, this is exactly what? I did yesterday with 
POSIXct > POSIXlt to go ahead. However I wanted to understand fully what 
happened, hence the call to the list. Jeff and Andrew, now eveything is 
clear to me thanks to you...


	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Fri Apr  1 09:09:02 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Fri, 1 Apr 2022 08:09:02 +0100
Subject: [R] readxl, read_excel: how colon (:) is read ?
In-Reply-To: <04b39c28-a42e-1a91-c446-82d53eb873b8@univ-fcomte.fr>
References: <04b39c28-a42e-1a91-c446-82d53eb873b8@univ-fcomte.fr>
Message-ID: <cbea4019-7fb0-8eb6-115e-0b3671677a8a@sapo.pt>

Hello,

The following function is probably not very solid, to work with dates 
and times is not trivial, but it converts those Excel numbers correctly.

I don't know with what numbers it fails.


xl_fracday_to_time <- function(x, digits = 0L) {
   old_opts <- options(digits = 20)
   on.exit(options(old_opts))
   if(is.character(x)) {
     x <- as.numeric(x)
   }
   y <- x * 24
   hours <- floor(y + .Machine$double.eps^0.5)
   y <- (y - hours) * 60
   mins <- floor(y + .Machine$double.eps^0.5)
   y <- (y - mins) * 60
   secs <- round(y, digits = digits)
   sprintf("%02d:%02d:%02d", hours, mins, secs)
}

x <- c("0.56875000000000009", "0.57708333333333328")
xl_fracday_to_time(x)
#[1] "13:39:00" "13:51:00"


Hope this helps,

Rui Barradas

?s 07:12 de 01/04/2022, Patrick Giraudoux escreveu:
> I have a unexpected behaviour reading times with colon from an Excel
> file, using the package readxl.
> 
> In an Excel sheet, I have a column with times in hours:minutes, e.g:
> 
> Arrival_time
> 13:39
> 13:51
> 
> When read from R with readxl::read_excel, this gives a tibble column
> with full date by defaut being the last day of 1899. OK. Why not, I know
> that POSIX variables are starting in 1900 after R doc (however I wonder
> why here the defaut is one day before January 1, 1900
> 
>> tmp$Arrival_time  [1] "1899-12-31 13:39:00 UTC" "1899-12-31 13:51:00 UTC"
> 
> Well, this is not exactly what I want to. I do not care about the year
> and the day... Therefore I decided to import this column as "text"
> explicitely (in order to manage it within R then). And this is what I
> get now:
> 
>> read_excel("saisie_data_durban_rapaces_LPO.xlsx",sheet=2,col_types="text")  > tmp$Arrival_time [1] "0.56875000000000009" "0.57708333333333328"
> 
> Can someone tell me what happens ?
> 
> I would really appreciate to understand the trick...
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From p@tr|ck@g|r@udoux @end|ng |rom un|v-|comte@|r  Fri Apr  1 09:50:05 2022
From: p@tr|ck@g|r@udoux @end|ng |rom un|v-|comte@|r (Patrick Giraudoux)
Date: Fri, 1 Apr 2022 09:50:05 +0200
Subject: [R] readxl, read_excel: how colon (:) is read ?
In-Reply-To: <cbea4019-7fb0-8eb6-115e-0b3671677a8a@sapo.pt>
References: <04b39c28-a42e-1a91-c446-82d53eb873b8@univ-fcomte.fr>
 <cbea4019-7fb0-8eb6-115e-0b3671677a8a@sapo.pt>
Message-ID: <4aa35965-37e0-8883-2447-a7dd57d4d9f0@univ-fcomte.fr>

Thanks ! An option is also to import from excel as a text, hence getting 
a fractional number of day as character. With as.numeric, it can be 
converted to numeric. The conversion into any unit of a day (hour, 
minutes, etc.) is then easy...
 ?eg. 0.5*24 = 12 hours


Le 01/04/2022 ? 09:09, Rui Barradas a ?crit?:
> Hello,
>
> The following function is probably not very solid, to work with dates 
> and times is not trivial, but it converts those Excel numbers correctly.
>
> I don't know with what numbers it fails.
>
>
> xl_fracday_to_time <- function(x, digits = 0L) {
> ? old_opts <- options(digits = 20)
> ? on.exit(options(old_opts))
> ? if(is.character(x)) {
> ??? x <- as.numeric(x)
> ? }
> ? y <- x * 24
> ? hours <- floor(y + .Machine$double.eps^0.5)
> ? y <- (y - hours) * 60
> ? mins <- floor(y + .Machine$double.eps^0.5)
> ? y <- (y - mins) * 60
> ? secs <- round(y, digits = digits)
> ? sprintf("%02d:%02d:%02d", hours, mins, secs)
> }
>
> x <- c("0.56875000000000009", "0.57708333333333328")
> xl_fracday_to_time(x)
> #[1] "13:39:00" "13:51:00"
>
>
> Hope this helps,
>
> Rui Barradas
>
> ?s 07:12 de 01/04/2022, Patrick Giraudoux escreveu:
>> I have a unexpected behaviour reading times with colon from an Excel
>> file, using the package readxl.
>>
>> In an Excel sheet, I have a column with times in hours:minutes, e.g:
>>
>> Arrival_time
>> 13:39
>> 13:51
>>
>> When read from R with readxl::read_excel, this gives a tibble column
>> with full date by defaut being the last day of 1899. OK. Why not, I know
>> that POSIX variables are starting in 1900 after R doc (however I wonder
>> why here the defaut is one day before January 1, 1900
>>
>>> tmp$Arrival_time? [1] "1899-12-31 13:39:00 UTC" "1899-12-31 13:51:00 
>>> UTC"
>>
>> Well, this is not exactly what I want to. I do not care about the year
>> and the day... Therefore I decided to import this column as "text"
>> explicitely (in order to manage it within R then). And this is what I
>> get now:
>>
>>> read_excel("saisie_data_durban_rapaces_LPO.xlsx",sheet=2,col_types="text") 
>>> > tmp$Arrival_time [1] "0.56875000000000009" "0.57708333333333328"
>>
>> Can someone tell me what happens ?
>>
>> I would really appreciate to understand the trick...
>>
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Apr  1 09:53:01 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 01 Apr 2022 00:53:01 -0700
Subject: [R] readxl, read_excel: how colon (:) is read ?
In-Reply-To: <cbea4019-7fb0-8eb6-115e-0b3671677a8a@sapo.pt>
References: <04b39c28-a42e-1a91-c446-82d53eb873b8@univ-fcomte.fr>
 <cbea4019-7fb0-8eb6-115e-0b3671677a8a@sapo.pt>
Message-ID: <23804918-C4AA-47B6-B498-BD128F5CE689@dcn.davis.ca.us>

Why not simply let readxl read the timestamp as it will naturally and use

    dta$Arrival_time_c <- as.character( dta$Arrival_time, format = "%H:%M" )

... though time data in such a form is remarkably useless for data analysis.

On April 1, 2022 12:09:02 AM PDT, Rui Barradas <ruipbarradas at sapo.pt> wrote:
>Hello,
>
>The following function is probably not very solid, to work with dates 
>and times is not trivial, but it converts those Excel numbers correctly.
>
>I don't know with what numbers it fails.
>
>
>xl_fracday_to_time <- function(x, digits = 0L) {
>   old_opts <- options(digits = 20)
>   on.exit(options(old_opts))
>   if(is.character(x)) {
>     x <- as.numeric(x)
>   }
>   y <- x * 24
>   hours <- floor(y + .Machine$double.eps^0.5)
>   y <- (y - hours) * 60
>   mins <- floor(y + .Machine$double.eps^0.5)
>   y <- (y - mins) * 60
>   secs <- round(y, digits = digits)
>   sprintf("%02d:%02d:%02d", hours, mins, secs)
>}
>
>x <- c("0.56875000000000009", "0.57708333333333328")
>xl_fracday_to_time(x)
>#[1] "13:39:00" "13:51:00"
>
>
>Hope this helps,
>
>Rui Barradas
>
>?s 07:12 de 01/04/2022, Patrick Giraudoux escreveu:
>> I have a unexpected behaviour reading times with colon from an Excel
>> file, using the package readxl.
>> 
>> In an Excel sheet, I have a column with times in hours:minutes, e.g:
>> 
>> Arrival_time
>> 13:39
>> 13:51
>> 
>> When read from R with readxl::read_excel, this gives a tibble column
>> with full date by defaut being the last day of 1899. OK. Why not, I know
>> that POSIX variables are starting in 1900 after R doc (however I wonder
>> why here the defaut is one day before January 1, 1900
>> 
>>> tmp$Arrival_time  [1] "1899-12-31 13:39:00 UTC" "1899-12-31 13:51:00 UTC"
>> 
>> Well, this is not exactly what I want to. I do not care about the year
>> and the day... Therefore I decided to import this column as "text"
>> explicitely (in order to manage it within R then). And this is what I
>> get now:
>> 
>>> read_excel("saisie_data_durban_rapaces_LPO.xlsx",sheet=2,col_types="text")  > tmp$Arrival_time [1] "0.56875000000000009" "0.57708333333333328"
>> 
>> Can someone tell me what happens ?
>> 
>> I would really appreciate to understand the trick...
>> 
>> 
>> 	[[alternative HTML version deleted]]
>> 
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From pj@|nh@07 @end|ng |rom gm@||@com  Fri Apr  1 01:00:20 2022
From: pj@|nh@07 @end|ng |rom gm@||@com (pooja sinha)
Date: Thu, 31 Mar 2022 19:00:20 -0400
Subject: [R] Violin plots in R
Message-ID: <CAGjf1cOgGf_hnfyG5msuAFERJOc1wo3f9vTXNYHaP_JH08XBXQ@mail.gmail.com>

Hi All,

I need your help in making the violin plot in R using the data which is
attached herewith. I am new to R and having issues in tidying my data for
R. I am trying the code but I am not able to tidy my data for violin plot
in ggplot.

Any help will be highly appreciated.

Thanks,
Puja

From er|cjberger @end|ng |rom gm@||@com  Fri Apr  1 11:32:41 2022
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Fri, 1 Apr 2022 12:32:41 +0300
Subject: [R] Violin plots in R
In-Reply-To: <CAGjf1cOgGf_hnfyG5msuAFERJOc1wo3f9vTXNYHaP_JH08XBXQ@mail.gmail.com>
References: <CAGjf1cOgGf_hnfyG5msuAFERJOc1wo3f9vTXNYHaP_JH08XBXQ@mail.gmail.com>
Message-ID: <CAGgJW76PFX9=cmvNNuCh94eRmdEoqHPyQJnpVvBKTk0rTFZ3zg@mail.gmail.com>

1. Your data was not attached.
2. You should show the code that you tried so that people can find the
problem(s).
3. have you tried searching the web for examples that work? A quick search
gave this site which looked relevant

http://www.sthda.com/english/wiki/ggplot2-violin-plot-quick-start-guide-r-software-and-data-visualization


On Fri, Apr 1, 2022 at 12:12 PM pooja sinha <pjsinha07 at gmail.com> wrote:

> Hi All,
>
> I need your help in making the violin plot in R using the data which is
> attached herewith. I am new to R and having issues in tidying my data for
> R. I am trying the code but I am not able to tidy my data for violin plot
> in ggplot.
>
> Any help will be highly appreciated.
>
> Thanks,
> Puja
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From tebert @end|ng |rom u||@edu  Fri Apr  1 11:34:53 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Fri, 1 Apr 2022 09:34:53 +0000
Subject: [R] Violin plots in R
In-Reply-To: <CAGjf1cOgGf_hnfyG5msuAFERJOc1wo3f9vTXNYHaP_JH08XBXQ@mail.gmail.com>
References: <CAGjf1cOgGf_hnfyG5msuAFERJOc1wo3f9vTXNYHaP_JH08XBXQ@mail.gmail.com>
Message-ID: <BN6PR2201MB1553646A54C40A35565E49FACFE09@BN6PR2201MB1553.namprd22.prod.outlook.com>

No data. Attachments are removed. Send only text. Include program. Did you look at geom_violin() ? try http://www.sthda.com/english/wiki/ggplot2-violin-plot-quick-start-guide-r-software-and-data-visualization

If geom_point() is working then geom_violin() should also work. If neither work then the problem is earlier in the program. Possibly in the ggplot() statement, or earlier.
Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of pooja sinha
Sent: Thursday, March 31, 2022 7:00 PM
To: r-help mailing list <r-help at r-project.org>
Subject: [R] Violin plots in R

[External Email]

Hi All,

I need your help in making the violin plot in R using the data which is attached herewith. I am new to R and having issues in tidying my data for R. I am trying the code but I am not able to tidy my data for violin plot in ggplot.

Any help will be highly appreciated.

Thanks,
Puja
______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=ewsSBA7yD-EGNgEo5uwx8ypGde2s8cN0NqRJcjUeat_oxJOzxc4u1RoS4APbTp-G&s=5RT-EbmPWAiqxd-tCyTCK3tUPOmNomYvRoE-pgEKXMk&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=ewsSBA7yD-EGNgEo5uwx8ypGde2s8cN0NqRJcjUeat_oxJOzxc4u1RoS4APbTp-G&s=FhxhDOcldxc5mIg1wiE5kq4D_sxIm1Ho0PbejAHl8xY&e=
and provide commented, minimal, self-contained, reproducible code.


From petr@p|k@| @end|ng |rom prechez@@cz  Fri Apr  1 14:58:55 2022
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Fri, 1 Apr 2022 12:58:55 +0000
Subject: [R] Violin plots in R
In-Reply-To: <BN6PR2201MB1553646A54C40A35565E49FACFE09@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <CAGjf1cOgGf_hnfyG5msuAFERJOc1wo3f9vTXNYHaP_JH08XBXQ@mail.gmail.com>
 <BN6PR2201MB1553646A54C40A35565E49FACFE09@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <fc563a5b5c6a4aeba1353ba31d4980ae@SRVEXCHCM1302.precheza.cz>

Hi.

Beside advice of others, at least 

str(yourdata)
and the ggplot code is minimum for us to be able to offer some advice.

Preferable way how to send your data is output from

dput(yourdata) or dput(head(yourdata))

Just copy paste to your email.

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Ebert,Timothy
> Aaron
> Sent: Friday, April 1, 2022 11:35 AM
> To: pooja sinha <pjsinha07 at gmail.com>; r-help mailing list <r-help at r-
> project.org>
> Subject: Re: [R] Violin plots in R
> 
> No data. Attachments are removed. Send only text. Include program. Did you
> look at geom_violin() ? try http://www.sthda.com/english/wiki/ggplot2-
> violin-plot-quick-start-guide-r-software-and-data-visualization
> 
> If geom_point() is working then geom_violin() should also work. If neither
> work then the problem is earlier in the program. Possibly in the ggplot()
> statement, or earlier.
> Tim
> 
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of pooja sinha
> Sent: Thursday, March 31, 2022 7:00 PM
> To: r-help mailing list <r-help at r-project.org>
> Subject: [R] Violin plots in R
> 
> [External Email]
> 
> Hi All,
> 
> I need your help in making the violin plot in R using the data which is
> attached herewith. I am new to R and having issues in tidying my data for
R. I
> am trying the code but I am not able to tidy my data for violin plot in
ggplot.
> 
> Any help will be highly appreciated.
> 
> Thanks,
> Puja
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://urldefense.proofpoint.com/v2/url?u=https-
> 3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-
> zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=ewsSBA7yD-
> EGNgEo5uwx8ypGde2s8cN0NqRJcjUeat_oxJOzxc4u1RoS4APbTp-G&s=5RT-
> EbmPWAiqxd-tCyTCK3tUPOmNomYvRoE-pgEKXMk&e=
> PLEASE do read the posting guide
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-
> 2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-
> zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=ewsSBA7yD-
> EGNgEo5uwx8ypGde2s8cN0NqRJcjUeat_oxJOzxc4u1RoS4APbTp-
> G&s=FhxhDOcldxc5mIg1wiE5kq4D_sxIm1Ho0PbejAHl8xY&e=
> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

From pj@|nh@07 @end|ng |rom gm@||@com  Fri Apr  1 15:22:02 2022
From: pj@|nh@07 @end|ng |rom gm@||@com (pooja sinha)
Date: Fri, 1 Apr 2022 09:22:02 -0400
Subject: [R] Violin plots in R
In-Reply-To: <fc563a5b5c6a4aeba1353ba31d4980ae@SRVEXCHCM1302.precheza.cz>
References: <CAGjf1cOgGf_hnfyG5msuAFERJOc1wo3f9vTXNYHaP_JH08XBXQ@mail.gmail.com>
 <BN6PR2201MB1553646A54C40A35565E49FACFE09@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <fc563a5b5c6a4aeba1353ba31d4980ae@SRVEXCHCM1302.precheza.cz>
Message-ID: <CAGjf1cNDL3Hwga9hXTNyWzD-P7P8UqBqD8JPG2j5xS8dWwe6TA@mail.gmail.com>

Thanks, I will do that.


Puja

On Fri, Apr 1, 2022 at 8:58 AM PIKAL Petr <petr.pikal at precheza.cz> wrote:

> Hi.
>
> Beside advice of others, at least
>
> str(yourdata)
> and the ggplot code is minimum for us to be able to offer some advice.
>
> Preferable way how to send your data is output from
>
> dput(yourdata) or dput(head(yourdata))
>
> Just copy paste to your email.
>
> Cheers
> Petr
>
> > -----Original Message-----
> > From: R-help <r-help-bounces at r-project.org> On Behalf Of Ebert,Timothy
> > Aaron
> > Sent: Friday, April 1, 2022 11:35 AM
> > To: pooja sinha <pjsinha07 at gmail.com>; r-help mailing list <r-help at r-
> > project.org>
> > Subject: Re: [R] Violin plots in R
> >
> > No data. Attachments are removed. Send only text. Include program. Did
> you
> > look at geom_violin() ? try http://www.sthda.com/english/wiki/ggplot2-
> > violin-plot-quick-start-guide-r-software-and-data-visualization
> >
> > If geom_point() is working then geom_violin() should also work. If
> neither
> > work then the problem is earlier in the program. Possibly in the ggplot()
> > statement, or earlier.
> > Tim
> >
> > -----Original Message-----
> > From: R-help <r-help-bounces at r-project.org> On Behalf Of pooja sinha
> > Sent: Thursday, March 31, 2022 7:00 PM
> > To: r-help mailing list <r-help at r-project.org>
> > Subject: [R] Violin plots in R
> >
> > [External Email]
> >
> > Hi All,
> >
> > I need your help in making the violin plot in R using the data which is
> > attached herewith. I am new to R and having issues in tidying my data for
> R. I
> > am trying the code but I am not able to tidy my data for violin plot in
> ggplot.
> >
> > Any help will be highly appreciated.
> >
> > Thanks,
> > Puja
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://urldefense.proofpoint.com/v2/url?u=https-
> > 3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-
> > zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=ewsSBA7yD-
> > EGNgEo5uwx8ypGde2s8cN0NqRJcjUeat_oxJOzxc4u1RoS4APbTp-G&s=5RT-
> > EbmPWAiqxd-tCyTCK3tUPOmNomYvRoE-pgEKXMk&e=
> > PLEASE do read the posting guide
> > https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-
> > 2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-
> > zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=ewsSBA7yD-
> > EGNgEo5uwx8ypGde2s8cN0NqRJcjUeat_oxJOzxc4u1RoS4APbTp-
> > G&s=FhxhDOcldxc5mIg1wiE5kq4D_sxIm1Ho0PbejAHl8xY&e=
> > and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-
> > guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From j|ox @end|ng |rom mcm@@ter@c@  Fri Apr  1 17:16:18 2022
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Fri, 1 Apr 2022 11:16:18 -0400
Subject: [R] 25th anniversary of R-help & new rules for the list
Message-ID: <21bf137e-afc8-11a1-65c3-195f6d674944@mcmaster.ca>

Dear R-help list members,

The first message to the R-help email list was posted by Ross Ihaka 25 
years ago, on April 1, 1997!

On this 25th anniversary of R-help, the official description of the list 
and the rules for posting to it have been modified. The general object 
of these changes is to broaden the topics that are legitimately 
discussed on the R-help list, partly to reflect how the list actually is 
used.

The description of the list at <https://www.r-project.org/mail.html> now 
reads:

------------ snip --------------

The ?main? R mailing list, for discussion about problems and solutions 
encountered using R, including using R packages in the standard R 
distribution and on CRAN; announcements (not covered by R-announce or 
R-packages); the availability of new functionality for R and 
documentation of R; and for posting nice examples and benchmarks.

This is quite an active list with many messages per day. An alternative 
is to subscribe and choose daily digests (in plain or MIME format). Use 
the web interface for information, subscription, archives, etc.

Please read the posting guide before sending a message to the list. In 
particular, if asking for help with a problem, it is important to be 
clear and concrete, and it is almost always advisable to send a minimal 
reproducible example of the problem.

There are many more specific R email lists (see below under ?Special 
Interest Groups?). If a problem is appropriate for one of the more 
specific lists, you are usually more likely to get help by posting to 
the more specific list. For example, a problem specific to R under macOS 
should normally be posted to the R-SIG-Mac list, and a problem 
concerning R software for mixed-effects models should normally be posted 
to the R-SIG-mixed-models list.

R-help is not intended for help with homework or basic-statistics questions.

Bugs in contributed CRAN packages should normally be reported directly 
to the package maintainer (enter the command 
maintainer("package-name")). You may also be able to obtain help with a 
problem from the package maintainer.

Help with R problems is available from a number of sources beyond the R 
email lists. See under ?Help? at the R home page.

------------ snip --------------

We have also modified the brief description of the R-help list in the 
posting guide at <https://www.r-project.org/posting-guide.html> and 
(eventually) in the R FAQ.

Best,
John Fox

For the R Foundation
-- 
John Fox, Professor Emeritus
McMaster University
Hamilton, Ontarion, Canada
web: https://socialsciences.mcmaster.ca/jfox/


From @erv|ce @end|ng |rom @hd@w@on@com  Fri Apr  1 17:23:20 2022
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Fri, 1 Apr 2022 11:23:20 -0400
Subject: [R] Recommended Statistics Papers and Packages
Message-ID: <f33867b3-5087-0c5e-cf5d-34c79e5f97d4@shdawson.com>

Good Morning,


I have been doing some further reading on the topic of statistics 
lately. I enjoyed reading the following material. I am writing to share 
the material with the list as recommended reading on the respective topics.


Estimating the number of clusters in a data set via the gap statistic
https://hastie.su.domains/Papers/gap.pdf



Package ?FNN?
https://cran.r-project.org/web/packages/FNN/FNN.pdf



The Relationship Between Precision-Recall and ROC Curves
https://www.biostat.wisc.edu/~page/rocpr.pdf


Enjoy!


Kindest Regards
-- 
*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com


From g@@mo||n@k|1 @end|ng |rom gm@||@com  Fri Apr  1 21:50:01 2022
From: g@@mo||n@k|1 @end|ng |rom gm@||@com (=?UTF-8?Q?Grzegorz_Smoli=C5=84ski?=)
Date: Fri, 1 Apr 2022 21:50:01 +0200
Subject: [R] Modificatio of function body within a function
Message-ID: <CABxpnnnkEvQceozk4yHaDJruTobUuno5Prhs8n5xmnFkpKdyDg@mail.gmail.com>

Hi,

I'm working on a presentation regarding the modification of the
function body on-the-fly and just discovered something I don't
understand. I would like to modify a body of the function within a
function, but I see that it is possible only when explicitly referring
to the environment where the function is defined:

fun1 <- function() {
  1
  body(fun1)[[2]] <- "one"
}
fun1()
body(fun1)
#> {
#>     1
#>     body(fun1)[[2]] <- "one"
#> }

fun2 <- function() {
  2
  env <- environment(fun2)
  body(env$fun2)[[2]] <- "two"
}
fun2()
body(fun2)
#> {
#>     "two"
#>     env <- environment(fun2)
#>     body(env$fun2)[[2]] <- "two"
#> }

Can I get some explanation or some links / articles about this,
please? I thought it won't be a difference and I should be able to
modify a function body also in the first case, because I'm changing
something in the parent environment being in the child environment.

Best regards,

Grzegorz


From bgunter@4567 @end|ng |rom gm@||@com  Fri Apr  1 23:12:28 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 1 Apr 2022 14:12:28 -0700
Subject: [R] Modificatio of function body within a function
In-Reply-To: <CABxpnnnkEvQceozk4yHaDJruTobUuno5Prhs8n5xmnFkpKdyDg@mail.gmail.com>
References: <CABxpnnnkEvQceozk4yHaDJruTobUuno5Prhs8n5xmnFkpKdyDg@mail.gmail.com>
Message-ID: <CAGxFJbSOOLbPB7ETcSkSO44j-TyH02BdjCBhLvjJ_GkroQW0pg@mail.gmail.com>

Heh ... These self-referential constructs are certainly puzzles...

Does this help:

fun1 <- function() {
   1
   body(fun1)[[2]] <<- 'one'
   'hi'
}

> fun1
function() {
   1
   body(fun1)[[2]] <<- 'one' ## note the double '<<" assigning to the parent env
   'hi'
}

> fun1()
[1] "hi"

> fun1
function ()
{
    "one" ## the change was made
    body(fun1)[[2]] <<- "one"
    "hi"
}

The point is that assignments within a function occur *within* the
function environment unless otherwise specified (either by <<- or the
use of the 'environment' argument in 'body<-'()  ). This is, of
course, central to the functional programming paradigm of no side
effects (unless explicitly invoked).

NOTE: Correction to this requested if this is wrong in any way!!

Cheers,
Bert




Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Fri, Apr 1, 2022 at 12:50 PM Grzegorz Smoli?ski
<g.smolinski1 at gmail.com> wrote:
>
> Hi,
>
> I'm working on a presentation regarding the modification of the
> function body on-the-fly and just discovered something I don't
> understand. I would like to modify a body of the function within a
> function, but I see that it is possible only when explicitly referring
> to the environment where the function is defined:
>
> fun1 <- function() {
>   1
>   body(fun1)[[2]] <- "one"
> }
> fun1()
> body(fun1)
> #> {
> #>     1
> #>     body(fun1)[[2]] <- "one"
> #> }
>
> fun2 <- function() {
>   2
>   env <- environment(fun2)
>   body(env$fun2)[[2]] <- "two"
> }
> fun2()
> body(fun2)
> #> {
> #>     "two"
> #>     env <- environment(fun2)
> #>     body(env$fun2)[[2]] <- "two"
> #> }
>
> Can I get some explanation or some links / articles about this,
> please? I thought it won't be a difference and I should be able to
> modify a function body also in the first case, because I'm changing
> something in the parent environment being in the child environment.
>
> Best regards,
>
> Grzegorz
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From g@@mo||n@k|1 @end|ng |rom gm@||@com  Sat Apr  2 11:31:35 2022
From: g@@mo||n@k|1 @end|ng |rom gm@||@com (=?UTF-8?Q?Grzegorz_Smoli=C5=84ski?=)
Date: Sat, 2 Apr 2022 11:31:35 +0200
Subject: [R] Modificatio of function body within a function
In-Reply-To: <CAGxFJbSOOLbPB7ETcSkSO44j-TyH02BdjCBhLvjJ_GkroQW0pg@mail.gmail.com>
References: <CABxpnnnkEvQceozk4yHaDJruTobUuno5Prhs8n5xmnFkpKdyDg@mail.gmail.com>
 <CAGxFJbSOOLbPB7ETcSkSO44j-TyH02BdjCBhLvjJ_GkroQW0pg@mail.gmail.com>
Message-ID: <CABxpnn=dp6H0ki7oSsD7JPTSL+0jBgBJeMv2=NE7QOGGTnh=gw@mail.gmail.com>

Thank you, I think I can say that I get it, especially when reading
this explanation: "assignments within a function occur *within* the
function environment unless otherwise specified", so this is just like
in the example below:

a <- 4
fun2 <- function() {
  a <- 2
}
fun2()
a
#> [1] 4

a <- 4
fun2 <- function() {
  env <- .GlobalEnv
  env$a <- 2
}
fun2()
a
#> [1] 2

I would like to ask about one more thing, also regarding the
modification of the body of function. There is one phenomenon which
I'm actually using during my work with R, but I'm not sure why this
happens. Below is an example of this:

fun1 <- function() {
  1
  env <- environment(fun1)
  body(env$fun1) <- body(env$fun1)[-5]
  "one"
}
fun1()
#> [1] "one"
body(fun1)
#> {
#>     1
#>     env <- environment(fun1)
#>     body(env$fun1) <- body(env$fun1)[-5]
#> }

Within a function, I'm removing the last line of code in that function
(string "one") and what happens here is that when I use this function
(first time), that string is actually returned, so this line of code
which is removed is executed. I don't have a good background in
computer science and would like to know why this last line of code is
executed. Why not - well, I could imagine that when the function is
called, it is executed line by line (of course), so before the last
line ("one"), this line will be removed and this string won't be
returned. However, when Bert mentioned functional paradigm, I have
started to think that it may looks like this:
a) function is defined
b) function is called and in the one before last line of code, some
object (fun1) is modified and when something is modified, the copy is
made, so the modified function lives in a different memory address.
c) the original function (not changed) continues computation and
returns the string
d) when the execution is finished, then the modified fun1 is bind to
the name "fun1" and because this happens in the same environment where
the original fun1 was defined and the objects are now different,
garbage collector removes original (not modified) fun1 object.

Is that, more or less, what happens?

Best,

Grzegorz

pt., 1 kwi 2022 o 23:12 Bert Gunter <bgunter.4567 at gmail.com> napisa?(a):
>
> Heh ... These self-referential constructs are certainly puzzles...
>
> Does this help:
>
> fun1 <- function() {
>    1
>    body(fun1)[[2]] <<- 'one'
>    'hi'
> }
>
> > fun1
> function() {
>    1
>    body(fun1)[[2]] <<- 'one' ## note the double '<<" assigning to the parent env
>    'hi'
> }
>
> > fun1()
> [1] "hi"
>
> > fun1
> function ()
> {
>     "one" ## the change was made
>     body(fun1)[[2]] <<- "one"
>     "hi"
> }
>
> The point is that assignments within a function occur *within* the
> function environment unless otherwise specified (either by <<- or the
> use of the 'environment' argument in 'body<-'()  ). This is, of
> course, central to the functional programming paradigm of no side
> effects (unless explicitly invoked).
>
> NOTE: Correction to this requested if this is wrong in any way!!
>
> Cheers,
> Bert
>
>
>
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
>
> On Fri, Apr 1, 2022 at 12:50 PM Grzegorz Smoli?ski
> <g.smolinski1 at gmail.com> wrote:
> >
> > Hi,
> >
> > I'm working on a presentation regarding the modification of the
> > function body on-the-fly and just discovered something I don't
> > understand. I would like to modify a body of the function within a
> > function, but I see that it is possible only when explicitly referring
> > to the environment where the function is defined:
> >
> > fun1 <- function() {
> >   1
> >   body(fun1)[[2]] <- "one"
> > }
> > fun1()
> > body(fun1)
> > #> {
> > #>     1
> > #>     body(fun1)[[2]] <- "one"
> > #> }
> >
> > fun2 <- function() {
> >   2
> >   env <- environment(fun2)
> >   body(env$fun2)[[2]] <- "two"
> > }
> > fun2()
> > body(fun2)
> > #> {
> > #>     "two"
> > #>     env <- environment(fun2)
> > #>     body(env$fun2)[[2]] <- "two"
> > #> }
> >
> > Can I get some explanation or some links / articles about this,
> > please? I thought it won't be a difference and I should be able to
> > modify a function body also in the first case, because I'm changing
> > something in the parent environment being in the child environment.
> >
> > Best regards,
> >
> > Grzegorz
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Sat Apr  2 16:39:16 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 2 Apr 2022 07:39:16 -0700
Subject: [R] Modificatio of function body within a function
In-Reply-To: <CABxpnn=dp6H0ki7oSsD7JPTSL+0jBgBJeMv2=NE7QOGGTnh=gw@mail.gmail.com>
References: <CABxpnnnkEvQceozk4yHaDJruTobUuno5Prhs8n5xmnFkpKdyDg@mail.gmail.com>
 <CAGxFJbSOOLbPB7ETcSkSO44j-TyH02BdjCBhLvjJ_GkroQW0pg@mail.gmail.com>
 <CABxpnn=dp6H0ki7oSsD7JPTSL+0jBgBJeMv2=NE7QOGGTnh=gw@mail.gmail.com>
Message-ID: <CAGxFJbT35KQR7pcE2mEL-dYWMhWc76Ce0-6brsKuux-KpA8oUA@mail.gmail.com>

This is not as complicated as you think.

## First define the function.
> fun1 <- function() {
    1
    env <- environment(fun1)
    body(env$fun1) <- body(env$fun1)[-5]
    "one"
 }

## The function as defined above is now in the environment in which it
was defined, here .GlobalRnv.

## Now calling it executes **the above function.**
> fun1()
[1] "one"

## But this execution has the side effect of modifying the function
object in .GlobalEnv. (This is why side effects can be problematic).
So when we look at fun1 again in that environment, we see the modified
version.

> fun1
function ()
{
    1
    env <- environment(fun1)
    body(env$fun1) <- body(env$fun1)[-5]
}

## which, of course, returns nothing on being called.
> fun1()
>

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Sat, Apr 2, 2022 at 2:32 AM Grzegorz Smoli?ski
<g.smolinski1 at gmail.com> wrote:
>
> Thank you, I think I can say that I get it, especially when reading
> this explanation: "assignments within a function occur *within* the
> function environment unless otherwise specified", so this is just like
> in the example below:
>
> a <- 4
> fun2 <- function() {
>   a <- 2
> }
> fun2()
> a
> #> [1] 4
>
> a <- 4
> fun2 <- function() {
>   env <- .GlobalEnv
>   env$a <- 2
> }
> fun2()
> a
> #> [1] 2
>
> I would like to ask about one more thing, also regarding the
> modification of the body of function. There is one phenomenon which
> I'm actually using during my work with R, but I'm not sure why this
> happens. Below is an example of this:
>
> fun1 <- function() {
>   1
>   env <- environment(fun1)
>   body(env$fun1) <- body(env$fun1)[-5]
>   "one"
> }
> fun1()
> #> [1] "one"
> body(fun1)
> #> {
> #>     1
> #>     env <- environment(fun1)
> #>     body(env$fun1) <- body(env$fun1)[-5]
> #> }
>
> Within a function, I'm removing the last line of code in that function
> (string "one") and what happens here is that when I use this function
> (first time), that string is actually returned, so this line of code
> which is removed is executed. I don't have a good background in
> computer science and would like to know why this last line of code is
> executed. Why not - well, I could imagine that when the function is
> called, it is executed line by line (of course), so before the last
> line ("one"), this line will be removed and this string won't be
> returned. However, when Bert mentioned functional paradigm, I have
> started to think that it may looks like this:
> a) function is defined
> b) function is called and in the one before last line of code, some
> object (fun1) is modified and when something is modified, the copy is
> made, so the modified function lives in a different memory address.
> c) the original function (not changed) continues computation and
> returns the string
> d) when the execution is finished, then the modified fun1 is bind to
> the name "fun1" and because this happens in the same environment where
> the original fun1 was defined and the objects are now different,
> garbage collector removes original (not modified) fun1 object.
>
> Is that, more or less, what happens?
>
> Best,
>
> Grzegorz
>
> pt., 1 kwi 2022 o 23:12 Bert Gunter <bgunter.4567 at gmail.com> napisa?(a):
> >
> > Heh ... These self-referential constructs are certainly puzzles...
> >
> > Does this help:
> >
> > fun1 <- function() {
> >    1
> >    body(fun1)[[2]] <<- 'one'
> >    'hi'
> > }
> >
> > > fun1
> > function() {
> >    1
> >    body(fun1)[[2]] <<- 'one' ## note the double '<<" assigning to the parent env
> >    'hi'
> > }
> >
> > > fun1()
> > [1] "hi"
> >
> > > fun1
> > function ()
> > {
> >     "one" ## the change was made
> >     body(fun1)[[2]] <<- "one"
> >     "hi"
> > }
> >
> > The point is that assignments within a function occur *within* the
> > function environment unless otherwise specified (either by <<- or the
> > use of the 'environment' argument in 'body<-'()  ). This is, of
> > course, central to the functional programming paradigm of no side
> > effects (unless explicitly invoked).
> >
> > NOTE: Correction to this requested if this is wrong in any way!!
> >
> > Cheers,
> > Bert
> >
> >
> >
> >
> > Bert Gunter
> >
> > "The trouble with having an open mind is that people keep coming along
> > and sticking things into it."
> > -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> >
> > Bert Gunter
> >
> > "The trouble with having an open mind is that people keep coming along
> > and sticking things into it."
> > -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> >
> >
> > On Fri, Apr 1, 2022 at 12:50 PM Grzegorz Smoli?ski
> > <g.smolinski1 at gmail.com> wrote:
> > >
> > > Hi,
> > >
> > > I'm working on a presentation regarding the modification of the
> > > function body on-the-fly and just discovered something I don't
> > > understand. I would like to modify a body of the function within a
> > > function, but I see that it is possible only when explicitly referring
> > > to the environment where the function is defined:
> > >
> > > fun1 <- function() {
> > >   1
> > >   body(fun1)[[2]] <- "one"
> > > }
> > > fun1()
> > > body(fun1)
> > > #> {
> > > #>     1
> > > #>     body(fun1)[[2]] <- "one"
> > > #> }
> > >
> > > fun2 <- function() {
> > >   2
> > >   env <- environment(fun2)
> > >   body(env$fun2)[[2]] <- "two"
> > > }
> > > fun2()
> > > body(fun2)
> > > #> {
> > > #>     "two"
> > > #>     env <- environment(fun2)
> > > #>     body(env$fun2)[[2]] <- "two"
> > > #> }
> > >
> > > Can I get some explanation or some links / articles about this,
> > > please? I thought it won't be a difference and I should be able to
> > > modify a function body also in the first case, because I'm changing
> > > something in the parent environment being in the child environment.
> > >
> > > Best regards,
> > >
> > > Grzegorz
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Apr  2 19:45:07 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 2 Apr 2022 18:45:07 +0100
Subject: [R] Unexpected behavior in par()
Message-ID: <ec4aa4b3-1b4c-8272-96d3-b0dde00af5d0@sapo.pt>

Hello,

I have a function using base graphics that changes some graphics 
parameters, then plots what it has to plot, then on exit puts the 
graphics parameters back as they were.
The problem is that if outside the function the graphics parameters are 
also changed, for instance mfrow, those chages are not respected by the 
function. This seems to come from the way the graphics pars are saved.

After par(mfrow = c(2, 1))

- if I call par(no.readonly = TRUE) then the second call to the function 
plots in the 1st row, it overplots what was plotted before.
- if I save the pars when they are changed, all is well.

Here is a reproducible example.


f <- function(x, ...) {
   old_par <- par(no.readonly = TRUE)    # this is the problem
   par(mar = c(4.1, 3.1, 3.1, 1.1))      # or maybe here
   on.exit(par(old_par))
   barplot(x, ...)
}

g <- function(x, ...) {
   old_par <- par(mar = c(4.1, 3.1, 3.1, 1.1))   # this is the solution
   on.exit(par(old_par))
   barplot(x, ...)
}

set.seed(2022)
b1 <- table(sample(4, 100, TRUE))
b2 <- table(sample(10, 100, TRUE))

# 1st function, unexpected behavior
old_par <- par(mfrow = c(2, 1))
f(b1, main = "1st plot")
f(b2, main = "2nd plot")
par(old_par)

# 2nd function, all is well
old_par <- par(mfrow = c(2, 1))
g(b1, main = "1st plot")
g(b2, main = "2nd plot")
par(old_par)


If I print(old_par) in any of the functions the result is the right 
mfrow setting, so I would expect the 2nd call to f() to plot in the 2nd 
row. But it doesn't.
Function f() calls par() twice but it only changes a parameter unrelated 
to the parameter set outside the function.

I'm obviously making a mistake but I don't know what. Is this expected 
(or a par() bug)?


Thaks in advance,

Rui Barradas


From w||||@mwdun|@p @end|ng |rom gm@||@com  Sat Apr  2 21:00:16 2022
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Sat, 2 Apr 2022 12:00:16 -0700
Subject: [R] Unexpected behavior in par()
In-Reply-To: <ec4aa4b3-1b4c-8272-96d3-b0dde00af5d0@sapo.pt>
References: <ec4aa4b3-1b4c-8272-96d3-b0dde00af5d0@sapo.pt>
Message-ID: <CAHqSRuQzvrUL_+kN8Oy6A+n=Vjxp8x67hB_+AU5zCxoQmXOq3Q@mail.gmail.com>

par("mfrow") works by updating par("fig") before each plot.  I think that
when you reset all the par values after each plot you reset par("fig") to
the value it had before you made the last plot.

-Bill

On Sat, Apr 2, 2022 at 10:45 AM Rui Barradas <ruipbarradas at sapo.pt> wrote:

> Hello,
>
> I have a function using base graphics that changes some graphics
> parameters, then plots what it has to plot, then on exit puts the
> graphics parameters back as they were.
> The problem is that if outside the function the graphics parameters are
> also changed, for instance mfrow, those chages are not respected by the
> function. This seems to come from the way the graphics pars are saved.
>
> After par(mfrow = c(2, 1))
>
> - if I call par(no.readonly = TRUE) then the second call to the function
> plots in the 1st row, it overplots what was plotted before.
> - if I save the pars when they are changed, all is well.
>
> Here is a reproducible example.
>
>
> f <- function(x, ...) {
>    old_par <- par(no.readonly = TRUE)    # this is the problem
>    par(mar = c(4.1, 3.1, 3.1, 1.1))      # or maybe here
>    on.exit(par(old_par))
>    barplot(x, ...)
> }
>
> g <- function(x, ...) {
>    old_par <- par(mar = c(4.1, 3.1, 3.1, 1.1))   # this is the solution
>    on.exit(par(old_par))
>    barplot(x, ...)
> }
>
> set.seed(2022)
> b1 <- table(sample(4, 100, TRUE))
> b2 <- table(sample(10, 100, TRUE))
>
> # 1st function, unexpected behavior
> old_par <- par(mfrow = c(2, 1))
> f(b1, main = "1st plot")
> f(b2, main = "2nd plot")
> par(old_par)
>
> # 2nd function, all is well
> old_par <- par(mfrow = c(2, 1))
> g(b1, main = "1st plot")
> g(b2, main = "2nd plot")
> par(old_par)
>
>
> If I print(old_par) in any of the functions the result is the right
> mfrow setting, so I would expect the 2nd call to f() to plot in the 2nd
> row. But it doesn't.
> Function f() calls par() twice but it only changes a parameter unrelated
> to the parameter set outside the function.
>
> I'm obviously making a mistake but I don't know what. Is this expected
> (or a par() bug)?
>
>
> Thaks in advance,
>
> Rui Barradas
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From p@t @end|ng |rom |@rh@rbor@com  Sat Apr  2 18:22:55 2022
From: p@t @end|ng |rom |@rh@rbor@com (Pat Malone)
Date: Sat, 2 Apr 2022 12:22:55 -0400
Subject: [R] EFA with Complex Survey Data (Incl. Replicate Weights)
In-Reply-To: <BN6PR11MB203337F8459D4CD1A0EF713E9BE19@BN6PR11MB2033.namprd11.prod.outlook.com>
References: <BN6PR11MB203337F8459D4CD1A0EF713E9BE19@BN6PR11MB2033.namprd11.prod.outlook.com>
Message-ID: <CAJhmz4fjFuqGedfxAo5uq_gqh59kYb6zckUZaSbDTWfMnCVYog@mail.gmail.com>

Lybrya,

You might have better luck on SEMNET. Responses won't necessarily be
specific to R, but that's where to find a concentration of experts on
factor analysis in a variety of contexts.

You have to have a LISTSERV account to log in, but you can follow this link
to both set up an account and then subscribe to the list.
https://listserv.ua.edu/cgi-bin/wa?A0=SEMNET

Pat



On Fri, Apr 1, 2022 at 4:14 AM Lybrya Kebreab <Lybrya.Kebreab at ucf.edu>
wrote:

> Hello,
>
>
> I am a doctoral student, completing my dissertation using the public
> HSLS2009 survey data. I am interested in running an exploratory factor
> analysis (EFA) and need to apply both the child weight and replicate
> weights. I found some information on applying weights in EFA (
> https://r-survey.r-forge.r-project.org/survey/html/svyfactanal.html),
> however I have not found information on how to apply multiple replicate
> weights. Can anyone please help me with a resource that can assist?
>
> Thank you kindly,
>
> Lybrya Kebreab
> Doctoral Candidate
> Education-Mathematics Education Track
> School of Teacher Education
> College of Community Innovation and Education
> University of Central Florida
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


-- 

*Patrick S. Malone, PhD*
Sr Research Statistician, FAR HARB?R
+1 803.553.4181  |  pat@ <pat at farharbor.com>  |  farharbor.com
*This message may contain confidential information; if you are not the
intended recipient please notify the sender and delete the message.*

	[[alternative HTML version deleted]]


From @jd@m|co @end|ng |rom gm@||@com  Sat Apr  2 22:14:13 2022
From: @jd@m|co @end|ng |rom gm@||@com (Anthony Damico)
Date: Sat, 2 Apr 2022 16:14:13 -0400
Subject: [R] EFA with Complex Survey Data (Incl. Replicate Weights)
In-Reply-To: <BN6PR11MB203337F8459D4CD1A0EF713E9BE19@BN6PR11MB2033.namprd11.prod.outlook.com>
References: <BN6PR11MB203337F8459D4CD1A0EF713E9BE19@BN6PR11MB2033.namprd11.prod.outlook.com>
Message-ID: <CAOwvMDyujeDniqYq_g=CLBuH2oDwt3KiwC0vrN-t0SYmcAV4vw@mail.gmail.com>

hi!  after loading the survey library, i believe you might want to create a
`svrepdesign()` object that matches the SAS syntax published here?

https://nces.ed.gov/surveys/hsls09/pdf/2011328_1.pdf#page=174

...not sure if you need combined.weights = FALSE option added to the
svrepdesign() call, but it looks like your complex survey design should
look roughly like this?

hsls09_design <- svrepdesign( data = data_frame_with_hsls09 , type="BRR",
weights = ~w1student , repweights="w1student[0-9]+" )

from there, you could look to the examples posted on the ?svyfactanal help
page and use your design=hsls09_design rather than the example dataset
design=dclus1












On Fri, Apr 1, 2022 at 4:14 AM Lybrya Kebreab <Lybrya.Kebreab at ucf.edu>
wrote:

> Hello,
>
>
> I am a doctoral student, completing my dissertation using the public
> HSLS2009 survey data. I am interested in running an exploratory factor
> analysis (EFA) and need to apply both the child weight and replicate
> weights. I found some information on applying weights in EFA (
> https://r-survey.r-forge.r-project.org/survey/html/svyfactanal.html),
> however I have not found information on how to apply multiple replicate
> weights. Can anyone please help me with a resource that can assist?
>
> Thank you kindly,
>
> Lybrya Kebreab
> Doctoral Candidate
> Education-Mathematics Education Track
> School of Teacher Education
> College of Community Innovation and Education
> University of Central Florida
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Apr  2 23:02:31 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 2 Apr 2022 22:02:31 +0100
Subject: [R] Unexpected behavior in par()
In-Reply-To: <CAHqSRuQzvrUL_+kN8Oy6A+n=Vjxp8x67hB_+AU5zCxoQmXOq3Q@mail.gmail.com>
References: <ec4aa4b3-1b4c-8272-96d3-b0dde00af5d0@sapo.pt>
 <CAHqSRuQzvrUL_+kN8Oy6A+n=Vjxp8x67hB_+AU5zCxoQmXOq3Q@mail.gmail.com>
Message-ID: <862ee107-e723-2070-a773-113a5ae06a51@sapo.pt>

Hello,

Thanks, that makes sense. So don't use par(no.readonly = TRUE) unless 
that's the desired behavior.

Rui Barradas

?s 20:00 de 02/04/2022, Bill Dunlap escreveu:
> par("mfrow") works by updating par("fig") before each plot.? I think 
> that when you reset all the par values after each plot you reset 
> par("fig") to the value it had before you made the last plot.
> 
> -Bill
> 
> On Sat, Apr 2, 2022 at 10:45 AM Rui Barradas <ruipbarradas at sapo.pt 
> <mailto:ruipbarradas at sapo.pt>> wrote:
> 
>     Hello,
> 
>     I have a function using base graphics that changes some graphics
>     parameters, then plots what it has to plot, then on exit puts the
>     graphics parameters back as they were.
>     The problem is that if outside the function the graphics parameters are
>     also changed, for instance mfrow, those chages are not respected by the
>     function. This seems to come from the way the graphics pars are saved.
> 
>     After par(mfrow = c(2, 1))
> 
>     - if I call par(no.readonly = TRUE) then the second call to the
>     function
>     plots in the 1st row, it overplots what was plotted before.
>     - if I save the pars when they are changed, all is well.
> 
>     Here is a reproducible example.
> 
> 
>     f <- function(x, ...) {
>      ? ?old_par <- par(no.readonly = TRUE)? ? # this is the problem
>      ? ?par(mar = c(4.1, 3.1, 3.1, 1.1))? ? ? # or maybe here
>      ? ?on.exit(par(old_par))
>      ? ?barplot(x, ...)
>     }
> 
>     g <- function(x, ...) {
>      ? ?old_par <- par(mar = c(4.1, 3.1, 3.1, 1.1))? ?# this is the solution
>      ? ?on.exit(par(old_par))
>      ? ?barplot(x, ...)
>     }
> 
>     set.seed(2022)
>     b1 <- table(sample(4, 100, TRUE))
>     b2 <- table(sample(10, 100, TRUE))
> 
>     # 1st function, unexpected behavior
>     old_par <- par(mfrow = c(2, 1))
>     f(b1, main = "1st plot")
>     f(b2, main = "2nd plot")
>     par(old_par)
> 
>     # 2nd function, all is well
>     old_par <- par(mfrow = c(2, 1))
>     g(b1, main = "1st plot")
>     g(b2, main = "2nd plot")
>     par(old_par)
> 
> 
>     If I print(old_par) in any of the functions the result is the right
>     mfrow setting, so I would expect the 2nd call to f() to plot in the 2nd
>     row. But it doesn't.
>     Function f() calls par() twice but it only changes a parameter
>     unrelated
>     to the parameter set outside the function.
> 
>     I'm obviously making a mistake but I don't know what. Is this expected
>     (or a par() bug)?
> 
> 
>     Thaks in advance,
> 
>     Rui Barradas
> 
>     ______________________________________________
>     R-help at r-project.org <mailto:R-help at r-project.org> mailing list --
>     To UNSUBSCRIBE and more, see
>     https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>     PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>     and provide commented, minimal, self-contained, reproducible code.
>


From m@pjg @end|ng |rom br|@to|@@c@uk  Sat Apr  2 16:58:17 2022
From: m@pjg @end|ng |rom br|@to|@@c@uk (Peter Green)
Date: Sat, 2 Apr 2022 15:58:17 +0100
Subject: [R] [R-pkgs] Nmix package - Bayesian inference about univariate
 Gaussian mixtures with an unknown number of components
Message-ID: <d52bf841-0a15-ba10-6585-155a33be35e9@bristol.ac.uk>

This package is now on CRAN in version 2.0.2, and anyone interested in 
inference on mixture models, or more generally in Bayesian inference for 
"trans-dimensional" problems, is encouraged to try it out. The 
methodology is that presented by Richardson and Green in our 1997 
article in the Journal of the Royal Statistical Society, using 
Reversible jump Markov chain Monte Carlo. The package is based on the 
Fortran code used in the research for that paper, which is available now 
to the R user for the first time. A rich variety of outputs from the 
MCMC sample path is available, optionally, and many features of the 
posterior distribution are presented graphically. Apart from its direct 
use in analysing data, the package might be useful in supporting 
learning about Bayesian computation.

Feedback is most welcome, and I may be open to extending the 
functionality of the package in response to concrete suggestions.

regards,

Peter Green

_______________________________________________
R-packages mailing list
R-packages at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-packages


From g@@mo||n@k|1 @end|ng |rom gm@||@com  Sun Apr  3 12:23:14 2022
From: g@@mo||n@k|1 @end|ng |rom gm@||@com (=?UTF-8?Q?Grzegorz_Smoli=C5=84ski?=)
Date: Sun, 3 Apr 2022 12:23:14 +0200
Subject: [R] ODP:  Modificatio of function body within a function
In-Reply-To: <CAGxFJbT35KQR7pcE2mEL-dYWMhWc76Ce0-6brsKuux-KpA8oUA@mail.gmail.com>
References: <CABxpnnnkEvQceozk4yHaDJruTobUuno5Prhs8n5xmnFkpKdyDg@mail.gmail.com>
 <CAGxFJbSOOLbPB7ETcSkSO44j-TyH02BdjCBhLvjJ_GkroQW0pg@mail.gmail.com>
 <CABxpnn=dp6H0ki7oSsD7JPTSL+0jBgBJeMv2=NE7QOGGTnh=gw@mail.gmail.com>
 <CAGxFJbT35KQR7pcE2mEL-dYWMhWc76Ce0-6brsKuux-KpA8oUA@mail.gmail.com>
Message-ID: <CABxpnnkKV4NGSJpEtyoqbDozVn2pADCFwOSORnQBSpefJXbohw@mail.gmail.com>

Thank you, Bert!


From n|ckmwr@y @end|ng |rom gm@||@com  Sun Apr  3 15:13:31 2022
From: n|ckmwr@y @end|ng |rom gm@||@com (Nick Wray)
Date: Sun, 3 Apr 2022 14:13:31 +0100
Subject: [R] Plotting proportions
Message-ID: <CABxY9BNwhhWgN6zBt5kPNyv69eHWGN5DRdBKTBfMGxzaFRKhUw@mail.gmail.com>

Hello  If you plot a square in the default R studio window you see a
rectangle.  Does anyone know what the proportions of the sides of this
rectangle are?  Thanks Nick Wray

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sun Apr  3 17:25:57 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sun, 3 Apr 2022 16:25:57 +0100
Subject: [R] Plotting proportions
In-Reply-To: <CABxY9BNwhhWgN6zBt5kPNyv69eHWGN5DRdBKTBfMGxzaFRKhUw@mail.gmail.com>
References: <CABxY9BNwhhWgN6zBt5kPNyv69eHWGN5DRdBKTBfMGxzaFRKhUw@mail.gmail.com>
Message-ID: <3279bcaa-3e4a-ac7c-5cee-5e2f9559f8f3@sapo.pt>

Hello,

There's a graphics parameter for aspect ratio that you can set asp=1 on 
a plot by plot basis. But you also need to change pty. From ?par:

pty
A character specifying the type of plot region to be used; "s" generates 
a square plotting region and "m" generates the maximal plotting region.



old_par <- par(pty = "s")
plot(1, asp = 1)
par(old_par)


Hope this helps,

Rui Barradas

?s 14:13 de 03/04/2022, Nick Wray escreveu:
> Hello  If you plot a square in the default R studio window you see a
> rectangle.  Does anyone know what the proportions of the sides of this
> rectangle are?  Thanks Nick Wray
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Sun Apr  3 18:03:17 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sun, 3 Apr 2022 09:03:17 -0700
Subject: [R] Plotting proportions
In-Reply-To: <3279bcaa-3e4a-ac7c-5cee-5e2f9559f8f3@sapo.pt>
References: <CABxY9BNwhhWgN6zBt5kPNyv69eHWGN5DRdBKTBfMGxzaFRKhUw@mail.gmail.com>
 <3279bcaa-3e4a-ac7c-5cee-5e2f9559f8f3@sapo.pt>
Message-ID: <CAGxFJbRnBHEVh8y=BcEMv8PBa1m_v4yGOT-gvLU3ad=0kh9QmQ@mail.gmail.com>

... and following up on Rui's reply, assuming that the default (in R,
not RStudio) "m" is being used, I would assume that the aspect ratio
in the RStudio device depends on the layout of your windows. Also, you
might do better asking here, https://community.rstudio.com/ , than on
this list.

Bert Gunter

On Sun, Apr 3, 2022 at 8:26 AM Rui Barradas <ruipbarradas at sapo.pt> wrote:
>
> Hello,
>
> There's a graphics parameter for aspect ratio that you can set asp=1 on
> a plot by plot basis. But you also need to change pty. From ?par:
>
> pty
> A character specifying the type of plot region to be used; "s" generates
> a square plotting region and "m" generates the maximal plotting region.
>
>
>
> old_par <- par(pty = "s")
> plot(1, asp = 1)
> par(old_par)
>
>
> Hope this helps,
>
> Rui Barradas
>
> ?s 14:13 de 03/04/2022, Nick Wray escreveu:
> > Hello  If you plot a square in the default R studio window you see a
> > rectangle.  Does anyone know what the proportions of the sides of this
> > rectangle are?  Thanks Nick Wray
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From w||||@mwdun|@p @end|ng |rom gm@||@com  Sun Apr  3 18:09:09 2022
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Sun, 3 Apr 2022 09:09:09 -0700
Subject: [R] Unexpected behavior in par()
In-Reply-To: <CAHqSRuQzvrUL_+kN8Oy6A+n=Vjxp8x67hB_+AU5zCxoQmXOq3Q@mail.gmail.com>
References: <ec4aa4b3-1b4c-8272-96d3-b0dde00af5d0@sapo.pt>
 <CAHqSRuQzvrUL_+kN8Oy6A+n=Vjxp8x67hB_+AU5zCxoQmXOq3Q@mail.gmail.com>
Message-ID: <CAHqSRuR6=ajE7P_8oZS34itJ8L6fWe_7SQV1nF6ujd6Onr-ROw@mail.gmail.com>

Making a new plot with par(mfrow=...) or par(mfcol=...) in effect also
updates par("mfg"), which describes where in the array of plots you are.
If you overwrite that with its previous value then you will overlay the new
plot on top of the previous one.

-Bill

On Sat, Apr 2, 2022 at 12:00 PM Bill Dunlap <williamwdunlap at gmail.com>
wrote:

> par("mfrow") works by updating par("fig") before each plot.  I think that
> when you reset all the par values after each plot you reset par("fig") to
> the value it had before you made the last plot.
>
> -Bill
>
> On Sat, Apr 2, 2022 at 10:45 AM Rui Barradas <ruipbarradas at sapo.pt> wrote:
>
>> Hello,
>>
>> I have a function using base graphics that changes some graphics
>> parameters, then plots what it has to plot, then on exit puts the
>> graphics parameters back as they were.
>> The problem is that if outside the function the graphics parameters are
>> also changed, for instance mfrow, those chages are not respected by the
>> function. This seems to come from the way the graphics pars are saved.
>>
>> After par(mfrow = c(2, 1))
>>
>> - if I call par(no.readonly = TRUE) then the second call to the function
>> plots in the 1st row, it overplots what was plotted before.
>> - if I save the pars when they are changed, all is well.
>>
>> Here is a reproducible example.
>>
>>
>> f <- function(x, ...) {
>>    old_par <- par(no.readonly = TRUE)    # this is the problem
>>    par(mar = c(4.1, 3.1, 3.1, 1.1))      # or maybe here
>>    on.exit(par(old_par))
>>    barplot(x, ...)
>> }
>>
>> g <- function(x, ...) {
>>    old_par <- par(mar = c(4.1, 3.1, 3.1, 1.1))   # this is the solution
>>    on.exit(par(old_par))
>>    barplot(x, ...)
>> }
>>
>> set.seed(2022)
>> b1 <- table(sample(4, 100, TRUE))
>> b2 <- table(sample(10, 100, TRUE))
>>
>> # 1st function, unexpected behavior
>> old_par <- par(mfrow = c(2, 1))
>> f(b1, main = "1st plot")
>> f(b2, main = "2nd plot")
>> par(old_par)
>>
>> # 2nd function, all is well
>> old_par <- par(mfrow = c(2, 1))
>> g(b1, main = "1st plot")
>> g(b2, main = "2nd plot")
>> par(old_par)
>>
>>
>> If I print(old_par) in any of the functions the result is the right
>> mfrow setting, so I would expect the 2nd call to f() to plot in the 2nd
>> row. But it doesn't.
>> Function f() calls par() twice but it only changes a parameter unrelated
>> to the parameter set outside the function.
>>
>> I'm obviously making a mistake but I don't know what. Is this expected
>> (or a par() bug)?
>>
>>
>> Thaks in advance,
>>
>> Rui Barradas
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From @|gbert @end|ng |rom w|w|@hu-ber||n@de  Sun Apr  3 20:00:31 2022
From: @|gbert @end|ng |rom w|w|@hu-ber||n@de (Sigbert Klinke)
Date: Sun, 3 Apr 2022 20:00:31 +0200
Subject: [R] binom.test & p-value
Message-ID: <bd4b57e5-2f91-9b11-ce04-50cadc8293d8@wiwi.hu-berlin.de>

Hi,

for the specific example binom.test(x=6, n=26, p=0.1) I get as p-value 
0.03986. The default approach to decide whether I can reject the null or 
or not is to compare the p-value with the given significance level. 
Using a significance level of 0.05 this will lead to reject the null 
hypothesis.

However, computing things by hand it turned out that the critical values 
are 0 and 6. Since the test statistic is also 6 I can not reject the 
null hypothesis.

I found the discussion under 
https://stat.ethz.ch/pipermail/r-help/2009-February/380341.html and I 
understand that a p-value is not well defined if we have a asymmmetric 
(discrete) distribution under the null.

At least I would have expected some hint in the documentation for 
binom.test.

Sigbert

-- 
https://hu.berlin/sk
https://www.stat.de/faqs
https://hu.berlin/mmstat
https://hu.berlin/mmstat-int
https://hu.berlin/mmstat-ar


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sun Apr  3 20:19:15 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sun, 3 Apr 2022 19:19:15 +0100
Subject: [R] binom.test & p-value
In-Reply-To: <bd4b57e5-2f91-9b11-ce04-50cadc8293d8@wiwi.hu-berlin.de>
References: <bd4b57e5-2f91-9b11-ce04-50cadc8293d8@wiwi.hu-berlin.de>
Message-ID: <093a432a-2f04-aa6f-572f-47bc4195fd45@sapo.pt>

Hello,

Can you post your computations? Assuming a two-sided test, mine are


x <- 6
n <- 26
p <- 0.1

cmb <- sapply(x:n, \(i) choose(n, i))
sum(cmb * p^(x:n) * (1 - p)^(n - (x:n)))
#[1] 0.03985931

binom.test(x=6, n=26, p=0.1)$p.value
#[1] 0.03985931


The result are equal to one another.

?s 19:00 de 03/04/2022, Sigbert Klinke escreveu:
> Hi,
> 
> for the specific example binom.test(x=6, n=26, p=0.1) I get as p-value 
> 0.03986. The default approach to decide whether I can reject the null or 
> or not is to compare the p-value with the given significance level. 
> Using a significance level of 0.05 this will lead to reject the null 
> hypothesis.
> 
> However, computing things by hand it turned out that the critical values 
> are 0 and 6. Since the test statistic is also 6 I can not reject the 
> null hypothesis.
> 
> I found the discussion under 
> https://stat.ethz.ch/pipermail/r-help/2009-February/380341.html and I 
> understand that a p-value is not well defined if we have a asymmmetric 
> (discrete) distribution under the null.
> 
> At least I would have expected some hint in the documentation for 
> binom.test.
> 
> Sigbert
>


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sun Apr  3 20:21:15 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sun, 3 Apr 2022 19:21:15 +0100
Subject: [R] binom.test & p-value
In-Reply-To: <093a432a-2f04-aa6f-572f-47bc4195fd45@sapo.pt>
References: <bd4b57e5-2f91-9b11-ce04-50cadc8293d8@wiwi.hu-berlin.de>
 <093a432a-2f04-aa6f-572f-47bc4195fd45@sapo.pt>
Message-ID: <3ee68f28-b6e2-ec08-7306-5d8834d772bc@sapo.pt>

Sorry, forgot to sign the previous e-mail.

Rui Barradas

?s 19:19 de 03/04/2022, Rui Barradas escreveu:
> Hello,
> 
> Can you post your computations? Assuming a two-sided test, mine are
> 
> 
> x <- 6
> n <- 26
> p <- 0.1
> 
> cmb <- sapply(x:n, \(i) choose(n, i))
> sum(cmb * p^(x:n) * (1 - p)^(n - (x:n)))
> #[1] 0.03985931
> 
> binom.test(x=6, n=26, p=0.1)$p.value
> #[1] 0.03985931
> 
> 
> The result are equal to one another.
> 
> ?s 19:00 de 03/04/2022, Sigbert Klinke escreveu:
>> Hi,
>>
>> for the specific example binom.test(x=6, n=26, p=0.1) I get as p-value 
>> 0.03986. The default approach to decide whether I can reject the null 
>> or or not is to compare the p-value with the given significance level. 
>> Using a significance level of 0.05 this will lead to reject the null 
>> hypothesis.
>>
>> However, computing things by hand it turned out that the critical 
>> values are 0 and 6. Since the test statistic is also 6 I can not 
>> reject the null hypothesis.
>>
>> I found the discussion under 
>> https://stat.ethz.ch/pipermail/r-help/2009-February/380341.html and I 
>> understand that a p-value is not well defined if we have a asymmmetric 
>> (discrete) distribution under the null.
>>
>> At least I would have expected some hint in the documentation for 
>> binom.test.
>>
>> Sigbert
>>
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From drj|m|emon @end|ng |rom gm@||@com  Sun Apr  3 23:54:51 2022
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Mon, 4 Apr 2022 07:54:51 +1000
Subject: [R] Plotting proportions
In-Reply-To: <CABxY9BNwhhWgN6zBt5kPNyv69eHWGN5DRdBKTBfMGxzaFRKhUw@mail.gmail.com>
References: <CABxY9BNwhhWgN6zBt5kPNyv69eHWGN5DRdBKTBfMGxzaFRKhUw@mail.gmail.com>
Message-ID: <CA+8X3fXMGRsn46jZeSYv0C_gXD0qOdvrZAH0vFT_Qpj1mLYYrQ@mail.gmail.com>

Hi Nick,
If you can bear using R base graphics, the plotrix package has a
function named "getYmult" that allows you to adjust for the aspect
ratio of any plot area.

Jim

On Sun, Apr 3, 2022 at 11:14 PM Nick Wray <nickmwray at gmail.com> wrote:
>
> Hello  If you plot a square in the default R studio window you see a
> rectangle.  Does anyone know what the proportions of the sides of this
> rectangle are?  Thanks Nick Wray
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From w||||@mwdun|@p @end|ng |rom gm@||@com  Mon Apr  4 03:06:55 2022
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Sun, 3 Apr 2022 18:06:55 -0700
Subject: [R] Plotting proportions
In-Reply-To: <CA+8X3fXMGRsn46jZeSYv0C_gXD0qOdvrZAH0vFT_Qpj1mLYYrQ@mail.gmail.com>
References: <CABxY9BNwhhWgN6zBt5kPNyv69eHWGN5DRdBKTBfMGxzaFRKhUw@mail.gmail.com>
 <CA+8X3fXMGRsn46jZeSYv0C_gXD0qOdvrZAH0vFT_Qpj1mLYYrQ@mail.gmail.com>
Message-ID: <CAHqSRuTv5FwHWCqa2=X-YmyOKo2eyOFekbeHO7G9tO1+EzUCfw@mail.gmail.com>

plot.window() (hence the default plot()) has an 'asp' argument that sets
the ratio of the y and x scales.
E.g.,
   par(mfrow=c(3,1))
   plot( 1i ^ (0:4), type="l")
   plot( 1i ^ (0:4), type="l", asp=1)
   plot( 1i ^ (0:4), type="l", asp=0.5)

-Bill

On Sun, Apr 3, 2022 at 2:55 PM Jim Lemon <drjimlemon at gmail.com> wrote:

> Hi Nick,
> If you can bear using R base graphics, the plotrix package has a
> function named "getYmult" that allows you to adjust for the aspect
> ratio of any plot area.
>
> Jim
>
> On Sun, Apr 3, 2022 at 11:14 PM Nick Wray <nickmwray at gmail.com> wrote:
> >
> > Hello  If you plot a square in the default R studio window you see a
> > rectangle.  Does anyone know what the proportions of the sides of this
> > rectangle are?  Thanks Nick Wray
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From Lybry@@Kebre@b @end|ng |rom uc|@edu  Sun Apr  3 17:36:54 2022
From: Lybry@@Kebre@b @end|ng |rom uc|@edu (Lybrya Kebreab)
Date: Sun, 3 Apr 2022 15:36:54 +0000
Subject: [R] EFA with Complex Survey Data (Incl. Replicate Weights)
In-Reply-To: <CAOwvMDyujeDniqYq_g=CLBuH2oDwt3KiwC0vrN-t0SYmcAV4vw@mail.gmail.com>
References: <BN6PR11MB203337F8459D4CD1A0EF713E9BE19@BN6PR11MB2033.namprd11.prod.outlook.com>
 <CAOwvMDyujeDniqYq_g=CLBuH2oDwt3KiwC0vrN-t0SYmcAV4vw@mail.gmail.com>
Message-ID: <BN6PR11MB2033024E58BFDD1BD7F8C44F9BE29@BN6PR11MB2033.namprd11.prod.outlook.com>

Hello Mr. Damico,

Thank you so much! I will work with my advisor and try this. Really appreciate your help. ?

Sincerely,

Lybrya Kebreab
Doctoral Candidate
Education-Mathematics Education Track
School of Teacher Education
College of Community Innovation and Education
University of Central Florida


From: Anthony Damico <ajdamico at gmail.com>
Date: Saturday, April 2, 2022 at 4:14 PM
To: Lybrya Kebreab <Lybrya.Kebreab at ucf.edu>
Cc: r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] EFA with Complex Survey Data (Incl. Replicate Weights)
hi!  after loading the survey library, i believe you might want to create a `svrepdesign()` object that matches the SAS syntax published here?

https://nces.ed.gov/surveys/hsls09/pdf/2011328_1.pdf#page=174<https://nam02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fnces.ed.gov%2Fsurveys%2Fhsls09%2Fpdf%2F2011328_1.pdf%23page%3D174&data=04%7C01%7CLybrya.Kebreab%40ucf.edu%7C5e98bbea7fef4b603c7a08da14e56257%7Cbb932f15ef3842ba91fcf3c59d5dd1f1%7C0%7C1%7C637845272695458770%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=3lwAHPrQyr2PkOWXRiyDadxRoRLLub7hC4%2FYRG61RmQ%3D&reserved=0>

...not sure if you need combined.weights = FALSE option added to the svrepdesign() call, but it looks like your complex survey design should look roughly like this?

hsls09_design <- svrepdesign( data = data_frame_with_hsls09 , type="BRR", weights = ~w1student , repweights="w1student[0-9]+" )

from there, you could look to the examples posted on the ?svyfactanal help page and use your design=hsls09_design rather than the example dataset design=dclus1












On Fri, Apr 1, 2022 at 4:14 AM Lybrya Kebreab <Lybrya.Kebreab at ucf.edu<mailto:Lybrya.Kebreab at ucf.edu>> wrote:
Hello,


I am a doctoral student, completing my dissertation using the public HSLS2009 survey data. I am interested in running an exploratory factor analysis (EFA) and need to apply both the child weight and replicate weights. I found some information on applying weights in EFA (https://r-survey.r-forge.r-project.org/survey/html/svyfactanal.html<https://nam02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr-survey.r-forge.r-project.org%2Fsurvey%2Fhtml%2Fsvyfactanal.html&data=04%7C01%7CLybrya.Kebreab%40ucf.edu%7C5e98bbea7fef4b603c7a08da14e56257%7Cbb932f15ef3842ba91fcf3c59d5dd1f1%7C0%7C1%7C637845272695458770%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=gXuKjEGIzQDGmgeUDnnJFywgICCRGXhpeqDTLuSf0WE%3D&reserved=0>), however I have not found information on how to apply multiple replicate weights. Can anyone please help me with a resource that can assist?

Thank you kindly,

Lybrya Kebreab
Doctoral Candidate
Education-Mathematics Education Track
School of Teacher Education
College of Community Innovation and Education
University of Central Florida


        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help<https://nam02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&data=04%7C01%7CLybrya.Kebreab%40ucf.edu%7C5e98bbea7fef4b603c7a08da14e56257%7Cbb932f15ef3842ba91fcf3c59d5dd1f1%7C0%7C1%7C637845272695458770%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=XCBHuW1VvQIXx3vwFrfuncLd%2F6T8iYWxFORwHl5WKTM%3D&reserved=0>
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html<https://nam02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&data=04%7C01%7CLybrya.Kebreab%40ucf.edu%7C5e98bbea7fef4b603c7a08da14e56257%7Cbb932f15ef3842ba91fcf3c59d5dd1f1%7C0%7C1%7C637845272695458770%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=H4qg5FZ2cOS8638OwyV26UBk1UtFV9JjMd2CkccaKFM%3D&reserved=0>
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From r|ch@rd@v|ckery @end|ng |rom te|u@@net  Sun Apr  3 18:49:12 2022
From: r|ch@rd@v|ckery @end|ng |rom te|u@@net (Richard Vickery)
Date: Sun, 3 Apr 2022 11:49:12 -0500
Subject: [R] ggplot2
Message-ID: <CAMR76Uv9LAocKvKvdx6HBOYjUoxx3SM3zJT+E4_tvaF5ox9irQ@mail.gmail.com>

Hi there,

I am finally getting to some material I had problems with in university,
where I was introduced to R - one of those that because of time
constraints, I had challenges figuring out, particularly because I decided
long ago on using Fedora Linux. The book, "Understanding Statistics Using
R" by Andy Field et. al., says to install ggplot2 into R and the version of
R that the dnf command installs will neigher install this package nor
'scales'. The result I get is below, and I attempted installing the
packages via the tar command, and that neither worked, and I attempted
library("ggplot2") and R said the package was unavailable. What can I do to
move forward?

Thanks,

Richard

	[[alternative HTML version deleted]]


From m|n@h@|| @end|ng |rom um|ch@edu  Mon Apr  4 05:58:25 2022
From: m|n@h@|| @end|ng |rom um|ch@edu (Greg Minshall)
Date: Sun, 03 Apr 2022 20:58:25 -0700
Subject: [R] ggplot2
In-Reply-To: <CAMR76Uv9LAocKvKvdx6HBOYjUoxx3SM3zJT+E4_tvaF5ox9irQ@mail.gmail.com>
References: <CAMR76Uv9LAocKvKvdx6HBOYjUoxx3SM3zJT+E4_tvaF5ox9irQ@mail.gmail.com>
Message-ID: <2429094.1649044705@apollo2.minshall.org>

Richard,

> ?install.packages

probably what you want.

cheers.


From ch@nce257 @end|ng |rom comc@@t@net  Mon Apr  4 07:28:04 2022
From: ch@nce257 @end|ng |rom comc@@t@net (CHANCE CARTER)
Date: Sun, 3 Apr 2022 22:28:04 -0700 (PDT)
Subject: [R] extracting data files names with odd numbers from folder
Message-ID: <1731700406.440237.1649050084705@connect.xfinity.com>

I have a selection of data files saved as:
File1.csv
File2.csv
File3.csv
File4.csv
.
.
.
File100.csv

I need to extract the odd numbered files.
I have tried using the list.files function but I do not understand how to set pattern ="???" in order to extract the odd file names

list.files(path, pattern= "????????",... )

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Mon Apr  4 07:56:00 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sun, 03 Apr 2022 22:56:00 -0700
Subject: [R] extracting data files names with odd numbers from folder
In-Reply-To: <1731700406.440237.1649050084705@connect.xfinity.com>
References: <1731700406.440237.1649050084705@connect.xfinity.com>
Message-ID: <D74ED380-5468-4C28-B324-63E5CAD84701@dcn.davis.ca.us>

You need to learn regular expression patterns... there are lots of languages that use them, and tutorial websites that teach them to you. They are not the same as filename globbing patterns, and list.files uses regex because they are much more flexible.

Here is an example:

list.files( pattern = "[135]\\.csv$" )

On April 3, 2022 10:28:04 PM PDT, CHANCE CARTER <chance257 at comcast.net> wrote:
>I have a selection of data files saved as:
>File1.csv
>File2.csv
>File3.csv
>File4.csv
>.
>.
>.
>File100.csv
>
>I need to extract the odd numbered files.
>I have tried using the list.files function but I do not understand how to set pattern ="???" in order to extract the odd file names
>
>list.files(path, pattern= "????????",... )
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From @|gbert @end|ng |rom w|w|@hu-ber||n@de  Mon Apr  4 08:38:56 2022
From: @|gbert @end|ng |rom w|w|@hu-ber||n@de (Sigbert Klinke)
Date: Mon, 4 Apr 2022 08:38:56 +0200
Subject: [R] binom.test & p-value
In-Reply-To: <093a432a-2f04-aa6f-572f-47bc4195fd45@sapo.pt>
References: <bd4b57e5-2f91-9b11-ce04-50cadc8293d8@wiwi.hu-berlin.de>
 <093a432a-2f04-aa6f-572f-47bc4195fd45@sapo.pt>
Message-ID: <47f1f3b5-fda8-6523-0b04-959d0275e4dc@wiwi.hu-berlin.de>

Hi,

the lower critical value is zero since:

 > cbind(0:2, pbinom(0:2, 26, 0.1))

      [,1]       [,2]

[1,]    0 0.06461082

[2,]    1 0.25126430

[3,]    2 0.51050524

the upper critical value c_u=6 since:

 > cbind(5:7, pbinom((5:7), 26, 0.1))

      [,1]      [,2]

[1,]    5 0.9601407

[2,]    6 0.9881313

[3,]    7 0.9970172

with F(c_u)>=0.975 and F(c_u-1)<0.975 .

Thus,

* x=6 is in [0,6] => can not reject null
* p-value 0.03985 < 0.05 => reject null

Am 03.04.22 um 20:19 schrieb Rui Barradas:
> Hello,
> 
> Can you post your computations? Assuming a two-sided test, mine are
> 
> 
> x <- 6
> n <- 26
> p <- 0.1
> 
> cmb <- sapply(x:n, \(i) choose(n, i))
> sum(cmb * p^(x:n) * (1 - p)^(n - (x:n)))
> #[1] 0.03985931
> 
> binom.test(x=6, n=26, p=0.1)$p.value
> #[1] 0.03985931
> 
> 
> The result are equal to one another.
> 
> ?s 19:00 de 03/04/2022, Sigbert Klinke escreveu:
>> Hi,
>>
>> for the specific example binom.test(x=6, n=26, p=0.1) I get as p-value 
>> 0.03986. The default approach to decide whether I can reject the null 
>> or or not is to compare the p-value with the given significance level. 
>> Using a significance level of 0.05 this will lead to reject the null 
>> hypothesis.
>>
>> However, computing things by hand it turned out that the critical 
>> values are 0 and 6. Since the test statistic is also 6 I can not 
>> reject the null hypothesis.
>>
>> I found the discussion under 
>> https://stat.ethz.ch/pipermail/r-help/2009-February/380341.html and I 
>> understand that a p-value is not well defined if we have a asymmmetric 
>> (discrete) distribution under the null.
>>
>> At least I would have expected some hint in the documentation for 
>> binom.test.
>>
>> Sigbert
>>


-- 
https://hu.berlin/sk
https://www.stat.de/faqs
https://hu.berlin/mmstat
https://hu.berlin/mmstat-int
https://hu.berlin/mmstat-ar


From drj|m|emon @end|ng |rom gm@||@com  Mon Apr  4 10:25:54 2022
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Mon, 4 Apr 2022 18:25:54 +1000
Subject: [R] Plotting proportions
In-Reply-To: <CAHqSRuTv5FwHWCqa2=X-YmyOKo2eyOFekbeHO7G9tO1+EzUCfw@mail.gmail.com>
References: <CABxY9BNwhhWgN6zBt5kPNyv69eHWGN5DRdBKTBfMGxzaFRKhUw@mail.gmail.com>
 <CA+8X3fXMGRsn46jZeSYv0C_gXD0qOdvrZAH0vFT_Qpj1mLYYrQ@mail.gmail.com>
 <CAHqSRuTv5FwHWCqa2=X-YmyOKo2eyOFekbeHO7G9tO1+EzUCfw@mail.gmail.com>
Message-ID: <CA+8X3fVu_gT_EQe=KiEiOJ7taiu1WvRbN=ce-c6J7ZPiV_7m5w@mail.gmail.com>

Hi Bill,
getYmult allows the user to draw a circle, square, etc. regardless of
whether the distortion is due to the plot aspect ratio or different x
and y ranges. It's handy when explicitly drawing regular geometric
figures on an existing plot.

Jim

On Mon, Apr 4, 2022 at 11:07 AM Bill Dunlap <williamwdunlap at gmail.com> wrote:
>
> plot.window() (hence the default plot()) has an 'asp' argument that sets the ratio of the y and x scales.
> E.g.,
>    par(mfrow=c(3,1))
>    plot( 1i ^ (0:4), type="l")
>    plot( 1i ^ (0:4), type="l", asp=1)
>   lot( 1i ^ (0:4), type="l", asp=0.5)
>
> -Bill


From pd@|gd @end|ng |rom gm@||@com  Mon Apr  4 11:18:39 2022
From: pd@|gd @end|ng |rom gm@||@com (peter dalgaard)
Date: Mon, 4 Apr 2022 11:18:39 +0200
Subject: [R] binom.test & p-value
In-Reply-To: <47f1f3b5-fda8-6523-0b04-959d0275e4dc@wiwi.hu-berlin.de>
References: <bd4b57e5-2f91-9b11-ce04-50cadc8293d8@wiwi.hu-berlin.de>
 <093a432a-2f04-aa6f-572f-47bc4195fd45@sapo.pt>
 <47f1f3b5-fda8-6523-0b04-959d0275e4dc@wiwi.hu-berlin.de>
Message-ID: <B09F662D-92EC-4F29-8B20-95DE2F751728@gmail.com>

No, there is NO lower critical value at 0.05 level since already P(X<=0) > .05. 

The basic issue here (generic to all two-sided 1 dimensional "exact" tests) is how to compute the rejection region. 

The version used by R is to count into the total p-value all points with a lower point probability than the one observed. So for X=6, we do

 > dbinom(0:26,26,.1)
 [1] 6.461082e-02 1.866535e-01 2.592409e-01 2.304364e-01 1.472232e-01
 [6] 7.197581e-02 2.799059e-02 8.885903e-03 2.344891e-03 5.210869e-04
[11] 9.842752e-05 1.590748e-05 2.209372e-06 2.643693e-07 2.727620e-08
[16] 2.424551e-09 1.852087e-10 1.210515e-11 6.725082e-13 3.146237e-14
[21] 1.223537e-15 3.884243e-17 9.808695e-19 1.895400e-20 2.632500e-22
[26] 2.340000e-24 1.000000e-26
> dbin <- dbinom(0:26,26,.1)
> dbin[7]
[1] 0.02799059
> sum(dbin[7:27])
[1] 0.03985931
> dbin < dbin[7]
 [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
[13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
[25]  TRUE  TRUE  TRUE
> sum(dbin[dbin<=dbin[7]])
[1] 0.03985931

Notice that all points with lower dbin are to the right of X==6. For X==5 we get

> dbin < dbin[6]
 [1]  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
[13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
[25]  TRUE  TRUE  TRUE
> sum(dbin[dbin<=dbin[6]])
[1] 0.1764459

so now we do count the point mass at X==0, but the total p-value is not < .05

Similarly, we do not reject if X==0
> sum(dbin[dbin<=dbin[1]])
[1] 0.1044701

where as we obviously rejece for any X>6. So we end up with a one-sided rejection region for any alpha value < .1045.

This is not uncontroversial, some may want to construct the test as two 1-sided test at half the significance level. 
In that case, P(X>=6) > .025 and no rejection at .05 level.
 
This approach has the benefit of being consistent with confidence interval calculations, but it does not generalize to multidimensional cases like fisher.test() on a 3x2 table.

-pd

> On 4 Apr 2022, at 08:38 , Sigbert Klinke <sigbert at wiwi.hu-berlin.de> wrote:
> 
> Hi,
> 
> the lower critical value is zero since:
> 
> > cbind(0:2, pbinom(0:2, 26, 0.1))
> 
>     [,1]       [,2]
> 
> [1,]    0 0.06461082
> 
> [2,]    1 0.25126430
> 
> [3,]    2 0.51050524
> 
> the upper critical value c_u=6 since:
> 
> > cbind(5:7, pbinom((5:7), 26, 0.1))
> 
>     [,1]      [,2]
> 
> [1,]    5 0.9601407
> 
> [2,]    6 0.9881313
> 
> [3,]    7 0.9970172
> 
> with F(c_u)>=0.975 and F(c_u-1)<0.975 .
> 
> Thus,
> 
> * x=6 is in [0,6] => can not reject null
> * p-value 0.03985 < 0.05 => reject null
> 
> Am 03.04.22 um 20:19 schrieb Rui Barradas:
>> Hello,
>> Can you post your computations? Assuming a two-sided test, mine are
>> x <- 6
>> n <- 26
>> p <- 0.1
>> cmb <- sapply(x:n, \(i) choose(n, i))
>> sum(cmb * p^(x:n) * (1 - p)^(n - (x:n)))
>> #[1] 0.03985931
>> binom.test(x=6, n=26, p=0.1)$p.value
>> #[1] 0.03985931
>> The result are equal to one another.
>> ?s 19:00 de 03/04/2022, Sigbert Klinke escreveu:
>>> Hi,
>>> 
>>> for the specific example binom.test(x=6, n=26, p=0.1) I get as p-value 0.03986. The default approach to decide whether I can reject the null or or not is to compare the p-value with the given significance level. Using a significance level of 0.05 this will lead to reject the null hypothesis.
>>> 
>>> However, computing things by hand it turned out that the critical values are 0 and 6. Since the test statistic is also 6 I can not reject the null hypothesis.
>>> 
>>> I found the discussion under https://stat.ethz.ch/pipermail/r-help/2009-February/380341.html and I understand that a p-value is not well defined if we have a asymmmetric (discrete) distribution under the null.
>>> 
>>> At least I would have expected some hint in the documentation for binom.test.
>>> 
>>> Sigbert
>>> 
> 
> 
> -- 
> https://hu.berlin/sk
> https://www.stat.de/faqs
> https://hu.berlin/mmstat
> https://hu.berlin/mmstat-int
> https://hu.berlin/mmstat-ar
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From r@oknz @end|ng |rom gm@||@com  Mon Apr  4 13:39:10 2022
From: r@oknz @end|ng |rom gm@||@com (Richard O'Keefe)
Date: Mon, 4 Apr 2022 23:39:10 +1200
Subject: [R] Violin plots in R
In-Reply-To: <CAGgJW76PFX9=cmvNNuCh94eRmdEoqHPyQJnpVvBKTk0rTFZ3zg@mail.gmail.com>
References: <CAGjf1cOgGf_hnfyG5msuAFERJOc1wo3f9vTXNYHaP_JH08XBXQ@mail.gmail.com>
 <CAGgJW76PFX9=cmvNNuCh94eRmdEoqHPyQJnpVvBKTk0rTFZ3zg@mail.gmail.com>
Message-ID: <CABcYAdJ1aYKt44OBeLDs==1RieNKdnxEkdEpo0bSpU7TFo-VJw@mail.gmail.com>

Does the OP insist on using ggplot?
I've been happy with
 > install.packages("vioplot")
 > library(vioplot)
 > ?vioplot(
 > vioplot(rnorm(30))
There are several CRAN packages that can generate violin
plots.

On Fri, 1 Apr 2022 at 22:33, Eric Berger <ericjberger at gmail.com> wrote:

> 1. Your data was not attached.
> 2. You should show the code that you tried so that people can find the
> problem(s).
> 3. have you tried searching the web for examples that work? A quick search
> gave this site which looked relevant
>
>
> http://www.sthda.com/english/wiki/ggplot2-violin-plot-quick-start-guide-r-software-and-data-visualization
>
>
> On Fri, Apr 1, 2022 at 12:12 PM pooja sinha <pjsinha07 at gmail.com> wrote:
>
> > Hi All,
> >
> > I need your help in making the violin plot in R using the data which is
> > attached herewith. I am new to R and having issues in tidying my data for
> > R. I am trying the code but I am not able to tidy my data for violin plot
> > in ggplot.
> >
> > Any help will be highly appreciated.
> >
> > Thanks,
> > Puja
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From tebert @end|ng |rom u||@edu  Mon Apr  4 13:39:51 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Mon, 4 Apr 2022 11:39:51 +0000
Subject: [R] ggplot2
In-Reply-To: <CAMR76Uv9LAocKvKvdx6HBOYjUoxx3SM3zJT+E4_tvaF5ox9irQ@mail.gmail.com>
References: <CAMR76Uv9LAocKvKvdx6HBOYjUoxx3SM3zJT+E4_tvaF5ox9irQ@mail.gmail.com>
Message-ID: <BN6PR2201MB15532F4E3F8A1C52143413CBCFE59@BN6PR2201MB1553.namprd22.prod.outlook.com>

install.packages("ggplot2")
library(ggplot2)

An alternative
install.packages("tidyverse")
library(tidyverse)

The first only installs ggplot2. The alternative installs a bunch of other stuff as well.

Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Richard Vickery
Sent: Sunday, April 3, 2022 12:49 PM
To: R-help at r-project.org
Subject: [R] ggplot2

[External Email]

Hi there,

I am finally getting to some material I had problems with in university, where I was introduced to R - one of those that because of time constraints, I had challenges figuring out, particularly because I decided long ago on using Fedora Linux. The book, "Understanding Statistics Using R" by Andy Field et. al., says to install ggplot2 into R and the version of R that the dnf command installs will neigher install this package nor 'scales'. The result I get is below, and I attempted installing the packages via the tar command, and that neither worked, and I attempted
library("ggplot2") and R said the package was unavailable. What can I do to move forward?

Thanks,

Richard

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=7xEzNpsPEMvdQLIcBNo-VFJErGQIZfwF2ueg-0lesWT4DSOwIMyZ5deX1XUeO2R2&s=QTw5eQQCMPK5qxhL7YKJYRMJWwmPSDI4bR9Px8VJrvA&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=7xEzNpsPEMvdQLIcBNo-VFJErGQIZfwF2ueg-0lesWT4DSOwIMyZ5deX1XUeO2R2&s=0kmwSZfq16L-GtPuQa5mSO8VGqauae08iBxm57dPnKI&e=
and provide commented, minimal, self-contained, reproducible code.


From m|m@|tr@ @end|ng |rom gmx@com  Mon Apr  4 15:44:05 2022
From: m|m@|tr@ @end|ng |rom gmx@com (Ranjan Maitra)
Date: Mon, 4 Apr 2022 08:44:05 -0500
Subject: [R] Plotting proportions
In-Reply-To: <CA+8X3fXMGRsn46jZeSYv0C_gXD0qOdvrZAH0vFT_Qpj1mLYYrQ@mail.gmail.com>
References: <CABxY9BNwhhWgN6zBt5kPNyv69eHWGN5DRdBKTBfMGxzaFRKhUw@mail.gmail.com>
 <CA+8X3fXMGRsn46jZeSYv0C_gXD0qOdvrZAH0vFT_Qpj1mLYYrQ@mail.gmail.com>
Message-ID: <Ykr2JR8rhoW92cUg@iastate.edu>

Hi,

Beyond the clear COI, allow me to suggest RadViz3D for fully three-dimensional radial visualization, which as pointed out by a reviewer, is ideal for proportions data.

The paper is here:

Fully Three-Dimensional Radial Visualization by Yifan Zhu, Fan Dai, and
Ranjan Maitra Journal of Computational and Graphical Statistics. 2022,
https://doi.org/10.1080/10618600.2021.2020129

The R package is on github: https://github.com/fanne-stat/radviz3d

Best wishes,
Ranjan



On Mon Apr04'22 07:54:51AM, Jim Lemon wrote:
> From: Jim Lemon <drjimlemon at gmail.com>
> Date: Mon, 4 Apr 2022 07:54:51 +1000
> To: Nick Wray <nickmwray at gmail.com>, r-help mailing list
>  <r-help at r-project.org>
> Subject: Re: [R] Plotting proportions
>
> Hi Nick,
> If you can bear using R base graphics, the plotrix package has a
> function named "getYmult" that allows you to adjust for the aspect
> ratio of any plot area.
>
> Jim
>
> On Sun, Apr 3, 2022 at 11:14 PM Nick Wray <nickmwray at gmail.com> wrote:
> >
> > Hello  If you plot a square in the default R studio window you see a
> > rectangle.  Does anyone know what the proportions of the sides of this
> > rectangle are?  Thanks Nick Wray
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From c@deb @end|ng |rom u@g@@gov  Mon Apr  4 21:55:15 2022
From: c@deb @end|ng |rom u@g@@gov (Cade, Brian S)
Date: Mon, 4 Apr 2022 19:55:15 +0000
Subject: [R] complicated time series filtering issue
Message-ID: <SA1PR09MB753614942CE63B4AE4E8081FD9E59@SA1PR09MB7536.namprd09.prod.outlook.com>

Hello:  I have an issue with filtering in a time series of animal growth data that seems conceptually simple but I have not come up with effective code to implement this.  I have temporal sequences of lengths by individuals and I want to retain only those data that are >10 days apart sequentially within an individuals records.  I can readily compute intervals between successive dates by individual using data.table() and its by = INDIVIDUAL functionality.  See example data for one individual below.  But what currently eludes me in processing this is how to recognize for example that deleting the 2nd and 3rd rows is required because the totality of their time interval is 9 days, deleting 8th record with 4 days is required,  deleting 17th record with 1 day is required, deleting 22nd and 23rd records is required because their sum is 2 days, but we do not delete 24th record of 10 days because the sum of previous 2 records deleted and this one is now 12 days.  Each individual can have very different patterns of these sort of sequences.  These sequences are easy to look at and determine what needs to be done but writing effective code to accomplish this filtering seems to require some functionality that I am currently missing.

Any suggestions would be greatly appreciated.

         Date   INDIVIDUAL DATENUMBER LENGTH length.prev interval
228 12-May-04 57084544        133         682.4           NA       NA
229 28-Sep-04 57084544        272         724.8        682.4      139
230 30-Sep-04 57084544        274         740.8        724.8        2
231  7-Oct-04 57084544        281         745.4        740.8        7
232 22-Nov-04 57084544        327         780.2        745.4       46
233 27-Jan-05 57084544        393         817.2        780.2       66
234  8-Mar-05 57084544        433         834.1        817.2       40
235  2-Jul-05 57084544        549         876.3        834.1      116
236  6-Jul-05 57084544        553         871.5        876.3        4
237  4-Aug-05 57084544        582         887.5        871.5       29
238 28-Dec-05 57084544        728         921.8        887.5      146
239 31-Jan-06 57084544        762         936.8        921.8       34
240 27-Feb-06 57084544        789         962.4        936.8       27
241 21-Nov-06 57084544       1056         972.3        962.4      267
242 30-Mar-07 57084544       1185        1007.2        972.3      129
243 23-Apr-07 57084544       1209        1009.1       1007.2       24
244 22-May-07 57084544       1238         991.6       1009.1       29
245 23-May-07 57084544       1239        1015.9        991.6        1
246 16-Jul-07 57084544       1293        1006.5       1015.9       54
247  9-Aug-07 57084544       1317        1013.0       1006.5       24
248 27-Aug-07 57084544       1335        1013.0       1013.0       18
249 29-Jul-08 57084544       1672        1021.5       1013.0      337
250 30-Jul-08 57084544       1673         984.3       1021.5        1
251 31-Jul-08 57084544       1674        1008.5        984.3        1
252 10-Aug-08 57084544       1684        1002.8       1008.5       10
253 22-Oct-08 57084544       1757         977.6       1002.8       73
254  2-Dec-08 57084544       1798        1000.6        977.6       41



Brian



Brian S. Cade, PhD

U. S. Geological Survey
Fort Collins Science Center
2150 Centre Ave., Bldg. C
Fort Collins, CO  80526-8818

email:  cadeb at usgs.gov<mailto:brian_cade at usgs.gov>
tel:  970 226-9326


	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Mon Apr  4 23:04:27 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 4 Apr 2022 14:04:27 -0700
Subject: [R] complicated time series filtering issue
In-Reply-To: <SA1PR09MB753614942CE63B4AE4E8081FD9E59@SA1PR09MB7536.namprd09.prod.outlook.com>
References: <SA1PR09MB753614942CE63B4AE4E8081FD9E59@SA1PR09MB7536.namprd09.prod.outlook.com>
Message-ID: <CAGxFJbSSw-EuZWAaV0k1Jor-PBazXkvV4xkbr8MJjUouE7=6yQ@mail.gmail.com>

Like this?

winnow <- function(x, int=5){
   keep <- x[1]
   remaining <- x[-1]
   while (length(remaining))
   {
      nxt <- tail(keep,1) + int
      if(length(remaining) ==1 ||
         all(remaining < nxt))break
      remaining <- remaining[remaining >tail(keep,1) + int]
      keep <- c(keep,remaining[1])
   }
   keep
}

> x
 [1]  1  2  5  7  8  9 15 16 17 19 20 21 28 35 37 41 43 45 46 50
> winnow(x,7)
[1]  1  9 17 28 37 45
> winnow(x,5)
[1]  1  7 15 21 28 35 41 50

Cheers,
Bert

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Mon, Apr 4, 2022 at 12:56 PM Cade, Brian S via R-help
<r-help at r-project.org> wrote:
>
> Hello:  I have an issue with filtering in a time series of animal growth data that seems conceptually simple but I have not come up with effective code to implement this.  I have temporal sequences of lengths by individuals and I want to retain only those data that are >10 days apart sequentially within an individuals records.  I can readily compute intervals between successive dates by individual using data.table() and its by = INDIVIDUAL functionality.  See example data for one individual below.  But what currently eludes me in processing this is how to recognize for example that deleting the 2nd and 3rd rows is required because the totality of their time interval is 9 days, deleting 8th record with 4 days is required,  deleting 17th record with 1 day is required, deleting 22nd and 23rd records is required because their sum is 2 days, but we do not delete 24th record of 10 days because the sum of previous 2 records deleted and this one is now 12 days.  Each individual can have very
>   different patterns of these sort of sequences.  These sequences are easy to look at and determine what needs to be done but writing effective code to accomplish this filtering seems to require some functionality that I am currently missing.
>
> Any suggestions would be greatly appreciated.
>
>          Date   INDIVIDUAL DATENUMBER LENGTH length.prev interval
> 228 12-May-04 57084544        133         682.4           NA       NA
> 229 28-Sep-04 57084544        272         724.8        682.4      139
> 230 30-Sep-04 57084544        274         740.8        724.8        2
> 231  7-Oct-04 57084544        281         745.4        740.8        7
> 232 22-Nov-04 57084544        327         780.2        745.4       46
> 233 27-Jan-05 57084544        393         817.2        780.2       66
> 234  8-Mar-05 57084544        433         834.1        817.2       40
> 235  2-Jul-05 57084544        549         876.3        834.1      116
> 236  6-Jul-05 57084544        553         871.5        876.3        4
> 237  4-Aug-05 57084544        582         887.5        871.5       29
> 238 28-Dec-05 57084544        728         921.8        887.5      146
> 239 31-Jan-06 57084544        762         936.8        921.8       34
> 240 27-Feb-06 57084544        789         962.4        936.8       27
> 241 21-Nov-06 57084544       1056         972.3        962.4      267
> 242 30-Mar-07 57084544       1185        1007.2        972.3      129
> 243 23-Apr-07 57084544       1209        1009.1       1007.2       24
> 244 22-May-07 57084544       1238         991.6       1009.1       29
> 245 23-May-07 57084544       1239        1015.9        991.6        1
> 246 16-Jul-07 57084544       1293        1006.5       1015.9       54
> 247  9-Aug-07 57084544       1317        1013.0       1006.5       24
> 248 27-Aug-07 57084544       1335        1013.0       1013.0       18
> 249 29-Jul-08 57084544       1672        1021.5       1013.0      337
> 250 30-Jul-08 57084544       1673         984.3       1021.5        1
> 251 31-Jul-08 57084544       1674        1008.5        984.3        1
> 252 10-Aug-08 57084544       1684        1002.8       1008.5       10
> 253 22-Oct-08 57084544       1757         977.6       1002.8       73
> 254  2-Dec-08 57084544       1798        1000.6        977.6       41
>
>
>
> Brian
>
>
>
> Brian S. Cade, PhD
>
> U. S. Geological Survey
> Fort Collins Science Center
> 2150 Centre Ave., Bldg. C
> Fort Collins, CO  80526-8818
>
> email:  cadeb at usgs.gov<mailto:brian_cade at usgs.gov>
> tel:  970 226-9326
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From tebert @end|ng |rom u||@edu  Mon Apr  4 23:30:42 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Mon, 4 Apr 2022 21:30:42 +0000
Subject: [R] complicated time series filtering issue
In-Reply-To: <CAGxFJbSSw-EuZWAaV0k1Jor-PBazXkvV4xkbr8MJjUouE7=6yQ@mail.gmail.com>
References: <SA1PR09MB753614942CE63B4AE4E8081FD9E59@SA1PR09MB7536.namprd09.prod.outlook.com>
 <CAGxFJbSSw-EuZWAaV0k1Jor-PBazXkvV4xkbr8MJjUouE7=6yQ@mail.gmail.com>
Message-ID: <BN6PR2201MB15530C88E480EF8AF047E0A5CFE59@BN6PR2201MB1553.namprd22.prod.outlook.com>

I think the idea is more 
for (i in 2:nrow(x)){
ifelse(x[i]-x[i-1] >10) {keep x[i], delete x[i]]
}

I am not quite clear on the correct code for "keep" or "delete."

One could try 
for (i in 2:nrow(x)){
x$new[i] <- x[i]-x[i-1]
}
x <- x %>% filter(new>=10)

This only works if consecutive sample dates are 10 or more days apart. You could add an else if that would accumulate days, and if successful reset the clock.

Tim
-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Bert Gunter
Sent: Monday, April 4, 2022 5:04 PM
To: Cade, Brian S <cadeb at usgs.gov>
Cc: r-help at r-project.org
Subject: Re: [R] complicated time series filtering issue

[External Email]

Like this?

winnow <- function(x, int=5){
   keep <- x[1]
   remaining <- x[-1]
   while (length(remaining))
   {
      nxt <- tail(keep,1) + int
      if(length(remaining) ==1 ||
         all(remaining < nxt))break
      remaining <- remaining[remaining >tail(keep,1) + int]
      keep <- c(keep,remaining[1])
   }
   keep
}

> x
 [1]  1  2  5  7  8  9 15 16 17 19 20 21 28 35 37 41 43 45 46 50
> winnow(x,7)
[1]  1  9 17 28 37 45
> winnow(x,5)
[1]  1  7 15 21 28 35 41 50

Cheers,
Bert

"The trouble with having an open mind is that people keep coming along and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Mon, Apr 4, 2022 at 12:56 PM Cade, Brian S via R-help <r-help at r-project.org> wrote:
>
> Hello:  I have an issue with filtering in a time series of animal 
> growth data that seems conceptually simple but I have not come up with 
> effective code to implement this.  I have temporal sequences of 
> lengths by individuals and I want to retain only those data that are 
> >10 days apart sequentially within an individuals records.  I can 
> readily compute intervals between successive dates by individual using 
> data.table() and its by = INDIVIDUAL functionality.  See example data 
> for one individual below.  But what currently eludes me in processing 
> this is how to recognize for example that deleting the 2nd and 3rd 
> rows is required because the totality of their time interval is 9 
> days, deleting 8th record with 4 days is required,  deleting 17th 
> record with 1 day is required, deleting 22nd and 23rd records is 
> required because their sum is 2 days, but we do not delete 24th record 
> of 10 days because the sum of previous 2 records deleted and this one 
> is now 12 days.  Each individual can have ve
 ry
>   different patterns of these sort of sequences.  These sequences are easy to look at and determine what needs to be done but writing effective code to accomplish this filtering seems to require some functionality that I am currently missing.
>
> Any suggestions would be greatly appreciated.
>
>          Date   INDIVIDUAL DATENUMBER LENGTH length.prev interval
> 228 12-May-04 57084544        133         682.4           NA       NA
> 229 28-Sep-04 57084544        272         724.8        682.4      139
> 230 30-Sep-04 57084544        274         740.8        724.8        2
> 231  7-Oct-04 57084544        281         745.4        740.8        7
> 232 22-Nov-04 57084544        327         780.2        745.4       46
> 233 27-Jan-05 57084544        393         817.2        780.2       66
> 234  8-Mar-05 57084544        433         834.1        817.2       40
> 235  2-Jul-05 57084544        549         876.3        834.1      116
> 236  6-Jul-05 57084544        553         871.5        876.3        4
> 237  4-Aug-05 57084544        582         887.5        871.5       29
> 238 28-Dec-05 57084544        728         921.8        887.5      146
> 239 31-Jan-06 57084544        762         936.8        921.8       34
> 240 27-Feb-06 57084544        789         962.4        936.8       27
> 241 21-Nov-06 57084544       1056         972.3        962.4      267
> 242 30-Mar-07 57084544       1185        1007.2        972.3      129
> 243 23-Apr-07 57084544       1209        1009.1       1007.2       24
> 244 22-May-07 57084544       1238         991.6       1009.1       29
> 245 23-May-07 57084544       1239        1015.9        991.6        1
> 246 16-Jul-07 57084544       1293        1006.5       1015.9       54
> 247  9-Aug-07 57084544       1317        1013.0       1006.5       24
> 248 27-Aug-07 57084544       1335        1013.0       1013.0       18
> 249 29-Jul-08 57084544       1672        1021.5       1013.0      337
> 250 30-Jul-08 57084544       1673         984.3       1021.5        1
> 251 31-Jul-08 57084544       1674        1008.5        984.3        1
> 252 10-Aug-08 57084544       1684        1002.8       1008.5       10
> 253 22-Oct-08 57084544       1757         977.6       1002.8       73
> 254  2-Dec-08 57084544       1798        1000.6        977.6       41
>
>
>
> Brian
>
>
>
> Brian S. Cade, PhD
>
> U. S. Geological Survey
> Fort Collins Science Center
> 2150 Centre Ave., Bldg. C
> Fort Collins, CO  80526-8818
>
> email:  cadeb at usgs.gov<mailto:brian_cade at usgs.gov>
> tel:  970 226-9326
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
> man_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAs
> Rzsn7AkP-g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu
> -vCEJab&s=PG1chCZY6eQzSdtSlvChVVVt0HXVDG1bgBkJMQ8wk1A&e=
> PLEASE do read the posting guide 
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.or
> g_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeA
> sRzsn7AkP-g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxg
> u-vCEJab&s=D_bzOVjWanUgYD_zJq-IS8EObMKBmC5Q5D-a_IHxMAA&e=
> and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu-vCEJab&s=PG1chCZY6eQzSdtSlvChVVVt0HXVDG1bgBkJMQ8wk1A&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu-vCEJab&s=D_bzOVjWanUgYD_zJq-IS8EObMKBmC5Q5D-a_IHxMAA&e=
and provide commented, minimal, self-contained, reproducible code.


From drj|m|emon @end|ng |rom gm@||@com  Tue Apr  5 00:15:22 2022
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Tue, 5 Apr 2022 08:15:22 +1000
Subject: [R] complicated time series filtering issue
In-Reply-To: <BN6PR2201MB15530C88E480EF8AF047E0A5CFE59@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <SA1PR09MB753614942CE63B4AE4E8081FD9E59@SA1PR09MB7536.namprd09.prod.outlook.com>
 <CAGxFJbSSw-EuZWAaV0k1Jor-PBazXkvV4xkbr8MJjUouE7=6yQ@mail.gmail.com>
 <BN6PR2201MB15530C88E480EF8AF047E0A5CFE59@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <CA+8X3fU5gbKcMfsTPOA8AG8V_iD9-JSPMsWxFqntp+3CakdYtQ@mail.gmail.com>

Hi Brian,
Perhaps this:

bc.df<-read.table(text="Date   INDIVIDUAL DATENUMBER LENGTH length.prev interval
12-May-04 57084544        133         682.4           NA       NA
28-Sep-04 57084544        272         724.8        682.4      139
30-Sep-04 57084544        274         740.8        724.8        2
7-Oct-04 57084544        281         745.4        740.8        7
22-Nov-04 57084544        327         780.2        745.4       46
27-Jan-05 57084544        393         817.2        780.2       66
8-Mar-05 57084544        433         834.1        817.2       40
2-Jul-05 57084544        549         876.3        834.1      116
6-Jul-05 57084544        553         871.5        876.3        4
4-Aug-05 57084544        582         887.5        871.5       29
28-Dec-05 57084544        728         921.8        887.5      146
31-Jan-06 57084544        762         936.8        921.8       34
27-Feb-06 57084544        789         962.4        936.8       27
21-Nov-06 57084544       1056         972.3        962.4      267
30-Mar-07 57084544       1185        1007.2        972.3      129
23-Apr-07 57084544       1209        1009.1       1007.2       24
22-May-07 57084544       1238         991.6       1009.1       29
23-May-07 57084544       1239        1015.9        991.6        1
16-Jul-07 57084544       1293        1006.5       1015.9       54
9-Aug-07 57084544       1317        1013.0       1006.5       24
27-Aug-07 57084544       1335        1013.0       1013.0       18
29-Jul-08 57084544       1672        1021.5       1013.0      337
30-Jul-08 57084544       1673         984.3       1021.5        1
31-Jul-08 57084544       1674        1008.5        984.3        1
10-Aug-08 57084544       1684        1002.8       1008.5       10
22-Oct-08 57084544       1757         977.6       1002.8       73
2-Dec-08 57084544       1798        1000.6        977.6       41",
stringsAsFactors=FALSE,header=TRUE)
min_interval<-function(x,minint=10) {
 indx<-1
 cumint<-0
 for(i in 2:length(x)) {
  cumint<-cumint+x[i]
  if(cumint > minint) {
   indx<-c(indx,i)
   cumint<-0
  }
 }
 return(indx)
}
min_interval(bc.df$interval)

Jim

On Tue, Apr 5, 2022 at 7:31 AM Ebert,Timothy Aaron <tebert at ufl.edu> wrote:
>
> I think the idea is more
> for (i in 2:nrow(x)){
> ifelse(x[i]-x[i-1] >10) {keep x[i], delete x[i]]
> }
>
> I am not quite clear on the correct code for "keep" or "delete."
>
> One could try
> for (i in 2:nrow(x)){
> x$new[i] <- x[i]-x[i-1]
> }
> x <- x %>% filter(new>=10)
>
> This only works if consecutive sample dates are 10 or more days apart. You could add an else if that would accumulate days, and if successful reset the clock.
>
> Tim
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Bert Gunter
> Sent: Monday, April 4, 2022 5:04 PM
> To: Cade, Brian S <cadeb at usgs.gov>
> Cc: r-help at r-project.org
> Subject: Re: [R] complicated time series filtering issue
>
> [External Email]
>
> Like this?
>
> winnow <- function(x, int=5){
>    keep <- x[1]
>    remaining <- x[-1]
>    while (length(remaining))
>    {
>       nxt <- tail(keep,1) + int
>       if(length(remaining) ==1 ||
>          all(remaining < nxt))break
>       remaining <- remaining[remaining >tail(keep,1) + int]
>       keep <- c(keep,remaining[1])
>    }
>    keep
> }
>
> > x
>  [1]  1  2  5  7  8  9 15 16 17 19 20 21 28 35 37 41 43 45 46 50
> > winnow(x,7)
> [1]  1  9 17 28 37 45
> > winnow(x,5)
> [1]  1  7 15 21 28 35 41 50
>
> Cheers,
> Bert
>
> "The trouble with having an open mind is that people keep coming along and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> On Mon, Apr 4, 2022 at 12:56 PM Cade, Brian S via R-help <r-help at r-project.org> wrote:
> >
> > Hello:  I have an issue with filtering in a time series of animal
> > growth data that seems conceptually simple but I have not come up with
> > effective code to implement this.  I have temporal sequences of
> > lengths by individuals and I want to retain only those data that are
> > >10 days apart sequentially within an individuals records.  I can
> > readily compute intervals between successive dates by individual using
> > data.table() and its by = INDIVIDUAL functionality.  See example data
> > for one individual below.  But what currently eludes me in processing
> > this is how to recognize for example that deleting the 2nd and 3rd
> > rows is required because the totality of their time interval is 9
> > days, deleting 8th record with 4 days is required,  deleting 17th
> > record with 1 day is required, deleting 22nd and 23rd records is
> > required because their sum is 2 days, but we do not delete 24th record
> > of 10 days because the sum of previous 2 records deleted and this one
> > is now 12 days.  Each individual can have ve
>  ry
> >   different patterns of these sort of sequences.  These sequences are easy to look at and determine what needs to be done but writing effective code to accomplish this filtering seems to require some functionality that I am currently missing.
> >
> > Any suggestions would be greatly appreciated.
> >
> >          Date   INDIVIDUAL DATENUMBER LENGTH length.prev interval
> > 228 12-May-04 57084544        133         682.4           NA       NA
> > 229 28-Sep-04 57084544        272         724.8        682.4      139
> > 230 30-Sep-04 57084544        274         740.8        724.8        2
> > 231  7-Oct-04 57084544        281         745.4        740.8        7
> > 232 22-Nov-04 57084544        327         780.2        745.4       46
> > 233 27-Jan-05 57084544        393         817.2        780.2       66
> > 234  8-Mar-05 57084544        433         834.1        817.2       40
> > 235  2-Jul-05 57084544        549         876.3        834.1      116
> > 236  6-Jul-05 57084544        553         871.5        876.3        4
> > 237  4-Aug-05 57084544        582         887.5        871.5       29
> > 238 28-Dec-05 57084544        728         921.8        887.5      146
> > 239 31-Jan-06 57084544        762         936.8        921.8       34
> > 240 27-Feb-06 57084544        789         962.4        936.8       27
> > 241 21-Nov-06 57084544       1056         972.3        962.4      267
> > 242 30-Mar-07 57084544       1185        1007.2        972.3      129
> > 243 23-Apr-07 57084544       1209        1009.1       1007.2       24
> > 244 22-May-07 57084544       1238         991.6       1009.1       29
> > 245 23-May-07 57084544       1239        1015.9        991.6        1
> > 246 16-Jul-07 57084544       1293        1006.5       1015.9       54
> > 247  9-Aug-07 57084544       1317        1013.0       1006.5       24
> > 248 27-Aug-07 57084544       1335        1013.0       1013.0       18
> > 249 29-Jul-08 57084544       1672        1021.5       1013.0      337
> > 250 30-Jul-08 57084544       1673         984.3       1021.5        1
> > 251 31-Jul-08 57084544       1674        1008.5        984.3        1
> > 252 10-Aug-08 57084544       1684        1002.8       1008.5       10
> > 253 22-Oct-08 57084544       1757         977.6       1002.8       73
> > 254  2-Dec-08 57084544       1798        1000.6        977.6       41
> >
> >
> >
> > Brian
> >
> >
> >
> > Brian S. Cade, PhD
> >
> > U. S. Geological Survey
> > Fort Collins Science Center
> > 2150 Centre Ave., Bldg. C
> > Fort Collins, CO  80526-8818
> >
> > email:  cadeb at usgs.gov<mailto:brian_cade at usgs.gov>
> > tel:  970 226-9326
> >
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
> > man_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAs
> > Rzsn7AkP-g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu
> > -vCEJab&s=PG1chCZY6eQzSdtSlvChVVVt0HXVDG1bgBkJMQ8wk1A&e=
> > PLEASE do read the posting guide
> > https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.or
> > g_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeA
> > sRzsn7AkP-g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxg
> > u-vCEJab&s=D_bzOVjWanUgYD_zJq-IS8EObMKBmC5Q5D-a_IHxMAA&e=
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu-vCEJab&s=PG1chCZY6eQzSdtSlvChVVVt0HXVDG1bgBkJMQ8wk1A&e=
> PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu-vCEJab&s=D_bzOVjWanUgYD_zJq-IS8EObMKBmC5Q5D-a_IHxMAA&e=
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m|n@h@|| @end|ng |rom um|ch@edu  Tue Apr  5 00:53:55 2022
From: m|n@h@|| @end|ng |rom um|ch@edu (Greg Minshall)
Date: Mon, 04 Apr 2022 15:53:55 -0700
Subject: [R] ggplot2
In-Reply-To: <20220404143700.5206098.38302.11579@telus.net>
References: <CAMR76Uv9LAocKvKvdx6HBOYjUoxx3SM3zJT+E4_tvaF5ox9irQ@mail.gmail.com>
 <2429094.1649044705@apollo2.minshall.org>
 <20220404143700.5206098.38302.11579@telus.net>
Message-ID: <2593283.1649112835@apollo2.minshall.org>

Richard,

> That command downloaded ggplot2_3.3.5.tar.gz and scales.1.1.1.tar.gz
> on my hard-drive and left warning messages:
> 
> installation of package(s) "scales' (and) 'ggplot2' had non-zero exit
> status;

i would guess, that's where you need to investigate, figure out why the
install didn't work.  one *possible* reason is that R is trying to
install the libraries to the system-wide library directory, and you
don't have permission to install there.  but, there are a multitude of
other possible failures.

you might start by this: are you able to install other packages?  if
not, you should look in one direction; if so, in another.

> I attempted tarring the files inside R and that appeared to fix the
> issue...

sadly, i don't know what that means.

good luck with the debugging!

cheers, Greg


From dw|n@em|u@ @end|ng |rom comc@@t@net  Tue Apr  5 01:23:04 2022
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Mon, 4 Apr 2022 16:23:04 -0700
Subject: [R] ggplot2
In-Reply-To: <BN6PR2201MB15532F4E3F8A1C52143413CBCFE59@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <CAMR76Uv9LAocKvKvdx6HBOYjUoxx3SM3zJT+E4_tvaF5ox9irQ@mail.gmail.com>
 <BN6PR2201MB15532F4E3F8A1C52143413CBCFE59@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <4ca49dd2-25fb-d6f5-b34e-623715cbdb36@comcast.net>


On 4/4/22 04:39, Ebert,Timothy Aaron wrote:
> install.packages("ggplot2")


Depending on your OS, there might be a better chance of success with


install.packages("ggplot2", dependencies=TRUE)

The Linux install process doesn't need this but the binary install on MacOS or Windows may need this to prevent the sort of error message that was offered.

-- 
David

> library(ggplot2)
>
> An alternative
> install.packages("tidyverse")
> library(tidyverse)
>
> The first only installs ggplot2. The alternative installs a bunch of other stuff as well.
>
> Tim
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Richard Vickery
> Sent: Sunday, April 3, 2022 12:49 PM
> To: R-help at r-project.org
> Subject: [R] ggplot2
>
> [External Email]
>
> Hi there,
>
> I am finally getting to some material I had problems with in university, where I was introduced to R - one of those that because of time constraints, I had challenges figuring out, particularly because I decided long ago on using Fedora Linux. The book, "Understanding Statistics Using R" by Andy Field et. al., says to install ggplot2 into R and the version of R that the dnf command installs will neigher install this package nor 'scales'. The result I get is below, and I attempted installing the packages via the tar command, and that neither worked, and I attempted
> library("ggplot2") and R said the package was unavailable. What can I do to move forward?
>
> Thanks,
>
> Richard
>
>          [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=7xEzNpsPEMvdQLIcBNo-VFJErGQIZfwF2ueg-0lesWT4DSOwIMyZ5deX1XUeO2R2&s=QTw5eQQCMPK5qxhL7YKJYRMJWwmPSDI4bR9Px8VJrvA&e=
> PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=7xEzNpsPEMvdQLIcBNo-VFJErGQIZfwF2ueg-0lesWT4DSOwIMyZ5deX1XUeO2R2&s=0kmwSZfq16L-GtPuQa5mSO8VGqauae08iBxm57dPnKI&e=
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From r|ch@rd@v|ckery @end|ng |rom te|u@@net  Mon Apr  4 16:37:00 2022
From: r|ch@rd@v|ckery @end|ng |rom te|u@@net (Richard Vickery)
Date: Mon, 04 Apr 2022 07:37:00 -0700
Subject: [R] ggplot2
In-Reply-To: <2429094.1649044705@apollo2.minshall.org>
References: <CAMR76Uv9LAocKvKvdx6HBOYjUoxx3SM3zJT+E4_tvaF5ox9irQ@mail.gmail.com>
 <2429094.1649044705@apollo2.minshall.org>
Message-ID: <20220404143700.5206098.38302.11579@telus.net>

Hi Greg,

That command downloaded ggplot2_3.3.5.tar.gz and scales.1.1.1.tar.gz on my hard-drive and left warning messages:

installation of package(s) "scales' (and) 'ggplot2' had non-zero exit status;

I attempted tarring the files inside R and that appeared to fix the issue but entering the command library("ggplit2") R told me the package didn?t exist.

Thanks for the help,?

Richard?
?
Sent?from?my?BlackBerry?10?smartphone?on?the?Bell?network.
? Original Message ?
From: Greg Minshall
Sent: Sunday, April 3, 2022 20:58
To: Richard Vickery
Cc: R-help at r-project.org
Subject: Re: [R] ggplot2

Richard,

> ?install.packages

probably what you want.

cheers.


From r|ch@rd@v|ckery @end|ng |rom te|u@@net  Tue Apr  5 01:58:31 2022
From: r|ch@rd@v|ckery @end|ng |rom te|u@@net (Richard Vickery)
Date: Mon, 4 Apr 2022 18:58:31 -0500
Subject: [R] ggplot2
In-Reply-To: <4ca49dd2-25fb-d6f5-b34e-623715cbdb36@comcast.net>
References: <CAMR76Uv9LAocKvKvdx6HBOYjUoxx3SM3zJT+E4_tvaF5ox9irQ@mail.gmail.com>
 <BN6PR2201MB15532F4E3F8A1C52143413CBCFE59@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <4ca49dd2-25fb-d6f5-b34e-623715cbdb36@comcast.net>
Message-ID: <CAMR76UuMUz3iBztjE_03JXk3aCCc2JjN0P6wa-1=VFAVOv+rUA@mail.gmail.com>

I use Fedora Linux. After completing

install.packages("ggplot2", dependencies=TRUE)

I get these warnings, and the package did not install:

Warning messages:
1: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?curl? had non-zero exit status
2: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?openssl? had non-zero exit status
3: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?jpeg? had non-zero exit status
4: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?RcppEigen? had non-zero exit status
5: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?units? had non-zero exit status
6: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?diffobj? had non-zero exit status
7: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?httr? had non-zero exit status
8: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?latticeExtra? had non-zero exit status
9: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?s2? had non-zero exit status
10: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?interp? had non-zero exit status
11: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?rgeos? had non-zero exit status
12: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?textshaping? had non-zero exit status
13: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?covr? had non-zero exit status
14: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?pillar? had non-zero exit status
15: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?ragg? had non-zero exit status
16: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?sf? had non-zero exit status
17: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?tibble? had non-zero exit status
18: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?rematch2? had non-zero exit status
19: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?dplyr? had non-zero exit status
20: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?ggplot2? had non-zero exit status
21: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?viridis? had non-zero exit status
22: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?waldo? had non-zero exit status
23: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?Hmisc? had non-zero exit status
24: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?testthat? had non-zero exit status
25: In install.packages("ggplot2", dependencies = TRUE) :
  installation of package ?vdiffr? had non-zero exit status
> .packages("ggplot2", dependencies=TRUE)

On Mon, Apr 4, 2022 at 6:23 PM David Winsemius <dwinsemius at comcast.net>
wrote:

>
> On 4/4/22 04:39, Ebert,Timothy Aaron wrote:
> > install.packages("ggplot2")
>
>
> Depending on your OS, there might be a better chance of success with
>
>
> install.packages("ggplot2", dependencies=TRUE)
>
> The Linux install process doesn't need this but the binary install on
> MacOS or Windows may need this to prevent the sort of error message that
> was offered.
>
> --
> David
>
> > library(ggplot2)
> >
> > An alternative
> > install.packages("tidyverse")
> > library(tidyverse)
> >
> > The first only installs ggplot2. The alternative installs a bunch of
> other stuff as well.
> >
> > Tim
> >
> > -----Original Message-----
> > From: R-help <r-help-bounces at r-project.org> On Behalf Of Richard Vickery
> > Sent: Sunday, April 3, 2022 12:49 PM
> > To: R-help at r-project.org
> > Subject: [R] ggplot2
> >
> > [External Email]
> >
> > Hi there,
> >
> > I am finally getting to some material I had problems with in university,
> where I was introduced to R - one of those that because of time
> constraints, I had challenges figuring out, particularly because I decided
> long ago on using Fedora Linux. The book, "Understanding Statistics Using
> R" by Andy Field et. al., says to install ggplot2 into R and the version of
> R that the dnf command installs will neigher install this package nor
> 'scales'. The result I get is below, and I attempted installing the
> packages via the tar command, and that neither worked, and I attempted
> > library("ggplot2") and R said the package was unavailable. What can I do
> to move forward?
> >
> > Thanks,
> >
> > Richard
> >
> >          [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=7xEzNpsPEMvdQLIcBNo-VFJErGQIZfwF2ueg-0lesWT4DSOwIMyZ5deX1XUeO2R2&s=QTw5eQQCMPK5qxhL7YKJYRMJWwmPSDI4bR9Px8VJrvA&e=
> > PLEASE do read the posting guide
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=7xEzNpsPEMvdQLIcBNo-VFJErGQIZfwF2ueg-0lesWT4DSOwIMyZ5deX1XUeO2R2&s=0kmwSZfq16L-GtPuQa5mSO8VGqauae08iBxm57dPnKI&e=
> > and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Tue Apr  5 11:54:59 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Tue, 5 Apr 2022 12:54:59 +0300
Subject: [R] ggplot2
In-Reply-To: <CAMR76UuMUz3iBztjE_03JXk3aCCc2JjN0P6wa-1=VFAVOv+rUA@mail.gmail.com>
References: <CAMR76Uv9LAocKvKvdx6HBOYjUoxx3SM3zJT+E4_tvaF5ox9irQ@mail.gmail.com>
 <BN6PR2201MB15532F4E3F8A1C52143413CBCFE59@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <4ca49dd2-25fb-d6f5-b34e-623715cbdb36@comcast.net>
 <CAMR76UuMUz3iBztjE_03JXk3aCCc2JjN0P6wa-1=VFAVOv+rUA@mail.gmail.com>
Message-ID: <20220405125459.157bdbd6@arachnoid>

On Mon, 4 Apr 2022 18:58:31 -0500
Richard Vickery <richard.vickery at telus.net> wrote:

> I use Fedora Linux.

You might get better help for Fedora-related problems in R-SIG-Fedora:
https://stat.ethz.ch/mailman/listinfo/r-sig-fedora

> After completing
> 
> install.packages("ggplot2", dependencies=TRUE)
> 
> I get these warnings, and the package did not install:

Unfortunately, you omitted the important part: the error messages
explaining the reason why installation of package x had non-zero exit
status. I'll try to guess: you probably need a compiler and all
respective -devel packages (at least R-core-devel) containing header
files installed.

It should also be possible to install ggplot2 as an RPM package
without having to install a compiler, according to
<https://cran.r-project.org/bin/linux/fedora/>.

-- 
Best regards,
Ivan


From k|mmo@e|o @end|ng |rom utu@||  Tue Apr  5 12:07:34 2022
From: k|mmo@e|o @end|ng |rom utu@|| (Kimmo Elo)
Date: Tue, 5 Apr 2022 10:07:34 +0000
Subject: [R] ggplot2
In-Reply-To: <20220405125459.157bdbd6@arachnoid>
References: <CAMR76Uv9LAocKvKvdx6HBOYjUoxx3SM3zJT+E4_tvaF5ox9irQ@mail.gmail.com>
 <BN6PR2201MB15532F4E3F8A1C52143413CBCFE59@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <4ca49dd2-25fb-d6f5-b34e-623715cbdb36@comcast.net>
 <CAMR76UuMUz3iBztjE_03JXk3aCCc2JjN0P6wa-1=VFAVOv+rUA@mail.gmail.com>
 <20220405125459.157bdbd6@arachnoid>
Message-ID: <913574178154580ede9503642bcf11d588836bba.camel@utu.fi>

Hi!

As Ivan pointed you, you might need to install some -devel packages on
you system as well. Check the error messages, they provide valuable
information about this.

And just a quick thought: is your R core system up-to-date?

Best,
Kimmo

ti, 2022-04-05 kello 12:54 +0300, Ivan Krylov kirjoitti:
> On Mon, 4 Apr 2022 18:58:31 -0500
> Richard Vickery <richard.vickery at telus.net> wrote:
> 
> > I use Fedora Linux.
> 
> You might get better help for Fedora-related problems in R-SIG-
> Fedora:
> https://stat.ethz.ch/mailman/listinfo/r-sig-fedora
> 
> > After completing
> > 
> > install.packages("ggplot2", dependencies=TRUE)
> > 
> > I get these warnings, and the package did not install:
> 
> Unfortunately, you omitted the important part: the error messages
> explaining the reason why installation of package x had non-zero exit
> status. I'll try to guess: you probably need a compiler and all
> respective -devel packages (at least R-core-devel) containing header
> files installed.
> 
> It should also be possible to install ggplot2 as an RPM package
> without having to install a compiler, according to
> <https://cran.r-project.org/bin/linux/fedora/>;.
> 

From er|cjberger @end|ng |rom gm@||@com  Tue Apr  5 14:36:37 2022
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Tue, 5 Apr 2022 15:36:37 +0300
Subject: [R] complicated time series filtering issue
In-Reply-To: <CA+8X3fU5gbKcMfsTPOA8AG8V_iD9-JSPMsWxFqntp+3CakdYtQ@mail.gmail.com>
References: <SA1PR09MB753614942CE63B4AE4E8081FD9E59@SA1PR09MB7536.namprd09.prod.outlook.com>
 <CAGxFJbSSw-EuZWAaV0k1Jor-PBazXkvV4xkbr8MJjUouE7=6yQ@mail.gmail.com>
 <BN6PR2201MB15530C88E480EF8AF047E0A5CFE59@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CA+8X3fU5gbKcMfsTPOA8AG8V_iD9-JSPMsWxFqntp+3CakdYtQ@mail.gmail.com>
Message-ID: <CAGgJW77MyQghKJJnAtaxbrO-up+52K--BLnsGCxdTGTt=U8f9g@mail.gmail.com>

For a different approach, use the Date column rather than the differences
column.
I assume the data has been put into the bc.df data frame (as Jim does,
above)

f <- function(v,m=10L) {
  w <- 1L
  while( (i <- tail(w,1)) < length(v))
    w <- c(w, match(TRUE,v[i:(i+m+1)] > v[i]+m )+(i-1))
  w
}
f(as.integer(as.Date(strptime(bc.df$Date,"%d-%b-%y"))))



On Tue, Apr 5, 2022 at 1:16 AM Jim Lemon <drjimlemon at gmail.com> wrote:

> Hi Brian,
> Perhaps this:
>
> bc.df<-read.table(text="Date   INDIVIDUAL DATENUMBER LENGTH length.prev
> interval
> 12-May-04 57084544        133         682.4           NA       NA
> 28-Sep-04 57084544        272         724.8        682.4      139
> 30-Sep-04 57084544        274         740.8        724.8        2
> 7-Oct-04 57084544        281         745.4        740.8        7
> 22-Nov-04 57084544        327         780.2        745.4       46
> 27-Jan-05 57084544        393         817.2        780.2       66
> 8-Mar-05 57084544        433         834.1        817.2       40
> 2-Jul-05 57084544        549         876.3        834.1      116
> 6-Jul-05 57084544        553         871.5        876.3        4
> 4-Aug-05 57084544        582         887.5        871.5       29
> 28-Dec-05 57084544        728         921.8        887.5      146
> 31-Jan-06 57084544        762         936.8        921.8       34
> 27-Feb-06 57084544        789         962.4        936.8       27
> 21-Nov-06 57084544       1056         972.3        962.4      267
> 30-Mar-07 57084544       1185        1007.2        972.3      129
> 23-Apr-07 57084544       1209        1009.1       1007.2       24
> 22-May-07 57084544       1238         991.6       1009.1       29
> 23-May-07 57084544       1239        1015.9        991.6        1
> 16-Jul-07 57084544       1293        1006.5       1015.9       54
> 9-Aug-07 57084544       1317        1013.0       1006.5       24
> 27-Aug-07 57084544       1335        1013.0       1013.0       18
> 29-Jul-08 57084544       1672        1021.5       1013.0      337
> 30-Jul-08 57084544       1673         984.3       1021.5        1
> 31-Jul-08 57084544       1674        1008.5        984.3        1
> 10-Aug-08 57084544       1684        1002.8       1008.5       10
> 22-Oct-08 57084544       1757         977.6       1002.8       73
> 2-Dec-08 57084544       1798        1000.6        977.6       41",
> stringsAsFactors=FALSE,header=TRUE)
> min_interval<-function(x,minint=10) {
>  indx<-1
>  cumint<-0
>  for(i in 2:length(x)) {
>   cumint<-cumint+x[i]
>   if(cumint > minint) {
>    indx<-c(indx,i)
>    cumint<-0
>   }
>  }
>  return(indx)
> }
> min_interval(bc.df$interval)
>
> Jim
>
> On Tue, Apr 5, 2022 at 7:31 AM Ebert,Timothy Aaron <tebert at ufl.edu> wrote:
> >
> > I think the idea is more
> > for (i in 2:nrow(x)){
> > ifelse(x[i]-x[i-1] >10) {keep x[i], delete x[i]]
> > }
> >
> > I am not quite clear on the correct code for "keep" or "delete."
> >
> > One could try
> > for (i in 2:nrow(x)){
> > x$new[i] <- x[i]-x[i-1]
> > }
> > x <- x %>% filter(new>=10)
> >
> > This only works if consecutive sample dates are 10 or more days apart.
> You could add an else if that would accumulate days, and if successful
> reset the clock.
> >
> > Tim
> > -----Original Message-----
> > From: R-help <r-help-bounces at r-project.org> On Behalf Of Bert Gunter
> > Sent: Monday, April 4, 2022 5:04 PM
> > To: Cade, Brian S <cadeb at usgs.gov>
> > Cc: r-help at r-project.org
> > Subject: Re: [R] complicated time series filtering issue
> >
> > [External Email]
> >
> > Like this?
> >
> > winnow <- function(x, int=5){
> >    keep <- x[1]
> >    remaining <- x[-1]
> >    while (length(remaining))
> >    {
> >       nxt <- tail(keep,1) + int
> >       if(length(remaining) ==1 ||
> >          all(remaining < nxt))break
> >       remaining <- remaining[remaining >tail(keep,1) + int]
> >       keep <- c(keep,remaining[1])
> >    }
> >    keep
> > }
> >
> > > x
> >  [1]  1  2  5  7  8  9 15 16 17 19 20 21 28 35 37 41 43 45 46 50
> > > winnow(x,7)
> > [1]  1  9 17 28 37 45
> > > winnow(x,5)
> > [1]  1  7 15 21 28 35 41 50
> >
> > Cheers,
> > Bert
> >
> > "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> > -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> >
> > On Mon, Apr 4, 2022 at 12:56 PM Cade, Brian S via R-help <
> r-help at r-project.org> wrote:
> > >
> > > Hello:  I have an issue with filtering in a time series of animal
> > > growth data that seems conceptually simple but I have not come up with
> > > effective code to implement this.  I have temporal sequences of
> > > lengths by individuals and I want to retain only those data that are
> > > >10 days apart sequentially within an individuals records.  I can
> > > readily compute intervals between successive dates by individual using
> > > data.table() and its by = INDIVIDUAL functionality.  See example data
> > > for one individual below.  But what currently eludes me in processing
> > > this is how to recognize for example that deleting the 2nd and 3rd
> > > rows is required because the totality of their time interval is 9
> > > days, deleting 8th record with 4 days is required,  deleting 17th
> > > record with 1 day is required, deleting 22nd and 23rd records is
> > > required because their sum is 2 days, but we do not delete 24th record
> > > of 10 days because the sum of previous 2 records deleted and this one
> > > is now 12 days.  Each individual can have ve
> >  ry
> > >   different patterns of these sort of sequences.  These sequences are
> easy to look at and determine what needs to be done but writing effective
> code to accomplish this filtering seems to require some functionality that
> I am currently missing.
> > >
> > > Any suggestions would be greatly appreciated.
> > >
> > >          Date   INDIVIDUAL DATENUMBER LENGTH length.prev interval
> > > 228 12-May-04 57084544        133         682.4           NA       NA
> > > 229 28-Sep-04 57084544        272         724.8        682.4      139
> > > 230 30-Sep-04 57084544        274         740.8        724.8        2
> > > 231  7-Oct-04 57084544        281         745.4        740.8        7
> > > 232 22-Nov-04 57084544        327         780.2        745.4       46
> > > 233 27-Jan-05 57084544        393         817.2        780.2       66
> > > 234  8-Mar-05 57084544        433         834.1        817.2       40
> > > 235  2-Jul-05 57084544        549         876.3        834.1      116
> > > 236  6-Jul-05 57084544        553         871.5        876.3        4
> > > 237  4-Aug-05 57084544        582         887.5        871.5       29
> > > 238 28-Dec-05 57084544        728         921.8        887.5      146
> > > 239 31-Jan-06 57084544        762         936.8        921.8       34
> > > 240 27-Feb-06 57084544        789         962.4        936.8       27
> > > 241 21-Nov-06 57084544       1056         972.3        962.4      267
> > > 242 30-Mar-07 57084544       1185        1007.2        972.3      129
> > > 243 23-Apr-07 57084544       1209        1009.1       1007.2       24
> > > 244 22-May-07 57084544       1238         991.6       1009.1       29
> > > 245 23-May-07 57084544       1239        1015.9        991.6        1
> > > 246 16-Jul-07 57084544       1293        1006.5       1015.9       54
> > > 247  9-Aug-07 57084544       1317        1013.0       1006.5       24
> > > 248 27-Aug-07 57084544       1335        1013.0       1013.0       18
> > > 249 29-Jul-08 57084544       1672        1021.5       1013.0      337
> > > 250 30-Jul-08 57084544       1673         984.3       1021.5        1
> > > 251 31-Jul-08 57084544       1674        1008.5        984.3        1
> > > 252 10-Aug-08 57084544       1684        1002.8       1008.5       10
> > > 253 22-Oct-08 57084544       1757         977.6       1002.8       73
> > > 254  2-Dec-08 57084544       1798        1000.6        977.6       41
> > >
> > >
> > >
> > > Brian
> > >
> > >
> > >
> > > Brian S. Cade, PhD
> > >
> > > U. S. Geological Survey
> > > Fort Collins Science Center
> > > 2150 Centre Ave., Bldg. C
> > > Fort Collins, CO  80526-8818
> > >
> > > email:  cadeb at usgs.gov<mailto:brian_cade at usgs.gov>
> > > tel:  970 226-9326
> > >
> > >
> > >         [[alternative HTML version deleted]]
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
> > > man_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAs
> > > Rzsn7AkP-g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu
> > > -vCEJab&s=PG1chCZY6eQzSdtSlvChVVVt0HXVDG1bgBkJMQ8wk1A&e=
> > > PLEASE do read the posting guide
> > > https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.or
> > > g_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeA
> > > sRzsn7AkP-g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxg
> > > u-vCEJab&s=D_bzOVjWanUgYD_zJq-IS8EObMKBmC5Q5D-a_IHxMAA&e=
> > > and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu-vCEJab&s=PG1chCZY6eQzSdtSlvChVVVt0HXVDG1bgBkJMQ8wk1A&e=
> > PLEASE do read the posting guide
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu-vCEJab&s=D_bzOVjWanUgYD_zJq-IS8EObMKBmC5Q5D-a_IHxMAA&e=
> > and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From k|mmo@e|o @end|ng |rom utu@||  Tue Apr  5 15:06:11 2022
From: k|mmo@e|o @end|ng |rom utu@|| (Kimmo Elo)
Date: Tue, 5 Apr 2022 13:06:11 +0000
Subject: [R] complicated time series filtering issue
In-Reply-To: <CAGgJW77MyQghKJJnAtaxbrO-up+52K--BLnsGCxdTGTt=U8f9g@mail.gmail.com>
References: <SA1PR09MB753614942CE63B4AE4E8081FD9E59@SA1PR09MB7536.namprd09.prod.outlook.com>
 <CAGxFJbSSw-EuZWAaV0k1Jor-PBazXkvV4xkbr8MJjUouE7=6yQ@mail.gmail.com>
 <BN6PR2201MB15530C88E480EF8AF047E0A5CFE59@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CA+8X3fU5gbKcMfsTPOA8AG8V_iD9-JSPMsWxFqntp+3CakdYtQ@mail.gmail.com>
 <CAGgJW77MyQghKJJnAtaxbrO-up+52K--BLnsGCxdTGTt=U8f9g@mail.gmail.com>
Message-ID: <b1ec9d52cddc4303ca54bd4e9d5c4a81c84bcce4.camel@utu.fi>

Hi!

Here is an alternative solution using DATENUMBER:

i<-2
while (i<nrow(bc.df)) {
    if (bc.df$DATENUMBER[i]-bc.df$DATENUMBER[i-1]<=11) {
        bc.df<-bc.df[-i,]
    } else { 
        bc.df$interval[i]<-bc.df$DATENUMBER[i]-bc.df$DATENUMBER[i-1]
        i<-i+1 
    }
}

Best,
Kimmo

ti, 2022-04-05 kello 15:36 +0300, Eric Berger kirjoitti:
> For a different approach, use the Date column rather than the
> differences
> column.
> I assume the data has been put into the bc.df data frame (as Jim
> does,
> above)
> 
> f <- function(v,m=10L) {
>   w <- 1L
>   while( (i <- tail(w,1)) < length(v))
>     w <- c(w, match(TRUE,v[i:(i+m+1)] > v[i]+m )+(i-1))
>   w
> }
> f(as.integer(as.Date(strptime(bc.df$Date,"%d-%b-%y"))))
> 
> 
> 
> On Tue, Apr 5, 2022 at 1:16 AM Jim Lemon <drjimlemon at gmail.com>
> wrote:
> 
> > Hi Brian,
> > Perhaps this:
> > 
> > bc.df<-read.table(text="Date   INDIVIDUAL DATENUMBER LENGTH
> > length.prev
> > interval
> > 12-May-04 57084544        133         682.4           NA       NA
> > 28-Sep-04 57084544        272         724.8        682.4      139
> > 30-Sep-04 57084544        274         740.8        724.8        2
> > 7-Oct-04 57084544        281         745.4        740.8        7
> > 22-Nov-04 57084544        327         780.2        745.4       46
> > 27-Jan-05 57084544        393         817.2        780.2       66
> > 8-Mar-05 57084544        433         834.1        817.2       40
> > 2-Jul-05 57084544        549         876.3        834.1      116
> > 6-Jul-05 57084544        553         871.5        876.3        4
> > 4-Aug-05 57084544        582         887.5        871.5       29
> > 28-Dec-05 57084544        728         921.8        887.5      146
> > 31-Jan-06 57084544        762         936.8        921.8       34
> > 27-Feb-06 57084544        789         962.4        936.8       27
> > 21-Nov-06 57084544       1056         972.3        962.4      267
> > 30-Mar-07 57084544       1185        1007.2        972.3      129
> > 23-Apr-07 57084544       1209        1009.1       1007.2       24
> > 22-May-07 57084544       1238         991.6       1009.1       29
> > 23-May-07 57084544       1239        1015.9        991.6        1
> > 16-Jul-07 57084544       1293        1006.5       1015.9       54
> > 9-Aug-07 57084544       1317        1013.0       1006.5       24
> > 27-Aug-07 57084544       1335        1013.0       1013.0       18
> > 29-Jul-08 57084544       1672        1021.5       1013.0      337
> > 30-Jul-08 57084544       1673         984.3       1021.5        1
> > 31-Jul-08 57084544       1674        1008.5        984.3        1
> > 10-Aug-08 57084544       1684        1002.8       1008.5       10
> > 22-Oct-08 57084544       1757         977.6       1002.8       73
> > 2-Dec-08 57084544       1798        1000.6        977.6       41",
> > stringsAsFactors=FALSE,header=TRUE)
> > min_interval<-function(x,minint=10) {
> >  indx<-1
> >  cumint<-0
> >  for(i in 2:length(x)) {
> >   cumint<-cumint+x[i]
> >   if(cumint > minint) {
> >    indx<-c(indx,i)
> >    cumint<-0
> >   }
> >  }
> >  return(indx)
> > }
> > min_interval(bc.df$interval)
> > 
> > Jim
> > 
> > On Tue, Apr 5, 2022 at 7:31 AM Ebert,Timothy Aaron <tebert at ufl.edu>
> > wrote:
> > > I think the idea is more
> > > for (i in 2:nrow(x)){
> > > ifelse(x[i]-x[i-1] >10) {keep x[i], delete x[i]]
> > > }
> > > 
> > > I am not quite clear on the correct code for "keep" or "delete."
> > > 
> > > One could try
> > > for (i in 2:nrow(x)){
> > > x$new[i] <- x[i]-x[i-1]
> > > }
> > > x <- x %>% filter(new>=10)
> > > 
> > > This only works if consecutive sample dates are 10 or more days
> > > apart.
> > You could add an else if that would accumulate days, and if
> > successful
> > reset the clock.
> > > Tim
> > > -----Original Message-----
> > > From: R-help <r-help-bounces at r-project.org> On Behalf Of Bert
> > > Gunter
> > > Sent: Monday, April 4, 2022 5:04 PM
> > > To: Cade, Brian S <cadeb at usgs.gov>
> > > Cc: r-help at r-project.org
> > > Subject: Re: [R] complicated time series filtering issue
> > > 
> > > [External Email]
> > > 
> > > Like this?
> > > 
> > > winnow <- function(x, int=5){
> > >    keep <- x[1]
> > >    remaining <- x[-1]
> > >    while (length(remaining))
> > >    {
> > >       nxt <- tail(keep,1) + int
> > >       if(length(remaining) ==1 ||
> > >          all(remaining < nxt))break
> > >       remaining <- remaining[remaining >tail(keep,1) + int]
> > >       keep <- c(keep,remaining[1])
> > >    }
> > >    keep
> > > }
> > > 
> > > > x
> > >  [1]  1  2  5  7  8  9 15 16 17 19 20 21 28 35 37 41 43 45 46 50
> > > > winnow(x,7)
> > > [1]  1  9 17 28 37 45
> > > > winnow(x,5)
> > > [1]  1  7 15 21 28 35 41 50
> > > 
> > > Cheers,
> > > Bert
> > > 
> > > "The trouble with having an open mind is that people keep coming
> > > along
> > and sticking things into it."
> > > -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip
> > > )
> > > 
> > > On Mon, Apr 4, 2022 at 12:56 PM Cade, Brian S via R-help <
> > r-help at r-project.org> wrote:
> > > > Hello:  I have an issue with filtering in a time series of
> > > > animal
> > > > growth data that seems conceptually simple but I have not come
> > > > up with
> > > > effective code to implement this.  I have temporal sequences of
> > > > lengths by individuals and I want to retain only those data
> > > > that are
> > > > > 10 days apart sequentially within an individuals records.  I
> > > > > can
> > > > readily compute intervals between successive dates by
> > > > individual using
> > > > data.table() and its by = INDIVIDUAL functionality.  See
> > > > example data
> > > > for one individual below.  But what currently eludes me in
> > > > processing
> > > > this is how to recognize for example that deleting the 2nd and
> > > > 3rd
> > > > rows is required because the totality of their time interval is
> > > > 9
> > > > days, deleting 8th record with 4 days is required,  deleting
> > > > 17th
> > > > record with 1 day is required, deleting 22nd and 23rd records
> > > > is
> > > > required because their sum is 2 days, but we do not delete 24th
> > > > record
> > > > of 10 days because the sum of previous 2 records deleted and
> > > > this one
> > > > is now 12 days.  Each individual can have ve
> > >  ry
> > > >   different patterns of these sort of sequences.  These
> > > > sequences are
> > easy to look at and determine what needs to be done but writing
> > effective
> > code to accomplish this filtering seems to require some
> > functionality that
> > I am currently missing.
> > > > Any suggestions would be greatly appreciated.
> > > > 
> > > >          Date   INDIVIDUAL DATENUMBER LENGTH length.prev
> > > > interval
> > > > 228 12-May-04
> > > > 57084544        133         682.4           NA       NA
> > > > 229 28-Sep-04
> > > > 57084544        272         724.8        682.4      139
> > > > 230 30-Sep-04
> > > > 57084544        274         740.8        724.8        2
> > > > 231  7-Oct-04
> > > > 57084544        281         745.4        740.8        7
> > > > 232 22-Nov-04
> > > > 57084544        327         780.2        745.4       46
> > > > 233 27-Jan-05
> > > > 57084544        393         817.2        780.2       66
> > > > 234  8-Mar-05
> > > > 57084544        433         834.1        817.2       40
> > > > 235  2-Jul-05
> > > > 57084544        549         876.3        834.1      116
> > > > 236  6-Jul-05
> > > > 57084544        553         871.5        876.3        4
> > > > 237  4-Aug-05
> > > > 57084544        582         887.5        871.5       29
> > > > 238 28-Dec-05
> > > > 57084544        728         921.8        887.5      146
> > > > 239 31-Jan-06
> > > > 57084544        762         936.8        921.8       34
> > > > 240 27-Feb-06
> > > > 57084544        789         962.4        936.8       27
> > > > 241 21-Nov-06
> > > > 57084544       1056         972.3        962.4      267
> > > > 242 30-Mar-07
> > > > 57084544       1185        1007.2        972.3      129
> > > > 243 23-Apr-07
> > > > 57084544       1209        1009.1       1007.2       24
> > > > 244 22-May-07
> > > > 57084544       1238         991.6       1009.1       29
> > > > 245 23-May-07
> > > > 57084544       1239        1015.9        991.6        1
> > > > 246 16-Jul-07
> > > > 57084544       1293        1006.5       1015.9       54
> > > > 247  9-Aug-07
> > > > 57084544       1317        1013.0       1006.5       24
> > > > 248 27-Aug-07
> > > > 57084544       1335        1013.0       1013.0       18
> > > > 249 29-Jul-08
> > > > 57084544       1672        1021.5       1013.0      337
> > > > 250 30-Jul-08
> > > > 57084544       1673         984.3       1021.5        1
> > > > 251 31-Jul-08
> > > > 57084544       1674        1008.5        984.3        1
> > > > 252 10-Aug-08
> > > > 57084544       1684        1002.8       1008.5       10
> > > > 253 22-Oct-08
> > > > 57084544       1757         977.6       1002.8       73
> > > > 254  2-Dec-08
> > > > 57084544       1798        1000.6        977.6       41
> > > > 
> > > > 
> > > > 
> > > > Brian
> > > > 
> > > > 
> > > > 
> > > > Brian S. Cade, PhD
> > > > 
> > > > U. S. Geological Survey
> > > > Fort Collins Science Center
> > > > 2150 Centre Ave., Bldg. C
> > > > Fort Collins, CO  80526-8818
> > > > 
> > > > email:  cadeb at usgs.gov<mailto:brian_cade at usgs.gov>
> > > > tel:  970 226-9326
> > > > 
> > > > 
> > > >         [[alternative HTML version deleted]]
> > > > 
> > > > ______________________________________________
> > > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more,
> > > > see
> > > > https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
> > > > man_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-
> > > > zLMB3EPkvcnVg&r=9PEhQh2kVeAs
> > > > Rzsn7AkP-
> > > > g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu
> > > > -vCEJab&s=PG1chCZY6eQzSdtSlvChVVVt0HXVDG1bgBkJMQ8wk1A&e=
> > > > PLEASE do read the posting guide
> > > > https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.or
> > > > g_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-
> > > > zLMB3EPkvcnVg&r=9PEhQh2kVeA
> > > > sRzsn7AkP-
> > > > g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxg
> > > > u-vCEJab&s=D_bzOVjWanUgYD_zJq-IS8EObMKBmC5Q5D-a_IHxMAA&e=
> > > > and provide commented, minimal, self-contained, reproducible
> > > > code.
> > > 
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu-vCEJab&s=PG1chCZY6eQzSdtSlvChVVVt0HXVDG1bgBkJMQ8wk1A&e=
> > > PLEASE do read the posting guide
> > https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu-vCEJab&s=D_bzOVjWanUgYD_zJq-IS8EObMKBmC5Q5D-a_IHxMAA&e=
> > > and provide commented, minimal, self-contained, reproducible
> > > code.
> > > 
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible
> > > code.
> > 
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> > 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

From m|n@h@|| @end|ng |rom um|ch@edu  Tue Apr  5 15:53:16 2022
From: m|n@h@|| @end|ng |rom um|ch@edu (Greg Minshall)
Date: Tue, 05 Apr 2022 06:53:16 -0700
Subject: [R] ggplot2
In-Reply-To: <CAMR76UuMUz3iBztjE_03JXk3aCCc2JjN0P6wa-1=VFAVOv+rUA@mail.gmail.com>
References: <CAMR76Uv9LAocKvKvdx6HBOYjUoxx3SM3zJT+E4_tvaF5ox9irQ@mail.gmail.com>
 <BN6PR2201MB15532F4E3F8A1C52143413CBCFE59@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <4ca49dd2-25fb-d6f5-b34e-623715cbdb36@comcast.net>
 <CAMR76UuMUz3iBztjE_03JXk3aCCc2JjN0P6wa-1=VFAVOv+rUA@mail.gmail.com>
Message-ID: <2718211.1649166796@apollo2.minshall.org>

hi, Richard,

> I get these warnings, and the package did not install:
...
> 1: In install.packages("ggplot2", dependencies = TRUE) :
>   installation of package ?curl? had non-zero exit status

Ivan and Kimmo have both pointed out you need the right development
tools.

in terms of debugging your problem -- if the development tools are
installed, etc. -- then you might choose one of the packages that didn't
install -- `curl` in the above case, and try

> install.packages("curl")

and seeing what failed *there*.  and, recursing, looking for a package
that doesn't depend on any other package, that can't be installed.
then, try to figure out the error messages.

again, in this case, things will hopefully work once you install the
compiler and other development tools.

cheers and good luck, Greg


From c@deb @end|ng |rom u@g@@gov  Tue Apr  5 16:26:16 2022
From: c@deb @end|ng |rom u@g@@gov (Cade, Brian S)
Date: Tue, 5 Apr 2022 14:26:16 +0000
Subject: [R] [EXTERNAL] Re:  complicated time series filtering issue
In-Reply-To: <b1ec9d52cddc4303ca54bd4e9d5c4a81c84bcce4.camel@utu.fi>
References: <SA1PR09MB753614942CE63B4AE4E8081FD9E59@SA1PR09MB7536.namprd09.prod.outlook.com>
 <CAGxFJbSSw-EuZWAaV0k1Jor-PBazXkvV4xkbr8MJjUouE7=6yQ@mail.gmail.com>
 <BN6PR2201MB15530C88E480EF8AF047E0A5CFE59@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CA+8X3fU5gbKcMfsTPOA8AG8V_iD9-JSPMsWxFqntp+3CakdYtQ@mail.gmail.com>
 <CAGgJW77MyQghKJJnAtaxbrO-up+52K--BLnsGCxdTGTt=U8f9g@mail.gmail.com>
 <b1ec9d52cddc4303ca54bd4e9d5c4a81c84bcce4.camel@utu.fi>
Message-ID: <SA1PR09MB753697B2B9FECF24B87A37BCD9E49@SA1PR09MB7536.namprd09.prod.outlook.com>

Thank you all for the useful suggestions.  Now I just need to figure out which solution will mesh with a by = INDIVIDUAL functionality easily.

Brian


Brian S. Cade, PhD

U. S. Geological Survey
Fort Collins Science Center
2150 Centre Ave., Bldg. C
Fort Collins, CO  80526-8818

email:  cadeb at usgs.gov<mailto:brian_cade at usgs.gov>
tel:  970 226-9326

________________________________
From: R-help <r-help-bounces at r-project.org> on behalf of Kimmo Elo <kimmo.elo at utu.fi>
Sent: Tuesday, April 5, 2022 7:06 AM
To: r-help at r-project.org <r-help at r-project.org>
Subject: [EXTERNAL] Re: [R] complicated time series filtering issue



 This email has been received from outside of DOI - Use caution before clicking on links, opening attachments, or responding.



Hi!

Here is an alternative solution using DATENUMBER:

i<-2
while (i<nrow(bc.df)) {
    if (bc.df$DATENUMBER[i]-bc.df$DATENUMBER[i-1]<=11) {
        bc.df<-bc.df[-i,]
    } else {
        bc.df$interval[i]<-bc.df$DATENUMBER[i]-bc.df$DATENUMBER[i-1]
        i<-i+1
    }
}

Best,
Kimmo

ti, 2022-04-05 kello 15:36 +0300, Eric Berger kirjoitti:
> For a different approach, use the Date column rather than the
> differences
> column.
> I assume the data has been put into the bc.df data frame (as Jim
> does,
> above)
>
> f <- function(v,m=10L) {
>   w <- 1L
>   while( (i <- tail(w,1)) < length(v))
>     w <- c(w, match(TRUE,v[i:(i+m+1)] > v[i]+m )+(i-1))
>   w
> }
> f(as.integer(as.Date(strptime(bc.df$Date,"%d-%b-%y"))))
>
>
>
> On Tue, Apr 5, 2022 at 1:16 AM Jim Lemon <drjimlemon at gmail.com>
> wrote:
>
> > Hi Brian,
> > Perhaps this:
> >
> > bc.df<-read.table(text="Date   INDIVIDUAL DATENUMBER LENGTH
> > length.prev
> > interval
> > 12-May-04 57084544        133         682.4           NA       NA
> > 28-Sep-04 57084544        272         724.8        682.4      139
> > 30-Sep-04 57084544        274         740.8        724.8        2
> > 7-Oct-04 57084544        281         745.4        740.8        7
> > 22-Nov-04 57084544        327         780.2        745.4       46
> > 27-Jan-05 57084544        393         817.2        780.2       66
> > 8-Mar-05 57084544        433         834.1        817.2       40
> > 2-Jul-05 57084544        549         876.3        834.1      116
> > 6-Jul-05 57084544        553         871.5        876.3        4
> > 4-Aug-05 57084544        582         887.5        871.5       29
> > 28-Dec-05 57084544        728         921.8        887.5      146
> > 31-Jan-06 57084544        762         936.8        921.8       34
> > 27-Feb-06 57084544        789         962.4        936.8       27
> > 21-Nov-06 57084544       1056         972.3        962.4      267
> > 30-Mar-07 57084544       1185        1007.2        972.3      129
> > 23-Apr-07 57084544       1209        1009.1       1007.2       24
> > 22-May-07 57084544       1238         991.6       1009.1       29
> > 23-May-07 57084544       1239        1015.9        991.6        1
> > 16-Jul-07 57084544       1293        1006.5       1015.9       54
> > 9-Aug-07 57084544       1317        1013.0       1006.5       24
> > 27-Aug-07 57084544       1335        1013.0       1013.0       18
> > 29-Jul-08 57084544       1672        1021.5       1013.0      337
> > 30-Jul-08 57084544       1673         984.3       1021.5        1
> > 31-Jul-08 57084544       1674        1008.5        984.3        1
> > 10-Aug-08 57084544       1684        1002.8       1008.5       10
> > 22-Oct-08 57084544       1757         977.6       1002.8       73
> > 2-Dec-08 57084544       1798        1000.6        977.6       41",
> > stringsAsFactors=FALSE,header=TRUE)
> > min_interval<-function(x,minint=10) {
> >  indx<-1
> >  cumint<-0
> >  for(i in 2:length(x)) {
> >   cumint<-cumint+x[i]
> >   if(cumint > minint) {
> >    indx<-c(indx,i)
> >    cumint<-0
> >   }
> >  }
> >  return(indx)
> > }
> > min_interval(bc.df$interval)
> >
> > Jim
> >
> > On Tue, Apr 5, 2022 at 7:31 AM Ebert,Timothy Aaron <tebert at ufl.edu>
> > wrote:
> > > I think the idea is more
> > > for (i in 2:nrow(x)){
> > > ifelse(x[i]-x[i-1] >10) {keep x[i], delete x[i]]
> > > }
> > >
> > > I am not quite clear on the correct code for "keep" or "delete."
> > >
> > > One could try
> > > for (i in 2:nrow(x)){
> > > x$new[i] <- x[i]-x[i-1]
> > > }
> > > x <- x %>% filter(new>=10)
> > >
> > > This only works if consecutive sample dates are 10 or more days
> > > apart.
> > You could add an else if that would accumulate days, and if
> > successful
> > reset the clock.
> > > Tim
> > > -----Original Message-----
> > > From: R-help <r-help-bounces at r-project.org> On Behalf Of Bert
> > > Gunter
> > > Sent: Monday, April 4, 2022 5:04 PM
> > > To: Cade, Brian S <cadeb at usgs.gov>
> > > Cc: r-help at r-project.org
> > > Subject: Re: [R] complicated time series filtering issue
> > >
> > > [External Email]
> > >
> > > Like this?
> > >
> > > winnow <- function(x, int=5){
> > >    keep <- x[1]
> > >    remaining <- x[-1]
> > >    while (length(remaining))
> > >    {
> > >       nxt <- tail(keep,1) + int
> > >       if(length(remaining) ==1 ||
> > >          all(remaining < nxt))break
> > >       remaining <- remaining[remaining >tail(keep,1) + int]
> > >       keep <- c(keep,remaining[1])
> > >    }
> > >    keep
> > > }
> > >
> > > > x
> > >  [1]  1  2  5  7  8  9 15 16 17 19 20 21 28 35 37 41 43 45 46 50
> > > > winnow(x,7)
> > > [1]  1  9 17 28 37 45
> > > > winnow(x,5)
> > > [1]  1  7 15 21 28 35 41 50
> > >
> > > Cheers,
> > > Bert
> > >
> > > "The trouble with having an open mind is that people keep coming
> > > along
> > and sticking things into it."
> > > -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip
> > > )
> > >
> > > On Mon, Apr 4, 2022 at 12:56 PM Cade, Brian S via R-help <
> > r-help at r-project.org> wrote:
> > > > Hello:  I have an issue with filtering in a time series of
> > > > animal
> > > > growth data that seems conceptually simple but I have not come
> > > > up with
> > > > effective code to implement this.  I have temporal sequences of
> > > > lengths by individuals and I want to retain only those data
> > > > that are
> > > > > 10 days apart sequentially within an individuals records.  I
> > > > > can
> > > > readily compute intervals between successive dates by
> > > > individual using
> > > > data.table() and its by = INDIVIDUAL functionality.  See
> > > > example data
> > > > for one individual below.  But what currently eludes me in
> > > > processing
> > > > this is how to recognize for example that deleting the 2nd and
> > > > 3rd
> > > > rows is required because the totality of their time interval is
> > > > 9
> > > > days, deleting 8th record with 4 days is required,  deleting
> > > > 17th
> > > > record with 1 day is required, deleting 22nd and 23rd records
> > > > is
> > > > required because their sum is 2 days, but we do not delete 24th
> > > > record
> > > > of 10 days because the sum of previous 2 records deleted and
> > > > this one
> > > > is now 12 days.  Each individual can have ve
> > >  ry
> > > >   different patterns of these sort of sequences.  These
> > > > sequences are
> > easy to look at and determine what needs to be done but writing
> > effective
> > code to accomplish this filtering seems to require some
> > functionality that
> > I am currently missing.
> > > > Any suggestions would be greatly appreciated.
> > > >
> > > >          Date   INDIVIDUAL DATENUMBER LENGTH length.prev
> > > > interval
> > > > 228 12-May-04
> > > > 57084544        133         682.4           NA       NA
> > > > 229 28-Sep-04
> > > > 57084544        272         724.8        682.4      139
> > > > 230 30-Sep-04
> > > > 57084544        274         740.8        724.8        2
> > > > 231  7-Oct-04
> > > > 57084544        281         745.4        740.8        7
> > > > 232 22-Nov-04
> > > > 57084544        327         780.2        745.4       46
> > > > 233 27-Jan-05
> > > > 57084544        393         817.2        780.2       66
> > > > 234  8-Mar-05
> > > > 57084544        433         834.1        817.2       40
> > > > 235  2-Jul-05
> > > > 57084544        549         876.3        834.1      116
> > > > 236  6-Jul-05
> > > > 57084544        553         871.5        876.3        4
> > > > 237  4-Aug-05
> > > > 57084544        582         887.5        871.5       29
> > > > 238 28-Dec-05
> > > > 57084544        728         921.8        887.5      146
> > > > 239 31-Jan-06
> > > > 57084544        762         936.8        921.8       34
> > > > 240 27-Feb-06
> > > > 57084544        789         962.4        936.8       27
> > > > 241 21-Nov-06
> > > > 57084544       1056         972.3        962.4      267
> > > > 242 30-Mar-07
> > > > 57084544       1185        1007.2        972.3      129
> > > > 243 23-Apr-07
> > > > 57084544       1209        1009.1       1007.2       24
> > > > 244 22-May-07
> > > > 57084544       1238         991.6       1009.1       29
> > > > 245 23-May-07
> > > > 57084544       1239        1015.9        991.6        1
> > > > 246 16-Jul-07
> > > > 57084544       1293        1006.5       1015.9       54
> > > > 247  9-Aug-07
> > > > 57084544       1317        1013.0       1006.5       24
> > > > 248 27-Aug-07
> > > > 57084544       1335        1013.0       1013.0       18
> > > > 249 29-Jul-08
> > > > 57084544       1672        1021.5       1013.0      337
> > > > 250 30-Jul-08
> > > > 57084544       1673         984.3       1021.5        1
> > > > 251 31-Jul-08
> > > > 57084544       1674        1008.5        984.3        1
> > > > 252 10-Aug-08
> > > > 57084544       1684        1002.8       1008.5       10
> > > > 253 22-Oct-08
> > > > 57084544       1757         977.6       1002.8       73
> > > > 254  2-Dec-08
> > > > 57084544       1798        1000.6        977.6       41
> > > >
> > > >
> > > >
> > > > Brian
> > > >
> > > >
> > > >
> > > > Brian S. Cade, PhD
> > > >
> > > > U. S. Geological Survey
> > > > Fort Collins Science Center
> > > > 2150 Centre Ave., Bldg. C
> > > > Fort Collins, CO  80526-8818
> > > >
> > > > email:  cadeb at usgs.gov<mailto:brian_cade at usgs.gov>
> > > > tel:  970 226-9326
> > > >
> > > >
> > > >         [[alternative HTML version deleted]]
> > > >
> > > > ______________________________________________
> > > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more,
> > > > see
> > > > https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Furldefense.proofpoint.com%2Fv2%2Furl%3Fu%3Dhttps-3A__stat.ethz.ch_mail&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=1nmGdrtMLTCKAiwFMRIQJrfNYKHzVhqXdpBMoAC9F54%3D&amp;reserved=0
> > > > man_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-
> > > > zLMB3EPkvcnVg&r=9PEhQh2kVeAs
> > > > Rzsn7AkP-
> > > > g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu
> > > > -vCEJab&s=PG1chCZY6eQzSdtSlvChVVVt0HXVDG1bgBkJMQ8wk1A&e=
> > > > PLEASE do read the posting guide
> > > > https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Furldefense.proofpoint.com%2Fv2%2Furl%3Fu%3Dhttp-3A__www.R-2Dproject.or&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=yHYWDC3bFh2Tl1SNiW6bEzF3qjfkBVQZUwhf1SQhE8U%3D&amp;reserved=0
> > > > g_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-
> > > > zLMB3EPkvcnVg&r=9PEhQh2kVeA
> > > > sRzsn7AkP-
> > > > g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxg
> > > > u-vCEJab&s=D_bzOVjWanUgYD_zJq-IS8EObMKBmC5Q5D-a_IHxMAA&e=
> > > > and provide commented, minimal, self-contained, reproducible
> > > > code.
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Furldefense.proofpoint.com%2Fv2%2Furl%3Fu%3Dhttps-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp%26d%3DDwICAg%26c%3DsJ6xIWYx-zLMB3EPkvcnVg%26r%3D9PEhQh2kVeAsRzsn7AkP-g%26m%3DZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu-vCEJab%26s%3DPG1chCZY6eQzSdtSlvChVVVt0HXVDG1bgBkJMQ8wk1A%26e%3D&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=Nbny2p%2B45YIFmSasHb1JjtM7v98gePIAF7ixM1BjLq8%3D&amp;reserved=0
> > > PLEASE do read the posting guide
> > https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Furldefense.proofpoint.com%2Fv2%2Furl%3Fu%3Dhttp-3A__www.R-2Dproject.org_posting-2Dguide.html%26d%3DDwICAg%26c%3DsJ6xIWYx-zLMB3EPkvcnVg%26r%3D9PEhQh2kVeAsRzsn7AkP-g%26m%3DZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu-vCEJab%26s%3DD_bzOVjWanUgYD_zJq-IS8EObMKBmC5Q5D-a_IHxMAA%26e%3D&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=7nyV7C8EsubHRAfi721l6QdCy%2BMYoqWJKWnd6ONhgAc%3D&amp;reserved=0
> > > and provide commented, minimal, self-contained, reproducible
> > > code.
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=DuIf9gykRJpBoiqui%2FlOgqdqB%2F0LAu1z%2B%2Bsxnfl%2BFEs%3D&amp;reserved=0
> > > PLEASE do read the posting guide
> > https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=myGg3MHNo1Iikdeaxod94fC41D6Pya2pY6CGMXFeR4A%3D&amp;reserved=0
> > > and provide commented, minimal, self-contained, reproducible
> > > code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=DuIf9gykRJpBoiqui%2FlOgqdqB%2F0LAu1z%2B%2Bsxnfl%2BFEs%3D&amp;reserved=0
> > PLEASE do read the posting guide
> > https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=myGg3MHNo1Iikdeaxod94fC41D6Pya2pY6CGMXFeR4A%3D&amp;reserved=0
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
>       [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=DuIf9gykRJpBoiqui%2FlOgqdqB%2F0LAu1z%2B%2Bsxnfl%2BFEs%3D&amp;reserved=0
> PLEASE do read the posting guide
> https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=myGg3MHNo1Iikdeaxod94fC41D6Pya2pY6CGMXFeR4A%3D&amp;reserved=0
> and provide commented, minimal, self-contained, reproducible code.
______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=DuIf9gykRJpBoiqui%2FlOgqdqB%2F0LAu1z%2B%2Bsxnfl%2BFEs%3D&amp;reserved=0
PLEASE do read the posting guide https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=myGg3MHNo1Iikdeaxod94fC41D6Pya2pY6CGMXFeR4A%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From peter@|@ng|e|der @end|ng |rom gm@||@com  Wed Apr  6 02:36:54 2022
From: peter@|@ng|e|der @end|ng |rom gm@||@com (Peter Langfelder)
Date: Tue, 5 Apr 2022 17:36:54 -0700
Subject: [R] Checking a function for undeclared variables
Message-ID: <CA+hbrhX+zSoJ9RrWTXvCkYUki=nq-VGcfrFT9arnHRjou6SBFA@mail.gmail.com>

Hi all,

I'd like to check a function for undeclared global variables using
something similar to what R CMD check does when "checking R code for
possible problems". My search came up empty but I hope there is way to
do it without building a package just for this purpose, isn't there?

Thanks!

Peter


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed Apr  6 02:48:04 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Tue, 05 Apr 2022 17:48:04 -0700
Subject: [R] Checking a function for undeclared variables
In-Reply-To: <CA+hbrhX+zSoJ9RrWTXvCkYUki=nq-VGcfrFT9arnHRjou6SBFA@mail.gmail.com>
References: <CA+hbrhX+zSoJ9RrWTXvCkYUki=nq-VGcfrFT9arnHRjou6SBFA@mail.gmail.com>
Message-ID: <AAC51ABE-B397-43BF-A645-53C25F5FDF0E@dcn.davis.ca.us>

?codetools::findGlobals

On April 5, 2022 5:36:54 PM PDT, Peter Langfelder <peter.langfelder at gmail.com> wrote:
>Hi all,
>
>I'd like to check a function for undeclared global variables using
>something similar to what R CMD check does when "checking R code for
>possible problems". My search came up empty but I hope there is way to
>do it without building a package just for this purpose, isn't there?
>
>Thanks!
>
>Peter
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From g@@@uu| @end|ng |rom gm@||@com  Wed Apr  6 04:47:34 2022
From: g@@@uu| @end|ng |rom gm@||@com (ani jaya)
Date: Wed, 6 Apr 2022 11:47:34 +0900
Subject: [R] replacing a value
Message-ID: <CAHXS41wDnqaCAO2vvtsww68u60dK4aYP-8n5ZejKsQhffLrwJQ@mail.gmail.com>

Dear R-Help,

I try to change a specific value here by following these:

https://www.journaldev.com/39695/replace-in-r
https://stackoverflow.com/questions/5824173/replace-a-value-in-a-data-frame-based-on-a-conditional-if-statement
https://stackoverflow.com/questions/54615462/how-to-replace-certain-values-in-a-specific-rows-and-columns-with-na-in-r
..and many more

however, it is not change anything. I believe it "should" be easy but
I think I am missing something. I am afraid it is my system that has a
problem but restarting r is not solve the problem.
I just want to change 20 to 0 in my data.

> dput(a)
c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 16.3092078677214,
20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298,
20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444,
20, 20, 20, 20)

what I did:
a[a==20]<-0 #fail
a<-replace(a,a==20,0) #fail
a[which(a==20)]<-0 #fail

> sessionInfo()
R version 4.1.2 (2021-11-01)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19043)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
[5] LC_TIME=English_United States.1252
system code page: 949

Best,
Ani


From drj|m|emon @end|ng |rom gm@||@com  Wed Apr  6 05:16:40 2022
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Wed, 6 Apr 2022 13:16:40 +1000
Subject: [R] replacing a value
In-Reply-To: <CAHXS41wDnqaCAO2vvtsww68u60dK4aYP-8n5ZejKsQhffLrwJQ@mail.gmail.com>
References: <CAHXS41wDnqaCAO2vvtsww68u60dK4aYP-8n5ZejKsQhffLrwJQ@mail.gmail.com>
Message-ID: <CA+8X3fUcunq4+o9iW8Q7Qaazd0NRs-qEk1KhBVJKGGCB4ByAPA@mail.gmail.com>

Hi Ani,
It seems to work for me:

 a<-c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 16.3092078677214,
20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298,
20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444,
20, 20, 20, 20)
> a==20
[1]  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
[13]  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE
[25]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE
> a[a==20]<-0
> a
[1]  0.00000  0.00000 14.23756 20.00000  0.00000  0.00000 16.30921  0.00000
[9]  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000 14.85909
[17] 16.17894  0.00000  0.00000  0.00000  0.00000 27.64041  0.00000  0.00000
[25]  0.00000  0.00000  0.00000 21.98571  0.00000  0.00000  0.00000  0.00000

Notice that it didn't make 19.99999999999999 equal to 20, but did
round it up when printing the result. How do you know that it failed?

Jim

On Wed, Apr 6, 2022 at 12:48 PM ani jaya <gaaauul at gmail.com> wrote:
>
> Dear R-Help,
>
> I try to change a specific value here by following these:
>
> https://www.journaldev.com/39695/replace-in-r
> https://stackoverflow.com/questions/5824173/replace-a-value-in-a-data-frame-based-on-a-conditional-if-statement
> https://stackoverflow.com/questions/54615462/how-to-replace-certain-values-in-a-specific-rows-and-columns-with-na-in-r
> ..and many more
>
> however, it is not change anything. I believe it "should" be easy but
> I think I am missing something. I am afraid it is my system that has a
> problem but restarting r is not solve the problem.
> I just want to change 20 to 0 in my data.
>
> > dput(a)
> c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 16.3092078677214,
> 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298,
> 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444,
> 20, 20, 20, 20)
>
> what I did:
> a[a==20]<-0 #fail
> a<-replace(a,a==20,0) #fail
> a[which(a==20)]<-0 #fail
>
> > sessionInfo()
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 10 x64 (build 19043)
>
> Matrix products: default
>
> locale:
> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
> system code page: 949
>
> Best,
> Ani
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From peter@|@ng|e|der @end|ng |rom gm@||@com  Wed Apr  6 05:53:53 2022
From: peter@|@ng|e|der @end|ng |rom gm@||@com (Peter Langfelder)
Date: Tue, 5 Apr 2022 20:53:53 -0700
Subject: [R] Checking a function for undeclared variables
In-Reply-To: <AAC51ABE-B397-43BF-A645-53C25F5FDF0E@dcn.davis.ca.us>
References: <CA+hbrhX+zSoJ9RrWTXvCkYUki=nq-VGcfrFT9arnHRjou6SBFA@mail.gmail.com>
 <AAC51ABE-B397-43BF-A645-53C25F5FDF0E@dcn.davis.ca.us>
Message-ID: <CA+hbrhWngDb-3g4urfi=cBzFfhmp0G5HKNmuEyDZVcY7NVypnw@mail.gmail.com>

Thanks!

Peter

On Tue, Apr 5, 2022 at 6:01 PM Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
>
> ?codetools::findGlobals
>
> On April 5, 2022 5:36:54 PM PDT, Peter Langfelder <peter.langfelder at gmail.com> wrote:
> >Hi all,
> >
> >I'd like to check a function for undeclared global variables using
> >something similar to what R CMD check does when "checking R code for
> >possible problems". My search came up empty but I hope there is way to
> >do it without building a package just for this purpose, isn't there?
> >
> >Thanks!
> >
> >Peter
> >
> >______________________________________________
> >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >https://stat.ethz.ch/mailman/listinfo/r-help
> >PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >and provide commented, minimal, self-contained, reproducible code.
>
> --
> Sent from my phone. Please excuse my brevity.


From g@@@uu| @end|ng |rom gm@||@com  Wed Apr  6 06:18:01 2022
From: g@@@uu| @end|ng |rom gm@||@com (ani jaya)
Date: Wed, 6 Apr 2022 13:18:01 +0900
Subject: [R] replacing a value
In-Reply-To: <CA+8X3fUcunq4+o9iW8Q7Qaazd0NRs-qEk1KhBVJKGGCB4ByAPA@mail.gmail.com>
References: <CAHXS41wDnqaCAO2vvtsww68u60dK4aYP-8n5ZejKsQhffLrwJQ@mail.gmail.com>
 <CA+8X3fUcunq4+o9iW8Q7Qaazd0NRs-qEk1KhBVJKGGCB4ByAPA@mail.gmail.com>
Message-ID: <CAHXS41zww6=dXdZ3+KybCVfxioxu1p2JiB8R1znnjNQ1_cpsKA@mail.gmail.com>

Hello Jim,

Thank you for the try. I am following your step and still have the problem.
But I know for sure now that my R/system is somewhat "broken" or I do
not know for sure.

> a
[1] 20.00000 20.00000 14.23756 20.00000 20.00000 20.00000 16.30921
20.00000 20.00000 20.00000
[11] 20.00000 20.00000 20.00000 20.00000 20.00000 14.85909 16.17894
20.00000 20.00000 20.00000
[21] 20.00000 27.64041 20.00000 20.00000 20.00000 20.00000 20.00000
21.98571 20.00000 20.00000
[31] 20.00000 20.00000
> a==20
[1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
FALSE FALSE FALSE FALSE FALSE
[17] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
FALSE FALSE FALSE FALSE FALSE
> a[a==20]<-0
> a
[1] 20.00000 20.00000 14.23756 20.00000 20.00000 20.00000 16.30921
20.00000 20.00000 20.00000
[11] 20.00000 20.00000 20.00000 20.00000 20.00000 14.85909 16.17894
20.00000 20.00000 20.00000
[21] 20.00000 27.64041 20.00000 20.00000 20.00000 20.00000 20.00000
21.98571 20.00000 20.00000
[31] 20.00000 20.00000

On Wed, Apr 6, 2022 at 12:16 PM Jim Lemon <drjimlemon at gmail.com> wrote:
>
> Hi Ani,
> It seems to work for me:
>
>  a<-c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 16.3092078677214,
> 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298,
> 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444,
> 20, 20, 20, 20)
> > a==20
> [1]  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
> [13]  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE
> [25]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE
> > a[a==20]<-0
> > a
> [1]  0.00000  0.00000 14.23756 20.00000  0.00000  0.00000 16.30921  0.00000
> [9]  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000 14.85909
> [17] 16.17894  0.00000  0.00000  0.00000  0.00000 27.64041  0.00000  0.00000
> [25]  0.00000  0.00000  0.00000 21.98571  0.00000  0.00000  0.00000  0.00000
>
> Notice that it didn't make 19.99999999999999 equal to 20, but did
> round it up when printing the result. How do you know that it failed?
>
> Jim
>
> On Wed, Apr 6, 2022 at 12:48 PM ani jaya <gaaauul at gmail.com> wrote:
> >
> > Dear R-Help,
> >
> > I try to change a specific value here by following these:
> >
> > https://www.journaldev.com/39695/replace-in-r
> > https://stackoverflow.com/questions/5824173/replace-a-value-in-a-data-frame-based-on-a-conditional-if-statement
> > https://stackoverflow.com/questions/54615462/how-to-replace-certain-values-in-a-specific-rows-and-columns-with-na-in-r
> > ..and many more
> >
> > however, it is not change anything. I believe it "should" be easy but
> > I think I am missing something. I am afraid it is my system that has a
> > problem but restarting r is not solve the problem.
> > I just want to change 20 to 0 in my data.
> >
> > > dput(a)
> > c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 16.3092078677214,
> > 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298,
> > 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444,
> > 20, 20, 20, 20)
> >
> > what I did:
> > a[a==20]<-0 #fail
> > a<-replace(a,a==20,0) #fail
> > a[which(a==20)]<-0 #fail
> >
> > > sessionInfo()
> > R version 4.1.2 (2021-11-01)
> > Platform: x86_64-w64-mingw32/x64 (64-bit)
> > Running under: Windows 10 x64 (build 19043)
> >
> > Matrix products: default
> >
> > locale:
> > [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252
> > [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
> > [5] LC_TIME=English_United States.1252
> > system code page: 949
> >
> > Best,
> > Ani
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.


From drj|m|emon @end|ng |rom gm@||@com  Wed Apr  6 06:25:56 2022
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Wed, 6 Apr 2022 14:25:56 +1000
Subject: [R] replacing a value
In-Reply-To: <CAHXS41zww6=dXdZ3+KybCVfxioxu1p2JiB8R1znnjNQ1_cpsKA@mail.gmail.com>
References: <CAHXS41wDnqaCAO2vvtsww68u60dK4aYP-8n5ZejKsQhffLrwJQ@mail.gmail.com>
 <CA+8X3fUcunq4+o9iW8Q7Qaazd0NRs-qEk1KhBVJKGGCB4ByAPA@mail.gmail.com>
 <CAHXS41zww6=dXdZ3+KybCVfxioxu1p2JiB8R1znnjNQ1_cpsKA@mail.gmail.com>
Message-ID: <CA+8X3fXMLQ06GdmQkjOxFA6OnR6L72+XxAQ271CytEFE5Z39jQ@mail.gmail.com>

Hi Ani,
Yes, there is something about the way your system is calculating
equality that is different from mine:

DELL Latitude laptop
Fedora 35 LINUX
R-4.1.3

Jim


On Wed, Apr 6, 2022 at 2:18 PM ani jaya <gaaauul at gmail.com> wrote:
>
> Hello Jim,
>
> Thank you for the try. I am following your step and still have the problem.
> But I know for sure now that my R/system is somewhat "broken" or I do
> not know for sure.
>
> > a
> [1] 20.00000 20.00000 14.23756 20.00000 20.00000 20.00000 16.30921
> 20.00000 20.00000 20.00000
> [11] 20.00000 20.00000 20.00000 20.00000 20.00000 14.85909 16.17894
> 20.00000 20.00000 20.00000
> [21] 20.00000 27.64041 20.00000 20.00000 20.00000 20.00000 20.00000
> 21.98571 20.00000 20.00000
> [31] 20.00000 20.00000
> > a==20
> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
> FALSE FALSE FALSE FALSE FALSE
> [17] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
> FALSE FALSE FALSE FALSE FALSE
> > a[a==20]<-0
> > a
> [1] 20.00000 20.00000 14.23756 20.00000 20.00000 20.00000 16.30921
> 20.00000 20.00000 20.00000
> [11] 20.00000 20.00000 20.00000 20.00000 20.00000 14.85909 16.17894
> 20.00000 20.00000 20.00000
> [21] 20.00000 27.64041 20.00000 20.00000 20.00000 20.00000 20.00000
> 21.98571 20.00000 20.00000
> [31] 20.00000 20.00000
>
> On Wed, Apr 6, 2022 at 12:16 PM Jim Lemon <drjimlemon at gmail.com> wrote:
> >
> > Hi Ani,
> > It seems to work for me:
> >
> >  a<-c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 16.3092078677214,
> > 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298,
> > 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444,
> > 20, 20, 20, 20)
> > > a==20
> > [1]  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
> > [13]  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE
> > [25]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE
> > > a[a==20]<-0
> > > a
> > [1]  0.00000  0.00000 14.23756 20.00000  0.00000  0.00000 16.30921  0.00000
> > [9]  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000 14.85909
> > [17] 16.17894  0.00000  0.00000  0.00000  0.00000 27.64041  0.00000  0.00000
> > [25]  0.00000  0.00000  0.00000 21.98571  0.00000  0.00000  0.00000  0.00000
> >
> > Notice that it didn't make 19.99999999999999 equal to 20, but did
> > round it up when printing the result. How do you know that it failed?
> >
> > Jim
> >
> > On Wed, Apr 6, 2022 at 12:48 PM ani jaya <gaaauul at gmail.com> wrote:
> > >
> > > Dear R-Help,
> > >
> > > I try to change a specific value here by following these:
> > >
> > > https://www.journaldev.com/39695/replace-in-r
> > > https://stackoverflow.com/questions/5824173/replace-a-value-in-a-data-frame-based-on-a-conditional-if-statement
> > > https://stackoverflow.com/questions/54615462/how-to-replace-certain-values-in-a-specific-rows-and-columns-with-na-in-r
> > > ..and many more
> > >
> > > however, it is not change anything. I believe it "should" be easy but
> > > I think I am missing something. I am afraid it is my system that has a
> > > problem but restarting r is not solve the problem.
> > > I just want to change 20 to 0 in my data.
> > >
> > > > dput(a)
> > > c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 16.3092078677214,
> > > 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298,
> > > 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444,
> > > 20, 20, 20, 20)
> > >
> > > what I did:
> > > a[a==20]<-0 #fail
> > > a<-replace(a,a==20,0) #fail
> > > a[which(a==20)]<-0 #fail
> > >
> > > > sessionInfo()
> > > R version 4.1.2 (2021-11-01)
> > > Platform: x86_64-w64-mingw32/x64 (64-bit)
> > > Running under: Windows 10 x64 (build 19043)
> > >
> > > Matrix products: default
> > >
> > > locale:
> > > [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252
> > > [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
> > > [5] LC_TIME=English_United States.1252
> > > system code page: 949
> > >
> > > Best,
> > > Ani
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed Apr  6 06:40:32 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Tue, 05 Apr 2022 21:40:32 -0700
Subject: [R] replacing a value
In-Reply-To: <CAHXS41zww6=dXdZ3+KybCVfxioxu1p2JiB8R1znnjNQ1_cpsKA@mail.gmail.com>
References: <CAHXS41wDnqaCAO2vvtsww68u60dK4aYP-8n5ZejKsQhffLrwJQ@mail.gmail.com>
 <CA+8X3fUcunq4+o9iW8Q7Qaazd0NRs-qEk1KhBVJKGGCB4ByAPA@mail.gmail.com>
 <CAHXS41zww6=dXdZ3+KybCVfxioxu1p2JiB8R1znnjNQ1_cpsKA@mail.gmail.com>
Message-ID: <193296AA-4759-4FF2-9800-D7762F1E0D2F@dcn.davis.ca.us>

I really don't think your R is broken, and I am puzzled why Jim didn't refer you to R FAQ 7.31 [1].

To cut to the chase... using == is not advised with floating point numbers, unless you know that the numbers have no fractional part. 19.9999999999999 prints as 20 given the default number of significant digits used to print numeric vectors, but that doesn't mean it _is_ 20.

is_near <- function( x, a, atol = 1e-6 ) {
  abs( x - a ) < atol
}
a[ is_near( a, 20 ) ] <- 0

Also see [2]... this is by no means unique to R.

[1] https://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-doesn_0027t-R-think-these-numbers-are-equal_003f
[2] https://0.30000000000000004.com/


On April 5, 2022 9:18:01 PM PDT, ani jaya <gaaauul at gmail.com> wrote:
>Hello Jim,
>
>Thank you for the try. I am following your step and still have the problem.
>But I know for sure now that my R/system is somewhat "broken" or I do
>not know for sure.
>
>> a
>[1] 20.00000 20.00000 14.23756 20.00000 20.00000 20.00000 16.30921
>20.00000 20.00000 20.00000
>[11] 20.00000 20.00000 20.00000 20.00000 20.00000 14.85909 16.17894
>20.00000 20.00000 20.00000
>[21] 20.00000 27.64041 20.00000 20.00000 20.00000 20.00000 20.00000
>21.98571 20.00000 20.00000
>[31] 20.00000 20.00000
>> a==20
>[1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
>FALSE FALSE FALSE FALSE FALSE
>[17] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
>FALSE FALSE FALSE FALSE FALSE
>> a[a==20]<-0
>> a
>[1] 20.00000 20.00000 14.23756 20.00000 20.00000 20.00000 16.30921
>20.00000 20.00000 20.00000
>[11] 20.00000 20.00000 20.00000 20.00000 20.00000 14.85909 16.17894
>20.00000 20.00000 20.00000
>[21] 20.00000 27.64041 20.00000 20.00000 20.00000 20.00000 20.00000
>21.98571 20.00000 20.00000
>[31] 20.00000 20.00000
>
>On Wed, Apr 6, 2022 at 12:16 PM Jim Lemon <drjimlemon at gmail.com> wrote:
>>
>> Hi Ani,
>> It seems to work for me:
>>
>>  a<-c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 16.3092078677214,
>> 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298,
>> 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444,
>> 20, 20, 20, 20)
>> > a==20
>> [1]  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
>> [13]  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE
>> [25]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE
>> > a[a==20]<-0
>> > a
>> [1]  0.00000  0.00000 14.23756 20.00000  0.00000  0.00000 16.30921  0.00000
>> [9]  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000 14.85909
>> [17] 16.17894  0.00000  0.00000  0.00000  0.00000 27.64041  0.00000  0.00000
>> [25]  0.00000  0.00000  0.00000 21.98571  0.00000  0.00000  0.00000  0.00000
>>
>> Notice that it didn't make 19.99999999999999 equal to 20, but did
>> round it up when printing the result. How do you know that it failed?
>>
>> Jim
>>
>> On Wed, Apr 6, 2022 at 12:48 PM ani jaya <gaaauul at gmail.com> wrote:
>> >
>> > Dear R-Help,
>> >
>> > I try to change a specific value here by following these:
>> >
>> > https://www.journaldev.com/39695/replace-in-r
>> > https://stackoverflow.com/questions/5824173/replace-a-value-in-a-data-frame-based-on-a-conditional-if-statement
>> > https://stackoverflow.com/questions/54615462/how-to-replace-certain-values-in-a-specific-rows-and-columns-with-na-in-r
>> > ..and many more
>> >
>> > however, it is not change anything. I believe it "should" be easy but
>> > I think I am missing something. I am afraid it is my system that has a
>> > problem but restarting r is not solve the problem.
>> > I just want to change 20 to 0 in my data.
>> >
>> > > dput(a)
>> > c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 16.3092078677214,
>> > 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298,
>> > 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444,
>> > 20, 20, 20, 20)
>> >
>> > what I did:
>> > a[a==20]<-0 #fail
>> > a<-replace(a,a==20,0) #fail
>> > a[which(a==20)]<-0 #fail
>> >
>> > > sessionInfo()
>> > R version 4.1.2 (2021-11-01)
>> > Platform: x86_64-w64-mingw32/x64 (64-bit)
>> > Running under: Windows 10 x64 (build 19043)
>> >
>> > Matrix products: default
>> >
>> > locale:
>> > [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252
>> > [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>> > [5] LC_TIME=English_United States.1252
>> > system code page: 949
>> >
>> > Best,
>> > Ani
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From rmh @end|ng |rom temp|e@edu  Wed Apr  6 06:47:10 2022
From: rmh @end|ng |rom temp|e@edu (Richard M. Heiberger)
Date: Wed, 6 Apr 2022 04:47:10 +0000
Subject: [R] [External]  replacing a value
In-Reply-To: <CAHXS41zww6=dXdZ3+KybCVfxioxu1p2JiB8R1znnjNQ1_cpsKA@mail.gmail.com>
References: <CAHXS41wDnqaCAO2vvtsww68u60dK4aYP-8n5ZejKsQhffLrwJQ@mail.gmail.com>
 <CA+8X3fUcunq4+o9iW8Q7Qaazd0NRs-qEk1KhBVJKGGCB4ByAPA@mail.gmail.com>
 <CAHXS41zww6=dXdZ3+KybCVfxioxu1p2JiB8R1znnjNQ1_cpsKA@mail.gmail.com>
Message-ID: <CB8F388A-835D-4B24-8A26-5CAAD84F9D22@temple.edu>

I believe you are not remembering that floating point numbers are not
exactly represented in decimal.
See FAQ 7.31

Here I have rounded a[4] to 12 places before comparing to 20.
The you get the answer you are looking for.

> a <- c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 16.3092078677214,
+ 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298,
+ 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444,
+ 20, 20, 20, 20)
> a[1:6]
[1] 20.00000 20.00000 14.23756 20.00000 20.00000 20.00000
> print(a[1:6], digits=17)
[1] 20.000000000000000 20.000000000000000 14.237564602994800 19.999999999999901 20.000000000000000 20.000000000000000
> a[1:6] == 20
[1]  TRUE  TRUE FALSE FALSE  TRUE  TRUE
> a[1:6] - 20
[1]  0.000000e+00  0.000000e+00 -5.762435e+00 -9.947598e-14  0.000000e+00  0.000000e+00
> a[4] == 20
[1] FALSE
> round(a[1:6], digits=14) - 20
[1]  0.000000e+00  0.000000e+00 -5.762435e+00 -9.947598e-14  0.000000e+00  0.000000e+00
> round(a[1:6], digits=13) - 20
[1]  0.000000e+00  0.000000e+00 -5.762435e+00 -9.947598e-14  0.000000e+00  0.000000e+00
> round(a[1:6], digits=12) - 20
[1]  0.000000  0.000000 -5.762435  0.000000  0.000000  0.000000
> b <- a[1:6]
> b[round(b,digits=12) == 20] <- 0
> b
[1]  0.00000  0.00000 14.23756  0.00000  0.00000  0.00000
> 

> On Apr 06, 2022, at 00:18, ani jaya <gaaauul at gmail.com> wrote:
> 
>>> c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 16.3092078677214,
>>> 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298,
>>> 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444,
>>> 20, 20, 20, 20)


From g@@@uu| @end|ng |rom gm@||@com  Wed Apr  6 06:58:27 2022
From: g@@@uu| @end|ng |rom gm@||@com (ani jaya)
Date: Wed, 6 Apr 2022 13:58:27 +0900
Subject: [R] [External]  replacing a value
In-Reply-To: <CB8F388A-835D-4B24-8A26-5CAAD84F9D22@temple.edu>
References: <CAHXS41wDnqaCAO2vvtsww68u60dK4aYP-8n5ZejKsQhffLrwJQ@mail.gmail.com>
 <CA+8X3fUcunq4+o9iW8Q7Qaazd0NRs-qEk1KhBVJKGGCB4ByAPA@mail.gmail.com>
 <CAHXS41zww6=dXdZ3+KybCVfxioxu1p2JiB8R1znnjNQ1_cpsKA@mail.gmail.com>
 <CB8F388A-835D-4B24-8A26-5CAAD84F9D22@temple.edu>
Message-ID: <CAHXS41ykCu+eHhJu13HuF9NaBYnv8UUX5M-U0Kh8X8tnOAST9A@mail.gmail.com>

Dear All,

I will remain sipping the seawater until it changes its taste if this
community does not exist.
Thank you.

> print(a,digit=18)
[1] 19.999999999999982 19.999999999999982 14.237564602994826
19.999999999999940 19.999999999999982
[6] 19.999999999999982 16.309207867721351 19.999999999999982
19.999999999999982 19.999999999999982
[11] 19.999999999999982 19.999999999999982 19.999999999999982
19.999999999999982 19.999999999999982
[16] 14.859093240879485 16.178935255298033 19.999999999999982
19.999999999999982 20.000000000000028
[21] 19.999999999999982 27.640407788607870 19.999999999999982
19.999999999999982 19.999999999999982
[26] 19.999999999999982 19.999999999999982 21.985706303744429
19.999999999999982 19.999999999999982
[31] 20.000000000000028 19.999999999999982


Best,
Ani

On Wed, Apr 6, 2022 at 1:47 PM Richard M. Heiberger <rmh at temple.edu> wrote:
>
> I believe you are not remembering that floating point numbers are not
> exactly represented in decimal.
> See FAQ 7.31
>
> Here I have rounded a[4] to 12 places before comparing to 20.
> The you get the answer you are looking for.
>
> > a <- c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 16.3092078677214,
> + 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298,
> + 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444,
> + 20, 20, 20, 20)
> > a[1:6]
> [1] 20.00000 20.00000 14.23756 20.00000 20.00000 20.00000
> > print(a[1:6], digits=17)
> [1] 20.000000000000000 20.000000000000000 14.237564602994800 19.999999999999901 20.000000000000000 20.000000000000000
> > a[1:6] == 20
> [1]  TRUE  TRUE FALSE FALSE  TRUE  TRUE
> > a[1:6] - 20
> [1]  0.000000e+00  0.000000e+00 -5.762435e+00 -9.947598e-14  0.000000e+00  0.000000e+00
> > a[4] == 20
> [1] FALSE
> > round(a[1:6], digits=14) - 20
> [1]  0.000000e+00  0.000000e+00 -5.762435e+00 -9.947598e-14  0.000000e+00  0.000000e+00
> > round(a[1:6], digits=13) - 20
> [1]  0.000000e+00  0.000000e+00 -5.762435e+00 -9.947598e-14  0.000000e+00  0.000000e+00
> > round(a[1:6], digits=12) - 20
> [1]  0.000000  0.000000 -5.762435  0.000000  0.000000  0.000000
> > b <- a[1:6]
> > b[round(b,digits=12) == 20] <- 0
> > b
> [1]  0.00000  0.00000 14.23756  0.00000  0.00000  0.00000
> >
>
> > On Apr 06, 2022, at 00:18, ani jaya <gaaauul at gmail.com> wrote:
> >
> >>> c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 16.3092078677214,
> >>> 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298,
> >>> 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444,
> >>> 20, 20, 20, 20)
>


From ch|n|he @end|ng |rom y@hoo@com  Wed Apr  6 03:59:40 2022
From: ch|n|he @end|ng |rom y@hoo@com (ihejirika christopher)
Date: Tue, 5 Apr 2022 21:59:40 -0400
Subject: [R] I need help with this
Message-ID: <447942194.44043.1649210382798@yahoo.com>

install.packages("titanic")
library(titanic)

training_set <- titanic_train#Saves the train set as a variable so that we do not affect the original data
testing_set <- titanic_test #Saves the test set as a variable so that we do not affect the original data
names(training_set) #Prints the name of each catergory

Sent from Mail for Windows


	[[alternative HTML version deleted]]


From k|mmo@e|o @end|ng |rom utu@||  Wed Apr  6 09:06:39 2022
From: k|mmo@e|o @end|ng |rom utu@|| (Kimmo Elo)
Date: Wed, 6 Apr 2022 07:06:39 +0000
Subject: [R] I need help with this
In-Reply-To: <447942194.44043.1649210382798@yahoo.com>
References: <447942194.44043.1649210382798@yahoo.com>
Message-ID: <d53b5d556b9f8c6e198ed7fe631ea1b80b2fb789.camel@utu.fi>

Hi!

No question. No idea, what you want to achieve. So do not be surprised
that we cannot give you any help.

Kimmo

ti, 2022-04-05 kello 21:59 -0400, ihejirika christopher via R-help
kirjoitti:
> install.packages("titanic")
> library(titanic)
> 
> training_set <- titanic_train#Saves the train set as a variable so
> that we do not affect the original data
> testing_set <- titanic_test #Saves the test set as a variable so that
> we do not affect the original data
> names(training_set) #Prints the name of each catergory
> 
> Sent from Mail for Windows
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

From tebert @end|ng |rom u||@edu  Wed Apr  6 14:30:21 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Wed, 6 Apr 2022 12:30:21 +0000
Subject: [R] replacing a value
In-Reply-To: <CAHXS41zww6=dXdZ3+KybCVfxioxu1p2JiB8R1znnjNQ1_cpsKA@mail.gmail.com>
References: <CAHXS41wDnqaCAO2vvtsww68u60dK4aYP-8n5ZejKsQhffLrwJQ@mail.gmail.com>
 <CA+8X3fUcunq4+o9iW8Q7Qaazd0NRs-qEk1KhBVJKGGCB4ByAPA@mail.gmail.com>
 <CAHXS41zww6=dXdZ3+KybCVfxioxu1p2JiB8R1znnjNQ1_cpsKA@mail.gmail.com>
Message-ID: <BN6PR2201MB1553BC1C26916DA7E7C43FBECFE79@BN6PR2201MB1553.namprd22.prod.outlook.com>

Excellent.
So Ani's answer to a==20 is different than Jim's answer. Jim's answer has some TRUE and some FALSE while Ani's answer is all FALSE. 
I get Jim's answer.

That is the problem, but I don't know how to solve it.
What is str(a)?
Are there any error messages?
What if you close R and restart? Just to be complete, try turning the power off on your computer and restarting the entire system.

Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of ani jaya
Sent: Wednesday, April 6, 2022 12:18 AM
To: Jim Lemon <drjimlemon at gmail.com>
Cc: r-help <r-help at r-project.org>
Subject: Re: [R] replacing a value

[External Email]

Hello Jim,

Thank you for the try. I am following your step and still have the problem.
But I know for sure now that my R/system is somewhat "broken" or I do not know for sure.

> a
[1] 20.00000 20.00000 14.23756 20.00000 20.00000 20.00000 16.30921
20.00000 20.00000 20.00000
[11] 20.00000 20.00000 20.00000 20.00000 20.00000 14.85909 16.17894
20.00000 20.00000 20.00000
[21] 20.00000 27.64041 20.00000 20.00000 20.00000 20.00000 20.00000
21.98571 20.00000 20.00000
[31] 20.00000 20.00000
> a==20
[1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE [17] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
> a[a==20]<-0
> a
[1] 20.00000 20.00000 14.23756 20.00000 20.00000 20.00000 16.30921
20.00000 20.00000 20.00000
[11] 20.00000 20.00000 20.00000 20.00000 20.00000 14.85909 16.17894
20.00000 20.00000 20.00000
[21] 20.00000 27.64041 20.00000 20.00000 20.00000 20.00000 20.00000
21.98571 20.00000 20.00000
[31] 20.00000 20.00000

On Wed, Apr 6, 2022 at 12:16 PM Jim Lemon <drjimlemon at gmail.com> wrote:
>
> Hi Ani,
> It seems to work for me:
>
>  a<-c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 
> 16.3092078677214, 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 
> 16.178935255298, 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 
> 21.9857063037444, 20, 20, 20, 20)
> > a==20
> [1]  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  
> TRUE [13]  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE  
> TRUE  TRUE [25]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE
> > a[a==20]<-0
> > a
> [1]  0.00000  0.00000 14.23756 20.00000  0.00000  0.00000 16.30921  
> 0.00000 [9]  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  
> 0.00000 14.85909 [17] 16.17894  0.00000  0.00000  0.00000  0.00000 
> 27.64041  0.00000  0.00000 [25]  0.00000  0.00000  0.00000 21.98571  
> 0.00000  0.00000  0.00000  0.00000
>
> Notice that it didn't make 19.99999999999999 equal to 20, but did 
> round it up when printing the result. How do you know that it failed?
>
> Jim
>
> On Wed, Apr 6, 2022 at 12:48 PM ani jaya <gaaauul at gmail.com> wrote:
> >
> > Dear R-Help,
> >
> > I try to change a specific value here by following these:
> >
> > https://urldefense.proofpoint.com/v2/url?u=https-3A__www.journaldev.
> > com_39695_replace-2Din-2Dr&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQ
> > h2kVeAsRzsn7AkP-g&m=TACLY8J-wKY5Wmh5GANOzGxKC-MKX-FtV6O1IhiR_evXimgt
> > xfQs8N6uI_OjKech&s=JHdEmtV2QpU0x5tkgSoD4ioUdH1s_YEFqBPMtjP2aXY&e=
> > https://urldefense.proofpoint.com/v2/url?u=https-3A__stackoverflow.c
> > om_questions_5824173_replace-2Da-2Dvalue-2Din-2Da-2Ddata-2Dframe-2Db
> > ased-2Don-2Da-2Dconditional-2Dif-2Dstatement&d=DwICAg&c=sJ6xIWYx-zLM
> > B3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=TACLY8J-wKY5Wmh5GANOzGxKC-MKX-
> > FtV6O1IhiR_evXimgtxfQs8N6uI_OjKech&s=Ret9j4R6Dg4DjrSq1DKCJcVkJx5D0fj
> > zUgUb6NjvrBE&e= 
> > https://urldefense.proofpoint.com/v2/url?u=https-3A__stackoverflow.c
> > om_questions_54615462_how-2Dto-2Dreplace-2Dcertain-2Dvalues-2Din-2Da
> > -2Dspecific-2Drows-2Dand-2Dcolumns-2Dwith-2Dna-2Din-2Dr&d=DwICAg&c=s
> > J6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=TACLY8J-wKY5Wmh5GAN
> > OzGxKC-MKX-FtV6O1IhiR_evXimgtxfQs8N6uI_OjKech&s=KW2vnxswrucdFsa3bWaB
> > faOQg-JXPhqYouEuONN-GqM&e=
> > ..and many more
> >
> > however, it is not change anything. I believe it "should" be easy 
> > but I think I am missing something. I am afraid it is my system that 
> > has a problem but restarting r is not solve the problem.
> > I just want to change 20 to 0 in my data.
> >
> > > dput(a)
> > c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 
> > 16.3092078677214, 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 
> > 16.178935255298, 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 
> > 20, 21.9857063037444, 20, 20, 20, 20)
> >
> > what I did:
> > a[a==20]<-0 #fail
> > a<-replace(a,a==20,0) #fail
> > a[which(a==20)]<-0 #fail
> >
> > > sessionInfo()
> > R version 4.1.2 (2021-11-01)
> > Platform: x86_64-w64-mingw32/x64 (64-bit) Running under: Windows 10 
> > x64 (build 19043)
> >
> > Matrix products: default
> >
> > locale:
> > [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United 
> > States.1252 [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C 
> > [5] LC_TIME=English_United States.1252 system code page: 949
> >
> > Best,
> > Ani
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> > https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_ma
> > ilman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2k
> > VeAsRzsn7AkP-g&m=TACLY8J-wKY5Wmh5GANOzGxKC-MKX-FtV6O1IhiR_evXimgtxfQ
> > s8N6uI_OjKech&s=d3cMYTtmc68ekAgzW4KSEq4vJ5NbfzxlNi5yLvWIgK0&e=
> > PLEASE do read the posting guide 
> > https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.
> > org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2
> > kVeAsRzsn7AkP-g&m=TACLY8J-wKY5Wmh5GANOzGxKC-MKX-FtV6O1IhiR_evXimgtxf
> > Qs8N6uI_OjKech&s=ZD6N8cPoUe4KKw4XqS0wC1YvfUzA_EnM0cZ3CYfr4GI&e=
> > and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=TACLY8J-wKY5Wmh5GANOzGxKC-MKX-FtV6O1IhiR_evXimgtxfQs8N6uI_OjKech&s=d3cMYTtmc68ekAgzW4KSEq4vJ5NbfzxlNi5yLvWIgK0&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=TACLY8J-wKY5Wmh5GANOzGxKC-MKX-FtV6O1IhiR_evXimgtxfQs8N6uI_OjKech&s=ZD6N8cPoUe4KKw4XqS0wC1YvfUzA_EnM0cZ3CYfr4GI&e=
and provide commented, minimal, self-contained, reproducible code.


From tebert @end|ng |rom u||@edu  Wed Apr  6 14:44:57 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Wed, 6 Apr 2022 12:44:57 +0000
Subject: [R] [External]  replacing a value
In-Reply-To: <CAHXS41ykCu+eHhJu13HuF9NaBYnv8UUX5M-U0Kh8X8tnOAST9A@mail.gmail.com>
References: <CAHXS41wDnqaCAO2vvtsww68u60dK4aYP-8n5ZejKsQhffLrwJQ@mail.gmail.com>
 <CA+8X3fUcunq4+o9iW8Q7Qaazd0NRs-qEk1KhBVJKGGCB4ByAPA@mail.gmail.com>
 <CAHXS41zww6=dXdZ3+KybCVfxioxu1p2JiB8R1znnjNQ1_cpsKA@mail.gmail.com>
 <CB8F388A-835D-4B24-8A26-5CAAD84F9D22@temple.edu>
 <CAHXS41ykCu+eHhJu13HuF9NaBYnv8UUX5M-U0Kh8X8tnOAST9A@mail.gmail.com>
Message-ID: <DM5PR2201MB1564F1E244A751E81108BD89CFE79@DM5PR2201MB1564.namprd22.prod.outlook.com>

But if I type a==b, all I get is TRUE. Is this behavior somewhat system dependent?

a <- c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 16.3092078677214, 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298, 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444, 20, 20, 20, 20)
b <- c(19.999999999999982, 19.999999999999982, 14.237564602994826,
      19.999999999999940, 19.999999999999982,
      19.999999999999982, 16.309207867721351, 19.999999999999982,
      19.999999999999982, 19.999999999999982,
      19.999999999999982, 19.999999999999982, 19.999999999999982,
      19.999999999999982, 19.999999999999982,
      14.859093240879485, 16.178935255298033, 19.999999999999982,
      19.999999999999982, 20.000000000000028,
      19.999999999999982, 27.640407788607870, 19.999999999999982,
      19.999999999999982, 19.999999999999982,
      19.999999999999982, 19.999999999999982, 21.985706303744429,
      19.999999999999982, 19.999999999999982,
      20.000000000000028, 19.999999999999982)
a==b


Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of ani jaya
Sent: Wednesday, April 6, 2022 12:58 AM
To: Richard M. Heiberger <rmh at temple.edu>; Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
Cc: r-help <r-help at r-project.org>
Subject: Re: [R] [External] replacing a value

[External Email]

Dear All,

I will remain sipping the seawater until it changes its taste if this community does not exist.
Thank you.

> print(a,digit=18)
[1] 19.999999999999982 19.999999999999982 14.237564602994826
19.999999999999940 19.999999999999982
[6] 19.999999999999982 16.309207867721351 19.999999999999982
19.999999999999982 19.999999999999982
[11] 19.999999999999982 19.999999999999982 19.999999999999982
19.999999999999982 19.999999999999982
[16] 14.859093240879485 16.178935255298033 19.999999999999982
19.999999999999982 20.000000000000028
[21] 19.999999999999982 27.640407788607870 19.999999999999982
19.999999999999982 19.999999999999982
[26] 19.999999999999982 19.999999999999982 21.985706303744429
19.999999999999982 19.999999999999982
[31] 20.000000000000028 19.999999999999982


Best,
Ani

On Wed, Apr 6, 2022 at 1:47 PM Richard M. Heiberger <rmh at temple.edu> wrote:
>
> I believe you are not remembering that floating point numbers are not 
> exactly represented in decimal.
> See FAQ 7.31
>
> Here I have rounded a[4] to 12 places before comparing to 20.
> The you get the answer you are looking for.
>
> > a <- c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 
> > 16.3092078677214,
> + 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298, 
> + 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 
> + 21.9857063037444, 20, 20, 20, 20)
> > a[1:6]
> [1] 20.00000 20.00000 14.23756 20.00000 20.00000 20.00000
> > print(a[1:6], digits=17)
> [1] 20.000000000000000 20.000000000000000 14.237564602994800 
> 19.999999999999901 20.000000000000000 20.000000000000000
> > a[1:6] == 20
> [1]  TRUE  TRUE FALSE FALSE  TRUE  TRUE
> > a[1:6] - 20
> [1]  0.000000e+00  0.000000e+00 -5.762435e+00 -9.947598e-14  
> 0.000000e+00  0.000000e+00
> > a[4] == 20
> [1] FALSE
> > round(a[1:6], digits=14) - 20
> [1]  0.000000e+00  0.000000e+00 -5.762435e+00 -9.947598e-14  
> 0.000000e+00  0.000000e+00
> > round(a[1:6], digits=13) - 20
> [1]  0.000000e+00  0.000000e+00 -5.762435e+00 -9.947598e-14  
> 0.000000e+00  0.000000e+00
> > round(a[1:6], digits=12) - 20
> [1]  0.000000  0.000000 -5.762435  0.000000  0.000000  0.000000
> > b <- a[1:6]
> > b[round(b,digits=12) == 20] <- 0
> > b
> [1]  0.00000  0.00000 14.23756  0.00000  0.00000  0.00000
> >
>
> > On Apr 06, 2022, at 00:18, ani jaya <gaaauul at gmail.com> wrote:
> >
> >>> c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 
> >>> 16.3092078677214, 20, 20, 20, 20, 20, 20, 20, 20, 
> >>> 14.8590932408795, 16.178935255298, 20, 20, 20, 20, 
> >>> 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444, 20, 20, 
> >>> 20, 20)
>

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=A4GRP2o-ZyuqJvgr9XsPfuhujKPAAdoUZhMkJ0fR1UAVnUMRFNJmIaHS7V1aotNE&s=fuF4ytG9jvStgygMp00bmdHVcovgKvbojK3bSFVJ6-E&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=A4GRP2o-ZyuqJvgr9XsPfuhujKPAAdoUZhMkJ0fR1UAVnUMRFNJmIaHS7V1aotNE&s=y6027ELiLvmRy2xbH_A8sxKnEIsXNvUOwv7934md2tA&e=
and provide commented, minimal, self-contained, reproducible code.


From w||||@mwdun|@p @end|ng |rom gm@||@com  Wed Apr  6 17:03:38 2022
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Wed, 6 Apr 2022 08:03:38 -0700
Subject: [R] replacing a value
In-Reply-To: <CAHXS41wDnqaCAO2vvtsww68u60dK4aYP-8n5ZejKsQhffLrwJQ@mail.gmail.com>
References: <CAHXS41wDnqaCAO2vvtsww68u60dK4aYP-8n5ZejKsQhffLrwJQ@mail.gmail.com>
Message-ID: <CAHqSRuQ=A3e5mhKSbBfvj2f-=MFOnihJ4H8q6Y-bHB_+2-cTvg@mail.gmail.com>

The confusion comes from dput() not distinguishing between numbers that are
quite close to each other.  E.g.,

> x <- 20 - (0:12)*.Machine$double.eps
> x == 20
 [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE
FALSE FALSE
> diff(x)
 [1]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
 0.000000e+00
 [7]  0.000000e+00  0.000000e+00 -3.552714e-15  0.000000e+00  0.000000e+00
 0.000000e+00
>
> dput(x)
c(20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20)

You have to use dput's control="digits17" or "exact" to avoid this rounding:

> dput(x, control="digits17")
c(20, 20, 20, 20, 20, 20, 20, 20, 20, 19.999999999999996,
19.999999999999996,
19.999999999999996, 19.999999999999996)
> dput(x, control="exact")
c(0x1.4p+4, 0x1.4p+4, 0x1.4p+4, 0x1.4p+4, 0x1.4p+4, 0x1.4p+4,
0x1.4p+4, 0x1.4p+4, 0x1.4p+4, 0x1.3ffffffffffffp+4, 0x1.3ffffffffffffp+4,
0x1.3ffffffffffffp+4, 0x1.3ffffffffffffp+4)

The solution to your original problem is to specify a small range of values
around 20
that you wish to change to zero.  E.g.,
  a[ abs(a-20) < 20*.Machine$double.eps ] <- 0

-Bill

On Tue, Apr 5, 2022 at 7:48 PM ani jaya <gaaauul at gmail.com> wrote:

> Dear R-Help,
>
> I try to change a specific value here by following these:
>
> https://www.journaldev.com/39695/replace-in-r
>
> https://stackoverflow.com/questions/5824173/replace-a-value-in-a-data-frame-based-on-a-conditional-if-statement
>
> https://stackoverflow.com/questions/54615462/how-to-replace-certain-values-in-a-specific-rows-and-columns-with-na-in-r
> ..and many more
>
> however, it is not change anything. I believe it "should" be easy but
> I think I am missing something. I am afraid it is my system that has a
> problem but restarting r is not solve the problem.
> I just want to change 20 to 0 in my data.
>
> > dput(a)
> c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 16.3092078677214,
> 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298,
> 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444,
> 20, 20, 20, 20)
>
> what I did:
> a[a==20]<-0 #fail
> a<-replace(a,a==20,0) #fail
> a[which(a==20)]<-0 #fail
>
> > sessionInfo()
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 10 x64 (build 19043)
>
> Matrix products: default
>
> locale:
> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
> States.1252
> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
> system code page: 949
>
> Best,
> Ani
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From c@deb @end|ng |rom u@g@@gov  Wed Apr  6 17:19:02 2022
From: c@deb @end|ng |rom u@g@@gov (Cade, Brian S)
Date: Wed, 6 Apr 2022 15:19:02 +0000
Subject: [R] [EXTERNAL] Re:  complicated time series filtering issue
In-Reply-To: <b1ec9d52cddc4303ca54bd4e9d5c4a81c84bcce4.camel@utu.fi>
References: <SA1PR09MB753614942CE63B4AE4E8081FD9E59@SA1PR09MB7536.namprd09.prod.outlook.com>
 <CAGxFJbSSw-EuZWAaV0k1Jor-PBazXkvV4xkbr8MJjUouE7=6yQ@mail.gmail.com>
 <BN6PR2201MB15530C88E480EF8AF047E0A5CFE59@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CA+8X3fU5gbKcMfsTPOA8AG8V_iD9-JSPMsWxFqntp+3CakdYtQ@mail.gmail.com>
 <CAGgJW77MyQghKJJnAtaxbrO-up+52K--BLnsGCxdTGTt=U8f9g@mail.gmail.com>
 <b1ec9d52cddc4303ca54bd4e9d5c4a81c84bcce4.camel@utu.fi>
Message-ID: <SA1PR09MB7536448A660860AD1481E9E4D9E79@SA1PR09MB7536.namprd09.prod.outlook.com>

Modifying the code from Kimmo slightly and embedding this in a looping process across individual organisms, here is script I ended up developing that does what I want .  I am sure there may be some more elegant solution but this worked.  Thank you all for the various suggestions.

Brian

?### To get prior dates and lengths by INDIVIDUAL with intervals between
### dates >10 days.
### Data set has dates in days as DATENUMBER, for INDIVIDUAL organisms,
### and lengths measured on those dates.

library(data.table)

master.data.dt <- data.table(master.data)

### Calculate intervals between dates by individual

master.data.lag <- master.data.dt[, DATENUMBER.prev:=c(NA, DATENUMBER[-.N]), by=INDIVIDUAL]

master.data.lag$interval <- master.data.lag$DATENUMBER - master.data.lag$DATENUMBER.prev

### to have a dummy dataframe row to rbind to.

master.data.newlag <- master.data.lag[1,]

### Begin looping across individuals, intervals set to be >=11 days

individlist <- names(table(master.data.lag$INDIVIDUAL))

for (i in seq(individlist)){
  temp.df <- master.data.lag[master.data.lag $INDIVIDUAL==individlist[i],]

j<-1
while (j<nrow(temp.df)) {
    if (temp.df$DATENUMBER[j+1]-temp.df$DATENUMBER[j]<11) {
        temp.df<-temp.df[-(j+1),]
    } else {
        temp.df$interval[j+1]<-temp.df$DATENUMBER[j+1]-temp.df$DATENUMBER[j]
        j<-j+1
    }
}
master.data.newlag <- rbind(master.data.newlag,temp.df)
}

### to eliminate the first dummy row created above

master.data.newlag <- master.data.newlag[-1,]

### to get lagged lengths and dates with the new intervals >10

master.data.newlag <- master.data.newlag[, length.prev:=c(NA, length[-.N]), by=INDIVIDUAL]

master.data.newlag <- master.data.newlag[, DATENUMBER.prev:=c(NA, DATENUMBER[-.N]), by=INDIVIDUAL]



Brian S. Cade, PhD

U. S. Geological Survey
Fort Collins Science Center
2150 Centre Ave., Bldg. C
Fort Collins, CO  80526-8818

email:  cadeb at usgs.gov<mailto:brian_cade at usgs.gov>
tel:  970 226-9326

________________________________
From: R-help <r-help-bounces at r-project.org> on behalf of Kimmo Elo <kimmo.elo at utu.fi>
Sent: Tuesday, April 5, 2022 7:06 AM
To: r-help at r-project.org <r-help at r-project.org>
Subject: [EXTERNAL] Re: [R] complicated time series filtering issue



 This email has been received from outside of DOI - Use caution before clicking on links, opening attachments, or responding.



Hi!

Here is an alternative solution using DATENUMBER:

i<-2
while (i<nrow(bc.df)) {
    if (bc.df$DATENUMBER[i]-bc.df$DATENUMBER[i-1]<=11) {
        bc.df<-bc.df[-i,]
    } else {
        bc.df$interval[i]<-bc.df$DATENUMBER[i]-bc.df$DATENUMBER[i-1]
        i<-i+1
    }
}

Best,
Kimmo

ti, 2022-04-05 kello 15:36 +0300, Eric Berger kirjoitti:
> For a different approach, use the Date column rather than the
> differences
> column.
> I assume the data has been put into the bc.df data frame (as Jim
> does,
> above)
>
> f <- function(v,m=10L) {
>   w <- 1L
>   while( (i <- tail(w,1)) < length(v))
>     w <- c(w, match(TRUE,v[i:(i+m+1)] > v[i]+m )+(i-1))
>   w
> }
> f(as.integer(as.Date(strptime(bc.df$Date,"%d-%b-%y"))))
>
>
>
> On Tue, Apr 5, 2022 at 1:16 AM Jim Lemon <drjimlemon at gmail.com>
> wrote:
>
> > Hi Brian,
> > Perhaps this:
> >
> > bc.df<-read.table(text="Date   INDIVIDUAL DATENUMBER LENGTH
> > length.prev
> > interval
> > 12-May-04 57084544        133         682.4           NA       NA
> > 28-Sep-04 57084544        272         724.8        682.4      139
> > 30-Sep-04 57084544        274         740.8        724.8        2
> > 7-Oct-04 57084544        281         745.4        740.8        7
> > 22-Nov-04 57084544        327         780.2        745.4       46
> > 27-Jan-05 57084544        393         817.2        780.2       66
> > 8-Mar-05 57084544        433         834.1        817.2       40
> > 2-Jul-05 57084544        549         876.3        834.1      116
> > 6-Jul-05 57084544        553         871.5        876.3        4
> > 4-Aug-05 57084544        582         887.5        871.5       29
> > 28-Dec-05 57084544        728         921.8        887.5      146
> > 31-Jan-06 57084544        762         936.8        921.8       34
> > 27-Feb-06 57084544        789         962.4        936.8       27
> > 21-Nov-06 57084544       1056         972.3        962.4      267
> > 30-Mar-07 57084544       1185        1007.2        972.3      129
> > 23-Apr-07 57084544       1209        1009.1       1007.2       24
> > 22-May-07 57084544       1238         991.6       1009.1       29
> > 23-May-07 57084544       1239        1015.9        991.6        1
> > 16-Jul-07 57084544       1293        1006.5       1015.9       54
> > 9-Aug-07 57084544       1317        1013.0       1006.5       24
> > 27-Aug-07 57084544       1335        1013.0       1013.0       18
> > 29-Jul-08 57084544       1672        1021.5       1013.0      337
> > 30-Jul-08 57084544       1673         984.3       1021.5        1
> > 31-Jul-08 57084544       1674        1008.5        984.3        1
> > 10-Aug-08 57084544       1684        1002.8       1008.5       10
> > 22-Oct-08 57084544       1757         977.6       1002.8       73
> > 2-Dec-08 57084544       1798        1000.6        977.6       41",
> > stringsAsFactors=FALSE,header=TRUE)
> > min_interval<-function(x,minint=10) {
> >  indx<-1
> >  cumint<-0
> >  for(i in 2:length(x)) {
> >   cumint<-cumint+x[i]
> >   if(cumint > minint) {
> >    indx<-c(indx,i)
> >    cumint<-0
> >   }
> >  }
> >  return(indx)
> > }
> > min_interval(bc.df$interval)
> >
> > Jim
> >
> > On Tue, Apr 5, 2022 at 7:31 AM Ebert,Timothy Aaron <tebert at ufl.edu>
> > wrote:
> > > I think the idea is more
> > > for (i in 2:nrow(x)){
> > > ifelse(x[i]-x[i-1] >10) {keep x[i], delete x[i]]
> > > }
> > >
> > > I am not quite clear on the correct code for "keep" or "delete."
> > >
> > > One could try
> > > for (i in 2:nrow(x)){
> > > x$new[i] <- x[i]-x[i-1]
> > > }
> > > x <- x %>% filter(new>=10)
> > >
> > > This only works if consecutive sample dates are 10 or more days
> > > apart.
> > You could add an else if that would accumulate days, and if
> > successful
> > reset the clock.
> > > Tim
> > > -----Original Message-----
> > > From: R-help <r-help-bounces at r-project.org> On Behalf Of Bert
> > > Gunter
> > > Sent: Monday, April 4, 2022 5:04 PM
> > > To: Cade, Brian S <cadeb at usgs.gov>
> > > Cc: r-help at r-project.org
> > > Subject: Re: [R] complicated time series filtering issue
> > >
> > > [External Email]
> > >
> > > Like this?
> > >
> > > winnow <- function(x, int=5){
> > >    keep <- x[1]
> > >    remaining <- x[-1]
> > >    while (length(remaining))
> > >    {
> > >       nxt <- tail(keep,1) + int
> > >       if(length(remaining) ==1 ||
> > >          all(remaining < nxt))break
> > >       remaining <- remaining[remaining >tail(keep,1) + int]
> > >       keep <- c(keep,remaining[1])
> > >    }
> > >    keep
> > > }
> > >
> > > > x
> > >  [1]  1  2  5  7  8  9 15 16 17 19 20 21 28 35 37 41 43 45 46 50
> > > > winnow(x,7)
> > > [1]  1  9 17 28 37 45
> > > > winnow(x,5)
> > > [1]  1  7 15 21 28 35 41 50
> > >
> > > Cheers,
> > > Bert
> > >
> > > "The trouble with having an open mind is that people keep coming
> > > along
> > and sticking things into it."
> > > -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip
> > > )
> > >
> > > On Mon, Apr 4, 2022 at 12:56 PM Cade, Brian S via R-help <
> > r-help at r-project.org> wrote:
> > > > Hello:  I have an issue with filtering in a time series of
> > > > animal
> > > > growth data that seems conceptually simple but I have not come
> > > > up with
> > > > effective code to implement this.  I have temporal sequences of
> > > > lengths by individuals and I want to retain only those data
> > > > that are
> > > > > 10 days apart sequentially within an individuals records.  I
> > > > > can
> > > > readily compute intervals between successive dates by
> > > > individual using
> > > > data.table() and its by = INDIVIDUAL functionality.  See
> > > > example data
> > > > for one individual below.  But what currently eludes me in
> > > > processing
> > > > this is how to recognize for example that deleting the 2nd and
> > > > 3rd
> > > > rows is required because the totality of their time interval is
> > > > 9
> > > > days, deleting 8th record with 4 days is required,  deleting
> > > > 17th
> > > > record with 1 day is required, deleting 22nd and 23rd records
> > > > is
> > > > required because their sum is 2 days, but we do not delete 24th
> > > > record
> > > > of 10 days because the sum of previous 2 records deleted and
> > > > this one
> > > > is now 12 days.  Each individual can have ve
> > >  ry
> > > >   different patterns of these sort of sequences.  These
> > > > sequences are
> > easy to look at and determine what needs to be done but writing
> > effective
> > code to accomplish this filtering seems to require some
> > functionality that
> > I am currently missing.
> > > > Any suggestions would be greatly appreciated.
> > > >
> > > >          Date   INDIVIDUAL DATENUMBER LENGTH length.prev
> > > > interval
> > > > 228 12-May-04
> > > > 57084544        133         682.4           NA       NA
> > > > 229 28-Sep-04
> > > > 57084544        272         724.8        682.4      139
> > > > 230 30-Sep-04
> > > > 57084544        274         740.8        724.8        2
> > > > 231  7-Oct-04
> > > > 57084544        281         745.4        740.8        7
> > > > 232 22-Nov-04
> > > > 57084544        327         780.2        745.4       46
> > > > 233 27-Jan-05
> > > > 57084544        393         817.2        780.2       66
> > > > 234  8-Mar-05
> > > > 57084544        433         834.1        817.2       40
> > > > 235  2-Jul-05
> > > > 57084544        549         876.3        834.1      116
> > > > 236  6-Jul-05
> > > > 57084544        553         871.5        876.3        4
> > > > 237  4-Aug-05
> > > > 57084544        582         887.5        871.5       29
> > > > 238 28-Dec-05
> > > > 57084544        728         921.8        887.5      146
> > > > 239 31-Jan-06
> > > > 57084544        762         936.8        921.8       34
> > > > 240 27-Feb-06
> > > > 57084544        789         962.4        936.8       27
> > > > 241 21-Nov-06
> > > > 57084544       1056         972.3        962.4      267
> > > > 242 30-Mar-07
> > > > 57084544       1185        1007.2        972.3      129
> > > > 243 23-Apr-07
> > > > 57084544       1209        1009.1       1007.2       24
> > > > 244 22-May-07
> > > > 57084544       1238         991.6       1009.1       29
> > > > 245 23-May-07
> > > > 57084544       1239        1015.9        991.6        1
> > > > 246 16-Jul-07
> > > > 57084544       1293        1006.5       1015.9       54
> > > > 247  9-Aug-07
> > > > 57084544       1317        1013.0       1006.5       24
> > > > 248 27-Aug-07
> > > > 57084544       1335        1013.0       1013.0       18
> > > > 249 29-Jul-08
> > > > 57084544       1672        1021.5       1013.0      337
> > > > 250 30-Jul-08
> > > > 57084544       1673         984.3       1021.5        1
> > > > 251 31-Jul-08
> > > > 57084544       1674        1008.5        984.3        1
> > > > 252 10-Aug-08
> > > > 57084544       1684        1002.8       1008.5       10
> > > > 253 22-Oct-08
> > > > 57084544       1757         977.6       1002.8       73
> > > > 254  2-Dec-08
> > > > 57084544       1798        1000.6        977.6       41
> > > >
> > > >
> > > >
> > > > Brian
> > > >
> > > >
> > > >
> > > > Brian S. Cade, PhD
> > > >
> > > > U. S. Geological Survey
> > > > Fort Collins Science Center
> > > > 2150 Centre Ave., Bldg. C
> > > > Fort Collins, CO  80526-8818
> > > >
> > > > email:  cadeb at usgs.gov<mailto:brian_cade at usgs.gov>
> > > > tel:  970 226-9326
> > > >
> > > >
> > > >         [[alternative HTML version deleted]]
> > > >
> > > > ______________________________________________
> > > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more,
> > > > see
> > > > https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Furldefense.proofpoint.com%2Fv2%2Furl%3Fu%3Dhttps-3A__stat.ethz.ch_mail&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=1nmGdrtMLTCKAiwFMRIQJrfNYKHzVhqXdpBMoAC9F54%3D&amp;reserved=0
> > > > man_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-
> > > > zLMB3EPkvcnVg&r=9PEhQh2kVeAs
> > > > Rzsn7AkP-
> > > > g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu
> > > > -vCEJab&s=PG1chCZY6eQzSdtSlvChVVVt0HXVDG1bgBkJMQ8wk1A&e=
> > > > PLEASE do read the posting guide
> > > > https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Furldefense.proofpoint.com%2Fv2%2Furl%3Fu%3Dhttp-3A__www.R-2Dproject.or&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=yHYWDC3bFh2Tl1SNiW6bEzF3qjfkBVQZUwhf1SQhE8U%3D&amp;reserved=0
> > > > g_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-
> > > > zLMB3EPkvcnVg&r=9PEhQh2kVeA
> > > > sRzsn7AkP-
> > > > g&m=ZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxg
> > > > u-vCEJab&s=D_bzOVjWanUgYD_zJq-IS8EObMKBmC5Q5D-a_IHxMAA&e=
> > > > and provide commented, minimal, self-contained, reproducible
> > > > code.
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Furldefense.proofpoint.com%2Fv2%2Furl%3Fu%3Dhttps-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp%26d%3DDwICAg%26c%3DsJ6xIWYx-zLMB3EPkvcnVg%26r%3D9PEhQh2kVeAsRzsn7AkP-g%26m%3DZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu-vCEJab%26s%3DPG1chCZY6eQzSdtSlvChVVVt0HXVDG1bgBkJMQ8wk1A%26e%3D&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=Nbny2p%2B45YIFmSasHb1JjtM7v98gePIAF7ixM1BjLq8%3D&amp;reserved=0
> > > PLEASE do read the posting guide
> > https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Furldefense.proofpoint.com%2Fv2%2Furl%3Fu%3Dhttp-3A__www.R-2Dproject.org_posting-2Dguide.html%26d%3DDwICAg%26c%3DsJ6xIWYx-zLMB3EPkvcnVg%26r%3D9PEhQh2kVeAsRzsn7AkP-g%26m%3DZfVdnGSALzyajo_d1U09NJs3RCXcx5NwQ2PZ9A9zwEnVYnexn4toTyxgu-vCEJab%26s%3DD_bzOVjWanUgYD_zJq-IS8EObMKBmC5Q5D-a_IHxMAA%26e%3D&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=7nyV7C8EsubHRAfi721l6QdCy%2BMYoqWJKWnd6ONhgAc%3D&amp;reserved=0
> > > and provide commented, minimal, self-contained, reproducible
> > > code.
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=DuIf9gykRJpBoiqui%2FlOgqdqB%2F0LAu1z%2B%2Bsxnfl%2BFEs%3D&amp;reserved=0
> > > PLEASE do read the posting guide
> > https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=myGg3MHNo1Iikdeaxod94fC41D6Pya2pY6CGMXFeR4A%3D&amp;reserved=0
> > > and provide commented, minimal, self-contained, reproducible
> > > code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=DuIf9gykRJpBoiqui%2FlOgqdqB%2F0LAu1z%2B%2Bsxnfl%2BFEs%3D&amp;reserved=0
> > PLEASE do read the posting guide
> > https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=myGg3MHNo1Iikdeaxod94fC41D6Pya2pY6CGMXFeR4A%3D&amp;reserved=0
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
>       [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=DuIf9gykRJpBoiqui%2FlOgqdqB%2F0LAu1z%2B%2Bsxnfl%2BFEs%3D&amp;reserved=0
> PLEASE do read the posting guide
> https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=myGg3MHNo1Iikdeaxod94fC41D6Pya2pY6CGMXFeR4A%3D&amp;reserved=0
> and provide commented, minimal, self-contained, reproducible code.
______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=DuIf9gykRJpBoiqui%2FlOgqdqB%2F0LAu1z%2B%2Bsxnfl%2BFEs%3D&amp;reserved=0
PLEASE do read the posting guide https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7Ccadeb%40usgs.gov%7Ceccbc95b43a44917bfed08da17053eec%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637847608558643674%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=myGg3MHNo1Iikdeaxod94fC41D6Pya2pY6CGMXFeR4A%3D&amp;reserved=0
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Apr  6 19:20:48 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 6 Apr 2022 18:20:48 +0100
Subject: [R] [External] replacing a value
In-Reply-To: <CAHXS41ykCu+eHhJu13HuF9NaBYnv8UUX5M-U0Kh8X8tnOAST9A@mail.gmail.com>
References: <CAHXS41wDnqaCAO2vvtsww68u60dK4aYP-8n5ZejKsQhffLrwJQ@mail.gmail.com>
 <CA+8X3fUcunq4+o9iW8Q7Qaazd0NRs-qEk1KhBVJKGGCB4ByAPA@mail.gmail.com>
 <CAHXS41zww6=dXdZ3+KybCVfxioxu1p2JiB8R1znnjNQ1_cpsKA@mail.gmail.com>
 <CB8F388A-835D-4B24-8A26-5CAAD84F9D22@temple.edu>
 <CAHXS41ykCu+eHhJu13HuF9NaBYnv8UUX5M-U0Kh8X8tnOAST9A@mail.gmail.com>
Message-ID: <eebd86ed-a77e-d1a2-7674-0c7527079575@sapo.pt>

Hello,

The problem seems to be solved, btu maybe my answer to this thread [1] 
can be of help.

Using Bill's dput'ed data


equals <- function(x, y, tol = .Machine$double.eps^0.5) abs(x - y) < tol

x <- c(0x1.4p+4, 0x1.4p+4, 0x1.4p+4, 0x1.4p+4, 0x1.4p+4, 0x1.4p+4,
        0x1.4p+4, 0x1.4p+4, 0x1.4p+4, 0x1.3ffffffffffffp+4, 
0x1.3ffffffffffffp+4,
        0x1.3ffffffffffffp+4, 0x1.3ffffffffffffp+4)

x == 20
#>  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE 
FALSE FALSE
#> [13] FALSE
equals(x, 20)
#>  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE



[1] https://stat.ethz.ch/pipermail/r-help/2012-September/322938.html


Hope this helps,

Rui Barradas

?s 05:58 de 06/04/2022, ani jaya escreveu:
> Dear All,
> 
> I will remain sipping the seawater until it changes its taste if this
> community does not exist.
> Thank you.
> 
>> print(a,digit=18)
> [1] 19.999999999999982 19.999999999999982 14.237564602994826
> 19.999999999999940 19.999999999999982
> [6] 19.999999999999982 16.309207867721351 19.999999999999982
> 19.999999999999982 19.999999999999982
> [11] 19.999999999999982 19.999999999999982 19.999999999999982
> 19.999999999999982 19.999999999999982
> [16] 14.859093240879485 16.178935255298033 19.999999999999982
> 19.999999999999982 20.000000000000028
> [21] 19.999999999999982 27.640407788607870 19.999999999999982
> 19.999999999999982 19.999999999999982
> [26] 19.999999999999982 19.999999999999982 21.985706303744429
> 19.999999999999982 19.999999999999982
> [31] 20.000000000000028 19.999999999999982
> 
> 
> Best,
> Ani
> 
> On Wed, Apr 6, 2022 at 1:47 PM Richard M. Heiberger <rmh at temple.edu> wrote:
>>
>> I believe you are not remembering that floating point numbers are not
>> exactly represented in decimal.
>> See FAQ 7.31
>>
>> Here I have rounded a[4] to 12 places before comparing to 20.
>> The you get the answer you are looking for.
>>
>>> a <- c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 16.3092078677214,
>> + 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298,
>> + 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444,
>> + 20, 20, 20, 20)
>>> a[1:6]
>> [1] 20.00000 20.00000 14.23756 20.00000 20.00000 20.00000
>>> print(a[1:6], digits=17)
>> [1] 20.000000000000000 20.000000000000000 14.237564602994800 19.999999999999901 20.000000000000000 20.000000000000000
>>> a[1:6] == 20
>> [1]  TRUE  TRUE FALSE FALSE  TRUE  TRUE
>>> a[1:6] - 20
>> [1]  0.000000e+00  0.000000e+00 -5.762435e+00 -9.947598e-14  0.000000e+00  0.000000e+00
>>> a[4] == 20
>> [1] FALSE
>>> round(a[1:6], digits=14) - 20
>> [1]  0.000000e+00  0.000000e+00 -5.762435e+00 -9.947598e-14  0.000000e+00  0.000000e+00
>>> round(a[1:6], digits=13) - 20
>> [1]  0.000000e+00  0.000000e+00 -5.762435e+00 -9.947598e-14  0.000000e+00  0.000000e+00
>>> round(a[1:6], digits=12) - 20
>> [1]  0.000000  0.000000 -5.762435  0.000000  0.000000  0.000000
>>> b <- a[1:6]
>>> b[round(b,digits=12) == 20] <- 0
>>> b
>> [1]  0.00000  0.00000 14.23756  0.00000  0.00000  0.00000
>>>
>>
>>> On Apr 06, 2022, at 00:18, ani jaya <gaaauul at gmail.com> wrote:
>>>
>>>>> c(20, 20, 14.2375646029948, 19.9999999999999, 20, 20, 16.3092078677214,
>>>>> 20, 20, 20, 20, 20, 20, 20, 20, 14.8590932408795, 16.178935255298,
>>>>> 20, 20, 20, 20, 27.6404077886079, 20, 20, 20, 20, 20, 21.9857063037444,
>>>>> 20, 20, 20, 20)
>>
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Wed Apr  6 21:54:14 2022
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Wed, 6 Apr 2022 19:54:14 +0000 (UTC)
Subject: [R] pcalg library : estimated DAG graph
In-Reply-To: <4bb323d6da7b4af086fae5bb995586c1@SRVEXCHCM1302.precheza.cz>
References: <2065726392.779530.1648764515413.ref@mail.yahoo.com>
 <2065726392.779530.1648764515413@mail.yahoo.com>
 <4bb323d6da7b4af086fae5bb995586c1@SRVEXCHCM1302.precheza.cz>
Message-ID: <1619884176.3857877.1649274854958@mail.yahoo.com>

Many thanks for your responses.

Best,
SV







Le vendredi 1 avril 2022, 07:25:00 UTC+2, PIKAL Petr <petr.pikal at precheza.cz> a ?crit : 





Hallo

It is not obvious what is your problem. You maybe should go through some 
articles about functions in the package.
https://pdfs.semanticscholar.org/aee5/cca63aad422c96ee637b5561bb051724d76c.pdf?_ga=2.241710466.1872226166.1648790330-1600227915.1617009045

or maybe you do not have Rgraphviz package installed as required by plotting 
functions of the package.

R> stopifnot(require(Rgraphviz))# needed for all our graph plots

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of varin sacha via
> R-help
> Sent: Friday, April 1, 2022 12:09 AM
> To: r-help at r-project.org
> Subject: [R] pcalg library : estimated DAG graph
>
> Dear R-experts,
>
> Here below my R code working but I don't know how I can get the graph
> (estimated DAG).
> If you could help me to get the graph, many thanks.
>
>
> ###################
> library(pcalg)
>
> x1<-
> c(508,413,426,500,568,372,484,512,529,322,544,586,480,561,567,488,450,
> 548,526,561,435,567,537,521,516,407,531,374,406,595,460,420,453,562,53
> 0)
>
> x2<-
> c(531,491,353,522,341,493,431,565,530,441,403,498,552,513,513,403,445,
> 424,529,486,519,492,397,579,479,511,535,504,465,520,517,528,542,483,49
> 9)
>
> x3<-
> c(541,451,510,649,329,464,511,609,643,530,568,366,371,442,611,437,445,
> 589,605,456,437,179,540,580,587,540,505,310,542,488,525,483,200,517,51
> 3)
>
> x4<-
> c(488,473,449,564,447,593,420,685,597,534,608,389,557,385,564,449,530,
> 615,502,510,412,321,509,480,469,594,506,431,555,567,491,414,359,418,46
> 8)
>
> x5<-
> c(487,430,419,583,469,369,540,637,563,328,498,448,356,552,521,417,513,
> 570,530,594,372,537,469,454,554,518,550,384,533,594,467,471,590,552,55
> 6)
>
> x6<-
> c(511,452,432,563,431,458,477,601,572,431,524,458,463,491,555,439,477,
> 549,539,521,435,419,490,523,521,514,525,401,500,553,492,463,429,506,51
> 3)
>
> X=cbind(x1,x2,x3,x4,x5,x6)
>
> res1=lingam(X,verbose=TRUE)
> cat("estimated DAG:/n")
> as(res1,"amat")
> res1
> ###################
>
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.


From petr@p|k@| @end|ng |rom prechez@@cz  Wed Apr  6 21:58:22 2022
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Wed, 6 Apr 2022 19:58:22 +0000
Subject: [R] add equation and rsqared to plot
Message-ID: <1649275105409.87603@precheza.cz>

Dear all


I want to add equation and rsquared values to plot and I am lost in correct expression form. I want to have 2 lines, one with equation and one with r squared values.


Here is what I made.

# function to extract values from lm fit.


lm_eqn = function(m) {
  l <- list(a = format(coef(m)[1], digits = 4),
      b = format(abs(coef(m)[2]), digits = 4),
      r2 = format(summary(m)$r.squared, digits = 3),
      r2adj = format(summary(m)$adj.r.squared, digits = 3));
  if (coef(m)[2] >= 0)  {
    eq <- substitute(italic(y) == a + b %.% italic(x), l)
  } else {
    eq <- substitute(italic(y) == a - b %.% italic(x),l)

  }
  req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
  expression(atop(eq, req))
}


#Example

x <- 1:10
y <- x*5 +rnorm(10)
plot(x,y)
fit <- lm(y~x)
text(4,40, lm_eqn(fit))


I know that both eq and req are correct expressions and when the last line in function is either eq or req, the example gives correct result.


But how to get both expressions one above the other is mystery.

Please help.


Best regards.

Petr



Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information about processing and protection of business partner's personal data are available on website: https://www.precheza.cz/en/personal-data-protection-principles/
D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl?en? o vylou?en? odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://www.precheza.cz/en/01-disclaimer/


	[[alternative HTML version deleted]]


From kt1572757 @end|ng |rom gm@||@com  Wed Apr  6 22:13:01 2022
From: kt1572757 @end|ng |rom gm@||@com (Kelly Thompson)
Date: Wed, 6 Apr 2022 13:13:01 -0700
Subject: [R] What is the intended behavior,
 when subsetting using brackets [ ], when the subset criterion has NA's?
Message-ID: <CAHfBD2fQM2X1QCzh+Ti7aeO3iJh-y42obdO8Ve34Nfnxj6XEsg@mail.gmail.com>

I noticed that I get different results when subsetting using subset,
compared to subsetting using  "brackets" when the subset criteria have
NA's.

Here's an example

#START OF EXAMPLE
my_data <- 1:5
my_data

my_subset_criteria <- c( F, F, T, NA, NA)
my_subset_criteria

#subsetting using subset returns the data where my_subset_criteria equals TRUE
my_data[my_subset_criteria == T]

#subsetting using brackets returns the data where my_subset_criteria
equals TRUE, and also NA where my_subset_criteria is NA
subset(my_data, my_subset_criteria == T)

#END OF EXAMPLE

This behavior is also mentioned here
https://statisticaloddsandends.wordpress.com/2018/10/07/subsetting-in-the-presence-of-nas/

Q. Is this the intended behavior when subsetting with brackets?

Thank you!


From rmh @end|ng |rom temp|e@edu  Wed Apr  6 22:36:28 2022
From: rmh @end|ng |rom temp|e@edu (Richard M. Heiberger)
Date: Wed, 6 Apr 2022 20:36:28 +0000
Subject: [R] [External]  add equation and rsqared to plot
In-Reply-To: <1649275105409.87603@precheza.cz>
References: <1649275105409.87603@precheza.cz>
Message-ID: <4483DC96-F937-4BB8-B5A1-4485FDF590DB@temple.edu>

I think you are looking for atop(a,b)
See ? plotmath

> On Apr 06, 2022, at 15:58, PIKAL Petr <petr.pikal at precheza.cz> wrote:
> 
> Dear all
> 
> 
> I want to add equation and rsquared values to plot and I am lost in correct expression form. I want to have 2 lines, one with equation and one with r squared values.
> 
> 
> Here is what I made.
> 
> # function to extract values from lm fit.
> 
> 
> lm_eqn = function(m) {
>  l <- list(a = format(coef(m)[1], digits = 4),
>      b = format(abs(coef(m)[2]), digits = 4),
>      r2 = format(summary(m)$r.squared, digits = 3),
>      r2adj = format(summary(m)$adj.r.squared, digits = 3));
>  if (coef(m)[2] >= 0)  {
>    eq <- substitute(italic(y) == a + b %.% italic(x), l)
>  } else {
>    eq <- substitute(italic(y) == a - b %.% italic(x),l)
> 
>  }
>  req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
>  expression(atop(eq, req))
> }
> 
> 
> #Example
> 
> x <- 1:10
> y <- x*5 +rnorm(10)
> plot(x,y)
> fit <- lm(y~x)
> text(4,40, lm_eqn(fit))
> 
> 
> I know that both eq and req are correct expressions and when the last line in function is either eq or req, the example gives correct result.
> 
> 
> But how to get both expressions one above the other is mystery.
> 
> Please help.
> 
> 
> Best regards.
> 
> Petr
> 
> 
> 
> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fzasady-ochrany-osobnich-udaju%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=MBtbONfsiMExWy0uorZMR1DglZindxErRMsooTztfUo%3D&amp;reserved=0 | Information about processing and protection of business partner's personal data are available on website: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fen%2Fpersonal-data-protection-principles%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=2YDPoejYRlphL6h%2FWFmEEyR44KdmH2GDC9rdLhFn4aU%3D&amp;reserved=0
> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl?en? o vylou?en? odpov?dnosti: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2F01-dovetek%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=z7TNZSbfNXlB%2FZt0ekl8P1kTu1l0eBFVoLvewSSdQDg%3D&amp;reserved=0 | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fen%2F01-disclaimer%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=RCUE7DJbn54MvhWX4bqiNtPzoJLl7NK9tieMlFpe2rg%3D&amp;reserved=0
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From petr@p|k@| @end|ng |rom prechez@@cz  Wed Apr  6 22:47:19 2022
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Wed, 6 Apr 2022 20:47:19 +0000
Subject: [R] [External]  add equation and rsqared to plot
In-Reply-To: <4483DC96-F937-4BB8-B5A1-4485FDF590DB@temple.edu>
References: <1649275105409.87603@precheza.cz>,
 <4483DC96-F937-4BB8-B5A1-4485FDF590DB@temple.edu>
Message-ID: <1649278042150.16601@precheza.cz>

Hallo Richard.

Did you try the example? I Used atop but with the syntax I made, the result is

eq
req

but not the equations.

I send the picture, but I am not sure if it will go through.

Best regards
Petr

________________________________________
Od: Richard M. Heiberger <rmh at temple.edu>
Odesl?no: 6. dubna 2022 22:36
Komu: PIKAL Petr
Kopie: r-help at r-project.org
P?edm?t: Re: [External] [R] add equation and rsqared to plot

I think you are looking for atop(a,b)
See ? plotmath

> On Apr 06, 2022, at 15:58, PIKAL Petr <petr.pikal at precheza.cz> wrote:
>
> Dear all
>
>
> I want to add equation and rsquared values to plot and I am lost in correct expression form. I want to have 2 lines, one with equation and one with r squared values.
>
>
> Here is what I made.
>
> # function to extract values from lm fit.
>
>
> lm_eqn = function(m) {
>  l <- list(a = format(coef(m)[1], digits = 4),
>      b = format(abs(coef(m)[2]), digits = 4),
>      r2 = format(summary(m)$r.squared, digits = 3),
>      r2adj = format(summary(m)$adj.r.squared, digits = 3));
>  if (coef(m)[2] >= 0)  {
>    eq <- substitute(italic(y) == a + b %.% italic(x), l)
>  } else {
>    eq <- substitute(italic(y) == a - b %.% italic(x),l)
>
>  }
>  req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
>  expression(atop(eq, req))
> }
>
>
> #Example
>
> x <- 1:10
> y <- x*5 +rnorm(10)
> plot(x,y)
> fit <- lm(y~x)
> text(4,40, lm_eqn(fit))
>
>
> I know that both eq and req are correct expressions and when the last line in function is either eq or req, the example gives correct result.
>
>
> But how to get both expressions one above the other is mystery.
>
> Please help.
>
>
> Best regards.
>
> Petr
>
>
>
> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fzasady-ochrany-osobnich-udaju%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=MBtbONfsiMExWy0uorZMR1DglZindxErRMsooTztfUo%3D&amp;reserved=0 | Information about processing and protection of business partner's personal data are available on website: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fen%2Fpersonal-data-protection-principles%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=2YDPoejYRlphL6h%2FWFmEEyR44KdmH2GDC9rdLhFn4aU%3D&amp;reserved=0
> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl?en? o vylou?en? odpov?dnosti: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2F01-dovetek%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=z7TNZSbfNXlB%2FZt0ekl8P1kTu1l0eBFVoLvewSSdQDg%3D&amp;reserved=0 | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fen%2F01-disclaimer%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=RCUE7DJbn54MvhWX4bqiNtPzoJLl7NK9tieMlFpe2rg%3D&amp;reserved=0
>
>
>       [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information about processing and protection of business partner?s personal data are available on website: https://www.precheza.cz/en/personal-data-protection-principles/
D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en? odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://www.precheza.cz/en/01-disclaimer/


-------------- next part --------------
A non-text attachment was scrubbed...
Name: test.pdf
Type: application/pdf
Size: 1788 bytes
Desc: test.pdf
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20220406/29a3dc98/attachment.pdf>

From petr@p|k@| @end|ng |rom prechez@@cz  Wed Apr  6 22:50:55 2022
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Wed, 6 Apr 2022 20:50:55 +0000
Subject: [R] What is the intended behavior,
 when subsetting using brackets [ ], when the subset criterion has NA's?
In-Reply-To: <CAHfBD2fQM2X1QCzh+Ti7aeO3iJh-y42obdO8Ve34Nfnxj6XEsg@mail.gmail.com>
References: <CAHfBD2fQM2X1QCzh+Ti7aeO3iJh-y42obdO8Ve34Nfnxj6XEsg@mail.gmail.com>
Message-ID: <1649278258546.12274@precheza.cz>

Hi

safer way with NA values is using which

 my_data[which(my_subset_criteria == T)]
[1] 3

Cheers
Petr

AFAIK it is intended.

________________________________________
Od: R-help <r-help-bounces at r-project.org> za u?ivatele Kelly Thompson <kt1572757 at gmail.com>
Odesl?no: 6. dubna 2022 22:13
Komu: r-help at r-project.org
P?edm?t: [R] What is the intended behavior, when subsetting using brackets [ ], when the subset criterion has NA's?

I noticed that I get different results when subsetting using subset,
compared to subsetting using  "brackets" when the subset criteria have
NA's.

Here's an example

#START OF EXAMPLE
my_data <- 1:5
my_data

my_subset_criteria <- c( F, F, T, NA, NA)
my_subset_criteria

#subsetting using subset returns the data where my_subset_criteria equals TRUE
my_data[my_subset_criteria == T]

#subsetting using brackets returns the data where my_subset_criteria
equals TRUE, and also NA where my_subset_criteria is NA
subset(my_data, my_subset_criteria == T)

#END OF EXAMPLE

This behavior is also mentioned here
https://statisticaloddsandends.wordpress.com/2018/10/07/subsetting-in-the-presence-of-nas/

Q. Is this the intended behavior when subsetting with brackets?

Thank you!

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.
Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information about processing and protection of business partner?s personal data are available on website: https://www.precheza.cz/en/personal-data-protection-principles/
D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en? odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://www.precheza.cz/en/01-disclaimer/


From tebert @end|ng |rom u||@edu  Wed Apr  6 22:52:47 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Wed, 6 Apr 2022 20:52:47 +0000
Subject: [R] What is the intended behavior,
 when subsetting using brackets [ ], when the subset criterion has NA's?
In-Reply-To: <CAHfBD2fQM2X1QCzh+Ti7aeO3iJh-y42obdO8Ve34Nfnxj6XEsg@mail.gmail.com>
References: <CAHfBD2fQM2X1QCzh+Ti7aeO3iJh-y42obdO8Ve34Nfnxj6XEsg@mail.gmail.com>
Message-ID: <DM5PR2201MB1564EFCC205C56B22007DDF0CFE79@DM5PR2201MB1564.namprd22.prod.outlook.com>

I get an error with this:
my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria


Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Kelly Thompson
Sent: Wednesday, April 6, 2022 4:13 PM
To: r-help at r-project.org
Subject: [R] What is the intended behavior, when subsetting using brackets [ ], when the subset criterion has NA's?

[External Email]

I noticed that I get different results when subsetting using subset, compared to subsetting using  "brackets" when the subset criteria have NA's.

Here's an example

#START OF EXAMPLE
my_data <- 1:5
my_data

my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria

#subsetting using subset returns the data where my_subset_criteria equals TRUE my_data[my_subset_criteria == T]

#subsetting using brackets returns the data where my_subset_criteria equals TRUE, and also NA where my_subset_criteria is NA subset(my_data, my_subset_criteria == T)

#END OF EXAMPLE

This behavior is also mentioned here
https://urldefense.proofpoint.com/v2/url?u=https-3A__statisticaloddsandends.wordpress.com_2018_10_07_subsetting-2Din-2Dthe-2Dpresence-2Dof-2Dnas_&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=NoPFkG0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQDMSEW&s=5lgkxT5A_MSfElILNk1ZM3RGpcBWpMBu713av1DH1mk&e=

Q. Is this the intended behavior when subsetting with brackets?

Thank you!

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=NoPFkG0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQDMSEW&s=g9IzSC3WrXPLYjys_RdYSmgUoFFjsbwRJZZodqtDRa0&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=NoPFkG0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQDMSEW&s=uy6rCSNVehGynLn3ZCpLp_r2gHhoGcya4dbRe-tqQRc&e=
and provide commented, minimal, self-contained, reproducible code.


From rmh @end|ng |rom temp|e@edu  Wed Apr  6 22:58:52 2022
From: rmh @end|ng |rom temp|e@edu (Richard M. Heiberger)
Date: Wed, 6 Apr 2022 20:58:52 +0000
Subject: [R] [External]  add equation and rsqared to plot
In-Reply-To: <1649275105409.87603@precheza.cz>
References: <1649275105409.87603@precheza.cz>
Message-ID: <08112B54-FCAC-4C58-90D1-28E4B8D922A8@temple.edu>

this isn't your example, but it works:

text(5,40, expression(atop(x^2, 3*pi)))

So it looks like your eq and req aren't used at all.  the character strings in your atop statement are used as is.
You will need bquote() or somethiing similar for what you are attempting.
See the section
 ## How to combine "math" and numeric variables :
in the example for plotmath.

Rich

> On Apr 06, 2022, at 15:58, PIKAL Petr <petr.pikal at precheza.cz> wrote:
> 
> Dear all
> 
> 
> I want to add equation and rsquared values to plot and I am lost in correct expression form. I want to have 2 lines, one with equation and one with r squared values.
> 
> 
> Here is what I made.
> 
> # function to extract values from lm fit.
> 
> 
> lm_eqn = function(m) {
>  l <- list(a = format(coef(m)[1], digits = 4),
>      b = format(abs(coef(m)[2]), digits = 4),
>      r2 = format(summary(m)$r.squared, digits = 3),
>      r2adj = format(summary(m)$adj.r.squared, digits = 3));
>  if (coef(m)[2] >= 0)  {
>    eq <- substitute(italic(y) == a + b %.% italic(x), l)
>  } else {
>    eq <- substitute(italic(y) == a - b %.% italic(x),l)
> 
>  }
>  req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
>  expression(atop(eq, req))
> }
> 
> 
> #Example
> 
> x <- 1:10
> y <- x*5 +rnorm(10)
> plot(x,y)
> fit <- lm(y~x)
> text(4,40, lm_eqn(fit))
> 
> 
> I know that both eq and req are correct expressions and when the last line in function is either eq or req, the example gives correct result.
> 
> 
> But how to get both expressions one above the other is mystery.
> 
> Please help.
> 
> 
> Best regards.
> 
> Petr
> 
> 
> 
> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fzasady-ochrany-osobnich-udaju%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=MBtbONfsiMExWy0uorZMR1DglZindxErRMsooTztfUo%3D&amp;reserved=0 | Information about processing and protection of business partner's personal data are available on website: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fen%2Fpersonal-data-protection-principles%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=2YDPoejYRlphL6h%2FWFmEEyR44KdmH2GDC9rdLhFn4aU%3D&amp;reserved=0
> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl?en? o vylou?en? odpov?dnosti: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2F01-dovetek%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=z7TNZSbfNXlB%2FZt0ekl8P1kTu1l0eBFVoLvewSSdQDg%3D&amp;reserved=0 | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fen%2F01-disclaimer%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=RCUE7DJbn54MvhWX4bqiNtPzoJLl7NK9tieMlFpe2rg%3D&amp;reserved=0
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m@rc_@chw@rtz @end|ng |rom me@com  Wed Apr  6 23:11:07 2022
From: m@rc_@chw@rtz @end|ng |rom me@com (Marc Schwartz)
Date: Wed, 6 Apr 2022 17:11:07 -0400
Subject: [R] What is the intended behavior,
 when subsetting using brackets [ ], when the subset criterion has NA's?
In-Reply-To: <CAHfBD2fQM2X1QCzh+Ti7aeO3iJh-y42obdO8Ve34Nfnxj6XEsg@mail.gmail.com>
References: <CAHfBD2fQM2X1QCzh+Ti7aeO3iJh-y42obdO8Ve34Nfnxj6XEsg@mail.gmail.com>
Message-ID: <etPan.624e01eb.412e42d8.381@me.com>

Hi,

The behavior is as intended.

Note that your subset criteria results in:

> my_subset_criteria == T
[1] FALSE FALSE ?TRUE ? ?NA ? ?NA

If you review ?subset, you will see in the Details section:

"For ordinary vectors, the result is simply x[subset & !is.na(subset)]."

while reviewing ?"[", you will see in the section titled "NAs in indexing":

"When extracting, a numerical, logical or character NA index picks an unknown element and so returns NA in the corresponding element of a logical, integer, numeric, complex or character result, and NULL for a list. (It returns 00 for a raw result.)"

So, in the first case using subset(), NAs are explicitly excluded in the result, while not the case by default using bracket based subsetting.

In essence, to replicate the behavior of subset() using brackets:

> my_data[(my_subset_criteria == T) & !is.na(my_subset_criteria == T)]
[1] 3


Lastly, the use of 'T' as a single character representation of the boolean TRUE, is generally recommended against. While T and F are set as TRUE and FALSE at the start of a new R session, there is no guarantee that they will stay that way, as they can both be re-assigned:

> T <- "This is not TRUE"
> T
[1] "This is not TRUE"

whereas TRUE cannot be:

> TRUE <- "This is not TRUE"
Error in TRUE <- "This is not TRUE" :?
? invalid (do_set) left-hand side to assignment

Regards,

Marc Schwartz


On April 6, 2022 at 4:13:01 PM, Kelly Thompson (kt1572757 at gmail.com (mailto:kt1572757 at gmail.com)) wrote:

> I noticed that I get different results when subsetting using subset,
> compared to subsetting using "brackets" when the subset criteria have
> NA's.
>
> Here's an example
>
> #START OF EXAMPLE
> my_data <- 1:5
> my_data
>
> my_subset_criteria <- c( F, F, T, NA, NA)
> my_subset_criteria
>
> #subsetting using subset returns the data where my_subset_criteria equals TRUE
> my_data[my_subset_criteria == T]
>
> #subsetting using brackets returns the data where my_subset_criteria
> equals TRUE, and also NA where my_subset_criteria is NA
> subset(my_data, my_subset_criteria == T)
>
> #END OF EXAMPLE
>
> This behavior is also mentioned here
> https://statisticaloddsandends.wordpress.com/2018/10/07/subsetting-in-the-presence-of-nas/
>
> Q. Is this the intended behavior when subsetting with brackets?
>
> Thank you!
>


From dw|n@em|u@ @end|ng |rom comc@@t@net  Wed Apr  6 23:20:04 2022
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Wed, 6 Apr 2022 14:20:04 -0700
Subject: [R] [External] add equation and rsqared to plot
In-Reply-To: <1649278042150.16601@precheza.cz>
References: <1649275105409.87603@precheza.cz>
 <4483DC96-F937-4BB8-B5A1-4485FDF590DB@temple.edu>
 <1649278042150.16601@precheza.cz>
Message-ID: <95448101-08c6-045d-ff79-fb9febf3effb@comcast.net>

Try this:


lm_eqn = function(m) {
 ??? l <- list(a = format(coef(m)[1], digits = 4),
 ????????????? b = format(abs(coef(m)[2]), digits = 4),
 ????????????? r2 = format(summary(m)$r.squared, digits = 3),
 ????????????? r2adj = format(summary(m)$adj.r.squared, digits = 3));
 ??? if (coef(m)[2] >= 0)? {
 ??????? eq <- substitute(italic(y) == a + b %.% italic(x), l)
 ??? } else {
 ??????? eq <- substitute(italic(y) == a - b %.% italic(x),l)

 ??? }
 ??? req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
 ??? a_regs <- substitute( atop(eq, req), list(eq=eq,req=req))
}

-- 

David.

On 4/6/22 13:47, PIKAL Petr wrote:
> Hallo Richard.
>
> Did you try the example? I Used atop but with the syntax I made, the result is
>
> eq
> req
>
> but not the equations.
>
> I send the picture, but I am not sure if it will go through.
>
> Best regards
> Petr
>
> ________________________________________
> Od: Richard M. Heiberger <rmh at temple.edu>
> Odesl?no: 6. dubna 2022 22:36
> Komu: PIKAL Petr
> Kopie: r-help at r-project.org
> P?edm?t: Re: [External] [R] add equation and rsqared to plot
>
> I think you are looking for atop(a,b)
> See ? plotmath
>
>> On Apr 06, 2022, at 15:58, PIKAL Petr <petr.pikal at precheza.cz> wrote:
>>
>> Dear all
>>
>>
>> I want to add equation and rsquared values to plot and I am lost in correct expression form. I want to have 2 lines, one with equation and one with r squared values.
>>
>>
>> Here is what I made.
>>
>> # function to extract values from lm fit.
>>
>>
>> lm_eqn = function(m) {
>>   l <- list(a = format(coef(m)[1], digits = 4),
>>       b = format(abs(coef(m)[2]), digits = 4),
>>       r2 = format(summary(m)$r.squared, digits = 3),
>>       r2adj = format(summary(m)$adj.r.squared, digits = 3));
>>   if (coef(m)[2] >= 0)  {
>>     eq <- substitute(italic(y) == a + b %.% italic(x), l)
>>   } else {
>>     eq <- substitute(italic(y) == a - b %.% italic(x),l)
>>
>>   }
>>   req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
>>   expression(atop(eq, req))
>> }
>>
>>
>> #Example
>>
>> x <- 1:10
>> y <- x*5 +rnorm(10)
>> plot(x,y)
>> fit <- lm(y~x)
>> text(4,40, lm_eqn(fit))
>>
>>
>> I know that both eq and req are correct expressions and when the last line in function is either eq or req, the example gives correct result.
>>
>>
>> But how to get both expressions one above the other is mystery.
>>
>> Please help.
>>
>>
>> Best regards.
>>
>> Petr
>>
>>
>>
>> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fzasady-ochrany-osobnich-udaju%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=MBtbONfsiMExWy0uorZMR1DglZindxErRMsooTztfUo%3D&amp;reserved=0 | Information about processing and protection of business partner's personal data are available on website: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fen%2Fpersonal-data-protection-principles%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=2YDPoejYRlphL6h%2FWFmEEyR44KdmH2GDC9rdLhFn4aU%3D&amp;reserved=0
>> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl?en? o vylou?en? odpov?dnosti: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2F01-dovetek%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=z7TNZSbfNXlB%2FZt0ekl8P1kTu1l0eBFVoLvewSSdQDg%3D&amp;reserved=0 | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fen%2F01-disclaimer%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=RCUE7DJbn54MvhWX4bqiNtPzoJLl7NK9tieMlFpe2rg%3D&amp;reserved=0
>>
>>
>>        [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information about processing and protection of business partner?s personal data are available on website: https://www.precheza.cz/en/personal-data-protection-principles/
> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en? odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://www.precheza.cz/en/01-disclaimer/
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed Apr  6 23:21:34 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 06 Apr 2022 14:21:34 -0700
Subject: [R] What is the intended behavior,
 when subsetting using brackets [ ], when the subset criterion has NA's?
In-Reply-To: <DM5PR2201MB1564EFCC205C56B22007DDF0CFE79@DM5PR2201MB1564.namprd22.prod.outlook.com>
References: <CAHfBD2fQM2X1QCzh+Ti7aeO3iJh-y42obdO8Ve34Nfnxj6XEsg@mail.gmail.com>
 <DM5PR2201MB1564EFCC205C56B22007DDF0CFE79@DM5PR2201MB1564.namprd22.prod.outlook.com>
Message-ID: <C9660C16-E837-4853-B4C4-46B3E2FE7270@dcn.davis.ca.us>

Mmmm, ESP on the blink.

WHAT error? from which line of code?

BTW see The R Inferno, section 8.2.32

On April 6, 2022 1:52:47 PM PDT, "Ebert,Timothy Aaron" <tebert at ufl.edu> wrote:
>I get an error with this:
>my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria
>
>
>Tim
>
>-----Original Message-----
>From: R-help <r-help-bounces at r-project.org> On Behalf Of Kelly Thompson
>Sent: Wednesday, April 6, 2022 4:13 PM
>To: r-help at r-project.org
>Subject: [R] What is the intended behavior, when subsetting using brackets [ ], when the subset criterion has NA's?
>
>[External Email]
>
>I noticed that I get different results when subsetting using subset, compared to subsetting using  "brackets" when the subset criteria have NA's.
>
>Here's an example
>
>#START OF EXAMPLE
>my_data <- 1:5
>my_data
>
>my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria
>
>#subsetting using subset returns the data where my_subset_criteria equals TRUE my_data[my_subset_criteria == T]
>
>#subsetting using brackets returns the data where my_subset_criteria equals TRUE, and also NA where my_subset_criteria is NA subset(my_data, my_subset_criteria == T)
>
>#END OF EXAMPLE
>
>This behavior is also mentioned here
>https://urldefense.proofpoint.com/v2/url?u=https-3A__statisticaloddsandends.wordpress.com_2018_10_07_subsetting-2Din-2Dthe-2Dpresence-2Dof-2Dnas_&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=NoPFkG0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQDMSEW&s=5lgkxT5A_MSfElILNk1ZM3RGpcBWpMBu713av1DH1mk&e=
>
>Q. Is this the intended behavior when subsetting with brackets?
>
>Thank you!
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=NoPFkG0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQDMSEW&s=g9IzSC3WrXPLYjys_RdYSmgUoFFjsbwRJZZodqtDRa0&e=
>PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=NoPFkG0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQDMSEW&s=uy6rCSNVehGynLn3ZCpLp_r2gHhoGcya4dbRe-tqQRc&e=
>and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From dw|n@em|u@ @end|ng |rom comc@@t@net  Wed Apr  6 23:25:23 2022
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Wed, 6 Apr 2022 14:25:23 -0700
Subject: [R] [External] add equation and rsqared to plot
In-Reply-To: <08112B54-FCAC-4C58-90D1-28E4B8D922A8@temple.edu>
References: <1649275105409.87603@precheza.cz>
 <08112B54-FCAC-4C58-90D1-28E4B8D922A8@temple.edu>
Message-ID: <a6bbf09e-d5a1-fc1a-088d-5223b9f039c6@comcast.net>


On 4/6/22 13:58, Richard M. Heiberger wrote:
> this isn't your example, but it works:
>
> text(5,40, expression(atop(x^2, 3*pi)))
>
> So it looks like your eq and req aren't used at all.  the character strings in your atop statement are used as is.
> You will need bquote() or somethiing similar for what you are attempting.

My earlier answer used `substitute`, but I tested this as the final line 
of the function and got success as well:


bquote( atop(.(eq), .(req)))


-- 

David.

> See the section
>   ## How to combine "math" and numeric variables :
> in the example for plotmath.
>
> Rich
>
>> On Apr 06, 2022, at 15:58, PIKAL Petr <petr.pikal at precheza.cz> wrote:
>>
>> Dear all
>>
>>
>> I want to add equation and rsquared values to plot and I am lost in correct expression form. I want to have 2 lines, one with equation and one with r squared values.
>>
>>
>> Here is what I made.
>>
>> # function to extract values from lm fit.
>>
>>
>> lm_eqn = function(m) {
>>   l <- list(a = format(coef(m)[1], digits = 4),
>>       b = format(abs(coef(m)[2]), digits = 4),
>>       r2 = format(summary(m)$r.squared, digits = 3),
>>       r2adj = format(summary(m)$adj.r.squared, digits = 3));
>>   if (coef(m)[2] >= 0)  {
>>     eq <- substitute(italic(y) == a + b %.% italic(x), l)
>>   } else {
>>     eq <- substitute(italic(y) == a - b %.% italic(x),l)
>>
>>   }
>>   req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
>>   expression(atop(eq, req))
>> }
>>
>>
>> #Example
>>
>> x <- 1:10
>> y <- x*5 +rnorm(10)
>> plot(x,y)
>> fit <- lm(y~x)
>> text(4,40, lm_eqn(fit))
>>
>>
>> I know that both eq and req are correct expressions and when the last line in function is either eq or req, the example gives correct result.
>>
>>
>> But how to get both expressions one above the other is mystery.
>>
>> Please help.
>>
>>
>> Best regards.
>>
>> Petr
>>
>>
>>
>> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fzasady-ochrany-osobnich-udaju%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=MBtbONfsiMExWy0uorZMR1DglZindxErRMsooTztfUo%3D&amp;reserved=0 | Information about processing and protection of business partner's personal data are available on website: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fen%2Fpersonal-data-protection-principles%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=2YDPoejYRlphL6h%2FWFmEEyR44KdmH2GDC9rdLhFn4aU%3D&amp;reserved=0
>> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl?en? o vylou?en? odpov?dnosti: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2F01-dovetek%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=z7TNZSbfNXlB%2FZt0ekl8P1kTu1l0eBFVoLvewSSdQDg%3D&amp;reserved=0 | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fen%2F01-disclaimer%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=RCUE7DJbn54MvhWX4bqiNtPzoJLl7NK9tieMlFpe2rg%3D&amp;reserved=0
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

From petr@p|k@| @end|ng |rom prechez@@cz  Wed Apr  6 23:36:01 2022
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Wed, 6 Apr 2022 21:36:01 +0000
Subject: [R] [External] add equation and rsqared to plot
In-Reply-To: <95448101-08c6-045d-ff79-fb9febf3effb@comcast.net>
References: <1649275105409.87603@precheza.cz>
 <4483DC96-F937-4BB8-B5A1-4485FDF590DB@temple.edu>
 <1649278042150.16601@precheza.cz>,
 <95448101-08c6-045d-ff79-fb9febf3effb@comcast.net>
Message-ID: <1649280964120.57655@precheza.cz>

Hallo David

Thanks for your answer. atop itself somehow cannot use expression made by substitute  although those expressions itself are correct. I asked this question after roughly two hours of unsuccessful atempts.

The second substitute or bquote solves the problem. Maybe this could propagate to help page, because although atop works smoothly with simple expressions, expressions with substitute are treated in a wrong way (at least by my opinion).

Thanks again.

Best regards.
Petr


________________________________________
Od: David Winsemius <dwinsemius at comcast.net>
Odesl?no: 6. dubna 2022 23:20
Komu: PIKAL Petr; Richard M. Heiberger
Kopie: r-help at r-project.org
P?edm?t: Re: [R] [External] add equation and rsqared to plot

Try this:


lm_eqn = function(m) {
     l <- list(a = format(coef(m)[1], digits = 4),
               b = format(abs(coef(m)[2]), digits = 4),
               r2 = format(summary(m)$r.squared, digits = 3),
               r2adj = format(summary(m)$adj.r.squared, digits = 3));
     if (coef(m)[2] >= 0)  {
         eq <- substitute(italic(y) == a + b %.% italic(x), l)
     } else {
         eq <- substitute(italic(y) == a - b %.% italic(x),l)

     }
     req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
     a_regs <- substitute( atop(eq, req), list(eq=eq,req=req))
}

--

David.

On 4/6/22 13:47, PIKAL Petr wrote:
> Hallo Richard.
>
> Did you try the example? I Used atop but with the syntax I made, the result is
>
> eq
> req
>
> but not the equations.
>
> I send the picture, but I am not sure if it will go through.
>
> Best regards
> Petr
>
> ________________________________________
> Od: Richard M. Heiberger <rmh at temple.edu>
> Odesl?no: 6. dubna 2022 22:36
> Komu: PIKAL Petr
> Kopie: r-help at r-project.org
> P?edm?t: Re: [External] [R] add equation and rsqared to plot
>
> I think you are looking for atop(a,b)
> See ? plotmath
>
>> On Apr 06, 2022, at 15:58, PIKAL Petr <petr.pikal at precheza.cz> wrote:
>>
>> Dear all
>>
>>
>> I want to add equation and rsquared values to plot and I am lost in correct expression form. I want to have 2 lines, one with equation and one with r squared values.
>>
>>
>> Here is what I made.
>>
>> # function to extract values from lm fit.
>>
>>
>> lm_eqn = function(m) {
>>   l <- list(a = format(coef(m)[1], digits = 4),
>>       b = format(abs(coef(m)[2]), digits = 4),
>>       r2 = format(summary(m)$r.squared, digits = 3),
>>       r2adj = format(summary(m)$adj.r.squared, digits = 3));
>>   if (coef(m)[2] >= 0)  {
>>     eq <- substitute(italic(y) == a + b %.% italic(x), l)
>>   } else {
>>     eq <- substitute(italic(y) == a - b %.% italic(x),l)
>>
>>   }
>>   req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
>>   expression(atop(eq, req))
>> }
>>
>>
>> #Example
>>
>> x <- 1:10
>> y <- x*5 +rnorm(10)
>> plot(x,y)
>> fit <- lm(y~x)
>> text(4,40, lm_eqn(fit))
>>
>>
>> I know that both eq and req are correct expressions and when the last line in function is either eq or req, the example gives correct result.
>>
>>
>> But how to get both expressions one above the other is mystery.
>>
>> Please help.
>>
>>
>> Best regards.
>>
>> Petr
>>
>>
>>
>> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fzasady-ochrany-osobnich-udaju%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=MBtbONfsiMExWy0uorZMR1DglZindxErRMsooTztfUo%3D&amp;reserved=0 | Information about processing and protection of business partner's personal data are available on website: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fen%2Fpersonal-data-protection-principles%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=2YDPoejYRlphL6h%2FWFmEEyR44KdmH2GDC9rdLhFn4aU%3D&amp;reserved=0
>> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl?en? o vylou?en? odpov?dnosti: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2F01-dovetek%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=z7TNZSbfNXlB%2FZt0ekl8P1kTu1l0eBFVoLvewSSdQDg%3D&amp;reserved=0 | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fen%2F01-disclaimer%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=RCUE7DJbn54MvhWX4bqiNtPzoJLl7NK9tieMlFpe2rg%3D&amp;reserved=0
>>
>>
>>        [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information about processing and protection of business partner?s personal data are available on website: https://www.precheza.cz/en/personal-data-protection-principles/
> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en? odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://www.precheza.cz/en/01-disclaimer/
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

From dw|n@em|u@ @end|ng |rom comc@@t@net  Thu Apr  7 00:03:58 2022
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Wed, 6 Apr 2022 15:03:58 -0700
Subject: [R] [External] add equation and rsqared to plot
In-Reply-To: <1649280964120.57655@precheza.cz>
References: <1649275105409.87603@precheza.cz>
 <4483DC96-F937-4BB8-B5A1-4485FDF590DB@temple.edu>
 <1649278042150.16601@precheza.cz>
 <95448101-08c6-045d-ff79-fb9febf3effb@comcast.net>
 <1649280964120.57655@precheza.cz>
Message-ID: <9ed7092d-b142-9f6f-854e-9e5182b2b466@comcast.net>


On 4/6/22 14:36, PIKAL Petr wrote:
> Hallo David
>
> Thanks for your answer. atop itself somehow cannot use expression made by substitute  although those expressions itself are correct. I asked this question after roughly two hours of unsuccessful atempts.
>
> The second substitute or bquote solves the problem. Maybe this could propagate to help page, because although atop works smoothly with simple expressions, expressions with substitute are treated in a wrong way (at least by my opinion).


It's not a problem with `atop`. It's a problem with your understanding 
of how R expressions and plotmath functions work. The argument(s) to 
`expression` are not evaluated. So `atop` was given two expressions `eq` 
and `req` and they in turn were not evaluated .... just taken as text 
values inside atop. Using either `substitute` (with a second argument? 
list) or bquote (with its special dot function) forces evaluation by 
getting from the R symbol table those expressions which you had assigned 
as values of the symbols `eq` and `req`.

The plotmath functions (not just atop but also `paste`, `frac`, `over` 
and all the rest on the ?plotmath pafge),? are designed to be "like" 
`expression` in not evaluating their arguments unless a "special value" 
like a Greek letter name or a defined %<op>% is found. Those functions 
are handled with a different parser than regular R functions. So they 
are not designed to go out to the R symbol table (which is where even 
locally defined object names are kept) to find values.


Hope this helps;

David.


-- 

David.

>
> Thanks again.
>
> Best regards.
> Petr
>
>
> ________________________________________
> Od: David Winsemius <dwinsemius at comcast.net>
> Odesl?no: 6. dubna 2022 23:20
> Komu: PIKAL Petr; Richard M. Heiberger
> Kopie: r-help at r-project.org
> P?edm?t: Re: [R] [External] add equation and rsqared to plot
>
> Try this:
>
>
> lm_eqn = function(m) {
>       l <- list(a = format(coef(m)[1], digits = 4),
>                 b = format(abs(coef(m)[2]), digits = 4),
>                 r2 = format(summary(m)$r.squared, digits = 3),
>                 r2adj = format(summary(m)$adj.r.squared, digits = 3));
>       if (coef(m)[2] >= 0)  {
>           eq <- substitute(italic(y) == a + b %.% italic(x), l)
>       } else {
>           eq <- substitute(italic(y) == a - b %.% italic(x),l)
>
>       }
>       req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
>       a_regs <- substitute( atop(eq, req), list(eq=eq,req=req))
> }
>
> --
>
> David.
>
> On 4/6/22 13:47, PIKAL Petr wrote:
>> Hallo Richard.
>>
>> Did you try the example? I Used atop but with the syntax I made, the result is
>>
>> eq
>> req
>>
>> but not the equations.
>>
>> I send the picture, but I am not sure if it will go through.
>>
>> Best regards
>> Petr
>>
>> ________________________________________
>> Od: Richard M. Heiberger <rmh at temple.edu>
>> Odesl?no: 6. dubna 2022 22:36
>> Komu: PIKAL Petr
>> Kopie: r-help at r-project.org
>> P?edm?t: Re: [External] [R] add equation and rsqared to plot
>>
>> I think you are looking for atop(a,b)
>> See ? plotmath
>>
>>> On Apr 06, 2022, at 15:58, PIKAL Petr <petr.pikal at precheza.cz> wrote:
>>>
>>> Dear all
>>>
>>>
>>> I want to add equation and rsquared values to plot and I am lost in correct expression form. I want to have 2 lines, one with equation and one with r squared values.
>>>
>>>
>>> Here is what I made.
>>>
>>> # function to extract values from lm fit.
>>>
>>>
>>> lm_eqn = function(m) {
>>>    l <- list(a = format(coef(m)[1], digits = 4),
>>>        b = format(abs(coef(m)[2]), digits = 4),
>>>        r2 = format(summary(m)$r.squared, digits = 3),
>>>        r2adj = format(summary(m)$adj.r.squared, digits = 3));
>>>    if (coef(m)[2] >= 0)  {
>>>      eq <- substitute(italic(y) == a + b %.% italic(x), l)
>>>    } else {
>>>      eq <- substitute(italic(y) == a - b %.% italic(x),l)
>>>
>>>    }
>>>    req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
>>>    expression(atop(eq, req))
>>> }
>>>
>>>
>>> #Example
>>>
>>> x <- 1:10
>>> y <- x*5 +rnorm(10)
>>> plot(x,y)
>>> fit <- lm(y~x)
>>> text(4,40, lm_eqn(fit))
>>>
>>>
>>> I know that both eq and req are correct expressions and when the last line in function is either eq or req, the example gives correct result.
>>>
>>>
>>> But how to get both expressions one above the other is mystery.
>>>
>>> Please help.
>>>
>>>
>>> Best regards.
>>>
>>> Petr
>>>
>>>
>>>
>>> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fzasady-ochrany-osobnich-udaju%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=MBtbONfsiMExWy0uorZMR1DglZindxErRMsooTztfUo%3D&amp;reserved=0 | Information about processing and protection of business partner's personal data are available on website: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fen%2Fpersonal-data-protection-principles%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=2YDPoejYRlphL6h%2FWFmEEyR44KdmH2GDC9rdLhFn4aU%3D&amp;reserved=0
>>> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl?en? o vylou?en? odpov?dnosti: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2F01-dovetek%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=z7TNZSbfNXlB%2FZt0ekl8P1kTu1l0eBFVoLvewSSdQDg%3D&amp;reserved=0 | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fen%2F01-disclaimer%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=RCUE7DJbn54MvhWX4bqiNtPzoJLl7NK9tieMlFpe2rg%3D&amp;reserved=0
>>>
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information about processing and protection of business partner?s personal data are available on website: https://www.precheza.cz/en/personal-data-protection-principles/
>> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en? odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://www.precheza.cz/en/01-disclaimer/
>>
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.

From bgunter@4567 @end|ng |rom gm@||@com  Thu Apr  7 00:49:54 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 6 Apr 2022 15:49:54 -0700
Subject: [R] [External] add equation and rsqared to plot
In-Reply-To: <9ed7092d-b142-9f6f-854e-9e5182b2b466@comcast.net>
References: <1649275105409.87603@precheza.cz>
 <4483DC96-F937-4BB8-B5A1-4485FDF590DB@temple.edu>
 <1649278042150.16601@precheza.cz>
 <95448101-08c6-045d-ff79-fb9febf3effb@comcast.net>
 <1649280964120.57655@precheza.cz>
 <9ed7092d-b142-9f6f-854e-9e5182b2b466@comcast.net>
Message-ID: <CAGxFJbSffXehFmagYwc8VB2eSHmdn=y1u08avWgRcHUMhFLDqw@mail.gmail.com>

... "symbol table"  := "namespace" in current R terminology, I believe.

Bert

On Wed, Apr 6, 2022 at 3:17 PM David Winsemius <dwinsemius at comcast.net> wrote:
>
>
> On 4/6/22 14:36, PIKAL Petr wrote:
> > Hallo David
> >
> > Thanks for your answer. atop itself somehow cannot use expression made by substitute  although those expressions itself are correct. I asked this question after roughly two hours of unsuccessful atempts.
> >
> > The second substitute or bquote solves the problem. Maybe this could propagate to help page, because although atop works smoothly with simple expressions, expressions with substitute are treated in a wrong way (at least by my opinion).
>
>
> It's not a problem with `atop`. It's a problem with your understanding
> of how R expressions and plotmath functions work. The argument(s) to
> `expression` are not evaluated. So `atop` was given two expressions `eq`
> and `req` and they in turn were not evaluated .... just taken as text
> values inside atop. Using either `substitute` (with a second argument
> list) or bquote (with its special dot function) forces evaluation by
> getting from the R symbol table those expressions which you had assigned
> as values of the symbols `eq` and `req`.
>
> The plotmath functions (not just atop but also `paste`, `frac`, `over`
> and all the rest on the ?plotmath pafge),  are designed to be "like"
> `expression` in not evaluating their arguments unless a "special value"
> like a Greek letter name or a defined %<op>% is found. Those functions
> are handled with a different parser than regular R functions. So they
> are not designed to go out to the R symbol table (which is where even
> locally defined object names are kept) to find values.
>
>
> Hope this helps;
>
> David.
>
>
> --
>
> David.
>
> >
> > Thanks again.
> >
> > Best regards.
> > Petr
> >
> >
> > ________________________________________
> > Od: David Winsemius <dwinsemius at comcast.net>
> > Odesl?no: 6. dubna 2022 23:20
> > Komu: PIKAL Petr; Richard M. Heiberger
> > Kopie: r-help at r-project.org
> > P?edm?t: Re: [R] [External] add equation and rsqared to plot
> >
> > Try this:
> >
> >
> > lm_eqn = function(m) {
> >       l <- list(a = format(coef(m)[1], digits = 4),
> >                 b = format(abs(coef(m)[2]), digits = 4),
> >                 r2 = format(summary(m)$r.squared, digits = 3),
> >                 r2adj = format(summary(m)$adj.r.squared, digits = 3));
> >       if (coef(m)[2] >= 0)  {
> >           eq <- substitute(italic(y) == a + b %.% italic(x), l)
> >       } else {
> >           eq <- substitute(italic(y) == a - b %.% italic(x),l)
> >
> >       }
> >       req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
> >       a_regs <- substitute( atop(eq, req), list(eq=eq,req=req))
> > }
> >
> > --
> >
> > David.
> >
> > On 4/6/22 13:47, PIKAL Petr wrote:
> >> Hallo Richard.
> >>
> >> Did you try the example? I Used atop but with the syntax I made, the result is
> >>
> >> eq
> >> req
> >>
> >> but not the equations.
> >>
> >> I send the picture, but I am not sure if it will go through.
> >>
> >> Best regards
> >> Petr
> >>
> >> ________________________________________
> >> Od: Richard M. Heiberger <rmh at temple.edu>
> >> Odesl?no: 6. dubna 2022 22:36
> >> Komu: PIKAL Petr
> >> Kopie: r-help at r-project.org
> >> P?edm?t: Re: [External] [R] add equation and rsqared to plot
> >>
> >> I think you are looking for atop(a,b)
> >> See ? plotmath
> >>
> >>> On Apr 06, 2022, at 15:58, PIKAL Petr <petr.pikal at precheza.cz> wrote:
> >>>
> >>> Dear all
> >>>
> >>>
> >>> I want to add equation and rsquared values to plot and I am lost in correct expression form. I want to have 2 lines, one with equation and one with r squared values.
> >>>
> >>>
> >>> Here is what I made.
> >>>
> >>> # function to extract values from lm fit.
> >>>
> >>>
> >>> lm_eqn = function(m) {
> >>>    l <- list(a = format(coef(m)[1], digits = 4),
> >>>        b = format(abs(coef(m)[2]), digits = 4),
> >>>        r2 = format(summary(m)$r.squared, digits = 3),
> >>>        r2adj = format(summary(m)$adj.r.squared, digits = 3));
> >>>    if (coef(m)[2] >= 0)  {
> >>>      eq <- substitute(italic(y) == a + b %.% italic(x), l)
> >>>    } else {
> >>>      eq <- substitute(italic(y) == a - b %.% italic(x),l)
> >>>
> >>>    }
> >>>    req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
> >>>    expression(atop(eq, req))
> >>> }
> >>>
> >>>
> >>> #Example
> >>>
> >>> x <- 1:10
> >>> y <- x*5 +rnorm(10)
> >>> plot(x,y)
> >>> fit <- lm(y~x)
> >>> text(4,40, lm_eqn(fit))
> >>>
> >>>
> >>> I know that both eq and req are correct expressions and when the last line in function is either eq or req, the example gives correct result.
> >>>
> >>>
> >>> But how to get both expressions one above the other is mystery.
> >>>
> >>> Please help.
> >>>
> >>>
> >>> Best regards.
> >>>
> >>> Petr
> >>>
> >>>
> >>>
> >>> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fzasady-ochrany-osobnich-udaju%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=MBtbONfsiMExWy0uorZMR1DglZindxErRMsooTztfUo%3D&amp;reserved=0 | Information about processing and protection of business partner's personal data are available on website: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fen%2Fpersonal-data-protection-principles%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=2YDPoejYRlphL6h%2FWFmEEyR44KdmH2GDC9rdLhFn4aU%3D&amp;reserved=0
> >>> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl?en? o vylou?en? odpov?dnosti: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2F01-dovetek%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=z7TNZSbfNXlB%2FZt0ekl8P1kTu1l0eBFVoLvewSSdQDg%3D&amp;reserved=0 | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.precheza.cz%2Fen%2F01-disclaimer%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=RCUE7DJbn54MvhWX4bqiNtPzoJLl7NK9tieMlFpe2rg%3D&amp;reserved=0
> >>>
> >>>
> >>>         [[alternative HTML version deleted]]
> >>>
> >>> ______________________________________________
> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >>> and provide commented, minimal, self-contained, reproducible code.
> >> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information about processing and protection of business partner?s personal data are available on website: https://www.precheza.cz/en/personal-data-protection-principles/
> >> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en? odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://www.precheza.cz/en/01-disclaimer/
> >>
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From d@go@t|no|@b| @end|ng |rom gm@||@com  Thu Apr  7 00:58:36 2022
From: d@go@t|no|@b| @end|ng |rom gm@||@com (Fabio D'Agostino)
Date: Thu, 7 Apr 2022 00:58:36 +0200
Subject: [R] What is the intended behavior,
 when subsetting using brackets [ ], when the subset criterion has NA's?
In-Reply-To: <CAHfBD2fQM2X1QCzh+Ti7aeO3iJh-y42obdO8Ve34Nfnxj6XEsg@mail.gmail.com>
References: <CAHfBD2fQM2X1QCzh+Ti7aeO3iJh-y42obdO8Ve34Nfnxj6XEsg@mail.gmail.com>
Message-ID: <CADUGNTzpmGy1guacQj3VOBiG9XQEWFv0o3u=huKLdvQ754Kdvw@mail.gmail.com>

Hi Kelly,
I had a question very similar to your months ago and Jeff replied this
https://stat.ethz.ch/pipermail/r-help/2022-February/473861.html
I hope this helps
Fabio


Il giorno mer 6 apr 2022 alle ore 22:23 Kelly Thompson
<kt1572757 at gmail.com> ha scritto:
>
> I noticed that I get different results when subsetting using subset,
> compared to subsetting using  "brackets" when the subset criteria have
> NA's.
>
> Here's an example
>
> #START OF EXAMPLE
> my_data <- 1:5
> my_data
>
> my_subset_criteria <- c( F, F, T, NA, NA)
> my_subset_criteria
>
> #subsetting using subset returns the data where my_subset_criteria equals TRUE
> my_data[my_subset_criteria == T]
>
> #subsetting using brackets returns the data where my_subset_criteria
> equals TRUE, and also NA where my_subset_criteria is NA
> subset(my_data, my_subset_criteria == T)
>
> #END OF EXAMPLE
>
> This behavior is also mentioned here
> https://statisticaloddsandends.wordpress.com/2018/10/07/subsetting-in-the-presence-of-nas/
>
> Q. Is this the intended behavior when subsetting with brackets?
>
> Thank you!
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From tebert @end|ng |rom u||@edu  Thu Apr  7 01:17:21 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Wed, 6 Apr 2022 23:17:21 +0000
Subject: [R] What is the intended behavior,
 when subsetting using brackets [ ], when the subset criterion has NA's?
In-Reply-To: <C9660C16-E837-4853-B4C4-46B3E2FE7270@dcn.davis.ca.us>
References: <CAHfBD2fQM2X1QCzh+Ti7aeO3iJh-y42obdO8Ve34Nfnxj6XEsg@mail.gmail.com>
 <DM5PR2201MB1564EFCC205C56B22007DDF0CFE79@DM5PR2201MB1564.namprd22.prod.outlook.com>
 <C9660C16-E837-4853-B4C4-46B3E2FE7270@dcn.davis.ca.us>
Message-ID: <BN6PR2201MB1553B9DC1E61F24A0C50368ACFE79@BN6PR2201MB1553.namprd22.prod.outlook.com>

Based on the OP's submission I pasted the following into R and tried to run it.

Here is what I think was posted (comments removed):

my_data <- 1:5
my_data
my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria
equals TRUE my_data[my_subset_criteria == T]
my_subset_criteria == T) 

Assuming that this is the right code I tried to run it. 
The third line " my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria" returns an error.

Error: unexpected symbol in " my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria"

Regards,
Tim

-----Original Message-----
From: Jeff Newmiller <jdnewmil at dcn.davis.ca.us> 
Sent: Wednesday, April 6, 2022 5:22 PM
To: r-help at r-project.org; Ebert,Timothy Aaron <tebert at ufl.edu>; Kelly Thompson <kt1572757 at gmail.com>; r-help at r-project.org
Subject: Re: [R] What is the intended behavior, when subsetting using brackets [ ], when the subset criterion has NA's?

[External Email]

Mmmm, ESP on the blink.

WHAT error? from which line of code?

BTW see The R Inferno, section 8.2.32

On April 6, 2022 1:52:47 PM PDT, "Ebert,Timothy Aaron" <tebert at ufl.edu> wrote:
>I get an error with this:
>my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria
>
>
>Tim
>
>-----Original Message-----
>From: R-help <r-help-bounces at r-project.org> On Behalf Of Kelly Thompson
>Sent: Wednesday, April 6, 2022 4:13 PM
>To: r-help at r-project.org
>Subject: [R] What is the intended behavior, when subsetting using brackets [ ], when the subset criterion has NA's?
>
>[External Email]
>
>I noticed that I get different results when subsetting using subset, compared to subsetting using  "brackets" when the subset criteria have NA's.
>
>Here's an example
>
>#START OF EXAMPLE
>my_data <- 1:5
>my_data
>
>my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria
>
>#subsetting using subset returns the data where my_subset_criteria 
>equals TRUE my_data[my_subset_criteria == T]
>
>#subsetting using brackets returns the data where my_subset_criteria 
>equals TRUE, and also NA where my_subset_criteria is NA subset(my_data, 
>my_subset_criteria == T)
>
>#END OF EXAMPLE
>
>This behavior is also mentioned here
>https://urldefense.proofpoint.com/v2/url?u=https-3A__statisticaloddsand
>ends.wordpress.com_2018_10_07_subsetting-2Din-2Dthe-2Dpresence-2Dof-2Dn
>as_&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=NoPFkG
>0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQDMSEW&s=5lgkxT5A_M
>SfElILNk1ZM3RGpcBWpMBu713av1DH1mk&e=
>
>Q. Is this the intended behavior when subsetting with brackets?
>
>Thank you!
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailm
>an_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRz
>sn7AkP-g&m=NoPFkG0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQD
>MSEW&s=g9IzSC3WrXPLYjys_RdYSmgUoFFjsbwRJZZodqtDRa0&e=
>PLEASE do read the posting guide 
>https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org
>_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsR
>zsn7AkP-g&m=NoPFkG0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQ
>DMSEW&s=uy6rCSNVehGynLn3ZCpLp_r2gHhoGcya4dbRe-tqQRc&e=
>and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailm
>an_listinfo_r-2Dhelp&d=DwIFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRz
>sn7AkP-g&m=QLbQb6DaELgtR0Qo6aQx51ea30OmGIC0oqVB_naWxmKYlQyw_N81MiAKj_5Z
>9TXC&s=G7rw7ZKvhE_HMF4z5cA5Gsr0C018E51Ov9ye3Ui2GX0&e=
>PLEASE do read the posting guide 
>https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org
>_posting-2Dguide.html&d=DwIFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsR
>zsn7AkP-g&m=QLbQb6DaELgtR0Qo6aQx51ea30OmGIC0oqVB_naWxmKYlQyw_N81MiAKj_5
>Z9TXC&s=PKD9VZ1n0p_NfoQ2OvbmPEVr14lVwLZx09mOIWPRZmk&e=
>and provide commented, minimal, self-contained, reproducible code.

--
Sent from my phone. Please excuse my brevity.

From tebert @end|ng |rom u||@edu  Thu Apr  7 01:42:18 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Wed, 6 Apr 2022 23:42:18 +0000
Subject: [R] What is the intended behavior,
 when subsetting using brackets [ ], when the subset criterion has NA's?
In-Reply-To: <BN6PR2201MB1553B9DC1E61F24A0C50368ACFE79@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <CAHfBD2fQM2X1QCzh+Ti7aeO3iJh-y42obdO8Ve34Nfnxj6XEsg@mail.gmail.com>
 <DM5PR2201MB1564EFCC205C56B22007DDF0CFE79@DM5PR2201MB1564.namprd22.prod.outlook.com>
 <C9660C16-E837-4853-B4C4-46B3E2FE7270@dcn.davis.ca.us>
 <BN6PR2201MB1553B9DC1E61F24A0C50368ACFE79@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <BN6PR2201MB1553C00EAB2C378CE592DB7BCFE79@BN6PR2201MB1553.namprd22.prod.outlook.com>

Sincere apologies. The R code got changed from what I thought I posted.

my_data <- 1:5

my_data

my_subset_criteria <- c( F, F, T, NA, NA)my_subset_criteria

my_data[my_subset_criteria == T]

subset(my_data, my_subset_criteria == T)


Regards,
Tim

 




-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Ebert,Timothy Aaron
Sent: Wednesday, April 6, 2022 7:17 PM
To: Jeff Newmiller <jdnewmil at dcn.davis.ca.us>; r-help at r-project.org; Kelly Thompson <kt1572757 at gmail.com>; r-help at r-project.org
Subject: Re: [R] What is the intended behavior, when subsetting using brackets [ ], when the subset criterion has NA's?

[External Email]

Based on the OP's submission I pasted the following into R and tried to run it.

Here is what I think was posted (comments removed):

my_data <- 1:5
my_data
my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria equals TRUE my_data[my_subset_criteria == T] my_subset_criteria == T)

Assuming that this is the right code I tried to run it.
The third line " my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria" returns an error.

Error: unexpected symbol in " my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria"

Regards,
Tim

-----Original Message-----
From: Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
Sent: Wednesday, April 6, 2022 5:22 PM
To: r-help at r-project.org; Ebert,Timothy Aaron <tebert at ufl.edu>; Kelly Thompson <kt1572757 at gmail.com>; r-help at r-project.org
Subject: Re: [R] What is the intended behavior, when subsetting using brackets [ ], when the subset criterion has NA's?

[External Email]

Mmmm, ESP on the blink.

WHAT error? from which line of code?

BTW see The R Inferno, section 8.2.32

On April 6, 2022 1:52:47 PM PDT, "Ebert,Timothy Aaron" <tebert at ufl.edu> wrote:
>I get an error with this:
>my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria
>
>
>Tim
>
>-----Original Message-----
>From: R-help <r-help-bounces at r-project.org> On Behalf Of Kelly Thompson
>Sent: Wednesday, April 6, 2022 4:13 PM
>To: r-help at r-project.org
>Subject: [R] What is the intended behavior, when subsetting using brackets [ ], when the subset criterion has NA's?
>
>[External Email]
>
>I noticed that I get different results when subsetting using subset, compared to subsetting using  "brackets" when the subset criteria have NA's.
>
>Here's an example
>
>#START OF EXAMPLE
>my_data <- 1:5
>my_data
>
>my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria
>
>#subsetting using subset returns the data where my_subset_criteria 
>equals TRUE my_data[my_subset_criteria == T]
>
>#subsetting using brackets returns the data where my_subset_criteria 
>equals TRUE, and also NA where my_subset_criteria is NA subset(my_data, 
>my_subset_criteria == T)
>
>#END OF EXAMPLE
>
>This behavior is also mentioned here
>https://urldefense.proofpoint.com/v2/url?u=https-3A__statisticaloddsand
>ends.wordpress.com_2018_10_07_subsetting-2Din-2Dthe-2Dpresence-2Dof-2Dn
>as_&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=NoPFkG
>0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQDMSEW&s=5lgkxT5A_M
>SfElILNk1ZM3RGpcBWpMBu713av1DH1mk&e=
>
>Q. Is this the intended behavior when subsetting with brackets?
>
>Thank you!
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailm
>an_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRz
>sn7AkP-g&m=NoPFkG0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQD
>MSEW&s=g9IzSC3WrXPLYjys_RdYSmgUoFFjsbwRJZZodqtDRa0&e=
>PLEASE do read the posting guide
>https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org
>_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsR
>zsn7AkP-g&m=NoPFkG0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQ
>DMSEW&s=uy6rCSNVehGynLn3ZCpLp_r2gHhoGcya4dbRe-tqQRc&e=
>and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailm
>an_listinfo_r-2Dhelp&d=DwIFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRz
>sn7AkP-g&m=QLbQb6DaELgtR0Qo6aQx51ea30OmGIC0oqVB_naWxmKYlQyw_N81MiAKj_5Z
>9TXC&s=G7rw7ZKvhE_HMF4z5cA5Gsr0C018E51Ov9ye3Ui2GX0&e=
>PLEASE do read the posting guide
>https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org
>_posting-2Dguide.html&d=DwIFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsR
>zsn7AkP-g&m=QLbQb6DaELgtR0Qo6aQx51ea30OmGIC0oqVB_naWxmKYlQyw_N81MiAKj_5
>Z9TXC&s=PKD9VZ1n0p_NfoQ2OvbmPEVr14lVwLZx09mOIWPRZmk&e=
>and provide commented, minimal, self-contained, reproducible code.

--
Sent from my phone. Please excuse my brevity.
______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=wsZer1oWbyc637le3XqcxP_Fm0qbbGOnp8xi-bhU9F9s8n_uqoeIFdmCTUeGBvPk&s=7fGkU6nCrIOrDL7v_8QUzSbpIcvx0HpDPywQiiL9KIk&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=wsZer1oWbyc637le3XqcxP_Fm0qbbGOnp8xi-bhU9F9s8n_uqoeIFdmCTUeGBvPk&s=qxdUsUjjcdJIJxjx3kCPJhMvI41AD23zPMITkE6_JPA&e=
and provide commented, minimal, self-contained, reproducible code.


From dw|n@em|u@ @end|ng |rom comc@@t@net  Thu Apr  7 01:43:55 2022
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Wed, 6 Apr 2022 16:43:55 -0700
Subject: [R] What is the intended behavior,
 when subsetting using brackets [ ], when the subset criterion has NA's?
In-Reply-To: <BN6PR2201MB1553B9DC1E61F24A0C50368ACFE79@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <CAHfBD2fQM2X1QCzh+Ti7aeO3iJh-y42obdO8Ve34Nfnxj6XEsg@mail.gmail.com>
 <DM5PR2201MB1564EFCC205C56B22007DDF0CFE79@DM5PR2201MB1564.namprd22.prod.outlook.com>
 <C9660C16-E837-4853-B4C4-46B3E2FE7270@dcn.davis.ca.us>
 <BN6PR2201MB1553B9DC1E61F24A0C50368ACFE79@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <7c250a15-19a4-7fa7-958f-fa5ea1c108f1@comcast.net>


On 4/6/22 16:17, Ebert,Timothy Aaron wrote:
> Based on the OP's submission I pasted the following into R and tried to run it.
>
> Here is what I think was posted (comments removed):
>
> my_data <- 1:5
> my_data
> my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria
> equals TRUE my_data[my_subset_criteria == T]
> my_subset_criteria == T)
>
> Assuming that this is the right code I tried to run it.
> The third line " my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria" returns an error.


As it should. You put two commands on the same line with no correct 
separator:Either of these should succeed:

my_subset_criteria <- c( F, F, T, NA, NA)
my_subset_criteria

# OR
  
my_subset_criteria <- c( F, F, T, NA, NA) ; my_subset_criteria

(The original poster had the correct syntax.)

-- 
David


>
> Error: unexpected symbol in " my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria"
>
> Regards,
> Tim
>
> -----Original Message-----
> From: Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
> Sent: Wednesday, April 6, 2022 5:22 PM
> To: r-help at r-project.org; Ebert,Timothy Aaron <tebert at ufl.edu>; Kelly Thompson <kt1572757 at gmail.com>; r-help at r-project.org
> Subject: Re: [R] What is the intended behavior, when subsetting using brackets [ ], when the subset criterion has NA's?
>
> [External Email]
>
> Mmmm, ESP on the blink.
>
> WHAT error? from which line of code?
>
> BTW see The R Inferno, section 8.2.32
>
> On April 6, 2022 1:52:47 PM PDT, "Ebert,Timothy Aaron" <tebert at ufl.edu> wrote:
>> I get an error with this:
>> my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria
>>
>>
>> Tim
>>
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Kelly Thompson
>> Sent: Wednesday, April 6, 2022 4:13 PM
>> To: r-help at r-project.org
>> Subject: [R] What is the intended behavior, when subsetting using brackets [ ], when the subset criterion has NA's?
>>
>> [External Email]
>>
>> I noticed that I get different results when subsetting using subset, compared to subsetting using  "brackets" when the subset criteria have NA's.
>>
>> Here's an example
>>
>> #START OF EXAMPLE
>> my_data <- 1:5
>> my_data
>>
>> my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria
>>
>> #subsetting using subset returns the data where my_subset_criteria
>> equals TRUE my_data[my_subset_criteria == T]
>>
>> #subsetting using brackets returns the data where my_subset_criteria
>> equals TRUE, and also NA where my_subset_criteria is NA subset(my_data,
>> my_subset_criteria == T)
>>
>> #END OF EXAMPLE
>>
>> This behavior is also mentioned here
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__statisticaloddsand
>> ends.wordpress.com_2018_10_07_subsetting-2Din-2Dthe-2Dpresence-2Dof-2Dn
>> as_&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=NoPFkG
>> 0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQDMSEW&s=5lgkxT5A_M
>> SfElILNk1ZM3RGpcBWpMBu713av1DH1mk&e=
>>
>> Q. Is this the intended behavior when subsetting with brackets?
>>
>> Thank you!
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailm
>> an_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRz
>> sn7AkP-g&m=NoPFkG0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQD
>> MSEW&s=g9IzSC3WrXPLYjys_RdYSmgUoFFjsbwRJZZodqtDRa0&e=
>> PLEASE do read the posting guide
>> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org
>> _posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsR
>> zsn7AkP-g&m=NoPFkG0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQ
>> DMSEW&s=uy6rCSNVehGynLn3ZCpLp_r2gHhoGcya4dbRe-tqQRc&e=
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailm
>> an_listinfo_r-2Dhelp&d=DwIFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRz
>> sn7AkP-g&m=QLbQb6DaELgtR0Qo6aQx51ea30OmGIC0oqVB_naWxmKYlQyw_N81MiAKj_5Z
>> 9TXC&s=G7rw7ZKvhE_HMF4z5cA5Gsr0C018E51Ov9ye3Ui2GX0&e=
>> PLEASE do read the posting guide
>> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org
>> _posting-2Dguide.html&d=DwIFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsR
>> zsn7AkP-g&m=QLbQb6DaELgtR0Qo6aQx51ea30OmGIC0oqVB_naWxmKYlQyw_N81MiAKj_5
>> Z9TXC&s=PKD9VZ1n0p_NfoQ2OvbmPEVr14lVwLZx09mOIWPRZmk&e=
>> and provide commented, minimal, self-contained, reproducible code.
> --
> Sent from my phone. Please excuse my brevity.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Apr  7 05:07:46 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 06 Apr 2022 20:07:46 -0700
Subject: [R] What is the intended behavior,
 when subsetting using brackets [ ], when the subset criterion has NA's?
In-Reply-To: <BN6PR2201MB1553B9DC1E61F24A0C50368ACFE79@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <CAHfBD2fQM2X1QCzh+Ti7aeO3iJh-y42obdO8Ve34Nfnxj6XEsg@mail.gmail.com>
 <DM5PR2201MB1564EFCC205C56B22007DDF0CFE79@DM5PR2201MB1564.namprd22.prod.outlook.com>
 <C9660C16-E837-4853-B4C4-46B3E2FE7270@dcn.davis.ca.us>
 <BN6PR2201MB1553B9DC1E61F24A0C50368ACFE79@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <58E41267-E1AD-4421-9354-A206097B982C@dcn.davis.ca.us>

I suspect you were the victim of your own failure to use plain text email format as the Posting Guide warns you to do, or at least you let your email client try to convert your reply to HTML format... which often treats text on different lines as part of a single paragraph. As David pointed out, your version of the code had missing newlines.

On April 6, 2022 4:17:21 PM PDT, "Ebert,Timothy Aaron" <tebert at ufl.edu> wrote:
>Based on the OP's submission I pasted the following into R and tried to run it.
>
>Here is what I think was posted (comments removed):
>
>my_data <- 1:5
>my_data
>my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria
>equals TRUE my_data[my_subset_criteria == T]
>my_subset_criteria == T) 
>
>Assuming that this is the right code I tried to run it. 
>The third line " my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria" returns an error.
>
>Error: unexpected symbol in " my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria"
>
>Regards,
>Tim
>
>-----Original Message-----
>From: Jeff Newmiller <jdnewmil at dcn.davis.ca.us> 
>Sent: Wednesday, April 6, 2022 5:22 PM
>To: r-help at r-project.org; Ebert,Timothy Aaron <tebert at ufl.edu>; Kelly Thompson <kt1572757 at gmail.com>; r-help at r-project.org
>Subject: Re: [R] What is the intended behavior, when subsetting using brackets [ ], when the subset criterion has NA's?
>
>[External Email]
>
>Mmmm, ESP on the blink.
>
>WHAT error? from which line of code?
>
>BTW see The R Inferno, section 8.2.32
>
>On April 6, 2022 1:52:47 PM PDT, "Ebert,Timothy Aaron" <tebert at ufl.edu> wrote:
>>I get an error with this:
>>my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria
>>
>>
>>Tim
>>
>>-----Original Message-----
>>From: R-help <r-help-bounces at r-project.org> On Behalf Of Kelly Thompson
>>Sent: Wednesday, April 6, 2022 4:13 PM
>>To: r-help at r-project.org
>>Subject: [R] What is the intended behavior, when subsetting using brackets [ ], when the subset criterion has NA's?
>>
>>[External Email]
>>
>>I noticed that I get different results when subsetting using subset, compared to subsetting using  "brackets" when the subset criteria have NA's.
>>
>>Here's an example
>>
>>#START OF EXAMPLE
>>my_data <- 1:5
>>my_data
>>
>>my_subset_criteria <- c( F, F, T, NA, NA) my_subset_criteria
>>
>>#subsetting using subset returns the data where my_subset_criteria 
>>equals TRUE my_data[my_subset_criteria == T]
>>
>>#subsetting using brackets returns the data where my_subset_criteria 
>>equals TRUE, and also NA where my_subset_criteria is NA subset(my_data, 
>>my_subset_criteria == T)
>>
>>#END OF EXAMPLE
>>
>>This behavior is also mentioned here
>>https://urldefense.proofpoint.com/v2/url?u=https-3A__statisticaloddsand
>>ends.wordpress.com_2018_10_07_subsetting-2Din-2Dthe-2Dpresence-2Dof-2Dn
>>as_&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=NoPFkG
>>0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQDMSEW&s=5lgkxT5A_M
>>SfElILNk1ZM3RGpcBWpMBu713av1DH1mk&e=
>>
>>Q. Is this the intended behavior when subsetting with brackets?
>>
>>Thank you!
>>
>>______________________________________________
>>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>>https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailm
>>an_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRz
>>sn7AkP-g&m=NoPFkG0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQD
>>MSEW&s=g9IzSC3WrXPLYjys_RdYSmgUoFFjsbwRJZZodqtDRa0&e=
>>PLEASE do read the posting guide 
>>https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org
>>_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsR
>>zsn7AkP-g&m=NoPFkG0n9RFRaacmiiQ9Hp1cGniz9ED5YGN11-Jh6rD_zkTTE8e5egsKqzQ
>>DMSEW&s=uy6rCSNVehGynLn3ZCpLp_r2gHhoGcya4dbRe-tqQRc&e=
>>and provide commented, minimal, self-contained, reproducible code.
>>
>>______________________________________________
>>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>>https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailm
>>an_listinfo_r-2Dhelp&d=DwIFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRz
>>sn7AkP-g&m=QLbQb6DaELgtR0Qo6aQx51ea30OmGIC0oqVB_naWxmKYlQyw_N81MiAKj_5Z
>>9TXC&s=G7rw7ZKvhE_HMF4z5cA5Gsr0C018E51Ov9ye3Ui2GX0&e=
>>PLEASE do read the posting guide 
>>https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org
>>_posting-2Dguide.html&d=DwIFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsR
>>zsn7AkP-g&m=QLbQb6DaELgtR0Qo6aQx51ea30OmGIC0oqVB_naWxmKYlQyw_N81MiAKj_5
>>Z9TXC&s=PKD9VZ1n0p_NfoQ2OvbmPEVr14lVwLZx09mOIWPRZmk&e=
>>and provide commented, minimal, self-contained, reproducible code.
>
>--
>Sent from my phone. Please excuse my brevity.

-- 
Sent from my phone. Please excuse my brevity.


From roh@n@r|ch@rd @end|ng |rom roth@m@ted@@c@uk  Thu Apr  7 12:30:19 2022
From: roh@n@r|ch@rd @end|ng |rom roth@m@ted@@c@uk (Rohan Richard)
Date: Thu, 7 Apr 2022 10:30:19 +0000
Subject: [R] Package nlme
Message-ID: <CWLP123MB414834EF6B8F4F57A83F29E6DEE69@CWLP123MB4148.GBRP123.PROD.OUTLOOK.COM>

Dear Help Desk,

I am trying to perform a non-linear regression (Sigmoid curves) using the R package nlme. My field trial is a randomised complete block design (RCBD) with 3 blocks and I would like to assess the block effect in the model. Do you know how I can incorporate the block term in nlme function?

So far I tried the following code and it did not work and I an error error message:

# code
minitab$NDVI<-as.factor(minitab$NDVI)
modnlme1 <- nlme(NDVI ~ a + d / (1 + exp(-b * (DegreeDay - m)) ), data = minitab,
                 random =a + d + b + m~ 1|Block,
                 fixed = list(a ~ Lines1, d~Lines1,b ~ Lines1, m ~ Lines1),
                 weights = varPower(),
                 start=c(b=0.5,c=3,d=0.4, e=700), control = list(msMaxIter = 200))

#Error message
Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
  contrasts can be applied only to factors with 2 or more levels

Could you please kindly help me?

Thank you in advance,

Best wishes,

Rohan

Sent from Mail<https://go.microsoft.com/fwlink/?LinkId=550986> for Windows


Rothamsted Research is a company limited by guarantee, registered in England at Harpenden, Hertfordshire, AL5 2JQ under the registration number 2393175 and a not for profit charity number 802038.

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Thu Apr  7 16:12:27 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 7 Apr 2022 07:12:27 -0700
Subject: [R] Package nlme
In-Reply-To: <CWLP123MB414834EF6B8F4F57A83F29E6DEE69@CWLP123MB4148.GBRP123.PROD.OUTLOOK.COM>
References: <CWLP123MB414834EF6B8F4F57A83F29E6DEE69@CWLP123MB4148.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <CAGxFJbTnpt=2qAUDWXg=RCNNZPvCwdxojCJMRnbpWUu7UwqZAg@mail.gmail.com>

1. We are not a "help desk", in the sense of being  constituted by a
software provider for customer support. This is a forum of volunteers.
Not a big deal, but no guarantees and caveat emptor.

2. You may get a reply here, but there is another forum specifically
for nlme (and its successor, lme4), r-sig-mixed-models,
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models . You should
post there if you don't get useful help here.

3. I haven't used nlme in a long time, but your error message seems to
suggest some issue with your data. You *may* need to provide the
results of str(minitab) to get a useful answer (or I may simply not
recognize an obvious issue in what you provided in your post).

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Thu, Apr 7, 2022 at 4:29 AM Rohan Richard via R-help
<r-help at r-project.org> wrote:
>
> Dear Help Desk,
>
> I am trying to perform a non-linear regression (Sigmoid curves) using the R package nlme. My field trial is a randomised complete block design (RCBD) with 3 blocks and I would like to assess the block effect in the model. Do you know how I can incorporate the block term in nlme function?
>
> So far I tried the following code and it did not work and I an error error message:
>
> # code
> minitab$NDVI<-as.factor(minitab$NDVI)
> modnlme1 <- nlme(NDVI ~ a + d / (1 + exp(-b * (DegreeDay - m)) ), data = minitab,
>                  random =a + d + b + m~ 1|Block,
>                  fixed = list(a ~ Lines1, d~Lines1,b ~ Lines1, m ~ Lines1),
>                  weights = varPower(),
>                  start=c(b=0.5,c=3,d=0.4, e=700), control = list(msMaxIter = 200))
>
> #Error message
> Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
>   contrasts can be applied only to factors with 2 or more levels
>
> Could you please kindly help me?
>
> Thank you in advance,
>
> Best wishes,
>
> Rohan
>
> Sent from Mail<https://go.microsoft.com/fwlink/?LinkId=550986> for Windows
>
>
> Rothamsted Research is a company limited by guarantee, registered in England at Harpenden, Hertfordshire, AL5 2JQ under the registration number 2393175 and a not for profit charity number 802038.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From j|ox @end|ng |rom mcm@@ter@c@  Thu Apr  7 16:32:21 2022
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Thu, 7 Apr 2022 10:32:21 -0400
Subject: [R] Package nlme
In-Reply-To: <17215_1649330991_237BTo4x018963_CWLP123MB414834EF6B8F4F57A83F29E6DEE69@CWLP123MB4148.GBRP123.PROD.OUTLOOK.COM>
References: <17215_1649330991_237BTo4x018963_CWLP123MB414834EF6B8F4F57A83F29E6DEE69@CWLP123MB4148.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <c619428a-a2be-ba73-1f28-96a16a4e8dc3@mcmaster.ca>

Dear Rohan,

Bert Gunter has already made several general useful suggestions.

In addition, why did you make the variable on the left-hand side of the 
model a factor? Shouldn't it be a numeric variable?

I hope this helps,
  John

-- 
John Fox, Professor Emeritus
McMaster University
Hamilton, Ontarion, Canada
web: https://socialsciences.mcmaster.ca/jfox/

On 4/7/2022 6:30 AM, Rohan Richard via R-help wrote:
> Dear Help Desk,
> 
> I am trying to perform a non-linear regression (Sigmoid curves) using the R package nlme. My field trial is a randomised complete block design (RCBD) with 3 blocks and I would like to assess the block effect in the model. Do you know how I can incorporate the block term in nlme function?
> 
> So far I tried the following code and it did not work and I an error error message:
> 
> # code
> minitab$NDVI<-as.factor(minitab$NDVI)
> modnlme1 <- nlme(NDVI ~ a + d / (1 + exp(-b * (DegreeDay - m)) ), data = minitab,
>                   random =a + d + b + m~ 1|Block,
>                   fixed = list(a ~ Lines1, d~Lines1,b ~ Lines1, m ~ Lines1),
>                   weights = varPower(),
>                   start=c(b=0.5,c=3,d=0.4, e=700), control = list(msMaxIter = 200))
> 
> #Error message
> Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
>    contrasts can be applied only to factors with 2 or more levels
> 
> Could you please kindly help me?
> 
> Thank you in advance,
> 
> Best wishes,
> 
> Rohan
> 
> Sent from Mail<https://go.microsoft.com/fwlink/?LinkId=550986> for Windows
> 
> 
> Rothamsted Research is a company limited by guarantee, registered in England at Harpenden, Hertfordshire, AL5 2JQ under the registration number 2393175 and a not for profit charity number 802038.
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @@r@bortot11 @end|ng |rom gm@||@com  Thu Apr  7 18:20:14 2022
From: @@r@bortot11 @end|ng |rom gm@||@com (Sara Bortot)
Date: Thu, 7 Apr 2022 18:20:14 +0200
Subject: [R] Calculation error found
Message-ID: <CAJrH7g2DFKRQCd6rpHOCTBEhDqe=XdVfif8SiFkSp0Z=5tcFqA@mail.gmail.com>

Good evening,
I was doing some calculations with R when I noticed an error in one of
the answers.
I am attaching the screenshot of the page. There you will see that the two
calculations are written in a different way but they should give the same
result, because they're equivalent.
Let me know if it is a solvable problem,

Kind regards

From bgunter@4567 @end|ng |rom gm@||@com  Thu Apr  7 19:47:42 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 7 Apr 2022 10:47:42 -0700
Subject: [R] Calculation error found
In-Reply-To: <CAJrH7g2DFKRQCd6rpHOCTBEhDqe=XdVfif8SiFkSp0Z=5tcFqA@mail.gmail.com>
References: <CAJrH7g2DFKRQCd6rpHOCTBEhDqe=XdVfif8SiFkSp0Z=5tcFqA@mail.gmail.com>
Message-ID: <CAGxFJbQc3i83Fqng_WAyhzp-L3716NEtKPGVviBqubYhaGaS_g@mail.gmail.com>

Most attachments are stripped, as was yours.

However, even without the info, the answer is very likely FAQ 7.31.
Computer arithmetic.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Thu, Apr 7, 2022 at 10:32 AM Sara Bortot <sarabortot11 at gmail.com> wrote:
>
> Good evening,
> I was doing some calculations with R when I noticed an error in one of
> the answers.
> I am attaching the screenshot of the page. There you will see that the two
> calculations are written in a different way but they should give the same
> result, because they're equivalent.
> Let me know if it is a solvable problem,
>
> Kind regards
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From rmh @end|ng |rom temp|e@edu  Thu Apr  7 19:56:55 2022
From: rmh @end|ng |rom temp|e@edu (Richard M. Heiberger)
Date: Thu, 7 Apr 2022 17:56:55 +0000
Subject: [R] [External]  Calculation error found
In-Reply-To: <CAJrH7g2DFKRQCd6rpHOCTBEhDqe=XdVfif8SiFkSp0Z=5tcFqA@mail.gmail.com>
References: <CAJrH7g2DFKRQCd6rpHOCTBEhDqe=XdVfif8SiFkSp0Z=5tcFqA@mail.gmail.com>
Message-ID: <15F0EA2D-DEEC-4172-8851-EC5D92AE33E0@temple.edu>

Probably numerical precision.  See FAQ 7.31 which is on your computer.
Enter
     system(paste("open",file.path(base::system.file(), "../../doc/manual/R-FAQ.pdf")))
and the FAQ file will open.

x <- 20
y <- 19.99999999999999
x-y
x == y

> On Apr 07, 2022, at 12:20, Sara Bortot <sarabortot11 at gmail.com> wrote:
> 
> Good evening,
> I was doing some calculations with R when I noticed an error in one of
> the answers.
> I am attaching the screenshot of the page. There you will see that the two
> calculations are written in a different way but they should give the same
> result, because they're equivalent.
> Let me know if it is a solvable problem,
> 
> Kind regards
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7Crmh%40temple.edu%7C415d01fbba264cd4d1ad08da18bc8805%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637849495421702100%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=v0xknDQUdAFoQ7HK8fDegMcGLOHuasMkQHq9XqazQlg%3D&amp;reserved=0
> PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7Crmh%40temple.edu%7C415d01fbba264cd4d1ad08da18bc8805%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637849495421702100%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=lVntKkDO9OnmMrZslJhZU8VydPepHERDjSTSsOTb9wY%3D&amp;reserved=0
> and provide commented, minimal, self-contained, reproducible code.


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Fri Apr  8 13:55:15 2022
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Fri, 8 Apr 2022 13:55:15 +0200
Subject: [R] pam() with more general dissimilarity / distance
In-Reply-To: <CANO3P_kV_J2dQJXuA0BfsDe3LMWv5_AM6dkw0uArrPzqO6GxXg@mail.gmail.com>
References: <CANO3P_kV_J2dQJXuA0BfsDe3LMWv5_AM6dkw0uArrPzqO6GxXg@mail.gmail.com>
Message-ID: <CAPRP4-eKjjq+XgbMQwQo3SuvAbg_yWgU1yXEqSNqku+fGro89Q@mail.gmail.com>

I was asked in private, but reply in public,
so others can also find this answer in the future:

On Fri, Apr 8, 2022 at 1:11 PM  ..... wrote :
>  Hello
> dear Dr. Maechler
> I have a question about "pam" function in the cluster package. In this
> function, we choose one of the  euclidean or manhattan distances to
> calculate dissimilarity but in the mixed typed data sets the true index may
> be jaccard or other indicators.
> How can we allocate the "true" metric for each variable?
> Best regards
>

yes,  you can use pam() use in two ways;  see this part of the help page :

  Arguments:

       x: data matrix or data frame, or dissimilarity matrix or object,
          depending on the value of the ?diss? argument.

          In case of a matrix or data frame, each row corresponds to an
          observation, and each column corresponds to a variable.  All
          variables must be numeric.  Missing values (NAs) _are_
          allowed-as long as every pair of observations has at least
          one case not missing.

          In case of a dissimilarity matrix, ?x? is typically the
          output of daisy or dist.  Also a vector of length
          n*(n-1)/2 is allowed (where n is the number of observations),
          and will be interpreted in the same way as the output of the
          above-mentioned functions. Missing values (NAs) are _not_
          allowed.

So, you can first use   dx <-  daisy(x, ...)     and use the correct
distance between your observational units,
After that you can use the computed distance / dissimilarity matrix
(the `dx`)  in you call to pam():

px <- pam(dx, k=., ....)

I hope this helps you.
With best regards,
Martin

--
Martin Maechler
ETH Zurich

?


From petr@p|k@| @end|ng |rom prechez@@cz  Fri Apr  8 16:41:59 2022
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Fri, 8 Apr 2022 14:41:59 +0000
Subject: [R] [External] add equation and rsqared to plot
In-Reply-To: <9ed7092d-b142-9f6f-854e-9e5182b2b466@comcast.net>
References: <1649275105409.87603@precheza.cz>
 <4483DC96-F937-4BB8-B5A1-4485FDF590DB@temple.edu>
 <1649278042150.16601@precheza.cz>
 <95448101-08c6-045d-ff79-fb9febf3effb@comcast.net>
 <1649280964120.57655@precheza.cz>
 <9ed7092d-b142-9f6f-854e-9e5182b2b466@comcast.net>
Message-ID: <96bfd2fd05024b47a33939a9b9d4c19a@SRVEXCHCM1302.precheza.cz>

Hallo David

Fair enough. Thanks for your explanation, which told me what should be done. It works perfectly for my example but I am still confused how to get expressions given to atop (or other functions) be evaluated and help page does not enlighten me, so I am still puzzled.

When I borrow example from help,

plot(1:10, type="n", xlab="", ylab="", main = "plot math & numbers")
theta <- 1.23 ; mtext(bquote(hat(theta) == .(theta)), line= .25)
for(i in 2:9)
    text(i, i+1, substitute(list(xi, eta) == group("(",list(x,y),")"),
                            list(x = i, y = i+1)))

#this is OK
ex1 <- expression("      first: {f * minute}(x) " == {f * minute}(x))
ex2 <- expression("               second: {f * second}(x) "        == {f * second}(x))
text(1, 9.6, ex1, adj=0)
text(1, 9.0, ex2, adj=0)

#and this is not
text(2, 8, expression(atop(ex1, ex2)))
text(2, 7, substitute( atop(ex1, ex2), list(ex1=ex1,ex2=ex2)))

#and this works
text(2, 6, expression(atop(1,2)))

I tried to use eval when calling atop, but it did not work either. Therefore some hint in help page could be quite handy.

Best regards
Petr Pikal

S pozdravem | Best Regards
RNDr. Petr PIKAL
Vedouc? V?zkumu a v?voje | Research Manager
PRECHEZA a.s.
n?b?. Dr. Edvarda Bene?e 1170/24 | 750 02 P?erov | Czech Republic
Tel: +420 581 252 256 | GSM: +420 724 008 364
petr.pikal at precheza.cz | www.precheza.cz

Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information about processing and protection of business partner?s personal data are available on website: https://www.precheza.cz/en/personal-data-protection-principles/
D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en? odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://www.precheza.cz/en/01-disclaimer/

-----Original Message-----
From: David Winsemius <dwinsemius at comcast.net> 
Sent: Thursday, April 7, 2022 12:04 AM
To: PIKAL Petr <petr.pikal at precheza.cz>; Richard M. Heiberger <rmh at temple.edu>
Cc: r-help at r-project.org
Subject: Re: [R] [External] add equation and rsqared to plot


On 4/6/22 14:36, PIKAL Petr wrote:
> Hallo David
>
> Thanks for your answer. atop itself somehow cannot use expression made by substitute  although those expressions itself are correct. I asked this question after roughly two hours of unsuccessful atempts.
>
> The second substitute or bquote solves the problem. Maybe this could propagate to help page, because although atop works smoothly with simple expressions, expressions with substitute are treated in a wrong way (at least by my opinion).


It's not a problem with `atop`. It's a problem with your understanding of how R expressions and plotmath functions work. The argument(s) to `expression` are not evaluated. So `atop` was given two expressions `eq` and `req` and they in turn were not evaluated .... just taken as text values inside atop. Using either `substitute` (with a second argument
list) or bquote (with its special dot function) forces evaluation by getting from the R symbol table those expressions which you had assigned as values of the symbols `eq` and `req`.

The plotmath functions (not just atop but also `paste`, `frac`, `over` and all the rest on the ?plotmath pafge),? are designed to be "like" 
`expression` in not evaluating their arguments unless a "special value" 
like a Greek letter name or a defined %<op>% is found. Those functions are handled with a different parser than regular R functions. So they are not designed to go out to the R symbol table (which is where even locally defined object names are kept) to find values.


Hope this helps;

David.


-- 

David.

>
> Thanks again.
>
> Best regards.
> Petr
>
>
> ________________________________________
> Od: David Winsemius <dwinsemius at comcast.net>
> Odesl?no: 6. dubna 2022 23:20
> Komu: PIKAL Petr; Richard M. Heiberger
> Kopie: r-help at r-project.org
> P?edm?t: Re: [R] [External] add equation and rsqared to plot
>
> Try this:
>
>
> lm_eqn = function(m) {
>       l <- list(a = format(coef(m)[1], digits = 4),
>                 b = format(abs(coef(m)[2]), digits = 4),
>                 r2 = format(summary(m)$r.squared, digits = 3),
>                 r2adj = format(summary(m)$adj.r.squared, digits = 3));
>       if (coef(m)[2] >= 0)  {
>           eq <- substitute(italic(y) == a + b %.% italic(x), l)
>       } else {
>           eq <- substitute(italic(y) == a - b %.% italic(x),l)
>
>       }
>       req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
>       a_regs <- substitute( atop(eq, req), list(eq=eq,req=req)) }
>
> --
>
> David.
>
> On 4/6/22 13:47, PIKAL Petr wrote:
>> Hallo Richard.
>>
>> Did you try the example? I Used atop but with the syntax I made, the 
>> result is
>>
>> eq
>> req
>>
>> but not the equations.
>>
>> I send the picture, but I am not sure if it will go through.
>>
>> Best regards
>> Petr
>>
>> ________________________________________
>> Od: Richard M. Heiberger <rmh at temple.edu>
>> Odesl?no: 6. dubna 2022 22:36
>> Komu: PIKAL Petr
>> Kopie: r-help at r-project.org
>> P?edm?t: Re: [External] [R] add equation and rsqared to plot
>>
>> I think you are looking for atop(a,b) See ? plotmath
>>
>>> On Apr 06, 2022, at 15:58, PIKAL Petr <petr.pikal at precheza.cz> wrote:
>>>
>>> Dear all
>>>
>>>
>>> I want to add equation and rsquared values to plot and I am lost in correct expression form. I want to have 2 lines, one with equation and one with r squared values.
>>>
>>>
>>> Here is what I made.
>>>
>>> # function to extract values from lm fit.
>>>
>>>
>>> lm_eqn = function(m) {
>>>    l <- list(a = format(coef(m)[1], digits = 4),
>>>        b = format(abs(coef(m)[2]), digits = 4),
>>>        r2 = format(summary(m)$r.squared, digits = 3),
>>>        r2adj = format(summary(m)$adj.r.squared, digits = 3));
>>>    if (coef(m)[2] >= 0)  {
>>>      eq <- substitute(italic(y) == a + b %.% italic(x), l)
>>>    } else {
>>>      eq <- substitute(italic(y) == a - b %.% italic(x),l)
>>>
>>>    }
>>>    req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
>>>    expression(atop(eq, req))
>>> }
>>>
>>>
>>> #Example
>>>
>>> x <- 1:10
>>> y <- x*5 +rnorm(10)
>>> plot(x,y)
>>> fit <- lm(y~x)
>>> text(4,40, lm_eqn(fit))
>>>
>>>
>>> I know that both eq and req are correct expressions and when the last line in function is either eq or req, the example gives correct result.
>>>
>>>
>>> But how to get both expressions one above the other is mystery.
>>>
>>> Please help.
>>>
>>>
>>> Best regards.
>>>
>>> Petr
>>>
>>>
>>>
>>> Osobn   daje: Informace o zpracov n  a ochran  osobn ch  daj  
>>> obchodn ch partner  PRECHEZA a.s. jsou zve ejn ny na: 
>>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
>>> w.precheza.cz%2Fzasady-ochrany-osobnich-udaju%2F&amp;data=04%7C01%7C
>>> rmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244
>>> 738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZs
>>> b3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%
>>> 3D%7C3000&amp;sdata=MBtbONfsiMExWy0uorZMR1DglZindxErRMsooTztfUo%3D&a
>>> mp;reserved=0 | Information about processing and protection of 
>>> business partner's personal data are available on website: 
>>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
>>> w.precheza.cz%2Fen%2Fpersonal-data-protection-principles%2F&amp;data
>>> =04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716
>>> e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown
>>> %7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiL
>>> CJXVCI6Mn0%3D%7C3000&amp;sdata=2YDPoejYRlphL6h%2FWFmEEyR44KdmH2GDC9r
>>> dLhFn4aU%3D&amp;reserved=0
>>> D v rnost: Tento e-mail a jak koliv k n mu p ipojen  dokumenty jsou 
>>> d v rn  a podl haj  tomuto pr vn  z vazn mu prohl en  o vylou en  
>>> odpov dnosti: 
>>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
>>> w.precheza.cz%2F01-dovetek%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C
>>> 3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%
>>> 7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjA
>>> wMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata
>>> =z7TNZSbfNXlB%2FZt0ekl8P1kTu1l0eBFVoLvewSSdQDg%3D&amp;reserved=0 | 
>>> This email and any documents attached to it may be confidential and 
>>> are subject to the legally binding disclaimer: 
>>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
>>> w.precheza.cz%2Fen%2F01-disclaimer%2F&amp;data=04%7C01%7Crmh%40templ
>>> e.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd0
>>> 2ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjo
>>> iMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&a
>>> mp;sdata=RCUE7DJbn54MvhWX4bqiNtPzoJLl7NK9tieMlFpe2rg%3D&amp;reserved
>>> =0
>>>
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide 
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? 
>> obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: 
>> https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information 
>> about processing and protection of business partner?s personal data 
>> are available on website: 
>> https://www.precheza.cz/en/personal-data-protection-principles/
>> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou 
>> d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en? 
>> odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and 
>> any documents attached to it may be confidential and are subject to 
>> the legally binding disclaimer: 
>> https://www.precheza.cz/en/01-disclaimer/
>>
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.

From bgunter@4567 @end|ng |rom gm@||@com  Fri Apr  8 18:49:14 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 8 Apr 2022 09:49:14 -0700
Subject: [R] [External] add equation and rsqared to plot
In-Reply-To: <96bfd2fd05024b47a33939a9b9d4c19a@SRVEXCHCM1302.precheza.cz>
References: <1649275105409.87603@precheza.cz>
 <4483DC96-F937-4BB8-B5A1-4485FDF590DB@temple.edu>
 <1649278042150.16601@precheza.cz>
 <95448101-08c6-045d-ff79-fb9febf3effb@comcast.net>
 <1649280964120.57655@precheza.cz>
 <9ed7092d-b142-9f6f-854e-9e5182b2b466@comcast.net>
 <96bfd2fd05024b47a33939a9b9d4c19a@SRVEXCHCM1302.precheza.cz>
Message-ID: <CAGxFJbToLSGpNxxnJAwMVO59JJJrnY6yiwvxGCu6HFsYpCfBjA@mail.gmail.com>

Yes, I also find it somewhat confusing. Perhaps this will help. I
apologize beforehand if I have misunderstood and you already know all
this.

The key is to realize that plotmath works with **expressions**,
unevaluated forms that include special plotmath keywords, like 'atop',
and symbols. So...

## simple example with plotmath used in plot's title

## This will produce an error, as 'atop' is not an R function:
plot(1,1, main = atop(x,y))

## to make this work, we need an expression on the rhs of 'main =' . A
simple way to do this is to use quote():

plot(1,1,main = quote(atop(x,y)))

## Note that this produce 'x' above 'y' **without quoting x and y**.
That's because
## this is an expression that plotmath parses and evaluates according
to its own rules,
## shown in ?plotmath

## Now suppose we have:
x <- 'first line'
y <- 'second line'

## and we want to display these quoted strings instead of 'x' and 'y'
in the title

## Then this will *not* work -- it gives the same result as before:
plot(1,1,main = quote(atop(x,y)))

## So what is needed here is R's 'computing on the language"
capability to substitute
## the quoted strings for x and y in the expression. Here are two
simple ways to do this:

## First using substitute()

plot(1,1, main = substitute(atop(x,y), list (x =x, y = y)))

## Second, using bquote()

plot(1,1, main = bquote(atop(.(x), .(y))))

## More complicated expressions can be built up using plotmath's rules.
## But you need to be careful about distinguishing plotmath expressions and
## ordinary R expressions. For example:

x <- pi/4  ## a number

## WRONG -- will display as written. bquote() is the same as quote() here.
plot(1,1, main = bquote(sin(pi/4) == round(x,2)))

## WRONG -- will substitute value of x rounded to session default
## in previous. This is a mistake in using bquote
plot(1,1, main = bquote(sin(pi/4) == round(.(x), 2)))

## RIGHT -- use of bquote
plot(1,1, main = bquote(sin(pi/4) == .(round(x,2))))
## or -- using substitute
plot(1,1, main = substitute(sin(pi/4) == x, list(x = round(x,2))))

Hope this is helpful and, again, apologies if I have misunderstood.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Fri, Apr 8, 2022 at 7:42 AM PIKAL Petr <petr.pikal at precheza.cz> wrote:
>
> Hallo David
>
> Fair enough. Thanks for your explanation, which told me what should be done. It works perfectly for my example but I am still confused how to get expressions given to atop (or other functions) be evaluated and help page does not enlighten me, so I am still puzzled.
>
> When I borrow example from help,
>
> plot(1:10, type="n", xlab="", ylab="", main = "plot math & numbers")
> theta <- 1.23 ; mtext(bquote(hat(theta) == .(theta)), line= .25)
> for(i in 2:9)
>     text(i, i+1, substitute(list(xi, eta) == group("(",list(x,y),")"),
>                             list(x = i, y = i+1)))
>
> #this is OK
> ex1 <- expression("      first: {f * minute}(x) " == {f * minute}(x))
> ex2 <- expression("               second: {f * second}(x) "        == {f * second}(x))
> text(1, 9.6, ex1, adj=0)
> text(1, 9.0, ex2, adj=0)
>
> #and this is not
> text(2, 8, expression(atop(ex1, ex2)))
> text(2, 7, substitute( atop(ex1, ex2), list(ex1=ex1,ex2=ex2)))
>
> #and this works
> text(2, 6, expression(atop(1,2)))
>
> I tried to use eval when calling atop, but it did not work either. Therefore some hint in help page could be quite handy.
>
> Best regards
> Petr Pikal
>
> S pozdravem | Best Regards
> RNDr. Petr PIKAL
> Vedouc? V?zkumu a v?voje | Research Manager
> PRECHEZA a.s.
> n?b?. Dr. Edvarda Bene?e 1170/24 | 750 02 P?erov | Czech Republic
> Tel: +420 581 252 256 | GSM: +420 724 008 364
> petr.pikal at precheza.cz | www.precheza.cz
>
> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information about processing and protection of business partner?s personal data are available on website: https://www.precheza.cz/en/personal-data-protection-principles/
> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en? odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://www.precheza.cz/en/01-disclaimer/
>
> -----Original Message-----
> From: David Winsemius <dwinsemius at comcast.net>
> Sent: Thursday, April 7, 2022 12:04 AM
> To: PIKAL Petr <petr.pikal at precheza.cz>; Richard M. Heiberger <rmh at temple.edu>
> Cc: r-help at r-project.org
> Subject: Re: [R] [External] add equation and rsqared to plot
>
>
> On 4/6/22 14:36, PIKAL Petr wrote:
> > Hallo David
> >
> > Thanks for your answer. atop itself somehow cannot use expression made by substitute  although those expressions itself are correct. I asked this question after roughly two hours of unsuccessful atempts.
> >
> > The second substitute or bquote solves the problem. Maybe this could propagate to help page, because although atop works smoothly with simple expressions, expressions with substitute are treated in a wrong way (at least by my opinion).
>
>
> It's not a problem with `atop`. It's a problem with your understanding of how R expressions and plotmath functions work. The argument(s) to `expression` are not evaluated. So `atop` was given two expressions `eq` and `req` and they in turn were not evaluated .... just taken as text values inside atop. Using either `substitute` (with a second argument
> list) or bquote (with its special dot function) forces evaluation by getting from the R symbol table those expressions which you had assigned as values of the symbols `eq` and `req`.
>
> The plotmath functions (not just atop but also `paste`, `frac`, `over` and all the rest on the ?plotmath pafge),  are designed to be "like"
> `expression` in not evaluating their arguments unless a "special value"
> like a Greek letter name or a defined %<op>% is found. Those functions are handled with a different parser than regular R functions. So they are not designed to go out to the R symbol table (which is where even locally defined object names are kept) to find values.
>
>
> Hope this helps;
>
> David.
>
>
> --
>
> David.
>
> >
> > Thanks again.
> >
> > Best regards.
> > Petr
> >
> >
> > ________________________________________
> > Od: David Winsemius <dwinsemius at comcast.net>
> > Odesl?no: 6. dubna 2022 23:20
> > Komu: PIKAL Petr; Richard M. Heiberger
> > Kopie: r-help at r-project.org
> > P?edm?t: Re: [R] [External] add equation and rsqared to plot
> >
> > Try this:
> >
> >
> > lm_eqn = function(m) {
> >       l <- list(a = format(coef(m)[1], digits = 4),
> >                 b = format(abs(coef(m)[2]), digits = 4),
> >                 r2 = format(summary(m)$r.squared, digits = 3),
> >                 r2adj = format(summary(m)$adj.r.squared, digits = 3));
> >       if (coef(m)[2] >= 0)  {
> >           eq <- substitute(italic(y) == a + b %.% italic(x), l)
> >       } else {
> >           eq <- substitute(italic(y) == a - b %.% italic(x),l)
> >
> >       }
> >       req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
> >       a_regs <- substitute( atop(eq, req), list(eq=eq,req=req)) }
> >
> > --
> >
> > David.
> >
> > On 4/6/22 13:47, PIKAL Petr wrote:
> >> Hallo Richard.
> >>
> >> Did you try the example? I Used atop but with the syntax I made, the
> >> result is
> >>
> >> eq
> >> req
> >>
> >> but not the equations.
> >>
> >> I send the picture, but I am not sure if it will go through.
> >>
> >> Best regards
> >> Petr
> >>
> >> ________________________________________
> >> Od: Richard M. Heiberger <rmh at temple.edu>
> >> Odesl?no: 6. dubna 2022 22:36
> >> Komu: PIKAL Petr
> >> Kopie: r-help at r-project.org
> >> P?edm?t: Re: [External] [R] add equation and rsqared to plot
> >>
> >> I think you are looking for atop(a,b) See ? plotmath
> >>
> >>> On Apr 06, 2022, at 15:58, PIKAL Petr <petr.pikal at precheza.cz> wrote:
> >>>
> >>> Dear all
> >>>
> >>>
> >>> I want to add equation and rsquared values to plot and I am lost in correct expression form. I want to have 2 lines, one with equation and one with r squared values.
> >>>
> >>>
> >>> Here is what I made.
> >>>
> >>> # function to extract values from lm fit.
> >>>
> >>>
> >>> lm_eqn = function(m) {
> >>>    l <- list(a = format(coef(m)[1], digits = 4),
> >>>        b = format(abs(coef(m)[2]), digits = 4),
> >>>        r2 = format(summary(m)$r.squared, digits = 3),
> >>>        r2adj = format(summary(m)$adj.r.squared, digits = 3));
> >>>    if (coef(m)[2] >= 0)  {
> >>>      eq <- substitute(italic(y) == a + b %.% italic(x), l)
> >>>    } else {
> >>>      eq <- substitute(italic(y) == a - b %.% italic(x),l)
> >>>
> >>>    }
> >>>    req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
> >>>    expression(atop(eq, req))
> >>> }
> >>>
> >>>
> >>> #Example
> >>>
> >>> x <- 1:10
> >>> y <- x*5 +rnorm(10)
> >>> plot(x,y)
> >>> fit <- lm(y~x)
> >>> text(4,40, lm_eqn(fit))
> >>>
> >>>
> >>> I know that both eq and req are correct expressions and when the last line in function is either eq or req, the example gives correct result.
> >>>
> >>>
> >>> But how to get both expressions one above the other is mystery.
> >>>
> >>> Please help.
> >>>
> >>>
> >>> Best regards.
> >>>
> >>> Petr
> >>>
> >>>
> >>>
> >>> Osobn   daje: Informace o zpracov n  a ochran  osobn ch  daj
> >>> obchodn ch partner  PRECHEZA a.s. jsou zve ejn ny na:
> >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
> >>> w.precheza.cz%2Fzasady-ochrany-osobnich-udaju%2F&amp;data=04%7C01%7C
> >>> rmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244
> >>> 738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZs
> >>> b3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%
> >>> 3D%7C3000&amp;sdata=MBtbONfsiMExWy0uorZMR1DglZindxErRMsooTztfUo%3D&a
> >>> mp;reserved=0 | Information about processing and protection of
> >>> business partner's personal data are available on website:
> >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
> >>> w.precheza.cz%2Fen%2Fpersonal-data-protection-principles%2F&amp;data
> >>> =04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716
> >>> e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown
> >>> %7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiL
> >>> CJXVCI6Mn0%3D%7C3000&amp;sdata=2YDPoejYRlphL6h%2FWFmEEyR44KdmH2GDC9r
> >>> dLhFn4aU%3D&amp;reserved=0
> >>> D v rnost: Tento e-mail a jak koliv k n mu p ipojen  dokumenty jsou
> >>> d v rn  a podl haj  tomuto pr vn  z vazn mu prohl en  o vylou en
> >>> odpov dnosti:
> >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
> >>> w.precheza.cz%2F01-dovetek%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C
> >>> 3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%
> >>> 7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjA
> >>> wMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata
> >>> =z7TNZSbfNXlB%2FZt0ekl8P1kTu1l0eBFVoLvewSSdQDg%3D&amp;reserved=0 |
> >>> This email and any documents attached to it may be confidential and
> >>> are subject to the legally binding disclaimer:
> >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
> >>> w.precheza.cz%2Fen%2F01-disclaimer%2F&amp;data=04%7C01%7Crmh%40templ
> >>> e.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd0
> >>> 2ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjo
> >>> iMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&a
> >>> mp;sdata=RCUE7DJbn54MvhWX4bqiNtPzoJLl7NK9tieMlFpe2rg%3D&amp;reserved
> >>> =0
> >>>
> >>>
> >>>         [[alternative HTML version deleted]]
> >>>
> >>> ______________________________________________
> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>> PLEASE do read the posting guide
> >>> http://www.R-project.org/posting-guide.html
> >>> and provide commented, minimal, self-contained, reproducible code.
> >> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj?
> >> obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na:
> >> https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information
> >> about processing and protection of business partner?s personal data
> >> are available on website:
> >> https://www.precheza.cz/en/personal-data-protection-principles/
> >> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou
> >> d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en?
> >> odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and
> >> any documents attached to it may be confidential and are subject to
> >> the legally binding disclaimer:
> >> https://www.precheza.cz/en/01-disclaimer/
> >>
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> >> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From w||||@mwdun|@p @end|ng |rom gm@||@com  Fri Apr  8 18:49:28 2022
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Fri, 8 Apr 2022 09:49:28 -0700
Subject: [R] [External] add equation and rsqared to plot
In-Reply-To: <96bfd2fd05024b47a33939a9b9d4c19a@SRVEXCHCM1302.precheza.cz>
References: <1649275105409.87603@precheza.cz>
 <4483DC96-F937-4BB8-B5A1-4485FDF590DB@temple.edu>
 <1649278042150.16601@precheza.cz>
 <95448101-08c6-045d-ff79-fb9febf3effb@comcast.net>
 <1649280964120.57655@precheza.cz>
 <9ed7092d-b142-9f6f-854e-9e5182b2b466@comcast.net>
 <96bfd2fd05024b47a33939a9b9d4c19a@SRVEXCHCM1302.precheza.cz>
Message-ID: <CAHqSRuQqj2BonjvYhitZo59NUEai67Ssre2==c01B2xUW+CNqA@mail.gmail.com>

#this is OK
ex1 <- expression("      first: {f * minute}(x) " == {f * minute}(x))
ex2 <- expression("               second: {f * second}(x) "        == {f *
second}(x))
text(1, 9.6, ex1, adj=0)
text(1, 9.0, ex2, adj=0)


#and this is not
text(2, 8, expression(atop(ex1, ex2)))
text(2, 7, substitute( atop(ex1, ex2), list(ex1=ex1,ex2=ex2)))

Plotmath does not like 'expression' objects inside of the expressions or
calls that you pass it.   You would be better off using quote() instead of
expression(), or at least learning how they differ.
           plot(1:10)

q1 <- quote("      first: {f * minute}(x) "=={f * minute}(x))
q2 <- quote("second: {f * second}(x) "=={f * second}(x))
text(1, 9.6, q1, adj=0)
text(1, 9.0, q2, adj=0)


# text(2, 8, expression(atop(q1, q2))) # quote() or expression(), this will
not look up values of ex1 or ex2
text(6, 3, substitute( atop(q1, q2), list(q1=q1,q2=q2)))


Looking at the output of substitute directly may help you understand the
difference between quote and expression.  expression(...) produces a
list-like object containing any number of language objects and quote(...)
produces a single language object.

> e <- expression(x^2)
> q <- quote(x^2)
> substitute(sin(e), list(e=e))
sin(expression(x^2))
> substitute(sin(q), list(q=q))
sin(x^2)


-Bill

On Fri, Apr 8, 2022 at 7:42 AM PIKAL Petr <petr.pikal at precheza.cz> wrote:

> Hallo David
>
> Fair enough. Thanks for your explanation, which told me what should be
> done. It works perfectly for my example but I am still confused how to get
> expressions given to atop (or other functions) be evaluated and help page
> does not enlighten me, so I am still puzzled.
>
> When I borrow example from help,
>
> plot(1:10, type="n", xlab="", ylab="", main = "plot math & numbers")
> theta <- 1.23 ; mtext(bquote(hat(theta) == .(theta)), line= .25)
> for(i in 2:9)
>     text(i, i+1, substitute(list(xi, eta) == group("(",list(x,y),")"),
>                             list(x = i, y = i+1)))
>
> #this is OK
> ex1 <- expression("      first: {f * minute}(x) " == {f * minute}(x))
> ex2 <- expression("               second: {f * second}(x) "        == {f *
> second}(x))
> text(1, 9.6, ex1, adj=0)
> text(1, 9.0, ex2, adj=0)
>
> #and this is not
> text(2, 8, expression(atop(ex1, ex2)))
> text(2, 7, substitute( atop(ex1, ex2), list(ex1=ex1,ex2=ex2)))
>
> #and this works
> text(2, 6, expression(atop(1,2)))
>
> I tried to use eval when calling atop, but it did not work either.
> Therefore some hint in help page could be quite handy.
>
> Best regards
> Petr Pikal
>
> S pozdravem | Best Regards
> RNDr. Petr PIKAL
> Vedouc? V?zkumu a v?voje | Research Manager
> PRECHEZA a.s.
> n?b?. Dr. Edvarda Bene?e 1170/24 | 750 02 P?erov | Czech Republic
> Tel: +420 581 252 256 | GSM: +420 724 008 364
> petr.pikal at precheza.cz | www.precheza.cz
>
> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch
> partner? PRECHEZA a.s. jsou zve?ejn?ny na:
> https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information
> about processing and protection of business partner?s personal data are
> available on website:
> https://www.precheza.cz/en/personal-data-protection-principles/
> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou
> d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en?
> odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and any
> documents attached to it may be confidential and are subject to the legally
> binding disclaimer: https://www.precheza.cz/en/01-disclaimer/
>
> -----Original Message-----
> From: David Winsemius <dwinsemius at comcast.net>
> Sent: Thursday, April 7, 2022 12:04 AM
> To: PIKAL Petr <petr.pikal at precheza.cz>; Richard M. Heiberger <
> rmh at temple.edu>
> Cc: r-help at r-project.org
> Subject: Re: [R] [External] add equation and rsqared to plot
>
>
> On 4/6/22 14:36, PIKAL Petr wrote:
> > Hallo David
> >
> > Thanks for your answer. atop itself somehow cannot use expression made
> by substitute  although those expressions itself are correct. I asked this
> question after roughly two hours of unsuccessful atempts.
> >
> > The second substitute or bquote solves the problem. Maybe this could
> propagate to help page, because although atop works smoothly with simple
> expressions, expressions with substitute are treated in a wrong way (at
> least by my opinion).
>
>
> It's not a problem with `atop`. It's a problem with your understanding of
> how R expressions and plotmath functions work. The argument(s) to
> `expression` are not evaluated. So `atop` was given two expressions `eq`
> and `req` and they in turn were not evaluated .... just taken as text
> values inside atop. Using either `substitute` (with a second argument
> list) or bquote (with its special dot function) forces evaluation by
> getting from the R symbol table those expressions which you had assigned as
> values of the symbols `eq` and `req`.
>
> The plotmath functions (not just atop but also `paste`, `frac`, `over` and
> all the rest on the ?plotmath pafge),  are designed to be "like"
> `expression` in not evaluating their arguments unless a "special value"
> like a Greek letter name or a defined %<op>% is found. Those functions are
> handled with a different parser than regular R functions. So they are not
> designed to go out to the R symbol table (which is where even locally
> defined object names are kept) to find values.
>
>
> Hope this helps;
>
> David.
>
>
> --
>
> David.
>
> >
> > Thanks again.
> >
> > Best regards.
> > Petr
> >
> >
> > ________________________________________
> > Od: David Winsemius <dwinsemius at comcast.net>
> > Odesl?no: 6. dubna 2022 23:20
> > Komu: PIKAL Petr; Richard M. Heiberger
> > Kopie: r-help at r-project.org
> > P?edm?t: Re: [R] [External] add equation and rsqared to plot
> >
> > Try this:
> >
> >
> > lm_eqn = function(m) {
> >       l <- list(a = format(coef(m)[1], digits = 4),
> >                 b = format(abs(coef(m)[2]), digits = 4),
> >                 r2 = format(summary(m)$r.squared, digits = 3),
> >                 r2adj = format(summary(m)$adj.r.squared, digits = 3));
> >       if (coef(m)[2] >= 0)  {
> >           eq <- substitute(italic(y) == a + b %.% italic(x), l)
> >       } else {
> >           eq <- substitute(italic(y) == a - b %.% italic(x),l)
> >
> >       }
> >       req <- substitute(italic(r)^2~"="~r2*
> ","~~italic(adj.r)^2~"="~r2adj,l)
> >       a_regs <- substitute( atop(eq, req), list(eq=eq,req=req)) }
> >
> > --
> >
> > David.
> >
> > On 4/6/22 13:47, PIKAL Petr wrote:
> >> Hallo Richard.
> >>
> >> Did you try the example? I Used atop but with the syntax I made, the
> >> result is
> >>
> >> eq
> >> req
> >>
> >> but not the equations.
> >>
> >> I send the picture, but I am not sure if it will go through.
> >>
> >> Best regards
> >> Petr
> >>
> >> ________________________________________
> >> Od: Richard M. Heiberger <rmh at temple.edu>
> >> Odesl?no: 6. dubna 2022 22:36
> >> Komu: PIKAL Petr
> >> Kopie: r-help at r-project.org
> >> P?edm?t: Re: [External] [R] add equation and rsqared to plot
> >>
> >> I think you are looking for atop(a,b) See ? plotmath
> >>
> >>> On Apr 06, 2022, at 15:58, PIKAL Petr <petr.pikal at precheza.cz> wrote:
> >>>
> >>> Dear all
> >>>
> >>>
> >>> I want to add equation and rsquared values to plot and I am lost in
> correct expression form. I want to have 2 lines, one with equation and one
> with r squared values.
> >>>
> >>>
> >>> Here is what I made.
> >>>
> >>> # function to extract values from lm fit.
> >>>
> >>>
> >>> lm_eqn = function(m) {
> >>>    l <- list(a = format(coef(m)[1], digits = 4),
> >>>        b = format(abs(coef(m)[2]), digits = 4),
> >>>        r2 = format(summary(m)$r.squared, digits = 3),
> >>>        r2adj = format(summary(m)$adj.r.squared, digits = 3));
> >>>    if (coef(m)[2] >= 0)  {
> >>>      eq <- substitute(italic(y) == a + b %.% italic(x), l)
> >>>    } else {
> >>>      eq <- substitute(italic(y) == a - b %.% italic(x),l)
> >>>
> >>>    }
> >>>    req <- substitute(italic(r)^2~"="~r2*
> ","~~italic(adj.r)^2~"="~r2adj,l)
> >>>    expression(atop(eq, req))
> >>> }
> >>>
> >>>
> >>> #Example
> >>>
> >>> x <- 1:10
> >>> y <- x*5 +rnorm(10)
> >>> plot(x,y)
> >>> fit <- lm(y~x)
> >>> text(4,40, lm_eqn(fit))
> >>>
> >>>
> >>> I know that both eq and req are correct expressions and when the last
> line in function is either eq or req, the example gives correct result.
> >>>
> >>>
> >>> But how to get both expressions one above the other is mystery.
> >>>
> >>> Please help.
> >>>
> >>>
> >>> Best regards.
> >>>
> >>> Petr
> >>>
> >>>
> >>>
> >>> Osobn   daje: Informace o zpracov n  a ochran  osobn ch  daj
> >>> obchodn ch partner  PRECHEZA a.s. jsou zve ejn ny na:
> >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
> >>> w.precheza.cz%2Fzasady-ochrany-osobnich-udaju%2F&amp;data=04%7C01%7C
> >>> rmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244
> >>> 738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZs
> >>> b3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%
> >>> 3D%7C3000&amp;sdata=MBtbONfsiMExWy0uorZMR1DglZindxErRMsooTztfUo%3D&a
> >>> mp;reserved=0 | Information about processing and protection of
> >>> business partner's personal data are available on website:
> >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
> >>> w.precheza.cz%2Fen%2Fpersonal-data-protection-principles%2F&amp;data
> >>> =04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716
> >>> e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown
> >>> %7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiL
> >>> CJXVCI6Mn0%3D%7C3000&amp;sdata=2YDPoejYRlphL6h%2FWFmEEyR44KdmH2GDC9r
> >>> dLhFn4aU%3D&amp;reserved=0
> >>> D v rnost: Tento e-mail a jak koliv k n mu p ipojen  dokumenty jsou
> >>> d v rn  a podl haj  tomuto pr vn  z vazn mu prohl en  o vylou en
> >>> odpov dnosti:
> >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
> >>> w.precheza.cz%2F01-dovetek%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C
> >>> 3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%
> >>> 7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjA
> >>> wMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata
> >>> =z7TNZSbfNXlB%2FZt0ekl8P1kTu1l0eBFVoLvewSSdQDg%3D&amp;reserved=0 |
> >>> This email and any documents attached to it may be confidential and
> >>> are subject to the legally binding disclaimer:
> >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
> >>> w.precheza.cz%2Fen%2F01-disclaimer%2F&amp;data=04%7C01%7Crmh%40templ
> >>> e.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd0
> >>> 2ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjo
> >>> iMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&a
> >>> mp;sdata=RCUE7DJbn54MvhWX4bqiNtPzoJLl7NK9tieMlFpe2rg%3D&amp;reserved
> >>> =0
> >>>
> >>>
> >>>         [[alternative HTML version deleted]]
> >>>
> >>> ______________________________________________
> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>> PLEASE do read the posting guide
> >>> http://www.R-project.org/posting-guide.html
> >>> and provide commented, minimal, self-contained, reproducible code.
> >> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj?
> >> obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na:
> >> https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information
> >> about processing and protection of business partner?s personal data
> >> are available on website:
> >> https://www.precheza.cz/en/personal-data-protection-principles/
> >> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou
> >> d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en?
> >> odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and
> >> any documents attached to it may be confidential and are subject to
> >> the legally binding disclaimer:
> >> https://www.precheza.cz/en/01-disclaimer/
> >>
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> >> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Fri Apr  8 19:05:54 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 8 Apr 2022 10:05:54 -0700
Subject: [R] [External] add equation and rsqared to plot
In-Reply-To: <CAGxFJbToLSGpNxxnJAwMVO59JJJrnY6yiwvxGCu6HFsYpCfBjA@mail.gmail.com>
References: <1649275105409.87603@precheza.cz>
 <4483DC96-F937-4BB8-B5A1-4485FDF590DB@temple.edu>
 <1649278042150.16601@precheza.cz>
 <95448101-08c6-045d-ff79-fb9febf3effb@comcast.net>
 <1649280964120.57655@precheza.cz>
 <9ed7092d-b142-9f6f-854e-9e5182b2b466@comcast.net>
 <96bfd2fd05024b47a33939a9b9d4c19a@SRVEXCHCM1302.precheza.cz>
 <CAGxFJbToLSGpNxxnJAwMVO59JJJrnY6yiwvxGCu6HFsYpCfBjA@mail.gmail.com>
Message-ID: <CAGxFJbQwXkqNQeTwFsjBi=CXNNeid9jU70rGDznytpzQa8arUQ@mail.gmail.com>

... and at the risk of boring you further, a more complicated example

## similar to my previous example:
x <- pi/4
y <- pi/3
plot(1,1, main = bquote(frac(sin(pi/3),sin(pi/4)) ==
                  .(round(y/x, 3))))

## or:
## Note here that the .()  doesn't actually substitute, but, as above,
allows the
## expression inside .() to be parsed and evaluated with R's usual rules,
## NOT plotmath's

plot(1,1, main = bquote(frac(sin(pi/3),sin(pi/4)) ==
                           .(round((pi/3) /(pi/4), 3))))

Bert

On Fri, Apr 8, 2022 at 9:49 AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> Yes, I also find it somewhat confusing. Perhaps this will help. I
> apologize beforehand if I have misunderstood and you already know all
> this.
>
> The key is to realize that plotmath works with **expressions**,
> unevaluated forms that include special plotmath keywords, like 'atop',
> and symbols. So...
>
> ## simple example with plotmath used in plot's title
>
> ## This will produce an error, as 'atop' is not an R function:
> plot(1,1, main = atop(x,y))
>
> ## to make this work, we need an expression on the rhs of 'main =' . A
> simple way to do this is to use quote():
>
> plot(1,1,main = quote(atop(x,y)))
>
> ## Note that this produce 'x' above 'y' **without quoting x and y**.
> That's because
> ## this is an expression that plotmath parses and evaluates according
> to its own rules,
> ## shown in ?plotmath
>
> ## Now suppose we have:
> x <- 'first line'
> y <- 'second line'
>
> ## and we want to display these quoted strings instead of 'x' and 'y'
> in the title
>
> ## Then this will *not* work -- it gives the same result as before:
> plot(1,1,main = quote(atop(x,y)))
>
> ## So what is needed here is R's 'computing on the language"
> capability to substitute
> ## the quoted strings for x and y in the expression. Here are two
> simple ways to do this:
>
> ## First using substitute()
>
> plot(1,1, main = substitute(atop(x,y), list (x =x, y = y)))
>
> ## Second, using bquote()
>
> plot(1,1, main = bquote(atop(.(x), .(y))))
>
> ## More complicated expressions can be built up using plotmath's rules.
> ## But you need to be careful about distinguishing plotmath expressions and
> ## ordinary R expressions. For example:
>
> x <- pi/4  ## a number
>
> ## WRONG -- will display as written. bquote() is the same as quote() here.
> plot(1,1, main = bquote(sin(pi/4) == round(x,2)))
>
> ## WRONG -- will substitute value of x rounded to session default
> ## in previous. This is a mistake in using bquote
> plot(1,1, main = bquote(sin(pi/4) == round(.(x), 2)))
>
> ## RIGHT -- use of bquote
> plot(1,1, main = bquote(sin(pi/4) == .(round(x,2))))
> ## or -- using substitute
> plot(1,1, main = substitute(sin(pi/4) == x, list(x = round(x,2))))
>
> Hope this is helpful and, again, apologies if I have misunderstood.
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> On Fri, Apr 8, 2022 at 7:42 AM PIKAL Petr <petr.pikal at precheza.cz> wrote:
> >
> > Hallo David
> >
> > Fair enough. Thanks for your explanation, which told me what should be done. It works perfectly for my example but I am still confused how to get expressions given to atop (or other functions) be evaluated and help page does not enlighten me, so I am still puzzled.
> >
> > When I borrow example from help,
> >
> > plot(1:10, type="n", xlab="", ylab="", main = "plot math & numbers")
> > theta <- 1.23 ; mtext(bquote(hat(theta) == .(theta)), line= .25)
> > for(i in 2:9)
> >     text(i, i+1, substitute(list(xi, eta) == group("(",list(x,y),")"),
> >                             list(x = i, y = i+1)))
> >
> > #this is OK
> > ex1 <- expression("      first: {f * minute}(x) " == {f * minute}(x))
> > ex2 <- expression("               second: {f * second}(x) "        == {f * second}(x))
> > text(1, 9.6, ex1, adj=0)
> > text(1, 9.0, ex2, adj=0)
> >
> > #and this is not
> > text(2, 8, expression(atop(ex1, ex2)))
> > text(2, 7, substitute( atop(ex1, ex2), list(ex1=ex1,ex2=ex2)))
> >
> > #and this works
> > text(2, 6, expression(atop(1,2)))
> >
> > I tried to use eval when calling atop, but it did not work either. Therefore some hint in help page could be quite handy.
> >
> > Best regards
> > Petr Pikal
> >
> > S pozdravem | Best Regards
> > RNDr. Petr PIKAL
> > Vedouc? V?zkumu a v?voje | Research Manager
> > PRECHEZA a.s.
> > n?b?. Dr. Edvarda Bene?e 1170/24 | 750 02 P?erov | Czech Republic
> > Tel: +420 581 252 256 | GSM: +420 724 008 364
> > petr.pikal at precheza.cz | www.precheza.cz
> >
> > Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information about processing and protection of business partner?s personal data are available on website: https://www.precheza.cz/en/personal-data-protection-principles/
> > D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en? odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://www.precheza.cz/en/01-disclaimer/
> >
> > -----Original Message-----
> > From: David Winsemius <dwinsemius at comcast.net>
> > Sent: Thursday, April 7, 2022 12:04 AM
> > To: PIKAL Petr <petr.pikal at precheza.cz>; Richard M. Heiberger <rmh at temple.edu>
> > Cc: r-help at r-project.org
> > Subject: Re: [R] [External] add equation and rsqared to plot
> >
> >
> > On 4/6/22 14:36, PIKAL Petr wrote:
> > > Hallo David
> > >
> > > Thanks for your answer. atop itself somehow cannot use expression made by substitute  although those expressions itself are correct. I asked this question after roughly two hours of unsuccessful atempts.
> > >
> > > The second substitute or bquote solves the problem. Maybe this could propagate to help page, because although atop works smoothly with simple expressions, expressions with substitute are treated in a wrong way (at least by my opinion).
> >
> >
> > It's not a problem with `atop`. It's a problem with your understanding of how R expressions and plotmath functions work. The argument(s) to `expression` are not evaluated. So `atop` was given two expressions `eq` and `req` and they in turn were not evaluated .... just taken as text values inside atop. Using either `substitute` (with a second argument
> > list) or bquote (with its special dot function) forces evaluation by getting from the R symbol table those expressions which you had assigned as values of the symbols `eq` and `req`.
> >
> > The plotmath functions (not just atop but also `paste`, `frac`, `over` and all the rest on the ?plotmath pafge),  are designed to be "like"
> > `expression` in not evaluating their arguments unless a "special value"
> > like a Greek letter name or a defined %<op>% is found. Those functions are handled with a different parser than regular R functions. So they are not designed to go out to the R symbol table (which is where even locally defined object names are kept) to find values.
> >
> >
> > Hope this helps;
> >
> > David.
> >
> >
> > --
> >
> > David.
> >
> > >
> > > Thanks again.
> > >
> > > Best regards.
> > > Petr
> > >
> > >
> > > ________________________________________
> > > Od: David Winsemius <dwinsemius at comcast.net>
> > > Odesl?no: 6. dubna 2022 23:20
> > > Komu: PIKAL Petr; Richard M. Heiberger
> > > Kopie: r-help at r-project.org
> > > P?edm?t: Re: [R] [External] add equation and rsqared to plot
> > >
> > > Try this:
> > >
> > >
> > > lm_eqn = function(m) {
> > >       l <- list(a = format(coef(m)[1], digits = 4),
> > >                 b = format(abs(coef(m)[2]), digits = 4),
> > >                 r2 = format(summary(m)$r.squared, digits = 3),
> > >                 r2adj = format(summary(m)$adj.r.squared, digits = 3));
> > >       if (coef(m)[2] >= 0)  {
> > >           eq <- substitute(italic(y) == a + b %.% italic(x), l)
> > >       } else {
> > >           eq <- substitute(italic(y) == a - b %.% italic(x),l)
> > >
> > >       }
> > >       req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
> > >       a_regs <- substitute( atop(eq, req), list(eq=eq,req=req)) }
> > >
> > > --
> > >
> > > David.
> > >
> > > On 4/6/22 13:47, PIKAL Petr wrote:
> > >> Hallo Richard.
> > >>
> > >> Did you try the example? I Used atop but with the syntax I made, the
> > >> result is
> > >>
> > >> eq
> > >> req
> > >>
> > >> but not the equations.
> > >>
> > >> I send the picture, but I am not sure if it will go through.
> > >>
> > >> Best regards
> > >> Petr
> > >>
> > >> ________________________________________
> > >> Od: Richard M. Heiberger <rmh at temple.edu>
> > >> Odesl?no: 6. dubna 2022 22:36
> > >> Komu: PIKAL Petr
> > >> Kopie: r-help at r-project.org
> > >> P?edm?t: Re: [External] [R] add equation and rsqared to plot
> > >>
> > >> I think you are looking for atop(a,b) See ? plotmath
> > >>
> > >>> On Apr 06, 2022, at 15:58, PIKAL Petr <petr.pikal at precheza.cz> wrote:
> > >>>
> > >>> Dear all
> > >>>
> > >>>
> > >>> I want to add equation and rsquared values to plot and I am lost in correct expression form. I want to have 2 lines, one with equation and one with r squared values.
> > >>>
> > >>>
> > >>> Here is what I made.
> > >>>
> > >>> # function to extract values from lm fit.
> > >>>
> > >>>
> > >>> lm_eqn = function(m) {
> > >>>    l <- list(a = format(coef(m)[1], digits = 4),
> > >>>        b = format(abs(coef(m)[2]), digits = 4),
> > >>>        r2 = format(summary(m)$r.squared, digits = 3),
> > >>>        r2adj = format(summary(m)$adj.r.squared, digits = 3));
> > >>>    if (coef(m)[2] >= 0)  {
> > >>>      eq <- substitute(italic(y) == a + b %.% italic(x), l)
> > >>>    } else {
> > >>>      eq <- substitute(italic(y) == a - b %.% italic(x),l)
> > >>>
> > >>>    }
> > >>>    req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
> > >>>    expression(atop(eq, req))
> > >>> }
> > >>>
> > >>>
> > >>> #Example
> > >>>
> > >>> x <- 1:10
> > >>> y <- x*5 +rnorm(10)
> > >>> plot(x,y)
> > >>> fit <- lm(y~x)
> > >>> text(4,40, lm_eqn(fit))
> > >>>
> > >>>
> > >>> I know that both eq and req are correct expressions and when the last line in function is either eq or req, the example gives correct result.
> > >>>
> > >>>
> > >>> But how to get both expressions one above the other is mystery.
> > >>>
> > >>> Please help.
> > >>>
> > >>>
> > >>> Best regards.
> > >>>
> > >>> Petr
> > >>>
> > >>>
> > >>>
> > >>> Osobn   daje: Informace o zpracov n  a ochran  osobn ch  daj
> > >>> obchodn ch partner  PRECHEZA a.s. jsou zve ejn ny na:
> > >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
> > >>> w.precheza.cz%2Fzasady-ochrany-osobnich-udaju%2F&amp;data=04%7C01%7C
> > >>> rmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244
> > >>> 738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZs
> > >>> b3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%
> > >>> 3D%7C3000&amp;sdata=MBtbONfsiMExWy0uorZMR1DglZindxErRMsooTztfUo%3D&a
> > >>> mp;reserved=0 | Information about processing and protection of
> > >>> business partner's personal data are available on website:
> > >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
> > >>> w.precheza.cz%2Fen%2Fpersonal-data-protection-principles%2F&amp;data
> > >>> =04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716
> > >>> e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown
> > >>> %7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiL
> > >>> CJXVCI6Mn0%3D%7C3000&amp;sdata=2YDPoejYRlphL6h%2FWFmEEyR44KdmH2GDC9r
> > >>> dLhFn4aU%3D&amp;reserved=0
> > >>> D v rnost: Tento e-mail a jak koliv k n mu p ipojen  dokumenty jsou
> > >>> d v rn  a podl haj  tomuto pr vn  z vazn mu prohl en  o vylou en
> > >>> odpov dnosti:
> > >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
> > >>> w.precheza.cz%2F01-dovetek%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C
> > >>> 3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%
> > >>> 7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjA
> > >>> wMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata
> > >>> =z7TNZSbfNXlB%2FZt0ekl8P1kTu1l0eBFVoLvewSSdQDg%3D&amp;reserved=0 |
> > >>> This email and any documents attached to it may be confidential and
> > >>> are subject to the legally binding disclaimer:
> > >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
> > >>> w.precheza.cz%2Fen%2F01-disclaimer%2F&amp;data=04%7C01%7Crmh%40templ
> > >>> e.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd0
> > >>> 2ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjo
> > >>> iMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&a
> > >>> mp;sdata=RCUE7DJbn54MvhWX4bqiNtPzoJLl7NK9tieMlFpe2rg%3D&amp;reserved
> > >>> =0
> > >>>
> > >>>
> > >>>         [[alternative HTML version deleted]]
> > >>>
> > >>> ______________________________________________
> > >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > >>> https://stat.ethz.ch/mailman/listinfo/r-help
> > >>> PLEASE do read the posting guide
> > >>> http://www.R-project.org/posting-guide.html
> > >>> and provide commented, minimal, self-contained, reproducible code.
> > >> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj?
> > >> obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na:
> > >> https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information
> > >> about processing and protection of business partner?s personal data
> > >> are available on website:
> > >> https://www.precheza.cz/en/personal-data-protection-principles/
> > >> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou
> > >> d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en?
> > >> odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and
> > >> any documents attached to it may be confidential and are subject to
> > >> the legally binding disclaimer:
> > >> https://www.precheza.cz/en/01-disclaimer/
> > >>
> > >>
> > >> ______________________________________________
> > >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > >> https://stat.ethz.ch/mailman/listinfo/r-help
> > >> PLEASE do read the posting guide
> > >> http://www.R-project.org/posting-guide.html
> > >> and provide commented, minimal, self-contained, reproducible code.
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.


From w||||@mwdun|@p @end|ng |rom gm@||@com  Fri Apr  8 19:08:39 2022
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Fri, 8 Apr 2022 10:08:39 -0700
Subject: [R] [External] add equation and rsqared to plot
In-Reply-To: <CAGxFJbToLSGpNxxnJAwMVO59JJJrnY6yiwvxGCu6HFsYpCfBjA@mail.gmail.com>
References: <1649275105409.87603@precheza.cz>
 <4483DC96-F937-4BB8-B5A1-4485FDF590DB@temple.edu>
 <1649278042150.16601@precheza.cz>
 <95448101-08c6-045d-ff79-fb9febf3effb@comcast.net>
 <1649280964120.57655@precheza.cz>
 <9ed7092d-b142-9f6f-854e-9e5182b2b466@comcast.net>
 <96bfd2fd05024b47a33939a9b9d4c19a@SRVEXCHCM1302.precheza.cz>
 <CAGxFJbToLSGpNxxnJAwMVO59JJJrnY6yiwvxGCu6HFsYpCfBjA@mail.gmail.com>
Message-ID: <CAHqSRuT8O0TkjwV_GSjB=z_g4j3q0OW7b_Lu=MaJzs_6PNpENQ@mail.gmail.com>

plotmath also accepts names and calls, which it treats as though they were
single-element expressions.  That is why quote() generally works.
quote("string") or quote(123) does not invoke plotmath, as quote returns a
literal string or number when given such a thing.

plot(0:1,0:1,type="n")
text(.2, .6, expression(phi^epsilon))
text(.2, .4, quote(phi^epsilon))
text(.7, .6, expression(1234567890123456))
text(.7, .4, quote(1234567890123456))

-Bill

On Fri, Apr 8, 2022 at 9:49 AM Bert Gunter <bgunter.4567 at gmail.com> wrote:

> Yes, I also find it somewhat confusing. Perhaps this will help. I
> apologize beforehand if I have misunderstood and you already know all
> this.
>
> The key is to realize that plotmath works with **expressions**,
> unevaluated forms that include special plotmath keywords, like 'atop',
> and symbols. So...
>
> ## simple example with plotmath used in plot's title
>
> ## This will produce an error, as 'atop' is not an R function:
> plot(1,1, main = atop(x,y))
>
> ## to make this work, we need an expression on the rhs of 'main =' . A
> simple way to do this is to use quote():
>
> plot(1,1,main = quote(atop(x,y)))
>
> ## Note that this produce 'x' above 'y' **without quoting x and y**.
> That's because
> ## this is an expression that plotmath parses and evaluates according
> to its own rules,
> ## shown in ?plotmath
>
> ## Now suppose we have:
> x <- 'first line'
> y <- 'second line'
>
> ## and we want to display these quoted strings instead of 'x' and 'y'
> in the title
>
> ## Then this will *not* work -- it gives the same result as before:
> plot(1,1,main = quote(atop(x,y)))
>
> ## So what is needed here is R's 'computing on the language"
> capability to substitute
> ## the quoted strings for x and y in the expression. Here are two
> simple ways to do this:
>
> ## First using substitute()
>
> plot(1,1, main = substitute(atop(x,y), list (x =x, y = y)))
>
> ## Second, using bquote()
>
> plot(1,1, main = bquote(atop(.(x), .(y))))
>
> ## More complicated expressions can be built up using plotmath's rules.
> ## But you need to be careful about distinguishing plotmath expressions and
> ## ordinary R expressions. For example:
>
> x <- pi/4  ## a number
>
> ## WRONG -- will display as written. bquote() is the same as quote() here.
> plot(1,1, main = bquote(sin(pi/4) == round(x,2)))
>
> ## WRONG -- will substitute value of x rounded to session default
> ## in previous. This is a mistake in using bquote
> plot(1,1, main = bquote(sin(pi/4) == round(.(x), 2)))
>
> ## RIGHT -- use of bquote
> plot(1,1, main = bquote(sin(pi/4) == .(round(x,2))))
> ## or -- using substitute
> plot(1,1, main = substitute(sin(pi/4) == x, list(x = round(x,2))))
>
> Hope this is helpful and, again, apologies if I have misunderstood.
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> On Fri, Apr 8, 2022 at 7:42 AM PIKAL Petr <petr.pikal at precheza.cz> wrote:
> >
> > Hallo David
> >
> > Fair enough. Thanks for your explanation, which told me what should be
> done. It works perfectly for my example but I am still confused how to get
> expressions given to atop (or other functions) be evaluated and help page
> does not enlighten me, so I am still puzzled.
> >
> > When I borrow example from help,
> >
> > plot(1:10, type="n", xlab="", ylab="", main = "plot math & numbers")
> > theta <- 1.23 ; mtext(bquote(hat(theta) == .(theta)), line= .25)
> > for(i in 2:9)
> >     text(i, i+1, substitute(list(xi, eta) == group("(",list(x,y),")"),
> >                             list(x = i, y = i+1)))
> >
> > #this is OK
> > ex1 <- expression("      first: {f * minute}(x) " == {f * minute}(x))
> > ex2 <- expression("               second: {f * second}(x) "        == {f
> * second}(x))
> > text(1, 9.6, ex1, adj=0)
> > text(1, 9.0, ex2, adj=0)
> >
> > #and this is not
> > text(2, 8, expression(atop(ex1, ex2)))
> > text(2, 7, substitute( atop(ex1, ex2), list(ex1=ex1,ex2=ex2)))
> >
> > #and this works
> > text(2, 6, expression(atop(1,2)))
> >
> > I tried to use eval when calling atop, but it did not work either.
> Therefore some hint in help page could be quite handy.
> >
> > Best regards
> > Petr Pikal
> >
> > S pozdravem | Best Regards
> > RNDr. Petr PIKAL
> > Vedouc? V?zkumu a v?voje | Research Manager
> > PRECHEZA a.s.
> > n?b?. Dr. Edvarda Bene?e 1170/24 | 750 02 P?erov | Czech Republic
> > Tel: +420 581 252 256 | GSM: +420 724 008 364
> > petr.pikal at precheza.cz | www.precheza.cz
> >
> > Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch
> partner? PRECHEZA a.s. jsou zve?ejn?ny na:
> https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information
> about processing and protection of business partner?s personal data are
> available on website:
> https://www.precheza.cz/en/personal-data-protection-principles/
> > D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou
> d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en?
> odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and any
> documents attached to it may be confidential and are subject to the legally
> binding disclaimer: https://www.precheza.cz/en/01-disclaimer/
> >
> > -----Original Message-----
> > From: David Winsemius <dwinsemius at comcast.net>
> > Sent: Thursday, April 7, 2022 12:04 AM
> > To: PIKAL Petr <petr.pikal at precheza.cz>; Richard M. Heiberger <
> rmh at temple.edu>
> > Cc: r-help at r-project.org
> > Subject: Re: [R] [External] add equation and rsqared to plot
> >
> >
> > On 4/6/22 14:36, PIKAL Petr wrote:
> > > Hallo David
> > >
> > > Thanks for your answer. atop itself somehow cannot use expression made
> by substitute  although those expressions itself are correct. I asked this
> question after roughly two hours of unsuccessful atempts.
> > >
> > > The second substitute or bquote solves the problem. Maybe this could
> propagate to help page, because although atop works smoothly with simple
> expressions, expressions with substitute are treated in a wrong way (at
> least by my opinion).
> >
> >
> > It's not a problem with `atop`. It's a problem with your understanding
> of how R expressions and plotmath functions work. The argument(s) to
> `expression` are not evaluated. So `atop` was given two expressions `eq`
> and `req` and they in turn were not evaluated .... just taken as text
> values inside atop. Using either `substitute` (with a second argument
> > list) or bquote (with its special dot function) forces evaluation by
> getting from the R symbol table those expressions which you had assigned as
> values of the symbols `eq` and `req`.
> >
> > The plotmath functions (not just atop but also `paste`, `frac`, `over`
> and all the rest on the ?plotmath pafge),  are designed to be "like"
> > `expression` in not evaluating their arguments unless a "special value"
> > like a Greek letter name or a defined %<op>% is found. Those functions
> are handled with a different parser than regular R functions. So they are
> not designed to go out to the R symbol table (which is where even locally
> defined object names are kept) to find values.
> >
> >
> > Hope this helps;
> >
> > David.
> >
> >
> > --
> >
> > David.
> >
> > >
> > > Thanks again.
> > >
> > > Best regards.
> > > Petr
> > >
> > >
> > > ________________________________________
> > > Od: David Winsemius <dwinsemius at comcast.net>
> > > Odesl?no: 6. dubna 2022 23:20
> > > Komu: PIKAL Petr; Richard M. Heiberger
> > > Kopie: r-help at r-project.org
> > > P?edm?t: Re: [R] [External] add equation and rsqared to plot
> > >
> > > Try this:
> > >
> > >
> > > lm_eqn = function(m) {
> > >       l <- list(a = format(coef(m)[1], digits = 4),
> > >                 b = format(abs(coef(m)[2]), digits = 4),
> > >                 r2 = format(summary(m)$r.squared, digits = 3),
> > >                 r2adj = format(summary(m)$adj.r.squared, digits = 3));
> > >       if (coef(m)[2] >= 0)  {
> > >           eq <- substitute(italic(y) == a + b %.% italic(x), l)
> > >       } else {
> > >           eq <- substitute(italic(y) == a - b %.% italic(x),l)
> > >
> > >       }
> > >       req <- substitute(italic(r)^2~"="~r2*
> ","~~italic(adj.r)^2~"="~r2adj,l)
> > >       a_regs <- substitute( atop(eq, req), list(eq=eq,req=req)) }
> > >
> > > --
> > >
> > > David.
> > >
> > > On 4/6/22 13:47, PIKAL Petr wrote:
> > >> Hallo Richard.
> > >>
> > >> Did you try the example? I Used atop but with the syntax I made, the
> > >> result is
> > >>
> > >> eq
> > >> req
> > >>
> > >> but not the equations.
> > >>
> > >> I send the picture, but I am not sure if it will go through.
> > >>
> > >> Best regards
> > >> Petr
> > >>
> > >> ________________________________________
> > >> Od: Richard M. Heiberger <rmh at temple.edu>
> > >> Odesl?no: 6. dubna 2022 22:36
> > >> Komu: PIKAL Petr
> > >> Kopie: r-help at r-project.org
> > >> P?edm?t: Re: [External] [R] add equation and rsqared to plot
> > >>
> > >> I think you are looking for atop(a,b) See ? plotmath
> > >>
> > >>> On Apr 06, 2022, at 15:58, PIKAL Petr <petr.pikal at precheza.cz>
> wrote:
> > >>>
> > >>> Dear all
> > >>>
> > >>>
> > >>> I want to add equation and rsquared values to plot and I am lost in
> correct expression form. I want to have 2 lines, one with equation and one
> with r squared values.
> > >>>
> > >>>
> > >>> Here is what I made.
> > >>>
> > >>> # function to extract values from lm fit.
> > >>>
> > >>>
> > >>> lm_eqn = function(m) {
> > >>>    l <- list(a = format(coef(m)[1], digits = 4),
> > >>>        b = format(abs(coef(m)[2]), digits = 4),
> > >>>        r2 = format(summary(m)$r.squared, digits = 3),
> > >>>        r2adj = format(summary(m)$adj.r.squared, digits = 3));
> > >>>    if (coef(m)[2] >= 0)  {
> > >>>      eq <- substitute(italic(y) == a + b %.% italic(x), l)
> > >>>    } else {
> > >>>      eq <- substitute(italic(y) == a - b %.% italic(x),l)
> > >>>
> > >>>    }
> > >>>    req <- substitute(italic(r)^2~"="~r2*
> ","~~italic(adj.r)^2~"="~r2adj,l)
> > >>>    expression(atop(eq, req))
> > >>> }
> > >>>
> > >>>
> > >>> #Example
> > >>>
> > >>> x <- 1:10
> > >>> y <- x*5 +rnorm(10)
> > >>> plot(x,y)
> > >>> fit <- lm(y~x)
> > >>> text(4,40, lm_eqn(fit))
> > >>>
> > >>>
> > >>> I know that both eq and req are correct expressions and when the
> last line in function is either eq or req, the example gives correct result.
> > >>>
> > >>>
> > >>> But how to get both expressions one above the other is mystery.
> > >>>
> > >>> Please help.
> > >>>
> > >>>
> > >>> Best regards.
> > >>>
> > >>> Petr
> > >>>
> > >>>
> > >>>
> > >>> Osobn   daje: Informace o zpracov n  a ochran  osobn ch  daj
> > >>> obchodn ch partner  PRECHEZA a.s. jsou zve ejn ny na:
> > >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
> > >>> w.precheza.cz%2Fzasady-ochrany-osobnich-udaju%2F&amp;data=04%7C01%7C
> > >>> rmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244
> > >>> 738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZs
> > >>> b3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%
> > >>> 3D%7C3000&amp;sdata=MBtbONfsiMExWy0uorZMR1DglZindxErRMsooTztfUo%3D&a
> > >>> mp;reserved=0 | Information about processing and protection of
> > >>> business partner's personal data are available on website:
> > >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
> > >>> w.precheza.cz%2Fen%2Fpersonal-data-protection-principles%2F&amp;data
> > >>> =04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716
> > >>> e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown
> > >>> %7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiL
> > >>> CJXVCI6Mn0%3D%7C3000&amp;sdata=2YDPoejYRlphL6h%2FWFmEEyR44KdmH2GDC9r
> > >>> dLhFn4aU%3D&amp;reserved=0
> > >>> D v rnost: Tento e-mail a jak koliv k n mu p ipojen  dokumenty jsou
> > >>> d v rn  a podl haj  tomuto pr vn  z vazn mu prohl en  o vylou en
> > >>> odpov dnosti:
> > >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
> > >>> w.precheza.cz%2F01-dovetek%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C
> > >>> 3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%
> > >>> 7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjA
> > >>> wMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata
> > >>> =z7TNZSbfNXlB%2FZt0ekl8P1kTu1l0eBFVoLvewSSdQDg%3D&amp;reserved=0 |
> > >>> This email and any documents attached to it may be confidential and
> > >>> are subject to the legally binding disclaimer:
> > >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
> > >>> w.precheza.cz%2Fen%2F01-disclaimer%2F&amp;data=04%7C01%7Crmh%40templ
> > >>> e.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd0
> > >>> 2ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjo
> > >>> iMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&a
> > >>> mp;sdata=RCUE7DJbn54MvhWX4bqiNtPzoJLl7NK9tieMlFpe2rg%3D&amp;reserved
> > >>> =0
> > >>>
> > >>>
> > >>>         [[alternative HTML version deleted]]
> > >>>
> > >>> ______________________________________________
> > >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > >>> https://stat.ethz.ch/mailman/listinfo/r-help
> > >>> PLEASE do read the posting guide
> > >>> http://www.R-project.org/posting-guide.html
> > >>> and provide commented, minimal, self-contained, reproducible code.
> > >> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj?
> > >> obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na:
> > >> https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information
> > >> about processing and protection of business partner?s personal data
> > >> are available on website:
> > >> https://www.precheza.cz/en/personal-data-protection-principles/
> > >> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou
> > >> d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en?
> > >> odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and
> > >> any documents attached to it may be confidential and are subject to
> > >> the legally binding disclaimer:
> > >> https://www.precheza.cz/en/01-disclaimer/
> > >>
> > >>
> > >> ______________________________________________
> > >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > >> https://stat.ethz.ch/mailman/listinfo/r-help
> > >> PLEASE do read the posting guide
> > >> http://www.R-project.org/posting-guide.html
> > >> and provide commented, minimal, self-contained, reproducible code.
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Fri Apr  8 19:32:41 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 8 Apr 2022 10:32:41 -0700
Subject: [R] [External] add equation and rsqared to plot
In-Reply-To: <CAHqSRuT8O0TkjwV_GSjB=z_g4j3q0OW7b_Lu=MaJzs_6PNpENQ@mail.gmail.com>
References: <1649275105409.87603@precheza.cz>
 <4483DC96-F937-4BB8-B5A1-4485FDF590DB@temple.edu>
 <1649278042150.16601@precheza.cz>
 <95448101-08c6-045d-ff79-fb9febf3effb@comcast.net>
 <1649280964120.57655@precheza.cz>
 <9ed7092d-b142-9f6f-854e-9e5182b2b466@comcast.net>
 <96bfd2fd05024b47a33939a9b9d4c19a@SRVEXCHCM1302.precheza.cz>
 <CAGxFJbToLSGpNxxnJAwMVO59JJJrnY6yiwvxGCu6HFsYpCfBjA@mail.gmail.com>
 <CAHqSRuT8O0TkjwV_GSjB=z_g4j3q0OW7b_Lu=MaJzs_6PNpENQ@mail.gmail.com>
Message-ID: <CAGxFJbQUTiLEu6nJp1aUpbjhTCXSYBqfkiVqsFTaHKFUe0DJVA@mail.gmail.com>

Thanks, Bill.

This is a subtlety I certainly did not understand.


Bert

On Fri, Apr 8, 2022 at 10:08 AM Bill Dunlap <williamwdunlap at gmail.com> wrote:
>
> plotmath also accepts names and calls, which it treats as though they were single-element expressions.  That is why quote() generally works.  quote("string") or quote(123) does not invoke plotmath, as quote returns a literal string or number when given such a thing.
>
> plot(0:1,0:1,type="n")
> text(.2, .6, expression(phi^epsilon))
> text(.2, .4, quote(phi^epsilon))
> text(.7, .6, expression(1234567890123456))
> text(.7, .4, quote(1234567890123456))
>
> -Bill
>
> On Fri, Apr 8, 2022 at 9:49 AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>>
>> Yes, I also find it somewhat confusing. Perhaps this will help. I
>> apologize beforehand if I have misunderstood and you already know all
>> this.
>>
>> The key is to realize that plotmath works with **expressions**,
>> unevaluated forms that include special plotmath keywords, like 'atop',
>> and symbols. So...
>>
>> ## simple example with plotmath used in plot's title
>>
>> ## This will produce an error, as 'atop' is not an R function:
>> plot(1,1, main = atop(x,y))
>>
>> ## to make this work, we need an expression on the rhs of 'main =' . A
>> simple way to do this is to use quote():
>>
>> plot(1,1,main = quote(atop(x,y)))
>>
>> ## Note that this produce 'x' above 'y' **without quoting x and y**.
>> That's because
>> ## this is an expression that plotmath parses and evaluates according
>> to its own rules,
>> ## shown in ?plotmath
>>
>> ## Now suppose we have:
>> x <- 'first line'
>> y <- 'second line'
>>
>> ## and we want to display these quoted strings instead of 'x' and 'y'
>> in the title
>>
>> ## Then this will *not* work -- it gives the same result as before:
>> plot(1,1,main = quote(atop(x,y)))
>>
>> ## So what is needed here is R's 'computing on the language"
>> capability to substitute
>> ## the quoted strings for x and y in the expression. Here are two
>> simple ways to do this:
>>
>> ## First using substitute()
>>
>> plot(1,1, main = substitute(atop(x,y), list (x =x, y = y)))
>>
>> ## Second, using bquote()
>>
>> plot(1,1, main = bquote(atop(.(x), .(y))))
>>
>> ## More complicated expressions can be built up using plotmath's rules.
>> ## But you need to be careful about distinguishing plotmath expressions and
>> ## ordinary R expressions. For example:
>>
>> x <- pi/4  ## a number
>>
>> ## WRONG -- will display as written. bquote() is the same as quote() here.
>> plot(1,1, main = bquote(sin(pi/4) == round(x,2)))
>>
>> ## WRONG -- will substitute value of x rounded to session default
>> ## in previous. This is a mistake in using bquote
>> plot(1,1, main = bquote(sin(pi/4) == round(.(x), 2)))
>>
>> ## RIGHT -- use of bquote
>> plot(1,1, main = bquote(sin(pi/4) == .(round(x,2))))
>> ## or -- using substitute
>> plot(1,1, main = substitute(sin(pi/4) == x, list(x = round(x,2))))
>>
>> Hope this is helpful and, again, apologies if I have misunderstood.
>>
>> Bert Gunter
>>
>> "The trouble with having an open mind is that people keep coming along
>> and sticking things into it."
>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>
>> On Fri, Apr 8, 2022 at 7:42 AM PIKAL Petr <petr.pikal at precheza.cz> wrote:
>> >
>> > Hallo David
>> >
>> > Fair enough. Thanks for your explanation, which told me what should be done. It works perfectly for my example but I am still confused how to get expressions given to atop (or other functions) be evaluated and help page does not enlighten me, so I am still puzzled.
>> >
>> > When I borrow example from help,
>> >
>> > plot(1:10, type="n", xlab="", ylab="", main = "plot math & numbers")
>> > theta <- 1.23 ; mtext(bquote(hat(theta) == .(theta)), line= .25)
>> > for(i in 2:9)
>> >     text(i, i+1, substitute(list(xi, eta) == group("(",list(x,y),")"),
>> >                             list(x = i, y = i+1)))
>> >
>> > #this is OK
>> > ex1 <- expression("      first: {f * minute}(x) " == {f * minute}(x))
>> > ex2 <- expression("               second: {f * second}(x) "        == {f * second}(x))
>> > text(1, 9.6, ex1, adj=0)
>> > text(1, 9.0, ex2, adj=0)
>> >
>> > #and this is not
>> > text(2, 8, expression(atop(ex1, ex2)))
>> > text(2, 7, substitute( atop(ex1, ex2), list(ex1=ex1,ex2=ex2)))
>> >
>> > #and this works
>> > text(2, 6, expression(atop(1,2)))
>> >
>> > I tried to use eval when calling atop, but it did not work either. Therefore some hint in help page could be quite handy.
>> >
>> > Best regards
>> > Petr Pikal
>> >
>> > S pozdravem | Best Regards
>> > RNDr. Petr PIKAL
>> > Vedouc? V?zkumu a v?voje | Research Manager
>> > PRECHEZA a.s.
>> > n?b?. Dr. Edvarda Bene?e 1170/24 | 750 02 P?erov | Czech Republic
>> > Tel: +420 581 252 256 | GSM: +420 724 008 364
>> > petr.pikal at precheza.cz | www.precheza.cz
>> >
>> > Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj? obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na: https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information about processing and protection of business partner?s personal data are available on website: https://www.precheza.cz/en/personal-data-protection-principles/
>> > D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en? odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and any documents attached to it may be confidential and are subject to the legally binding disclaimer: https://www.precheza.cz/en/01-disclaimer/
>> >
>> > -----Original Message-----
>> > From: David Winsemius <dwinsemius at comcast.net>
>> > Sent: Thursday, April 7, 2022 12:04 AM
>> > To: PIKAL Petr <petr.pikal at precheza.cz>; Richard M. Heiberger <rmh at temple.edu>
>> > Cc: r-help at r-project.org
>> > Subject: Re: [R] [External] add equation and rsqared to plot
>> >
>> >
>> > On 4/6/22 14:36, PIKAL Petr wrote:
>> > > Hallo David
>> > >
>> > > Thanks for your answer. atop itself somehow cannot use expression made by substitute  although those expressions itself are correct. I asked this question after roughly two hours of unsuccessful atempts.
>> > >
>> > > The second substitute or bquote solves the problem. Maybe this could propagate to help page, because although atop works smoothly with simple expressions, expressions with substitute are treated in a wrong way (at least by my opinion).
>> >
>> >
>> > It's not a problem with `atop`. It's a problem with your understanding of how R expressions and plotmath functions work. The argument(s) to `expression` are not evaluated. So `atop` was given two expressions `eq` and `req` and they in turn were not evaluated .... just taken as text values inside atop. Using either `substitute` (with a second argument
>> > list) or bquote (with its special dot function) forces evaluation by getting from the R symbol table those expressions which you had assigned as values of the symbols `eq` and `req`.
>> >
>> > The plotmath functions (not just atop but also `paste`, `frac`, `over` and all the rest on the ?plotmath pafge),  are designed to be "like"
>> > `expression` in not evaluating their arguments unless a "special value"
>> > like a Greek letter name or a defined %<op>% is found. Those functions are handled with a different parser than regular R functions. So they are not designed to go out to the R symbol table (which is where even locally defined object names are kept) to find values.
>> >
>> >
>> > Hope this helps;
>> >
>> > David.
>> >
>> >
>> > --
>> >
>> > David.
>> >
>> > >
>> > > Thanks again.
>> > >
>> > > Best regards.
>> > > Petr
>> > >
>> > >
>> > > ________________________________________
>> > > Od: David Winsemius <dwinsemius at comcast.net>
>> > > Odesl?no: 6. dubna 2022 23:20
>> > > Komu: PIKAL Petr; Richard M. Heiberger
>> > > Kopie: r-help at r-project.org
>> > > P?edm?t: Re: [R] [External] add equation and rsqared to plot
>> > >
>> > > Try this:
>> > >
>> > >
>> > > lm_eqn = function(m) {
>> > >       l <- list(a = format(coef(m)[1], digits = 4),
>> > >                 b = format(abs(coef(m)[2]), digits = 4),
>> > >                 r2 = format(summary(m)$r.squared, digits = 3),
>> > >                 r2adj = format(summary(m)$adj.r.squared, digits = 3));
>> > >       if (coef(m)[2] >= 0)  {
>> > >           eq <- substitute(italic(y) == a + b %.% italic(x), l)
>> > >       } else {
>> > >           eq <- substitute(italic(y) == a - b %.% italic(x),l)
>> > >
>> > >       }
>> > >       req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
>> > >       a_regs <- substitute( atop(eq, req), list(eq=eq,req=req)) }
>> > >
>> > > --
>> > >
>> > > David.
>> > >
>> > > On 4/6/22 13:47, PIKAL Petr wrote:
>> > >> Hallo Richard.
>> > >>
>> > >> Did you try the example? I Used atop but with the syntax I made, the
>> > >> result is
>> > >>
>> > >> eq
>> > >> req
>> > >>
>> > >> but not the equations.
>> > >>
>> > >> I send the picture, but I am not sure if it will go through.
>> > >>
>> > >> Best regards
>> > >> Petr
>> > >>
>> > >> ________________________________________
>> > >> Od: Richard M. Heiberger <rmh at temple.edu>
>> > >> Odesl?no: 6. dubna 2022 22:36
>> > >> Komu: PIKAL Petr
>> > >> Kopie: r-help at r-project.org
>> > >> P?edm?t: Re: [External] [R] add equation and rsqared to plot
>> > >>
>> > >> I think you are looking for atop(a,b) See ? plotmath
>> > >>
>> > >>> On Apr 06, 2022, at 15:58, PIKAL Petr <petr.pikal at precheza.cz> wrote:
>> > >>>
>> > >>> Dear all
>> > >>>
>> > >>>
>> > >>> I want to add equation and rsquared values to plot and I am lost in correct expression form. I want to have 2 lines, one with equation and one with r squared values.
>> > >>>
>> > >>>
>> > >>> Here is what I made.
>> > >>>
>> > >>> # function to extract values from lm fit.
>> > >>>
>> > >>>
>> > >>> lm_eqn = function(m) {
>> > >>>    l <- list(a = format(coef(m)[1], digits = 4),
>> > >>>        b = format(abs(coef(m)[2]), digits = 4),
>> > >>>        r2 = format(summary(m)$r.squared, digits = 3),
>> > >>>        r2adj = format(summary(m)$adj.r.squared, digits = 3));
>> > >>>    if (coef(m)[2] >= 0)  {
>> > >>>      eq <- substitute(italic(y) == a + b %.% italic(x), l)
>> > >>>    } else {
>> > >>>      eq <- substitute(italic(y) == a - b %.% italic(x),l)
>> > >>>
>> > >>>    }
>> > >>>    req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
>> > >>>    expression(atop(eq, req))
>> > >>> }
>> > >>>
>> > >>>
>> > >>> #Example
>> > >>>
>> > >>> x <- 1:10
>> > >>> y <- x*5 +rnorm(10)
>> > >>> plot(x,y)
>> > >>> fit <- lm(y~x)
>> > >>> text(4,40, lm_eqn(fit))
>> > >>>
>> > >>>
>> > >>> I know that both eq and req are correct expressions and when the last line in function is either eq or req, the example gives correct result.
>> > >>>
>> > >>>
>> > >>> But how to get both expressions one above the other is mystery.
>> > >>>
>> > >>> Please help.
>> > >>>
>> > >>>
>> > >>> Best regards.
>> > >>>
>> > >>> Petr
>> > >>>
>> > >>>
>> > >>>
>> > >>> Osobn   daje: Informace o zpracov n  a ochran  osobn ch  daj
>> > >>> obchodn ch partner  PRECHEZA a.s. jsou zve ejn ny na:
>> > >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
>> > >>> w.precheza.cz%2Fzasady-ochrany-osobnich-udaju%2F&amp;data=04%7C01%7C
>> > >>> rmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244
>> > >>> 738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZs
>> > >>> b3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%
>> > >>> 3D%7C3000&amp;sdata=MBtbONfsiMExWy0uorZMR1DglZindxErRMsooTztfUo%3D&a
>> > >>> mp;reserved=0 | Information about processing and protection of
>> > >>> business partner's personal data are available on website:
>> > >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
>> > >>> w.precheza.cz%2Fen%2Fpersonal-data-protection-principles%2F&amp;data
>> > >>> =04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716
>> > >>> e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown
>> > >>> %7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiL
>> > >>> CJXVCI6Mn0%3D%7C3000&amp;sdata=2YDPoejYRlphL6h%2FWFmEEyR44KdmH2GDC9r
>> > >>> dLhFn4aU%3D&amp;reserved=0
>> > >>> D v rnost: Tento e-mail a jak koliv k n mu p ipojen  dokumenty jsou
>> > >>> d v rn  a podl haj  tomuto pr vn  z vazn mu prohl en  o vylou en
>> > >>> odpov dnosti:
>> > >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
>> > >>> w.precheza.cz%2F01-dovetek%2F&amp;data=04%7C01%7Crmh%40temple.edu%7C
>> > >>> 3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02ccf6e5%
>> > >>> 7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjA
>> > >>> wMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata
>> > >>> =z7TNZSbfNXlB%2FZt0ekl8P1kTu1l0eBFVoLvewSSdQDg%3D&amp;reserved=0 |
>> > >>> This email and any documents attached to it may be confidential and
>> > >>> are subject to the legally binding disclaimer:
>> > >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fww
>> > >>> w.precheza.cz%2Fen%2F01-disclaimer%2F&amp;data=04%7C01%7Crmh%40templ
>> > >>> e.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd0
>> > >>> 2ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIjo
>> > >>> iMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&a
>> > >>> mp;sdata=RCUE7DJbn54MvhWX4bqiNtPzoJLl7NK9tieMlFpe2rg%3D&amp;reserved
>> > >>> =0
>> > >>>
>> > >>>
>> > >>>         [[alternative HTML version deleted]]
>> > >>>
>> > >>> ______________________________________________
>> > >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > >>> https://stat.ethz.ch/mailman/listinfo/r-help
>> > >>> PLEASE do read the posting guide
>> > >>> http://www.R-project.org/posting-guide.html
>> > >>> and provide commented, minimal, self-contained, reproducible code.
>> > >> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj?
>> > >> obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na:
>> > >> https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ | Information
>> > >> about processing and protection of business partner?s personal data
>> > >> are available on website:
>> > >> https://www.precheza.cz/en/personal-data-protection-principles/
>> > >> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou
>> > >> d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en?
>> > >> odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and
>> > >> any documents attached to it may be confidential and are subject to
>> > >> the legally binding disclaimer:
>> > >> https://www.precheza.cz/en/01-disclaimer/
>> > >>
>> > >>
>> > >> ______________________________________________
>> > >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > >> https://stat.ethz.ch/mailman/listinfo/r-help
>> > >> PLEASE do read the posting guide
>> > >> http://www.R-project.org/posting-guide.html
>> > >> and provide commented, minimal, self-contained, reproducible code.
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From gkr@emer @end|ng |rom bgc-jen@@mpg@de  Fri Apr  8 22:02:25 2022
From: gkr@emer @end|ng |rom bgc-jen@@mpg@de (Guido Kraemer)
Date: Fri, 8 Apr 2022 22:02:25 +0200
Subject: [R] error with more 100 forked processes
Message-ID: <cae97b08-040f-07da-21fe-b2ddfe0563e2@bgc-jena.mpg.de>

I am trying to run a parallel job on a computer with many CPUs and get 
the following error:

 > library(parallel)
 > cl <- makeForkCluster(128)
Error in UseMethod("sendData") :
 ? no applicable method for 'sendData' applied to an object of class "NULL"

If I scale down to 100 CPUs it doesn't produce an error. I can reproduce 
this with a self compiled R 4.1.3 on Ubuntu 20.04 and Manjaro, as well 
as the R binaries that come with both distributions.


-- 
Guido Kraemer
Max Planck Institute for Biogeochemistry Jena
Department for Biogeochemical Integration
Hans-Kn?ll-Str. 10
07745 Jena
Germany

phone: +49 3641 576293
e-mail: gkraemer at bgc-jena.mpg.de


From @zwj|08 @end|ng |rom gm@||@com  Fri Apr  8 23:02:48 2022
From: @zwj|08 @end|ng |rom gm@||@com (Jiefei Wang)
Date: Fri, 8 Apr 2022 17:02:48 -0400
Subject: [R] error with more 100 forked processes
In-Reply-To: <cae97b08-040f-07da-21fe-b2ddfe0563e2@bgc-jena.mpg.de>
References: <cae97b08-040f-07da-21fe-b2ddfe0563e2@bgc-jena.mpg.de>
Message-ID: <CAGiFhPNG7pdGnWW2fUpZqnxSuLH+btbd2yoPqmygRcLuMs36qg@mail.gmail.com>

Dear Guido,

R does not support that many connections so this is the reason you get
the error. Unfortunately, it is a hard limit in R so there is no way
to bypass the issue.

However, what you can do is to use a different parallelization
backend. In Bioconductor, we use BiocParallel to do the
parallelization, and we have a specific backend called RedisParam,
which uses the in-memory database Redis to support parallel computing.
The idea is that the Redis server will connect with both master and
workers, so the master does not have to create a connection for each
worker. Therefore, it is able to support unlimited number of workers.
You can find RedisParam here: https://github.com/mtmorgan/RedisParam

Another choice is to use foreach package with doRedis backend. The
idea is the same. Unfortunately, both ways require you to learn how to
run a Redis server. This is the cost we must pay to solve this
problem:(

Best,
Jiefei



On Fri, Apr 8, 2022 at 4:03 PM Guido Kraemer via R-help
<r-help at r-project.org> wrote:
>
> I am trying to run a parallel job on a computer with many CPUs and get
> the following error:
>
>  > library(parallel)
>  > cl <- makeForkCluster(128)
> Error in UseMethod("sendData") :
>    no applicable method for 'sendData' applied to an object of class "NULL"
>
> If I scale down to 100 CPUs it doesn't produce an error. I can reproduce
> this with a self compiled R 4.1.3 on Ubuntu 20.04 and Manjaro, as well
> as the R binaries that come with both distributions.
>
>
> --
> Guido Kraemer
> Max Planck Institute for Biogeochemistry Jena
> Department for Biogeochemical Integration
> Hans-Kn?ll-Str. 10
> 07745 Jena
> Germany
>
> phone: +49 3641 576293
> e-mail: gkraemer at bgc-jena.mpg.de
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Apr  8 23:18:17 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sat, 9 Apr 2022 00:18:17 +0300
Subject: [R] error with more 100 forked processes
In-Reply-To: <cae97b08-040f-07da-21fe-b2ddfe0563e2@bgc-jena.mpg.de>
References: <cae97b08-040f-07da-21fe-b2ddfe0563e2@bgc-jena.mpg.de>
Message-ID: <20220409001817.223f336b@Tarkus>

On Fri, 8 Apr 2022 22:02:25 +0200
Guido Kraemer via R-help <r-help at r-project.org> wrote:

>  > cl <- makeForkCluster(128)  
> Error in UseMethod("sendData") :
>  ? no applicable method for 'sendData' applied to an object of class
> "NULL"

In order to communicate with the workers, R creates connection objects.
Unfortunately, the memory for connection objects in R has a
statically-defined limit of 128. (A few connections are used by
default, and a few more will likely be used by user code during the
actual program run.)

Try increasing the limit in #define NCONNECTIONS in
src/main/connections.c and re-compiling R.

See also: https://github.com/HenrikBengtsson/Wishlist-for-R/issues/28
According to Henrik Bengtsson, R should work well even with as many
as 16381 possible connections, but then you may run into OS limits on
file descriptors.


-- 
Best regards,
Ivan


From henr|k@bengt@@on @end|ng |rom gm@||@com  Fri Apr  8 23:45:51 2022
From: henr|k@bengt@@on @end|ng |rom gm@||@com (Henrik Bengtsson)
Date: Fri, 8 Apr 2022 14:45:51 -0700
Subject: [R] error with more 100 forked processes
In-Reply-To: <20220409001817.223f336b@Tarkus>
References: <cae97b08-040f-07da-21fe-b2ddfe0563e2@bgc-jena.mpg.de>
 <20220409001817.223f336b@Tarkus>
Message-ID: <CAFDcVCQsz-Mjr+KACU=sLJJaBxAZX09E_nSmkDx+uaKOD=Qc8g@mail.gmail.com>

The reason why you hit the limit already around 100 workers, could be
because you already have other connections open, e.g. file
connections, capture.output(), etc.

If you want to use *forked* processing with more than 125 workers
using bare-bone R, you can use parallel::mclapply() and friends,
because they don't use sockets connections to communicate between the
main process and the workers.

If you don't need *forked* processing per se, there are other
alternatives, as already pointed out above.

As the author of the future framework (https://www.futureverse.org/),
I obviously suggest you try that one. It's on CRAN and installs out of
the box on all OSes. You get several alternatives for parallel
backends. For *forked* processing, call plan(multicore) on top of your
script, and it'll parallelize via the parallel::mclapply() framework
internally, so you won't have the connection limitation to worry
about(*). You can also use plan(future.callr::callr) to parallelize
via the callr package, which also don't have the connection
limitation. Your code will be the same regardless which you end up
using.  For the front end, there's future.apply::future_lapply() et
al. (parallel version of base lapply functions), furrr::future_map()
et al. (parallel version of purrr's map functions), foreach w/
doFuture if you like the y <- foreach(...) %dopar% { ... } style.

(*) But there are other issues with forked processing, e.g. it might
not be compatible with multi-threaded code used by some packages. This
is a problem independent of futures per se.

Hope this helps

Henrik

On Fri, Apr 8, 2022 at 2:19 PM Ivan Krylov <krylov.r00t at gmail.com> wrote:
>
> On Fri, 8 Apr 2022 22:02:25 +0200
> Guido Kraemer via R-help <r-help at r-project.org> wrote:
>
> >  > cl <- makeForkCluster(128)
> > Error in UseMethod("sendData") :
> >    no applicable method for 'sendData' applied to an object of class
> > "NULL"
>
> In order to communicate with the workers, R creates connection objects.
> Unfortunately, the memory for connection objects in R has a
> statically-defined limit of 128. (A few connections are used by
> default, and a few more will likely be used by user code during the
> actual program run.)
>
> Try increasing the limit in #define NCONNECTIONS in
> src/main/connections.c and re-compiling R.
>
> See also: https://github.com/HenrikBengtsson/Wishlist-for-R/issues/28
> According to Henrik Bengtsson, R should work well even with as many
> as 16381 possible connections, but then you may run into OS limits on
> file descriptors.
>
>
> --
> Best regards,
> Ivan
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kt1572757 @end|ng |rom gm@||@com  Sat Apr  9 03:26:10 2022
From: kt1572757 @end|ng |rom gm@||@com (Kelly Thompson)
Date: Fri, 8 Apr 2022 18:26:10 -0700
Subject: [R] "apply" a function that takes two or more vectors as arguments,
 such as cor(x, y), over a "category" or "grouping variable" or "index"?
Message-ID: <CAHfBD2fnhY5OucUuBOCvgOdk58W7OFjqNh2STYBCiJC=3U0Wzw@mail.gmail.com>

#Q. How can I "apply" a function that takes two or more vectors as
arguments, such as cor(x, y), over a "category" or "grouping variable"
or "index"?
#I'm using cor() as an example, I'd like to find a way to do this for
any function that takes 2 or more vectors as arguments.


#create example data

my_category <- rep ( c("a","b","c"),  4)

set.seed(12345)
my_x <- rnorm(12)

set.seed(54321)
my_y <- rnorm(12)

my_df <- data.frame(my_category, my_x, my_y)

#review data
my_df

#If i wanted to get the correlation of x and y grouped by category, I
could use this code and loop:

my_category_unique <- unique(my_category)

my_results <- vector("list", length(my_category_unique) )
names(my_results) <- my_category_unique

#start i loop
  for (i in 1:length(my_category_unique) ) {
    my_criteria_i <- my_category == my_category_unique[i]
    my_x_i <- my_x[which(my_criteria_i)]
    my_y_i <- my_y[which(my_criteria_i)]
    my_correl_i <- cor(x = my_x_i, y = my_y_i)
    my_results[i] <- list(my_correl_i)
} # end i loop

#review results
my_results

#Q. Is there a better or more "elegant" way to do this, using by(),
aggregate(), apply(), or some other function?

#This does not work and results in this error message: "Error in
FUN(dd[x, ], ...) : incompatible dimensions"
by (data = my_x, INDICES = my_category, FUN = cor, y = my_y)

#This does not work and results in this error message: "Error in
cor(my_df$x, my_df$y) : ... supply both 'x' and 'y' or a matrix-like
'x' "
by (data = my_df, INDICES = my_category, FUN = function(x, y) { cor
(my_df$x, my_df$y) } )


#if I wanted the mean of x by category, I could use by() or aggregate():
by (data = my_x, INDICES = my_category, FUN = mean)

aggregate(x = my_x, by = list(my_category), FUN = mean)

#Thanks!


From rmh @end|ng |rom temp|e@edu  Sat Apr  9 03:37:18 2022
From: rmh @end|ng |rom temp|e@edu (Richard M. Heiberger)
Date: Sat, 9 Apr 2022 01:37:18 +0000
Subject: [R] 
 [External] "apply" a function that takes two or more vectors as
 arguments, such as cor(x, y),
 over a "category" or "grouping variable" or "index"?
In-Reply-To: <CAHfBD2fnhY5OucUuBOCvgOdk58W7OFjqNh2STYBCiJC=3U0Wzw@mail.gmail.com>
References: <CAHfBD2fnhY5OucUuBOCvgOdk58W7OFjqNh2STYBCiJC=3U0Wzw@mail.gmail.com>
Message-ID: <3871091D-D75E-41FC-87DB-8CE1AC901CC2@temple.edu>

look at
?mapply
Apply a Function to Multiple List or Vector Arguments

to see if that meets your needs

> On Apr 08, 2022, at 21:26, Kelly Thompson <kt1572757 at gmail.com> wrote:
> 
> #Q. How can I "apply" a function that takes two or more vectors as
> arguments, such as cor(x, y), over a "category" or "grouping variable"
> or "index"?
> #I'm using cor() as an example, I'd like to find a way to do this for
> any function that takes 2 or more vectors as arguments.
> 
> 
> #create example data
> 
> my_category <- rep ( c("a","b","c"),  4)
> 
> set.seed(12345)
> my_x <- rnorm(12)
> 
> set.seed(54321)
> my_y <- rnorm(12)
> 
> my_df <- data.frame(my_category, my_x, my_y)
> 
> #review data
> my_df
> 
> #If i wanted to get the correlation of x and y grouped by category, I
> could use this code and loop:
> 
> my_category_unique <- unique(my_category)
> 
> my_results <- vector("list", length(my_category_unique) )
> names(my_results) <- my_category_unique
> 
> #start i loop
>  for (i in 1:length(my_category_unique) ) {
>    my_criteria_i <- my_category == my_category_unique[i]
>    my_x_i <- my_x[which(my_criteria_i)]
>    my_y_i <- my_y[which(my_criteria_i)]
>    my_correl_i <- cor(x = my_x_i, y = my_y_i)
>    my_results[i] <- list(my_correl_i)
> } # end i loop
> 
> #review results
> my_results
> 
> #Q. Is there a better or more "elegant" way to do this, using by(),
> aggregate(), apply(), or some other function?
> 
> #This does not work and results in this error message: "Error in
> FUN(dd[x, ], ...) : incompatible dimensions"
> by (data = my_x, INDICES = my_category, FUN = cor, y = my_y)
> 
> #This does not work and results in this error message: "Error in
> cor(my_df$x, my_df$y) : ... supply both 'x' and 'y' or a matrix-like
> 'x' "
> by (data = my_df, INDICES = my_category, FUN = function(x, y) { cor
> (my_df$x, my_df$y) } )
> 
> 
> #if I wanted the mean of x by category, I could use by() or aggregate():
> by (data = my_x, INDICES = my_category, FUN = mean)
> 
> aggregate(x = my_x, by = list(my_category), FUN = mean)
> 
> #Thanks!
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7Crmh%40temple.edu%7C4c8a50fd1bf14b2cf7b408da19c7fe20%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637850644148770767%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=23Y%2Fqw7G1gb4ACIz5V41DjBIR8c2IFkkZgud9dGaftE%3D&amp;reserved=0
> PLEASE do read the posting guide https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7Crmh%40temple.edu%7C4c8a50fd1bf14b2cf7b408da19c7fe20%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637850644148770767%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=3vIZYrMBnAZKZhZCwHcLpILHEE72NuLc03LXAxr%2BXQ4%3D&amp;reserved=0
> and provide commented, minimal, self-contained, reproducible code.


From er|cjberger @end|ng |rom gm@||@com  Sat Apr  9 06:25:14 2022
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Sat, 9 Apr 2022 07:25:14 +0300
Subject: [R] 
 [External] "apply" a function that takes two or more vectors as
 arguments, such as cor(x, y),
 over a "category" or "grouping variable" or "index"?
In-Reply-To: <3871091D-D75E-41FC-87DB-8CE1AC901CC2@temple.edu>
References: <CAHfBD2fnhY5OucUuBOCvgOdk58W7OFjqNh2STYBCiJC=3U0Wzw@mail.gmail.com>
 <3871091D-D75E-41FC-87DB-8CE1AC901CC2@temple.edu>
Message-ID: <CAGgJW76XbwK-B-s6JN+YtUoWapu+J8zWX5kOGN6ySqJDe10g+g@mail.gmail.com>

library(dplyr)
my_df |> group_by(my_category) |> summarise(my_z = cor(my_x, my_y))


On Sat, Apr 9, 2022 at 4:37 AM Richard M. Heiberger <rmh at temple.edu> wrote:

> look at
> ?mapply
> Apply a Function to Multiple List or Vector Arguments
>
> to see if that meets your needs
>
> > On Apr 08, 2022, at 21:26, Kelly Thompson <kt1572757 at gmail.com> wrote:
> >
> > #Q. How can I "apply" a function that takes two or more vectors as
> > arguments, such as cor(x, y), over a "category" or "grouping variable"
> > or "index"?
> > #I'm using cor() as an example, I'd like to find a way to do this for
> > any function that takes 2 or more vectors as arguments.
> >
> >
> > #create example data
> >
> > my_category <- rep ( c("a","b","c"),  4)
> >
> > set.seed(12345)
> > my_x <- rnorm(12)
> >
> > set.seed(54321)
> > my_y <- rnorm(12)
> >
> > my_df <- data.frame(my_category, my_x, my_y)
> >
> > #review data
> > my_df
> >
> > #If i wanted to get the correlation of x and y grouped by category, I
> > could use this code and loop:
> >
> > my_category_unique <- unique(my_category)
> >
> > my_results <- vector("list", length(my_category_unique) )
> > names(my_results) <- my_category_unique
> >
> > #start i loop
> >  for (i in 1:length(my_category_unique) ) {
> >    my_criteria_i <- my_category == my_category_unique[i]
> >    my_x_i <- my_x[which(my_criteria_i)]
> >    my_y_i <- my_y[which(my_criteria_i)]
> >    my_correl_i <- cor(x = my_x_i, y = my_y_i)
> >    my_results[i] <- list(my_correl_i)
> > } # end i loop
> >
> > #review results
> > my_results
> >
> > #Q. Is there a better or more "elegant" way to do this, using by(),
> > aggregate(), apply(), or some other function?
> >
> > #This does not work and results in this error message: "Error in
> > FUN(dd[x, ], ...) : incompatible dimensions"
> > by (data = my_x, INDICES = my_category, FUN = cor, y = my_y)
> >
> > #This does not work and results in this error message: "Error in
> > cor(my_df$x, my_df$y) : ... supply both 'x' and 'y' or a matrix-like
> > 'x' "
> > by (data = my_df, INDICES = my_category, FUN = function(x, y) { cor
> > (my_df$x, my_df$y) } )
> >
> >
> > #if I wanted the mean of x by category, I could use by() or aggregate():
> > by (data = my_x, INDICES = my_category, FUN = mean)
> >
> > aggregate(x = my_x, by = list(my_category), FUN = mean)
> >
> > #Thanks!
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >
> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7Crmh%40temple.edu%7C4c8a50fd1bf14b2cf7b408da19c7fe20%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637850644148770767%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=23Y%2Fqw7G1gb4ACIz5V41DjBIR8c2IFkkZgud9dGaftE%3D&amp;reserved=0
> > PLEASE do read the posting guide
> https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7Crmh%40temple.edu%7C4c8a50fd1bf14b2cf7b408da19c7fe20%7C716e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637850644148770767%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=3vIZYrMBnAZKZhZCwHcLpILHEE72NuLc03LXAxr%2BXQ4%3D&amp;reserved=0
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From m@ithiii_shiv@ m@iii@g oii y@hoo@com  Fri Apr  8 14:17:42 2022
From: m@ithiii_shiv@ m@iii@g oii y@hoo@com (m@ithiii_shiv@ m@iii@g oii y@hoo@com)
Date: Fri, 8 Apr 2022 12:17:42 +0000 (UTC)
Subject: [R] Multiplying each row of data.frame by a row in another
 data.frame
References: <54991585.2266057.1649420262120.ref@mail.yahoo.com>
Message-ID: <54991585.2266057.1649420262120@mail.yahoo.com>

Dear R forum
weights <- data.frame(id = c("ABC", "DEF",? "ONS"), value = c(1, 2, 5))
val_df <- data.frame(ABC = c(10, 20, 10, 10, 10), DEF = c(1, 2, 10, 2, 5), ONS = c(100, 100, 200, 100, 100))

> weights
? ?id? ? ? ? ? ?value1 ABC? ? ? ?12 DEF? ? ? ?23 ONS? ? ? ?5

> val_df
? ABC DEF ONS1? 10? ?1? ? ?1002? 20? ?2? ? ?1003? 10? 10? ? 2004? 10? ?2? ? 1005? 10? ?5? ? 100
I wish to multilpy each row of data.frame val_df by value column of data.frame weights.
? ABC? ? DEF? ? ONS1? 10*1? ?1*2? ?100*52? 20*1? ?2*2? ?100*53? 10*1? ?10*2? 200*54? 10*1? ?2*2? ?100*55? 10*1? ?5*2? ?100*5
ie I wish to have output as
OUTPUT
? ABC? ? DEF? ? ONS1? 10? ? 2? ? ? ? ? 5002? 20? ? 4? ? ? ? ?5003? 10? ? 20? ? ? 10004? 10? ? 4? ? ? ? 5005? 10? ? 10? ? ?500

O have tried sweep function, even matrix multiplcation etc, but nothing seems to be working.
Please guide
Regards
Maithili

	[[alternative HTML version deleted]]


From deep@y@n@@@rk@r @end|ng |rom gm@||@com  Sat Apr  9 07:16:55 2022
From: deep@y@n@@@rk@r @end|ng |rom gm@||@com (Deepayan Sarkar)
Date: Sat, 9 Apr 2022 10:46:55 +0530
Subject: [R] 
 "apply" a function that takes two or more vectors as arguments,
 such as cor(x, y), over a "category" or "grouping variable" or "index"?
In-Reply-To: <CAHfBD2fnhY5OucUuBOCvgOdk58W7OFjqNh2STYBCiJC=3U0Wzw@mail.gmail.com>
References: <CAHfBD2fnhY5OucUuBOCvgOdk58W7OFjqNh2STYBCiJC=3U0Wzw@mail.gmail.com>
Message-ID: <CADfFDC5C8jb7z-vxQD-LXHRS=AXGdDMD+TZWCnMP8tM+bo0VpQ@mail.gmail.com>

On Sat, Apr 9, 2022 at 6:56 AM Kelly Thompson <kt1572757 at gmail.com> wrote:
>
> #Q. How can I "apply" a function that takes two or more vectors as
> arguments, such as cor(x, y), over a "category" or "grouping variable"
> or "index"?
> #I'm using cor() as an example, I'd like to find a way to do this for
> any function that takes 2 or more vectors as arguments.
>
> #create example data
>
> my_category <- rep ( c("a","b","c"),  4)
>
> set.seed(12345)
> my_x <- rnorm(12)
>
> set.seed(54321)
> my_y <- rnorm(12)
>
> my_df <- data.frame(my_category, my_x, my_y)
>
> #review data
> my_df
>
> #If i wanted to get the correlation of x and y grouped by category, I
> could use this code and loop:
>
> my_category_unique <- unique(my_category)
>
> my_results <- vector("list", length(my_category_unique) )
> names(my_results) <- my_category_unique
>
> #start i loop
>   for (i in 1:length(my_category_unique) ) {
>     my_criteria_i <- my_category == my_category_unique[i]
>     my_x_i <- my_x[which(my_criteria_i)]
>     my_y_i <- my_y[which(my_criteria_i)]
>     my_correl_i <- cor(x = my_x_i, y = my_y_i)
>     my_results[i] <- list(my_correl_i)
> } # end i loop
>
> #review results
> my_results
>
> #Q. Is there a better or more "elegant" way to do this, using by(),
> aggregate(), apply(), or some other function?

split() is another generally useful function to know about: e.g.,

s <- split(my_df, ~ my_category)
lapply(s, function(d) with(d, cor(my_x, my_y)))

Best,
-Deepayan

> #This does not work and results in this error message: "Error in
> FUN(dd[x, ], ...) : incompatible dimensions"
> by (data = my_x, INDICES = my_category, FUN = cor, y = my_y)
>
> #This does not work and results in this error message: "Error in
> cor(my_df$x, my_df$y) : ... supply both 'x' and 'y' or a matrix-like
> 'x' "
> by (data = my_df, INDICES = my_category, FUN = function(x, y) { cor
> (my_df$x, my_df$y) } )
>
>
> #if I wanted the mean of x by category, I could use by() or aggregate():
> by (data = my_x, INDICES = my_category, FUN = mean)
>
> aggregate(x = my_x, by = list(my_category), FUN = mean)
>
> #Thanks!
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From er|cjberger @end|ng |rom gm@||@com  Sat Apr  9 10:58:11 2022
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Sat, 9 Apr 2022 11:58:11 +0300
Subject: [R] Multiplying each row of data.frame by a row in another
 data.frame
In-Reply-To: <54991585.2266057.1649420262120@mail.yahoo.com>
References: <54991585.2266057.1649420262120.ref@mail.yahoo.com>
 <54991585.2266057.1649420262120@mail.yahoo.com>
Message-ID: <CAGgJW75V6WZvMeM12kNrkFJCsEz9mLWmAQK4ZSQbHDxvJminZQ@mail.gmail.com>

This looks like homework, which is not permitted on this list. But
giving you the benefit of the doubt, here are two ways to do it

> as.matrix(val_df) * matrix(rep(weights$value,5),ncol=3,byrow = TRUE)
     ABC DEF  ONS
[1,]  10   2  500
[2,]  20   4  500
[3,]  10  20 1000
[4,]  10   4  500
[5,]  10  10  500
> t(apply(as.matrix(val_df),MAR=1,function(v) v * weights$value))

HTH,
Eric


On Sat, Apr 9, 2022 at 7:57 AM maithili_shiva--- via R-help
<r-help at r-project.org> wrote:
>
> Dear R forum
> weights <- data.frame(id = c("ABC", "DEF",  "ONS"), value = c(1, 2, 5))
> val_df <- data.frame(ABC = c(10, 20, 10, 10, 10), DEF = c(1, 2, 10, 2, 5), ONS = c(100, 100, 200, 100, 100))
>
> > weights
>    id           value1 ABC       12 DEF       23 ONS       5
>
> > val_df
>   ABC DEF ONS1  10   1     1002  20   2     1003  10  10    2004  10   2    1005  10   5    100
> I wish to multilpy each row of data.frame val_df by value column of data.frame weights.
>   ABC    DEF    ONS1  10*1   1*2   100*52  20*1   2*2   100*53  10*1   10*2  200*54  10*1   2*2   100*55  10*1   5*2   100*5
> ie I wish to have output as
> OUTPUT
>   ABC    DEF    ONS1  10    2          5002  20    4         5003  10    20      10004  10    4        5005  10    10     500
>
> O have tried sweep function, even matrix multiplcation etc, but nothing seems to be working.
> Please guide
> Regards
> Maithili
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Apr  9 14:32:07 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 9 Apr 2022 13:32:07 +0100
Subject: [R] 
 "apply" a function that takes two or more vectors as arguments,
 such as cor(x, y), over a "category" or "grouping variable" or "index"?
In-Reply-To: <CAHfBD2fnhY5OucUuBOCvgOdk58W7OFjqNh2STYBCiJC=3U0Wzw@mail.gmail.com>
References: <CAHfBD2fnhY5OucUuBOCvgOdk58W7OFjqNh2STYBCiJC=3U0Wzw@mail.gmail.com>
Message-ID: <8c4620e9-11e2-70e7-1a51-c10f0ecdca72@sapo.pt>

Hello,

Another option is ?by.


by(my_df[-1], my_df$my_category, cor)
by(my_df[-1], my_df$my_category, \(x) cor(x)[1,2])


Hope this helps,

Rui Barradas

?s 02:26 de 09/04/2022, Kelly Thompson escreveu:
> #Q. How can I "apply" a function that takes two or more vectors as
> arguments, such as cor(x, y), over a "category" or "grouping variable"
> or "index"?
> #I'm using cor() as an example, I'd like to find a way to do this for
> any function that takes 2 or more vectors as arguments.
> 
> 
> #create example data
> 
> my_category <- rep ( c("a","b","c"),  4)
> 
> set.seed(12345)
> my_x <- rnorm(12)
> 
> set.seed(54321)
> my_y <- rnorm(12)
> 
> my_df <- data.frame(my_category, my_x, my_y)
> 
> #review data
> my_df
> 
> #If i wanted to get the correlation of x and y grouped by category, I
> could use this code and loop:
> 
> my_category_unique <- unique(my_category)
> 
> my_results <- vector("list", length(my_category_unique) )
> names(my_results) <- my_category_unique
> 
> #start i loop
>    for (i in 1:length(my_category_unique) ) {
>      my_criteria_i <- my_category == my_category_unique[i]
>      my_x_i <- my_x[which(my_criteria_i)]
>      my_y_i <- my_y[which(my_criteria_i)]
>      my_correl_i <- cor(x = my_x_i, y = my_y_i)
>      my_results[i] <- list(my_correl_i)
> } # end i loop
> 
> #review results
> my_results
> 
> #Q. Is there a better or more "elegant" way to do this, using by(),
> aggregate(), apply(), or some other function?
> 
> #This does not work and results in this error message: "Error in
> FUN(dd[x, ], ...) : incompatible dimensions"
> by (data = my_x, INDICES = my_category, FUN = cor, y = my_y)
> 
> #This does not work and results in this error message: "Error in
> cor(my_df$x, my_df$y) : ... supply both 'x' and 'y' or a matrix-like
> 'x' "
> by (data = my_df, INDICES = my_category, FUN = function(x, y) { cor
> (my_df$x, my_df$y) } )
> 
> 
> #if I wanted the mean of x by category, I could use by() or aggregate():
> by (data = my_x, INDICES = my_category, FUN = mean)
> 
> aggregate(x = my_x, by = list(my_category), FUN = mean)
> 
> #Thanks!
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kt1572757 @end|ng |rom gm@||@com  Sat Apr  9 18:36:50 2022
From: kt1572757 @end|ng |rom gm@||@com (Kelly Thompson)
Date: Sat, 9 Apr 2022 09:36:50 -0700
Subject: [R] 
 "apply" a function that takes two or more vectors as arguments,
 such as cor(x, y), over a "category" or "grouping variable" or "index"?
In-Reply-To: <8c4620e9-11e2-70e7-1a51-c10f0ecdca72@sapo.pt>
References: <CAHfBD2fnhY5OucUuBOCvgOdk58W7OFjqNh2STYBCiJC=3U0Wzw@mail.gmail.com>
 <8c4620e9-11e2-70e7-1a51-c10f0ecdca72@sapo.pt>
Message-ID: <CAHfBD2ePWmLO6VUXM7fz+r=P=6wnX_+WhxoqZDYoQ4=xNTWVEQ@mail.gmail.com>

Thanks. I have a clarification and a follow-up question. I should have
asked this in the original post, and I should have provided a better
example for the FUN argument, I apologize.

For use in an example, here is a "silly" example of a function that
requires arguments such as x and y to be "separately assigned" :

udf_x_plus_y <- function (x, y) { return ( x + y) }

Q. Is there a way to use by() when the argument of FUN is a function
that requires arguments such as "x" and "y" to be separately assigned
(ex. udf_x_plus_y (x = my_x , y = my_y ), rather than assigned as a
range of columns using brackets (ex. cor(x)[1,2]) ?

Something like this perhaps? (This produces an error message.)
by( data = my_df[-1], INDICES = my_df$my_category,  FUN = function(x,
y) { udf_x_plus_y (x = data$my_x, y = data$my_y) } )

Thanks again.

On Sat, Apr 9, 2022 at 5:32 AM Rui Barradas <ruipbarradas at sapo.pt> wrote:
>
> Hello,
>
> Another option is ?by.
>
>
> by(my_df[-1], my_df$my_category, cor)
> by(my_df[-1], my_df$my_category, \(x) cor(x)[1,2])
>
>
> Hope this helps,
>
> Rui Barradas
>
> ?s 02:26 de 09/04/2022, Kelly Thompson escreveu:
> > #Q. How can I "apply" a function that takes two or more vectors as
> > arguments, such as cor(x, y), over a "category" or "grouping variable"
> > or "index"?
> > #I'm using cor() as an example, I'd like to find a way to do this for
> > any function that takes 2 or more vectors as arguments.
> >
> >
> > #create example data
> >
> > my_category <- rep ( c("a","b","c"),  4)
> >
> > set.seed(12345)
> > my_x <- rnorm(12)
> >
> > set.seed(54321)
> > my_y <- rnorm(12)
> >
> > my_df <- data.frame(my_category, my_x, my_y)
> >
> > #review data
> > my_df
> >
> > #If i wanted to get the correlation of x and y grouped by category, I
> > could use this code and loop:
> >
> > my_category_unique <- unique(my_category)
> >
> > my_results <- vector("list", length(my_category_unique) )
> > names(my_results) <- my_category_unique
> >
> > #start i loop
> >    for (i in 1:length(my_category_unique) ) {
> >      my_criteria_i <- my_category == my_category_unique[i]
> >      my_x_i <- my_x[which(my_criteria_i)]
> >      my_y_i <- my_y[which(my_criteria_i)]
> >      my_correl_i <- cor(x = my_x_i, y = my_y_i)
> >      my_results[i] <- list(my_correl_i)
> > } # end i loop
> >
> > #review results
> > my_results
> >
> > #Q. Is there a better or more "elegant" way to do this, using by(),
> > aggregate(), apply(), or some other function?
> >
> > #This does not work and results in this error message: "Error in
> > FUN(dd[x, ], ...) : incompatible dimensions"
> > by (data = my_x, INDICES = my_category, FUN = cor, y = my_y)
> >
> > #This does not work and results in this error message: "Error in
> > cor(my_df$x, my_df$y) : ... supply both 'x' and 'y' or a matrix-like
> > 'x' "
> > by (data = my_df, INDICES = my_category, FUN = function(x, y) { cor
> > (my_df$x, my_df$y) } )
> >
> >
> > #if I wanted the mean of x by category, I could use by() or aggregate():
> > by (data = my_x, INDICES = my_category, FUN = mean)
> >
> > aggregate(x = my_x, by = list(my_category), FUN = mean)
> >
> > #Thanks!
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.


From kt1572757 @end|ng |rom gm@||@com  Sat Apr  9 18:49:43 2022
From: kt1572757 @end|ng |rom gm@||@com (Kelly Thompson)
Date: Sat, 9 Apr 2022 09:49:43 -0700
Subject: [R] Multiplying each row of data.frame by a row in another
 data.frame
In-Reply-To: <54991585.2266057.1649420262120@mail.yahoo.com>
References: <54991585.2266057.1649420262120.ref@mail.yahoo.com>
 <54991585.2266057.1649420262120@mail.yahoo.com>
Message-ID: <CAHfBD2fYJ1xTP8GjvF=OYY4rP3e8TdjuzkHjY+B5D-jtmmkiQw@mail.gmail.com>

Does this produce the desired results?
Also, even if this produces your desired results, I am not sure it is
the "best" way to do this. There might be better ways.

data.frame( t ( t(val_df) * (weights$value) )

On Fri, Apr 8, 2022 at 9:57 PM maithili_shiva--- via R-help
<r-help at r-project.org> wrote:
>
> Dear R forum
> weights <- data.frame(id = c("ABC", "DEF",  "ONS"), value = c(1, 2, 5))
> val_df <- data.frame(ABC = c(10, 20, 10, 10, 10), DEF = c(1, 2, 10, 2, 5), ONS = c(100, 100, 200, 100, 100))
>
> > weights
>    id           value1 ABC       12 DEF       23 ONS       5
>
> > val_df
>   ABC DEF ONS1  10   1     1002  20   2     1003  10  10    2004  10   2    1005  10   5    100
> I wish to multilpy each row of data.frame val_df by value column of data.frame weights.
>   ABC    DEF    ONS1  10*1   1*2   100*52  20*1   2*2   100*53  10*1   10*2  200*54  10*1   2*2   100*55  10*1   5*2   100*5
> ie I wish to have output as
> OUTPUT
>   ABC    DEF    ONS1  10    2          5002  20    4         5003  10    20      10004  10    4        5005  10    10     500
>
> O have tried sweep function, even matrix multiplcation etc, but nothing seems to be working.
> Please guide
> Regards
> Maithili
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Apr  9 18:50:04 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 9 Apr 2022 17:50:04 +0100
Subject: [R] 
 "apply" a function that takes two or more vectors as arguments,
 such as cor(x, y), over a "category" or "grouping variable" or "index"?
In-Reply-To: <CAHfBD2ePWmLO6VUXM7fz+r=P=6wnX_+WhxoqZDYoQ4=xNTWVEQ@mail.gmail.com>
References: <CAHfBD2fnhY5OucUuBOCvgOdk58W7OFjqNh2STYBCiJC=3U0Wzw@mail.gmail.com>
 <8c4620e9-11e2-70e7-1a51-c10f0ecdca72@sapo.pt>
 <CAHfBD2ePWmLO6VUXM7fz+r=P=6wnX_+WhxoqZDYoQ4=xNTWVEQ@mail.gmail.com>
Message-ID: <802ed47c-59f8-9d50-19a6-a4f38acb6afb@sapo.pt>

Hello,

Yes, that's possible. Must by() will still pass only one object to the 
function. Then, in the function, process this object's columns.


by(my_df[-1], my_df$my_category, \(x) udf_x_plus_y(x[[1]], x[[2]]))


Hope this helps,

Rui Barradas

?s 17:36 de 09/04/2022, Kelly Thompson escreveu:
> Thanks. I have a clarification and a follow-up question. I should have
> asked this in the original post, and I should have provided a better
> example for the FUN argument, I apologize.
> 
> For use in an example, here is a "silly" example of a function that
> requires arguments such as x and y to be "separately assigned" :
> 
> udf_x_plus_y <- function (x, y) { return ( x + y) }
> 
> Q. Is there a way to use by() when the argument of FUN is a function
> that requires arguments such as "x" and "y" to be separately assigned
> (ex. udf_x_plus_y (x = my_x , y = my_y ), rather than assigned as a
> range of columns using brackets (ex. cor(x)[1,2]) ?
> 
> Something like this perhaps? (This produces an error message.)
> by( data = my_df[-1], INDICES = my_df$my_category,  FUN = function(x,
> y) { udf_x_plus_y (x = data$my_x, y = data$my_y) } )
> 
> Thanks again.
> 
> On Sat, Apr 9, 2022 at 5:32 AM Rui Barradas <ruipbarradas at sapo.pt> wrote:
>>
>> Hello,
>>
>> Another option is ?by.
>>
>>
>> by(my_df[-1], my_df$my_category, cor)
>> by(my_df[-1], my_df$my_category, \(x) cor(x)[1,2])
>>
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>> ?s 02:26 de 09/04/2022, Kelly Thompson escreveu:
>>> #Q. How can I "apply" a function that takes two or more vectors as
>>> arguments, such as cor(x, y), over a "category" or "grouping variable"
>>> or "index"?
>>> #I'm using cor() as an example, I'd like to find a way to do this for
>>> any function that takes 2 or more vectors as arguments.
>>>
>>>
>>> #create example data
>>>
>>> my_category <- rep ( c("a","b","c"),  4)
>>>
>>> set.seed(12345)
>>> my_x <- rnorm(12)
>>>
>>> set.seed(54321)
>>> my_y <- rnorm(12)
>>>
>>> my_df <- data.frame(my_category, my_x, my_y)
>>>
>>> #review data
>>> my_df
>>>
>>> #If i wanted to get the correlation of x and y grouped by category, I
>>> could use this code and loop:
>>>
>>> my_category_unique <- unique(my_category)
>>>
>>> my_results <- vector("list", length(my_category_unique) )
>>> names(my_results) <- my_category_unique
>>>
>>> #start i loop
>>>     for (i in 1:length(my_category_unique) ) {
>>>       my_criteria_i <- my_category == my_category_unique[i]
>>>       my_x_i <- my_x[which(my_criteria_i)]
>>>       my_y_i <- my_y[which(my_criteria_i)]
>>>       my_correl_i <- cor(x = my_x_i, y = my_y_i)
>>>       my_results[i] <- list(my_correl_i)
>>> } # end i loop
>>>
>>> #review results
>>> my_results
>>>
>>> #Q. Is there a better or more "elegant" way to do this, using by(),
>>> aggregate(), apply(), or some other function?
>>>
>>> #This does not work and results in this error message: "Error in
>>> FUN(dd[x, ], ...) : incompatible dimensions"
>>> by (data = my_x, INDICES = my_category, FUN = cor, y = my_y)
>>>
>>> #This does not work and results in this error message: "Error in
>>> cor(my_df$x, my_df$y) : ... supply both 'x' and 'y' or a matrix-like
>>> 'x' "
>>> by (data = my_df, INDICES = my_category, FUN = function(x, y) { cor
>>> (my_df$x, my_df$y) } )
>>>
>>>
>>> #if I wanted the mean of x by category, I could use by() or aggregate():
>>> by (data = my_x, INDICES = my_category, FUN = mean)
>>>
>>> aggregate(x = my_x, by = list(my_category), FUN = mean)
>>>
>>> #Thanks!
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Apr  9 19:03:42 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 9 Apr 2022 18:03:42 +0100
Subject: [R] 
 "apply" a function that takes two or more vectors as arguments,
 such as cor(x, y), over a "category" or "grouping variable" or "index"?
In-Reply-To: <802ed47c-59f8-9d50-19a6-a4f38acb6afb@sapo.pt>
References: <CAHfBD2fnhY5OucUuBOCvgOdk58W7OFjqNh2STYBCiJC=3U0Wzw@mail.gmail.com>
 <8c4620e9-11e2-70e7-1a51-c10f0ecdca72@sapo.pt>
 <CAHfBD2ePWmLO6VUXM7fz+r=P=6wnX_+WhxoqZDYoQ4=xNTWVEQ@mail.gmail.com>
 <802ed47c-59f8-9d50-19a6-a4f38acb6afb@sapo.pt>
Message-ID: <39dc4733-bee0-f84d-564d-24cdb79311ee@sapo.pt>

Hello,



?s 17:50 de 09/04/2022, Rui Barradas escreveu:
> Hello,
> 
> Yes, that's possible. Must by() will still pass only one object to the 

Typo: "But" ------------^^^^

Rui Barradas

> function. Then, in the function, process this object's columns.
> 
> 
> by(my_df[-1], my_df$my_category, \(x) udf_x_plus_y(x[[1]], x[[2]]))
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 17:36 de 09/04/2022, Kelly Thompson escreveu:
>> Thanks. I have a clarification and a follow-up question. I should have
>> asked this in the original post, and I should have provided a better
>> example for the FUN argument, I apologize.
>>
>> For use in an example, here is a "silly" example of a function that
>> requires arguments such as x and y to be "separately assigned" :
>>
>> udf_x_plus_y <- function (x, y) { return ( x + y) }
>>
>> Q. Is there a way to use by() when the argument of FUN is a function
>> that requires arguments such as "x" and "y" to be separately assigned
>> (ex. udf_x_plus_y (x = my_x , y = my_y ), rather than assigned as a
>> range of columns using brackets (ex. cor(x)[1,2]) ?
>>
>> Something like this perhaps? (This produces an error message.)
>> by( data = my_df[-1], INDICES = my_df$my_category,? FUN = function(x,
>> y) { udf_x_plus_y (x = data$my_x, y = data$my_y) } )
>>
>> Thanks again.
>>
>> On Sat, Apr 9, 2022 at 5:32 AM Rui Barradas <ruipbarradas at sapo.pt> wrote:
>>>
>>> Hello,
>>>
>>> Another option is ?by.
>>>
>>>
>>> by(my_df[-1], my_df$my_category, cor)
>>> by(my_df[-1], my_df$my_category, \(x) cor(x)[1,2])
>>>
>>>
>>> Hope this helps,
>>>
>>> Rui Barradas
>>>
>>> ?s 02:26 de 09/04/2022, Kelly Thompson escreveu:
>>>> #Q. How can I "apply" a function that takes two or more vectors as
>>>> arguments, such as cor(x, y), over a "category" or "grouping variable"
>>>> or "index"?
>>>> #I'm using cor() as an example, I'd like to find a way to do this for
>>>> any function that takes 2 or more vectors as arguments.
>>>>
>>>>
>>>> #create example data
>>>>
>>>> my_category <- rep ( c("a","b","c"),? 4)
>>>>
>>>> set.seed(12345)
>>>> my_x <- rnorm(12)
>>>>
>>>> set.seed(54321)
>>>> my_y <- rnorm(12)
>>>>
>>>> my_df <- data.frame(my_category, my_x, my_y)
>>>>
>>>> #review data
>>>> my_df
>>>>
>>>> #If i wanted to get the correlation of x and y grouped by category, I
>>>> could use this code and loop:
>>>>
>>>> my_category_unique <- unique(my_category)
>>>>
>>>> my_results <- vector("list", length(my_category_unique) )
>>>> names(my_results) <- my_category_unique
>>>>
>>>> #start i loop
>>>> ??? for (i in 1:length(my_category_unique) ) {
>>>> ????? my_criteria_i <- my_category == my_category_unique[i]
>>>> ????? my_x_i <- my_x[which(my_criteria_i)]
>>>> ????? my_y_i <- my_y[which(my_criteria_i)]
>>>> ????? my_correl_i <- cor(x = my_x_i, y = my_y_i)
>>>> ????? my_results[i] <- list(my_correl_i)
>>>> } # end i loop
>>>>
>>>> #review results
>>>> my_results
>>>>
>>>> #Q. Is there a better or more "elegant" way to do this, using by(),
>>>> aggregate(), apply(), or some other function?
>>>>
>>>> #This does not work and results in this error message: "Error in
>>>> FUN(dd[x, ], ...) : incompatible dimensions"
>>>> by (data = my_x, INDICES = my_category, FUN = cor, y = my_y)
>>>>
>>>> #This does not work and results in this error message: "Error in
>>>> cor(my_df$x, my_df$y) : ... supply both 'x' and 'y' or a matrix-like
>>>> 'x' "
>>>> by (data = my_df, INDICES = my_category, FUN = function(x, y) { cor
>>>> (my_df$x, my_df$y) } )
>>>>
>>>>
>>>> #if I wanted the mean of x by category, I could use by() or 
>>>> aggregate():
>>>> by (data = my_x, INDICES = my_category, FUN = mean)
>>>>
>>>> aggregate(x = my_x, by = list(my_category), FUN = mean)
>>>>
>>>> #Thanks!
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide 
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @v|gro@@ @end|ng |rom ver|zon@net  Sat Apr  9 19:37:32 2022
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Sat, 9 Apr 2022 17:37:32 +0000 (UTC)
Subject: [R] Multiplying each row of data.frame by a row in another
 data.frame
In-Reply-To: <CAHfBD2fYJ1xTP8GjvF=OYY4rP3e8TdjuzkHjY+B5D-jtmmkiQw@mail.gmail.com>
References: <54991585.2266057.1649420262120.ref@mail.yahoo.com>
 <54991585.2266057.1649420262120@mail.yahoo.com>
 <CAHfBD2fYJ1xTP8GjvF=OYY4rP3e8TdjuzkHjY+B5D-jtmmkiQw@mail.gmail.com>
Message-ID: <1692923579.129099.1649525852586@mail.yahoo.com>

As usual, it would be really nice if we KNEW what the parameters of a problem?are before offering many solutions based on guesses.
The trivial solution seems to be component-wise multiplication of a vector?in sequential steps against each column of a data.frame.
Unless you have tons of columns, this is easy and straightforward.
If the goal is to do it in a more general way so that no matter how manycolumns there are, then it depends on whether this is homework and what?is valid to use. And, in that case, people may not wish to provide a solution directly.
There are MANY possible solutions including some that have been offered whichtake the vector you are multiplying by and expand it into? a matrix made of copies.
My text may wrap funny no matter what I do so here are two data structures:
orig <- data.frame(a=1:3, b=3:1, c=c(10,15,20))

vec <- c(1, 10, 100)



The first has columns going from 1 to 3 and from 3 to 1 and then by fives from 10 to 20.
The second is simply the powers of 10 from 1 to 100.
If you multiply the data.frame by the vector in R, it multiplies various ways you can change?by using a transpose but not necesarily the results intended.

Many would suggest some of the newer packages, especially dplyr in the tidyverse.
The following works for me. It takes the original column and mutates every column?back into the same name by multiplying the "current" column denoted by ".x"?against the vector.
mutate_all(orig, ~ .x * vec)


Again, as my text using this mailer gets shown oddly to someone?no matter what I do, I am not sowing the results or trying to show multi-line?code.?
Do note the dplyr packages themselves keep mutating and things get?deprecated so you may find that it suggests another way to do the above?and especially if you search the internet and find advice from various?versions. Be that as it may, there are various solutions.



-----Original Message-----
From: Kelly Thompson <kt1572757 at gmail.com>
Cc: r-help at r-project.org <r-help at r-project.org>
Sent: Sat, Apr 9, 2022 12:49 pm
Subject: Re: [R] Multiplying each row of data.frame by a row in another data.frame

Does this produce the desired results?
Also, even if this produces your desired results, I am not sure it is
the "best" way to do this. There might be better ways.

data.frame( t ( t(val_df) * (weights$value) )

On Fri, Apr 8, 2022 at 9:57 PM maithili_shiva--- via R-help
<r-help at r-project.org> wrote:
>
> Dear R forum
> weights <- data.frame(id = c("ABC", "DEF",? "ONS"), value = c(1, 2, 5))
> val_df <- data.frame(ABC = c(10, 20, 10, 10, 10), DEF = c(1, 2, 10, 2, 5), ONS = c(100, 100, 200, 100, 100))
>
> > weights
>? ? id? ? ? ? ? value1 ABC? ? ? 12 DEF? ? ? 23 ONS? ? ? 5
>
> > val_df
>? ABC DEF ONS1? 10? 1? ? 1002? 20? 2? ? 1003? 10? 10? ? 2004? 10? 2? ? 1005? 10? 5? ? 100
> I wish to multilpy each row of data.frame val_df by value column of data.frame weights.
>? ABC? ? DEF? ? ONS1? 10*1? 1*2? 100*52? 20*1? 2*2? 100*53? 10*1? 10*2? 200*54? 10*1? 2*2? 100*55? 10*1? 5*2? 100*5
> ie I wish to have output as
> OUTPUT
>? ABC? ? DEF? ? ONS1? 10? ? 2? ? ? ? ? 5002? 20? ? 4? ? ? ? 5003? 10? ? 20? ? ? 10004? 10? ? 4? ? ? ? 5005? 10? ? 10? ? 500
>
> O have tried sweep function, even matrix multiplcation etc, but nothing seems to be working.
> Please guide
> Regards
> Maithili
>
>? ? ? ? [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From @v|gro@@ @end|ng |rom ver|zon@net  Sat Apr  9 19:52:19 2022
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Sat, 9 Apr 2022 17:52:19 +0000 (UTC)
Subject: [R] Multiplying each row of data.frame by a row in another
 data.frame
In-Reply-To: <CAHfBD2fYJ1xTP8GjvF=OYY4rP3e8TdjuzkHjY+B5D-jtmmkiQw@mail.gmail.com>
References: <54991585.2266057.1649420262120.ref@mail.yahoo.com>
 <54991585.2266057.1649420262120@mail.yahoo.com>
 <CAHfBD2fYJ1xTP8GjvF=OYY4rP3e8TdjuzkHjY+B5D-jtmmkiQw@mail.gmail.com>
Message-ID: <1989837054.102672.1649526739168@mail.yahoo.com>

Within standard R, it is common to take objects that are lists (as a data.frame is) 
apart and apply some function and recombine them. So using my example in an earlier 
message, and hoping this text-mode message is readable, try something like this
to multiply each column of a data.frame by the same vector and return the data.frame.

Note the multiply operation as a function is denoted by `*` including the grave accents.

> orig <- data.frame(a=1:3, b=3:1, c=c(10,15,20))
> orig
  a b  c
1 1 3 10
2 2 2 15
3 3 1 20
> vec <- c(1, 10, 100)
> as.data.frame(lapply(orig, `*`, vec))
    a   b    c
1   1   3   10
2  20  20  150
3 300 100 2000

You can also use sapply but it returns more of a matrix than a data.frame:

> sapply(orig, `*`, vec)
       a   b    c
[1,]   1   3   10
[2,]  20  20  150
[3,] 300 100 2000
> class(sapply(orig, `*`, vec))
[1] "matrix" "array"

Again, there are an amazing number of ways to do anything in R.







-----Original Message-----
From: Kelly Thompson <kt1572757 at gmail.com>
Cc: r-help at r-project.org <r-help at r-project.org>
Sent: Sat, Apr 9, 2022 12:49 pm
Subject: Re: [R] Multiplying each row of data.frame by a row in another data.frame


Does this produce the desired results?
Also, even if this produces your desired results, I am not sure it is
the "best" way to do this. There might be better ways.

data.frame( t ( t(val_df) * (weights$value) )

On Fri, Apr 8, 2022 at 9:57 PM maithili_shiva--- via R-help
<r-help at r-project.org> wrote:
>
> Dear R forum
> weights <- data.frame(id = c("ABC", "DEF",? "ONS"), value = c(1, 2, 5))
> val_df <- data.frame(ABC = c(10, 20, 10, 10, 10), DEF = c(1, 2, 10, 2, 5), ONS = c(100, 100, 200, 100, 100))
>
> > weights
>? ? id? ? ? ? ?  value1 ABC? ? ?  12 DEF? ? ?  23 ONS? ? ?  5
>
> > val_df
>?  ABC DEF ONS1? 10?  1? ?  1002? 20?  2? ?  1003? 10? 10? ? 2004? 10?  2? ? 1005? 10?  5? ? 100
> I wish to multilpy each row of data.frame val_df by value column of data.frame weights.
>?  ABC? ? DEF? ? ONS1? 10*1?  1*2?  100*52? 20*1?  2*2?  100*53? 10*1?  10*2? 200*54? 10*1?  2*2?  100*55? 10*1?  5*2?  100*5
> ie I wish to have output as
> OUTPUT
>?  ABC? ? DEF? ? ONS1? 10? ? 2? ? ? ? ? 5002? 20? ? 4? ? ? ?  5003? 10? ? 20? ? ? 10004? 10? ? 4? ? ? ? 5005? 10? ? 10? ?  500
>
> O have tried sweep function, even matrix multiplcation etc, but nothing seems to be working.
> Please guide
> Regards
> Maithili
>
>? ? ? ?  [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From m@ithiii_shiv@ m@iii@g oii y@hoo@com  Sun Apr 10 09:34:29 2022
From: m@ithiii_shiv@ m@iii@g oii y@hoo@com (m@ithiii_shiv@ m@iii@g oii y@hoo@com)
Date: Sun, 10 Apr 2022 07:34:29 +0000 (UTC)
Subject: [R] Multiplying each row of data.frame by a row in another
 data.frame
In-Reply-To: <1989837054.102672.1649526739168@mail.yahoo.com>
References: <54991585.2266057.1649420262120.ref@mail.yahoo.com>
 <54991585.2266057.1649420262120@mail.yahoo.com>
 <CAHfBD2fYJ1xTP8GjvF=OYY4rP3e8TdjuzkHjY+B5D-jtmmkiQw@mail.gmail.com>
 <1989837054.102672.1649526739168@mail.yahoo.com>
Message-ID: <2000943948.199827.1649576069628@mail.yahoo.com>

 Dear all,
Thanks a lot for your valuable input. At the outset, let me clarify first that this was not a homework. In reality I had a data.frame containing returns of 121 risk factors and another data.frame of 121 weights arrived at using Marked to market (MTM) values of these 121 risk factors.?
There are 250 returns for each of these 121 risk factors and I wanted to compute portfolio weighted return.
So kindly don't feel this was homework. I just tried to simply my objective.
Thanks a lot "Eric Burger", "Kelly Thompson", "Avi Gross" for your guidance.
Regards
Maithili
    On Saturday, 9 April, 2022, 11:23:10 pm IST, Avi Gross via R-help <r-help at r-project.org> wrote:  
 
 Within standard R, it is common to take objects that are lists (as a data.frame is) 
apart and apply some function and recombine them. So using my example in an earlier 
message, and hoping this text-mode message is readable, try something like this
to multiply each column of a data.frame by the same vector and return the data.frame.

Note the multiply operation as a function is denoted by `*` including the grave accents.

> orig <- data.frame(a=1:3, b=3:1, c=c(10,15,20))
> orig
? a b? c
1 1 3 10
2 2 2 15
3 3 1 20
> vec <- c(1, 10, 100)
> as.data.frame(lapply(orig, `*`, vec))
? ? a? b? ? c
1? 1? 3? 10
2? 20? 20? 150
3 300 100 2000

You can also use sapply but it returns more of a matrix than a data.frame:

> sapply(orig, `*`, vec)
? ? ? a? b? ? c
[1,]? 1? 3? 10
[2,]? 20? 20? 150
[3,] 300 100 2000
> class(sapply(orig, `*`, vec))
[1] "matrix" "array"

Again, there are an amazing number of ways to do anything in R.







-----Original Message-----
From: Kelly Thompson <kt1572757 at gmail.com>
Cc: r-help at r-project.org <r-help at r-project.org>
Sent: Sat, Apr 9, 2022 12:49 pm
Subject: Re: [R] Multiplying each row of data.frame by a row in another data.frame


Does this produce the desired results?
Also, even if this produces your desired results, I am not sure it is
the "best" way to do this. There might be better ways.

data.frame( t ( t(val_df) * (weights$value) )

On Fri, Apr 8, 2022 at 9:57 PM maithili_shiva--- via R-help
<r-help at r-project.org> wrote:
>
> Dear R forum
> weights <- data.frame(id = c("ABC", "DEF",? "ONS"), value = c(1, 2, 5))
> val_df <- data.frame(ABC = c(10, 20, 10, 10, 10), DEF = c(1, 2, 10, 2, 5), ONS = c(100, 100, 200, 100, 100))
>
> > weights
>? ? id? ? ? ? ?? value1 ABC? ? ?? 12 DEF? ? ?? 23 ONS? ? ?? 5
>
> > val_df
>?? ABC DEF ONS1? 10?? 1? ?? 1002? 20?? 2? ?? 1003? 10? 10? ? 2004? 10?? 2? ? 1005? 10?? 5? ? 100
> I wish to multilpy each row of data.frame val_df by value column of data.frame weights.
>?? ABC? ? DEF? ? ONS1? 10*1?? 1*2?? 100*52? 20*1?? 2*2?? 100*53? 10*1?? 10*2? 200*54? 10*1?? 2*2?? 100*55? 10*1?? 5*2?? 100*5
> ie I wish to have output as
> OUTPUT
>?? ABC? ? DEF? ? ONS1? 10? ? 2? ? ? ? ? 5002? 20? ? 4? ? ? ?? 5003? 10? ? 20? ? ? 10004? 10? ? 4? ? ? ? 5005? 10? ? 10? ?? 500
>
> O have tried sweep function, even matrix multiplcation etc, but nothing seems to be working.
> Please guide
> Regards
> Maithili
>
>? ? ? ?? [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.
  
	[[alternative HTML version deleted]]


From j@ork|n @end|ng |rom @om@um@ry|@nd@edu  Sun Apr 10 23:40:36 2022
From: j@ork|n @end|ng |rom @om@um@ry|@nd@edu (Sorkin, John)
Date: Sun, 10 Apr 2022 21:40:36 +0000
Subject: [R] superscript of plot 2 x-mean(x) vs. (x-xmean)^2 has part of the
 superscript 2 cutoff.
Message-ID: <MN2PR03MB5167A884291919B3B40F911AE2EB9@MN2PR03MB5167.namprd03.prod.outlook.com>



I am trying to produce two plots, one of x vs x^2 and the other x-mean(x) vs. (x-mean(x))^2 using base R functions. All works well EXCEPT for the superscript of the y axis of the second plot. Half of the superscript 2 in (x-mean(x))^2 is cut off. My code follows. Any suggestions for modification to the plot so that the superscript 2 will not be cut off would be apprecated.


x <- 0:100
xsq <- x^2
mydata1 <-data.frame(x=x,xsq=xsq)

oldpar <- par(mfrow=c(1,2),mfcol=c(1,2))

# First plot. This plot is fine.
plot(x,xsq,xlab="",ylab="",cex=0.5)
title(,xlab="x",ylab=expression(x^2))
abline(lm(xsq~x,data=mydata),col="red")
length(x)
length(xsq)
cor(x,xsq)
text(40, 8000, expression(Correlation == 0.97))

# Second Plot. Label of the y axis of this plot
# has the superscript 2 cut off.
xcentered <- x-mean(x)
xcenteredsq <- xcentered^2
plot(xcentered,xcenteredsq,xlab="",ylab="",cex=0.5)
# Superscipt of the y axis is cut off.
title(xlab="x-mean(x)",ylab=expression((x-mean(x))^2))
abline(lm(xcenteredsq~xcentered),col="red")
cor(xcentered,xcenteredsq)
text(0, 2000, expression(Correlation == 0.00))


Thank you,
John

Sent from Mail<https://go.microsoft.com/fwlink/?LinkId=550986> for Windows


	[[alternative HTML version deleted]]


From j|ox @end|ng |rom mcm@@ter@c@  Sun Apr 10 23:50:33 2022
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Sun, 10 Apr 2022 17:50:33 -0400
Subject: [R] 
 superscript of plot 2 x-mean(x) vs. (x-xmean)^2 has part of the
 superscript 2 cutoff.
In-Reply-To: <20045_1649626864_23ALf4aw028338_MN2PR03MB5167A884291919B3B40F911AE2EB9@MN2PR03MB5167.namprd03.prod.outlook.com>
References: <20045_1649626864_23ALf4aw028338_MN2PR03MB5167A884291919B3B40F911AE2EB9@MN2PR03MB5167.namprd03.prod.outlook.com>
Message-ID: <b526567b-9230-8d36-ccdd-80c365aa826b@mcmaster.ca>

Dear John,

You can adjust par("mar"), e.g.,

oldpar <- par(mfrow=c(1,2),mfcol=c(1,2), mar=0.1+c(5, 5, 1, 1))

I hope this helps,
  John

On 2022-04-10 5:40 p.m., Sorkin, John wrote:
> x <- 0:100
> xsq <- x^2
> mydata1 <-data.frame(x=x,xsq=xsq)
> 
> oldpar <- par(mfrow=c(1,2),mfcol=c(1,2))
> 
> # First plot. This plot is fine.
> plot(x,xsq,xlab="",ylab="",cex=0.5)
> title(,xlab="x",ylab=expression(x^2))
> abline(lm(xsq~x,data=mydata),col="red")
> length(x)
> length(xsq)
> cor(x,xsq)
> text(40, 8000, expression(Correlation == 0.97))
> 
> # Second Plot. Label of the y axis of this plot
> # has the superscript 2 cut off.
> xcentered <- x-mean(x)
> xcenteredsq <- xcentered^2
> plot(xcentered,xcenteredsq,xlab="",ylab="",cex=0.5)
> # Superscipt of the y axis is cut off.
> title(xlab="x-mean(x)",ylab=expression((x-mean(x))^2))
> abline(lm(xcenteredsq~xcentered),col="red")
> cor(xcentered,xcenteredsq)
> text(0, 2000, expression(Correlation == 0.00))
-- 
John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://socialsciences.mcmaster.ca/jfox/


From r@turner @end|ng |rom @uck|@nd@@c@nz  Mon Apr 11 05:25:53 2022
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Mon, 11 Apr 2022 15:25:53 +1200
Subject: [R] Stack smashing again.
Message-ID: <20220411152553.0ca7f03f@rolf-Latitude-E7470>


    To all and sundry, near and far,
    Ivan Krylov in particular ....

(The latter being singled out because he was so helpful the last time I
asked a question on this issue.  My apologies to him if I am being a
pest.)

I have again been beset by a "stack smashing" problem when trying
to run R code that calls upon dynamically loaded Fortran.  I have now
reached the end of my limited mental resources in trying to solve this
problem, so I am beseeching R-help to come to my assistance.

I have applied valgrind to try to track down the source of the problem.
I.e. I started R using "R -d valgrind".  The output from trying to run
my code is in the attached file "vgo.txt".  All that I can discern from
this output is that something went wrong.  The "location" of the
problem seems to be specified as line 85 in the Fortran file "getgl.f",
but this is the last line ("end") of that file, so this just seems to be
saying that there is something wrong, somewhere in this file!

I have bundled up all of the components of a reproducible example in a
"shell archive" that I have named "shark.txt" (which is attached). To
investigate the problem:

* unpack the shell archive using "sh shark.txt"
* create a shared object library using "R CMD SHLIB -o hah.so *.f"
* start R using "R -d valgrind"
* source the file "scr" (from the archive) using 'source("scr")'

The shell archive concept is peculiar to Unix/Linux, but apparently
there is an application called "ZipZag" which can be used by Windoze
users to unpack shell archives (if any such users are interested).

I have gone over and over my code, to the point of madness, looking for
argument miss-matches in the calls in this code, and for screw-ups in
the dimension statements, and can find none.  They must be there
somewhere, but I cannot see them.  Can anyone help me?

Note that the code in the *.f files is very opaque, since the code was
originally written in Ratfor and then compiled into Fortran.  The Ratfor
code is much more perspicuous, so I have included the corresponding *.r
files so as to possibly provide some enlightenment.  If you have ratfor
on your system, you can do things like "ratfor getgl.r > getgl.f" to
recreate the *.f files.

Thanks for any assistance.

cheers,

Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: vgo.txt
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20220411/52f90f93/attachment.txt>

-------------- next part --------------
An embedded message was scrubbed...
From: UoA Secure Email Gateway Notifications<secure-email-gateway-notifications at auckland.ac.nz>
Subject: shark_txt was removed from this message
Date: Mon, 11 Apr 2022 15:25:53 +1200
Size: 2098
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20220411/52f90f93/attachment.mht>

From r@turner @end|ng |rom @uck|@nd@@c@nz  Mon Apr 11 11:21:04 2022
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Mon, 11 Apr 2022 21:21:04 +1200
Subject: [R] Stack smashing again, redux.
Message-ID: <20220411212104.7efd2fbf@rolf-Latitude-E7470>


Apparently the <expletive deleted> system at the U. of Orcland refused
to transmit the file/attachment "shark.txt".  I was informed of this by
Ivan Krylov who suggested that I put this file up on my web page, and
supply the link.  I have uploaded the file; the link is:

    https://www.stat.auckland.ac.nz/~rolf/Smash/

as in a previous incarnation of this problem.  You should see a link

    Shell archive of reprex.

Right click on this link and then on "Save link as".  This should
provide the file "shark.txt" that I wanted to transmit to you.

For completeness here is a repeat of my previous message, that was
*supposed* to be accompanied by a "shark.txt" attachment until the UoA
buggered things up.  Note that I have re-attached the file "vgo.txt" to
the present email (but of course *not* the untransmittable file
"shark.txt").

>     To all and sundry, near and far,
>     Ivan Krylov in particular ....
> 
> (The latter being singled out because he was so helpful the last time
> I asked a question on this issue.  My apologies to him if I am being a
> pest.)
> 
> I have again been beset by a "stack smashing" problem when trying
> to run R code that calls upon dynamically loaded Fortran.  I have now
> reached the end of my limited mental resources in trying to solve this
> problem, so I am beseeching R-help to come to my assistance.
> 
> I have applied valgrind to try to track down the source of the
> problem. I.e. I started R using "R -d valgrind".  The output from
> trying to run my code is in the attached file "vgo.txt".  All that I
> can discern from this output is that something went wrong.  The
> "location" of the problem seems to be specified as line 85 in the
> Fortran file "getgl.f", but this is the last line ("end") of that
> file, so this just seems to be saying that there is something wrong,
> somewhere in this file!
> 
> I have bundled up all of the components of a reproducible example in a
> "shell archive" that I have named "shark.txt" (which is attached). To
> investigate the problem:
> 
> * unpack the shell archive using "sh shark.txt"
> * create a shared object library using "R CMD SHLIB -o hah.so *.f"
> * start R using "R -d valgrind"
> * source the file "scr" (from the archive) using 'source("scr")'
> 
> The shell archive concept is peculiar to Unix/Linux, but apparently
> there is an application called "ZipZag" which can be used by Windoze
> users to unpack shell archives (if any such users are interested).
> 
> I have gone over and over my code, to the point of madness, looking
> for argument miss-matches in the calls in this code, and for
> screw-ups in the dimension statements, and can find none.  They must
> be there somewhere, but I cannot see them.  Can anyone help me?
> 
> Note that the code in the *.f files is very opaque, since the code was
> originally written in Ratfor and then compiled into Fortran.  The
> Ratfor code is much more perspicuous, so I have included the
> corresponding *.r files so as to possibly provide some enlightenment.
>  If you have ratfor on your system, you can do things like "ratfor
> getgl.r > getgl.f" to recreate the *.f files.
> 
> Thanks for any assistance.
> 
> cheers,
> 
> Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: vgo.txt
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20220411/f0ac89d1/attachment.txt>

From kry|ov@r00t @end|ng |rom gm@||@com  Mon Apr 11 12:00:21 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Mon, 11 Apr 2022 13:00:21 +0300
Subject: [R] Stack smashing again, redux.
In-Reply-To: <20220411212104.7efd2fbf@rolf-Latitude-E7470>
References: <20220411212104.7efd2fbf@rolf-Latitude-E7470>
Message-ID: <20220411130021.3c9dae03@arachnoid>

Depending on one's dislike for different approaches, it's possible to
use AddressSanitizer with R in at least three different ways, probably
more. There's the Rocker project providing Docker images of R already
built with sanitizer support [1] (but then you have to install Docker),
there's compiling R from source with -fsanitize=address in CFLAGS,
FFLAGS, MAIN_LDFLAGS [2] (but then you have to compile R from source)
and there's the partially manual way I've mentioned before (which
involves modifying one's global configuration files and reverting the
changes later):

1. Temporarily add the following to ~/.R/Makevars:
   FFLAGS=-g -Og -fsanitize=address
   FCFLAGS=-g -Og -fsanitize=address
2. Compile the shared object using:
   R CMD SHLIB -o hah.so *.f -fsanitize=address
3. Run R as follows:
   LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libasan.so.5 R

With AddressSanitizer, I get the following stack buffer overflow error
message:

> xxx <- get.gl(theta.new,sigma,X,y,cf,state,"Dbd",size,nbot,ntop)
=================================================================
==716==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7ffea5d32458 at pc 0x7f282c38498d bp 0x7ffea5d32
000 sp 0x7ffea5d31ff8
WRITE of size 8 at 0x7ffea5d32458 thread T0
    #0 0x7f282c38498c in derivfdbd_ /home/ivan/derivfdbd.f:16
    #1 0x7f282c3852d6 in derivf_ /home/ivan/derivf.f:17
    #2 0x7f282c385dd3 in getgl_ /home/ivan/getgl.f:19
    #3 0x7f282c4e5eec in do_dotCode src/main/dotcode.c:1994

(skipping unrelated stack frames)

Address 0x7ffea5d32458 is located in stack of thread T0 at offset 312 in frame
    #0 0x7f282c385a6f in getgl_ /home/ivan/getgl.f:2

  This frame has 7 object(s):
    [32, 36) 'nd'
    [96, 104) 'd2aa'
    [160, 168) 'd2ab'
    [224, 232) 'd2bb'
    [288, 296) 'd2f' <== Memory access at offset 312 overflows this variable
    [352, 360) 'd2u'
    [416, 424) 'd2zeta'

(skipping more unnecessary information)

Adding "dimension d2f(kstate,npar,npar)" to getgl.f seems to prevent
this or any other error from happening, though I can't judge the
calculation results; they could indicate some other problem with memory
management.

-- 
Best regards,
Ivan

[1] https://www.rocker-project.org/images/#additional-images

[2]
https://cran.r-project.org/doc/manuals/R-exts.html#Using-Address-Sanitizer


From r@turner @end|ng |rom @uck|@nd@@c@nz  Tue Apr 12 01:03:21 2022
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Tue, 12 Apr 2022 11:03:21 +1200
Subject: [R] Stack smashing again, redux.
In-Reply-To: <20220411130021.3c9dae03@arachnoid>
References: <20220411212104.7efd2fbf@rolf-Latitude-E7470>
 <20220411130021.3c9dae03@arachnoid>
Message-ID: <20220412110321.643b86de@rolf-Latitude-E7470>


On Mon, 11 Apr 2022 13:00:21 +0300
Ivan Krylov <krylov.r00t at gmail.com> wrote:

> Depending on one's dislike for different approaches, it's possible to
> use AddressSanitizer with R in at least three different ways, probably
> more. There's the Rocker project providing Docker images of R already
> built with sanitizer support [1] (but then you have to install
> Docker), there's compiling R from source with -fsanitize=address in
> CFLAGS, FFLAGS, MAIN_LDFLAGS [2] (but then you have to compile R from
> source) and there's the partially manual way I've mentioned before
> (which involves modifying one's global configuration files and
> reverting the changes later):
> 
> 1. Temporarily add the following to ~/.R/Makevars:
>    FFLAGS=-g -Og -fsanitize=address
>    FCFLAGS=-g -Og -fsanitize=address
> 2. Compile the shared object using:
>    R CMD SHLIB -o hah.so *.f -fsanitize=address
> 3. Run R as follows:
>    LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libasan.so.5 R
> 
> With AddressSanitizer, I get the following stack buffer overflow error
> message:
> 
> > xxx <- get.gl(theta.new,sigma,X,y,cf,state,"Dbd",size,nbot,ntop)
> =================================================================
> ==716==ERROR: AddressSanitizer: stack-buffer-overflow on address
> 0x7ffea5d32458 at pc 0x7f282c38498d bp 0x7ffea5d32 000 sp
> 0x7ffea5d31ff8 WRITE of size 8 at 0x7ffea5d32458 thread T0
>     #0 0x7f282c38498c in derivfdbd_ /home/ivan/derivfdbd.f:16
>     #1 0x7f282c3852d6 in derivf_ /home/ivan/derivf.f:17
>     #2 0x7f282c385dd3 in getgl_ /home/ivan/getgl.f:19
>     #3 0x7f282c4e5eec in do_dotCode src/main/dotcode.c:1994
> 
> (skipping unrelated stack frames)
> 
> Address 0x7ffea5d32458 is located in stack of thread T0 at offset 312
> in frame #0 0x7f282c385a6f in getgl_ /home/ivan/getgl.f:2
> 
>   This frame has 7 object(s):
>     [32, 36) 'nd'
>     [96, 104) 'd2aa'
>     [160, 168) 'd2ab'
>     [224, 232) 'd2bb'
>     [288, 296) 'd2f' <== Memory access at offset 312 overflows this
> variable [352, 360) 'd2u'
>     [416, 424) 'd2zeta'
> 
> (skipping more unnecessary information)
> 
> Adding "dimension d2f(kstate,npar,npar)" to getgl.f seems to prevent
> this or any other error from happening, though I can't judge the
> calculation results; they could indicate some other problem with
> memory management.

The fact that d2f was not dimensioned in getgl was indeed the loony
that I had not spotted.  I fixed that, and another couple of
deficiencies that became apparent to me once the d2f deficiency was
drawn to my attention, and the example ran, without any stack smashing.

Thank you Ivan, from the bottom of my heart.  There is no way that I
could have got to this point without your assistance.

I would like to add that I tried your third method of applying
AddressSanitizer, and it "worked", but yet it didn't work.  (This is
the story of my life; things that work for everyone else do not work
for me. :-( ) I have attached the output from running "scr" with
AddressSanitizer enabled.  (*Before* making the necessary corrections
to getgl.)

There is nothing in the output to indicate where the problem lies.
Unlike the output that you (Ivan) observed, there is no reference at
all to getgl.  This doesn't matter now, since the problem has been
isolated and fixed, but it is an interesting demonstration of the way
that everything goes wrong for me!  See, I'm *not* paranoid!

Just as a semi-final word (and as a further demonstration of how
everything goes wrong for me --- I am *not* paranoid! :-) ) I will
mention that the real application (in contrast with my reprex) is still
not actually working.  The algorithm is not converging.  However the
stack-smashing has been eliminated so I *should* be able to track down
where things are going off the rails.

Final word:  thanks again, *HUGELY* to you, Ivan Krylov.

cheers,

Rolf

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: addSanOut.txt
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20220412/84ce2d78/attachment.txt>

From t|||@ny@v|d@| @end|ng |rom gm@||@com  Tue Apr 12 05:59:35 2022
From: t|||@ny@v|d@| @end|ng |rom gm@||@com (Tiffany Vidal)
Date: Tue, 12 Apr 2022 15:59:35 +1200
Subject: [R] Confused by error message: Error in assign(".popath", popath,
 .BaseNamespaceEnv)
Message-ID: <CAArSc3Xw+aGKThCJt4-E7LbXR4VDuOLb=H9dQbcVejHeyay9BA@mail.gmail.com>

 I am trying to install a package and am getting an unusual (to me) error:

devtools::install_github("MikkoVihtakari/ggOceanMapsData")

Error in assign(".popath", popath, .BaseNamespaceEnv) :
cannot change value of locked binding for '.popath'
Calls: local ... eval.parent -> eval -> eval -> eval -> eval -> assign

I have modified the R_USER, R_LIBS, HOME, etc settings to try and get R and
knitr to behave. I have been successful there, but now this error. Any
thoughts on what this means and how to fix the issue would be welcomed.

I found a similar post that indicated clearing the R history worked to
solve the issue, but that did not for me.

It appears to be associated with the base package and ".popath is a
variable created at startup which records where the translations package in
use is." I have noted that the translations package does exist in my R_LIBS
location.

I am not sure how to troubleshoot this error. Thanks in advance.

Session info:
R version 4.1.3 (2022-03-10)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19044)

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Tue Apr 12 12:33:04 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Tue, 12 Apr 2022 13:33:04 +0300
Subject: [R] Stack smashing again, redux.
In-Reply-To: <20220412110321.643b86de@rolf-Latitude-E7470>
References: <20220411212104.7efd2fbf@rolf-Latitude-E7470>
 <20220411130021.3c9dae03@arachnoid>
 <20220412110321.643b86de@rolf-Latitude-E7470>
Message-ID: <20220412133304.4574fea1@parabola>

? Tue, 12 Apr 2022 11:03:21 +1200
Rolf Turner <r.turner at auckland.ac.nz> ?????:

> The fact that d2f was not dimensioned in getgl was indeed the loony
> that I had not spotted.  I fixed that, and another couple of
> deficiencies that became apparent to me once the d2f deficiency was
> drawn to my attention, and the example ran, without any stack
> smashing.

Glad to be able to help!

> I would like to add that I tried your third method of applying
> AddressSanitizer, and it "worked", but yet it didn't work.  (This is
> the story of my life; things that work for everyone else do not work
> for me. :-( ) I have attached the output from running "scr" with
> AddressSanitizer enabled.  (*Before* making the necessary corrections
> to getgl.)

Maybe I'm just lucky to be able to run an unsupported configuration
like I did. What versions of compiler and kernel are you running? I
wasn't able to get ASan to work with R not compiled for it on an older
system (Debian 9), but my advice does seem to work on newer systems
(Debian 10, 11).

Compiling R from source with -fsanitize=address set in compiler options
or running R with ASan using Docker should have a higher likelihood of
working than my manual approach.

-- 
Best regards,
Ivan


From kry|ov@r00t @end|ng |rom gm@||@com  Tue Apr 12 12:38:03 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Tue, 12 Apr 2022 13:38:03 +0300
Subject: [R] 
 Confused by error message: Error in assign(".popath", popath,
 .BaseNamespaceEnv)
In-Reply-To: <CAArSc3Xw+aGKThCJt4-E7LbXR4VDuOLb=H9dQbcVejHeyay9BA@mail.gmail.com>
References: <CAArSc3Xw+aGKThCJt4-E7LbXR4VDuOLb=H9dQbcVejHeyay9BA@mail.gmail.com>
Message-ID: <20220412133803.1d045930@parabola>

? Tue, 12 Apr 2022 15:59:35 +1200
Tiffany Vidal <tiffany.vidal at gmail.com> ?????:

> devtools::install_github("MikkoVihtakari/ggOceanMapsData")
> 
> Error in assign(".popath", popath, .BaseNamespaceEnv) :
> cannot change value of locked binding for '.popath'
> Calls: local ... eval.parent -> eval -> eval -> eval -> eval -> assign

A full output of traceback() just after the error could be very useful
here. This error message might indicate a bug in devtools or its
dependencies (perhaps remotes). I don't know if the developers of
remotes or devtools lurk here, but it should be possible to reach them
at GitHub: https://github.com/r-lib/devtools/issues

You could also check whether devtools or the package itself is to blame
by downloading the code (either using git clone or by downloading the
zip archive of the head of the master branch), then running R CMD build
and R CMD INSTALL on the contents.

-- 
Best regards,
Ivan


From neh@@bo|ogn@90 @end|ng |rom gm@||@com  Wed Apr 13 00:11:43 2022
From: neh@@bo|ogn@90 @end|ng |rom gm@||@com (Neha gupta)
Date: Wed, 13 Apr 2022 00:11:43 +0200
Subject: [R] Error with text analysis data
Message-ID: <CA+nrPntd1ddeAskYt9LZ_Jav0rLyGaxEO4OyDbjNuCYi9f1f6w@mail.gmail.com>

Hello everyone, I have text data with output variable have three subgroups.
I am using the following code but getting the error message (see error
after the code).

d=read.csv("SONAR_RULES.csv", stringsAsFactors = FALSE)
d$REMEDIATION_FUNCTION=NULL
d$DEF_REMEDIATION_GAP_MULT=NULL
d$REMEDIATION_BASE_EFFORT=NULL

index <- createDataPartition(d$TYPE, p = .70,list = FALSE)
tr <- d[index, ]
ts <- d[-index, ]

ctrl <- trainControl(method = "cv",number=3, index = index, classProbs =
TRUE, summaryFunction = multiClassSummary)

ran <- train(TYPE ~ ., data = tr,
                    method = "rpart",
                    ## Will create 48 parameter combinations
                    tuneLength = 3,
                    na.action= na.pass,
                    metric = "Accuracy",
                    preProc = c("center", "scale", "nzv"),
                    trControl = ctrl)
getTrainPerf(ran)

*It gives me error:*


*Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
contrasts can be applied only to factors with 2 or more levels*


*My data is as follow*

Rows: 1,819
Columns: 14
$ PLUGIN_RULE_KEY             <chr> "InsufficientBranchCoverage",
"InsufficientLin~
$ PLUGIN_CONFIG_KEY           <chr> "", "", "", "", "", "", "", "", "", "",
"S1120~
$ PLUGIN_NAME                 <chr> "common-java", "common-java",
"common-java", "~
$ DESCRIPTION                 <chr> "An issue is created on a file as soon
as the ~
$ SEVERITY                    <chr> "MAJOR", "MAJOR", "MAJOR", "MAJOR",
"MAJOR", "~
$ NAME                        <chr> "Branches should have sufficient
coverage by t~
$ DEF_REMEDIATION_FUNCTION    <chr> "LINEAR", "LINEAR", "LINEAR",
"LINEAR_OFFSET",~
$ REMEDIATION_GAP_MULT        <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,
NA, NA~
$ DEF_REMEDIATION_BASE_EFFORT <chr> "", "", "", "10min", "", "", "5min",
"5min", "~
$ GAP_DESCRIPTION             <chr> "number of uncovered conditions",
"number of l~
$ SYSTEM_TAGS                 <chr> "bad-practice", "bad-practice",
"convention", ~
$ IS_TEMPLATE                 <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0~
$ DESCRIPTION_FORMAT          <chr> "HTML", "HTML", "HTML", "HTML", "HTML",
"HTML"~
$ TYPE                        <chr> "CODE_SMELL", "CODE_SMELL",
"CODE_SMELL", "COD~

	[[alternative HTML version deleted]]


From |eo@m@d@ @end|ng |rom @yon|c@eu  Wed Apr 13 00:32:32 2022
From: |eo@m@d@ @end|ng |rom @yon|c@eu (Leonard Mada)
Date: Wed, 13 Apr 2022 01:32:32 +0300
Subject: [R] Tools to transform/expand expressions (e.g. for ODE models)?
Message-ID: <913b0b2b-8e29-bbfb-41df-5659e832bd2e@syonic.eu>

Dear R-Users,


I would like to generate automatically the mathematical expressions for 
some more advanced SIR-models.


The models should be specified using a simpler syntax. The R parser can 
parse various types of formulas/expressions. And I am wondering if there 
are tools available to help with the expansion and transformation of the 
intermediary expressions to the exact ODE expressions.


Example:

# Stratification: Y = Young adults; O = Old;

model = "S ~ Y + O; I ~ .; H ~ .; S %*% I -> I; S %*% H -> I;
 ?? I -> H + R + D; H -> R + D; V ~ .; (time >= t0) & S^0 -> V;"
model = strsplit(model, ";")[[1]];

for(sM in model) {
 ? eq = parse(text = sM); # works nicely up to here
 ? # beyond: tools would be helpful;
}


### Model Description

1.) Stratification:
- stratified compartment: S ~ Y + O; [Young & Old]
- stratified compartment inheriting strata from parent compartment: I ~ .;

2.) Evolution
- simple: H -> R + D;
 ? => dH[Y] = - H[Y] * (k[Hy, Ry] + k[Hy, Dy]);
 ? # Note: R & D are not stratified;
 ? => dR = H[Y] * k[Hy, Ry] + H[O] * k[Ho, Ro];
- simple interaction: S * I -> I;
 ? => dS[Y] = - k[Sy, Iy] * S[Y] * I[Y];
- full interaction: S %*% I -> I;
 ? => dS[Y] = - S[Y] * (k[Sy, Iy] * I[y] + k[Sy, Io] * I[O]);
 ? # Note: all components of I interact (as if it was not-stratified);


1.) Tools

I would like to avoid to reinvent the wheel. Maybe there are some useful 
tools.

The current model description syntax is not final/fixed: changes are 
possible.

The model definition used by package dMod is useful for chemical 
reactions, but is not quit what I have in mind:

https://cran.r-project.org/web/packages/dMod/vignettes/dMod.html


2.) Explicit Models on Github

Various models with explicit mathematical formulas are available on 
GitHub and will be part of a BSc thesis:

https://github.com/BicaAnamaria/EpidemicSimulator


3.) Model Description

The description of the model syntax is available as an issue on GitHub 
as well:

https://github.com/BicaAnamaria/EpidemicSimulator/issues/35


Although I did not find tools that could help to easily convert the 
expressions, I might have missed them. There might be such tools - even 
outside the scope of ODE expressions - and I would be grateful for any 
hints.


Sincerely,


Leonard


From drj|m|emon @end|ng |rom gm@||@com  Wed Apr 13 05:12:43 2022
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Wed, 13 Apr 2022 13:12:43 +1000
Subject: [R] Error with text analysis data
In-Reply-To: <CA+nrPntd1ddeAskYt9LZ_Jav0rLyGaxEO4OyDbjNuCYi9f1f6w@mail.gmail.com>
References: <CA+nrPntd1ddeAskYt9LZ_Jav0rLyGaxEO4OyDbjNuCYi9f1f6w@mail.gmail.com>
Message-ID: <CA+8X3fVYJ=SHiO8mMc1ocMECaf8EX2ZKvutnKhZR9YwQDUGBAA@mail.gmail.com>

Hi Neha,
The error message is about not having _factors_ with two or more
levels. Apart from using stringsAsFactors=FALSE (meaning that you
probably won't get any factors in "d"), your sample data doesn't look
like CSV format. Perhaps the lines have been truncated. You may get
something with stringsAsFactors=TRUE, but I don't know whether it will
be sensibler.

Jim

On Wed, Apr 13, 2022 at 8:12 AM Neha gupta <neha.bologna90 at gmail.com> wrote:
>
> Hello everyone, I have text data with output variable have three subgroups.
> I am using the following code but getting the error message (see error
> after the code).
>
> d=read.csv("SONAR_RULES.csv", stringsAsFactors = FALSE)
> d$REMEDIATION_FUNCTION=NULL
> d$DEF_REMEDIATION_GAP_MULT=NULL
> d$REMEDIATION_BASE_EFFORT=NULL
>
> index <- createDataPartition(d$TYPE, p = .70,list = FALSE)
> tr <- d[index, ]
> ts <- d[-index, ]
>
> ctrl <- trainControl(method = "cv",number=3, index = index, classProbs =
> TRUE, summaryFunction = multiClassSummary)
>
> ran <- train(TYPE ~ ., data = tr,
>                     method = "rpart",
>                     ## Will create 48 parameter combinations
>                     tuneLength = 3,
>                     na.action= na.pass,
>                     metric = "Accuracy",
>                     preProc = c("center", "scale", "nzv"),
>                     trControl = ctrl)
> getTrainPerf(ran)
>
> *It gives me error:*
>
>
> *Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
> contrasts can be applied only to factors with 2 or more levels*
>
>
> *My data is as follow*
>
> Rows: 1,819
> Columns: 14
> $ PLUGIN_RULE_KEY             <chr> "InsufficientBranchCoverage",
> "InsufficientLin~
> $ PLUGIN_CONFIG_KEY           <chr> "", "", "", "", "", "", "", "", "", "",
> "S1120~
> $ PLUGIN_NAME                 <chr> "common-java", "common-java",
> "common-java", "~
> $ DESCRIPTION                 <chr> "An issue is created on a file as soon
> as the ~
> $ SEVERITY                    <chr> "MAJOR", "MAJOR", "MAJOR", "MAJOR",
> "MAJOR", "~
> $ NAME                        <chr> "Branches should have sufficient
> coverage by t~
> $ DEF_REMEDIATION_FUNCTION    <chr> "LINEAR", "LINEAR", "LINEAR",
> "LINEAR_OFFSET",~
> $ REMEDIATION_GAP_MULT        <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,
> NA, NA~
> $ DEF_REMEDIATION_BASE_EFFORT <chr> "", "", "", "10min", "", "", "5min",
> "5min", "~
> $ GAP_DESCRIPTION             <chr> "number of uncovered conditions",
> "number of l~
> $ SYSTEM_TAGS                 <chr> "bad-practice", "bad-practice",
> "convention", ~
> $ IS_TEMPLATE                 <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
> 0, 0, 0~
> $ DESCRIPTION_FORMAT          <chr> "HTML", "HTML", "HTML", "HTML", "HTML",
> "HTML"~
> $ TYPE                        <chr> "CODE_SMELL", "CODE_SMELL",
> "CODE_SMELL", "COD~
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From neh@@bo|ogn@90 @end|ng |rom gm@||@com  Wed Apr 13 11:05:25 2022
From: neh@@bo|ogn@90 @end|ng |rom gm@||@com (Neha gupta)
Date: Wed, 13 Apr 2022 11:05:25 +0200
Subject: [R] Error with text analysis data
In-Reply-To: <CA+8X3fVYJ=SHiO8mMc1ocMECaf8EX2ZKvutnKhZR9YwQDUGBAA@mail.gmail.com>
References: <CA+nrPntd1ddeAskYt9LZ_Jav0rLyGaxEO4OyDbjNuCYi9f1f6w@mail.gmail.com>
 <CA+8X3fVYJ=SHiO8mMc1ocMECaf8EX2ZKvutnKhZR9YwQDUGBAA@mail.gmail.com>
Message-ID: <CA+nrPntre3_Ka3t9QVvQO65Fo2DjkYJv2TJ4V=Xdq+JkHnHtzw@mail.gmail.com>

Thank you Jim

So what solution you do suggest? The features are text so it doesn't look
like a csv format.

Best regards

On Wednesday, April 13, 2022, Jim Lemon <drjimlemon at gmail.com> wrote:

> Hi Neha,
> The error message is about not having _factors_ with two or more
> levels. Apart from using stringsAsFactors=FALSE (meaning that you
> probably won't get any factors in "d"), your sample data doesn't look
> like CSV format. Perhaps the lines have been truncated. You may get
> something with stringsAsFactors=TRUE, but I don't know whether it will
> be sensibler.
>
> Jim
>
> On Wed, Apr 13, 2022 at 8:12 AM Neha gupta <neha.bologna90 at gmail.com>
> wrote:
> >
> > Hello everyone, I have text data with output variable have three
> subgroups.
> > I am using the following code but getting the error message (see error
> > after the code).
> >
> > d=read.csv("SONAR_RULES.csv", stringsAsFactors = FALSE)
> > d$REMEDIATION_FUNCTION=NULL
> > d$DEF_REMEDIATION_GAP_MULT=NULL
> > d$REMEDIATION_BASE_EFFORT=NULL
> >
> > index <- createDataPartition(d$TYPE, p = .70,list = FALSE)
> > tr <- d[index, ]
> > ts <- d[-index, ]
> >
> > ctrl <- trainControl(method = "cv",number=3, index = index, classProbs =
> > TRUE, summaryFunction = multiClassSummary)
> >
> > ran <- train(TYPE ~ ., data = tr,
> >                     method = "rpart",
> >                     ## Will create 48 parameter combinations
> >                     tuneLength = 3,
> >                     na.action= na.pass,
> >                     metric = "Accuracy",
> >                     preProc = c("center", "scale", "nzv"),
> >                     trControl = ctrl)
> > getTrainPerf(ran)
> >
> > *It gives me error:*
> >
> >
> > *Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
> > contrasts can be applied only to factors with 2 or more levels*
> >
> >
> > *My data is as follow*
> >
> > Rows: 1,819
> > Columns: 14
> > $ PLUGIN_RULE_KEY             <chr> "InsufficientBranchCoverage",
> > "InsufficientLin~
> > $ PLUGIN_CONFIG_KEY           <chr> "", "", "", "", "", "", "", "", "",
> "",
> > "S1120~
> > $ PLUGIN_NAME                 <chr> "common-java", "common-java",
> > "common-java", "~
> > $ DESCRIPTION                 <chr> "An issue is created on a file as
> soon
> > as the ~
> > $ SEVERITY                    <chr> "MAJOR", "MAJOR", "MAJOR", "MAJOR",
> > "MAJOR", "~
> > $ NAME                        <chr> "Branches should have sufficient
> > coverage by t~
> > $ DEF_REMEDIATION_FUNCTION    <chr> "LINEAR", "LINEAR", "LINEAR",
> > "LINEAR_OFFSET",~
> > $ REMEDIATION_GAP_MULT        <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA,
> NA,
> > NA, NA~
> > $ DEF_REMEDIATION_BASE_EFFORT <chr> "", "", "", "10min", "", "", "5min",
> > "5min", "~
> > $ GAP_DESCRIPTION             <chr> "number of uncovered conditions",
> > "number of l~
> > $ SYSTEM_TAGS                 <chr> "bad-practice", "bad-practice",
> > "convention", ~
> > $ IS_TEMPLATE                 <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
> 0,
> > 0, 0, 0~
> > $ DESCRIPTION_FORMAT          <chr> "HTML", "HTML", "HTML", "HTML",
> "HTML",
> > "HTML"~
> > $ TYPE                        <chr> "CODE_SMELL", "CODE_SMELL",
> > "CODE_SMELL", "COD~
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/
> posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From drj|m|emon @end|ng |rom gm@||@com  Wed Apr 13 11:24:45 2022
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Wed, 13 Apr 2022 19:24:45 +1000
Subject: [R] Error with text analysis data
In-Reply-To: <CA+nrPntre3_Ka3t9QVvQO65Fo2DjkYJv2TJ4V=Xdq+JkHnHtzw@mail.gmail.com>
References: <CA+nrPntd1ddeAskYt9LZ_Jav0rLyGaxEO4OyDbjNuCYi9f1f6w@mail.gmail.com>
 <CA+8X3fVYJ=SHiO8mMc1ocMECaf8EX2ZKvutnKhZR9YwQDUGBAA@mail.gmail.com>
 <CA+nrPntre3_Ka3t9QVvQO65Fo2DjkYJv2TJ4V=Xdq+JkHnHtzw@mail.gmail.com>
Message-ID: <CA+8X3fUm8foVBPJs-39B3e8qf_HxebyUS1N=b+T+6g6_YCmWiQ@mail.gmail.com>

Hi Neha,
The suggestion I made was to try stringsAsFactors=TRUE, although I
will be surprised if it solves your problem.
CSV means "Comma Separated Variables". The following examples are
valid CSV formats:

Date,Temperature,Humidity
13/04/2022,18,87

Country,PrimeMinister,Party
Australia,Morrison,Liberal

You could read in the second example as character OR factor type,
depending upon the setting of stringsAsFactors=

Jim

On Wed, Apr 13, 2022 at 7:05 PM Neha gupta <neha.bologna90 at gmail.com> wrote:
>
> Thank you Jim
>
> So what solution you do suggest? The features are text so it doesn't look like a csv format.
>
> Best regards
>
> On Wednesday, April 13, 2022, Jim Lemon <drjimlemon at gmail.com> wrote:
>>
>> Hi Neha,
>> The error message is about not having _factors_ with two or more
>> levels. Apart from using stringsAsFactors=FALSE (meaning that you
>> probably won't get any factors in "d"), your sample data doesn't look
>> like CSV format. Perhaps the lines have been truncated. You may get
>> something with stringsAsFactors=TRUE, but I don't know whether it will
>> be sensibler.
>>
>> Jim
>>
>> On Wed, Apr 13, 2022 at 8:12 AM Neha gupta <neha.bologna90 at gmail.com> wrote:
>> >
>> > Hello everyone, I have text data with output variable have three subgroups.
>> > I am using the following code but getting the error message (see error
>> > after the code).
>> >
>> > d=read.csv("SONAR_RULES.csv", stringsAsFactors = FALSE)
>> > d$REMEDIATION_FUNCTION=NULL
>> > d$DEF_REMEDIATION_GAP_MULT=NULL
>> > d$REMEDIATION_BASE_EFFORT=NULL
>> >
>> > index <- createDataPartition(d$TYPE, p = .70,list = FALSE)
>> > tr <- d[index, ]
>> > ts <- d[-index, ]
>> >
>> > ctrl <- trainControl(method = "cv",number=3, index = index, classProbs =
>> > TRUE, summaryFunction = multiClassSummary)
>> >
>> > ran <- train(TYPE ~ ., data = tr,
>> >                     method = "rpart",
>> >                     ## Will create 48 parameter combinations
>> >                     tuneLength = 3,
>> >                     na.action= na.pass,
>> >                     metric = "Accuracy",
>> >                     preProc = c("center", "scale", "nzv"),
>> >                     trControl = ctrl)
>> > getTrainPerf(ran)
>> >
>> > *It gives me error:*
>> >
>> >
>> > *Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
>> > contrasts can be applied only to factors with 2 or more levels*
>> >
>> >
>> > *My data is as follow*
>> >
>> > Rows: 1,819
>> > Columns: 14
>> > $ PLUGIN_RULE_KEY             <chr> "InsufficientBranchCoverage",
>> > "InsufficientLin~
>> > $ PLUGIN_CONFIG_KEY           <chr> "", "", "", "", "", "", "", "", "", "",
>> > "S1120~
>> > $ PLUGIN_NAME                 <chr> "common-java", "common-java",
>> > "common-java", "~
>> > $ DESCRIPTION                 <chr> "An issue is created on a file as soon
>> > as the ~
>> > $ SEVERITY                    <chr> "MAJOR", "MAJOR", "MAJOR", "MAJOR",
>> > "MAJOR", "~
>> > $ NAME                        <chr> "Branches should have sufficient
>> > coverage by t~
>> > $ DEF_REMEDIATION_FUNCTION    <chr> "LINEAR", "LINEAR", "LINEAR",
>> > "LINEAR_OFFSET",~
>> > $ REMEDIATION_GAP_MULT        <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,
>> > NA, NA~
>> > $ DEF_REMEDIATION_BASE_EFFORT <chr> "", "", "", "10min", "", "", "5min",
>> > "5min", "~
>> > $ GAP_DESCRIPTION             <chr> "number of uncovered conditions",
>> > "number of l~
>> > $ SYSTEM_TAGS                 <chr> "bad-practice", "bad-practice",
>> > "convention", ~
>> > $ IS_TEMPLATE                 <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
>> > 0, 0, 0~
>> > $ DESCRIPTION_FORMAT          <chr> "HTML", "HTML", "HTML", "HTML", "HTML",
>> > "HTML"~
>> > $ TYPE                        <chr> "CODE_SMELL", "CODE_SMELL",
>> > "CODE_SMELL", "COD~
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.


From tebert @end|ng |rom u||@edu  Wed Apr 13 12:17:47 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Wed, 13 Apr 2022 10:17:47 +0000
Subject: [R] Error with text analysis data
In-Reply-To: <CA+8X3fUm8foVBPJs-39B3e8qf_HxebyUS1N=b+T+6g6_YCmWiQ@mail.gmail.com>
References: <CA+nrPntd1ddeAskYt9LZ_Jav0rLyGaxEO4OyDbjNuCYi9f1f6w@mail.gmail.com>
 <CA+8X3fVYJ=SHiO8mMc1ocMECaf8EX2ZKvutnKhZR9YwQDUGBAA@mail.gmail.com>
 <CA+nrPntre3_Ka3t9QVvQO65Fo2DjkYJv2TJ4V=Xdq+JkHnHtzw@mail.gmail.com>
 <CA+8X3fUm8foVBPJs-39B3e8qf_HxebyUS1N=b+T+6g6_YCmWiQ@mail.gmail.com>
Message-ID: <BN6PR2201MB15530574C8BDA8680BE9BA03CFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>

Are you sure that read.csv is reading the data correctly? Look at the data frame and compare that result to your interpretation of the data file. Consider converting strings to dates. The lubridate() package is one option.
Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Jim Lemon
Sent: Wednesday, April 13, 2022 5:25 AM
To: Neha gupta <neha.bologna90 at gmail.com>
Cc: r-help mailing list <r-help at r-project.org>
Subject: Re: [R] Error with text analysis data

[External Email]

Hi Neha,
The suggestion I made was to try stringsAsFactors=TRUE, although I will be surprised if it solves your problem.
CSV means "Comma Separated Variables". The following examples are valid CSV formats:

Date,Temperature,Humidity
13/04/2022,18,87

Country,PrimeMinister,Party
Australia,Morrison,Liberal

You could read in the second example as character OR factor type, depending upon the setting of stringsAsFactors=

Jim

On Wed, Apr 13, 2022 at 7:05 PM Neha gupta <neha.bologna90 at gmail.com> wrote:
>
> Thank you Jim
>
> So what solution you do suggest? The features are text so it doesn't look like a csv format.
>
> Best regards
>
> On Wednesday, April 13, 2022, Jim Lemon <drjimlemon at gmail.com> wrote:
>>
>> Hi Neha,
>> The error message is about not having _factors_ with two or more 
>> levels. Apart from using stringsAsFactors=FALSE (meaning that you 
>> probably won't get any factors in "d"), your sample data doesn't look 
>> like CSV format. Perhaps the lines have been truncated. You may get 
>> something with stringsAsFactors=TRUE, but I don't know whether it 
>> will be sensibler.
>>
>> Jim
>>
>> On Wed, Apr 13, 2022 at 8:12 AM Neha gupta <neha.bologna90 at gmail.com> wrote:
>> >
>> > Hello everyone, I have text data with output variable have three subgroups.
>> > I am using the following code but getting the error message (see 
>> > error after the code).
>> >
>> > d=read.csv("SONAR_RULES.csv", stringsAsFactors = FALSE) 
>> > d$REMEDIATION_FUNCTION=NULL d$DEF_REMEDIATION_GAP_MULT=NULL 
>> > d$REMEDIATION_BASE_EFFORT=NULL
>> >
>> > index <- createDataPartition(d$TYPE, p = .70,list = FALSE) tr <- 
>> > d[index, ] ts <- d[-index, ]
>> >
>> > ctrl <- trainControl(method = "cv",number=3, index = index, 
>> > classProbs = TRUE, summaryFunction = multiClassSummary)
>> >
>> > ran <- train(TYPE ~ ., data = tr,
>> >                     method = "rpart",
>> >                     ## Will create 48 parameter combinations
>> >                     tuneLength = 3,
>> >                     na.action= na.pass,
>> >                     metric = "Accuracy",
>> >                     preProc = c("center", "scale", "nzv"),
>> >                     trControl = ctrl)
>> > getTrainPerf(ran)
>> >
>> > *It gives me error:*
>> >
>> >
>> > *Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
>> > contrasts can be applied only to factors with 2 or more levels*
>> >
>> >
>> > *My data is as follow*
>> >
>> > Rows: 1,819
>> > Columns: 14
>> > $ PLUGIN_RULE_KEY             <chr> "InsufficientBranchCoverage",
>> > "InsufficientLin~
>> > $ PLUGIN_CONFIG_KEY           <chr> "", "", "", "", "", "", "", "", "", "",
>> > "S1120~
>> > $ PLUGIN_NAME                 <chr> "common-java", "common-java",
>> > "common-java", "~
>> > $ DESCRIPTION                 <chr> "An issue is created on a file as soon
>> > as the ~
>> > $ SEVERITY                    <chr> "MAJOR", "MAJOR", "MAJOR", "MAJOR",
>> > "MAJOR", "~
>> > $ NAME                        <chr> "Branches should have sufficient
>> > coverage by t~
>> > $ DEF_REMEDIATION_FUNCTION    <chr> "LINEAR", "LINEAR", "LINEAR",
>> > "LINEAR_OFFSET",~
>> > $ REMEDIATION_GAP_MULT        <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,
>> > NA, NA~
>> > $ DEF_REMEDIATION_BASE_EFFORT <chr> "", "", "", "10min", "", "", 
>> > "5min", "5min", "~
>> > $ GAP_DESCRIPTION             <chr> "number of uncovered conditions",
>> > "number of l~
>> > $ SYSTEM_TAGS                 <chr> "bad-practice", "bad-practice",
>> > "convention", ~
>> > $ IS_TEMPLATE                 <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
>> > 0, 0, 0~
>> > $ DESCRIPTION_FORMAT          <chr> "HTML", "HTML", "HTML", "HTML", "HTML",
>> > "HTML"~
>> > $ TYPE                        <chr> "CODE_SMELL", "CODE_SMELL",
>> > "CODE_SMELL", "COD~
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>> > https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_m
>> > ailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh
>> > 2kVeAsRzsn7AkP-g&m=PARBI_qb2A9OpQHRgGxbaoo-hD4kcHlvR9jgfs5WYBuVu6gS
>> > gBlY7mvZWK3FZGew&s=PmVgSi0KaMcXns1Wmu0-K9kUqo7A7nSGLT8oCtaNgGE&e=
>> > PLEASE do read the posting guide 
>> > https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject
>> > .org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQ
>> > h2kVeAsRzsn7AkP-g&m=PARBI_qb2A9OpQHRgGxbaoo-hD4kcHlvR9jgfs5WYBuVu6g
>> > SgBlY7mvZWK3FZGew&s=h56R6zMkpRuIlkEwv9G878zFxfilQOleZYC4dJ4fHps&e=
>> > and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=PARBI_qb2A9OpQHRgGxbaoo-hD4kcHlvR9jgfs5WYBuVu6gSgBlY7mvZWK3FZGew&s=PmVgSi0KaMcXns1Wmu0-K9kUqo7A7nSGLT8oCtaNgGE&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=PARBI_qb2A9OpQHRgGxbaoo-hD4kcHlvR9jgfs5WYBuVu6gSgBlY7mvZWK3FZGew&s=h56R6zMkpRuIlkEwv9G878zFxfilQOleZYC4dJ4fHps&e=
and provide commented, minimal, self-contained, reproducible code.


From c@zh@owq@z@z @end|ng |rom out|ook@com  Wed Apr 13 15:36:31 2022
From: c@zh@owq@z@z @end|ng |rom out|ook@com (Dr Cazhaow Qazaz)
Date: Wed, 13 Apr 2022 13:36:31 +0000
Subject: [R] Max-Diff Package
Message-ID: <F6652036-91C1-485F-A590-D08F2EF06805@contoso.com>

Hi All,

Any recommendations for a R package to perform MaxDiff analysis?

Thank you,

Cazhaow Qazaz


	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Wed Apr 13 15:51:31 2022
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Wed, 13 Apr 2022 16:51:31 +0300
Subject: [R] Max-Diff Package
In-Reply-To: <F6652036-91C1-485F-A590-D08F2EF06805@contoso.com>
References: <F6652036-91C1-485F-A590-D08F2EF06805@contoso.com>
Message-ID: <CAGgJW76QfMC09ogv7w=fxDQGtzThAyps6P-jBwhXKZkhV4CPrg@mail.gmail.com>

I have no experience with this but a Google search came up with

CRAN support.BWS

See https://cran.r-project.org/web/packages/support.BWS/index.html

On Wed, Apr 13, 2022 at 4:37 PM Dr Cazhaow Qazaz <cazhaowqazaz at outlook.com>
wrote:

> Hi All,
>
> Any recommendations for a R package to perform MaxDiff analysis?
>
> Thank you,
>
> Cazhaow Qazaz
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From w||||@mwdun|@p @end|ng |rom gm@||@com  Wed Apr 13 15:55:50 2022
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Wed, 13 Apr 2022 06:55:50 -0700
Subject: [R] Error with text analysis data
In-Reply-To: <CA+nrPntd1ddeAskYt9LZ_Jav0rLyGaxEO4OyDbjNuCYi9f1f6w@mail.gmail.com>
References: <CA+nrPntd1ddeAskYt9LZ_Jav0rLyGaxEO4OyDbjNuCYi9f1f6w@mail.gmail.com>
Message-ID: <CAHqSRuRKpKmLTHHKrJE84oF-+RUWyfqyWpNR2=02+G4pSNSkuA@mail.gmail.com>

This sounds like what I think is a bug in stats::model.matrix.default(): a
numeric column with all identical entries is fine but a constant character
or factor column is not.

> d <- data.frame(y=1:5, sex=rep("Female",5))
> d$sexFactor <- factor(d$sex, levels=c("Male","Female"))
> d$sexCode <- as.integer(d$sexFactor)
> d
  y    sex sexFactor sexCode
1 1 Female    Female       2
2 2 Female    Female       2
3 3 Female    Female       2
4 4 Female    Female       2
5 5 Female    Female       2
> lm(y~sex, data=d)
Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
  contrasts can be applied only to factors with 2 or more levels
> lm(y~sexFactor, data=d)
Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
  contrasts can be applied only to factors with 2 or more levels
> lm(y~sexCode, data=d)

Call:
lm(formula = y ~ sexCode, data = d)

Coefficients:
(Intercept)      sexCode
          3           NA

Calling traceback() after the error would clarify this.

-Bill


On Tue, Apr 12, 2022 at 3:12 PM Neha gupta <neha.bologna90 at gmail.com> wrote:

> Hello everyone, I have text data with output variable have three subgroups.
> I am using the following code but getting the error message (see error
> after the code).
>
> d=read.csv("SONAR_RULES.csv", stringsAsFactors = FALSE)
> d$REMEDIATION_FUNCTION=NULL
> d$DEF_REMEDIATION_GAP_MULT=NULL
> d$REMEDIATION_BASE_EFFORT=NULL
>
> index <- createDataPartition(d$TYPE, p = .70,list = FALSE)
> tr <- d[index, ]
> ts <- d[-index, ]
>
> ctrl <- trainControl(method = "cv",number=3, index = index, classProbs =
> TRUE, summaryFunction = multiClassSummary)
>
> ran <- train(TYPE ~ ., data = tr,
>                     method = "rpart",
>                     ## Will create 48 parameter combinations
>                     tuneLength = 3,
>                     na.action= na.pass,
>                     metric = "Accuracy",
>                     preProc = c("center", "scale", "nzv"),
>                     trControl = ctrl)
> getTrainPerf(ran)
>
> *It gives me error:*
>
>
> *Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
> contrasts can be applied only to factors with 2 or more levels*
>
>
> *My data is as follow*
>
> Rows: 1,819
> Columns: 14
> $ PLUGIN_RULE_KEY             <chr> "InsufficientBranchCoverage",
> "InsufficientLin~
> $ PLUGIN_CONFIG_KEY           <chr> "", "", "", "", "", "", "", "", "", "",
> "S1120~
> $ PLUGIN_NAME                 <chr> "common-java", "common-java",
> "common-java", "~
> $ DESCRIPTION                 <chr> "An issue is created on a file as soon
> as the ~
> $ SEVERITY                    <chr> "MAJOR", "MAJOR", "MAJOR", "MAJOR",
> "MAJOR", "~
> $ NAME                        <chr> "Branches should have sufficient
> coverage by t~
> $ DEF_REMEDIATION_FUNCTION    <chr> "LINEAR", "LINEAR", "LINEAR",
> "LINEAR_OFFSET",~
> $ REMEDIATION_GAP_MULT        <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,
> NA, NA~
> $ DEF_REMEDIATION_BASE_EFFORT <chr> "", "", "", "10min", "", "", "5min",
> "5min", "~
> $ GAP_DESCRIPTION             <chr> "number of uncovered conditions",
> "number of l~
> $ SYSTEM_TAGS                 <chr> "bad-practice", "bad-practice",
> "convention", ~
> $ IS_TEMPLATE                 <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
> 0, 0, 0~
> $ DESCRIPTION_FORMAT          <chr> "HTML", "HTML", "HTML", "HTML", "HTML",
> "HTML"~
> $ TYPE                        <chr> "CODE_SMELL", "CODE_SMELL",
> "CODE_SMELL", "COD~
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From tebert @end|ng |rom u||@edu  Wed Apr 13 18:13:07 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Wed, 13 Apr 2022 16:13:07 +0000
Subject: [R] Error with text analysis data
In-Reply-To: <CAHqSRuRKpKmLTHHKrJE84oF-+RUWyfqyWpNR2=02+G4pSNSkuA@mail.gmail.com>
References: <CA+nrPntd1ddeAskYt9LZ_Jav0rLyGaxEO4OyDbjNuCYi9f1f6w@mail.gmail.com>
 <CAHqSRuRKpKmLTHHKrJE84oF-+RUWyfqyWpNR2=02+G4pSNSkuA@mail.gmail.com>
Message-ID: <BN6PR2201MB155387DDC0EAA8FE0323B60ACFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>

What is the goal of having a constant in the model? To me that seems pointless. Also there is no variability in sexCode regardless of whether you call it integer or factor. So the model y ~ sexCode is just a strange way to look at the variability in y and it would be better to do something like summarize(y) or mean(y) if that was the goal.
 
Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Bill Dunlap
Sent: Wednesday, April 13, 2022 9:56 AM
To: Neha gupta <neha.bologna90 at gmail.com>
Cc: r-help mailing list <r-help at r-project.org>
Subject: Re: [R] Error with text analysis data

[External Email]

This sounds like what I think is a bug in stats::model.matrix.default(): a numeric column with all identical entries is fine but a constant character or factor column is not.

> d <- data.frame(y=1:5, sex=rep("Female",5)) d$sexFactor <- 
> factor(d$sex, levels=c("Male","Female")) d$sexCode <- 
> as.integer(d$sexFactor) d
  y    sex sexFactor sexCode
1 1 Female    Female       2
2 2 Female    Female       2
3 3 Female    Female       2
4 4 Female    Female       2
5 5 Female    Female       2
> lm(y~sex, data=d)
Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
  contrasts can be applied only to factors with 2 or more levels
> lm(y~sexFactor, data=d)
Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
  contrasts can be applied only to factors with 2 or more levels
> lm(y~sexCode, data=d)

Call:
lm(formula = y ~ sexCode, data = d)

Coefficients:
(Intercept)      sexCode
          3           NA

Calling traceback() after the error would clarify this.

-Bill


On Tue, Apr 12, 2022 at 3:12 PM Neha gupta <neha.bologna90 at gmail.com> wrote:

> Hello everyone, I have text data with output variable have three subgroups.
> I am using the following code but getting the error message (see error 
> after the code).
>
> d=read.csv("SONAR_RULES.csv", stringsAsFactors = FALSE) 
> d$REMEDIATION_FUNCTION=NULL d$DEF_REMEDIATION_GAP_MULT=NULL 
> d$REMEDIATION_BASE_EFFORT=NULL
>
> index <- createDataPartition(d$TYPE, p = .70,list = FALSE) tr <- 
> d[index, ] ts <- d[-index, ]
>
> ctrl <- trainControl(method = "cv",number=3, index = index, classProbs 
> = TRUE, summaryFunction = multiClassSummary)
>
> ran <- train(TYPE ~ ., data = tr,
>                     method = "rpart",
>                     ## Will create 48 parameter combinations
>                     tuneLength = 3,
>                     na.action= na.pass,
>                     metric = "Accuracy",
>                     preProc = c("center", "scale", "nzv"),
>                     trControl = ctrl)
> getTrainPerf(ran)
>
> *It gives me error:*
>
>
> *Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
> contrasts can be applied only to factors with 2 or more levels*
>
>
> *My data is as follow*
>
> Rows: 1,819
> Columns: 14
> $ PLUGIN_RULE_KEY             <chr> "InsufficientBranchCoverage",
> "InsufficientLin~
> $ PLUGIN_CONFIG_KEY           <chr> "", "", "", "", "", "", "", "", "", "",
> "S1120~
> $ PLUGIN_NAME                 <chr> "common-java", "common-java",
> "common-java", "~
> $ DESCRIPTION                 <chr> "An issue is created on a file as soon
> as the ~
> $ SEVERITY                    <chr> "MAJOR", "MAJOR", "MAJOR", "MAJOR",
> "MAJOR", "~
> $ NAME                        <chr> "Branches should have sufficient
> coverage by t~
> $ DEF_REMEDIATION_FUNCTION    <chr> "LINEAR", "LINEAR", "LINEAR",
> "LINEAR_OFFSET",~
> $ REMEDIATION_GAP_MULT        <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,
> NA, NA~
> $ DEF_REMEDIATION_BASE_EFFORT <chr> "", "", "", "10min", "", "", 
> "5min", "5min", "~
> $ GAP_DESCRIPTION             <chr> "number of uncovered conditions",
> "number of l~
> $ SYSTEM_TAGS                 <chr> "bad-practice", "bad-practice",
> "convention", ~
> $ IS_TEMPLATE                 <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
> 0, 0, 0~
> $ DESCRIPTION_FORMAT          <chr> "HTML", "HTML", "HTML", "HTML", "HTML",
> "HTML"~
> $ TYPE                        <chr> "CODE_SMELL", "CODE_SMELL",
> "CODE_SMELL", "COD~
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
> man_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAs
> Rzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxo
> RrVO5eP&s=f3IyuRfeDDjr_8UWlwyBTC5Yn4Y56QV4FjYC0GCWcVc&e=
> PLEASE do read the posting guide
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.or
> g_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeA
> sRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWx
> oRrVO5eP&s=Vo6cRRCeqGApsiEGGtA6pndDHjOIuGFOs7BOkJMvuaw&e=
> and provide commented, minimal, self-contained, reproducible code.
>

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxoRrVO5eP&s=f3IyuRfeDDjr_8UWlwyBTC5Yn4Y56QV4FjYC0GCWcVc&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxoRrVO5eP&s=Vo6cRRCeqGApsiEGGtA6pndDHjOIuGFOs7BOkJMvuaw&e=
and provide commented, minimal, self-contained, reproducible code.


From w||||@mwdun|@p @end|ng |rom gm@||@com  Wed Apr 13 18:23:19 2022
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Wed, 13 Apr 2022 09:23:19 -0700
Subject: [R] Error with text analysis data
In-Reply-To: <BN6PR2201MB155387DDC0EAA8FE0323B60ACFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <CA+nrPntd1ddeAskYt9LZ_Jav0rLyGaxEO4OyDbjNuCYi9f1f6w@mail.gmail.com>
 <CAHqSRuRKpKmLTHHKrJE84oF-+RUWyfqyWpNR2=02+G4pSNSkuA@mail.gmail.com>
 <BN6PR2201MB155387DDC0EAA8FE0323B60ACFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <CAHqSRuQRrgXd26YekJ-5urnTmvP+jfiksz-LTp=tVcP_CUjnaA@mail.gmail.com>

Constant columns can be the model when you do some subsetting or are
exploring a new dataset.  My objection is that constant columns of numbers
and logicals are fine but those of characters and factors are not.

-Bill

On Wed, Apr 13, 2022 at 9:15 AM Ebert,Timothy Aaron <tebert at ufl.edu> wrote:

> What is the goal of having a constant in the model? To me that seems
> pointless. Also there is no variability in sexCode regardless of whether
> you call it integer or factor. So the model y ~ sexCode is just a strange
> way to look at the variability in y and it would be better to do something
> like summarize(y) or mean(y) if that was the goal.
>
> Tim
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Bill Dunlap
> Sent: Wednesday, April 13, 2022 9:56 AM
> To: Neha gupta <neha.bologna90 at gmail.com>
> Cc: r-help mailing list <r-help at r-project.org>
> Subject: Re: [R] Error with text analysis data
>
> [External Email]
>
> This sounds like what I think is a bug in stats::model.matrix.default(): a
> numeric column with all identical entries is fine but a constant character
> or factor column is not.
>
> > d <- data.frame(y=1:5, sex=rep("Female",5)) d$sexFactor <-
> > factor(d$sex, levels=c("Male","Female")) d$sexCode <-
> > as.integer(d$sexFactor) d
>   y    sex sexFactor sexCode
> 1 1 Female    Female       2
> 2 2 Female    Female       2
> 3 3 Female    Female       2
> 4 4 Female    Female       2
> 5 5 Female    Female       2
> > lm(y~sex, data=d)
> Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
>   contrasts can be applied only to factors with 2 or more levels
> > lm(y~sexFactor, data=d)
> Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
>   contrasts can be applied only to factors with 2 or more levels
> > lm(y~sexCode, data=d)
>
> Call:
> lm(formula = y ~ sexCode, data = d)
>
> Coefficients:
> (Intercept)      sexCode
>           3           NA
>
> Calling traceback() after the error would clarify this.
>
> -Bill
>
>
> On Tue, Apr 12, 2022 at 3:12 PM Neha gupta <neha.bologna90 at gmail.com>
> wrote:
>
> > Hello everyone, I have text data with output variable have three
> subgroups.
> > I am using the following code but getting the error message (see error
> > after the code).
> >
> > d=read.csv("SONAR_RULES.csv", stringsAsFactors = FALSE)
> > d$REMEDIATION_FUNCTION=NULL d$DEF_REMEDIATION_GAP_MULT=NULL
> > d$REMEDIATION_BASE_EFFORT=NULL
> >
> > index <- createDataPartition(d$TYPE, p = .70,list = FALSE) tr <-
> > d[index, ] ts <- d[-index, ]
> >
> > ctrl <- trainControl(method = "cv",number=3, index = index, classProbs
> > = TRUE, summaryFunction = multiClassSummary)
> >
> > ran <- train(TYPE ~ ., data = tr,
> >                     method = "rpart",
> >                     ## Will create 48 parameter combinations
> >                     tuneLength = 3,
> >                     na.action= na.pass,
> >                     metric = "Accuracy",
> >                     preProc = c("center", "scale", "nzv"),
> >                     trControl = ctrl)
> > getTrainPerf(ran)
> >
> > *It gives me error:*
> >
> >
> > *Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
> > contrasts can be applied only to factors with 2 or more levels*
> >
> >
> > *My data is as follow*
> >
> > Rows: 1,819
> > Columns: 14
> > $ PLUGIN_RULE_KEY             <chr> "InsufficientBranchCoverage",
> > "InsufficientLin~
> > $ PLUGIN_CONFIG_KEY           <chr> "", "", "", "", "", "", "", "", "",
> "",
> > "S1120~
> > $ PLUGIN_NAME                 <chr> "common-java", "common-java",
> > "common-java", "~
> > $ DESCRIPTION                 <chr> "An issue is created on a file as
> soon
> > as the ~
> > $ SEVERITY                    <chr> "MAJOR", "MAJOR", "MAJOR", "MAJOR",
> > "MAJOR", "~
> > $ NAME                        <chr> "Branches should have sufficient
> > coverage by t~
> > $ DEF_REMEDIATION_FUNCTION    <chr> "LINEAR", "LINEAR", "LINEAR",
> > "LINEAR_OFFSET",~
> > $ REMEDIATION_GAP_MULT        <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA,
> NA,
> > NA, NA~
> > $ DEF_REMEDIATION_BASE_EFFORT <chr> "", "", "", "10min", "", "",
> > "5min", "5min", "~
> > $ GAP_DESCRIPTION             <chr> "number of uncovered conditions",
> > "number of l~
> > $ SYSTEM_TAGS                 <chr> "bad-practice", "bad-practice",
> > "convention", ~
> > $ IS_TEMPLATE                 <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
> 0,
> > 0, 0, 0~
> > $ DESCRIPTION_FORMAT          <chr> "HTML", "HTML", "HTML", "HTML",
> "HTML",
> > "HTML"~
> > $ TYPE                        <chr> "CODE_SMELL", "CODE_SMELL",
> > "CODE_SMELL", "COD~
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
> > man_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAs
> > Rzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxo
> > RrVO5eP&s=f3IyuRfeDDjr_8UWlwyBTC5Yn4Y56QV4FjYC0GCWcVc&e=
> > PLEASE do read the posting guide
> > https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.or
> > g_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeA
> > sRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWx
> > oRrVO5eP&s=Vo6cRRCeqGApsiEGGtA6pndDHjOIuGFOs7BOkJMvuaw&e=
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxoRrVO5eP&s=f3IyuRfeDDjr_8UWlwyBTC5Yn4Y56QV4FjYC0GCWcVc&e=
> PLEASE do read the posting guide
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxoRrVO5eP&s=Vo6cRRCeqGApsiEGGtA6pndDHjOIuGFOs7BOkJMvuaw&e=
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From w||||@mwdun|@p @end|ng |rom gm@||@com  Wed Apr 13 18:57:23 2022
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Wed, 13 Apr 2022 09:57:23 -0700
Subject: [R] Error with text analysis data
In-Reply-To: <BN6PR2201MB155357C13CA4352899C809F7CFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <CA+nrPntd1ddeAskYt9LZ_Jav0rLyGaxEO4OyDbjNuCYi9f1f6w@mail.gmail.com>
 <CAHqSRuRKpKmLTHHKrJE84oF-+RUWyfqyWpNR2=02+G4pSNSkuA@mail.gmail.com>
 <BN6PR2201MB155387DDC0EAA8FE0323B60ACFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CAHqSRuQRrgXd26YekJ-5urnTmvP+jfiksz-LTp=tVcP_CUjnaA@mail.gmail.com>
 <BN6PR2201MB155357C13CA4352899C809F7CFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <CAHqSRuRNw4KYw7co_VqOvONXAAMx6tibW+Qw4fdxpL3CZFaqCQ@mail.gmail.com>

>  I would always suggest working until the model works, no errors and no
NA values

We agree on that.  However, the error gives you no hint about which
variables are causing the problem.  If it did, then it could only tell
about the first variable with the problem.  I think you would get to your
working model faster if you got NA's for the constant columns and then
could drop them all at once (or otherwise deal with them).

-Bill

On Wed, Apr 13, 2022 at 9:40 AM Ebert,Timothy Aaron <tebert at ufl.edu> wrote:

> I suspect that it is because you are looking at two types of error, both
> telling you that the model was not appropriate. In the ?error in contrasts?
> there is nothing to contrast in the model. For a numerical constant the
> program calculates the standard deviation and ends with a division by zero.
> Division by zero is undefined, or NA.
>
>
>
> I would always suggest working until the model works, no errors and no NA
> values. The reason is that I can get NA in several ways and I need to
> understand why. If I just ignore the NA in my model I may be assuming the
> wrong thing.
>
>
>
> Tim
>
>
>
> *From:* Bill Dunlap <williamwdunlap at gmail.com>
> *Sent:* Wednesday, April 13, 2022 12:23 PM
> *To:* Ebert,Timothy Aaron <tebert at ufl.edu>
> *Cc:* Neha gupta <neha.bologna90 at gmail.com>; r-help mailing list <
> r-help at r-project.org>
> *Subject:* Re: [R] Error with text analysis data
>
>
>
> *[External Email]*
>
> Constant columns can be the model when you do some subsetting or are
> exploring a new dataset.  My objection is that constant columns of numbers
> and logicals are fine but those of characters and factors are not.
>
>
>
> -Bill
>
>
>
> On Wed, Apr 13, 2022 at 9:15 AM Ebert,Timothy Aaron <tebert at ufl.edu>
> wrote:
>
> What is the goal of having a constant in the model? To me that seems
> pointless. Also there is no variability in sexCode regardless of whether
> you call it integer or factor. So the model y ~ sexCode is just a strange
> way to look at the variability in y and it would be better to do something
> like summarize(y) or mean(y) if that was the goal.
>
> Tim
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Bill Dunlap
> Sent: Wednesday, April 13, 2022 9:56 AM
> To: Neha gupta <neha.bologna90 at gmail.com>
> Cc: r-help mailing list <r-help at r-project.org>
> Subject: Re: [R] Error with text analysis data
>
> [External Email]
>
> This sounds like what I think is a bug in stats::model.matrix.default(): a
> numeric column with all identical entries is fine but a constant character
> or factor column is not.
>
> > d <- data.frame(y=1:5, sex=rep("Female",5)) d$sexFactor <-
> > factor(d$sex, levels=c("Male","Female")) d$sexCode <-
> > as.integer(d$sexFactor) d
>   y    sex sexFactor sexCode
> 1 1 Female    Female       2
> 2 2 Female    Female       2
> 3 3 Female    Female       2
> 4 4 Female    Female       2
> 5 5 Female    Female       2
> > lm(y~sex, data=d)
> Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
>   contrasts can be applied only to factors with 2 or more levels
> > lm(y~sexFactor, data=d)
> Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
>   contrasts can be applied only to factors with 2 or more levels
> > lm(y~sexCode, data=d)
>
> Call:
> lm(formula = y ~ sexCode, data = d)
>
> Coefficients:
> (Intercept)      sexCode
>           3           NA
>
> Calling traceback() after the error would clarify this.
>
> -Bill
>
>
> On Tue, Apr 12, 2022 at 3:12 PM Neha gupta <neha.bologna90 at gmail.com>
> wrote:
>
> > Hello everyone, I have text data with output variable have three
> subgroups.
> > I am using the following code but getting the error message (see error
> > after the code).
> >
> > d=read.csv("SONAR_RULES.csv", stringsAsFactors = FALSE)
> > d$REMEDIATION_FUNCTION=NULL d$DEF_REMEDIATION_GAP_MULT=NULL
> > d$REMEDIATION_BASE_EFFORT=NULL
> >
> > index <- createDataPartition(d$TYPE, p = .70,list = FALSE) tr <-
> > d[index, ] ts <- d[-index, ]
> >
> > ctrl <- trainControl(method = "cv",number=3, index = index, classProbs
> > = TRUE, summaryFunction = multiClassSummary)
> >
> > ran <- train(TYPE ~ ., data = tr,
> >                     method = "rpart",
> >                     ## Will create 48 parameter combinations
> >                     tuneLength = 3,
> >                     na.action= na.pass,
> >                     metric = "Accuracy",
> >                     preProc = c("center", "scale", "nzv"),
> >                     trControl = ctrl)
> > getTrainPerf(ran)
> >
> > *It gives me error:*
> >
> >
> > *Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
> > contrasts can be applied only to factors with 2 or more levels*
> >
> >
> > *My data is as follow*
> >
> > Rows: 1,819
> > Columns: 14
> > $ PLUGIN_RULE_KEY             <chr> "InsufficientBranchCoverage",
> > "InsufficientLin~
> > $ PLUGIN_CONFIG_KEY           <chr> "", "", "", "", "", "", "", "", "",
> "",
> > "S1120~
> > $ PLUGIN_NAME                 <chr> "common-java", "common-java",
> > "common-java", "~
> > $ DESCRIPTION                 <chr> "An issue is created on a file as
> soon
> > as the ~
> > $ SEVERITY                    <chr> "MAJOR", "MAJOR", "MAJOR", "MAJOR",
> > "MAJOR", "~
> > $ NAME                        <chr> "Branches should have sufficient
> > coverage by t~
> > $ DEF_REMEDIATION_FUNCTION    <chr> "LINEAR", "LINEAR", "LINEAR",
> > "LINEAR_OFFSET",~
> > $ REMEDIATION_GAP_MULT        <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA,
> NA,
> > NA, NA~
> > $ DEF_REMEDIATION_BASE_EFFORT <chr> "", "", "", "10min", "", "",
> > "5min", "5min", "~
> > $ GAP_DESCRIPTION             <chr> "number of uncovered conditions",
> > "number of l~
> > $ SYSTEM_TAGS                 <chr> "bad-practice", "bad-practice",
> > "convention", ~
> > $ IS_TEMPLATE                 <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
> 0,
> > 0, 0, 0~
> > $ DESCRIPTION_FORMAT          <chr> "HTML", "HTML", "HTML", "HTML",
> "HTML",
> > "HTML"~
> > $ TYPE                        <chr> "CODE_SMELL", "CODE_SMELL",
> > "CODE_SMELL", "COD~
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
> > man_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAs
> > Rzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxo
> > RrVO5eP&s=f3IyuRfeDDjr_8UWlwyBTC5Yn4Y56QV4FjYC0GCWcVc&e=
> > PLEASE do read the posting guide
> > https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.or
> > g_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeA
> > sRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWx
> > oRrVO5eP&s=Vo6cRRCeqGApsiEGGtA6pndDHjOIuGFOs7BOkJMvuaw&e=
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxoRrVO5eP&s=f3IyuRfeDDjr_8UWlwyBTC5Yn4Y56QV4FjYC0GCWcVc&e=
> PLEASE do read the posting guide
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxoRrVO5eP&s=Vo6cRRCeqGApsiEGGtA6pndDHjOIuGFOs7BOkJMvuaw&e=
> and provide commented, minimal, self-contained, reproducible code.
>
>

	[[alternative HTML version deleted]]


From neh@@bo|ogn@90 @end|ng |rom gm@||@com  Wed Apr 13 20:48:59 2022
From: neh@@bo|ogn@90 @end|ng |rom gm@||@com (Neha gupta)
Date: Wed, 13 Apr 2022 20:48:59 +0200
Subject: [R] Error with text analysis data
In-Reply-To: <CAHqSRuRNw4KYw7co_VqOvONXAAMx6tibW+Qw4fdxpL3CZFaqCQ@mail.gmail.com>
References: <CA+nrPntd1ddeAskYt9LZ_Jav0rLyGaxEO4OyDbjNuCYi9f1f6w@mail.gmail.com>
 <CAHqSRuRKpKmLTHHKrJE84oF-+RUWyfqyWpNR2=02+G4pSNSkuA@mail.gmail.com>
 <BN6PR2201MB155387DDC0EAA8FE0323B60ACFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CAHqSRuQRrgXd26YekJ-5urnTmvP+jfiksz-LTp=tVcP_CUjnaA@mail.gmail.com>
 <BN6PR2201MB155357C13CA4352899C809F7CFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CAHqSRuRNw4KYw7co_VqOvONXAAMx6tibW+Qw4fdxpL3CZFaqCQ@mail.gmail.com>
Message-ID: <CA+nrPnshxPzfRJhw1GFO-Za3-iUoptygXFwEaaJvrDMjy9X=LQ@mail.gmail.com>

Someone just told me that you need to pre process the data before model
construction. For instance, make the text to lower case, remove
punctuation, symbols etc and tokenize the text (give number to each word).
Then create word of bags model (not sure about it), and then create a
model.

Is it true to perform all these steps?

Best regards

On Wednesday, April 13, 2022, Bill Dunlap <williamwdunlap at gmail.com> wrote:

> >  I would always suggest working until the model works, no errors and no
> NA values
>
> We agree on that.  However, the error gives you no hint about which
> variables are causing the problem.  If it did, then it could only tell
> about the first variable with the problem.  I think you would get to your
> working model faster if you got NA's for the constant columns and then
> could drop them all at once (or otherwise deal with them).
>
> -Bill
>
> On Wed, Apr 13, 2022 at 9:40 AM Ebert,Timothy Aaron <tebert at ufl.edu>
> wrote:
>
>> I suspect that it is because you are looking at two types of error, both
>> telling you that the model was not appropriate. In the ?error in contrasts?
>> there is nothing to contrast in the model. For a numerical constant the
>> program calculates the standard deviation and ends with a division by zero.
>> Division by zero is undefined, or NA.
>>
>>
>>
>> I would always suggest working until the model works, no errors and no NA
>> values. The reason is that I can get NA in several ways and I need to
>> understand why. If I just ignore the NA in my model I may be assuming the
>> wrong thing.
>>
>>
>>
>> Tim
>>
>>
>>
>> *From:* Bill Dunlap <williamwdunlap at gmail.com>
>> *Sent:* Wednesday, April 13, 2022 12:23 PM
>> *To:* Ebert,Timothy Aaron <tebert at ufl.edu>
>> *Cc:* Neha gupta <neha.bologna90 at gmail.com>; r-help mailing list <
>> r-help at r-project.org>
>> *Subject:* Re: [R] Error with text analysis data
>>
>>
>>
>> *[External Email]*
>>
>> Constant columns can be the model when you do some subsetting or are
>> exploring a new dataset.  My objection is that constant columns of numbers
>> and logicals are fine but those of characters and factors are not.
>>
>>
>>
>> -Bill
>>
>>
>>
>> On Wed, Apr 13, 2022 at 9:15 AM Ebert,Timothy Aaron <tebert at ufl.edu>
>> wrote:
>>
>> What is the goal of having a constant in the model? To me that seems
>> pointless. Also there is no variability in sexCode regardless of whether
>> you call it integer or factor. So the model y ~ sexCode is just a strange
>> way to look at the variability in y and it would be better to do something
>> like summarize(y) or mean(y) if that was the goal.
>>
>> Tim
>>
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Bill Dunlap
>> Sent: Wednesday, April 13, 2022 9:56 AM
>> To: Neha gupta <neha.bologna90 at gmail.com>
>> Cc: r-help mailing list <r-help at r-project.org>
>> Subject: Re: [R] Error with text analysis data
>>
>> [External Email]
>>
>> This sounds like what I think is a bug in stats::model.matrix.default():
>> a numeric column with all identical entries is fine but a constant
>> character or factor column is not.
>>
>> > d <- data.frame(y=1:5, sex=rep("Female",5)) d$sexFactor <-
>> > factor(d$sex, levels=c("Male","Female")) d$sexCode <-
>> > as.integer(d$sexFactor) d
>>   y    sex sexFactor sexCode
>> 1 1 Female    Female       2
>> 2 2 Female    Female       2
>> 3 3 Female    Female       2
>> 4 4 Female    Female       2
>> 5 5 Female    Female       2
>> > lm(y~sex, data=d)
>> Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
>>   contrasts can be applied only to factors with 2 or more levels
>> > lm(y~sexFactor, data=d)
>> Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
>>   contrasts can be applied only to factors with 2 or more levels
>> > lm(y~sexCode, data=d)
>>
>> Call:
>> lm(formula = y ~ sexCode, data = d)
>>
>> Coefficients:
>> (Intercept)      sexCode
>>           3           NA
>>
>> Calling traceback() after the error would clarify this.
>>
>> -Bill
>>
>>
>> On Tue, Apr 12, 2022 at 3:12 PM Neha gupta <neha.bologna90 at gmail.com>
>> wrote:
>>
>> > Hello everyone, I have text data with output variable have three
>> subgroups.
>> > I am using the following code but getting the error message (see error
>> > after the code).
>> >
>> > d=read.csv("SONAR_RULES.csv", stringsAsFactors = FALSE)
>> > d$REMEDIATION_FUNCTION=NULL d$DEF_REMEDIATION_GAP_MULT=NULL
>> > d$REMEDIATION_BASE_EFFORT=NULL
>> >
>> > index <- createDataPartition(d$TYPE, p = .70,list = FALSE) tr <-
>> > d[index, ] ts <- d[-index, ]
>> >
>> > ctrl <- trainControl(method = "cv",number=3, index = index, classProbs
>> > = TRUE, summaryFunction = multiClassSummary)
>> >
>> > ran <- train(TYPE ~ ., data = tr,
>> >                     method = "rpart",
>> >                     ## Will create 48 parameter combinations
>> >                     tuneLength = 3,
>> >                     na.action= na.pass,
>> >                     metric = "Accuracy",
>> >                     preProc = c("center", "scale", "nzv"),
>> >                     trControl = ctrl)
>> > getTrainPerf(ran)
>> >
>> > *It gives me error:*
>> >
>> >
>> > *Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
>> > contrasts can be applied only to factors with 2 or more levels*
>> >
>> >
>> > *My data is as follow*
>> >
>> > Rows: 1,819
>> > Columns: 14
>> > $ PLUGIN_RULE_KEY             <chr> "InsufficientBranchCoverage",
>> > "InsufficientLin~
>> > $ PLUGIN_CONFIG_KEY           <chr> "", "", "", "", "", "", "", "", "",
>> "",
>> > "S1120~
>> > $ PLUGIN_NAME                 <chr> "common-java", "common-java",
>> > "common-java", "~
>> > $ DESCRIPTION                 <chr> "An issue is created on a file as
>> soon
>> > as the ~
>> > $ SEVERITY                    <chr> "MAJOR", "MAJOR", "MAJOR", "MAJOR",
>> > "MAJOR", "~
>> > $ NAME                        <chr> "Branches should have sufficient
>> > coverage by t~
>> > $ DEF_REMEDIATION_FUNCTION    <chr> "LINEAR", "LINEAR", "LINEAR",
>> > "LINEAR_OFFSET",~
>> > $ REMEDIATION_GAP_MULT        <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA,
>> NA,
>> > NA, NA~
>> > $ DEF_REMEDIATION_BASE_EFFORT <chr> "", "", "", "10min", "", "",
>> > "5min", "5min", "~
>> > $ GAP_DESCRIPTION             <chr> "number of uncovered conditions",
>> > "number of l~
>> > $ SYSTEM_TAGS                 <chr> "bad-practice", "bad-practice",
>> > "convention", ~
>> > $ IS_TEMPLATE                 <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
>> 0,
>> > 0, 0, 0~
>> > $ DESCRIPTION_FORMAT          <chr> "HTML", "HTML", "HTML", "HTML",
>> "HTML",
>> > "HTML"~
>> > $ TYPE                        <chr> "CODE_SMELL", "CODE_SMELL",
>> > "CODE_SMELL", "COD~
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
>> > man_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAs
>> > Rzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxo
>> > RrVO5eP&s=f3IyuRfeDDjr_8UWlwyBTC5Yn4Y56QV4FjYC0GCWcVc&e=
>> > PLEASE do read the posting guide
>> > https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.or
>> > g_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeA
>> > sRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWx
>> > oRrVO5eP&s=Vo6cRRCeqGApsiEGGtA6pndDHjOIuGFOs7BOkJMvuaw&e=
>> > and provide commented, minimal, self-contained, reproducible code.
>> >
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.
>> ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=
>> 9PEhQh2kVeAsRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-
>> qPEQIBxDJnlSkAQrae1FdSHYJTfWxoRrVO5eP&s=f3IyuRfeDDjr_
>> 8UWlwyBTC5Yn4Y56QV4FjYC0GCWcVc&e=
>> PLEASE do read the posting guide https://urldefense.proofpoint.
>> com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.
>> html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=
>> HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxoRrVO5eP&s=
>> Vo6cRRCeqGApsiEGGtA6pndDHjOIuGFOs7BOkJMvuaw&e=
>> and provide commented, minimal, self-contained, reproducible code.
>>
>>

	[[alternative HTML version deleted]]


From tebert @end|ng |rom u||@edu  Wed Apr 13 21:53:02 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Wed, 13 Apr 2022 19:53:02 +0000
Subject: [R] Error with text analysis data
In-Reply-To: <CA+nrPnshxPzfRJhw1GFO-Za3-iUoptygXFwEaaJvrDMjy9X=LQ@mail.gmail.com>
References: <CA+nrPntd1ddeAskYt9LZ_Jav0rLyGaxEO4OyDbjNuCYi9f1f6w@mail.gmail.com>
 <CAHqSRuRKpKmLTHHKrJE84oF-+RUWyfqyWpNR2=02+G4pSNSkuA@mail.gmail.com>
 <BN6PR2201MB155387DDC0EAA8FE0323B60ACFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CAHqSRuQRrgXd26YekJ-5urnTmvP+jfiksz-LTp=tVcP_CUjnaA@mail.gmail.com>
 <BN6PR2201MB155357C13CA4352899C809F7CFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CAHqSRuRNw4KYw7co_VqOvONXAAMx6tibW+Qw4fdxpL3CZFaqCQ@mail.gmail.com>
 <CA+nrPnshxPzfRJhw1GFO-Za3-iUoptygXFwEaaJvrDMjy9X=LQ@mail.gmail.com>
Message-ID: <BN6PR2201MB15533B93CA2E24096EBCC2DCCFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>

Is this a different question from the original post? It would be better to keep threads separate.
Always pre-process the data. Clean the data of obvious mistakes. This can be simple typographical errors or complicated like an author that wrote too when they intended two or to. In old English texts spelling was not standardized and the same word could have multiple spellings within one book or chapter. Removing punctuation is probably a part of this, though a program like Grammarly would not work very well if it removed punctuation.

After that it depends on what you are trying to accomplish. Are you interested in the number of times an author used the word ?a? or ?the? and is ?The? different from ?the?? Are you modeling word use frequency or comparing vocabulary between texts.

Too many choices.

Tim

From: Neha gupta <neha.bologna90 at gmail.com>
Sent: Wednesday, April 13, 2022 2:49 PM
To: Bill Dunlap <williamwdunlap at gmail.com>
Cc: Ebert,Timothy Aaron <tebert at ufl.edu>; r-help mailing list <r-help at r-project.org>
Subject: Re: Error with text analysis data

[External Email]
Someone just told me that you need to pre process the data before model construction. For instance, make the text to lower case, remove punctuation, symbols etc and tokenize the text (give number to each word). Then create word of bags model (not sure about it), and then create a model.

Is it true to perform all these steps?

Best regards

On Wednesday, April 13, 2022, Bill Dunlap <williamwdunlap at gmail.com<mailto:williamwdunlap at gmail.com>> wrote:
>  I would always suggest working until the model works, no errors and no NA values

We agree on that.  However, the error gives you no hint about which variables are causing the problem.  If it did, then it could only tell about the first variable with the problem.  I think you would get to your working model faster if you got NA's for the constant columns and then could drop them all at once (or otherwise deal with them).

-Bill

On Wed, Apr 13, 2022 at 9:40 AM Ebert,Timothy Aaron <tebert at ufl.edu<mailto:tebert at ufl.edu>> wrote:
I suspect that it is because you are looking at two types of error, both telling you that the model was not appropriate. In the ?error in contrasts? there is nothing to contrast in the model. For a numerical constant the program calculates the standard deviation and ends with a division by zero. Division by zero is undefined, or NA.

I would always suggest working until the model works, no errors and no NA values. The reason is that I can get NA in several ways and I need to understand why. If I just ignore the NA in my model I may be assuming the wrong thing.

Tim

From: Bill Dunlap <williamwdunlap at gmail.com<mailto:williamwdunlap at gmail.com>>
Sent: Wednesday, April 13, 2022 12:23 PM
To: Ebert,Timothy Aaron <tebert at ufl.edu<mailto:tebert at ufl.edu>>
Cc: Neha gupta <neha.bologna90 at gmail.com<mailto:neha.bologna90 at gmail.com>>; r-help mailing list <r-help at r-project.org<mailto:r-help at r-project.org>>
Subject: Re: [R] Error with text analysis data

[External Email]
Constant columns can be the model when you do some subsetting or are exploring a new dataset.  My objection is that constant columns of numbers and logicals are fine but those of characters and factors are not.

-Bill

On Wed, Apr 13, 2022 at 9:15 AM Ebert,Timothy Aaron <tebert at ufl.edu<mailto:tebert at ufl.edu>> wrote:
What is the goal of having a constant in the model? To me that seems pointless. Also there is no variability in sexCode regardless of whether you call it integer or factor. So the model y ~ sexCode is just a strange way to look at the variability in y and it would be better to do something like summarize(y) or mean(y) if that was the goal.

Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org<mailto:r-help-bounces at r-project.org>> On Behalf Of Bill Dunlap
Sent: Wednesday, April 13, 2022 9:56 AM
To: Neha gupta <neha.bologna90 at gmail.com<mailto:neha.bologna90 at gmail.com>>
Cc: r-help mailing list <r-help at r-project.org<mailto:r-help at r-project.org>>
Subject: Re: [R] Error with text analysis data

[External Email]

This sounds like what I think is a bug in stats::model.matrix.default(): a numeric column with all identical entries is fine but a constant character or factor column is not.

> d <- data.frame(y=1:5, sex=rep("Female",5)) d$sexFactor <-
> factor(d$sex, levels=c("Male","Female")) d$sexCode <-
> as.integer(d$sexFactor) d
  y    sex sexFactor sexCode
1 1 Female    Female       2
2 2 Female    Female       2
3 3 Female    Female       2
4 4 Female    Female       2
5 5 Female    Female       2
> lm(y~sex, data=d)
Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
  contrasts can be applied only to factors with 2 or more levels
> lm(y~sexFactor, data=d)
Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
  contrasts can be applied only to factors with 2 or more levels
> lm(y~sexCode, data=d)

Call:
lm(formula = y ~ sexCode, data = d)

Coefficients:
(Intercept)      sexCode
          3           NA

Calling traceback() after the error would clarify this.

-Bill


On Tue, Apr 12, 2022 at 3:12 PM Neha gupta <neha.bologna90 at gmail.com<mailto:neha.bologna90 at gmail.com>> wrote:

> Hello everyone, I have text data with output variable have three subgroups.
> I am using the following code but getting the error message (see error
> after the code).
>
> d=read.csv("SONAR_RULES.csv", stringsAsFactors = FALSE)
> d$REMEDIATION_FUNCTION=NULL d$DEF_REMEDIATION_GAP_MULT=NULL
> d$REMEDIATION_BASE_EFFORT=NULL
>
> index <- createDataPartition(d$TYPE, p = .70,list = FALSE) tr <-
> d[index, ] ts <- d[-index, ]
>
> ctrl <- trainControl(method = "cv",number=3, index = index, classProbs
> = TRUE, summaryFunction = multiClassSummary)
>
> ran <- train(TYPE ~ ., data = tr,
>                     method = "rpart",
>                     ## Will create 48 parameter combinations
>                     tuneLength = 3,
>                     na.action= na.pass,
>                     metric = "Accuracy",
>                     preProc = c("center", "scale", "nzv"),
>                     trControl = ctrl)
> getTrainPerf(ran)
>
> *It gives me error:*
>
>
> *Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
> contrasts can be applied only to factors with 2 or more levels*
>
>
> *My data is as follow*
>
> Rows: 1,819
> Columns: 14
> $ PLUGIN_RULE_KEY             <chr> "InsufficientBranchCoverage",
> "InsufficientLin~
> $ PLUGIN_CONFIG_KEY           <chr> "", "", "", "", "", "", "", "", "", "",
> "S1120~
> $ PLUGIN_NAME                 <chr> "common-java", "common-java",
> "common-java", "~
> $ DESCRIPTION                 <chr> "An issue is created on a file as soon
> as the ~
> $ SEVERITY                    <chr> "MAJOR", "MAJOR", "MAJOR", "MAJOR",
> "MAJOR", "~
> $ NAME                        <chr> "Branches should have sufficient
> coverage by t~
> $ DEF_REMEDIATION_FUNCTION    <chr> "LINEAR", "LINEAR", "LINEAR",
> "LINEAR_OFFSET",~
> $ REMEDIATION_GAP_MULT        <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,
> NA, NA~
> $ DEF_REMEDIATION_BASE_EFFORT <chr> "", "", "", "10min", "", "",
> "5min", "5min", "~
> $ GAP_DESCRIPTION             <chr> "number of uncovered conditions",
> "number of l~
> $ SYSTEM_TAGS                 <chr> "bad-practice", "bad-practice",
> "convention", ~
> $ IS_TEMPLATE                 <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
> 0, 0, 0~
> $ DESCRIPTION_FORMAT          <chr> "HTML", "HTML", "HTML", "HTML", "HTML",
> "HTML"~
> $ TYPE                        <chr> "CODE_SMELL", "CODE_SMELL",
> "CODE_SMELL", "COD~
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
> man_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAs
> Rzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxo
> RrVO5eP&s=f3IyuRfeDDjr_8UWlwyBTC5Yn4Y56QV4FjYC0GCWcVc&e=
> PLEASE do read the posting guide
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.or
> g_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeA
> sRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWx
> oRrVO5eP&s=Vo6cRRCeqGApsiEGGtA6pndDHjOIuGFOs7BOkJMvuaw&e=
> and provide commented, minimal, self-contained, reproducible code.
>

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxoRrVO5eP&s=f3IyuRfeDDjr_8UWlwyBTC5Yn4Y56QV4FjYC0GCWcVc&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxoRrVO5eP&s=Vo6cRRCeqGApsiEGGtA6pndDHjOIuGFOs7BOkJMvuaw&e=
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From neh@@bo|ogn@90 @end|ng |rom gm@||@com  Wed Apr 13 22:07:11 2022
From: neh@@bo|ogn@90 @end|ng |rom gm@||@com (Neha gupta)
Date: Wed, 13 Apr 2022 22:07:11 +0200
Subject: [R] Error with text analysis data
In-Reply-To: <BN6PR2201MB15533B93CA2E24096EBCC2DCCFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <CA+nrPntd1ddeAskYt9LZ_Jav0rLyGaxEO4OyDbjNuCYi9f1f6w@mail.gmail.com>
 <CAHqSRuRKpKmLTHHKrJE84oF-+RUWyfqyWpNR2=02+G4pSNSkuA@mail.gmail.com>
 <BN6PR2201MB155387DDC0EAA8FE0323B60ACFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CAHqSRuQRrgXd26YekJ-5urnTmvP+jfiksz-LTp=tVcP_CUjnaA@mail.gmail.com>
 <BN6PR2201MB155357C13CA4352899C809F7CFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CAHqSRuRNw4KYw7co_VqOvONXAAMx6tibW+Qw4fdxpL3CZFaqCQ@mail.gmail.com>
 <CA+nrPnshxPzfRJhw1GFO-Za3-iUoptygXFwEaaJvrDMjy9X=LQ@mail.gmail.com>
 <BN6PR2201MB15533B93CA2E24096EBCC2DCCFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <CA+nrPnukJFB8s0X75RbrqcZXA7CZrX_0UTgEFy3wj4=zk87yhw@mail.gmail.com>

Thank you Tim

My purpose and aim is to train a model (based on the data I provided in my
first email) and predict the output variable (TYPE variable which has three
different values like Severity, bugs, code smell etc) The data as you can
see also have a few text columns which is creating problems for me as I
have never worked before with text data.

I read a tutorial that says stringAsFactor should be false, symbols etc
should be removed, then data should be in tokens, then the text should be
placed in a matrix/table form, and then a model should be built. I am not
sure if these steps are required in my case. Its I think a word2vec problem
though I did not use it before.

Best regards

On Wed, Apr 13, 2022 at 9:53 PM Ebert,Timothy Aaron <tebert at ufl.edu> wrote:

> Is this a different question from the original post? It would be better to
> keep threads separate.
>
> Always pre-process the data. Clean the data of obvious mistakes. This can
> be simple typographical errors or complicated like an author that wrote too
> when they intended two or to. In old English texts spelling was not
> standardized and the same word could have multiple spellings within one
> book or chapter. Removing punctuation is probably a part of this, though a
> program like Grammarly would not work very well if it removed punctuation.
>
>
>
> After that it depends on what you are trying to accomplish. Are you
> interested in the number of times an author used the word ?a? or ?the? and
> is ?The? different from ?the?? Are you modeling word use frequency or
> comparing vocabulary between texts.
>
>
>
> Too many choices.
>
>
>
> Tim
>
>
>
> *From:* Neha gupta <neha.bologna90 at gmail.com>
> *Sent:* Wednesday, April 13, 2022 2:49 PM
> *To:* Bill Dunlap <williamwdunlap at gmail.com>
> *Cc:* Ebert,Timothy Aaron <tebert at ufl.edu>; r-help mailing list <
> r-help at r-project.org>
> *Subject:* Re: Error with text analysis data
>
>
>
> *[External Email]*
>
> Someone just told me that you need to pre process the data before model
> construction. For instance, make the text to lower case, remove
> punctuation, symbols etc and tokenize the text (give number to each word).
> Then create word of bags model (not sure about it), and then create a
> model.
>
>
>
> Is it true to perform all these steps?
>
>
>
> Best regards
>
> On Wednesday, April 13, 2022, Bill Dunlap <williamwdunlap at gmail.com>
> wrote:
>
> >  I would always suggest working until the model works, no errors and no
> NA values
>
>
>
> We agree on that.  However, the error gives you no hint about which
> variables are causing the problem.  If it did, then it could only tell
> about the first variable with the problem.  I think you would get to your
> working model faster if you got NA's for the constant columns and then
> could drop them all at once (or otherwise deal with them).
>
>
>
> -Bill
>
>
>
> On Wed, Apr 13, 2022 at 9:40 AM Ebert,Timothy Aaron <tebert at ufl.edu>
> wrote:
>
> I suspect that it is because you are looking at two types of error, both
> telling you that the model was not appropriate. In the ?error in contrasts?
> there is nothing to contrast in the model. For a numerical constant the
> program calculates the standard deviation and ends with a division by zero.
> Division by zero is undefined, or NA.
>
>
>
> I would always suggest working until the model works, no errors and no NA
> values. The reason is that I can get NA in several ways and I need to
> understand why. If I just ignore the NA in my model I may be assuming the
> wrong thing.
>
>
>
> Tim
>
>
>
> *From:* Bill Dunlap <williamwdunlap at gmail.com>
> *Sent:* Wednesday, April 13, 2022 12:23 PM
> *To:* Ebert,Timothy Aaron <tebert at ufl.edu>
> *Cc:* Neha gupta <neha.bologna90 at gmail.com>; r-help mailing list <
> r-help at r-project.org>
> *Subject:* Re: [R] Error with text analysis data
>
>
>
> *[External Email]*
>
> Constant columns can be the model when you do some subsetting or are
> exploring a new dataset.  My objection is that constant columns of numbers
> and logicals are fine but those of characters and factors are not.
>
>
>
> -Bill
>
>
>
> On Wed, Apr 13, 2022 at 9:15 AM Ebert,Timothy Aaron <tebert at ufl.edu>
> wrote:
>
> What is the goal of having a constant in the model? To me that seems
> pointless. Also there is no variability in sexCode regardless of whether
> you call it integer or factor. So the model y ~ sexCode is just a strange
> way to look at the variability in y and it would be better to do something
> like summarize(y) or mean(y) if that was the goal.
>
> Tim
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Bill Dunlap
> Sent: Wednesday, April 13, 2022 9:56 AM
> To: Neha gupta <neha.bologna90 at gmail.com>
> Cc: r-help mailing list <r-help at r-project.org>
> Subject: Re: [R] Error with text analysis data
>
> [External Email]
>
> This sounds like what I think is a bug in stats::model.matrix.default(): a
> numeric column with all identical entries is fine but a constant character
> or factor column is not.
>
> > d <- data.frame(y=1:5, sex=rep("Female",5)) d$sexFactor <-
> > factor(d$sex, levels=c("Male","Female")) d$sexCode <-
> > as.integer(d$sexFactor) d
>   y    sex sexFactor sexCode
> 1 1 Female    Female       2
> 2 2 Female    Female       2
> 3 3 Female    Female       2
> 4 4 Female    Female       2
> 5 5 Female    Female       2
> > lm(y~sex, data=d)
> Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
>   contrasts can be applied only to factors with 2 or more levels
> > lm(y~sexFactor, data=d)
> Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
>   contrasts can be applied only to factors with 2 or more levels
> > lm(y~sexCode, data=d)
>
> Call:
> lm(formula = y ~ sexCode, data = d)
>
> Coefficients:
> (Intercept)      sexCode
>           3           NA
>
> Calling traceback() after the error would clarify this.
>
> -Bill
>
>
> On Tue, Apr 12, 2022 at 3:12 PM Neha gupta <neha.bologna90 at gmail.com>
> wrote:
>
> > Hello everyone, I have text data with output variable have three
> subgroups.
> > I am using the following code but getting the error message (see error
> > after the code).
> >
> > d=read.csv("SONAR_RULES.csv", stringsAsFactors = FALSE)
> > d$REMEDIATION_FUNCTION=NULL d$DEF_REMEDIATION_GAP_MULT=NULL
> > d$REMEDIATION_BASE_EFFORT=NULL
> >
> > index <- createDataPartition(d$TYPE, p = .70,list = FALSE) tr <-
> > d[index, ] ts <- d[-index, ]
> >
> > ctrl <- trainControl(method = "cv",number=3, index = index, classProbs
> > = TRUE, summaryFunction = multiClassSummary)
> >
> > ran <- train(TYPE ~ ., data = tr,
> >                     method = "rpart",
> >                     ## Will create 48 parameter combinations
> >                     tuneLength = 3,
> >                     na.action= na.pass,
> >                     metric = "Accuracy",
> >                     preProc = c("center", "scale", "nzv"),
> >                     trControl = ctrl)
> > getTrainPerf(ran)
> >
> > *It gives me error:*
> >
> >
> > *Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
> > contrasts can be applied only to factors with 2 or more levels*
> >
> >
> > *My data is as follow*
> >
> > Rows: 1,819
> > Columns: 14
> > $ PLUGIN_RULE_KEY             <chr> "InsufficientBranchCoverage",
> > "InsufficientLin~
> > $ PLUGIN_CONFIG_KEY           <chr> "", "", "", "", "", "", "", "", "",
> "",
> > "S1120~
> > $ PLUGIN_NAME                 <chr> "common-java", "common-java",
> > "common-java", "~
> > $ DESCRIPTION                 <chr> "An issue is created on a file as
> soon
> > as the ~
> > $ SEVERITY                    <chr> "MAJOR", "MAJOR", "MAJOR", "MAJOR",
> > "MAJOR", "~
> > $ NAME                        <chr> "Branches should have sufficient
> > coverage by t~
> > $ DEF_REMEDIATION_FUNCTION    <chr> "LINEAR", "LINEAR", "LINEAR",
> > "LINEAR_OFFSET",~
> > $ REMEDIATION_GAP_MULT        <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA,
> NA,
> > NA, NA~
> > $ DEF_REMEDIATION_BASE_EFFORT <chr> "", "", "", "10min", "", "",
> > "5min", "5min", "~
> > $ GAP_DESCRIPTION             <chr> "number of uncovered conditions",
> > "number of l~
> > $ SYSTEM_TAGS                 <chr> "bad-practice", "bad-practice",
> > "convention", ~
> > $ IS_TEMPLATE                 <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
> 0,
> > 0, 0, 0~
> > $ DESCRIPTION_FORMAT          <chr> "HTML", "HTML", "HTML", "HTML",
> "HTML",
> > "HTML"~
> > $ TYPE                        <chr> "CODE_SMELL", "CODE_SMELL",
> > "CODE_SMELL", "COD~
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
> > man_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAs
> > Rzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxo
> > RrVO5eP&s=f3IyuRfeDDjr_8UWlwyBTC5Yn4Y56QV4FjYC0GCWcVc&e=
> > PLEASE do read the posting guide
> > https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.or
> > g_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeA
> > sRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWx
> > oRrVO5eP&s=Vo6cRRCeqGApsiEGGtA6pndDHjOIuGFOs7BOkJMvuaw&e=
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxoRrVO5eP&s=f3IyuRfeDDjr_8UWlwyBTC5Yn4Y56QV4FjYC0GCWcVc&e=
> PLEASE do read the posting guide
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxoRrVO5eP&s=Vo6cRRCeqGApsiEGGtA6pndDHjOIuGFOs7BOkJMvuaw&e=
> and provide commented, minimal, self-contained, reproducible code.
>
>

	[[alternative HTML version deleted]]


From kr|@tj@n@kure@1 @end|ng |rom gm@||@com  Wed Apr 13 16:06:02 2022
From: kr|@tj@n@kure@1 @end|ng |rom gm@||@com (Kristjan Kure)
Date: Wed, 13 Apr 2022 17:06:02 +0300
Subject: [R] Symbol/String comparison in R
Message-ID: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>

Hi!

Sorry, I am a beginner in R.

I was not able to find answers to my questions (tried Google, Stack
Overflow, etc). Please correct me if anything is wrong here.

When comparing symbols/strings in R - raw numeric values are compared
symbol by symbol starting from left? If raw numeric values are not used is
there an ASCII / Unicode table where symbols have values/ranking/order and
R compares those values?

*2) Comparing symbols*
Letter "a" raw value is 61, letter "b" raw value is 62? Is this correct?

# Raw value for "a" = 61
a_raw <- charToRaw("a")
a_raw

# Raw value for "b" = 62
b_raw <- charToRaw("b")
b_raw

# equals TRUE
"a" < "b"

Ok, so 61 is less than 62 so it's TRUE. Is this correct?

*3) Comparing strings #1*
"1040" <= "12000"

raw_1040 <- charToRaw("1040")
raw_1040
#31 *30* (comparison happens with the second symbol) 34 30

raw_12000 <- charToRaw("12000")
raw_12000
#31 *32* (comparison happens with the second symbol) 30 30 30

The symbol in the second position is 30 and it's less than 32. Equals to
true. Is this correct?

*4) Comparing strings #2*
"1040" <= "10000"

raw_1040 <- charToRaw("1040")
raw_1040
#31 30 *34*  (comparison happens with third symbol) 30

raw_10000 <- charToRaw("10000")
raw_10000
#31 30 *30*  (comparison happens with third symbol) 30 30

The symbol in the third position is 34 is greater than 30. Equals to false.
Is this correct?

*5) Problem - Why does this equal FALSE?*
*"A" < "a"*

41 < 61 # FALSE?

# Raw value for "A" = 41
A_raw <- charToRaw("A")
A_raw

# Raw value for "a" = 61
a_raw <- charToRaw("a")
a_raw

Why is capitalized "A" not less than lowercase "a"? Based on raw values it
should be. What am I missing here?

Thanks
Kristjan

	[[alternative HTML version deleted]]


From neh@@bo|ogn@90 @end|ng |rom gm@||@com  Thu Apr 14 02:38:00 2022
From: neh@@bo|ogn@90 @end|ng |rom gm@||@com (Neha gupta)
Date: Thu, 14 Apr 2022 02:38:00 +0200
Subject: [R] Error with text analysis data
In-Reply-To: <2fd54815-dc63-f496-7a28-c97920fe93ce@comcast.net>
References: <CA+nrPntd1ddeAskYt9LZ_Jav0rLyGaxEO4OyDbjNuCYi9f1f6w@mail.gmail.com>
 <CAHqSRuRKpKmLTHHKrJE84oF-+RUWyfqyWpNR2=02+G4pSNSkuA@mail.gmail.com>
 <BN6PR2201MB155387DDC0EAA8FE0323B60ACFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CAHqSRuQRrgXd26YekJ-5urnTmvP+jfiksz-LTp=tVcP_CUjnaA@mail.gmail.com>
 <BN6PR2201MB155357C13CA4352899C809F7CFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CAHqSRuRNw4KYw7co_VqOvONXAAMx6tibW+Qw4fdxpL3CZFaqCQ@mail.gmail.com>
 <CA+nrPnshxPzfRJhw1GFO-Za3-iUoptygXFwEaaJvrDMjy9X=LQ@mail.gmail.com>
 <BN6PR2201MB15533B93CA2E24096EBCC2DCCFEC9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CA+nrPnukJFB8s0X75RbrqcZXA7CZrX_0UTgEFy3wj4=zk87yhw@mail.gmail.com>
 <39f31093-2938-33e9-c068-9a4ca9f00f3b@comcast.net>
 <CA+nrPntaeEQAJses1Auk=SaYSRtK1C0oaCDkt+6qRpaZ-4sgEw@mail.gmail.com>
 <2fd54815-dc63-f496-7a28-c97920fe93ce@comcast.net>
Message-ID: <CA+nrPnsk9QLW-Guc7=c97DvVGXo90f4SSJ0uq3oBhdHkmf-zZA@mail.gmail.com>

Hi David,

I just used caret library and farff file format.

sapply(d, function(x){ length(unique(x)) } )
            PLUGIN_RULE_KEY           PLUGIN_CONFIG_KEY
PLUGIN_NAME
                       1817                        1211
     14
                DESCRIPTION                    SEVERITY
   NAME
                       1815                           5
   1813
   DEF_REMEDIATION_FUNCTION        REMEDIATION_GAP_MULT
DEF_REMEDIATION_BASE_EFFORT
                          4                           1
     15
            GAP_DESCRIPTION                 SYSTEM_TAGS
IS_TEMPLATE
                         15                         142
      2
         DESCRIPTION_FORMAT                        TYPE
                          2                           3

On Thu, Apr 14, 2022 at 2:30 AM David Winsemius <dwinsemius at comcast.net>
wrote:

>
> On 4/13/22 16:58, Neha gupta wrote:
>
>  summary(d)
>
>  PLUGIN_RULE_KEY    PLUGIN_CONFIG_KEY  PLUGIN_NAME        DESCRIPTION
>
>  Length:1819        Length:1819        Length:1819        Length:1819
>
>  Class :character   Class :character   Class :character   Class :character
>
>  Mode  :character   Mode  :character   Mode  :character   Mode  :character
>
>
>
>
>
>
>
>    SEVERITY             NAME           REMEDIATION_FUNCTION
>  Length:1819        Length:1819        Mode:logical
>  Class :character   Class :character   NA's:1819
>  Mode  :character   Mode  :character
>
> According to your code that column (and the two following it) should have
> been deleted with the lines:
>
> d$REMEDIATION_FUNCTION=NULL
> d$DEF_REMEDIATION_GAP_MULT=NULL
> d$REMEDIATION_BASE_EFFORT=NULL
>
> # And we're still only guessing that the caret package has been loaded since you have not offered the library calls that have set your workspace.
>
> Now we need:
> sapply(d, function(x){ length(unique(x)) } )
>
> # I generally use Hmisc::describe since it is a vast improvement over the default summary.data.frame
>
>
>
>
>
>
>
>  DEF_REMEDIATION_FUNCTION REMEDIATION_GAP_MULT DEF_REMEDIATION_GAP_MULT
>  Length:1819              Mode:logical         Length:1819
>  Class :character         NA's:1819            Class :character
>  Mode  :character                              Mode  :character
>
>
>
>  REMEDIATION_BASE_EFFORT
>
> So that column should also have been deleted since it is all NA..
>
>
> DEF_REMEDIATION_BASE_EFFORT GAP_DESCRIPTION
>  Mode:logical            Length:1819                 Length:1819
>  NA's:1819               Class :character            Class :character
>                          Mode  :character            Mode  :character
>
>
>
>  SYSTEM_TAGS         IS_TEMPLATE      DESCRIPTION_FORMAT     TYPE
>  Length:1819        Min.   :0.00000   Length:1819        Length:1819
>  Class :character   1st Qu.:0.00000   Class :character   Class :character
>  Mode  :character   Median :0.00000   Mode  :character   Mode  :character
>                     Mean   :0.02859
>                     3rd Qu.:0.00000
>                     Max.   :1.00000
>
>
> The IS_TEMPLATE column certainly does not look like "text".
>
> You have been posting in HTML. STOP DOING THAT. Read the Posting Guide
>
>
> --
> David.
>
>
> On Thu, Apr 14, 2022 at 1:33 AM David Winsemius <dwinsemius at comcast.net>
> wrote:
>
>>
>> On 4/13/22 13:07, Neha gupta wrote:
>> > Thank you Tim
>> >
>> > My purpose and aim is to train a model
>>
>>
>> It appears you are using the 'caret' package. You should have posted
>> code that loaded all the packages that you thought were essential to the
>> effort.
>>
>> > (based on the data I provided in my
>> > first email) and predict the output variable (TYPE variable which has
>> three
>> > different values like Severity, bugs, code smell etc) The data as you
>> can
>> > see also have a few text columns which is creating problems for me as I
>> > have never worked before with text data.
>> You offered what looks something like the output of `str(.)` on a
>> dataframe. It would also be a great help if you offered the output of
>> `summary(d)`
>> >
>> > I read a tutorial
>> What tutorial?
>> > that says stringAsFactor should be false, symbols etc
>> > should be removed, then data should be in tokens, then the text should
>> be
>> > placed in a matrix/table form, and then a model should be built. I am
>> not
>> > sure if these steps are required in my case. Its I think a word2vec
>> problem
>> > though I did not use it before.
>>
>>
>> I'm not sure what a "word2vec problem" might be.
>>
>> --
>>
>> David.
>>
>> >
>> > Best regards
>> >
>> > On Wed, Apr 13, 2022 at 9:53 PM Ebert,Timothy Aaron <tebert at ufl.edu>
>> wrote:
>> >
>> >> Is this a different question from the original post? It would be
>> better to
>> >> keep threads separate.
>> >>
>> >> Always pre-process the data. Clean the data of obvious mistakes. This
>> can
>> >> be simple typographical errors or complicated like an author that
>> wrote too
>> >> when they intended two or to. In old English texts spelling was not
>> >> standardized and the same word could have multiple spellings within one
>> >> book or chapter. Removing punctuation is probably a part of this,
>> though a
>> >> program like Grammarly would not work very well if it removed
>> punctuation.
>> >>
>> >>
>> >>
>> >> After that it depends on what you are trying to accomplish. Are you
>> >> interested in the number of times an author used the word ?a? or ?the?
>> and
>> >> is ?The? different from ?the?? Are you modeling word use frequency or
>> >> comparing vocabulary between texts.
>> >>
>> >>
>> >>
>> >> Too many choices.
>> >>
>> >>
>> >>
>> >> Tim
>> >>
>> >>
>> >>
>> >> *From:* Neha gupta <neha.bologna90 at gmail.com>
>> >> *Sent:* Wednesday, April 13, 2022 2:49 PM
>> >> *To:* Bill Dunlap <williamwdunlap at gmail.com>
>> >> *Cc:* Ebert,Timothy Aaron <tebert at ufl.edu>; r-help mailing list <
>> >> r-help at r-project.org>
>> >> *Subject:* Re: Error with text analysis data
>> >>
>> >>
>> >>
>> >> *[External Email]*
>> >>
>> >> Someone just told me that you need to pre process the data before model
>> >> construction. For instance, make the text to lower case, remove
>> >> punctuation, symbols etc and tokenize the text (give number to each
>> word).
>> >> Then create word of bags model (not sure about it), and then create a
>> >> model.
>> >>
>> >>
>> >>
>> >> Is it true to perform all these steps?
>> >>
>> >>
>> >>
>> >> Best regards
>> >>
>> >> On Wednesday, April 13, 2022, Bill Dunlap <williamwdunlap at gmail.com>
>> >> wrote:
>> >>
>> >>>   I would always suggest working until the model works, no errors and
>> no
>> >> NA values
>> >>
>> >>
>> >>
>> >> We agree on that.  However, the error gives you no hint about which
>> >> variables are causing the problem.  If it did, then it could only tell
>> >> about the first variable with the problem.  I think you would get to
>> your
>> >> working model faster if you got NA's for the constant columns and then
>> >> could drop them all at once (or otherwise deal with them).
>> >>
>> >>
>> >>
>> >> -Bill
>> >>
>> >>
>> >>
>> >> On Wed, Apr 13, 2022 at 9:40 AM Ebert,Timothy Aaron <tebert at ufl.edu>
>> >> wrote:
>> >>
>> >> I suspect that it is because you are looking at two types of error,
>> both
>> >> telling you that the model was not appropriate. In the ?error in
>> contrasts?
>> >> there is nothing to contrast in the model. For a numerical constant the
>> >> program calculates the standard deviation and ends with a division by
>> zero.
>> >> Division by zero is undefined, or NA.
>> >>
>> >>
>> >>
>> >> I would always suggest working until the model works, no errors and no
>> NA
>> >> values. The reason is that I can get NA in several ways and I need to
>> >> understand why. If I just ignore the NA in my model I may be assuming
>> the
>> >> wrong thing.
>> >>
>> >>
>> >>
>> >> Tim
>> >>
>> >>
>> >>
>> >> *From:* Bill Dunlap <williamwdunlap at gmail.com>
>> >> *Sent:* Wednesday, April 13, 2022 12:23 PM
>> >> *To:* Ebert,Timothy Aaron <tebert at ufl.edu>
>> >> *Cc:* Neha gupta <neha.bologna90 at gmail.com>; r-help mailing list <
>> >> r-help at r-project.org>
>> >> *Subject:* Re: [R] Error with text analysis data
>> >>
>> >>
>> >>
>> >> *[External Email]*
>> >>
>> >> Constant columns can be the model when you do some subsetting or are
>> >> exploring a new dataset.  My objection is that constant columns of
>> numbers
>> >> and logicals are fine but those of characters and factors are not.
>> >>
>> >>
>> >>
>> >> -Bill
>> >>
>> >>
>> >>
>> >> On Wed, Apr 13, 2022 at 9:15 AM Ebert,Timothy Aaron <tebert at ufl.edu>
>> >> wrote:
>> >>
>> >> What is the goal of having a constant in the model? To me that seems
>> >> pointless. Also there is no variability in sexCode regardless of
>> whether
>> >> you call it integer or factor. So the model y ~ sexCode is just a
>> strange
>> >> way to look at the variability in y and it would be better to do
>> something
>> >> like summarize(y) or mean(y) if that was the goal.
>> >>
>> >> Tim
>> >>
>> >> -----Original Message-----
>> >> From: R-help <r-help-bounces at r-project.org> On Behalf Of Bill Dunlap
>> >> Sent: Wednesday, April 13, 2022 9:56 AM
>> >> To: Neha gupta <neha.bologna90 at gmail.com>
>> >> Cc: r-help mailing list <r-help at r-project.org>
>> >> Subject: Re: [R] Error with text analysis data
>> >>
>> >> [External Email]
>> >>
>> >> This sounds like what I think is a bug in
>> stats::model.matrix.default(): a
>> >> numeric column with all identical entries is fine but a constant
>> character
>> >> or factor column is not.
>> >>
>> >>> d <- data.frame(y=1:5, sex=rep("Female",5)) d$sexFactor <-
>> >>> factor(d$sex, levels=c("Male","Female")) d$sexCode <-
>> >>> as.integer(d$sexFactor) d
>> >>    y    sex sexFactor sexCode
>> >> 1 1 Female    Female       2
>> >> 2 2 Female    Female       2
>> >> 3 3 Female    Female       2
>> >> 4 4 Female    Female       2
>> >> 5 5 Female    Female       2
>> >>> lm(y~sex, data=d)
>> >> Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
>> >>    contrasts can be applied only to factors with 2 or more levels
>> >>> lm(y~sexFactor, data=d)
>> >> Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
>> >>    contrasts can be applied only to factors with 2 or more levels
>> >>> lm(y~sexCode, data=d)
>> >> Call:
>> >> lm(formula = y ~ sexCode, data = d)
>> >>
>> >> Coefficients:
>> >> (Intercept)      sexCode
>> >>            3           NA
>> >>
>> >> Calling traceback() after the error would clarify this.
>> >>
>> >> -Bill
>> >>
>> >>
>> >> On Tue, Apr 12, 2022 at 3:12 PM Neha gupta <neha.bologna90 at gmail.com>
>> >> wrote:
>> >>
>> >>> Hello everyone, I have text data with output variable have three
>> >> subgroups.
>> >>> I am using the following code but getting the error message (see error
>> >>> after the code).
>> >>>
>> >>> d=read.csv("SONAR_RULES.csv", stringsAsFactors = FALSE)
>> >>> d$REMEDIATION_FUNCTION=NULL d$DEF_REMEDIATION_GAP_MULT=NULL
>> >>> d$REMEDIATION_BASE_EFFORT=NULL
>> >>>
>> >>> index <- createDataPartition(d$TYPE, p = .70,list = FALSE) tr <-
>> >>> d[index, ] ts <- d[-index, ]
>> >>>
>> >>> ctrl <- trainControl(method = "cv",number=3, index = index, classProbs
>> >>> = TRUE, summaryFunction = multiClassSummary)
>> >>>
>> >>> ran <- train(TYPE ~ ., data = tr,
>> >>>                      method = "rpart",
>> >>>                      ## Will create 48 parameter combinations
>> >>>                      tuneLength = 3,
>> >>>                      na.action= na.pass,
>> >>>                      metric = "Accuracy",
>> >>>                      preProc = c("center", "scale", "nzv"),
>> >>>                      trControl = ctrl)
>> >>> getTrainPerf(ran)
>> >>>
>> >>> *It gives me error:*
>> >>>
>> >>>
>> >>> *Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) :
>> >>> contrasts can be applied only to factors with 2 or more levels*
>> >>>
>> >>>
>> >>> *My data is as follow*
>> >>>
>> >>> Rows: 1,819
>> >>> Columns: 14
>> >>> $ PLUGIN_RULE_KEY             <chr> "InsufficientBranchCoverage",
>> >>> "InsufficientLin~
>> >>> $ PLUGIN_CONFIG_KEY           <chr> "", "", "", "", "", "", "", "",
>> "",
>> >> "",
>> >>> "S1120~
>> >>> $ PLUGIN_NAME                 <chr> "common-java", "common-java",
>> >>> "common-java", "~
>> >>> $ DESCRIPTION                 <chr> "An issue is created on a file as
>> >> soon
>> >>> as the ~
>> >>> $ SEVERITY                    <chr> "MAJOR", "MAJOR", "MAJOR",
>> "MAJOR",
>> >>> "MAJOR", "~
>> >>> $ NAME                        <chr> "Branches should have sufficient
>> >>> coverage by t~
>> >>> $ DEF_REMEDIATION_FUNCTION    <chr> "LINEAR", "LINEAR", "LINEAR",
>> >>> "LINEAR_OFFSET",~
>> >>> $ REMEDIATION_GAP_MULT        <lgl> NA, NA, NA, NA, NA, NA, NA, NA,
>> NA,
>> >> NA,
>> >>> NA, NA~
>> >>> $ DEF_REMEDIATION_BASE_EFFORT <chr> "", "", "", "10min", "", "",
>> >>> "5min", "5min", "~
>> >>> $ GAP_DESCRIPTION             <chr> "number of uncovered conditions",
>> >>> "number of l~
>> >>> $ SYSTEM_TAGS                 <chr> "bad-practice", "bad-practice",
>> >>> "convention", ~
>> >>> $ IS_TEMPLATE                 <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
>> 0,
>> >> 0,
>> >>> 0, 0, 0~
>> >>> $ DESCRIPTION_FORMAT          <chr> "HTML", "HTML", "HTML", "HTML",
>> >> "HTML",
>> >>> "HTML"~
>> >>> $ TYPE                        <chr> "CODE_SMELL", "CODE_SMELL",
>> >>> "CODE_SMELL", "COD~
>> >>>
>> >>>          [[alternative HTML version deleted]]
>> >>>
>> >>> ______________________________________________
>> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> >>>
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
>> >>> man_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAs
>> >>> Rzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxo
>> >>> RrVO5eP&s=f3IyuRfeDDjr_8UWlwyBTC5Yn4Y56QV4FjYC0GCWcVc&e=
>> >>> PLEASE do read the posting guide
>> >>>
>> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.or
>> >>> g_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeA
>> >>> sRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWx
>> >>> oRrVO5eP&s=Vo6cRRCeqGApsiEGGtA6pndDHjOIuGFOs7BOkJMvuaw&e=
>> >>> and provide commented, minimal, self-contained, reproducible code.
>> >>>
>> >>          [[alternative HTML version deleted]]
>> >>
>> >> ______________________________________________
>> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> >>
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxoRrVO5eP&s=f3IyuRfeDDjr_8UWlwyBTC5Yn4Y56QV4FjYC0GCWcVc&e=
>> >> PLEASE do read the posting guide
>> >>
>> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=HOpL0ELxWdK0xzzVxRd_DnxukD-qPEQIBxDJnlSkAQrae1FdSHYJTfWxoRrVO5eP&s=Vo6cRRCeqGApsiEGGtA6pndDHjOIuGFOs7BOkJMvuaw&e=
>> >> and provide commented, minimal, self-contained, reproducible code.
>> >>
>> >>
>> >       [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From tebert @end|ng |rom u||@edu  Thu Apr 14 03:37:14 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Thu, 14 Apr 2022 01:37:14 +0000
Subject: [R] Symbol/String comparison in R
In-Reply-To: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>
References: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>
Message-ID: <BN6PR2201MB15539E14C13A43B753D756EDCFEF9@BN6PR2201MB1553.namprd22.prod.outlook.com>

https://en.wikipedia.org/wiki/ASCII
There is a table towards the end of the document. Some of the other pieces may be of interest and/or relevant.

Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Kristjan Kure
Sent: Wednesday, April 13, 2022 10:06 AM
To: r-help at r-project.org
Subject: [R] Symbol/String comparison in R

[External Email]

Hi!

Sorry, I am a beginner in R.

I was not able to find answers to my questions (tried Google, Stack Overflow, etc). Please correct me if anything is wrong here.

When comparing symbols/strings in R - raw numeric values are compared symbol by symbol starting from left? If raw numeric values are not used is there an ASCII / Unicode table where symbols have values/ranking/order and R compares those values?

*2) Comparing symbols*
Letter "a" raw value is 61, letter "b" raw value is 62? Is this correct?

# Raw value for "a" = 61
a_raw <- charToRaw("a")
a_raw

# Raw value for "b" = 62
b_raw <- charToRaw("b")
b_raw

# equals TRUE
"a" < "b"

Ok, so 61 is less than 62 so it's TRUE. Is this correct?

*3) Comparing strings #1*
"1040" <= "12000"

raw_1040 <- charToRaw("1040")
raw_1040
#31 *30* (comparison happens with the second symbol) 34 30

raw_12000 <- charToRaw("12000")
raw_12000
#31 *32* (comparison happens with the second symbol) 30 30 30

The symbol in the second position is 30 and it's less than 32. Equals to true. Is this correct?

*4) Comparing strings #2*
"1040" <= "10000"

raw_1040 <- charToRaw("1040")
raw_1040
#31 30 *34*  (comparison happens with third symbol) 30

raw_10000 <- charToRaw("10000")
raw_10000
#31 30 *30*  (comparison happens with third symbol) 30 30

The symbol in the third position is 34 is greater than 30. Equals to false.
Is this correct?

*5) Problem - Why does this equal FALSE?* *"A" < "a"*

41 < 61 # FALSE?

# Raw value for "A" = 41
A_raw <- charToRaw("A")
A_raw

# Raw value for "a" = 61
a_raw <- charToRaw("a")
a_raw

Why is capitalized "A" not less than lowercase "a"? Based on raw values it should be. What am I missing here?

Thanks
Kristjan

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=9E-P8HOWO0s4h1p__tW4o8QGtge3bJ9VUJEDH-e-U_8OKRu2p1zazebKjPltKrWM&s=rhYKCkMRBFMzOVf8rVaRiO1Puh-rTSWAS8P6hoSzdgc&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=9E-P8HOWO0s4h1p__tW4o8QGtge3bJ9VUJEDH-e-U_8OKRu2p1zazebKjPltKrWM&s=fI_1ZAYJFp1nrJkOV4i4ueqf4o1MD1gKHzb6AyciJUc&e=
and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Thu Apr 14 04:00:26 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 13 Apr 2022 19:00:26 -0700
Subject: [R] Symbol/String comparison in R
In-Reply-To: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>
References: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>
Message-ID: <CAGxFJbQfMvJ17PM5-QjKMCJrD4mmTcT8HGDGRK8jeoDUDm=CWg@mail.gmail.com>

"I was not able to find answers to my questions (tried Google, Stack
Overflow, etc). Please correct me if anything is wrong here."

R has an extensive Help system. That should always be your first place
to look. In this case, ?"<" (at the R prompt) brings you to the Help
page for comparisons (as would ?Comparison, but only if the 'c" is in
upper case, unfortunately). Among lots of other stuff, it says:

"Comparison of strings in character vectors is lexicographic within
the strings using the collating sequence of the locale in use: see
locales." ... (+ lots more).

Incidentally, rseek.org and rdrr.io are another couple of good places
to look for R documentation.



Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Wed, Apr 13, 2022 at 5:10 PM Kristjan Kure <kristjan.kure.1 at gmail.com> wrote:
>
> Hi!
>
> Sorry, I am a beginner in R.
>
> I was not able to find answers to my questions (tried Google, Stack
> Overflow, etc). Please correct me if anything is wrong here.
>
> When comparing symbols/strings in R - raw numeric values are compared
> symbol by symbol starting from left? If raw numeric values are not used is
> there an ASCII / Unicode table where symbols have values/ranking/order and
> R compares those values?
>
> *2) Comparing symbols*
> Letter "a" raw value is 61, letter "b" raw value is 62? Is this correct?
>
> # Raw value for "a" = 61
> a_raw <- charToRaw("a")
> a_raw
>
> # Raw value for "b" = 62
> b_raw <- charToRaw("b")
> b_raw
>
> # equals TRUE
> "a" < "b"
>
> Ok, so 61 is less than 62 so it's TRUE. Is this correct?
>
> *3) Comparing strings #1*
> "1040" <= "12000"
>
> raw_1040 <- charToRaw("1040")
> raw_1040
> #31 *30* (comparison happens with the second symbol) 34 30
>
> raw_12000 <- charToRaw("12000")
> raw_12000
> #31 *32* (comparison happens with the second symbol) 30 30 30
>
> The symbol in the second position is 30 and it's less than 32. Equals to
> true. Is this correct?
>
> *4) Comparing strings #2*
> "1040" <= "10000"
>
> raw_1040 <- charToRaw("1040")
> raw_1040
> #31 30 *34*  (comparison happens with third symbol) 30
>
> raw_10000 <- charToRaw("10000")
> raw_10000
> #31 30 *30*  (comparison happens with third symbol) 30 30
>
> The symbol in the third position is 34 is greater than 30. Equals to false.
> Is this correct?
>
> *5) Problem - Why does this equal FALSE?*
> *"A" < "a"*
>
> 41 < 61 # FALSE?
>
> # Raw value for "A" = 41
> A_raw <- charToRaw("A")
> A_raw
>
> # Raw value for "a" = 61
> a_raw <- charToRaw("a")
> a_raw
>
> Why is capitalized "A" not less than lowercase "a"? Based on raw values it
> should be. What am I missing here?
>
> Thanks
> Kristjan
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From tebert @end|ng |rom u||@edu  Thu Apr 14 12:20:02 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Thu, 14 Apr 2022 10:20:02 +0000
Subject: [R] Symbol/String comparison in R
In-Reply-To: <CAGxFJbQfMvJ17PM5-QjKMCJrD4mmTcT8HGDGRK8jeoDUDm=CWg@mail.gmail.com>
References: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>
 <CAGxFJbQfMvJ17PM5-QjKMCJrD4mmTcT8HGDGRK8jeoDUDm=CWg@mail.gmail.com>
Message-ID: <BN6PR2201MB15534C950F9C02E97CE16084CFEF9@BN6PR2201MB1553.namprd22.prod.outlook.com>

For some issues it can be useful to learn by experiment. It gives you experience and shows you what sorts of error messages you can expect. In the console type things like this:
a>B
gives an error
"a">"B"
FALSE


-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Bert Gunter
Sent: Wednesday, April 13, 2022 10:00 PM
To: Kristjan Kure <kristjan.kure.1 at gmail.com>
Cc: R-help <r-help at r-project.org>
Subject: Re: [R] Symbol/String comparison in R

[External Email]

"I was not able to find answers to my questions (tried Google, Stack Overflow, etc). Please correct me if anything is wrong here."

R has an extensive Help system. That should always be your first place to look. In this case, ?"<" (at the R prompt) brings you to the Help page for comparisons (as would ?Comparison, but only if the 'c" is in upper case, unfortunately). Among lots of other stuff, it says:

"Comparison of strings in character vectors is lexicographic within the strings using the collating sequence of the locale in use: see locales." ... (+ lots more).

Incidentally, rseek.org and rdrr.io are another couple of good places to look for R documentation.



Bert Gunter

"The trouble with having an open mind is that people keep coming along and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

Bert Gunter

"The trouble with having an open mind is that people keep coming along and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Wed, Apr 13, 2022 at 5:10 PM Kristjan Kure <kristjan.kure.1 at gmail.com> wrote:
>
> Hi!
>
> Sorry, I am a beginner in R.
>
> I was not able to find answers to my questions (tried Google, Stack 
> Overflow, etc). Please correct me if anything is wrong here.
>
> When comparing symbols/strings in R - raw numeric values are compared 
> symbol by symbol starting from left? If raw numeric values are not 
> used is there an ASCII / Unicode table where symbols have 
> values/ranking/order and R compares those values?
>
> *2) Comparing symbols*
> Letter "a" raw value is 61, letter "b" raw value is 62? Is this correct?
>
> # Raw value for "a" = 61
> a_raw <- charToRaw("a")
> a_raw
>
> # Raw value for "b" = 62
> b_raw <- charToRaw("b")
> b_raw
>
> # equals TRUE
> "a" < "b"
>
> Ok, so 61 is less than 62 so it's TRUE. Is this correct?
>
> *3) Comparing strings #1*
> "1040" <= "12000"
>
> raw_1040 <- charToRaw("1040")
> raw_1040
> #31 *30* (comparison happens with the second symbol) 34 30
>
> raw_12000 <- charToRaw("12000")
> raw_12000
> #31 *32* (comparison happens with the second symbol) 30 30 30
>
> The symbol in the second position is 30 and it's less than 32. Equals 
> to true. Is this correct?
>
> *4) Comparing strings #2*
> "1040" <= "10000"
>
> raw_1040 <- charToRaw("1040")
> raw_1040
> #31 30 *34*  (comparison happens with third symbol) 30
>
> raw_10000 <- charToRaw("10000")
> raw_10000
> #31 30 *30*  (comparison happens with third symbol) 30 30
>
> The symbol in the third position is 34 is greater than 30. Equals to false.
> Is this correct?
>
> *5) Problem - Why does this equal FALSE?* *"A" < "a"*
>
> 41 < 61 # FALSE?
>
> # Raw value for "A" = 41
> A_raw <- charToRaw("A")
> A_raw
>
> # Raw value for "a" = 61
> a_raw <- charToRaw("a")
> a_raw
>
> Why is capitalized "A" not less than lowercase "a"? Based on raw 
> values it should be. What am I missing here?
>
> Thanks
> Kristjan
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
> man_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAs
> Rzsn7AkP-g&m=yz1V2nVJPZSQ9gn4HFUMVpUhZKZg_cwwu3HIvvS5jCkbCbdw_4DHCUxzb
> 1Z4DKFB&s=7MT7GhFYxYsVOPG_ayqqA63o6SYSWKlMJYSq5BhbGow&e=
> PLEASE do read the posting guide 
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.or
> g_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeA
> sRzsn7AkP-g&m=yz1V2nVJPZSQ9gn4HFUMVpUhZKZg_cwwu3HIvvS5jCkbCbdw_4DHCUxz
> b1Z4DKFB&s=-FIG1LH5_F3fqVDTUEvJUFpwYehrqtqS2P6YhyETQwY&e=
> and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=yz1V2nVJPZSQ9gn4HFUMVpUhZKZg_cwwu3HIvvS5jCkbCbdw_4DHCUxzb1Z4DKFB&s=7MT7GhFYxYsVOPG_ayqqA63o6SYSWKlMJYSq5BhbGow&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=yz1V2nVJPZSQ9gn4HFUMVpUhZKZg_cwwu3HIvvS5jCkbCbdw_4DHCUxzb1Z4DKFB&s=-FIG1LH5_F3fqVDTUEvJUFpwYehrqtqS2P6YhyETQwY&e=
and provide commented, minimal, self-contained, reproducible code.


From m@rc_grt @end|ng |rom y@hoo@|r  Thu Apr 14 12:34:24 2022
From: m@rc_grt @end|ng |rom y@hoo@|r (Marc Girondot)
Date: Thu, 14 Apr 2022 12:34:24 +0200
Subject: [R] Correct way to handle class
References: <81273719-b76c-eff9-6908-ad0b615919ef.ref@yahoo.fr>
Message-ID: <81273719-b76c-eff9-6908-ad0b615919ef@yahoo.fr>

Dear member of the list,

I search for the correct way to handle class.

I learn recently that inherits() was the correct way to test class:

inherits(x, what, which = FALSE)

For this part it is ok.

But now I have questions about the correct procedure to set class.

Previously I used:

result <- "Je suis donc je pense"
class(result) <- "ECFOCF"

But I loose the previous class "character". It is still present in 
mode(result) but sometimes it can be a problem.

For example here:

 > resultL <- data.frame(A=c(1,2), B=c(3, 4))
 > class(resultL)
[1] "data.frame"
 > class(resultL) <- "ECFOCF"
 > resultL
$A
[1] 1 2

$B
[1] 3 4

attr(,"class")
[1] "ECFOCF"
attr(,"row.names")
[1] 1 2

I lost the data.frame structure when I set the new class. It is seen as 
a list by:

 > mode(resultL)
[1] "list"

So I use:

result <- "Je suis donc je pense"
class(result) <- unique(append("ECFOCF", class(result)))

I use append because I don't want loose the original class. I use 
unique() to prevent the same class being put several times in the object.

However, Using this formula, I am not 100% sure the "ECFOCF" is the 
first class. If it is not, it could prevent plot.ECFOCF to take in 
charge the plot of this object.

An alternative could be:

 > result <- "Je suis donc je pense"
 > class(result) <- unique(append("ECFOCF", class(result)[class(result) 
!= "ECFOCF"]))
 > class(result)
[1] "ECFOCF"??? "character"

Then I am sure that "ECFOCF" class is the first one.

Is it the correct way to define class or I am in wrong direction?

Thanks a lot

Marc


From r@oknz @end|ng |rom gm@||@com  Thu Apr 14 13:25:17 2022
From: r@oknz @end|ng |rom gm@||@com (Richard O'Keefe)
Date: Thu, 14 Apr 2022 23:25:17 +1200
Subject: [R] Symbol/String comparison in R
In-Reply-To: <BN6PR2201MB15539E14C13A43B753D756EDCFEF9@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>
 <BN6PR2201MB15539E14C13A43B753D756EDCFEF9@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <CABcYAdKgxg-Kib2r62tScO9OoH3_gaY+Jd1KEEXUrFo0pj2EwA@mail.gmail.com>

To the original poster: don't even think about
charToRaw.  For one thing, the integer code that
corresponds to "a" can be found thus:
> library(gtools)
> asc("a")
97
and the answer is (predictably) 97, not 61.

> ?"<"
...
     Comparison of strings in character vectors is lexicographic within
     the strings using the collating sequence of the locale in use: see
     'locales'.  The collating sequence of locales such as 'en_US' is
     normally different from 'C' (which should use ASCII) and can be
     surprising.  Beware of making _any_ assumptions about the
     collation order
...

In a UNIX environment, the collating order R uses will
normally match the collating order that the system
sort(1) command uses.  This is also the order that is
used by the strcoll(3) library function.  There is an
ISO standard, not for how to compare strings, but for
specifying the rules for how to compare strings.  The
rules can be amazingly elaborate requiring up to seven
different passes and not all of them in the same direction.

ORIGINALLY the order was lexicographical left to right
by byte values (like the strcmp(3) library function) but
in a world of about 6000 languages and an amazing number
of scripts, that just doesn't match what people actually
want to do.

> icuGetCollate()
will tell you what collation rules R is following.
> ?icuGetCollate
will not so much tell you more than you wanted to know
about collation as hint at it.

These days, with Unicode and internationalisation,
text encoding and collation are just insanely complex.
R goes to a lot of trouble to hide this from you.
LET IT.



On Thu, 14 Apr 2022 at 13:38, Ebert,Timothy Aaron <tebert at ufl.edu> wrote:

> https://en.wikipedia.org/wiki/ASCII
> There is a table towards the end of the document. Some of the other pieces
> may be of interest and/or relevant.
>
> Tim
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Kristjan Kure
> Sent: Wednesday, April 13, 2022 10:06 AM
> To: r-help at r-project.org
> Subject: [R] Symbol/String comparison in R
>
> [External Email]
>
> Hi!
>
> Sorry, I am a beginner in R.
>
> I was not able to find answers to my questions (tried Google, Stack
> Overflow, etc). Please correct me if anything is wrong here.
>
> When comparing symbols/strings in R - raw numeric values are compared
> symbol by symbol starting from left? If raw numeric values are not used is
> there an ASCII / Unicode table where symbols have values/ranking/order and
> R compares those values?
>
> *2) Comparing symbols*
> Letter "a" raw value is 61, letter "b" raw value is 62? Is this correct?
>
> # Raw value for "a" = 61
> a_raw <- charToRaw("a")
> a_raw
>
> # Raw value for "b" = 62
> b_raw <- charToRaw("b")
> b_raw
>
> # equals TRUE
> "a" < "b"
>
> Ok, so 61 is less than 62 so it's TRUE. Is this correct?
>
> *3) Comparing strings #1*
> "1040" <= "12000"
>
> raw_1040 <- charToRaw("1040")
> raw_1040
> #31 *30* (comparison happens with the second symbol) 34 30
>
> raw_12000 <- charToRaw("12000")
> raw_12000
> #31 *32* (comparison happens with the second symbol) 30 30 30
>
> The symbol in the second position is 30 and it's less than 32. Equals to
> true. Is this correct?
>
> *4) Comparing strings #2*
> "1040" <= "10000"
>
> raw_1040 <- charToRaw("1040")
> raw_1040
> #31 30 *34*  (comparison happens with third symbol) 30
>
> raw_10000 <- charToRaw("10000")
> raw_10000
> #31 30 *30*  (comparison happens with third symbol) 30 30
>
> The symbol in the third position is 34 is greater than 30. Equals to false.
> Is this correct?
>
> *5) Problem - Why does this equal FALSE?* *"A" < "a"*
>
> 41 < 61 # FALSE?
>
> # Raw value for "A" = 41
> A_raw <- charToRaw("A")
> A_raw
>
> # Raw value for "a" = 61
> a_raw <- charToRaw("a")
> a_raw
>
> Why is capitalized "A" not less than lowercase "a"? Based on raw values it
> should be. What am I missing here?
>
> Thanks
> Kristjan
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=9E-P8HOWO0s4h1p__tW4o8QGtge3bJ9VUJEDH-e-U_8OKRu2p1zazebKjPltKrWM&s=rhYKCkMRBFMzOVf8rVaRiO1Puh-rTSWAS8P6hoSzdgc&e=
> PLEASE do read the posting guide
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=9E-P8HOWO0s4h1p__tW4o8QGtge3bJ9VUJEDH-e-U_8OKRu2p1zazebKjPltKrWM&s=fI_1ZAYJFp1nrJkOV4i4ueqf4o1MD1gKHzb6AyciJUc&e=
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Apr 14 16:05:19 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 14 Apr 2022 15:05:19 +0100
Subject: [R] Symbol/String comparison in R
In-Reply-To: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>
References: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>
Message-ID: <074d6a6f-4fe7-6c9e-7059-585f492bbb6f@sapo.pt>

Hello,

This is a locale issue, you are counting on the ASCII table codes but 
that's only valid for the "C" locale.

old_loc <- Sys.getlocale("LC_COLLATE")

"A" < "a"
#> [1] FALSE
"A" > "a"
#> [1] TRUE

Sys.setlocale("LC_COLLATE", locale = "C")
#> [1] "C"

"A" < "a"
#> [1] TRUE
"A" > "a"
#> [1] FALSE

Sys.setlocale("LC_COLLATE", old_loc)
#> [1] "Portuguese_Portugal.1252"


Hope this helps,

Rui Barradas

?s 15:06 de 13/04/2022, Kristjan Kure escreveu:
> Hi!
> 
> Sorry, I am a beginner in R.
> 
> I was not able to find answers to my questions (tried Google, Stack
> Overflow, etc). Please correct me if anything is wrong here.
> 
> When comparing symbols/strings in R - raw numeric values are compared
> symbol by symbol starting from left? If raw numeric values are not used is
> there an ASCII / Unicode table where symbols have values/ranking/order and
> R compares those values?
> 
> *2) Comparing symbols*
> Letter "a" raw value is 61, letter "b" raw value is 62? Is this correct?
> 
> # Raw value for "a" = 61
> a_raw <- charToRaw("a")
> a_raw
> 
> # Raw value for "b" = 62
> b_raw <- charToRaw("b")
> b_raw
> 
> # equals TRUE
> "a" < "b"
> 
> Ok, so 61 is less than 62 so it's TRUE. Is this correct?
> 
> *3) Comparing strings #1*
> "1040" <= "12000"
> 
> raw_1040 <- charToRaw("1040")
> raw_1040
> #31 *30* (comparison happens with the second symbol) 34 30
> 
> raw_12000 <- charToRaw("12000")
> raw_12000
> #31 *32* (comparison happens with the second symbol) 30 30 30
> 
> The symbol in the second position is 30 and it's less than 32. Equals to
> true. Is this correct?
> 
> *4) Comparing strings #2*
> "1040" <= "10000"
> 
> raw_1040 <- charToRaw("1040")
> raw_1040
> #31 30 *34*  (comparison happens with third symbol) 30
> 
> raw_10000 <- charToRaw("10000")
> raw_10000
> #31 30 *30*  (comparison happens with third symbol) 30 30
> 
> The symbol in the third position is 34 is greater than 30. Equals to false.
> Is this correct?
> 
> *5) Problem - Why does this equal FALSE?*
> *"A" < "a"*
> 
> 41 < 61 # FALSE?
> 
> # Raw value for "A" = 41
> A_raw <- charToRaw("A")
> A_raw
> 
> # Raw value for "a" = 61
> a_raw <- charToRaw("a")
> a_raw
> 
> Why is capitalized "A" not less than lowercase "a"? Based on raw values it
> should be. What am I missing here?
> 
> Thanks
> Kristjan
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Apr 14 16:24:14 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 14 Apr 2022 07:24:14 -0700
Subject: [R] Symbol/String comparison in R
In-Reply-To: <CABcYAdKgxg-Kib2r62tScO9OoH3_gaY+Jd1KEEXUrFo0pj2EwA@mail.gmail.com>
References: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>
 <BN6PR2201MB15539E14C13A43B753D756EDCFEF9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CABcYAdKgxg-Kib2r62tScO9OoH3_gaY+Jd1KEEXUrFo0pj2EwA@mail.gmail.com>
Message-ID: <B6EFD588-C064-4C9D-982B-0CA74559BD07@dcn.davis.ca.us>

While the advice that collation order is not necessarily determined by encoding is helpful, the advice suggesting that charToRaw is to be always avoided rings false to me, since 61 hexadecimal is the same as 97 decimal.

I am hoping someone will come along and offer useful input like where to find the actual collation order implemented by the now-default Sys.getlocale("LC_COLATE")="C.UTF-8", since I was under the impression that this particular collation was in fact supposed to collate according to the numerical magnitude of the UTF-8 code points but it does not appear to do so.

On April 14, 2022 4:25:17 AM PDT, Richard O'Keefe <raoknz at gmail.com> wrote:
>To the original poster: don't even think about
>charToRaw.  For one thing, the integer code that
>corresponds to "a" can be found thus:
>> library(gtools)
>> asc("a")
>97
>and the answer is (predictably) 97, not 61.
>
>> ?"<"
>...
>     Comparison of strings in character vectors is lexicographic within
>     the strings using the collating sequence of the locale in use: see
>     'locales'.  The collating sequence of locales such as 'en_US' is
>     normally different from 'C' (which should use ASCII) and can be
>     surprising.  Beware of making _any_ assumptions about the
>     collation order
>...
>
>In a UNIX environment, the collating order R uses will
>normally match the collating order that the system
>sort(1) command uses.  This is also the order that is
>used by the strcoll(3) library function.  There is an
>ISO standard, not for how to compare strings, but for
>specifying the rules for how to compare strings.  The
>rules can be amazingly elaborate requiring up to seven
>different passes and not all of them in the same direction.
>
>ORIGINALLY the order was lexicographical left to right
>by byte values (like the strcmp(3) library function) but
>in a world of about 6000 languages and an amazing number
>of scripts, that just doesn't match what people actually
>want to do.
>
>> icuGetCollate()
>will tell you what collation rules R is following.
>> ?icuGetCollate
>will not so much tell you more than you wanted to know
>about collation as hint at it.
>
>These days, with Unicode and internationalisation,
>text encoding and collation are just insanely complex.
>R goes to a lot of trouble to hide this from you.
>LET IT.
>
>
>
>On Thu, 14 Apr 2022 at 13:38, Ebert,Timothy Aaron <tebert at ufl.edu> wrote:
>
>> https://en.wikipedia.org/wiki/ASCII
>> There is a table towards the end of the document. Some of the other pieces
>> may be of interest and/or relevant.
>>
>> Tim
>>
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Kristjan Kure
>> Sent: Wednesday, April 13, 2022 10:06 AM
>> To: r-help at r-project.org
>> Subject: [R] Symbol/String comparison in R
>>
>> [External Email]
>>
>> Hi!
>>
>> Sorry, I am a beginner in R.
>>
>> I was not able to find answers to my questions (tried Google, Stack
>> Overflow, etc). Please correct me if anything is wrong here.
>>
>> When comparing symbols/strings in R - raw numeric values are compared
>> symbol by symbol starting from left? If raw numeric values are not used is
>> there an ASCII / Unicode table where symbols have values/ranking/order and
>> R compares those values?
>>
>> *2) Comparing symbols*
>> Letter "a" raw value is 61, letter "b" raw value is 62? Is this correct?
>>
>> # Raw value for "a" = 61
>> a_raw <- charToRaw("a")
>> a_raw
>>
>> # Raw value for "b" = 62
>> b_raw <- charToRaw("b")
>> b_raw
>>
>> # equals TRUE
>> "a" < "b"
>>
>> Ok, so 61 is less than 62 so it's TRUE. Is this correct?
>>
>> *3) Comparing strings #1*
>> "1040" <= "12000"
>>
>> raw_1040 <- charToRaw("1040")
>> raw_1040
>> #31 *30* (comparison happens with the second symbol) 34 30
>>
>> raw_12000 <- charToRaw("12000")
>> raw_12000
>> #31 *32* (comparison happens with the second symbol) 30 30 30
>>
>> The symbol in the second position is 30 and it's less than 32. Equals to
>> true. Is this correct?
>>
>> *4) Comparing strings #2*
>> "1040" <= "10000"
>>
>> raw_1040 <- charToRaw("1040")
>> raw_1040
>> #31 30 *34*  (comparison happens with third symbol) 30
>>
>> raw_10000 <- charToRaw("10000")
>> raw_10000
>> #31 30 *30*  (comparison happens with third symbol) 30 30
>>
>> The symbol in the third position is 34 is greater than 30. Equals to false.
>> Is this correct?
>>
>> *5) Problem - Why does this equal FALSE?* *"A" < "a"*
>>
>> 41 < 61 # FALSE?
>>
>> # Raw value for "A" = 41
>> A_raw <- charToRaw("A")
>> A_raw
>>
>> # Raw value for "a" = 61
>> a_raw <- charToRaw("a")
>> a_raw
>>
>> Why is capitalized "A" not less than lowercase "a"? Based on raw values it
>> should be. What am I missing here?
>>
>> Thanks
>> Kristjan
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=9E-P8HOWO0s4h1p__tW4o8QGtge3bJ9VUJEDH-e-U_8OKRu2p1zazebKjPltKrWM&s=rhYKCkMRBFMzOVf8rVaRiO1Puh-rTSWAS8P6hoSzdgc&e=
>> PLEASE do read the posting guide
>> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=9E-P8HOWO0s4h1p__tW4o8QGtge3bJ9VUJEDH-e-U_8OKRu2p1zazebKjPltKrWM&s=fI_1ZAYJFp1nrJkOV4i4ueqf4o1MD1gKHzb6AyciJUc&e=
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Apr 14 16:24:37 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 14 Apr 2022 15:24:37 +0100
Subject: [R] Correct way to handle class
In-Reply-To: <81273719-b76c-eff9-6908-ad0b615919ef@yahoo.fr>
References: <81273719-b76c-eff9-6908-ad0b615919ef.ref@yahoo.fr>
 <81273719-b76c-eff9-6908-ad0b615919ef@yahoo.fr>
Message-ID: <5db1750d-18ee-134a-fc2e-54e65c18dd41@sapo.pt>

Hello,

Write a function to set the new class attribute. If other changes need 
to be done, you can do them all in one function. For instance, the 
as.matrix method for atomic vectors coerces a vector to class "matrix" 
*and* gives it a dim attribute. The two changes are done in one call.

In the example below, there's a setter function and a print method for 
the new class. It can handle both atomic vectors and with NextMethod 
complicated objects such as data.frames.


as_ECFOCF <- function(x, ...) {
   if(!inherits(x, "ECFOCF"))
     class(x) <- c("ECFOCF", class(x))
   x
}
print.ECFOCF <- function(x, ...) {
   if(is.atomic(x))
     print.default(unclass(x))
   else
     NextMethod()
}

result2 <- "Je suis donc je pense"
resultL2 <- data.frame(A=c(1,2), B=c(3, 4))

result2 <- as_ECFOCF(result2)
class(result2)
#> [1] "ECFOCF"    "character"
result2
#> [1] "Je suis donc je pense"

resultL2 <- as_ECFOCF(resultL2)
class(resultL2)
#> [1] "ECFOCF"     "data.frame"
resultL2
#>   A B
#> 1 1 3
#> 2 2 4


Hope this helps,

Rui Barradas

?s 11:34 de 14/04/2022, Marc Girondot via R-help escreveu:
> Dear member of the list,
> 
> I search for the correct way to handle class.
> 
> I learn recently that inherits() was the correct way to test class:
> 
> inherits(x, what, which = FALSE)
> 
> For this part it is ok.
> 
> But now I have questions about the correct procedure to set class.
> 
> Previously I used:
> 
> result <- "Je suis donc je pense"
> class(result) <- "ECFOCF"
> 
> But I loose the previous class "character". It is still present in 
> mode(result) but sometimes it can be a problem.
> 
> For example here:
> 
>  > resultL <- data.frame(A=c(1,2), B=c(3, 4))
>  > class(resultL)
> [1] "data.frame"
>  > class(resultL) <- "ECFOCF"
>  > resultL
> $A
> [1] 1 2
> 
> $B
> [1] 3 4
> 
> attr(,"class")
> [1] "ECFOCF"
> attr(,"row.names")
> [1] 1 2
> 
> I lost the data.frame structure when I set the new class. It is seen as 
> a list by:
> 
>  > mode(resultL)
> [1] "list"
> 
> So I use:
> 
> result <- "Je suis donc je pense"
> class(result) <- unique(append("ECFOCF", class(result)))
> 
> I use append because I don't want loose the original class. I use 
> unique() to prevent the same class being put several times in the object.
> 
> However, Using this formula, I am not 100% sure the "ECFOCF" is the 
> first class. If it is not, it could prevent plot.ECFOCF to take in 
> charge the plot of this object.
> 
> An alternative could be:
> 
>  > result <- "Je suis donc je pense"
>  > class(result) <- unique(append("ECFOCF", class(result)[class(result) 
> != "ECFOCF"]))
>  > class(result)
> [1] "ECFOCF"??? "character"
> 
> Then I am sure that "ECFOCF" class is the first one.
> 
> Is it the correct way to define class or I am in wrong direction?
> 
> Thanks a lot
> 
> Marc
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Thu Apr 14 16:29:44 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 14 Apr 2022 07:29:44 -0700
Subject: [R] Correct way to handle class
In-Reply-To: <81273719-b76c-eff9-6908-ad0b615919ef@yahoo.fr>
References: <81273719-b76c-eff9-6908-ad0b615919ef.ref@yahoo.fr>
 <81273719-b76c-eff9-6908-ad0b615919ef@yahoo.fr>
Message-ID: <CAGxFJbS3Yat1vxzCutHNf8EM7Tf8G1a8k9OEb5PPd_NT5baBGQ@mail.gmail.com>

There are numerous tutorials, including the "Intro to R" that explain
this. A search on "S3 classes in R" (there are at least **3**
different class systems in R -- S3, S4, and R6) would have found many.

But even ?UseMethod provides the info you need, I think. It says:
"A class attribute is a character **vector** giving the names of the
classes from which the object inherits. ..."

So while what you did is correct, simply using:

class(result) <- c("ECFOCF", class(result))

would suffice. The Help page above or tutorials will provide greater
detail of course.


Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Thu, Apr 14, 2022 at 3:34 AM Marc Girondot via R-help
<r-help at r-project.org> wrote:
>
> Dear member of the list,
>
> I search for the correct way to handle class.
>
> I learn recently that inherits() was the correct way to test class:
>
> inherits(x, what, which = FALSE)
>
> For this part it is ok.
>
> But now I have questions about the correct procedure to set class.
>
> Previously I used:
>
> result <- "Je suis donc je pense"
> class(result) <- "ECFOCF"
>
> But I loose the previous class "character". It is still present in
> mode(result) but sometimes it can be a problem.
>
> For example here:
>
>  > resultL <- data.frame(A=c(1,2), B=c(3, 4))
>  > class(resultL)
> [1] "data.frame"
>  > class(resultL) <- "ECFOCF"
>  > resultL
> $A
> [1] 1 2
>
> $B
> [1] 3 4
>
> attr(,"class")
> [1] "ECFOCF"
> attr(,"row.names")
> [1] 1 2
>
> I lost the data.frame structure when I set the new class. It is seen as
> a list by:
>
>  > mode(resultL)
> [1] "list"
>
> So I use:
>
> result <- "Je suis donc je pense"
> class(result) <- unique(append("ECFOCF", class(result)))
>
> I use append because I don't want loose the original class. I use
> unique() to prevent the same class being put several times in the object.
>
> However, Using this formula, I am not 100% sure the "ECFOCF" is the
> first class. If it is not, it could prevent plot.ECFOCF to take in
> charge the plot of this object.
>
> An alternative could be:
>
>  > result <- "Je suis donc je pense"
>  > class(result) <- unique(append("ECFOCF", class(result)[class(result)
> != "ECFOCF"]))
>  > class(result)
> [1] "ECFOCF"    "character"
>
> Then I am sure that "ECFOCF" class is the first one.
>
> Is it the correct way to define class or I am in wrong direction?
>
> Thanks a lot
>
> Marc
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From tebert @end|ng |rom u||@edu  Thu Apr 14 16:39:55 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Thu, 14 Apr 2022 14:39:55 +0000
Subject: [R] Symbol/String comparison in R
In-Reply-To: <CAJ_7LVtGw-kPUN+gAG6nwrYpFkvH2XQKvQ+W9FAcP04Bz6F_uA@mail.gmail.com>
References: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>
 <CAGxFJbQfMvJ17PM5-QjKMCJrD4mmTcT8HGDGRK8jeoDUDm=CWg@mail.gmail.com>
 <BN6PR2201MB15534C950F9C02E97CE16084CFEF9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CAJ_7LVtGw-kPUN+gAG6nwrYpFkvH2XQKvQ+W9FAcP04Bz6F_uA@mail.gmail.com>
Message-ID: <BN6PR2201MB1553AD9243E116D702F9B430CFEF9@BN6PR2201MB1553.namprd22.prod.outlook.com>

These outcomes are correct. It is an element wise comparison with the left most comparison taking precedence.
?abaca? < ?acaba?
TRUE
?abaca? < ?acabammmmm?
TRUE

This is important because it makes clear sort order: What is the right order for the numbers 1 through 10 sorted as character?

Another fun game is to explain
F > T
FALSE
f > t
error
?f?>?t?
FALSE

I can also change the first outcome
F<-4
T<-2
F>T
TRUE

The key is to know when I am comparing variables versus strings and a short cut R uses as a default for TRUE and FALSE that can be reset by the user.

Tim

From: Kristjan Kure <kristjan.kure.1 at gmail.com>
Sent: Thursday, April 14, 2022 8:00 AM
To: Ebert,Timothy Aaron <tebert at ufl.edu>
Cc: Bert Gunter <bgunter.4567 at gmail.com>; R-help <r-help at r-project.org>
Subject: Re: [R] Symbol/String comparison in R

[External Email]
Thank you for your response. This is the current status:

I am looking fundamental why for these comparisons:
"1040" <= "12000" # returns true
"1040" <= "10000" # returns false
"a" < "A" # returns true
"A" < "a" # returns false
"raining" <= "raining x" #true

Feedback so far:
1) Bert: "lexicographic", "locale"
2) Timothy: https://en.wikipedia.org/wiki/ASCII<https://urldefense.proofpoint.com/v2/url?u=https-3A__en.wikipedia.org_wiki_ASCII&d=DwMFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=e86X_tk8tjXPbrbY_0i-7WvJzmij3UUzZzE0awNSlL0fEpHaKLIEWyoJ3diccoJ3&s=Ds3AyEefVfUhjBBwZYJ9CqhqtfyorOkZfENCpIZv7hU&e=>

My comments:
1) "Lexicographic" - The phrase lexicographic order means alphabetical order. This will help me only when comparing:
"a" < "b" # I suppose it returns true, bluntly because (1 < 2)? Position 1 - A, position 2 - B
"b" < "a" # I suppose it returns false, bluntly because (2 < 1)? Position 2 - B, position 1 - A

2) Checking the alphabet or ASCII table won't help me understand why "a" < "A" returns true.

3) Letter "A" has smaller values compared to "a" (Checking oct, dec, hex values in https://en.wikipedia.org/wiki/ASCII<https://urldefense.proofpoint.com/v2/url?u=https-3A__en.wikipedia.org_wiki_ASCII&d=DwMFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=e86X_tk8tjXPbrbY_0i-7WvJzmij3UUzZzE0awNSlL0fEpHaKLIEWyoJ3diccoJ3&s=Ds3AyEefVfUhjBBwZYJ9CqhqtfyorOkZfENCpIZv7hU&e=>). On the other hand, if alphabetical order is different
in country X the whole ASCII table is obsolete?

4) "Locale" - I understand the order of letters can be different between locales/alphabets. Still, it does not help with "a" < "A" comparison.
Tried to use local() function in RStudio - did not get additional insight. Or is there any local table somewhere listing all symbols, lowercase, and uppercase symbols/letters?

I understand it might be a rare occasion for this type of comparison, but I still want to understand the why. Also, some functions might return strings instead of numbers
and then it might be helpful to understand what is really going on.

If no one can answer how these comparisons fundamentally work should this kind of string comparison return NaN in R?
Best regards,
Kristjan

On Thu, Apr 14, 2022 at 1:20 PM Ebert,Timothy Aaron <tebert at ufl.edu<mailto:tebert at ufl.edu>> wrote:
For some issues it can be useful to learn by experiment. It gives you experience and shows you what sorts of error messages you can expect. In the console type things like this:
a>B
gives an error
"a">"B"
FALSE


-----Original Message-----
From: R-help <r-help-bounces at r-project.org<mailto:r-help-bounces at r-project.org>> On Behalf Of Bert Gunter
Sent: Wednesday, April 13, 2022 10:00 PM
To: Kristjan Kure <kristjan.kure.1 at gmail.com<mailto:kristjan.kure.1 at gmail.com>>
Cc: R-help <r-help at r-project.org<mailto:r-help at r-project.org>>
Subject: Re: [R] Symbol/String comparison in R

[External Email]

"I was not able to find answers to my questions (tried Google, Stack Overflow, etc). Please correct me if anything is wrong here."

R has an extensive Help system. That should always be your first place to look. In this case, ?"<" (at the R prompt) brings you to the Help page for comparisons (as would ?Comparison, but only if the 'c" is in upper case, unfortunately). Among lots of other stuff, it says:

"Comparison of strings in character vectors is lexicographic within the strings using the collating sequence of the locale in use: see locales." ... (+ lots more).

Incidentally, rseek.org<https://urldefense.proofpoint.com/v2/url?u=http-3A__rseek.org&d=DwMFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=e86X_tk8tjXPbrbY_0i-7WvJzmij3UUzZzE0awNSlL0fEpHaKLIEWyoJ3diccoJ3&s=Wp6_AwvgFE91zeQ3W1r0TCGdfxdJhVtv4ZrlieWqeaA&e=> and rdrr.io<https://urldefense.proofpoint.com/v2/url?u=http-3A__rdrr.io&d=DwMFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=e86X_tk8tjXPbrbY_0i-7WvJzmij3UUzZzE0awNSlL0fEpHaKLIEWyoJ3diccoJ3&s=lmyiTc5RbfDL4dT_DLta_PeLG-6BghH_cmU2Zr01jtI&e=> are another couple of good places to look for R documentation.



Bert Gunter

"The trouble with having an open mind is that people keep coming along and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

Bert Gunter

"The trouble with having an open mind is that people keep coming along and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Wed, Apr 13, 2022 at 5:10 PM Kristjan Kure <kristjan.kure.1 at gmail.com<mailto:kristjan.kure.1 at gmail.com>> wrote:
>
> Hi!
>
> Sorry, I am a beginner in R.
>
> I was not able to find answers to my questions (tried Google, Stack
> Overflow, etc). Please correct me if anything is wrong here.
>
> When comparing symbols/strings in R - raw numeric values are compared
> symbol by symbol starting from left? If raw numeric values are not
> used is there an ASCII / Unicode table where symbols have
> values/ranking/order and R compares those values?
>
> *2) Comparing symbols*
> Letter "a" raw value is 61, letter "b" raw value is 62? Is this correct?
>
> # Raw value for "a" = 61
> a_raw <- charToRaw("a")
> a_raw
>
> # Raw value for "b" = 62
> b_raw <- charToRaw("b")
> b_raw
>
> # equals TRUE
> "a" < "b"
>
> Ok, so 61 is less than 62 so it's TRUE. Is this correct?
>
> *3) Comparing strings #1*
> "1040" <= "12000"
>
> raw_1040 <- charToRaw("1040")
> raw_1040
> #31 *30* (comparison happens with the second symbol) 34 30
>
> raw_12000 <- charToRaw("12000")
> raw_12000
> #31 *32* (comparison happens with the second symbol) 30 30 30
>
> The symbol in the second position is 30 and it's less than 32. Equals
> to true. Is this correct?
>
> *4) Comparing strings #2*
> "1040" <= "10000"
>
> raw_1040 <- charToRaw("1040")
> raw_1040
> #31 30 *34*  (comparison happens with third symbol) 30
>
> raw_10000 <- charToRaw("10000")
> raw_10000
> #31 30 *30*  (comparison happens with third symbol) 30 30
>
> The symbol in the third position is 34 is greater than 30. Equals to false.
> Is this correct?
>
> *5) Problem - Why does this equal FALSE?* *"A" < "a"*
>
> 41 < 61 # FALSE?
>
> # Raw value for "A" = 41
> A_raw <- charToRaw("A")
> A_raw
>
> # Raw value for "a" = 61
> a_raw <- charToRaw("a")
> a_raw
>
> Why is capitalized "A" not less than lowercase "a"? Based on raw
> values it should be. What am I missing here?
>
> Thanks
> Kristjan
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
> man_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAs
> Rzsn7AkP-g&m=yz1V2nVJPZSQ9gn4HFUMVpUhZKZg_cwwu3HIvvS5jCkbCbdw_4DHCUxzb
> 1Z4DKFB&s=7MT7GhFYxYsVOPG_ayqqA63o6SYSWKlMJYSq5BhbGow&e=
> PLEASE do read the posting guide
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.or
> g_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeA
> sRzsn7AkP-g&m=yz1V2nVJPZSQ9gn4HFUMVpUhZKZg_cwwu3HIvvS5jCkbCbdw_4DHCUxz
> b1Z4DKFB&s=-FIG1LH5_F3fqVDTUEvJUFpwYehrqtqS2P6YhyETQwY&e=
> and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=yz1V2nVJPZSQ9gn4HFUMVpUhZKZg_cwwu3HIvvS5jCkbCbdw_4DHCUxzb1Z4DKFB&s=7MT7GhFYxYsVOPG_ayqqA63o6SYSWKlMJYSq5BhbGow&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=yz1V2nVJPZSQ9gn4HFUMVpUhZKZg_cwwu3HIvvS5jCkbCbdw_4DHCUxzb1Z4DKFB&s=-FIG1LH5_F3fqVDTUEvJUFpwYehrqtqS2P6YhyETQwY&e=
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Apr 14 18:44:04 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 14 Apr 2022 09:44:04 -0700 (PDT)
Subject: [R] Symbol/String comparison in R
In-Reply-To: <BN6PR2201MB1553AD9243E116D702F9B430CFEF9@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>
 <CAGxFJbQfMvJ17PM5-QjKMCJrD4mmTcT8HGDGRK8jeoDUDm=CWg@mail.gmail.com>
 <BN6PR2201MB15534C950F9C02E97CE16084CFEF9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CAJ_7LVtGw-kPUN+gAG6nwrYpFkvH2XQKvQ+W9FAcP04Bz6F_uA@mail.gmail.com>
 <BN6PR2201MB1553AD9243E116D702F9B430CFEF9@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <alpine.BSF.2.00.2204140900000.79805@pedal.dcn.davis.ca.us>

I encourage others to read Kristjan's clarifications below Timothy's reply 
below, as I very nearly missed them. I get similar results on Windows 10 
(21H1, with R 4.1.2) and Ubuntu (20.04, with R 4.1.3), both of which 
indicate Sys.getlocale("LC_COLLATE") is "C.UTF-8", which non-definitive 
sources (e.g. [1]) say should sort in raw code point order.

Re: OP reference to the "local" function... do learn to read the help 
regarding functions, as in ?local. That function has nothing to do with 
the concept of a locale (with an e at the end), for which other replies 
have suggested reading ?Sys.setlocale or ?icuSetCollate (which, by the 
way, indicates that its functionality is OPTIONAL and should not control 
collation until it is invoked to activate it, so could be regarded as 
informative but tangential unless the documentation is out of date).

Timothy, at some point it would behoove you to try to answer the questions 
that are asked instead of going off on tangents.

- Posting in html is interfering with communication, as what you see is
not what we see (e.g. "quotes" in "?abaca? < ?acaba?" below).
- OP seems to have used the term symbol to indicate what I might refer to 
as "glyph", a visual representation. They are apparently not familiar with 
the meta-language handling in R that refers to syntactic language elements 
as symbols. So
    a<b
was never included in the question. Therefore, issues around R symbols T 
vs t are tangents that divert from the question.
- OP was clear from the beginning that they are familiar with the ASCII 
code point table, so pointing them at it missed the mark by a mile.

The upside of this latest post is that you re-introduced the OP's off-list 
clarification comments to the mailing list thread. Kristjan, do use 
reply-all if you don't want to get lost in off-list conversations with 
an audience of 1, and do read the Posting Guide (e.g. re plain text).

[1] https://community.hpe.com/t5/HP-UX-General/Difference-between-C-utf8-and-en-us-utf8-points/td-p/4418194#.YlhHXujMLb0

On Thu, 14 Apr 2022, Ebert,Timothy Aaron wrote:

> These outcomes are correct. It is an element wise comparison with the left most comparison taking precedence.
> ?abaca? < ?acaba?
> TRUE
> ?abaca? < ?acabammmmm?
> TRUE
>
> This is important because it makes clear sort order: What is the right order for the numbers 1 through 10 sorted as character?
>
> Another fun game is to explain
> F > T
> FALSE
> f > t
> error
> ?f?>?t?
> FALSE
>
> I can also change the first outcome
> F<-4
> T<-2
> F>T
> TRUE
>
> The key is to know when I am comparing variables versus strings and a short cut R uses as a default for TRUE and FALSE that can be reset by the user.
>
> Tim
>
> From: Kristjan Kure <kristjan.kure.1 at gmail.com>
> Sent: Thursday, April 14, 2022 8:00 AM
> To: Ebert,Timothy Aaron <tebert at ufl.edu>
> Cc: Bert Gunter <bgunter.4567 at gmail.com>; R-help <r-help at r-project.org>
> Subject: Re: [R] Symbol/String comparison in R
>
> [External Email]
> Thank you for your response. This is the current status:
>
> I am looking fundamental why for these comparisons:
> "1040" <= "12000" # returns true
> "1040" <= "10000" # returns false
> "a" < "A" # returns true
> "A" < "a" # returns false
> "raining" <= "raining x" #true
>
> Feedback so far:
> 1) Bert: "lexicographic", "locale"
> 2) Timothy: https://en.wikipedia.org/wiki/ASCII<https://urldefense.proofpoint.com/v2/url?u=https-3A__en.wikipedia.org_wiki_ASCII&d=DwMFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=e86X_tk8tjXPbrbY_0i-7WvJzmij3UUzZzE0awNSlL0fEpHaKLIEWyoJ3diccoJ3&s=Ds3AyEefVfUhjBBwZYJ9CqhqtfyorOkZfENCpIZv7hU&e=>
>
> My comments:
> 1) "Lexicographic" - The phrase lexicographic order means alphabetical order. This will help me only when comparing:
> "a" < "b" # I suppose it returns true, bluntly because (1 < 2)? Position 1 - A, position 2 - B
> "b" < "a" # I suppose it returns false, bluntly because (2 < 1)? Position 2 - B, position 1 - A
>
> 2) Checking the alphabet or ASCII table won't help me understand why "a" < "A" returns true.
>
> 3) Letter "A" has smaller values compared to "a" (Checking oct, dec, hex values in https://en.wikipedia.org/wiki/ASCII<https://urldefense.proofpoint.com/v2/url?u=https-3A__en.wikipedia.org_wiki_ASCII&d=DwMFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=e86X_tk8tjXPbrbY_0i-7WvJzmij3UUzZzE0awNSlL0fEpHaKLIEWyoJ3diccoJ3&s=Ds3AyEefVfUhjBBwZYJ9CqhqtfyorOkZfENCpIZv7hU&e=>). On the other hand, if alphabetical order is different
> in country X the whole ASCII table is obsolete?
>
> 4) "Locale" - I understand the order of letters can be different between locales/alphabets. Still, it does not help with "a" < "A" comparison.
> Tried to use local() function in RStudio - did not get additional insight. Or is there any local table somewhere listing all symbols, lowercase, and uppercase symbols/letters?
>
> I understand it might be a rare occasion for this type of comparison, but I still want to understand the why. Also, some functions might return strings instead of numbers
> and then it might be helpful to understand what is really going on.
>
> If no one can answer how these comparisons fundamentally work should this kind of string comparison return NaN in R?
> Best regards,
> Kristjan
>
> On Thu, Apr 14, 2022 at 1:20 PM Ebert,Timothy Aaron <tebert at ufl.edu<mailto:tebert at ufl.edu>> wrote:
> For some issues it can be useful to learn by experiment. It gives you experience and shows you what sorts of error messages you can expect. In the console type things like this:
> a>B
> gives an error
> "a">"B"
> FALSE
>
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org<mailto:r-help-bounces at r-project.org>> On Behalf Of Bert Gunter
> Sent: Wednesday, April 13, 2022 10:00 PM
> To: Kristjan Kure <kristjan.kure.1 at gmail.com<mailto:kristjan.kure.1 at gmail.com>>
> Cc: R-help <r-help at r-project.org<mailto:r-help at r-project.org>>
> Subject: Re: [R] Symbol/String comparison in R
>
> [External Email]
>
> "I was not able to find answers to my questions (tried Google, Stack Overflow, etc). Please correct me if anything is wrong here."
>
> R has an extensive Help system. That should always be your first place to look. In this case, ?"<" (at the R prompt) brings you to the Help page for comparisons (as would ?Comparison, but only if the 'c" is in upper case, unfortunately). Among lots of other stuff, it says:
>
> "Comparison of strings in character vectors is lexicographic within the strings using the collating sequence of the locale in use: see locales." ... (+ lots more).
>
> Incidentally, rseek.org<https://urldefense.proofpoint.com/v2/url?u=http-3A__rseek.org&d=DwMFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=e86X_tk8tjXPbrbY_0i-7WvJzmij3UUzZzE0awNSlL0fEpHaKLIEWyoJ3diccoJ3&s=Wp6_AwvgFE91zeQ3W1r0TCGdfxdJhVtv4ZrlieWqeaA&e=> and rdrr.io<https://urldefense.proofpoint.com/v2/url?u=http-3A__rdrr.io&d=DwMFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=e86X_tk8tjXPbrbY_0i-7WvJzmij3UUzZzE0awNSlL0fEpHaKLIEWyoJ3diccoJ3&s=lmyiTc5RbfDL4dT_DLta_PeLG-6BghH_cmU2Zr01jtI&e=> are another couple of good places to look for R documentation.
>
>
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
>
> On Wed, Apr 13, 2022 at 5:10 PM Kristjan Kure <kristjan.kure.1 at gmail.com<mailto:kristjan.kure.1 at gmail.com>> wrote:
>>
>> Hi!
>>
>> Sorry, I am a beginner in R.
>>
>> I was not able to find answers to my questions (tried Google, Stack
>> Overflow, etc). Please correct me if anything is wrong here.
>>
>> When comparing symbols/strings in R - raw numeric values are compared
>> symbol by symbol starting from left? If raw numeric values are not
>> used is there an ASCII / Unicode table where symbols have
>> values/ranking/order and R compares those values?
>>
>> *2) Comparing symbols*
>> Letter "a" raw value is 61, letter "b" raw value is 62? Is this correct?
>>
>> # Raw value for "a" = 61
>> a_raw <- charToRaw("a")
>> a_raw
>>
>> # Raw value for "b" = 62
>> b_raw <- charToRaw("b")
>> b_raw
>>
>> # equals TRUE
>> "a" < "b"
>>
>> Ok, so 61 is less than 62 so it's TRUE. Is this correct?
>>
>> *3) Comparing strings #1*
>> "1040" <= "12000"
>>
>> raw_1040 <- charToRaw("1040")
>> raw_1040
>> #31 *30* (comparison happens with the second symbol) 34 30
>>
>> raw_12000 <- charToRaw("12000")
>> raw_12000
>> #31 *32* (comparison happens with the second symbol) 30 30 30
>>
>> The symbol in the second position is 30 and it's less than 32. Equals
>> to true. Is this correct?
>>
>> *4) Comparing strings #2*
>> "1040" <= "10000"
>>
>> raw_1040 <- charToRaw("1040")
>> raw_1040
>> #31 30 *34*  (comparison happens with third symbol) 30
>>
>> raw_10000 <- charToRaw("10000")
>> raw_10000
>> #31 30 *30*  (comparison happens with third symbol) 30 30
>>
>> The symbol in the third position is 34 is greater than 30. Equals to false.
>> Is this correct?
>>
>> *5) Problem - Why does this equal FALSE?* *"A" < "a"*
>>
>> 41 < 61 # FALSE?
>>
>> # Raw value for "A" = 41
>> A_raw <- charToRaw("A")
>> A_raw
>>
>> # Raw value for "a" = 61
>> a_raw <- charToRaw("a")
>> a_raw
>>
>> Why is capitalized "A" not less than lowercase "a"? Based on raw
>> values it should be. What am I missing here?
>>
>> Thanks
>> Kristjan
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
>> man_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAs
>> Rzsn7AkP-g&m=yz1V2nVJPZSQ9gn4HFUMVpUhZKZg_cwwu3HIvvS5jCkbCbdw_4DHCUxzb
>> 1Z4DKFB&s=7MT7GhFYxYsVOPG_ayqqA63o6SYSWKlMJYSq5BhbGow&e=
>> PLEASE do read the posting guide
>> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.or
>> g_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeA
>> sRzsn7AkP-g&m=yz1V2nVJPZSQ9gn4HFUMVpUhZKZg_cwwu3HIvvS5jCkbCbdw_4DHCUxz
>> b1Z4DKFB&s=-FIG1LH5_F3fqVDTUEvJUFpwYehrqtqS2P6YhyETQwY&e=
>> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=yz1V2nVJPZSQ9gn4HFUMVpUhZKZg_cwwu3HIvvS5jCkbCbdw_4DHCUxzb1Z4DKFB&s=7MT7GhFYxYsVOPG_ayqqA63o6SYSWKlMJYSq5BhbGow&e=
> PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=yz1V2nVJPZSQ9gn4HFUMVpUhZKZg_cwwu3HIvvS5jCkbCbdw_4DHCUxzb1Z4DKFB&s=-FIG1LH5_F3fqVDTUEvJUFpwYehrqtqS2P6YhyETQwY&e=
> and provide commented, minimal, self-contained, reproducible code.
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

---------------------------------------------------------------------------
Jeff Newmiller                        The     .....       .....  Go Live...
DCN:<jdnewmil at dcn.davis.ca.us>        Basics: ##.#.       ##.#.  Live Go...
                                       Live:   OO#.. Dead: OO#..  Playing
Research Engineer (Solar/Batteries            O.O#.       #.O#.  with
/Software/Embedded Controllers)               .OO#.       .OO#.  rocks...1k


From kr|@tj@n@kure@1 @end|ng |rom gm@||@com  Thu Apr 14 13:59:41 2022
From: kr|@tj@n@kure@1 @end|ng |rom gm@||@com (Kristjan Kure)
Date: Thu, 14 Apr 2022 14:59:41 +0300
Subject: [R] Symbol/String comparison in R
In-Reply-To: <BN6PR2201MB15534C950F9C02E97CE16084CFEF9@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>
 <CAGxFJbQfMvJ17PM5-QjKMCJrD4mmTcT8HGDGRK8jeoDUDm=CWg@mail.gmail.com>
 <BN6PR2201MB15534C950F9C02E97CE16084CFEF9@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <CAJ_7LVtGw-kPUN+gAG6nwrYpFkvH2XQKvQ+W9FAcP04Bz6F_uA@mail.gmail.com>

Thank you for your response. This is the current status:

*I am looking fundamental why for these comparisons:*
"1040" <= "12000" # returns true
"1040" <= "10000" # returns false
"a" < "A" # returns true
"A" < "a" # returns false
"raining" <= "raining x" #true

*Feedback so far:*
1) Bert: "lexicographic", "locale"
2) Timothy: https://en.wikipedia.org/wiki/ASCII

*My comments:*
1) "Lexicographic" - The phrase lexicographic order means alphabetical
order. This will help me only when comparing:
"a" < "b" # I suppose it returns true, bluntly because (1 < 2)? Position 1
- A, position 2 - B
"b" < "a" # I suppose it returns false, bluntly because (2 < 1)? Position 2
- B, position 1 - A

2) Checking the alphabet or ASCII table won't help me understand why "a" <
"A" returns true.

3) Letter "A" has smaller values compared to "a" (Checking oct, dec, hex
values in https://en.wikipedia.org/wiki/ASCII). On the other hand, if
alphabetical order is different
in country X the whole ASCII table is obsolete?

4) "Locale" - I understand the order of letters can be different between
locales/alphabets. Still, it does not help with "a" < "A" comparison.
Tried to use local() function in RStudio - did not get additional insight.
Or is there any local table somewhere listing all symbols, lowercase, and
uppercase symbols/letters?

I understand it might be a rare occasion for this type of comparison, but I
still want to understand the why. Also, some functions might return strings
instead of numbers
and then it might be helpful to understand what is really going on.

*If no one can answer how these comparisons fundamentally work should this
kind of string comparison return NaN in R?*

Best regards,
Kristjan

On Thu, Apr 14, 2022 at 1:20 PM Ebert,Timothy Aaron <tebert at ufl.edu> wrote:

> For some issues it can be useful to learn by experiment. It gives you
> experience and shows you what sorts of error messages you can expect. In
> the console type things like this:
> a>B
> gives an error
> "a">"B"
> FALSE
>
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Bert Gunter
> Sent: Wednesday, April 13, 2022 10:00 PM
> To: Kristjan Kure <kristjan.kure.1 at gmail.com>
> Cc: R-help <r-help at r-project.org>
> Subject: Re: [R] Symbol/String comparison in R
>
> [External Email]
>
> "I was not able to find answers to my questions (tried Google, Stack
> Overflow, etc). Please correct me if anything is wrong here."
>
> R has an extensive Help system. That should always be your first place to
> look. In this case, ?"<" (at the R prompt) brings you to the Help page for
> comparisons (as would ?Comparison, but only if the 'c" is in upper case,
> unfortunately). Among lots of other stuff, it says:
>
> "Comparison of strings in character vectors is lexicographic within the
> strings using the collating sequence of the locale in use: see locales."
> ... (+ lots more).
>
> Incidentally, rseek.org and rdrr.io are another couple of good places to
> look for R documentation.
>
>
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along and
> sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along and
> sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
>
> On Wed, Apr 13, 2022 at 5:10 PM Kristjan Kure <kristjan.kure.1 at gmail.com>
> wrote:
> >
> > Hi!
> >
> > Sorry, I am a beginner in R.
> >
> > I was not able to find answers to my questions (tried Google, Stack
> > Overflow, etc). Please correct me if anything is wrong here.
> >
> > When comparing symbols/strings in R - raw numeric values are compared
> > symbol by symbol starting from left? If raw numeric values are not
> > used is there an ASCII / Unicode table where symbols have
> > values/ranking/order and R compares those values?
> >
> > *2) Comparing symbols*
> > Letter "a" raw value is 61, letter "b" raw value is 62? Is this correct?
> >
> > # Raw value for "a" = 61
> > a_raw <- charToRaw("a")
> > a_raw
> >
> > # Raw value for "b" = 62
> > b_raw <- charToRaw("b")
> > b_raw
> >
> > # equals TRUE
> > "a" < "b"
> >
> > Ok, so 61 is less than 62 so it's TRUE. Is this correct?
> >
> > *3) Comparing strings #1*
> > "1040" <= "12000"
> >
> > raw_1040 <- charToRaw("1040")
> > raw_1040
> > #31 *30* (comparison happens with the second symbol) 34 30
> >
> > raw_12000 <- charToRaw("12000")
> > raw_12000
> > #31 *32* (comparison happens with the second symbol) 30 30 30
> >
> > The symbol in the second position is 30 and it's less than 32. Equals
> > to true. Is this correct?
> >
> > *4) Comparing strings #2*
> > "1040" <= "10000"
> >
> > raw_1040 <- charToRaw("1040")
> > raw_1040
> > #31 30 *34*  (comparison happens with third symbol) 30
> >
> > raw_10000 <- charToRaw("10000")
> > raw_10000
> > #31 30 *30*  (comparison happens with third symbol) 30 30
> >
> > The symbol in the third position is 34 is greater than 30. Equals to
> false.
> > Is this correct?
> >
> > *5) Problem - Why does this equal FALSE?* *"A" < "a"*
> >
> > 41 < 61 # FALSE?
> >
> > # Raw value for "A" = 41
> > A_raw <- charToRaw("A")
> > A_raw
> >
> > # Raw value for "a" = 61
> > a_raw <- charToRaw("a")
> > a_raw
> >
> > Why is capitalized "A" not less than lowercase "a"? Based on raw
> > values it should be. What am I missing here?
> >
> > Thanks
> > Kristjan
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
> > man_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAs
> > Rzsn7AkP-g&m=yz1V2nVJPZSQ9gn4HFUMVpUhZKZg_cwwu3HIvvS5jCkbCbdw_4DHCUxzb
> > 1Z4DKFB&s=7MT7GhFYxYsVOPG_ayqqA63o6SYSWKlMJYSq5BhbGow&e=
> > PLEASE do read the posting guide
> > https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.or
> > g_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeA
> > sRzsn7AkP-g&m=yz1V2nVJPZSQ9gn4HFUMVpUhZKZg_cwwu3HIvvS5jCkbCbdw_4DHCUxz
> > b1Z4DKFB&s=-FIG1LH5_F3fqVDTUEvJUFpwYehrqtqS2P6YhyETQwY&e=
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=yz1V2nVJPZSQ9gn4HFUMVpUhZKZg_cwwu3HIvvS5jCkbCbdw_4DHCUxzb1Z4DKFB&s=7MT7GhFYxYsVOPG_ayqqA63o6SYSWKlMJYSq5BhbGow&e=
> PLEASE do read the posting guide
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=yz1V2nVJPZSQ9gn4HFUMVpUhZKZg_cwwu3HIvvS5jCkbCbdw_4DHCUxzb1Z4DKFB&s=-FIG1LH5_F3fqVDTUEvJUFpwYehrqtqS2P6YhyETQwY&e=
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From kr|@tj@n@kure@1 @end|ng |rom gm@||@com  Thu Apr 14 17:33:58 2022
From: kr|@tj@n@kure@1 @end|ng |rom gm@||@com (Kristjan Kure)
Date: Thu, 14 Apr 2022 18:33:58 +0300
Subject: [R] Symbol/String comparison in R
In-Reply-To: <074d6a6f-4fe7-6c9e-7059-585f492bbb6f@sapo.pt>
References: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>
 <074d6a6f-4fe7-6c9e-7059-585f492bbb6f@sapo.pt>
Message-ID: <CAJ_7LVswyHkvcnV_TtCEn-0VGWcxurHih4Ww=w8p6CRO0=yhEQ@mail.gmail.com>

Hi Rui

Thank you for the code snippet.

1) How do you find your "Portuguese_Portugal.1252" symbols table now?
Is it this https://en.wikipedia.org/wiki/Windows-1252?

2) What attributes and values do you check to validate the end result?
I see there is a section "Codepage layout" and I can find "A" and "a"
symbols.

What values on that table tell you "A" is bigger than "a"?
"A" < "a" # returns FALSE
"A" > "a" # returns TRUE

PS! My locale is Estonian_Estonia.1257

Regards,
Kristjan

On Thu, Apr 14, 2022 at 5:05 PM Rui Barradas <ruipbarradas at sapo.pt> wrote:

> Hello,
>
> This is a locale issue, you are counting on the ASCII table codes but
> that's only valid for the "C" locale.
>
> old_loc <- Sys.getlocale("LC_COLLATE")
>
> "A" < "a"
> #> [1] FALSE
> "A" > "a"
> #> [1] TRUE
>
> Sys.setlocale("LC_COLLATE", locale = "C")
> #> [1] "C"
>
> "A" < "a"
> #> [1] TRUE
> "A" > "a"
> #> [1] FALSE
>
> Sys.setlocale("LC_COLLATE", old_loc)
> #> [1] "Portuguese_Portugal.1252"
>
>
> Hope this helps,
>
> Rui Barradas
>
> ?s 15:06 de 13/04/2022, Kristjan Kure escreveu:
> > Hi!
> >
> > Sorry, I am a beginner in R.
> >
> > I was not able to find answers to my questions (tried Google, Stack
> > Overflow, etc). Please correct me if anything is wrong here.
> >
> > When comparing symbols/strings in R - raw numeric values are compared
> > symbol by symbol starting from left? If raw numeric values are not used
> is
> > there an ASCII / Unicode table where symbols have values/ranking/order
> and
> > R compares those values?
> >
> > *2) Comparing symbols*
> > Letter "a" raw value is 61, letter "b" raw value is 62? Is this correct?
> >
> > # Raw value for "a" = 61
> > a_raw <- charToRaw("a")
> > a_raw
> >
> > # Raw value for "b" = 62
> > b_raw <- charToRaw("b")
> > b_raw
> >
> > # equals TRUE
> > "a" < "b"
> >
> > Ok, so 61 is less than 62 so it's TRUE. Is this correct?
> >
> > *3) Comparing strings #1*
> > "1040" <= "12000"
> >
> > raw_1040 <- charToRaw("1040")
> > raw_1040
> > #31 *30* (comparison happens with the second symbol) 34 30
> >
> > raw_12000 <- charToRaw("12000")
> > raw_12000
> > #31 *32* (comparison happens with the second symbol) 30 30 30
> >
> > The symbol in the second position is 30 and it's less than 32. Equals to
> > true. Is this correct?
> >
> > *4) Comparing strings #2*
> > "1040" <= "10000"
> >
> > raw_1040 <- charToRaw("1040")
> > raw_1040
> > #31 30 *34*  (comparison happens with third symbol) 30
> >
> > raw_10000 <- charToRaw("10000")
> > raw_10000
> > #31 30 *30*  (comparison happens with third symbol) 30 30
> >
> > The symbol in the third position is 34 is greater than 30. Equals to
> false.
> > Is this correct?
> >
> > *5) Problem - Why does this equal FALSE?*
> > *"A" < "a"*
> >
> > 41 < 61 # FALSE?
> >
> > # Raw value for "A" = 41
> > A_raw <- charToRaw("A")
> > A_raw
> >
> > # Raw value for "a" = 61
> > a_raw <- charToRaw("a")
> > a_raw
> >
> > Why is capitalized "A" not less than lowercase "a"? Based on raw values
> it
> > should be. What am I missing here?
> >
> > Thanks
> > Kristjan
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Apr 14 21:01:31 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 14 Apr 2022 20:01:31 +0100
Subject: [R] Symbol/String comparison in R
In-Reply-To: <CAJ_7LVswyHkvcnV_TtCEn-0VGWcxurHih4Ww=w8p6CRO0=yhEQ@mail.gmail.com>
References: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>
 <074d6a6f-4fe7-6c9e-7059-585f492bbb6f@sapo.pt>
 <CAJ_7LVswyHkvcnV_TtCEn-0VGWcxurHih4Ww=w8p6CRO0=yhEQ@mail.gmail.com>
Message-ID: <6a02e922-b11e-edf8-abd2-f1b2b1849e37@sapo.pt>

Hello,

1) The best I could find on lower case/upper case is [1];
The Wikipedia page you link to is about a code page and the collating 
sequence is the same as ASCII so no, that's not it.

2) In the cp1252 table "A" < "a", it follows the numeric order 0x31 < 
0x41. But what R is using is the locale LC_COLLATE setting, not the "C" 
one.

How to validate the end results? The best way is to check the current 
setting, with Sys.getlocale.



[1] 
https://books.google.pt/books?id=GkajBQAAQBAJ&pg=PA259&lpg=PA259&dq=collating+sequence+portuguese&source=bl&ots=fVnUYHz0ev&sig=ACfU3U3xjpJfPNcWEfvwb_2nScYb89CeOw&hl=pt-PT&sa=X&ved=2ahUKEwiAoNTW-JP3AhVI1xoKHXT-C4oQ6AF6BAgUEAM#v=onepage&q=collating%20sequence%20portuguese&f=false


Hope this helps,

Rui Barradas

?s 16:33 de 14/04/2022, Kristjan Kure escreveu:
> Hi Rui
> 
> Thank you for the code snippet.
> 
> 1) How do you find your "Portuguese_Portugal.1252" symbols table now?
> Is it this https://en.wikipedia.org/wiki/Windows-1252 
> <https://en.wikipedia.org/wiki/Windows-1252>?
> 
> 2) What attributes and values do you check to validate the end result?
> I see there is a section "Codepage layout" and I can find "A" and "a" 
> symbols.
> 
> What values on that table tell you "A" is bigger than "a"?
> "A" < "a" # returns FALSE
> "A" > "a" # returns TRUE
> 
> PS! My locale is Estonian_Estonia.1257
> 
> Regards,
> Kristjan
> 
> On Thu, Apr 14, 2022 at 5:05 PM Rui Barradas <ruipbarradas at sapo.pt 
> <mailto:ruipbarradas at sapo.pt>> wrote:
> 
>     Hello,
> 
>     This is a locale issue, you are counting on the ASCII table codes but
>     that's only valid for the "C" locale.
> 
>     old_loc <- Sys.getlocale("LC_COLLATE")
> 
>     "A" < "a"
>     #> [1] FALSE
>     "A" > "a"
>     #> [1] TRUE
> 
>     Sys.setlocale("LC_COLLATE", locale = "C")
>     #> [1] "C"
> 
>     "A" < "a"
>     #> [1] TRUE
>     "A" > "a"
>     #> [1] FALSE
> 
>     Sys.setlocale("LC_COLLATE", old_loc)
>     #> [1] "Portuguese_Portugal.1252"
> 
> 
>     Hope this helps,
> 
>     Rui Barradas
> 
>     ?s 15:06 de 13/04/2022, Kristjan Kure escreveu:
>      > Hi!
>      >
>      > Sorry, I am a beginner in R.
>      >
>      > I was not able to find answers to my questions (tried Google, Stack
>      > Overflow, etc). Please correct me if anything is wrong here.
>      >
>      > When comparing symbols/strings in R - raw numeric values are compared
>      > symbol by symbol starting from left? If raw numeric values are
>     not used is
>      > there an ASCII / Unicode table where symbols have
>     values/ranking/order and
>      > R compares those values?
>      >
>      > *2) Comparing symbols*
>      > Letter "a" raw value is 61, letter "b" raw value is 62? Is this
>     correct?
>      >
>      > # Raw value for "a" = 61
>      > a_raw <- charToRaw("a")
>      > a_raw
>      >
>      > # Raw value for "b" = 62
>      > b_raw <- charToRaw("b")
>      > b_raw
>      >
>      > # equals TRUE
>      > "a" < "b"
>      >
>      > Ok, so 61 is less than 62 so it's TRUE. Is this correct?
>      >
>      > *3) Comparing strings #1*
>      > "1040" <= "12000"
>      >
>      > raw_1040 <- charToRaw("1040")
>      > raw_1040
>      > #31 *30* (comparison happens with the second symbol) 34 30
>      >
>      > raw_12000 <- charToRaw("12000")
>      > raw_12000
>      > #31 *32* (comparison happens with the second symbol) 30 30 30
>      >
>      > The symbol in the second position is 30 and it's less than 32.
>     Equals to
>      > true. Is this correct?
>      >
>      > *4) Comparing strings #2*
>      > "1040" <= "10000"
>      >
>      > raw_1040 <- charToRaw("1040")
>      > raw_1040
>      > #31 30 *34*? (comparison happens with third symbol) 30
>      >
>      > raw_10000 <- charToRaw("10000")
>      > raw_10000
>      > #31 30 *30*? (comparison happens with third symbol) 30 30
>      >
>      > The symbol in the third position is 34 is greater than 30. Equals
>     to false.
>      > Is this correct?
>      >
>      > *5) Problem - Why does this equal FALSE?*
>      > *"A" < "a"*
>      >
>      > 41 < 61 # FALSE?
>      >
>      > # Raw value for "A" = 41
>      > A_raw <- charToRaw("A")
>      > A_raw
>      >
>      > # Raw value for "a" = 61
>      > a_raw <- charToRaw("a")
>      > a_raw
>      >
>      > Why is capitalized "A" not less than lowercase "a"? Based on raw
>     values it
>      > should be. What am I missing here?
>      >
>      > Thanks
>      > Kristjan
>      >
>      >? ? ? ?[[alternative HTML version deleted]]
>      >
>      > ______________________________________________
>      > R-help at r-project.org <mailto:R-help at r-project.org> mailing list
>     -- To UNSUBSCRIBE and more, see
>      > https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>      > PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>      > and provide commented, minimal, self-contained, reproducible code.
>


From r@oknz @end|ng |rom gm@||@com  Fri Apr 15 05:05:16 2022
From: r@oknz @end|ng |rom gm@||@com (Richard O'Keefe)
Date: Fri, 15 Apr 2022 15:05:16 +1200
Subject: [R] Symbol/String comparison in R
In-Reply-To: <B6EFD588-C064-4C9D-982B-0CA74559BD07@dcn.davis.ca.us>
References: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>
 <BN6PR2201MB15539E14C13A43B753D756EDCFEF9@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <CABcYAdKgxg-Kib2r62tScO9OoH3_gaY+Jd1KEEXUrFo0pj2EwA@mail.gmail.com>
 <B6EFD588-C064-4C9D-982B-0CA74559BD07@dcn.davis.ca.us>
Message-ID: <CABcYAd+8muJZ9uj-45qvi81-1kd0Ms8R_yb3jCGyBtfyHZDweA@mail.gmail.com>

First off, while it is true that 16r61 = 10r97,
there is nothing about the interaction
> charToRaw("a")
61
that suggests to the unwary that 61 does not mean
six tens and one unit.  In fact that 61 isn't even
a number, though it looks like one.  It's a "raw".

And that's the problem.  The whole point of "raws"
is to forget how a string was encoded (that is, to
forget what it MEANS), and compare it DIFFERENTLY
from the way it would be compared as a string.  So
it really has no relevance to how string collation
is done.

There is good reason to use "raws", and that is when
you are interfacing with code written in some other
language that for some reason wants byte sequences.

As for the default collation order and other local aspects,
R is expected to pick that up from the environment.
If I have
   l=en_NZ.iso88591
   export LC_COLLATE=$l
   export LC_NUMERIC=$l
then when I run R, I expect it to take en_NZ.iso88591
as the locale for collation (it does) and for numbers
(it doesn't, it insists on LC_NUMERIC=C).

The help for ?"<" is quite clear that collation for
UTF-8 is *not* byte-by-byte but by Unicode code-point.
Now if you are given *valid* UTF-8 in which each
code-point is represented by the smallest number of
bytes possible, byte-by-byte and code-point-by-code-
point should agree, but for quite a bit of "UTF-8" out
there (such as the stuff Java used to generate) they
can be teased apart.

Alexander Pope's advice is good counsel here.

A little learning is a dangerous thing ;
Drink deep, or taste not the Pierian spring :
There shallow draughts intoxicate the brain,
And drinking largely sobers us again.
...
While from the bounded level of our mind
Short views we take, nor see the lengths behind,
But, more advanced, behold with strange surprise
New distant scenes of endless science rise !
...

If you really want to understand this stuff,
start with "Unicode Demystified", go on to
"The Unicode Standard 14.0.0"
https://www.unicode.org/versions/Unicode14.0.0/
then over to ISO 14651
https://en.wikipedia.org/wiki/ISO/IEC_14651
then to the Unicode Collation Algorithm
and The International Components for Unicode.
Don't forget to check out the Unicode CLDR
(Common Locale Data Repository) version 41
https://home.unicode.org/unicode-cldr-version-41-released/

Or you could let R get on with it and study
some more statistics instead.

On Fri, 15 Apr 2022 at 02:24, Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
wrote:

> While the advice that collation order is not necessarily determined by
> encoding is helpful, the advice suggesting that charToRaw is to be always
> avoided rings false to me, since 61 hexadecimal is the same as 97 decimal.
>
> I am hoping someone will come along and offer useful input like where to
> find the actual collation order implemented by the now-default
> Sys.getlocale("LC_COLATE")="C.UTF-8", since I was under the impression that
> this particular collation was in fact supposed to collate according to the
> numerical magnitude of the UTF-8 code points but it does not appear to do
> so.
>
> On April 14, 2022 4:25:17 AM PDT, Richard O'Keefe <raoknz at gmail.com>
> wrote:
> >To the original poster: don't even think about
> >charToRaw.  For one thing, the integer code that
> >corresponds to "a" can be found thus:
> >> library(gtools)
> >> asc("a")
> >97
> >and the answer is (predictably) 97, not 61.
> >
> >> ?"<"
> >...
> >     Comparison of strings in character vectors is lexicographic within
> >     the strings using the collating sequence of the locale in use: see
> >     'locales'.  The collating sequence of locales such as 'en_US' is
> >     normally different from 'C' (which should use ASCII) and can be
> >     surprising.  Beware of making _any_ assumptions about the
> >     collation order
> >...
> >
> >In a UNIX environment, the collating order R uses will
> >normally match the collating order that the system
> >sort(1) command uses.  This is also the order that is
> >used by the strcoll(3) library function.  There is an
> >ISO standard, not for how to compare strings, but for
> >specifying the rules for how to compare strings.  The
> >rules can be amazingly elaborate requiring up to seven
> >different passes and not all of them in the same direction.
> >
> >ORIGINALLY the order was lexicographical left to right
> >by byte values (like the strcmp(3) library function) but
> >in a world of about 6000 languages and an amazing number
> >of scripts, that just doesn't match what people actually
> >want to do.
> >
> >> icuGetCollate()
> >will tell you what collation rules R is following.
> >> ?icuGetCollate
> >will not so much tell you more than you wanted to know
> >about collation as hint at it.
> >
> >These days, with Unicode and internationalisation,
> >text encoding and collation are just insanely complex.
> >R goes to a lot of trouble to hide this from you.
> >LET IT.
> >
> >
> >
> >On Thu, 14 Apr 2022 at 13:38, Ebert,Timothy Aaron <tebert at ufl.edu> wrote:
> >
> >> https://en.wikipedia.org/wiki/ASCII
> >> There is a table towards the end of the document. Some of the other
> pieces
> >> may be of interest and/or relevant.
> >>
> >> Tim
> >>
> >> -----Original Message-----
> >> From: R-help <r-help-bounces at r-project.org> On Behalf Of Kristjan Kure
> >> Sent: Wednesday, April 13, 2022 10:06 AM
> >> To: r-help at r-project.org
> >> Subject: [R] Symbol/String comparison in R
> >>
> >> [External Email]
> >>
> >> Hi!
> >>
> >> Sorry, I am a beginner in R.
> >>
> >> I was not able to find answers to my questions (tried Google, Stack
> >> Overflow, etc). Please correct me if anything is wrong here.
> >>
> >> When comparing symbols/strings in R - raw numeric values are compared
> >> symbol by symbol starting from left? If raw numeric values are not used
> is
> >> there an ASCII / Unicode table where symbols have values/ranking/order
> and
> >> R compares those values?
> >>
> >> *2) Comparing symbols*
> >> Letter "a" raw value is 61, letter "b" raw value is 62? Is this correct?
> >>
> >> # Raw value for "a" = 61
> >> a_raw <- charToRaw("a")
> >> a_raw
> >>
> >> # Raw value for "b" = 62
> >> b_raw <- charToRaw("b")
> >> b_raw
> >>
> >> # equals TRUE
> >> "a" < "b"
> >>
> >> Ok, so 61 is less than 62 so it's TRUE. Is this correct?
> >>
> >> *3) Comparing strings #1*
> >> "1040" <= "12000"
> >>
> >> raw_1040 <- charToRaw("1040")
> >> raw_1040
> >> #31 *30* (comparison happens with the second symbol) 34 30
> >>
> >> raw_12000 <- charToRaw("12000")
> >> raw_12000
> >> #31 *32* (comparison happens with the second symbol) 30 30 30
> >>
> >> The symbol in the second position is 30 and it's less than 32. Equals to
> >> true. Is this correct?
> >>
> >> *4) Comparing strings #2*
> >> "1040" <= "10000"
> >>
> >> raw_1040 <- charToRaw("1040")
> >> raw_1040
> >> #31 30 *34*  (comparison happens with third symbol) 30
> >>
> >> raw_10000 <- charToRaw("10000")
> >> raw_10000
> >> #31 30 *30*  (comparison happens with third symbol) 30 30
> >>
> >> The symbol in the third position is 34 is greater than 30. Equals to
> false.
> >> Is this correct?
> >>
> >> *5) Problem - Why does this equal FALSE?* *"A" < "a"*
> >>
> >> 41 < 61 # FALSE?
> >>
> >> # Raw value for "A" = 41
> >> A_raw <- charToRaw("A")
> >> A_raw
> >>
> >> # Raw value for "a" = 61
> >> a_raw <- charToRaw("a")
> >> a_raw
> >>
> >> Why is capitalized "A" not less than lowercase "a"? Based on raw values
> it
> >> should be. What am I missing here?
> >>
> >> Thanks
> >> Kristjan
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=9E-P8HOWO0s4h1p__tW4o8QGtge3bJ9VUJEDH-e-U_8OKRu2p1zazebKjPltKrWM&s=rhYKCkMRBFMzOVf8rVaRiO1Puh-rTSWAS8P6hoSzdgc&e=
> >> PLEASE do read the posting guide
> >>
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=9E-P8HOWO0s4h1p__tW4o8QGtge3bJ9VUJEDH-e-U_8OKRu2p1zazebKjPltKrWM&s=fI_1ZAYJFp1nrJkOV4i4ueqf4o1MD1gKHzb6AyciJUc&e=
> >> and provide commented, minimal, self-contained, reproducible code.
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> >> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> >______________________________________________
> >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >https://stat.ethz.ch/mailman/listinfo/r-help
> >PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >and provide commented, minimal, self-contained, reproducible code.
>
> --
> Sent from my phone. Please excuse my brevity.
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Fri Apr 15 05:26:59 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Fri, 15 Apr 2022 04:26:59 +0100
Subject: [R] Symbol/String comparison in R
In-Reply-To: <CAJ_7LVsw+rJqx4bmwr9a-MsvO4SPob9G1Dmquy3bDes=FanD-w@mail.gmail.com>
References: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>
 <074d6a6f-4fe7-6c9e-7059-585f492bbb6f@sapo.pt>
 <CAJ_7LVswyHkvcnV_TtCEn-0VGWcxurHih4Ww=w8p6CRO0=yhEQ@mail.gmail.com>
 <6a02e922-b11e-edf8-abd2-f1b2b1849e37@sapo.pt>
 <CAJ_7LVsw+rJqx4bmwr9a-MsvO4SPob9G1Dmquy3bDes=FanD-w@mail.gmail.com>
Message-ID: <bbaec6bb-bec8-642a-64c4-0df8e97b711b@sapo.pt>

Hello,

Inline.

?s 22:09 de 14/04/2022, Kristjan Kure escreveu:
> Thank you, Rui. Not sure I got everything right, but here it is:
> 
> *current_loc <- Sys.getlocale("LC_COLLATE")*
> #> [1] "Estonian_Estonia.1257"
> 
> "A" < "a"
> #41 < 61
> #> [1] FALSE
> raw_A <- charToRaw("A") #41
> raw_a <- charToRaw("a") #61
> # Not OK - should be TRUE (41 is less than 61)
> 
> "A" > "a"
> #41 > 61
> #> [1] TRUE
> raw_A <- charToRaw("A") #41
> raw_a <- charToRaw("a") #61
> # Not OK - should be FALSE (41 is not bigger than 61)
> 
> *Sys.setlocale("LC_COLLATE", locale = "C")*
> 
> "A" < "a"
> #41 < 61
> #> [1] TRUE
> raw_A <- charToRaw("A") #41
> raw_a <- charToRaw("a") #61
> 
> # OK - (41 is less than 61)
> 
> "A" > "a"
> #41 > 61
> #> [1] FALSE
> raw_A <- charToRaw("A") #41
> raw_a <- charToRaw("a") #61
> 
> # OK - (41 is not bigger than 61)
> 
> *Sys.setlocale("LC_COLLATE", current_loc)*
> *
> *
> *Conclusion: Comparing strings using charToRaw() only works correctly 
> with locale = C?*
> *

You are still mistaking the locale with the ASCII code (raw).
Windows codepages like 1252 or your 1257 are supersets of the ASCII code 
and the ASCII hex codes make a lot of sense. The upper case and lower 
letters are 2^5 == 32 == 0x20 apart so set the 5th bit to go from upper 
to lower case:

"A": 0100 0001 == 0x41
"a": 0110 0001 == 0x61

"B": 0100 0010
"b": 0110 0010

etc.

This only relates to human alphabets and languages because its an 
attempt to make an electronic code usable to transmit/record/retrieve 
text in human readable way. But each language's lexicographic order need 
not follow this encoding's order even if it's what is used to record it 
electronically.
In the examples below you'll see that to change the locale does not 
change the numeric codes.

Comparing strings using charToRaw() only works correctly if what you 
want is to compare codes, not letters (in the sense of human writing).


old_loc <- Sys.getlocale("LC_COLLATE")

# hexadecimal base integers
raw_A <- charToRaw("A") # 0x41
raw_a <- charToRaw("a") # 0x61

raw_A < raw_a
#> [1] TRUE
raw_A > raw_a
#> [1] FALSE

as.integer(raw_A)
#> [1] 65
as.integer(raw_a)
#> [1] 97

Sys.setlocale("LC_COLLATE", locale = "C")
#> [1] "C"

(C_raw_A <- charToRaw("A")) # 0x41
#> [1] 41
(C_raw_a <- charToRaw("a")) # 0x61
#> [1] 61
C_raw_A < C_raw_a
#> [1] TRUE
C_raw_A > C_raw_a
#> [1] FALSE

identical(raw_A, C_raw_A)
#> [1] TRUE
identical(raw_a, C_raw_a)
#> [1] TRUE

Sys.setlocale("LC_COLLATE", old_loc)
#> [1] "Portuguese_Portugal.1252"


Hope this helps,

Rui Barradas


> *
> Regards,
> Kristjan*
> *
> *
> *
> *
> *
> 
> On Thu, Apr 14, 2022 at 10:01 PM Rui Barradas <ruipbarradas at sapo.pt 
> <mailto:ruipbarradas at sapo.pt>> wrote:
> 
>     Hello,
> 
>     1) The best I could find on lower case/upper case is [1];
>     The Wikipedia page you link to is about a code page and the collating
>     sequence is the same as ASCII so no, that's not it.
> 
>     2) In the cp1252 table "A" < "a", it follows the numeric order 0x31 <
>     0x41. But what R is using is the locale LC_COLLATE setting, not the "C"
>     one.
> 
>     How to validate the end results? The best way is to check the current
>     setting, with Sys.getlocale.
> 
> 
> 
>     [1]
>     https://books.google.pt/books?id=GkajBQAAQBAJ&pg=PA259&lpg=PA259&dq=collating+sequence+portuguese&source=bl&ots=fVnUYHz0ev&sig=ACfU3U3xjpJfPNcWEfvwb_2nScYb89CeOw&hl=pt-PT&sa=X&ved=2ahUKEwiAoNTW-JP3AhVI1xoKHXT-C4oQ6AF6BAgUEAM#v=onepage&q=collating%20sequence%20portuguese&f=false
>     <https://books.google.pt/books?id=GkajBQAAQBAJ&pg=PA259&lpg=PA259&dq=collating+sequence+portuguese&source=bl&ots=fVnUYHz0ev&sig=ACfU3U3xjpJfPNcWEfvwb_2nScYb89CeOw&hl=pt-PT&sa=X&ved=2ahUKEwiAoNTW-JP3AhVI1xoKHXT-C4oQ6AF6BAgUEAM#v=onepage&q=collating%20sequence%20portuguese&f=false>
> 
> 
>     Hope this helps,
> 
>     Rui Barradas
> 
>     ?s 16:33 de 14/04/2022, Kristjan Kure escreveu:
>      > Hi Rui
>      >
>      > Thank you for the code snippet.
>      >
>      > 1) How do you find your "Portuguese_Portugal.1252" symbols table now?
>      > Is it this https://en.wikipedia.org/wiki/Windows-1252
>     <https://en.wikipedia.org/wiki/Windows-1252>
>      > <https://en.wikipedia.org/wiki/Windows-1252
>     <https://en.wikipedia.org/wiki/Windows-1252>>?
>      >
>      > 2) What attributes and values do you check to validate the end
>     result?
>      > I see there is a section "Codepage layout" and I can find "A" and
>     "a"
>      > symbols.
>      >
>      > What values on that table tell you "A" is bigger than "a"?
>      > "A" < "a" # returns FALSE
>      > "A" > "a" # returns TRUE
>      >
>      > PS! My locale is Estonian_Estonia.1257
>      >
>      > Regards,
>      > Kristjan
>      >
>      > On Thu, Apr 14, 2022 at 5:05 PM Rui Barradas
>     <ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>
>      > <mailto:ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>>> wrote:
>      >
>      >? ? ?Hello,
>      >
>      >? ? ?This is a locale issue, you are counting on the ASCII table
>     codes but
>      >? ? ?that's only valid for the "C" locale.
>      >
>      >? ? ?old_loc <- Sys.getlocale("LC_COLLATE")
>      >
>      >? ? ?"A" < "a"
>      >? ? ?#> [1] FALSE
>      >? ? ?"A" > "a"
>      >? ? ?#> [1] TRUE
>      >
>      >? ? ?Sys.setlocale("LC_COLLATE", locale = "C")
>      >? ? ?#> [1] "C"
>      >
>      >? ? ?"A" < "a"
>      >? ? ?#> [1] TRUE
>      >? ? ?"A" > "a"
>      >? ? ?#> [1] FALSE
>      >
>      >? ? ?Sys.setlocale("LC_COLLATE", old_loc)
>      >? ? ?#> [1] "Portuguese_Portugal.1252"
>      >
>      >
>      >? ? ?Hope this helps,
>      >
>      >? ? ?Rui Barradas
>      >
>      >? ? ??s 15:06 de 13/04/2022, Kristjan Kure escreveu:
>      >? ? ? > Hi!
>      >? ? ? >
>      >? ? ? > Sorry, I am a beginner in R.
>      >? ? ? >
>      >? ? ? > I was not able to find answers to my questions (tried
>     Google, Stack
>      >? ? ? > Overflow, etc). Please correct me if anything is wrong here.
>      >? ? ? >
>      >? ? ? > When comparing symbols/strings in R - raw numeric values
>     are compared
>      >? ? ? > symbol by symbol starting from left? If raw numeric values are
>      >? ? ?not used is
>      >? ? ? > there an ASCII / Unicode table where symbols have
>      >? ? ?values/ranking/order and
>      >? ? ? > R compares those values?
>      >? ? ? >
>      >? ? ? > *2) Comparing symbols*
>      >? ? ? > Letter "a" raw value is 61, letter "b" raw value is 62? Is
>     this
>      >? ? ?correct?
>      >? ? ? >
>      >? ? ? > # Raw value for "a" = 61
>      >? ? ? > a_raw <- charToRaw("a")
>      >? ? ? > a_raw
>      >? ? ? >
>      >? ? ? > # Raw value for "b" = 62
>      >? ? ? > b_raw <- charToRaw("b")
>      >? ? ? > b_raw
>      >? ? ? >
>      >? ? ? > # equals TRUE
>      >? ? ? > "a" < "b"
>      >? ? ? >
>      >? ? ? > Ok, so 61 is less than 62 so it's TRUE. Is this correct?
>      >? ? ? >
>      >? ? ? > *3) Comparing strings #1*
>      >? ? ? > "1040" <= "12000"
>      >? ? ? >
>      >? ? ? > raw_1040 <- charToRaw("1040")
>      >? ? ? > raw_1040
>      >? ? ? > #31 *30* (comparison happens with the second symbol) 34 30
>      >? ? ? >
>      >? ? ? > raw_12000 <- charToRaw("12000")
>      >? ? ? > raw_12000
>      >? ? ? > #31 *32* (comparison happens with the second symbol) 30 30 30
>      >? ? ? >
>      >? ? ? > The symbol in the second position is 30 and it's less than 32.
>      >? ? ?Equals to
>      >? ? ? > true. Is this correct?
>      >? ? ? >
>      >? ? ? > *4) Comparing strings #2*
>      >? ? ? > "1040" <= "10000"
>      >? ? ? >
>      >? ? ? > raw_1040 <- charToRaw("1040")
>      >? ? ? > raw_1040
>      >? ? ? > #31 30 *34*? (comparison happens with third symbol) 30
>      >? ? ? >
>      >? ? ? > raw_10000 <- charToRaw("10000")
>      >? ? ? > raw_10000
>      >? ? ? > #31 30 *30*? (comparison happens with third symbol) 30 30
>      >? ? ? >
>      >? ? ? > The symbol in the third position is 34 is greater than 30.
>     Equals
>      >? ? ?to false.
>      >? ? ? > Is this correct?
>      >? ? ? >
>      >? ? ? > *5) Problem - Why does this equal FALSE?*
>      >? ? ? > *"A" < "a"*
>      >? ? ? >
>      >? ? ? > 41 < 61 # FALSE?
>      >? ? ? >
>      >? ? ? > # Raw value for "A" = 41
>      >? ? ? > A_raw <- charToRaw("A")
>      >? ? ? > A_raw
>      >? ? ? >
>      >? ? ? > # Raw value for "a" = 61
>      >? ? ? > a_raw <- charToRaw("a")
>      >? ? ? > a_raw
>      >? ? ? >
>      >? ? ? > Why is capitalized "A" not less than lowercase "a"? Based
>     on raw
>      >? ? ?values it
>      >? ? ? > should be. What am I missing here?
>      >? ? ? >
>      >? ? ? > Thanks
>      >? ? ? > Kristjan
>      >? ? ? >
>      >? ? ? >? ? ? ?[[alternative HTML version deleted]]
>      >? ? ? >
>      >? ? ? > ______________________________________________
>      >? ? ? > R-help at r-project.org <mailto:R-help at r-project.org>
>     <mailto:R-help at r-project.org <mailto:R-help at r-project.org>> mailing list
>      >? ? ?-- To UNSUBSCRIBE and more, see
>      >? ? ? > https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>      >? ? ?<https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>>
>      >? ? ? > PLEASE do read the posting guide
>      > http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>      >? ? ?<http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>>
>      >? ? ? > and provide commented, minimal, self-contained,
>     reproducible code.
>      >
>


From neh@@bo|ogn@90 @end|ng |rom gm@||@com  Fri Apr 15 15:15:34 2022
From: neh@@bo|ogn@90 @end|ng |rom gm@||@com (Neha gupta)
Date: Fri, 15 Apr 2022 15:15:34 +0200
Subject: [R] Preprocess and training model with text data
Message-ID: <CA+nrPns5diauNiRJxJseM5uYhAGayvv8v2E9Fa_UFgYce+LWVg@mail.gmail.com>

Hi everyone,

I am working on text categorization (my first project so learning) and my
dataset has several columns as text (detail about the data is pasted in the
bottom. I worked before on numeric data but my advisor now asked me to
perform predictive modeling on this text data.

I am doing some preprocessing such as tokenizing, lower case, stemming etc.

The following code is used for tokenization

train.tokens <- tokens(train$DESCRIPTION,, what = "word",
                       remove_numbers = TRUE, remove_punct = TRUE,
                       remove_symbols = TRUE, remove_hyphens = TRUE).   then

 train.tokens <- tokens_tolower(train.tokens)     then

train.tokens <- tokens_wordstem(train.tokens, language = "english")

I have two questions

(1)  If we have more text features (apart from DESCRIPTION), do I need to
repeat these steps for each feature? I tried the following but does not work


*train.tokens <- tokens(c(train$DESCRIPTION,,train$NAME) , what = "word",
remove_numbers = TRUE, remove_punct = TRUE,*
*     remove_symbols = TRUE, remove_hyphens = TRUE).*

(2) My second question, after we preprocess the data and create our
bag-of-words model like below

train.tokens.dfm <- dfm(train.tokens, tolower = FALSE)

train.tokens.matrix= as.matrix(train.tokens.dfm)

,  are we ready to *train our model and perform prediction*?


*My data as mentioned also in previous emails*

Rows: 1,819
Columns: 14
$ PLUGIN_RULE_KEY             <chr> "InsufficientBranchCoverage",
"InsufficientLin~
$ PLUGIN_CONFIG_KEY           <chr> "", "", "", "", "", "", "", "", "", "",
"S1120~
$ PLUGIN_NAME                 <chr> "common-java", "common-java",
"common-java", "~
$ DESCRIPTION                 <chr> "An issue is created on a file as soon
as the ~
$ SEVERITY                    <chr> "MAJOR", "MAJOR", "MAJOR", "MAJOR",
"MAJOR", "~
$ NAME                        <chr> "Branches should have sufficient
coverage by t~
$ DEF_REMEDIATION_FUNCTION    <chr> "LINEAR", "LINEAR", "LINEAR",
"LINEAR_OFFSET",~
$ REMEDIATION_GAP_MULT        <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,
NA, NA~
$ DEF_REMEDIATION_BASE_EFFORT <chr> "", "", "", "10min", "", "", "5min",
"5min", "~
$ GAP_DESCRIPTION             <chr> "number of uncovered conditions",
"number of l~
$ SYSTEM_TAGS                 <chr> "bad-practice", "bad-practice",
"convention", ~
$ IS_TEMPLATE                 <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0~
$ DESCRIPTION_FORMAT          <chr> "HTML", "HTML", "HTML", "HTML", "HTML",
"HTML"~
$ TYPE                        <chr> "CODE_SMELL", "CODE_SMELL",
"CODE_SMELL", "COD~

	[[alternative HTML version deleted]]


From e||z@_botto @end|ng |rom out|ook@com  Fri Apr 15 16:53:36 2022
From: e||z@_botto @end|ng |rom out|ook@com (Eliza Botto)
Date: Fri, 15 Apr 2022 14:53:36 +0000
Subject: [R] Sorted index of values in matrix
Message-ID: <VI1PR0501MB26408188825DBD86941BEA4A9AEE9@VI1PR0501MB2640.eurprd05.prod.outlook.com>

deaR useRs,

I have this following simple dataset

> dput(qq)

structure(1:6, .Dim = 3:2, .Dimnames = list(c("1", "2", "3"),
    c("1", "2")))

I want to extract row and column index of the sorted values of this matrix

For example,

sort(qq) command will execute the sorted values of this matrix as (1 2 3 4 5 6). Instead of values, I want the row and column names of these sorted values as (1,1), (1,2), (1,3), (2,1), (2,2), (2,3)

I thankyou very much in advance for your help.

Eliza


	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Apr 15 17:11:37 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 15 Apr 2022 18:11:37 +0300
Subject: [R] Sorted index of values in matrix
In-Reply-To: <VI1PR0501MB26408188825DBD86941BEA4A9AEE9@VI1PR0501MB2640.eurprd05.prod.outlook.com>
References: <VI1PR0501MB26408188825DBD86941BEA4A9AEE9@VI1PR0501MB2640.eurprd05.prod.outlook.com>
Message-ID: <20220415181137.60744732@arachnoid>

? Fri, 15 Apr 2022 14:53:36 +0000
Eliza Botto <eliza_botto at outlook.com> ?????:

> sort(qq) command will execute the sorted values of this matrix as (1
> 2 3 4 5 6). Instead of values, I want the row and column names of
> these sorted values as (1,1), (1,2), (1,3), (2,1), (2,2), (2,3)

Combine order() to get the sorting permutation with arrayInd() to get
row and column indices from absolute indices with colnames() and
rownames() to get the names themselves.

-- 
Best regards,
Ivan


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Apr 15 17:33:22 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 15 Apr 2022 08:33:22 -0700
Subject: [R] Sorted index of values in matrix
In-Reply-To: <VI1PR0501MB26408188825DBD86941BEA4A9AEE9@VI1PR0501MB2640.eurprd05.prod.outlook.com>
References: <VI1PR0501MB26408188825DBD86941BEA4A9AEE9@VI1PR0501MB2640.eurprd05.prod.outlook.com>
Message-ID: <558AB668-6441-40BE-AEF8-06CD28155D9E@dcn.davis.ca.us>

Please stop posting in HTML format.

I think your specified result coordinates are in (col,row) order, which is not normal for R. The solution below yields (row,col) order.

qq <- structure(1:6, .Dim = 3:2, .Dimnames = list(c("1", "2", "3"), c("1", "2")))
pos <- expand.grid( r = seq.int( nrow( qq ) )
                  , c = seq.int( ncol( qq ) ) )
qq #'confirm source layout is column major
pos[ order( qq ), ] # (row,col)
pos[ order( qq ), 2:1 ] # (col,row)


On April 15, 2022 7:53:36 AM PDT, Eliza Botto <eliza_botto at outlook.com> wrote:
>deaR useRs,
>
>I have this following simple dataset
>
>> dput(qq)
>
>structure(1:6, .Dim = 3:2, .Dimnames = list(c("1", "2", "3"),
>    c("1", "2")))
>
>I want to extract row and column index of the sorted values of this matrix
>
>For example,
>
>sort(qq) command will execute the sorted values of this matrix as (1 2 3 4 5 6). Instead of values, I want the row and column names of these sorted values as (1,1), (1,2), (1,3), (2,1), (2,2), (2,3)
>
>I thankyou very much in advance for your help.
>
>Eliza
>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From bgunter@4567 @end|ng |rom gm@||@com  Fri Apr 15 18:25:16 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 15 Apr 2022 09:25:16 -0700
Subject: [R] Sorted index of values in matrix
In-Reply-To: <558AB668-6441-40BE-AEF8-06CD28155D9E@dcn.davis.ca.us>
References: <VI1PR0501MB26408188825DBD86941BEA4A9AEE9@VI1PR0501MB2640.eurprd05.prod.outlook.com>
 <558AB668-6441-40BE-AEF8-06CD28155D9E@dcn.davis.ca.us>
Message-ID: <CAGxFJbR4eL6a0nqFW0bcoj+srhdyHM2Gktt1St-zfp7ZdfuXNQ@mail.gmail.com>

... and here is another version of Jeff's solution using the built in
row() and col() functions instead of explicitly creating the indices
(but his version generalizes to arbitrary arrays; this does not):

 qq <- matrix(12:7, nrow =3) ## start with a non-sorted matrix
> qq
     [,1] [,2]
[1,]   12    9
[2,]   11    8
[3,]   10    7
> sort(qq)
[1]  7  8  9 10 11 12 ## the sorted values

> o <- order(qq)
> cbind(row(qq)[o], col(qq)[o])
## matrix of (row, col) indices of sorted values in original unsorted matrix
     [,1] [,2]
[1,]    3    2
[2,]    2    2
[3,]    1    2
[4,]    3    1
[5,]    2    1
[6,]    1    1

Cheers,
Bert Gunter

On Fri, Apr 15, 2022 at 8:33 AM Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
>
> Please stop posting in HTML format.
>
> I think your specified result coordinates are in (col,row) order, which is not normal for R. The solution below yields (row,col) order.
>
> qq <- structure(1:6, .Dim = 3:2, .Dimnames = list(c("1", "2", "3"), c("1", "2")))
> pos <- expand.grid( r = seq.int( nrow( qq ) )
>                   , c = seq.int( ncol( qq ) ) )
> qq #'confirm source layout is column major
> pos[ order( qq ), ] # (row,col)
> pos[ order( qq ), 2:1 ] # (col,row)
>
>
> On April 15, 2022 7:53:36 AM PDT, Eliza Botto <eliza_botto at outlook.com> wrote:
> >deaR useRs,
> >
> >I have this following simple dataset
> >
> >> dput(qq)
> >
> >structure(1:6, .Dim = 3:2, .Dimnames = list(c("1", "2", "3"),
> >    c("1", "2")))
> >
> >I want to extract row and column index of the sorted values of this matrix
> >
> >For example,
> >
> >sort(qq) command will execute the sorted values of this matrix as (1 2 3 4 5 6). Instead of values, I want the row and column names of these sorted values as (1,1), (1,2), (1,3), (2,1), (2,2), (2,3)
> >
> >I thankyou very much in advance for your help.
> >
> >Eliza
> >
> >
> >       [[alternative HTML version deleted]]
> >
> >______________________________________________
> >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >https://stat.ethz.ch/mailman/listinfo/r-help
> >PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >and provide commented, minimal, self-contained, reproducible code.
>
> --
> Sent from my phone. Please excuse my brevity.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Fri Apr 15 19:00:34 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 15 Apr 2022 10:00:34 -0700
Subject: [R] Sorted index of values in matrix
In-Reply-To: <CAGxFJbR4eL6a0nqFW0bcoj+srhdyHM2Gktt1St-zfp7ZdfuXNQ@mail.gmail.com>
References: <VI1PR0501MB26408188825DBD86941BEA4A9AEE9@VI1PR0501MB2640.eurprd05.prod.outlook.com>
 <558AB668-6441-40BE-AEF8-06CD28155D9E@dcn.davis.ca.us>
 <CAGxFJbR4eL6a0nqFW0bcoj+srhdyHM2Gktt1St-zfp7ZdfuXNQ@mail.gmail.com>
Message-ID: <CAGxFJbSqaYTJwGa7gOe=tTW2_-pN0Xgu3PpYysYxdG_jQ+fX5g@mail.gmail.com>

...
But Ivan's solution -- which I had to think about -- is better, and it
also generalizes to arbitrary arrays:

arrayInd(order(qq), .dim = dim(qq))

Bert Gunter


On Fri, Apr 15, 2022 at 9:25 AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> ... and here is another version of Jeff's solution using the built in
> row() and col() functions instead of explicitly creating the indices
> (but his version generalizes to arbitrary arrays; this does not):
>
>  qq <- matrix(12:7, nrow =3) ## start with a non-sorted matrix
> > qq
>      [,1] [,2]
> [1,]   12    9
> [2,]   11    8
> [3,]   10    7
> > sort(qq)
> [1]  7  8  9 10 11 12 ## the sorted values
>
> > o <- order(qq)
> > cbind(row(qq)[o], col(qq)[o])
> ## matrix of (row, col) indices of sorted values in original unsorted matrix
>      [,1] [,2]
> [1,]    3    2
> [2,]    2    2
> [3,]    1    2
> [4,]    3    1
> [5,]    2    1
> [6,]    1    1
>
> Cheers,
> Bert Gunter
>
> On Fri, Apr 15, 2022 at 8:33 AM Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
> >
> > Please stop posting in HTML format.
> >
> > I think your specified result coordinates are in (col,row) order, which is not normal for R. The solution below yields (row,col) order.
> >
> > qq <- structure(1:6, .Dim = 3:2, .Dimnames = list(c("1", "2", "3"), c("1", "2")))
> > pos <- expand.grid( r = seq.int( nrow( qq ) )
> >                   , c = seq.int( ncol( qq ) ) )
> > qq #'confirm source layout is column major
> > pos[ order( qq ), ] # (row,col)
> > pos[ order( qq ), 2:1 ] # (col,row)
> >
> >
> > On April 15, 2022 7:53:36 AM PDT, Eliza Botto <eliza_botto at outlook.com> wrote:
> > >deaR useRs,
> > >
> > >I have this following simple dataset
> > >
> > >> dput(qq)
> > >
> > >structure(1:6, .Dim = 3:2, .Dimnames = list(c("1", "2", "3"),
> > >    c("1", "2")))
> > >
> > >I want to extract row and column index of the sorted values of this matrix
> > >
> > >For example,
> > >
> > >sort(qq) command will execute the sorted values of this matrix as (1 2 3 4 5 6). Instead of values, I want the row and column names of these sorted values as (1,1), (1,2), (1,3), (2,1), (2,2), (2,3)
> > >
> > >I thankyou very much in advance for your help.
> > >
> > >Eliza
> > >
> > >
> > >       [[alternative HTML version deleted]]
> > >
> > >______________________________________________
> > >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > >https://stat.ethz.ch/mailman/listinfo/r-help
> > >PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > >and provide commented, minimal, self-contained, reproducible code.
> >
> > --
> > Sent from my phone. Please excuse my brevity.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.


From kr|@tj@n@kure@1 @end|ng |rom gm@||@com  Thu Apr 14 23:09:20 2022
From: kr|@tj@n@kure@1 @end|ng |rom gm@||@com (Kristjan Kure)
Date: Fri, 15 Apr 2022 00:09:20 +0300
Subject: [R] Symbol/String comparison in R
In-Reply-To: <6a02e922-b11e-edf8-abd2-f1b2b1849e37@sapo.pt>
References: <CAJ_7LVteUa=FJDDoT_TyYq1tG8QRQoM0XFTuT+q87+9MAbg9_w@mail.gmail.com>
 <074d6a6f-4fe7-6c9e-7059-585f492bbb6f@sapo.pt>
 <CAJ_7LVswyHkvcnV_TtCEn-0VGWcxurHih4Ww=w8p6CRO0=yhEQ@mail.gmail.com>
 <6a02e922-b11e-edf8-abd2-f1b2b1849e37@sapo.pt>
Message-ID: <CAJ_7LVsw+rJqx4bmwr9a-MsvO4SPob9G1Dmquy3bDes=FanD-w@mail.gmail.com>

Thank you, Rui. Not sure I got everything right, but here it is:

*current_loc <- Sys.getlocale("LC_COLLATE")*
#> [1] "Estonian_Estonia.1257"

"A" < "a"
#41 < 61
#> [1] FALSE
raw_A <- charToRaw("A") #41
raw_a <- charToRaw("a") #61
# Not OK - should be TRUE (41 is less than 61)

"A" > "a"
#41 > 61
#> [1] TRUE
raw_A <- charToRaw("A") #41
raw_a <- charToRaw("a") #61
# Not OK - should be FALSE (41 is not bigger than 61)

*Sys.setlocale("LC_COLLATE", locale = "C")*

"A" < "a"
#41 < 61
#> [1] TRUE
raw_A <- charToRaw("A") #41
raw_a <- charToRaw("a") #61

# OK - (41 is less than 61)

"A" > "a"
#41 > 61
#> [1] FALSE
raw_A <- charToRaw("A") #41
raw_a <- charToRaw("a") #61

# OK - (41 is not bigger than 61)

*Sys.setlocale("LC_COLLATE", current_loc)*

*Conclusion: Comparing strings using charToRaw() only works correctly with
locale = C?*

Regards,
Kristjan



On Thu, Apr 14, 2022 at 10:01 PM Rui Barradas <ruipbarradas at sapo.pt> wrote:

> Hello,
>
> 1) The best I could find on lower case/upper case is [1];
> The Wikipedia page you link to is about a code page and the collating
> sequence is the same as ASCII so no, that's not it.
>
> 2) In the cp1252 table "A" < "a", it follows the numeric order 0x31 <
> 0x41. But what R is using is the locale LC_COLLATE setting, not the "C"
> one.
>
> How to validate the end results? The best way is to check the current
> setting, with Sys.getlocale.
>
>
>
> [1]
>
> https://books.google.pt/books?id=GkajBQAAQBAJ&pg=PA259&lpg=PA259&dq=collating+sequence+portuguese&source=bl&ots=fVnUYHz0ev&sig=ACfU3U3xjpJfPNcWEfvwb_2nScYb89CeOw&hl=pt-PT&sa=X&ved=2ahUKEwiAoNTW-JP3AhVI1xoKHXT-C4oQ6AF6BAgUEAM#v=onepage&q=collating%20sequence%20portuguese&f=false
>
>
> Hope this helps,
>
> Rui Barradas
>
> ?s 16:33 de 14/04/2022, Kristjan Kure escreveu:
> > Hi Rui
> >
> > Thank you for the code snippet.
> >
> > 1) How do you find your "Portuguese_Portugal.1252" symbols table now?
> > Is it this https://en.wikipedia.org/wiki/Windows-1252
> > <https://en.wikipedia.org/wiki/Windows-1252>?
> >
> > 2) What attributes and values do you check to validate the end result?
> > I see there is a section "Codepage layout" and I can find "A" and "a"
> > symbols.
> >
> > What values on that table tell you "A" is bigger than "a"?
> > "A" < "a" # returns FALSE
> > "A" > "a" # returns TRUE
> >
> > PS! My locale is Estonian_Estonia.1257
> >
> > Regards,
> > Kristjan
> >
> > On Thu, Apr 14, 2022 at 5:05 PM Rui Barradas <ruipbarradas at sapo.pt
> > <mailto:ruipbarradas at sapo.pt>> wrote:
> >
> >     Hello,
> >
> >     This is a locale issue, you are counting on the ASCII table codes but
> >     that's only valid for the "C" locale.
> >
> >     old_loc <- Sys.getlocale("LC_COLLATE")
> >
> >     "A" < "a"
> >     #> [1] FALSE
> >     "A" > "a"
> >     #> [1] TRUE
> >
> >     Sys.setlocale("LC_COLLATE", locale = "C")
> >     #> [1] "C"
> >
> >     "A" < "a"
> >     #> [1] TRUE
> >     "A" > "a"
> >     #> [1] FALSE
> >
> >     Sys.setlocale("LC_COLLATE", old_loc)
> >     #> [1] "Portuguese_Portugal.1252"
> >
> >
> >     Hope this helps,
> >
> >     Rui Barradas
> >
> >     ?s 15:06 de 13/04/2022, Kristjan Kure escreveu:
> >      > Hi!
> >      >
> >      > Sorry, I am a beginner in R.
> >      >
> >      > I was not able to find answers to my questions (tried Google,
> Stack
> >      > Overflow, etc). Please correct me if anything is wrong here.
> >      >
> >      > When comparing symbols/strings in R - raw numeric values are
> compared
> >      > symbol by symbol starting from left? If raw numeric values are
> >     not used is
> >      > there an ASCII / Unicode table where symbols have
> >     values/ranking/order and
> >      > R compares those values?
> >      >
> >      > *2) Comparing symbols*
> >      > Letter "a" raw value is 61, letter "b" raw value is 62? Is this
> >     correct?
> >      >
> >      > # Raw value for "a" = 61
> >      > a_raw <- charToRaw("a")
> >      > a_raw
> >      >
> >      > # Raw value for "b" = 62
> >      > b_raw <- charToRaw("b")
> >      > b_raw
> >      >
> >      > # equals TRUE
> >      > "a" < "b"
> >      >
> >      > Ok, so 61 is less than 62 so it's TRUE. Is this correct?
> >      >
> >      > *3) Comparing strings #1*
> >      > "1040" <= "12000"
> >      >
> >      > raw_1040 <- charToRaw("1040")
> >      > raw_1040
> >      > #31 *30* (comparison happens with the second symbol) 34 30
> >      >
> >      > raw_12000 <- charToRaw("12000")
> >      > raw_12000
> >      > #31 *32* (comparison happens with the second symbol) 30 30 30
> >      >
> >      > The symbol in the second position is 30 and it's less than 32.
> >     Equals to
> >      > true. Is this correct?
> >      >
> >      > *4) Comparing strings #2*
> >      > "1040" <= "10000"
> >      >
> >      > raw_1040 <- charToRaw("1040")
> >      > raw_1040
> >      > #31 30 *34*  (comparison happens with third symbol) 30
> >      >
> >      > raw_10000 <- charToRaw("10000")
> >      > raw_10000
> >      > #31 30 *30*  (comparison happens with third symbol) 30 30
> >      >
> >      > The symbol in the third position is 34 is greater than 30. Equals
> >     to false.
> >      > Is this correct?
> >      >
> >      > *5) Problem - Why does this equal FALSE?*
> >      > *"A" < "a"*
> >      >
> >      > 41 < 61 # FALSE?
> >      >
> >      > # Raw value for "A" = 41
> >      > A_raw <- charToRaw("A")
> >      > A_raw
> >      >
> >      > # Raw value for "a" = 61
> >      > a_raw <- charToRaw("a")
> >      > a_raw
> >      >
> >      > Why is capitalized "A" not less than lowercase "a"? Based on raw
> >     values it
> >      > should be. What am I missing here?
> >      >
> >      > Thanks
> >      > Kristjan
> >      >
> >      >       [[alternative HTML version deleted]]
> >      >
> >      > ______________________________________________
> >      > R-help at r-project.org <mailto:R-help at r-project.org> mailing list
> >     -- To UNSUBSCRIBE and more, see
> >      > https://stat.ethz.ch/mailman/listinfo/r-help
> >     <https://stat.ethz.ch/mailman/listinfo/r-help>
> >      > PLEASE do read the posting guide
> >     http://www.R-project.org/posting-guide.html
> >     <http://www.R-project.org/posting-guide.html>
> >      > and provide commented, minimal, self-contained, reproducible code.
> >
>

	[[alternative HTML version deleted]]


From r@ubb@|@h115 @end|ng |rom gm@||@com  Fri Apr 15 19:51:04 2022
From: r@ubb@|@h115 @end|ng |rom gm@||@com (Roopa Subbaiah)
Date: Fri, 15 Apr 2022 23:21:04 +0530
Subject: [R] Need help with netmeta package
Message-ID: <CAHudoO3Q+xrW5yOsgdkSQvLV9D63LeAC6wWWsCK_0ySw=uXK0A@mail.gmail.com>

Hi all,

We are conducting network metaanalysis of 3 treatments compared to placebo
using netmeta analysis. We have mean sd values for an outcome. How do we
calculate z scores using netmeta package? Thank you

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Fri Apr 15 22:52:11 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 15 Apr 2022 13:52:11 -0700
Subject: [R] Need help with netmeta package
In-Reply-To: <CAHudoO3Q+xrW5yOsgdkSQvLV9D63LeAC6wWWsCK_0ySw=uXK0A@mail.gmail.com>
References: <CAHudoO3Q+xrW5yOsgdkSQvLV9D63LeAC6wWWsCK_0ySw=uXK0A@mail.gmail.com>
Message-ID: <CAGxFJbRNE3JntChzRUkbnC1cjMWr93LijK4cBa3--ET9C-=TiQ@mail.gmail.com>

While you *may* get a useful reply here, there is an
r-sig-meta-analysis list to which this would be better posted:
https://stat.ethz.ch/mailman/listinfo/r-sig-meta-analysis


Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Fri, Apr 15, 2022 at 1:04 PM Roopa Subbaiah <rsubbaiah115 at gmail.com> wrote:
>
> Hi all,
>
> We are conducting network metaanalysis of 3 treatments compared to placebo
> using netmeta analysis. We have mean sd values for an outcome. How do we
> calculate z scores using netmeta package? Thank you
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From e||z@_botto @end|ng |rom out|ook@com  Sat Apr 16 01:51:36 2022
From: e||z@_botto @end|ng |rom out|ook@com (Eliza Botto)
Date: Fri, 15 Apr 2022 23:51:36 +0000
Subject: [R] Sorted index of values in matrix
In-Reply-To: <CAGxFJbSqaYTJwGa7gOe=tTW2_-pN0Xgu3PpYysYxdG_jQ+fX5g@mail.gmail.com>
References: <VI1PR0501MB26408188825DBD86941BEA4A9AEE9@VI1PR0501MB2640.eurprd05.prod.outlook.com>
 <558AB668-6441-40BE-AEF8-06CD28155D9E@dcn.davis.ca.us>
 <CAGxFJbR4eL6a0nqFW0bcoj+srhdyHM2Gktt1St-zfp7ZdfuXNQ@mail.gmail.com>
 <CAGxFJbSqaYTJwGa7gOe=tTW2_-pN0Xgu3PpYysYxdG_jQ+fX5g@mail.gmail.com>
Message-ID: <VI1PR0501MB2640475BF7CAB03F236C2FEB9AEE9@VI1PR0501MB2640.eurprd05.prod.outlook.com>

Thankyou very much. It worked.


Eliza
________________________________
From: Bert Gunter <bgunter.4567 at gmail.com>
Sent: Friday 15 April 2022 17:00
To: Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
Cc: R-help <r-help at r-project.org>; Eliza Botto <eliza_botto at outlook.com>
Subject: Re: [R] Sorted index of values in matrix

...
But Ivan's solution -- which I had to think about -- is better, and it
also generalizes to arbitrary arrays:

arrayInd(order(qq), .dim = dim(qq))

Bert Gunter


On Fri, Apr 15, 2022 at 9:25 AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> ... and here is another version of Jeff's solution using the built in
> row() and col() functions instead of explicitly creating the indices
> (but his version generalizes to arbitrary arrays; this does not):
>
>  qq <- matrix(12:7, nrow =3) ## start with a non-sorted matrix
> > qq
>      [,1] [,2]
> [1,]   12    9
> [2,]   11    8
> [3,]   10    7
> > sort(qq)
> [1]  7  8  9 10 11 12 ## the sorted values
>
> > o <- order(qq)
> > cbind(row(qq)[o], col(qq)[o])
> ## matrix of (row, col) indices of sorted values in original unsorted matrix
>      [,1] [,2]
> [1,]    3    2
> [2,]    2    2
> [3,]    1    2
> [4,]    3    1
> [5,]    2    1
> [6,]    1    1
>
> Cheers,
> Bert Gunter
>
> On Fri, Apr 15, 2022 at 8:33 AM Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
> >
> > Please stop posting in HTML format.
> >
> > I think your specified result coordinates are in (col,row) order, which is not normal for R. The solution below yields (row,col) order.
> >
> > qq <- structure(1:6, .Dim = 3:2, .Dimnames = list(c("1", "2", "3"), c("1", "2")))
> > pos <- expand.grid( r = seq.int( nrow( qq ) )
> >                   , c = seq.int( ncol( qq ) ) )
> > qq #'confirm source layout is column major
> > pos[ order( qq ), ] # (row,col)
> > pos[ order( qq ), 2:1 ] # (col,row)
> >
> >
> > On April 15, 2022 7:53:36 AM PDT, Eliza Botto <eliza_botto at outlook.com> wrote:
> > >deaR useRs,
> > >
> > >I have this following simple dataset
> > >
> > >> dput(qq)
> > >
> > >structure(1:6, .Dim = 3:2, .Dimnames = list(c("1", "2", "3"),
> > >    c("1", "2")))
> > >
> > >I want to extract row and column index of the sorted values of this matrix
> > >
> > >For example,
> > >
> > >sort(qq) command will execute the sorted values of this matrix as (1 2 3 4 5 6). Instead of values, I want the row and column names of these sorted values as (1,1), (1,2), (1,3), (2,1), (2,2), (2,3)
> > >
> > >I thankyou very much in advance for your help.
> > >
> > >Eliza
> > >
> > >
> > >       [[alternative HTML version deleted]]
> > >
> > >______________________________________________
> > >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > >https://stat.ethz.ch/mailman/listinfo/r-help
> > >PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > >and provide commented, minimal, self-contained, reproducible code.
> >
> > --
> > Sent from my phone. Please excuse my brevity.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From p@u|bern@|07 @end|ng |rom gm@||@com  Sat Apr 16 02:11:33 2022
From: p@u|bern@|07 @end|ng |rom gm@||@com (Paul Bernal)
Date: Fri, 15 Apr 2022 19:11:33 -0500
Subject: [R] Question regarding k-fold cross validation
Message-ID: <CAMOcQfPfLkCwL+0mxYDa9eNAX2UspPqSK0-gmCfyZaEmJ9toBw@mail.gmail.com>

Dear friends,

Hope you are doing great. I need to perform a k-fold cross validation
analysis on the famous iris dataset, with k = 5.

Now, the model I am using is a multinomial logit, because the dependent
variable is species and it has three classes (setosa, versicolor and
virginica).

The packages I am using are caret and nnet.

Below is my R code:

#specifying the cross-validation method

ctrl <- trainControl(method = "cv", number = 5)

model = train(multinom(as.factor(iris_frame$species) ~
iris_frame$sepal_length + iris_frame$sepal_width + iris_frame$petal_length
+ iris_frame$petal_width), trControl = ctrl)

Now, R throws the following message:

# weights:  18 (10 variable)
initial  value 164.791843
iter  10 value 16.119063
iter  20 value 7.103299
iter  30 value 6.191105
iter  40 value 5.984259
iter  50 value 5.961820
iter  60 value 5.955196
iter  70 value 5.952041
iter  80 value 5.950570
iter  90 value 5.950178
iter 100 value 5.950059
final  value 5.950059
stopped after 100 iterations
Error in x[0, , drop = FALSE] : incorrect number of dimensions

What am I doing wrong? How could I accomplish the 5-fold cross validation
on the iris data set?

I am providing the dput for the iris data set that I am using below:
dput(iris)
structure(list(Sepal.Length = c(5.1, 4.9, 4.7, 4.6, 5, 5.4, 4.6,
5, 4.4, 4.9, 5.4, 4.8, 4.8, 4.3, 5.8, 5.7, 5.4, 5.1, 5.7, 5.1,
5.4, 5.1, 4.6, 5.1, 4.8, 5, 5, 5.2, 5.2, 4.7, 4.8, 5.4, 5.2,
5.5, 4.9, 5, 5.5, 4.9, 4.4, 5.1, 5, 4.5, 4.4, 5, 5.1, 4.8, 5.1,
4.6, 5.3, 5, 7, 6.4, 6.9, 5.5, 6.5, 5.7, 6.3, 4.9, 6.6, 5.2,
5, 5.9, 6, 6.1, 5.6, 6.7, 5.6, 5.8, 6.2, 5.6, 5.9, 6.1, 6.3,
6.1, 6.4, 6.6, 6.8, 6.7, 6, 5.7, 5.5, 5.5, 5.8, 6, 5.4, 6, 6.7,
6.3, 5.6, 5.5, 5.5, 6.1, 5.8, 5, 5.6, 5.7, 5.7, 6.2, 5.1, 5.7,
6.3, 5.8, 7.1, 6.3, 6.5, 7.6, 4.9, 7.3, 6.7, 7.2, 6.5, 6.4, 6.8,
5.7, 5.8, 6.4, 6.5, 7.7, 7.7, 6, 6.9, 5.6, 7.7, 6.3, 6.7, 7.2,
6.2, 6.1, 6.4, 7.2, 7.4, 7.9, 6.4, 6.3, 6.1, 7.7, 6.3, 6.4, 6,
6.9, 6.7, 6.9, 5.8, 6.8, 6.7, 6.7, 6.3, 6.5, 6.2, 5.9), Sepal.Width =
c(3.5,
3, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.4, 3, 3, 4,
4.4, 3.9, 3.5, 3.8, 3.8, 3.4, 3.7, 3.6, 3.3, 3.4, 3, 3.4, 3.5,
3.4, 3.2, 3.1, 3.4, 4.1, 4.2, 3.1, 3.2, 3.5, 3.6, 3, 3.4, 3.5,
2.3, 3.2, 3.5, 3.8, 3, 3.8, 3.2, 3.7, 3.3, 3.2, 3.2, 3.1, 2.3,
2.8, 2.8, 3.3, 2.4, 2.9, 2.7, 2, 3, 2.2, 2.9, 2.9, 3.1, 3, 2.7,
2.2, 2.5, 3.2, 2.8, 2.5, 2.8, 2.9, 3, 2.8, 3, 2.9, 2.6, 2.4,
2.4, 2.7, 2.7, 3, 3.4, 3.1, 2.3, 3, 2.5, 2.6, 3, 2.6, 2.3, 2.7,
3, 2.9, 2.9, 2.5, 2.8, 3.3, 2.7, 3, 2.9, 3, 3, 2.5, 2.9, 2.5,
3.6, 3.2, 2.7, 3, 2.5, 2.8, 3.2, 3, 3.8, 2.6, 2.2, 3.2, 2.8,
2.8, 2.7, 3.3, 3.2, 2.8, 3, 2.8, 3, 2.8, 3.8, 2.8, 2.8, 2.6,
3, 3.4, 3.1, 3, 3.1, 3.1, 3.1, 2.7, 3.2, 3.3, 3, 2.5, 3, 3.4,
3), Petal.Length = c(1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5,
1.4, 1.5, 1.5, 1.6, 1.4, 1.1, 1.2, 1.5, 1.3, 1.4, 1.7, 1.5, 1.7,
1.5, 1, 1.7, 1.9, 1.6, 1.6, 1.5, 1.4, 1.6, 1.6, 1.5, 1.5, 1.4,
1.5, 1.2, 1.3, 1.4, 1.3, 1.5, 1.3, 1.3, 1.3, 1.6, 1.9, 1.4, 1.6,
1.4, 1.5, 1.4, 4.7, 4.5, 4.9, 4, 4.6, 4.5, 4.7, 3.3, 4.6, 3.9,
3.5, 4.2, 4, 4.7, 3.6, 4.4, 4.5, 4.1, 4.5, 3.9, 4.8, 4, 4.9,
4.7, 4.3, 4.4, 4.8, 5, 4.5, 3.5, 3.8, 3.7, 3.9, 5.1, 4.5, 4.5,
4.7, 4.4, 4.1, 4, 4.4, 4.6, 4, 3.3, 4.2, 4.2, 4.2, 4.3, 3, 4.1,
6, 5.1, 5.9, 5.6, 5.8, 6.6, 4.5, 6.3, 5.8, 6.1, 5.1, 5.3, 5.5,
5, 5.1, 5.3, 5.5, 6.7, 6.9, 5, 5.7, 4.9, 6.7, 4.9, 5.7, 6, 4.8,
4.9, 5.6, 5.8, 6.1, 6.4, 5.6, 5.1, 5.6, 6.1, 5.6, 5.5, 4.8, 5.4,
5.6, 5.1, 5.1, 5.9, 5.7, 5.2, 5, 5.2, 5.4, 5.1), Petal.Width = c(0.2,
0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.2, 0.1, 0.1,
0.2, 0.4, 0.4, 0.3, 0.3, 0.3, 0.2, 0.4, 0.2, 0.5, 0.2, 0.2, 0.4,
0.2, 0.2, 0.2, 0.2, 0.4, 0.1, 0.2, 0.2, 0.2, 0.2, 0.1, 0.2, 0.2,
0.3, 0.3, 0.2, 0.6, 0.4, 0.3, 0.2, 0.2, 0.2, 0.2, 1.4, 1.5, 1.5,
1.3, 1.5, 1.3, 1.6, 1, 1.3, 1.4, 1, 1.5, 1, 1.4, 1.3, 1.4, 1.5,
1, 1.5, 1.1, 1.8, 1.3, 1.5, 1.2, 1.3, 1.4, 1.4, 1.7, 1.5, 1,
1.1, 1, 1.2, 1.6, 1.5, 1.6, 1.5, 1.3, 1.3, 1.3, 1.2, 1.4, 1.2,
1, 1.3, 1.2, 1.3, 1.3, 1.1, 1.3, 2.5, 1.9, 2.1, 1.8, 2.2, 2.1,
1.7, 1.8, 1.8, 2.5, 2, 1.9, 2.1, 2, 2.4, 2.3, 1.8, 2.2, 2.3,
1.5, 2.3, 2, 2, 1.8, 2.1, 1.8, 1.8, 1.8, 2.1, 1.6, 1.9, 2, 2.2,
1.5, 1.4, 2.3, 2.4, 1.8, 1.8, 2.1, 2.4, 2.3, 1.9, 2.3, 2.5, 2.3,
1.9, 2, 2.3, 1.8), Species = structure(c(1L, 1L, 1L, 1L, 1L,
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L,
2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L,
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L,
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L,
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L,
3L), .Label = c("setosa", "versicolor", "virginica"), class = "factor")),
class = "data.frame", row.names = c(NA,
-150L))

Any help and/or guidance will be greatly appreciated.

Best regards,
Paul

	[[alternative HTML version deleted]]


From dw|n@em|u@ @end|ng |rom comc@@t@net  Sat Apr 16 02:49:04 2022
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Fri, 15 Apr 2022 17:49:04 -0700
Subject: [R] Question regarding k-fold cross validation
In-Reply-To: <CAMOcQfPfLkCwL+0mxYDa9eNAX2UspPqSK0-gmCfyZaEmJ9toBw@mail.gmail.com>
References: <CAMOcQfPfLkCwL+0mxYDa9eNAX2UspPqSK0-gmCfyZaEmJ9toBw@mail.gmail.com>
Message-ID: <72831a78-b5b8-c475-3f3e-460cbfbea8a2@comcast.net>


On 4/15/22 17:11, Paul Bernal wrote:
> Dear friends,
>
> Hope you are doing great. I need to perform a k-fold cross validation
> analysis on the famous iris dataset, with k = 5.
>
> Now, the model I am using is a multinomial logit, because the dependent
> variable is species and it has three classes (setosa, versicolor and
> virginica).
>
> The packages I am using are caret and nnet.
>
> Below is my R code:
>
> #specifying the cross-validation method
>
> ctrl <- trainControl(method = "cv", number = 5)
>
> model = train(multinom(as.factor(iris_frame$species) ~
> iris_frame$sepal_length + iris_frame$sepal_width + iris_frame$petal_length
> + iris_frame$petal_width), trControl = ctrl)
>
> Now, R throws the following message:
>
> # weights:  18 (10 variable)
> initial  value 164.791843
> iter  10 value 16.119063
> iter  20 value 7.103299
> iter  30 value 6.191105
> iter  40 value 5.984259
> iter  50 value 5.961820
> iter  60 value 5.955196
> iter  70 value 5.952041
> iter  80 value 5.950570
> iter  90 value 5.950178
> iter 100 value 5.950059
> final  value 5.950059
> stopped after 100 iterations
> Error in x[0, , drop = FALSE] : incorrect number of dimensions
>
> What am I doing wrong? How could I accomplish the 5-fold cross validation
> on the iris data set?
>
> I am providing the dput for the iris data set that I am using below:
> dput(iris)
> structure(list(Sepal.Length = c(5.1, 4.9, 4.7, 4.6, 5, 5.4, 4.6,
> 5, 4.4, 4.9, 5.4, 4.8, 4.8, 4.3, 5.8, 5.7, 5.4, 5.1, 5.7, 5.1,
> 5.4, 5.1, 4.6, 5.1, 4.8, 5, 5, 5.2, 5.2, 4.7, 4.8, 5.4, 5.2,
> 5.5, 4.9, 5, 5.5, 4.9, 4.4, 5.1, 5, 4.5, 4.4, 5, 5.1, 4.8, 5.1,
> 4.6, 5.3, 5, 7, 6.4, 6.9, 5.5, 6.5, 5.7, 6.3, 4.9, 6.6, 5.2,
> 5, 5.9, 6, 6.1, 5.6, 6.7, 5.6, 5.8, 6.2, 5.6, 5.9, 6.1, 6.3,
> 6.1, 6.4, 6.6, 6.8, 6.7, 6, 5.7, 5.5, 5.5, 5.8, 6, 5.4, 6, 6.7,
> 6.3, 5.6, 5.5, 5.5, 6.1, 5.8, 5, 5.6, 5.7, 5.7, 6.2, 5.1, 5.7,
> 6.3, 5.8, 7.1, 6.3, 6.5, 7.6, 4.9, 7.3, 6.7, 7.2, 6.5, 6.4, 6.8,
> 5.7, 5.8, 6.4, 6.5, 7.7, 7.7, 6, 6.9, 5.6, 7.7, 6.3, 6.7, 7.2,
> 6.2, 6.1, 6.4, 7.2, 7.4, 7.9, 6.4, 6.3, 6.1, 7.7, 6.3, 6.4, 6,
> 6.9, 6.7, 6.9, 5.8, 6.8, 6.7, 6.7, 6.3, 6.5, 6.2, 5.9), Sepal.Width =
> c(3.5,
> 3, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.4, 3, 3, 4,
> 4.4, 3.9, 3.5, 3.8, 3.8, 3.4, 3.7, 3.6, 3.3, 3.4, 3, 3.4, 3.5,
> 3.4, 3.2, 3.1, 3.4, 4.1, 4.2, 3.1, 3.2, 3.5, 3.6, 3, 3.4, 3.5,
> 2.3, 3.2, 3.5, 3.8, 3, 3.8, 3.2, 3.7, 3.3, 3.2, 3.2, 3.1, 2.3,
> 2.8, 2.8, 3.3, 2.4, 2.9, 2.7, 2, 3, 2.2, 2.9, 2.9, 3.1, 3, 2.7,
> 2.2, 2.5, 3.2, 2.8, 2.5, 2.8, 2.9, 3, 2.8, 3, 2.9, 2.6, 2.4,
> 2.4, 2.7, 2.7, 3, 3.4, 3.1, 2.3, 3, 2.5, 2.6, 3, 2.6, 2.3, 2.7,
> 3, 2.9, 2.9, 2.5, 2.8, 3.3, 2.7, 3, 2.9, 3, 3, 2.5, 2.9, 2.5,
> 3.6, 3.2, 2.7, 3, 2.5, 2.8, 3.2, 3, 3.8, 2.6, 2.2, 3.2, 2.8,
> 2.8, 2.7, 3.3, 3.2, 2.8, 3, 2.8, 3, 2.8, 3.8, 2.8, 2.8, 2.6,
> 3, 3.4, 3.1, 3, 3.1, 3.1, 3.1, 2.7, 3.2, 3.3, 3, 2.5, 3, 3.4,
> 3), Petal.Length = c(1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5,
> 1.4, 1.5, 1.5, 1.6, 1.4, 1.1, 1.2, 1.5, 1.3, 1.4, 1.7, 1.5, 1.7,
> 1.5, 1, 1.7, 1.9, 1.6, 1.6, 1.5, 1.4, 1.6, 1.6, 1.5, 1.5, 1.4,
> 1.5, 1.2, 1.3, 1.4, 1.3, 1.5, 1.3, 1.3, 1.3, 1.6, 1.9, 1.4, 1.6,
> 1.4, 1.5, 1.4, 4.7, 4.5, 4.9, 4, 4.6, 4.5, 4.7, 3.3, 4.6, 3.9,
> 3.5, 4.2, 4, 4.7, 3.6, 4.4, 4.5, 4.1, 4.5, 3.9, 4.8, 4, 4.9,
> 4.7, 4.3, 4.4, 4.8, 5, 4.5, 3.5, 3.8, 3.7, 3.9, 5.1, 4.5, 4.5,
> 4.7, 4.4, 4.1, 4, 4.4, 4.6, 4, 3.3, 4.2, 4.2, 4.2, 4.3, 3, 4.1,
> 6, 5.1, 5.9, 5.6, 5.8, 6.6, 4.5, 6.3, 5.8, 6.1, 5.1, 5.3, 5.5,
> 5, 5.1, 5.3, 5.5, 6.7, 6.9, 5, 5.7, 4.9, 6.7, 4.9, 5.7, 6, 4.8,
> 4.9, 5.6, 5.8, 6.1, 6.4, 5.6, 5.1, 5.6, 6.1, 5.6, 5.5, 4.8, 5.4,
> 5.6, 5.1, 5.1, 5.9, 5.7, 5.2, 5, 5.2, 5.4, 5.1), Petal.Width = c(0.2,
> 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.2, 0.1, 0.1,
> 0.2, 0.4, 0.4, 0.3, 0.3, 0.3, 0.2, 0.4, 0.2, 0.5, 0.2, 0.2, 0.4,
> 0.2, 0.2, 0.2, 0.2, 0.4, 0.1, 0.2, 0.2, 0.2, 0.2, 0.1, 0.2, 0.2,
> 0.3, 0.3, 0.2, 0.6, 0.4, 0.3, 0.2, 0.2, 0.2, 0.2, 1.4, 1.5, 1.5,
> 1.3, 1.5, 1.3, 1.6, 1, 1.3, 1.4, 1, 1.5, 1, 1.4, 1.3, 1.4, 1.5,
> 1, 1.5, 1.1, 1.8, 1.3, 1.5, 1.2, 1.3, 1.4, 1.4, 1.7, 1.5, 1,
> 1.1, 1, 1.2, 1.6, 1.5, 1.6, 1.5, 1.3, 1.3, 1.3, 1.2, 1.4, 1.2,
> 1, 1.3, 1.2, 1.3, 1.3, 1.1, 1.3, 2.5, 1.9, 2.1, 1.8, 2.2, 2.1,
> 1.7, 1.8, 1.8, 2.5, 2, 1.9, 2.1, 2, 2.4, 2.3, 1.8, 2.2, 2.3,
> 1.5, 2.3, 2, 2, 1.8, 2.1, 1.8, 1.8, 1.8, 2.1, 1.6, 1.9, 2, 2.2,
> 1.5, 1.4, 2.3, 2.4, 1.8, 1.8, 2.1, 2.4, 2.3, 1.9, 2.3, 2.5, 2.3,
> 1.9, 2, 2.3, 1.8), Species = structure(c(1L, 1L, 1L, 1L, 1L,
> 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
> 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
> 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L,
> 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
> 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
> 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L,
> 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L,
> 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L,
> 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L,
> 3L), .Label = c("setosa", "versicolor", "virginica"), class = "factor")),
> class = "data.frame", row.names = c(NA,
> -150L))
>
> Any help and/or guidance will be greatly appreciated.
>
> Best regards,
> Paul
>
> 	[[alternative HTML version deleted]]


The first thing "wrong" is posting in HTML. Read the Posting Guide.

Next. You offer a data object named "iris" and then construct a formula 
that is using the "$" operator to access columns in a different named 
object: "iris_frame". Easy but annoying to fix.

Last, and most critical, is failing to use the caret format of 
specifying "method" with a character name for the function to be used:

# This runs without error

library(caret)

library(nnet)

model = train(? form= Species ~? Sepal.Length + Sepal.Width + Petal.Length +
 ?????????????????????? Petal.Width, data=iris, method="multinom", 
trControl = ctrl)

#-----------------

R formulas in regression functions expect to find their column names 
(a.k.a. "variables") in an object passed via the data-prameter

-- 

David.


>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kt1572757 @end|ng |rom gm@||@com  Sat Apr 16 20:45:18 2022
From: kt1572757 @end|ng |rom gm@||@com (Kelly Thompson)
Date: Sat, 16 Apr 2022 14:45:18 -0400
Subject: [R] What are the pros and cons of the various R functions and
 methods for conducting least median of squares regression analysis?
Message-ID: <CAHfBD2dVadhPZwAvG-+EvzQLk5faBOf-nTbtXdvJM0K7gQsTHQ@mail.gmail.com>

What are the pros and cons of the various R functions and methods for
conducting least median of squares regression analysis?

I know about these:

lqs, wth method = "lms" and lmsreg, which as I understan dit are equivalent

Mentions:
https://www.rdocumentation.org/packages/MASS/versions/7.3-56/topics/lqs

https://stat.ethz.ch/pipermail/r-help/2006-October/115681.html

https://stat.ethz.ch/pipermail/r-help/2007-March/126564.html
-----

ltsReg

https://www.rdocumentation.org/packages/robustbase/versions/0.1-2/topics/ltsReg
-----
nl.lmsNM
https://rdrr.io/cran/nlr/man/nl.lmsNM.html


From bgunter@4567 @end|ng |rom gm@||@com  Sat Apr 16 20:59:43 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 16 Apr 2022 11:59:43 -0700
Subject: [R] What are the pros and cons of the various R functions and
 methods for conducting least median of squares regression analysis?
In-Reply-To: <CAHfBD2dVadhPZwAvG-+EvzQLk5faBOf-nTbtXdvJM0K7gQsTHQ@mail.gmail.com>
References: <CAHfBD2dVadhPZwAvG-+EvzQLk5faBOf-nTbtXdvJM0K7gQsTHQ@mail.gmail.com>
Message-ID: <CAGxFJbQ+6L5=gs5Gx4aemP21nb12khnYZXNPWBJsBMH9DSwRtg@mail.gmail.com>

No opinion (or expertise), but I think you may have missed the most
important one, Roger Koenker's package, quantreg:

https://CRAN.R-project.org/package=quantreg

Cheers,
Bert


Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Sat, Apr 16, 2022 at 11:45 AM Kelly Thompson <kt1572757 at gmail.com> wrote:
>
> What are the pros and cons of the various R functions and methods for
> conducting least median of squares regression analysis?
>
> I know about these:
>
> lqs, wth method = "lms" and lmsreg, which as I understan dit are equivalent
>
> Mentions:
> https://www.rdocumentation.org/packages/MASS/versions/7.3-56/topics/lqs
>
> https://stat.ethz.ch/pipermail/r-help/2006-October/115681.html
>
> https://stat.ethz.ch/pipermail/r-help/2007-March/126564.html
> -----
>
> ltsReg
>
> https://www.rdocumentation.org/packages/robustbase/versions/0.1-2/topics/ltsReg
> -----
> nl.lmsNM
> https://rdrr.io/cran/nlr/man/nl.lmsNM.html
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @v|gro@@ @end|ng |rom ver|zon@net  Sat Apr 16 23:06:16 2022
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Sat, 16 Apr 2022 21:06:16 +0000 (UTC)
Subject: [R] What are the pros and cons of the various R functions and
 methods for conducting least median of squares regression analysis?
In-Reply-To: <CAHfBD2dVadhPZwAvG-+EvzQLk5faBOf-nTbtXdvJM0K7gQsTHQ@mail.gmail.com>
References: <CAHfBD2dVadhPZwAvG-+EvzQLk5faBOf-nTbtXdvJM0K7gQsTHQ@mail.gmail.com>
Message-ID: <282294923.270109.1650143176208@mail.yahoo.com>

Kelly,
I am not going to answer your question directly as I have no experience with all?those packages and others.
Your question is very broad as you have not told us what your criteria and needs are.
For some purposes, the package to use may be one that has been around, seems?to continue to be supported, has had many kinks and errors straightened out and?so on.
For other purposes, a package often comes with lots of other "related" functionality?and often? uses names that hide other functions you may use. If a package?also meets your other needs, or takes your data in the current format rather than?making you rearrange first or after it returns, or other such considerations, that may?be a valid set of criteria.
Do you care about various costs and overhead? You may not if your data is small and?there may be a huge difference if the function does too much that you do not need?or an inefficient algorithm. If your need is one-time, fine. If it will be used regularly,?you may want to use some testing while measuring use of time and memory and?anything else you care about which can include parallelization. In many cases,?you can view the source code and sometimes even copy some and modify for?your own use, especially if the function takes dozens of arguments you never expect to?use and your needs are far simpler.
And, realistically, if you work with others, it may work better to use whatever?they use, all else being close to equal.
I will say this is not the best place to ask such questions as the focus is on base R.?Some here prefer not to have questions even about some fairly commonly used?packages. But an abstract question about a plethora of packages, many not mentioned,?may get more answers like mine rather than useful ones.
Good luck.


-----Original Message-----
From: Kelly Thompson <kt1572757 at gmail.com>
To: r-help at r-project.org
Sent: Sat, Apr 16, 2022 2:45 pm
Subject: [R] What are the pros and cons of the various R functions and methods for conducting least median of squares regression analysis?

What are the pros and cons of the various R functions and methods for
conducting least median of squares regression analysis?

I know about these:

lqs, wth method = "lms" and lmsreg, which as I understan dit are equivalent

Mentions:
https://www.rdocumentation.org/packages/MASS/versions/7.3-56/topics/lqs

https://stat.ethz.ch/pipermail/r-help/2006-October/115681.html

https://stat.ethz.ch/pipermail/r-help/2007-March/126564.html
-----

ltsReg

https://www.rdocumentation.org/packages/robustbase/versions/0.1-2/topics/ltsReg
-----
nl.lmsNM
https://rdrr.io/cran/nlr/man/nl.lmsNM.html

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From tebert @end|ng |rom u||@edu  Sat Apr 16 23:24:01 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Sat, 16 Apr 2022 21:24:01 +0000
Subject: [R] What are the pros and cons of the various R functions and
 methods for conducting least median of squares regression analysis?
In-Reply-To: <282294923.270109.1650143176208@mail.yahoo.com>
References: <CAHfBD2dVadhPZwAvG-+EvzQLk5faBOf-nTbtXdvJM0K7gQsTHQ@mail.gmail.com>
 <282294923.270109.1650143176208@mail.yahoo.com>
Message-ID: <BN6PR2201MB15533D275761063871D60783CFF19@BN6PR2201MB1553.namprd22.prod.outlook.com>

If you want to publish, please consider a standard practice amongst similar published works. If you choose a different path please include something in the methods (or results) that justifies your choice.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Avi Gross via R-help
Sent: Saturday, April 16, 2022 5:06 PM
To: r-help at r-project.org
Subject: Re: [R] What are the pros and cons of the various R functions and methods for conducting least median of squares regression analysis?

[External Email]

Kelly,
I am not going to answer your question directly as I have no experience with all those packages and others.
Your question is very broad as you have not told us what your criteria and needs are.
For some purposes, the package to use may be one that has been around, seems to continue to be supported, has had many kinks and errors straightened out and so on.
For other purposes, a package often comes with lots of other "related" functionality and often  uses names that hide other functions you may use. If a package also meets your other needs, or takes your data in the current format rather than making you rearrange first or after it returns, or other such considerations, that may be a valid set of criteria.
Do you care about various costs and overhead? You may not if your data is small and there may be a huge difference if the function does too much that you do not need or an inefficient algorithm. If your need is one-time, fine. If it will be used regularly, you may want to use some testing while measuring use of time and memory and anything else you care about which can include parallelization. In many cases, you can view the source code and sometimes even copy some and modify for your own use, especially if the function takes dozens of arguments you never expect to use and your needs are far simpler.
And, realistically, if you work with others, it may work better to use whatever they use, all else being close to equal.
I will say this is not the best place to ask such questions as the focus is on base R. Some here prefer not to have questions even about some fairly commonly used packages. But an abstract question about a plethora of packages, many not mentioned, may get more answers like mine rather than useful ones.
Good luck.


-----Original Message-----
From: Kelly Thompson <kt1572757 at gmail.com>
To: r-help at r-project.org
Sent: Sat, Apr 16, 2022 2:45 pm
Subject: [R] What are the pros and cons of the various R functions and methods for conducting least median of squares regression analysis?

What are the pros and cons of the various R functions and methods for conducting least median of squares regression analysis?

I know about these:

lqs, wth method = "lms" and lmsreg, which as I understan dit are equivalent

Mentions:
https://urldefense.proofpoint.com/v2/url?u=https-3A__www.rdocumentation.org_packages_MASS_versions_7.3-2D56_topics_lqs&d=DwIFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=_zEwDLlbWFk6gkuQzftAosGBSMwnq_5rS1V6hVIBZl1myUn9umKcN0VneIpmXr6B&s=vscauL07vWisvXyVoUBen_zCqfalaC3leMuTHuZst9k&e=

https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_pipermail_r-2Dhelp_2006-2DOctober_115681.html&d=DwIFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=_zEwDLlbWFk6gkuQzftAosGBSMwnq_5rS1V6hVIBZl1myUn9umKcN0VneIpmXr6B&s=t3A6uGvwbeqNIjcEiU0xGXKPnQEpm0S1qx-kT-H2C1k&e=

https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_pipermail_r-2Dhelp_2007-2DMarch_126564.html&d=DwIFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=_zEwDLlbWFk6gkuQzftAosGBSMwnq_5rS1V6hVIBZl1myUn9umKcN0VneIpmXr6B&s=BZ-1JuUHIB_EOum5w9VylKe-3p_QP8cjkG6JZYYmsHE&e=
-----

ltsReg

https://urldefense.proofpoint.com/v2/url?u=https-3A__www.rdocumentation.org_packages_robustbase_versions_0.1-2D2_topics_ltsReg&d=DwIFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=_zEwDLlbWFk6gkuQzftAosGBSMwnq_5rS1V6hVIBZl1myUn9umKcN0VneIpmXr6B&s=R-1kVZt-7fnTeSJMKUPosRbdUv-twsm94Z3IU1UUF-8&e=
-----
nl.lmsNM
https://urldefense.proofpoint.com/v2/url?u=https-3A__rdrr.io_cran_nlr_man_nl.lmsNM.html&d=DwIFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=_zEwDLlbWFk6gkuQzftAosGBSMwnq_5rS1V6hVIBZl1myUn9umKcN0VneIpmXr6B&s=tV-d0Ud9qx8-R2ImO9z_6UVRSGQjuWLFqVALtj1v8RA&e=

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwIFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=_zEwDLlbWFk6gkuQzftAosGBSMwnq_5rS1V6hVIBZl1myUn9umKcN0VneIpmXr6B&s=8gVn_qg0HwKPP0oCbFb92VxY_lcC9QhhBQynMRosmf8&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwIFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=_zEwDLlbWFk6gkuQzftAosGBSMwnq_5rS1V6hVIBZl1myUn9umKcN0VneIpmXr6B&s=HFLWU5EtlPJUbpaXwBiTKKc76EFfuxa2Nu7_bTVwuHA&e=
and provide commented, minimal, self-contained, reproducible code.

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwIFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=_zEwDLlbWFk6gkuQzftAosGBSMwnq_5rS1V6hVIBZl1myUn9umKcN0VneIpmXr6B&s=8gVn_qg0HwKPP0oCbFb92VxY_lcC9QhhBQynMRosmf8&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwIFaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=_zEwDLlbWFk6gkuQzftAosGBSMwnq_5rS1V6hVIBZl1myUn9umKcN0VneIpmXr6B&s=HFLWU5EtlPJUbpaXwBiTKKc76EFfuxa2Nu7_bTVwuHA&e=
and provide commented, minimal, self-contained, reproducible code.

From e@ @end|ng |rom enr|co@chum@nn@net  Sun Apr 17 16:33:43 2022
From: e@ @end|ng |rom enr|co@chum@nn@net (Enrico Schumann)
Date: Sun, 17 Apr 2022 16:33:43 +0200
Subject: [R] What are the pros and cons of the various R functions and
 methods for conducting least median of squares regression analysis?
In-Reply-To: <CAHfBD2dVadhPZwAvG-+EvzQLk5faBOf-nTbtXdvJM0K7gQsTHQ@mail.gmail.com>
 (Kelly Thompson's message of "Sat, 16 Apr 2022 14:45:18 -0400")
References: <CAHfBD2dVadhPZwAvG-+EvzQLk5faBOf-nTbtXdvJM0K7gQsTHQ@mail.gmail.com>
Message-ID: <87k0bnwzi0.fsf@enricoschumann.net>

On Sat, 16 Apr 2022, Kelly Thompson writes:

> What are the pros and cons of the various R functions and methods for
> conducting least median of squares regression analysis?
>
> I know about these:
>
> lqs, wth method = "lms" and lmsreg, which as I understan dit are equivalent
>
> Mentions:
> https://www.rdocumentation.org/packages/MASS/versions/7.3-56/topics/lqs
>
> https://stat.ethz.ch/pipermail/r-help/2006-October/115681.html
>
> https://stat.ethz.ch/pipermail/r-help/2007-March/126564.html
> -----
>
> ltsReg
>
> https://www.rdocumentation.org/packages/robustbase/versions/0.1-2/topics/ltsReg
> -----
> nl.lmsNM
> https://rdrr.io/cran/nlr/man/nl.lmsNM.html
>

There is also a special mailing list for robust statistics with R:
https://stat.ethz.ch/mailman/listinfo/R-sig-Robust

As others have already suggested: you'd probably get
better answers if you ask more specific questions,
e.g. why/for what application you want to use LMS.


-- 
Enrico Schumann
Lucerne, Switzerland
http://enricoschumann.net


From r@ubb@|@h115 @end|ng |rom gm@||@com  Sat Apr 16 08:19:05 2022
From: r@ubb@|@h115 @end|ng |rom gm@||@com (Roopa Subbaiah)
Date: Sat, 16 Apr 2022 11:49:05 +0530
Subject: [R] Need help with netmeta package
In-Reply-To: <CAGxFJbRNE3JntChzRUkbnC1cjMWr93LijK4cBa3--ET9C-=TiQ@mail.gmail.com>
References: <CAHudoO3Q+xrW5yOsgdkSQvLV9D63LeAC6wWWsCK_0ySw=uXK0A@mail.gmail.com>
 <CAGxFJbRNE3JntChzRUkbnC1cjMWr93LijK4cBa3--ET9C-=TiQ@mail.gmail.com>
Message-ID: <CAHudoO29dFPf3j3cTguuZuUSff6RK15BXf8X7ecXvrnJ87wBiQ@mail.gmail.com>

Dear Bert,


Thank you. Will do the same

Regards, Roopa

On Sat 16 Apr, 2022, 2:22 AM Bert Gunter <bgunter.4567 at gmail.com wrote:

> While you *may* get a useful reply here, there is an
> r-sig-meta-analysis list to which this would be better posted:
> https://stat.ethz.ch/mailman/listinfo/r-sig-meta-analysis
>
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> On Fri, Apr 15, 2022 at 1:04 PM Roopa Subbaiah <rsubbaiah115 at gmail.com>
> wrote:
> >
> > Hi all,
> >
> > We are conducting network metaanalysis of 3 treatments compared to
> placebo
> > using netmeta analysis. We have mean sd values for an outcome. How do we
> > calculate z scores using netmeta package? Thank you
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From neh@@bo|ogn@90 @end|ng |rom gm@||@com  Tue Apr 19 19:08:37 2022
From: neh@@bo|ogn@90 @end|ng |rom gm@||@com (Neha gupta)
Date: Tue, 19 Apr 2022 19:08:37 +0200
Subject: [R] How to output ROC/AUC in caret?
Message-ID: <CA+nrPntABRjznfvmbSkbkCh-mmNWMOJK4BomzF+FN3NAtK8Xbw@mail.gmail.com>

Hello everyone

I use the caret library to train a model and need to output ROC/AUC score,
however, caret outputs 'Accuracy' and not ROC/AUC.

The code is here

cv.folds <- createMultiFolds(train$TYPE, k = 10, times = 3)

ctrl <- trainControl(method = "cv",number=3, index = cv.folds, classProbs =
TRUE, summaryFunction = multiClassSummary)


m= train(y = train_label, x = train_x,
      method = "rpart" , na.action = na.pass,
      metric = "ROC",
      preProc = c("center", "scale", "nzv"),
      trControl = ctrl)

p=predict(m, test_x)
confusionMatrix(p, as.factor(test_label))

	[[alternative HTML version deleted]]


From r@turner @end|ng |rom @uck|@nd@@c@nz  Wed Apr 20 00:32:43 2022
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Wed, 20 Apr 2022 10:32:43 +1200
Subject: [R] How to output ROC/AUC in caret?
In-Reply-To: <CA+nrPntABRjznfvmbSkbkCh-mmNWMOJK4BomzF+FN3NAtK8Xbw@mail.gmail.com>
References: <CA+nrPntABRjznfvmbSkbkCh-mmNWMOJK4BomzF+FN3NAtK8Xbw@mail.gmail.com>
Message-ID: <20220420103243.6fc74847@rolf-Latitude-E7470>


On Tue, 19 Apr 2022 19:08:37 +0200
Neha gupta <neha.bologna90 at gmail.com> wrote:

> Hello everyone
> 
> I use the caret library to train a model and need to output ROC/AUC
> score, however, caret outputs 'Accuracy' and not ROC/AUC.

Should you not be contacting the maintainer of the caret *package*
(*NOT* library!!!) rather than R-help?  (Type 'maintainer("caret") in
the R console.)

cheers,

Rolf Turner

P.S. Please read the posting guide; in particular learn how to post in
*plain text* (not in html).

R. T.

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From e||z@_botto @end|ng |rom out|ook@com  Wed Apr 20 08:18:14 2022
From: e||z@_botto @end|ng |rom out|ook@com (Eliza Botto)
Date: Wed, 20 Apr 2022 06:18:14 +0000
Subject: [R] Executing index value for unequal vector lengths
Message-ID: <VI1PR0501MB2640A624ED54820D81FB14939AF59@VI1PR0501MB2640.eurprd05.prod.outlook.com>

Good day useRs,

I have the data of two vectors

> dput(DDD)
c(1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997,
1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008,
2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019,
2020, 2021)

> dput(EEE)
c(2018, 2019, 2020, 2021)

You can see that 2018, 2019, 2020, 2021 are equal in both vectors.

I want to execute the index values for the values in DDD which are equal to EEE (31,32,33,34); and also the index values where EEE values are equal to DDD (1,2,3,4).

I tried the following commend but it didn't work

>which(EEE==DDD))

I thank-you very much in advance

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Wed Apr 20 08:34:22 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Wed, 20 Apr 2022 09:34:22 +0300
Subject: [R] Executing index value for unequal vector lengths
In-Reply-To: <VI1PR0501MB2640A624ED54820D81FB14939AF59@VI1PR0501MB2640.eurprd05.prod.outlook.com>
References: <VI1PR0501MB2640A624ED54820D81FB14939AF59@VI1PR0501MB2640.eurprd05.prod.outlook.com>
Message-ID: <20220420093422.080ef405@Tarkus>

On Wed, 20 Apr 2022 06:18:14 +0000
Eliza Botto <eliza_botto at outlook.com> wrote:

> EEE==DDD

== doesn't work because it's element-wise. Try the %in% operator, or
setdiff() if you know that EEE and DDD are sets and you'd like to be
fancy.

-- 
Best regards,
Ivan


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed Apr 20 08:37:16 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Tue, 19 Apr 2022 23:37:16 -0700
Subject: [R] Executing index value for unequal vector lengths
In-Reply-To: <VI1PR0501MB2640A624ED54820D81FB14939AF59@VI1PR0501MB2640.eurprd05.prod.outlook.com>
References: <VI1PR0501MB2640A624ED54820D81FB14939AF59@VI1PR0501MB2640.eurprd05.prod.outlook.com>
Message-ID: <599311A2-F94E-4A46-BE52-01699BA45C0E@dcn.davis.ca.us>

?match

On April 19, 2022 11:18:14 PM PDT, Eliza Botto <eliza_botto at outlook.com> wrote:
>Good day useRs,
>
>I have the data of two vectors
>
>> dput(DDD)
>c(1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997,
>1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008,
>2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019,
>2020, 2021)
>
>> dput(EEE)
>c(2018, 2019, 2020, 2021)
>
>You can see that 2018, 2019, 2020, 2021 are equal in both vectors.
>
>I want to execute the index values for the values in DDD which are equal to EEE (31,32,33,34); and also the index values where EEE values are equal to DDD (1,2,3,4).
>
>I tried the following commend but it didn't work
>
>>which(EEE==DDD))
>
>I thank-you very much in advance
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From e||z@_botto @end|ng |rom out|ook@com  Wed Apr 20 11:14:02 2022
From: e||z@_botto @end|ng |rom out|ook@com (Eliza Botto)
Date: Wed, 20 Apr 2022 09:14:02 +0000
Subject: [R] Sorted index of values in matrix
In-Reply-To: <VI1PR0501MB2640475BF7CAB03F236C2FEB9AEE9@VI1PR0501MB2640.eurprd05.prod.outlook.com>
References: <VI1PR0501MB26408188825DBD86941BEA4A9AEE9@VI1PR0501MB2640.eurprd05.prod.outlook.com>
 <558AB668-6441-40BE-AEF8-06CD28155D9E@dcn.davis.ca.us>
 <CAGxFJbR4eL6a0nqFW0bcoj+srhdyHM2Gktt1St-zfp7ZdfuXNQ@mail.gmail.com>
 <CAGxFJbSqaYTJwGa7gOe=tTW2_-pN0Xgu3PpYysYxdG_jQ+fX5g@mail.gmail.com>
 <VI1PR0501MB2640475BF7CAB03F236C2FEB9AEE9@VI1PR0501MB2640.eurprd05.prod.outlook.com>
Message-ID: <VI1PR0501MB264098F363961E5C821B79039AF59@VI1PR0501MB2640.eurprd05.prod.outlook.com>

Thankyou for your assistance. ?
________________________________
From: R-help <r-help-bounces at r-project.org> on behalf of Eliza Botto <eliza_botto at outlook.com>
Sent: Friday 15 April 2022 23:51
To: Bert Gunter <bgunter.4567 at gmail.com>; Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
Cc: R-help <r-help at r-project.org>
Subject: Re: [R] Sorted index of values in matrix

Thankyou very much. It worked.


Eliza
________________________________
From: Bert Gunter <bgunter.4567 at gmail.com>
Sent: Friday 15 April 2022 17:00
To: Jeff Newmiller <jdnewmil at dcn.davis.ca.us>
Cc: R-help <r-help at r-project.org>; Eliza Botto <eliza_botto at outlook.com>
Subject: Re: [R] Sorted index of values in matrix

...
But Ivan's solution -- which I had to think about -- is better, and it
also generalizes to arbitrary arrays:

arrayInd(order(qq), .dim = dim(qq))

Bert Gunter


On Fri, Apr 15, 2022 at 9:25 AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> ... and here is another version of Jeff's solution using the built in
> row() and col() functions instead of explicitly creating the indices
> (but his version generalizes to arbitrary arrays; this does not):
>
>  qq <- matrix(12:7, nrow =3) ## start with a non-sorted matrix
> > qq
>      [,1] [,2]
> [1,]   12    9
> [2,]   11    8
> [3,]   10    7
> > sort(qq)
> [1]  7  8  9 10 11 12 ## the sorted values
>
> > o <- order(qq)
> > cbind(row(qq)[o], col(qq)[o])
> ## matrix of (row, col) indices of sorted values in original unsorted matrix
>      [,1] [,2]
> [1,]    3    2
> [2,]    2    2
> [3,]    1    2
> [4,]    3    1
> [5,]    2    1
> [6,]    1    1
>
> Cheers,
> Bert Gunter
>
> On Fri, Apr 15, 2022 at 8:33 AM Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
> >
> > Please stop posting in HTML format.
> >
> > I think your specified result coordinates are in (col,row) order, which is not normal for R. The solution below yields (row,col) order.
> >
> > qq <- structure(1:6, .Dim = 3:2, .Dimnames = list(c("1", "2", "3"), c("1", "2")))
> > pos <- expand.grid( r = seq.int( nrow( qq ) )
> >                   , c = seq.int( ncol( qq ) ) )
> > qq #'confirm source layout is column major
> > pos[ order( qq ), ] # (row,col)
> > pos[ order( qq ), 2:1 ] # (col,row)
> >
> >
> > On April 15, 2022 7:53:36 AM PDT, Eliza Botto <eliza_botto at outlook.com> wrote:
> > >deaR useRs,
> > >
> > >I have this following simple dataset
> > >
> > >> dput(qq)
> > >
> > >structure(1:6, .Dim = 3:2, .Dimnames = list(c("1", "2", "3"),
> > >    c("1", "2")))
> > >
> > >I want to extract row and column index of the sorted values of this matrix
> > >
> > >For example,
> > >
> > >sort(qq) command will execute the sorted values of this matrix as (1 2 3 4 5 6). Instead of values, I want the row and column names of these sorted values as (1,1), (1,2), (1,3), (2,1), (2,2), (2,3)
> > >
> > >I thankyou very much in advance for your help.
> > >
> > >Eliza
> > >
> > >
> > >       [[alternative HTML version deleted]]
> > >
> > >______________________________________________
> > >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > >https://stat.ethz.ch/mailman/listinfo/r-help
> > >PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > >and provide commented, minimal, self-contained, reproducible code.
> >
> > --
> > Sent from my phone. Please excuse my brevity.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Wed Apr 20 17:27:54 2022
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Wed, 20 Apr 2022 15:27:54 +0000
Subject: [R] A simple lattice histogram
Message-ID: <BL0PR01MB4036FCC6A4F8BFD5A682F2D8FAF59@BL0PR01MB4036.prod.exchangelabs.com>

I am struggling with a simple histogram where scales of x-axis should be free. ?Each panel should only show the range relevant for data plotted in that panel. ?

library(lattice)
library(AER)
data(CreditCard)
histogram( ~ card + reports, data = CreditCard, scales = "free")

This code creates two panels of histograms. ?But each panel has x-axis range from 0 to 14 and "yes" and "no". ?I want a graph where "card" panel x-axis only has "yes" and "no" and where "reports" panel only has numbers 0 to 14. ?

How can this code be fixed?

Thanks,
Naresh

From rmh @end|ng |rom temp|e@edu  Wed Apr 20 18:02:57 2022
From: rmh @end|ng |rom temp|e@edu (Richard M. Heiberger)
Date: Wed, 20 Apr 2022 16:02:57 +0000
Subject: [R] [External]  A simple lattice histogram
In-Reply-To: <BL0PR01MB4036FCC6A4F8BFD5A682F2D8FAF59@BL0PR01MB4036.prod.exchangelabs.com>
References: <BL0PR01MB4036FCC6A4F8BFD5A682F2D8FAF59@BL0PR01MB4036.prod.exchangelabs.com>
Message-ID: <87255278-B0D0-4E17-8298-DCB18612D073@temple.edu>

start here

 library(latticeExtra)
 c(histogram(~ card, data=CreditCard), histogram(~ reports, data=CreditCard))

then continue with

 resizePanels(c(histogram(~ card, data=CreditCard), histogram(~ reports, data=CreditCard), y.same=TRUE), w=c(2,16))

> On Apr 20, 2022, at 11:27, Naresh Gurbuxani <naresh_gurbuxani at hotmail.com> wrote:
> 
> library(lattice)
> library(AER)
> data(CreditCard)
> histogram( ~ card + reports, data = CreditCard, scales = "free")


From j@vedbtk111 @end|ng |rom gm@||@com  Wed Apr 20 21:50:52 2022
From: j@vedbtk111 @end|ng |rom gm@||@com (javed khan)
Date: Wed, 20 Apr 2022 21:50:52 +0200
Subject: [R] NAs error in caret function
Message-ID: <CAJhui+tqBbnRv-ghVxTof=dkuFi7_vwQ7G=FuYXGTte7qp7cfQ@mail.gmail.com>

Caret produce the error: Something is wrong; all the Accuracy metric values
are missing:
    logLoss         AUC          prAUC        Accuracy       Kappa
 Min.   : NA   Min.   : NA   Min.   : NA   Min.   : NA   Min.   : NA
 1st Qu.: NA   1st Qu.: NA   1st Qu.: NA   1st Qu.: NA   1st Qu.: NA
 Median : NA   Median : NA   Median : NA   Median : NA   Median : NA

We (group of three) working on an assignment and could not fix this error
from a few days. The error comes with the majority of the models while with
a few model (e.g. nb), the code works. The data is text-based
classification.

Some Warnings are:

Warning messages:
1: In train.default(y = train_label, x = train_x, method = "pls",  ... :
  The metric "ROC" was not in the result set. logLoss will be used instead.
2: model fit failed for Fold01.Rep1: ncomp=3 Error in
`[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
  replacement has 320292 rows, data has 1148

3: model fit failed for Fold02.Rep1: ncomp=3 Error in
`[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
  replacement has 320013 rows, data has 1147

4: model fit failed for Fold03.Rep1: ncomp=3 Error in
`[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
  replacement has 320013 rows, data has 1147

5: model fit failed for Fold04.Rep1: ncomp=3 Error in
`[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
  replacement has 320292 rows, data has 1148

6: model fit failed for Fold05.Rep1: ncomp=3 Error in
`[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
  replacement has 320013 rows, data has 1147

7: model fit failed for Fold06.Rep1: ncomp=3 Error in
`[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
  replacement has 320013 rows, data has 1147



Code is


m= train(y = train_label, x = train_x,
      method = "pls" ,
      metric = "Accuracy",
      ## #  preProc = c("center", "scale", "nzv"),
      trControl = ctrl)

p=predict(m, test_x)
confusionMatrix(p, as.factor(test_label))

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Wed Apr 20 22:25:51 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 20 Apr 2022 13:25:51 -0700
Subject: [R] NAs error in caret function
In-Reply-To: <CAJhui+tqBbnRv-ghVxTof=dkuFi7_vwQ7G=FuYXGTte7qp7cfQ@mail.gmail.com>
References: <CAJhui+tqBbnRv-ghVxTof=dkuFi7_vwQ7G=FuYXGTte7qp7cfQ@mail.gmail.com>
Message-ID: <CAGxFJbQqSfm7kptTY3z=72ELVqk68a76GBrjNVHdw_qmSUN=Ag@mail.gmail.com>

A quick web search on 'R caret package' found a host of useful
results, the first of which was this:
https://topepo.github.io/caret/
Note that the author, Max Kuhn, explicitly says there that you can
email him with questions. I think you should do so, as you do not seem
to be making progress here.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Wed, Apr 20, 2022 at 12:51 PM javed khan <javedbtk111 at gmail.com> wrote:
>
> Caret produce the error: Something is wrong; all the Accuracy metric values
> are missing:
>     logLoss         AUC          prAUC        Accuracy       Kappa
>  Min.   : NA   Min.   : NA   Min.   : NA   Min.   : NA   Min.   : NA
>  1st Qu.: NA   1st Qu.: NA   1st Qu.: NA   1st Qu.: NA   1st Qu.: NA
>  Median : NA   Median : NA   Median : NA   Median : NA   Median : NA
>
> We (group of three) working on an assignment and could not fix this error
> from a few days. The error comes with the majority of the models while with
> a few model (e.g. nb), the code works. The data is text-based
> classification.
>
> Some Warnings are:
>
> Warning messages:
> 1: In train.default(y = train_label, x = train_x, method = "pls",  ... :
>   The metric "ROC" was not in the result set. logLoss will be used instead.
> 2: model fit failed for Fold01.Rep1: ncomp=3 Error in
> `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>   replacement has 320292 rows, data has 1148
>
> 3: model fit failed for Fold02.Rep1: ncomp=3 Error in
> `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>   replacement has 320013 rows, data has 1147
>
> 4: model fit failed for Fold03.Rep1: ncomp=3 Error in
> `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>   replacement has 320013 rows, data has 1147
>
> 5: model fit failed for Fold04.Rep1: ncomp=3 Error in
> `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>   replacement has 320292 rows, data has 1148
>
> 6: model fit failed for Fold05.Rep1: ncomp=3 Error in
> `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>   replacement has 320013 rows, data has 1147
>
> 7: model fit failed for Fold06.Rep1: ncomp=3 Error in
> `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>   replacement has 320013 rows, data has 1147
>
>
>
> Code is
>
>
> m= train(y = train_label, x = train_x,
>       method = "pls" ,
>       metric = "Accuracy",
>       ## #  preProc = c("center", "scale", "nzv"),
>       trControl = ctrl)
>
> p=predict(m, test_x)
> confusionMatrix(p, as.factor(test_label))
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Wed Apr 20 23:01:47 2022
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Wed, 20 Apr 2022 21:01:47 +0000
Subject: [R] [External]  A simple lattice histogram
In-Reply-To: <87255278-B0D0-4E17-8298-DCB18612D073@temple.edu>
References: <BL0PR01MB4036FCC6A4F8BFD5A682F2D8FAF59@BL0PR01MB4036.prod.exchangelabs.com>
 <87255278-B0D0-4E17-8298-DCB18612D073@temple.edu>
Message-ID: <BL0PR01MB4036160B9EF606B0E8E16485FAF59@BL0PR01MB4036.prod.exchangelabs.com>

Richard,

Thanks?for your quick response. ?Since I also want the name of the variable in the histogram, I settled for below code.? Not an elegant solution, but displays what I want.  

reports.hist <- histogram(~ reports, data = CreditCard)
income.hist <- histogram(~ income, data = CreditCard)
share.hist <- histogram(~ share, data = CreditCard)
dependents.hist <- histogram(~ dependents, data = CreditCard)
plot(reports.hist, c(0, 0.5, 0.5, 1), more = TRUE)
plot(income.hist, c(0.5, 0.5, 1, 1), more = TRUE)
plot(share.hist, c(0, 0, 0.5, 0.5), more = TRUE)
plot(dependents.hist, c(0.5, 0, 1, 0.5), more = FALSE)

Naresh

From: Richard M. Heiberger <rmh at temple.edu>
Sent: Wednesday, April 20, 2022 12:02 PM
To: Naresh Gurbuxani <naresh_gurbuxani at hotmail.com>
Cc: r-help at r-project.org <r-help at R-project.org>
Subject: Re: [External] [R] A simple lattice histogram 
?
start here

?library(latticeExtra)
?c(histogram(~ card, data=CreditCard), histogram(~ reports, data=CreditCard))

then continue with

?resizePanels(c(histogram(~ card, data=CreditCard), histogram(~ reports, data=CreditCard), y.same=TRUE), w=c(2,16))

> On Apr 20, 2022, at 11:27, Naresh Gurbuxani <naresh_gurbuxani at hotmail.com> wrote:
> 
> library(lattice)
> library(AER)
> data(CreditCard)
> histogram( ~ card + reports, data = CreditCard, scales = "free")


From co|or|e @end|ng |rom gm@||@com  Wed Apr 20 23:09:47 2022
From: co|or|e @end|ng |rom gm@||@com (Carlos Ortega)
Date: Wed, 20 Apr 2022 23:09:47 +0200
Subject: [R] NAs error in caret function
In-Reply-To: <CAGxFJbQqSfm7kptTY3z=72ELVqk68a76GBrjNVHdw_qmSUN=Ag@mail.gmail.com>
References: <CAJhui+tqBbnRv-ghVxTof=dkuFi7_vwQ7G=FuYXGTte7qp7cfQ@mail.gmail.com>
 <CAGxFJbQqSfm7kptTY3z=72ELVqk68a76GBrjNVHdw_qmSUN=Ag@mail.gmail.com>
Message-ID: <CAFKNbkLyLUr90bnmGBEbGH+uOEpBaqqps1NAkLrac4p=MnKWoQ@mail.gmail.com>

Hi,

There are many things than could be wrong:

1. What is inside "ctrl" in the trainControl argument ?
2. Your model is a classication one, but if you do not configure correctly
"ctrl" you do not get out the metrics correctly. It depends if your model
is binary or multi-class.
3. Another thing is that if it is a classification one, you should also
check that in the "train()" you "train_label" is a factor.

On top of that, remember that your problem is not reproducible.
If you attach a portion of your data, we could create a working "caret"
code.

Thanks,
Carlos Ortega.

On Wed, Apr 20, 2022 at 10:26 PM Bert Gunter <bgunter.4567 at gmail.com> wrote:

> A quick web search on 'R caret package' found a host of useful
> results, the first of which was this:
> https://topepo.github.io/caret/
> Note that the author, Max Kuhn, explicitly says there that you can
> email him with questions. I think you should do so, as you do not seem
> to be making progress here.
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> On Wed, Apr 20, 2022 at 12:51 PM javed khan <javedbtk111 at gmail.com> wrote:
> >
> > Caret produce the error: Something is wrong; all the Accuracy metric
> values
> > are missing:
> >     logLoss         AUC          prAUC        Accuracy       Kappa
> >  Min.   : NA   Min.   : NA   Min.   : NA   Min.   : NA   Min.   : NA
> >  1st Qu.: NA   1st Qu.: NA   1st Qu.: NA   1st Qu.: NA   1st Qu.: NA
> >  Median : NA   Median : NA   Median : NA   Median : NA   Median : NA
> >
> > We (group of three) working on an assignment and could not fix this error
> > from a few days. The error comes with the majority of the models while
> with
> > a few model (e.g. nb), the code works. The data is text-based
> > classification.
> >
> > Some Warnings are:
> >
> > Warning messages:
> > 1: In train.default(y = train_label, x = train_x, method = "pls",  ... :
> >   The metric "ROC" was not in the result set. logLoss will be used
> instead.
> > 2: model fit failed for Fold01.Rep1: ncomp=3 Error in
> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
> >   replacement has 320292 rows, data has 1148
> >
> > 3: model fit failed for Fold02.Rep1: ncomp=3 Error in
> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
> >   replacement has 320013 rows, data has 1147
> >
> > 4: model fit failed for Fold03.Rep1: ncomp=3 Error in
> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
> >   replacement has 320013 rows, data has 1147
> >
> > 5: model fit failed for Fold04.Rep1: ncomp=3 Error in
> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
> >   replacement has 320292 rows, data has 1148
> >
> > 6: model fit failed for Fold05.Rep1: ncomp=3 Error in
> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
> >   replacement has 320013 rows, data has 1147
> >
> > 7: model fit failed for Fold06.Rep1: ncomp=3 Error in
> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
> >   replacement has 320013 rows, data has 1147
> >
> >
> >
> > Code is
> >
> >
> > m= train(y = train_label, x = train_x,
> >       method = "pls" ,
> >       metric = "Accuracy",
> >       ## #  preProc = c("center", "scale", "nzv"),
> >       trControl = ctrl)
> >
> > p=predict(m, test_x)
> > confusionMatrix(p, as.factor(test_label))
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From j@vedbtk111 @end|ng |rom gm@||@com  Thu Apr 21 00:59:18 2022
From: j@vedbtk111 @end|ng |rom gm@||@com (javed khan)
Date: Thu, 21 Apr 2022 00:59:18 +0200
Subject: [R] NAs error in caret function
In-Reply-To: <CAFKNbkLyLUr90bnmGBEbGH+uOEpBaqqps1NAkLrac4p=MnKWoQ@mail.gmail.com>
References: <CAJhui+tqBbnRv-ghVxTof=dkuFi7_vwQ7G=FuYXGTte7qp7cfQ@mail.gmail.com>
 <CAGxFJbQqSfm7kptTY3z=72ELVqk68a76GBrjNVHdw_qmSUN=Ag@mail.gmail.com>
 <CAFKNbkLyLUr90bnmGBEbGH+uOEpBaqqps1NAkLrac4p=MnKWoQ@mail.gmail.com>
Message-ID: <CAJhui+uv+a-UkRK827b2sa7JH_PCq9RiEQO68QurE4Q57RzrPg@mail.gmail.com>

Carlos Ortega, thank you for your answer.

Class label has three values (Bug, Codel smell and Vulnerability). X is a
text-based feature that include English statements and we performed some
preprocessing such as removing symbols, lower-case etc.

Yes, train_label is a factor class.

*I can provide the whole code and data if needed. We followed the same
method provided in this tutorial*

*https://algotech.netlify.app/blog/text-lime/
<https://algotech.netlify.app/blog/text-lime/> *


cv.folds <- createMultiFolds(train$TYPE, k = 10, times = 3)

ctrl <- trainControl(method = "cv",number=3, index = cv.folds, classProbs =
TRUE, summaryFunction = multiClassSummary)
m= train(y = train_label, x = train_x,
      method = "knn" ,
      metric = "Accuracy",
      ## #  preProc = c("center", "scale", "nzv"),
      trControl = ctrl)

p=predict(m, test_x)
confusionMatrix(p, as.factor(test_label))

With some models, it show error like: Error in { :
  task 1 failed - "Not all variable names used in object found in newdata"

However, when I run the base models like naiveBayes, it works.

model_bayes <- naiveBayes(train_x, train_label, laplace = 1)


On Wed, Apr 20, 2022 at 11:09 PM Carlos Ortega <coforfe at gmail.com> wrote:

> Hi,
>
> There are many things than could be wrong:
>
> 1. What is inside "ctrl" in the trainControl argument ?
> 2. Your model is a classication one, but if you do not configure correctly
> "ctrl" you do not get out the metrics correctly. It depends if your model
> is binary or multi-class.
> 3. Another thing is that if it is a classification one, you should also
> check that in the "train()" you "train_label" is a factor.
>
> On top of that, remember that your problem is not reproducible.
> If you attach a portion of your data, we could create a working "caret"
> code.
>
> Thanks,
> Carlos Ortega.
>
> On Wed, Apr 20, 2022 at 10:26 PM Bert Gunter <bgunter.4567 at gmail.com>
> wrote:
>
>> A quick web search on 'R caret package' found a host of useful
>> results, the first of which was this:
>> https://topepo.github.io/caret/
>> Note that the author, Max Kuhn, explicitly says there that you can
>> email him with questions. I think you should do so, as you do not seem
>> to be making progress here.
>>
>> Bert Gunter
>>
>> "The trouble with having an open mind is that people keep coming along
>> and sticking things into it."
>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>
>> On Wed, Apr 20, 2022 at 12:51 PM javed khan <javedbtk111 at gmail.com>
>> wrote:
>> >
>> > Caret produce the error: Something is wrong; all the Accuracy metric
>> values
>> > are missing:
>> >     logLoss         AUC          prAUC        Accuracy       Kappa
>> >  Min.   : NA   Min.   : NA   Min.   : NA   Min.   : NA   Min.   : NA
>> >  1st Qu.: NA   1st Qu.: NA   1st Qu.: NA   1st Qu.: NA   1st Qu.: NA
>> >  Median : NA   Median : NA   Median : NA   Median : NA   Median : NA
>> >
>> > We (group of three) working on an assignment and could not fix this
>> error
>> > from a few days. The error comes with the majority of the models while
>> with
>> > a few model (e.g. nb), the code works. The data is text-based
>> > classification.
>> >
>> > Some Warnings are:
>> >
>> > Warning messages:
>> > 1: In train.default(y = train_label, x = train_x, method = "pls",  ... :
>> >   The metric "ROC" was not in the result set. logLoss will be used
>> instead.
>> > 2: model fit failed for Fold01.Rep1: ncomp=3 Error in
>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>> >   replacement has 320292 rows, data has 1148
>> >
>> > 3: model fit failed for Fold02.Rep1: ncomp=3 Error in
>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>> >   replacement has 320013 rows, data has 1147
>> >
>> > 4: model fit failed for Fold03.Rep1: ncomp=3 Error in
>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>> >   replacement has 320013 rows, data has 1147
>> >
>> > 5: model fit failed for Fold04.Rep1: ncomp=3 Error in
>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>> >   replacement has 320292 rows, data has 1148
>> >
>> > 6: model fit failed for Fold05.Rep1: ncomp=3 Error in
>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>> >   replacement has 320013 rows, data has 1147
>> >
>> > 7: model fit failed for Fold06.Rep1: ncomp=3 Error in
>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>> >   replacement has 320013 rows, data has 1147
>> >
>> >
>> >
>> > Code is
>> >
>> >
>> > m= train(y = train_label, x = train_x,
>> >       method = "pls" ,
>> >       metric = "Accuracy",
>> >       ## #  preProc = c("center", "scale", "nzv"),
>> >       trControl = ctrl)
>> >
>> > p=predict(m, test_x)
>> > confusionMatrix(p, as.factor(test_label))
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From p@u|bern@|07 @end|ng |rom gm@||@com  Thu Apr 21 05:37:57 2022
From: p@u|bern@|07 @end|ng |rom gm@||@com (Paul Bernal)
Date: Wed, 20 Apr 2022 22:37:57 -0500
Subject: [R] Model To Simulate Dice Roll
Message-ID: <CAMOcQfMMq7U0jjsGgfL3kQ=Gc4ZsMqZVaLP=SmguPJuhZTYRGg@mail.gmail.com>

Dear friends,

Hope you are doing well. I need to simulate a 1 dice roll for each one of
the twelve months of the year and perform 100 trials, so I thought of
constructing a dataframe with twelve columns and 100 rows the following way:

num_rows = 100

prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
colnames(prob_frame)<-c("January","February","March","April","May","June","July","August","September","October","November","December")

Now, using the dice package, I can simulate n number of dice rolls as
follows:
#performing simulation
dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides = dice_sides,
plot.it = TRUE)

What I would like to do is to populate each column and row with the results
of dice_simul.

Let me show you the structure of dice_simul:
> str(dice_simul)
Classes ?dice? and 'data.frame': 100 obs. of  1 variable:
 $ Red: int  2 2 1 2 5 4 4 6 1 4 ...
> dput(dice_simul)
structure(list(Red = c(2L, 2L, 1L, 2L, 5L, 4L, 4L, 6L, 1L, 4L,
4L, 2L, 6L, 2L, 2L, 1L, 3L, 6L, 1L, 5L, 5L, 5L, 3L, 4L, 2L, 6L,
4L, 6L, 6L, 2L, 1L, 2L, 2L, 6L, 4L, 2L, 3L, 5L, 6L, 6L, 4L, 5L,
4L, 6L, 6L, 3L, 4L, 1L, 5L, 3L, 3L, 5L, 3L, 4L, 1L, 3L, 3L, 2L,
4L, 1L, 2L, 1L, 6L, 3L, 5L, 5L, 3L, 4L, 4L, 5L, 4L, 1L, 5L, 3L,
4L, 4L, 3L, 6L, 5L, 2L, 4L, 1L, 1L, 6L, 4L, 3L, 6L, 5L, 6L, 2L,
6L, 1L, 6L, 6L, 4L, 3L, 4L, 2L, 1L, 5L)), class = c("dice", "data.frame"
), row.names = c(NA, -100L))

For example, the first number of dice_simul should go to row 1 for January,
the second number of dice_simul should go to row 1 for February, ... the
twelveth number of dice_simul should go to row 1 for December, the 13th
number should go to row 2 for january, and so on.

This is what I tried to do but doesn?t work they way I want to:

#1)dice_rolls which is the number of times the dice will be rolled
#2)num_dice which is the number of dice that will be rolled each time
#3)dice_sides which is the number of sides of the dice
#function dice will take each one of these variables as its parameter to
perform the simulation
dice_rolls = 100
num_dice   = 1
dice_sides = 6

#performing simulation
dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides = dice_sides,
plot.it = TRUE)

num_rows = 100

prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
colnames(prob_frame) <-
c("January","February","March","April","May","June","July","August","September","October","November","December")


for (j in 1:12){
  for (i in 1:num_rows){
    prob_frame[i,j]=dice_simul[i,1]
  }
}
I basically want to populate the twelve months for the first row, then the
twelve months for the second row, and so on, until I get to populate the
twelve months for the last row sequentially.

How could I accomplish this?

Any help and/or guidance will be greatly appreciated.

Best regards,
Paul

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Thu Apr 21 05:47:19 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 20 Apr 2022 20:47:19 -0700
Subject: [R] Model To Simulate Dice Roll
In-Reply-To: <CAMOcQfMMq7U0jjsGgfL3kQ=Gc4ZsMqZVaLP=SmguPJuhZTYRGg@mail.gmail.com>
References: <CAMOcQfMMq7U0jjsGgfL3kQ=Gc4ZsMqZVaLP=SmguPJuhZTYRGg@mail.gmail.com>
Message-ID: <CAGxFJbTwAqA9beG8FwUPY+v4S-jKMM8+3YjTqH0r_WO2JvOZ_Q@mail.gmail.com>

If I understand you correctly, it's simple.
Matrices in R are vectors with a dimension attribute. By default, they
are populated column by column. Use 'byrow = TRUE to populate by row
instead. For example:

> matrix (1:36, ncol = 12, byrow = TRUE)
     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
[1,]    1    2    3    4    5    6    7    8    9    10    11    12
[2,]   13   14   15   16   17   18   19   20   21    22    23    24
[3,]   25   26   27   28   29   30   31   32   33    34    35    36

I leave it to you to use the 'dimnames' argument of ?matrix  to give
names to the column and then subsequently convert to a data frame if
you like.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Wed, Apr 20, 2022 at 8:38 PM Paul Bernal <paulbernal07 at gmail.com> wrote:
>
> Dear friends,
>
> Hope you are doing well. I need to simulate a 1 dice roll for each one of
> the twelve months of the year and perform 100 trials, so I thought of
> constructing a dataframe with twelve columns and 100 rows the following way:
>
> num_rows = 100
>
> prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
> colnames(prob_frame)<-c("January","February","March","April","May","June","July","August","September","October","November","December")
>
> Now, using the dice package, I can simulate n number of dice rolls as
> follows:
> #performing simulation
> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides = dice_sides,
> plot.it = TRUE)
>
> What I would like to do is to populate each column and row with the results
> of dice_simul.
>
> Let me show you the structure of dice_simul:
> > str(dice_simul)
> Classes ?dice? and 'data.frame': 100 obs. of  1 variable:
>  $ Red: int  2 2 1 2 5 4 4 6 1 4 ...
> > dput(dice_simul)
> structure(list(Red = c(2L, 2L, 1L, 2L, 5L, 4L, 4L, 6L, 1L, 4L,
> 4L, 2L, 6L, 2L, 2L, 1L, 3L, 6L, 1L, 5L, 5L, 5L, 3L, 4L, 2L, 6L,
> 4L, 6L, 6L, 2L, 1L, 2L, 2L, 6L, 4L, 2L, 3L, 5L, 6L, 6L, 4L, 5L,
> 4L, 6L, 6L, 3L, 4L, 1L, 5L, 3L, 3L, 5L, 3L, 4L, 1L, 3L, 3L, 2L,
> 4L, 1L, 2L, 1L, 6L, 3L, 5L, 5L, 3L, 4L, 4L, 5L, 4L, 1L, 5L, 3L,
> 4L, 4L, 3L, 6L, 5L, 2L, 4L, 1L, 1L, 6L, 4L, 3L, 6L, 5L, 6L, 2L,
> 6L, 1L, 6L, 6L, 4L, 3L, 4L, 2L, 1L, 5L)), class = c("dice", "data.frame"
> ), row.names = c(NA, -100L))
>
> For example, the first number of dice_simul should go to row 1 for January,
> the second number of dice_simul should go to row 1 for February, ... the
> twelveth number of dice_simul should go to row 1 for December, the 13th
> number should go to row 2 for january, and so on.
>
> This is what I tried to do but doesn?t work they way I want to:
>
> #1)dice_rolls which is the number of times the dice will be rolled
> #2)num_dice which is the number of dice that will be rolled each time
> #3)dice_sides which is the number of sides of the dice
> #function dice will take each one of these variables as its parameter to
> perform the simulation
> dice_rolls = 100
> num_dice   = 1
> dice_sides = 6
>
> #performing simulation
> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides = dice_sides,
> plot.it = TRUE)
>
> num_rows = 100
>
> prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
> colnames(prob_frame) <-
> c("January","February","March","April","May","June","July","August","September","October","November","December")
>
>
> for (j in 1:12){
>   for (i in 1:num_rows){
>     prob_frame[i,j]=dice_simul[i,1]
>   }
> }
> I basically want to populate the twelve months for the first row, then the
> twelve months for the second row, and so on, until I get to populate the
> twelve months for the last row sequentially.
>
> How could I accomplish this?
>
> Any help and/or guidance will be greatly appreciated.
>
> Best regards,
> Paul
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From p@u|bern@|07 @end|ng |rom gm@||@com  Thu Apr 21 06:02:39 2022
From: p@u|bern@|07 @end|ng |rom gm@||@com (Paul Bernal)
Date: Wed, 20 Apr 2022 23:02:39 -0500
Subject: [R] Model To Simulate Dice Roll
In-Reply-To: <CAGxFJbTwAqA9beG8FwUPY+v4S-jKMM8+3YjTqH0r_WO2JvOZ_Q@mail.gmail.com>
References: <CAMOcQfMMq7U0jjsGgfL3kQ=Gc4ZsMqZVaLP=SmguPJuhZTYRGg@mail.gmail.com>
 <CAGxFJbTwAqA9beG8FwUPY+v4S-jKMM8+3YjTqH0r_WO2JvOZ_Q@mail.gmail.com>
Message-ID: <CAMOcQfOQG4camFLTHpesHUMd9L01tmUW0xHUQGDJK1dBQ=nAAw@mail.gmail.com>

Dear friend Bert,

Thank you so much for your kind reply. The first thing I need to do is to
simulate dice rolls, say 120 times.

I want to populate an m by 12 dataframe with the results of each dice roll.
For example, the result from dice roll #1 would need to go on row 1,
column1, the result from dice roll #2 would have to go in row 1 column 2,
and so on.

The reason why I want to store those results in a dataframe is to be able
to perform some other calculations afterwards.

This is for a project I am doing.

So this is the situation:
You and five friends ? a total of six people ? plan to meet once per month
to have dinner together, with one of you choosing the restaurant each
month. Rather than scheduling the entire year in advance, you decide to
make it interesting: each month a single six-sided die will be rolled to
determine which of you gets to choose the restaurant that month. How likely
is it that everyone will have a chance to eat at their own favorite
restaurant? That is, what is the probability p that over the next 12
months, each of you will have had at least one opportunity to choose where
to eat?

This is what I am asked to do:
Write a program to estimate the desired probability p via simulation. The
program should input a sequence of positive integer number of trials to
simulate using the language's pseudorandom number generator and calculate
the corresponding fractions of simulated trials that are ?successful"
(i.e., all 6 parties get at least one opportunity to choose where to eat.
Alice, Bob, Charley, Fred, Ellen, Don, Don, Don, Don, Alice, Charley, Bob
is a successful trial. Alice, Bob, Charley, Ellen, Don, Don, Don, Don,
Ellen, Alice, Charley, Bob is not a successful trial since Fred does not
get to choose.)
Turn in a set of 10 trials showing each roll of the dice to show
correctness. Label the out-comes. Keep in mind that a single trial requires
rolling the die twelve times. Calculate and print the average probability p
for the set. Please refer to your friends by name.

For this reason, I am trying to simulate the n trials, and then populate a
table with the results from the trials. I have to simulate a dice roll dice
for each month and for each row. Rows would be equivalent to years, and
then columns would be equivalent to the month of a particular year.

Once I store the results in a dataframe, everything is much easier.

I installed package dice and performed simulations by doing:
#declaring variables:
#1)dice_rolls which is the number of times the dice will be rolled
#2)num_dice which is the number of dice that will be rolled each time
#3)dice_sides which is the number of sides of the dice
#function dice will take each one of these variables as its parameter to
perform the simulation
dice_rolls = 120
num_dice   = 1
dice_sides = 6

#performing simulation
dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides = dice_sides,
plot.it = TRUE)

I tried the following, but did not work as expected:

for (i in 1:nrow(dice_simul)){
  for(j in 1:ncol(prob_frame)){
    for(k in 1:nrow(prob_frame)){
      prob_frame[k,j] = dice_simul[i,1]
    }
  }
}

I apologize for the long explanation.

Best regards,

Paul


El mi?, 20 abr 2022 a las 22:47, Bert Gunter (<bgunter.4567 at gmail.com>)
escribi?:

> If I understand you correctly, it's simple.
> Matrices in R are vectors with a dimension attribute. By default, they
> are populated column by column. Use 'byrow = TRUE to populate by row
> instead. For example:
>
> > matrix (1:36, ncol = 12, byrow = TRUE)
>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
> [1,]    1    2    3    4    5    6    7    8    9    10    11    12
> [2,]   13   14   15   16   17   18   19   20   21    22    23    24
> [3,]   25   26   27   28   29   30   31   32   33    34    35    36
>
> I leave it to you to use the 'dimnames' argument of ?matrix  to give
> names to the column and then subsequently convert to a data frame if
> you like.
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> On Wed, Apr 20, 2022 at 8:38 PM Paul Bernal <paulbernal07 at gmail.com>
> wrote:
> >
> > Dear friends,
> >
> > Hope you are doing well. I need to simulate a 1 dice roll for each one of
> > the twelve months of the year and perform 100 trials, so I thought of
> > constructing a dataframe with twelve columns and 100 rows the following
> way:
> >
> > num_rows = 100
> >
> > prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
> >
> colnames(prob_frame)<-c("January","February","March","April","May","June","July","August","September","October","November","December")
> >
> > Now, using the dice package, I can simulate n number of dice rolls as
> > follows:
> > #performing simulation
> > dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
> dice_sides,
> > plot.it = TRUE)
> >
> > What I would like to do is to populate each column and row with the
> results
> > of dice_simul.
> >
> > Let me show you the structure of dice_simul:
> > > str(dice_simul)
> > Classes ?dice? and 'data.frame': 100 obs. of  1 variable:
> >  $ Red: int  2 2 1 2 5 4 4 6 1 4 ...
> > > dput(dice_simul)
> > structure(list(Red = c(2L, 2L, 1L, 2L, 5L, 4L, 4L, 6L, 1L, 4L,
> > 4L, 2L, 6L, 2L, 2L, 1L, 3L, 6L, 1L, 5L, 5L, 5L, 3L, 4L, 2L, 6L,
> > 4L, 6L, 6L, 2L, 1L, 2L, 2L, 6L, 4L, 2L, 3L, 5L, 6L, 6L, 4L, 5L,
> > 4L, 6L, 6L, 3L, 4L, 1L, 5L, 3L, 3L, 5L, 3L, 4L, 1L, 3L, 3L, 2L,
> > 4L, 1L, 2L, 1L, 6L, 3L, 5L, 5L, 3L, 4L, 4L, 5L, 4L, 1L, 5L, 3L,
> > 4L, 4L, 3L, 6L, 5L, 2L, 4L, 1L, 1L, 6L, 4L, 3L, 6L, 5L, 6L, 2L,
> > 6L, 1L, 6L, 6L, 4L, 3L, 4L, 2L, 1L, 5L)), class = c("dice", "data.frame"
> > ), row.names = c(NA, -100L))
> >
> > For example, the first number of dice_simul should go to row 1 for
> January,
> > the second number of dice_simul should go to row 1 for February, ... the
> > twelveth number of dice_simul should go to row 1 for December, the 13th
> > number should go to row 2 for january, and so on.
> >
> > This is what I tried to do but doesn?t work they way I want to:
> >
> > #1)dice_rolls which is the number of times the dice will be rolled
> > #2)num_dice which is the number of dice that will be rolled each time
> > #3)dice_sides which is the number of sides of the dice
> > #function dice will take each one of these variables as its parameter to
> > perform the simulation
> > dice_rolls = 100
> > num_dice   = 1
> > dice_sides = 6
> >
> > #performing simulation
> > dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
> dice_sides,
> > plot.it = TRUE)
> >
> > num_rows = 100
> >
> > prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
> > colnames(prob_frame) <-
> >
> c("January","February","March","April","May","June","July","August","September","October","November","December")
> >
> >
> > for (j in 1:12){
> >   for (i in 1:num_rows){
> >     prob_frame[i,j]=dice_simul[i,1]
> >   }
> > }
> > I basically want to populate the twelve months for the first row, then
> the
> > twelve months for the second row, and so on, until I get to populate the
> > twelve months for the last row sequentially.
> >
> > How could I accomplish this?
> >
> > Any help and/or guidance will be greatly appreciated.
> >
> > Best regards,
> > Paul
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Thu Apr 21 06:30:56 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 20 Apr 2022 21:30:56 -0700
Subject: [R] Model To Simulate Dice Roll
In-Reply-To: <CAMOcQfOQG4camFLTHpesHUMd9L01tmUW0xHUQGDJK1dBQ=nAAw@mail.gmail.com>
References: <CAMOcQfMMq7U0jjsGgfL3kQ=Gc4ZsMqZVaLP=SmguPJuhZTYRGg@mail.gmail.com>
 <CAGxFJbTwAqA9beG8FwUPY+v4S-jKMM8+3YjTqH0r_WO2JvOZ_Q@mail.gmail.com>
 <CAMOcQfOQG4camFLTHpesHUMd9L01tmUW0xHUQGDJK1dBQ=nAAw@mail.gmail.com>
Message-ID: <CAGxFJbRdUsUZwfmEhKbOEaFiFie0TtWF0vHfgGb2h-m-B7doMA@mail.gmail.com>

I believe I gave you sufficient information (the vector of dice roll
results would replace 1:36 in my example). Furthermore, this sounds
like homework, which we try not to do here. But even if it is not, I
expect you to fill in the details based on what I have provided. If I
have misunderstood your query, I am sorry: I am too lazy to go through
your long explanation. If I have understood correctly, perhaps others
will be kinder and provide you the missing details that I did not.


Bert Gunter

On Wed, Apr 20, 2022 at 9:02 PM Paul Bernal <paulbernal07 at gmail.com> wrote:
>
> Dear friend Bert,
>
> Thank you so much for your kind reply. The first thing I need to do is to simulate dice rolls, say 120 times.
>
> I want to populate an m by 12 dataframe with the results of each dice roll. For example, the result from dice roll #1 would need to go on row 1, column1, the result from dice roll #2 would have to go in row 1 column 2, and so on.
>
> The reason why I want to store those results in a dataframe is to be able to perform some other calculations afterwards.
>
> This is for a project I am doing.
>
> So this is the situation:
> You and five friends ? a total of six people ? plan to meet once per month to have dinner together, with one of you choosing the restaurant each month. Rather than scheduling the entire year in advance, you decide to make it interesting: each month a single six-sided die will be rolled to determine which of you gets to choose the restaurant that month. How likely is it that everyone will have a chance to eat at their own favorite restaurant? That is, what is the probability p that over the next 12 months, each of you will have had at least one opportunity to choose where to eat?
>
> This is what I am asked to do:
> Write a program to estimate the desired probability p via simulation. The program should input a sequence of positive integer number of trials to simulate using the language's pseudorandom number generator and calculate the corresponding fractions of simulated trials that are ?successful" (i.e., all 6 parties get at least one opportunity to choose where to eat. Alice, Bob, Charley, Fred, Ellen, Don, Don, Don, Don, Alice, Charley, Bob is a successful trial. Alice, Bob, Charley, Ellen, Don, Don, Don, Don, Ellen, Alice, Charley, Bob is not a successful trial since Fred does not get to choose.)
> Turn in a set of 10 trials showing each roll of the dice to show correctness. Label the out-comes. Keep in mind that a single trial requires rolling the die twelve times. Calculate and print the average probability p for the set. Please refer to your friends by name.
>
> For this reason, I am trying to simulate the n trials, and then populate a table with the results from the trials. I have to simulate a dice roll dice for each month and for each row. Rows would be equivalent to years, and then columns would be equivalent to the month of a particular year.
>
> Once I store the results in a dataframe, everything is much easier.
>
> I installed package dice and performed simulations by doing:
> #declaring variables:
> #1)dice_rolls which is the number of times the dice will be rolled
> #2)num_dice which is the number of dice that will be rolled each time
> #3)dice_sides which is the number of sides of the dice
> #function dice will take each one of these variables as its parameter to perform the simulation
> dice_rolls = 120
> num_dice   = 1
> dice_sides = 6
>
> #performing simulation
> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides = dice_sides, plot.it = TRUE)
>
> I tried the following, but did not work as expected:
>
> for (i in 1:nrow(dice_simul)){
>   for(j in 1:ncol(prob_frame)){
>     for(k in 1:nrow(prob_frame)){
>       prob_frame[k,j] = dice_simul[i,1]
>     }
>   }
> }
>
> I apologize for the long explanation.
>
> Best regards,
>
> Paul
>
>
> El mi?, 20 abr 2022 a las 22:47, Bert Gunter (<bgunter.4567 at gmail.com>) escribi?:
>>
>> If I understand you correctly, it's simple.
>> Matrices in R are vectors with a dimension attribute. By default, they
>> are populated column by column. Use 'byrow = TRUE to populate by row
>> instead. For example:
>>
>> > matrix (1:36, ncol = 12, byrow = TRUE)
>>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
>> [1,]    1    2    3    4    5    6    7    8    9    10    11    12
>> [2,]   13   14   15   16   17   18   19   20   21    22    23    24
>> [3,]   25   26   27   28   29   30   31   32   33    34    35    36
>>
>> I leave it to you to use the 'dimnames' argument of ?matrix  to give
>> names to the column and then subsequently convert to a data frame if
>> you like.
>>
>> Bert Gunter
>>
>> "The trouble with having an open mind is that people keep coming along
>> and sticking things into it."
>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>
>> On Wed, Apr 20, 2022 at 8:38 PM Paul Bernal <paulbernal07 at gmail.com> wrote:
>> >
>> > Dear friends,
>> >
>> > Hope you are doing well. I need to simulate a 1 dice roll for each one of
>> > the twelve months of the year and perform 100 trials, so I thought of
>> > constructing a dataframe with twelve columns and 100 rows the following way:
>> >
>> > num_rows = 100
>> >
>> > prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
>> > colnames(prob_frame)<-c("January","February","March","April","May","June","July","August","September","October","November","December")
>> >
>> > Now, using the dice package, I can simulate n number of dice rolls as
>> > follows:
>> > #performing simulation
>> > dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides = dice_sides,
>> > plot.it = TRUE)
>> >
>> > What I would like to do is to populate each column and row with the results
>> > of dice_simul.
>> >
>> > Let me show you the structure of dice_simul:
>> > > str(dice_simul)
>> > Classes ?dice? and 'data.frame': 100 obs. of  1 variable:
>> >  $ Red: int  2 2 1 2 5 4 4 6 1 4 ...
>> > > dput(dice_simul)
>> > structure(list(Red = c(2L, 2L, 1L, 2L, 5L, 4L, 4L, 6L, 1L, 4L,
>> > 4L, 2L, 6L, 2L, 2L, 1L, 3L, 6L, 1L, 5L, 5L, 5L, 3L, 4L, 2L, 6L,
>> > 4L, 6L, 6L, 2L, 1L, 2L, 2L, 6L, 4L, 2L, 3L, 5L, 6L, 6L, 4L, 5L,
>> > 4L, 6L, 6L, 3L, 4L, 1L, 5L, 3L, 3L, 5L, 3L, 4L, 1L, 3L, 3L, 2L,
>> > 4L, 1L, 2L, 1L, 6L, 3L, 5L, 5L, 3L, 4L, 4L, 5L, 4L, 1L, 5L, 3L,
>> > 4L, 4L, 3L, 6L, 5L, 2L, 4L, 1L, 1L, 6L, 4L, 3L, 6L, 5L, 6L, 2L,
>> > 6L, 1L, 6L, 6L, 4L, 3L, 4L, 2L, 1L, 5L)), class = c("dice", "data.frame"
>> > ), row.names = c(NA, -100L))
>> >
>> > For example, the first number of dice_simul should go to row 1 for January,
>> > the second number of dice_simul should go to row 1 for February, ... the
>> > twelveth number of dice_simul should go to row 1 for December, the 13th
>> > number should go to row 2 for january, and so on.
>> >
>> > This is what I tried to do but doesn?t work they way I want to:
>> >
>> > #1)dice_rolls which is the number of times the dice will be rolled
>> > #2)num_dice which is the number of dice that will be rolled each time
>> > #3)dice_sides which is the number of sides of the dice
>> > #function dice will take each one of these variables as its parameter to
>> > perform the simulation
>> > dice_rolls = 100
>> > num_dice   = 1
>> > dice_sides = 6
>> >
>> > #performing simulation
>> > dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides = dice_sides,
>> > plot.it = TRUE)
>> >
>> > num_rows = 100
>> >
>> > prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
>> > colnames(prob_frame) <-
>> > c("January","February","March","April","May","June","July","August","September","October","November","December")
>> >
>> >
>> > for (j in 1:12){
>> >   for (i in 1:num_rows){
>> >     prob_frame[i,j]=dice_simul[i,1]
>> >   }
>> > }
>> > I basically want to populate the twelve months for the first row, then the
>> > twelve months for the second row, and so on, until I get to populate the
>> > twelve months for the last row sequentially.
>> >
>> > How could I accomplish this?
>> >
>> > Any help and/or guidance will be greatly appreciated.
>> >
>> > Best regards,
>> > Paul
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.


From p@u|bern@|07 @end|ng |rom gm@||@com  Thu Apr 21 06:36:43 2022
From: p@u|bern@|07 @end|ng |rom gm@||@com (Paul Bernal)
Date: Wed, 20 Apr 2022 23:36:43 -0500
Subject: [R] Model To Simulate Dice Roll
In-Reply-To: <CAGxFJbRdUsUZwfmEhKbOEaFiFie0TtWF0vHfgGb2h-m-B7doMA@mail.gmail.com>
References: <CAMOcQfMMq7U0jjsGgfL3kQ=Gc4ZsMqZVaLP=SmguPJuhZTYRGg@mail.gmail.com>
 <CAGxFJbTwAqA9beG8FwUPY+v4S-jKMM8+3YjTqH0r_WO2JvOZ_Q@mail.gmail.com>
 <CAMOcQfOQG4camFLTHpesHUMd9L01tmUW0xHUQGDJK1dBQ=nAAw@mail.gmail.com>
 <CAGxFJbRdUsUZwfmEhKbOEaFiFie0TtWF0vHfgGb2h-m-B7doMA@mail.gmail.com>
Message-ID: <CAMOcQfNYTUVpOeL48dzbvQP3dq7kJ0=aCm88DfifraW_KVuqHQ@mail.gmail.com>

Dear Bert,

Thank you for your kind reply.

That is fine, I appreciate your feedback anyway.

Have a great day/night.

Best,
Paul

El mi?, 20 abr 2022 a las 23:31, Bert Gunter (<bgunter.4567 at gmail.com>)
escribi?:

> I believe I gave you sufficient information (the vector of dice roll
> results would replace 1:36 in my example). Furthermore, this sounds
> like homework, which we try not to do here. But even if it is not, I
> expect you to fill in the details based on what I have provided. If I
> have misunderstood your query, I am sorry: I am too lazy to go through
> your long explanation. If I have understood correctly, perhaps others
> will be kinder and provide you the missing details that I did not.
>
>
> Bert Gunter
>
> On Wed, Apr 20, 2022 at 9:02 PM Paul Bernal <paulbernal07 at gmail.com>
> wrote:
> >
> > Dear friend Bert,
> >
> > Thank you so much for your kind reply. The first thing I need to do is
> to simulate dice rolls, say 120 times.
> >
> > I want to populate an m by 12 dataframe with the results of each dice
> roll. For example, the result from dice roll #1 would need to go on row 1,
> column1, the result from dice roll #2 would have to go in row 1 column 2,
> and so on.
> >
> > The reason why I want to store those results in a dataframe is to be
> able to perform some other calculations afterwards.
> >
> > This is for a project I am doing.
> >
> > So this is the situation:
> > You and five friends ? a total of six people ? plan to meet once per
> month to have dinner together, with one of you choosing the restaurant each
> month. Rather than scheduling the entire year in advance, you decide to
> make it interesting: each month a single six-sided die will be rolled to
> determine which of you gets to choose the restaurant that month. How likely
> is it that everyone will have a chance to eat at their own favorite
> restaurant? That is, what is the probability p that over the next 12
> months, each of you will have had at least one opportunity to choose where
> to eat?
> >
> > This is what I am asked to do:
> > Write a program to estimate the desired probability p via simulation.
> The program should input a sequence of positive integer number of trials to
> simulate using the language's pseudorandom number generator and calculate
> the corresponding fractions of simulated trials that are ?successful"
> (i.e., all 6 parties get at least one opportunity to choose where to eat.
> Alice, Bob, Charley, Fred, Ellen, Don, Don, Don, Don, Alice, Charley, Bob
> is a successful trial. Alice, Bob, Charley, Ellen, Don, Don, Don, Don,
> Ellen, Alice, Charley, Bob is not a successful trial since Fred does not
> get to choose.)
> > Turn in a set of 10 trials showing each roll of the dice to show
> correctness. Label the out-comes. Keep in mind that a single trial requires
> rolling the die twelve times. Calculate and print the average probability p
> for the set. Please refer to your friends by name.
> >
> > For this reason, I am trying to simulate the n trials, and then populate
> a table with the results from the trials. I have to simulate a dice roll
> dice for each month and for each row. Rows would be equivalent to years,
> and then columns would be equivalent to the month of a particular year.
> >
> > Once I store the results in a dataframe, everything is much easier.
> >
> > I installed package dice and performed simulations by doing:
> > #declaring variables:
> > #1)dice_rolls which is the number of times the dice will be rolled
> > #2)num_dice which is the number of dice that will be rolled each time
> > #3)dice_sides which is the number of sides of the dice
> > #function dice will take each one of these variables as its parameter to
> perform the simulation
> > dice_rolls = 120
> > num_dice   = 1
> > dice_sides = 6
> >
> > #performing simulation
> > dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
> dice_sides, plot.it = TRUE)
> >
> > I tried the following, but did not work as expected:
> >
> > for (i in 1:nrow(dice_simul)){
> >   for(j in 1:ncol(prob_frame)){
> >     for(k in 1:nrow(prob_frame)){
> >       prob_frame[k,j] = dice_simul[i,1]
> >     }
> >   }
> > }
> >
> > I apologize for the long explanation.
> >
> > Best regards,
> >
> > Paul
> >
> >
> > El mi?, 20 abr 2022 a las 22:47, Bert Gunter (<bgunter.4567 at gmail.com>)
> escribi?:
> >>
> >> If I understand you correctly, it's simple.
> >> Matrices in R are vectors with a dimension attribute. By default, they
> >> are populated column by column. Use 'byrow = TRUE to populate by row
> >> instead. For example:
> >>
> >> > matrix (1:36, ncol = 12, byrow = TRUE)
> >>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
> >> [1,]    1    2    3    4    5    6    7    8    9    10    11    12
> >> [2,]   13   14   15   16   17   18   19   20   21    22    23    24
> >> [3,]   25   26   27   28   29   30   31   32   33    34    35    36
> >>
> >> I leave it to you to use the 'dimnames' argument of ?matrix  to give
> >> names to the column and then subsequently convert to a data frame if
> >> you like.
> >>
> >> Bert Gunter
> >>
> >> "The trouble with having an open mind is that people keep coming along
> >> and sticking things into it."
> >> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> >>
> >> On Wed, Apr 20, 2022 at 8:38 PM Paul Bernal <paulbernal07 at gmail.com>
> wrote:
> >> >
> >> > Dear friends,
> >> >
> >> > Hope you are doing well. I need to simulate a 1 dice roll for each
> one of
> >> > the twelve months of the year and perform 100 trials, so I thought of
> >> > constructing a dataframe with twelve columns and 100 rows the
> following way:
> >> >
> >> > num_rows = 100
> >> >
> >> > prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
> >> >
> colnames(prob_frame)<-c("January","February","March","April","May","June","July","August","September","October","November","December")
> >> >
> >> > Now, using the dice package, I can simulate n number of dice rolls as
> >> > follows:
> >> > #performing simulation
> >> > dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
> dice_sides,
> >> > plot.it = TRUE)
> >> >
> >> > What I would like to do is to populate each column and row with the
> results
> >> > of dice_simul.
> >> >
> >> > Let me show you the structure of dice_simul:
> >> > > str(dice_simul)
> >> > Classes ?dice? and 'data.frame': 100 obs. of  1 variable:
> >> >  $ Red: int  2 2 1 2 5 4 4 6 1 4 ...
> >> > > dput(dice_simul)
> >> > structure(list(Red = c(2L, 2L, 1L, 2L, 5L, 4L, 4L, 6L, 1L, 4L,
> >> > 4L, 2L, 6L, 2L, 2L, 1L, 3L, 6L, 1L, 5L, 5L, 5L, 3L, 4L, 2L, 6L,
> >> > 4L, 6L, 6L, 2L, 1L, 2L, 2L, 6L, 4L, 2L, 3L, 5L, 6L, 6L, 4L, 5L,
> >> > 4L, 6L, 6L, 3L, 4L, 1L, 5L, 3L, 3L, 5L, 3L, 4L, 1L, 3L, 3L, 2L,
> >> > 4L, 1L, 2L, 1L, 6L, 3L, 5L, 5L, 3L, 4L, 4L, 5L, 4L, 1L, 5L, 3L,
> >> > 4L, 4L, 3L, 6L, 5L, 2L, 4L, 1L, 1L, 6L, 4L, 3L, 6L, 5L, 6L, 2L,
> >> > 6L, 1L, 6L, 6L, 4L, 3L, 4L, 2L, 1L, 5L)), class = c("dice",
> "data.frame"
> >> > ), row.names = c(NA, -100L))
> >> >
> >> > For example, the first number of dice_simul should go to row 1 for
> January,
> >> > the second number of dice_simul should go to row 1 for February, ...
> the
> >> > twelveth number of dice_simul should go to row 1 for December, the
> 13th
> >> > number should go to row 2 for january, and so on.
> >> >
> >> > This is what I tried to do but doesn?t work they way I want to:
> >> >
> >> > #1)dice_rolls which is the number of times the dice will be rolled
> >> > #2)num_dice which is the number of dice that will be rolled each time
> >> > #3)dice_sides which is the number of sides of the dice
> >> > #function dice will take each one of these variables as its parameter
> to
> >> > perform the simulation
> >> > dice_rolls = 100
> >> > num_dice   = 1
> >> > dice_sides = 6
> >> >
> >> > #performing simulation
> >> > dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
> dice_sides,
> >> > plot.it = TRUE)
> >> >
> >> > num_rows = 100
> >> >
> >> > prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
> >> > colnames(prob_frame) <-
> >> >
> c("January","February","March","April","May","June","July","August","September","October","November","December")
> >> >
> >> >
> >> > for (j in 1:12){
> >> >   for (i in 1:num_rows){
> >> >     prob_frame[i,j]=dice_simul[i,1]
> >> >   }
> >> > }
> >> > I basically want to populate the twelve months for the first row,
> then the
> >> > twelve months for the second row, and so on, until I get to populate
> the
> >> > twelve months for the last row sequentially.
> >> >
> >> > How could I accomplish this?
> >> >
> >> > Any help and/or guidance will be greatly appreciated.
> >> >
> >> > Best regards,
> >> > Paul
> >> >
> >> >         [[alternative HTML version deleted]]
> >> >
> >> > ______________________________________________
> >> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> > https://stat.ethz.ch/mailman/listinfo/r-help
> >> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From p@u|bern@|07 @end|ng |rom gm@||@com  Thu Apr 21 06:55:20 2022
From: p@u|bern@|07 @end|ng |rom gm@||@com (Paul Bernal)
Date: Wed, 20 Apr 2022 23:55:20 -0500
Subject: [R] Looping through all matrix columns each 1 row at a time
Message-ID: <CAMOcQfOmVbCG6+btebGDT6O_D3qQmaPzDZpvVAHcG6tzAimSrg@mail.gmail.com>

Dear R friends,

One question, so, thanks to the Bert's kind feedback, I was able to create
my matrix using the following code:
dice_rolls = 120
num_dice   = 1
dice_sides = 6

#performing simulation
dice_simul = data.frame(dice(rolls = dice_rolls, ndice = num_dice, sides =
dice_sides, plot.it = TRUE))

dice_simul


prob_matrix <- matrix(dice_simul[,1], ncol = 12, byrow = TRUE)

colnames(prob_matrix) <-
c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")

Now, I need to perform an analysis for each column, one row at a time. For
example, I need to know if numbers 1 through 6 all appear in the twelve
column for row 1, then for row 2, etc.

Any guidance will be greatly appreciated.

Best,
Paul

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Apr 21 08:55:20 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 21 Apr 2022 07:55:20 +0100
Subject: [R] Model To Simulate Dice Roll
In-Reply-To: <CAMOcQfOQG4camFLTHpesHUMd9L01tmUW0xHUQGDJK1dBQ=nAAw@mail.gmail.com>
References: <CAMOcQfMMq7U0jjsGgfL3kQ=Gc4ZsMqZVaLP=SmguPJuhZTYRGg@mail.gmail.com>
 <CAGxFJbTwAqA9beG8FwUPY+v4S-jKMM8+3YjTqH0r_WO2JvOZ_Q@mail.gmail.com>
 <CAMOcQfOQG4camFLTHpesHUMd9L01tmUW0xHUQGDJK1dBQ=nAAw@mail.gmail.com>
Message-ID: <63179a44-d944-fe1e-ae0f-c6ed7d2d3cde@sapo.pt>

Hello,

For what I understand of the question, the followng might answer it.

The functions below roll dice and simulate R replicates of dice rolls.
Then 12 (one per month) 6 sided dice rolls are simulated 100 times.

The colMeans/apply computes the empiric probabilities of having all 6 
sides occur in each row, Jan to Dec and a overall probabilty is the mean 
of those probabilities.

The matrix is coerced to data.frame only at the end.



dice <- function(rolls = 1, ndice = 1, sides = 6) {
   roll <- function(ndice = 1, sides = 6) {
     sample(seq_len(sides), ndice, replace = TRUE)
   }
   y <- replicate(rolls, roll(ndice = ndice, sides = sides))
   if(is.null(dim(y))) y else colSums(y)
}
dice_simul <- function(rolls = 1, ndice = 1, sides = 6, R) {
   if(missing(R)) {
     stop("number of simulations 'R' is missing with no default.")
   }
   replicate(R, dice(rolls = rolls, ndice = ndice, sides = sides))
}

dice_rolls <- 100
#dice_rolls <- 1e6
num_dice <- 1
dice_sides <- 6
months <- 12

set.seed(2022)
prob_frame <- t(dice_simul(months, num_dice, dice_sides, R = dice_rolls))
colnames(prob_frame) <- month.name
head(prob_frame)

p <- colMeans(apply(prob_frame, 1, \(x) 1:6 %in% x))
mean(p)
# [1] 0.9116667

prob_frame <- as.data.frame(prob_frame)


Hope this helps,

Rui Barradas


?s 05:02 de 21/04/2022, Paul Bernal escreveu:
> Dear friend Bert,
> 
> Thank you so much for your kind reply. The first thing I need to do is to
> simulate dice rolls, say 120 times.
> 
> I want to populate an m by 12 dataframe with the results of each dice roll.
> For example, the result from dice roll #1 would need to go on row 1,
> column1, the result from dice roll #2 would have to go in row 1 column 2,
> and so on.
> 
> The reason why I want to store those results in a dataframe is to be able
> to perform some other calculations afterwards.
> 
> This is for a project I am doing.
> 
> So this is the situation:
> You and five friends ? a total of six people ? plan to meet once per month
> to have dinner together, with one of you choosing the restaurant each
> month. Rather than scheduling the entire year in advance, you decide to
> make it interesting: each month a single six-sided die will be rolled to
> determine which of you gets to choose the restaurant that month. How likely
> is it that everyone will have a chance to eat at their own favorite
> restaurant? That is, what is the probability p that over the next 12
> months, each of you will have had at least one opportunity to choose where
> to eat?
> 
> This is what I am asked to do:
> Write a program to estimate the desired probability p via simulation. The
> program should input a sequence of positive integer number of trials to
> simulate using the language's pseudorandom number generator and calculate
> the corresponding fractions of simulated trials that are ?successful"
> (i.e., all 6 parties get at least one opportunity to choose where to eat.
> Alice, Bob, Charley, Fred, Ellen, Don, Don, Don, Don, Alice, Charley, Bob
> is a successful trial. Alice, Bob, Charley, Ellen, Don, Don, Don, Don,
> Ellen, Alice, Charley, Bob is not a successful trial since Fred does not
> get to choose.)
> Turn in a set of 10 trials showing each roll of the dice to show
> correctness. Label the out-comes. Keep in mind that a single trial requires
> rolling the die twelve times. Calculate and print the average probability p
> for the set. Please refer to your friends by name.
> 
> For this reason, I am trying to simulate the n trials, and then populate a
> table with the results from the trials. I have to simulate a dice roll dice
> for each month and for each row. Rows would be equivalent to years, and
> then columns would be equivalent to the month of a particular year.
> 
> Once I store the results in a dataframe, everything is much easier.
> 
> I installed package dice and performed simulations by doing:
> #declaring variables:
> #1)dice_rolls which is the number of times the dice will be rolled
> #2)num_dice which is the number of dice that will be rolled each time
> #3)dice_sides which is the number of sides of the dice
> #function dice will take each one of these variables as its parameter to
> perform the simulation
> dice_rolls = 120
> num_dice   = 1
> dice_sides = 6
> 
> #performing simulation
> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides = dice_sides,
> plot.it = TRUE)
> 
> I tried the following, but did not work as expected:
> 
> for (i in 1:nrow(dice_simul)){
>    for(j in 1:ncol(prob_frame)){
>      for(k in 1:nrow(prob_frame)){
>        prob_frame[k,j] = dice_simul[i,1]
>      }
>    }
> }
> 
> I apologize for the long explanation.
> 
> Best regards,
> 
> Paul
> 
> 
> El mi?, 20 abr 2022 a las 22:47, Bert Gunter (<bgunter.4567 at gmail.com>)
> escribi?:
> 
>> If I understand you correctly, it's simple.
>> Matrices in R are vectors with a dimension attribute. By default, they
>> are populated column by column. Use 'byrow = TRUE to populate by row
>> instead. For example:
>>
>>> matrix (1:36, ncol = 12, byrow = TRUE)
>>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
>> [1,]    1    2    3    4    5    6    7    8    9    10    11    12
>> [2,]   13   14   15   16   17   18   19   20   21    22    23    24
>> [3,]   25   26   27   28   29   30   31   32   33    34    35    36
>>
>> I leave it to you to use the 'dimnames' argument of ?matrix  to give
>> names to the column and then subsequently convert to a data frame if
>> you like.
>>
>> Bert Gunter
>>
>> "The trouble with having an open mind is that people keep coming along
>> and sticking things into it."
>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>
>> On Wed, Apr 20, 2022 at 8:38 PM Paul Bernal <paulbernal07 at gmail.com>
>> wrote:
>>>
>>> Dear friends,
>>>
>>> Hope you are doing well. I need to simulate a 1 dice roll for each one of
>>> the twelve months of the year and perform 100 trials, so I thought of
>>> constructing a dataframe with twelve columns and 100 rows the following
>> way:
>>>
>>> num_rows = 100
>>>
>>> prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
>>>
>> colnames(prob_frame)<-c("January","February","March","April","May","June","July","August","September","October","November","December")
>>>
>>> Now, using the dice package, I can simulate n number of dice rolls as
>>> follows:
>>> #performing simulation
>>> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
>> dice_sides,
>>> plot.it = TRUE)
>>>
>>> What I would like to do is to populate each column and row with the
>> results
>>> of dice_simul.
>>>
>>> Let me show you the structure of dice_simul:
>>>> str(dice_simul)
>>> Classes ?dice? and 'data.frame': 100 obs. of  1 variable:
>>>   $ Red: int  2 2 1 2 5 4 4 6 1 4 ...
>>>> dput(dice_simul)
>>> structure(list(Red = c(2L, 2L, 1L, 2L, 5L, 4L, 4L, 6L, 1L, 4L,
>>> 4L, 2L, 6L, 2L, 2L, 1L, 3L, 6L, 1L, 5L, 5L, 5L, 3L, 4L, 2L, 6L,
>>> 4L, 6L, 6L, 2L, 1L, 2L, 2L, 6L, 4L, 2L, 3L, 5L, 6L, 6L, 4L, 5L,
>>> 4L, 6L, 6L, 3L, 4L, 1L, 5L, 3L, 3L, 5L, 3L, 4L, 1L, 3L, 3L, 2L,
>>> 4L, 1L, 2L, 1L, 6L, 3L, 5L, 5L, 3L, 4L, 4L, 5L, 4L, 1L, 5L, 3L,
>>> 4L, 4L, 3L, 6L, 5L, 2L, 4L, 1L, 1L, 6L, 4L, 3L, 6L, 5L, 6L, 2L,
>>> 6L, 1L, 6L, 6L, 4L, 3L, 4L, 2L, 1L, 5L)), class = c("dice", "data.frame"
>>> ), row.names = c(NA, -100L))
>>>
>>> For example, the first number of dice_simul should go to row 1 for
>> January,
>>> the second number of dice_simul should go to row 1 for February, ... the
>>> twelveth number of dice_simul should go to row 1 for December, the 13th
>>> number should go to row 2 for january, and so on.
>>>
>>> This is what I tried to do but doesn?t work they way I want to:
>>>
>>> #1)dice_rolls which is the number of times the dice will be rolled
>>> #2)num_dice which is the number of dice that will be rolled each time
>>> #3)dice_sides which is the number of sides of the dice
>>> #function dice will take each one of these variables as its parameter to
>>> perform the simulation
>>> dice_rolls = 100
>>> num_dice   = 1
>>> dice_sides = 6
>>>
>>> #performing simulation
>>> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
>> dice_sides,
>>> plot.it = TRUE)
>>>
>>> num_rows = 100
>>>
>>> prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
>>> colnames(prob_frame) <-
>>>
>> c("January","February","March","April","May","June","July","August","September","October","November","December")
>>>
>>>
>>> for (j in 1:12){
>>>    for (i in 1:num_rows){
>>>      prob_frame[i,j]=dice_simul[i,1]
>>>    }
>>> }
>>> I basically want to populate the twelve months for the first row, then
>> the
>>> twelve months for the second row, and so on, until I get to populate the
>>> twelve months for the last row sequentially.
>>>
>>> How could I accomplish this?
>>>
>>> Any help and/or guidance will be greatly appreciated.
>>>
>>> Best regards,
>>> Paul
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From co|or|e @end|ng |rom gm@||@com  Thu Apr 21 09:42:36 2022
From: co|or|e @end|ng |rom gm@||@com (Carlos Ortega)
Date: Thu, 21 Apr 2022 09:42:36 +0200
Subject: [R] NAs error in caret function
In-Reply-To: <CAJhui+uv+a-UkRK827b2sa7JH_PCq9RiEQO68QurE4Q57RzrPg@mail.gmail.com>
References: <CAJhui+tqBbnRv-ghVxTof=dkuFi7_vwQ7G=FuYXGTte7qp7cfQ@mail.gmail.com>
 <CAGxFJbQqSfm7kptTY3z=72ELVqk68a76GBrjNVHdw_qmSUN=Ag@mail.gmail.com>
 <CAFKNbkLyLUr90bnmGBEbGH+uOEpBaqqps1NAkLrac4p=MnKWoQ@mail.gmail.com>
 <CAJhui+uv+a-UkRK827b2sa7JH_PCq9RiEQO68QurE4Q57RzrPg@mail.gmail.com>
Message-ID: <CAFKNbkKsqb+jUbSzp3NWcoqbvyH_xmbzwdimSxDwe3N8HOB+zg@mail.gmail.com>

Hi,

I do not see any issue with the code you provided.
In this situation, you should use a more "debugging" approach for your
problem until catching the problem. In this case, I would start using a
much more simplified version of your "trainControl". No folds, just "cv"
and "number = 2" and try.

Perhaps the problem is that you do not have enough or any representation of
one of your labels and that creates an evaluation problem. If your data is
not balanced and you create a lot of folds that could happen.

And if it works with this very simplified version, start including more
complexity in the trainControl function.

Thanks,
Carlos.


On Thu, Apr 21, 2022 at 12:59 AM javed khan <javedbtk111 at gmail.com> wrote:

> Carlos Ortega, thank you for your answer.
>
> Class label has three values (Bug, Codel smell and Vulnerability). X is a
> text-based feature that include English statements and we performed some
> preprocessing such as removing symbols, lower-case etc.
>
> Yes, train_label is a factor class.
>
> *I can provide the whole code and data if needed. We followed the same
> method provided in this tutorial*
>
> *https://algotech.netlify.app/blog/text-lime/
> <https://algotech.netlify.app/blog/text-lime/> *
>
>
> cv.folds <- createMultiFolds(train$TYPE, k = 10, times = 3)
>
> ctrl <- trainControl(method = "cv",number=3, index = cv.folds, classProbs
> = TRUE, summaryFunction = multiClassSummary)
> m= train(y = train_label, x = train_x,
>       method = "knn" ,
>       metric = "Accuracy",
>       ## #  preProc = c("center", "scale", "nzv"),
>       trControl = ctrl)
>
> p=predict(m, test_x)
> confusionMatrix(p, as.factor(test_label))
>
> With some models, it show error like: Error in { :
>   task 1 failed - "Not all variable names used in object found in newdata"
>
> However, when I run the base models like naiveBayes, it works.
>
> model_bayes <- naiveBayes(train_x, train_label, laplace = 1)
>
>
> On Wed, Apr 20, 2022 at 11:09 PM Carlos Ortega <coforfe at gmail.com> wrote:
>
>> Hi,
>>
>> There are many things than could be wrong:
>>
>> 1. What is inside "ctrl" in the trainControl argument ?
>> 2. Your model is a classication one, but if you do not configure
>> correctly "ctrl" you do not get out the metrics correctly. It depends if
>> your model is binary or multi-class.
>> 3. Another thing is that if it is a classification one, you should also
>> check that in the "train()" you "train_label" is a factor.
>>
>> On top of that, remember that your problem is not reproducible.
>> If you attach a portion of your data, we could create a working "caret"
>> code.
>>
>> Thanks,
>> Carlos Ortega.
>>
>> On Wed, Apr 20, 2022 at 10:26 PM Bert Gunter <bgunter.4567 at gmail.com>
>> wrote:
>>
>>> A quick web search on 'R caret package' found a host of useful
>>> results, the first of which was this:
>>> https://topepo.github.io/caret/
>>> Note that the author, Max Kuhn, explicitly says there that you can
>>> email him with questions. I think you should do so, as you do not seem
>>> to be making progress here.
>>>
>>> Bert Gunter
>>>
>>> "The trouble with having an open mind is that people keep coming along
>>> and sticking things into it."
>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>>
>>> On Wed, Apr 20, 2022 at 12:51 PM javed khan <javedbtk111 at gmail.com>
>>> wrote:
>>> >
>>> > Caret produce the error: Something is wrong; all the Accuracy metric
>>> values
>>> > are missing:
>>> >     logLoss         AUC          prAUC        Accuracy       Kappa
>>> >  Min.   : NA   Min.   : NA   Min.   : NA   Min.   : NA   Min.   : NA
>>> >  1st Qu.: NA   1st Qu.: NA   1st Qu.: NA   1st Qu.: NA   1st Qu.: NA
>>> >  Median : NA   Median : NA   Median : NA   Median : NA   Median : NA
>>> >
>>> > We (group of three) working on an assignment and could not fix this
>>> error
>>> > from a few days. The error comes with the majority of the models while
>>> with
>>> > a few model (e.g. nb), the code works. The data is text-based
>>> > classification.
>>> >
>>> > Some Warnings are:
>>> >
>>> > Warning messages:
>>> > 1: In train.default(y = train_label, x = train_x, method = "pls",  ...
>>> :
>>> >   The metric "ROC" was not in the result set. logLoss will be used
>>> instead.
>>> > 2: model fit failed for Fold01.Rep1: ncomp=3 Error in
>>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>>> >   replacement has 320292 rows, data has 1148
>>> >
>>> > 3: model fit failed for Fold02.Rep1: ncomp=3 Error in
>>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>>> >   replacement has 320013 rows, data has 1147
>>> >
>>> > 4: model fit failed for Fold03.Rep1: ncomp=3 Error in
>>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>>> >   replacement has 320013 rows, data has 1147
>>> >
>>> > 5: model fit failed for Fold04.Rep1: ncomp=3 Error in
>>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>>> >   replacement has 320292 rows, data has 1148
>>> >
>>> > 6: model fit failed for Fold05.Rep1: ncomp=3 Error in
>>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>>> >   replacement has 320013 rows, data has 1147
>>> >
>>> > 7: model fit failed for Fold06.Rep1: ncomp=3 Error in
>>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>>> >   replacement has 320013 rows, data has 1147
>>> >
>>> >
>>> >
>>> > Code is
>>> >
>>> >
>>> > m= train(y = train_label, x = train_x,
>>> >       method = "pls" ,
>>> >       metric = "Accuracy",
>>> >       ## #  preProc = c("center", "scale", "nzv"),
>>> >       trControl = ctrl)
>>> >
>>> > p=predict(m, test_x)
>>> > confusionMatrix(p, as.factor(test_label))
>>> >
>>> >         [[alternative HTML version deleted]]
>>> >
>>> > ______________________________________________
>>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> > https://stat.ethz.ch/mailman/listinfo/r-help
>>> > PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> > and provide commented, minimal, self-contained, reproducible code.
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>

	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Thu Apr 21 10:53:46 2022
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Thu, 21 Apr 2022 11:53:46 +0300
Subject: [R] Looping through all matrix columns each 1 row at a time
In-Reply-To: <CAMOcQfOmVbCG6+btebGDT6O_D3qQmaPzDZpvVAHcG6tzAimSrg@mail.gmail.com>
References: <CAMOcQfOmVbCG6+btebGDT6O_D3qQmaPzDZpvVAHcG6tzAimSrg@mail.gmail.com>
Message-ID: <CAGgJW777F7GFqMAO+N1xsXsuPu_r40_UustQTbCMksucMJh=3A@mail.gmail.com>

Hi Paul,
I am not sure I understand your question, but perhaps the following is helpful.
In particular, the apply() function used with MAR=1, applies a
function to a matrix row-wise.

set.seed(123)
m <- matrix(sample(1:6,5*12,replace=TRUE),ncol=12) ## dummy data
m
     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
[1,]    3    6    6    3    1    1    1    5    4     1     5     1
[2,]    6    3    1    3    5    6    3    1    5     2     2     6
[3,]    3    5    2    1    3    3    5    1    5     5     1     5
[4,]    2    4    3    4    2    4    4    2    3     5     1     1
[5,]    2    6    5    1    2    6    2    3    6     4     3     2

apply(m,MAR=1,function(v) length(setdiff(1:6,v))==0)

[1] FALSE FALSE FALSE FALSE  TRUE  ## only the last row has all numbers from 1-6

HTH,
Eric


On Thu, Apr 21, 2022 at 7:55 AM Paul Bernal <paulbernal07 at gmail.com> wrote:
>
> Dear R friends,
>
> One question, so, thanks to the Bert's kind feedback, I was able to create
> my matrix using the following code:
> dice_rolls = 120
> num_dice   = 1
> dice_sides = 6
>
> #performing simulation
> dice_simul = data.frame(dice(rolls = dice_rolls, ndice = num_dice, sides =
> dice_sides, plot.it = TRUE))
>
> dice_simul
>
>
> prob_matrix <- matrix(dice_simul[,1], ncol = 12, byrow = TRUE)
>
> colnames(prob_matrix) <-
> c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
>
> Now, I need to perform an analysis for each column, one row at a time. For
> example, I need to know if numbers 1 through 6 all appear in the twelve
> column for row 1, then for row 2, etc.
>
> Any guidance will be greatly appreciated.
>
> Best,
> Paul
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Apr 21 11:04:29 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 21 Apr 2022 10:04:29 +0100
Subject: [R] Model To Simulate Dice Roll
In-Reply-To: <63179a44-d944-fe1e-ae0f-c6ed7d2d3cde@sapo.pt>
References: <CAMOcQfMMq7U0jjsGgfL3kQ=Gc4ZsMqZVaLP=SmguPJuhZTYRGg@mail.gmail.com>
 <CAGxFJbTwAqA9beG8FwUPY+v4S-jKMM8+3YjTqH0r_WO2JvOZ_Q@mail.gmail.com>
 <CAMOcQfOQG4camFLTHpesHUMd9L01tmUW0xHUQGDJK1dBQ=nAAw@mail.gmail.com>
 <63179a44-d944-fe1e-ae0f-c6ed7d2d3cde@sapo.pt>
Message-ID: <931063bd-ecd7-8edd-23c1-dcb5f02f86a7@sapo.pt>

Hello,

There's an error in my code, inline.

?s 07:55 de 21/04/2022, Rui Barradas escreveu:
> Hello,
> 
> For what I understand of the question, the followng might answer it.
> 
> The functions below roll dice and simulate R replicates of dice rolls.
> Then 12 (one per month) 6 sided dice rolls are simulated 100 times.
> 
> The colMeans/apply computes the empiric probabilities of having all 6 
> sides occur in each row, Jan to Dec and a overall probabilty is the mean 
> of those probabilities.
> 
> The matrix is coerced to data.frame only at the end.
> 
> 
> 
> dice <- function(rolls = 1, ndice = 1, sides = 6) {
>  ? roll <- function(ndice = 1, sides = 6) {
>  ??? sample(seq_len(sides), ndice, replace = TRUE)
>  ? }
>  ? y <- replicate(rolls, roll(ndice = ndice, sides = sides))
>  ? if(is.null(dim(y))) y else colSums(y)
> }
> dice_simul <- function(rolls = 1, ndice = 1, sides = 6, R) {
>  ? if(missing(R)) {
>  ??? stop("number of simulations 'R' is missing with no default.")
>  ? }
>  ? replicate(R, dice(rolls = rolls, ndice = ndice, sides = sides))
> }
> 
> dice_rolls <- 100
> #dice_rolls <- 1e6
> num_dice <- 1
> dice_sides <- 6
> months <- 12
> 
> set.seed(2022)
> prob_frame <- t(dice_simul(months, num_dice, dice_sides, R = dice_rolls))
> colnames(prob_frame) <- month.name
> head(prob_frame)
> 

# --- wrong
> p <- colMeans(apply(prob_frame, 1, \(x) 1:6 %in% x))
> mean(p)
> # [1] 0.9116667

This should be

yes_no <- apply(prob_frame, 1, \(x) all(1:6 %in% x))
p <- mean(yes_no)
p
# [1] 0.53


Rui Barradas



> 
> prob_frame <- as.data.frame(prob_frame)
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> 
> ?s 05:02 de 21/04/2022, Paul Bernal escreveu:
>> Dear friend Bert,
>>
>> Thank you so much for your kind reply. The first thing I need to do is to
>> simulate dice rolls, say 120 times.
>>
>> I want to populate an m by 12 dataframe with the results of each dice 
>> roll.
>> For example, the result from dice roll #1 would need to go on row 1,
>> column1, the result from dice roll #2 would have to go in row 1 column 2,
>> and so on.
>>
>> The reason why I want to store those results in a dataframe is to be able
>> to perform some other calculations afterwards.
>>
>> This is for a project I am doing.
>>
>> So this is the situation:
>> You and five friends ? a total of six people ? plan to meet once per 
>> month
>> to have dinner together, with one of you choosing the restaurant each
>> month. Rather than scheduling the entire year in advance, you decide to
>> make it interesting: each month a single six-sided die will be rolled to
>> determine which of you gets to choose the restaurant that month. How 
>> likely
>> is it that everyone will have a chance to eat at their own favorite
>> restaurant? That is, what is the probability p that over the next 12
>> months, each of you will have had at least one opportunity to choose 
>> where
>> to eat?
>>
>> This is what I am asked to do:
>> Write a program to estimate the desired probability p via simulation. The
>> program should input a sequence of positive integer number of trials to
>> simulate using the language's pseudorandom number generator and calculate
>> the corresponding fractions of simulated trials that are ?successful"
>> (i.e., all 6 parties get at least one opportunity to choose where to eat.
>> Alice, Bob, Charley, Fred, Ellen, Don, Don, Don, Don, Alice, Charley, Bob
>> is a successful trial. Alice, Bob, Charley, Ellen, Don, Don, Don, Don,
>> Ellen, Alice, Charley, Bob is not a successful trial since Fred does not
>> get to choose.)
>> Turn in a set of 10 trials showing each roll of the dice to show
>> correctness. Label the out-comes. Keep in mind that a single trial 
>> requires
>> rolling the die twelve times. Calculate and print the average 
>> probability p
>> for the set. Please refer to your friends by name.
>>
>> For this reason, I am trying to simulate the n trials, and then 
>> populate a
>> table with the results from the trials. I have to simulate a dice roll 
>> dice
>> for each month and for each row. Rows would be equivalent to years, and
>> then columns would be equivalent to the month of a particular year.
>>
>> Once I store the results in a dataframe, everything is much easier.
>>
>> I installed package dice and performed simulations by doing:
>> #declaring variables:
>> #1)dice_rolls which is the number of times the dice will be rolled
>> #2)num_dice which is the number of dice that will be rolled each time
>> #3)dice_sides which is the number of sides of the dice
>> #function dice will take each one of these variables as its parameter to
>> perform the simulation
>> dice_rolls = 120
>> num_dice?? = 1
>> dice_sides = 6
>>
>> #performing simulation
>> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides = 
>> dice_sides,
>> plot.it = TRUE)
>>
>> I tried the following, but did not work as expected:
>>
>> for (i in 1:nrow(dice_simul)){
>> ?? for(j in 1:ncol(prob_frame)){
>> ???? for(k in 1:nrow(prob_frame)){
>> ?????? prob_frame[k,j] = dice_simul[i,1]
>> ???? }
>> ?? }
>> }
>>
>> I apologize for the long explanation.
>>
>> Best regards,
>>
>> Paul
>>
>>
>> El mi?, 20 abr 2022 a las 22:47, Bert Gunter (<bgunter.4567 at gmail.com>)
>> escribi?:
>>
>>> If I understand you correctly, it's simple.
>>> Matrices in R are vectors with a dimension attribute. By default, they
>>> are populated column by column. Use 'byrow = TRUE to populate by row
>>> instead. For example:
>>>
>>>> matrix (1:36, ncol = 12, byrow = TRUE)
>>> ????? [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
>>> [1,]??? 1??? 2??? 3??? 4??? 5??? 6??? 7??? 8??? 9??? 10??? 11??? 12
>>> [2,]?? 13?? 14?? 15?? 16?? 17?? 18?? 19?? 20?? 21??? 22??? 23??? 24
>>> [3,]?? 25?? 26?? 27?? 28?? 29?? 30?? 31?? 32?? 33??? 34??? 35??? 36
>>>
>>> I leave it to you to use the 'dimnames' argument of ?matrix? to give
>>> names to the column and then subsequently convert to a data frame if
>>> you like.
>>>
>>> Bert Gunter
>>>
>>> "The trouble with having an open mind is that people keep coming along
>>> and sticking things into it."
>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>>
>>> On Wed, Apr 20, 2022 at 8:38 PM Paul Bernal <paulbernal07 at gmail.com>
>>> wrote:
>>>>
>>>> Dear friends,
>>>>
>>>> Hope you are doing well. I need to simulate a 1 dice roll for each 
>>>> one of
>>>> the twelve months of the year and perform 100 trials, so I thought of
>>>> constructing a dataframe with twelve columns and 100 rows the following
>>> way:
>>>>
>>>> num_rows = 100
>>>>
>>>> prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
>>>>
>>> colnames(prob_frame)<-c("January","February","March","April","May","June","July","August","September","October","November","December") 
>>>
>>>>
>>>> Now, using the dice package, I can simulate n number of dice rolls as
>>>> follows:
>>>> #performing simulation
>>>> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
>>> dice_sides,
>>>> plot.it = TRUE)
>>>>
>>>> What I would like to do is to populate each column and row with the
>>> results
>>>> of dice_simul.
>>>>
>>>> Let me show you the structure of dice_simul:
>>>>> str(dice_simul)
>>>> Classes ?dice? and 'data.frame': 100 obs. of? 1 variable:
>>>> ? $ Red: int? 2 2 1 2 5 4 4 6 1 4 ...
>>>>> dput(dice_simul)
>>>> structure(list(Red = c(2L, 2L, 1L, 2L, 5L, 4L, 4L, 6L, 1L, 4L,
>>>> 4L, 2L, 6L, 2L, 2L, 1L, 3L, 6L, 1L, 5L, 5L, 5L, 3L, 4L, 2L, 6L,
>>>> 4L, 6L, 6L, 2L, 1L, 2L, 2L, 6L, 4L, 2L, 3L, 5L, 6L, 6L, 4L, 5L,
>>>> 4L, 6L, 6L, 3L, 4L, 1L, 5L, 3L, 3L, 5L, 3L, 4L, 1L, 3L, 3L, 2L,
>>>> 4L, 1L, 2L, 1L, 6L, 3L, 5L, 5L, 3L, 4L, 4L, 5L, 4L, 1L, 5L, 3L,
>>>> 4L, 4L, 3L, 6L, 5L, 2L, 4L, 1L, 1L, 6L, 4L, 3L, 6L, 5L, 6L, 2L,
>>>> 6L, 1L, 6L, 6L, 4L, 3L, 4L, 2L, 1L, 5L)), class = c("dice", 
>>>> "data.frame"
>>>> ), row.names = c(NA, -100L))
>>>>
>>>> For example, the first number of dice_simul should go to row 1 for
>>> January,
>>>> the second number of dice_simul should go to row 1 for February, ... 
>>>> the
>>>> twelveth number of dice_simul should go to row 1 for December, the 13th
>>>> number should go to row 2 for january, and so on.
>>>>
>>>> This is what I tried to do but doesn?t work they way I want to:
>>>>
>>>> #1)dice_rolls which is the number of times the dice will be rolled
>>>> #2)num_dice which is the number of dice that will be rolled each time
>>>> #3)dice_sides which is the number of sides of the dice
>>>> #function dice will take each one of these variables as its 
>>>> parameter to
>>>> perform the simulation
>>>> dice_rolls = 100
>>>> num_dice?? = 1
>>>> dice_sides = 6
>>>>
>>>> #performing simulation
>>>> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
>>> dice_sides,
>>>> plot.it = TRUE)
>>>>
>>>> num_rows = 100
>>>>
>>>> prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
>>>> colnames(prob_frame) <-
>>>>
>>> c("January","February","March","April","May","June","July","August","September","October","November","December") 
>>>
>>>>
>>>>
>>>> for (j in 1:12){
>>>> ?? for (i in 1:num_rows){
>>>> ???? prob_frame[i,j]=dice_simul[i,1]
>>>> ?? }
>>>> }
>>>> I basically want to populate the twelve months for the first row, then
>>> the
>>>> twelve months for the second row, and so on, until I get to populate 
>>>> the
>>>> twelve months for the last row sequentially.
>>>>
>>>> How could I accomplish this?
>>>>
>>>> Any help and/or guidance will be greatly appreciated.
>>>>
>>>> Best regards,
>>>> Paul
>>>>
>>>> ???????? [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From j@vedbtk111 @end|ng |rom gm@||@com  Thu Apr 21 15:15:42 2022
From: j@vedbtk111 @end|ng |rom gm@||@com (javed khan)
Date: Thu, 21 Apr 2022 15:15:42 +0200
Subject: [R] NAs error in caret function
In-Reply-To: <CAFKNbkKsqb+jUbSzp3NWcoqbvyH_xmbzwdimSxDwe3N8HOB+zg@mail.gmail.com>
References: <CAJhui+tqBbnRv-ghVxTof=dkuFi7_vwQ7G=FuYXGTte7qp7cfQ@mail.gmail.com>
 <CAGxFJbQqSfm7kptTY3z=72ELVqk68a76GBrjNVHdw_qmSUN=Ag@mail.gmail.com>
 <CAFKNbkLyLUr90bnmGBEbGH+uOEpBaqqps1NAkLrac4p=MnKWoQ@mail.gmail.com>
 <CAJhui+uv+a-UkRK827b2sa7JH_PCq9RiEQO68QurE4Q57RzrPg@mail.gmail.com>
 <CAFKNbkKsqb+jUbSzp3NWcoqbvyH_xmbzwdimSxDwe3N8HOB+zg@mail.gmail.com>
Message-ID: <CAJhui+uiVDaU9_-VvjPQ8ULa9kFCAAKsSGwHWpKRFG-Mukfc+Q@mail.gmail.com>

Dear Carlos Ortega, thank you again for your information.

My data is indeed imbalanced, so I am going to balance it and will try
again

Best regards

On Thursday, April 21, 2022, Carlos Ortega <coforfe at gmail.com> wrote:

> Hi,
>
> I do not see any issue with the code you provided.
> In this situation, you should use a more "debugging" approach for your
> problem until catching the problem. In this case, I would start using a
> much more simplified version of your "trainControl". No folds, just "cv"
> and "number = 2" and try.
>
> Perhaps the problem is that you do not have enough or any representation
> of one of your labels and that creates an evaluation problem. If your data
> is not balanced and you create a lot of folds that could happen.
>
> And if it works with this very simplified version, start including more
> complexity in the trainControl function.
>
> Thanks,
> Carlos.
>
>
> On Thu, Apr 21, 2022 at 12:59 AM javed khan <javedbtk111 at gmail.com> wrote:
>
>> Carlos Ortega, thank you for your answer.
>>
>> Class label has three values (Bug, Codel smell and Vulnerability). X is a
>> text-based feature that include English statements and we performed some
>> preprocessing such as removing symbols, lower-case etc.
>>
>> Yes, train_label is a factor class.
>>
>> *I can provide the whole code and data if needed. We followed the same
>> method provided in this tutorial*
>>
>> *https://algotech.netlify.app/blog/text-lime/
>> <https://algotech.netlify.app/blog/text-lime/> *
>>
>>
>> cv.folds <- createMultiFolds(train$TYPE, k = 10, times = 3)
>>
>> ctrl <- trainControl(method = "cv",number=3, index = cv.folds, classProbs
>> = TRUE, summaryFunction = multiClassSummary)
>> m= train(y = train_label, x = train_x,
>>       method = "knn" ,
>>       metric = "Accuracy",
>>       ## #  preProc = c("center", "scale", "nzv"),
>>       trControl = ctrl)
>>
>> p=predict(m, test_x)
>> confusionMatrix(p, as.factor(test_label))
>>
>> With some models, it show error like: Error in { :
>>   task 1 failed - "Not all variable names used in object found in newdata"
>>
>> However, when I run the base models like naiveBayes, it works.
>>
>> model_bayes <- naiveBayes(train_x, train_label, laplace = 1)
>>
>>
>> On Wed, Apr 20, 2022 at 11:09 PM Carlos Ortega <coforfe at gmail.com> wrote:
>>
>>> Hi,
>>>
>>> There are many things than could be wrong:
>>>
>>> 1. What is inside "ctrl" in the trainControl argument ?
>>> 2. Your model is a classication one, but if you do not configure
>>> correctly "ctrl" you do not get out the metrics correctly. It depends if
>>> your model is binary or multi-class.
>>> 3. Another thing is that if it is a classification one, you should also
>>> check that in the "train()" you "train_label" is a factor.
>>>
>>> On top of that, remember that your problem is not reproducible.
>>> If you attach a portion of your data, we could create a working "caret"
>>> code.
>>>
>>> Thanks,
>>> Carlos Ortega.
>>>
>>> On Wed, Apr 20, 2022 at 10:26 PM Bert Gunter <bgunter.4567 at gmail.com>
>>> wrote:
>>>
>>>> A quick web search on 'R caret package' found a host of useful
>>>> results, the first of which was this:
>>>> https://topepo.github.io/caret/
>>>> Note that the author, Max Kuhn, explicitly says there that you can
>>>> email him with questions. I think you should do so, as you do not seem
>>>> to be making progress here.
>>>>
>>>> Bert Gunter
>>>>
>>>> "The trouble with having an open mind is that people keep coming along
>>>> and sticking things into it."
>>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>>>
>>>> On Wed, Apr 20, 2022 at 12:51 PM javed khan <javedbtk111 at gmail.com>
>>>> wrote:
>>>> >
>>>> > Caret produce the error: Something is wrong; all the Accuracy metric
>>>> values
>>>> > are missing:
>>>> >     logLoss         AUC          prAUC        Accuracy       Kappa
>>>> >  Min.   : NA   Min.   : NA   Min.   : NA   Min.   : NA   Min.   : NA
>>>> >  1st Qu.: NA   1st Qu.: NA   1st Qu.: NA   1st Qu.: NA   1st Qu.: NA
>>>> >  Median : NA   Median : NA   Median : NA   Median : NA   Median : NA
>>>> >
>>>> > We (group of three) working on an assignment and could not fix this
>>>> error
>>>> > from a few days. The error comes with the majority of the models
>>>> while with
>>>> > a few model (e.g. nb), the code works. The data is text-based
>>>> > classification.
>>>> >
>>>> > Some Warnings are:
>>>> >
>>>> > Warning messages:
>>>> > 1: In train.default(y = train_label, x = train_x, method = "pls",
>>>> ... :
>>>> >   The metric "ROC" was not in the result set. logLoss will be used
>>>> instead.
>>>> > 2: model fit failed for Fold01.Rep1: ncomp=3 Error in
>>>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>>>> >   replacement has 320292 rows, data has 1148
>>>> >
>>>> > 3: model fit failed for Fold02.Rep1: ncomp=3 Error in
>>>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>>>> >   replacement has 320013 rows, data has 1147
>>>> >
>>>> > 4: model fit failed for Fold03.Rep1: ncomp=3 Error in
>>>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>>>> >   replacement has 320013 rows, data has 1147
>>>> >
>>>> > 5: model fit failed for Fold04.Rep1: ncomp=3 Error in
>>>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>>>> >   replacement has 320292 rows, data has 1148
>>>> >
>>>> > 6: model fit failed for Fold05.Rep1: ncomp=3 Error in
>>>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>>>> >   replacement has 320013 rows, data has 1147
>>>> >
>>>> > 7: model fit failed for Fold06.Rep1: ncomp=3 Error in
>>>> > `[[<-.data.frame`(`*tmp*`, i, value = structure(c(1L, 1L, 1L,  :
>>>> >   replacement has 320013 rows, data has 1147
>>>> >
>>>> >
>>>> >
>>>> > Code is
>>>> >
>>>> >
>>>> > m= train(y = train_label, x = train_x,
>>>> >       method = "pls" ,
>>>> >       metric = "Accuracy",
>>>> >       ## #  preProc = c("center", "scale", "nzv"),
>>>> >       trControl = ctrl)
>>>> >
>>>> > p=predict(m, test_x)
>>>> > confusionMatrix(p, as.factor(test_label))
>>>> >
>>>> >         [[alternative HTML version deleted]]
>>>> >
>>>> > ______________________________________________
>>>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> > https://stat.ethz.ch/mailman/listinfo/r-help
>>>> > PLEASE do read the posting guide http://www.R-project.org/
>>>> posting-guide.html
>>>> > and provide commented, minimal, self-contained, reproducible code.
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide http://www.R-project.org/
>>>> posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>>

	[[alternative HTML version deleted]]


From pd@|gd @end|ng |rom gm@||@com  Fri Apr 22 10:19:36 2022
From: pd@|gd @end|ng |rom gm@||@com (peter dalgaard)
Date: Fri, 22 Apr 2022 10:19:36 +0200
Subject: [R] [Rd] R 4.2.0 is released
Message-ID: <1E52AAD3-D28F-4071-B1B7-E7345DAB50EE@gmail.com>


The build system rolled up R-4.2.0.tar.gz (codename "Vigorous Calisthenics") this morning.

This is a major update, notably containing extensive rework on the Windows port and its toolchain, including UTF-8 support.

The list below details the changes in this release. 

You can get the source code from

https://cran.r-project.org/src/base/R-4/R-4.2.0.tar.gz

or wait for it to be mirrored at a CRAN site nearer to you.

Binaries for various platforms will appear in due course.


For the R Core Team,

Peter Dalgaard


These are the checksums (md5 and SHA-256) for the freshly created files, in case you wish
to check that they are uncorrupted:

MD5 (AUTHORS) = 320967884b547734d6279dedbc739dd4
MD5 (COPYING) = eb723b61539feef013de476e68b5c50a
MD5 (COPYING.LIB) = a6f89e2100d9b6cdffcea4f398e37343
MD5 (FAQ) = f593bc2137bcb005337630ca5611a26f
MD5 (INSTALL) = 7893f754308ca31f1ccf62055090ad7b
MD5 (NEWS) = c154effcc08d4202851e282bbac50859
MD5 (NEWS.0) = bfcd7c147251b5474d96848c6f57e5a8
MD5 (NEWS.1) = eb78c4d053ec9c32b815cf0c2ebea801
MD5 (NEWS.2) = b38d94569700664205a76a7de836ba83
MD5 (NEWS.3) = e55ed2c8a547b827b46e08eb7137ba23
MD5 (R-latest.tar.gz) = f1d4b7fec9e15835fdcfb8369ef039c0
MD5 (README) = f468f281c919665e276a1b691decbbe6
MD5 (RESOURCES) = a79b9b338cab09bd665f6b62ac6f455b
MD5 (THANKS) = 45b6d2e88a6ecb5b24fa33a781351cd5
MD5 (VERSION-INFO.dcf) = 3adb7939bc77f583d2472a43824072cd
MD5 (R-4/R-4.2.0.tar.gz) = f1d4b7fec9e15835fdcfb8369ef039c0

60a0d150e6fc1f424be76ad7b645d236b56e747692a4679f81ce6536c550e949  AUTHORS
e6d6a009505e345fe949e1310334fcb0747f28dae2856759de102ab66b722cb4  COPYING
6095e9ffa777dd22839f7801aa845b31c9ed07f3d6bf8a26dc5d2dec8ccc0ef3  COPYING.LIB
1b1f962382ff185e14b6b5b9b40dc87360399466c7d7ce928ae443261e3955c9  FAQ
f87461be6cbaecc4dce44ac58e5bd52364b0491ccdadaf846cb9b452e9550f31  INSTALL
faab2a0cdd10fa456fcdbbb409e2fd6fd0afe8d3d5172ce13fbed176976a3633  NEWS
4e21b62f515b749f80997063fceab626d7258c7d650e81a662ba8e0640f12f62  NEWS.0
12b30c724117b1b2b11484673906a6dcd48a361f69fc420b36194f9218692d01  NEWS.1
cde079b6beab7d700d3d4ecda494e2681ad3b7f8fab13b68be090f949393ec62  NEWS.2
1910a2405300b9bc7c76beeb0753a5249cf799afe175ce28f8d782fab723e012  NEWS.3
38eab7719b7ad095388f06aa090c5a2b202791945de60d3e2bb0eab1f5097488  R-latest.tar.gz
2fdd3e90f23f32692d4b3a0c0452f2c219a10882033d1774f8cadf25886c3ddc  README
8b7d3856100220f4555d4d57140829f2e81c27eccec5b441f5dce616e9ec9061  RESOURCES
8319c5415de58ee10d4bc058d79c370fd8e6b2ad09e25d7a1e04b74ca5f380a6  THANKS
b4aa7d9d51ed8145caa4490012cc8e33033b761c4e8eead49136b69cd481fc2f  VERSION-INFO.dcf
38eab7719b7ad095388f06aa090c5a2b202791945de60d3e2bb0eab1f5097488  R-4/R-4.2.0.tar.gz


This is the relevant part of the NEWS file

CHANGES IN R 4.2.0:

  SIGNIFICANT USER-VISIBLE CHANGES:

    * The formula method of aggregate() now matches the generic in
      naming its first argument x (resolving PR#18299 by Thomas
      Soeiro).

      This means that calling aggregate() with a formula as a named
      first argument requires name formula in earlier versions of R and
      name x now, so portable code should not name the argument (code
      in many packages did).

    * Calling && or || with either argument of length greater than one
      now gives a warning (which it is intended will become an error).

    * Calling if() or while() with a condition of length greater than
      one gives an error rather than a warning.  Consequently,
      environment variable _R_CHECK_LENGTH_1_CONDITION_ no longer has
      any effect.

    * Windows users should consult the WINDOWS section below for some
      profound changes including

        * Support for 32-bit builds has been dropped.

        * UTF-8 locales are used where available.

        * The default locations for the R installation and personal
          library folder have been changed.

      Thanks to Tomas Kalibera for months of work on the Windows port
      for this release.

  NEW FEATURES:

    * matrix(x, n, m) now warns in more cases where length(x) differs
      from n * m, as suggested by Abby Spurdle and Wolfgang Huber in
      Feb 2021 on the R-devel mailing list.

      This warning can be turned into an error by setting environment
      variable _R_CHECK_MATRIX_DATA_ to TRUE: R CMD check --as-cran
      does so unless it is already set.

    * Function file_test() in package utils gains tests for symlinks,
      readability and writability.

    * capabilities("libxml") is now false.

      The description of capabilities("http/ftp") now reflects that it
      refers to the default method, no longer the internal one.

    * simplify2array() gains an except argument for controlling the
      exceptions used by sapply().

    * Environment variables R_LIBS_USER and R_LIBS_SITE are both now
      set to the R system default if unset or empty, and can be set to
      NULL to indicate an empty list of user or site library
      directories.

    * The warning for axis()(-like) calls in cases of relatively small
      ranges (typically in log-scale situations) is slightly improved
      _and_ suppressed from explicit calls to .axisPars() as has always
      been the intention.

    * The contrasts setter function `contrasts<-` gains an explicit
      default how.many = NULL rather than just using missing(how.many).

    * grid.pretty() gains a new optional argument n = 5.

    * There is a new function .pretty() with option bounds as a
      technical-utility version of pretty().  It and pretty() gain a
      new argument f.min with a better than back-compatible default.

    * Function grDevices::axisTicks() and related functions such as
      graphics::axis() work better, notably for the log scale; partly
      because of the pretty() improvements, but also because care is
      taken e.g., when ylim is finite but diff(ylim) is infinite.

    * nclass.FD() gains a digits option.

    * The R Mathlib internal C function bd0() (called indirectly from a
      dozen probability density and distribution functions such as
      dpois(), dbinom(), dgamma(), pgamma() _etc_) has been
      complemented by a more sophisticated and (mostly) more accurate C
      function ebd0(), currently called only by internal dpois_raw()
      improving accuracy for R level dpois() and potentially others
      calling it such as dnbinom(), dgamma() or pgamma().  (Thanks to
      Morten Welinder's PR#15628.)

    * write.ftable() gains sep = " " argument as suggested by Thomas
      Soeiro.

    * The names of the locale categories supported by R's
      Sys.getlocale() and Sys.setlocale() are now provided by variable
      .LC.categories in the base namespace.

    * The Date and POSIXt methods for hist() and the histogram method
      for plot() now also use the new default col = "lightgray" in
      consistency with the corresponding change to hist()'s default for
      R 4.0.0.

    * hist.default() gains new fuzz argument, and the histogram plot
      method no longer uses fractional axis ticks when displaying
      counts ("Frequency").

    * mapply() and hence Map() now also obey the "max-or-0-if-any"
      recycling rule, such that, e.g., Map(`+`, 1:3, 1[0]) is valid
      now.

    * as.character(<obj>) for "hexmode" or "octmode" objects now
      fulfils the important basic rule as.character(x)[j] ===
      as.character(x[j]).

    * The set utility functions, notably intersect() have been tweaked
      to be more consistent and symmetric in their two set arguments,
      also preserving a common mode.

    * substr(ch, start,end) <- new now e.g., preserves names(ch); ditto
      for substring(), thanks to a patch from Brodie Gaslam.

    * plot(<lm>) gains a extend.ylim.f argument, in partial response to
      PR#15285; further PR#17784 is fixed thanks to several
      contributors and a patch by Elin Waring.  The Cook's dist
      contours get customizable via cook.col and cook.lty with a
      different default color and their legend is nicer by default and
      customizable via cook.legendChanges.

    * Attempting to subset an object that is not subsettable now
      signals an error of class notSubsettableError. The
      non-subsettable object is contained in the object field of the
      error condition.

    * Subscript-out-of-bounds errors are now signaled as errors of
      class subscriptOutOfBoundsError.

    * Stack-overflow errors are now signaled as errors inheriting from
      class stackOverflowError. See ?stackOverflowError for more
      details.

    * New partly experimental Sys.setLanguage() utility, solving the
      main problem of PR#18055.

    * gettext() and gettextf() get a new option trim = TRUE which when
      set to false allows translations for strings such as "Execution
      halted\n" typical for C code.

    * An experimental implementation of hash tables is now available.
      See ?hashtab for more details.

    * identical() gains a extptr.as.ref argument for requesting that
      external pointer objects be compared as reference objects.

    * reorder() gets an argument decreasing which it passes to sort()
      for level creation; based on the wish and patch by Thomas Soeiro
      in PR#18243.

    * as.vector() gains a data.frame method which returns a simple
      named list, also clearing a long standing 'FIXME' to enable
      as.vector(<data.frame>, mode="list").  This breaks code relying
      on as.vector(<data.frame>) to return the unchanged data frame.

    * legend() is now vectorized for arguments cex, x.intersp, and
      text.width.  The latter can now also be specified as a vector
      (one element for each column of the legend) or as NA for
      computing a proper column wise maximum value of strwidth(legend).
      The argument y.intersp can be specified as a vector with one
      entry for each row of the legend.

      legend() also gains new arguments title.cex and title.font.
      Thanks to Swetlana Herbrandt.

    * Deparsing no longer remaps attribute names dim, dimnames, levels,
      names and tsp to historical S-compatible names (which structure()
      maps back).

    * sample() and sample.int() have additional sanity checks on their
      size and n arguments.

      all.equal.numeric() gains a sanity check on its tolerance
      argument - calling all.equal(a, b, c) for three numeric vectors
      is a surprisingly common error.

      mean(na.rm =), rank(na.last =), barplot(legend.text =),
      boxplot(), contour(drawlabels =), polygon(border =) and
      methods::is(class2 =) have more robust sanity checks on their
      arguments.

      R CMD Rd2pdf (used by R CMD check) has a more robust sanity check
      on the format of \alias{} commands.

    * psigamma(x, deriv) for negative x now also works for deriv = 4
      and 5; their underlying C level dpsifn() is documented in
      'Writing R Extensions'.

    * The HTML help system now uses HTML5 (wish of PR#18149).

    * ks.test() now provides exact p-values also with ties and MC
      p-values in the two-sample (Smirnov) case.  By Torsten Hothorn.

    * ks.test() gains a formula interface, with y ~ 1 for the
      one-sample (Kolmogorov) test and y ~ group for the two-sample
      (Smirnov) test.  Contributed by Torsten Hothorn.

    * The return value from ks.test() now has class c("ks.test",
      "htest") - packages using try() need to take care to use
      inherits() and not == on the class.

    * New functions psmirnov(), qsmirnov() and rsmirnov() in package
      stats implementing the asymptotic and exact distributions of the
      two-sample Smirnov statistic.

    * iconv() now allows sub = "c99" to use C99-style escapes for UTF-8
      inputs which cannot be converted to encoding to.

    * In a forward pipe |> expression it is now possible to use a named
      argument with the placeholder _ in the rhs call to specify where
      the lhs is to be inserted.  The placeholder can only appear once
      on the rhs.

    * The included LAPACK sources have been updated to version 3.10.0,
      except for the four Fortran 77 routines which 3.10.0 has
      re-implemented in Fortran 90 (where the older versions have been
      retained as the R build process does not support Fortran 90).

    * path.expand() and most other uses of tilde expansion now warn if
      a path would be too long if expanded.  (An exception is
      file.exists(), which silently returns false.)

    * trunc(<Date>, *) now supports units = "months" or "years" for
      consistency with the POSIXt method, thanks to Dirk Eddelbuettel's
      proposal in PR#18099.

    * list2DF() now checks that its arguments are of the same length,
      rather than use recycling.

    * The HTML help system has several new features: LaTeX-like math
      can be typeset using either KaTeX or MathJax, usage and example
      code is highlighted using Prism, and for dynamic help the output
      of examples and demos can be shown within the browser if the
      knitr package is installed. These features can be disabled by
      setting the environment variable _R_HELP_ENABLE_ENHANCED_HTML_ to
      a false value.

  GRAPHICS:

    * The graphics engine version, R_GE_version, has been bumped to 15
      and so packages that provide graphics devices should be
      reinstalled.

    * The grid package now allows the user to specify a "vector" of
      pattern fills.  The fill argument to gpar() accepts a list of
      gradients and/or patterns and the functions linearGradient(),
      radialGradient(), and pattern() have a new group argument.

      Points grobs (data symbols) can now also have a pattern fill.

      The grobCoords() function now returns a more informative and
      complex result.

    * The grid package has new functions for drawing isolated groups:
      grid.group(), grid.define(), and grid.use().  These functions add
      compositing operators and affine transformations to R's graphics
      capabilities.

      The grid package also has new functions for stroking and filling
      paths: grid.stroke(), grid.fill(), and grid.fillStroke().

      A new function as.path() allows the user to specify the fill rule
      for a path that is to be used for clipping, stroking, or filling;
      available options are "winding" and "evenodd".  A new function
      as.mask() allows the user to specify the type of a mask;
      available options are "alpha" and "luminance".

      These new features are only supported so far (at most) on the
      Cairo-based graphics devices and on the pdf() device.

    * dev.capabilities() reports on device support for the new
      features.

    * par() now warns about unnamed non-character arguments to prevent
      misuse such as {usr <- par("usr"); par(usr)}.

  WINDOWS:

    * R uses UTF-8 as the native encoding on recent Windows systems (at
      least Windows 10 version 1903, Windows Server 2022 or Windows
      Server 1903).  As a part of this change, R uses UCRT as the C
      runtime.  UCRT should be installed manually on systems older than
      Windows 10 or Windows Server 2016 before installing R.

    * The default personal library on Windows, folder R\win-library\x.y
      where x.y stands for R release x.y.z, is now a subdirectory of
      Local Application Data directory (usually a hidden directory
      C:\Users\username\AppData\Local).  Use shell.exec(.libPaths()[1])
      from R to open the personal library in Explorer when it is first
      in the list (PR#17842).

    * R uses a new 64-bit Tcl/Tk bundle.  The previous 32-bit/64-bit
      bundle had a different layout and can no longer be used.

    * Make files and installer scripts for Windows have been tailored
      to Rtools42, the newly recommended 64-bit gcc 10.3 MinGW-W64 UCRT
      toolchain.

    * Rtools42 by default uses the Windows security features ASLR and
      DEP; hence CRAN builds of R and packages also do.

    * R now supports files Makevars.ucrt, Makefile.ucrt, configure.ucrt
      and cleanup.ucrt in packages, which are used in preference to the
      .win variants.  This allows keeping the .win files around to
      support older versions of R.  This feature will be removed in the
      future once support for older versions of R would no longer be
      needed.

    * R.version gains a new field crt (only on Windows) to denote the C
      runtime.  The value is "ucrt".

    * On Windows, download.file(method = "auto") and url(method =
      "default") now follow Unix in using "libcurl" for all except
      file:// URIs.

    * Rtools42 includes an unpatched Msys2 build of GNU tar.  Paths
      including drive letters can be made to work by adding
      --force-local to environment variable TAR_OPTIONS.  (Rtools40 and
      earlier included a patched version which defaulted to this
      option.)

    * Installer builds of R automatically find the Rtools42 software
      collection as well as the compiler toolchain.  No PATH setting is
      required from the user.

    * The default installation directory of R for a user-only
      installation has been changed to the User Program Files directory
      (usually a hidden directory
      C:\Users\username\AppData\Local\Programs) to follow Windows
      conventions.  Use shell.exec(R.home()) from R to open the R
      installation directory in Explorer (PR#17842).

    * R now supports installation-time patching of packages.  Patches
      may be installed from a supplied URL or a local directory or
      disabled.  Patches are included into the installed packages for
      reference.  This experimental feature may be removed in the
      future.

    * libcurl is now required for building from source.

    * The clipboard connection now works also with text in other than
      the current native encoding (PR#18267, with Hiroaki Yutani).
      Text is always pasted to the clipboard in UTF16-LE and the
      encoding argument is ignored.

    * The internal case-changing functions are now used by default on
      Windows - this circumvents problems (for example with E acute) of
      the UCRT Windows' runtime.

    * R on Windows now uses the system memory allocator.  Doug Lea's
      allocator was used since R 1.2.0 to mitigate performance
      limitations seen with system allocators on earlier versions of
      Windows.

    * memory.limit() and memory.size() are now stubs on Windows (as on
      Unix-alikes).

    * Applications embedding R on Windows can now use additional
      callbacks, which have so far only been available only on Unix
      (PR#18286).

  INSTALLATION:

    * Facilities for accessing ftp:// sites are no longer tested
      (except _pro tem_ for curlGetHeaders()) as modern browsers have
      removed support.

    * R can now be built with DEFS = -DSTRICT_R_HEADERS .

  PACKAGE INSTALLATION:

    * R CMD INSTALL no longer tangles vignettes. This completes an R
      CMD build change in R 3.0.0 and affects packages built before R
      3.0.2. Such packages should be re-made with R CMD build to have
      the tangled R code of vignettes shipped with the tarball.

    * USE_FC_LEN_T will become the default: this uses the correct
      prototypes for Fortran BLAS/LAPACK routines called from C/C++,
      and requires adjustment of most such calls - see 'Writing R
      Extensions' SS6.6.2.  (This has been supported since R 3.6.2.)

    * Package installation speed for packages installed with
      keep.source has been improved. This resolve the issue reported by
      Ofek Shilon in PR#18236.

  UTILITIES:

    * R CMD check can optionally report files/directories left behind
      in home, /tmp (even though TMPDIR is set) and other directories.
      See the "R Internals" manual for details.

    * R CMD check now reports byte-compilation errors during
      installation.  These are not usually fatal but may result in
      parts of the package not being byte-compiled.

    * _R_CHECK_DEPENDS_ONLY_ can be applied selectively to examples,
      tests and/or vignettes in R CMD check: see the "R Internals"
      manual.

    * _R_CHECK_SRC_MINUS_W_IMPLICIT_ now defaults to true: recent
      versions of Apple clang on macOS have made implicit function
      declarations in C into a compilation error.

    * R CMD check --as-cran makes use of the environment variable
      AUTORECONF.  See the "R Internals" manual SS8 for further details.

    * R CMD check --use-valgrind also uses valgrind when re-building
      vignettes as some non-Sweave vignettes unhelpfully comment out
      all their code when R CMD check runs vignettes.

    * Errors in re-building vignettes (unless there are LaTeX errors)
      are reported by R CMD check as ERROR rather than WARNING when
      running vignettes has been skipped (as it frequently is in CRAN
      checks and by --as-cran).

    * R CMD Rd2pdf gains a --quiet option that is used by R CMD build
      when building the PDF package manual.

    * R CMD Rd2pdf now always runs LaTeX in batch mode, consistent with
      Texinfo >= 6.7. The --batch option is ignored.

    * R CMD build and R CMD check now include the Rd file name and line
      numbers in the error message of an \Sexpr evaluation failure.

    * For packages using the \doi Rd macro (now an install-time \Sexpr)
      but no other dynamic Rd content, R CMD build now produces a
      smaller tarball and is considerably faster - skipping temporary
      package installation.

  C-LEVEL FACILITIES:

    * The non-API header R_ext/R-ftp-http.h is no longer provided, as
      the entry points it covered are now all defunct.

    * A number of non-API declarations and macro definitions have been
      moved from the installed header Rinternals.h to the internal
      header Defn.h. Packages that only use entry points and
      definitions documented to be part of the API as specified in
      'Writing R Extensions' SS6 should not be affected.

    * The macro USE_RINTERNALS no longer has any effect when compiling
      package code.  Packages which also use R_NO_REMAP will need to
      ensure that the remapped names are used for calls to API
      functions that were formerly also made available as macros.

    * The deprecated legacy S-compatibility macros PROBLEM, MESSAGE,
      ERROR, WARN, WARNING, RECOVER, ... are no longer defined in
      R_exts/RS.h (included by R.h).  Replace these by calls to
      Rf_error and Rf_warning (defined in header R_ext/Error.h included
      by R.h).

      Header R_ext/RS.h no longer includes R_ext/Error.h.

    * Header R_ext/Constants.h (included by R.h) when included from C++
      now includes the C++ header cfloat rather than the C header
      float.h (now possible as C++11 is required).

    * The legacy S-compatibility macros DOUBLE_* in R_ext/Constants.h
      (included by R.h) are deprecated.

    * The deprecated S-compatibility macros SINGLE_* in
      R_ext/Constants.h (included by R.h) have been removed.

    * R_Calloc, R_Free and R_Realloc are preferred to their unprefixed
      forms and error messages now use the prefix. These forms were
      introduced in R 3.4.0 and are available even when
      STRICT_R_HEADERS is defined.

    * rmultinom has been documented in 'Writing R Extensions' SS6 so is
      now part of the R API.

    * Similarly, Rtanpi, called from R level tanpi() is now part of the
      R API.

    * The long-deprecated, undocumented and non-API entry point call_R
      is no longer declared in R_ext/RS.h (included by R.h).

    * The header S.h which has been unsupported since Jan 2016 has been
      removed.  Use R.h instead.

  DEPRECATED AND DEFUNCT:

    * The (non-default and deprecated) method = "internal" for
      download.file() and url() no longer supports http:// nor ftp://
      URIs.  (It is used only for file:// URIs.)

      On Windows, download.file(method = "wininet") no longer supports
      ftp:// URIs.  (It is no longer the default method, which is
      "libcurl" and does.)

      On Windows, the deprecated method = "wininet" now gives a warning
      for http:// and https:// URIs for both download.file() and url().
      (It is no longer the default method.)

    * On Windows, the command-line option --max-mem-size and
      environment variable R_MAX_MEM_SIZE are defunct.  The memory
      allocation limit was important for 32-bit builds, but these are
      no longer supported.

    * default.stringsAsFactors() is now formally deprecated, where that
      was only mentioned on its regular help page, previously.  So it
      now gives a warning if called.

    * unix.time() is defunct now; it had been deprecated since R 3.4.0.

  BUG FIXES:

    * Setting digits = 0 in format(), print.default() (and hence
      typically print()) or options() is again invalid.  Its behaviour
      was platform-dependent, and it is unclear what "zero significant
      digits" should mean (PR#18098).

    * Messages from C code in the cairo section of package grDevices
      are now also offered for translation, thanks to Michael Chirico's
      PR#18123.

    * mean(x) with finite x now is finite also without "long.double"
      capability.

    * R CMD Rd2pdf no longer leaves an empty build directory behind
      when it aborts due to an already existing output file.  (Thanks
      to Sebastian Meyer's PR#18141.)

    * density(x, weights = w, na.rm = TRUE) when anyNA(x) is true, now
      removes weights "in parallel" to x, fixing PR#18151, reported by
      Matthias Gondan.  Additionally, it gets a subdensity option.

    * Conversion of \Sexpr[]{<expR>} to LaTeX or HTML no longer
      produces long blocks of empty lines when <expR> itself contains
      several lines all producing empty output.  Thanks to a report and
      patch by Ivan Krylov posted to R-devel.

    * R CMD build no longer fails if a package vignette uses child
      documents and inst/doc exists.  (Thanks to Sebastian Meyer's
      PR#18156.)

    * When an R documentation ('help' source) file man/foo.Rd in a
      package has \donttest{..} examples with a syntax error, it is now
      signalled as ERROR and with correct line numbers relating to the
      *-Ex.R file, thanks to Duncan Murdoch and Sebastian Meyer's
      reports and patch proposals in PR#17501.

    * Improved determination of the correct translation domain in
      non-base packages, addressing the combination of PR#18092 and
      PR#17998 (#c6) with reports and _augmented_ patch #2904 by
      Suharto Anggono.

      Note that "R-base" is no longer the default domain e.g., for
      top-level calls to gettext(); rather translation needs explicit
      domain = * specification in such cases.

    * identical(attrib.as.set=FALSE) now works correctly with data
      frames with default row names (Thanks to Charlie Gao's PR#18179).

    * txtProgressBar() now enforces a non-zero width for argument char,
      without which no progress can be visible.

    * dimnames(table(d)) is more consistent in the case where d is a
      list with a single component, thanks to Thomas Soeiro's report to
      R-devel.

      Further, table(d1, d2) now gives an error when d1 and d2 are data
      frames as suggested by Thomas in PR#18224.

    * Fix for drawing semi-transparent lines and fills on the native
      Windows graphics device (PR#18219 and PR#16694).  Thanks to Nick
      Ray for helpful diagnosis on Bugzilla.

    * The deparser now wraps sub-expressions such as if(A) ..  with
      parentheses when needed; thanks to Duncan Murdoch's PR#18232 and
      Lionel Henry's patches there.

    * remove.packages() no longer tries to uninstall Priority: base
      packages, thanks to a report and suggestions by Colin Fay in
      PR#18227.

    * win.metafile() now has xpinch and ypinch arguments so that the
      user can override Windows' (potentially wrong) guess at device
      dimensions.

    * x[i] and x[[i]] for non-integer i should now behave in all cases
      as always documented: the index used is equivalent to
      as.integer(i) unless that would overflow where trunc(i) is used
      instead; thanks to Suharto Anggono's report and patch proposals
      in PR#17977.

    * asOneSidedFormula() now associates the resulting formula with the
      global environment rather than the evaluation environment created
      for the call.

    * <bibentry>$name now matches the field name case-insensitively,
      consistent with bibentry() creation and the replacement method.

    * cbind() failed to detect some length mismatches with a mixture of
      time-series and non-time-series inputs.

    * The default LaTeX style file Sweave.sty used by the RweaveLatex
      driver no longer loads the obsolete ae package; thanks to a
      report by Thomas Soeiro in PR#18271.  Furthermore, it now skips
      \usepackage[T1]{fontenc} for engines other than pdfTeX (if
      detected) or if the new [nofontenc] option is used.

    * smooth.spline() now stores its logical cv argument more safely,
      fixing a rare bug when printing, and also stores n.

    * smooth.spline(x,y,*) now computes the cv.crit statistic
      correctly, also when is.unsorted(x), fixing PR#18294.

    * The data.frame method of rbind() now warns when binding
      not-wholly-recycling vectors, by analogy to the default method
      (for matrices).

    * setAs() finds the correct class for name to when multiple
      packages define a class with that name. Thanks to Gabor Csardi
      for the report.

    * Fix for detaching a package when two classes of the same name are
      present in method signatures for the same generic. Thanks to
      Gabor Csardi for the report.

    * match.arg("", c("", "a", "B")) gives a better error message, in
      part from PR#17959, thanks to Elin Waring.

    * R CMD Sweave --clean no longer removes pre-existing files or
      subdirectories (PR#18242).

    * The quartz() device no longer splits polylines into subpaths.
      That has caused narrowly-spaced lines with many points to always
      look solid even when dashed line type was used due to dash phase
      restarts.

    * Deparsing constructs such as quote(1 + `!`(2) + 3) works again as
      before R 3.5.0, thanks to the report and patch in PR#18284 by
      Suharto Anggono.

    * as.list(f) for a factor f now keeps names(f), fixing PR#18309.

    * qbeta(.001, .9, .009) and analogous qf() calls now return a
      correct value instead of NaN or wrongly 1, all with a warning;
      thanks to the report by Ludger Goeminne in PR#18302.

    * plot.lm() failed to produce the plot of residuals vs.  factor
      levels (i.e., which=5 when leverages are constant) for models
      with character predictors (PR#17840).

    * interaction.plot(..., xtick = TRUE) misplaced the x-axis line
      (PR#18305).

    * Not strictly fixing a bug, format()ing and print()ing of
      non-finite Date and POSIXt values NaN and +/-Inf no longer show
      as NA but the respective string, e.g., Inf, for consistency with
      numeric vector's behaviour, fulfilling the wish of PR#18308.

    * R CMD check no longer runs test scripts generated from
      corresponding .Rin files twice and now signals an ERROR if
      processing an .Rin script fails.

    * tools::Rd2txt() used for plain-text help pages now renders \hrefs
      (if tools::Rd2txt_options(showURLs = TRUE)) and \urls with
      percent-encoding and standards-compliant delimiting style (angle
      brackets and no URL: prefix).  \email is now rendered with a
      mailto: prefix.

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel

_______________________________________________
R-announce at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-announce


From dc@r|@on @end|ng |rom t@mu@edu  Sat Apr 23 06:04:32 2022
From: dc@r|@on @end|ng |rom t@mu@edu (David Carlson)
Date: Fri, 22 Apr 2022 23:04:32 -0500
Subject: [R] Model To Simulate Dice Roll
In-Reply-To: <931063bd-ecd7-8edd-23c1-dcb5f02f86a7@sapo.pt>
References: <CAMOcQfMMq7U0jjsGgfL3kQ=Gc4ZsMqZVaLP=SmguPJuhZTYRGg@mail.gmail.com>
 <CAGxFJbTwAqA9beG8FwUPY+v4S-jKMM8+3YjTqH0r_WO2JvOZ_Q@mail.gmail.com>
 <CAMOcQfOQG4camFLTHpesHUMd9L01tmUW0xHUQGDJK1dBQ=nAAw@mail.gmail.com>
 <63179a44-d944-fe1e-ae0f-c6ed7d2d3cde@sapo.pt>
 <931063bd-ecd7-8edd-23c1-dcb5f02f86a7@sapo.pt>
Message-ID: <CAE-dL2orYo_bAzxh3-CTC2FfiiD8JzYRRVzgsTmGmDN857b+6Q@mail.gmail.com>

Since the rolls are independent, it is not necessary to separate the rolls
into two stages:

sides <- 6
months <- 12
reps <- 100

set.seed(2022)
results <- matrix(sample.int(sides, months*reps, replace=TRUE), reps,
months, byrow=TRUE)
colnames(results) <- month.name
all6 <- apply(results, 1, function(x) length(intersect(x, 1:6))==6)
sum(all6)/reps
# 0.53 which matches Rui's result
results <- as.data.frame(results)

David L. Carlson



On Thu, Apr 21, 2022 at 4:04 AM Rui Barradas <ruipbarradas at sapo.pt> wrote:

> Hello, There's an error in my code, inline. ?s 07:55 de 21/04/2022, Rui
> Barradas escreveu: > Hello, > > For what I understand of the question, the
> followng might answer it. > > The functions below roll dice and simulate R
> replicates
> ZjQcmQRYFpfptBannerStart
> This Message Is From an External Sender
> This message came from outside your organization.
>
> ZjQcmQRYFpfptBannerEnd
>
> Hello,
>
> There's an error in my code, inline.
>
> ?s 07:55 de 21/04/2022, Rui Barradas escreveu:
> > Hello,
> >
> > For what I understand of the question, the followng might answer it.
> >
> > The functions below roll dice and simulate R replicates of dice rolls.
> > Then 12 (one per month) 6 sided dice rolls are simulated 100 times.
> >
> > The colMeans/apply computes the empiric probabilities of having all 6
> > sides occur in each row, Jan to Dec and a overall probabilty is the mean
> > of those probabilities.
> >
> > The matrix is coerced to data.frame only at the end.
> >
> >
> >
> > dice <- function(rolls = 1, ndice = 1, sides = 6) {
> >    roll <- function(ndice = 1, sides = 6) {
> >      sample(seq_len(sides), ndice, replace = TRUE)
> >    }
> >    y <- replicate(rolls, roll(ndice = ndice, sides = sides))
> >    if(is.null(dim(y))) y else colSums(y)
> > }
> > dice_simul <- function(rolls = 1, ndice = 1, sides = 6, R) {
> >    if(missing(R)) {
> >      stop("number of simulations 'R' is missing with no default.")
> >    }
> >    replicate(R, dice(rolls = rolls, ndice = ndice, sides = sides))
> > }
> >
> > dice_rolls <- 100
> > #dice_rolls <- 1e6
> > num_dice <- 1
> > dice_sides <- 6
> > months <- 12
> >
> > set.seed(2022)
> > prob_frame <- t(dice_simul(months, num_dice, dice_sides, R = dice_rolls))
> > colnames(prob_frame) <- month.name
> > head(prob_frame)
> >
>
> # --- wrong
> > p <- colMeans(apply(prob_frame, 1, \(x) 1:6 %in% x))
> > mean(p)
> > # [1] 0.9116667
>
> This should be
>
> yes_no <- apply(prob_frame, 1, \(x) all(1:6 %in% x))
> p <- mean(yes_no)
> p
> # [1] 0.53
>
>
> Rui Barradas
>
>
>
> >
> > prob_frame <- as.data.frame(prob_frame)
> >
> >
> > Hope this helps,
> >
> > Rui Barradas
> >
> >
> > ?s 05:02 de 21/04/2022, Paul Bernal escreveu:
> >> Dear friend Bert,
> >>
> >> Thank you so much for your kind reply. The first thing I need to do is to
> >> simulate dice rolls, say 120 times.
> >>
> >> I want to populate an m by 12 dataframe with the results of each dice
> >> roll.
> >> For example, the result from dice roll #1 would need to go on row 1,
> >> column1, the result from dice roll #2 would have to go in row 1 column 2,
> >> and so on.
> >>
> >> The reason why I want to store those results in a dataframe is to be able
> >> to perform some other calculations afterwards.
> >>
> >> This is for a project I am doing.
> >>
> >> So this is the situation:
> >> You and five friends ? a total of six people ? plan to meet once per
> >> month
> >> to have dinner together, with one of you choosing the restaurant each
> >> month. Rather than scheduling the entire year in advance, you decide to
> >> make it interesting: each month a single six-sided die will be rolled to
> >> determine which of you gets to choose the restaurant that month. How
> >> likely
> >> is it that everyone will have a chance to eat at their own favorite
> >> restaurant? That is, what is the probability p that over the next 12
> >> months, each of you will have had at least one opportunity to choose
> >> where
> >> to eat?
> >>
> >> This is what I am asked to do:
> >> Write a program to estimate the desired probability p via simulation. The
> >> program should input a sequence of positive integer number of trials to
> >> simulate using the language's pseudorandom number generator and calculate
> >> the corresponding fractions of simulated trials that are ?successful"
> >> (i.e., all 6 parties get at least one opportunity to choose where to eat.
> >> Alice, Bob, Charley, Fred, Ellen, Don, Don, Don, Don, Alice, Charley, Bob
> >> is a successful trial. Alice, Bob, Charley, Ellen, Don, Don, Don, Don,
> >> Ellen, Alice, Charley, Bob is not a successful trial since Fred does not
> >> get to choose.)
> >> Turn in a set of 10 trials showing each roll of the dice to show
> >> correctness. Label the out-comes. Keep in mind that a single trial
> >> requires
> >> rolling the die twelve times. Calculate and print the average
> >> probability p
> >> for the set. Please refer to your friends by name.
> >>
> >> For this reason, I am trying to simulate the n trials, and then
> >> populate a
> >> table with the results from the trials. I have to simulate a dice roll
> >> dice
> >> for each month and for each row. Rows would be equivalent to years, and
> >> then columns would be equivalent to the month of a particular year.
> >>
> >> Once I store the results in a dataframe, everything is much easier.
> >>
> >> I installed package dice and performed simulations by doing:
> >> #declaring variables:
> >> #1)dice_rolls which is the number of times the dice will be rolled
> >> #2)num_dice which is the number of dice that will be rolled each time
> >> #3)dice_sides which is the number of sides of the dice
> >> #function dice will take each one of these variables as its parameter to
> >> perform the simulation
> >> dice_rolls = 120
> >> num_dice   = 1
> >> dice_sides = 6
> >>
> >> #performing simulation
> >> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
> >> dice_sides,
> >> plot.it = TRUE)
> >>
> >> I tried the following, but did not work as expected:
> >>
> >> for (i in 1:nrow(dice_simul)){
> >>    for(j in 1:ncol(prob_frame)){
> >>      for(k in 1:nrow(prob_frame)){
> >>        prob_frame[k,j] = dice_simul[i,1]
> >>      }
> >>    }
> >> }
> >>
> >> I apologize for the long explanation.
> >>
> >> Best regards,
> >>
> >> Paul
> >>
> >>
> >> El mi?, 20 abr 2022 a las 22:47, Bert Gunter (<bgunter.4567 at gmail.com>)
> >> escribi?:
> >>
> >>> If I understand you correctly, it's simple.
> >>> Matrices in R are vectors with a dimension attribute. By default, they
> >>> are populated column by column. Use 'byrow = TRUE to populate by row
> >>> instead. For example:
> >>>
> >>>> matrix (1:36, ncol = 12, byrow = TRUE)
> >>>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
> >>> [1,]    1    2    3    4    5    6    7    8    9    10    11    12
> >>> [2,]   13   14   15   16   17   18   19   20   21    22    23    24
> >>> [3,]   25   26   27   28   29   30   31   32   33    34    35    36
> >>>
> >>> I leave it to you to use the 'dimnames' argument of ?matrix  to give
> >>> names to the column and then subsequently convert to a data frame if
> >>> you like.
> >>>
> >>> Bert Gunter
> >>>
> >>> "The trouble with having an open mind is that people keep coming along
> >>> and sticking things into it."
> >>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> >>>
> >>> On Wed, Apr 20, 2022 at 8:38 PM Paul Bernal <paulbernal07 at gmail.com>
> >>> wrote:
> >>>>
> >>>> Dear friends,
> >>>>
> >>>> Hope you are doing well. I need to simulate a 1 dice roll for each
> >>>> one of
> >>>> the twelve months of the year and perform 100 trials, so I thought of
> >>>> constructing a dataframe with twelve columns and 100 rows the following
> >>> way:
> >>>>
> >>>> num_rows = 100
> >>>>
> >>>> prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
> >>>>
> >>> colnames(prob_frame)<-c("January","February","March","April","May","June","July","August","September","October","November","December")
> >>>
> >>>>
> >>>> Now, using the dice package, I can simulate n number of dice rolls as
> >>>> follows:
> >>>> #performing simulation
> >>>> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
> >>> dice_sides,
> >>>> plot.it = TRUE)
> >>>>
> >>>> What I would like to do is to populate each column and row with the
> >>> results
> >>>> of dice_simul.
> >>>>
> >>>> Let me show you the structure of dice_simul:
> >>>>> str(dice_simul)
> >>>> Classes ?dice? and 'data.frame': 100 obs. of  1 variable:
> >>>>   $ Red: int  2 2 1 2 5 4 4 6 1 4 ...
> >>>>> dput(dice_simul)
> >>>> structure(list(Red = c(2L, 2L, 1L, 2L, 5L, 4L, 4L, 6L, 1L, 4L,
> >>>> 4L, 2L, 6L, 2L, 2L, 1L, 3L, 6L, 1L, 5L, 5L, 5L, 3L, 4L, 2L, 6L,
> >>>> 4L, 6L, 6L, 2L, 1L, 2L, 2L, 6L, 4L, 2L, 3L, 5L, 6L, 6L, 4L, 5L,
> >>>> 4L, 6L, 6L, 3L, 4L, 1L, 5L, 3L, 3L, 5L, 3L, 4L, 1L, 3L, 3L, 2L,
> >>>> 4L, 1L, 2L, 1L, 6L, 3L, 5L, 5L, 3L, 4L, 4L, 5L, 4L, 1L, 5L, 3L,
> >>>> 4L, 4L, 3L, 6L, 5L, 2L, 4L, 1L, 1L, 6L, 4L, 3L, 6L, 5L, 6L, 2L,
> >>>> 6L, 1L, 6L, 6L, 4L, 3L, 4L, 2L, 1L, 5L)), class = c("dice",
> >>>> "data.frame"
> >>>> ), row.names = c(NA, -100L))
> >>>>
> >>>> For example, the first number of dice_simul should go to row 1 for
> >>> January,
> >>>> the second number of dice_simul should go to row 1 for February, ...
> >>>> the
> >>>> twelveth number of dice_simul should go to row 1 for December, the 13th
> >>>> number should go to row 2 for january, and so on.
> >>>>
> >>>> This is what I tried to do but doesn?t work they way I want to:
> >>>>
> >>>> #1)dice_rolls which is the number of times the dice will be rolled
> >>>> #2)num_dice which is the number of dice that will be rolled each time
> >>>> #3)dice_sides which is the number of sides of the dice
> >>>> #function dice will take each one of these variables as its
> >>>> parameter to
> >>>> perform the simulation
> >>>> dice_rolls = 100
> >>>> num_dice   = 1
> >>>> dice_sides = 6
> >>>>
> >>>> #performing simulation
> >>>> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
> >>> dice_sides,
> >>>> plot.it = TRUE)
> >>>>
> >>>> num_rows = 100
> >>>>
> >>>> prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
> >>>> colnames(prob_frame) <-
> >>>>
> >>> c("January","February","March","April","May","June","July","August","September","October","November","December")
> >>>
> >>>>
> >>>>
> >>>> for (j in 1:12){
> >>>>    for (i in 1:num_rows){
> >>>>      prob_frame[i,j]=dice_simul[i,1]
> >>>>    }
> >>>> }
> >>>> I basically want to populate the twelve months for the first row, then
> >>> the
> >>>> twelve months for the second row, and so on, until I get to populate
> >>>> the
> >>>> twelve months for the last row sequentially.
> >>>>
> >>>> How could I accomplish this?
> >>>>
> >>>> Any help and/or guidance will be greatly appreciated.
> >>>>
> >>>> Best regards,
> >>>> Paul
> >>>>
> >>>>          [[alternative HTML version deleted]]
> >>>>
> >>>> ______________________________________________
> >>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>>> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAbZaomfvI$
> >>>> PLEASE do read the posting guide
> >>> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAb7rrtTbc$
> >>>> and provide commented, minimal, self-contained, reproducible code.
> >>>
> >>
> >>     [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAbZaomfvI$
> >> PLEASE do read the posting guide
> >> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAb7rrtTbc$
> >> and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAbZaomfvI$
> > PLEASE do read the posting guide
> > https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAb7rrtTbc$
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, seehttps://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAbZaomfvI$
> PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAb7rrtTbc$
> and provide commented, minimal, self-contained, reproducible code.
>
>

	[[alternative HTML version deleted]]


From p@u|bern@|07 @end|ng |rom gm@||@com  Sat Apr 23 06:05:38 2022
From: p@u|bern@|07 @end|ng |rom gm@||@com (Paul Bernal)
Date: Fri, 22 Apr 2022 23:05:38 -0500
Subject: [R] Model To Simulate Dice Roll
In-Reply-To: <CAE-dL2orYo_bAzxh3-CTC2FfiiD8JzYRRVzgsTmGmDN857b+6Q@mail.gmail.com>
References: <CAMOcQfMMq7U0jjsGgfL3kQ=Gc4ZsMqZVaLP=SmguPJuhZTYRGg@mail.gmail.com>
 <CAGxFJbTwAqA9beG8FwUPY+v4S-jKMM8+3YjTqH0r_WO2JvOZ_Q@mail.gmail.com>
 <CAMOcQfOQG4camFLTHpesHUMd9L01tmUW0xHUQGDJK1dBQ=nAAw@mail.gmail.com>
 <63179a44-d944-fe1e-ae0f-c6ed7d2d3cde@sapo.pt>
 <931063bd-ecd7-8edd-23c1-dcb5f02f86a7@sapo.pt>
 <CAE-dL2orYo_bAzxh3-CTC2FfiiD8JzYRRVzgsTmGmDN857b+6Q@mail.gmail.com>
Message-ID: <CAMOcQfPB4eQ7TpSnK_fqcjfUJ8ycmYiWMQ-ea3WaHqPaU_ZrTg@mail.gmail.com>

Thank you so much David!

El El vie, 22 de abr. de 2022 a la(s) 11:04 p. m., David Carlson <
dcarlson at tamu.edu> escribi?:

> Since the rolls are independent, it is not necessary to separate the rolls
> into two stages:
>
> sides <- 6
> months <- 12
> reps <- 100
>
> set.seed(2022)
> results <- matrix(sample.int(sides, months*reps, replace=TRUE), reps,
> months, byrow=TRUE)
> colnames(results) <- month.name
> all6 <- apply(results, 1, function(x) length(intersect(x, 1:6))==6)
> sum(all6)/reps
> # 0.53 which matches Rui's result
> results <- as.data.frame(results)
>
> David L. Carlson
>
>
>
> On Thu, Apr 21, 2022 at 4:04 AM Rui Barradas <ruipbarradas at sapo.pt> wrote:
>
>> Hello, There's an error in my code, inline. ?s 07:55 de 21/04/2022, Rui
>> Barradas escreveu: > Hello, > > For what I understand of the question, the
>> followng might answer it. > > The functions below roll dice and simulate R
>> replicates
>> ZjQcmQRYFpfptBannerStart
>> This Message Is From an External Sender
>> This message came from outside your organization.
>>
>> ZjQcmQRYFpfptBannerEnd
>>
>> Hello,
>>
>> There's an error in my code, inline.
>>
>> ?s 07:55 de 21/04/2022, Rui Barradas escreveu:
>> > Hello,
>> >
>> > For what I understand of the question, the followng might answer it.
>> >
>> > The functions below roll dice and simulate R replicates of dice rolls.
>> > Then 12 (one per month) 6 sided dice rolls are simulated 100 times.
>> >
>> > The colMeans/apply computes the empiric probabilities of having all 6
>> > sides occur in each row, Jan to Dec and a overall probabilty is the mean
>> > of those probabilities.
>> >
>> > The matrix is coerced to data.frame only at the end.
>> >
>> >
>> >
>> > dice <- function(rolls = 1, ndice = 1, sides = 6) {
>> >    roll <- function(ndice = 1, sides = 6) {
>> >      sample(seq_len(sides), ndice, replace = TRUE)
>> >    }
>> >    y <- replicate(rolls, roll(ndice = ndice, sides = sides))
>> >    if(is.null(dim(y))) y else colSums(y)
>> > }
>> > dice_simul <- function(rolls = 1, ndice = 1, sides = 6, R) {
>> >    if(missing(R)) {
>> >      stop("number of simulations 'R' is missing with no default.")
>> >    }
>> >    replicate(R, dice(rolls = rolls, ndice = ndice, sides = sides))
>> > }
>> >
>> > dice_rolls <- 100
>> > #dice_rolls <- 1e6
>> > num_dice <- 1
>> > dice_sides <- 6
>> > months <- 12
>> >
>> > set.seed(2022)
>> > prob_frame <- t(dice_simul(months, num_dice, dice_sides, R = dice_rolls))
>> > colnames(prob_frame) <- month.name
>> > head(prob_frame)
>> >
>>
>> # --- wrong
>> > p <- colMeans(apply(prob_frame, 1, \(x) 1:6 %in% x))
>> > mean(p)
>> > # [1] 0.9116667
>>
>> This should be
>>
>> yes_no <- apply(prob_frame, 1, \(x) all(1:6 %in% x))
>> p <- mean(yes_no)
>> p
>> # [1] 0.53
>>
>>
>> Rui Barradas
>>
>>
>>
>> >
>> > prob_frame <- as.data.frame(prob_frame)
>> >
>> >
>> > Hope this helps,
>> >
>> > Rui Barradas
>> >
>> >
>> > ?s 05:02 de 21/04/2022, Paul Bernal escreveu:
>> >> Dear friend Bert,
>> >>
>> >> Thank you so much for your kind reply. The first thing I need to do is to
>> >> simulate dice rolls, say 120 times.
>> >>
>> >> I want to populate an m by 12 dataframe with the results of each dice
>> >> roll.
>> >> For example, the result from dice roll #1 would need to go on row 1,
>> >> column1, the result from dice roll #2 would have to go in row 1 column 2,
>> >> and so on.
>> >>
>> >> The reason why I want to store those results in a dataframe is to be able
>> >> to perform some other calculations afterwards.
>> >>
>> >> This is for a project I am doing.
>> >>
>> >> So this is the situation:
>> >> You and five friends ? a total of six people ? plan to meet once per
>> >> month
>> >> to have dinner together, with one of you choosing the restaurant each
>> >> month. Rather than scheduling the entire year in advance, you decide to
>> >> make it interesting: each month a single six-sided die will be rolled to
>> >> determine which of you gets to choose the restaurant that month. How
>> >> likely
>> >> is it that everyone will have a chance to eat at their own favorite
>> >> restaurant? That is, what is the probability p that over the next 12
>> >> months, each of you will have had at least one opportunity to choose
>> >> where
>> >> to eat?
>> >>
>> >> This is what I am asked to do:
>> >> Write a program to estimate the desired probability p via simulation. The
>> >> program should input a sequence of positive integer number of trials to
>> >> simulate using the language's pseudorandom number generator and calculate
>> >> the corresponding fractions of simulated trials that are ?successful"
>> >> (i.e., all 6 parties get at least one opportunity to choose where to eat.
>> >> Alice, Bob, Charley, Fred, Ellen, Don, Don, Don, Don, Alice, Charley, Bob
>> >> is a successful trial. Alice, Bob, Charley, Ellen, Don, Don, Don, Don,
>> >> Ellen, Alice, Charley, Bob is not a successful trial since Fred does not
>> >> get to choose.)
>> >> Turn in a set of 10 trials showing each roll of the dice to show
>> >> correctness. Label the out-comes. Keep in mind that a single trial
>> >> requires
>> >> rolling the die twelve times. Calculate and print the average
>> >> probability p
>> >> for the set. Please refer to your friends by name.
>> >>
>> >> For this reason, I am trying to simulate the n trials, and then
>> >> populate a
>> >> table with the results from the trials. I have to simulate a dice roll
>> >> dice
>> >> for each month and for each row. Rows would be equivalent to years, and
>> >> then columns would be equivalent to the month of a particular year.
>> >>
>> >> Once I store the results in a dataframe, everything is much easier.
>> >>
>> >> I installed package dice and performed simulations by doing:
>> >> #declaring variables:
>> >> #1)dice_rolls which is the number of times the dice will be rolled
>> >> #2)num_dice which is the number of dice that will be rolled each time
>> >> #3)dice_sides which is the number of sides of the dice
>> >> #function dice will take each one of these variables as its parameter to
>> >> perform the simulation
>> >> dice_rolls = 120
>> >> num_dice   = 1
>> >> dice_sides = 6
>> >>
>> >> #performing simulation
>> >> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
>> >> dice_sides,
>> >> plot.it = TRUE)
>> >>
>> >> I tried the following, but did not work as expected:
>> >>
>> >> for (i in 1:nrow(dice_simul)){
>> >>    for(j in 1:ncol(prob_frame)){
>> >>      for(k in 1:nrow(prob_frame)){
>> >>        prob_frame[k,j] = dice_simul[i,1]
>> >>      }
>> >>    }
>> >> }
>> >>
>> >> I apologize for the long explanation.
>> >>
>> >> Best regards,
>> >>
>> >> Paul
>> >>
>> >>
>> >> El mi?, 20 abr 2022 a las 22:47, Bert Gunter (<bgunter.4567 at gmail.com>)
>> >> escribi?:
>> >>
>> >>> If I understand you correctly, it's simple.
>> >>> Matrices in R are vectors with a dimension attribute. By default, they
>> >>> are populated column by column. Use 'byrow = TRUE to populate by row
>> >>> instead. For example:
>> >>>
>> >>>> matrix (1:36, ncol = 12, byrow = TRUE)
>> >>>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
>> >>> [1,]    1    2    3    4    5    6    7    8    9    10    11    12
>> >>> [2,]   13   14   15   16   17   18   19   20   21    22    23    24
>> >>> [3,]   25   26   27   28   29   30   31   32   33    34    35    36
>> >>>
>> >>> I leave it to you to use the 'dimnames' argument of ?matrix  to give
>> >>> names to the column and then subsequently convert to a data frame if
>> >>> you like.
>> >>>
>> >>> Bert Gunter
>> >>>
>> >>> "The trouble with having an open mind is that people keep coming along
>> >>> and sticking things into it."
>> >>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>> >>>
>> >>> On Wed, Apr 20, 2022 at 8:38 PM Paul Bernal <paulbernal07 at gmail.com>
>> >>> wrote:
>> >>>>
>> >>>> Dear friends,
>> >>>>
>> >>>> Hope you are doing well. I need to simulate a 1 dice roll for each
>> >>>> one of
>> >>>> the twelve months of the year and perform 100 trials, so I thought of
>> >>>> constructing a dataframe with twelve columns and 100 rows the following
>> >>> way:
>> >>>>
>> >>>> num_rows = 100
>> >>>>
>> >>>> prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
>> >>>>
>> >>> colnames(prob_frame)<-c("January","February","March","April","May","June","July","August","September","October","November","December")
>> >>>
>> >>>>
>> >>>> Now, using the dice package, I can simulate n number of dice rolls as
>> >>>> follows:
>> >>>> #performing simulation
>> >>>> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
>> >>> dice_sides,
>> >>>> plot.it = TRUE)
>> >>>>
>> >>>> What I would like to do is to populate each column and row with the
>> >>> results
>> >>>> of dice_simul.
>> >>>>
>> >>>> Let me show you the structure of dice_simul:
>> >>>>> str(dice_simul)
>> >>>> Classes ?dice? and 'data.frame': 100 obs. of  1 variable:
>> >>>>   $ Red: int  2 2 1 2 5 4 4 6 1 4 ...
>> >>>>> dput(dice_simul)
>> >>>> structure(list(Red = c(2L, 2L, 1L, 2L, 5L, 4L, 4L, 6L, 1L, 4L,
>> >>>> 4L, 2L, 6L, 2L, 2L, 1L, 3L, 6L, 1L, 5L, 5L, 5L, 3L, 4L, 2L, 6L,
>> >>>> 4L, 6L, 6L, 2L, 1L, 2L, 2L, 6L, 4L, 2L, 3L, 5L, 6L, 6L, 4L, 5L,
>> >>>> 4L, 6L, 6L, 3L, 4L, 1L, 5L, 3L, 3L, 5L, 3L, 4L, 1L, 3L, 3L, 2L,
>> >>>> 4L, 1L, 2L, 1L, 6L, 3L, 5L, 5L, 3L, 4L, 4L, 5L, 4L, 1L, 5L, 3L,
>> >>>> 4L, 4L, 3L, 6L, 5L, 2L, 4L, 1L, 1L, 6L, 4L, 3L, 6L, 5L, 6L, 2L,
>> >>>> 6L, 1L, 6L, 6L, 4L, 3L, 4L, 2L, 1L, 5L)), class = c("dice",
>> >>>> "data.frame"
>> >>>> ), row.names = c(NA, -100L))
>> >>>>
>> >>>> For example, the first number of dice_simul should go to row 1 for
>> >>> January,
>> >>>> the second number of dice_simul should go to row 1 for February, ...
>> >>>> the
>> >>>> twelveth number of dice_simul should go to row 1 for December, the 13th
>> >>>> number should go to row 2 for january, and so on.
>> >>>>
>> >>>> This is what I tried to do but doesn?t work they way I want to:
>> >>>>
>> >>>> #1)dice_rolls which is the number of times the dice will be rolled
>> >>>> #2)num_dice which is the number of dice that will be rolled each time
>> >>>> #3)dice_sides which is the number of sides of the dice
>> >>>> #function dice will take each one of these variables as its
>> >>>> parameter to
>> >>>> perform the simulation
>> >>>> dice_rolls = 100
>> >>>> num_dice   = 1
>> >>>> dice_sides = 6
>> >>>>
>> >>>> #performing simulation
>> >>>> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
>> >>> dice_sides,
>> >>>> plot.it = TRUE)
>> >>>>
>> >>>> num_rows = 100
>> >>>>
>> >>>> prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
>> >>>> colnames(prob_frame) <-
>> >>>>
>> >>> c("January","February","March","April","May","June","July","August","September","October","November","December")
>> >>>
>> >>>>
>> >>>>
>> >>>> for (j in 1:12){
>> >>>>    for (i in 1:num_rows){
>> >>>>      prob_frame[i,j]=dice_simul[i,1]
>> >>>>    }
>> >>>> }
>> >>>> I basically want to populate the twelve months for the first row, then
>> >>> the
>> >>>> twelve months for the second row, and so on, until I get to populate
>> >>>> the
>> >>>> twelve months for the last row sequentially.
>> >>>>
>> >>>> How could I accomplish this?
>> >>>>
>> >>>> Any help and/or guidance will be greatly appreciated.
>> >>>>
>> >>>> Best regards,
>> >>>> Paul
>> >>>>
>> >>>>          [[alternative HTML version deleted]]
>> >>>>
>> >>>> ______________________________________________
>> >>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> >>>> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAbZaomfvI$
>> >>>> PLEASE do read the posting guide
>> >>> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAb7rrtTbc$
>> >>>> and provide commented, minimal, self-contained, reproducible code.
>> >>>
>> >>
>> >>     [[alternative HTML version deleted]]
>> >>
>> >> ______________________________________________
>> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> >> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAbZaomfvI$
>> >> PLEASE do read the posting guide
>> >> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAb7rrtTbc$
>> >> and provide commented, minimal, self-contained, reproducible code.
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAbZaomfvI$
>> > PLEASE do read the posting guide
>> > https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAb7rrtTbc$
>> > and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, seehttps://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAbZaomfvI$
>> PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAb7rrtTbc$
>> and provide commented, minimal, self-contained, reproducible code.
>>
>>

	[[alternative HTML version deleted]]


From dc@r|@on @end|ng |rom t@mu@edu  Sat Apr 23 06:24:31 2022
From: dc@r|@on @end|ng |rom t@mu@edu (David Carlson)
Date: Fri, 22 Apr 2022 23:24:31 -0500
Subject: [R] Model To Simulate Dice Roll
In-Reply-To: <CAMOcQfPB4eQ7TpSnK_fqcjfUJ8ycmYiWMQ-ea3WaHqPaU_ZrTg@mail.gmail.com>
References: <CAMOcQfMMq7U0jjsGgfL3kQ=Gc4ZsMqZVaLP=SmguPJuhZTYRGg@mail.gmail.com>
 <CAGxFJbTwAqA9beG8FwUPY+v4S-jKMM8+3YjTqH0r_WO2JvOZ_Q@mail.gmail.com>
 <CAMOcQfOQG4camFLTHpesHUMd9L01tmUW0xHUQGDJK1dBQ=nAAw@mail.gmail.com>
 <63179a44-d944-fe1e-ae0f-c6ed7d2d3cde@sapo.pt>
 <931063bd-ecd7-8edd-23c1-dcb5f02f86a7@sapo.pt>
 <CAE-dL2orYo_bAzxh3-CTC2FfiiD8JzYRRVzgsTmGmDN857b+6Q@mail.gmail.com>
 <CAMOcQfPB4eQ7TpSnK_fqcjfUJ8ycmYiWMQ-ea3WaHqPaU_ZrTg@mail.gmail.com>
Message-ID: <CAE-dL2qjUoPhigSBEgGuJeCVCT9gdCZ3x2aZ-DDMZh=M0kxhCg@mail.gmail.com>

Sorry, The last three lines should read:

all <- apply(results, 1, function(x) length(intersect(x,
seq(sides)))==sides)
sum(all)/reps
results <- as.data.frame(results)

To generalize them for values of sides other than 6.

On Fri, Apr 22, 2022 at 11:05 PM Paul Bernal <paulbernal07 at gmail.com> wrote:

> Thank you so much David! El El vie, 22 de abr. de 2022 a la(s) 11:04 p.
> m., David Carlson <dcarlson at tamu.edu> escribi?: Since the rolls are
> independent, it is not necessary to separate the rolls into two stages:
> sides <- 6 ? ? ? ? ? ? ? ?
> ZjQcmQRYFpfptBannerStart
> This Message Is From an External Sender
> This message came from outside your organization.
>
> ZjQcmQRYFpfptBannerEnd
> Thank you so much David!
>
> El El vie, 22 de abr. de 2022 a la(s) 11:04 p. m., David Carlson <
> dcarlson at tamu.edu> escribi?:
>
>> Since the rolls are independent, it is not necessary to separate the
>> rolls into two stages:
>>
>> sides <- 6
>> months <- 12
>> reps <- 100
>>
>> set.seed(2022)
>> results <- matrix(sample.int
>> <https://urldefense.com/v3/__http://sample.int__;!!KwNVnqRv!GvZvIF7bCsJmP-MoZAjpwRSwA0SLF9dwlLokWfsqj07fpKB_yoDtZ64yl90ktreESKpQkxnxfP7vuF2jfsHvZA$>(sides,
>> months*reps, replace=TRUE), reps, months, byrow=TRUE)
>> colnames(results) <- month.name
>> <https://urldefense.com/v3/__http://month.name__;!!KwNVnqRv!GvZvIF7bCsJmP-MoZAjpwRSwA0SLF9dwlLokWfsqj07fpKB_yoDtZ64yl90ktreESKpQkxnxfP7vuF14dyuUpA$>
>> all6 <- apply(results, 1, function(x) length(intersect(x, 1:6))==6)
>> sum(all6)/reps
>> # 0.53 which matches Rui's result
>> results <- as.data.frame(results)
>>
>> David L. Carlson
>>
>>
>>
>> On Thu, Apr 21, 2022 at 4:04 AM Rui Barradas <ruipbarradas at sapo.pt>
>> wrote:
>>
>>> Hello, There's an error in my code, inline. ?s 07:55 de 21/04/2022, Rui
>>> Barradas escreveu: > Hello, > > For what I understand of the question, the
>>> followng might answer it. > > The functions below roll dice and simulate R
>>> replicates
>>> ZjQcmQRYFpfptBannerStart
>>> This Message Is From an External Sender
>>> This message came from outside your organization.
>>>
>>> ZjQcmQRYFpfptBannerEnd
>>>
>>> Hello,
>>>
>>> There's an error in my code, inline.
>>>
>>> ?s 07:55 de 21/04/2022, Rui Barradas escreveu:
>>> > Hello,
>>> >
>>> > For what I understand of the question, the followng might answer it.
>>> >
>>> > The functions below roll dice and simulate R replicates of dice rolls.
>>> > Then 12 (one per month) 6 sided dice rolls are simulated 100 times.
>>> >
>>> > The colMeans/apply computes the empiric probabilities of having all 6
>>> > sides occur in each row, Jan to Dec and a overall probabilty is the mean
>>> > of those probabilities.
>>> >
>>> > The matrix is coerced to data.frame only at the end.
>>> >
>>> >
>>> >
>>> > dice <- function(rolls = 1, ndice = 1, sides = 6) {
>>> >    roll <- function(ndice = 1, sides = 6) {
>>> >      sample(seq_len(sides), ndice, replace = TRUE)
>>> >    }
>>> >    y <- replicate(rolls, roll(ndice = ndice, sides = sides))
>>> >    if(is.null(dim(y))) y else colSums(y)
>>> > }
>>> > dice_simul <- function(rolls = 1, ndice = 1, sides = 6, R) {
>>> >    if(missing(R)) {
>>> >      stop("number of simulations 'R' is missing with no default.")
>>> >    }
>>> >    replicate(R, dice(rolls = rolls, ndice = ndice, sides = sides))
>>> > }
>>> >
>>> > dice_rolls <- 100
>>> > #dice_rolls <- 1e6
>>> > num_dice <- 1
>>> > dice_sides <- 6
>>> > months <- 12
>>> >
>>> > set.seed(2022)
>>> > prob_frame <- t(dice_simul(months, num_dice, dice_sides, R = dice_rolls))
>>> > colnames(prob_frame) <- month.name <https://urldefense.com/v3/__http://month.name__;!!KwNVnqRv!GvZvIF7bCsJmP-MoZAjpwRSwA0SLF9dwlLokWfsqj07fpKB_yoDtZ64yl90ktreESKpQkxnxfP7vuF14dyuUpA$>
>>> > head(prob_frame)
>>> >
>>>
>>> # --- wrong
>>> > p <- colMeans(apply(prob_frame, 1, \(x) 1:6 %in% x))
>>> > mean(p)
>>> > # [1] 0.9116667
>>>
>>> This should be
>>>
>>> yes_no <- apply(prob_frame, 1, \(x) all(1:6 %in% x))
>>> p <- mean(yes_no)
>>> p
>>> # [1] 0.53
>>>
>>>
>>> Rui Barradas
>>>
>>>
>>>
>>> >
>>> > prob_frame <- as.data.frame(prob_frame)
>>> >
>>> >
>>> > Hope this helps,
>>> >
>>> > Rui Barradas
>>> >
>>> >
>>> > ?s 05:02 de 21/04/2022, Paul Bernal escreveu:
>>> >> Dear friend Bert,
>>> >>
>>> >> Thank you so much for your kind reply. The first thing I need to do is to
>>> >> simulate dice rolls, say 120 times.
>>> >>
>>> >> I want to populate an m by 12 dataframe with the results of each dice
>>> >> roll.
>>> >> For example, the result from dice roll #1 would need to go on row 1,
>>> >> column1, the result from dice roll #2 would have to go in row 1 column 2,
>>> >> and so on.
>>> >>
>>> >> The reason why I want to store those results in a dataframe is to be able
>>> >> to perform some other calculations afterwards.
>>> >>
>>> >> This is for a project I am doing.
>>> >>
>>> >> So this is the situation:
>>> >> You and five friends ? a total of six people ? plan to meet once per
>>> >> month
>>> >> to have dinner together, with one of you choosing the restaurant each
>>> >> month. Rather than scheduling the entire year in advance, you decide to
>>> >> make it interesting: each month a single six-sided die will be rolled to
>>> >> determine which of you gets to choose the restaurant that month. How
>>> >> likely
>>> >> is it that everyone will have a chance to eat at their own favorite
>>> >> restaurant? That is, what is the probability p that over the next 12
>>> >> months, each of you will have had at least one opportunity to choose
>>> >> where
>>> >> to eat?
>>> >>
>>> >> This is what I am asked to do:
>>> >> Write a program to estimate the desired probability p via simulation. The
>>> >> program should input a sequence of positive integer number of trials to
>>> >> simulate using the language's pseudorandom number generator and calculate
>>> >> the corresponding fractions of simulated trials that are ?successful"
>>> >> (i.e., all 6 parties get at least one opportunity to choose where to eat.
>>> >> Alice, Bob, Charley, Fred, Ellen, Don, Don, Don, Don, Alice, Charley, Bob
>>> >> is a successful trial. Alice, Bob, Charley, Ellen, Don, Don, Don, Don,
>>> >> Ellen, Alice, Charley, Bob is not a successful trial since Fred does not
>>> >> get to choose.)
>>> >> Turn in a set of 10 trials showing each roll of the dice to show
>>> >> correctness. Label the out-comes. Keep in mind that a single trial
>>> >> requires
>>> >> rolling the die twelve times. Calculate and print the average
>>> >> probability p
>>> >> for the set. Please refer to your friends by name.
>>> >>
>>> >> For this reason, I am trying to simulate the n trials, and then
>>> >> populate a
>>> >> table with the results from the trials. I have to simulate a dice roll
>>> >> dice
>>> >> for each month and for each row. Rows would be equivalent to years, and
>>> >> then columns would be equivalent to the month of a particular year.
>>> >>
>>> >> Once I store the results in a dataframe, everything is much easier.
>>> >>
>>> >> I installed package dice and performed simulations by doing:
>>> >> #declaring variables:
>>> >> #1)dice_rolls which is the number of times the dice will be rolled
>>> >> #2)num_dice which is the number of dice that will be rolled each time
>>> >> #3)dice_sides which is the number of sides of the dice
>>> >> #function dice will take each one of these variables as its parameter to
>>> >> perform the simulation
>>> >> dice_rolls = 120
>>> >> num_dice   = 1
>>> >> dice_sides = 6
>>> >>
>>> >> #performing simulation
>>> >> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
>>> >> dice_sides,
>>> >> plot.it <https://urldefense.com/v3/__http://plot.it__;!!KwNVnqRv!GvZvIF7bCsJmP-MoZAjpwRSwA0SLF9dwlLokWfsqj07fpKB_yoDtZ64yl90ktreESKpQkxnxfP7vuF1nNnEZyA$> = TRUE)
>>> >>
>>> >> I tried the following, but did not work as expected:
>>> >>
>>> >> for (i in 1:nrow(dice_simul)){
>>> >>    for(j in 1:ncol(prob_frame)){
>>> >>      for(k in 1:nrow(prob_frame)){
>>> >>        prob_frame[k,j] = dice_simul[i,1]
>>> >>      }
>>> >>    }
>>> >> }
>>> >>
>>> >> I apologize for the long explanation.
>>> >>
>>> >> Best regards,
>>> >>
>>> >> Paul
>>> >>
>>> >>
>>> >> El mi?, 20 abr 2022 a las 22:47, Bert Gunter (<bgunter.4567 at gmail.com>)
>>> >> escribi?:
>>> >>
>>> >>> If I understand you correctly, it's simple.
>>> >>> Matrices in R are vectors with a dimension attribute. By default, they
>>> >>> are populated column by column. Use 'byrow = TRUE to populate by row
>>> >>> instead. For example:
>>> >>>
>>> >>>> matrix (1:36, ncol = 12, byrow = TRUE)
>>> >>>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
>>> >>> [1,]    1    2    3    4    5    6    7    8    9    10    11    12
>>> >>> [2,]   13   14   15   16   17   18   19   20   21    22    23    24
>>> >>> [3,]   25   26   27   28   29   30   31   32   33    34    35    36
>>> >>>
>>> >>> I leave it to you to use the 'dimnames' argument of ?matrix  to give
>>> >>> names to the column and then subsequently convert to a data frame if
>>> >>> you like.
>>> >>>
>>> >>> Bert Gunter
>>> >>>
>>> >>> "The trouble with having an open mind is that people keep coming along
>>> >>> and sticking things into it."
>>> >>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>> >>>
>>> >>> On Wed, Apr 20, 2022 at 8:38 PM Paul Bernal <paulbernal07 at gmail.com>
>>> >>> wrote:
>>> >>>>
>>> >>>> Dear friends,
>>> >>>>
>>> >>>> Hope you are doing well. I need to simulate a 1 dice roll for each
>>> >>>> one of
>>> >>>> the twelve months of the year and perform 100 trials, so I thought of
>>> >>>> constructing a dataframe with twelve columns and 100 rows the following
>>> >>> way:
>>> >>>>
>>> >>>> num_rows = 100
>>> >>>>
>>> >>>> prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
>>> >>>>
>>> >>> colnames(prob_frame)<-c("January","February","March","April","May","June","July","August","September","October","November","December")
>>> >>>
>>> >>>>
>>> >>>> Now, using the dice package, I can simulate n number of dice rolls as
>>> >>>> follows:
>>> >>>> #performing simulation
>>> >>>> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
>>> >>> dice_sides,
>>> >>>> plot.it <https://urldefense.com/v3/__http://plot.it__;!!KwNVnqRv!GvZvIF7bCsJmP-MoZAjpwRSwA0SLF9dwlLokWfsqj07fpKB_yoDtZ64yl90ktreESKpQkxnxfP7vuF1nNnEZyA$> = TRUE)
>>> >>>>
>>> >>>> What I would like to do is to populate each column and row with the
>>> >>> results
>>> >>>> of dice_simul.
>>> >>>>
>>> >>>> Let me show you the structure of dice_simul:
>>> >>>>> str(dice_simul)
>>> >>>> Classes ?dice? and 'data.frame': 100 obs. of  1 variable:
>>> >>>>   $ Red: int  2 2 1 2 5 4 4 6 1 4 ...
>>> >>>>> dput(dice_simul)
>>> >>>> structure(list(Red = c(2L, 2L, 1L, 2L, 5L, 4L, 4L, 6L, 1L, 4L,
>>> >>>> 4L, 2L, 6L, 2L, 2L, 1L, 3L, 6L, 1L, 5L, 5L, 5L, 3L, 4L, 2L, 6L,
>>> >>>> 4L, 6L, 6L, 2L, 1L, 2L, 2L, 6L, 4L, 2L, 3L, 5L, 6L, 6L, 4L, 5L,
>>> >>>> 4L, 6L, 6L, 3L, 4L, 1L, 5L, 3L, 3L, 5L, 3L, 4L, 1L, 3L, 3L, 2L,
>>> >>>> 4L, 1L, 2L, 1L, 6L, 3L, 5L, 5L, 3L, 4L, 4L, 5L, 4L, 1L, 5L, 3L,
>>> >>>> 4L, 4L, 3L, 6L, 5L, 2L, 4L, 1L, 1L, 6L, 4L, 3L, 6L, 5L, 6L, 2L,
>>> >>>> 6L, 1L, 6L, 6L, 4L, 3L, 4L, 2L, 1L, 5L)), class = c("dice",
>>> >>>> "data.frame"
>>> >>>> ), row.names = c(NA, -100L))
>>> >>>>
>>> >>>> For example, the first number of dice_simul should go to row 1 for
>>> >>> January,
>>> >>>> the second number of dice_simul should go to row 1 for February, ...
>>> >>>> the
>>> >>>> twelveth number of dice_simul should go to row 1 for December, the 13th
>>> >>>> number should go to row 2 for january, and so on.
>>> >>>>
>>> >>>> This is what I tried to do but doesn?t work they way I want to:
>>> >>>>
>>> >>>> #1)dice_rolls which is the number of times the dice will be rolled
>>> >>>> #2)num_dice which is the number of dice that will be rolled each time
>>> >>>> #3)dice_sides which is the number of sides of the dice
>>> >>>> #function dice will take each one of these variables as its
>>> >>>> parameter to
>>> >>>> perform the simulation
>>> >>>> dice_rolls = 100
>>> >>>> num_dice   = 1
>>> >>>> dice_sides = 6
>>> >>>>
>>> >>>> #performing simulation
>>> >>>> dice_simul = dice(rolls = dice_rolls, ndice = num_dice, sides =
>>> >>> dice_sides,
>>> >>>> plot.it <https://urldefense.com/v3/__http://plot.it__;!!KwNVnqRv!GvZvIF7bCsJmP-MoZAjpwRSwA0SLF9dwlLokWfsqj07fpKB_yoDtZ64yl90ktreESKpQkxnxfP7vuF1nNnEZyA$> = TRUE)
>>> >>>>
>>> >>>> num_rows = 100
>>> >>>>
>>> >>>> prob_frame <- data.frame(matrix(NA, nrow = num_rows, ncol = 12))
>>> >>>> colnames(prob_frame) <-
>>> >>>>
>>> >>> c("January","February","March","April","May","June","July","August","September","October","November","December")
>>> >>>
>>> >>>>
>>> >>>>
>>> >>>> for (j in 1:12){
>>> >>>>    for (i in 1:num_rows){
>>> >>>>      prob_frame[i,j]=dice_simul[i,1]
>>> >>>>    }
>>> >>>> }
>>> >>>> I basically want to populate the twelve months for the first row, then
>>> >>> the
>>> >>>> twelve months for the second row, and so on, until I get to populate
>>> >>>> the
>>> >>>> twelve months for the last row sequentially.
>>> >>>>
>>> >>>> How could I accomplish this?
>>> >>>>
>>> >>>> Any help and/or guidance will be greatly appreciated.
>>> >>>>
>>> >>>> Best regards,
>>> >>>> Paul
>>> >>>>
>>> >>>>          [[alternative HTML version deleted]]
>>> >>>>
>>> >>>> ______________________________________________
>>> >>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> >>>> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAbZaomfvI$
>>> >>>> PLEASE do read the posting guide
>>> >>> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAb7rrtTbc$
>>> >>>> and provide commented, minimal, self-contained, reproducible code.
>>> >>>
>>> >>
>>> >>     [[alternative HTML version deleted]]
>>> >>
>>> >> ______________________________________________
>>> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> >> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAbZaomfvI$
>>> >> PLEASE do read the posting guide
>>> >> https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAb7rrtTbc$
>>> >> and provide commented, minimal, self-contained, reproducible code.
>>> >
>>> > ______________________________________________
>>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAbZaomfvI$
>>> > PLEASE do read the posting guide
>>> > https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAb7rrtTbc$
>>> > and provide commented, minimal, self-contained, reproducible code.
>>>
>>> ______________________________________________R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, seehttps://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-help__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAbZaomfvI$
>>> PLEASE do read the posting guide https://urldefense.com/v3/__http://www.R-project.org/posting-guide.html__;!!KwNVnqRv!GmY3d1J5JTqq58eyId3zjOPuWKBidPg_ojtvbhygQyudquxNCQkrcOT1xJfOQTFSlSxEJgiAwDPunCAb7rrtTbc$
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>>

	[[alternative HTML version deleted]]


From n|ckmwr@y @end|ng |rom gm@||@com  Sat Apr 23 16:32:07 2022
From: n|ckmwr@y @end|ng |rom gm@||@com (Nick Wray)
Date: Sat, 23 Apr 2022 15:32:07 +0100
Subject: [R] QGIS and R
Message-ID: <CABxY9BOq39c9Q+N4jy+Z-c+E5zT+J0kJLTwUh6Dz-LwTyymVpA@mail.gmail.com>

For my PhD researches I am trying to get to grips with QGIS and in
particular with using QGIS within R, but it's a steep and tricky learning
curve.  For example I have installed RQGIS successfully but any example
programs won't run because (apparently)  I haven't got x-display enabled -
I haven't got the foggiest what that is or how to get it.  So basically my
question is - can anyone recommend any sources/websites/books/videos etc
which would give examples/walkthroughs/explanations of how to get off the
ground with QGIS in R/RQGIS etc?  Thanks Nick Wray

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Sat Apr 23 16:41:47 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 23 Apr 2022 07:41:47 -0700
Subject: [R] QGIS and R
In-Reply-To: <CABxY9BOq39c9Q+N4jy+Z-c+E5zT+J0kJLTwUh6Dz-LwTyymVpA@mail.gmail.com>
References: <CABxY9BOq39c9Q+N4jy+Z-c+E5zT+J0kJLTwUh6Dz-LwTyymVpA@mail.gmail.com>
Message-ID: <CAGxFJbS9CNMJ-=QRcBW_RgXRFLY-j8GQPFjeyRvNXN0mbTDMDg@mail.gmail.com>

https://www.qgis.org/en/site/   (obviously)

Probably better to ask on  https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Sat, Apr 23, 2022 at 7:32 AM Nick Wray <nickmwray at gmail.com> wrote:
>
> For my PhD researches I am trying to get to grips with QGIS and in
> particular with using QGIS within R, but it's a steep and tricky learning
> curve.  For example I have installed RQGIS successfully but any example
> programs won't run because (apparently)  I haven't got x-display enabled -
> I haven't got the foggiest what that is or how to get it.  So basically my
> question is - can anyone recommend any sources/websites/books/videos etc
> which would give examples/walkthroughs/explanations of how to get off the
> ground with QGIS in R/RQGIS etc?  Thanks Nick Wray
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @@r@h@go@|ee @end|ng |rom gm@||@com  Sat Apr 23 16:48:14 2022
From: @@r@h@go@|ee @end|ng |rom gm@||@com (Sarah Goslee)
Date: Sat, 23 Apr 2022 10:48:14 -0400
Subject: [R] QGIS and R
In-Reply-To: <CABxY9BOq39c9Q+N4jy+Z-c+E5zT+J0kJLTwUh6Dz-LwTyymVpA@mail.gmail.com>
References: <CABxY9BOq39c9Q+N4jy+Z-c+E5zT+J0kJLTwUh6Dz-LwTyymVpA@mail.gmail.com>
Message-ID: <CAM_vju=2Cwgvo9nejWkLZtgRKejMRN-vTY=OtjAZ3SWsSQ0hYA@mail.gmail.com>

Hi Nick,

There's a geospatial mailing list that might be helpful (r-sig-geo),
but also you don't give enough information to help.

Are you running Windows?
What version of QGIS did you install?
Where did you get RQGIS from - it is no longer on CRAN, and is
obsolete and not recommended because it only supports QGIS2
(https://github.com/r-spatial/RQGIS).

One option might be to try RQGIS3
(https://github.com/r-spatial/RQGIS3), but again there the developers
suggest that you don't, and offer some other possibilities.

The geospatial capabilities built into R are very good, and you might
not even need QGIS as part of your main workflow. Look into the sf and
raster (or terra) packages for vector and raster processing,
respectively.

Good resources include https://r-spatial.org and the spatial data
science book at https://keen-swartz-3146c4.netlify.app

Sarah

On Sat, Apr 23, 2022 at 10:32 AM Nick Wray <nickmwray at gmail.com> wrote:
>
> For my PhD researches I am trying to get to grips with QGIS and in
> particular with using QGIS within R, but it's a steep and tricky learning
> curve.  For example I have installed RQGIS successfully but any example
> programs won't run because (apparently)  I haven't got x-display enabled -
> I haven't got the foggiest what that is or how to get it.  So basically my
> question is - can anyone recommend any sources/websites/books/videos etc
> which would give examples/walkthroughs/explanations of how to get off the
> ground with QGIS in R/RQGIS etc?  Thanks Nick Wray
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
Sarah Goslee (she/her)
http://www.numberwright.com


From kry|ov@r00t @end|ng |rom gm@||@com  Sat Apr 23 16:53:27 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Sat, 23 Apr 2022 17:53:27 +0300
Subject: [R] QGIS and R
In-Reply-To: <CABxY9BOq39c9Q+N4jy+Z-c+E5zT+J0kJLTwUh6Dz-LwTyymVpA@mail.gmail.com>
References: <CABxY9BOq39c9Q+N4jy+Z-c+E5zT+J0kJLTwUh6Dz-LwTyymVpA@mail.gmail.com>
Message-ID: <20220423175327.060ffab9@Tarkus>

On Sat, 23 Apr 2022 15:32:07 +0100
Nick Wray <nickmwray at gmail.com> wrote:

> For example I have installed RQGIS successfully but any example
> programs won't run because (apparently)  I haven't got x-display
> enabled 

Bad news: RQGIS is apparently not maintained any more [1,2], because it
only supports the old version of QGIS (2 instead of 3). There was
something called RQGIS3, but it didn't work out, either [3]. Your best
bet might be something else called qgisprocess [4], which isn't on CRAN
(yet?), but at least doesn't have scary warnings in its README.

I'll second the advice to ask in R-SIG-Geo. That X11-related problem (?)
might solve itself by the time you switch to another package, but if it
doesn't, make sure to mention the exact error message and the operating
system you are running: X11 is very different between Windows, macOS
and other POSIX-compatible OSes.

> 	[[alternative HTML version deleted]]

P.S. Please compose your messages to R mailing lists in plain text, not
HTML.

-- 
Best regards,
Ivan

[1] https://cran.r-project.org/package=RQGIS

[2] https://github.com/r-spatial/RQGIS

[3] https://github.com/r-spatial/RQGIS3

[4] https://github.com/paleolimbot/qgisprocess


From p@u|bern@|07 @end|ng |rom gm@||@com  Sun Apr 24 03:00:52 2022
From: p@u|bern@|07 @end|ng |rom gm@||@com (Paul Bernal)
Date: Sat, 23 Apr 2022 20:00:52 -0500
Subject: [R] R Code Execution taking forever
Message-ID: <CAMOcQfN1U-gMbAtM5JA9VLmwyKESPo8NAPs=0gmBrtON5zq0dg@mail.gmail.com>

Dear R friends,

Hope you are doing great. The reason why I am contacting you all, is
because the code I am sharing with you takes forever. It started running at
2:00 AM today, and it's 7:52 PM and is still running (see code at the end
of this mail).

I am using Rx64  4.1.2, and the code is being executed in RStudio. The
RStudio version I am currently using is Version 2022.02.0 Build 443
"Prairie Trillium" Release (9f796939, 2022-02-16) for Windows.

My PC specs:
Processor: Intel(R) Core(TM) i5-10310U CPU @ 1.70 GHz
Installed RAM: 16.0 GB (15.6 GB usable)
System type: 64-bit operating system, x64-based processor
Local Disc(C:) Free Space: 274 GB

I am wondering if there is/are a set of system variable(s) or something I
could do to improve the performance of the program.

It is really odd this code has taken this much (and it is still running).

Any help and/or guidance would be greatly appreciated.

Best regards,
Paul




#performing 1,000,000 simulations 10 times
num_trials_6 = 1000000
dice_rolls_6 = num_trials_6*12
num_dice_6 = 1
dice_sides_6 = 6

prob_frame_6 <- data.frame(matrix(ncol = 10, nrow = 1))

k <- 0
while(k < 10){
  dice_simul_6 = data.frame(dice(rolls = dice_rolls_6, ndice = num_dice_6,
sides = dice_sides_6, plot.it = FALSE))

  #constructing matrix containing results of all dice rolls by month
  prob_matrix_6 <- data.frame(matrix(dice_simul_6[,1], ncol = 12, byrow =
TRUE))

  #naming each column by it's corresponding month name
  colnames(prob_matrix_6) <-
c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")


  #assigning each person?s name depending on the number showed in the dice
once rolled
  for (i in 1:nrow(prob_matrix_6)){
    for (j in 1:ncol(prob_matrix_6)){
      if (prob_matrix_6[i,j] == 1){
        prob_matrix_6[i,j] = "Alice"
      }
      if (prob_matrix_6[i,j] == 2){
        prob_matrix_6[i,j] = "Bob"
      }
      if (prob_matrix_6[i,j] == 3){
        prob_matrix_6[i,j] = "Charlie"
      }
      if (prob_matrix_6[i,j] == 4){
        prob_matrix_6[i,j] = "Don"
      }
      if (prob_matrix_6[i,j] == 5){
        prob_matrix_6[i,j] = "Ellen"
      }
      if (prob_matrix_6[i,j] == 6){
        prob_matrix_6[i,j] = "Fred"
      }

    }
  }

  #calculating column  which will have a 1 if trial was successful and a 0
otherwise
  prob_matrix_6['success'] <- for (i in 1:nrow(prob_matrix_6)){
    if (("Alice" %in% prob_matrix_6[i,]) & ("Bob" %in% prob_matrix_6[i,]) &
("Charlie" %in% prob_matrix_6[i,]) & ("Don" %in% prob_matrix_6[i,]) &
("Ellen" %in% prob_matrix_6[i,]) & ("Fred" %in% prob_matrix_6[i,])){
      prob_matrix_6[i,13] = 1
    }else{
      prob_matrix_6[i,13] = 0
    }
  }

  #relabeling column v13 so that its new name is success
  colnames(prob_matrix_6)[13] <- "success"


  #calculating probability of success

  p6 = sum(prob_matrix_6$success)/nrow(prob_matrix_6)
  prob_frame_6 <- cbind(prob_frame_6, p6)

  k = k + 1

}

prob_frame_6 <- prob_frame_6[11:20]
colnames(prob_frame_6) <-
c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10")
average_prob_frame_6 <- rowMeans(prob_frame_6)
trial_1000000_10_frame <- cbind(prob_frame_6, average_prob_frame_6)
final_frame_6 <- trial_1000000_10_frame
colnames(final_frame_6) <-
c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10", "avg_prob_frame_5")

write.csv(final_frame_6, "OneMillion_Trials_Ten_Times_Results.csv")
print(final_frame_6)
print(paste("The average probability of success when doing 1,000,000 trials
10 times is:", average_prob_frame_6))

	[[alternative HTML version deleted]]


From drj|m|emon @end|ng |rom gm@||@com  Sun Apr 24 07:56:41 2022
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Sun, 24 Apr 2022 15:56:41 +1000
Subject: [R] R Code Execution taking forever
In-Reply-To: <CAMOcQfN1U-gMbAtM5JA9VLmwyKESPo8NAPs=0gmBrtON5zq0dg@mail.gmail.com>
References: <CAMOcQfN1U-gMbAtM5JA9VLmwyKESPo8NAPs=0gmBrtON5zq0dg@mail.gmail.com>
Message-ID: <CA+8X3fXbToN7oS_4+q4SeN8x=k6joFxT8NzH8gD4MQXx8Gj_rg@mail.gmail.com>

HI Paul,
I had a problem a bit like this when trying to implement the Lim-Wolfe
imputation for ranks. The size of the output matrix increases
exponentially with the size of the initial matrix and it goes into
disk-swapping slow motion. It works for small matrices, but rapidly
runs out of memory. I have planned to insert code to only retain the
largest maximum to fix this. If I get to it, I'll post the result.

Jim

On Sun, Apr 24, 2022 at 11:01 AM Paul Bernal <paulbernal07 at gmail.com> wrote:
>
> Dear R friends,
>
> Hope you are doing great. The reason why I am contacting you all, is
> because the code I am sharing with you takes forever. It started running at
> 2:00 AM today, and it's 7:52 PM and is still running (see code at the end
> of this mail).
>
> I am using Rx64  4.1.2, and the code is being executed in RStudio. The
> RStudio version I am currently using is Version 2022.02.0 Build 443
> "Prairie Trillium" Release (9f796939, 2022-02-16) for Windows.
>
> My PC specs:
> Processor: Intel(R) Core(TM) i5-10310U CPU @ 1.70 GHz
> Installed RAM: 16.0 GB (15.6 GB usable)
> System type: 64-bit operating system, x64-based processor
> Local Disc(C:) Free Space: 274 GB
>
> I am wondering if there is/are a set of system variable(s) or something I
> could do to improve the performance of the program.
>
> It is really odd this code has taken this much (and it is still running).
>
> Any help and/or guidance would be greatly appreciated.
>
> Best regards,
> Paul
>
>
>
>
> #performing 1,000,000 simulations 10 times
> num_trials_6 = 1000000
> dice_rolls_6 = num_trials_6*12
> num_dice_6 = 1
> dice_sides_6 = 6
>
> prob_frame_6 <- data.frame(matrix(ncol = 10, nrow = 1))
>
> k <- 0
> while(k < 10){
>   dice_simul_6 = data.frame(dice(rolls = dice_rolls_6, ndice = num_dice_6,
> sides = dice_sides_6, plot.it = FALSE))
>
>   #constructing matrix containing results of all dice rolls by month
>   prob_matrix_6 <- data.frame(matrix(dice_simul_6[,1], ncol = 12, byrow =
> TRUE))
>
>   #naming each column by it's corresponding month name
>   colnames(prob_matrix_6) <-
> c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
>
>
>   #assigning each person?s name depending on the number showed in the dice
> once rolled
>   for (i in 1:nrow(prob_matrix_6)){
>     for (j in 1:ncol(prob_matrix_6)){
>       if (prob_matrix_6[i,j] == 1){
>         prob_matrix_6[i,j] = "Alice"
>       }
>       if (prob_matrix_6[i,j] == 2){
>         prob_matrix_6[i,j] = "Bob"
>       }
>       if (prob_matrix_6[i,j] == 3){
>         prob_matrix_6[i,j] = "Charlie"
>       }
>       if (prob_matrix_6[i,j] == 4){
>         prob_matrix_6[i,j] = "Don"
>       }
>       if (prob_matrix_6[i,j] == 5){
>         prob_matrix_6[i,j] = "Ellen"
>       }
>       if (prob_matrix_6[i,j] == 6){
>         prob_matrix_6[i,j] = "Fred"
>       }
>
>     }
>   }
>
>   #calculating column  which will have a 1 if trial was successful and a 0
> otherwise
>   prob_matrix_6['success'] <- for (i in 1:nrow(prob_matrix_6)){
>     if (("Alice" %in% prob_matrix_6[i,]) & ("Bob" %in% prob_matrix_6[i,]) &
> ("Charlie" %in% prob_matrix_6[i,]) & ("Don" %in% prob_matrix_6[i,]) &
> ("Ellen" %in% prob_matrix_6[i,]) & ("Fred" %in% prob_matrix_6[i,])){
>       prob_matrix_6[i,13] = 1
>     }else{
>       prob_matrix_6[i,13] = 0
>     }
>   }
>
>   #relabeling column v13 so that its new name is success
>   colnames(prob_matrix_6)[13] <- "success"
>
>
>   #calculating probability of success
>
>   p6 = sum(prob_matrix_6$success)/nrow(prob_matrix_6)
>   prob_frame_6 <- cbind(prob_frame_6, p6)
>
>   k = k + 1
>
> }
>
> prob_frame_6 <- prob_frame_6[11:20]
> colnames(prob_frame_6) <-
> c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10")
> average_prob_frame_6 <- rowMeans(prob_frame_6)
> trial_1000000_10_frame <- cbind(prob_frame_6, average_prob_frame_6)
> final_frame_6 <- trial_1000000_10_frame
> colnames(final_frame_6) <-
> c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10", "avg_prob_frame_5")
>
> write.csv(final_frame_6, "OneMillion_Trials_Ten_Times_Results.csv")
> print(final_frame_6)
> print(paste("The average probability of success when doing 1,000,000 trials
> 10 times is:", average_prob_frame_6))
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From p@u|bern@|07 @end|ng |rom gm@||@com  Sun Apr 24 08:42:25 2022
From: p@u|bern@|07 @end|ng |rom gm@||@com (Paul Bernal)
Date: Sun, 24 Apr 2022 01:42:25 -0500
Subject: [R] R Code Execution taking forever
In-Reply-To: <CA+8X3fXbToN7oS_4+q4SeN8x=k6joFxT8NzH8gD4MQXx8Gj_rg@mail.gmail.com>
References: <CAMOcQfN1U-gMbAtM5JA9VLmwyKESPo8NAPs=0gmBrtON5zq0dg@mail.gmail.com>
 <CA+8X3fXbToN7oS_4+q4SeN8x=k6joFxT8NzH8gD4MQXx8Gj_rg@mail.gmail.com>
Message-ID: <CAMOcQfMTdE28G-WnN4+eLT6TMzpz9Sbse7VaMTVjRHPPFVmrwQ@mail.gmail.com>

Dear Jim,
Thank you for your kind reply. I am wondering whether it would be a good
idea to just interrupt R?s execution or give it until tomorrow to see if it
finishes running.

At this point (I may be wrong) I think I have asked R for too much.

I wonder whether I may have to use another peogramming language to finish
this project.

At first, I thought it could well be a matter of configuring some system
variables or something along those lines, or simply eliminate some steps in
the code, to see if that could bring significant improve in the
performance, but right now I truly don?t know what to do.

Any tips, workarounds or guidance will be greatly appreciated.

Best,
Paul

El El dom, 24 de abr. de 2022 a la(s) 12:56 a. m., Jim Lemon <
drjimlemon at gmail.com> escribi?:

> HI Paul,
> I had a problem a bit like this when trying to implement the Lim-Wolfe
> imputation for ranks. The size of the output matrix increases
> exponentially with the size of the initial matrix and it goes into
> disk-swapping slow motion. It works for small matrices, but rapidly
> runs out of memory. I have planned to insert code to only retain the
> largest maximum to fix this. If I get to it, I'll post the result.
>
> Jim
>
> On Sun, Apr 24, 2022 at 11:01 AM Paul Bernal <paulbernal07 at gmail.com>
> wrote:
> >
> > Dear R friends,
> >
> > Hope you are doing great. The reason why I am contacting you all, is
> > because the code I am sharing with you takes forever. It started running
> at
> > 2:00 AM today, and it's 7:52 PM and is still running (see code at the end
> > of this mail).
> >
> > I am using Rx64  4.1.2, and the code is being executed in RStudio. The
> > RStudio version I am currently using is Version 2022.02.0 Build 443
> > "Prairie Trillium" Release (9f796939, 2022-02-16) for Windows.
> >
> > My PC specs:
> > Processor: Intel(R) Core(TM) i5-10310U CPU @ 1.70 GHz
> > Installed RAM: 16.0 GB (15.6 GB usable)
> > System type: 64-bit operating system, x64-based processor
> > Local Disc(C:) Free Space: 274 GB
> >
> > I am wondering if there is/are a set of system variable(s) or something I
> > could do to improve the performance of the program.
> >
> > It is really odd this code has taken this much (and it is still running).
> >
> > Any help and/or guidance would be greatly appreciated.
> >
> > Best regards,
> > Paul
> >
> >
> >
> >
> > #performing 1,000,000 simulations 10 times
> > num_trials_6 = 1000000
> > dice_rolls_6 = num_trials_6*12
> > num_dice_6 = 1
> > dice_sides_6 = 6
> >
> > prob_frame_6 <- data.frame(matrix(ncol = 10, nrow = 1))
> >
> > k <- 0
> > while(k < 10){
> >   dice_simul_6 = data.frame(dice(rolls = dice_rolls_6, ndice =
> num_dice_6,
> > sides = dice_sides_6, plot.it = FALSE))
> >
> >   #constructing matrix containing results of all dice rolls by month
> >   prob_matrix_6 <- data.frame(matrix(dice_simul_6[,1], ncol = 12, byrow =
> > TRUE))
> >
> >   #naming each column by it's corresponding month name
> >   colnames(prob_matrix_6) <-
> >
> c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
> >
> >
> >   #assigning each person?s name depending on the number showed in the
> dice
> > once rolled
> >   for (i in 1:nrow(prob_matrix_6)){
> >     for (j in 1:ncol(prob_matrix_6)){
> >       if (prob_matrix_6[i,j] == 1){
> >         prob_matrix_6[i,j] = "Alice"
> >       }
> >       if (prob_matrix_6[i,j] == 2){
> >         prob_matrix_6[i,j] = "Bob"
> >       }
> >       if (prob_matrix_6[i,j] == 3){
> >         prob_matrix_6[i,j] = "Charlie"
> >       }
> >       if (prob_matrix_6[i,j] == 4){
> >         prob_matrix_6[i,j] = "Don"
> >       }
> >       if (prob_matrix_6[i,j] == 5){
> >         prob_matrix_6[i,j] = "Ellen"
> >       }
> >       if (prob_matrix_6[i,j] == 6){
> >         prob_matrix_6[i,j] = "Fred"
> >       }
> >
> >     }
> >   }
> >
> >   #calculating column  which will have a 1 if trial was successful and a
> 0
> > otherwise
> >   prob_matrix_6['success'] <- for (i in 1:nrow(prob_matrix_6)){
> >     if (("Alice" %in% prob_matrix_6[i,]) & ("Bob" %in%
> prob_matrix_6[i,]) &
> > ("Charlie" %in% prob_matrix_6[i,]) & ("Don" %in% prob_matrix_6[i,]) &
> > ("Ellen" %in% prob_matrix_6[i,]) & ("Fred" %in% prob_matrix_6[i,])){
> >       prob_matrix_6[i,13] = 1
> >     }else{
> >       prob_matrix_6[i,13] = 0
> >     }
> >   }
> >
> >   #relabeling column v13 so that its new name is success
> >   colnames(prob_matrix_6)[13] <- "success"
> >
> >
> >   #calculating probability of success
> >
> >   p6 = sum(prob_matrix_6$success)/nrow(prob_matrix_6)
> >   prob_frame_6 <- cbind(prob_frame_6, p6)
> >
> >   k = k + 1
> >
> > }
> >
> > prob_frame_6 <- prob_frame_6[11:20]
> > colnames(prob_frame_6) <-
> > c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10")
> > average_prob_frame_6 <- rowMeans(prob_frame_6)
> > trial_1000000_10_frame <- cbind(prob_frame_6, average_prob_frame_6)
> > final_frame_6 <- trial_1000000_10_frame
> > colnames(final_frame_6) <-
> > c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10", "avg_prob_frame_5")
> >
> > write.csv(final_frame_6, "OneMillion_Trials_Ten_Times_Results.csv")
> > print(final_frame_6)
> > print(paste("The average probability of success when doing 1,000,000
> trials
> > 10 times is:", average_prob_frame_6))
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sun Apr 24 11:43:46 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sun, 24 Apr 2022 10:43:46 +0100
Subject: [R] R Code Execution taking forever
In-Reply-To: <CAMOcQfN1U-gMbAtM5JA9VLmwyKESPo8NAPs=0gmBrtON5zq0dg@mail.gmail.com>
References: <CAMOcQfN1U-gMbAtM5JA9VLmwyKESPo8NAPs=0gmBrtON5zq0dg@mail.gmail.com>
Message-ID: <3ea85564-5162-ebcc-3697-73a7df86dcbd@sapo.pt>

Hello,

I'm having trouble running the code, where does function dice come from?
CRAN package dice only has two functions,

getEventProb
getSumProbs

not a function dice.

Can you post a link to where the package/function can be found?

Rui Barradas


?s 02:00 de 24/04/2022, Paul Bernal escreveu:
> Dear R friends,
> 
> Hope you are doing great. The reason why I am contacting you all, is
> because the code I am sharing with you takes forever. It started running at
> 2:00 AM today, and it's 7:52 PM and is still running (see code at the end
> of this mail).
> 
> I am using Rx64  4.1.2, and the code is being executed in RStudio. The
> RStudio version I am currently using is Version 2022.02.0 Build 443
> "Prairie Trillium" Release (9f796939, 2022-02-16) for Windows.
> 
> My PC specs:
> Processor: Intel(R) Core(TM) i5-10310U CPU @ 1.70 GHz
> Installed RAM: 16.0 GB (15.6 GB usable)
> System type: 64-bit operating system, x64-based processor
> Local Disc(C:) Free Space: 274 GB
> 
> I am wondering if there is/are a set of system variable(s) or something I
> could do to improve the performance of the program.
> 
> It is really odd this code has taken this much (and it is still running).
> 
> Any help and/or guidance would be greatly appreciated.
> 
> Best regards,
> Paul
> 
> 
> 
> 
> #performing 1,000,000 simulations 10 times
> num_trials_6 = 1000000
> dice_rolls_6 = num_trials_6*12
> num_dice_6 = 1
> dice_sides_6 = 6
> 
> prob_frame_6 <- data.frame(matrix(ncol = 10, nrow = 1))
> 
> k <- 0
> while(k < 10){
>    dice_simul_6 = data.frame(dice(rolls = dice_rolls_6, ndice = num_dice_6,
> sides = dice_sides_6, plot.it = FALSE))
> 
>    #constructing matrix containing results of all dice rolls by month
>    prob_matrix_6 <- data.frame(matrix(dice_simul_6[,1], ncol = 12, byrow =
> TRUE))
> 
>    #naming each column by it's corresponding month name
>    colnames(prob_matrix_6) <-
> c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
> 
> 
>    #assigning each person?s name depending on the number showed in the dice
> once rolled
>    for (i in 1:nrow(prob_matrix_6)){
>      for (j in 1:ncol(prob_matrix_6)){
>        if (prob_matrix_6[i,j] == 1){
>          prob_matrix_6[i,j] = "Alice"
>        }
>        if (prob_matrix_6[i,j] == 2){
>          prob_matrix_6[i,j] = "Bob"
>        }
>        if (prob_matrix_6[i,j] == 3){
>          prob_matrix_6[i,j] = "Charlie"
>        }
>        if (prob_matrix_6[i,j] == 4){
>          prob_matrix_6[i,j] = "Don"
>        }
>        if (prob_matrix_6[i,j] == 5){
>          prob_matrix_6[i,j] = "Ellen"
>        }
>        if (prob_matrix_6[i,j] == 6){
>          prob_matrix_6[i,j] = "Fred"
>        }
> 
>      }
>    }
> 
>    #calculating column  which will have a 1 if trial was successful and a 0
> otherwise
>    prob_matrix_6['success'] <- for (i in 1:nrow(prob_matrix_6)){
>      if (("Alice" %in% prob_matrix_6[i,]) & ("Bob" %in% prob_matrix_6[i,]) &
> ("Charlie" %in% prob_matrix_6[i,]) & ("Don" %in% prob_matrix_6[i,]) &
> ("Ellen" %in% prob_matrix_6[i,]) & ("Fred" %in% prob_matrix_6[i,])){
>        prob_matrix_6[i,13] = 1
>      }else{
>        prob_matrix_6[i,13] = 0
>      }
>    }
> 
>    #relabeling column v13 so that its new name is success
>    colnames(prob_matrix_6)[13] <- "success"
> 
> 
>    #calculating probability of success
> 
>    p6 = sum(prob_matrix_6$success)/nrow(prob_matrix_6)
>    prob_frame_6 <- cbind(prob_frame_6, p6)
> 
>    k = k + 1
> 
> }
> 
> prob_frame_6 <- prob_frame_6[11:20]
> colnames(prob_frame_6) <-
> c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10")
> average_prob_frame_6 <- rowMeans(prob_frame_6)
> trial_1000000_10_frame <- cbind(prob_frame_6, average_prob_frame_6)
> final_frame_6 <- trial_1000000_10_frame
> colnames(final_frame_6) <-
> c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10", "avg_prob_frame_5")
> 
> write.csv(final_frame_6, "OneMillion_Trials_Ten_Times_Results.csv")
> print(final_frame_6)
> print(paste("The average probability of success when doing 1,000,000 trials
> 10 times is:", average_prob_frame_6))
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sun Apr 24 16:38:44 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sun, 24 Apr 2022 15:38:44 +0100
Subject: [R] R Code Execution taking forever
In-Reply-To: <CAMOcQfOt3qHO3NvYch1J2u7Y=1obK0Gn8N2fePBjfLWAr_NHkA@mail.gmail.com>
References: <CAMOcQfN1U-gMbAtM5JA9VLmwyKESPo8NAPs=0gmBrtON5zq0dg@mail.gmail.com>
 <3ea85564-5162-ebcc-3697-73a7df86dcbd@sapo.pt>
 <CAMOcQfO3MVMbkWcQQcQv4CwZgWpNFci9OVqJZZom4i9Ah14FRA@mail.gmail.com>
 <92e4acee-31db-425a-1e33-d057dc1fb280@sapo.pt>
 <CAMOcQfOt3qHO3NvYch1J2u7Y=1obK0Gn8N2fePBjfLWAr_NHkA@mail.gmail.com>
Message-ID: <39d15320-7f6c-bf54-3e09-801ce4fdcb4c@sapo.pt>

Hello,

Thanks for the link, the package is TeachingDemos, it's the function 
that's named dice. And the source code shows that it calls sample() in a 
way similar to mine, so the code I posted should give approximately the 
same results.

To run just once, change to K <- 1L, right before the main for loop.

Hope this helps,

Rui Barradas

?s 15:24 de 24/04/2022, Paul Bernal escreveu:
> Dear friend Rui,
> 
> Thank you so much for your extremely valuable help.
> 
> This is the dice function I used:
> https://www.rdocumentation.org/packages/TeachingDemos/versions/2.12/topics/dice 
> <https://www.rdocumentation.org/packages/TeachingDemos/versions/2.12/topics/dice>
> 
> One question, how would I modify your code to run it for 1,000,000 rolls 
> 1 time?
> 
> Best,
> Paul
> 
> El dom, 24 abr 2022 a las 8:58, Rui Barradas (<ruipbarradas at sapo.pt 
> <mailto:ruipbarradas at sapo.pt>>) escribi?:
> 
>     Hello,
> 
>     I still can't find the package dice you are using, it's not the one on
>     CRAN, that one only has two functions, like I said earlier.
> 
>     Anyway, I have replaced function dice(9 by a call to sample().
>     And simplified the code a lot. It takes half a minute to run the
>     1,000,000 simulations K = 10 times (upper case K).
>     See if this is what you want.
> 
> 
>     # these two are equal
>     cnames0 <-
>     c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
>     cnames <- month.abb
>     identical(cnames0, cnames)
>     # [1] TRUE
> 
>     # performing 1,000,000 simulations 10 times
>     num_trials_6 <- 1e6
>     dice_rolls_6 <- num_trials_6*12
>     num_dice_6 <- 1
>     dice_sides_6 <- 6
> 
>     set.seed(2022)
> 
>     prob_frame_6 <- as.data.frame(matrix(ncol = 10L, nrow = 1L))
>     K <- 10L
>     for(k in seq_len(K)){
>      ? ?#
>      ? ?dice_simul_6 <- sample(dice_sides_6, dice_rolls_6, replace = TRUE)
>      ? ?# constructing matrix containing results of all dice rolls by month
>      ? ?prob_matrix_6 <- matrix(dice_simul_6, ncol = 12, byrow = TRUE)
> 
>      ? ?# naming each column by it's corresponding month name
>      ? ?colnames(prob_matrix_6) <- month.abb
> 
>      ? ?# calculating column? which will have a 1
>      ? ?# if trial was successful and a 0 otherwise
>      ? ?success <- integer(num_trials_6)
>      ? ?for(i in seq_len(num_trials_6)){
>      ? ? ?success[i] <- as.integer(all(1:6 %in% prob_matrix_6[i, ]))
>      ? ?}
> 
>      ? ?#calculating probability of success
> 
>      ? ?p6 <- mean(success)
>      ? ?prob_frame_6[1, k] <- p6
>     }
> 
>     colnames(prob_frame_6) <- sprintf("p%d", seq_len(K))
>     average_prob_frame_6 <- rowMeans(prob_frame_6)
>     final_frame_6 <- cbind(prob_frame_6, average_prob_frame_6)
> 
>     write.csv(final_frame_6, "OneMillion_Trials_Ten_Times_Results.csv")
> 
>     print(final_frame_6)
>     print(paste("The average probability of success when doing 1,000,000
>     trials 10 times is:", average_prob_frame_6))
> 
> 
>     Hope this helps,
> 
>     Rui Barradas
> 
>     ?s 12:14 de 24/04/2022, Paul Bernal escreveu:
>      > Dear Rui,
>      >
>      > There is a package called dice, that package is the one I am
>     using. This
>      > package has a funci?n called dice.
>      >
>      > Best,
>      >
>      > Paul
>      >
>      > El El dom, 24 de abr. de 2022 a la(s) 4:43 a.?m., Rui Barradas
>      > <ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>
>     <mailto:ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>>> escribi?:
>      >
>      >? ? ?Hello,
>      >
>      >? ? ?I'm having trouble running the code, where does function dice
>     come from?
>      >? ? ?CRAN package dice only has two functions,
>      >
>      >? ? ?getEventProb
>      >? ? ?getSumProbs
>      >
>      >? ? ?not a function dice.
>      >
>      >? ? ?Can you post a link to where the package/function can be found?
>      >
>      >? ? ?Rui Barradas
>      >
>      >
>      >? ? ??s 02:00 de 24/04/2022, Paul Bernal escreveu:
>      >? ? ? > Dear R friends,
>      >? ? ? >
>      >? ? ? > Hope you are doing great. The reason why I am contacting
>     you all, is
>      >? ? ? > because the code I am sharing with you takes forever. It
>     started
>      >? ? ?running at
>      >? ? ? > 2:00 AM today, and it's 7:52 PM and is still running (see
>     code at
>      >? ? ?the end
>      >? ? ? > of this mail).
>      >? ? ? >
>      >? ? ? > I am using Rx64? 4.1.2, and the code is being executed in
>      >? ? ?RStudio. The
>      >? ? ? > RStudio version I am currently using is Version 2022.02.0
>     Build 443
>      >? ? ? > "Prairie Trillium" Release (9f796939, 2022-02-16) for Windows.
>      >? ? ? >
>      >? ? ? > My PC specs:
>      >? ? ? > Processor: Intel(R) Core(TM) i5-10310U CPU @ 1.70 GHz
>      >? ? ? > Installed RAM: 16.0 GB (15.6 GB usable)
>      >? ? ? > System type: 64-bit operating system, x64-based processor
>      >? ? ? > Local Disc(C:) Free Space: 274 GB
>      >? ? ? >
>      >? ? ? > I am wondering if there is/are a set of system variable(s) or
>      >? ? ?something I
>      >? ? ? > could do to improve the performance of the program.
>      >? ? ? >
>      >? ? ? > It is really odd this code has taken this much (and it is
>     still
>      >? ? ?running).
>      >? ? ? >
>      >? ? ? > Any help and/or guidance would be greatly appreciated.
>      >? ? ? >
>      >? ? ? > Best regards,
>      >? ? ? > Paul
>      >? ? ? >
>      >? ? ? >
>      >? ? ? >
>      >? ? ? >
>      >? ? ? > #performing 1,000,000 simulations 10 times
>      >? ? ? > num_trials_6 = 1000000
>      >? ? ? > dice_rolls_6 = num_trials_6*12
>      >? ? ? > num_dice_6 = 1
>      >? ? ? > dice_sides_6 = 6
>      >? ? ? >
>      >? ? ? > prob_frame_6 <- data.frame(matrix(ncol = 10, nrow = 1))
>      >? ? ? >
>      >? ? ? > k <- 0
>      >? ? ? > while(k < 10){
>      >? ? ? >? ? dice_simul_6 = data.frame(dice(rolls = dice_rolls_6,
>     ndice =
>      >? ? ?num_dice_6,
>      >? ? ? > sides = dice_sides_6, plot.it <http://plot.it>
>     <http://plot.it <http://plot.it>> = FALSE))
>      >? ? ? >
>      >? ? ? >? ? #constructing matrix containing results of all dice
>     rolls by month
>      >? ? ? >? ? prob_matrix_6 <- data.frame(matrix(dice_simul_6[,1], ncol =
>      >? ? ?12, byrow =
>      >? ? ? > TRUE))
>      >? ? ? >
>      >? ? ? >? ? #naming each column by it's corresponding month name
>      >? ? ? >? ? colnames(prob_matrix_6) <-
>      >? ? ? >
>      >   
>      ?c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
>      >? ? ? >
>      >? ? ? >
>      >? ? ? >? ? #assigning each person?s name depending on the number
>     showed
>      >? ? ?in the dice
>      >? ? ? > once rolled
>      >? ? ? >? ? for (i in 1:nrow(prob_matrix_6)){
>      >? ? ? >? ? ? for (j in 1:ncol(prob_matrix_6)){
>      >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 1){
>      >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Alice"
>      >? ? ? >? ? ? ? }
>      >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 2){
>      >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Bob"
>      >? ? ? >? ? ? ? }
>      >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 3){
>      >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Charlie"
>      >? ? ? >? ? ? ? }
>      >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 4){
>      >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Don"
>      >? ? ? >? ? ? ? }
>      >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 5){
>      >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Ellen"
>      >? ? ? >? ? ? ? }
>      >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 6){
>      >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Fred"
>      >? ? ? >? ? ? ? }
>      >? ? ? >
>      >? ? ? >? ? ? }
>      >? ? ? >? ? }
>      >? ? ? >
>      >? ? ? >? ? #calculating column? which will have a 1 if trial was
>      >? ? ?successful and a 0
>      >? ? ? > otherwise
>      >? ? ? >? ? prob_matrix_6['success'] <- for (i in
>     1:nrow(prob_matrix_6)){
>      >? ? ? >? ? ? if (("Alice" %in% prob_matrix_6[i,]) & ("Bob" %in%
>      >? ? ?prob_matrix_6[i,]) &
>      >? ? ? > ("Charlie" %in% prob_matrix_6[i,]) & ("Don" %in%
>     prob_matrix_6[i,]) &
>      >? ? ? > ("Ellen" %in% prob_matrix_6[i,]) & ("Fred" %in%
>     prob_matrix_6[i,])){
>      >? ? ? >? ? ? ? prob_matrix_6[i,13] = 1
>      >? ? ? >? ? ? }else{
>      >? ? ? >? ? ? ? prob_matrix_6[i,13] = 0
>      >? ? ? >? ? ? }
>      >? ? ? >? ? }
>      >? ? ? >
>      >? ? ? >? ? #relabeling column v13 so that its new name is success
>      >? ? ? >? ? colnames(prob_matrix_6)[13] <- "success"
>      >? ? ? >
>      >? ? ? >
>      >? ? ? >? ? #calculating probability of success
>      >? ? ? >
>      >? ? ? >? ? p6 = sum(prob_matrix_6$success)/nrow(prob_matrix_6)
>      >? ? ? >? ? prob_frame_6 <- cbind(prob_frame_6, p6)
>      >? ? ? >
>      >? ? ? >? ? k = k + 1
>      >? ? ? >
>      >? ? ? > }
>      >? ? ? >
>      >? ? ? > prob_frame_6 <- prob_frame_6[11:20]
>      >? ? ? > colnames(prob_frame_6) <-
>      >? ? ? > c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10")
>      >? ? ? > average_prob_frame_6 <- rowMeans(prob_frame_6)
>      >? ? ? > trial_1000000_10_frame <- cbind(prob_frame_6,
>     average_prob_frame_6)
>      >? ? ? > final_frame_6 <- trial_1000000_10_frame
>      >? ? ? > colnames(final_frame_6) <-
>      >? ? ? > c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10",
>      >? ? ?"avg_prob_frame_5")
>      >? ? ? >
>      >? ? ? > write.csv(final_frame_6,
>     "OneMillion_Trials_Ten_Times_Results.csv")
>      >? ? ? > print(final_frame_6)
>      >? ? ? > print(paste("The average probability of success when doing
>      >? ? ?1,000,000 trials
>      >? ? ? > 10 times is:", average_prob_frame_6))
>      >? ? ? >
>      >? ? ? >? ? ? ?[[alternative HTML version deleted]]
>      >? ? ? >
>      >? ? ? > ______________________________________________
>      >? ? ? > R-help at r-project.org <mailto:R-help at r-project.org>
>     <mailto:R-help at r-project.org <mailto:R-help at r-project.org>> mailing list
>      >? ? ?-- To UNSUBSCRIBE and more, see
>      >? ? ? > https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>      >? ? ?<https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>>
>      >? ? ? > PLEASE do read the posting guide
>      > http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>      >? ? ?<http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>>
>      >? ? ? > and provide commented, minimal, self-contained,
>     reproducible code.
>      >
>


From kt1572757 @end|ng |rom gm@||@com  Sun Apr 24 17:02:49 2022
From: kt1572757 @end|ng |rom gm@||@com (Kelly Thompson)
Date: Sun, 24 Apr 2022 11:02:49 -0400
Subject: [R] What are the pros and cons of the various R functions and
 methods for conducting least median of squares regression analysis?
In-Reply-To: <CAHfBD2dVadhPZwAvG-+EvzQLk5faBOf-nTbtXdvJM0K7gQsTHQ@mail.gmail.com>
References: <CAHfBD2dVadhPZwAvG-+EvzQLk5faBOf-nTbtXdvJM0K7gQsTHQ@mail.gmail.com>
Message-ID: <CAHfBD2cGC0wz1FqOg3hwSZTOwGSTi3THMGDn-00W74sPWRXUZQ@mail.gmail.com>

Thanks to all responded for your insights and advice, and for the
information about the mailing list for robust statistics with R. I
will post to that list.

I feel that I am in the early stage of learning about and "exploring"
least median of squares regression analysis and other robust
regression methods such as least absolute deviation regression, and
iteratively reweighted least squares regression, and I feel I do not
yet know enough to ask more specific questions or have the knowledge
and understanding to know what else I "should" be asking.

I am interested in robust regression methods useful for datasets with
50,000 or more observations, that might have "outliers" and/or
"influential observations", where the regression model might have one
to perhaps ten independent variables.

Here are questions I have. I'm open to suggestions of other questions
to ask, and to learning from others:
- What R functions offer least median of squares regression analysis?
- Which of these functions if any continue to be maintained?
- Are there any clear pros and cons of each package?

Thanks again.

On Sat, Apr 16, 2022 at 2:45 PM Kelly Thompson <kt1572757 at gmail.com> wrote:
>
> What are the pros and cons of the various R functions and methods for
> conducting least median of squares regression analysis?
>
> I know about these:
>
> lqs, wth method = "lms" and lmsreg, which as I understan dit are equivalent
>
> Mentions:
> https://www.rdocumentation.org/packages/MASS/versions/7.3-56/topics/lqs
>
> https://stat.ethz.ch/pipermail/r-help/2006-October/115681.html
>
> https://stat.ethz.ch/pipermail/r-help/2007-March/126564.html
> -----
>
> ltsReg
>
> https://www.rdocumentation.org/packages/robustbase/versions/0.1-2/topics/ltsReg
> -----
> nl.lmsNM
> https://rdrr.io/cran/nlr/man/nl.lmsNM.html


From @erv|ce @end|ng |rom @hd@w@on@com  Sun Apr 24 17:24:58 2022
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Sun, 24 Apr 2022 11:24:58 -0400
Subject: [R] What are the pros and cons of the various R functions and
 methods for conducting least median of squares regression analysis?
In-Reply-To: <CAHfBD2cGC0wz1FqOg3hwSZTOwGSTi3THMGDn-00W74sPWRXUZQ@mail.gmail.com>
References: <CAHfBD2dVadhPZwAvG-+EvzQLk5faBOf-nTbtXdvJM0K7gQsTHQ@mail.gmail.com>
 <CAHfBD2cGC0wz1FqOg3hwSZTOwGSTi3THMGDn-00W74sPWRXUZQ@mail.gmail.com>
Message-ID: <fe16b1a1-8c4c-3129-8454-342b92d3a46c@shdawson.com>

Hi Kelly,

https://stat.ethz.ch/pipermail/r-devel/2022-April/081622.html

I spoke about your topic on another list by way of a similar discussion. 
Perhaps this suggested tool is the help that would ... help ... the 
bigger picture for all of us.

*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com


On 4/24/22 11:02, Kelly Thompson wrote:
> Thanks to all responded for your insights and advice, and for the
> information about the mailing list for robust statistics with R. I
> will post to that list.
>
> I feel that I am in the early stage of learning about and "exploring"
> least median of squares regression analysis and other robust
> regression methods such as least absolute deviation regression, and
> iteratively reweighted least squares regression, and I feel I do not
> yet know enough to ask more specific questions or have the knowledge
> and understanding to know what else I "should" be asking.
>
> I am interested in robust regression methods useful for datasets with
> 50,000 or more observations, that might have "outliers" and/or
> "influential observations", where the regression model might have one
> to perhaps ten independent variables.
>
> Here are questions I have. I'm open to suggestions of other questions
> to ask, and to learning from others:
> - What R functions offer least median of squares regression analysis?
> - Which of these functions if any continue to be maintained?
> - Are there any clear pros and cons of each package?
>
> Thanks again.
>
> On Sat, Apr 16, 2022 at 2:45 PM Kelly Thompson<kt1572757 at gmail.com>  wrote:
>> What are the pros and cons of the various R functions and methods for
>> conducting least median of squares regression analysis?
>>
>> I know about these:
>>
>> lqs, wth method = "lms" and lmsreg, which as I understan dit are equivalent
>>
>> Mentions:
>> https://www.rdocumentation.org/packages/MASS/versions/7.3-56/topics/lqs
>>
>> https://stat.ethz.ch/pipermail/r-help/2006-October/115681.html
>>
>> https://stat.ethz.ch/pipermail/r-help/2007-March/126564.html
>> -----
>>
>> ltsReg
>>
>> https://www.rdocumentation.org/packages/robustbase/versions/0.1-2/topics/ltsReg
>> -----
>> nl.lmsNM
>> https://rdrr.io/cran/nlr/man/nl.lmsNM.html
> ______________________________________________
> R-help at r-project.org  mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guidehttp://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Sun Apr 24 18:09:39 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sun, 24 Apr 2022 09:09:39 -0700
Subject: [R] What are the pros and cons of the various R functions and
 methods for conducting least median of squares regression analysis?
In-Reply-To: <CAHfBD2cGC0wz1FqOg3hwSZTOwGSTi3THMGDn-00W74sPWRXUZQ@mail.gmail.com>
References: <CAHfBD2dVadhPZwAvG-+EvzQLk5faBOf-nTbtXdvJM0K7gQsTHQ@mail.gmail.com>
 <CAHfBD2cGC0wz1FqOg3hwSZTOwGSTi3THMGDn-00W74sPWRXUZQ@mail.gmail.com>
Message-ID: <CAGxFJbSyk-_Qc3NvAMJ8MbUCrHOfpqooQ8Xqy5pnnyNDme6p9g@mail.gmail.com>

Please make use of existing resources before posting:
https://cran.r-project.org/web/views/Robust.html

Also, you should probably post here:
https://stat.ethz.ch/mailman/listinfo/r-sig-robust

instead of on this list.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Sun, Apr 24, 2022 at 8:03 AM Kelly Thompson <kt1572757 at gmail.com> wrote:
>
> Thanks to all responded for your insights and advice, and for the
> information about the mailing list for robust statistics with R. I
> will post to that list.
>
> I feel that I am in the early stage of learning about and "exploring"
> least median of squares regression analysis and other robust
> regression methods such as least absolute deviation regression, and
> iteratively reweighted least squares regression, and I feel I do not
> yet know enough to ask more specific questions or have the knowledge
> and understanding to know what else I "should" be asking.
>
> I am interested in robust regression methods useful for datasets with
> 50,000 or more observations, that might have "outliers" and/or
> "influential observations", where the regression model might have one
> to perhaps ten independent variables.
>
> Here are questions I have. I'm open to suggestions of other questions
> to ask, and to learning from others:
> - What R functions offer least median of squares regression analysis?
> - Which of these functions if any continue to be maintained?
> - Are there any clear pros and cons of each package?
>
> Thanks again.
>
> On Sat, Apr 16, 2022 at 2:45 PM Kelly Thompson <kt1572757 at gmail.com> wrote:
> >
> > What are the pros and cons of the various R functions and methods for
> > conducting least median of squares regression analysis?
> >
> > I know about these:
> >
> > lqs, wth method = "lms" and lmsreg, which as I understan dit are equivalent
> >
> > Mentions:
> > https://www.rdocumentation.org/packages/MASS/versions/7.3-56/topics/lqs
> >
> > https://stat.ethz.ch/pipermail/r-help/2006-October/115681.html
> >
> > https://stat.ethz.ch/pipermail/r-help/2007-March/126564.html
> > -----
> >
> > ltsReg
> >
> > https://www.rdocumentation.org/packages/robustbase/versions/0.1-2/topics/ltsReg
> > -----
> > nl.lmsNM
> > https://rdrr.io/cran/nlr/man/nl.lmsNM.html
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From tebert @end|ng |rom u||@edu  Sun Apr 24 21:02:10 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Sun, 24 Apr 2022 19:02:10 +0000
Subject: [R] R Code Execution taking forever
In-Reply-To: <3ea85564-5162-ebcc-3697-73a7df86dcbd@sapo.pt>
References: <CAMOcQfN1U-gMbAtM5JA9VLmwyKESPo8NAPs=0gmBrtON5zq0dg@mail.gmail.com>
 <3ea85564-5162-ebcc-3697-73a7df86dcbd@sapo.pt>
Message-ID: <BN6PR2201MB155357A6ACA50FCC9444E34CCFF99@BN6PR2201MB1553.namprd22.prod.outlook.com>

1) Does it run perfectly with num_tirals_6 <- 100 ?
2) Rework the code to remove as much as possible from loops. 
            Renaming column names each time through the loop seems pointless.
            Is the nested for loops converting the dice roll to person name necessary within the while loop?
3) Stop all other apps on the computer.
4) Consider rewriting to take advantage of multiple cores in your system in parallel processing (this might or might not help much).
5) Rerun with num_trials_6 set to different values 10, 100, 1000, and 10000. Linear regression with run time and trial size should let you estimate run time for 1 million.


Tim 

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Rui Barradas
Sent: Sunday, April 24, 2022 5:44 AM
To: Paul Bernal <paulbernal07 at gmail.com>; R <r-help at r-project.org>
Subject: Re: [R] R Code Execution taking forever

[External Email]

Hello,

I'm having trouble running the code, where does function dice come from?
CRAN package dice only has two functions,

getEventProb
getSumProbs

not a function dice.

Can you post a link to where the package/function can be found?

Rui Barradas


?s 02:00 de 24/04/2022, Paul Bernal escreveu:
> Dear R friends,
>
> Hope you are doing great. The reason why I am contacting you all, is 
> because the code I am sharing with you takes forever. It started 
> running at
> 2:00 AM today, and it's 7:52 PM and is still running (see code at the 
> end of this mail).
>
> I am using Rx64  4.1.2, and the code is being executed in RStudio. The 
> RStudio version I am currently using is Version 2022.02.0 Build 443 
> "Prairie Trillium" Release (9f796939, 2022-02-16) for Windows.
>
> My PC specs:
> Processor: Intel(R) Core(TM) i5-10310U CPU @ 1.70 GHz Installed RAM: 
> 16.0 GB (15.6 GB usable) System type: 64-bit operating system, 
> x64-based processor Local Disc(C:) Free Space: 274 GB
>
> I am wondering if there is/are a set of system variable(s) or 
> something I could do to improve the performance of the program.
>
> It is really odd this code has taken this much (and it is still running).
>
> Any help and/or guidance would be greatly appreciated.
>
> Best regards,
> Paul
>
>
>
>
> #performing 1,000,000 simulations 10 times
> num_trials_6 = 1000000
> dice_rolls_6 = num_trials_6*12
> num_dice_6 = 1
> dice_sides_6 = 6
>
> prob_frame_6 <- data.frame(matrix(ncol = 10, nrow = 1))
>
> k <- 0
> while(k < 10){
>    dice_simul_6 = data.frame(dice(rolls = dice_rolls_6, ndice = 
> num_dice_6, sides = dice_sides_6, plot.it = FALSE))
>
>    #constructing matrix containing results of all dice rolls by month
>    prob_matrix_6 <- data.frame(matrix(dice_simul_6[,1], ncol = 12, 
> byrow =
> TRUE))
>
>    #naming each column by it's corresponding month name
>    colnames(prob_matrix_6) <-
> c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","D
> ec")
>
>
>    #assigning each person?s name depending on the number showed in the 
> dice once rolled
>    for (i in 1:nrow(prob_matrix_6)){
>      for (j in 1:ncol(prob_matrix_6)){
>        if (prob_matrix_6[i,j] == 1){
>          prob_matrix_6[i,j] = "Alice"
>        }
>        if (prob_matrix_6[i,j] == 2){
>          prob_matrix_6[i,j] = "Bob"
>        }
>        if (prob_matrix_6[i,j] == 3){
>          prob_matrix_6[i,j] = "Charlie"
>        }
>        if (prob_matrix_6[i,j] == 4){
>          prob_matrix_6[i,j] = "Don"
>        }
>        if (prob_matrix_6[i,j] == 5){
>          prob_matrix_6[i,j] = "Ellen"
>        }
>        if (prob_matrix_6[i,j] == 6){
>          prob_matrix_6[i,j] = "Fred"
>        }
>
>      }
>    }
>
>    #calculating column  which will have a 1 if trial was successful 
> and a 0 otherwise
>    prob_matrix_6['success'] <- for (i in 1:nrow(prob_matrix_6)){
>      if (("Alice" %in% prob_matrix_6[i,]) & ("Bob" %in% 
> prob_matrix_6[i,]) & ("Charlie" %in% prob_matrix_6[i,]) & ("Don" %in% 
> prob_matrix_6[i,]) & ("Ellen" %in% prob_matrix_6[i,]) & ("Fred" %in% prob_matrix_6[i,])){
>        prob_matrix_6[i,13] = 1
>      }else{
>        prob_matrix_6[i,13] = 0
>      }
>    }
>
>    #relabeling column v13 so that its new name is success
>    colnames(prob_matrix_6)[13] <- "success"
>
>
>    #calculating probability of success
>
>    p6 = sum(prob_matrix_6$success)/nrow(prob_matrix_6)
>    prob_frame_6 <- cbind(prob_frame_6, p6)
>
>    k = k + 1
>
> }
>
> prob_frame_6 <- prob_frame_6[11:20]
> colnames(prob_frame_6) <-
> c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10")
> average_prob_frame_6 <- rowMeans(prob_frame_6) trial_1000000_10_frame 
> <- cbind(prob_frame_6, average_prob_frame_6)
> final_frame_6 <- trial_1000000_10_frame
> colnames(final_frame_6) <-
> c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10", 
> "avg_prob_frame_5")
>
> write.csv(final_frame_6, "OneMillion_Trials_Ten_Times_Results.csv")
> print(final_frame_6)
> print(paste("The average probability of success when doing 1,000,000 
> trials
> 10 times is:", average_prob_frame_6))
>
>       [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
> man_listinfo_r-2Dhelp&d=DwIDaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAs
> Rzsn7AkP-g&m=wM6IILK-62Cb0r02bfEW05eVb0lndtvSWfuz7gHTlutarVXWwMYm2ucHQ
> 8zpRTow&s=il9X1N5C_yJqnTaXdQFBZFkG2En_jhiejElnzL__WdA&e=
> PLEASE do read the posting guide 
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.or
> g_posting-2Dguide.html&d=DwIDaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeA
> sRzsn7AkP-g&m=wM6IILK-62Cb0r02bfEW05eVb0lndtvSWfuz7gHTlutarVXWwMYm2ucH
> Q8zpRTow&s=027mAUgUIZGXPwemk-9LCBL8uREpR8MMkM5-4Hf4y5w&e=
> and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwIDaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=wM6IILK-62Cb0r02bfEW05eVb0lndtvSWfuz7gHTlutarVXWwMYm2ucHQ8zpRTow&s=il9X1N5C_yJqnTaXdQFBZFkG2En_jhiejElnzL__WdA&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwIDaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=wM6IILK-62Cb0r02bfEW05eVb0lndtvSWfuz7gHTlutarVXWwMYm2ucHQ8zpRTow&s=027mAUgUIZGXPwemk-9LCBL8uREpR8MMkM5-4Hf4y5w&e=
and provide commented, minimal, self-contained, reproducible code.

From p@u|bern@|07 @end|ng |rom gm@||@com  Sun Apr 24 21:21:57 2022
From: p@u|bern@|07 @end|ng |rom gm@||@com (Paul Bernal)
Date: Sun, 24 Apr 2022 14:21:57 -0500
Subject: [R] R Code Execution taking forever
In-Reply-To: <BN6PR2201MB155357A6ACA50FCC9444E34CCFF99@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <CAMOcQfN1U-gMbAtM5JA9VLmwyKESPo8NAPs=0gmBrtON5zq0dg@mail.gmail.com>
 <3ea85564-5162-ebcc-3697-73a7df86dcbd@sapo.pt>
 <BN6PR2201MB155357A6ACA50FCC9444E34CCFF99@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <CAMOcQfNZkhA259+HAdAM-W=bi8J-LmWNbbz=e6xS+9jmn76e6g@mail.gmail.com>

Dear friend Ebert,

The only reason why I labeled the numbers is because out instructor asked
for it(as part of the project). However, I agree with you 100% in that
labeling is pointless and doesn?t add any value.

>From the modified code shared by Rui, it seems to me that the dice function
is rather inefficient (I could be wrong).

I will run the mofied version provided by Rui and will let you all know how
it went. I even thought for a moment that the problem could be due to
system variables configurations or even my computer?s capacity (RAM and
processor).

The code I sent originally worked perfectly from 10 trials up to 100,000
trials but ejem trying with 1 million trials it was over, more than 24
hours and still didn?t finish execution.

Best,
Paul

El El dom, 24 de abr. de 2022 a la(s) 2:03 p. m., Ebert,Timothy Aaron <
tebert at ufl.edu> escribi?:

> 1) Does it run perfectly with num_tirals_6 <- 100 ?
> 2) Rework the code to remove as much as possible from loops.
>             Renaming column names each time through the loop seems
> pointless.
>             Is the nested for loops converting the dice roll to person
> name necessary within the while loop?
> 3) Stop all other apps on the computer.
> 4) Consider rewriting to take advantage of multiple cores in your system
> in parallel processing (this might or might not help much).
> 5) Rerun with num_trials_6 set to different values 10, 100, 1000, and
> 10000. Linear regression with run time and trial size should let you
> estimate run time for 1 million.
>
>
> Tim
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Rui Barradas
> Sent: Sunday, April 24, 2022 5:44 AM
> To: Paul Bernal <paulbernal07 at gmail.com>; R <r-help at r-project.org>
> Subject: Re: [R] R Code Execution taking forever
>
> [External Email]
>
> Hello,
>
> I'm having trouble running the code, where does function dice come from?
> CRAN package dice only has two functions,
>
> getEventProb
> getSumProbs
>
> not a function dice.
>
> Can you post a link to where the package/function can be found?
>
> Rui Barradas
>
>
> ?s 02:00 de 24/04/2022, Paul Bernal escreveu:
> > Dear R friends,
> >
> > Hope you are doing great. The reason why I am contacting you all, is
> > because the code I am sharing with you takes forever. It started
> > running at
> > 2:00 AM today, and it's 7:52 PM and is still running (see code at the
> > end of this mail).
> >
> > I am using Rx64  4.1.2, and the code is being executed in RStudio. The
> > RStudio version I am currently using is Version 2022.02.0 Build 443
> > "Prairie Trillium" Release (9f796939, 2022-02-16) for Windows.
> >
> > My PC specs:
> > Processor: Intel(R) Core(TM) i5-10310U CPU @ 1.70 GHz Installed RAM:
> > 16.0 GB (15.6 GB usable) System type: 64-bit operating system,
> > x64-based processor Local Disc(C:) Free Space: 274 GB
> >
> > I am wondering if there is/are a set of system variable(s) or
> > something I could do to improve the performance of the program.
> >
> > It is really odd this code has taken this much (and it is still running).
> >
> > Any help and/or guidance would be greatly appreciated.
> >
> > Best regards,
> > Paul
> >
> >
> >
> >
> > #performing 1,000,000 simulations 10 times
> > num_trials_6 = 1000000
> > dice_rolls_6 = num_trials_6*12
> > num_dice_6 = 1
> > dice_sides_6 = 6
> >
> > prob_frame_6 <- data.frame(matrix(ncol = 10, nrow = 1))
> >
> > k <- 0
> > while(k < 10){
> >    dice_simul_6 = data.frame(dice(rolls = dice_rolls_6, ndice =
> > num_dice_6, sides = dice_sides_6, plot.it = FALSE))
> >
> >    #constructing matrix containing results of all dice rolls by month
> >    prob_matrix_6 <- data.frame(matrix(dice_simul_6[,1], ncol = 12,
> > byrow =
> > TRUE))
> >
> >    #naming each column by it's corresponding month name
> >    colnames(prob_matrix_6) <-
> > c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","D
> > ec")
> >
> >
> >    #assigning each person?s name depending on the number showed in the
> > dice once rolled
> >    for (i in 1:nrow(prob_matrix_6)){
> >      for (j in 1:ncol(prob_matrix_6)){
> >        if (prob_matrix_6[i,j] == 1){
> >          prob_matrix_6[i,j] = "Alice"
> >        }
> >        if (prob_matrix_6[i,j] == 2){
> >          prob_matrix_6[i,j] = "Bob"
> >        }
> >        if (prob_matrix_6[i,j] == 3){
> >          prob_matrix_6[i,j] = "Charlie"
> >        }
> >        if (prob_matrix_6[i,j] == 4){
> >          prob_matrix_6[i,j] = "Don"
> >        }
> >        if (prob_matrix_6[i,j] == 5){
> >          prob_matrix_6[i,j] = "Ellen"
> >        }
> >        if (prob_matrix_6[i,j] == 6){
> >          prob_matrix_6[i,j] = "Fred"
> >        }
> >
> >      }
> >    }
> >
> >    #calculating column  which will have a 1 if trial was successful
> > and a 0 otherwise
> >    prob_matrix_6['success'] <- for (i in 1:nrow(prob_matrix_6)){
> >      if (("Alice" %in% prob_matrix_6[i,]) & ("Bob" %in%
> > prob_matrix_6[i,]) & ("Charlie" %in% prob_matrix_6[i,]) & ("Don" %in%
> > prob_matrix_6[i,]) & ("Ellen" %in% prob_matrix_6[i,]) & ("Fred" %in%
> prob_matrix_6[i,])){
> >        prob_matrix_6[i,13] = 1
> >      }else{
> >        prob_matrix_6[i,13] = 0
> >      }
> >    }
> >
> >    #relabeling column v13 so that its new name is success
> >    colnames(prob_matrix_6)[13] <- "success"
> >
> >
> >    #calculating probability of success
> >
> >    p6 = sum(prob_matrix_6$success)/nrow(prob_matrix_6)
> >    prob_frame_6 <- cbind(prob_frame_6, p6)
> >
> >    k = k + 1
> >
> > }
> >
> > prob_frame_6 <- prob_frame_6[11:20]
> > colnames(prob_frame_6) <-
> > c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10")
> > average_prob_frame_6 <- rowMeans(prob_frame_6) trial_1000000_10_frame
> > <- cbind(prob_frame_6, average_prob_frame_6)
> > final_frame_6 <- trial_1000000_10_frame
> > colnames(final_frame_6) <-
> > c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10",
> > "avg_prob_frame_5")
> >
> > write.csv(final_frame_6, "OneMillion_Trials_Ten_Times_Results.csv")
> > print(final_frame_6)
> > print(paste("The average probability of success when doing 1,000,000
> > trials
> > 10 times is:", average_prob_frame_6))
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mail
> > man_listinfo_r-2Dhelp&d=DwIDaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAs
> > Rzsn7AkP-g&m=wM6IILK-62Cb0r02bfEW05eVb0lndtvSWfuz7gHTlutarVXWwMYm2ucHQ
> > 8zpRTow&s=il9X1N5C_yJqnTaXdQFBZFkG2En_jhiejElnzL__WdA&e=
> > PLEASE do read the posting guide
> > https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.or
> > g_posting-2Dguide.html&d=DwIDaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeA
> > sRzsn7AkP-g&m=wM6IILK-62Cb0r02bfEW05eVb0lndtvSWfuz7gHTlutarVXWwMYm2ucH
> > Q8zpRTow&s=027mAUgUIZGXPwemk-9LCBL8uREpR8MMkM5-4Hf4y5w&e=
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwIDaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=wM6IILK-62Cb0r02bfEW05eVb0lndtvSWfuz7gHTlutarVXWwMYm2ucHQ8zpRTow&s=il9X1N5C_yJqnTaXdQFBZFkG2En_jhiejElnzL__WdA&e=
> PLEASE do read the posting guide
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwIDaQ&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=wM6IILK-62Cb0r02bfEW05eVb0lndtvSWfuz7gHTlutarVXWwMYm2ucHQ8zpRTow&s=027mAUgUIZGXPwemk-9LCBL8uREpR8MMkM5-4Hf4y5w&e=
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From h@m|d200356 @end|ng |rom gm@||@com  Sun Apr 24 22:42:30 2022
From: h@m|d200356 @end|ng |rom gm@||@com (Hamid)
Date: Mon, 25 Apr 2022 01:12:30 +0430
Subject: [R] about correctness of calculated factor scores in robCompositions
Message-ID: <CADXWdGXrFrzwiQWvwWNCTufGv9xO-dxKMNfxHcPKyR7N5CVMBA@mail.gmail.com>

Please have a look at  the factor scores returned from robCompositions
package  in this example:

data(expenditures)
x <- expenditures

 res.rob <- pfa(x, factors=1, score="regression")


according to ?pfa since the covariance  is not specified,
the covariance is estimated from isometric log-ratio transformed data
internally, but the data used for factor analysis are backtransformed
to the clr space.

So the clr transformed data obtain as follows:

# ilr transformation
ilr <- function(x){
x.ilr=matrix(NA,nrow=nrow(x),ncol=ncol(x)-1)
  for (i in 1:ncol(x.ilr)){
    x.ilr[,i]=sqrt((i)/(i+1))*log(((apply(as.matrix(x[,1:i]), 1,
prod))^(1/i))/(x[,i+1]))
  }
return(x.ilr)
}

# construct orthonormal basis: (matrix with ncol(x) rows and ncol(x)-1
columns)
V=matrix(0,nrow=ncol(x),ncol=ncol(x)-1)
for (i in 1:ncol(V)){
  V[1:i,i] <- 1/i
  V[i+1,i] <- (-1)
  V[,i] <- V[,i]*sqrt(i/(i+1))
}
z=ilr(x) #ilr transformed data
y=z%*%t(V) #clr transformed data
now the factor scores using regression method might be calculated as
follows:

 loa<-c(0.970,0.830,0.986,0.876,0.977)  #res.rob object

facscores<- y%*%loa

> head(facscores)
             [,1]
[1,] -0.009485110
[2,]  0.009680645
[3,]  0.008426665
[4,] -0.015401000
[5,] -0.003610644
[6,] -0.004584145

but calling res.rob$scores returns us
head(res.rob$scores)
> head(res.rob$scores)
       Factor1
[1,] -755.2681
[2,]  705.5309
[3,] 4196.5652
[4,] -778.6955
[5,] -628.2141
[6,] -663.4534

So please check am I wrong or there is probably  a bug in the pfa command ?
Yours,
Hamid

	[[alternative HTML version deleted]]


From p@u|bern@|07 @end|ng |rom gm@||@com  Mon Apr 25 02:56:40 2022
From: p@u|bern@|07 @end|ng |rom gm@||@com (Paul Bernal)
Date: Sun, 24 Apr 2022 19:56:40 -0500
Subject: [R] Issues when setting k to 1L
Message-ID: <CAMOcQfNVqZzxD8SUpQL76n+94-kKMyeNR0Lo=wKTxmPDvn9KNg@mail.gmail.com>

Dear Rui,

I made the modification to k <- 1L (see the code below), but I get the
following odd result (maybe I am forgetting to do something):
print(final_frame_6)
        p1 NA NA NA NA NA NA NA NA NA average_prob_frame_6
1 0.437738 NA NA NA NA NA NA NA NA NA                   NA
> print(paste("The average probability of success when doing 1,000,000
single trials is:", average_prob_frame_6))
[1] "The average probability of success when doing 1,000,000 single trials
is: NA"
>

#single 1,000,000 trials

# these two are equal
cnames0 <-
c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
cnames <- month.abb
identical(cnames0, cnames)
# [1] TRUE

# performing 1,000,000 simulations 10 times
num_trials_6 <- 1e6
dice_rolls_6 <- num_trials_6*12
num_dice_6 <- 1
dice_sides_6 <- 6

set.seed(2022)

prob_frame_6 <- as.data.frame(matrix(ncol = 10L, nrow = 1L))
K <- 1L
for(k in seq_len(K)){
  #
  dice_simul_6 <- sample(dice_sides_6, dice_rolls_6, replace = TRUE)
  # constructing matrix containing results of all dice rolls by month
  prob_matrix_6 <- matrix(dice_simul_6, ncol = 12, byrow = TRUE)

  # naming each column by it's corresponding month name
  colnames(prob_matrix_6) <- month.abb

  # calculating column  which will have a 1
  # if trial was successful and a 0 otherwise
  success <- integer(num_trials_6)
  for(i in seq_len(num_trials_6)){
    success[i] <- as.integer(all(1:6 %in% prob_matrix_6[i, ]))
  }

  #calculating probability of success

  p6 <- mean(success)
  prob_frame_6[1, k] <- p6
}

colnames(prob_frame_6) <- sprintf("p%d", seq_len(K))
average_prob_frame_6 <- rowMeans(prob_frame_6)
final_frame_6 <- cbind(prob_frame_6, average_prob_frame_6)

write.csv(final_frame_6, "OneMillion_Trials_Ten_Times_Results.csv")

print(final_frame_6)
print(paste("The average probability of success when doing 1,000,000 single
trials is:", average_prob_frame_6))

	[[alternative HTML version deleted]]


From @v|gro@@ @end|ng |rom ver|zon@net  Mon Apr 25 03:45:49 2022
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Mon, 25 Apr 2022 01:45:49 +0000 (UTC)
Subject: [R] Issues when setting k to 1L
In-Reply-To: <CAMOcQfNVqZzxD8SUpQL76n+94-kKMyeNR0Lo=wKTxmPDvn9KNg@mail.gmail.com>
References: <CAMOcQfNVqZzxD8SUpQL76n+94-kKMyeNR0Lo=wKTxmPDvn9KNg@mail.gmail.com>
Message-ID: <1697459832.504545.1650851149670@mail.yahoo.com>

Try:?average_prob_frame_6 <- rowMeans(prob_frame_6, na.rm=TRUE)
Any NA propagates into calculations to make it NA.
Then again, should there be any NA?



-----Original Message-----
From: Paul Bernal <paulbernal07 at gmail.com>
To: Rui Barradas <ruipbarradas at sapo.pt>; R <r-help at r-project.org>
Sent: Sun, Apr 24, 2022 8:56 pm
Subject: [R] Issues when setting k to 1L

Dear Rui,

I made the modification to k <- 1L (see the code below), but I get the
following odd result (maybe I am forgetting to do something):
print(final_frame_6)
? ? ? ? p1 NA NA NA NA NA NA NA NA NA average_prob_frame_6
1 0.437738 NA NA NA NA NA NA NA NA NA? ? ? ? ? ? ? ? ? NA
> print(paste("The average probability of success when doing 1,000,000
single trials is:", average_prob_frame_6))
[1] "The average probability of success when doing 1,000,000 single trials
is: NA"
>

#single 1,000,000 trials

# these two are equal
cnames0 <-
c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
cnames <- month.abb
identical(cnames0, cnames)
# [1] TRUE

# performing 1,000,000 simulations 10 times
num_trials_6 <- 1e6
dice_rolls_6 <- num_trials_6*12
num_dice_6 <- 1
dice_sides_6 <- 6

set.seed(2022)

prob_frame_6 <- as.data.frame(matrix(ncol = 10L, nrow = 1L))
K <- 1L
for(k in seq_len(K)){
? #
? dice_simul_6 <- sample(dice_sides_6, dice_rolls_6, replace = TRUE)
? # constructing matrix containing results of all dice rolls by month
? prob_matrix_6 <- matrix(dice_simul_6, ncol = 12, byrow = TRUE)

? # naming each column by it's corresponding month name
? colnames(prob_matrix_6) <- month.abb

? # calculating column? which will have a 1
? # if trial was successful and a 0 otherwise
? success <- integer(num_trials_6)
? for(i in seq_len(num_trials_6)){
? ? success[i] <- as.integer(all(1:6 %in% prob_matrix_6[i, ]))
? }

? #calculating probability of success

? p6 <- mean(success)
? prob_frame_6[1, k] <- p6
}

colnames(prob_frame_6) <- sprintf("p%d", seq_len(K))
average_prob_frame_6 <- rowMeans(prob_frame_6)
final_frame_6 <- cbind(prob_frame_6, average_prob_frame_6)

write.csv(final_frame_6, "OneMillion_Trials_Ten_Times_Results.csv")

print(final_frame_6)
print(paste("The average probability of success when doing 1,000,000 single
trials is:", average_prob_frame_6))

??? [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Apr 25 09:11:38 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 25 Apr 2022 08:11:38 +0100
Subject: [R] R Code Execution taking forever
In-Reply-To: <CAMOcQfMHQXVETm_aDnVMt_9ZEGKGdw9XscuZtqEu+4SMXMsgjg@mail.gmail.com>
References: <CAMOcQfN1U-gMbAtM5JA9VLmwyKESPo8NAPs=0gmBrtON5zq0dg@mail.gmail.com>
 <3ea85564-5162-ebcc-3697-73a7df86dcbd@sapo.pt>
 <CAMOcQfO3MVMbkWcQQcQv4CwZgWpNFci9OVqJZZom4i9Ah14FRA@mail.gmail.com>
 <92e4acee-31db-425a-1e33-d057dc1fb280@sapo.pt>
 <CAMOcQfOt3qHO3NvYch1J2u7Y=1obK0Gn8N2fePBjfLWAr_NHkA@mail.gmail.com>
 <39d15320-7f6c-bf54-3e09-801ce4fdcb4c@sapo.pt>
 <CAMOcQfMHQXVETm_aDnVMt_9ZEGKGdw9XscuZtqEu+4SMXMsgjg@mail.gmail.com>
Message-ID: <aa1b5f41-2a21-fe10-5145-7dfaec4dbda2@sapo.pt>

Hello,

You forgot to cc the list.

The bug comes from creating a results data.frame with 10 columns when 
there's only one iteration K. Swap these lines


prob_frame_6 <- as.data.frame(matrix(ncol = 10L, nrow = 1L))
K <- 1


and set ncol = K:


K <- 1L
prob_frame_6 <- as.data.frame(matrix(ncol = K, nrow = 1L))


You now have final_frame_6 with 2 columns, one from prob_frame_6 and the 
other its row mean.
Try also with K <- 2L or another number of iterations.


Hope this helps,

Rui Barradas


?s 01:49 de 25/04/2022, Paul Bernal escreveu:
> Dear Rui,
> 
> Hope you are doing great.
> 
> This is the code based on yours (I modified it to run just 1 time 
> instead of 10 times):
> 
> #performing 1,000,000 single trials
> 
> # these two are equal
> cnames0 <- 
> c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
> cnames <- month.abb
> identical(cnames0, cnames)
> # [1] TRUE
> 
> # performing 1,000,000 simulations 10 times
> num_trials_6 <- 1e6
> dice_rolls_6 <- num_trials_6*12
> num_dice_6 <- 1
> dice_sides_6 <- 6
> 
> set.seed(2022)
> 
> prob_frame_6 <- as.data.frame(matrix(ncol = 10L, nrow = 1L))
> K <- 1
> for(k in seq_len(K)){
>  ? #
>  ? dice_simul_6 <- sample(dice_sides_6, dice_rolls_6, replace = TRUE)
>  ? # constructing matrix containing results of all dice rolls by month
>  ? prob_matrix_6 <- matrix(dice_simul_6, ncol = 12, byrow = TRUE)
> 
>  ? # naming each column by it's corresponding month name
>  ? colnames(prob_matrix_6) <- month.abb
> 
>  ? # calculating column ?which will have a 1
>  ? # if trial was successful and a 0 otherwise
>  ? success <- integer(num_trials_6)
>  ? for(i in seq_len(num_trials_6)){
>  ? ? success[i] <- as.integer(all(1:6 %in% prob_matrix_6[i, ]))
>  ? }
> 
>  ? #calculating probability of success
> 
>  ? p6 <- mean(success)
>  ? prob_frame_6[1, k] <- p6
> }
> 
> colnames(prob_frame_6) <- sprintf("p%d", seq_len(K))
> average_prob_frame_6 <- rowMeans(prob_frame_6)
> final_frame_6 <- cbind(prob_frame_6, average_prob_frame_6)
> 
> write.csv(final_frame_6, "OneMillion_Trials_Ten_Times_Results.csv")
> 
> print(final_frame_6)
> print(paste("The average probability of success when doing 1,000,000 
> single trials is:", average_prob_frame_6))
> 
> however, for some reason I get this result:
> 
>  > print(final_frame_6)
>  ? ? ? ? p1 NA NA NA NA NA NA NA NA NA average_prob_frame_6
> 1 0.437738 NA NA NA NA NA NA NA NA NA ? ? ? ? ? ? ? ? ? NA
>  > print(paste("The average probability of success when doing 1,000,000 
> single trials is:", average_prob_frame_6))
> [1] "The average probability of success when doing 1,000,000 single 
> trials is: NA"
> 
> Any idea of why this could be happening?
> 
> Best,
> Paul
> 
> 
> 
> El dom, 24 abr 2022 a las 9:38, Rui Barradas (<ruipbarradas at sapo.pt 
> <mailto:ruipbarradas at sapo.pt>>) escribi?:
> 
>     Hello,
> 
>     Thanks for the link, the package is TeachingDemos, it's the function
>     that's named dice. And the source code shows that it calls sample()
>     in a
>     way similar to mine, so the code I posted should give approximately the
>     same results.
> 
>     To run just once, change to K <- 1L, right before the main for loop.
> 
>     Hope this helps,
> 
>     Rui Barradas
> 
>     ?s 15:24 de 24/04/2022, Paul Bernal escreveu:
>      > Dear friend Rui,
>      >
>      > Thank you so much for your extremely valuable help.
>      >
>      > This is the dice function I used:
>      >
>     https://www.rdocumentation.org/packages/TeachingDemos/versions/2.12/topics/dice
>     <https://www.rdocumentation.org/packages/TeachingDemos/versions/2.12/topics/dice>
> 
>      >
>     <https://www.rdocumentation.org/packages/TeachingDemos/versions/2.12/topics/dice
>     <https://www.rdocumentation.org/packages/TeachingDemos/versions/2.12/topics/dice>>
>      >
>      > One question, how would I modify your code to run it for
>     1,000,000 rolls
>      > 1 time?
>      >
>      > Best,
>      > Paul
>      >
>      > El dom, 24 abr 2022 a las 8:58, Rui Barradas
>     (<ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>
>      > <mailto:ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>>>)
>     escribi?:
>      >
>      >? ? ?Hello,
>      >
>      >? ? ?I still can't find the package dice you are using, it's not
>     the one on
>      >? ? ?CRAN, that one only has two functions, like I said earlier.
>      >
>      >? ? ?Anyway, I have replaced function dice(9 by a call to sample().
>      >? ? ?And simplified the code a lot. It takes half a minute to run the
>      >? ? ?1,000,000 simulations K = 10 times (upper case K).
>      >? ? ?See if this is what you want.
>      >
>      >
>      >? ? ?# these two are equal
>      >? ? ?cnames0 <-
>      >   
>      ?c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
>      >? ? ?cnames <- month.abb
>      >? ? ?identical(cnames0, cnames)
>      >? ? ?# [1] TRUE
>      >
>      >? ? ?# performing 1,000,000 simulations 10 times
>      >? ? ?num_trials_6 <- 1e6
>      >? ? ?dice_rolls_6 <- num_trials_6*12
>      >? ? ?num_dice_6 <- 1
>      >? ? ?dice_sides_6 <- 6
>      >
>      >? ? ?set.seed(2022)
>      >
>      >? ? ?prob_frame_6 <- as.data.frame(matrix(ncol = 10L, nrow = 1L))
>      >? ? ?K <- 10L
>      >? ? ?for(k in seq_len(K)){
>      >? ? ? ? ?#
>      >? ? ? ? ?dice_simul_6 <- sample(dice_sides_6, dice_rolls_6,
>     replace = TRUE)
>      >? ? ? ? ?# constructing matrix containing results of all dice
>     rolls by month
>      >? ? ? ? ?prob_matrix_6 <- matrix(dice_simul_6, ncol = 12, byrow =
>     TRUE)
>      >
>      >? ? ? ? ?# naming each column by it's corresponding month name
>      >? ? ? ? ?colnames(prob_matrix_6) <- month.abb
>      >
>      >? ? ? ? ?# calculating column? which will have a 1
>      >? ? ? ? ?# if trial was successful and a 0 otherwise
>      >? ? ? ? ?success <- integer(num_trials_6)
>      >? ? ? ? ?for(i in seq_len(num_trials_6)){
>      >? ? ? ? ? ?success[i] <- as.integer(all(1:6 %in% prob_matrix_6[i, ]))
>      >? ? ? ? ?}
>      >
>      >? ? ? ? ?#calculating probability of success
>      >
>      >? ? ? ? ?p6 <- mean(success)
>      >? ? ? ? ?prob_frame_6[1, k] <- p6
>      >? ? ?}
>      >
>      >? ? ?colnames(prob_frame_6) <- sprintf("p%d", seq_len(K))
>      >? ? ?average_prob_frame_6 <- rowMeans(prob_frame_6)
>      >? ? ?final_frame_6 <- cbind(prob_frame_6, average_prob_frame_6)
>      >
>      >? ? ?write.csv(final_frame_6,
>     "OneMillion_Trials_Ten_Times_Results.csv")
>      >
>      >? ? ?print(final_frame_6)
>      >? ? ?print(paste("The average probability of success when doing
>     1,000,000
>      >? ? ?trials 10 times is:", average_prob_frame_6))
>      >
>      >
>      >? ? ?Hope this helps,
>      >
>      >? ? ?Rui Barradas
>      >
>      >? ? ??s 12:14 de 24/04/2022, Paul Bernal escreveu:
>      >? ? ? > Dear Rui,
>      >? ? ? >
>      >? ? ? > There is a package called dice, that package is the one I am
>      >? ? ?using. This
>      >? ? ? > package has a funci?n called dice.
>      >? ? ? >
>      >? ? ? > Best,
>      >? ? ? >
>      >? ? ? > Paul
>      >? ? ? >
>      >? ? ? > El El dom, 24 de abr. de 2022 a la(s) 4:43 a.?m., Rui Barradas
>      >? ? ? > <ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>
>     <mailto:ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>>
>      >? ? ?<mailto:ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>
>     <mailto:ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>>>> escribi?:
>      >? ? ? >
>      >? ? ? >? ? ?Hello,
>      >? ? ? >
>      >? ? ? >? ? ?I'm having trouble running the code, where does
>     function dice
>      >? ? ?come from?
>      >? ? ? >? ? ?CRAN package dice only has two functions,
>      >? ? ? >
>      >? ? ? >? ? ?getEventProb
>      >? ? ? >? ? ?getSumProbs
>      >? ? ? >
>      >? ? ? >? ? ?not a function dice.
>      >? ? ? >
>      >? ? ? >? ? ?Can you post a link to where the package/function can
>     be found?
>      >? ? ? >
>      >? ? ? >? ? ?Rui Barradas
>      >? ? ? >
>      >? ? ? >
>      >? ? ? >? ? ??s 02:00 de 24/04/2022, Paul Bernal escreveu:
>      >? ? ? >? ? ? > Dear R friends,
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > Hope you are doing great. The reason why I am
>     contacting
>      >? ? ?you all, is
>      >? ? ? >? ? ? > because the code I am sharing with you takes
>     forever. It
>      >? ? ?started
>      >? ? ? >? ? ?running at
>      >? ? ? >? ? ? > 2:00 AM today, and it's 7:52 PM and is still
>     running (see
>      >? ? ?code at
>      >? ? ? >? ? ?the end
>      >? ? ? >? ? ? > of this mail).
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > I am using Rx64? 4.1.2, and the code is being
>     executed in
>      >? ? ? >? ? ?RStudio. The
>      >? ? ? >? ? ? > RStudio version I am currently using is Version
>     2022.02.0
>      >? ? ?Build 443
>      >? ? ? >? ? ? > "Prairie Trillium" Release (9f796939, 2022-02-16)
>     for Windows.
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > My PC specs:
>      >? ? ? >? ? ? > Processor: Intel(R) Core(TM) i5-10310U CPU @ 1.70 GHz
>      >? ? ? >? ? ? > Installed RAM: 16.0 GB (15.6 GB usable)
>      >? ? ? >? ? ? > System type: 64-bit operating system, x64-based
>     processor
>      >? ? ? >? ? ? > Local Disc(C:) Free Space: 274 GB
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > I am wondering if there is/are a set of system
>     variable(s) or
>      >? ? ? >? ? ?something I
>      >? ? ? >? ? ? > could do to improve the performance of the program.
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > It is really odd this code has taken this much (and
>     it is
>      >? ? ?still
>      >? ? ? >? ? ?running).
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > Any help and/or guidance would be greatly appreciated.
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > Best regards,
>      >? ? ? >? ? ? > Paul
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > #performing 1,000,000 simulations 10 times
>      >? ? ? >? ? ? > num_trials_6 = 1000000
>      >? ? ? >? ? ? > dice_rolls_6 = num_trials_6*12
>      >? ? ? >? ? ? > num_dice_6 = 1
>      >? ? ? >? ? ? > dice_sides_6 = 6
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > prob_frame_6 <- data.frame(matrix(ncol = 10, nrow = 1))
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > k <- 0
>      >? ? ? >? ? ? > while(k < 10){
>      >? ? ? >? ? ? >? ? dice_simul_6 = data.frame(dice(rolls = dice_rolls_6,
>      >? ? ?ndice =
>      >? ? ? >? ? ?num_dice_6,
>      >? ? ? >? ? ? > sides = dice_sides_6, plot.it <http://plot.it>
>     <http://plot.it <http://plot.it>>
>      >? ? ?<http://plot.it <http://plot.it> <http://plot.it
>     <http://plot.it>>> = FALSE))
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? #constructing matrix containing results of all dice
>      >? ? ?rolls by month
>      >? ? ? >? ? ? >? ? prob_matrix_6 <-
>     data.frame(matrix(dice_simul_6[,1], ncol =
>      >? ? ? >? ? ?12, byrow =
>      >? ? ? >? ? ? > TRUE))
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? #naming each column by it's corresponding month name
>      >? ? ? >? ? ? >? ? colnames(prob_matrix_6) <-
>      >? ? ? >? ? ? >
>      >? ? ? >
>      >     
>      ?c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? #assigning each person?s name depending on the
>     number
>      >? ? ?showed
>      >? ? ? >? ? ?in the dice
>      >? ? ? >? ? ? > once rolled
>      >? ? ? >? ? ? >? ? for (i in 1:nrow(prob_matrix_6)){
>      >? ? ? >? ? ? >? ? ? for (j in 1:ncol(prob_matrix_6)){
>      >? ? ? >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 1){
>      >? ? ? >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Alice"
>      >? ? ? >? ? ? >? ? ? ? }
>      >? ? ? >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 2){
>      >? ? ? >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Bob"
>      >? ? ? >? ? ? >? ? ? ? }
>      >? ? ? >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 3){
>      >? ? ? >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Charlie"
>      >? ? ? >? ? ? >? ? ? ? }
>      >? ? ? >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 4){
>      >? ? ? >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Don"
>      >? ? ? >? ? ? >? ? ? ? }
>      >? ? ? >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 5){
>      >? ? ? >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Ellen"
>      >? ? ? >? ? ? >? ? ? ? }
>      >? ? ? >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 6){
>      >? ? ? >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Fred"
>      >? ? ? >? ? ? >? ? ? ? }
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? }
>      >? ? ? >? ? ? >? ? }
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? #calculating column? which will have a 1 if
>     trial was
>      >? ? ? >? ? ?successful and a 0
>      >? ? ? >? ? ? > otherwise
>      >? ? ? >? ? ? >? ? prob_matrix_6['success'] <- for (i in
>      >? ? ?1:nrow(prob_matrix_6)){
>      >? ? ? >? ? ? >? ? ? if (("Alice" %in% prob_matrix_6[i,]) & ("Bob" %in%
>      >? ? ? >? ? ?prob_matrix_6[i,]) &
>      >? ? ? >? ? ? > ("Charlie" %in% prob_matrix_6[i,]) & ("Don" %in%
>      >? ? ?prob_matrix_6[i,]) &
>      >? ? ? >? ? ? > ("Ellen" %in% prob_matrix_6[i,]) & ("Fred" %in%
>      >? ? ?prob_matrix_6[i,])){
>      >? ? ? >? ? ? >? ? ? ? prob_matrix_6[i,13] = 1
>      >? ? ? >? ? ? >? ? ? }else{
>      >? ? ? >? ? ? >? ? ? ? prob_matrix_6[i,13] = 0
>      >? ? ? >? ? ? >? ? ? }
>      >? ? ? >? ? ? >? ? }
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? #relabeling column v13 so that its new name is
>     success
>      >? ? ? >? ? ? >? ? colnames(prob_matrix_6)[13] <- "success"
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? #calculating probability of success
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? p6 = sum(prob_matrix_6$success)/nrow(prob_matrix_6)
>      >? ? ? >? ? ? >? ? prob_frame_6 <- cbind(prob_frame_6, p6)
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? k = k + 1
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > }
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > prob_frame_6 <- prob_frame_6[11:20]
>      >? ? ? >? ? ? > colnames(prob_frame_6) <-
>      >? ? ? >? ? ? > c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10")
>      >? ? ? >? ? ? > average_prob_frame_6 <- rowMeans(prob_frame_6)
>      >? ? ? >? ? ? > trial_1000000_10_frame <- cbind(prob_frame_6,
>      >? ? ?average_prob_frame_6)
>      >? ? ? >? ? ? > final_frame_6 <- trial_1000000_10_frame
>      >? ? ? >? ? ? > colnames(final_frame_6) <-
>      >? ? ? >? ? ? > c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10",
>      >? ? ? >? ? ?"avg_prob_frame_5")
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > write.csv(final_frame_6,
>      >? ? ?"OneMillion_Trials_Ten_Times_Results.csv")
>      >? ? ? >? ? ? > print(final_frame_6)
>      >? ? ? >? ? ? > print(paste("The average probability of success
>     when doing
>      >? ? ? >? ? ?1,000,000 trials
>      >? ? ? >? ? ? > 10 times is:", average_prob_frame_6))
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? ?[[alternative HTML version deleted]]
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > ______________________________________________
>      >? ? ? >? ? ? > R-help at r-project.org <mailto:R-help at r-project.org>
>     <mailto:R-help at r-project.org <mailto:R-help at r-project.org>>
>      >? ? ?<mailto:R-help at r-project.org <mailto:R-help at r-project.org>
>     <mailto:R-help at r-project.org <mailto:R-help at r-project.org>>> mailing
>     list
>      >? ? ? >? ? ?-- To UNSUBSCRIBE and more, see
>      >? ? ? >? ? ? > https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>      >? ? ?<https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>>
>      >? ? ? >? ? ?<https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>      >? ? ?<https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>>>
>      >? ? ? >? ? ? > PLEASE do read the posting guide
>      >? ? ? > http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>      >? ? ?<http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>>
>      >? ? ? >? ? ?<http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>      >? ? ?<http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>>>
>      >? ? ? >? ? ? > and provide commented, minimal, self-contained,
>      >? ? ?reproducible code.
>      >? ? ? >
>      >
>


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Apr 25 09:15:09 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 25 Apr 2022 08:15:09 +0100
Subject: [R] Issues when setting k to 1L
In-Reply-To: <1697459832.504545.1650851149670@mail.yahoo.com>
References: <CAMOcQfNVqZzxD8SUpQL76n+94-kKMyeNR0Lo=wKTxmPDvn9KNg@mail.gmail.com>
 <1697459832.504545.1650851149670@mail.yahoo.com>
Message-ID: <36944176-db4c-088a-6c10-2408902ddc75@sapo.pt>

Hello,

Inliner.

?s 02:45 de 25/04/2022, Avi Gross via R-help escreveu:
> Try:?average_prob_frame_6 <- rowMeans(prob_frame_6, na.rm=TRUE)
> Any NA propagates into calculations to make it NA.
> Then again, should there be any NA?

Yes, na.rm = TRUE is a good idea.
And no, there should be no NA's in prob_frame_6.


Rui Barradas

> 
> 
> 
> -----Original Message-----
> From: Paul Bernal <paulbernal07 at gmail.com>
> To: Rui Barradas <ruipbarradas at sapo.pt>; R <r-help at r-project.org>
> Sent: Sun, Apr 24, 2022 8:56 pm
> Subject: [R] Issues when setting k to 1L
> 
> Dear Rui,
> 
> I made the modification to k <- 1L (see the code below), but I get the
> following odd result (maybe I am forgetting to do something):
> print(final_frame_6)
>  ? ? ? ? p1 NA NA NA NA NA NA NA NA NA average_prob_frame_6
> 1 0.437738 NA NA NA NA NA NA NA NA NA? ? ? ? ? ? ? ? ? NA
>> print(paste("The average probability of success when doing 1,000,000
> single trials is:", average_prob_frame_6))
> [1] "The average probability of success when doing 1,000,000 single trials
> is: NA"
>>
> 
> #single 1,000,000 trials
> 
> # these two are equal
> cnames0 <-
> c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
> cnames <- month.abb
> identical(cnames0, cnames)
> # [1] TRUE
> 
> # performing 1,000,000 simulations 10 times
> num_trials_6 <- 1e6
> dice_rolls_6 <- num_trials_6*12
> num_dice_6 <- 1
> dice_sides_6 <- 6
> 
> set.seed(2022)
> 
> prob_frame_6 <- as.data.frame(matrix(ncol = 10L, nrow = 1L))
> K <- 1L
> for(k in seq_len(K)){
>  ? #
>  ? dice_simul_6 <- sample(dice_sides_6, dice_rolls_6, replace = TRUE)
>  ? # constructing matrix containing results of all dice rolls by month
>  ? prob_matrix_6 <- matrix(dice_simul_6, ncol = 12, byrow = TRUE)
> 
>  ? # naming each column by it's corresponding month name
>  ? colnames(prob_matrix_6) <- month.abb
> 
>  ? # calculating column? which will have a 1
>  ? # if trial was successful and a 0 otherwise
>  ? success <- integer(num_trials_6)
>  ? for(i in seq_len(num_trials_6)){
>  ? ? success[i] <- as.integer(all(1:6 %in% prob_matrix_6[i, ]))
>  ? }
> 
>  ? #calculating probability of success
> 
>  ? p6 <- mean(success)
>  ? prob_frame_6[1, k] <- p6
> }
> 
> colnames(prob_frame_6) <- sprintf("p%d", seq_len(K))
> average_prob_frame_6 <- rowMeans(prob_frame_6)
> final_frame_6 <- cbind(prob_frame_6, average_prob_frame_6)
> 
> write.csv(final_frame_6, "OneMillion_Trials_Ten_Times_Results.csv")
> 
> print(final_frame_6)
> print(paste("The average probability of success when doing 1,000,000 single
> trials is:", average_prob_frame_6))
> 
>  ??? [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Apr 25 09:25:28 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 25 Apr 2022 08:25:28 +0100
Subject: [R] Issues when setting k to 1L
In-Reply-To: <36944176-db4c-088a-6c10-2408902ddc75@sapo.pt>
References: <CAMOcQfNVqZzxD8SUpQL76n+94-kKMyeNR0Lo=wKTxmPDvn9KNg@mail.gmail.com>
 <1697459832.504545.1650851149670@mail.yahoo.com>
 <36944176-db4c-088a-6c10-2408902ddc75@sapo.pt>
Message-ID: <87a1c3c6-6993-f5e8-3afd-91468dd28d05@sapo.pt>

Hello,

Sorry, it's "inline", the final "r" is a letter next to the "e", a mistake.

Rui Barradas

?s 08:15 de 25/04/2022, Rui Barradas escreveu:
> Hello,
> 
> Inliner.
> 
> ?s 02:45 de 25/04/2022, Avi Gross via R-help escreveu:
>> Try:?average_prob_frame_6 <- rowMeans(prob_frame_6, na.rm=TRUE)
>> Any NA propagates into calculations to make it NA.
>> Then again, should there be any NA?
> 
> Yes, na.rm = TRUE is a good idea.
> And no, there should be no NA's in prob_frame_6.
> 
> 
> Rui Barradas
> 
>>
>>
>>
>> -----Original Message-----
>> From: Paul Bernal <paulbernal07 at gmail.com>
>> To: Rui Barradas <ruipbarradas at sapo.pt>; R <r-help at r-project.org>
>> Sent: Sun, Apr 24, 2022 8:56 pm
>> Subject: [R] Issues when setting k to 1L
>>
>> Dear Rui,
>>
>> I made the modification to k <- 1L (see the code below), but I get the
>> following odd result (maybe I am forgetting to do something):
>> print(final_frame_6)
>> ?? ? ? ? p1 NA NA NA NA NA NA NA NA NA average_prob_frame_6
>> 1 0.437738 NA NA NA NA NA NA NA NA NA? ? ? ? ? ? ? ? ? NA
>>> print(paste("The average probability of success when doing 1,000,000
>> single trials is:", average_prob_frame_6))
>> [1] "The average probability of success when doing 1,000,000 single 
>> trials
>> is: NA"
>>>
>>
>> #single 1,000,000 trials
>>
>> # these two are equal
>> cnames0 <-
>> c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec") 
>>
>> cnames <- month.abb
>> identical(cnames0, cnames)
>> # [1] TRUE
>>
>> # performing 1,000,000 simulations 10 times
>> num_trials_6 <- 1e6
>> dice_rolls_6 <- num_trials_6*12
>> num_dice_6 <- 1
>> dice_sides_6 <- 6
>>
>> set.seed(2022)
>>
>> prob_frame_6 <- as.data.frame(matrix(ncol = 10L, nrow = 1L))
>> K <- 1L
>> for(k in seq_len(K)){
>> ?? #
>> ?? dice_simul_6 <- sample(dice_sides_6, dice_rolls_6, replace = TRUE)
>> ?? # constructing matrix containing results of all dice rolls by month
>> ?? prob_matrix_6 <- matrix(dice_simul_6, ncol = 12, byrow = TRUE)
>>
>> ?? # naming each column by it's corresponding month name
>> ?? colnames(prob_matrix_6) <- month.abb
>>
>> ?? # calculating column? which will have a 1
>> ?? # if trial was successful and a 0 otherwise
>> ?? success <- integer(num_trials_6)
>> ?? for(i in seq_len(num_trials_6)){
>> ?? ? success[i] <- as.integer(all(1:6 %in% prob_matrix_6[i, ]))
>> ?? }
>>
>> ?? #calculating probability of success
>>
>> ?? p6 <- mean(success)
>> ?? prob_frame_6[1, k] <- p6
>> }
>>
>> colnames(prob_frame_6) <- sprintf("p%d", seq_len(K))
>> average_prob_frame_6 <- rowMeans(prob_frame_6)
>> final_frame_6 <- cbind(prob_frame_6, average_prob_frame_6)
>>
>> write.csv(final_frame_6, "OneMillion_Trials_Ten_Times_Results.csv")
>>
>> print(final_frame_6)
>> print(paste("The average probability of success when doing 1,000,000 
>> single
>> trials is:", average_prob_frame_6))
>>
>> ???? [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Apr 25 09:41:15 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 25 Apr 2022 08:41:15 +0100
Subject: [R] R Code Execution taking forever
In-Reply-To: <CAMOcQfPbGQZdk81XTVGr7CJcgTvicVgeq7O7X+DK=wtr=GW2RQ@mail.gmail.com>
References: <CAMOcQfN1U-gMbAtM5JA9VLmwyKESPo8NAPs=0gmBrtON5zq0dg@mail.gmail.com>
 <3ea85564-5162-ebcc-3697-73a7df86dcbd@sapo.pt>
 <CAMOcQfO3MVMbkWcQQcQv4CwZgWpNFci9OVqJZZom4i9Ah14FRA@mail.gmail.com>
 <92e4acee-31db-425a-1e33-d057dc1fb280@sapo.pt>
 <CAMOcQfOt3qHO3NvYch1J2u7Y=1obK0Gn8N2fePBjfLWAr_NHkA@mail.gmail.com>
 <39d15320-7f6c-bf54-3e09-801ce4fdcb4c@sapo.pt>
 <CAMOcQfMHQXVETm_aDnVMt_9ZEGKGdw9XscuZtqEu+4SMXMsgjg@mail.gmail.com>
 <aa1b5f41-2a21-fe10-5145-7dfaec4dbda2@sapo.pt>
 <CAMOcQfPbGQZdk81XTVGr7CJcgTvicVgeq7O7X+DK=wtr=GW2RQ@mail.gmail.com>
Message-ID: <27c2ccd2-dfd6-f75b-9dc5-47ae647e5c40@sapo.pt>

Hello,

Yes, that's it.
Now the results dataframe prob_frame_6  is created with the right number 
of columns, this number depends on the number of iterations K. Before it 
would always have 10 columns.

In the example run below I have timed the code with K <- 20L and changed 
the final print instruction a bit to make it more general purpose.



system.time({

   options(width=205)

   # these two are equal
   cnames0 <- 
c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
   cnames <- month.abb
   identical(cnames0, cnames)
   # [1] TRUE

   # performing 1,000,000 simulations 10 times
   num_trials_6 <- 1e6
   dice_rolls_6 <- num_trials_6*12
   num_dice_6 <- 1
   dice_sides_6 <- 6

   set.seed(2022)

   K <- 20L
   prob_frame_6 <- as.data.frame(matrix(ncol = K, nrow = 1L))

   for(k in seq_len(K)){
     #
     dice_simul_6 <- sample(dice_sides_6, dice_rolls_6, replace = TRUE)
     # constructing matrix containing results of all dice rolls by month
     prob_matrix_6 <- matrix(dice_simul_6, ncol = 12, byrow = TRUE)

     # naming each column by it's corresponding month name
     colnames(prob_matrix_6) <- month.abb

     # calculating column  which will have a 1
     # if trial was successful and a 0 otherwise
     success <- integer(num_trials_6)
     for(i in seq_len(num_trials_6)){
       success[i] <- as.integer(all(1:6 %in% prob_matrix_6[i, ]))
     }

     #calculating probability of success

     p6 <- mean(success)
     prob_frame_6[1, k] <- p6
   }

   colnames(prob_frame_6) <- sprintf("p%d", seq_len(K))
   average_prob_frame_6 <- rowMeans(prob_frame_6)
   final_frame_6 <- cbind(prob_frame_6, average_prob_frame_6)

   write.csv(final_frame_6, "OneMillion_Trials_Ten_Times_Results.csv")

   print(final_frame_6)
   fmt <- "The average probability of success when doing %s trials %d 
times is: %0.5g"
   txt <- sprintf(fmt, formatC(num_trials_6, format = "fg", big.mark = 
","), K, average_prob_frame_6)
   print(txt)
})
#>         p1       p2       p3       p4       p5       p6       p7 
   p8       p9      p10      p11      p12      p13      p14      p15 
   p16     p17      p18      p19      p20 average_prob_frame_6
#> 1 0.437738 0.438101 0.438051 0.437195 0.437623 0.437977 0.437828 
0.437546 0.437663 0.438468 0.437435 0.438332 0.438678 0.438268 0.438047 
0.438817 0.43817 0.437762 0.438403 0.437472            0.4379787
#> [1] "The average probability of success when doing 1,000,000 trials 
20 times is: 0.43798"
#>    user  system elapsed
#>   62.25    0.44   62.71


Hope this helps,

Rui Barradas

?s 08:24 de 25/04/2022, Paul Bernal escreveu:
> Dear friend Rui,
> 
> So, if I understood correctly, I should do this:
> 
> K <- 1L
> prob_frame_6 <- as.data.frame(matrix(ncol = K, nrow = 1L))
> 
> Instead of this:
> 
> prob_frame_6 <- as.data.frame(matrix(ncol = 10L, nrow = 1L))
> K <- 1
> 
> Right?
> 
> Cheers,
> Paul
> 
> Do I should do this:
> 
> El El lun, 25 de abr. de 2022 a la(s) 2:11 a.?m., Rui Barradas 
> <ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>> escribi?:
> 
>     Hello,
> 
>     You forgot to cc the list.
> 
>     The bug comes from creating a results data.frame with 10 columns when
>     there's only one iteration K. Swap these lines
> 
> 
>     prob_frame_6 <- as.data.frame(matrix(ncol = 10L, nrow = 1L))
>     K <- 1
> 
> 
>     and set ncol = K:
> 
> 
>     K <- 1L
>     prob_frame_6 <- as.data.frame(matrix(ncol = K, nrow = 1L))
> 
> 
>     You now have final_frame_6 with 2 columns, one from prob_frame_6 and
>     the
>     other its row mean.
>     Try also with K <- 2L or another number of iterations.
> 
> 
>     Hope this helps,
> 
>     Rui Barradas
> 
> 
>     ?s 01:49 de 25/04/2022, Paul Bernal escreveu:
>      > Dear Rui,
>      >
>      > Hope you are doing great.
>      >
>      > This is the code based on yours (I modified it to run just 1 time
>      > instead of 10 times):
>      >
>      > #performing 1,000,000 single trials
>      >
>      > # these two are equal
>      > cnames0 <-
>      >
>     c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
>      > cnames <- month.abb
>      > identical(cnames0, cnames)
>      > # [1] TRUE
>      >
>      > # performing 1,000,000 simulations 10 times
>      > num_trials_6 <- 1e6
>      > dice_rolls_6 <- num_trials_6*12
>      > num_dice_6 <- 1
>      > dice_sides_6 <- 6
>      >
>      > set.seed(2022)
>      >
>      > prob_frame_6 <- as.data.frame(matrix(ncol = 10L, nrow = 1L))
>      > K <- 1
>      > for(k in seq_len(K)){
>      >? ? #
>      >? ? dice_simul_6 <- sample(dice_sides_6, dice_rolls_6, replace = TRUE)
>      >? ? # constructing matrix containing results of all dice rolls by
>     month
>      >? ? prob_matrix_6 <- matrix(dice_simul_6, ncol = 12, byrow = TRUE)
>      >
>      >? ? # naming each column by it's corresponding month name
>      >? ? colnames(prob_matrix_6) <- month.abb
>      >
>      >? ? # calculating column ?which will have a 1
>      >? ? # if trial was successful and a 0 otherwise
>      >? ? success <- integer(num_trials_6)
>      >? ? for(i in seq_len(num_trials_6)){
>      >? ? ? success[i] <- as.integer(all(1:6 %in% prob_matrix_6[i, ]))
>      >? ? }
>      >
>      >? ? #calculating probability of success
>      >
>      >? ? p6 <- mean(success)
>      >? ? prob_frame_6[1, k] <- p6
>      > }
>      >
>      > colnames(prob_frame_6) <- sprintf("p%d", seq_len(K))
>      > average_prob_frame_6 <- rowMeans(prob_frame_6)
>      > final_frame_6 <- cbind(prob_frame_6, average_prob_frame_6)
>      >
>      > write.csv(final_frame_6, "OneMillion_Trials_Ten_Times_Results.csv")
>      >
>      > print(final_frame_6)
>      > print(paste("The average probability of success when doing 1,000,000
>      > single trials is:", average_prob_frame_6))
>      >
>      > however, for some reason I get this result:
>      >
>      >? > print(final_frame_6)
>      >? ? ? ? ? p1 NA NA NA NA NA NA NA NA NA average_prob_frame_6
>      > 1 0.437738 NA NA NA NA NA NA NA NA NA ? ? ? ? ? ? ? ? ? NA
>      >? > print(paste("The average probability of success when doing
>     1,000,000
>      > single trials is:", average_prob_frame_6))
>      > [1] "The average probability of success when doing 1,000,000 single
>      > trials is: NA"
>      >
>      > Any idea of why this could be happening?
>      >
>      > Best,
>      > Paul
>      >
>      >
>      >
>      > El dom, 24 abr 2022 a las 9:38, Rui Barradas
>     (<ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>
>      > <mailto:ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>>>)
>     escribi?:
>      >
>      >? ? ?Hello,
>      >
>      >? ? ?Thanks for the link, the package is TeachingDemos, it's the
>     function
>      >? ? ?that's named dice. And the source code shows that it calls
>     sample()
>      >? ? ?in a
>      >? ? ?way similar to mine, so the code I posted should give
>     approximately the
>      >? ? ?same results.
>      >
>      >? ? ?To run just once, change to K <- 1L, right before the main
>     for loop.
>      >
>      >? ? ?Hope this helps,
>      >
>      >? ? ?Rui Barradas
>      >
>      >? ? ??s 15:24 de 24/04/2022, Paul Bernal escreveu:
>      >? ? ? > Dear friend Rui,
>      >? ? ? >
>      >? ? ? > Thank you so much for your extremely valuable help.
>      >? ? ? >
>      >? ? ? > This is the dice function I used:
>      >? ? ? >
>      >
>     https://www.rdocumentation.org/packages/TeachingDemos/versions/2.12/topics/dice
>     <https://www.rdocumentation.org/packages/TeachingDemos/versions/2.12/topics/dice>
>      >   
>      ?<https://www.rdocumentation.org/packages/TeachingDemos/versions/2.12/topics/dice <https://www.rdocumentation.org/packages/TeachingDemos/versions/2.12/topics/dice>>
>      >
>      >? ? ? >
>      >   
>      ?<https://www.rdocumentation.org/packages/TeachingDemos/versions/2.12/topics/dice <https://www.rdocumentation.org/packages/TeachingDemos/versions/2.12/topics/dice>
>      >   
>      ?<https://www.rdocumentation.org/packages/TeachingDemos/versions/2.12/topics/dice <https://www.rdocumentation.org/packages/TeachingDemos/versions/2.12/topics/dice>>>
>      >? ? ? >
>      >? ? ? > One question, how would I modify your code to run it for
>      >? ? ?1,000,000 rolls
>      >? ? ? > 1 time?
>      >? ? ? >
>      >? ? ? > Best,
>      >? ? ? > Paul
>      >? ? ? >
>      >? ? ? > El dom, 24 abr 2022 a las 8:58, Rui Barradas
>      >? ? ?(<ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>
>     <mailto:ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>>
>      >? ? ? > <mailto:ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>
>     <mailto:ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>>>>)
>      >? ? ?escribi?:
>      >? ? ? >
>      >? ? ? >? ? ?Hello,
>      >? ? ? >
>      >? ? ? >? ? ?I still can't find the package dice you are using,
>     it's not
>      >? ? ?the one on
>      >? ? ? >? ? ?CRAN, that one only has two functions, like I said
>     earlier.
>      >? ? ? >
>      >? ? ? >? ? ?Anyway, I have replaced function dice(9 by a call to
>     sample().
>      >? ? ? >? ? ?And simplified the code a lot. It takes half a minute
>     to run the
>      >? ? ? >? ? ?1,000,000 simulations K = 10 times (upper case K).
>      >? ? ? >? ? ?See if this is what you want.
>      >? ? ? >
>      >? ? ? >
>      >? ? ? >? ? ?# these two are equal
>      >? ? ? >? ? ?cnames0 <-
>      >? ? ? >
>      >     
>      ?c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
>      >? ? ? >? ? ?cnames <- month.abb
>      >? ? ? >? ? ?identical(cnames0, cnames)
>      >? ? ? >? ? ?# [1] TRUE
>      >? ? ? >
>      >? ? ? >? ? ?# performing 1,000,000 simulations 10 times
>      >? ? ? >? ? ?num_trials_6 <- 1e6
>      >? ? ? >? ? ?dice_rolls_6 <- num_trials_6*12
>      >? ? ? >? ? ?num_dice_6 <- 1
>      >? ? ? >? ? ?dice_sides_6 <- 6
>      >? ? ? >
>      >? ? ? >? ? ?set.seed(2022)
>      >? ? ? >
>      >? ? ? >? ? ?prob_frame_6 <- as.data.frame(matrix(ncol = 10L, nrow
>     = 1L))
>      >? ? ? >? ? ?K <- 10L
>      >? ? ? >? ? ?for(k in seq_len(K)){
>      >? ? ? >? ? ? ? ?#
>      >? ? ? >? ? ? ? ?dice_simul_6 <- sample(dice_sides_6, dice_rolls_6,
>      >? ? ?replace = TRUE)
>      >? ? ? >? ? ? ? ?# constructing matrix containing results of all dice
>      >? ? ?rolls by month
>      >? ? ? >? ? ? ? ?prob_matrix_6 <- matrix(dice_simul_6, ncol = 12,
>     byrow =
>      >? ? ?TRUE)
>      >? ? ? >
>      >? ? ? >? ? ? ? ?# naming each column by it's corresponding month name
>      >? ? ? >? ? ? ? ?colnames(prob_matrix_6) <- month.abb
>      >? ? ? >
>      >? ? ? >? ? ? ? ?# calculating column? which will have a 1
>      >? ? ? >? ? ? ? ?# if trial was successful and a 0 otherwise
>      >? ? ? >? ? ? ? ?success <- integer(num_trials_6)
>      >? ? ? >? ? ? ? ?for(i in seq_len(num_trials_6)){
>      >? ? ? >? ? ? ? ? ?success[i] <- as.integer(all(1:6 %in%
>     prob_matrix_6[i, ]))
>      >? ? ? >? ? ? ? ?}
>      >? ? ? >
>      >? ? ? >? ? ? ? ?#calculating probability of success
>      >? ? ? >
>      >? ? ? >? ? ? ? ?p6 <- mean(success)
>      >? ? ? >? ? ? ? ?prob_frame_6[1, k] <- p6
>      >? ? ? >? ? ?}
>      >? ? ? >
>      >? ? ? >? ? ?colnames(prob_frame_6) <- sprintf("p%d", seq_len(K))
>      >? ? ? >? ? ?average_prob_frame_6 <- rowMeans(prob_frame_6)
>      >? ? ? >? ? ?final_frame_6 <- cbind(prob_frame_6, average_prob_frame_6)
>      >? ? ? >
>      >? ? ? >? ? ?write.csv(final_frame_6,
>      >? ? ?"OneMillion_Trials_Ten_Times_Results.csv")
>      >? ? ? >
>      >? ? ? >? ? ?print(final_frame_6)
>      >? ? ? >? ? ?print(paste("The average probability of success when doing
>      >? ? ?1,000,000
>      >? ? ? >? ? ?trials 10 times is:", average_prob_frame_6))
>      >? ? ? >
>      >? ? ? >
>      >? ? ? >? ? ?Hope this helps,
>      >? ? ? >
>      >? ? ? >? ? ?Rui Barradas
>      >? ? ? >
>      >? ? ? >? ? ??s 12:14 de 24/04/2022, Paul Bernal escreveu:
>      >? ? ? >? ? ? > Dear Rui,
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > There is a package called dice, that package is the
>     one I am
>      >? ? ? >? ? ?using. This
>      >? ? ? >? ? ? > package has a funci?n called dice.
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > Best,
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > Paul
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? > El El dom, 24 de abr. de 2022 a la(s) 4:43 a.?m.,
>     Rui Barradas
>      >? ? ? >? ? ? > <ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>
>     <mailto:ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>>
>      >? ? ?<mailto:ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>
>     <mailto:ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>>>
>      >? ? ? >? ? ?<mailto:ruipbarradas at sapo.pt
>     <mailto:ruipbarradas at sapo.pt> <mailto:ruipbarradas at sapo.pt
>     <mailto:ruipbarradas at sapo.pt>>
>      >? ? ?<mailto:ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>
>     <mailto:ruipbarradas at sapo.pt <mailto:ruipbarradas at sapo.pt>>>>> escribi?:
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ?Hello,
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ?I'm having trouble running the code, where does
>      >? ? ?function dice
>      >? ? ? >? ? ?come from?
>      >? ? ? >? ? ? >? ? ?CRAN package dice only has two functions,
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ?getEventProb
>      >? ? ? >? ? ? >? ? ?getSumProbs
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ?not a function dice.
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ?Can you post a link to where the
>     package/function can
>      >? ? ?be found?
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ?Rui Barradas
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ??s 02:00 de 24/04/2022, Paul Bernal escreveu:
>      >? ? ? >? ? ? >? ? ? > Dear R friends,
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? > Hope you are doing great. The reason why I am
>      >? ? ?contacting
>      >? ? ? >? ? ?you all, is
>      >? ? ? >? ? ? >? ? ? > because the code I am sharing with you takes
>      >? ? ?forever. It
>      >? ? ? >? ? ?started
>      >? ? ? >? ? ? >? ? ?running at
>      >? ? ? >? ? ? >? ? ? > 2:00 AM today, and it's 7:52 PM and is still
>      >? ? ?running (see
>      >? ? ? >? ? ?code at
>      >? ? ? >? ? ? >? ? ?the end
>      >? ? ? >? ? ? >? ? ? > of this mail).
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? > I am using Rx64? 4.1.2, and the code is being
>      >? ? ?executed in
>      >? ? ? >? ? ? >? ? ?RStudio. The
>      >? ? ? >? ? ? >? ? ? > RStudio version I am currently using is Version
>      >? ? ?2022.02.0
>      >? ? ? >? ? ?Build 443
>      >? ? ? >? ? ? >? ? ? > "Prairie Trillium" Release (9f796939,
>     2022-02-16)
>      >? ? ?for Windows.
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? > My PC specs:
>      >? ? ? >? ? ? >? ? ? > Processor: Intel(R) Core(TM) i5-10310U CPU @
>     1.70 GHz
>      >? ? ? >? ? ? >? ? ? > Installed RAM: 16.0 GB (15.6 GB usable)
>      >? ? ? >? ? ? >? ? ? > System type: 64-bit operating system, x64-based
>      >? ? ?processor
>      >? ? ? >? ? ? >? ? ? > Local Disc(C:) Free Space: 274 GB
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? > I am wondering if there is/are a set of system
>      >? ? ?variable(s) or
>      >? ? ? >? ? ? >? ? ?something I
>      >? ? ? >? ? ? >? ? ? > could do to improve the performance of the
>     program.
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? > It is really odd this code has taken this
>     much (and
>      >? ? ?it is
>      >? ? ? >? ? ?still
>      >? ? ? >? ? ? >? ? ?running).
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? > Any help and/or guidance would be greatly
>     appreciated.
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? > Best regards,
>      >? ? ? >? ? ? >? ? ? > Paul
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? > #performing 1,000,000 simulations 10 times
>      >? ? ? >? ? ? >? ? ? > num_trials_6 = 1000000
>      >? ? ? >? ? ? >? ? ? > dice_rolls_6 = num_trials_6*12
>      >? ? ? >? ? ? >? ? ? > num_dice_6 = 1
>      >? ? ? >? ? ? >? ? ? > dice_sides_6 = 6
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? > prob_frame_6 <- data.frame(matrix(ncol = 10,
>     nrow = 1))
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? > k <- 0
>      >? ? ? >? ? ? >? ? ? > while(k < 10){
>      >? ? ? >? ? ? >? ? ? >? ? dice_simul_6 = data.frame(dice(rolls =
>     dice_rolls_6,
>      >? ? ? >? ? ?ndice =
>      >? ? ? >? ? ? >? ? ?num_dice_6,
>      >? ? ? >? ? ? >? ? ? > sides = dice_sides_6, plot.it
>     <http://plot.it> <http://plot.it <http://plot.it>>
>      >? ? ?<http://plot.it <http://plot.it> <http://plot.it
>     <http://plot.it>>>
>      >? ? ? >? ? ?<http://plot.it <http://plot.it> <http://plot.it
>     <http://plot.it>> <http://plot.it <http://plot.it>
>      >? ? ?<http://plot.it <http://plot.it>>>> = FALSE))
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? >? ? #constructing matrix containing results
>     of all dice
>      >? ? ? >? ? ?rolls by month
>      >? ? ? >? ? ? >? ? ? >? ? prob_matrix_6 <-
>      >? ? ?data.frame(matrix(dice_simul_6[,1], ncol =
>      >? ? ? >? ? ? >? ? ?12, byrow =
>      >? ? ? >? ? ? >? ? ? > TRUE))
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? >? ? #naming each column by it's corresponding
>     month name
>      >? ? ? >? ? ? >? ? ? >? ? colnames(prob_matrix_6) <-
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >
>      >? ? ? >
>      >     
>      ?c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? >? ? #assigning each person?s name depending
>     on the
>      >? ? ?number
>      >? ? ? >? ? ?showed
>      >? ? ? >? ? ? >? ? ?in the dice
>      >? ? ? >? ? ? >? ? ? > once rolled
>      >? ? ? >? ? ? >? ? ? >? ? for (i in 1:nrow(prob_matrix_6)){
>      >? ? ? >? ? ? >? ? ? >? ? ? for (j in 1:ncol(prob_matrix_6)){
>      >? ? ? >? ? ? >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 1){
>      >? ? ? >? ? ? >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Alice"
>      >? ? ? >? ? ? >? ? ? >? ? ? ? }
>      >? ? ? >? ? ? >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 2){
>      >? ? ? >? ? ? >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Bob"
>      >? ? ? >? ? ? >? ? ? >? ? ? ? }
>      >? ? ? >? ? ? >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 3){
>      >? ? ? >? ? ? >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Charlie"
>      >? ? ? >? ? ? >? ? ? >? ? ? ? }
>      >? ? ? >? ? ? >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 4){
>      >? ? ? >? ? ? >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Don"
>      >? ? ? >? ? ? >? ? ? >? ? ? ? }
>      >? ? ? >? ? ? >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 5){
>      >? ? ? >? ? ? >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Ellen"
>      >? ? ? >? ? ? >? ? ? >? ? ? ? }
>      >? ? ? >? ? ? >? ? ? >? ? ? ? if (prob_matrix_6[i,j] == 6){
>      >? ? ? >? ? ? >? ? ? >? ? ? ? ? prob_matrix_6[i,j] = "Fred"
>      >? ? ? >? ? ? >? ? ? >? ? ? ? }
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? >? ? ? }
>      >? ? ? >? ? ? >? ? ? >? ? }
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? >? ? #calculating column? which will have a 1 if
>      >? ? ?trial was
>      >? ? ? >? ? ? >? ? ?successful and a 0
>      >? ? ? >? ? ? >? ? ? > otherwise
>      >? ? ? >? ? ? >? ? ? >? ? prob_matrix_6['success'] <- for (i in
>      >? ? ? >? ? ?1:nrow(prob_matrix_6)){
>      >? ? ? >? ? ? >? ? ? >? ? ? if (("Alice" %in% prob_matrix_6[i,]) &
>     ("Bob" %in%
>      >? ? ? >? ? ? >? ? ?prob_matrix_6[i,]) &
>      >? ? ? >? ? ? >? ? ? > ("Charlie" %in% prob_matrix_6[i,]) & ("Don" %in%
>      >? ? ? >? ? ?prob_matrix_6[i,]) &
>      >? ? ? >? ? ? >? ? ? > ("Ellen" %in% prob_matrix_6[i,]) & ("Fred" %in%
>      >? ? ? >? ? ?prob_matrix_6[i,])){
>      >? ? ? >? ? ? >? ? ? >? ? ? ? prob_matrix_6[i,13] = 1
>      >? ? ? >? ? ? >? ? ? >? ? ? }else{
>      >? ? ? >? ? ? >? ? ? >? ? ? ? prob_matrix_6[i,13] = 0
>      >? ? ? >? ? ? >? ? ? >? ? ? }
>      >? ? ? >? ? ? >? ? ? >? ? }
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? >? ? #relabeling column v13 so that its new
>     name is
>      >? ? ?success
>      >? ? ? >? ? ? >? ? ? >? ? colnames(prob_matrix_6)[13] <- "success"
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? >? ? #calculating probability of success
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? >? ? p6 =
>     sum(prob_matrix_6$success)/nrow(prob_matrix_6)
>      >? ? ? >? ? ? >? ? ? >? ? prob_frame_6 <- cbind(prob_frame_6, p6)
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? >? ? k = k + 1
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? > }
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? > prob_frame_6 <- prob_frame_6[11:20]
>      >? ? ? >? ? ? >? ? ? > colnames(prob_frame_6) <-
>      >? ? ? >? ? ? >? ? ? >
>     c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10")
>      >? ? ? >? ? ? >? ? ? > average_prob_frame_6 <- rowMeans(prob_frame_6)
>      >? ? ? >? ? ? >? ? ? > trial_1000000_10_frame <- cbind(prob_frame_6,
>      >? ? ? >? ? ?average_prob_frame_6)
>      >? ? ? >? ? ? >? ? ? > final_frame_6 <- trial_1000000_10_frame
>      >? ? ? >? ? ? >? ? ? > colnames(final_frame_6) <-
>      >? ? ? >? ? ? >? ? ? >
>     c("p1","p2","p3","p4","p5","p6","p7","p8","p9","p10",
>      >? ? ? >? ? ? >? ? ?"avg_prob_frame_5")
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? > write.csv(final_frame_6,
>      >? ? ? >? ? ?"OneMillion_Trials_Ten_Times_Results.csv")
>      >? ? ? >? ? ? >? ? ? > print(final_frame_6)
>      >? ? ? >? ? ? >? ? ? > print(paste("The average probability of success
>      >? ? ?when doing
>      >? ? ? >? ? ? >? ? ?1,000,000 trials
>      >? ? ? >? ? ? >? ? ? > 10 times is:", average_prob_frame_6))
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? >? ? ? ?[[alternative HTML version deleted]]
>      >? ? ? >? ? ? >? ? ? >
>      >? ? ? >? ? ? >? ? ? > ______________________________________________
>      >? ? ? >? ? ? >? ? ? > R-help at r-project.org
>     <mailto:R-help at r-project.org> <mailto:R-help at r-project.org
>     <mailto:R-help at r-project.org>>
>      >? ? ?<mailto:R-help at r-project.org <mailto:R-help at r-project.org>
>     <mailto:R-help at r-project.org <mailto:R-help at r-project.org>>>
>      >? ? ? >? ? ?<mailto:R-help at r-project.org
>     <mailto:R-help at r-project.org> <mailto:R-help at r-project.org
>     <mailto:R-help at r-project.org>>
>      >? ? ?<mailto:R-help at r-project.org <mailto:R-help at r-project.org>
>     <mailto:R-help at r-project.org <mailto:R-help at r-project.org>>>> mailing
>      >? ? ?list
>      >? ? ? >? ? ? >? ? ?-- To UNSUBSCRIBE and more, see
>      >? ? ? >? ? ? >? ? ? > https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>      >? ? ?<https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>>
>      >? ? ? >? ? ?<https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>      >? ? ?<https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>>>
>      >? ? ? >? ? ? >? ? ?<https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>      >? ? ?<https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>>
>      >? ? ? >? ? ?<https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>      >? ? ?<https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>>>>
>      >? ? ? >? ? ? >? ? ? > PLEASE do read the posting guide
>      >? ? ? >? ? ? > http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>      >? ? ?<http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>>
>      >? ? ? >? ? ?<http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>      >? ? ?<http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>>>
>      >? ? ? >? ? ? >? ? ?<http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>      >? ? ?<http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>>
>      >? ? ? >? ? ?<http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>      >? ? ?<http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>>>>
>      >? ? ? >? ? ? >? ? ? > and provide commented, minimal, self-contained,
>      >? ? ? >? ? ?reproducible code.
>      >? ? ? >? ? ? >
>      >? ? ? >
>      >
>


From yongchu@ng99 @end|ng |rom qq@com  Sun Apr 24 03:38:16 2022
From: yongchu@ng99 @end|ng |rom qq@com (=?gb18030?B?08C0tA==?=)
Date: Sun, 24 Apr 2022 09:38:16 +0800
Subject: [R] about opening R script Chinese annotation garble problem
Message-ID: <tencent_82D863BBEAA3B88125F6D1FF41F885529406@qq.com>

Garbled characters appear in Chinese annotation when opening program script using RGui (see attached picture). I use a variety of methods have not been solved, I hope to help me solve this problem. Thank you.

From uwe @end|ng |rom |re|er@de  Sun Apr 24 17:05:55 2022
From: uwe @end|ng |rom |re|er@de (Uwe Freier)
Date: Sun, 24 Apr 2022 17:05:55 +0200
Subject: [R] Confusing fori or ifelse result in matrix manipulation
Message-ID: <09a90ba0470a47626f93455aeb0e83e3@freier.de>

Hello,

sorry for the newbie question but I can't find out where I'm wrong.

A <- matrix(1:9,ncol=3)
x <- c(0,1,0)
M <- matrix(ncol=3,nrow=3)
for(i in 1:3) {
  M[,i] <- ifelse(x[i] == 0, A[,i], 0)
}

expected:

> M
      [,1] [,2] [,3]
[1,]    1    0    7
[2,]    2    0    8
[3,]    3    0    9


but the result is:

> M
      [,1] [,2] [,3]
[1,]    1    0    7
[2,]    1    0    7
[3,]    1    0    7


If I do it "manually":

> M[,1] <- A[,1]
> M[,2] <- 0
> M[,3] <- A[,3]

M is as expected, where is my misconception?

Thanks for any hint and best regards,

Uwe


From n|co|@@@deg@|||er @end|ng |rom |ree@|r  Sun Apr 24 22:43:21 2022
From: n|co|@@@deg@|||er @end|ng |rom |ree@|r (Nicolas Degallier)
Date: Sun, 24 Apr 2022 22:43:21 +0200
Subject: [R] conversion of d m s (lat) d m s (long) coordinates into decimal
 coordinates
Message-ID: <A4CD90DD-8EEF-410B-B528-9B0EC92DECD0@free.fr>

Dear R Users,

I am using a 'simple' script to draw maps with points.
It runs fine with the following libraries:
library(sp)
library(maptools)
library(maps)
library(mapdata)
library(RColorBrewer)
library(MASS)
library(rgeos)
library(GISTools)

Until now, to prepare the input data, I have used manually some free net converter because the number of points to plot was not too high.
Now I have much more points coordinates to convert from a GPS ? ' " (d m s) format to a decimal format which will be accepted by the R script to build maps.

My initial data is of the form (tab delimited text file):

nom	lat	long
"D. antoinei"	6?04' S	50?12'W
"D. antoinei"	3?45'S	49?40'W
"D. antoinei"	3?1'49"N	53?6'24"W
"D. barberoi"	13?03.3?S	71?32.7?W
"D. barberoi"	10?59.3?S	75?25.5?W" 

and I need them in the format (tab delimited):

nom	lat	long
"D. antoinei"	-11.944478527683975	-71.28298997950684
"D. antoinei"	-12.833333	-69.333333
"D. antoinei"	3.333333	-60.283333
"D. barberoi"	-10.366667	-67.683333
"D. barberoi"	-15.314500	-55.970300

Is there some 'simple' R script to do such a conversion?
I am using R v. 3.2.1. on a iMac OS 10.6.8.

May be this topic had already been resolved but I was unable to find the result in the FAQs.
Cheers
Nicolas Degallier


<nicolas.degallier at free.fr>
<omalodes at yahoo.fr>

Publications :
https://www.documentation.ird.fr/listes/parauteur/DEGALLIER/NICOLAS/tout/annee


From kry|ov@r00t @end|ng |rom gm@||@com  Mon Apr 25 10:49:22 2022
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Mon, 25 Apr 2022 11:49:22 +0300
Subject: [R] Confusing fori or ifelse result in matrix manipulation
In-Reply-To: <09a90ba0470a47626f93455aeb0e83e3@freier.de>
References: <09a90ba0470a47626f93455aeb0e83e3@freier.de>
Message-ID: <20220425114922.01b83e99@arachnoid>

? Sun, 24 Apr 2022 17:05:55 +0200
Uwe Freier <uwe at freier.de> ?????:

> ifelse(x[i] == 0, A[,i], 0)

Hint: what does ifelse return instead of a vector of length nrow(A)?

Since you're checking conditions of length 1, you can safely use `if
(x[i] == 0) A[,i] else 0` here, or you can transform the `x` vector
into a boolean matrix of the correct shape to guide the substitution:

X <- matrix(as.logical(x), nrow(A), ncol(A), byrow = TRUE)
ifelse(X, 0, A)

-- 
Best regards,
Ivan


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Apr 25 11:12:43 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 25 Apr 2022 10:12:43 +0100
Subject: [R] 
 conversion of d m s (lat) d m s (long) coordinates into decimal
 coordinates
In-Reply-To: <A4CD90DD-8EEF-410B-B528-9B0EC92DECD0@free.fr>
References: <A4CD90DD-8EEF-410B-B528-9B0EC92DECD0@free.fr>
Message-ID: <4d991288-6f43-8d6a-9a88-67076316ecb9@sapo.pt>

Hello,

See if this StackOverflow.com post [1] solves your problem.

Also, examples should be minimal, you don't need all those packages to 
solve this problem.


[1]  https://stackoverflow.com/a/69485865/8245406


Hope this helps,

Rui Barradas

?s 21:43 de 24/04/2022, Nicolas Degallier escreveu:
> Dear R Users,
> 
> I am using a 'simple' script to draw maps with points.
> It runs fine with the following libraries:
> library(sp)
> library(maptools)
> library(maps)
> library(mapdata)
> library(RColorBrewer)
> library(MASS)
> library(rgeos)
> library(GISTools)
> 
> Until now, to prepare the input data, I have used manually some free net converter because the number of points to plot was not too high.
> Now I have much more points coordinates to convert from a GPS ? ' " (d m s) format to a decimal format which will be accepted by the R script to build maps.
> 
> My initial data is of the form (tab delimited text file):
> 
> nom	lat	long
> "D. antoinei"	6?04' S	50?12'W
> "D. antoinei"	3?45'S	49?40'W
> "D. antoinei"	3?1'49"N	53?6'24"W
> "D. barberoi"	13?03.3?S	71?32.7?W
> "D. barberoi"	10?59.3?S	75?25.5?W"
> 
> and I need them in the format (tab delimited):
> 
> nom	lat	long
> "D. antoinei"	-11.944478527683975	-71.28298997950684
> "D. antoinei"	-12.833333	-69.333333
> "D. antoinei"	3.333333	-60.283333
> "D. barberoi"	-10.366667	-67.683333
> "D. barberoi"	-15.314500	-55.970300
> 
> Is there some 'simple' R script to do such a conversion?
> I am using R v. 3.2.1. on a iMac OS 10.6.8.
> 
> May be this topic had already been resolved but I was unable to find the result in the FAQs.
> Cheers
> Nicolas Degallier
> 
> 
> <nicolas.degallier at free.fr>
> <omalodes at yahoo.fr>
> 
> Publications :
> https://www.documentation.ird.fr/listes/parauteur/DEGALLIER/NICOLAS/tout/annee
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Apr 25 12:06:39 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 25 Apr 2022 11:06:39 +0100
Subject: [R] 
 conversion of d m s (lat) d m s (long) coordinates into decimal
 coordinates
In-Reply-To: <7360CF88-97B5-484B-A15F-046CA8670061@free.fr>
References: <A4CD90DD-8EEF-410B-B528-9B0EC92DECD0@free.fr>
 <4d991288-6f43-8d6a-9a88-67076316ecb9@sapo.pt>
 <7360CF88-97B5-484B-A15F-046CA8670061@free.fr>
Message-ID: <dfabecf2-15d7-dfa3-b256-5158171bf7e0@sapo.pt>

Hello,

Here is the link to the archived versions of package measurements [1].
But the edit to that answer has another solution, with sp::char2dms and 
you are loading package sp.


[1] https://cran.hafro.is/src/contrib/Archive/measurements/

Hope this helps,

Rui Barradas

?s 10:57 de 25/04/2022, Nicolas Degallier escreveu:
> Hi Rui,
> 
> Thanks for the information.
> Unfortunately, my versions of MacOS and of R are too old:
> 
>  > install.packages("measurements")
> 
> Warning message:
> package ?measurements? is not available (for R version 3.2.1)
>  > library(measurements)
> Warning message:
> le package ?measurements? a ?t? compil? avec la version R 3.2.5
> 
> There is no older package to do the same?
> Cheers
> Nicolas
> 
> 
> Le 25 avr. 2022 ? 11:12, Rui Barradas a ?crit :
> 
>> Hello,
>>
>> See if this StackOverflow.com <http://StackOverflow.com> post [1] 
>> solves your problem.
>>
>> Also, examples should be minimal, you don't need all those packages to 
>> solve this problem.
>>
>>
>> [1] https://stackoverflow.com/a/69485865/8245406 
>> <https://stackoverflow.com/a/69485865/8245406>
>>
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>> ?s 21:43 de 24/04/2022, Nicolas Degallier escreveu:
>>> Dear R Users,
>>> I am using a 'simple' script to draw maps with points.
>>> It runs fine with the following libraries:
>>> library(sp)
>>> library(maptools)
>>> library(maps)
>>> library(mapdata)
>>> library(RColorBrewer)
>>> library(MASS)
>>> library(rgeos)
>>> library(GISTools)
>>> Until now, to prepare the input data, I have used manually some free 
>>> net converter because the number of points to plot was not too high.
>>> Now I have much more points coordinates to convert from a GPS ? ' " 
>>> (d m s) format to a decimal format which will be accepted by the R 
>>> script to build maps.
>>> My initial data is of the form (tab delimited text file):
>>> nomlatlong
>>> "D. antoinei"6?04' S50?12'W
>>> "D. antoinei"3?45'S49?40'W
>>> "D. antoinei"3?1'49"N53?6'24"W
>>> "D. barberoi"13?03.3?S71?32.7?W
>>> "D. barberoi"10?59.3?S75?25.5?W"
>>> and I need them in the format (tab delimited):
>>> nomlatlong
>>> "D. antoinei"-11.944478527683975-71.28298997950684
>>> "D. antoinei"-12.833333-69.333333
>>> "D. antoinei"3.333333-60.283333
>>> "D. barberoi"-10.366667-67.683333
>>> "D. barberoi"-15.314500-55.970300
>>> Is there some 'simple' R script to do such a conversion?
>>> I am using R v. 3.2.1. on a iMac OS 10.6.8.
>>> May be this topic had already been resolved but I was unable to find 
>>> the result in the FAQs.
>>> Cheers
>>> Nicolas Degallier
>>> <nicolas.degallier at free.fr <mailto:nicolas.degallier at free.fr>>
>>> <omalodes at yahoo.fr <mailto:omalodes at yahoo.fr>>
>>> Publications :
>>> https://www.documentation.ird.fr/listes/parauteur/DEGALLIER/NICOLAS/tout/annee 
>>> <https://www.documentation.ird.fr/listes/parauteur/DEGALLIER/NICOLAS/tout/annee>
>>> ______________________________________________
>>> R-help at r-project.org <mailto:R-help at r-project.org> mailing list -- To 
>>> UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help 
>>> <https://stat.ethz.ch/mailman/listinfo/r-help>
>>> PLEASE do read the posting guide 
>>> http://www.R-project.org/posting-guide.html 
>>> <http://www.R-project.org/posting-guide.html>
>>> and provide commented, minimal, self-contained, reproducible code.
>


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Mon Apr 25 13:16:06 2022
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Mon, 25 Apr 2022 06:16:06 -0500
Subject: [R] about opening R script Chinese annotation garble problem
In-Reply-To: <tencent_82D863BBEAA3B88125F6D1FF41F885529406@qq.com>
References: <tencent_82D863BBEAA3B88125F6D1FF41F885529406@qq.com>
Message-ID: <fb029612-768c-c2ea-0bd1-9d0b95424f76@effectivedefense.org>

	  Attachments are NOT delivered to the readers of this list.


	  PLEASE do read the posting guide 
http://www.R-project.org/posting-guide.html and provide commented, 
minimal, self-contained, reproducible code.  This includes 
sessionInfo().  If you can reproduce it on multiple platforms, that 
would help.  Can you can post the image to the web someplace (e.g., a 
Google Drive) and provide the link?  That would help, also.


	  Thanks,
	  Spencer Graves


On 4/23/22 8:38 PM, ?? via R-help wrote:
> Garbled characters appear in Chinese annotation when opening program script using RGui (see attached picture). I use a variety of methods have not been solved, I hope to help me solve this problem. Thank you.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From petr@p|k@| @end|ng |rom prechez@@cz  Mon Apr 25 15:21:38 2022
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Mon, 25 Apr 2022 13:21:38 +0000
Subject: [R] [External] add equation and rsqared to plot
In-Reply-To: <CAGxFJbQUTiLEu6nJp1aUpbjhTCXSYBqfkiVqsFTaHKFUe0DJVA@mail.gmail.com>
References: <1649275105409.87603@precheza.cz>
 <4483DC96-F937-4BB8-B5A1-4485FDF590DB@temple.edu>
 <1649278042150.16601@precheza.cz>
 <95448101-08c6-045d-ff79-fb9febf3effb@comcast.net>
 <1649280964120.57655@precheza.cz>
 <9ed7092d-b142-9f6f-854e-9e5182b2b466@comcast.net>
 <96bfd2fd05024b47a33939a9b9d4c19a@SRVEXCHCM1302.precheza.cz>
 <CAGxFJbToLSGpNxxnJAwMVO59JJJrnY6yiwvxGCu6HFsYpCfBjA@mail.gmail.com>
 <CAHqSRuT8O0TkjwV_GSjB=z_g4j3q0OW7b_Lu=MaJzs_6PNpENQ@mail.gmail.com>
 <CAGxFJbQUTiLEu6nJp1aUpbjhTCXSYBqfkiVqsFTaHKFUe0DJVA@mail.gmail.com>
Message-ID: <be5886de51514dfc8e441a5033fbff63@SRVEXCHCM1302.precheza.cz>

Thanks to all who responded. Now I started a bit to understand what is behind my miserable effort to put some text into graph in required way.

Best regards.
Petr

> -----Original Message-----
> From: Bert Gunter <bgunter.4567 at gmail.com>
> Sent: Friday, April 8, 2022 7:33 PM
> To: Bill Dunlap <williamwdunlap at gmail.com>
> Cc: PIKAL Petr <petr.pikal at precheza.cz>; r-help at r-project.org
> Subject: Re: [R] [External] add equation and rsqared to plot
> 
> Thanks, Bill.
> 
> This is a subtlety I certainly did not understand.
> 
> 
> Bert
> 
> On Fri, Apr 8, 2022 at 10:08 AM Bill Dunlap <williamwdunlap at gmail.com>
> wrote:
> >
> > plotmath also accepts names and calls, which it treats as though they were
> single-element expressions.  That is why quote() generally works.
> quote("string") or quote(123) does not invoke plotmath, as quote returns a
> literal string or number when given such a thing.
> >
> > plot(0:1,0:1,type="n")
> > text(.2, .6, expression(phi^epsilon))
> > text(.2, .4, quote(phi^epsilon))
> > text(.7, .6, expression(1234567890123456)) text(.7, .4,
> > quote(1234567890123456))
> >
> > -Bill
> >
> > On Fri, Apr 8, 2022 at 9:49 AM Bert Gunter <bgunter.4567 at gmail.com>
> wrote:
> >>
> >> Yes, I also find it somewhat confusing. Perhaps this will help. I
> >> apologize beforehand if I have misunderstood and you already know all
> >> this.
> >>
> >> The key is to realize that plotmath works with **expressions**,
> >> unevaluated forms that include special plotmath keywords, like
> >> 'atop', and symbols. So...
> >>
> >> ## simple example with plotmath used in plot's title
> >>
> >> ## This will produce an error, as 'atop' is not an R function:
> >> plot(1,1, main = atop(x,y))
> >>
> >> ## to make this work, we need an expression on the rhs of 'main =' .
> >> A simple way to do this is to use quote():
> >>
> >> plot(1,1,main = quote(atop(x,y)))
> >>
> >> ## Note that this produce 'x' above 'y' **without quoting x and y**.
> >> That's because
> >> ## this is an expression that plotmath parses and evaluates according
> >> to its own rules, ## shown in ?plotmath
> >>
> >> ## Now suppose we have:
> >> x <- 'first line'
> >> y <- 'second line'
> >>
> >> ## and we want to display these quoted strings instead of 'x' and 'y'
> >> in the title
> >>
> >> ## Then this will *not* work -- it gives the same result as before:
> >> plot(1,1,main = quote(atop(x,y)))
> >>
> >> ## So what is needed here is R's 'computing on the language"
> >> capability to substitute
> >> ## the quoted strings for x and y in the expression. Here are two
> >> simple ways to do this:
> >>
> >> ## First using substitute()
> >>
> >> plot(1,1, main = substitute(atop(x,y), list (x =x, y = y)))
> >>
> >> ## Second, using bquote()
> >>
> >> plot(1,1, main = bquote(atop(.(x), .(y))))
> >>
> >> ## More complicated expressions can be built up using plotmath's rules.
> >> ## But you need to be careful about distinguishing plotmath
> >> expressions and ## ordinary R expressions. For example:
> >>
> >> x <- pi/4  ## a number
> >>
> >> ## WRONG -- will display as written. bquote() is the same as quote() here.
> >> plot(1,1, main = bquote(sin(pi/4) == round(x,2)))
> >>
> >> ## WRONG -- will substitute value of x rounded to session default ##
> >> in previous. This is a mistake in using bquote plot(1,1, main =
> >> bquote(sin(pi/4) == round(.(x), 2)))
> >>
> >> ## RIGHT -- use of bquote
> >> plot(1,1, main = bquote(sin(pi/4) == .(round(x,2)))) ## or -- using
> >> substitute plot(1,1, main = substitute(sin(pi/4) == x, list(x =
> >> round(x,2))))
> >>
> >> Hope this is helpful and, again, apologies if I have misunderstood.
> >>
> >> Bert Gunter
> >>
> >> "The trouble with having an open mind is that people keep coming
> >> along and sticking things into it."
> >> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> >>
> >> On Fri, Apr 8, 2022 at 7:42 AM PIKAL Petr <petr.pikal at precheza.cz>
> wrote:
> >> >
> >> > Hallo David
> >> >
> >> > Fair enough. Thanks for your explanation, which told me what should be
> done. It works perfectly for my example but I am still confused how to get
> expressions given to atop (or other functions) be evaluated and help page
> does not enlighten me, so I am still puzzled.
> >> >
> >> > When I borrow example from help,
> >> >
> >> > plot(1:10, type="n", xlab="", ylab="", main = "plot math &
> >> > numbers") theta <- 1.23 ; mtext(bquote(hat(theta) == .(theta)),
> >> > line= .25) for(i in 2:9)
> >> >     text(i, i+1, substitute(list(xi, eta) == group("(",list(x,y),")"),
> >> >                             list(x = i, y = i+1)))
> >> >
> >> > #this is OK
> >> > ex1 <- expression("      first: {f * minute}(x) " == {f * minute}(x))
> >> > ex2 <- expression("               second: {f * second}(x) "        == {f *
> second}(x))
> >> > text(1, 9.6, ex1, adj=0)
> >> > text(1, 9.0, ex2, adj=0)
> >> >
> >> > #and this is not
> >> > text(2, 8, expression(atop(ex1, ex2))) text(2, 7, substitute(
> >> > atop(ex1, ex2), list(ex1=ex1,ex2=ex2)))
> >> >
> >> > #and this works
> >> > text(2, 6, expression(atop(1,2)))
> >> >
> >> > I tried to use eval when calling atop, but it did not work either.
> Therefore some hint in help page could be quite handy.
> >> >
> >> > Best regards
> >> > Petr Pikal
> >> >
> >> > S pozdravem | Best Regards
> >> > RNDr. Petr PIKAL
> >> > Vedouc? V?zkumu a v?voje | Research Manager PRECHEZA a.s.
> >> > n?b?. Dr. Edvarda Bene?e 1170/24 | 750 02 P?erov | Czech Republic
> >> > Tel: +420 581 252 256 | GSM: +420 724 008 364
> >> > petr.pikal at precheza.cz | www.precheza.cz
> >> >
> >> > Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj?
> >> > obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na:
> >> > https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ |
> >> > Information about processing and protection of business partner?s
> >> > personal data are available on website:
> >> > https://www.precheza.cz/en/personal-data-protection-principles/
> >> > D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty jsou
> >> > d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o vylou?en?
> >> > odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email and
> >> > any documents attached to it may be confidential and are subject to
> >> > the legally binding disclaimer:
> >> > https://www.precheza.cz/en/01-disclaimer/
> >> >
> >> > -----Original Message-----
> >> > From: David Winsemius <dwinsemius at comcast.net>
> >> > Sent: Thursday, April 7, 2022 12:04 AM
> >> > To: PIKAL Petr <petr.pikal at precheza.cz>; Richard M. Heiberger
> >> > <rmh at temple.edu>
> >> > Cc: r-help at r-project.org
> >> > Subject: Re: [R] [External] add equation and rsqared to plot
> >> >
> >> >
> >> > On 4/6/22 14:36, PIKAL Petr wrote:
> >> > > Hallo David
> >> > >
> >> > > Thanks for your answer. atop itself somehow cannot use expression
> made by substitute  although those expressions itself are correct. I asked this
> question after roughly two hours of unsuccessful atempts.
> >> > >
> >> > > The second substitute or bquote solves the problem. Maybe this could
> propagate to help page, because although atop works smoothly with simple
> expressions, expressions with substitute are treated in a wrong way (at least
> by my opinion).
> >> >
> >> >
> >> > It's not a problem with `atop`. It's a problem with your
> >> > understanding of how R expressions and plotmath functions work. The
> >> > argument(s) to `expression` are not evaluated. So `atop` was given
> >> > two expressions `eq` and `req` and they in turn were not evaluated
> >> > .... just taken as text values inside atop. Using either
> >> > `substitute` (with a second argument
> >> > list) or bquote (with its special dot function) forces evaluation by getting
> from the R symbol table those expressions which you had assigned as values
> of the symbols `eq` and `req`.
> >> >
> >> > The plotmath functions (not just atop but also `paste`, `frac`, `over` and
> all the rest on the ?plotmath pafge),  are designed to be "like"
> >> > `expression` in not evaluating their arguments unless a "special value"
> >> > like a Greek letter name or a defined %<op>% is found. Those functions
> are handled with a different parser than regular R functions. So they are not
> designed to go out to the R symbol table (which is where even locally defined
> object names are kept) to find values.
> >> >
> >> >
> >> > Hope this helps;
> >> >
> >> > David.
> >> >
> >> >
> >> > --
> >> >
> >> > David.
> >> >
> >> > >
> >> > > Thanks again.
> >> > >
> >> > > Best regards.
> >> > > Petr
> >> > >
> >> > >
> >> > > ________________________________________
> >> > > Od: David Winsemius <dwinsemius at comcast.net>
> >> > > Odesl?no: 6. dubna 2022 23:20
> >> > > Komu: PIKAL Petr; Richard M. Heiberger
> >> > > Kopie: r-help at r-project.org
> >> > > P?edm?t: Re: [R] [External] add equation and rsqared to plot
> >> > >
> >> > > Try this:
> >> > >
> >> > >
> >> > > lm_eqn = function(m) {
> >> > >       l <- list(a = format(coef(m)[1], digits = 4),
> >> > >                 b = format(abs(coef(m)[2]), digits = 4),
> >> > >                 r2 = format(summary(m)$r.squared, digits = 3),
> >> > >                 r2adj = format(summary(m)$adj.r.squared, digits = 3));
> >> > >       if (coef(m)[2] >= 0)  {
> >> > >           eq <- substitute(italic(y) == a + b %.% italic(x), l)
> >> > >       } else {
> >> > >           eq <- substitute(italic(y) == a - b %.% italic(x),l)
> >> > >
> >> > >       }
> >> > >       req <- substitute(italic(r)^2~"="~r2* ","~~italic(adj.r)^2~"="~r2adj,l)
> >> > >       a_regs <- substitute( atop(eq, req), list(eq=eq,req=req)) }
> >> > >
> >> > > --
> >> > >
> >> > > David.
> >> > >
> >> > > On 4/6/22 13:47, PIKAL Petr wrote:
> >> > >> Hallo Richard.
> >> > >>
> >> > >> Did you try the example? I Used atop but with the syntax I made,
> >> > >> the result is
> >> > >>
> >> > >> eq
> >> > >> req
> >> > >>
> >> > >> but not the equations.
> >> > >>
> >> > >> I send the picture, but I am not sure if it will go through.
> >> > >>
> >> > >> Best regards
> >> > >> Petr
> >> > >>
> >> > >> ________________________________________
> >> > >> Od: Richard M. Heiberger <rmh at temple.edu>
> >> > >> Odesl?no: 6. dubna 2022 22:36
> >> > >> Komu: PIKAL Petr
> >> > >> Kopie: r-help at r-project.org
> >> > >> P?edm?t: Re: [External] [R] add equation and rsqared to plot
> >> > >>
> >> > >> I think you are looking for atop(a,b) See ? plotmath
> >> > >>
> >> > >>> On Apr 06, 2022, at 15:58, PIKAL Petr <petr.pikal at precheza.cz>
> wrote:
> >> > >>>
> >> > >>> Dear all
> >> > >>>
> >> > >>>
> >> > >>> I want to add equation and rsquared values to plot and I am lost in
> correct expression form. I want to have 2 lines, one with equation and one
> with r squared values.
> >> > >>>
> >> > >>>
> >> > >>> Here is what I made.
> >> > >>>
> >> > >>> # function to extract values from lm fit.
> >> > >>>
> >> > >>>
> >> > >>> lm_eqn = function(m) {
> >> > >>>    l <- list(a = format(coef(m)[1], digits = 4),
> >> > >>>        b = format(abs(coef(m)[2]), digits = 4),
> >> > >>>        r2 = format(summary(m)$r.squared, digits = 3),
> >> > >>>        r2adj = format(summary(m)$adj.r.squared, digits = 3));
> >> > >>>    if (coef(m)[2] >= 0)  {
> >> > >>>      eq <- substitute(italic(y) == a + b %.% italic(x), l)
> >> > >>>    } else {
> >> > >>>      eq <- substitute(italic(y) == a - b %.% italic(x),l)
> >> > >>>
> >> > >>>    }
> >> > >>>    req <- substitute(italic(r)^2~"="~r2*
> ","~~italic(adj.r)^2~"="~r2adj,l)
> >> > >>>    expression(atop(eq, req))
> >> > >>> }
> >> > >>>
> >> > >>>
> >> > >>> #Example
> >> > >>>
> >> > >>> x <- 1:10
> >> > >>> y <- x*5 +rnorm(10)
> >> > >>> plot(x,y)
> >> > >>> fit <- lm(y~x)
> >> > >>> text(4,40, lm_eqn(fit))
> >> > >>>
> >> > >>>
> >> > >>> I know that both eq and req are correct expressions and when the
> last line in function is either eq or req, the example gives correct result.
> >> > >>>
> >> > >>>
> >> > >>> But how to get both expressions one above the other is mystery.
> >> > >>>
> >> > >>> Please help.
> >> > >>>
> >> > >>>
> >> > >>> Best regards.
> >> > >>>
> >> > >>> Petr
> >> > >>>
> >> > >>>
> >> > >>>
> >> > >>> Osobn   daje: Informace o zpracov n  a ochran  osobn ch  daj
> >> > >>> obchodn ch partner  PRECHEZA a.s. jsou zve ejn ny na:
> >> > >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F
> >> > >>> %2Fww
> >> > >>> w.precheza.cz%2Fzasady-ochrany-osobnich-
> udaju%2F&amp;data=04%7C
> >> > >>> 01%7C
> >> > >>>
> rmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81ef
> b
> >> > >>> 52244
> >> > >>>
> 738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7
> CTWF
> >> > >>> pbGZs
> >> > >>>
> b3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI
> >> > >>> 6Mn0%
> >> > >>>
> 3D%7C3000&amp;sdata=MBtbONfsiMExWy0uorZMR1DglZindxErRMsooTztf
> Uo
> >> > >>> %3D&a
> >> > >>> mp;reserved=0 | Information about processing and protection of
> >> > >>> business partner's personal data are available on website:
> >> > >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F
> >> > >>> %2Fww
> >> > >>> w.precheza.cz%2Fen%2Fpersonal-data-protection-
> principles%2F&amp
> >> > >>> ;data
> >> > >>>
> =04%7C01%7Crmh%40temple.edu%7C3b28fb8737e146a9ee3208da1807da2
> e%
> >> > >>> 7C716
> >> > >>>
> e81efb52244738e3110bd02ccf6e5%7C0%7C0%7C637848719391803553%7C
> Un
> >> > >>> known
> >> > >>>
> %7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1h
> >> > >>> aWwiL
> >> > >>>
> CJXVCI6Mn0%3D%7C3000&amp;sdata=2YDPoejYRlphL6h%2FWFmEEyR44Kd
> mH2
> >> > >>> GDC9r
> >> > >>> dLhFn4aU%3D&amp;reserved=0
> >> > >>> D v rnost: Tento e-mail a jak koliv k n mu p ipojen  dokumenty
> >> > >>> jsou d v rn  a podl haj  tomuto pr vn  z vazn mu prohl en  o
> >> > >>> vylou en odpov dnosti:
> >> > >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F
> >> > >>> %2Fww
> >> > >>> w.precheza.cz%2F01-
> dovetek%2F&amp;data=04%7C01%7Crmh%40temple.e
> >> > >>> du%7C
> >> > >>>
> 3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3110bd02c
> c
> >> > >>> f6e5%
> >> > >>>
> 7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3d8eyJWIj
> oiMC
> >> > >>> 4wLjA
> >> > >>>
> wMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;
> >> > >>> sdata
> >> > >>>
> =z7TNZSbfNXlB%2FZt0ekl8P1kTu1l0eBFVoLvewSSdQDg%3D&amp;reserved=
> >> > >>> 0 | This email and any documents attached to it may be
> >> > >>> confidential and are subject to the legally binding disclaimer:
> >> > >>> https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F
> >> > >>> %2Fww
> >> > >>> w.precheza.cz%2Fen%2F01-
> disclaimer%2F&amp;data=04%7C01%7Crmh%40
> >> > >>> templ
> >> > >>>
> e.edu%7C3b28fb8737e146a9ee3208da1807da2e%7C716e81efb52244738e3
> 1
> >> > >>> 10bd0
> >> > >>>
> 2ccf6e5%7C0%7C0%7C637848719391803553%7CUnknown%7CTWFpbGZsb3
> d8ey
> >> > >>> JWIjo
> >> > >>>
> iMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3
> >> > >>> 000&a
> >> > >>>
> mp;sdata=RCUE7DJbn54MvhWX4bqiNtPzoJLl7NK9tieMlFpe2rg%3D&amp;res
> >> > >>> erved
> >> > >>> =0
> >> > >>>
> >> > >>>
> >> > >>>         [[alternative HTML version deleted]]
> >> > >>>
> >> > >>> ______________________________________________
> >> > >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more,
> >> > >>> see https://stat.ethz.ch/mailman/listinfo/r-help
> >> > >>> PLEASE do read the posting guide
> >> > >>> http://www.R-project.org/posting-guide.html
> >> > >>> and provide commented, minimal, self-contained, reproducible
> code.
> >> > >> Osobn? ?daje: Informace o zpracov?n? a ochran? osobn?ch ?daj?
> >> > >> obchodn?ch partner? PRECHEZA a.s. jsou zve?ejn?ny na:
> >> > >> https://www.precheza.cz/zasady-ochrany-osobnich-udaju/ |
> >> > >> Information about processing and protection of business
> >> > >> partner?s personal data are available on website:
> >> > >> https://www.precheza.cz/en/personal-data-protection-principles/
> >> > >> D?v?rnost: Tento e-mail a jak?koliv k n?mu p?ipojen? dokumenty
> >> > >> jsou d?v?rn? a podl?haj? tomuto pr?vn? z?vazn?mu prohl??en? o
> >> > >> vylou?en?
> >> > >> odpov?dnosti: https://www.precheza.cz/01-dovetek/ | This email
> >> > >> and any documents attached to it may be confidential and are
> >> > >> subject to the legally binding disclaimer:
> >> > >> https://www.precheza.cz/en/01-disclaimer/
> >> > >>
> >> > >>
> >> > >> ______________________________________________
> >> > >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more,
> >> > >> see https://stat.ethz.ch/mailman/listinfo/r-help
> >> > >> PLEASE do read the posting guide
> >> > >> http://www.R-project.org/posting-guide.html
> >> > >> and provide commented, minimal, self-contained, reproducible code.
> >> > ______________________________________________
> >> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> > https://stat.ethz.ch/mailman/listinfo/r-help
> >> > PLEASE do read the posting guide
> >> > http://www.R-project.org/posting-guide.html
> >> > and provide commented, minimal, self-contained, reproducible code.
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> >> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.

From tebert @end|ng |rom u||@edu  Mon Apr 25 16:01:15 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Mon, 25 Apr 2022 14:01:15 +0000
Subject: [R] Confusing fori or ifelse result in matrix manipulation
In-Reply-To: <09a90ba0470a47626f93455aeb0e83e3@freier.de>
References: <09a90ba0470a47626f93455aeb0e83e3@freier.de>
Message-ID: <BN6PR2201MB1553F06C70875D683CC87366CFF89@BN6PR2201MB1553.namprd22.prod.outlook.com>

A <- matrix(1:9,ncol=3)
x <- c(0,1,0)
M <- matrix(ncol=3,nrow=3)
M<-A
for(i in 1:3) {
  if(x[i]){
    M[,i] <-0
    }
  } 
}
M

The outcome you want is to set all of the middle column values to zero. So I used x as a logical in an if test and when true everything in that column is set to zero.

Your approach also works but you must go through each element explicitly.
A <- matrix(1:9,ncol=3)
x <- c(0,1,0)
M <- matrix(ncol=3,nrow=3)
for(j in 1:3){
  for(i in 1:3){
    ifelse(x[i]==1, M[j,i]<-0, M[j,i]<-A[j,i])
  }
}
M



Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Uwe Freier
Sent: Sunday, April 24, 2022 11:06 AM
To: r-help at r-project.org
Subject: [R] Confusing fori or ifelse result in matrix manipulation

[External Email]

Hello,

sorry for the newbie question but I can't find out where I'm wrong.

A <- matrix(1:9,ncol=3)
x <- c(0,1,0)
M <- matrix(ncol=3,nrow=3)
for(i in 1:3) {
  M[,i] <- ifelse(x[i] == 0, A[,i], 0)
}

expected:

> M
      [,1] [,2] [,3]
[1,]    1    0    7
[2,]    2    0    8
[3,]    3    0    9


but the result is:

> M
      [,1] [,2] [,3]
[1,]    1    0    7
[2,]    1    0    7
[3,]    1    0    7


If I do it "manually":

> M[,1] <- A[,1]
> M[,2] <- 0
> M[,3] <- A[,3]

M is as expected, where is my misconception?

Thanks for any hint and best regards,

Uwe

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=K2RWPvtxaxwigGGH2oOrg8qiDWC5KTu60b8Wjybwsg4&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=L9VXAAYzIzrG2h17hBO-Qfg_EoS2mRQbjs3sRESp62Q&e=
and provide commented, minimal, self-contained, reproducible code.


From |v@n@c@|@ndr@ @end|ng |rom rgzm@de  Mon Apr 25 16:18:15 2022
From: |v@n@c@|@ndr@ @end|ng |rom rgzm@de (Ivan Calandra)
Date: Mon, 25 Apr 2022 16:18:15 +0200
Subject: [R] Confusing fori or ifelse result in matrix manipulation
In-Reply-To: <BN6PR2201MB1553F06C70875D683CC87366CFF89@BN6PR2201MB1553.namprd22.prod.outlook.com>
References: <09a90ba0470a47626f93455aeb0e83e3@freier.de>
 <BN6PR2201MB1553F06C70875D683CC87366CFF89@BN6PR2201MB1553.namprd22.prod.outlook.com>
Message-ID: <7bbaddbb-b373-3c95-9ff5-f9353f8b8c11@rgzm.de>

Hi Uwe,

If I understood the problem completely and building up on Tim's answer, 
this is even easier:
M <- A <- matrix(1:9, ncol = 3)
x <- c(0, 1, 0)
M[, x == 1] <- 0
M

The original issue was with the way ifelse works. The explanation is in 
the help page: "ifelse returns a value with the same shape as test||".
So, because x[i] == 0 returns a single value (TRUE or FALSE), ifelse 
will also return a single value (either A[, i][1] or 0) and not a vector 
of length 3 as you wanted. This single value is recycled to fill M[, i], 
hence the result.

HTH,
Ivan

--
Dr. Ivan Calandra
Imaging lab
RGZM - MONREPOS Archaeological Research Centre
Schloss Monrepos
56567 Neuwied, Germany
+49 (0) 2631 9772-243
https://www.researchgate.net/profile/Ivan_Calandra

On 25/04/2022 16:01, Ebert,Timothy Aaron wrote:
> A <- matrix(1:9,ncol=3)
> x <- c(0,1,0)
> M <- matrix(ncol=3,nrow=3)
> M<-A
> for(i in 1:3) {
>    if(x[i]){
>      M[,i] <-0
>      }
>    }
> }
> M
>
> The outcome you want is to set all of the middle column values to zero. So I used x as a logical in an if test and when true everything in that column is set to zero.
>
> Your approach also works but you must go through each element explicitly.
> A <- matrix(1:9,ncol=3)
> x <- c(0,1,0)
> M <- matrix(ncol=3,nrow=3)
> for(j in 1:3){
>    for(i in 1:3){
>      ifelse(x[i]==1, M[j,i]<-0, M[j,i]<-A[j,i])
>    }
> }
> M
>
>
>
> Tim
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Uwe Freier
> Sent: Sunday, April 24, 2022 11:06 AM
> To: r-help at r-project.org
> Subject: [R] Confusing fori or ifelse result in matrix manipulation
>
> [External Email]
>
> Hello,
>
> sorry for the newbie question but I can't find out where I'm wrong.
>
> A <- matrix(1:9,ncol=3)
> x <- c(0,1,0)
> M <- matrix(ncol=3,nrow=3)
> for(i in 1:3) {
>    M[,i] <- ifelse(x[i] == 0, A[,i], 0)
> }
>
> expected:
>
>> M
>        [,1] [,2] [,3]
> [1,]    1    0    7
> [2,]    2    0    8
> [3,]    3    0    9
>
>
> but the result is:
>
>> M
>        [,1] [,2] [,3]
> [1,]    1    0    7
> [2,]    1    0    7
> [3,]    1    0    7
>
>
> If I do it "manually":
>
>> M[,1] <- A[,1]
>> M[,2] <- 0
>> M[,3] <- A[,3]
> M is as expected, where is my misconception?
>
> Thanks for any hint and best regards,
>
> Uwe
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=K2RWPvtxaxwigGGH2oOrg8qiDWC5KTu60b8Wjybwsg4&e=
> PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=L9VXAAYzIzrG2h17hBO-Qfg_EoS2mRQbjs3sRESp62Q&e=
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Mon Apr 25 16:30:14 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 25 Apr 2022 07:30:14 -0700
Subject: [R] Confusing fori or ifelse result in matrix manipulation
In-Reply-To: <7bbaddbb-b373-3c95-9ff5-f9353f8b8c11@rgzm.de>
References: <09a90ba0470a47626f93455aeb0e83e3@freier.de>
 <BN6PR2201MB1553F06C70875D683CC87366CFF89@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <7bbaddbb-b373-3c95-9ff5-f9353f8b8c11@rgzm.de>
Message-ID: <CAGxFJbQ94kb9GzyiafWzRF9ObTCS-LUs7MxDdhgUD5e6nmmUug@mail.gmail.com>

x == 1 is the same as M[, x] so your expression is the same as
M[, c(FALSE, TRUE, FALSE)] <- 0
which is the same as M[, 2]  <- 0

So what is the point of all this, exactly?

Bert

On Mon, Apr 25, 2022 at 7:18 AM Ivan Calandra <ivan.calandra at rgzm.de> wrote:
>
> Hi Uwe,
>
> If I understood the problem completely and building up on Tim's answer,
> this is even easier:
> M <- A <- matrix(1:9, ncol = 3)
> x <- c(0, 1, 0)
> M[, x == 1] <- 0
> M
>
> The original issue was with the way ifelse works. The explanation is in
> the help page: "ifelse returns a value with the same shape as test||".
> So, because x[i] == 0 returns a single value (TRUE or FALSE), ifelse
> will also return a single value (either A[, i][1] or 0) and not a vector
> of length 3 as you wanted. This single value is recycled to fill M[, i],
> hence the result.
>
> HTH,
> Ivan
>
> --
> Dr. Ivan Calandra
> Imaging lab
> RGZM - MONREPOS Archaeological Research Centre
> Schloss Monrepos
> 56567 Neuwied, Germany
> +49 (0) 2631 9772-243
> https://www.researchgate.net/profile/Ivan_Calandra
>
> On 25/04/2022 16:01, Ebert,Timothy Aaron wrote:
> > A <- matrix(1:9,ncol=3)
> > x <- c(0,1,0)
> > M <- matrix(ncol=3,nrow=3)
> > M<-A
> > for(i in 1:3) {
> >    if(x[i]){
> >      M[,i] <-0
> >      }
> >    }
> > }
> > M
> >
> > The outcome you want is to set all of the middle column values to zero. So I used x as a logical in an if test and when true everything in that column is set to zero.
> >
> > Your approach also works but you must go through each element explicitly.
> > A <- matrix(1:9,ncol=3)
> > x <- c(0,1,0)
> > M <- matrix(ncol=3,nrow=3)
> > for(j in 1:3){
> >    for(i in 1:3){
> >      ifelse(x[i]==1, M[j,i]<-0, M[j,i]<-A[j,i])
> >    }
> > }
> > M
> >
> >
> >
> > Tim
> >
> > -----Original Message-----
> > From: R-help <r-help-bounces at r-project.org> On Behalf Of Uwe Freier
> > Sent: Sunday, April 24, 2022 11:06 AM
> > To: r-help at r-project.org
> > Subject: [R] Confusing fori or ifelse result in matrix manipulation
> >
> > [External Email]
> >
> > Hello,
> >
> > sorry for the newbie question but I can't find out where I'm wrong.
> >
> > A <- matrix(1:9,ncol=3)
> > x <- c(0,1,0)
> > M <- matrix(ncol=3,nrow=3)
> > for(i in 1:3) {
> >    M[,i] <- ifelse(x[i] == 0, A[,i], 0)
> > }
> >
> > expected:
> >
> >> M
> >        [,1] [,2] [,3]
> > [1,]    1    0    7
> > [2,]    2    0    8
> > [3,]    3    0    9
> >
> >
> > but the result is:
> >
> >> M
> >        [,1] [,2] [,3]
> > [1,]    1    0    7
> > [2,]    1    0    7
> > [3,]    1    0    7
> >
> >
> > If I do it "manually":
> >
> >> M[,1] <- A[,1]
> >> M[,2] <- 0
> >> M[,3] <- A[,3]
> > M is as expected, where is my misconception?
> >
> > Thanks for any hint and best regards,
> >
> > Uwe
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=K2RWPvtxaxwigGGH2oOrg8qiDWC5KTu60b8Wjybwsg4&e=
> > PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=L9VXAAYzIzrG2h17hBO-Qfg_EoS2mRQbjs3sRESp62Q&e=
> > and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From er|cjberger @end|ng |rom gm@||@com  Mon Apr 25 16:33:13 2022
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Mon, 25 Apr 2022 17:33:13 +0300
Subject: [R] Confusing fori or ifelse result in matrix manipulation
In-Reply-To: <CAGxFJbQ94kb9GzyiafWzRF9ObTCS-LUs7MxDdhgUD5e6nmmUug@mail.gmail.com>
References: <09a90ba0470a47626f93455aeb0e83e3@freier.de>
 <BN6PR2201MB1553F06C70875D683CC87366CFF89@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <7bbaddbb-b373-3c95-9ff5-f9353f8b8c11@rgzm.de>
 <CAGxFJbQ94kb9GzyiafWzRF9ObTCS-LUs7MxDdhgUD5e6nmmUug@mail.gmail.com>
Message-ID: <CAGgJW77JvsgrmZoMn4LhXymSju9Rd4mC_XqZ25MmjwK9YkW-1Q@mail.gmail.com>

M[,x==1] is not the same as M[,x] :-)
However, M[,!!x] is the same as M[,x==1] and saves one character!
The point of this is "I can name that tune in ... " (as if that was not
obvious)



On Mon, Apr 25, 2022 at 5:30 PM Bert Gunter <bgunter.4567 at gmail.com> wrote:

> x == 1 is the same as M[, x] so your expression is the same as
> M[, c(FALSE, TRUE, FALSE)] <- 0
> which is the same as M[, 2]  <- 0
>
> So what is the point of all this, exactly?
>
> Bert
>
> On Mon, Apr 25, 2022 at 7:18 AM Ivan Calandra <ivan.calandra at rgzm.de>
> wrote:
> >
> > Hi Uwe,
> >
> > If I understood the problem completely and building up on Tim's answer,
> > this is even easier:
> > M <- A <- matrix(1:9, ncol = 3)
> > x <- c(0, 1, 0)
> > M[, x == 1] <- 0
> > M
> >
> > The original issue was with the way ifelse works. The explanation is in
> > the help page: "ifelse returns a value with the same shape as test||".
> > So, because x[i] == 0 returns a single value (TRUE or FALSE), ifelse
> > will also return a single value (either A[, i][1] or 0) and not a vector
> > of length 3 as you wanted. This single value is recycled to fill M[, i],
> > hence the result.
> >
> > HTH,
> > Ivan
> >
> > --
> > Dr. Ivan Calandra
> > Imaging lab
> > RGZM - MONREPOS Archaeological Research Centre
> > Schloss Monrepos
> > 56567 Neuwied, Germany
> > +49 (0) 2631 9772-243
> > https://www.researchgate.net/profile/Ivan_Calandra
> >
> > On 25/04/2022 16:01, Ebert,Timothy Aaron wrote:
> > > A <- matrix(1:9,ncol=3)
> > > x <- c(0,1,0)
> > > M <- matrix(ncol=3,nrow=3)
> > > M<-A
> > > for(i in 1:3) {
> > >    if(x[i]){
> > >      M[,i] <-0
> > >      }
> > >    }
> > > }
> > > M
> > >
> > > The outcome you want is to set all of the middle column values to
> zero. So I used x as a logical in an if test and when true everything in
> that column is set to zero.
> > >
> > > Your approach also works but you must go through each element
> explicitly.
> > > A <- matrix(1:9,ncol=3)
> > > x <- c(0,1,0)
> > > M <- matrix(ncol=3,nrow=3)
> > > for(j in 1:3){
> > >    for(i in 1:3){
> > >      ifelse(x[i]==1, M[j,i]<-0, M[j,i]<-A[j,i])
> > >    }
> > > }
> > > M
> > >
> > >
> > >
> > > Tim
> > >
> > > -----Original Message-----
> > > From: R-help <r-help-bounces at r-project.org> On Behalf Of Uwe Freier
> > > Sent: Sunday, April 24, 2022 11:06 AM
> > > To: r-help at r-project.org
> > > Subject: [R] Confusing fori or ifelse result in matrix manipulation
> > >
> > > [External Email]
> > >
> > > Hello,
> > >
> > > sorry for the newbie question but I can't find out where I'm wrong.
> > >
> > > A <- matrix(1:9,ncol=3)
> > > x <- c(0,1,0)
> > > M <- matrix(ncol=3,nrow=3)
> > > for(i in 1:3) {
> > >    M[,i] <- ifelse(x[i] == 0, A[,i], 0)
> > > }
> > >
> > > expected:
> > >
> > >> M
> > >        [,1] [,2] [,3]
> > > [1,]    1    0    7
> > > [2,]    2    0    8
> > > [3,]    3    0    9
> > >
> > >
> > > but the result is:
> > >
> > >> M
> > >        [,1] [,2] [,3]
> > > [1,]    1    0    7
> > > [2,]    1    0    7
> > > [3,]    1    0    7
> > >
> > >
> > > If I do it "manually":
> > >
> > >> M[,1] <- A[,1]
> > >> M[,2] <- 0
> > >> M[,3] <- A[,3]
> > > M is as expected, where is my misconception?
> > >
> > > Thanks for any hint and best regards,
> > >
> > > Uwe
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=K2RWPvtxaxwigGGH2oOrg8qiDWC5KTu60b8Wjybwsg4&e=
> > > PLEASE do read the posting guide
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=L9VXAAYzIzrG2h17hBO-Qfg_EoS2mRQbjs3sRESp62Q&e=
> > > and provide commented, minimal, self-contained, reproducible code.
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From |v@n@c@|@ndr@ @end|ng |rom rgzm@de  Mon Apr 25 16:38:25 2022
From: |v@n@c@|@ndr@ @end|ng |rom rgzm@de (Ivan Calandra)
Date: Mon, 25 Apr 2022 16:38:25 +0200
Subject: [R] Confusing fori or ifelse result in matrix manipulation
In-Reply-To: <CAGxFJbQ94kb9GzyiafWzRF9ObTCS-LUs7MxDdhgUD5e6nmmUug@mail.gmail.com>
References: <09a90ba0470a47626f93455aeb0e83e3@freier.de>
 <BN6PR2201MB1553F06C70875D683CC87366CFF89@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <7bbaddbb-b373-3c95-9ff5-f9353f8b8c11@rgzm.de>
 <CAGxFJbQ94kb9GzyiafWzRF9ObTCS-LUs7MxDdhgUD5e6nmmUug@mail.gmail.com>
Message-ID: <59e74e3a-c6f9-ffbb-10f9-21bafd830fd3@rgzm.de>

Indeed, M[, x] <- 0 does the same, but only if x is 0's and 1's only, 
right? I thought that it might not always be the case so I choose this 
maybe superflous approach.

M[, 2] does the same of course in the example, but I was assuming that 
the columns to change to zero are not known in advance and are based on 
data contained in another vector. Where that vector comes from is 
important too because the whole thing might be unnecessary. Is that 
maybe what you were hinting at, Bert?

Maybe Uwe can tell us more about what/why he wants to do!

Ivan

--
Dr. Ivan Calandra
Imaging lab
RGZM - MONREPOS Archaeological Research Centre
Schloss Monrepos
56567 Neuwied, Germany
+49 (0) 2631 9772-243
https://www.researchgate.net/profile/Ivan_Calandra

On 25/04/2022 16:30, Bert Gunter wrote:
> x == 1 is the same as M[, x] so your expression is the same as
> M[, c(FALSE, TRUE, FALSE)] <- 0
> which is the same as M[, 2]  <- 0
>
> So what is the point of all this, exactly?
>
> Bert
>
> On Mon, Apr 25, 2022 at 7:18 AM Ivan Calandra <ivan.calandra at rgzm.de> wrote:
>> Hi Uwe,
>>
>> If I understood the problem completely and building up on Tim's answer,
>> this is even easier:
>> M <- A <- matrix(1:9, ncol = 3)
>> x <- c(0, 1, 0)
>> M[, x == 1] <- 0
>> M
>>
>> The original issue was with the way ifelse works. The explanation is in
>> the help page: "ifelse returns a value with the same shape as test||".
>> So, because x[i] == 0 returns a single value (TRUE or FALSE), ifelse
>> will also return a single value (either A[, i][1] or 0) and not a vector
>> of length 3 as you wanted. This single value is recycled to fill M[, i],
>> hence the result.
>>
>> HTH,
>> Ivan
>>
>> --
>> Dr. Ivan Calandra
>> Imaging lab
>> RGZM - MONREPOS Archaeological Research Centre
>> Schloss Monrepos
>> 56567 Neuwied, Germany
>> +49 (0) 2631 9772-243
>> https://www.researchgate.net/profile/Ivan_Calandra
>>
>> On 25/04/2022 16:01, Ebert,Timothy Aaron wrote:
>>> A <- matrix(1:9,ncol=3)
>>> x <- c(0,1,0)
>>> M <- matrix(ncol=3,nrow=3)
>>> M<-A
>>> for(i in 1:3) {
>>>     if(x[i]){
>>>       M[,i] <-0
>>>       }
>>>     }
>>> }
>>> M
>>>
>>> The outcome you want is to set all of the middle column values to zero. So I used x as a logical in an if test and when true everything in that column is set to zero.
>>>
>>> Your approach also works but you must go through each element explicitly.
>>> A <- matrix(1:9,ncol=3)
>>> x <- c(0,1,0)
>>> M <- matrix(ncol=3,nrow=3)
>>> for(j in 1:3){
>>>     for(i in 1:3){
>>>       ifelse(x[i]==1, M[j,i]<-0, M[j,i]<-A[j,i])
>>>     }
>>> }
>>> M
>>>
>>>
>>>
>>> Tim
>>>
>>> -----Original Message-----
>>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Uwe Freier
>>> Sent: Sunday, April 24, 2022 11:06 AM
>>> To: r-help at r-project.org
>>> Subject: [R] Confusing fori or ifelse result in matrix manipulation
>>>
>>> [External Email]
>>>
>>> Hello,
>>>
>>> sorry for the newbie question but I can't find out where I'm wrong.
>>>
>>> A <- matrix(1:9,ncol=3)
>>> x <- c(0,1,0)
>>> M <- matrix(ncol=3,nrow=3)
>>> for(i in 1:3) {
>>>     M[,i] <- ifelse(x[i] == 0, A[,i], 0)
>>> }
>>>
>>> expected:
>>>
>>>> M
>>>         [,1] [,2] [,3]
>>> [1,]    1    0    7
>>> [2,]    2    0    8
>>> [3,]    3    0    9
>>>
>>>
>>> but the result is:
>>>
>>>> M
>>>         [,1] [,2] [,3]
>>> [1,]    1    0    7
>>> [2,]    1    0    7
>>> [3,]    1    0    7
>>>
>>>
>>> If I do it "manually":
>>>
>>>> M[,1] <- A[,1]
>>>> M[,2] <- 0
>>>> M[,3] <- A[,3]
>>> M is as expected, where is my misconception?
>>>
>>> Thanks for any hint and best regards,
>>>
>>> Uwe
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=K2RWPvtxaxwigGGH2oOrg8qiDWC5KTu60b8Wjybwsg4&e=
>>> PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=L9VXAAYzIzrG2h17hBO-Qfg_EoS2mRQbjs3sRESp62Q&e=
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Mon Apr 25 16:39:33 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 25 Apr 2022 07:39:33 -0700
Subject: [R] Confusing fori or ifelse result in matrix manipulation
In-Reply-To: <CAGgJW77JvsgrmZoMn4LhXymSju9Rd4mC_XqZ25MmjwK9YkW-1Q@mail.gmail.com>
References: <09a90ba0470a47626f93455aeb0e83e3@freier.de>
 <BN6PR2201MB1553F06C70875D683CC87366CFF89@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <7bbaddbb-b373-3c95-9ff5-f9353f8b8c11@rgzm.de>
 <CAGxFJbQ94kb9GzyiafWzRF9ObTCS-LUs7MxDdhgUD5e6nmmUug@mail.gmail.com>
 <CAGgJW77JvsgrmZoMn4LhXymSju9Rd4mC_XqZ25MmjwK9YkW-1Q@mail.gmail.com>
Message-ID: <CAGxFJbSSh7w_31=3E+yOoWxsv+BA-36TOwzRTWNM3KguuWYm2A@mail.gmail.com>

Yes, sorry. But it's with the logical cast it's still M[, c(FALSE,
TRUE, FALSE)] which is M[, 2], and so I still don't get the point.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Mon, Apr 25, 2022 at 7:33 AM Eric Berger <ericjberger at gmail.com> wrote:
>
> M[,x==1] is not the same as M[,x] :-)
> However, M[,!!x] is the same as M[,x==1] and saves one character!
> The point of this is "I can name that tune in ... " (as if that was not obvious)
>
>
>
> On Mon, Apr 25, 2022 at 5:30 PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>>
>> x == 1 is the same as M[, x] so your expression is the same as
>> M[, c(FALSE, TRUE, FALSE)] <- 0
>> which is the same as M[, 2]  <- 0
>>
>> So what is the point of all this, exactly?
>>
>> Bert
>>
>> On Mon, Apr 25, 2022 at 7:18 AM Ivan Calandra <ivan.calandra at rgzm.de> wrote:
>> >
>> > Hi Uwe,
>> >
>> > If I understood the problem completely and building up on Tim's answer,
>> > this is even easier:
>> > M <- A <- matrix(1:9, ncol = 3)
>> > x <- c(0, 1, 0)
>> > M[, x == 1] <- 0
>> > M
>> >
>> > The original issue was with the way ifelse works. The explanation is in
>> > the help page: "ifelse returns a value with the same shape as test||".
>> > So, because x[i] == 0 returns a single value (TRUE or FALSE), ifelse
>> > will also return a single value (either A[, i][1] or 0) and not a vector
>> > of length 3 as you wanted. This single value is recycled to fill M[, i],
>> > hence the result.
>> >
>> > HTH,
>> > Ivan
>> >
>> > --
>> > Dr. Ivan Calandra
>> > Imaging lab
>> > RGZM - MONREPOS Archaeological Research Centre
>> > Schloss Monrepos
>> > 56567 Neuwied, Germany
>> > +49 (0) 2631 9772-243
>> > https://www.researchgate.net/profile/Ivan_Calandra
>> >
>> > On 25/04/2022 16:01, Ebert,Timothy Aaron wrote:
>> > > A <- matrix(1:9,ncol=3)
>> > > x <- c(0,1,0)
>> > > M <- matrix(ncol=3,nrow=3)
>> > > M<-A
>> > > for(i in 1:3) {
>> > >    if(x[i]){
>> > >      M[,i] <-0
>> > >      }
>> > >    }
>> > > }
>> > > M
>> > >
>> > > The outcome you want is to set all of the middle column values to zero. So I used x as a logical in an if test and when true everything in that column is set to zero.
>> > >
>> > > Your approach also works but you must go through each element explicitly.
>> > > A <- matrix(1:9,ncol=3)
>> > > x <- c(0,1,0)
>> > > M <- matrix(ncol=3,nrow=3)
>> > > for(j in 1:3){
>> > >    for(i in 1:3){
>> > >      ifelse(x[i]==1, M[j,i]<-0, M[j,i]<-A[j,i])
>> > >    }
>> > > }
>> > > M
>> > >
>> > >
>> > >
>> > > Tim
>> > >
>> > > -----Original Message-----
>> > > From: R-help <r-help-bounces at r-project.org> On Behalf Of Uwe Freier
>> > > Sent: Sunday, April 24, 2022 11:06 AM
>> > > To: r-help at r-project.org
>> > > Subject: [R] Confusing fori or ifelse result in matrix manipulation
>> > >
>> > > [External Email]
>> > >
>> > > Hello,
>> > >
>> > > sorry for the newbie question but I can't find out where I'm wrong.
>> > >
>> > > A <- matrix(1:9,ncol=3)
>> > > x <- c(0,1,0)
>> > > M <- matrix(ncol=3,nrow=3)
>> > > for(i in 1:3) {
>> > >    M[,i] <- ifelse(x[i] == 0, A[,i], 0)
>> > > }
>> > >
>> > > expected:
>> > >
>> > >> M
>> > >        [,1] [,2] [,3]
>> > > [1,]    1    0    7
>> > > [2,]    2    0    8
>> > > [3,]    3    0    9
>> > >
>> > >
>> > > but the result is:
>> > >
>> > >> M
>> > >        [,1] [,2] [,3]
>> > > [1,]    1    0    7
>> > > [2,]    1    0    7
>> > > [3,]    1    0    7
>> > >
>> > >
>> > > If I do it "manually":
>> > >
>> > >> M[,1] <- A[,1]
>> > >> M[,2] <- 0
>> > >> M[,3] <- A[,3]
>> > > M is as expected, where is my misconception?
>> > >
>> > > Thanks for any hint and best regards,
>> > >
>> > > Uwe
>> > >
>> > > ______________________________________________
>> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=K2RWPvtxaxwigGGH2oOrg8qiDWC5KTu60b8Wjybwsg4&e=
>> > > PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=L9VXAAYzIzrG2h17hBO-Qfg_EoS2mRQbjs3sRESp62Q&e=
>> > > and provide commented, minimal, self-contained, reproducible code.
>> > >
>> > > ______________________________________________
>> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > > https://stat.ethz.ch/mailman/listinfo/r-help
>> > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> > > and provide commented, minimal, self-contained, reproducible code.
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Mon Apr 25 16:44:12 2022
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Mon, 25 Apr 2022 07:44:12 -0700
Subject: [R] about opening R script Chinese annotation garble problem
In-Reply-To: <fb029612-768c-c2ea-0bd1-9d0b95424f76@effectivedefense.org>
References: <tencent_82D863BBEAA3B88125F6D1FF41F885529406@qq.com>
 <fb029612-768c-c2ea-0bd1-9d0b95424f76@effectivedefense.org>
Message-ID: <5E582590-CD07-43A4-8BA2-075640DA0563@dcn.davis.ca.us>

Some are, per the Posting Guide. But it can be challenging to convince your mail client to send them with the appropriate MIME settings, so attachments are generally best avoided.

Character encodings are a non-trivial challenge also... results are highly sensitive to operating-system configuration and use of "fileEncoding" and "encoding" text input options, as well as the output device support for text encodings (including thr R console/terminal). This [1] has been informative for me, though I am by no means an expert. If OP can frame the question with knowledge from that blog and include the output from the sessionInfo() function, they might get a more informative response here.

[1] https://kevinushey.github.io/blog/2018/02/21/string-encoding-and-r/

On April 25, 2022 4:16:06 AM PDT, Spencer Graves <spencer.graves at effectivedefense.org> wrote:
>	  Attachments are NOT delivered to the readers of this list.
>
>
>	  PLEASE do read the posting guide http://www.R-project.org/posting-guide.html and provide commented, minimal, self-contained, reproducible code.  This includes sessionInfo().  If you can reproduce it on multiple platforms, that would help.  Can you can post the image to the web someplace (e.g., a Google Drive) and provide the link?  That would help, also.
>
>
>	  Thanks,
>	  Spencer Graves
>
>
>On 4/23/22 8:38 PM, ?? via R-help wrote:
>> Garbled characters appear in Chinese annotation when opening program script using RGui (see attached picture). I use a variety of methods have not been solved, I hope to help me solve this problem. Thank you.
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From er|cjberger @end|ng |rom gm@||@com  Mon Apr 25 16:44:10 2022
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Mon, 25 Apr 2022 17:44:10 +0300
Subject: [R] Confusing fori or ifelse result in matrix manipulation
In-Reply-To: <59e74e3a-c6f9-ffbb-10f9-21bafd830fd3@rgzm.de>
References: <09a90ba0470a47626f93455aeb0e83e3@freier.de>
 <BN6PR2201MB1553F06C70875D683CC87366CFF89@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <7bbaddbb-b373-3c95-9ff5-f9353f8b8c11@rgzm.de>
 <CAGxFJbQ94kb9GzyiafWzRF9ObTCS-LUs7MxDdhgUD5e6nmmUug@mail.gmail.com>
 <59e74e3a-c6f9-ffbb-10f9-21bafd830fd3@rgzm.de>
Message-ID: <CAGgJW75hUsy6+iveN9Pys=gvkWnsM9dYYKY6SbLY+8NguJzZjA@mail.gmail.com>

M[,x] <- 0 *does not do the same* !! even if x only contains 0's and 1's

To understand this, note that
M[,c(2,3)]
gives columns 2 and 3
M[,c(0,3)]
gives the 3rd column and
M[,c(0,1,0)]
gives the *first* column!!



On Mon, Apr 25, 2022 at 5:41 PM Ivan Calandra <ivan.calandra at rgzm.de> wrote:

> Indeed, M[, x] <- 0 does the same, but only if x is 0's and 1's only,
> right? I thought that it might not always be the case so I choose this
> maybe superflous approach.
>
> M[, 2] does the same of course in the example, but I was assuming that
> the columns to change to zero are not known in advance and are based on
> data contained in another vector. Where that vector comes from is
> important too because the whole thing might be unnecessary. Is that
> maybe what you were hinting at, Bert?
>
> Maybe Uwe can tell us more about what/why he wants to do!
>
> Ivan
>
> --
> Dr. Ivan Calandra
> Imaging lab
> RGZM - MONREPOS Archaeological Research Centre
> Schloss Monrepos
> 56567 Neuwied, Germany
> +49 (0) 2631 9772-243
> https://www.researchgate.net/profile/Ivan_Calandra
>
> On 25/04/2022 16:30, Bert Gunter wrote:
> > x == 1 is the same as M[, x] so your expression is the same as
> > M[, c(FALSE, TRUE, FALSE)] <- 0
> > which is the same as M[, 2]  <- 0
> >
> > So what is the point of all this, exactly?
> >
> > Bert
> >
> > On Mon, Apr 25, 2022 at 7:18 AM Ivan Calandra <ivan.calandra at rgzm.de>
> wrote:
> >> Hi Uwe,
> >>
> >> If I understood the problem completely and building up on Tim's answer,
> >> this is even easier:
> >> M <- A <- matrix(1:9, ncol = 3)
> >> x <- c(0, 1, 0)
> >> M[, x == 1] <- 0
> >> M
> >>
> >> The original issue was with the way ifelse works. The explanation is in
> >> the help page: "ifelse returns a value with the same shape as test||".
> >> So, because x[i] == 0 returns a single value (TRUE or FALSE), ifelse
> >> will also return a single value (either A[, i][1] or 0) and not a vector
> >> of length 3 as you wanted. This single value is recycled to fill M[, i],
> >> hence the result.
> >>
> >> HTH,
> >> Ivan
> >>
> >> --
> >> Dr. Ivan Calandra
> >> Imaging lab
> >> RGZM - MONREPOS Archaeological Research Centre
> >> Schloss Monrepos
> >> 56567 Neuwied, Germany
> >> +49 (0) 2631 9772-243
> >> https://www.researchgate.net/profile/Ivan_Calandra
> >>
> >> On 25/04/2022 16:01, Ebert,Timothy Aaron wrote:
> >>> A <- matrix(1:9,ncol=3)
> >>> x <- c(0,1,0)
> >>> M <- matrix(ncol=3,nrow=3)
> >>> M<-A
> >>> for(i in 1:3) {
> >>>     if(x[i]){
> >>>       M[,i] <-0
> >>>       }
> >>>     }
> >>> }
> >>> M
> >>>
> >>> The outcome you want is to set all of the middle column values to
> zero. So I used x as a logical in an if test and when true everything in
> that column is set to zero.
> >>>
> >>> Your approach also works but you must go through each element
> explicitly.
> >>> A <- matrix(1:9,ncol=3)
> >>> x <- c(0,1,0)
> >>> M <- matrix(ncol=3,nrow=3)
> >>> for(j in 1:3){
> >>>     for(i in 1:3){
> >>>       ifelse(x[i]==1, M[j,i]<-0, M[j,i]<-A[j,i])
> >>>     }
> >>> }
> >>> M
> >>>
> >>>
> >>>
> >>> Tim
> >>>
> >>> -----Original Message-----
> >>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Uwe Freier
> >>> Sent: Sunday, April 24, 2022 11:06 AM
> >>> To: r-help at r-project.org
> >>> Subject: [R] Confusing fori or ifelse result in matrix manipulation
> >>>
> >>> [External Email]
> >>>
> >>> Hello,
> >>>
> >>> sorry for the newbie question but I can't find out where I'm wrong.
> >>>
> >>> A <- matrix(1:9,ncol=3)
> >>> x <- c(0,1,0)
> >>> M <- matrix(ncol=3,nrow=3)
> >>> for(i in 1:3) {
> >>>     M[,i] <- ifelse(x[i] == 0, A[,i], 0)
> >>> }
> >>>
> >>> expected:
> >>>
> >>>> M
> >>>         [,1] [,2] [,3]
> >>> [1,]    1    0    7
> >>> [2,]    2    0    8
> >>> [3,]    3    0    9
> >>>
> >>>
> >>> but the result is:
> >>>
> >>>> M
> >>>         [,1] [,2] [,3]
> >>> [1,]    1    0    7
> >>> [2,]    1    0    7
> >>> [3,]    1    0    7
> >>>
> >>>
> >>> If I do it "manually":
> >>>
> >>>> M[,1] <- A[,1]
> >>>> M[,2] <- 0
> >>>> M[,3] <- A[,3]
> >>> M is as expected, where is my misconception?
> >>>
> >>> Thanks for any hint and best regards,
> >>>
> >>> Uwe
> >>>
> >>> ______________________________________________
> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=K2RWPvtxaxwigGGH2oOrg8qiDWC5KTu60b8Wjybwsg4&e=
> >>> PLEASE do read the posting guide
> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=L9VXAAYzIzrG2h17hBO-Qfg_EoS2mRQbjs3sRESp62Q&e=
> >>> and provide commented, minimal, self-contained, reproducible code.
> >>>
> >>> ______________________________________________
> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >>> and provide commented, minimal, self-contained, reproducible code.
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Mon Apr 25 16:51:13 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 25 Apr 2022 07:51:13 -0700
Subject: [R] Confusing fori or ifelse result in matrix manipulation
In-Reply-To: <CAGxFJbSSh7w_31=3E+yOoWxsv+BA-36TOwzRTWNM3KguuWYm2A@mail.gmail.com>
References: <09a90ba0470a47626f93455aeb0e83e3@freier.de>
 <BN6PR2201MB1553F06C70875D683CC87366CFF89@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <7bbaddbb-b373-3c95-9ff5-f9353f8b8c11@rgzm.de>
 <CAGxFJbQ94kb9GzyiafWzRF9ObTCS-LUs7MxDdhgUD5e6nmmUug@mail.gmail.com>
 <CAGgJW77JvsgrmZoMn4LhXymSju9Rd4mC_XqZ25MmjwK9YkW-1Q@mail.gmail.com>
 <CAGxFJbSSh7w_31=3E+yOoWxsv+BA-36TOwzRTWNM3KguuWYm2A@mail.gmail.com>
Message-ID: <CAGxFJbQomZ4NPNfi+oN7wDuQcWEHpqvUQhdWOzxdttvPeAw=4Q@mail.gmail.com>

Oh, I get it. The context was in  choosing columns to set to 0 via a
**predicate**.

Sorry for the noise.


Bert

On Mon, Apr 25, 2022 at 7:39 AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> Yes, sorry. But it's with the logical cast it's still M[, c(FALSE,
> TRUE, FALSE)] which is M[, 2], and so I still don't get the point.
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> On Mon, Apr 25, 2022 at 7:33 AM Eric Berger <ericjberger at gmail.com> wrote:
> >
> > M[,x==1] is not the same as M[,x] :-)
> > However, M[,!!x] is the same as M[,x==1] and saves one character!
> > The point of this is "I can name that tune in ... " (as if that was not obvious)
> >
> >
> >
> > On Mon, Apr 25, 2022 at 5:30 PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >>
> >> x == 1 is the same as M[, x] so your expression is the same as
> >> M[, c(FALSE, TRUE, FALSE)] <- 0
> >> which is the same as M[, 2]  <- 0
> >>
> >> So what is the point of all this, exactly?
> >>
> >> Bert
> >>
> >> On Mon, Apr 25, 2022 at 7:18 AM Ivan Calandra <ivan.calandra at rgzm.de> wrote:
> >> >
> >> > Hi Uwe,
> >> >
> >> > If I understood the problem completely and building up on Tim's answer,
> >> > this is even easier:
> >> > M <- A <- matrix(1:9, ncol = 3)
> >> > x <- c(0, 1, 0)
> >> > M[, x == 1] <- 0
> >> > M
> >> >
> >> > The original issue was with the way ifelse works. The explanation is in
> >> > the help page: "ifelse returns a value with the same shape as test||".
> >> > So, because x[i] == 0 returns a single value (TRUE or FALSE), ifelse
> >> > will also return a single value (either A[, i][1] or 0) and not a vector
> >> > of length 3 as you wanted. This single value is recycled to fill M[, i],
> >> > hence the result.
> >> >
> >> > HTH,
> >> > Ivan
> >> >
> >> > --
> >> > Dr. Ivan Calandra
> >> > Imaging lab
> >> > RGZM - MONREPOS Archaeological Research Centre
> >> > Schloss Monrepos
> >> > 56567 Neuwied, Germany
> >> > +49 (0) 2631 9772-243
> >> > https://www.researchgate.net/profile/Ivan_Calandra
> >> >
> >> > On 25/04/2022 16:01, Ebert,Timothy Aaron wrote:
> >> > > A <- matrix(1:9,ncol=3)
> >> > > x <- c(0,1,0)
> >> > > M <- matrix(ncol=3,nrow=3)
> >> > > M<-A
> >> > > for(i in 1:3) {
> >> > >    if(x[i]){
> >> > >      M[,i] <-0
> >> > >      }
> >> > >    }
> >> > > }
> >> > > M
> >> > >
> >> > > The outcome you want is to set all of the middle column values to zero. So I used x as a logical in an if test and when true everything in that column is set to zero.
> >> > >
> >> > > Your approach also works but you must go through each element explicitly.
> >> > > A <- matrix(1:9,ncol=3)
> >> > > x <- c(0,1,0)
> >> > > M <- matrix(ncol=3,nrow=3)
> >> > > for(j in 1:3){
> >> > >    for(i in 1:3){
> >> > >      ifelse(x[i]==1, M[j,i]<-0, M[j,i]<-A[j,i])
> >> > >    }
> >> > > }
> >> > > M
> >> > >
> >> > >
> >> > >
> >> > > Tim
> >> > >
> >> > > -----Original Message-----
> >> > > From: R-help <r-help-bounces at r-project.org> On Behalf Of Uwe Freier
> >> > > Sent: Sunday, April 24, 2022 11:06 AM
> >> > > To: r-help at r-project.org
> >> > > Subject: [R] Confusing fori or ifelse result in matrix manipulation
> >> > >
> >> > > [External Email]
> >> > >
> >> > > Hello,
> >> > >
> >> > > sorry for the newbie question but I can't find out where I'm wrong.
> >> > >
> >> > > A <- matrix(1:9,ncol=3)
> >> > > x <- c(0,1,0)
> >> > > M <- matrix(ncol=3,nrow=3)
> >> > > for(i in 1:3) {
> >> > >    M[,i] <- ifelse(x[i] == 0, A[,i], 0)
> >> > > }
> >> > >
> >> > > expected:
> >> > >
> >> > >> M
> >> > >        [,1] [,2] [,3]
> >> > > [1,]    1    0    7
> >> > > [2,]    2    0    8
> >> > > [3,]    3    0    9
> >> > >
> >> > >
> >> > > but the result is:
> >> > >
> >> > >> M
> >> > >        [,1] [,2] [,3]
> >> > > [1,]    1    0    7
> >> > > [2,]    1    0    7
> >> > > [3,]    1    0    7
> >> > >
> >> > >
> >> > > If I do it "manually":
> >> > >
> >> > >> M[,1] <- A[,1]
> >> > >> M[,2] <- 0
> >> > >> M[,3] <- A[,3]
> >> > > M is as expected, where is my misconception?
> >> > >
> >> > > Thanks for any hint and best regards,
> >> > >
> >> > > Uwe
> >> > >
> >> > > ______________________________________________
> >> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=K2RWPvtxaxwigGGH2oOrg8qiDWC5KTu60b8Wjybwsg4&e=
> >> > > PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=L9VXAAYzIzrG2h17hBO-Qfg_EoS2mRQbjs3sRESp62Q&e=
> >> > > and provide commented, minimal, self-contained, reproducible code.
> >> > >
> >> > > ______________________________________________
> >> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> > > https://stat.ethz.ch/mailman/listinfo/r-help
> >> > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >> > > and provide commented, minimal, self-contained, reproducible code.
> >> >
> >> > ______________________________________________
> >> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> > https://stat.ethz.ch/mailman/listinfo/r-help
> >> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >> > and provide commented, minimal, self-contained, reproducible code.
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.


From |v@n@c@|@ndr@ @end|ng |rom rgzm@de  Mon Apr 25 16:52:03 2022
From: |v@n@c@|@ndr@ @end|ng |rom rgzm@de (Ivan Calandra)
Date: Mon, 25 Apr 2022 16:52:03 +0200
Subject: [R] Confusing fori or ifelse result in matrix manipulation
In-Reply-To: <CAGgJW75hUsy6+iveN9Pys=gvkWnsM9dYYKY6SbLY+8NguJzZjA@mail.gmail.com>
References: <09a90ba0470a47626f93455aeb0e83e3@freier.de>
 <BN6PR2201MB1553F06C70875D683CC87366CFF89@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <7bbaddbb-b373-3c95-9ff5-f9353f8b8c11@rgzm.de>
 <CAGxFJbQ94kb9GzyiafWzRF9ObTCS-LUs7MxDdhgUD5e6nmmUug@mail.gmail.com>
 <59e74e3a-c6f9-ffbb-10f9-21bafd830fd3@rgzm.de>
 <CAGgJW75hUsy6+iveN9Pys=gvkWnsM9dYYKY6SbLY+8NguJzZjA@mail.gmail.com>
Message-ID: <d9f89bb8-a45b-f30c-fcb9-f65d800a5892@rgzm.de>

Indeed, of course, my bad! I got confused by Bert's answer...

So my first suggestion to do M[, x == 1] was correct :)

--
Dr. Ivan Calandra
Imaging lab
RGZM - MONREPOS Archaeological Research Centre
Schloss Monrepos
56567 Neuwied, Germany
+49 (0) 2631 9772-243
https://www.researchgate.net/profile/Ivan_Calandra

On 25/04/2022 16:44, Eric Berger wrote:
> M[,x] <- 0 *does not do the same* !! even if x only contains 0's and 1's
>
> To understand this, note that
> M[,c(2,3)]
> gives columns 2 and 3
> M[,c(0,3)]
> gives the 3rd column and
> M[,c(0,1,0)]
> gives the *first* column!!
>
>
>
> On Mon, Apr 25, 2022 at 5:41 PM Ivan Calandra <ivan.calandra at rgzm.de> 
> wrote:
>
>     Indeed, M[, x] <- 0 does the same, but only if x is 0's and 1's only,
>     right? I thought that it might not always be the case so I choose
>     this
>     maybe superflous approach.
>
>     M[, 2] does the same of course in the example, but I was assuming
>     that
>     the columns to change to zero are not known in advance and are
>     based on
>     data contained in another vector. Where that vector comes from is
>     important too because the whole thing might be unnecessary. Is that
>     maybe what you were hinting at, Bert?
>
>     Maybe Uwe can tell us more about what/why he wants to do!
>
>     Ivan
>
>     --
>     Dr. Ivan Calandra
>     Imaging lab
>     RGZM - MONREPOS Archaeological Research Centre
>     Schloss Monrepos
>     56567 Neuwied, Germany
>     +49 (0) 2631 9772-243
>     https://www.researchgate.net/profile/Ivan_Calandra
>
>     On 25/04/2022 16:30, Bert Gunter wrote:
>     > x == 1 is the same as M[, x] so your expression is the same as
>     > M[, c(FALSE, TRUE, FALSE)] <- 0
>     > which is the same as M[, 2]? <- 0
>     >
>     > So what is the point of all this, exactly?
>     >
>     > Bert
>     >
>     > On Mon, Apr 25, 2022 at 7:18 AM Ivan Calandra
>     <ivan.calandra at rgzm.de> wrote:
>     >> Hi Uwe,
>     >>
>     >> If I understood the problem completely and building up on Tim's
>     answer,
>     >> this is even easier:
>     >> M <- A <- matrix(1:9, ncol = 3)
>     >> x <- c(0, 1, 0)
>     >> M[, x == 1] <- 0
>     >> M
>     >>
>     >> The original issue was with the way ifelse works. The
>     explanation is in
>     >> the help page: "ifelse returns a value with the same shape as
>     test||".
>     >> So, because x[i] == 0 returns a single value (TRUE or FALSE),
>     ifelse
>     >> will also return a single value (either A[, i][1] or 0) and not
>     a vector
>     >> of length 3 as you wanted. This single value is recycled to
>     fill M[, i],
>     >> hence the result.
>     >>
>     >> HTH,
>     >> Ivan
>     >>
>     >> --
>     >> Dr. Ivan Calandra
>     >> Imaging lab
>     >> RGZM - MONREPOS Archaeological Research Centre
>     >> Schloss Monrepos
>     >> 56567 Neuwied, Germany
>     >> +49 (0) 2631 9772-243
>     >> https://www.researchgate.net/profile/Ivan_Calandra
>     >>
>     >> On 25/04/2022 16:01, Ebert,Timothy Aaron wrote:
>     >>> A <- matrix(1:9,ncol=3)
>     >>> x <- c(0,1,0)
>     >>> M <- matrix(ncol=3,nrow=3)
>     >>> M<-A
>     >>> for(i in 1:3) {
>     >>>? ? ?if(x[i]){
>     >>>? ? ? ?M[,i] <-0
>     >>>? ? ? ?}
>     >>>? ? ?}
>     >>> }
>     >>> M
>     >>>
>     >>> The outcome you want is to set all of the middle column values
>     to zero. So I used x as a logical in an if test and when true
>     everything in that column is set to zero.
>     >>>
>     >>> Your approach also works but you must go through each element
>     explicitly.
>     >>> A <- matrix(1:9,ncol=3)
>     >>> x <- c(0,1,0)
>     >>> M <- matrix(ncol=3,nrow=3)
>     >>> for(j in 1:3){
>     >>>? ? ?for(i in 1:3){
>     >>>? ? ? ?ifelse(x[i]==1, M[j,i]<-0, M[j,i]<-A[j,i])
>     >>>? ? ?}
>     >>> }
>     >>> M
>     >>>
>     >>>
>     >>>
>     >>> Tim
>     >>>
>     >>> -----Original Message-----
>     >>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Uwe
>     Freier
>     >>> Sent: Sunday, April 24, 2022 11:06 AM
>     >>> To: r-help at r-project.org
>     >>> Subject: [R] Confusing fori or ifelse result in matrix
>     manipulation
>     >>>
>     >>> [External Email]
>     >>>
>     >>> Hello,
>     >>>
>     >>> sorry for the newbie question but I can't find out where I'm
>     wrong.
>     >>>
>     >>> A <- matrix(1:9,ncol=3)
>     >>> x <- c(0,1,0)
>     >>> M <- matrix(ncol=3,nrow=3)
>     >>> for(i in 1:3) {
>     >>>? ? ?M[,i] <- ifelse(x[i] == 0, A[,i], 0)
>     >>> }
>     >>>
>     >>> expected:
>     >>>
>     >>>> M
>     >>>? ? ? ? ?[,1] [,2] [,3]
>     >>> [1,]? ? 1? ? 0? ? 7
>     >>> [2,]? ? 2? ? 0? ? 8
>     >>> [3,]? ? 3? ? 0? ? 9
>     >>>
>     >>>
>     >>> but the result is:
>     >>>
>     >>>> M
>     >>>? ? ? ? ?[,1] [,2] [,3]
>     >>> [1,]? ? 1? ? 0? ? 7
>     >>> [2,]? ? 1? ? 0? ? 7
>     >>> [3,]? ? 1? ? 0? ? 7
>     >>>
>     >>>
>     >>> If I do it "manually":
>     >>>
>     >>>> M[,1] <- A[,1]
>     >>>> M[,2] <- 0
>     >>>> M[,3] <- A[,3]
>     >>> M is as expected, where is my misconception?
>     >>>
>     >>> Thanks for any hint and best regards,
>     >>>
>     >>> Uwe
>     >>>
>     >>> ______________________________________________
>     >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more,
>     see
>     https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=K2RWPvtxaxwigGGH2oOrg8qiDWC5KTu60b8Wjybwsg4&e=
>     <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=K2RWPvtxaxwigGGH2oOrg8qiDWC5KTu60b8Wjybwsg4&e=>
>     >>> PLEASE do read the posting guide
>     https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=L9VXAAYzIzrG2h17hBO-Qfg_EoS2mRQbjs3sRESp62Q&e=
>     <https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=L9VXAAYzIzrG2h17hBO-Qfg_EoS2mRQbjs3sRESp62Q&e=>
>     >>> and provide commented, minimal, self-contained, reproducible code.
>     >>>
>     >>> ______________________________________________
>     >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>     >>> https://stat.ethz.ch/mailman/listinfo/r-help
>     >>> PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>     >>> and provide commented, minimal, self-contained, reproducible code.
>     >> ______________________________________________
>     >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>     >> https://stat.ethz.ch/mailman/listinfo/r-help
>     >> PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>     >> and provide commented, minimal, self-contained, reproducible code.
>
>     ______________________________________________
>     R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>     https://stat.ethz.ch/mailman/listinfo/r-help
>     PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>     and provide commented, minimal, self-contained, reproducible code.
>


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Apr 25 17:25:13 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 25 Apr 2022 16:25:13 +0100
Subject: [R] Confusing fori or ifelse result in matrix manipulation
In-Reply-To: <d9f89bb8-a45b-f30c-fcb9-f65d800a5892@rgzm.de>
References: <09a90ba0470a47626f93455aeb0e83e3@freier.de>
 <BN6PR2201MB1553F06C70875D683CC87366CFF89@BN6PR2201MB1553.namprd22.prod.outlook.com>
 <7bbaddbb-b373-3c95-9ff5-f9353f8b8c11@rgzm.de>
 <CAGxFJbQ94kb9GzyiafWzRF9ObTCS-LUs7MxDdhgUD5e6nmmUug@mail.gmail.com>
 <59e74e3a-c6f9-ffbb-10f9-21bafd830fd3@rgzm.de>
 <CAGgJW75hUsy6+iveN9Pys=gvkWnsM9dYYKY6SbLY+8NguJzZjA@mail.gmail.com>
 <d9f89bb8-a45b-f30c-fcb9-f65d800a5892@rgzm.de>
Message-ID: <fc17126e-7dad-1f26-9843-a701df2b196c@sapo.pt>

Hello,

If !!x obfuscates what the is doing, there's


M[, as.logical(x)] <- 0


Hope this helps,

Rui Barradas

?s 15:52 de 25/04/2022, Ivan Calandra escreveu:
> Indeed, of course, my bad! I got confused by Bert's answer...
> 
> So my first suggestion to do M[, x == 1] was correct :)
> 
> -- 
> Dr. Ivan Calandra
> Imaging lab
> RGZM - MONREPOS Archaeological Research Centre
> Schloss Monrepos
> 56567 Neuwied, Germany
> +49 (0) 2631 9772-243
> https://www.researchgate.net/profile/Ivan_Calandra
> 
> On 25/04/2022 16:44, Eric Berger wrote:
>> M[,x] <- 0 *does not do the same* !! even if x only contains 0's and 1's
>>
>> To understand this, note that
>> M[,c(2,3)]
>> gives columns 2 and 3
>> M[,c(0,3)]
>> gives the 3rd column and
>> M[,c(0,1,0)]
>> gives the *first* column!!
>>
>>
>>
>> On Mon, Apr 25, 2022 at 5:41 PM Ivan Calandra <ivan.calandra at rgzm.de> 
>> wrote:
>>
>> ??? Indeed, M[, x] <- 0 does the same, but only if x is 0's and 1's only,
>> ??? right? I thought that it might not always be the case so I choose
>> ??? this
>> ??? maybe superflous approach.
>>
>> ??? M[, 2] does the same of course in the example, but I was assuming
>> ??? that
>> ??? the columns to change to zero are not known in advance and are
>> ??? based on
>> ??? data contained in another vector. Where that vector comes from is
>> ??? important too because the whole thing might be unnecessary. Is that
>> ??? maybe what you were hinting at, Bert?
>>
>> ??? Maybe Uwe can tell us more about what/why he wants to do!
>>
>> ??? Ivan
>>
>> ??? --
>> ??? Dr. Ivan Calandra
>> ??? Imaging lab
>> ??? RGZM - MONREPOS Archaeological Research Centre
>> ??? Schloss Monrepos
>> ??? 56567 Neuwied, Germany
>> ??? +49 (0) 2631 9772-243
>> ??? https://www.researchgate.net/profile/Ivan_Calandra
>>
>> ??? On 25/04/2022 16:30, Bert Gunter wrote:
>> ??? > x == 1 is the same as M[, x] so your expression is the same as
>> ??? > M[, c(FALSE, TRUE, FALSE)] <- 0
>> ??? > which is the same as M[, 2]? <- 0
>> ??? >
>> ??? > So what is the point of all this, exactly?
>> ??? >
>> ??? > Bert
>> ??? >
>> ??? > On Mon, Apr 25, 2022 at 7:18 AM Ivan Calandra
>> ??? <ivan.calandra at rgzm.de> wrote:
>> ??? >> Hi Uwe,
>> ??? >>
>> ??? >> If I understood the problem completely and building up on Tim's
>> ??? answer,
>> ??? >> this is even easier:
>> ??? >> M <- A <- matrix(1:9, ncol = 3)
>> ??? >> x <- c(0, 1, 0)
>> ??? >> M[, x == 1] <- 0
>> ??? >> M
>> ??? >>
>> ??? >> The original issue was with the way ifelse works. The
>> ??? explanation is in
>> ??? >> the help page: "ifelse returns a value with the same shape as
>> ??? test||".
>> ??? >> So, because x[i] == 0 returns a single value (TRUE or FALSE),
>> ??? ifelse
>> ??? >> will also return a single value (either A[, i][1] or 0) and not
>> ??? a vector
>> ??? >> of length 3 as you wanted. This single value is recycled to
>> ??? fill M[, i],
>> ??? >> hence the result.
>> ??? >>
>> ??? >> HTH,
>> ??? >> Ivan
>> ??? >>
>> ??? >> --
>> ??? >> Dr. Ivan Calandra
>> ??? >> Imaging lab
>> ??? >> RGZM - MONREPOS Archaeological Research Centre
>> ??? >> Schloss Monrepos
>> ??? >> 56567 Neuwied, Germany
>> ??? >> +49 (0) 2631 9772-243
>> ??? >> https://www.researchgate.net/profile/Ivan_Calandra
>> ??? >>
>> ??? >> On 25/04/2022 16:01, Ebert,Timothy Aaron wrote:
>> ??? >>> A <- matrix(1:9,ncol=3)
>> ??? >>> x <- c(0,1,0)
>> ??? >>> M <- matrix(ncol=3,nrow=3)
>> ??? >>> M<-A
>> ??? >>> for(i in 1:3) {
>> ??? >>>? ? ?if(x[i]){
>> ??? >>>? ? ? ?M[,i] <-0
>> ??? >>>? ? ? ?}
>> ??? >>>? ? ?}
>> ??? >>> }
>> ??? >>> M
>> ??? >>>
>> ??? >>> The outcome you want is to set all of the middle column values
>> ??? to zero. So I used x as a logical in an if test and when true
>> ??? everything in that column is set to zero.
>> ??? >>>
>> ??? >>> Your approach also works but you must go through each element
>> ??? explicitly.
>> ??? >>> A <- matrix(1:9,ncol=3)
>> ??? >>> x <- c(0,1,0)
>> ??? >>> M <- matrix(ncol=3,nrow=3)
>> ??? >>> for(j in 1:3){
>> ??? >>>? ? ?for(i in 1:3){
>> ??? >>>? ? ? ?ifelse(x[i]==1, M[j,i]<-0, M[j,i]<-A[j,i])
>> ??? >>>? ? ?}
>> ??? >>> }
>> ??? >>> M
>> ??? >>>
>> ??? >>>
>> ??? >>>
>> ??? >>> Tim
>> ??? >>>
>> ??? >>> -----Original Message-----
>> ??? >>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Uwe
>> ??? Freier
>> ??? >>> Sent: Sunday, April 24, 2022 11:06 AM
>> ??? >>> To: r-help at r-project.org
>> ??? >>> Subject: [R] Confusing fori or ifelse result in matrix
>> ??? manipulation
>> ??? >>>
>> ??? >>> [External Email]
>> ??? >>>
>> ??? >>> Hello,
>> ??? >>>
>> ??? >>> sorry for the newbie question but I can't find out where I'm
>> ??? wrong.
>> ??? >>>
>> ??? >>> A <- matrix(1:9,ncol=3)
>> ??? >>> x <- c(0,1,0)
>> ??? >>> M <- matrix(ncol=3,nrow=3)
>> ??? >>> for(i in 1:3) {
>> ??? >>>? ? ?M[,i] <- ifelse(x[i] == 0, A[,i], 0)
>> ??? >>> }
>> ??? >>>
>> ??? >>> expected:
>> ??? >>>
>> ??? >>>> M
>> ??? >>>? ? ? ? ?[,1] [,2] [,3]
>> ??? >>> [1,]? ? 1? ? 0? ? 7
>> ??? >>> [2,]? ? 2? ? 0? ? 8
>> ??? >>> [3,]? ? 3? ? 0? ? 9
>> ??? >>>
>> ??? >>>
>> ??? >>> but the result is:
>> ??? >>>
>> ??? >>>> M
>> ??? >>>? ? ? ? ?[,1] [,2] [,3]
>> ??? >>> [1,]? ? 1? ? 0? ? 7
>> ??? >>> [2,]? ? 1? ? 0? ? 7
>> ??? >>> [3,]? ? 1? ? 0? ? 7
>> ??? >>>
>> ??? >>>
>> ??? >>> If I do it "manually":
>> ??? >>>
>> ??? >>>> M[,1] <- A[,1]
>> ??? >>>> M[,2] <- 0
>> ??? >>>> M[,3] <- A[,3]
>> ??? >>> M is as expected, where is my misconception?
>> ??? >>>
>> ??? >>> Thanks for any hint and best regards,
>> ??? >>>
>> ??? >>> Uwe
>> ??? >>>
>> ??? >>> ______________________________________________
>> ??? >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more,
>> ??? see
>>     
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=K2RWPvtxaxwigGGH2oOrg8qiDWC5KTu60b8Wjybwsg4&e= 
>>
>>     
>> <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=K2RWPvtxaxwigGGH2oOrg8qiDWC5KTu60b8Wjybwsg4&e=> 
>>
>> ??? >>> PLEASE do read the posting guide
>>     
>> https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=L9VXAAYzIzrG2h17hBO-Qfg_EoS2mRQbjs3sRESp62Q&e= 
>>
>>     
>> <https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=eyJm06tVDfKvtMDgz6oIWM-WVdoW3Szzb5G6rq0cCO_cB6ljj2x80E4oRkt3Vgba&s=L9VXAAYzIzrG2h17hBO-Qfg_EoS2mRQbjs3sRESp62Q&e=> 
>>
>> ??? >>> and provide commented, minimal, self-contained, reproducible 
>> code.
>> ??? >>>
>> ??? >>> ______________________________________________
>> ??? >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> ??? >>> https://stat.ethz.ch/mailman/listinfo/r-help
>> ??? >>> PLEASE do read the posting guide
>> ??? http://www.R-project.org/posting-guide.html
>> ??? <http://www.R-project.org/posting-guide.html>
>> ??? >>> and provide commented, minimal, self-contained, reproducible 
>> code.
>> ??? >> ______________________________________________
>> ??? >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> ??? >> https://stat.ethz.ch/mailman/listinfo/r-help
>> ??? >> PLEASE do read the posting guide
>> ??? http://www.R-project.org/posting-guide.html
>> ??? <http://www.R-project.org/posting-guide.html>
>> ??? >> and provide commented, minimal, self-contained, reproducible code.
>>
>> ??? ______________________________________________
>> ??? R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> ??? https://stat.ethz.ch/mailman/listinfo/r-help
>> ??? PLEASE do read the posting guide
>> ??? http://www.R-project.org/posting-guide.html
>> ??? <http://www.R-project.org/posting-guide.html>
>> ??? and provide commented, minimal, self-contained, reproducible code.
>>
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From w||||@mwdun|@p @end|ng |rom gm@||@com  Mon Apr 25 17:52:10 2022
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Mon, 25 Apr 2022 08:52:10 -0700
Subject: [R] about opening R script Chinese annotation garble problem
In-Reply-To: <tencent_82D863BBEAA3B88125F6D1FF41F885529406@qq.com>
References: <tencent_82D863BBEAA3B88125F6D1FF41F885529406@qq.com>
Message-ID: <CAHqSRuQRcG1bs4qh487O3Sfz8gX3gXD7WepGtueKOOaN8hHY0Q@mail.gmail.com>

The answer depends on the encoding of the file containing the Chinese
characters and on the version of R (since you are using Windows).  I copied
your subject line into Wordpad and and added some syntax to make a valid R
expression
  s <- "?? via R-help"
I then saved it with the type "Unicode Text Document".  In my version of
Wordpad this means UTF-16.  The bytes in the file are
  4.2.0> readBin("Chinese-utf-16.txt", what="raw",
n=file.size("Chinese-utf-16.txt"))
   [1] ff fe 73 00 20 00 3c 00 2d 00 20 00 22 00 38 6c 1b 52
  [19] 20 00 76 00 69 00 61 00 20 00 52 00 2d 00 68 00 65 00
  [37] 6c 00 70 00 22 00 0d 00 0a 00
All the nulls in the file are a hint that this is encoded using UTF-16, not
UTF-8.

With R-4.2.0 (released a few days ago) I can source the file with
  4.2.0> source("Chinese-utf-16.txt", encoding="UTF-16")
  4.2.0> s
  [1] "?? via R-help"
  4.2.0> Encoding(s)
  [1] "UTF-8"

With R-4.1.2 I get
  > source("Chinese-utf-16.txt", encoding="UTF-16")
  Error in source("Chinese-utf-16.txt", encoding = "UTF-16") :
    Chinese-utf-16.txt:1:6: unexpected INCOMPLETE_STRING
  1: s <- "
           ^
  In addition: Warning message:
  In readLines(file, warn = FALSE) :
    invalid input found on input connection 'Chinese-utf-16.txt'
  > source(file("Chinese-utf-16.txt", encoding="UTF-16"))
  > s
  [1] "<U+6C38><U+521B> via R-help"
  > source(file("Chinese-utf-16.txt", encoding="UTF-16"), encoding="UTF-8")
  > s
  [1] "?? via R-help"
  > Encoding(s)
  [1] "UTF-8"
  > charToRaw(s)
   [1] e6 b0 b8 e5 88 9b 20 76 69 61 20 52 2d 68 65 6c 70

R-4.2.0 makes this much easier.

-Bill

On Mon, Apr 25, 2022 at 1:04 AM ?? via R-help <r-help at r-project.org> wrote:

> Garbled characters appear in Chinese annotation when opening program
> script using RGui (see attached picture). I use a variety of methods have
> not been solved, I hope to help me solve this problem. Thank you.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From w||||@mwdun|@p @end|ng |rom gm@||@com  Mon Apr 25 19:52:26 2022
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Mon, 25 Apr 2022 10:52:26 -0700
Subject: [R] about opening R script Chinese annotation garble problem
In-Reply-To: <CAHqSRuQRcG1bs4qh487O3Sfz8gX3gXD7WepGtueKOOaN8hHY0Q@mail.gmail.com>
References: <tencent_82D863BBEAA3B88125F6D1FF41F885529406@qq.com>
 <CAHqSRuQRcG1bs4qh487O3Sfz8gX3gXD7WepGtueKOOaN8hHY0Q@mail.gmail.com>
Message-ID: <CAHqSRuRHQ9qgmX1mC7-tEs+FubC0kCragCZW83T4=BKLnUL8fQ@mail.gmail.com>

If your file is encoded as UTF-8 (as most stuff on the internet is, there
will be no null bytes in the file), then R-4.2.0 on a recent enough version
of Windows can source() it without mentioning the encoding.

-Bill

On Mon, Apr 25, 2022 at 8:52 AM Bill Dunlap <williamwdunlap at gmail.com>
wrote:

> The answer depends on the encoding of the file containing the Chinese
> characters and on the version of R (since you are using Windows).  I copied
> your subject line into Wordpad and and added some syntax to make a valid R
> expression
>   s <- "?? via R-help"
> I then saved it with the type "Unicode Text Document".  In my version of
> Wordpad this means UTF-16.  The bytes in the file are
>   4.2.0> readBin("Chinese-utf-16.txt", what="raw",
> n=file.size("Chinese-utf-16.txt"))
>    [1] ff fe 73 00 20 00 3c 00 2d 00 20 00 22 00 38 6c 1b 52
>   [19] 20 00 76 00 69 00 61 00 20 00 52 00 2d 00 68 00 65 00
>   [37] 6c 00 70 00 22 00 0d 00 0a 00
> All the nulls in the file are a hint that this is encoded using UTF-16,
> not UTF-8.
>
> With R-4.2.0 (released a few days ago) I can source the file with
>   4.2.0> source("Chinese-utf-16.txt", encoding="UTF-16")
>   4.2.0> s
>   [1] "?? via R-help"
>   4.2.0> Encoding(s)
>   [1] "UTF-8"
>
> With R-4.1.2 I get
>   > source("Chinese-utf-16.txt", encoding="UTF-16")
>   Error in source("Chinese-utf-16.txt", encoding = "UTF-16") :
>     Chinese-utf-16.txt:1:6: unexpected INCOMPLETE_STRING
>   1: s <- "
>            ^
>   In addition: Warning message:
>   In readLines(file, warn = FALSE) :
>     invalid input found on input connection 'Chinese-utf-16.txt'
>   > source(file("Chinese-utf-16.txt", encoding="UTF-16"))
>   > s
>   [1] "<U+6C38><U+521B> via R-help"
>   > source(file("Chinese-utf-16.txt", encoding="UTF-16"), encoding="UTF-8")
>   > s
>   [1] "?? via R-help"
>   > Encoding(s)
>   [1] "UTF-8"
>   > charToRaw(s)
>    [1] e6 b0 b8 e5 88 9b 20 76 69 61 20 52 2d 68 65 6c 70
>
> R-4.2.0 makes this much easier.
>
> -Bill
>
> On Mon, Apr 25, 2022 at 1:04 AM ?? via R-help <r-help at r-project.org>
> wrote:
>
>> Garbled characters appear in Chinese annotation when opening program
>> script using RGui (see attached picture). I use a variety of methods have
>> not been solved, I hope to help me solve this problem. Thank you.
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From j@b@y@t194 @end|ng |rom gm@||@com  Tue Apr 26 11:20:41 2022
From: j@b@y@t194 @end|ng |rom gm@||@com (javad bayat)
Date: Tue, 26 Apr 2022 13:50:41 +0430
Subject: [R] Convert one rectangle into two rectangles
Message-ID: <CANTxAm+_kHtuLvGJC53i+c51FuMB7jSN3gQyfR3tUC=GhsOwyw@mail.gmail.com>

Dear R users;
I want to convert a rectangle into 2 new rectangles. I have a rectangle (18
m * 200 m), and I want to subtract 45 percent of it's area as a new
rectangle. Is it possible to do this in R?
Sincerely.

	[[alternative HTML version deleted]]


From n|co|@@@deg@|||er @end|ng |rom |ree@|r  Tue Apr 26 15:03:28 2022
From: n|co|@@@deg@|||er @end|ng |rom |ree@|r (Nicolas Degallier)
Date: Tue, 26 Apr 2022 15:03:28 +0200
Subject: [R] 
 conversion of d m s (lat) d m s (long) coordinates into decimal
 coordinates
In-Reply-To: <7360CF88-97B5-484B-A15F-046CA8670061@free.fr>
References: <A4CD90DD-8EEF-410B-B528-9B0EC92DECD0@free.fr>
 <4d991288-6f43-8d6a-9a88-67076316ecb9@sapo.pt>
 <7360CF88-97B5-484B-A15F-046CA8670061@free.fr>
Message-ID: <E52FDC00-AFC5-4BF0-B789-138603B9562D@free.fr>

Hi Rui,

I succeded to convert a coordinate from decimal to DMS formats but not the inverse!!!

 dd<- -52.55684
c<-dd2dms(dd, NS = FALSE)
c
[1] 52d33'24.624"W
> 

The use of char2dms() function is not so easy because I cannot yet read() the text file with the DMS coordinates (one col. with the points names, lat col. and long. col.)!!


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: coordDegal.txt
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20220426/3a87a17d/attachment.txt>

-------------- next part --------------


Cheers
Nicolas




Hello,

Here is the link to the archived versions of package measurements [1].
But the edit to that answer has another solution, with sp::char2dms and you are loading package sp.


[1] https://cran.hafro.is/src/contrib/Archive/measurements/

Hope this helps,

Rui Barradas

?s 10:57 de 25/04/2022, Nicolas Degallier escreveu:
> Hi Rui,
> Thanks for the information.
> Unfortunately, my versions of MacOS and of R are too old:
> > install.packages("measurements")
> Warning message:
> package ?measurements? is not available (for R version 3.2.1)
> > library(measurements)
> Warning message:
> le package ?measurements? a ?t? compil? avec la version R 3.2.5
> There is no older package to do the same?
> Cheers
> Nicolas
> Le 25 avr. 2022 ? 11:12, Rui Barradas a ?crit :
>> Hello,
>> 
>> See if this StackOverflow.com <http://StackOverflow.com> post [1] solves your problem.
>> 
>> Also, examples should be minimal, you don't need all those packages to solve this problem.
>> 
>> 
>> [1] https://stackoverflow.com/a/69485865/8245406 <https://stackoverflow.com/a/69485865/8245406>
>> 
>> 
>> Hope this helps,
>> 
>> Rui Barradas
>> 
>> ?s 21:43 de 24/04/2022, Nicolas Degallier escreveu:
>>> Dear R Users,
>>> I am using a 'simple' script to draw maps with points.
>>> It runs fine with the following libraries:
>>> library(sp)
>>> library(maptools)
>>> library(maps)
>>> library(mapdata)
>>> library(RColorBrewer)
>>> library(MASS)
>>> library(rgeos)
>>> library(GISTools)
>>> Until now, to prepare the input data, I have used manually some free net converter because the number of points to plot was not too high.
>>> Now I have much more points coordinates to convert from a GPS ? ' " (d m s) format to a decimal format which will be accepted by the R script to build maps.
>>> My initial data is of the form (tab delimited text file):
>>> nomlatlong
>>> "D. antoinei"6?04' S50?12'W
>>> "D. antoinei"3?45'S49?40'W
>>> "D. antoinei"3?1'49"N53?6'24"W
>>> "D. barberoi"13?03.3?S71?32.7?W
>>> "D. barberoi"10?59.3?S75?25.5?W"
>>> and I need them in the format (tab delimited):
>>> nomlatlong
>>> "D. antoinei"-11.944478527683975-71.28298997950684
>>> "D. antoinei"-12.833333-69.333333
>>> "D. antoinei"3.333333-60.283333
>>> "D. barberoi"-10.366667-67.683333
>>> "D. barberoi"-15.314500-55.970300
>>> Is there some 'simple' R script to do such a conversion?
>>> I am using R v. 3.2.1. on a iMac OS 10.6.8.
>>> May be this topic had already been resolved but I was unable to find the result in the FAQs.
>>> Cheers
>>> Nicolas Degallier
>>> <nicolas.degallier at free.fr <mailto:nicolas.degallier at free.fr>>
>>> <omalodes at yahoo.fr <mailto:omalodes at yahoo.fr>>
>>> Publications :
>>> https://www.documentation.ird.fr/listes/parauteur/DEGALLIER/NICOLAS/tout/annee <https://www.documentation.ird.fr/listes/parauteur/DEGALLIER/NICOLAS/tout/annee>
>>> ______________________________________________
>>> R-help at r-project.org <mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help <https://stat.ethz.ch/mailman/listinfo/r-help>
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html <http://www.R-project.org/posting-guide.html>
>>> and provide commented, minimal, self-contained, reproducible code.

From tebert @end|ng |rom u||@edu  Tue Apr 26 18:32:07 2022
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Tue, 26 Apr 2022 16:32:07 +0000
Subject: [R] Convert one rectangle into two rectangles
In-Reply-To: <CANTxAm+_kHtuLvGJC53i+c51FuMB7jSN3gQyfR3tUC=GhsOwyw@mail.gmail.com>
References: <CANTxAm+_kHtuLvGJC53i+c51FuMB7jSN3gQyfR3tUC=GhsOwyw@mail.gmail.com>
Message-ID: <BN6PR2201MB1553510F572AD31BB81A99B7CFFB9@BN6PR2201MB1553.namprd22.prod.outlook.com>

Yes it is possible, but contingent on exactly what you want to do and the form of your data. Is this a picture with a rectangle, or is this a rectangular matrix?

If there is one pixel per square meter then the matrix has dimensions 18 by 200. 45% of 200 is 90. 
Mat <- matrix(0, nrow=18, ncol=200)
Mat1 <- Mat[,1:90]
Mat2 <- Mat[,91:200]


If this is a graphical question, my thought would be to try Python. You would have to get Python to identify the rectangle and then give it some rules to split the rectangle. 

Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of javad bayat
Sent: Tuesday, April 26, 2022 5:21 AM
To: R-help at r-project.org
Subject: [R] Convert one rectangle into two rectangles

[External Email]

Dear R users;
I want to convert a rectangle into 2 new rectangles. I have a rectangle (18 m * 200 m), and I want to subtract 45 percent of it's area as a new rectangle. Is it possible to do this in R?
Sincerely.

        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dhelp&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=IT-iqd3VDNxH2pOQdJCv8la_J55nS5LrQMIs0gfoO4vYuZZXZdcV4UNweZVSctI6&s=2r0VJdEfq7-vH9GlxUtWS1235uMTfJyX2BUMRfTtmlk&e=
PLEASE do read the posting guide https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org_posting-2Dguide.html&d=DwICAg&c=sJ6xIWYx-zLMB3EPkvcnVg&r=9PEhQh2kVeAsRzsn7AkP-g&m=IT-iqd3VDNxH2pOQdJCv8la_J55nS5LrQMIs0gfoO4vYuZZXZdcV4UNweZVSctI6&s=pcSG7rjvhu775rq8Y8piGcqBjUz8fzP4m52PU17pUXg&e=
and provide commented, minimal, self-contained, reproducible code.


From @v|gro@@ @end|ng |rom ver|zon@net  Tue Apr 26 19:24:35 2022
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Tue, 26 Apr 2022 17:24:35 +0000 (UTC)
Subject: [R] Convert one rectangle into two rectangles
In-Reply-To: <CANTxAm+_kHtuLvGJC53i+c51FuMB7jSN3gQyfR3tUC=GhsOwyw@mail.gmail.com>
References: <CANTxAm+_kHtuLvGJC53i+c51FuMB7jSN3gQyfR3tUC=GhsOwyw@mail.gmail.com>
Message-ID: <1887932069.876763.1650993875711@mail.yahoo.com>

>>> Is it possible to do this in R?

Is it possible?
Yes, I am sure if it can be done in any language, it can also be done in R.
The real question is do you have an algorithm you can come up with to try?to implement in R or?any other method?
You know the lengths of your initial rectangle. So you can calculate your?area.
You can also calculate what 45% and 55% of that area is.
Hint: are you being asked to make two totally new rectangles?with an infinite number of solutions, or subdivide the existing?rectangle into two joined parts? That can lead to two fairly easy answers.

-----Original Message-----
From: javad bayat <j.bayat194 at gmail.com>
To: R-help at r-project.org
Sent: Tue, Apr 26, 2022 5:20 am
Subject: [R] Convert one rectangle into two rectangles

Dear R users;
I want to convert a rectangle into 2 new rectangles. I have a rectangle (18
m * 200 m), and I want to subtract 45 percent of it's area as a new
rectangle. Is it possible to do this in R?
Sincerely.

??? [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From uwe @end|ng |rom |re|er@de  Tue Apr 26 20:10:58 2022
From: uwe @end|ng |rom |re|er@de (Uwe Freier)
Date: Tue, 26 Apr 2022 20:10:58 +0200
Subject: [R] Confusing fori or ifelse result in matrix manipulation
Message-ID: <353ba8ababe4ba2ea7dd02f2fd7b09b9@freier.de>

Hello,

many thanks for your replies. The code I've posted was simplified and 
depicted my problem basically. Of course my intention was not to add 
0-columns to a matrix, the problem resulted from my approach to add only 
eigenvectors to a matrix if the corresponding eigenvalue is element of 
real numbers, otherwise 0. So now I've learned that following code does 
it:

A is the matrix with the eigenvalues and -vectors of my interest
M <- matrix(ncol=8,nrow=8)
> for(i in 1:8) {
      M[,i] <- if(Im(eigen(A)$val[i]) == 0) eigen(A)$vec[,i] else 0
}

Many thanks again!

Uwe


From bgunter@4567 @end|ng |rom gm@||@com  Tue Apr 26 21:41:11 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 26 Apr 2022 12:41:11 -0700
Subject: [R] Convert one rectangle into two rectangles
In-Reply-To: <1887932069.876763.1650993875711@mail.yahoo.com>
References: <CANTxAm+_kHtuLvGJC53i+c51FuMB7jSN3gQyfR3tUC=GhsOwyw@mail.gmail.com>
 <1887932069.876763.1650993875711@mail.yahoo.com>
Message-ID: <CAGxFJbRaifOZPy+GcYH5U=gwHba2rBoctmn0immN-NK10J5o=A@mail.gmail.com>

Sounds like homework. We try not to do homework here (if it is). See
the posting guide linked below for details.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Tue, Apr 26, 2022 at 10:24 AM Avi Gross via R-help
<r-help at r-project.org> wrote:
>
> >>> Is it possible to do this in R?
>
> Is it possible?
> Yes, I am sure if it can be done in any language, it can also be done in R.
> The real question is do you have an algorithm you can come up with to try to implement in R or any other method?
> You know the lengths of your initial rectangle. So you can calculate your area.
> You can also calculate what 45% and 55% of that area is.
> Hint: are you being asked to make two totally new rectangles with an infinite number of solutions, or subdivide the existing rectangle into two joined parts? That can lead to two fairly easy answers.
>
> -----Original Message-----
> From: javad bayat <j.bayat194 at gmail.com>
> To: R-help at r-project.org
> Sent: Tue, Apr 26, 2022 5:20 am
> Subject: [R] Convert one rectangle into two rectangles
>
> Dear R users;
> I want to convert a rectangle into 2 new rectangles. I have a rectangle (18
> m * 200 m), and I want to subtract 45 percent of it's area as a new
> rectangle. Is it possible to do this in R?
> Sincerely.
>
>     [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Tue Apr 26 22:04:34 2022
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Tue, 26 Apr 2022 21:04:34 +0100
Subject: [R] 
 conversion of d m s (lat) d m s (long) coordinates into decimal
 coordinates
In-Reply-To: <E52FDC00-AFC5-4BF0-B789-138603B9562D@free.fr>
References: <A4CD90DD-8EEF-410B-B528-9B0EC92DECD0@free.fr>
 <4d991288-6f43-8d6a-9a88-67076316ecb9@sapo.pt>
 <7360CF88-97B5-484B-A15F-046CA8670061@free.fr>
 <E52FDC00-AFC5-4BF0-B789-138603B9562D@free.fr>
Message-ID: <e2021efc-d355-bbff-a963-a9a52333c720@sapo.pt>

Hello,

You have a problem with the numbers format and with the smart single 
close quotes. Try to substitute single quotes for the problem characters.

Hope this helps,

Rui Barradas

?s 14:03 de 26/04/2022, Nicolas Degallier escreveu:
> Hi Rui,
> 
> I succeded to convert a coordinate from decimal to DMS formats but not the inverse!!!
> 
>   dd<- -52.55684
> c<-dd2dms(dd, NS = FALSE)
> c
> [1] 52d33'24.624"W
>>
> 
> The use of char2dms() function is not so easy because I cannot yet read() the text file with the DMS coordinates (one col. with the points names, lat col. and long. col.)!!
> 
> 
> 
> 
> Cheers
> Nicolas
> 
> 
> 
> 
> Hello,
> 
> Here is the link to the archived versions of package measurements [1].
> But the edit to that answer has another solution, with sp::char2dms and you are loading package sp.
> 
> 
> [1] https://cran.hafro.is/src/contrib/Archive/measurements/
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 10:57 de 25/04/2022, Nicolas Degallier escreveu:
>> Hi Rui,
>> Thanks for the information.
>> Unfortunately, my versions of MacOS and of R are too old:
>>> install.packages("measurements")
>> Warning message:
>> package ?measurements? is not available (for R version 3.2.1)
>>> library(measurements)
>> Warning message:
>> le package ?measurements? a ?t? compil? avec la version R 3.2.5
>> There is no older package to do the same?
>> Cheers
>> Nicolas
>> Le 25 avr. 2022 ? 11:12, Rui Barradas a ?crit :
>>> Hello,
>>>
>>> See if this StackOverflow.com <http://StackOverflow.com> post [1] solves your problem.
>>>
>>> Also, examples should be minimal, you don't need all those packages to solve this problem.
>>>
>>>
>>> [1] https://stackoverflow.com/a/69485865/8245406 <https://stackoverflow.com/a/69485865/8245406>
>>>
>>>
>>> Hope this helps,
>>>
>>> Rui Barradas
>>>
>>> ?s 21:43 de 24/04/2022, Nicolas Degallier escreveu:
>>>> Dear R Users,
>>>> I am using a 'simple' script to draw maps with points.
>>>> It runs fine with the following libraries:
>>>> library(sp)
>>>> library(maptools)
>>>> library(maps)
>>>> library(mapdata)
>>>> library(RColorBrewer)
>>>> library(MASS)
>>>> library(rgeos)
>>>> library(GISTools)
>>>> Until now, to prepare the input data, I have used manually some free net converter because the number of points to plot was not too high.
>>>> Now I have much more points coordinates to convert from a GPS ? ' " (d m s) format to a decimal format which will be accepted by the R script to build maps.
>>>> My initial data is of the form (tab delimited text file):
>>>> nomlatlong
>>>> "D. antoinei"6?04' S50?12'W
>>>> "D. antoinei"3?45'S49?40'W
>>>> "D. antoinei"3?1'49"N53?6'24"W
>>>> "D. barberoi"13?03.3?S71?32.7?W
>>>> "D. barberoi"10?59.3?S75?25.5?W"
>>>> and I need them in the format (tab delimited):
>>>> nomlatlong
>>>> "D. antoinei"-11.944478527683975-71.28298997950684
>>>> "D. antoinei"-12.833333-69.333333
>>>> "D. antoinei"3.333333-60.283333
>>>> "D. barberoi"-10.366667-67.683333
>>>> "D. barberoi"-15.314500-55.970300
>>>> Is there some 'simple' R script to do such a conversion?
>>>> I am using R v. 3.2.1. on a iMac OS 10.6.8.
>>>> May be this topic had already been resolved but I was unable to find the result in the FAQs.
>>>> Cheers
>>>> Nicolas Degallier
>>>> <nicolas.degallier at free.fr <mailto:nicolas.degallier at free.fr>>
>>>> <omalodes at yahoo.fr <mailto:omalodes at yahoo.fr>>
>>>> Publications :
>>>> https://www.documentation.ird.fr/listes/parauteur/DEGALLIER/NICOLAS/tout/annee <https://www.documentation.ird.fr/listes/parauteur/DEGALLIER/NICOLAS/tout/annee>
>>>> ______________________________________________
>>>> R-help at r-project.org <mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help <https://stat.ethz.ch/mailman/listinfo/r-help>
>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html <http://www.R-project.org/posting-guide.html>
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.


From v@|kremk @end|ng |rom gm@||@com  Wed Apr 27 00:17:23 2022
From: v@|kremk @end|ng |rom gm@||@com (Val)
Date: Tue, 26 Apr 2022 17:17:23 -0500
Subject: [R] flag records
Message-ID: <CAJOiR6bTy0EYSs722zEryVViLvaDU=vpmmtFkxeDr_tCFFdNcw@mail.gmail.com>

Hi All,

I want to flag a record based on the following condition.
The variables  in the sample data are
State, name, day, text, ddate

Sort the data by State, name, day ddate,

Within  State, name, day
    assign consecutive number for each row
    find the date difference between consecutive rows,
    if the difference is less than 50 days and the text string in
previous and current rows  are the same then flag the record as X,
otherwise Y.

Here is  sample data and my attempt,

DF<-read.table(text="State name day text ddate
  CA A 1 xch 2014/09/16
  CA A 2 xck 2015/5/29
  CA A 2 xck 2015/6/18
  CA A 2 xcm 2015/8/3
  CA A 2 xcj 2015/8/26
  FL B 3 xcu  2017/7/23
  FL B 3 xcl  2017/7/03
  FL B 3 xmc  2017/7/26
  FL B 3 xca  2017/3/17
  FL B 3 xcb  2017/4/8
  FL B 4 xhh  2017/3/17
  FL B 4 xhh  2017/1/29",header=TRUE)

  DF$ddate   <- as.Date (as.Date(DF$ddate),  format="%Y/%m/%d" )
  DF3         <- DF[order(DF$State,DF$name,DF$day,xtfrm(DF$ddate)), ]
  DF3$C       <- with(DF3, ave(State, name, day, FUN = seq_along))
  DF3$diff    <- with(DF3, ave(as.integer(ddate), State, name, day,
FUN = function(x) x - x[1]))

I stopped here, how do I evaluate the previous and the current rows
text string and date difference?

Desired result,


     State name day text      ddate C diff flag
1     CA    A   1  xch 2014-09-16 1    0     y
2     CA    A   2  xck 2015-05-29 1    0      y
3     CA    A   2  xck 2015-06-18 2   20     x
4     CA    A   2  xcm 2015-08-03 3   66    y
5     CA    A   2  xcj 2015-08-26 4   89      y
9     FL    B   3  xca 2017-03-17 1    0      y
10    FL    B   3  xcb 2017-04-08 2   22    y
7     FL    B   3  xcl 2017-07-03 3   108     y
6     FL    B   3  xcu 2017-07-23 4  128    y
8     FL    B   3  xmc 2017-07-26 5  131   y
12    FL    B   4  xhh 2017-01-29 1    0     y
11    FL    B   4  xhh 2017-03-17 2   47    x



Thank you,


From bgunter@4567 @end|ng |rom gm@||@com  Wed Apr 27 00:41:30 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 26 Apr 2022 15:41:30 -0700
Subject: [R] flag records
In-Reply-To: <CAJOiR6bTy0EYSs722zEryVViLvaDU=vpmmtFkxeDr_tCFFdNcw@mail.gmail.com>
References: <CAJOiR6bTy0EYSs722zEryVViLvaDU=vpmmtFkxeDr_tCFFdNcw@mail.gmail.com>
Message-ID: <CAGxFJbT4VgwqP4HG8avmPxZghwK851TSXQ8qghefrS_99C76wQ@mail.gmail.com>

Sounds like homework. We try not to do homework here. See the posting
guide linked below for details.  (If not homework, let us know).

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Tue, Apr 26, 2022 at 3:17 PM Val <valkremk at gmail.com> wrote:
>
> Hi All,
>
> I want to flag a record based on the following condition.
> The variables  in the sample data are
> State, name, day, text, ddate
>
> Sort the data by State, name, day ddate,
>
> Within  State, name, day
>     assign consecutive number for each row
>     find the date difference between consecutive rows,
>     if the difference is less than 50 days and the text string in
> previous and current rows  are the same then flag the record as X,
> otherwise Y.
>
> Here is  sample data and my attempt,
>
> DF<-read.table(text="State name day text ddate
>   CA A 1 xch 2014/09/16
>   CA A 2 xck 2015/5/29
>   CA A 2 xck 2015/6/18
>   CA A 2 xcm 2015/8/3
>   CA A 2 xcj 2015/8/26
>   FL B 3 xcu  2017/7/23
>   FL B 3 xcl  2017/7/03
>   FL B 3 xmc  2017/7/26
>   FL B 3 xca  2017/3/17
>   FL B 3 xcb  2017/4/8
>   FL B 4 xhh  2017/3/17
>   FL B 4 xhh  2017/1/29",header=TRUE)
>
>   DF$ddate   <- as.Date (as.Date(DF$ddate),  format="%Y/%m/%d" )
>   DF3         <- DF[order(DF$State,DF$name,DF$day,xtfrm(DF$ddate)), ]
>   DF3$C       <- with(DF3, ave(State, name, day, FUN = seq_along))
>   DF3$diff    <- with(DF3, ave(as.integer(ddate), State, name, day,
> FUN = function(x) x - x[1]))
>
> I stopped here, how do I evaluate the previous and the current rows
> text string and date difference?
>
> Desired result,
>
>
>      State name day text      ddate C diff flag
> 1     CA    A   1  xch 2014-09-16 1    0     y
> 2     CA    A   2  xck 2015-05-29 1    0      y
> 3     CA    A   2  xck 2015-06-18 2   20     x
> 4     CA    A   2  xcm 2015-08-03 3   66    y
> 5     CA    A   2  xcj 2015-08-26 4   89      y
> 9     FL    B   3  xca 2017-03-17 1    0      y
> 10    FL    B   3  xcb 2017-04-08 2   22    y
> 7     FL    B   3  xcl 2017-07-03 3   108     y
> 6     FL    B   3  xcu 2017-07-23 4  128    y
> 8     FL    B   3  xmc 2017-07-26 5  131   y
> 12    FL    B   4  xhh 2017-01-29 1    0     y
> 11    FL    B   4  xhh 2017-03-17 2   47    x
>
>
>
> Thank you,
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From v@|kremk @end|ng |rom gm@||@com  Wed Apr 27 00:56:57 2022
From: v@|kremk @end|ng |rom gm@||@com (Val)
Date: Tue, 26 Apr 2022 17:56:57 -0500
Subject: [R] flag records
In-Reply-To: <CAGxFJbT4VgwqP4HG8avmPxZghwK851TSXQ8qghefrS_99C76wQ@mail.gmail.com>
References: <CAJOiR6bTy0EYSs722zEryVViLvaDU=vpmmtFkxeDr_tCFFdNcw@mail.gmail.com>
 <CAGxFJbT4VgwqP4HG8avmPxZghwK851TSXQ8qghefrS_99C76wQ@mail.gmail.com>
Message-ID: <CAJOiR6Yfzysj=5fsqFOCSh10yL7oEu4jPj8w78AE4zLa7RG8VA@mail.gmail.com>

Hi Bert,

I am too old for school.




On Tue, Apr 26, 2022 at 5:41 PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> Sounds like homework. We try not to do homework here. See the posting
> guide linked below for details.  (If not homework, let us know).
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> On Tue, Apr 26, 2022 at 3:17 PM Val <valkremk at gmail.com> wrote:
> >
> > Hi All,
> >
> > I want to flag a record based on the following condition.
> > The variables  in the sample data are
> > State, name, day, text, ddate
> >
> > Sort the data by State, name, day ddate,
> >
> > Within  State, name, day
> >     assign consecutive number for each row
> >     find the date difference between consecutive rows,
> >     if the difference is less than 50 days and the text string in
> > previous and current rows  are the same then flag the record as X,
> > otherwise Y.
> >
> > Here is  sample data and my attempt,
> >
> > DF<-read.table(text="State name day text ddate
> >   CA A 1 xch 2014/09/16
> >   CA A 2 xck 2015/5/29
> >   CA A 2 xck 2015/6/18
> >   CA A 2 xcm 2015/8/3
> >   CA A 2 xcj 2015/8/26
> >   FL B 3 xcu  2017/7/23
> >   FL B 3 xcl  2017/7/03
> >   FL B 3 xmc  2017/7/26
> >   FL B 3 xca  2017/3/17
> >   FL B 3 xcb  2017/4/8
> >   FL B 4 xhh  2017/3/17
> >   FL B 4 xhh  2017/1/29",header=TRUE)
> >
> >   DF$ddate   <- as.Date (as.Date(DF$ddate),  format="%Y/%m/%d" )
> >   DF3         <- DF[order(DF$State,DF$name,DF$day,xtfrm(DF$ddate)), ]
> >   DF3$C       <- with(DF3, ave(State, name, day, FUN = seq_along))
> >   DF3$diff    <- with(DF3, ave(as.integer(ddate), State, name, day,
> > FUN = function(x) x - x[1]))
> >
> > I stopped here, how do I evaluate the previous and the current rows
> > text string and date difference?
> >
> > Desired result,
> >
> >
> >      State name day text      ddate C diff flag
> > 1     CA    A   1  xch 2014-09-16 1    0     y
> > 2     CA    A   2  xck 2015-05-29 1    0      y
> > 3     CA    A   2  xck 2015-06-18 2   20     x
> > 4     CA    A   2  xcm 2015-08-03 3   66    y
> > 5     CA    A   2  xcj 2015-08-26 4   89      y
> > 9     FL    B   3  xca 2017-03-17 1    0      y
> > 10    FL    B   3  xcb 2017-04-08 2   22    y
> > 7     FL    B   3  xcl 2017-07-03 3   108     y
> > 6     FL    B   3  xcu 2017-07-23 4  128    y
> > 8     FL    B   3  xmc 2017-07-26 5  131   y
> > 12    FL    B   4  xhh 2017-01-29 1    0     y
> > 11    FL    B   4  xhh 2017-03-17 2   47    x
> >
> >
> >
> > Thank you,
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Wed Apr 27 01:01:24 2022
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 26 Apr 2022 16:01:24 -0700
Subject: [R] flag records
In-Reply-To: <CAJOiR6Yfzysj=5fsqFOCSh10yL7oEu4jPj8w78AE4zLa7RG8VA@mail.gmail.com>
References: <CAJOiR6bTy0EYSs722zEryVViLvaDU=vpmmtFkxeDr_tCFFdNcw@mail.gmail.com>
 <CAGxFJbT4VgwqP4HG8avmPxZghwK851TSXQ8qghefrS_99C76wQ@mail.gmail.com>
 <CAJOiR6Yfzysj=5fsqFOCSh10yL7oEu4jPj8w78AE4zLa7RG8VA@mail.gmail.com>
Message-ID: <CAGxFJbT+hn6+GjFPG6h3=iGtZir=EM=82hue7p7G6rVy-g8wkg@mail.gmail.com>

Thanks ... and fair enough.
However, I disagree -- one is never too old for school.

Cheers,
Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Tue, Apr 26, 2022 at 3:57 PM Val <valkremk at gmail.com> wrote:
>
> Hi Bert,
>
> I am too old for school.
>
>
>
>
> On Tue, Apr 26, 2022 at 5:41 PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >
> > Sounds like homework. We try not to do homework here. See the posting
> > guide linked below for details.  (If not homework, let us know).
> >
> > Bert Gunter
> >
> > "The trouble with having an open mind is that people keep coming along
> > and sticking things into it."
> > -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> >
> > On Tue, Apr 26, 2022 at 3:17 PM Val <valkremk at gmail.com> wrote:
> > >
> > > Hi All,
> > >
> > > I want to flag a record based on the following condition.
> > > The variables  in the sample data are
> > > State, name, day, text, ddate
> > >
> > > Sort the data by State, name, day ddate,
> > >
> > > Within  State, name, day
> > >     assign consecutive number for each row
> > >     find the date difference between consecutive rows,
> > >     if the difference is less than 50 days and the text string in
> > > previous and current rows  are the same then flag the record as X,
> > > otherwise Y.
> > >
> > > Here is  sample data and my attempt,
> > >
> > > DF<-read.table(text="State name day text ddate
> > >   CA A 1 xch 2014/09/16
> > >   CA A 2 xck 2015/5/29
> > >   CA A 2 xck 2015/6/18
> > >   CA A 2 xcm 2015/8/3
> > >   CA A 2 xcj 2015/8/26
> > >   FL B 3 xcu  2017/7/23
> > >   FL B 3 xcl  2017/7/03
> > >   FL B 3 xmc  2017/7/26
> > >   FL B 3 xca  2017/3/17
> > >   FL B 3 xcb  2017/4/8
> > >   FL B 4 xhh  2017/3/17
> > >   FL B 4 xhh  2017/1/29",header=TRUE)
> > >
> > >   DF$ddate   <- as.Date (as.Date(DF$ddate),  format="%Y/%m/%d" )
> > >   DF3         <- DF[order(DF$State,DF$name,DF$day,xtfrm(DF$ddate)), ]
> > >   DF3$C       <- with(DF3, ave(State, name, day, FUN = seq_along))
> > >   DF3$diff    <- with(DF3, ave(as.integer(ddate), State, name, day,
> > > FUN = function(x) x - x[1]))
> > >
> > > I stopped here, how do I evaluate the previous and the current rows
> > > text string and date difference?
> > >
> > > Desired result,
> > >
> > >
> > >      State name day text      ddate C diff flag
> > > 1     CA    A   1  xch 2014-09-16 1    0     y
> > > 2     CA    A   2  xck 2015-05-29 1    0      y
> > > 3     CA    A   2  xck 2015-06-18 2   20     x
> > > 4     CA    A   2  xcm 2015-08-03 3   66    y
> > > 5     CA    A   2  xcj 2015-08-26 4   89      y
> > > 9     FL    B   3  xca 2017-03-17 1    0      y
> > > 10    FL    B   3  xcb 2017-04-08 2   22    y
> > > 7     FL    B   3  xcl 2017-07-03 3   108     y
> > > 6     FL    B   3  xcu 2017-07-23 4  128    y
> > > 8     FL    B   3  xmc 2017-07-26 5  131   y
> > > 12    FL    B   4  xhh 2017-01-29 1    0     y
> > > 11    FL    B   4  xhh 2017-03-17 2   47    x
> > >
> > >
> > >
> > > Thank you,
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.


From v@|kremk @end|ng |rom gm@||@com  Wed Apr 27 01:10:17 2022
From: v@|kremk @end|ng |rom gm@||@com (Val)
Date: Tue, 26 Apr 2022 18:10:17 -0500
Subject: [R] flag records
In-Reply-To: <CAGxFJbT+hn6+GjFPG6h3=iGtZir=EM=82hue7p7G6rVy-g8wkg@mail.gmail.com>
References: <CAJOiR6bTy0EYSs722zEryVViLvaDU=vpmmtFkxeDr_tCFFdNcw@mail.gmail.com>
 <CAGxFJbT4VgwqP4HG8avmPxZghwK851TSXQ8qghefrS_99C76wQ@mail.gmail.com>
 <CAJOiR6Yfzysj=5fsqFOCSh10yL7oEu4jPj8w78AE4zLa7RG8VA@mail.gmail.com>
 <CAGxFJbT+hn6+GjFPG6h3=iGtZir=EM=82hue7p7G6rVy-g8wkg@mail.gmail.com>
Message-ID: <CAJOiR6bMPq1tRMSC2fZKppPVEo76TvGW-35cCsEOwqYPMjSYLQ@mail.gmail.com>

I agree with you on this " one is never too old for school."

My point was,   it is not for homework.

On Tue, Apr 26, 2022 at 6:01 PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> Thanks ... and fair enough.
> However, I disagree -- one is never too old for school.
>
> Cheers,
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
> On Tue, Apr 26, 2022 at 3:57 PM Val <valkremk at gmail.com> wrote:
> >
> > Hi Bert,
> >
> > I am too old for school.
> >
> >
> >
> >
> > On Tue, Apr 26, 2022 at 5:41 PM Bert Gunter <bgunter.4567 at gmail.com> wrote:
> > >
> > > Sounds like homework. We try not to do homework here. See the posting
> > > guide linked below for details.  (If not homework, let us know).
> > >
> > > Bert Gunter
> > >
> > > "The trouble with having an open mind is that people keep coming along
> > > and sticking things into it."
> > > -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> > >
> > > On Tue, Apr 26, 2022 at 3:17 PM Val <valkremk at gmail.com> wrote:
> > > >
> > > > Hi All,
> > > >
> > > > I want to flag a record based on the following condition.
> > > > The variables  in the sample data are
> > > > State, name, day, text, ddate
> > > >
> > > > Sort the data by State, name, day ddate,
> > > >
> > > > Within  State, name, day
> > > >     assign consecutive number for each row
> > > >     find the date difference between consecutive rows,
> > > >     if the difference is less than 50 days and the text string in
> > > > previous and current rows  are the same then flag the record as X,
> > > > otherwise Y.
> > > >
> > > > Here is  sample data and my attempt,
> > > >
> > > > DF<-read.table(text="State name day text ddate
> > > >   CA A 1 xch 2014/09/16
> > > >   CA A 2 xck 2015/5/29
> > > >   CA A 2 xck 2015/6/18
> > > >   CA A 2 xcm 2015/8/3
> > > >   CA A 2 xcj 2015/8/26
> > > >   FL B 3 xcu  2017/7/23
> > > >   FL B 3 xcl  2017/7/03
> > > >   FL B 3 xmc  2017/7/26
> > > >   FL B 3 xca  2017/3/17
> > > >   FL B 3 xcb  2017/4/8
> > > >   FL B 4 xhh  2017/3/17
> > > >   FL B 4 xhh  2017/1/29",header=TRUE)
> > > >
> > > >   DF$ddate   <- as.Date (as.Date(DF$ddate),  format="%Y/%m/%d" )
> > > >   DF3         <- DF[order(DF$State,DF$name,DF$day,xtfrm(DF$ddate)), ]
> > > >   DF3$C       <- with(DF3, ave(State, name, day, FUN = seq_along))
> > > >   DF3$diff    <- with(DF3, ave(as.integer(ddate), State, name, day,
> > > > FUN = function(x) x - x[1]))
> > > >
> > > > I stopped here, how do I evaluate the previous and the current rows
> > > > text string and date difference?
> > > >
> > > > Desired result,
> > > >
> > > >
> > > >      State name day text      ddate C diff flag
> > > > 1     CA    A   1  xch 2014-09-16 1    0     y
> > > > 2     CA    A   2  xck 2015-05-29 1    0      y
> > > > 3     CA    A   2  xck 2015-06-18 2   20     x
> > > > 4     CA    A   2  xcm 2015-08-03 3   66    y
> > > > 5     CA    A   2  xcj 2015-08-26 4   89      y
> > > > 9     FL    B   3  xca 2017-03-17 1    0      y
> > > > 10    FL    B   3  xcb 2017-04-08 2   22    y
> > > > 7     FL    B   3  xcl 2017-07-03 3   108     y
> > > > 6     FL    B   3  xcu 2017-07-23 4  128    y
> > > > 8     FL    B   3  xmc 2017-07-26 5  131   y
> > > > 12    FL    B   4  xhh 2017-01-29 1    0     y
> > > > 11    FL    B   4  xhh 2017-03-17 2   47    x
> > > >
> > > >
> > > >
> > > > Thank you,
> > > >
> > > > ______________________________________________
> > > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > > > and provide commented, minimal, self-contained, reproducible code.


