From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Sun Feb  2 15:58:31 2025
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Sun, 2 Feb 2025 14:58:31 +0000
Subject: [R] R CMD check error: File `inconsolata.sty' not found
Message-ID: <9141AF1E-5E6B-4786-8BE5-203F594C28E8@hotmail.com>

R CMD check <package> gives me below message at the end.  There does not seem to be a problem with my TeX installation.  Is it possible that R CMD check is not looking in the correct location?  How can this problem be fixed?

Thanks,
Naresh

* checking PDF version of manual ... WARNING
LaTeX errors when creating PDF version.
This typically indicates Rd problems.
LaTeX errors found:
! LaTeX Error: File `inconsolata.sty' not found.

Type X to quit or <RETURN> to proceed,
or enter new name. (Default extension: sty)

! Emergency stop.
<read *> 
         
l.326 ^^M
         
!  ==> Fatal error occurred, no output PDF file produced!
* checking PDF version of manual without index ... OK
* DONE

My Mac has the latest version of TeX installed from texlive.  Below are top few lines from running tlmgr conf

=========================== version information ==========================
tlmgr revision 73493 (2025-01-17 23:28:29 +0100)
tlmgr using installation: /usr/local/texlive/2024
TeX Live (https://tug.org/texlive) version 2024
==================== executables found by searching PATH =================
PATH: /usr/local/texlive/2024/bin/universal-darwin:/opt/local/bin:/opt/local/sbin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/texlive/2024/bin/universal-darwin
dvipdfmx:  /usr/local/texlive/2024/bin/universal-darwin/dvipdfmx
dvips:     /usr/local/texlive/2024/bin/universal-darwin/dvips
fmtutil:   /usr/local/texlive/2024/bin/universal-darwin/fmtutil
kpsewhich: /usr/local/texlive/2024/bin/universal-darwin/kpsewhich
luatex:    /usr/local/texlive/2024/bin/universal-darwin/luatex
mktexpk:   /usr/local/texlive/2024/bin/universal-darwin/mktexpk
pdftex:    /usr/local/texlive/2024/bin/universal-darwin/pdftex
tex:       /usr/local/texlive/2024/bin/universal-darwin/tex
tlmgr:     /usr/local/texlive/2024/bin/universal-darwin/tlmgr
updmap:    /usr/local/texlive/2024/bin/universal-darwin/updmap
xetex:     /usr/local/texlive/2024/bin/universal-darwin/xetex

On the command line, I tried updating incosolata package

bash-3.2$ sudo tlmgr install inconsolata
Password:
tlmgr: package repository https://ctan.tinycomputers.io/tex-archive/systems/texlive/tlnet (verified)
tlmgr install: package already present: inconsolata

bash-3.2$ sudo tlmgr update inconsolata
tlmgr: package repository https://ctan.tinycomputers.io/tex-archive/systems/texlive/tlnet (verified)
tlmgr: saving backups to /usr/local/texlive/2024/tlpkg/backups
tlmgr: no updates available

From m@rc_grt @end|ng |rom y@hoo@|r  Wed Feb  5 10:46:22 2025
From: m@rc_grt @end|ng |rom y@hoo@|r (Marc Girondot)
Date: Wed, 5 Feb 2025 10:46:22 +0100
Subject: [R] Error when loading optimx package and a solution
References: <21fb5b76-8add-4a1a-b075-38f6c358ed1a.ref@yahoo.fr>
Message-ID: <21fb5b76-8add-4a1a-b075-38f6c358ed1a@yahoo.fr>

Dear R-help members

Since this morning (5/2/2025), I get an error when I try to load optimx 
package. I solve it and I send my solution but if someone has a better 
idea or understand what's happened, I will be most happy to know.

MacOSX 15.3

R 4.4.2

nlopt installed using
brew install nlopt

Here are the steps to produce the error and a solution to solve it. Some 
parts are in French. I don't know how to "ask" to R to not use French 
for some system messages.

Marc


 > library("optimx")
Erreur : le chargement du package ou de l'espace de noms a ?chou? pour 
?optimx? in dyn.load(file, DLLpath = DLLpath, ...) :
impossible de charger l'objet partag? 
'/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/nloptr/libs/nloptr.so'?:
dlopen(/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/nloptr/libs/nloptr.so, 
0x0006): Library not loaded: /opt/homebrew/opt/nlopt/lib/libnlopt.0.dylib
 ? Referenced from: <2A7DAFE2-8123-3555-9569-F28214328E47> 
/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/nloptr/libs/nloptr.so
 ? Reason: tried: '/opt/homebrew/opt/nlopt/lib/libnlopt.0.dylib' (no 
such file), 
'/System/Volumes/Preboot/Cryptexes/OS/opt/homebrew/opt/nlopt/lib/libnlopt.0.dylib' 
(no such file), '/opt/homebrew/opt/nlopt/lib/libnlopt.0.dylib' (no such 
file), '/Library/Frameworks/R.framework/Resources/lib/libnlopt.0.dylib' 
(no such file), 
'/Library/Java/JavaVirtualMachines/jdk-11.0.18+10/Contents/Home/lib/server/libnlopt.0.d
It seems that the file libnlopt.0.dylib is not find.

When I check in this folder, indeed it is not present:

? lib % cd /opt/homebrew/opt/nlopt/lib
? lib % ls
cmake??????????? libnlopt.1.dylib??? pkgconfig
libnlopt.1.0.0.dylib??? libnlopt.dylib

I create a symlink:

? lib % sudo ln -s libnlopt.1.dylib libnlopt.0.dylib
Password:
? lib % ls -al
total 880
drwxr-xr-x?? 8 marcgirondot? admin???? 256? 5 f?v 10:28 .
drwxr-xr-x? 15 marcgirondot? admin???? 480? 5 f?v 10:26 ..
drwxr-xr-x?? 3 marcgirondot? admin????? 96? 4 f?v 19:29 cmake
lrwxr-xr-x?? 1 root????????? admin????? 16? 5 f?v 10:28 libnlopt.0.dylib 
-> libnlopt.1.dylib
-r--r--r--?? 1 marcgirondot? admin? 447936? 5 f?v 10:26 libnlopt.1.0.0.dylib
lrwxr-xr-x?? 1 marcgirondot? admin????? 20? 4 f?v 19:29 libnlopt.1.dylib 
-> libnlopt.1.0.0.dylib
lrwxr-xr-x?? 1 marcgirondot? admin????? 16? 4 f?v 19:29 libnlopt.dylib 
-> libnlopt.1.dylib
drwxr-xr-x?? 3 marcgirondot? admin????? 96? 5 f?v 10:26 pkgconfig

and I reinstall optimx from source

 > remove.packages("optimx")
Elimination du package de 
?/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library?
(car ?lib? n'est pas sp?cifi?)
 > install.packages("optimx", type="source")
essai de l'URL 'https://cran.irsn.fr/src/contrib/optimx_2024-12.2.tar.gz'
Content type 'application/x-gzip' length 2259525 bytes (2.2 MB)
==================================================
downloaded 2.2 MB

* installing *source* package ?optimx? ...
** package ?optimx? correctement d?compress? et sommes MD5 v?rifi?es
** using staged installation
** R
** inst
** byte-compile and prepare package for lazy loading
** help
*** installing help indices
** building package indices
** installing vignettes
** testing if installed package can be loaded from temporary location
** testing if installed package can be loaded from final location
** testing if installed package keeps a record of temporary installation 
path
* DONE (optimx)

Les packages source t?l?charg?s sont dans
 ??? ?/private/tmp/Rtmpsb2lpE/downloaded_packages?


From pro|jcn@@h @end|ng |rom gm@||@com  Wed Feb  5 14:05:21 2025
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Wed, 5 Feb 2025 08:05:21 -0500
Subject: [R] Error when loading optimx package and a solution
In-Reply-To: <21fb5b76-8add-4a1a-b075-38f6c358ed1a@yahoo.fr>
References: <21fb5b76-8add-4a1a-b075-38f6c358ed1a.ref@yahoo.fr>
 <21fb5b76-8add-4a1a-b075-38f6c358ed1a@yahoo.fr>
Message-ID: <3c90a854-2fbf-4423-9966-ab0ab71351d0@gmail.com>

Hi,

That looks like the dependency on nlopt for nloptr (used by several of the
solvers) was somehow missing. There is SUPPOSED to be a check of what is installed
and a warning issued, but possibly one got missed. Even some base packages
do sometimes need the external libraries manually installed, and I find I'm
doing that after various OS updates or resets when the long term support
runs out.

Some updates and minor extensions to optimx, mostly convenience features or
checks that dependencies available, are on the github version, which is a bit
ahead of CRAN (https://github.com/nashjc/optimx). I find doing all the checks
and revdeps for the package now getting heavy enough that it is worth waiting
a bit unless there's a critical bug, which I don't think there has been for
a long while.

I don't have a Mac, and am currently away from home (actually in Nice, FR for
a couple of weeks), but would be interested in knowing if the github version
needs an independent install of nlopt on Mac, or indeed on any platform.

Cheers,

John Nash
maintainer, optimx


On 2025-02-05 04:46, Marc Girondot via R-help wrote:
> Dear R-help members
> 
> Since this morning (5/2/2025), I get an error when I try to load optimx package. I solve it and I send my solution but 
> if someone has a better idea or understand what's happened, I will be most happy to know.
> 
> MacOSX 15.3
> 
> R 4.4.2
> 
> nlopt installed using
> brew install nlopt
> 
> Here are the steps to produce the error and a solution to solve it. Some parts are in French. I don't know how to "ask" 
> to R to not use French for some system messages.
> 
> Marc
> 
> 
>  > library("optimx")
> Erreur : le chargement du package ou de l'espace de noms a ?chou? pour ?optimx? in dyn.load(file, DLLpath = DLLpath, ...) :
> impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/nloptr/libs/ 
> nloptr.so'?:
> dlopen(/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/nloptr/libs/nloptr.so, 0x0006): Library not 
> loaded: /opt/homebrew/opt/nlopt/lib/libnlopt.0.dylib
>  ? Referenced from: <2A7DAFE2-8123-3555-9569-F28214328E47> /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/ 
> library/nloptr/libs/nloptr.so
>  ? Reason: tried: '/opt/homebrew/opt/nlopt/lib/libnlopt.0.dylib' (no such file), '/System/Volumes/Preboot/Cryptexes/OS/ 
> opt/homebrew/opt/nlopt/lib/libnlopt.0.dylib' (no such file), '/opt/homebrew/opt/nlopt/lib/libnlopt.0.dylib' (no such 
> file), '/Library/Frameworks/R.framework/Resources/lib/libnlopt.0.dylib' (no such file), '/Library/Java/ 
> JavaVirtualMachines/jdk-11.0.18+10/Contents/Home/lib/server/libnlopt.0.d
> It seems that the file libnlopt.0.dylib is not find.
> 
> When I check in this folder, indeed it is not present:
> 
> ? lib % cd /opt/homebrew/opt/nlopt/lib
> ? lib % ls
> cmake??????????? libnlopt.1.dylib??? pkgconfig
> libnlopt.1.0.0.dylib??? libnlopt.dylib
> 
> I create a symlink:
> 
> ? lib % sudo ln -s libnlopt.1.dylib libnlopt.0.dylib
> Password:
> ? lib % ls -al
> total 880
> drwxr-xr-x?? 8 marcgirondot? admin???? 256? 5 f?v 10:28 .
> drwxr-xr-x? 15 marcgirondot? admin???? 480? 5 f?v 10:26 ..
> drwxr-xr-x?? 3 marcgirondot? admin????? 96? 4 f?v 19:29 cmake
> lrwxr-xr-x?? 1 root????????? admin????? 16? 5 f?v 10:28 libnlopt.0.dylib -> libnlopt.1.dylib
> -r--r--r--?? 1 marcgirondot? admin? 447936? 5 f?v 10:26 libnlopt.1.0.0.dylib
> lrwxr-xr-x?? 1 marcgirondot? admin????? 20? 4 f?v 19:29 libnlopt.1.dylib -> libnlopt.1.0.0.dylib
> lrwxr-xr-x?? 1 marcgirondot? admin????? 16? 4 f?v 19:29 libnlopt.dylib -> libnlopt.1.dylib
> drwxr-xr-x?? 3 marcgirondot? admin????? 96? 5 f?v 10:26 pkgconfig
> 
> and I reinstall optimx from source
> 
>  > remove.packages("optimx")
> Elimination du package de ?/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library?
> (car ?lib? n'est pas sp?cifi?)
>  > install.packages("optimx", type="source")
> essai de l'URL 'https://cran.irsn.fr/src/contrib/optimx_2024-12.2.tar.gz'
> Content type 'application/x-gzip' length 2259525 bytes (2.2 MB)
> ==================================================
> downloaded 2.2 MB
> 
> * installing *source* package ?optimx? ...
> ** package ?optimx? correctement d?compress? et sommes MD5 v?rifi?es
> ** using staged installation
> ** R
> ** inst
> ** byte-compile and prepare package for lazy loading
> ** help
> *** installing help indices
> ** building package indices
> ** installing vignettes
> ** testing if installed package can be loaded from temporary location
> ** testing if installed package can be loaded from final location
> ** testing if installed package keeps a record of temporary installation path
> * DONE (optimx)
> 
> Les packages source t?l?charg?s sont dans
>  ??? ?/private/tmp/Rtmpsb2lpE/downloaded_packages?
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From pd@|gd @end|ng |rom gm@||@com  Wed Feb  5 14:39:32 2025
From: pd@|gd @end|ng |rom gm@||@com (peter dalgaard)
Date: Wed, 5 Feb 2025 14:39:32 +0100
Subject: [R] Error when loading optimx package and a solution
In-Reply-To: <3c90a854-2fbf-4423-9966-ab0ab71351d0@gmail.com>
References: <21fb5b76-8add-4a1a-b075-38f6c358ed1a.ref@yahoo.fr>
 <21fb5b76-8add-4a1a-b075-38f6c358ed1a@yahoo.fr>
 <3c90a854-2fbf-4423-9966-ab0ab71351d0@gmail.com>
Message-ID: <79CB359F-C07F-4534-BEC8-9C6D7792630E@gmail.com>

I think the operative words here are "brew install". I.e., this is a homebrew installation, and thus nothing to do with CRAN.

Nothing wrong with homebrew as far as R Core and the CRAN team knows, we just don't support it, so you have to hope for response from other homebrew users.


- Peter D.


> On 5 Feb 2025, at 14:05 , J C Nash <profjcnash at gmail.com> wrote:
> 
> Hi,
> 
> That looks like the dependency on nlopt for nloptr (used by several of the
> solvers) was somehow missing. There is SUPPOSED to be a check of what is installed
> and a warning issued, but possibly one got missed. Even some base packages
> do sometimes need the external libraries manually installed, and I find I'm
> doing that after various OS updates or resets when the long term support
> runs out.
> 
> Some updates and minor extensions to optimx, mostly convenience features or
> checks that dependencies available, are on the github version, which is a bit
> ahead of CRAN (https://github.com/nashjc/optimx). I find doing all the checks
> and revdeps for the package now getting heavy enough that it is worth waiting
> a bit unless there's a critical bug, which I don't think there has been for
> a long while.
> 
> I don't have a Mac, and am currently away from home (actually in Nice, FR for
> a couple of weeks), but would be interested in knowing if the github version
> needs an independent install of nlopt on Mac, or indeed on any platform.
> 
> Cheers,
> 
> John Nash
> maintainer, optimx
> 
> 
> On 2025-02-05 04:46, Marc Girondot via R-help wrote:
>> Dear R-help members
>> Since this morning (5/2/2025), I get an error when I try to load optimx package. I solve it and I send my solution but if someone has a better idea or understand what's happened, I will be most happy to know.
>> MacOSX 15.3
>> R 4.4.2
>> nlopt installed using
>> brew install nlopt
>> Here are the steps to produce the error and a solution to solve it. Some parts are in French. I don't know how to "ask" to R to not use French for some system messages.
>> Marc
>> > library("optimx")
>> Erreur : le chargement du package ou de l'espace de noms a ?chou? pour ?optimx? in dyn.load(file, DLLpath = DLLpath, ...) :
>> impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/nloptr/libs/ nloptr.so'?:
>> dlopen(/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/nloptr/libs/nloptr.so, 0x0006): Library not loaded: /opt/homebrew/opt/nlopt/lib/libnlopt.0.dylib
>>   Referenced from: <2A7DAFE2-8123-3555-9569-F28214328E47> /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/ library/nloptr/libs/nloptr.so
>>   Reason: tried: '/opt/homebrew/opt/nlopt/lib/libnlopt.0.dylib' (no such file), '/System/Volumes/Preboot/Cryptexes/OS/ opt/homebrew/opt/nlopt/lib/libnlopt.0.dylib' (no such file), '/opt/homebrew/opt/nlopt/lib/libnlopt.0.dylib' (no such file), '/Library/Frameworks/R.framework/Resources/lib/libnlopt.0.dylib' (no such file), '/Library/Java/ JavaVirtualMachines/jdk-11.0.18+10/Contents/Home/lib/server/libnlopt.0.d
>> It seems that the file libnlopt.0.dylib is not find.
>> When I check in this folder, indeed it is not present:
>> ? lib % cd /opt/homebrew/opt/nlopt/lib
>> ? lib % ls
>> cmake            libnlopt.1.dylib    pkgconfig
>> libnlopt.1.0.0.dylib    libnlopt.dylib
>> I create a symlink:
>> ? lib % sudo ln -s libnlopt.1.dylib libnlopt.0.dylib
>> Password:
>> ? lib % ls -al
>> total 880
>> drwxr-xr-x   8 marcgirondot  admin     256  5 f?v 10:28 .
>> drwxr-xr-x  15 marcgirondot  admin     480  5 f?v 10:26 ..
>> drwxr-xr-x   3 marcgirondot  admin      96  4 f?v 19:29 cmake
>> lrwxr-xr-x   1 root          admin      16  5 f?v 10:28 libnlopt.0.dylib -> libnlopt.1.dylib
>> -r--r--r--   1 marcgirondot  admin  447936  5 f?v 10:26 libnlopt.1.0.0.dylib
>> lrwxr-xr-x   1 marcgirondot  admin      20  4 f?v 19:29 libnlopt.1.dylib -> libnlopt.1.0.0.dylib
>> lrwxr-xr-x   1 marcgirondot  admin      16  4 f?v 19:29 libnlopt.dylib -> libnlopt.1.dylib
>> drwxr-xr-x   3 marcgirondot  admin      96  5 f?v 10:26 pkgconfig
>> and I reinstall optimx from source
>> > remove.packages("optimx")
>> Elimination du package de ?/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library?
>> (car ?lib? n'est pas sp?cifi?)
>> > install.packages("optimx", type="source")
>> essai de l'URL 'https://cran.irsn.fr/src/contrib/optimx_2024-12.2.tar.gz'
>> Content type 'application/x-gzip' length 2259525 bytes (2.2 MB)
>> ==================================================
>> downloaded 2.2 MB
>> * installing *source* package ?optimx? ...
>> ** package ?optimx? correctement d?compress? et sommes MD5 v?rifi?es
>> ** using staged installation
>> ** R
>> ** inst
>> ** byte-compile and prepare package for lazy loading
>> ** help
>> *** installing help indices
>> ** building package indices
>> ** installing vignettes
>> ** testing if installed package can be loaded from temporary location
>> ** testing if installed package can be loaded from final location
>> ** testing if installed package keeps a record of temporary installation path
>> * DONE (optimx)
>> Les packages source t?l?charg?s sont dans
>>     ?/private/tmp/Rtmpsb2lpE/downloaded_packages?
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Feb  5 14:44:12 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 5 Feb 2025 08:44:12 -0500
Subject: [R] Looking for simple line-splitting code
Message-ID: <cc02f160-3147-4bfc-89d0-21c5633cbbc5@gmail.com>

If I have this object:

   x <- c("abc\ndef", "", "ghi")

and I write it to a file using `writeLines(x, "test.txt")`, my text 
editor sees a 5 line file:

   1: abc
   2: def
   3:
   4: ghi
   5:

which is what I'd expect:  the last line in the editor is empty.  If I 
use `readLines("test.txt")` on that file, I get the vector

   c("abc", "def", "", "ghi")

and all of that is fine.

What I'm looking for is simple code that modifies x to the `readLines()` 
output, without actually writing and reading it.

My first attempt doesn't work:

   unlist(strsplit(x, "\n"))

because it leaves out the blank line 3.  I can fix that with this ugly code:

   lines <- strsplit(x, "\n")
   lines[sapply(lines, length) == 0] <- list("")
   lines <- unlist(lines)

Surely there's a simpler way to do this?  I'd like to use just base 
functions, no other packages.

Duncan Murdoch


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Feb  5 14:52:08 2025
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 5 Feb 2025 13:52:08 +0000
Subject: [R] Looking for simple line-splitting code
In-Reply-To: <cc02f160-3147-4bfc-89d0-21c5633cbbc5@gmail.com>
References: <cc02f160-3147-4bfc-89d0-21c5633cbbc5@gmail.com>
Message-ID: <8597ae86-ee91-4558-9990-08628b035950@sapo.pt>

?s 13:44 de 05/02/2025, Duncan Murdoch escreveu:
> If I have this object:
> 
>  ? x <- c("abc\ndef", "", "ghi")
> 
> and I write it to a file using `writeLines(x, "test.txt")`, my text 
> editor sees a 5 line file:
> 
>  ? 1: abc
>  ? 2: def
>  ? 3:
>  ? 4: ghi
>  ? 5:
> 
> which is what I'd expect:? the last line in the editor is empty.? If I 
> use `readLines("test.txt")` on that file, I get the vector
> 
>  ? c("abc", "def", "", "ghi")
> 
> and all of that is fine.
> 
> What I'm looking for is simple code that modifies x to the `readLines()` 
> output, without actually writing and reading it.
> 
> My first attempt doesn't work:
> 
>  ? unlist(strsplit(x, "\n"))
> 
> because it leaves out the blank line 3.? I can fix that with this ugly 
> code:
> 
>  ? lines <- strsplit(x, "\n")
>  ? lines[sapply(lines, length) == 0] <- list("")
>  ? lines <- unlist(lines)
> 
> Surely there's a simpler way to do this?? I'd like to use just base 
> functions, no other packages.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting- 
> guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Use ?textConnection.
The 5th line is left out, just like in your code.


x <- c("abc\ndef", "", "ghi")
x |> textConnection() |> readLines()
# [1] "abc" "def" ""    "ghi"


Hope this helps,

Rui Barradas



-- 
Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.
www.avg.com


From pd@|gd @end|ng |rom gm@||@com  Wed Feb  5 15:13:00 2025
From: pd@|gd @end|ng |rom gm@||@com (peter dalgaard)
Date: Wed, 5 Feb 2025 15:13:00 +0100
Subject: [R] Looking for simple line-splitting code
In-Reply-To: <cc02f160-3147-4bfc-89d0-21c5633cbbc5@gmail.com>
References: <cc02f160-3147-4bfc-89d0-21c5633cbbc5@gmail.com>
Message-ID: <07740212-AF66-4219-B235-F985BE744CA8@gmail.com>

This also seems to work:

> strsplit(paste(x,collapse="\n"),"\n")[[1]]
[1] "abc" "def" ""    "ghi"


> On 5 Feb 2025, at 14:44 , Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> If I have this object:
> 
>  x <- c("abc\ndef", "", "ghi")
> 
> and I write it to a file using `writeLines(x, "test.txt")`, my text editor sees a 5 line file:
> 
>  1: abc
>  2: def
>  3:
>  4: ghi
>  5:
> 
> which is what I'd expect:  the last line in the editor is empty.  If I use `readLines("test.txt")` on that file, I get the vector
> 
>  c("abc", "def", "", "ghi")
> 
> and all of that is fine.
> 
> What I'm looking for is simple code that modifies x to the `readLines()` output, without actually writing and reading it.
> 
> My first attempt doesn't work:
> 
>  unlist(strsplit(x, "\n"))
> 
> because it leaves out the blank line 3.  I can fix that with this ugly code:
> 
>  lines <- strsplit(x, "\n")
>  lines[sapply(lines, length) == 0] <- list("")
>  lines <- unlist(lines)
> 
> Surely there's a simpler way to do this?  I'd like to use just base functions, no other packages.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From m@@hr@ng@ @end|ng |rom y@hoo@com  Wed Feb  5 15:19:52 2025
From: m@@hr@ng@ @end|ng |rom y@hoo@com (Mohammad Tanvir Ahamed)
Date: Wed, 5 Feb 2025 14:19:52 +0000 (UTC)
Subject: [R] Looking for simple line-splitting code
In-Reply-To: <cc02f160-3147-4bfc-89d0-21c5633cbbc5@gmail.com>
References: <cc02f160-3147-4bfc-89d0-21c5633cbbc5@gmail.com>
Message-ID: <753785940.8791528.1738765192014@mail.yahoo.com>

x <- c("abc\ndef", "", "ghi")

unlist(strsplit(gsub("^$", "\n", x), "\n"))

or?

x %>%
? gsub("^$", "\n", .) %>%
? strsplit("\n") %>%
? unlist()


Regards.............
Tanvir Ahamed 
Stockholm, Sweden???? |??mashranga at yahoo.com 

On Wednesday, February 5, 2025 at 02:44:37 PM GMT+1, Duncan Murdoch <murdoch.duncan at gmail.com> wrote: 

If I have this object:

? x <- c("abc\ndef", "", "ghi")

and I write it to a file using `writeLines(x, "test.txt")`, my text 
editor sees a 5 line file:

? 1: abc
? 2: def
? 3:
? 4: ghi
? 5:

which is what I'd expect:? the last line in the editor is empty.? If I 
use `readLines("test.txt")` on that file, I get the vector

? c("abc", "def", "", "ghi")

and all of that is fine.

What I'm looking for is simple code that modifies x to the `readLines()` 
output, without actually writing and reading it.

My first attempt doesn't work:

? unlist(strsplit(x, "\n"))

because it leaves out the blank line 3.? I can fix that with this ugly code:

? lines <- strsplit(x, "\n")
? lines[sapply(lines, length) == 0] <- list("")
? lines <- unlist(lines)

Surely there's a simpler way to do this?? I'd like to use just base 
functions, no other packages.

Duncan Murdoch

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Feb  5 15:35:24 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 5 Feb 2025 09:35:24 -0500
Subject: [R] Looking for simple line-splitting code
In-Reply-To: <07740212-AF66-4219-B235-F985BE744CA8@gmail.com>
References: <cc02f160-3147-4bfc-89d0-21c5633cbbc5@gmail.com>
 <07740212-AF66-4219-B235-F985BE744CA8@gmail.com>
Message-ID: <fdff731e-d1f5-4ef2-bf3e-8a450f143e59@gmail.com>

Thanks to Rui, Peter and Tanvir!  Peter's seems to be the fastest of the 
3 suggestions so far on the little test case, but on the real data 
(where x contains several thousand lines), Rui's seems best.

Duncan

On 2025-02-05 9:13 a.m., peter dalgaard wrote:
> This also seems to work:
> 
>> strsplit(paste(x,collapse="\n"),"\n")[[1]]
> [1] "abc" "def" ""    "ghi"
> 
> 
>> On 5 Feb 2025, at 14:44 , Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>
>> If I have this object:
>>
>>   x <- c("abc\ndef", "", "ghi")
>>
>> and I write it to a file using `writeLines(x, "test.txt")`, my text editor sees a 5 line file:
>>
>>   1: abc
>>   2: def
>>   3:
>>   4: ghi
>>   5:
>>
>> which is what I'd expect:  the last line in the editor is empty.  If I use `readLines("test.txt")` on that file, I get the vector
>>
>>   c("abc", "def", "", "ghi")
>>
>> and all of that is fine.
>>
>> What I'm looking for is simple code that modifies x to the `readLines()` output, without actually writing and reading it.
>>
>> My first attempt doesn't work:
>>
>>   unlist(strsplit(x, "\n"))
>>
>> because it leaves out the blank line 3.  I can fix that with this ugly code:
>>
>>   lines <- strsplit(x, "\n")
>>   lines[sapply(lines, length) == 0] <- list("")
>>   lines <- unlist(lines)
>>
>> Surely there's a simpler way to do this?  I'd like to use just base functions, no other packages.
>>
>> Duncan Murdoch
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>


From e@ @end|ng |rom enr|co@chum@nn@net  Wed Feb  5 20:17:58 2025
From: e@ @end|ng |rom enr|co@chum@nn@net (Enrico Schumann)
Date: Wed, 05 Feb 2025 20:17:58 +0100
Subject: [R] R CMD check error: File `inconsolata.sty' not found
In-Reply-To: <9141AF1E-5E6B-4786-8BE5-203F594C28E8@hotmail.com> (Naresh
 Gurbuxani's message of "Sun, 2 Feb 2025 14:58:31 +0000")
References: <9141AF1E-5E6B-4786-8BE5-203F594C28E8@hotmail.com>
Message-ID: <87y0ykp5eh.fsf@enricoschumann.net>

On Sun, 02 Feb 2025, Naresh Gurbuxani writes:

> R CMD check <package> gives me below message at the
> end.  There does not seem to be a problem with my TeX
> installation.  Is it possible that R CMD check is not
> looking in the correct location?  How can this problem
> be fixed?
>
> Thanks,
> Naresh
>
> * checking PDF version of manual ... WARNING
> LaTeX errors when creating PDF version.
> This typically indicates Rd problems.
> LaTeX errors found:
> ! LaTeX Error: File `inconsolata.sty' not found.
>
> Type X to quit or <RETURN> to proceed,
> or enter new name. (Default extension: sty)
>
> ! Emergency stop.
> <read *> 
>          
> l.326 ^^M
>          
> !  ==> Fatal error occurred, no output PDF file produced!
> * checking PDF version of manual without index ... OK
> * DONE
>
> My Mac has the latest version of TeX installed from texlive.  Below are top few lines from running tlmgr conf
>
> =========================== version information ==========================
> tlmgr revision 73493 (2025-01-17 23:28:29 +0100)
> tlmgr using installation: /usr/local/texlive/2024
> TeX Live (https://tug.org/texlive) version 2024
> ==================== executables found by searching PATH =================
> PATH: /usr/local/texlive/2024/bin/universal-darwin:/opt/local/bin:/opt/local/sbin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/texlive/2024/bin/universal-darwin
> dvipdfmx:  /usr/local/texlive/2024/bin/universal-darwin/dvipdfmx
> dvips:     /usr/local/texlive/2024/bin/universal-darwin/dvips
> fmtutil:   /usr/local/texlive/2024/bin/universal-darwin/fmtutil
> kpsewhich: /usr/local/texlive/2024/bin/universal-darwin/kpsewhich
> luatex:    /usr/local/texlive/2024/bin/universal-darwin/luatex
> mktexpk:   /usr/local/texlive/2024/bin/universal-darwin/mktexpk
> pdftex:    /usr/local/texlive/2024/bin/universal-darwin/pdftex
> tex:       /usr/local/texlive/2024/bin/universal-darwin/tex
> tlmgr:     /usr/local/texlive/2024/bin/universal-darwin/tlmgr
> updmap:    /usr/local/texlive/2024/bin/universal-darwin/updmap
> xetex:     /usr/local/texlive/2024/bin/universal-darwin/xetex
>
> On the command line, I tried updating incosolata package
>
> bash-3.2$ sudo tlmgr install inconsolata
> Password:
> tlmgr: package repository https://ctan.tinycomputers.io/tex-archive/systems/texlive/tlnet (verified)
> tlmgr install: package already present: inconsolata
>
> bash-3.2$ sudo tlmgr update inconsolata
> tlmgr: package repository https://ctan.tinycomputers.io/tex-archive/systems/texlive/tlnet (verified)
> tlmgr: saving backups to /usr/local/texlive/2024/tlpkg/backups
> tlmgr: no updates available

What does 

     kpsewhich inconsolata.sty

(on the command line) say?  (It should show the
location of the file.)

The 'Installation and Administration' manual briefly
discusses how to build the manual for a package, also
without 'inconsolata':

  https://cran.r-project.org/doc/manuals/R-admin.html#Making-the-manuals


-- 
Enrico Schumann
Lucerne, Switzerland
https://enricoschumann.net


From pd@|gd @end|ng |rom gm@||@com  Wed Feb  5 21:27:09 2025
From: pd@|gd @end|ng |rom gm@||@com (peter dalgaard)
Date: Wed, 5 Feb 2025 21:27:09 +0100
Subject: [R] Looking for simple line-splitting code
In-Reply-To: <fdff731e-d1f5-4ef2-bf3e-8a450f143e59@gmail.com>
References: <cc02f160-3147-4bfc-89d0-21c5633cbbc5@gmail.com>
 <07740212-AF66-4219-B235-F985BE744CA8@gmail.com>
 <fdff731e-d1f5-4ef2-bf3e-8a450f143e59@gmail.com>
Message-ID: <17DCA5E2-A799-484C-A1B8-E2F4E8BD94CC@gmail.com>

A 3rd option could be

scan(text=x, what="", blank.lines.skip=FALSE)

(all because readLines() doesn't obey the text=x convention, perhaps it should? I'm unsure whether the textConnection is left open in Rui's method.)

-pd

> On 5 Feb 2025, at 15:35 , Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> Thanks to Rui, Peter and Tanvir!  Peter's seems to be the fastest of the 3 suggestions so far on the little test case, but on the real data (where x contains several thousand lines), Rui's seems best.
> 
> Duncan
> 
> On 2025-02-05 9:13 a.m., peter dalgaard wrote:
>> This also seems to work:
>>> strsplit(paste(x,collapse="\n"),"\n")[[1]]
>> [1] "abc" "def" ""    "ghi"
>>> On 5 Feb 2025, at 14:44 , Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>> 
>>> If I have this object:
>>> 
>>>  x <- c("abc\ndef", "", "ghi")
>>> 
>>> and I write it to a file using `writeLines(x, "test.txt")`, my text editor sees a 5 line file:
>>> 
>>>  1: abc
>>>  2: def
>>>  3:
>>>  4: ghi
>>>  5:
>>> 
>>> which is what I'd expect:  the last line in the editor is empty.  If I use `readLines("test.txt")` on that file, I get the vector
>>> 
>>>  c("abc", "def", "", "ghi")
>>> 
>>> and all of that is fine.
>>> 
>>> What I'm looking for is simple code that modifies x to the `readLines()` output, without actually writing and reading it.
>>> 
>>> My first attempt doesn't work:
>>> 
>>>  unlist(strsplit(x, "\n"))
>>> 
>>> because it leaves out the blank line 3.  I can fix that with this ugly code:
>>> 
>>>  lines <- strsplit(x, "\n")
>>>  lines[sapply(lines, length) == 0] <- list("")
>>>  lines <- unlist(lines)
>>> 
>>> Surely there's a simpler way to do this?  I'd like to use just base functions, no other packages.
>>> 
>>> Duncan Murdoch
>>> 
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
> 

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From ro||turner @end|ng |rom po@teo@net  Wed Feb  5 23:20:45 2025
From: ro||turner @end|ng |rom po@teo@net (Rolf Turner)
Date: Wed,  5 Feb 2025 22:20:45 +0000
Subject: [R] Looking for simple line-splitting code
In-Reply-To: <cc02f160-3147-4bfc-89d0-21c5633cbbc5@gmail.com>
References: <cc02f160-3147-4bfc-89d0-21c5633cbbc5@gmail.com>
Message-ID: <20250206112045.43e9dea8@new-hp>


On Wed, 5 Feb 2025 08:44:12 -0500
Duncan Murdoch <murdoch.duncan at gmail.com> wrote:

> If I have this object:
> 
>    x <- c("abc\ndef", "", "ghi")
> 
> and I write it to a file using `writeLines(x, "test.txt")`, my text 
> editor sees a 5 line file:
> 
>    1: abc
>    2: def
>    3:
>    4: ghi
>    5:
> 
> which is what I'd expect:  the last line in the editor is empty.If I 
> use `readLines("test.txt")` on that file, I get the vector
> 
>    c("abc", "def", "", "ghi")


<SNIP>

Apologies for muddying the waters with my ignorance, but why would you
expect a 5 line file?   I would expect a 4 line file, and that is
indeed what I get when I try the code in question.

If I append an empty line at the end of my test.txt and then
apply readLines() to that file, I get [1] "abc" "def" ""    "ghi" "",
again as *I* would expect.

What am I missing?  Sorry for being a thicko.

cheers,

Rolf

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Stats. Dep't. (secretaries) phone:readLines("test.txt")
         +64-9-373-7599 ext. 89622
Home phone: +64-9-480-4619


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Feb  5 23:38:48 2025
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 5 Feb 2025 22:38:48 +0000
Subject: [R] Looking for simple line-splitting code
In-Reply-To: <17DCA5E2-A799-484C-A1B8-E2F4E8BD94CC@gmail.com>
References: <cc02f160-3147-4bfc-89d0-21c5633cbbc5@gmail.com>
 <07740212-AF66-4219-B235-F985BE744CA8@gmail.com>
 <fdff731e-d1f5-4ef2-bf3e-8a450f143e59@gmail.com>
 <17DCA5E2-A799-484C-A1B8-E2F4E8BD94CC@gmail.com>
Message-ID: <1f352f99-1651-43ef-9833-681ee7b57d8a@sapo.pt>

Hello,

Inline.

?s 20:27 de 05/02/2025, peter dalgaard escreveu:
> A 3rd option could be
> 
> scan(text=x, what="", blank.lines.skip=FALSE)
> 
> (all because readLines() doesn't obey the text=x convention, perhaps it should? I'm unsure whether the textConnection is left open in Rui's method.)

No, it is not left open. Use ?showConnections to check it.


x <- c("abc\ndef", "", "ghi")

x |> textConnection() |> readLines()
showConnections()

# this creates and opens a connection
tc <- textConnection(x)
showConnections()
readLines(tc)
showConnections()
close(tc)
showConnections()


Hope this helps,

Rui Barradas

> 
> -pd
> 
>> On 5 Feb 2025, at 15:35 , Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>
>> Thanks to Rui, Peter and Tanvir!  Peter's seems to be the fastest of the 3 suggestions so far on the little test case, but on the real data (where x contains several thousand lines), Rui's seems best.
>>
>> Duncan
>>
>> On 2025-02-05 9:13 a.m., peter dalgaard wrote:
>>> This also seems to work:
>>>> strsplit(paste(x,collapse="\n"),"\n")[[1]]
>>> [1] "abc" "def" ""    "ghi"
>>>> On 5 Feb 2025, at 14:44 , Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>>
>>>> If I have this object:
>>>>
>>>>   x <- c("abc\ndef", "", "ghi")
>>>>
>>>> and I write it to a file using `writeLines(x, "test.txt")`, my text editor sees a 5 line file:
>>>>
>>>>   1: abc
>>>>   2: def
>>>>   3:
>>>>   4: ghi
>>>>   5:
>>>>
>>>> which is what I'd expect:  the last line in the editor is empty.  If I use `readLines("test.txt")` on that file, I get the vector
>>>>
>>>>   c("abc", "def", "", "ghi")
>>>>
>>>> and all of that is fine.
>>>>
>>>> What I'm looking for is simple code that modifies x to the `readLines()` output, without actually writing and reading it.
>>>>
>>>> My first attempt doesn't work:
>>>>
>>>>   unlist(strsplit(x, "\n"))
>>>>
>>>> because it leaves out the blank line 3.  I can fix that with this ugly code:
>>>>
>>>>   lines <- strsplit(x, "\n")
>>>>   lines[sapply(lines, length) == 0] <- list("")
>>>>   lines <- unlist(lines)
>>>>
>>>> Surely there's a simpler way to do this?  I'd like to use just base functions, no other packages.
>>>>
>>>> Duncan Murdoch
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>
> 


-- 
Este e-mail foi analisado pelo software antiv?rus AVG para verificar a presen?a de v?rus.
www.avg.com


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Feb  6 00:04:30 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 5 Feb 2025 18:04:30 -0500
Subject: [R] Looking for simple line-splitting code
In-Reply-To: <20250206112045.43e9dea8@new-hp>
References: <cc02f160-3147-4bfc-89d0-21c5633cbbc5@gmail.com>
 <20250206112045.43e9dea8@new-hp>
Message-ID: <b17ed335-4457-4151-b4f1-ba00fa130bd5@gmail.com>

On 2025-02-05 5:20 p.m., Rolf Turner wrote:
> 
> On Wed, 5 Feb 2025 08:44:12 -0500
> Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
>> If I have this object:
>>
>>     x <- c("abc\ndef", "", "ghi")
>>
>> and I write it to a file using `writeLines(x, "test.txt")`, my text
>> editor sees a 5 line file:
>>
>>     1: abc
>>     2: def
>>     3:
>>     4: ghi
>>     5:
>>
>> which is what I'd expect:  the last line in the editor is empty.If I
>> use `readLines("test.txt")` on that file, I get the vector
>>
>>     c("abc", "def", "", "ghi")
> 
> 
> <SNIP>
> 
> Apologies for muddying the waters with my ignorance, but why would you
> expect a 5 line file?   I would expect a 4 line file, and that is
> indeed what I get when I try the code in question.
> 
> If I append an empty line at the end of my test.txt and then
> apply readLines() to that file, I get [1] "abc" "def" ""    "ghi" "",
> again as *I* would expect.
> 
> What am I missing?  Sorry for being a thicko.
> 

That fifth line is more a function of the editor (RStudio) than the 
file.  The last line ends with a newline.  The editor shows this by 
including a blank 5th line.  If the last line just stopped at the last 
letter, the editor would display it as a 4 line file.

Duncan Murdoch


From k|mmo@e|o @end|ng |rom ue|@||  Thu Feb  6 08:34:09 2025
From: k|mmo@e|o @end|ng |rom ue|@|| (Kimmo Elo)
Date: Thu, 6 Feb 2025 07:34:09 +0000
Subject: [R] Looking for simple line-splitting code
In-Reply-To: <fdff731e-d1f5-4ef2-bf3e-8a450f143e59@gmail.com>
References: <cc02f160-3147-4bfc-89d0-21c5633cbbc5@gmail.com>
 <07740212-AF66-4219-B235-F985BE744CA8@gmail.com>
 <fdff731e-d1f5-4ef2-bf3e-8a450f143e59@gmail.com>
Message-ID: <d67f3dd9d987c4f741c0d8b7afc0f0b2af89d48b.camel@uef.fi>

Hi,

using the library "stringi" allows this:

> unlist(stringr::str_split(x, "\n"))
[1] "abc" "def" ""    "ghi"

Best,
Kimmo

ke, 2025-02-05 kello 09:35 -0500, Duncan Murdoch kirjoitti:
> Thanks to Rui, Peter and Tanvir!  Peter's seems to be the fastest of
> the
> 3 suggestions so far on the little test case, but on the real data
> (where x contains several thousand lines), Rui's seems best.
>
> Duncan
>
> On 2025-02-05 9:13 a.m., peter dalgaard wrote:
> > This also seems to work:
> >
> > > strsplit(paste(x,collapse="\n"),"\n")[[1]]
> > [1] "abc" "def" ""    "ghi"
> >
> >
> > > On 5 Feb 2025, at 14:44 , Duncan Murdoch
> > > <murdoch.duncan at gmail.com> wrote:
> > >
> > > If I have this object:
> > >
> > >   x <- c("abc\ndef", "", "ghi")
> > >
> > > and I write it to a file using `writeLines(x, "test.txt")`, my
> > > text editor sees a 5 line file:
> > >
> > >   1: abc
> > >   2: def
> > >   3:
> > >   4: ghi
> > >   5:
> > >
> > > which is what I'd expect:  the last line in the editor is empty.
> > > If I use `readLines("test.txt")` on that file, I get the vector
> > >
> > >   c("abc", "def", "", "ghi")
> > >
> > > and all of that is fine.
> > >
> > > What I'm looking for is simple code that modifies x to the
> > > `readLines()` output, without actually writing and reading it.
> > >
> > > My first attempt doesn't work:
> > >
> > >   unlist(strsplit(x, "\n"))
> > >
> > > because it leaves out the blank line 3.  I can fix that with this
> > > ugly code:
> > >
> > >   lines <- strsplit(x, "\n")
> > >   lines[sapply(lines, length) == 0] <- list("")
> > >   lines <- unlist(lines)
> > >
> > > Surely there's a simpler way to do this?  I'd like to use just
> > > base functions, no other packages.
> > >
> > > Duncan Murdoch
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide
> > > https://www.r-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible
> > > code.
> >
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> https://www.r-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m|m@|tr@ @end|ng |rom gmx@com  Thu Feb  6 04:32:17 2025
From: m|m@|tr@ @end|ng |rom gmx@com (Ranjan Maitra)
Date: Wed, 5 Feb 2025 21:32:17 -0600
Subject: [R] pairs plot
Message-ID: <Z6QtQcmXeTvs8Ck7@iastate.edu>

According to the help for pairs, the diag.panel function is supposed to
take a panel.hist as in:

 pairs(USJudgeRatings[1:5], panel = panel.smooth,
           cex = 1.5, pch = 24, bg = "light blue", horOdd=TRUE,
           diag.panel = panel.hist, cex.labels = 2, font.labels = 2)

Error: object 'panel.hist' not found

I know that this used to work in the past so I wonder if this was changed and the documentation was not corrected.
Anyway, what is the current way of doing this?

Many thanks and best wishes,
Ranjan


From bgunter@4567 @end|ng |rom gm@||@com  Thu Feb  6 17:15:45 2025
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 6 Feb 2025 08:15:45 -0800
Subject: [R] pairs plot
In-Reply-To: <Z6QtQcmXeTvs8Ck7@iastate.edu>
References: <Z6QtQcmXeTvs8Ck7@iastate.edu>
Message-ID: <CAGxFJbR+NNtoTtRq7QZ=fCjPc5UR20qeRH1H53AWXRKGnSXovg@mail.gmail.com>

Possibly because:
panel.hist is not an existing R function -- you have to first create
it so pairs() can use it. ?pairs shows you how in the Help examples,
i.e.

panel.hist <- function(x, ...)
{
    usr <- par("usr")
    par(usr = c(usr[1:2], 0, 1.5) )
    h <- hist(x, plot = FALSE)
    breaks <- h$breaks; nB <- length(breaks)
    y <- h$counts; y <- y/max(y)
    rect(breaks[-nB], 0, breaks[-1], y, col = "cyan", ...)
}

Cheers,
Bert


On Thu, Feb 6, 2025 at 8:01?AM Ranjan Maitra via R-help
<r-help at r-project.org> wrote:
>
> According to the help for pairs, the diag.panel function is supposed to
> take a panel.hist as in:
>
>  pairs(USJudgeRatings[1:5], panel = panel.smooth,
>            cex = 1.5, pch = 24, bg = "light blue", horOdd=TRUE,
>            diag.panel = panel.hist, cex.labels = 2, font.labels = 2)
>
> Error: object 'panel.hist' not found
>
> I know that this used to work in the past so I wonder if this was changed and the documentation was not corrected.
> Anyway, what is the current way of doing this?
>
> Many thanks and best wishes,
> Ranjan
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Thu Feb  6 17:27:27 2025
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Thu, 6 Feb 2025 17:27:27 +0100
Subject: [R] pairs plot
In-Reply-To: <Z6QtQcmXeTvs8Ck7@iastate.edu>
References: <Z6QtQcmXeTvs8Ck7@iastate.edu>
Message-ID: <16888c06-1183-4277-8091-8000ba5a992b@statistik.tu-dortmund.de>

On 06.02.2025 04:32, Ranjan Maitra via R-help wrote:
> According to the help for pairs, the diag.panel function is supposed to
> take a panel.hist as in:
> 
>   pairs(USJudgeRatings[1:5], panel = panel.smooth,
>             cex = 1.5, pch = 24, bg = "light blue", horOdd=TRUE,
>             diag.panel = panel.hist, cex.labels = 2, font.labels = 2)
> 
> Error: object 'panel.hist' not found

Function panel.hist is only defined in the example section of pairs.

Best,
Uwe Ligges


> I know that this used to work in the past so I wonder if this was changed and the documentation was not corrected.
> Anyway, what is the current way of doing this?
> 
> Many thanks and best wishes,
> Ranjan
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @rii@mstei@ m@iii@g oii gm@ii@com  Thu Feb  6 18:36:23 2025
From: @rii@mstei@ m@iii@g oii gm@ii@com (@rii@mstei@ m@iii@g oii gm@ii@com)
Date: Thu, 6 Feb 2025 09:36:23 -0800
Subject: [R] install.packages and package dependencies
Message-ID: <CAEO2kuJfzGdeQOFKKPcyJbzct_5oOy178Ss1tsnbaYboA2xyNA@mail.gmail.com>

It appears that install.packages does not automatically install package
dependencies when the package is installed via a URL. As an example, here
is what I get when I attempt to install the latest ggplot2 tarball via its
URL on CRAN:

> install.packages("
https://cran.r-project.org/src/contrib/ggplot2_3.5.1.tar.gz")
inferring 'repos = NULL' from 'pkgs'
trying URL 'https://cran.r-project.org/src/contrib/ggplot2_3.5.1.tar.gz'
Content type 'application/x-gzip' length 3604371 bytes (3.4 MB)
==================================================
downloaded 3.4 MB

ERROR: dependencies ?cli?, ?glue?, ?gtable?, ?isoband?, ?lifecycle?,
?rlang?, ?scales?, ?tibble?, ?vctrs?, ?withr? are not available for package
?ggplot2?
* removing
?/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/ggplot2?
Warning in install.packages :
  installation of package
?/var/folders/m7/ztk511fj6vl4m6bw7vh47nk40000gn/T//RtmpmmFBOH/downloaded_packages/ggplot2_3.5.1.tar.gz?
had non-zero exit status
>

Is there a parameter I can give to install.packages so that it will
automatically install all the packages the package (in this example
ggplot2) needs? I've read the documentation of install.packages several
times, and am confused by the interplay of the various parameters. When I
type getOption('repos') I get:

                       CRAN
"https://cran.rstudio.com/"
attr(,"RStudio")
[1] TRUE

Without this it looks like installing from a URL is a 2-step process:

install.packages(c(<packages the package needs>))
install.packages("<url of package tarball>")

I am aware that there are some contributed packages (such as devtools and
remotes) that do this for you in a single line. But I am curious whether
this is possible via install.packages alone.

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Feb  6 21:37:50 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 6 Feb 2025 15:37:50 -0500
Subject: [R] install.packages and package dependencies
In-Reply-To: <CAEO2kuJfzGdeQOFKKPcyJbzct_5oOy178Ss1tsnbaYboA2xyNA@mail.gmail.com>
References: <CAEO2kuJfzGdeQOFKKPcyJbzct_5oOy178Ss1tsnbaYboA2xyNA@mail.gmail.com>
Message-ID: <56e8caed-82de-4142-9f24-62255a796eab@gmail.com>

I don't think install.packages() can do what you want.  If you are 
specifying a URL, then install.packages() assumes it has no way to know 
where the other dependencies are supposed to come from.

The typical way I install an unusual version of a package is to install 
the CRAN version first (install.packages("ggplot2") will do that, and 
will get all the deps), then reinstall the special version, and hope 
I've got all the right dependencies.

Duncan Murdoch

On 2025-02-06 12:36 p.m., arilamstein at gmail.com wrote:
> It appears that install.packages does not automatically install package
> dependencies when the package is installed via a URL. As an example, here
> is what I get when I attempt to install the latest ggplot2 tarball via its
> URL on CRAN:
> 
>> install.packages("
> https://cran.r-project.org/src/contrib/ggplot2_3.5.1.tar.gz")
> inferring 'repos = NULL' from 'pkgs'
> trying URL 'https://cran.r-project.org/src/contrib/ggplot2_3.5.1.tar.gz'
> Content type 'application/x-gzip' length 3604371 bytes (3.4 MB)
> ==================================================
> downloaded 3.4 MB
> 
> ERROR: dependencies ?cli?, ?glue?, ?gtable?, ?isoband?, ?lifecycle?,
> ?rlang?, ?scales?, ?tibble?, ?vctrs?, ?withr? are not available for package
> ?ggplot2?
> * removing
> ?/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/ggplot2?
> Warning in install.packages :
>    installation of package
> ?/var/folders/m7/ztk511fj6vl4m6bw7vh47nk40000gn/T//RtmpmmFBOH/downloaded_packages/ggplot2_3.5.1.tar.gz?
> had non-zero exit status
>>
> 
> Is there a parameter I can give to install.packages so that it will
> automatically install all the packages the package (in this example
> ggplot2) needs? I've read the documentation of install.packages several
> times, and am confused by the interplay of the various parameters. When I
> type getOption('repos') I get:
> 
>                         CRAN
> "https://cran.rstudio.com/"
> attr(,"RStudio")
> [1] TRUE
> 
> Without this it looks like installing from a URL is a 2-step process:
> 
> install.packages(c(<packages the package needs>))
> install.packages("<url of package tarball>")
> 
> I am aware that there are some contributed packages (such as devtools and
> remotes) that do this for you in a single line. But I am curious whether
> this is possible via install.packages alone.
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m|m@|tr@ @end|ng |rom gmx@com  Fri Feb  7 05:30:25 2025
From: m|m@|tr@ @end|ng |rom gmx@com (Ranjan Maitra)
Date: Thu, 6 Feb 2025 22:30:25 -0600
Subject: [R] pairs plot
In-Reply-To: <CAGxFJbR+NNtoTtRq7QZ=fCjPc5UR20qeRH1H53AWXRKGnSXovg@mail.gmail.com>
References: <Z6QtQcmXeTvs8Ck7@iastate.edu>
 <CAGxFJbR+NNtoTtRq7QZ=fCjPc5UR20qeRH1H53AWXRKGnSXovg@mail.gmail.com>
Message-ID: <Z6WMYSe_2_rWSTtQ@iastate.edu>

Bert,

Thanks very much!

Oops! I can not believe I completely  missed this!

Best wishes,
Ranjan



On Thu Feb06'25 08:15:45AM, Bert Gunter wrote:
> From: Bert Gunter <bgunter.4567 at gmail.com>
> Date: Thu, 6 Feb 2025 08:15:45 -0800
> To: Ranjan Maitra <mlmaitra at gmx.com>
> Cc: R-Help <r-help at r-project.org>
> Subject: Re: [R] pairs plot
>
> Possibly because:
> panel.hist is not an existing R function -- you have to first create
> it so pairs() can use it. ?pairs shows you how in the Help examples,
> i.e.
>
> panel.hist <- function(x, ...)
> {
>     usr <- par("usr")
>     par(usr = c(usr[1:2], 0, 1.5) )
>     h <- hist(x, plot = FALSE)
>     breaks <- h$breaks; nB <- length(breaks)
>     y <- h$counts; y <- y/max(y)
>     rect(breaks[-nB], 0, breaks[-1], y, col = "cyan", ...)
> }
>
> Cheers,
> Bert
>
>
> On Thu, Feb 6, 2025 at 8:01?AM Ranjan Maitra via R-help
> <r-help at r-project.org> wrote:
> >
> > According to the help for pairs, the diag.panel function is supposed to
> > take a panel.hist as in:
> >
> >  pairs(USJudgeRatings[1:5], panel = panel.smooth,
> >            cex = 1.5, pch = 24, bg = "light blue", horOdd=TRUE,
> >            diag.panel = panel.hist, cex.labels = 2, font.labels = 2)
> >
> > Error: object 'panel.hist' not found
> >
> > I know that this used to work in the past so I wonder if this was changed and the documentation was not corrected.
> > Anyway, what is the current way of doing this?
> >
> > Many thanks and best wishes,
> > Ranjan
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Sat Feb  8 13:26:18 2025
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Sat, 8 Feb 2025 12:26:18 +0000
Subject: [R] R CMD check error: File `inconsolata.sty' not found
In-Reply-To: <9310363F-7D97-4AB3-9E16-0A28E42F6F5F@hotmail.com>
References: <9141AF1E-5E6B-4786-8BE5-203F594C28E8@hotmail.com>
 <48d44dd7-28de-4aa6-ad38-52ed86dc4688@universite-paris-saclay.fr>
 <9310363F-7D97-4AB3-9E16-0A28E42F6F5F@hotmail.com>
Message-ID: <61691479-9C46-4AC7-A6FC-331A631C6FC1@hotmail.com>

This is about LaTeX install and not about R.  My problem was multiple installations of LaTeX: first using MacTex, then newer version using texlive.  I had also tried to install then uninstall using MacPorts.  It seems MacPorts uninstall was not clean.  I had to manually delete several sym links.  MacTex install inserts /etc/paths.d/TeX, which has the path /Library/TeX/texbin.  So to get TeX to use the more recent texlive install, PATH should be updated so that texlive comes before /Library/TeX/texbin.

With above corrections, my problem is solved.

This might help some other users:
1.  Check tex installation.  Multiple installs using different methods (MacTex, MacPorts, texlive using perl) can interfere with one another.
2.  Ensure that, in PATH variable, desired tex installation comes first.
3.  Verify that different tex family commands use the same tex installation.  For example, tlmgr - - version, tex - - version, should both point to the same installation.   

> On Feb 2, 2025, at 11:31?AM, Naresh Gurbuxani <naresh_gurbuxani at hotmail.com> wrote:
> 
> This did not help.  I removed inconsolata.sty, then reinstalled inconsolata.
> 
> bash-3.2$ sudo tlmgr install -reinstall inconsolata
> Password:
> Sorry, try again.
> Password:
> tlmgr: package repository https://ctan.tinycomputers.io/tex-archive/systems/texlive/tlnet (verified)
> [1/1, ??:??/??:??] reinstall: inconsolata [468k]
> running mktexlsr ...
> done running mktexlsr.
> running updmap-sys ...
> done running updmap-sys.
> tlmgr: package log updated: /usr/local/texlive/2024/texmf-var/web2c/tlmgr.log
> tlmgr: command log updated: /usr/local/texlive/2024/texmf-var/web2c/tlmgr-commands.log
> bash-3.2$ tlmgr info inconsolata
> package:     inconsolata
> category:    Package
> shortdesc:   A monospaced font, with support files for use with TeX
> longdesc:    Inconsolata is a monospaced font designed by Raph Levien. This package contains the font (in both Adobe Type 1 and OpenType formats) in regular and bold weights, with additional glyphs and options to control slashed zero, upright quotes and a shapelier lower-case L, plus metric files for use with TeX, and LaTeX font definition and other relevant files.
> installed:   Yes
> revision:    54512
> sizes:       doc: 597k, run: 1201k
> relocatable: No
> cat-version: 1.121
> cat-license: ofl apache2 lppl1.3
> cat-topics:  font font-mono font-type1 font-otf font-t1enc
> cat-contact-home: http://levien.com/type/myfonts/inconsolata.html
> collection:  collection-fontsextra
> 
> On running R CMD check, below is the bottom of the messages:
> 
> * checking PDF version of manual ... WARNING
> LaTeX errors when creating PDF version.
> This typically indicates Rd problems.
> LaTeX errors found:
> ! LaTeX Error: File `inconsolata.sty' not found.
> 
> Type X to quit or <RETURN> to proceed,
> or enter new name. (Default extension: sty)
> 
> ! Emergency stop.
> <read *> 
>         l.326 ^^M
>         !  ==> Fatal error occurred, no output PDF file produced!
> * checking PDF version of manual without index ... OK
> * DONE
> Status: 1 WARNING
> 
> 
>> On Feb 2, 2025, at 10:13?AM, Marc Girondot <marc.girondot at universite-paris-saclay.fr> wrote:
>> 
>> Hi Naresh
>> 
>> I have nearly the same configuration as yours:
>> I have this file installed (you must activate locate database to use locate):
>> locate inconsolata.sty
>> /usr/local/texlive/2024/texmf-dist/tex/latex/inconsolata/inconsolata.sty
>> 
>> Have you the file ?
>> 
>> If you have it, a solution could be to remove it and reinstall.
>> 
>> Marc
>> 
>> Le 02/02/2025 ? 15:58, Naresh Gurbuxani a ?crit :
>>> R CMD check <package> gives me below message at the end. There does not seem to be a problem with my TeX installation. Is it possible that R CMD check is not looking in the correct location? How can this problem be fixed?
>>> 
>>> Thanks,
>>> Naresh
>>> 
>>> * checking PDF version of manual ... WARNING
>>> LaTeX errors when creating PDF version.
>>> This typically indicates Rd problems.
>>> LaTeX errors found:
>>> ! LaTeX Error: File `inconsolata.sty' not found.
>>> 
>>> Type X to quit or <RETURN> to proceed,
>>> or enter new name. (Default extension: sty)
>>> 
>>> ! Emergency stop.
>>> <read *> 
>>> 
>>> l.326 ^^M
>>> 
>>> ! ==> Fatal error occurred, no output PDF file produced!
>>> * checking PDF version of manual without index ... OK
>>> * DONE
>>> 
>>> My Mac has the latest version of TeX installed from texlive. Below are top few lines from running tlmgr conf
>>> 
>>> =========================== version information ==========================
>>> tlmgr revision 73493 (2025-01-17 23:28:29 +0100)
>>> tlmgr using installation: /usr/local/texlive/2024
>>> TeX Live (https://tug.org/texlive) version 2024
>>> ==================== executables found by searching PATH =================
>>> PATH: /usr/local/texlive/2024/bin/universal-darwin:/opt/local/bin:/opt/local/sbin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/texlive/2024/bin/universal-darwin
>>> dvipdfmx: /usr/local/texlive/2024/bin/universal-darwin/dvipdfmx
>>> dvips: /usr/local/texlive/2024/bin/universal-darwin/dvips
>>> fmtutil: /usr/local/texlive/2024/bin/universal-darwin/fmtutil
>>> kpsewhich: /usr/local/texlive/2024/bin/universal-darwin/kpsewhich
>>> luatex: /usr/local/texlive/2024/bin/universal-darwin/luatex
>>> mktexpk: /usr/local/texlive/2024/bin/universal-darwin/mktexpk
>>> pdftex: /usr/local/texlive/2024/bin/universal-darwin/pdftex
>>> tex: /usr/local/texlive/2024/bin/universal-darwin/tex
>>> tlmgr: /usr/local/texlive/2024/bin/universal-darwin/tlmgr
>>> updmap: /usr/local/texlive/2024/bin/universal-darwin/updmap
>>> xetex: /usr/local/texlive/2024/bin/universal-darwin/xetex
>>> 
>>> On the command line, I tried updating incosolata package
>>> 
>>> bash-3.2$ sudo tlmgr install inconsolata
>>> Password:
>>> tlmgr: package repository https://ctan.tinycomputers.io/tex-archive/systems/texlive/tlnet (verified)
>>> tlmgr install: package already present: inconsolata
>>> 
>>> bash-3.2$ sudo tlmgr update inconsolata
>>> tlmgr: package repository https://ctan.tinycomputers.io/tex-archive/systems/texlive/tlnet (verified)
>>> tlmgr: saving backups to /usr/local/texlive/2024/tlpkg/backups
>>> tlmgr: no updates available
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>> 
>> 
>> Marc Girondot, Pr
>> Laboratoire Ecologie, Soci?t?, Evolution
>> Equipe de Processus Ecologiques et Pressions Anthropiques
>> CNRS, AgroParisTech et Universit? Paris-Saclay, UMR 8079
>> 91190 Gif-sur-Yvette, France
>> Tel: +33 (0)1.69.15.72.30 Mobile: +33 (0)6.20.18.22.16
>> e-mail: marc.girondot at universite-paris-saclay.fr
>> marc.girondot at gmail.com
>> Web: http://hebergement.universite-paris-saclay.fr/marcgirondot/
> 


From ju0815nk @end|ng |rom gmx@net  Tue Feb 11 13:51:48 2025
From: ju0815nk @end|ng |rom gmx@net (H B)
Date: Tue, 11 Feb 2025 13:51:48 +0100
Subject: [R] Unexpected result after auto-attaching of the Matrix package
Message-ID: <7560a90d-2662-4673-97ec-6cca47137044@gmx.net>

Dear all,

I just stumbled on this behavior - not sure if this is expected:

R version 4.4.2 (2024-10-31) -- "Pile of Leaves"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

 > library(Matrix)

 > sparseMatrix(i=1:10, j=1:10, x=rnorm(10)) |>
saveRDS("~/Downloads/sparsemat_test.rds")
 > q()
Save workspace image? [y/n/c]: n
# start R again
 > d <- readRDS("~/Downloads/sparsemat_test.rds")
 > class(d)
[1] "dgCMatrix"
attr(,"package")
[1] "Matrix"
 > dim(d)
Loading required package: Matrix
NULL
 > dim(d)
[1] 10 10

So the first call to dim(d) loads/attaches the Matrix package but
returns NULL for the call. Only the second call to dim returns the
correct results. I would expect the first call to succeed also,
otherwise what is the purpose of loading the package?

Best regards

Hilmar


 > sessionInfo()
R version 4.4.2 (2024-10-31)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 24.04.1 LTS

Matrix products: default
BLAS:?? /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.12.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.12.0

locale:
 ?[1] LC_CTYPE=en_US.UTF-8?????? LC_NUMERIC=C
 ?[3] LC_TIME=de_DE.UTF-8??????? LC_COLLATE=en_US.UTF-8
 ?[5] LC_MONETARY=de_DE.UTF-8??? LC_MESSAGES=en_US.UTF-8
 ?[7] LC_PAPER=de_DE.UTF-8?????? LC_NAME=C
 ?[9] LC_ADDRESS=C?????????????? LC_TELEPHONE=C
[11] LC_MEASUREMENT=de_DE.UTF-8 LC_IDENTIFICATION=C

time zone: Europe/Berlin
tzcode source: system (glibc)

attached base packages:> sessionInfo()
R version 4.4.2 (2024-10-31)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 24.04.1 LTS

Matrix products: default
BLAS:?? /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.12.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.12.0

locale:
 ?[1] LC_CTYPE=en_US.UTF-8?????? LC_NUMERIC=C
 ?[3] LC_TIME=de_DE.UTF-8??????? LC_COLLATE=en_US.UTF-8
 ?[5] LC_MONETARY=de_DE.UTF-8??? LC_MESSAGES=en_US.UTF-8
 ?[7] LC_PAPER=de_DE.UTF-8?????? LC_NAME=C
 ?[9] LC_ADDRESS=C?????????????? LC_TELEPHONE=C
[11] LC_MEASUREMENT=de_DE.UTF-8 LC_IDENTIFICATION=C

time zone: Europe/Berlin
tzcode source: system (glibc)

attached base packages:
[1] stats???? graphics? grDevices utils???? datasets? methods base

other attached packages:
[1] Matrix_1.7-2

loaded via a namespace (and not attached):
[1] compiler_4.4.2 grid_4.4.2???? lattice_0.22-5

[1] stats???? graphics? grDevices utils???? datasets? methods base

other attached packages:
[1] Matrix_1.7-2

loaded via a namespace (and not attached):
[1] compiler_4.4.2 grid_4.4.2???? lattice_0.22-5


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed Feb 12 03:02:01 2025
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Tue, 11 Feb 2025 18:02:01 -0800
Subject: [R] 
 Unexpected result after auto-attaching of the Matrix package
In-Reply-To: <7560a90d-2662-4673-97ec-6cca47137044@gmx.net>
References: <7560a90d-2662-4673-97ec-6cca47137044@gmx.net>
Message-ID: <9A8EF777-FABE-4A29-92BC-349A7B7DFD64@dcn.davis.ca.us>

Why aren't you loading the package before you load the object that assumes the relevant methods for that object are available?

On February 11, 2025 4:51:48 AM PST, H B via R-help <r-help at r-project.org> wrote:
>Dear all,
>
>I just stumbled on this behavior - not sure if this is expected:
>
>R version 4.4.2 (2024-10-31) -- "Pile of Leaves"
>Copyright (C) 2024 The R Foundation for Statistical Computing
>Platform: x86_64-pc-linux-gnu
>
>> library(Matrix)
>
>> sparseMatrix(i=1:10, j=1:10, x=rnorm(10)) |>
>saveRDS("~/Downloads/sparsemat_test.rds")
>> q()
>Save workspace image? [y/n/c]: n
># start R again
>> d <- readRDS("~/Downloads/sparsemat_test.rds")
>> class(d)
>[1] "dgCMatrix"
>attr(,"package")
>[1] "Matrix"
>> dim(d)
>Loading required package: Matrix
>NULL
>> dim(d)
>[1] 10 10
>
>So the first call to dim(d) loads/attaches the Matrix package but
>returns NULL for the call. Only the second call to dim returns the
>correct results. I would expect the first call to succeed also,
>otherwise what is the purpose of loading the package?
>
>Best regards
>
>Hilmar
>
>
>> sessionInfo()
>R version 4.4.2 (2024-10-31)
>Platform: x86_64-pc-linux-gnu
>Running under: Ubuntu 24.04.1 LTS
>
>Matrix products: default
>BLAS:?? /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.12.0
>LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.12.0
>
>locale:
>?[1] LC_CTYPE=en_US.UTF-8?????? LC_NUMERIC=C
>?[3] LC_TIME=de_DE.UTF-8??????? LC_COLLATE=en_US.UTF-8
>?[5] LC_MONETARY=de_DE.UTF-8??? LC_MESSAGES=en_US.UTF-8
>?[7] LC_PAPER=de_DE.UTF-8?????? LC_NAME=C
>?[9] LC_ADDRESS=C?????????????? LC_TELEPHONE=C
>[11] LC_MEASUREMENT=de_DE.UTF-8 LC_IDENTIFICATION=C
>
>time zone: Europe/Berlin
>tzcode source: system (glibc)
>
>attached base packages:> sessionInfo()
>R version 4.4.2 (2024-10-31)
>Platform: x86_64-pc-linux-gnu
>Running under: Ubuntu 24.04.1 LTS
>
>Matrix products: default
>BLAS:?? /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.12.0
>LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.12.0
>
>locale:
>?[1] LC_CTYPE=en_US.UTF-8?????? LC_NUMERIC=C
>?[3] LC_TIME=de_DE.UTF-8??????? LC_COLLATE=en_US.UTF-8
>?[5] LC_MONETARY=de_DE.UTF-8??? LC_MESSAGES=en_US.UTF-8
>?[7] LC_PAPER=de_DE.UTF-8?????? LC_NAME=C
>?[9] LC_ADDRESS=C?????????????? LC_TELEPHONE=C
>[11] LC_MEASUREMENT=de_DE.UTF-8 LC_IDENTIFICATION=C
>
>time zone: Europe/Berlin
>tzcode source: system (glibc)
>
>attached base packages:
>[1] stats???? graphics? grDevices utils???? datasets? methods base
>
>other attached packages:
>[1] Matrix_1.7-2
>
>loaded via a namespace (and not attached):
>[1] compiler_4.4.2 grid_4.4.2???? lattice_0.22-5
>
>[1] stats???? graphics? grDevices utils???? datasets? methods base
>
>other attached packages:
>[1] Matrix_1.7-2
>
>loaded via a namespace (and not attached):
>[1] compiler_4.4.2 grid_4.4.2???? lattice_0.22-5
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From berw|n@tur|@ch @end|ng |rom gm@||@com  Wed Feb 12 03:29:39 2025
From: berw|n@tur|@ch @end|ng |rom gm@||@com (Berwin A Turlach)
Date: Wed, 12 Feb 2025 10:29:39 +0800
Subject: [R] install.packages and package dependencies
In-Reply-To: <CAEO2kuJfzGdeQOFKKPcyJbzct_5oOy178Ss1tsnbaYboA2xyNA@mail.gmail.com>
References: <CAEO2kuJfzGdeQOFKKPcyJbzct_5oOy178Ss1tsnbaYboA2xyNA@mail.gmail.com>
Message-ID: <20250212102939.6658d5aa@dep59159.uniwa.uwa.edu.au>

On Thu, 6 Feb 2025 09:36:23 -0800
arilamstein at gmail.com wrote:

> It appears that install.packages does not automatically install
> package dependencies when the package is installed via a URL. [...]
> When I type getOption('repos') I get:
> 
>                        CRAN
> "https://cran.rstudio.com/"
> attr(,"RStudio")
> [1] TRUE

Do you set this value somewhere (via an environment variable or start
up file)?  Or is it this value because you use RStudio as IDE?

If you use RStudio, please be aware that RStudio has its own version of
install.packages():

RStudio> install.packages
function (...) 
.rs.callAs(name, hook, original, ...)
<environment: 0x12a530f00>

So if you are using RStudio, you will have to talk with Posit about
changing the behaviour of install.packages().

If you want the behaviour of utils::install.packages() to change, I am
sure that R-Core will consider any diff that implements the
new/improved behaviour. :-)

Cheers,

	Berwin


From |kry|ov @end|ng |rom d|@root@org  Wed Feb 12 14:09:35 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Wed, 12 Feb 2025 16:09:35 +0300
Subject: [R] 
 Unexpected result after auto-attaching of the Matrix package
In-Reply-To: <7560a90d-2662-4673-97ec-6cca47137044@gmx.net>
References: <7560a90d-2662-4673-97ec-6cca47137044@gmx.net>
Message-ID: <20250212160935.6ddacce1@arachnoid>

? Tue, 11 Feb 2025 13:51:48 +0100
H B via R-help <r-help at r-project.org> ?????:

>  > class(d)  
> [1] "dgCMatrix"
> attr(,"package")
> [1] "Matrix"
>  > dim(d)  
> Loading required package: Matrix
> NULL

Here's what happens here:

1. .Primitive("dim") considers dispatching a dim() method:
https://github.com/r-devel/r-svn/blob/fa73948a1977da05788499807469e69d5a21bd98/src/main/attrib.c#L1181
2. DispatchOrEval() first considers S4 dispatch:
https://github.com/r-devel/r-svn/blob/fa73948a1977da05788499807469e69d5a21bd98/src/main/eval.c#L4152
3. But then R_has_methods(dim) finds out that no S4 methods are
currently registered for dim() - Matrix not being loaded yet - and S4
dispatch is abandoned:
https://github.com/r-devel/r-svn/blob/fa73948a1977da05788499807469e69d5a21bd98/src/main/objects.c#L1578
4. Instead, R tries usemethod(...) for S3 dispatch:
https://github.com/r-devel/r-svn/blob/fa73948a1977da05788499807469e69d5a21bd98/src/main/eval.c#L4215
5. UseMethod() wants to find out the S3 class vector for 'd' and calls
R_data_class2():
https://github.com/r-devel/r-svn/blob/fa73948a1977da05788499807469e69d5a21bd98/src/main/objects.c#L493
6. R_data_class2() sees it's an S4 object and calls
methods:::.extendsForS3(class(d)), which finally loads Matrix in order
to find out classes extended by "dgCMatrix":
https://github.com/r-devel/r-svn/blob/fa73948a1977da05788499807469e69d5a21bd98/src/main/attrib.c#L840
https://github.com/r-devel/r-svn/blob/fa73948a1977da05788499807469e69d5a21bd98/src/main/attrib.c#L736-L741
7. S3 dispatch fails for all those S4 classes or the "default" method,
so dim(d) returns attr(d, "dim") (which is not set):
https://github.com/r-devel/r-svn/blob/fa73948a1977da05788499807469e69d5a21bd98/src/main/attrib.c#L1184

Then why does print(d) work without loading Matrix first?
print.default() internally performs S4 dispatch after Matrix was loaded
by R_data_class2() on step (6) above.

So while Matrix is not being loaded by accident in your example, things
are not set up to load the packages containing S4 classes
automatically. It could become a feature request for DispatchOrEval()
to ensure that the the package owning the S4 class is loaded before
trying to dispatch an S4 method, although it could be challenging to
implement while avoiding additional slowdowns.

-- 
Best regards,
Ivan


From @rii@mstei@ m@iii@g oii gm@ii@com  Thu Feb 13 00:56:25 2025
From: @rii@mstei@ m@iii@g oii gm@ii@com (@rii@mstei@ m@iii@g oii gm@ii@com)
Date: Wed, 12 Feb 2025 15:56:25 -0800
Subject: [R] install.packages and package dependencies
In-Reply-To: <20250212102939.6658d5aa@dep59159.uniwa.uwa.edu.au>
References: <CAEO2kuJfzGdeQOFKKPcyJbzct_5oOy178Ss1tsnbaYboA2xyNA@mail.gmail.com>
 <20250212102939.6658d5aa@dep59159.uniwa.uwa.edu.au>
Message-ID: <CAEO2ku+8rjSZuYHbcM9vfQ9NwmbRhR3V1Ye1H-52mXRegeJ_yw@mail.gmail.com>

Duncan and Berwin,

Thank you for your help.

I really wanted confirmation from someone more experienced than me that I
wasn't missing something. It looks like there is no way to do this in one
line in base R, and that's fine.

For reference, the packages that I am doing this for are acs and
choroplethr, both of which were archived today. (choroplethr depends on
acs, and acs was archived due to a NOTE. I was the maintainer of
chroplethr).

I believe that at least a few people will still want to use choroplethr, at
least for a little while. The instructions I have posted on this are
consistent with what I wrote above for:

# Install binary versions of acs' dependencies, then install acs from source
acs_imports = c("stringr", "XML", "plyr", "httr")
install.packages(acs_imports)
install.packages("
https://cran.r-project.org/src/contrib/Archive/acs/acs_2.1.4.tar.gz")

# Install binary versions of choroplethr's dependencies, then install
choroplethr from source
choroplethr_imports = c("Hmisc", "ggplot2", "dplyr", "R6", "WDI", "ggmap",
"RgoogleMaps", "tigris", "gridExtra", "xml2", "tidyr", "tidycensus",
"testthat", "choroplethrMaps", "choroplethrAdmin1")
install.packages(choroplethr_imports)
install.packages("
https://cran.r-project.org/src/contrib/Archive/choroplethr/choroplethr_3.7.3.tar.gz
")

I believe that both the remotes and devtools packages have functions that
can do this in one line of code. But I believe that they install all the
dependencies from source. I found that there were intermittent failures
with that (not in the acs or choroplethr packages, surprisingly). And also
it was substantially slower (319 seconds for devtools' install_version vs.
43 seconds for the code I showed above).

Berwin, your post actually made me chuckle. In the original draft of my
post I wrote something like "I tried to look at what install.packages does
by typing 'install.packages' but it shows me something I can't understand:

> install.packages
function (...)
.rs.callAs(name, hook, original, ...)
<environment: 0x118030cc0>"

I am indeed using RStudio and I had no idea that they overwrote that
function!

	[[alternative HTML version deleted]]


From Ach|m@Ze||e|@ @end|ng |rom u|bk@@c@@t  Thu Feb 13 12:42:21 2025
From: Ach|m@Ze||e|@ @end|ng |rom u|bk@@c@@t (Achim Zeileis)
Date: Thu, 13 Feb 2025 12:42:21 +0100 (CET)
Subject: [R] install.packages and package dependencies
In-Reply-To: <CAEO2ku+8rjSZuYHbcM9vfQ9NwmbRhR3V1Ye1H-52mXRegeJ_yw@mail.gmail.com>
References: <CAEO2kuJfzGdeQOFKKPcyJbzct_5oOy178Ss1tsnbaYboA2xyNA@mail.gmail.com>
 <20250212102939.6658d5aa@dep59159.uniwa.uwa.edu.au>
 <CAEO2ku+8rjSZuYHbcM9vfQ9NwmbRhR3V1Ye1H-52mXRegeJ_yw@mail.gmail.com>
Message-ID: <68f241ab-8f79-bae4-4606-84c5e17c33fb@uibk.ac.at>

On Thu, 13 Feb 2025, arilamstein at gmail.com wrote:

> Duncan and Berwin,
>
> Thank you for your help.
>
> I really wanted confirmation from someone more experienced than me that I
> wasn't missing something. It looks like there is no way to do this in one
> line in base R, and that's fine.
>
> For reference, the packages that I am doing this for are acs and
> choroplethr, both of which were archived today. (choroplethr depends on
> acs, and acs was archived due to a NOTE. I was the maintainer of
> chroplethr).
>
> I believe that at least a few people will still want to use choroplethr, at
> least for a little while.

Maybe it would be an option for you to adopt and fix the NOTE for "acs"?

Its CRAN page (https://CRAN.R-project.org/package=acs) conveys that the 
original acs author will not keep on maintaining it. But the problems seem 
like they can be addressed without too much effort. Then you could bring 
back both acs and choroplethr.

Best wishes,
Achim

> The instructions I have posted on this are consistent with what I wrote 
> above for:
>
> # Install binary versions of acs' dependencies, then install acs from source
> acs_imports = c("stringr", "XML", "plyr", "httr")
> install.packages(acs_imports)
> install.packages("
> https://cran.r-project.org/src/contrib/Archive/acs/acs_2.1.4.tar.gz")
>
> # Install binary versions of choroplethr's dependencies, then install
> choroplethr from source
> choroplethr_imports = c("Hmisc", "ggplot2", "dplyr", "R6", "WDI", "ggmap",
> "RgoogleMaps", "tigris", "gridExtra", "xml2", "tidyr", "tidycensus",
> "testthat", "choroplethrMaps", "choroplethrAdmin1")
> install.packages(choroplethr_imports)
> install.packages("
> https://cran.r-project.org/src/contrib/Archive/choroplethr/choroplethr_3.7.3.tar.gz
> ")
>
> I believe that both the remotes and devtools packages have functions that
> can do this in one line of code. But I believe that they install all the
> dependencies from source. I found that there were intermittent failures
> with that (not in the acs or choroplethr packages, surprisingly). And also
> it was substantially slower (319 seconds for devtools' install_version vs.
> 43 seconds for the code I showed above).
>
> Berwin, your post actually made me chuckle. In the original draft of my
> post I wrote something like "I tried to look at what install.packages does
> by typing 'install.packages' but it shows me something I can't understand:
>
>> install.packages
> function (...)
> .rs.callAs(name, hook, original, ...)
> <environment: 0x118030cc0>"
>
> I am indeed using RStudio and I had no idea that they overwrote that
> function!
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From ru@@e||-|enth @end|ng |rom u|ow@@edu  Wed Feb 12 22:42:56 2025
From: ru@@e||-|enth @end|ng |rom u|ow@@edu (Lenth, Russell V)
Date: Wed, 12 Feb 2025 21:42:56 +0000
Subject: [R] Reverse dependency checking
Message-ID: <BN7PR04MB3844887EF21A85E8017F52BAF1FC2@BN7PR04MB3844.namprd04.prod.outlook.com>

Dear R-Help,

When I submit an update to one of my packages, I decided to try to avoid having to fix errors that sometimes occur in CRAN's reverse-dependency checks by performing the same checks ahead of time. From what I can tell, the way to do this is to use

    tools::check_packages_in_dir(..., reverse = list(which = "all"), ...)

It does not surprise me that this takes a lot of time! One of my packages has quite a few reverse suggests, so this process installs all packages that my package or any of the reverse depends requires, which is about a zillion. But eventually, this works. I've learned to run this in batch mode so it doesn't tie up Rgui or RStudio. That's fine; I just have a script that I can run.

I have two questions:

1. While it is installing all those packages, I see a lot of chatter so I can see what progress is being made, however glacial. But when it gets the the phase where it checks each of the reverse-dependent packages, it is utterly silent. It would be really helpful to me if check_packages_in_dir() would just print a one-line message that it is checking such-and-such package.

2. Is there any way to streamline the checking? It seems to me that since all the packages are already on CRAN and thus pass most checks, all that we need to check for reverse dependencies are the examples, vignettes, and tests. This could save a lot of time.

Thanks

Russ Lenth
U of Iowa, USA


From jeroenoom@ @end|ng |rom gm@||@com  Thu Feb 13 13:59:08 2025
From: jeroenoom@ @end|ng |rom gm@||@com (Jeroen Ooms)
Date: Thu, 13 Feb 2025 13:59:08 +0100
Subject: [R] Reverse dependency checking
In-Reply-To: <BN7PR04MB3844887EF21A85E8017F52BAF1FC2@BN7PR04MB3844.namprd04.prod.outlook.com>
References: <BN7PR04MB3844887EF21A85E8017F52BAF1FC2@BN7PR04MB3844.namprd04.prod.outlook.com>
Message-ID: <CABFfbXvXDv8xPD4aL77AVipD+ieXpnqrd6PDamd2iFO0QwZKdA@mail.gmail.com>

On Thu, Feb 13, 2025 at 1:46?PM Lenth, Russell V via R-help
<r-help at r-project.org> wrote:
>
> Dear R-Help,
>
> When I submit an update to one of my packages, I decided to try to avoid having to fix errors that sometimes occur in CRAN's reverse-dependency checks by performing the same checks ahead of time. From what I can tell, the way to do this is to use
>
>     tools::check_packages_in_dir(..., reverse = list(which = "all"), ...)
>
> It does not surprise me that this takes a lot of time! One of my packages has quite a few reverse suggests, so this process installs all packages that my package or any of the reverse depends requires, which is about a zillion. But eventually, this works. I've learned to run this in batch mode so it doesn't tie up Rgui or RStudio. That's fine; I just have a script that I can run.
>
> I have two questions:
>
> 1. While it is installing all those packages, I see a lot of chatter so I can see what progress is being made, however glacial. But when it gets the the phase where it checks each of the reverse-dependent packages, it is utterly silent. It would be really helpful to me if check_packages_in_dir() would just print a one-line message that it is checking such-and-such package.
>
> 2. Is there any way to streamline the checking? It seems to me that since all the packages are already on CRAN and thus pass most checks, all that we need to check for reverse dependencies are the examples, vignettes, and tests. This could save a lot of time.

You may also want to try the recheck container + github action, which
runs the recheck process on public infrastructure:
https://github.com/r-devel/recheck





>
> Thanks
>
> Russ Lenth
> U of Iowa, USA
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Feb 13 14:43:39 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 13 Feb 2025 08:43:39 -0500
Subject: [R] Reverse dependency checking
In-Reply-To: <BN7PR04MB3844887EF21A85E8017F52BAF1FC2@BN7PR04MB3844.namprd04.prod.outlook.com>
References: <BN7PR04MB3844887EF21A85E8017F52BAF1FC2@BN7PR04MB3844.namprd04.prod.outlook.com>
Message-ID: <cd211503-8ad7-42d3-b46e-5c4b2f340307@gmail.com>

On 2025-02-12 4:42 p.m., Lenth, Russell V via R-help wrote:
> Dear R-Help,
> 
> When I submit an update to one of my packages, I decided to try to avoid having to fix errors that sometimes occur in CRAN's reverse-dependency checks by performing the same checks ahead of time. From what I can tell, the way to do this is to use
> 
>      tools::check_packages_in_dir(..., reverse = list(which = "all"), ...)
> 
> It does not surprise me that this takes a lot of time! One of my packages has quite a few reverse suggests, so this process installs all packages that my package or any of the reverse depends requires, which is about a zillion. But eventually, this works. I've learned to run this in batch mode so it doesn't tie up Rgui or RStudio. That's fine; I just have a script that I can run.
> 
> I have two questions:
> 
> 1. While it is installing all those packages, I see a lot of chatter so I can see what progress is being made, however glacial. But when it gets the the phase where it checks each of the reverse-dependent packages, it is utterly silent. It would be really helpful to me if check_packages_in_dir() would just print a one-line message that it is checking such-and-such package.

There are several re-implementations of that code.  Jeroen pointed you 
to one, I think devtools has another.  You should try those.
> 
> 2. Is there any way to streamline the checking? It seems to me that since all the packages are already on CRAN and thus pass most checks, all that we need to check for reverse dependencies are the examples, vignettes, and tests. This could save a lot of time.

I think there can't be.  You may have dropped some export, or changed 
its behaviour.  Even suggested packages can be used anywhere (with tests 
that they are installed), so your changes could conceivably have bad 
effects in lots of strange ways. There are probably a few of the checks 
that could be dropped, but not most of them.

Duncan


From bbo|ker @end|ng |rom gm@||@com  Thu Feb 13 14:50:43 2025
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Thu, 13 Feb 2025 08:50:43 -0500
Subject: [R] Reverse dependency checking
In-Reply-To: <cd211503-8ad7-42d3-b46e-5c4b2f340307@gmail.com>
References: <BN7PR04MB3844887EF21A85E8017F52BAF1FC2@BN7PR04MB3844.namprd04.prod.outlook.com>
 <cd211503-8ad7-42d3-b46e-5c4b2f340307@gmail.com>
Message-ID: <f3cf530e-8e40-49e7-92ac-0f85d9288bae@gmail.com>

   For what it's worth I use https://github.com/r-lib/revdepcheck (see 
also https://revdepcheck.r-lib.org/ ) ... it has some of its own warts, 
but it has a very informative progress bar.

On 2025-02-13 8:43 a.m., Duncan Murdoch wrote:
> On 2025-02-12 4:42 p.m., Lenth, Russell V via R-help wrote:
>> Dear R-Help,
>>
>> When I submit an update to one of my packages, I decided to try to 
>> avoid having to fix errors that sometimes occur in CRAN's reverse- 
>> dependency checks by performing the same checks ahead of time. From 
>> what I can tell, the way to do this is to use
>>
>> ???? tools::check_packages_in_dir(..., reverse = list(which = 
>> "all"), ...)
>>
>> It does not surprise me that this takes a lot of time! One of my 
>> packages has quite a few reverse suggests, so this process installs 
>> all packages that my package or any of the reverse depends requires, 
>> which is about a zillion. But eventually, this works. I've learned to 
>> run this in batch mode so it doesn't tie up Rgui or RStudio. That's 
>> fine; I just have a script that I can run.
>>
>> I have two questions:
>>
>> 1. While it is installing all those packages, I see a lot of chatter 
>> so I can see what progress is being made, however glacial. But when it 
>> gets the the phase where it checks each of the reverse-dependent 
>> packages, it is utterly silent. It would be really helpful to me if 
>> check_packages_in_dir() would just print a one-line message that it is 
>> checking such-and-such package.
> 
> There are several re-implementations of that code.? Jeroen pointed you 
> to one, I think devtools has another.? You should try those.
>>
>> 2. Is there any way to streamline the checking? It seems to me that 
>> since all the packages are already on CRAN and thus pass most checks, 
>> all that we need to check for reverse dependencies are the examples, 
>> vignettes, and tests. This could save a lot of time.
> 
> I think there can't be.? You may have dropped some export, or changed 
> its behaviour.? Even suggested packages can be used anywhere (with tests 
> that they are installed), so your changes could conceivably have bad 
> effects in lots of strange ways. There are probably a few of the checks 
> that could be dropped, but not most of them.
> 
> Duncan
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting- 
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From pd@|gd @end|ng |rom gm@||@com  Thu Feb 13 15:57:22 2025
From: pd@|gd @end|ng |rom gm@||@com (peter dalgaard)
Date: Thu, 13 Feb 2025 15:57:22 +0100
Subject: [R] [Rd] R 4.4.3 scheduled for February 28
Message-ID: <4A3CB298-ABFF-4F42-B3BE-69F3C1F5B85C@gmail.com>

Full schedule is available on developer.r-project.org (pending update from SVN).

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel

_______________________________________________
R-announce at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-announce


From ju0815nk @end|ng |rom gmx@net  Wed Feb 12 21:46:49 2025
From: ju0815nk @end|ng |rom gmx@net (H B)
Date: Wed, 12 Feb 2025 21:46:49 +0100
Subject: [R] 
 Unexpected result after auto-attaching of the Matrix package
In-Reply-To: <20250212160935.6ddacce1@arachnoid>
References: <7560a90d-2662-4673-97ec-6cca47137044@gmx.net>
 <20250212160935.6ddacce1@arachnoid>
Message-ID: <dfc2d617-77ca-4e39-bef4-8dd6512152c6@gmx.net>

Dear? Ivan,

thanks a lot for the detailed analysis. This is excellent? and answers
my question. Unfortunately it is difficult to find any documentation on
this topic.

I now understand this is not a formal library? auto-loading feature.

What I still see as problematic is that in this way one can get two
different results when trying to access the? same object in the same?
way,? without any error or warning message.

Thanks again!

Best regards

Hilmar

On 12.02.25 14:09, Ivan Krylov wrote:
> ? Tue, 11 Feb 2025 13:51:48 +0100
> H B via R-help <r-help at r-project.org> ?????:
>
>>   > class(d)
>> [1] "dgCMatrix"
>> attr(,"package")
>> [1] "Matrix"
>>   > dim(d)
>> Loading required package: Matrix
>> NULL
> Here's what happens here:
>
> 1. .Primitive("dim") considers dispatching a dim() method:
> https://github.com/r-devel/r-svn/blob/fa73948a1977da05788499807469e69d5a21bd98/src/main/attrib.c#L1181
> 2. DispatchOrEval() first considers S4 dispatch:
> https://github.com/r-devel/r-svn/blob/fa73948a1977da05788499807469e69d5a21bd98/src/main/eval.c#L4152
> 3. But then R_has_methods(dim) finds out that no S4 methods are
> currently registered for dim() - Matrix not being loaded yet - and S4
> dispatch is abandoned:
> https://github.com/r-devel/r-svn/blob/fa73948a1977da05788499807469e69d5a21bd98/src/main/objects.c#L1578
> 4. Instead, R tries usemethod(...) for S3 dispatch:
> https://github.com/r-devel/r-svn/blob/fa73948a1977da05788499807469e69d5a21bd98/src/main/eval.c#L4215
> 5. UseMethod() wants to find out the S3 class vector for 'd' and calls
> R_data_class2():
> https://github.com/r-devel/r-svn/blob/fa73948a1977da05788499807469e69d5a21bd98/src/main/objects.c#L493
> 6. R_data_class2() sees it's an S4 object and calls
> methods:::.extendsForS3(class(d)), which finally loads Matrix in order
> to find out classes extended by "dgCMatrix":
> https://github.com/r-devel/r-svn/blob/fa73948a1977da05788499807469e69d5a21bd98/src/main/attrib.c#L840
> https://github.com/r-devel/r-svn/blob/fa73948a1977da05788499807469e69d5a21bd98/src/main/attrib.c#L736-L741
> 7. S3 dispatch fails for all those S4 classes or the "default" method,
> so dim(d) returns attr(d, "dim") (which is not set):
> https://github.com/r-devel/r-svn/blob/fa73948a1977da05788499807469e69d5a21bd98/src/main/attrib.c#L1184
>
> Then why does print(d) work without loading Matrix first?
> print.default() internally performs S4 dispatch after Matrix was loaded
> by R_data_class2() on step (6) above.
>
> So while Matrix is not being loaded by accident in your example, things
> are not set up to load the packages containing S4 classes
> automatically. It could become a feature request for DispatchOrEval()
> to ensure that the the package owning the S4 class is loaded before
> trying to dispatch an S4 method, although it could be challenging to
> implement while avoiding additional slowdowns.
>


From ju0815nk @end|ng |rom gmx@net  Thu Feb 13 10:48:43 2025
From: ju0815nk @end|ng |rom gmx@net (H B)
Date: Thu, 13 Feb 2025 10:48:43 +0100
Subject: [R] 
 Unexpected result after auto-attaching of the Matrix package
In-Reply-To: <9A8EF777-FABE-4A29-92BC-349A7B7DFD64@dcn.davis.ca.us>
References: <7560a90d-2662-4673-97ec-6cca47137044@gmx.net>
 <9A8EF777-FABE-4A29-92BC-349A7B7DFD64@dcn.davis.ca.us>
Message-ID: <2104bdc4-5af2-46d8-92cf-0cf9f4dc46d5@gmx.net>

Hi Jeff,

you are obviously right and I would usually load packages before, but in
this case it was a saved R object that I had not created, and therefore
did not know what to expect.

I was prepared to get an error message, but not getting an error or at
least a warning and then getting the wrong result was kind of unexpected.

Best regards

Hilmar

On 12.02.25 03:02, Jeff Newmiller wrote:
> Why aren't you loading the package before you load the object that assumes the relevant methods for that object are available?
>
> On February 11, 2025 4:51:48 AM PST, H B via R-help <r-help at r-project.org> wrote:
>> Dear all,
>>
>> I just stumbled on this behavior - not sure if this is expected:
>>
>> R version 4.4.2 (2024-10-31) -- "Pile of Leaves"
>> Copyright (C) 2024 The R Foundation for Statistical Computing
>> Platform: x86_64-pc-linux-gnu
>>
>>> library(Matrix)
>>> sparseMatrix(i=1:10, j=1:10, x=rnorm(10)) |>
>> saveRDS("~/Downloads/sparsemat_test.rds")
>>> q()
>> Save workspace image? [y/n/c]: n
>> # start R again
>>> d <- readRDS("~/Downloads/sparsemat_test.rds")
>>> class(d)
>> [1] "dgCMatrix"
>> attr(,"package")
>> [1] "Matrix"
>>> dim(d)
>> Loading required package: Matrix
>> NULL
>>> dim(d)
>> [1] 10 10
>>
>> So the first call to dim(d) loads/attaches the Matrix package but
>> returns NULL for the call. Only the second call to dim returns the
>> correct results. I would expect the first call to succeed also,
>> otherwise what is the purpose of loading the package?
>>
>> Best regards
>>
>> Hilmar
>>
>>
>>> sessionInfo()
>> R version 4.4.2 (2024-10-31)
>> Platform: x86_64-pc-linux-gnu
>> Running under: Ubuntu 24.04.1 LTS
>>
>> Matrix products: default
>> BLAS:?? /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.12.0
>> LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.12.0
>>
>> locale:
>>  ?[1] LC_CTYPE=en_US.UTF-8?????? LC_NUMERIC=C
>>  ?[3] LC_TIME=de_DE.UTF-8??????? LC_COLLATE=en_US.UTF-8
>>  ?[5] LC_MONETARY=de_DE.UTF-8??? LC_MESSAGES=en_US.UTF-8
>>  ?[7] LC_PAPER=de_DE.UTF-8?????? LC_NAME=C
>>  ?[9] LC_ADDRESS=C?????????????? LC_TELEPHONE=C
>> [11] LC_MEASUREMENT=de_DE.UTF-8 LC_IDENTIFICATION=C
>>
>> time zone: Europe/Berlin
>> tzcode source: system (glibc)
>>
>> attached base packages:> sessionInfo()
>> R version 4.4.2 (2024-10-31)
>> Platform: x86_64-pc-linux-gnu
>> Running under: Ubuntu 24.04.1 LTS
>>
>> Matrix products: default
>> BLAS:?? /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.12.0
>> LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.12.0
>>
>> locale:
>>  ?[1] LC_CTYPE=en_US.UTF-8?????? LC_NUMERIC=C
>>  ?[3] LC_TIME=de_DE.UTF-8??????? LC_COLLATE=en_US.UTF-8
>>  ?[5] LC_MONETARY=de_DE.UTF-8??? LC_MESSAGES=en_US.UTF-8
>>  ?[7] LC_PAPER=de_DE.UTF-8?????? LC_NAME=C
>>  ?[9] LC_ADDRESS=C?????????????? LC_TELEPHONE=C
>> [11] LC_MEASUREMENT=de_DE.UTF-8 LC_IDENTIFICATION=C
>>
>> time zone: Europe/Berlin
>> tzcode source: system (glibc)
>>
>> attached base packages:
>> [1] stats???? graphics? grDevices utils???? datasets? methods base
>>
>> other attached packages:
>> [1] Matrix_1.7-2
>>
>> loaded via a namespace (and not attached):
>> [1] compiler_4.4.2 grid_4.4.2???? lattice_0.22-5
>>
>> [1] stats???? graphics? grDevices utils???? datasets? methods base
>>
>> other attached packages:
>> [1] Matrix_1.7-2
>>
>> loaded via a namespace (and not attached):
>> [1] compiler_4.4.2 grid_4.4.2???? lattice_0.22-5
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Thu Feb 13 20:02:51 2025
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 13 Feb 2025 11:02:51 -0800
Subject: [R] Completely Off Topic: Renowned scientific integrity
 investigator endows fund to support fellow sleuths
Message-ID: <CAGxFJbRTD3H7Zba9h_TeQdavr1HcgpmGNwJFO_UfV_2JRi91kw@mail.gmail.com>

Again, **Completely Off Topic,** but I hope of interest to at least some on
this forum.

https://www.science.org/content/article/renowned-scientific-integrity-investigator-endows-fund-support-fellow-sleuths

Please do not reply. This is just FYI.

Best to all,
Bert

"An educated person is one who can entertain new ideas, entertain others,
and entertain herself."

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Thu Feb 13 20:56:29 2025
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Thu, 13 Feb 2025 19:56:29 +0000
Subject: [R] install.packages and package dependencies
Message-ID: <OSWP279MB0471513D25EBD4AB56607119EEFF2@OSWP279MB0471.NORP279.PROD.OUTLOOK.COM>

Ari,

There were multiple errors in the acs package. If CRAN states that the maintainer abandoned it, that is what happened. Had you reached out to Ezra Glenn (cc-ed here) and offered to help keep the package maintained, this hiccup need not have happened. 

The three problems were:

1) stale URLs using http: not https:, of which some are dead (locally changed to https:, so reported as such):

Found the following (possibly) invalid URLs:
  URL: https://dusp.mit.edu/faculty/ezra-glenn
    From: DESCRIPTION
    Status: 404
    Message: Not Found
  URL: https://eglenn.scripts.mit.edu/citystate/
    From: DESCRIPTION
          man/acs-package.Rd
    Status: 403
    Message: Forbidden
  URL: https://factfinder2.census.gov
    From: man/read.acs.Rd
    Status: Error
    Message: libcurl error code 28:
      	Connection timed out after 60000 milliseconds
  URL: https://www.bls.gov/cpi/
    From: man/cpi.Rd
    Status: 403
    Message: Forbidden

2) multiple uses of class() == "string" - class() may return a vector of length > 1, so for some years it has been required that inherits() be used, to permit the test to succeed even when the required class is not first. This was discussed in 2019 in https://blog.r-project.org/2019/11/09/when-you-think-class.-think-again/index.html

3) The first lines of configure and cleanup were #! /bin/bash - see https://cran.r-project.org/doc/manuals/r-devel/R-ints.html#index-_005fR_005fCHECK_005fBASHISMS_005f for why this isn't robust (for example macOS doesn't use bash as its default shell, and maybe might not work correctly.

I would think that CRAN approached the maintainer multiple times over a period of many months to clear these inconsistencies. You assert elsewhere that if it worked before, you might expect it to continue to work. However, things like failing a class test because some upstream package has re-ordered the class vector have become more of a problem as the CRAN package count has grown, not necessarily for this package but in general, so that rules are tightened in the light of experience. 

I attach separately for the direct addressees a corrected version of the package as far as I can go, since for the failing URLs, it isn't very clear what to do.

I would suggest that you, Ari, are best placed to offer to take over the package, meaning that as soon as you get a fixed version of acs to CRAN, you can re-submit your valued choroplethr to CRAN and be a bit better future-proofed. Since you do use github, I'd suggest using an acs repo there and running CI both for acs and for choroplethr using the acs on github. That would give you advance notice of possible rule tightening in R-devel.

Hope this helps,

Roger

--
Roger Bivand
Emeritus Professor
Norwegian School of Economics
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway
Roger.Bivand at nhh.no

From Ach|m@Ze||e|@ @end|ng |rom u|bk@@c@@t  Thu Feb 13 21:02:47 2025
From: Ach|m@Ze||e|@ @end|ng |rom u|bk@@c@@t (Achim Zeileis)
Date: Thu, 13 Feb 2025 21:02:47 +0100 (CET)
Subject: [R] install.packages and package dependencies
In-Reply-To: <OSWP279MB0471513D25EBD4AB56607119EEFF2@OSWP279MB0471.NORP279.PROD.OUTLOOK.COM>
References: <OSWP279MB0471513D25EBD4AB56607119EEFF2@OSWP279MB0471.NORP279.PROD.OUTLOOK.COM>
Message-ID: <ffa4968b-f11b-da74-fc7c-e76957f34774@uibk.ac.at>

Roger,

just to you: Thanks for taking the time! I hope that Ari follows your 
recommendation, fingers crossed.

Best wishes,
Achim


On Thu, 13 Feb 2025, Roger Bivand via R-help wrote:

> Ari,
>
> There were multiple errors in the acs package. If CRAN states that the maintainer abandoned it, that is what happened. Had you reached out to Ezra Glenn (cc-ed here) and offered to help keep the package maintained, this hiccup need not have happened.
>
> The three problems were:
>
> 1) stale URLs using http: not https:, of which some are dead (locally changed to https:, so reported as such):
>
> Found the following (possibly) invalid URLs:
>  URL: https://dusp.mit.edu/faculty/ezra-glenn
>    From: DESCRIPTION
>    Status: 404
>    Message: Not Found
>  URL: https://eglenn.scripts.mit.edu/citystate/
>    From: DESCRIPTION
>          man/acs-package.Rd
>    Status: 403
>    Message: Forbidden
>  URL: https://factfinder2.census.gov
>    From: man/read.acs.Rd
>    Status: Error
>    Message: libcurl error code 28:
>      	Connection timed out after 60000 milliseconds
>  URL: https://www.bls.gov/cpi/
>    From: man/cpi.Rd
>    Status: 403
>    Message: Forbidden
>
> 2) multiple uses of class() == "string" - class() may return a vector of length > 1, so for some years it has been required that inherits() be used, to permit the test to succeed even when the required class is not first. This was discussed in 2019 in https://blog.r-project.org/2019/11/09/when-you-think-class.-think-again/index.html
>
> 3) The first lines of configure and cleanup were #! /bin/bash - see https://cran.r-project.org/doc/manuals/r-devel/R-ints.html#index-_005fR_005fCHECK_005fBASHISMS_005f for why this isn't robust (for example macOS doesn't use bash as its default shell, and maybe might not work correctly.
>
> I would think that CRAN approached the maintainer multiple times over a period of many months to clear these inconsistencies. You assert elsewhere that if it worked before, you might expect it to continue to work. However, things like failing a class test because some upstream package has re-ordered the class vector have become more of a problem as the CRAN package count has grown, not necessarily for this package but in general, so that rules are tightened in the light of experience.
>
> I attach separately for the direct addressees a corrected version of the package as far as I can go, since for the failing URLs, it isn't very clear what to do.
>
> I would suggest that you, Ari, are best placed to offer to take over the package, meaning that as soon as you get a fixed version of acs to CRAN, you can re-submit your valued choroplethr to CRAN and be a bit better future-proofed. Since you do use github, I'd suggest using an acs repo there and running CI both for acs and for choroplethr using the acs on github. That would give you advance notice of possible rule tightening in R-devel.
>
> Hope this helps,
>
> Roger
>
> --
> Roger Bivand
> Emeritus Professor
> Norwegian School of Economics
> Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway
> Roger.Bivand at nhh.no
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From Ach|m@Ze||e|@ @end|ng |rom u|bk@@c@@t  Thu Feb 13 21:29:58 2025
From: Ach|m@Ze||e|@ @end|ng |rom u|bk@@c@@t (Achim Zeileis)
Date: Thu, 13 Feb 2025 21:29:58 +0100 (CET)
Subject: [R] install.packages and package dependencies
In-Reply-To: <ffa4968b-f11b-da74-fc7c-e76957f34774@uibk.ac.at>
References: <OSWP279MB0471513D25EBD4AB56607119EEFF2@OSWP279MB0471.NORP279.PROD.OUTLOOK.COM>
 <ffa4968b-f11b-da74-fc7c-e76957f34774@uibk.ac.at>
Message-ID: <1787b28f-f3df-b875-89c5-0e544e47326c@uibk.ac.at>

Apparently not just to Roger...sorry for spamming the entire list!

In any case, I hope really do hope that this helps to resolve the issue.

Ari, let us know if we can help with anything else.

Best wishes,
Achim


On Thu, 13 Feb 2025, Achim Zeileis via R-help wrote:

> Roger,
>
> just to you: Thanks for taking the time! I hope that Ari follows your 
> recommendation, fingers crossed.
>
> Best wishes,
> Achim
>
>
> On Thu, 13 Feb 2025, Roger Bivand via R-help wrote:
>
>> Ari,
>> 
>> There were multiple errors in the acs package. If CRAN states that the 
>> maintainer abandoned it, that is what happened. Had you reached out to Ezra 
>> Glenn (cc-ed here) and offered to help keep the package maintained, this 
>> hiccup need not have happened.
>> 
>> The three problems were:
>> 
>> 1) stale URLs using http: not https:, of which some are dead (locally 
>> changed to https:, so reported as such):
>> 
>> Found the following (possibly) invalid URLs:
>>  URL: https://dusp.mit.edu/faculty/ezra-glenn
>>    From: DESCRIPTION
>>    Status: 404
>>    Message: Not Found
>>  URL: https://eglenn.scripts.mit.edu/citystate/
>>    From: DESCRIPTION
>>          man/acs-package.Rd
>>    Status: 403
>>    Message: Forbidden
>>  URL: https://factfinder2.census.gov
>>    From: man/read.acs.Rd
>>    Status: Error
>>    Message: libcurl error code 28:
>>      	Connection timed out after 60000 milliseconds
>>  URL: https://www.bls.gov/cpi/
>>    From: man/cpi.Rd
>>    Status: 403
>>    Message: Forbidden
>> 
>> 2) multiple uses of class() == "string" - class() may return a vector of 
>> length > 1, so for some years it has been required that inherits() be used, 
>> to permit the test to succeed even when the required class is not first. 
>> This was discussed in 2019 in 
>> https://blog.r-project.org/2019/11/09/when-you-think-class.-think-again/index.html
>> 
>> 3) The first lines of configure and cleanup were #! /bin/bash - see 
>> https://cran.r-project.org/doc/manuals/r-devel/R-ints.html#index-_005fR_005fCHECK_005fBASHISMS_005f 
>> for why this isn't robust (for example macOS doesn't use bash as its 
>> default shell, and maybe might not work correctly.
>> 
>> I would think that CRAN approached the maintainer multiple times over a 
>> period of many months to clear these inconsistencies. You assert elsewhere 
>> that if it worked before, you might expect it to continue to work. However, 
>> things like failing a class test because some upstream package has 
>> re-ordered the class vector have become more of a problem as the CRAN 
>> package count has grown, not necessarily for this package but in general, 
>> so that rules are tightened in the light of experience.
>> 
>> I attach separately for the direct addressees a corrected version of the 
>> package as far as I can go, since for the failing URLs, it isn't very clear 
>> what to do.
>> 
>> I would suggest that you, Ari, are best placed to offer to take over the 
>> package, meaning that as soon as you get a fixed version of acs to CRAN, 
>> you can re-submit your valued choroplethr to CRAN and be a bit better 
>> future-proofed. Since you do use github, I'd suggest using an acs repo 
>> there and running CI both for acs and for choroplethr using the acs on 
>> github. That would give you advance notice of possible rule tightening in 
>> R-devel.
>> 
>> Hope this helps,
>> 
>> Roger
>> 
>> --
>> Roger Bivand
>> Emeritus Professor
>> Norwegian School of Economics
>> Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway
>> Roger.Bivand at nhh.no
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> https://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>> 
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


