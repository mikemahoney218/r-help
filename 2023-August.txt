From p@u|bern@|07 @end|ng |rom gm@||@com  Tue Aug  1 15:57:49 2023
From: p@u|bern@|07 @end|ng |rom gm@||@com (Paul Bernal)
Date: Tue, 1 Aug 2023 08:57:49 -0500
Subject: [R] Plotting Fitted vs Observed Values in Logistic Regression Model
Message-ID: <CAMOcQfNC_0yD3hZejgtpMHqFT6GyfJXnhVcUgopiFPDZuPS+9g@mail.gmail.com>

Dear friends,

I hope  this email finds you all well. This is the dataset I am working
with:
dput(random_mod12_data2)
structure(list(Index = c(1L, 5L, 11L, 3L, 2L, 8L, 9L, 4L), x = c(5,
13, 25, 9, 7, 19, 21, 11), n = c(500, 500, 500, 500, 500, 500,
500, 500), r = c(100, 211, 391, 147, 122, 310, 343, 176), ratio = c(0.2,
0.422, 0.782, 0.294, 0.244, 0.62, 0.686, 0.352)), row.names = c(NA,
-8L), class = "data.frame")

A brief description of the dataset:
Index: is just a column that shows the ID of each observation (row)
x: is a column which gives information on the discount rate of the coupon
n: is the sample or number of observations
r: is the count of redeemed coupons
ratio: is just the ratio of redeemed coupons to n (total number of
observations)

#Fitting a logistic regression model to response variable y for problem 13.4
logistic_regmod2 <- glm(formula = ratio~x, family = binomial(logit), data =
random_mod12_data2)

I would like to plot the value of r (in the y-axis) vs x (the different
discount rates) and then superimpose the logistic regression fitted values
all in the same plot.

How could I accomplish this?

Any help and/or guidance will be greatly appreciated.

Kind regards,
Paul

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Tue Aug  1 16:06:57 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Tue, 1 Aug 2023 10:06:57 -0400
Subject: [R] 
 Plotting Fitted vs Observed Values in Logistic Regression Model
In-Reply-To: <CAMOcQfNC_0yD3hZejgtpMHqFT6GyfJXnhVcUgopiFPDZuPS+9g@mail.gmail.com>
References: <CAMOcQfNC_0yD3hZejgtpMHqFT6GyfJXnhVcUgopiFPDZuPS+9g@mail.gmail.com>
Message-ID: <da6e16e2-bb3d-10ff-6a72-c806bc0d0e65@gmail.com>

logistic_regmod2 <- glm(formula = ratio~x, family = binomial(logit), data =
random_mod12_data2, weights =n)

plot(ratio ~ x, data = random_mod12_data2)

pframe <- data.frame(x = sort(random_mod12_data2$x))
pframe$ratio <- predict(logistic_regmod2, newdata = pframe, type = 
"response")
with(pframe, lines(x, ratio))



On 2023-08-01 9:57 a.m., Paul Bernal wrote:
> Dear friends,
> 
> I hope  this email finds you all well. This is the dataset I am working
> with:
> dput(random_mod12_data2)
> structure(list(Index = c(1L, 5L, 11L, 3L, 2L, 8L, 9L, 4L), x = c(5,
> 13, 25, 9, 7, 19, 21, 11), n = c(500, 500, 500, 500, 500, 500,
> 500, 500), r = c(100, 211, 391, 147, 122, 310, 343, 176), ratio = c(0.2,
> 0.422, 0.782, 0.294, 0.244, 0.62, 0.686, 0.352)), row.names = c(NA,
> -8L), class = "data.frame")
> 
> A brief description of the dataset:
> Index: is just a column that shows the ID of each observation (row)
> x: is a column which gives information on the discount rate of the coupon
> n: is the sample or number of observations
> r: is the count of redeemed coupons
> ratio: is just the ratio of redeemed coupons to n (total number of
> observations)
> 
> #Fitting a logistic regression model to response variable y for problem 13.4
> logistic_regmod2 <- glm(formula = ratio~x, family = binomial(logit), data =
> random_mod12_data2)
> 
> I would like to plot the value of r (in the y-axis) vs x (the different
> discount rates) and then superimpose the logistic regression fitted values
> all in the same plot.
> 
> How could I accomplish this?
> 
> Any help and/or guidance will be greatly appreciated.
> 
> Kind regards,
> Paul
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Aug  2 15:50:17 2023
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 2 Aug 2023 14:50:17 +0100
Subject: [R] 
 Plotting Fitted vs Observed Values in Logistic Regression Model
In-Reply-To: <CAMOcQfNC_0yD3hZejgtpMHqFT6GyfJXnhVcUgopiFPDZuPS+9g@mail.gmail.com>
References: <CAMOcQfNC_0yD3hZejgtpMHqFT6GyfJXnhVcUgopiFPDZuPS+9g@mail.gmail.com>
Message-ID: <39b5dd66-5539-6af9-1a13-cfb6a88e32ab@sapo.pt>

?s 14:57 de 01/08/2023, Paul Bernal escreveu:
> Dear friends,
> 
> I hope  this email finds you all well. This is the dataset I am working
> with:
> dput(random_mod12_data2)
> structure(list(Index = c(1L, 5L, 11L, 3L, 2L, 8L, 9L, 4L), x = c(5,
> 13, 25, 9, 7, 19, 21, 11), n = c(500, 500, 500, 500, 500, 500,
> 500, 500), r = c(100, 211, 391, 147, 122, 310, 343, 176), ratio = c(0.2,
> 0.422, 0.782, 0.294, 0.244, 0.62, 0.686, 0.352)), row.names = c(NA,
> -8L), class = "data.frame")
> 
> A brief description of the dataset:
> Index: is just a column that shows the ID of each observation (row)
> x: is a column which gives information on the discount rate of the coupon
> n: is the sample or number of observations
> r: is the count of redeemed coupons
> ratio: is just the ratio of redeemed coupons to n (total number of
> observations)
> 
> #Fitting a logistic regression model to response variable y for problem 13.4
> logistic_regmod2 <- glm(formula = ratio~x, family = binomial(logit), data =
> random_mod12_data2)
> 
> I would like to plot the value of r (in the y-axis) vs x (the different
> discount rates) and then superimpose the logistic regression fitted values
> all in the same plot.
> 
> How could I accomplish this?
> 
> Any help and/or guidance will be greatly appreciated.
> 
> Kind regards,
> Paul
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Here is another way with ggplot2.
It doesn't give you the fitted values but it plots the fitted line.


library(ggplot2)

ggplot(random_mod12_data2, aes(x, ratio)) +
   geom_point() +
   stat_smooth(
     formula = y ~ x,
     method = glm,
     method.args = list(family = binomial),
     se = FALSE
   )


Hope this helps,

Rui Barradas


From n|ckmwr@y @end|ng |rom gm@||@com  Wed Aug  2 19:10:41 2023
From: n|ckmwr@y @end|ng |rom gm@||@com (Nick Wray)
Date: Wed, 2 Aug 2023 18:10:41 +0100
Subject: [R] Choosing colours for lines in ggplot2
Message-ID: <CABxY9BMwYCr09zfbzfeRMo8TPF6xLJwBRpv1LJ6JpJebHtcdkQ@mail.gmail.com>

Hello - I am trying to plot flows in a number of rivers within the same
plot, and need to colour the lines differently, using a colour-blind
palette.


Code beneath works but has colours assigned by the program I have made some
simple dummy data:
## code 1
cb8<- c("#000000", "#E69F00", "#56B4E9", "#009E73","#F0E442", "#0072B2",
"#D55E00", "#CC79A7")  ## this is the colour-blind palette
 set.seed(020823)
 df<-as.data.frame(cbind(rep(1980:1991,2),c(10*runif(12),10*runif(12)),c(rep(1,12),rep(2,12))))
 colnames(df)<-c("Year","Flow","Stat")
 df
 ggplot(df,aes(Year,Flow,group=Stat,colour=Stat))+
   coord_cartesian(ylim = c(0, 10)) +
   geom_line()+
   geom_point()
 ## this works

## BUT:
## code 2
col.2<-cb8[4:5]
 ggplot(df,aes(Year,Flow,group=Stat,colour=Stat))+
   coord_cartesian(ylim = c(0, 10)) +
   geom_line()+
   geom_point()+
 scale_color_manual(values =cb8[4:5])+
   theme_bw()
 ## this gives error message Error: Continuous value supplied to discrete
scale

## However this example using code from the net does work so I don't
understand why my ## second code doesn't work.
## code 3
 df.1 <- data.frame(store=c('A', 'A', 'A', 'B', 'B', 'B', 'C', 'C', 'C'),
                  week=c(1, 2, 3, 1, 2, 3, 1, 2, 3),
                  sales=c(9, 12, 15, 7, 9, 14, 10, 16, 19))
 ggplot(df.1, aes(x=week, y=sales, group=store, color=store)) +
   geom_line(size=2) +
   #scale_color_manual(values=c('orange', 'pink', 'red'))
   scale_color_manual(values=cb8[4:6])

Can anyone help? Thanks Nick Wray

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Aug  2 20:26:34 2023
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 2 Aug 2023 19:26:34 +0100
Subject: [R] Choosing colours for lines in ggplot2
In-Reply-To: <CABxY9BMwYCr09zfbzfeRMo8TPF6xLJwBRpv1LJ6JpJebHtcdkQ@mail.gmail.com>
References: <CABxY9BMwYCr09zfbzfeRMo8TPF6xLJwBRpv1LJ6JpJebHtcdkQ@mail.gmail.com>
Message-ID: <b536355c-961a-f43e-c0cc-7a4f887ca2b2@sapo.pt>

?s 18:10 de 02/08/2023, Nick Wray escreveu:
> Hello - I am trying to plot flows in a number of rivers within the same
> plot, and need to colour the lines differently, using a colour-blind
> palette.
> 
> 
> Code beneath works but has colours assigned by the program I have made some
> simple dummy data:
> ## code 1
> cb8<- c("#000000", "#E69F00", "#56B4E9", "#009E73","#F0E442", "#0072B2",
> "#D55E00", "#CC79A7")  ## this is the colour-blind palette
>   set.seed(020823)
>   df<-as.data.frame(cbind(rep(1980:1991,2),c(10*runif(12),10*runif(12)),c(rep(1,12),rep(2,12))))
>   colnames(df)<-c("Year","Flow","Stat")
>   df
>   ggplot(df,aes(Year,Flow,group=Stat,colour=Stat))+
>     coord_cartesian(ylim = c(0, 10)) +
>     geom_line()+
>     geom_point()
>   ## this works
> 
> ## BUT:
> ## code 2
> col.2<-cb8[4:5]
>   ggplot(df,aes(Year,Flow,group=Stat,colour=Stat))+
>     coord_cartesian(ylim = c(0, 10)) +
>     geom_line()+
>     geom_point()+
>   scale_color_manual(values =cb8[4:5])+
>     theme_bw()
>   ## this gives error message Error: Continuous value supplied to discrete
> scale
> 
> ## However this example using code from the net does work so I don't
> understand why my ## second code doesn't work.
> ## code 3
>   df.1 <- data.frame(store=c('A', 'A', 'A', 'B', 'B', 'B', 'C', 'C', 'C'),
>                    week=c(1, 2, 3, 1, 2, 3, 1, 2, 3),
>                    sales=c(9, 12, 15, 7, 9, 14, 10, 16, 19))
>   ggplot(df.1, aes(x=week, y=sales, group=store, color=store)) +
>     geom_line(size=2) +
>     #scale_color_manual(values=c('orange', 'pink', 'red'))
>     scale_color_manual(values=cb8[4:6])
> 
> Can anyone help? Thanks Nick Wray
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Your Stat column is numeric, therefore, ggplot sees it as continuous.
To make it work, coerce to factor. Here are two ways.


## 1st way, Stat coerce to factor in the ggplot code
## this means you will have to set the legend name
## manually in scale_color_manual
## code 2, now it works
col.2<-cb8[4:5]
ggplot(df, aes(Year,Flow, group = factor(Stat), colour = factor(Stat)))+
   coord_cartesian(ylim = c(0, 10)) +
   geom_line()+
   geom_point()+
   scale_color_manual(name = "Stat", values = cb8[4:5])+
   theme_bw()


## 2nd way, since you are using ggplot2, a tidyverse package,
## coerce to factor in a pipe before the ggplot call
## this is done with dplyr::mutate and R's native pipe operator
## (could also be magritttr's pipe)
## I have left name = "Stat" like above though it's no
## longer needed
df |>
   dplyr::mutate(Stat = factor(Stat)) |>
   ggplot(aes(Year, Flow, group = Stat, colour = Stat))+
   coord_cartesian(ylim = c(0, 10)) +
   geom_line()+
   geom_point()+
   scale_color_manual(name = "Stat", values = cb8[4:5])+
   theme_bw()



Hope this helps,

Rui Barradas


From k|mmo@e|o @end|ng |rom utu@||  Thu Aug  3 08:14:11 2023
From: k|mmo@e|o @end|ng |rom utu@|| (Kimmo Elo)
Date: Thu, 3 Aug 2023 06:14:11 +0000
Subject: [R] Choosing colours for lines in ggplot2
In-Reply-To: <CABxY9BMwYCr09zfbzfeRMo8TPF6xLJwBRpv1LJ6JpJebHtcdkQ@mail.gmail.com>
References: <CABxY9BMwYCr09zfbzfeRMo8TPF6xLJwBRpv1LJ6JpJebHtcdkQ@mail.gmail.com>
Message-ID: <0fd6bd6ad538431a5f58d0844aa9ebd46af33285.camel@utu.fi>

Hi,

when using 'scale_colours_manual' the colours must be defined as value-
color pairs (i.e. "A"="red", "B"="blue" an so on). If you read the
documentation it is recommended to use a named vector.

If I understood it correctly, in your code #2 R understood the variable
"Stat" as a number (i.e. continuous), whereas "store" (in code #3) is a
categorical variable. You cannot use scale_manual_* functions with
continuous variables.

This should work (please note than I use 'as_factor' from 'haven', this
is a more general function compared to 'as.factor'):

--- snip ---
library(tidyverse)
library(haven)
col.2<-cb8[4:5]
 ggplot(df,aes(Year,Flow,group=Stat,colour=as_factor(Stat)))+
   coord_cartesian(ylim = c(0, 10)) +
   geom_line()+
   geom_point()+
 scale_color_manual(values =cb8[4:5])+
   theme_bw()
--- snip ---

Is the result what you expected?

HTH,
Kimmo

ke, 2023-08-02 kello 18:10 +0100, Nick Wray kirjoitti:
> Hello - I am trying to plot flows in a number of rivers within the
> same
> plot, and need to colour the lines differently, using a colour-blind
> palette.
> 
> 
> Code beneath works but has colours assigned by the program I have
> made some
> simple dummy data:
> ## code 1
> cb8<- c("#000000", "#E69F00", "#56B4E9", "#009E73","#F0E442",
> "#0072B2",
> "#D55E00", "#CC79A7")? ## this is the colour-blind palette
> ?set.seed(020823)
> ?df<-
> as.data.frame(cbind(rep(1980:1991,2),c(10*runif(12),10*runif(12)),c(r
> ep(1,12),rep(2,12))))
> ?colnames(df)<-c("Year","Flow","Stat")
> ?df
> ?ggplot(df,aes(Year,Flow,group=Stat,colour=Stat))+
> ?? coord_cartesian(ylim = c(0, 10)) +
> ?? geom_line()+
> ?? geom_point()
> ?## this works
> 
> ## BUT:
> ## code 2
> col.2<-cb8[4:5]
> ?ggplot(df,aes(Year,Flow,group=Stat,colour=Stat))+
> ?? coord_cartesian(ylim = c(0, 10)) +
> ?? geom_line()+
> ?? geom_point()+
> ?scale_color_manual(values =cb8[4:5])+
> ?? theme_bw()
> ?## this gives error message Error: Continuous value supplied to
> discrete
> scale
> 
> ## However this example using code from the net does work so I don't
> understand why my ## second code doesn't work.
> ## code 3
> ?df.1 <- data.frame(store=c('A', 'A', 'A', 'B', 'B', 'B', 'C', 'C',
> 'C'),
> ????????????????? week=c(1, 2, 3, 1, 2, 3, 1, 2, 3),
> ????????????????? sales=c(9, 12, 15, 7, 9, 14, 10, 16, 19))
> ?ggplot(df.1, aes(x=week, y=sales, group=store, color=store)) +
> ?? geom_line(size=2) +
> ?? #scale_color_manual(values=c('orange', 'pink', 'red'))
> ?? scale_color_manual(values=cb8[4:6])
> 
> Can anyone help? Thanks Nick Wray
> 
> ????????[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org?mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bog@@o@chr|@to|er @end|ng |rom gm@||@com  Thu Aug  3 16:53:07 2023
From: bog@@o@chr|@to|er @end|ng |rom gm@||@com (Christofer Bogaso)
Date: Thu, 3 Aug 2023 20:23:07 +0530
Subject: [R] Could not read time series data using read.zoo()
Message-ID: <CA+dpOJnL4j-m=ExFvo0e76C6VvJAUEGCOAjiTdj5ha6Gqx60Lg@mail.gmail.com>

Hi,

I have a CSV which contains data like below (only first few rows),

Date Adj Close lret
02-01-1997 737.01
03-01-1997 748.03 1.48416235
06-01-1997 747.65 -0.050813009
07-01-1997 753.23 0.743567202
08-01-1997 748.41 -0.64196699
09-01-1997 754.85 0.856809786
10-01-1997 759.5 0.614126802

However when I try to read this data using below code I get error,

read.zoo("1.csv", sep = ',', format = '%d-%m-%Y')

Error reads as,

index has 4500 bad entries at data rows: 1 2 3 4 5 6 7 8 9.....

Could you please help to understand why I am getting this error?

> sessionInfo()

R version 4.2.2 (2022-10-31)

Platform: x86_64-apple-darwin17.0 (64-bit)

Running under: macOS Big Sur ... 10.16


Matrix products: default

BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib

LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib


locale:

[1] C/UTF-8/C/C/C/C


attached base packages:

[1] stats     graphics  grDevices utils     datasets  methods   base


other attached packages:

[1] zoo_1.8-12


loaded via a namespace (and not attached):

[1] compiler_4.2.2  tools_4.2.2     grid_4.2.2      lattice_0.20-45


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Aug  3 17:04:53 2023
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 03 Aug 2023 08:04:53 -0700
Subject: [R] Could not read time series data using read.zoo()
In-Reply-To: <CA+dpOJnL4j-m=ExFvo0e76C6VvJAUEGCOAjiTdj5ha6Gqx60Lg@mail.gmail.com>
References: <CA+dpOJnL4j-m=ExFvo0e76C6VvJAUEGCOAjiTdj5ha6Gqx60Lg@mail.gmail.com>
Message-ID: <14770ACD-E7C1-4F3E-8A56-E4A029F6E218@dcn.davis.ca.us>

no commas?

On August 3, 2023 7:53:07 AM PDT, Christofer Bogaso <bogaso.christofer at gmail.com> wrote:
>Hi,
>
>I have a CSV which contains data like below (only first few rows),
>
>Date Adj Close lret
>02-01-1997 737.01
>03-01-1997 748.03 1.48416235
>06-01-1997 747.65 -0.050813009
>07-01-1997 753.23 0.743567202
>08-01-1997 748.41 -0.64196699
>09-01-1997 754.85 0.856809786
>10-01-1997 759.5 0.614126802
>
>However when I try to read this data using below code I get error,
>
>read.zoo("1.csv", sep = ',', format = '%d-%m-%Y')
>
>Error reads as,
>
>index has 4500 bad entries at data rows: 1 2 3 4 5 6 7 8 9.....
>
>Could you please help to understand why I am getting this error?
>
>> sessionInfo()
>
>R version 4.2.2 (2022-10-31)
>
>Platform: x86_64-apple-darwin17.0 (64-bit)
>
>Running under: macOS Big Sur ... 10.16
>
>
>Matrix products: default
>
>BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
>
>LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
>
>
>locale:
>
>[1] C/UTF-8/C/C/C/C
>
>
>attached base packages:
>
>[1] stats     graphics  grDevices utils     datasets  methods   base
>
>
>other attached packages:
>
>[1] zoo_1.8-12
>
>
>loaded via a namespace (and not attached):
>
>[1] compiler_4.2.2  tools_4.2.2     grid_4.2.2      lattice_0.20-45
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From jrkr|de@u @end|ng |rom gm@||@com  Thu Aug  3 17:12:39 2023
From: jrkr|de@u @end|ng |rom gm@||@com (John Kane)
Date: Thu, 3 Aug 2023 11:12:39 -0400
Subject: [R] Could not read time series data using read.zoo()
In-Reply-To: <CA+dpOJnL4j-m=ExFvo0e76C6VvJAUEGCOAjiTdj5ha6Gqx60Lg@mail.gmail.com>
References: <CA+dpOJnL4j-m=ExFvo0e76C6VvJAUEGCOAjiTdj5ha6Gqx60Lg@mail.gmail.com>
Message-ID: <CAKZQJMDQhcQLqa_vbNfx2v-8MLLbCsJfifXwh7MaeDLiAbusqg@mail.gmail.com>

One reason seems to be you are saying sep = "," and there is no "," in the
file.
Also you only have 3 columns of data but 4 variable names.

On Thu, 3 Aug 2023 at 10:53, Christofer Bogaso <bogaso.christofer at gmail.com>
wrote:

> Hi,
>
> I have a CSV which contains data like below (only first few rows),
>
> Date Adj Close lret
> 02-01-1997 737.01
> 03-01-1997 748.03 1.48416235
> 06-01-1997 747.65 -0.050813009
> 07-01-1997 753.23 0.743567202
> 08-01-1997 748.41 -0.64196699
> 09-01-1997 754.85 0.856809786
> 10-01-1997 759.5 0.614126802
>
> However when I try to read this data using below code I get error,
>
> read.zoo("1.csv", sep = ',', format = '%d-%m-%Y')
>
> Error reads as,
>
> index has 4500 bad entries at data rows: 1 2 3 4 5 6 7 8 9.....
>
> Could you please help to understand why I am getting this error?
>
> > sessionInfo()
>
> R version 4.2.2 (2022-10-31)
>
> Platform: x86_64-apple-darwin17.0 (64-bit)
>
> Running under: macOS Big Sur ... 10.16
>
>
> Matrix products: default
>
> BLAS:
>  /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
>
> LAPACK:
> /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
>
>
> locale:
>
> [1] C/UTF-8/C/C/C/C
>
>
> attached base packages:
>
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
>
> other attached packages:
>
> [1] zoo_1.8-12
>
>
> loaded via a namespace (and not attached):
>
> [1] compiler_4.2.2  tools_4.2.2     grid_4.2.2      lattice_0.20-45
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


-- 
John Kane
Kingston ON Canada

	[[alternative HTML version deleted]]


From @erv|ce @end|ng |rom @hd@w@on@com  Thu Aug  3 17:09:27 2023
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Thu, 3 Aug 2023 11:09:27 -0400
Subject: [R] Could not read time series data using read.zoo()
In-Reply-To: <14770ACD-E7C1-4F3E-8A56-E4A029F6E218@dcn.davis.ca.us>
References: <CA+dpOJnL4j-m=ExFvo0e76C6VvJAUEGCOAjiTdj5ha6Gqx60Lg@mail.gmail.com>
 <14770ACD-E7C1-4F3E-8A56-E4A029F6E218@dcn.davis.ca.us>
Message-ID: <d1afe6e4-da01-2084-582a-5e0034b2f22f@shdawson.com>

Agreed. Tab character is not comma character.

*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com


On 8/3/23 11:04, Jeff Newmiller wrote:
> no commas?
>
> On August 3, 2023 7:53:07 AM PDT, Christofer Bogaso <bogaso.christofer at gmail.com> wrote:
>> Hi,
>>
>> I have a CSV which contains data like below (only first few rows),
>>
>> Date Adj Close lret
>> 02-01-1997 737.01
>> 03-01-1997 748.03 1.48416235
>> 06-01-1997 747.65 -0.050813009
>> 07-01-1997 753.23 0.743567202
>> 08-01-1997 748.41 -0.64196699
>> 09-01-1997 754.85 0.856809786
>> 10-01-1997 759.5 0.614126802
>>
>> However when I try to read this data using below code I get error,
>>
>> read.zoo("1.csv", sep = ',', format = '%d-%m-%Y')
>>
>> Error reads as,
>>
>> index has 4500 bad entries at data rows: 1 2 3 4 5 6 7 8 9.....
>>
>> Could you please help to understand why I am getting this error?
>>
>>> sessionInfo()
>> R version 4.2.2 (2022-10-31)
>>
>> Platform: x86_64-apple-darwin17.0 (64-bit)
>>
>> Running under: macOS Big Sur ... 10.16
>>
>>
>> Matrix products: default
>>
>> BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
>>
>> LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
>>
>>
>> locale:
>>
>> [1] C/UTF-8/C/C/C/C
>>
>>
>> attached base packages:
>>
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>>
>> other attached packages:
>>
>> [1] zoo_1.8-12
>>
>>
>> loaded via a namespace (and not attached):
>>
>> [1] compiler_4.2.2  tools_4.2.2     grid_4.2.2      lattice_0.20-45
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From ggrothend|eck @end|ng |rom gm@||@com  Thu Aug  3 20:46:21 2023
From: ggrothend|eck @end|ng |rom gm@||@com (Gabor Grothendieck)
Date: Thu, 3 Aug 2023 14:46:21 -0400
Subject: [R] Could not read time series data using read.zoo()
In-Reply-To: <CA+dpOJnL4j-m=ExFvo0e76C6VvJAUEGCOAjiTdj5ha6Gqx60Lg@mail.gmail.com>
References: <CA+dpOJnL4j-m=ExFvo0e76C6VvJAUEGCOAjiTdj5ha6Gqx60Lg@mail.gmail.com>
Message-ID: <CAP01uRnVFX7ydHMu4FnWuVY6RpQjb52OBX+nLid_WC+SOKeGjQ@mail.gmail.com>

The header has white space in it so skip over it, use header = FALSE
and specify the
column headers yourself.  Also use fill=TRUE since the first row does
not have 3 entries.

   # generate test file
  cat("Date Adj Close lret
  02-01-1997 737.01
  03-01-1997 748.03 1.48416235
  06-01-1997 747.65 -0.050813009
  07-01-1997 753.23 0.743567202
  08-01-1997 748.41 -0.64196699
  09-01-1997 754.85 0.856809786
  10-01-1997 759.5 0.614126802", file = "1.csv")

  # test
  library(zoo)
  read.zoo("1.csv", skip = 1, header = FALSE, format = "%m-%d-%Y", fill = TRUE,
     col.names = c(NA, "Adj_Close", "Close"))

On Thu, Aug 3, 2023 at 10:53?AM Christofer Bogaso
<bogaso.christofer at gmail.com> wrote:
>
> Hi,
>
> I have a CSV which contains data like below (only first few rows),
>
> Date Adj Close lret
> 02-01-1997 737.01
> 03-01-1997 748.03 1.48416235
> 06-01-1997 747.65 -0.050813009
> 07-01-1997 753.23 0.743567202
> 08-01-1997 748.41 -0.64196699
> 09-01-1997 754.85 0.856809786
> 10-01-1997 759.5 0.614126802
>
> However when I try to read this data using below code I get error,
>
> read.zoo("1.csv", sep = ',', format = '%d-%m-%Y')
>
> Error reads as,
>
> index has 4500 bad entries at data rows: 1 2 3 4 5 6 7 8 9.....
>
> Could you please help to understand why I am getting this error?
>
> > sessionInfo()
>
> R version 4.2.2 (2022-10-31)
>
> Platform: x86_64-apple-darwin17.0 (64-bit)
>
> Running under: macOS Big Sur ... 10.16
>
>
> Matrix products: default
>
> BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
>
> LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
>
>
> locale:
>
> [1] C/UTF-8/C/C/C/C
>
>
> attached base packages:
>
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
>
> other attached packages:
>
> [1] zoo_1.8-12
>
>
> loaded via a namespace (and not attached):
>
> [1] compiler_4.2.2  tools_4.2.2     grid_4.2.2      lattice_0.20-45
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From bog@@o@chr|@to|er @end|ng |rom gm@||@com  Thu Aug  3 17:08:58 2023
From: bog@@o@chr|@to|er @end|ng |rom gm@||@com (Christofer Bogaso)
Date: Thu, 3 Aug 2023 20:38:58 +0530
Subject: [R] Could not read time series data using read.zoo()
In-Reply-To: <14770ACD-E7C1-4F3E-8A56-E4A029F6E218@dcn.davis.ca.us>
References: <CA+dpOJnL4j-m=ExFvo0e76C6VvJAUEGCOAjiTdj5ha6Gqx60Lg@mail.gmail.com>
 <14770ACD-E7C1-4F3E-8A56-E4A029F6E218@dcn.davis.ca.us>
Message-ID: <CA+dpOJ=mJ+pO1wpJ-Z+4A4iKsfTCO8QhaS28R=KxXR_OUWX-PA@mail.gmail.com>

Hi,

I just provided a snapshot of my CSV file. Attaching the full file
here (not sure if R-help would accept the attachment).

Thanks and regards,

On Thu, Aug 3, 2023 at 8:35?PM Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
>
> no commas?
>
> On August 3, 2023 7:53:07 AM PDT, Christofer Bogaso <bogaso.christofer at gmail.com> wrote:
> >Hi,
> >
> >I have a CSV which contains data like below (only first few rows),
> >
> >Date Adj Close lret
> >02-01-1997 737.01
> >03-01-1997 748.03 1.48416235
> >06-01-1997 747.65 -0.050813009
> >07-01-1997 753.23 0.743567202
> >08-01-1997 748.41 -0.64196699
> >09-01-1997 754.85 0.856809786
> >10-01-1997 759.5 0.614126802
> >
> >However when I try to read this data using below code I get error,
> >
> >read.zoo("1.csv", sep = ',', format = '%d-%m-%Y')
> >
> >Error reads as,
> >
> >index has 4500 bad entries at data rows: 1 2 3 4 5 6 7 8 9.....
> >
> >Could you please help to understand why I am getting this error?
> >
> >> sessionInfo()
> >
> >R version 4.2.2 (2022-10-31)
> >
> >Platform: x86_64-apple-darwin17.0 (64-bit)
> >
> >Running under: macOS Big Sur ... 10.16
> >
> >
> >Matrix products: default
> >
> >BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
> >
> >LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
> >
> >
> >locale:
> >
> >[1] C/UTF-8/C/C/C/C
> >
> >
> >attached base packages:
> >
> >[1] stats     graphics  grDevices utils     datasets  methods   base
> >
> >
> >other attached packages:
> >
> >[1] zoo_1.8-12
> >
> >
> >loaded via a namespace (and not attached):
> >
> >[1] compiler_4.2.2  tools_4.2.2     grid_4.2.2      lattice_0.20-45
> >
> >______________________________________________
> >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >https://stat.ethz.ch/mailman/listinfo/r-help
> >PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >and provide commented, minimal, self-contained, reproducible code.
>
> --
> Sent from my phone. Please excuse my brevity.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

From n|ckmwr@y @end|ng |rom gm@||@com  Fri Aug  4 12:08:10 2023
From: n|ckmwr@y @end|ng |rom gm@||@com (Nick Wray)
Date: Fri, 4 Aug 2023 11:08:10 +0100
Subject: [R] Problems with facets in ggplot2
Message-ID: <CABxY9BPZ6U5yj91FtPg2ejtX=YA93iCdmd6dX=oKYDg16cCRqw@mail.gmail.com>

Hello  I am wrestling with ggplot ? I have produced a facetted plot of
flows under various metrics but I can?t find info on the net which tells me
how to do three things


I have created some simplified mock data to illustrate (and using a
colour-blind palette):


library(ggplot2)

library(forcats)

cb8<- c("#000000", "#E69F00", "#56B4E9", "#009E73","#F0E442", "#0072B2",
"#D55E00", "#CC79A7")

set.seed<-(040823)

  mock<- set.seed<-(040823)


mock<-as.data.frame(cbind(rep((1990:1995),8),round(rnorm(48,50,10),3),rep(c(rep("Tweed",6),rep("Tay",6)),4),rep(c("AMAX","Mean","AMIN","Median"),each=12)))

  colnames(mock)<-c("Year","Flow","Stat","Metric")

  mock



  ggplot(mock, aes(Year,Flow, group = factor(Stat), colour = factor(Stat)))+

    coord_cartesian(ylim = c(0, 100)) +

    geom_line(size=1)+

    scale_color_manual(name = "Stat", values = cb8[4:7])+

    scale_y_discrete(breaks=c(0,25,50,75,100),labels=c(0,25,50,75,100))+

    facet_wrap(vars(Metric),nrow=2,ncol=2)+

    ylab("Flow")



1)This gives me a facetted plot but I can?t work out why I?m not getting a
labelled y scale



2)Why are plots down at the bottom of the facets rather than in the middle?



3)And also I?d like the plots to be in the order (top left to bottom right)
of

AMAX MEAN AMIN MEDIAN

but if I add in the line
facet_grid(~fct_relevel(Metric,"AMAX","Mean","AMIN","Median")) before the
line ylab it disrupts the 2x2 layout



Can anyone tell me how to resolve these problems?  Thanks Nick Wray

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Fri Aug  4 12:26:02 2023
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Fri, 4 Aug 2023 11:26:02 +0100
Subject: [R] Problems with facets in ggplot2
In-Reply-To: <CABxY9BPZ6U5yj91FtPg2ejtX=YA93iCdmd6dX=oKYDg16cCRqw@mail.gmail.com>
References: <CABxY9BPZ6U5yj91FtPg2ejtX=YA93iCdmd6dX=oKYDg16cCRqw@mail.gmail.com>
Message-ID: <0fa2c9bc-6b82-2cb5-e6e7-d23bceb66759@sapo.pt>

?s 11:08 de 04/08/2023, Nick Wray escreveu:
> Hello  I am wrestling with ggplot ? I have produced a facetted plot of
> flows under various metrics but I can?t find info on the net which tells me
> how to do three things
> 
> 
> I have created some simplified mock data to illustrate (and using a
> colour-blind palette):
> 
> 
> library(ggplot2)
> 
> library(forcats)
> 
> cb8<- c("#000000", "#E69F00", "#56B4E9", "#009E73","#F0E442", "#0072B2",
> "#D55E00", "#CC79A7")
> 
> set.seed<-(040823)
> 
>    mock<- set.seed<-(040823)
> 
> 
> mock<-as.data.frame(cbind(rep((1990:1995),8),round(rnorm(48,50,10),3),rep(c(rep("Tweed",6),rep("Tay",6)),4),rep(c("AMAX","Mean","AMIN","Median"),each=12)))
> 
>    colnames(mock)<-c("Year","Flow","Stat","Metric")
> 
>    mock
> 
> 
> 
>    ggplot(mock, aes(Year,Flow, group = factor(Stat), colour = factor(Stat)))+
> 
>      coord_cartesian(ylim = c(0, 100)) +
> 
>      geom_line(size=1)+
> 
>      scale_color_manual(name = "Stat", values = cb8[4:7])+
> 
>      scale_y_discrete(breaks=c(0,25,50,75,100),labels=c(0,25,50,75,100))+
> 
>      facet_wrap(vars(Metric),nrow=2,ncol=2)+
> 
>      ylab("Flow")
> 
> 
> 
> 1)This gives me a facetted plot but I can?t work out why I?m not getting a
> labelled y scale
> 
> 
> 
> 2)Why are plots down at the bottom of the facets rather than in the middle?
> 
> 
> 
> 3)And also I?d like the plots to be in the order (top left to bottom right)
> of
> 
> AMAX MEAN AMIN MEDIAN
> 
> but if I add in the line
> facet_grid(~fct_relevel(Metric,"AMAX","Mean","AMIN","Median")) before the
> line ylab it disrupts the 2x2 layout
> 
> 
> 
> Can anyone tell me how to resolve these problems?  Thanks Nick Wray
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

The main problem is the way ou create the data set. cbind defaults to 
creating a matrix and since some of the vectors are of class "character" 
all others will be coerced to character too. And Year and Flow will no 
longer be numeric.

You can coerce those two columns to numeric manually or you can use 
data.frame(), not as.data.frame(), to create the data set.
And you were, therefore, using scale_y_discrete when it should be 
scale_y_continuous. Corrected below.

As for the relevel, I'm not getting any errors.



library(ggplot2)
library(forcats)

cb8<- c("#000000", "#E69F00", "#56B4E9", "#009E73",
         "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

set.seed(040823)

# the right way of creating the data set
mock <- data.frame(
   Year = rep((1990:1995),8),
   Flow = round(rnorm(48,50,10),3),
   Stat = rep(c(rep("Tweed",6), rep("Tay",6)),4),
   Metric = rep(c("AMAX","Mean","AMIN","Median"),each=12)
)

ggplot(mock, aes(Year,Flow, group = factor(Stat), colour = factor(Stat))) +
   coord_cartesian(ylim = c(0, 100)) +
   geom_line(size=1) +
   scale_color_manual(name = "Stat", values = cb8[4:5]) +
   scale_y_continuous(breaks=c(0, 25, 50, 75, 100), labels=c(0, 25, 50, 
75, 100)) +
   facet_wrap(~ fct_relevel(Metric,"AMAX","Mean","AMIN","Median"), nrow 
= 2, ncol = 2) +
   ylab("Flow")


Hope this helps,

Rui Barradas


From mur@t@de|m@n @end|ng |rom gm@||@com  Fri Aug  4 09:13:55 2023
From: mur@t@de|m@n @end|ng |rom gm@||@com (Murat DELMAN)
Date: Fri, 4 Aug 2023 10:13:55 +0300
Subject: [R] Technical Help Request for "Version Differences" (i.e.,
 CYTOFKIT package)
Message-ID: <CAHZ-BgrATMoVki+KEm6TaLtnsig-zWP4_N7BCK+=Fyt+Lf4ayw@mail.gmail.com>

Dear Ms./Mr.,


I sent an email to this email address from my institutional address
muratdelman at iyte.edu.tr, but could not make sure if my email reached you
because sometimes emails are not delivered to the target due to
server issues and country-related limitations. I wanted to send you the
same email via my Gmail account.




If the email text and codes below are not properly displayed, you can
download the attached Word file, which has exactly the same content.



I am a cytometrist and microscopist at Izmir Institute of Technology,
Integrated Research Center. I operate a cytometer and fluorescence
microscope to acquire data from our researchers? samples and then give them
analyzed data. I need to dive into bulk data to present all of the
information in the sample. To do this, I have recently been trying to
develop my skills in R, RStudio, and Cytofkit package for cytometry (flow,
spectral, mass, imaging mass cytometry) data analysis. I am new in this
area and must learn R for data analysis.





May I request help from you or one of your assistants who is competent in
R, RStudio, and R packages with the installation issues caused by ?*version
differences*? between R itself, R packages, and their dependencies? I
really had to send this email to you anymore, because I could not run the
package ?Cytofkit? and find a solution on the internet.


It has been nearly 2 weeks since I have been trying to solve the errors and
warnings. I am in a vicious circle and cannot move forward anymore. This is
why I needed help from an expert competent in R programming.



I tried to use the renv package, but I could not move forward because I am
not competent in R.


I explained the errors that I faced during the installation below.



I have two computers, both operating Windows 10, 64-bit.



I installed R 3.5.*2* on the desktop (Windows in English) and R 3.5.*0* on
the laptop (Windows in Turkish).



I know that you are very busy with your work, but may you (or your
assistant) help me by informing me *how to install consistent versions of
R, RStudio, and packages/dependencies* (for example, Cytofkit, ggplot2,
Rtools, devtools, plyr, shiny, GUI)?



I guess I will need exact web page links "*in* *an orderly manner" to
download* the correct versions of everything.



I would appreciate it if you could advise me or forward this email to one
of your assistants or experts.




I really appreciate any help you can provide.




Kind Regards




*Please find the technical details below;*





I used the installation order listed below;



I downloaded R 3.5.0 and R 3.5.2 using the link and directory below.



Link: https://www.freestatistics.org/cran/



Directory: Download R for Windows > install R for the first time > Previous
releases > R 3.5.2 (December, 2018) or R 3.5.0



I downloaded RStudio from the link below;



https://posit.co/download/rstudio-desktop/




I downloaded packages via either
https://cran.rstudio.com/bin/windows/contrib/r-devel/ or the ?install
function? tab in RStudio.



Rtools : https://cran.r-project.org/bin/windows/Rtools/



Devtools : https://cran.r-project.org/web/packages/devtools/index.html



ggplot2 : https://cran.r-project.org/web/packages/ggplot2/index.html



                 https://ggplot2.tidyverse.org/



                 https://cran.r-project.org/web/packages/ggplot2/ggplot2.pdf





plyr : https://cran.r-project.org/web/packages/plyr/index.html



shiny : https://cran.r-project.org/web/packages/shiny/index.html




https://shiny.posit.co/r/getstarted/shiny-basics/lesson1/index.html



            https://github.com/rstudio/shiny



cytofkit : https://github.com/JinmiaoChenLab/cytofkit




https://bioconductor.riken.jp/packages/3.3/bioc/html/cytofkit.html



https://journals.plos.org/ploscompbiol/article/file?id=10.1371/journal.pcbi.1005112&type=printable




Below, I provide the errors and warnings that I faced for 2 weeks for both
R versions;





*Please find the errors and warnings below;*




*CYTOFKIT FOR R VERSION 3.5.**2*





> library(cytofkit)

Loading required package: ggplot2

Loading required package: plyr

Error: package or namespace load failed for ?cytofkit?:

package ?cytofkit? was installed by an R version with different internals;
it needs to be reinstalled for use with this R version

ERROR: this R is version 3.5.2, package 'cytofkit2' requires R >= 4.0.0

In R CMD INSTALL

Installation paths not writeable, unable to update packages

  path: C:/Program Files/R/R-3.5.2/library

  packages:

    boot, class, cluster, codetools, KernSmooth, Matrix, nlme, nnet, rpart,
spatial, survival

There were 23 warnings (use warnings() to see them)



> warnings()

Warning messages:

1: packages ?caTools?, ?umap? are not available (for R version 3.5.2)

2: In i.p(...) : installation of package ?DEoptimR? had non-zero exit status

3: In i.p(...) : installation of package ?mvtnorm? had non-zero exit status

4: In i.p(...) : installation of package ?XML? had non-zero exit status

5: In i.p(...) : installation of package ?fastmap? had non-zero exit status

6: In i.p(...) : installation of package ?sass? had non-zero exit status

7: In i.p(...) : installation of package ?jquerylib? had non-zero exit
status

8: In i.p(...) : installation of package ?later? had non-zero exit status

9: In i.p(...) : installation of package ?fontawesome? had non-zero exit
status

10: In i.p(...) : installation of package ?miniUI? had non-zero exit status

11: In i.p(...) : installation of package ?RcppTOML? had non-zero exit
status

12: In i.p(...) : installation of package ?pcaPP? had non-zero exit status

13: In i.p(...) : installation of package ?robustbase? had non-zero exit
status

14: In i.p(...) : installation of package ?cachem? had non-zero exit status

15: In i.p(...) : installation of package ?promises? had non-zero exit
status

16: In i.p(...) : installation of package ?reticulate? had non-zero exit
status

17: In i.p(...) : installation of package ?rrcov? had non-zero exit status

18: In i.p(...) : installation of package ?memoise? had non-zero exit status

19: In i.p(...) : installation of package ?httpuv? had non-zero exit status

20: In i.p(...) : installation of package ?bslib? had non-zero exit status

21: In i.p(...) : installation of package ?rmarkdown? had non-zero exit
status

22: In i.p(...) : installation of package ?htmlwidgets? had non-zero exit
status

23: In i.p(...) :

  installation of package
?C:/Users/murat-delman/AppData/Local/Temp/Rtmp8GGq71/file4d0c54c135b4/cytofkit2_0.99.80.tar.gz?
had non-zero exit status

> devtools::install_github("JinmiaoChenLab/cytofkit")

Error in rbind(info, getNamespaceInfo(env, "S3methods")) :

  number of columns of matrices must match (see arg 2)



>





*INSTALLING GGPLOT2 FOR R VERSION 3.5.**0*



> library(cytofkit)

Loading required package: ggplot2

Warning: namespace ?cli? is not available and has been replaced

by .GlobalEnv when processing object ?.Random.seed?

Error: package or namespace load failed for ?ggplot2? in rbind(info,
getNamespaceInfo(env, "S3methods")):

 number of columns of matrices must match (see arg 2)

Error: package ?ggplot2? could not be loaded

In addition: Warning message:

package ?ggplot2? was built under R version 4.2.3



> library(cytofkit)

Error: package ?ggplot2? required by ?cytofkit? could not be found



> install.packages("D:/Programlar/ggplotgui_1.0.0.zip", repos = NULL, type
= "win.binary")

Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?

(as ?lib? is unspecified)

package ?ggplotgui? successfully unpacked and MD5 sums checked



> install.packages("D:/Programlar/ggplot2/ggplot2_3.0.0.tar.gz", repos =
NULL, type = "source")

Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?

(as ?lib? is unspecified)

* installing *source* package 'ggplot2' ...

** package 'ggplot2' successfully unpacked and MD5 sums checked

** R

** data

*** moving datasets to lazyload DB

** inst

** byte-compile and prepare package for lazy loading

Warning: namespace 'cli' is not available and has been replaced

by .GlobalEnv when processing object 'txhousing'

Error in rbind(info, getNamespaceInfo(env, "S3methods")) :

  number of columns of matrices must match (see arg 2)

ERROR: lazy loading failed for package 'ggplot2'

* removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2'

In R CMD INSTALL

Warning in install.packages :

  installation of package ?D:/Programlar/ggplot2/ggplot2_3.0.0.tar.gz? had
non-zero exit status



> packageurl <- "
https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz"

> install.packages(packageurl, repos=NULL, type="source")

Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?

(as ?lib? is unspecified)

trying URL '
https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz'

Content type 'application/x-gzip' length 3031461 bytes (2.9 MB)

downloaded 2.9 MB



* installing *source* package 'ggplot2' ...

** package 'ggplot2' successfully unpacked and MD5 sums checked

** R

** data

*** moving datasets to lazyload DB

** inst

** byte-compile and prepare package for lazy loading

Warning: namespace 'cli' is not available and has been replaced

by .GlobalEnv when processing object 'txhousing'

Error in rbind(info, getNamespaceInfo(env, "S3methods")) :

  number of columns of matrices must match (see arg 2)

ERROR: lazy loading failed for package 'ggplot2'

* removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2'

In R CMD INSTALL

Warning in install.packages :

  installation of package
?C:/Users/murat/AppData/Local/Temp/RtmpI776iL/downloaded_packages/ggplot2_3.3.0.tar.gz?
had non-zero exit status



> install.packages("ggplot2")

Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?

(as ?lib? is unspecified)

Warning in install.packages :

  unable to access index for repository
https://cran.rstudio.com/bin/windows/contrib/3.5:

  cannot open URL 'https://cran.rstudio.com/bin/windows/contrib/3.5/PACKAGES
'

installing the source package ?ggplot2?



trying URL 'https://cran.rstudio.com/src/contrib/ggplot2_3.4.2.tar.gz'

Content type 'application/x-gzip' length 3153811 bytes (3.0 MB)

downloaded 3.0 MB



* installing *source* package 'ggplot2' ...

** package 'ggplot2' successfully unpacked and MD5 sums checked

** R

** data

*** moving datasets to lazyload DB

** inst

** byte-compile and prepare package for lazy loading

Warning: namespace 'cli' is not available and has been replaced

by .GlobalEnv when processing object 'txhousing'

Error in rbind(info, getNamespaceInfo(env, "S3methods")) :

  number of columns of matrices must match (see arg 2)

ERROR: lazy loading failed for package 'ggplot2'

* removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2'

In R CMD INSTALL

Warning in install.packages :

  installation of package ?ggplot2? had non-zero exit status



The downloaded source packages are in

?C:\Users\murat\AppData\Local\Temp\RtmpI776iL\downloaded_packages?



> packageurl <- "https://cran.r-project.org/web/packages/ggplot2/index.html"

> install.packages(packageurl, repos=NULL, type="source")

Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?

(as ?lib? is unspecified)

trying URL 'https://cran.r-project.org/web/packages/ggplot2/index.html'

Content type 'text/html' length 468435 bytes (457 KB)

downloaded 457 KB



Error in getOctD(x, offset, len) : invalid octal digit

In R CMD INSTALL

Warning in install.packages :

  installation of package
?C:/Users/murat/AppData/Local/Temp/RtmpI776iL/downloaded_packages/index.html?
had non-zero exit status



> packageurl <- "
https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz"

> install.packages(packageurl, repos=NULL, type="source")

Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?

(as ?lib? is unspecified)

trying URL '
https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz'

Content type 'application/x-gzip' length 3031461 bytes (2.9 MB)

downloaded 2.9 MB



* installing *source* package 'ggplot2' ...

** package 'ggplot2' successfully unpacked and MD5 sums checked

** R

** data

*** moving datasets to lazyload DB

** inst

** byte-compile and prepare package for lazy loading

Warning: namespace 'cli' is not available and has been replaced

by .GlobalEnv when processing object 'txhousing'

Error in rbind(info, getNamespaceInfo(env, "S3methods")) :

  number of columns of matrices must match (see arg 2)

ERROR: lazy loading failed for package 'ggplot2'

* removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2'

In R CMD INSTALL

Warning in install.packages :

  installation of package
?C:/Users/murat/AppData/Local/Temp/Rtmp8sLmoj/downloaded_packages/ggplot2_3.3.0.tar.gz?
had non-zero exit status



> pak::pkg_install("tibble")

Error in load_private_package("cli") :

  Cannot load cli from the private library



> pak::pkg_install("tidyverse/tibble")

Error in load_private_package("cli") :

  Cannot load cli from the private library



> pkg_install("tibble")

Error in pkg_install("tibble") : could not find function "pkg_install"



> install.packages("D:/Programlar/ggplot2/ggplot2_3.4.2.zip", repos = NULL,
type = "win.binary")

Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?

(as ?lib? is unspecified)

package ?ggplot2? successfully unpacked and MD5 sums checked



Kind Regards


Murat Delman, Ph.D.
Izmir Institute of Technology
Integrated Research Centers

[image: Mailtrack]
<https://mailtrack.io?utm_source=gmail&utm_medium=signature&utm_campaign=signaturevirality11&>
Sender
notified by
Mailtrack
<https://mailtrack.io?utm_source=gmail&utm_medium=signature&utm_campaign=signaturevirality11&>
08/04/23,
10:12:50 AM

From v@|kremk @end|ng |rom gm@||@com  Fri Aug  4 16:54:07 2023
From: v@|kremk @end|ng |rom gm@||@com (Val)
Date: Fri, 4 Aug 2023 09:54:07 -0500
Subject: [R] Multiply
Message-ID: <CAJOiR6Y-qZL=N8Cb_VZwsRdxzDhkUG8+uhJOvvZB=3YC4TA1VA@mail.gmail.com>

Hi all,

I want to multiply two  data frames as shown below,

dat1 <-read.table(text="ID, x, y, z
 A, 10,  34, 12
 B, 25,  42, 18
 C, 14,  20,  8 ",sep=",",header=TRUE,stringsAsFactors=F)

dat2 <-read.table(text="ID, weight, weiht2
 A,  0.25, 0.35
 B,  0.42, 0.52
 C,  0.65, 0.75",sep=",",header=TRUE,stringsAsFactors=F)

Desired result

ID  Index1 Index2
1  A 24.58 30.18
2  B 35.59 44.09
3  C 17.10 21.30

Here is my attempt,  but did not work

dat3 <- data.frame(ID = dat1[,1], Index = apply(dat1[,-1], 1, FUN=
function(x) {sum(x*dat2[,2:ncol(dat2)])} ), stringsAsFactors=F)


Any help?

Thank you,


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Aug  4 17:05:33 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 4 Aug 2023 18:05:33 +0300
Subject: [R] Multiply
In-Reply-To: <CAJOiR6Y-qZL=N8Cb_VZwsRdxzDhkUG8+uhJOvvZB=3YC4TA1VA@mail.gmail.com>
References: <CAJOiR6Y-qZL=N8Cb_VZwsRdxzDhkUG8+uhJOvvZB=3YC4TA1VA@mail.gmail.com>
Message-ID: <20230804180533.225f504b@parabola>

? Fri, 4 Aug 2023 09:54:07 -0500
Val <valkremk at gmail.com> ?????:

> I want to multiply two  data frames as shown below,
> 
> dat1 <-read.table(text="ID, x, y, z
>  A, 10,  34, 12
>  B, 25,  42, 18
>  C, 14,  20,  8 ",sep=",",header=TRUE,stringsAsFactors=F)
> 
> dat2 <-read.table(text="ID, weight, weiht2
>  A,  0.25, 0.35
>  B,  0.42, 0.52
>  C,  0.65, 0.75",sep=",",header=TRUE,stringsAsFactors=F)
> 
> Desired result
> 
> ID  Index1 Index2
> 1  A 24.58 30.18
> 2  B 35.59 44.09
> 3  C 17.10 21.30

You mean as in matrix multiplication? Nice of you to show the desired
result, otherwise I wouldn't be sure what you meant. You can employ the
matrix multiplication operator %*% if you use as.matrix and omit the
non-numeric parts:

as.matrix(dat1[,-1]) %*% as.matrix(dat2[match(dat1[,1], dat2[,1]),-1])
#      weight weiht2
# [1,]  24.58  30.18
# [2,]  35.59  44.09
# [3,]  17.10  21.30

The [,-1] part drops the 'ID' column and the match() on the first
columns of both data frames ensures the correct row order. Omit the
match(...) if you have a guarantee that the samples appear in the same
order (A, B, C) in both dat1 and dat2.

Once the calculation is done, you can construct a data frame again
using something like data.frame(ID = dat1[,1], Index = multiplication).

-- 
Best regards,
Ivan


From mur@tde|m@n @end|ng |rom |yte@edu@tr  Fri Aug  4 09:10:58 2023
From: mur@tde|m@n @end|ng |rom |yte@edu@tr (MURAT DELMAN)
Date: Fri, 4 Aug 2023 10:10:58 +0300 (TRT)
Subject: [R] Technical Help Request for "Version Differences" (i.e.,
 CYTOFKIT package)
Message-ID: <146822026.2931556.1691133058051.JavaMail.zimbra@iyte.edu.tr>




Dear Ms./Mr., 







If the email text and codes below are not properly displayed, you can download the attached Word file, which has exactly the same content. 



I am a cytometrist and microscopist at Izmir Institute of Technology, Integrated Research Center. I operate a cytometer and fluorescence microscope to acquire data from our researchers? samples and then give them analyzed data. I need to dive into bulk data to present all of the information in the sample. To do this, I have recently been trying to develop my skills in R, RStudio, and Cytofkit package for cytometry (flow, spectral, mass, imaging mass cytometry) data analysis. I am new in this area and must learn R for data analysis. 





May I request help from you or one of your assistants who is competent in R, RStudio, and R packages with the installation issues caused by ? version differences ? between R itself, R packages, and their dependencies? I really had to send this email to you anymore, because I could not run the package ?Cytofkit? and find a solution on the internet. 


It has been nearly 2 weeks since I have been trying to solve the errors and warnings. I am in a vicious circle and cannot move forward anymore. This is why I needed help from an expert competent in R programming. 



I tried to use the renv package, but I could not move forward because I am not competent in R. 




I explained the errors that I faced during the installation below. 



I have two computers, both operating Windows 10, 64-bit. 



I installed R 3.5. 2 on the desktop (Windows in English) and R 3.5. 0 on the laptop (Windows in Turkish). 



I know that you are very busy with your work, but may you (or your assistant) help me by informing me how to install consistent versions of R, RStudio, and packages/dependencies (for example, Cytofkit, ggplot2, Rtools, devtools, plyr, shiny, GUI)? 





I guess I will need exact web page links " in an orderly manner" to download the correct versions of everything. 



I would appreciate it if you could advise me or forward this email to one of your assistants or experts. 






I really appreciate any help you can provide. 






Kind Regards 






Please find the technical details below; 





I used the installation order listed below; 



I downloaded R 3.5.0 and R 3.5.2 using the link and directory below. 



Link: [ https://www.freestatistics.org/cran/ | https://www.freestatistics.org/cran/ ] 



Directory: Download R for Windows > install R for the first time > Previous releases > R 3.5.2 (December, 2018) or R 3.5.0 





I downloaded RStudio from the link below; 



[ https://posit.co/download/rstudio-desktop/ | https://posit.co/download/rstudio-desktop/ ] 






I downloaded packages via either [ https://cran.rstudio.com/bin/windows/contrib/r-devel/ | https://cran.rstudio.com/bin/windows/contrib/r-devel/ ] or the ?install function? tab in RStudio. 



Rtools : [ https://cran.r-project.org/bin/windows/Rtools/ | https://cran.r-project.org/bin/windows/Rtools/ ] 



Devtools : [ https://cran.r-project.org/web/packages/devtools/index.html | https://cran.r-project.org/web/packages/devtools/index.html ] 



ggplot2 : [ https://cran.r-project.org/web/packages/ggplot2/index.html | https://cran.r-project.org/web/packages/ggplot2/index.html ] 



[ https://ggplot2.tidyverse.org/ | https://ggplot2.tidyverse.org/ ] 



[ https://cran.r-project.org/web/packages/ggplot2/ggplot2.pdf | https://cran.r-project.org/web/packages/ggplot2/ggplot2.pdf ] 





plyr : [ https://cran.r-project.org/web/packages/plyr/index.html | https://cran.r-project.org/web/packages/plyr/index.html ] 



shiny : [ https://cran.r-project.org/web/packages/shiny/index.html | https://cran.r-project.org/web/packages/shiny/index.html ] 



[ https://shiny.posit.co/r/getstarted/shiny-basics/lesson1/index.html | https://shiny.posit.co/r/getstarted/shiny-basics/lesson1/index.html ] 



[ https://github.com/rstudio/shiny | https://github.com/rstudio/shiny ] 



cytofkit : [ https://github.com/JinmiaoChenLab/cytofkit | https://github.com/JinmiaoChenLab/cytofkit ] 



[ https://bioconductor.riken.jp/packages/3.3/bioc/html/cytofkit.html | https://bioconductor.riken.jp/packages/3.3/bioc/html/cytofkit.html ] 



[ https://journals.plos.org/ploscompbiol/article/file?id=10.1371/journal.pcbi.1005112&type=printable | https://journals.plos.org/ploscompbiol/article/file?id=10.1371/journal.pcbi.1005112&type=printable ] 






Below, I provide the errors and warnings that I faced for 2 weeks for both R versions; 





Please find the errors and warnings below; 






CYTOFKIT FOR R VERSION 3.5. 2 









> library(cytofkit) 

Loading required package: ggplot2 

Loading required package: plyr 

Error: package or namespace load failed for ?cytofkit?: 

package ?cytofkit? was installed by an R version with different internals; it needs to be reinstalled for use with this R version 



ERROR: this R is version 3.5.2, package 'cytofkit2' requires R >= 4.0.0 

In R CMD INSTALL 

Installation paths not writeable, unable to update packages 

path: C:/Program Files/R/R-3.5.2/library 

packages: 

boot, class, cluster, codetools, KernSmooth, Matrix, nlme, nnet, rpart, spatial, survival 

There were 23 warnings (use warnings() to see them) 



> warnings() 

Warning messages: 

1: packages ?caTools?, ?umap? are not available (for R version 3.5.2) 

2: In i.p(...) : installation of package ?DEoptimR? had non-zero exit status 

3: In i.p(...) : installation of package ?mvtnorm? had non-zero exit status 

4: In i.p(...) : installation of package ?XML? had non-zero exit status 

5: In i.p(...) : installation of package ?fastmap? had non-zero exit status 

6: In i.p(...) : installation of package ?sass? had non-zero exit status 

7: In i.p(...) : installation of package ?jquerylib? had non-zero exit status 

8: In i.p(...) : installation of package ?later? had non-zero exit status 

9: In i.p(...) : installation of package ?fontawesome? had non-zero exit status 

10: In i.p(...) : installation of package ?miniUI? had non-zero exit status 

11: In i.p(...) : installation of package ?RcppTOML? had non-zero exit status 

12: In i.p(...) : installation of package ?pcaPP? had non-zero exit status 

13: In i.p(...) : installation of package ?robustbase? had non-zero exit status 

14: In i.p(...) : installation of package ?cachem? had non-zero exit status 

15: In i.p(...) : installation of package ?promises? had non-zero exit status 

16: In i.p(...) : installation of package ?reticulate? had non-zero exit status 

17: In i.p(...) : installation of package ?rrcov? had non-zero exit status 

18: In i.p(...) : installation of package ?memoise? had non-zero exit status 

19: In i.p(...) : installation of package ?httpuv? had non-zero exit status 

20: In i.p(...) : installation of package ?bslib? had non-zero exit status 

21: In i.p(...) : installation of package ?rmarkdown? had non-zero exit status 

22: In i.p(...) : installation of package ?htmlwidgets? had non-zero exit status 

23: In i.p(...) : 

installation of package ?C:/Users/murat-delman/AppData/Local/Temp/Rtmp8GGq71/file4d0c54c135b4/cytofkit2_0.99.80.tar.gz? had non-zero exit status 


> devtools::install_github("JinmiaoChenLab/cytofkit") 

Error in rbind(info, getNamespaceInfo(env, "S3methods")) : 

number of columns of matrices must match (see arg 2) 



> 





INSTALLING GGPLOT2 FOR R VERSION 3.5. 0 



> library(cytofkit) 

Loading required package: ggplot2 

Warning: namespace ?cli? is not available and has been replaced 

by .GlobalEnv when processing object ?.Random.seed? 

Error: package or namespace load failed for ?ggplot2? in rbind(info, getNamespaceInfo(env, "S3methods")): 

number of columns of matrices must match (see arg 2) 

Error: package ?ggplot2? could not be loaded 

In addition: Warning message: 

package ?ggplot2? was built under R version 4.2.3 



> library(cytofkit) 

Error: package ?ggplot2? required by ?cytofkit? could not be found 



> install.packages("D:/Programlar/ggplotgui_1.0.0.zip", repos = NULL, type = "win.binary") 

Installing package into ?C:/Users/murat/Documents/R/win-library/3.5? 

(as ?lib? is unspecified) 

package ?ggplotgui? successfully unpacked and MD5 sums checked 



> install.packages("D:/Programlar/ggplot2/ggplot2_3.0.0.tar.gz", repos = NULL, type = "source") 

Installing package into ?C:/Users/murat/Documents/R/win-library/3.5? 

(as ?lib? is unspecified) 

* installing *source* package 'ggplot2' ... 

** package 'ggplot2' successfully unpacked and MD5 sums checked 

** R 

** data 

*** moving datasets to lazyload DB 

** inst 

** byte-compile and prepare package for lazy loading 

Warning: namespace 'cli' is not available and has been replaced 

by .GlobalEnv when processing object 'txhousing' 

Error in rbind(info, getNamespaceInfo(env, "S3methods")) : 

number of columns of matrices must match (see arg 2) 

ERROR: lazy loading failed for package 'ggplot2' 

* removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2' 

In R CMD INSTALL 

Warning in install.packages : 

installation of package ?D:/Programlar/ggplot2/ggplot2_3.0.0.tar.gz? had non-zero exit status 



> packageurl <- " [ https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz | https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz ] " 

> install.packages(packageurl, repos=NULL, type="source") 

Installing package into ?C:/Users/murat/Documents/R/win-library/3.5? 

(as ?lib? is unspecified) 

trying URL ' [ https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz | https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz ] ' 

Content type 'application/x-gzip' length 3031461 bytes (2.9 MB) 

downloaded 2.9 MB 



* installing *source* package 'ggplot2' ... 

** package 'ggplot2' successfully unpacked and MD5 sums checked 

** R 

** data 

*** moving datasets to lazyload DB 

** inst 

** byte-compile and prepare package for lazy loading 

Warning: namespace 'cli' is not available and has been replaced 

by .GlobalEnv when processing object 'txhousing' 

Error in rbind(info, getNamespaceInfo(env, "S3methods")) : 

number of columns of matrices must match (see arg 2) 

ERROR: lazy loading failed for package 'ggplot2' 

* removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2' 

In R CMD INSTALL 

Warning in install.packages : 

installation of package ?C:/Users/murat/AppData/Local/Temp/RtmpI776iL/downloaded_packages/ggplot2_3.3.0.tar.gz? had non-zero exit status 



> install.packages("ggplot2") 

Installing package into ?C:/Users/murat/Documents/R/win-library/3.5? 

(as ?lib? is unspecified) 

Warning in install.packages : 

unable to access index for repository [ https://cran.rstudio.com/bin/windows/contrib/3.5 | https://cran.rstudio.com/bin/windows/contrib/3.5 ] : 

cannot open URL ' [ https://cran.rstudio.com/bin/windows/contrib/3.5/PACKAGES | https://cran.rstudio.com/bin/windows/contrib/3.5/PACKAGES ] ' 

installing the source package ?ggplot2? 



trying URL ' [ https://cran.rstudio.com/src/contrib/ggplot2_3.4.2.tar.gz | https://cran.rstudio.com/src/contrib/ggplot2_3.4.2.tar.gz ] ' 

Content type 'application/x-gzip' length 3153811 bytes (3.0 MB) 

downloaded 3.0 MB 



* installing *source* package 'ggplot2' ... 

** package 'ggplot2' successfully unpacked and MD5 sums checked 

** R 

** data 

*** moving datasets to lazyload DB 

** inst 

** byte-compile and prepare package for lazy loading 

Warning: namespace 'cli' is not available and has been replaced 

by .GlobalEnv when processing object 'txhousing' 

Error in rbind(info, getNamespaceInfo(env, "S3methods")) : 

number of columns of matrices must match (see arg 2) 

ERROR: lazy loading failed for package 'ggplot2' 

* removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2' 

In R CMD INSTALL 

Warning in install.packages : 

installation of package ?ggplot2? had non-zero exit status 



The downloaded source packages are in 

?C:\Users\murat\AppData\Local\Temp\RtmpI776iL\downloaded_packages? 



> packageurl <- " [ https://cran.r-project.org/web/packages/ggplot2/index.html | https://cran.r-project.org/web/packages/ggplot2/index.html ] " 

> install.packages(packageurl, repos=NULL, type="source") 

Installing package into ?C:/Users/murat/Documents/R/win-library/3.5? 

(as ?lib? is unspecified) 

trying URL ' [ https://cran.r-project.org/web/packages/ggplot2/index.html | https://cran.r-project.org/web/packages/ggplot2/index.html ] ' 

Content type 'text/html' length 468435 bytes (457 KB) 

downloaded 457 KB 



Error in getOctD(x, offset, len) : invalid octal digit 

In R CMD INSTALL 

Warning in install.packages : 

installation of package ?C:/Users/murat/AppData/Local/Temp/RtmpI776iL/downloaded_packages/index.html? had non-zero exit status 



> packageurl <- " [ https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz | https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz ] " 

> install.packages(packageurl, repos=NULL, type="source") 

Installing package into ?C:/Users/murat/Documents/R/win-library/3.5? 

(as ?lib? is unspecified) 

trying URL ' [ https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz | https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz ] ' 

Content type 'application/x-gzip' length 3031461 bytes (2.9 MB) 

downloaded 2.9 MB 



* installing *source* package 'ggplot2' ... 

** package 'ggplot2' successfully unpacked and MD5 sums checked 

** R 

** data 

*** moving datasets to lazyload DB 

** inst 

** byte-compile and prepare package for lazy loading 

Warning: namespace 'cli' is not available and has been replaced 

by .GlobalEnv when processing object 'txhousing' 

Error in rbind(info, getNamespaceInfo(env, "S3methods")) : 

number of columns of matrices must match (see arg 2) 

ERROR: lazy loading failed for package 'ggplot2' 

* removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2' 

In R CMD INSTALL 

Warning in install.packages : 

installation of package ?C:/Users/murat/AppData/Local/Temp/Rtmp8sLmoj/downloaded_packages/ggplot2_3.3.0.tar.gz? had non-zero exit status 



> pak::pkg_install("tibble") 

Error in load_private_package("cli") : 

Cannot load cli from the private library 



> pak::pkg_install("tidyverse/tibble") 

Error in load_private_package("cli") : 

Cannot load cli from the private library 



> pkg_install("tibble") 

Error in pkg_install("tibble") : could not find function "pkg_install" 



> install.packages("D:/Programlar/ggplot2/ggplot2_3.4.2.zip", repos = NULL, type = "win.binary") 

Installing package into ?C:/Users/murat/Documents/R/win-library/3.5? 

(as ?lib? is unspecified) 

package ?ggplot2? successfully unpacked and MD5 sums checked 



Kind Regards 


Murat Delman, Ph.D. 
Izmir Institute of Technology 
Integrated Research Centers 


From @vi@e@gross m@iii@g oii gm@ii@com  Fri Aug  4 17:59:16 2023
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Fri, 4 Aug 2023 11:59:16 -0400
Subject: [R] Multiply
In-Reply-To: <CAJOiR6Y-qZL=N8Cb_VZwsRdxzDhkUG8+uhJOvvZB=3YC4TA1VA@mail.gmail.com>
References: <CAJOiR6Y-qZL=N8Cb_VZwsRdxzDhkUG8+uhJOvvZB=3YC4TA1VA@mail.gmail.com>
Message-ID: <006f01d9c6ec$9f005180$dd00f480$@gmail.com>

Val,

A data.frame is not quite the same thing as a matrix.

But as long as everything is numeric, you can convert both data.frames to
matrices, perform the computations needed and, if you want, convert it back
into a data.frame.

BUT it must be all numeric and you violate that requirement by having a
character column for ID. You need to eliminate that temporarily:

dat1 <- read.table(text="ID, x, y, z
 A, 10,  34, 12
 B, 25,  42, 18
 C, 14,  20,  8 ",sep=",",header=TRUE,stringsAsFactors=F)

mat1 <- as.matrix(dat1[,2:4])

The result is:

> mat1
      x  y  z
[1,] 10 34 12
[2,] 25 42 18
[3,] 14 20  8

Now do the second matrix, perhaps in one step:

mat2 <- as.matrix(read.table(text="ID, weight, weiht2
 A,  0.25, 0.35
 B,  0.42, 0.52
 C,  0.65, 0.75",sep=",",header=TRUE,stringsAsFactors=F)[,2:3])


Do note some people use read.csv() instead of read.table, albeit it simply
calls read.table after setting some parameters like the comma.

The result is what you asked for, including spelling weight wrong once.:

> mat2
     weight weiht2
[1,]   0.25   0.35
[2,]   0.42   0.52
[3,]   0.65   0.75

Now you wanted to multiply as in matrix multiplication.

> mat1 %*% mat2
     weight weiht2
[1,]  24.58  30.18
[2,]  35.59  44.09
[3,]  17.10  21.30

Of course, you wanted different names for the columns and you can do that
easily enough:

result <- mat1 %*% mat2

colnames(result) <- c("index1", "index2")


But this is missing something:

> result
     index1 index2
[1,]  24.58  30.18
[2,]  35.59  44.09
[3,]  17.10  21.30

Do you want a column of ID numbers on the left? If numeric, you can keep it
in a matrix in one of many ways but if you want to go back to the data.frame
format and re-use the ID numbers, there are again MANY ways. But note mixing
characters and numbers can inadvertently convert everything to characters.

Here is one solution. Not the only one nor the best one but reasonable:

recombined <- data.frame(index=dat1$ID, 
                         index1=result[,1], 
                         index2=result[,2])


> recombined
  index index1 index2
1     A  24.58  30.18
2     B  35.59  44.09
3     C  17.10  21.30

If for some reason you need a more general purpose way to do this for
arbitrary conformant matrices, you can write a function that does this in a
more general way but perhaps a better idea might be a way to store your
matrices in files in a way that can be read back in directly or to not
include indices as character columns but as row names.






-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Val
Sent: Friday, August 4, 2023 10:54 AM
To: r-help at R-project.org (r-help at r-project.org) <r-help at r-project.org>
Subject: [R] Multiply

Hi all,

I want to multiply two  data frames as shown below,

dat1 <-read.table(text="ID, x, y, z
 A, 10,  34, 12
 B, 25,  42, 18
 C, 14,  20,  8 ",sep=",",header=TRUE,stringsAsFactors=F)

dat2 <-read.table(text="ID, weight, weiht2
 A,  0.25, 0.35
 B,  0.42, 0.52
 C,  0.65, 0.75",sep=",",header=TRUE,stringsAsFactors=F)

Desired result

ID  Index1 Index2
1  A 24.58 30.18
2  B 35.59 44.09
3  C 17.10 21.30

Here is my attempt,  but did not work

dat3 <- data.frame(ID = dat1[,1], Index = apply(dat1[,-1], 1, FUN=
function(x) {sum(x*dat2[,2:ncol(dat2)])} ), stringsAsFactors=F)


Any help?

Thank you,

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Fri Aug  4 18:15:40 2023
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 4 Aug 2023 09:15:40 -0700
Subject: [R] Technical Help Request for "Version Differences" (i.e.,
 CYTOFKIT package)
In-Reply-To: <146822026.2931556.1691133058051.JavaMail.zimbra@iyte.edu.tr>
References: <146822026.2931556.1691133058051.JavaMail.zimbra@iyte.edu.tr>
Message-ID: <CAGxFJbTPtK6uha-Z=EEeTkf+SCVJHi-c5iMx63MLTcijCdYvgg@mail.gmail.com>

Dear Murat:

See the "posting guide" (link below) for how and what to post on this list.

I believe that in that guide it is recommended that you first update
your R version and packages to the latest versions (R 3.5 is rather
old now). You should probably reinstall R and all packages from the
main CRAN website:
https://cran.r-project.org/

Note that once you install R, you can read ?install.packages for how
to install the latest versions of all the packages you need that are
on CRAN.

Note that R and RStudio are different software products. So once R is
installed, you can download and install the packages you need from the
Posit website if you prefer, again with the latest versions.

If for some reason CRAN is not available to you or some of the
packages you need are not on CRAN(e.g. github only packages)  or won't
run on your computer, then the process will be more complicated, and
others will have to help you. CRAN has a rigorous process for assuring
compatibility of packages and R versions, so that packages not on CRAN
may not be compatible with the latest R version. All I can suggest is
that you avoid such packages **if possible** (I understand that it may
not be). You can search CRAN's "Task Views" (link on
https://cran.r-project.org/ )for alternative CRAN packages that may
have the functionality you seek.

Cheers,
Bert


On Fri, Aug 4, 2023 at 8:40?AM MURAT DELMAN via R-help
<r-help at r-project.org> wrote:
>
>
>
>
> Dear Ms./Mr.,
>
>
>
>
>
>
>
> If the email text and codes below are not properly displayed, you can download the attached Word file, which has exactly the same content.
>
>
>
> I am a cytometrist and microscopist at Izmir Institute of Technology, Integrated Research Center. I operate a cytometer and fluorescence microscope to acquire data from our researchers? samples and then give them analyzed data. I need to dive into bulk data to present all of the information in the sample. To do this, I have recently been trying to develop my skills in R, RStudio, and Cytofkit package for cytometry (flow, spectral, mass, imaging mass cytometry) data analysis. I am new in this area and must learn R for data analysis.
>
>
>
>
>
> May I request help from you or one of your assistants who is competent in R, RStudio, and R packages with the installation issues caused by ? version differences ? between R itself, R packages, and their dependencies? I really had to send this email to you anymore, because I could not run the package ?Cytofkit? and find a solution on the internet.
>
>
> It has been nearly 2 weeks since I have been trying to solve the errors and warnings. I am in a vicious circle and cannot move forward anymore. This is why I needed help from an expert competent in R programming.
>
>
>
> I tried to use the renv package, but I could not move forward because I am not competent in R.
>
>
>
>
> I explained the errors that I faced during the installation below.
>
>
>
> I have two computers, both operating Windows 10, 64-bit.
>
>
>
> I installed R 3.5. 2 on the desktop (Windows in English) and R 3.5. 0 on the laptop (Windows in Turkish).
>
>
>
> I know that you are very busy with your work, but may you (or your assistant) help me by informing me how to install consistent versions of R, RStudio, and packages/dependencies (for example, Cytofkit, ggplot2, Rtools, devtools, plyr, shiny, GUI)?
>
>
>
>
>
> I guess I will need exact web page links " in an orderly manner" to download the correct versions of everything.
>
>
>
> I would appreciate it if you could advise me or forward this email to one of your assistants or experts.
>
>
>
>
>
>
> I really appreciate any help you can provide.
>
>
>
>
>
>
> Kind Regards
>
>
>
>
>
>
> Please find the technical details below;
>
>
>
>
>
> I used the installation order listed below;
>
>
>
> I downloaded R 3.5.0 and R 3.5.2 using the link and directory below.
>
>
>
> Link: [ https://www.freestatistics.org/cran/ | https://www.freestatistics.org/cran/ ]
>
>
>
> Directory: Download R for Windows > install R for the first time > Previous releases > R 3.5.2 (December, 2018) or R 3.5.0
>
>
>
>
>
> I downloaded RStudio from the link below;
>
>
>
> [ https://posit.co/download/rstudio-desktop/ | https://posit.co/download/rstudio-desktop/ ]
>
>
>
>
>
>
> I downloaded packages via either [ https://cran.rstudio.com/bin/windows/contrib/r-devel/ | https://cran.rstudio.com/bin/windows/contrib/r-devel/ ] or the ?install function? tab in RStudio.
>
>
>
> Rtools : [ https://cran.r-project.org/bin/windows/Rtools/ | https://cran.r-project.org/bin/windows/Rtools/ ]
>
>
>
> Devtools : [ https://cran.r-project.org/web/packages/devtools/index.html | https://cran.r-project.org/web/packages/devtools/index.html ]
>
>
>
> ggplot2 : [ https://cran.r-project.org/web/packages/ggplot2/index.html | https://cran.r-project.org/web/packages/ggplot2/index.html ]
>
>
>
> [ https://ggplot2.tidyverse.org/ | https://ggplot2.tidyverse.org/ ]
>
>
>
> [ https://cran.r-project.org/web/packages/ggplot2/ggplot2.pdf | https://cran.r-project.org/web/packages/ggplot2/ggplot2.pdf ]
>
>
>
>
>
> plyr : [ https://cran.r-project.org/web/packages/plyr/index.html | https://cran.r-project.org/web/packages/plyr/index.html ]
>
>
>
> shiny : [ https://cran.r-project.org/web/packages/shiny/index.html | https://cran.r-project.org/web/packages/shiny/index.html ]
>
>
>
> [ https://shiny.posit.co/r/getstarted/shiny-basics/lesson1/index.html | https://shiny.posit.co/r/getstarted/shiny-basics/lesson1/index.html ]
>
>
>
> [ https://github.com/rstudio/shiny | https://github.com/rstudio/shiny ]
>
>
>
> cytofkit : [ https://github.com/JinmiaoChenLab/cytofkit | https://github.com/JinmiaoChenLab/cytofkit ]
>
>
>
> [ https://bioconductor.riken.jp/packages/3.3/bioc/html/cytofkit.html | https://bioconductor.riken.jp/packages/3.3/bioc/html/cytofkit.html ]
>
>
>
> [ https://journals.plos.org/ploscompbiol/article/file?id=10.1371/journal.pcbi.1005112&type=printable | https://journals.plos.org/ploscompbiol/article/file?id=10.1371/journal.pcbi.1005112&type=printable ]
>
>
>
>
>
>
> Below, I provide the errors and warnings that I faced for 2 weeks for both R versions;
>
>
>
>
>
> Please find the errors and warnings below;
>
>
>
>
>
>
> CYTOFKIT FOR R VERSION 3.5. 2
>
>
>
>
>
>
>
>
>
> > library(cytofkit)
>
> Loading required package: ggplot2
>
> Loading required package: plyr
>
> Error: package or namespace load failed for ?cytofkit?:
>
> package ?cytofkit? was installed by an R version with different internals; it needs to be reinstalled for use with this R version
>
>
>
> ERROR: this R is version 3.5.2, package 'cytofkit2' requires R >= 4.0.0
>
> In R CMD INSTALL
>
> Installation paths not writeable, unable to update packages
>
> path: C:/Program Files/R/R-3.5.2/library
>
> packages:
>
> boot, class, cluster, codetools, KernSmooth, Matrix, nlme, nnet, rpart, spatial, survival
>
> There were 23 warnings (use warnings() to see them)
>
>
>
> > warnings()
>
> Warning messages:
>
> 1: packages ?caTools?, ?umap? are not available (for R version 3.5.2)
>
> 2: In i.p(...) : installation of package ?DEoptimR? had non-zero exit status
>
> 3: In i.p(...) : installation of package ?mvtnorm? had non-zero exit status
>
> 4: In i.p(...) : installation of package ?XML? had non-zero exit status
>
> 5: In i.p(...) : installation of package ?fastmap? had non-zero exit status
>
> 6: In i.p(...) : installation of package ?sass? had non-zero exit status
>
> 7: In i.p(...) : installation of package ?jquerylib? had non-zero exit status
>
> 8: In i.p(...) : installation of package ?later? had non-zero exit status
>
> 9: In i.p(...) : installation of package ?fontawesome? had non-zero exit status
>
> 10: In i.p(...) : installation of package ?miniUI? had non-zero exit status
>
> 11: In i.p(...) : installation of package ?RcppTOML? had non-zero exit status
>
> 12: In i.p(...) : installation of package ?pcaPP? had non-zero exit status
>
> 13: In i.p(...) : installation of package ?robustbase? had non-zero exit status
>
> 14: In i.p(...) : installation of package ?cachem? had non-zero exit status
>
> 15: In i.p(...) : installation of package ?promises? had non-zero exit status
>
> 16: In i.p(...) : installation of package ?reticulate? had non-zero exit status
>
> 17: In i.p(...) : installation of package ?rrcov? had non-zero exit status
>
> 18: In i.p(...) : installation of package ?memoise? had non-zero exit status
>
> 19: In i.p(...) : installation of package ?httpuv? had non-zero exit status
>
> 20: In i.p(...) : installation of package ?bslib? had non-zero exit status
>
> 21: In i.p(...) : installation of package ?rmarkdown? had non-zero exit status
>
> 22: In i.p(...) : installation of package ?htmlwidgets? had non-zero exit status
>
> 23: In i.p(...) :
>
> installation of package ?C:/Users/murat-delman/AppData/Local/Temp/Rtmp8GGq71/file4d0c54c135b4/cytofkit2_0.99.80.tar.gz? had non-zero exit status
>
>
> > devtools::install_github("JinmiaoChenLab/cytofkit")
>
> Error in rbind(info, getNamespaceInfo(env, "S3methods")) :
>
> number of columns of matrices must match (see arg 2)
>
>
>
> >
>
>
>
>
>
> INSTALLING GGPLOT2 FOR R VERSION 3.5. 0
>
>
>
> > library(cytofkit)
>
> Loading required package: ggplot2
>
> Warning: namespace ?cli? is not available and has been replaced
>
> by .GlobalEnv when processing object ?.Random.seed?
>
> Error: package or namespace load failed for ?ggplot2? in rbind(info, getNamespaceInfo(env, "S3methods")):
>
> number of columns of matrices must match (see arg 2)
>
> Error: package ?ggplot2? could not be loaded
>
> In addition: Warning message:
>
> package ?ggplot2? was built under R version 4.2.3
>
>
>
> > library(cytofkit)
>
> Error: package ?ggplot2? required by ?cytofkit? could not be found
>
>
>
> > install.packages("D:/Programlar/ggplotgui_1.0.0.zip", repos = NULL, type = "win.binary")
>
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> package ?ggplotgui? successfully unpacked and MD5 sums checked
>
>
>
> > install.packages("D:/Programlar/ggplot2/ggplot2_3.0.0.tar.gz", repos = NULL, type = "source")
>
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> * installing *source* package 'ggplot2' ...
>
> ** package 'ggplot2' successfully unpacked and MD5 sums checked
>
> ** R
>
> ** data
>
> *** moving datasets to lazyload DB
>
> ** inst
>
> ** byte-compile and prepare package for lazy loading
>
> Warning: namespace 'cli' is not available and has been replaced
>
> by .GlobalEnv when processing object 'txhousing'
>
> Error in rbind(info, getNamespaceInfo(env, "S3methods")) :
>
> number of columns of matrices must match (see arg 2)
>
> ERROR: lazy loading failed for package 'ggplot2'
>
> * removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2'
>
> In R CMD INSTALL
>
> Warning in install.packages :
>
> installation of package ?D:/Programlar/ggplot2/ggplot2_3.0.0.tar.gz? had non-zero exit status
>
>
>
> > packageurl <- " [ https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz | https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz ] "
>
> > install.packages(packageurl, repos=NULL, type="source")
>
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> trying URL ' [ https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz | https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz ] '
>
> Content type 'application/x-gzip' length 3031461 bytes (2.9 MB)
>
> downloaded 2.9 MB
>
>
>
> * installing *source* package 'ggplot2' ...
>
> ** package 'ggplot2' successfully unpacked and MD5 sums checked
>
> ** R
>
> ** data
>
> *** moving datasets to lazyload DB
>
> ** inst
>
> ** byte-compile and prepare package for lazy loading
>
> Warning: namespace 'cli' is not available and has been replaced
>
> by .GlobalEnv when processing object 'txhousing'
>
> Error in rbind(info, getNamespaceInfo(env, "S3methods")) :
>
> number of columns of matrices must match (see arg 2)
>
> ERROR: lazy loading failed for package 'ggplot2'
>
> * removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2'
>
> In R CMD INSTALL
>
> Warning in install.packages :
>
> installation of package ?C:/Users/murat/AppData/Local/Temp/RtmpI776iL/downloaded_packages/ggplot2_3.3.0.tar.gz? had non-zero exit status
>
>
>
> > install.packages("ggplot2")
>
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> Warning in install.packages :
>
> unable to access index for repository [ https://cran.rstudio.com/bin/windows/contrib/3.5 | https://cran.rstudio.com/bin/windows/contrib/3.5 ] :
>
> cannot open URL ' [ https://cran.rstudio.com/bin/windows/contrib/3.5/PACKAGES | https://cran.rstudio.com/bin/windows/contrib/3.5/PACKAGES ] '
>
> installing the source package ?ggplot2?
>
>
>
> trying URL ' [ https://cran.rstudio.com/src/contrib/ggplot2_3.4.2.tar.gz | https://cran.rstudio.com/src/contrib/ggplot2_3.4.2.tar.gz ] '
>
> Content type 'application/x-gzip' length 3153811 bytes (3.0 MB)
>
> downloaded 3.0 MB
>
>
>
> * installing *source* package 'ggplot2' ...
>
> ** package 'ggplot2' successfully unpacked and MD5 sums checked
>
> ** R
>
> ** data
>
> *** moving datasets to lazyload DB
>
> ** inst
>
> ** byte-compile and prepare package for lazy loading
>
> Warning: namespace 'cli' is not available and has been replaced
>
> by .GlobalEnv when processing object 'txhousing'
>
> Error in rbind(info, getNamespaceInfo(env, "S3methods")) :
>
> number of columns of matrices must match (see arg 2)
>
> ERROR: lazy loading failed for package 'ggplot2'
>
> * removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2'
>
> In R CMD INSTALL
>
> Warning in install.packages :
>
> installation of package ?ggplot2? had non-zero exit status
>
>
>
> The downloaded source packages are in
>
> ?C:\Users\murat\AppData\Local\Temp\RtmpI776iL\downloaded_packages?
>
>
>
> > packageurl <- " [ https://cran.r-project.org/web/packages/ggplot2/index.html | https://cran.r-project.org/web/packages/ggplot2/index.html ] "
>
> > install.packages(packageurl, repos=NULL, type="source")
>
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> trying URL ' [ https://cran.r-project.org/web/packages/ggplot2/index.html | https://cran.r-project.org/web/packages/ggplot2/index.html ] '
>
> Content type 'text/html' length 468435 bytes (457 KB)
>
> downloaded 457 KB
>
>
>
> Error in getOctD(x, offset, len) : invalid octal digit
>
> In R CMD INSTALL
>
> Warning in install.packages :
>
> installation of package ?C:/Users/murat/AppData/Local/Temp/RtmpI776iL/downloaded_packages/index.html? had non-zero exit status
>
>
>
> > packageurl <- " [ https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz | https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz ] "
>
> > install.packages(packageurl, repos=NULL, type="source")
>
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> trying URL ' [ https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz | https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz ] '
>
> Content type 'application/x-gzip' length 3031461 bytes (2.9 MB)
>
> downloaded 2.9 MB
>
>
>
> * installing *source* package 'ggplot2' ...
>
> ** package 'ggplot2' successfully unpacked and MD5 sums checked
>
> ** R
>
> ** data
>
> *** moving datasets to lazyload DB
>
> ** inst
>
> ** byte-compile and prepare package for lazy loading
>
> Warning: namespace 'cli' is not available and has been replaced
>
> by .GlobalEnv when processing object 'txhousing'
>
> Error in rbind(info, getNamespaceInfo(env, "S3methods")) :
>
> number of columns of matrices must match (see arg 2)
>
> ERROR: lazy loading failed for package 'ggplot2'
>
> * removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2'
>
> In R CMD INSTALL
>
> Warning in install.packages :
>
> installation of package ?C:/Users/murat/AppData/Local/Temp/Rtmp8sLmoj/downloaded_packages/ggplot2_3.3.0.tar.gz? had non-zero exit status
>
>
>
> > pak::pkg_install("tibble")
>
> Error in load_private_package("cli") :
>
> Cannot load cli from the private library
>
>
>
> > pak::pkg_install("tidyverse/tibble")
>
> Error in load_private_package("cli") :
>
> Cannot load cli from the private library
>
>
>
> > pkg_install("tibble")
>
> Error in pkg_install("tibble") : could not find function "pkg_install"
>
>
>
> > install.packages("D:/Programlar/ggplot2/ggplot2_3.4.2.zip", repos = NULL, type = "win.binary")
>
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> package ?ggplot2? successfully unpacked and MD5 sums checked
>
>
>
> Kind Regards
>
>
> Murat Delman, Ph.D.
> Izmir Institute of Technology
> Integrated Research Centers
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From v@|kremk @end|ng |rom gm@||@com  Fri Aug  4 20:03:18 2023
From: v@|kremk @end|ng |rom gm@||@com (Val)
Date: Fri, 4 Aug 2023 13:03:18 -0500
Subject: [R] Multiply
In-Reply-To: <006f01d9c6ec$9f005180$dd00f480$@gmail.com>
References: <CAJOiR6Y-qZL=N8Cb_VZwsRdxzDhkUG8+uhJOvvZB=3YC4TA1VA@mail.gmail.com>
 <006f01d9c6ec$9f005180$dd00f480$@gmail.com>
Message-ID: <CAJOiR6aEfU-HrS9Q_ufCxubLOMt01fa7q1oV2fZ-rsmrygiOOw@mail.gmail.com>

Thank you,  Avi and Ivan.  Worked for this particular Example.

Yes, I am looking for something with a more general purpose.
I think Ivan's suggestion works for this.

multiplication=as.matrix(dat1[,-1]) %*% as.matrix(dat2[match(dat1[,1],
dat2[,1]),-1])
Res=data.frame(ID = dat1[,1], Index = multiplication)

On Fri, Aug 4, 2023 at 10:59?AM <avi.e.gross at gmail.com> wrote:
>
> Val,
>
> A data.frame is not quite the same thing as a matrix.
>
> But as long as everything is numeric, you can convert both data.frames to
> matrices, perform the computations needed and, if you want, convert it back
> into a data.frame.
>
> BUT it must be all numeric and you violate that requirement by having a
> character column for ID. You need to eliminate that temporarily:
>
> dat1 <- read.table(text="ID, x, y, z
>  A, 10,  34, 12
>  B, 25,  42, 18
>  C, 14,  20,  8 ",sep=",",header=TRUE,stringsAsFactors=F)
>
> mat1 <- as.matrix(dat1[,2:4])
>
> The result is:
>
> > mat1
>       x  y  z
> [1,] 10 34 12
> [2,] 25 42 18
> [3,] 14 20  8
>
> Now do the second matrix, perhaps in one step:
>
> mat2 <- as.matrix(read.table(text="ID, weight, weiht2
>  A,  0.25, 0.35
>  B,  0.42, 0.52
>  C,  0.65, 0.75",sep=",",header=TRUE,stringsAsFactors=F)[,2:3])
>
>
> Do note some people use read.csv() instead of read.table, albeit it simply
> calls read.table after setting some parameters like the comma.
>
> The result is what you asked for, including spelling weight wrong once.:
>
> > mat2
>      weight weiht2
> [1,]   0.25   0.35
> [2,]   0.42   0.52
> [3,]   0.65   0.75
>
> Now you wanted to multiply as in matrix multiplication.
>
> > mat1 %*% mat2
>      weight weiht2
> [1,]  24.58  30.18
> [2,]  35.59  44.09
> [3,]  17.10  21.30
>
> Of course, you wanted different names for the columns and you can do that
> easily enough:
>
> result <- mat1 %*% mat2
>
> colnames(result) <- c("index1", "index2")
>
>
> But this is missing something:
>
> > result
>      index1 index2
> [1,]  24.58  30.18
> [2,]  35.59  44.09
> [3,]  17.10  21.30
>
> Do you want a column of ID numbers on the left? If numeric, you can keep it
> in a matrix in one of many ways but if you want to go back to the data.frame
> format and re-use the ID numbers, there are again MANY ways. But note mixing
> characters and numbers can inadvertently convert everything to characters.
>
> Here is one solution. Not the only one nor the best one but reasonable:
>
> recombined <- data.frame(index=dat1$ID,
>                          index1=result[,1],
>                          index2=result[,2])
>
>
> > recombined
>   index index1 index2
> 1     A  24.58  30.18
> 2     B  35.59  44.09
> 3     C  17.10  21.30
>
> If for some reason you need a more general purpose way to do this for
> arbitrary conformant matrices, you can write a function that does this in a
> more general way but perhaps a better idea might be a way to store your
> matrices in files in a way that can be read back in directly or to not
> include indices as character columns but as row names.
>
>
>
>
>
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Val
> Sent: Friday, August 4, 2023 10:54 AM
> To: r-help at R-project.org (r-help at r-project.org) <r-help at r-project.org>
> Subject: [R] Multiply
>
> Hi all,
>
> I want to multiply two  data frames as shown below,
>
> dat1 <-read.table(text="ID, x, y, z
>  A, 10,  34, 12
>  B, 25,  42, 18
>  C, 14,  20,  8 ",sep=",",header=TRUE,stringsAsFactors=F)
>
> dat2 <-read.table(text="ID, weight, weiht2
>  A,  0.25, 0.35
>  B,  0.42, 0.52
>  C,  0.65, 0.75",sep=",",header=TRUE,stringsAsFactors=F)
>
> Desired result
>
> ID  Index1 Index2
> 1  A 24.58 30.18
> 2  B 35.59 44.09
> 3  C 17.10 21.30
>
> Here is my attempt,  but did not work
>
> dat3 <- data.frame(ID = dat1[,1], Index = apply(dat1[,-1], 1, FUN=
> function(x) {sum(x*dat2[,2:ncol(dat2)])} ), stringsAsFactors=F)
>
>
> Any help?
>
> Thank you,
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From er|cjberger @end|ng |rom gm@||@com  Fri Aug  4 20:09:43 2023
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Fri, 4 Aug 2023 21:09:43 +0300
Subject: [R] Technical Help Request for "Version Differences" (i.e.,
 CYTOFKIT package)
In-Reply-To: <CAHZ-BgrATMoVki+KEm6TaLtnsig-zWP4_N7BCK+=Fyt+Lf4ayw@mail.gmail.com>
References: <CAHZ-BgrATMoVki+KEm6TaLtnsig-zWP4_N7BCK+=Fyt+Lf4ayw@mail.gmail.com>
Message-ID: <CAGgJW75FEvy-Je0rwGP3N5kFzNTmZwx5rD3uueax2WL09VRFPQ@mail.gmail.com>

Hi Murat,
I am not sure why you are using R 3.5.
CRAN has R 4.3.1

https://cran.r-project.org/bin/windows/base/

I suggest you start over and install R 4.3.1 and then your cytofkit
install might work.

Good luck,
Eric


On Fri, Aug 4, 2023 at 5:47?PM Murat DELMAN <murat.delman at gmail.com> wrote:
>
> Dear Ms./Mr.,
>
>
> I sent an email to this email address from my institutional address
> muratdelman at iyte.edu.tr, but could not make sure if my email reached you
> because sometimes emails are not delivered to the target due to
> server issues and country-related limitations. I wanted to send you the
> same email via my Gmail account.
>
>
>
>
> If the email text and codes below are not properly displayed, you can
> download the attached Word file, which has exactly the same content.
>
>
>
> I am a cytometrist and microscopist at Izmir Institute of Technology,
> Integrated Research Center. I operate a cytometer and fluorescence
> microscope to acquire data from our researchers? samples and then give them
> analyzed data. I need to dive into bulk data to present all of the
> information in the sample. To do this, I have recently been trying to
> develop my skills in R, RStudio, and Cytofkit package for cytometry (flow,
> spectral, mass, imaging mass cytometry) data analysis. I am new in this
> area and must learn R for data analysis.
>
>
>
>
>
> May I request help from you or one of your assistants who is competent in
> R, RStudio, and R packages with the installation issues caused by ?*version
> differences*? between R itself, R packages, and their dependencies? I
> really had to send this email to you anymore, because I could not run the
> package ?Cytofkit? and find a solution on the internet.
>
>
> It has been nearly 2 weeks since I have been trying to solve the errors and
> warnings. I am in a vicious circle and cannot move forward anymore. This is
> why I needed help from an expert competent in R programming.
>
>
>
> I tried to use the renv package, but I could not move forward because I am
> not competent in R.
>
>
> I explained the errors that I faced during the installation below.
>
>
>
> I have two computers, both operating Windows 10, 64-bit.
>
>
>
> I installed R 3.5.*2* on the desktop (Windows in English) and R 3.5.*0* on
> the laptop (Windows in Turkish).
>
>
>
> I know that you are very busy with your work, but may you (or your
> assistant) help me by informing me *how to install consistent versions of
> R, RStudio, and packages/dependencies* (for example, Cytofkit, ggplot2,
> Rtools, devtools, plyr, shiny, GUI)?
>
>
>
> I guess I will need exact web page links "*in* *an orderly manner" to
> download* the correct versions of everything.
>
>
>
> I would appreciate it if you could advise me or forward this email to one
> of your assistants or experts.
>
>
>
>
> I really appreciate any help you can provide.
>
>
>
>
> Kind Regards
>
>
>
>
> *Please find the technical details below;*
>
>
>
>
>
> I used the installation order listed below;
>
>
>
> I downloaded R 3.5.0 and R 3.5.2 using the link and directory below.
>
>
>
> Link: https://www.freestatistics.org/cran/
>
>
>
> Directory: Download R for Windows > install R for the first time > Previous
> releases > R 3.5.2 (December, 2018) or R 3.5.0
>
>
>
> I downloaded RStudio from the link below;
>
>
>
> https://posit.co/download/rstudio-desktop/
>
>
>
>
> I downloaded packages via either
> https://cran.rstudio.com/bin/windows/contrib/r-devel/ or the ?install
> function? tab in RStudio.
>
>
>
> Rtools : https://cran.r-project.org/bin/windows/Rtools/
>
>
>
> Devtools : https://cran.r-project.org/web/packages/devtools/index.html
>
>
>
> ggplot2 : https://cran.r-project.org/web/packages/ggplot2/index.html
>
>
>
>                  https://ggplot2.tidyverse.org/
>
>
>
>                  https://cran.r-project.org/web/packages/ggplot2/ggplot2.pdf
>
>
>
>
>
> plyr : https://cran.r-project.org/web/packages/plyr/index.html
>
>
>
> shiny : https://cran.r-project.org/web/packages/shiny/index.html
>
>
>
>
> https://shiny.posit.co/r/getstarted/shiny-basics/lesson1/index.html
>
>
>
>             https://github.com/rstudio/shiny
>
>
>
> cytofkit : https://github.com/JinmiaoChenLab/cytofkit
>
>
>
>
> https://bioconductor.riken.jp/packages/3.3/bioc/html/cytofkit.html
>
>
>
> https://journals.plos.org/ploscompbiol/article/file?id=10.1371/journal.pcbi.1005112&type=printable
>
>
>
>
> Below, I provide the errors and warnings that I faced for 2 weeks for both
> R versions;
>
>
>
>
>
> *Please find the errors and warnings below;*
>
>
>
>
> *CYTOFKIT FOR R VERSION 3.5.**2*
>
>
>
>
>
> > library(cytofkit)
>
> Loading required package: ggplot2
>
> Loading required package: plyr
>
> Error: package or namespace load failed for ?cytofkit?:
>
> package ?cytofkit? was installed by an R version with different internals;
> it needs to be reinstalled for use with this R version
>
> ERROR: this R is version 3.5.2, package 'cytofkit2' requires R >= 4.0.0
>
> In R CMD INSTALL
>
> Installation paths not writeable, unable to update packages
>
>   path: C:/Program Files/R/R-3.5.2/library
>
>   packages:
>
>     boot, class, cluster, codetools, KernSmooth, Matrix, nlme, nnet, rpart,
> spatial, survival
>
> There were 23 warnings (use warnings() to see them)
>
>
>
> > warnings()
>
> Warning messages:
>
> 1: packages ?caTools?, ?umap? are not available (for R version 3.5.2)
>
> 2: In i.p(...) : installation of package ?DEoptimR? had non-zero exit status
>
> 3: In i.p(...) : installation of package ?mvtnorm? had non-zero exit status
>
> 4: In i.p(...) : installation of package ?XML? had non-zero exit status
>
> 5: In i.p(...) : installation of package ?fastmap? had non-zero exit status
>
> 6: In i.p(...) : installation of package ?sass? had non-zero exit status
>
> 7: In i.p(...) : installation of package ?jquerylib? had non-zero exit
> status
>
> 8: In i.p(...) : installation of package ?later? had non-zero exit status
>
> 9: In i.p(...) : installation of package ?fontawesome? had non-zero exit
> status
>
> 10: In i.p(...) : installation of package ?miniUI? had non-zero exit status
>
> 11: In i.p(...) : installation of package ?RcppTOML? had non-zero exit
> status
>
> 12: In i.p(...) : installation of package ?pcaPP? had non-zero exit status
>
> 13: In i.p(...) : installation of package ?robustbase? had non-zero exit
> status
>
> 14: In i.p(...) : installation of package ?cachem? had non-zero exit status
>
> 15: In i.p(...) : installation of package ?promises? had non-zero exit
> status
>
> 16: In i.p(...) : installation of package ?reticulate? had non-zero exit
> status
>
> 17: In i.p(...) : installation of package ?rrcov? had non-zero exit status
>
> 18: In i.p(...) : installation of package ?memoise? had non-zero exit status
>
> 19: In i.p(...) : installation of package ?httpuv? had non-zero exit status
>
> 20: In i.p(...) : installation of package ?bslib? had non-zero exit status
>
> 21: In i.p(...) : installation of package ?rmarkdown? had non-zero exit
> status
>
> 22: In i.p(...) : installation of package ?htmlwidgets? had non-zero exit
> status
>
> 23: In i.p(...) :
>
>   installation of package
> ?C:/Users/murat-delman/AppData/Local/Temp/Rtmp8GGq71/file4d0c54c135b4/cytofkit2_0.99.80.tar.gz?
> had non-zero exit status
>
> > devtools::install_github("JinmiaoChenLab/cytofkit")
>
> Error in rbind(info, getNamespaceInfo(env, "S3methods")) :
>
>   number of columns of matrices must match (see arg 2)
>
>
>
> >
>
>
>
>
>
> *INSTALLING GGPLOT2 FOR R VERSION 3.5.**0*
>
>
>
> > library(cytofkit)
>
> Loading required package: ggplot2
>
> Warning: namespace ?cli? is not available and has been replaced
>
> by .GlobalEnv when processing object ?.Random.seed?
>
> Error: package or namespace load failed for ?ggplot2? in rbind(info,
> getNamespaceInfo(env, "S3methods")):
>
>  number of columns of matrices must match (see arg 2)
>
> Error: package ?ggplot2? could not be loaded
>
> In addition: Warning message:
>
> package ?ggplot2? was built under R version 4.2.3
>
>
>
> > library(cytofkit)
>
> Error: package ?ggplot2? required by ?cytofkit? could not be found
>
>
>
> > install.packages("D:/Programlar/ggplotgui_1.0.0.zip", repos = NULL, type
> = "win.binary")
>
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> package ?ggplotgui? successfully unpacked and MD5 sums checked
>
>
>
> > install.packages("D:/Programlar/ggplot2/ggplot2_3.0.0.tar.gz", repos =
> NULL, type = "source")
>
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> * installing *source* package 'ggplot2' ...
>
> ** package 'ggplot2' successfully unpacked and MD5 sums checked
>
> ** R
>
> ** data
>
> *** moving datasets to lazyload DB
>
> ** inst
>
> ** byte-compile and prepare package for lazy loading
>
> Warning: namespace 'cli' is not available and has been replaced
>
> by .GlobalEnv when processing object 'txhousing'
>
> Error in rbind(info, getNamespaceInfo(env, "S3methods")) :
>
>   number of columns of matrices must match (see arg 2)
>
> ERROR: lazy loading failed for package 'ggplot2'
>
> * removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2'
>
> In R CMD INSTALL
>
> Warning in install.packages :
>
>   installation of package ?D:/Programlar/ggplot2/ggplot2_3.0.0.tar.gz? had
> non-zero exit status
>
>
>
> > packageurl <- "
> https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz"
>
> > install.packages(packageurl, repos=NULL, type="source")
>
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> trying URL '
> https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz'
>
> Content type 'application/x-gzip' length 3031461 bytes (2.9 MB)
>
> downloaded 2.9 MB
>
>
>
> * installing *source* package 'ggplot2' ...
>
> ** package 'ggplot2' successfully unpacked and MD5 sums checked
>
> ** R
>
> ** data
>
> *** moving datasets to lazyload DB
>
> ** inst
>
> ** byte-compile and prepare package for lazy loading
>
> Warning: namespace 'cli' is not available and has been replaced
>
> by .GlobalEnv when processing object 'txhousing'
>
> Error in rbind(info, getNamespaceInfo(env, "S3methods")) :
>
>   number of columns of matrices must match (see arg 2)
>
> ERROR: lazy loading failed for package 'ggplot2'
>
> * removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2'
>
> In R CMD INSTALL
>
> Warning in install.packages :
>
>   installation of package
> ?C:/Users/murat/AppData/Local/Temp/RtmpI776iL/downloaded_packages/ggplot2_3.3.0.tar.gz?
> had non-zero exit status
>
>
>
> > install.packages("ggplot2")
>
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> Warning in install.packages :
>
>   unable to access index for repository
> https://cran.rstudio.com/bin/windows/contrib/3.5:
>
>   cannot open URL 'https://cran.rstudio.com/bin/windows/contrib/3.5/PACKAGES
> '
>
> installing the source package ?ggplot2?
>
>
>
> trying URL 'https://cran.rstudio.com/src/contrib/ggplot2_3.4.2.tar.gz'
>
> Content type 'application/x-gzip' length 3153811 bytes (3.0 MB)
>
> downloaded 3.0 MB
>
>
>
> * installing *source* package 'ggplot2' ...
>
> ** package 'ggplot2' successfully unpacked and MD5 sums checked
>
> ** R
>
> ** data
>
> *** moving datasets to lazyload DB
>
> ** inst
>
> ** byte-compile and prepare package for lazy loading
>
> Warning: namespace 'cli' is not available and has been replaced
>
> by .GlobalEnv when processing object 'txhousing'
>
> Error in rbind(info, getNamespaceInfo(env, "S3methods")) :
>
>   number of columns of matrices must match (see arg 2)
>
> ERROR: lazy loading failed for package 'ggplot2'
>
> * removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2'
>
> In R CMD INSTALL
>
> Warning in install.packages :
>
>   installation of package ?ggplot2? had non-zero exit status
>
>
>
> The downloaded source packages are in
>
> ?C:\Users\murat\AppData\Local\Temp\RtmpI776iL\downloaded_packages?
>
>
>
> > packageurl <- "https://cran.r-project.org/web/packages/ggplot2/index.html"
>
> > install.packages(packageurl, repos=NULL, type="source")
>
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> trying URL 'https://cran.r-project.org/web/packages/ggplot2/index.html'
>
> Content type 'text/html' length 468435 bytes (457 KB)
>
> downloaded 457 KB
>
>
>
> Error in getOctD(x, offset, len) : invalid octal digit
>
> In R CMD INSTALL
>
> Warning in install.packages :
>
>   installation of package
> ?C:/Users/murat/AppData/Local/Temp/RtmpI776iL/downloaded_packages/index.html?
> had non-zero exit status
>
>
>
> > packageurl <- "
> https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz"
>
> > install.packages(packageurl, repos=NULL, type="source")
>
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> trying URL '
> https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz'
>
> Content type 'application/x-gzip' length 3031461 bytes (2.9 MB)
>
> downloaded 2.9 MB
>
>
>
> * installing *source* package 'ggplot2' ...
>
> ** package 'ggplot2' successfully unpacked and MD5 sums checked
>
> ** R
>
> ** data
>
> *** moving datasets to lazyload DB
>
> ** inst
>
> ** byte-compile and prepare package for lazy loading
>
> Warning: namespace 'cli' is not available and has been replaced
>
> by .GlobalEnv when processing object 'txhousing'
>
> Error in rbind(info, getNamespaceInfo(env, "S3methods")) :
>
>   number of columns of matrices must match (see arg 2)
>
> ERROR: lazy loading failed for package 'ggplot2'
>
> * removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2'
>
> In R CMD INSTALL
>
> Warning in install.packages :
>
>   installation of package
> ?C:/Users/murat/AppData/Local/Temp/Rtmp8sLmoj/downloaded_packages/ggplot2_3.3.0.tar.gz?
> had non-zero exit status
>
>
>
> > pak::pkg_install("tibble")
>
> Error in load_private_package("cli") :
>
>   Cannot load cli from the private library
>
>
>
> > pak::pkg_install("tidyverse/tibble")
>
> Error in load_private_package("cli") :
>
>   Cannot load cli from the private library
>
>
>
> > pkg_install("tibble")
>
> Error in pkg_install("tibble") : could not find function "pkg_install"
>
>
>
> > install.packages("D:/Programlar/ggplot2/ggplot2_3.4.2.zip", repos = NULL,
> type = "win.binary")
>
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> package ?ggplot2? successfully unpacked and MD5 sums checked
>
>
>
> Kind Regards
>
>
> Murat Delman, Ph.D.
> Izmir Institute of Technology
> Integrated Research Centers
>
> [image: Mailtrack]
> <https://mailtrack.io?utm_source=gmail&utm_medium=signature&utm_campaign=signaturevirality11&>
> Sender
> notified by
> Mailtrack
> <https://mailtrack.io?utm_source=gmail&utm_medium=signature&utm_campaign=signaturevirality11&>
> 08/04/23,
> 10:12:50 AM
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Fri Aug  4 20:12:22 2023
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Fri, 4 Aug 2023 19:12:22 +0100
Subject: [R] Multiply
In-Reply-To: <CAJOiR6aEfU-HrS9Q_ufCxubLOMt01fa7q1oV2fZ-rsmrygiOOw@mail.gmail.com>
References: <CAJOiR6Y-qZL=N8Cb_VZwsRdxzDhkUG8+uhJOvvZB=3YC4TA1VA@mail.gmail.com>
 <006f01d9c6ec$9f005180$dd00f480$@gmail.com>
 <CAJOiR6aEfU-HrS9Q_ufCxubLOMt01fa7q1oV2fZ-rsmrygiOOw@mail.gmail.com>
Message-ID: <9eb6d5d2-54f5-3a89-6aaf-ecb1b7a7b5a0@sapo.pt>

?s 19:03 de 04/08/2023, Val escreveu:
> Thank you,  Avi and Ivan.  Worked for this particular Example.
> 
> Yes, I am looking for something with a more general purpose.
> I think Ivan's suggestion works for this.
> 
> multiplication=as.matrix(dat1[,-1]) %*% as.matrix(dat2[match(dat1[,1],
> dat2[,1]),-1])
> Res=data.frame(ID = dat1[,1], Index = multiplication)
> 
> On Fri, Aug 4, 2023 at 10:59?AM <avi.e.gross at gmail.com> wrote:
>>
>> Val,
>>
>> A data.frame is not quite the same thing as a matrix.
>>
>> But as long as everything is numeric, you can convert both data.frames to
>> matrices, perform the computations needed and, if you want, convert it back
>> into a data.frame.
>>
>> BUT it must be all numeric and you violate that requirement by having a
>> character column for ID. You need to eliminate that temporarily:
>>
>> dat1 <- read.table(text="ID, x, y, z
>>   A, 10,  34, 12
>>   B, 25,  42, 18
>>   C, 14,  20,  8 ",sep=",",header=TRUE,stringsAsFactors=F)
>>
>> mat1 <- as.matrix(dat1[,2:4])
>>
>> The result is:
>>
>>> mat1
>>        x  y  z
>> [1,] 10 34 12
>> [2,] 25 42 18
>> [3,] 14 20  8
>>
>> Now do the second matrix, perhaps in one step:
>>
>> mat2 <- as.matrix(read.table(text="ID, weight, weiht2
>>   A,  0.25, 0.35
>>   B,  0.42, 0.52
>>   C,  0.65, 0.75",sep=",",header=TRUE,stringsAsFactors=F)[,2:3])
>>
>>
>> Do note some people use read.csv() instead of read.table, albeit it simply
>> calls read.table after setting some parameters like the comma.
>>
>> The result is what you asked for, including spelling weight wrong once.:
>>
>>> mat2
>>       weight weiht2
>> [1,]   0.25   0.35
>> [2,]   0.42   0.52
>> [3,]   0.65   0.75
>>
>> Now you wanted to multiply as in matrix multiplication.
>>
>>> mat1 %*% mat2
>>       weight weiht2
>> [1,]  24.58  30.18
>> [2,]  35.59  44.09
>> [3,]  17.10  21.30
>>
>> Of course, you wanted different names for the columns and you can do that
>> easily enough:
>>
>> result <- mat1 %*% mat2
>>
>> colnames(result) <- c("index1", "index2")
>>
>>
>> But this is missing something:
>>
>>> result
>>       index1 index2
>> [1,]  24.58  30.18
>> [2,]  35.59  44.09
>> [3,]  17.10  21.30
>>
>> Do you want a column of ID numbers on the left? If numeric, you can keep it
>> in a matrix in one of many ways but if you want to go back to the data.frame
>> format and re-use the ID numbers, there are again MANY ways. But note mixing
>> characters and numbers can inadvertently convert everything to characters.
>>
>> Here is one solution. Not the only one nor the best one but reasonable:
>>
>> recombined <- data.frame(index=dat1$ID,
>>                           index1=result[,1],
>>                           index2=result[,2])
>>
>>
>>> recombined
>>    index index1 index2
>> 1     A  24.58  30.18
>> 2     B  35.59  44.09
>> 3     C  17.10  21.30
>>
>> If for some reason you need a more general purpose way to do this for
>> arbitrary conformant matrices, you can write a function that does this in a
>> more general way but perhaps a better idea might be a way to store your
>> matrices in files in a way that can be read back in directly or to not
>> include indices as character columns but as row names.
>>
>>
>>
>>
>>
>>
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Val
>> Sent: Friday, August 4, 2023 10:54 AM
>> To: r-help at R-project.org (r-help at r-project.org) <r-help at r-project.org>
>> Subject: [R] Multiply
>>
>> Hi all,
>>
>> I want to multiply two  data frames as shown below,
>>
>> dat1 <-read.table(text="ID, x, y, z
>>   A, 10,  34, 12
>>   B, 25,  42, 18
>>   C, 14,  20,  8 ",sep=",",header=TRUE,stringsAsFactors=F)
>>
>> dat2 <-read.table(text="ID, weight, weiht2
>>   A,  0.25, 0.35
>>   B,  0.42, 0.52
>>   C,  0.65, 0.75",sep=",",header=TRUE,stringsAsFactors=F)
>>
>> Desired result
>>
>> ID  Index1 Index2
>> 1  A 24.58 30.18
>> 2  B 35.59 44.09
>> 3  C 17.10 21.30
>>
>> Here is my attempt,  but did not work
>>
>> dat3 <- data.frame(ID = dat1[,1], Index = apply(dat1[,-1], 1, FUN=
>> function(x) {sum(x*dat2[,2:ncol(dat2)])} ), stringsAsFactors=F)
>>
>>
>> Any help?
>>
>> Thank you,
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Slightly simpler:



multiplication <- as.matrix(dat1[,-1]) %*% 
as.matrix(dat2[match(dat1[,1], dat2[,1]),-1])
Res <- data.frame(ID = dat1[,1], Index = multiplication)

# this is what I find simpler
# the method being called is cbind.data.frame
Res2 <- cbind(dat1[1], Index = multiplication)

identical(Res, Res2)
#> [1] TRUE


Hope this helps,

Rui Barradas


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Aug  4 20:58:01 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 4 Aug 2023 21:58:01 +0300
Subject: [R] Technical Help Request for "Version Differences" (i.e.,
 CYTOFKIT package)
In-Reply-To: <146822026.2931556.1691133058051.JavaMail.zimbra@iyte.edu.tr>
References: <146822026.2931556.1691133058051.JavaMail.zimbra@iyte.edu.tr>
Message-ID: <20230804215801.5e7a5a12@parabola>

Dear Murat Delman,

Both your messages came through, and I'm replying to the one that was
the first chronologically.

I have taken a look at the cytofkit package. It used to be a
Bioconductor package, but was removed, most likely because it failed to
build and pass a check: https://support.bioconductor.org/p/128865

Installing cytofkit will involve spending a lot of effort: you need an
old Bioconductor release, hence an old version of R, hence likely old,
archived version of the dependencies, and to build the packages from
source because CRAN doesn't serve Windows binaries for old versions of
R. In this light, may I suggest looking for alternative packages that
currently pass their checks on CRAN or Bioconductor? That support
thread above has some suggestions, though I lack the expertise to judge
them. In particular, the cytofWorkflow vignette and the scDataviz
package look promising.

For "basic R literacy", I can recommend this free book by A. Shipunov:
http://web.archive.org/web/20230501112111/http://ashipunov.info/shipunov/school/biol_240/en/visual_statistics.pdf

In order to install packages from the current release of Bioconductor,
follow the guide at https://bioconductor.org/install/.

Good luck!

-- 
Best regards,
Ivan


From @vi@e@gross m@iii@g oii gm@ii@com  Sat Aug  5 01:45:22 2023
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Fri, 4 Aug 2023 19:45:22 -0400
Subject: [R] Multiply
In-Reply-To: <CAJOiR6aEfU-HrS9Q_ufCxubLOMt01fa7q1oV2fZ-rsmrygiOOw@mail.gmail.com>
References: <CAJOiR6Y-qZL=N8Cb_VZwsRdxzDhkUG8+uhJOvvZB=3YC4TA1VA@mail.gmail.com>
 <006f01d9c6ec$9f005180$dd00f480$@gmail.com>
 <CAJOiR6aEfU-HrS9Q_ufCxubLOMt01fa7q1oV2fZ-rsmrygiOOw@mail.gmail.com>
Message-ID: <017301d9c72d$bc6ce850$3546b8f0$@gmail.com>

[See the end for an interesting twist on moving a column to row.names.]

Yes, many ways to do things exist but it may make sense to ask for what the user/OP really wants. Sometimes the effort to make a brief example obscures things.

Was there actually any need to read in a file containing comma-separated values? Did it have to include one, or perhaps more, non-numeric columns? Was the ID column guaranteed to exist and be named ID or just be the first column? Is any error checking needed?

So assuming we read in two data structures into data.frames called A and B to be unoriginal. A wider approach might be to split A into A.text and A.numeric by checking which columns test as numeric (meaning is.numeric() return TRUE) and which can be text or logical or anything else. Note that complex is not considered numeric if that matters.

You might then count the number of rows and columns of A.numeric and set A.text Aside for now. 

You then get B and it seems you can throw away any non-numeric columns. The resulting numeric columns can be in B.numeric.
The number of rows and columns of what remains need to conform to the dimensions of A in the sense that if a is M rows by N columns, then B must be N x anything and the result of the multiplication is M x anything. If the condition is not met, you need to fail gracefully.

You may also want to decide what to do with data that came with things like NA content. Or, if your design allows content that can be converted to numeric, check and make any conversions.

Then you can convert the data into matrices, perform the matrix multiplication and optionally restore any column names you want along with any of the non-numeric columns you held back and note there could possible be more than one. Obviously, getting multiple ones in the original order is harder.

I am not sure if you are interested in another tweak. For some purposes, rownames() and colnames() make sense instead of additional rows or columns.

A line of code like this applied to a data.frame will copy your id column as a rowname then remove the actual ID column.

> dat1
  ID  x  y  z
1  A 10 34 12
2  B 25 42 18
3  C 14 20  8
> rownames(dat1) <- dat1$ID
> dat1$ID <- NULL
> dat1
    x  y  z
 A 10 34 12
 B 25 42 18
 C 14 20  8

> result <- as.matrix(dat1) %*% mat2
> result
   weight weiht2
 A  24.58  30.18
 B  35.59  44.09
 C  17.10  21.30

There are functions (perhaps in packages, with names like column_to_rownames() in the tidyverse packages that can be used and you can also reverse the process.

Just some thoughts. The point is that it is often wiser to not mix text with numeric and rownames and colnames provide a way to include the text for the purposes you want and not for others where they are in the way. And here is an oddity I found:

> dat2
  ID weight weiht2
1  A   0.25   0.35
2  B   0.42   0.52
3  C   0.65   0.75
> temp <- data.frame(dat2, row.names=1)
> temp
   weight weiht2
 A   0.25   0.35
 B   0.42   0.52
 C   0.65   0.75

As shown, when you create a data.frame you can move any column by NUMBER into rownames. So consider your early code and note read.table supports the option row.names=1 and passes it on so in one step:

> ?read.table
> dat1 <-read.table(text="ID, x, y, z
+ A, 10,  34, 12
+ B, 25,  42, 18
+ C, 14,  20,  8 ",sep=",",header=TRUE,stringsAsFactors=F, row.names=1)
> dat1
   x  y  z
A 10 34 12
B 25 42 18
C 14 20  8

You can make it a matrix immediately:

mat1 <- as.matrix(read.table(
  text = text,
  sep = ",",
  header = TRUE,
  stringsAsFactors = F,
  row.names = 1
))


-----Original Message-----
From: Val <valkremk at gmail.com> 
Sent: Friday, August 4, 2023 2:03 PM
To: avi.e.gross at gmail.com
Cc: r-help at r-project.org
Subject: Re: [R] Multiply

Thank you,  Avi and Ivan.  Worked for this particular Example.

Yes, I am looking for something with a more general purpose.
I think Ivan's suggestion works for this.

multiplication=as.matrix(dat1[,-1]) %*% as.matrix(dat2[match(dat1[,1],
dat2[,1]),-1])
Res=data.frame(ID = dat1[,1], Index = multiplication)

On Fri, Aug 4, 2023 at 10:59?AM <avi.e.gross at gmail.com> wrote:
>
> Val,
>
> A data.frame is not quite the same thing as a matrix.
>
> But as long as everything is numeric, you can convert both data.frames to
> matrices, perform the computations needed and, if you want, convert it back
> into a data.frame.
>
> BUT it must be all numeric and you violate that requirement by having a
> character column for ID. You need to eliminate that temporarily:
>
> dat1 <- read.table(text="ID, x, y, z
>  A, 10,  34, 12
>  B, 25,  42, 18
>  C, 14,  20,  8 ",sep=",",header=TRUE,stringsAsFactors=F)
>
> mat1 <- as.matrix(dat1[,2:4])
>
> The result is:
>
> > mat1
>       x  y  z
> [1,] 10 34 12
> [2,] 25 42 18
> [3,] 14 20  8
>
> Now do the second matrix, perhaps in one step:
>
> mat2 <- as.matrix(read.table(text="ID, weight, weiht2
>  A,  0.25, 0.35
>  B,  0.42, 0.52
>  C,  0.65, 0.75",sep=",",header=TRUE,stringsAsFactors=F)[,2:3])
>
>
> Do note some people use read.csv() instead of read.table, albeit it simply
> calls read.table after setting some parameters like the comma.
>
> The result is what you asked for, including spelling weight wrong once.:
>
> > mat2
>      weight weiht2
> [1,]   0.25   0.35
> [2,]   0.42   0.52
> [3,]   0.65   0.75
>
> Now you wanted to multiply as in matrix multiplication.
>
> > mat1 %*% mat2
>      weight weiht2
> [1,]  24.58  30.18
> [2,]  35.59  44.09
> [3,]  17.10  21.30
>
> Of course, you wanted different names for the columns and you can do that
> easily enough:
>
> result <- mat1 %*% mat2
>
> colnames(result) <- c("index1", "index2")
>
>
> But this is missing something:
>
> > result
>      index1 index2
> [1,]  24.58  30.18
> [2,]  35.59  44.09
> [3,]  17.10  21.30
>
> Do you want a column of ID numbers on the left? If numeric, you can keep it
> in a matrix in one of many ways but if you want to go back to the data.frame
> format and re-use the ID numbers, there are again MANY ways. But note mixing
> characters and numbers can inadvertently convert everything to characters.
>
> Here is one solution. Not the only one nor the best one but reasonable:
>
> recombined <- data.frame(index=dat1$ID,
>                          index1=result[,1],
>                          index2=result[,2])
>
>
> > recombined
>   index index1 index2
> 1     A  24.58  30.18
> 2     B  35.59  44.09
> 3     C  17.10  21.30
>
> If for some reason you need a more general purpose way to do this for
> arbitrary conformant matrices, you can write a function that does this in a
> more general way but perhaps a better idea might be a way to store your
> matrices in files in a way that can be read back in directly or to not
> include indices as character columns but as row names.
>
>
>
>
>
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Val
> Sent: Friday, August 4, 2023 10:54 AM
> To: r-help at R-project.org (r-help at r-project.org) <r-help at r-project.org>
> Subject: [R] Multiply
>
> Hi all,
>
> I want to multiply two  data frames as shown below,
>
> dat1 <-read.table(text="ID, x, y, z
>  A, 10,  34, 12
>  B, 25,  42, 18
>  C, 14,  20,  8 ",sep=",",header=TRUE,stringsAsFactors=F)
>
> dat2 <-read.table(text="ID, weight, weiht2
>  A,  0.25, 0.35
>  B,  0.42, 0.52
>  C,  0.65, 0.75",sep=",",header=TRUE,stringsAsFactors=F)
>
> Desired result
>
> ID  Index1 Index2
> 1  A 24.58 30.18
> 2  B 35.59 44.09
> 3  C 17.10 21.30
>
> Here is my attempt,  but did not work
>
> dat3 <- data.frame(ID = dat1[,1], Index = apply(dat1[,-1], 1, FUN=
> function(x) {sum(x*dat2[,2:ncol(dat2)])} ), stringsAsFactors=F)
>
>
> Any help?
>
> Thank you,
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From @tyen @end|ng |rom ntu@edu@tw  Sun Aug  6 02:11:28 2023
From: @tyen @end|ng |rom ntu@edu@tw (Steven Yen)
Date: Sun, 6 Aug 2023 08:11:28 +0800
Subject: [R] Stacking matrix columns
Message-ID: <c5408792-2ca1-9116-a694-455617277520@ntu.edu.tw>

I wish to stack columns of a matrix into one column. The following 
matrix command does it. Any other ways? Thanks.

 > x<-matrix(1:20,5,4)
 > x
 ???? [,1] [,2] [,3] [,4]
[1,]??? 1??? 6?? 11?? 16
[2,]??? 2??? 7?? 12?? 17
[3,]??? 3??? 8?? 13?? 18
[4,]??? 4??? 9?? 14?? 19
[5,]??? 5?? 10?? 15?? 20

 > matrix(x,ncol=1)
 ????? [,1]
 ?[1,]??? 1
 ?[2,]??? 2
 ?[3,]??? 3
 ?[4,]??? 4
 ?[5,]??? 5
 ?[6,]??? 6
 ?[7,]??? 7
 ?[8,]??? 8
 ?[9,]??? 9
[10,]?? 10
[11,]?? 11
[12,]?? 12
[13,]?? 13
[14,]?? 14
[15,]?? 15
[16,]?? 16
[17,]?? 17
[18,]?? 18
[19,]?? 19
[20,]?? 20
 >


From |kw@|mmo @end|ng |rom gm@||@com  Sun Aug  6 02:15:07 2023
From: |kw@|mmo @end|ng |rom gm@||@com (Iris Simmons)
Date: Sat, 5 Aug 2023 20:15:07 -0400
Subject: [R] Stacking matrix columns
In-Reply-To: <c5408792-2ca1-9116-a694-455617277520@ntu.edu.tw>
References: <c5408792-2ca1-9116-a694-455617277520@ntu.edu.tw>
Message-ID: <CADNULg8AOWx44dLaa1CQy=WPxvGzSNh-LmTK3PGCgT436U7bhg@mail.gmail.com>

You could also do

dim(x) <- c(length(x), 1)

On Sat, Aug 5, 2023, 20:12 Steven Yen <styen at ntu.edu.tw> wrote:

> I wish to stack columns of a matrix into one column. The following
> matrix command does it. Any other ways? Thanks.
>
>  > x<-matrix(1:20,5,4)
>  > x
>       [,1] [,2] [,3] [,4]
> [1,]    1    6   11   16
> [2,]    2    7   12   17
> [3,]    3    8   13   18
> [4,]    4    9   14   19
> [5,]    5   10   15   20
>
>  > matrix(x,ncol=1)
>        [,1]
>   [1,]    1
>   [2,]    2
>   [3,]    3
>   [4,]    4
>   [5,]    5
>   [6,]    6
>   [7,]    7
>   [8,]    8
>   [9,]    9
> [10,]   10
> [11,]   11
> [12,]   12
> [13,]   13
> [14,]   14
> [15,]   15
> [16,]   16
> [17,]   17
> [18,]   18
> [19,]   19
> [20,]   20
>  >
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @vi@e@gross m@iii@g oii gm@ii@com  Sun Aug  6 02:56:06 2023
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Sat, 5 Aug 2023 20:56:06 -0400
Subject: [R] Stacking matrix columns
In-Reply-To: <c5408792-2ca1-9116-a694-455617277520@ntu.edu.tw>
References: <c5408792-2ca1-9116-a694-455617277520@ntu.edu.tw>
Message-ID: <012b01d9c800$c80ef940$582cebc0$@gmail.com>

Steve,

As Iris pointed out, some implementations of a matrix are actually of a vector with special qualities. There are sometimes choices whether to store it a row at a time or a column at a time.

In R, your data consisted of the integers from 1 to 20 and they clearly are stored a column at a time:

> x<-matrix(1:20,5,4)
> 
> x
     [,1] [,2] [,3] [,4]
[1,]    1    6   11   16
[2,]    2    7   12   17
[3,]    3    8   13   18
[4,]    4    9   14   19
[5,]    5   10   15   20

Your method involved creating a second matrix/ But you could as easily ask for a vector that gives you back the info in that order:

> as.vector(x)
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20

Iris mentioned the fact that the version of built-in matrices you are using in R is actually a vector with an attribute:

> attributes(x)
$dim
[1] 5 4

This means that when you try to work with the matrix and ask for x[3,4] it does a calculation on where in the vector to look and since you want column 4, it means three columns with five things are ahead of it meaning 15 items. Then it sees you want the third item in this fourth column so it adds 3 to make 18 and looks at the 18th item in the vector:

> x<-matrix(data=1:20,nrow=5, ncol=4, byrow=TRUE)
> x
     [,1] [,2] [,3] [,4]
[1,]    1    2    3    4
[2,]    5    6    7    8
[3,]    9   10   11   12
[4,]   13   14   15   16
[5,]   17   18   19   20

This is now stored differently:

> x[18]
[1] 12

> as.vector(x)
 [1]  1  5  9 13 17  2  6 10 14 18  3  7 11 15 19  4  8 12 16 20

And just FYI, you can make multidimensional arrays using the array() function that as far as I know are just extensions of the same analysis with a dim attribute containg the dimensions.



> x[3,4]
[1] 18
> x[18]
[1] 18
> as.vector(x)[18]
[1] 18

The latter two approaches get to look at the pure vector implementation. So your data is already in the order you want and it is just a question of how to access it.

Rather than copying the matrix, if not needed for another purpose, changing the attribute lets you reshape it in many ways, including a 2x10 matrix but also into a vertical or horizontal matrix of 1x20 or 20x1. Of course, if you will be passing the object around to places that expect a vector, it would be safer. Inn this case, it does seem like it becomes seen like any vector.

> length(x)
[1] 20
> str(x)
 int [1:5, 1:4] 1 2 3 4 5 6 7 8 9 10 ...

> attr(x, "dim") <- c(length(x), 1)
> dim(x)
[1] 20  1
> str(x)
 int [1:20, 1] 1 2 3 4 5 6 7 8 9 10 ...
> typeof(x)
[1] "integer"

But please note my comments above do not apply the same if you make the matric by rows as in:



-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Steven Yen
Sent: Saturday, August 5, 2023 8:11 PM
To: R-help Mailing List <r-help at r-project.org>
Subject: [R] Stacking matrix columns

I wish to stack columns of a matrix into one column. The following 
matrix command does it. Any other ways? Thanks.

 > x<-matrix(1:20,5,4)
 > x
      [,1] [,2] [,3] [,4]
[1,]    1    6   11   16
[2,]    2    7   12   17
[3,]    3    8   13   18
[4,]    4    9   14   19
[5,]    5   10   15   20

 > matrix(x,ncol=1)
       [,1]
  [1,]    1
  [2,]    2
  [3,]    3
  [4,]    4
  [5,]    5
  [6,]    6
  [7,]    7
  [8,]    8
  [9,]    9
[10,]   10
[11,]   11
[12,]   12
[13,]   13
[14,]   14
[15,]   15
[16,]   16
[17,]   17
[18,]   18
[19,]   19
[20,]   20
 >

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Sun Aug  6 04:05:14 2023
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 5 Aug 2023 19:05:14 -0700
Subject: [R] Stacking matrix columns
In-Reply-To: <CADNULg8AOWx44dLaa1CQy=WPxvGzSNh-LmTK3PGCgT436U7bhg@mail.gmail.com>
References: <c5408792-2ca1-9116-a694-455617277520@ntu.edu.tw>
 <CADNULg8AOWx44dLaa1CQy=WPxvGzSNh-LmTK3PGCgT436U7bhg@mail.gmail.com>
Message-ID: <CAGxFJbQ=s-Ei8o1EkktFSknB7RiwLVj7oxNYYTqJBtn2GYKwHQ@mail.gmail.com>

Or just dim(x) <- NULL.
(as matrices in base R are just vectors with a dim attribute stored in
column major order)

ergo:

> x
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
> x<- 1:20  ## a vector
> is.matrix(x)
[1] FALSE
> dim(x) <- c(5,4)
> is.matrix(x)
[1] TRUE
> attributes(x)
$dim
[1] 5 4

> ## in painful and unnecessary detail as dim() should be used instead
> attr(x, "dim") <- NULL
> is.matrix(x)
[1] FALSE
> x
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20

## well, you get it...

-- Bert

On Sat, Aug 5, 2023 at 5:21?PM Iris Simmons <ikwsimmo at gmail.com> wrote:
>
> You could also do
>
> dim(x) <- c(length(x), 1)
>
> On Sat, Aug 5, 2023, 20:12 Steven Yen <styen at ntu.edu.tw> wrote:
>
> > I wish to stack columns of a matrix into one column. The following
> > matrix command does it. Any other ways? Thanks.
> >
> >  > x<-matrix(1:20,5,4)
> >  > x
> >       [,1] [,2] [,3] [,4]
> > [1,]    1    6   11   16
> > [2,]    2    7   12   17
> > [3,]    3    8   13   18
> > [4,]    4    9   14   19
> > [5,]    5   10   15   20
> >
> >  > matrix(x,ncol=1)
> >        [,1]
> >   [1,]    1
> >   [2,]    2
> >   [3,]    3
> >   [4,]    4
> >   [5,]    5
> >   [6,]    6
> >   [7,]    7
> >   [8,]    8
> >   [9,]    9
> > [10,]   10
> > [11,]   11
> > [12,]   12
> > [13,]   13
> > [14,]   14
> > [15,]   15
> > [16,]   16
> > [17,]   17
> > [18,]   18
> > [19,]   19
> > [20,]   20
> >  >
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From er|cjberger @end|ng |rom gm@||@com  Sun Aug  6 09:33:31 2023
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Sun, 6 Aug 2023 10:33:31 +0300
Subject: [R] Stacking matrix columns
In-Reply-To: <CAGxFJbQ=s-Ei8o1EkktFSknB7RiwLVj7oxNYYTqJBtn2GYKwHQ@mail.gmail.com>
References: <c5408792-2ca1-9116-a694-455617277520@ntu.edu.tw>
 <CADNULg8AOWx44dLaa1CQy=WPxvGzSNh-LmTK3PGCgT436U7bhg@mail.gmail.com>
 <CAGxFJbQ=s-Ei8o1EkktFSknB7RiwLVj7oxNYYTqJBtn2GYKwHQ@mail.gmail.com>
Message-ID: <CAGgJW76at5rM5+2TG5Qq9TyVOacr3996vKLeGgBM4X8zBpkrGw@mail.gmail.com>

Stacking columns of a matrix is a standard operation in multilinear
algebra, usually written as the operator vec().
I checked to see if there is an R package that deals with multilinear
algebra. I found rTensor, which has a function vec().
So, yet another way to accomplish what you want would be:

> library(rTensor)
> vec(as.tensor(x))

Eric


On Sun, Aug 6, 2023 at 5:05?AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> Or just dim(x) <- NULL.
> (as matrices in base R are just vectors with a dim attribute stored in
> column major order)
>
> ergo:
>
> > x
>  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
> > x<- 1:20  ## a vector
> > is.matrix(x)
> [1] FALSE
> > dim(x) <- c(5,4)
> > is.matrix(x)
> [1] TRUE
> > attributes(x)
> $dim
> [1] 5 4
>
> > ## in painful and unnecessary detail as dim() should be used instead
> > attr(x, "dim") <- NULL
> > is.matrix(x)
> [1] FALSE
> > x
>  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
>
> ## well, you get it...
>
> -- Bert
>
> On Sat, Aug 5, 2023 at 5:21?PM Iris Simmons <ikwsimmo at gmail.com> wrote:
> >
> > You could also do
> >
> > dim(x) <- c(length(x), 1)
> >
> > On Sat, Aug 5, 2023, 20:12 Steven Yen <styen at ntu.edu.tw> wrote:
> >
> > > I wish to stack columns of a matrix into one column. The following
> > > matrix command does it. Any other ways? Thanks.
> > >
> > >  > x<-matrix(1:20,5,4)
> > >  > x
> > >       [,1] [,2] [,3] [,4]
> > > [1,]    1    6   11   16
> > > [2,]    2    7   12   17
> > > [3,]    3    8   13   18
> > > [4,]    4    9   14   19
> > > [5,]    5   10   15   20
> > >
> > >  > matrix(x,ncol=1)
> > >        [,1]
> > >   [1,]    1
> > >   [2,]    2
> > >   [3,]    3
> > >   [4,]    4
> > >   [5,]    5
> > >   [6,]    6
> > >   [7,]    7
> > >   [8,]    8
> > >   [9,]    9
> > > [10,]   10
> > > [11,]   11
> > > [12,]   12
> > > [13,]   13
> > > [14,]   14
> > > [15,]   15
> > > [16,]   16
> > > [17,]   17
> > > [18,]   18
> > > [19,]   19
> > > [20,]   20
> > >  >
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide
> > > http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> > >
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @yen04 @end|ng |rom gm@||@com  Sun Aug  6 02:08:25 2023
From: @yen04 @end|ng |rom gm@||@com (Steven Yen)
Date: Sun, 6 Aug 2023 08:08:25 +0800
Subject: [R] Stacking matrix columns
In-Reply-To: <4f0449c3-3a7b-6537-4ba2-a6a1ae78c806@ntu.edu.tw>
References: <4f0449c3-3a7b-6537-4ba2-a6a1ae78c806@ntu.edu.tw>
Message-ID: <91833fc8-646f-45cd-a067-71b947a52aae@gmail.com>

I wish to stack columns of a matrix into one column. The following 
matrix command does it. Any other ways? Thanks.

 > x<-matrix(1:20,5,4)
 > x
 ???? [,1] [,2] [,3] [,4]
[1,]??? 1??? 6?? 11?? 16
[2,]??? 2??? 7?? 12?? 17
[3,]??? 3??? 8?? 13?? 18
[4,]??? 4??? 9?? 14?? 19
[5,]??? 5?? 10?? 15?? 20

 > matrix(x,ncol=1)
 ????? [,1]
 ?[1,]??? 1
 ?[2,]??? 2
 ?[3,]??? 3
 ?[4,]??? 4
 ?[5,]??? 5
 ?[6,]??? 6
 ?[7,]??? 7
 ?[8,]??? 8
 ?[9,]??? 9
[10,]?? 10
[11,]?? 11
[12,]?? 12
[13,]?? 13
[14,]?? 14
[15,]?? 15
[16,]?? 16
[17,]?? 17
[18,]?? 18
[19,]?? 19
[20,]?? 20
 >


From @vi@e@gross m@iii@g oii gm@ii@com  Sun Aug  6 17:16:11 2023
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Sun, 6 Aug 2023 11:16:11 -0400
Subject: [R] Stacking matrix columns
In-Reply-To: <CAGgJW76at5rM5+2TG5Qq9TyVOacr3996vKLeGgBM4X8zBpkrGw@mail.gmail.com>
References: <c5408792-2ca1-9116-a694-455617277520@ntu.edu.tw>
 <CADNULg8AOWx44dLaa1CQy=WPxvGzSNh-LmTK3PGCgT436U7bhg@mail.gmail.com>
 <CAGxFJbQ=s-Ei8o1EkktFSknB7RiwLVj7oxNYYTqJBtn2GYKwHQ@mail.gmail.com>
 <CAGgJW76at5rM5+2TG5Qq9TyVOacr3996vKLeGgBM4X8zBpkrGw@mail.gmail.com>
Message-ID: <002e01d9c878$ef7715d0$ce654170$@gmail.com>

Eric,

I am not sure your solution is particularly economical albeit it works for arbitrary arrays of any dimension, presumably. But it seems to involve converting a matrix to a tensor just to undo it back to a vector. Other solutions offered here, simply manipulate the dim attribute of the data structure.

Of course, the OP may have uses in mind which the package might make easier. We often get fairly specific questions here without the additional context that may help guide a better answer. 

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Eric Berger
Sent: Sunday, August 6, 2023 3:34 AM
To: Bert Gunter <bgunter.4567 at gmail.com>
Cc: R-help Mailing List <r-help at r-project.org>; Steven Yen <styen at ntu.edu.tw>
Subject: Re: [R] Stacking matrix columns

Stacking columns of a matrix is a standard operation in multilinear
algebra, usually written as the operator vec().
I checked to see if there is an R package that deals with multilinear
algebra. I found rTensor, which has a function vec().
So, yet another way to accomplish what you want would be:

> library(rTensor)
> vec(as.tensor(x))

Eric


On Sun, Aug 6, 2023 at 5:05?AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> Or just dim(x) <- NULL.
> (as matrices in base R are just vectors with a dim attribute stored in
> column major order)
>
> ergo:
>
> > x
>  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
> > x<- 1:20  ## a vector
> > is.matrix(x)
> [1] FALSE
> > dim(x) <- c(5,4)
> > is.matrix(x)
> [1] TRUE
> > attributes(x)
> $dim
> [1] 5 4
>
> > ## in painful and unnecessary detail as dim() should be used instead
> > attr(x, "dim") <- NULL
> > is.matrix(x)
> [1] FALSE
> > x
>  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
>
> ## well, you get it...
>
> -- Bert
>
> On Sat, Aug 5, 2023 at 5:21?PM Iris Simmons <ikwsimmo at gmail.com> wrote:
> >
> > You could also do
> >
> > dim(x) <- c(length(x), 1)
> >
> > On Sat, Aug 5, 2023, 20:12 Steven Yen <styen at ntu.edu.tw> wrote:
> >
> > > I wish to stack columns of a matrix into one column. The following
> > > matrix command does it. Any other ways? Thanks.
> > >
> > >  > x<-matrix(1:20,5,4)
> > >  > x
> > >       [,1] [,2] [,3] [,4]
> > > [1,]    1    6   11   16
> > > [2,]    2    7   12   17
> > > [3,]    3    8   13   18
> > > [4,]    4    9   14   19
> > > [5,]    5   10   15   20
> > >
> > >  > matrix(x,ncol=1)
> > >        [,1]
> > >   [1,]    1
> > >   [2,]    2
> > >   [3,]    3
> > >   [4,]    4
> > >   [5,]    5
> > >   [6,]    6
> > >   [7,]    7
> > >   [8,]    8
> > >   [9,]    9
> > > [10,]   10
> > > [11,]   11
> > > [12,]   12
> > > [13,]   13
> > > [14,]   14
> > > [15,]   15
> > > [16,]   16
> > > [17,]   17
> > > [18,]   18
> > > [19,]   19
> > > [20,]   20
> > >  >
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide
> > > http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> > >
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From er|cjberger @end|ng |rom gm@||@com  Sun Aug  6 17:58:37 2023
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Sun, 6 Aug 2023 18:58:37 +0300
Subject: [R] Stacking matrix columns
In-Reply-To: <002e01d9c878$ef7715d0$ce654170$@gmail.com>
References: <c5408792-2ca1-9116-a694-455617277520@ntu.edu.tw>
 <CADNULg8AOWx44dLaa1CQy=WPxvGzSNh-LmTK3PGCgT436U7bhg@mail.gmail.com>
 <CAGxFJbQ=s-Ei8o1EkktFSknB7RiwLVj7oxNYYTqJBtn2GYKwHQ@mail.gmail.com>
 <CAGgJW76at5rM5+2TG5Qq9TyVOacr3996vKLeGgBM4X8zBpkrGw@mail.gmail.com>
 <002e01d9c878$ef7715d0$ce654170$@gmail.com>
Message-ID: <CAGgJW764qg0JkARtQzGY90JkyGaOakXF3gVPMYDNnFs1h5QFFA@mail.gmail.com>

Avi,

I was not trying to provide the most economical solution. I was trying
to anticipate that people (either the OP or others searching for how
to stack columns of a matrix) might be motivated by calculations in
multilinear algebra, in which case they might be interested in the
rTensor package.



On Sun, Aug 6, 2023 at 6:16?PM <avi.e.gross at gmail.com> wrote:
>
> Eric,
>
> I am not sure your solution is particularly economical albeit it works for arbitrary arrays of any dimension, presumably. But it seems to involve converting a matrix to a tensor just to undo it back to a vector. Other solutions offered here, simply manipulate the dim attribute of the data structure.
>
> Of course, the OP may have uses in mind which the package might make easier. We often get fairly specific questions here without the additional context that may help guide a better answer.
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Eric Berger
> Sent: Sunday, August 6, 2023 3:34 AM
> To: Bert Gunter <bgunter.4567 at gmail.com>
> Cc: R-help Mailing List <r-help at r-project.org>; Steven Yen <styen at ntu.edu.tw>
> Subject: Re: [R] Stacking matrix columns
>
> Stacking columns of a matrix is a standard operation in multilinear
> algebra, usually written as the operator vec().
> I checked to see if there is an R package that deals with multilinear
> algebra. I found rTensor, which has a function vec().
> So, yet another way to accomplish what you want would be:
>
> > library(rTensor)
> > vec(as.tensor(x))
>
> Eric
>
>
> On Sun, Aug 6, 2023 at 5:05?AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >
> > Or just dim(x) <- NULL.
> > (as matrices in base R are just vectors with a dim attribute stored in
> > column major order)
> >
> > ergo:
> >
> > > x
> >  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
> > > x<- 1:20  ## a vector
> > > is.matrix(x)
> > [1] FALSE
> > > dim(x) <- c(5,4)
> > > is.matrix(x)
> > [1] TRUE
> > > attributes(x)
> > $dim
> > [1] 5 4
> >
> > > ## in painful and unnecessary detail as dim() should be used instead
> > > attr(x, "dim") <- NULL
> > > is.matrix(x)
> > [1] FALSE
> > > x
> >  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
> >
> > ## well, you get it...
> >
> > -- Bert
> >
> > On Sat, Aug 5, 2023 at 5:21?PM Iris Simmons <ikwsimmo at gmail.com> wrote:
> > >
> > > You could also do
> > >
> > > dim(x) <- c(length(x), 1)
> > >
> > > On Sat, Aug 5, 2023, 20:12 Steven Yen <styen at ntu.edu.tw> wrote:
> > >
> > > > I wish to stack columns of a matrix into one column. The following
> > > > matrix command does it. Any other ways? Thanks.
> > > >
> > > >  > x<-matrix(1:20,5,4)
> > > >  > x
> > > >       [,1] [,2] [,3] [,4]
> > > > [1,]    1    6   11   16
> > > > [2,]    2    7   12   17
> > > > [3,]    3    8   13   18
> > > > [4,]    4    9   14   19
> > > > [5,]    5   10   15   20
> > > >
> > > >  > matrix(x,ncol=1)
> > > >        [,1]
> > > >   [1,]    1
> > > >   [2,]    2
> > > >   [3,]    3
> > > >   [4,]    4
> > > >   [5,]    5
> > > >   [6,]    6
> > > >   [7,]    7
> > > >   [8,]    8
> > > >   [9,]    9
> > > > [10,]   10
> > > > [11,]   11
> > > > [12,]   12
> > > > [13,]   13
> > > > [14,]   14
> > > > [15,]   15
> > > > [16,]   16
> > > > [17,]   17
> > > > [18,]   18
> > > > [19,]   19
> > > > [20,]   20
> > > >  >
> > > >
> > > > ______________________________________________
> > > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > > PLEASE do read the posting guide
> > > > http://www.R-project.org/posting-guide.html
> > > > and provide commented, minimal, self-contained, reproducible code.
> > > >
> > >
> > >         [[alternative HTML version deleted]]
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From @vi@e@gross m@iii@g oii gm@ii@com  Sun Aug  6 18:31:32 2023
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Sun, 6 Aug 2023 12:31:32 -0400
Subject: [R] Stacking matrix columns
In-Reply-To: <CAGgJW764qg0JkARtQzGY90JkyGaOakXF3gVPMYDNnFs1h5QFFA@mail.gmail.com>
References: <c5408792-2ca1-9116-a694-455617277520@ntu.edu.tw>
 <CADNULg8AOWx44dLaa1CQy=WPxvGzSNh-LmTK3PGCgT436U7bhg@mail.gmail.com>
 <CAGxFJbQ=s-Ei8o1EkktFSknB7RiwLVj7oxNYYTqJBtn2GYKwHQ@mail.gmail.com>
 <CAGgJW76at5rM5+2TG5Qq9TyVOacr3996vKLeGgBM4X8zBpkrGw@mail.gmail.com>
 <002e01d9c878$ef7715d0$ce654170$@gmail.com>
 <CAGgJW764qg0JkARtQzGY90JkyGaOakXF3gVPMYDNnFs1h5QFFA@mail.gmail.com>
Message-ID: <004f01d9c883$75b0c3d0$61124b70$@gmail.com>

Eric,

I fully agreed with you that anyone doing serious work in various projects such as machine learning that make heavy use of mathematical data structures  would do well to find some decent well designed and possibly efficient packages to do much of the work rather than re-inventing their own way. As you note, it can be quite common to do things like flatten a matrix (or higher order array) into a vector and do tasks like image recognition using the vector form. 

Mind you, there are other packages that might be a better entry point than rTensor and which incorporate that package or similar ones for the user but supply other high-level ways to do things like set up neural networks. 

I think the primary focus of this group has been to deal with how to do things within a main R distribution and when people start suggesting ways using other packages, such as in the tidyverse, that not everyone knows or uses, then there is sometimes feedback suggesting a return to more standard topics. Personally, I am happy to look at any well-known and appreciated packages even if maintained by another company as long as it helps get work done easily. 

I downloaded rTensor just to take a look and see how it implements vec():

> vec
nonstandardGenericFunction for "vec" defined from package "rTensor"

function (tnsr) 
{
    standardGeneric("vec")
}

So, no, they do not directly use the trick of setting the dim attribute and that may be because they are not operating on a naked matrix/vector but on an enhanced version that wraps it as a tensor. 

I experimented with making a small matrix and calling as.tensor() on it and it is quite a bit more complex:

> attributes(mymat)
$dim
[1] 3 4

> attributes(mytens)
$num_modes
[1] 2

$modes
[1] 3 4

$data
     [,1] [,2] [,3] [,4]
[1,]    1    4    7   10
[2,]    2    5    8   11
[3,]    3    6    9   12

$class
[1] "Tensor"
attr(,"package")
[1] "rTensor"

This makes sense given that it has to store something more complex. Mind you, an R array does it simpler. I am confident this design has advantages for how the rTensor package does many other activities. It is more than is needed if the OP really has a simple case use.

I do note the vec() function produces the same result as one of the mentioned solutions of setting the dim attribute to NULL. 

It would not surprise me if other packages like TensorFlow or ones built on top of it like Keras, also have their own ways to do this simple task. The OP may want to choose a specific package instead, or as well, for meeting their other needs.

-----Original Message-----
From: Eric Berger <ericjberger at gmail.com> 
Sent: Sunday, August 6, 2023 11:59 AM
To: avi.e.gross at gmail.com
Cc: R-help Mailing List <r-help at r-project.org>
Subject: Re: [R] Stacking matrix columns

Avi,

I was not trying to provide the most economical solution. I was trying
to anticipate that people (either the OP or others searching for how
to stack columns of a matrix) might be motivated by calculations in
multilinear algebra, in which case they might be interested in the
rTensor package.


On Sun, Aug 6, 2023 at 6:16?PM <avi.e.gross at gmail.com> wrote:
>
> Eric,
>
> I am not sure your solution is particularly economical albeit it works for arbitrary arrays of any dimension, presumably. But it seems to involve converting a matrix to a tensor just to undo it back to a vector. Other solutions offered here, simply manipulate the dim attribute of the data structure.
>
> Of course, the OP may have uses in mind which the package might make easier. We often get fairly specific questions here without the additional context that may help guide a better answer.
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Eric Berger
> Sent: Sunday, August 6, 2023 3:34 AM
> To: Bert Gunter <bgunter.4567 at gmail.com>
> Cc: R-help Mailing List <r-help at r-project.org>; Steven Yen <styen at ntu.edu.tw>
> Subject: Re: [R] Stacking matrix columns
>
> Stacking columns of a matrix is a standard operation in multilinear
> algebra, usually written as the operator vec().
> I checked to see if there is an R package that deals with multilinear
> algebra. I found rTensor, which has a function vec().
> So, yet another way to accomplish what you want would be:
>
> > library(rTensor)
> > vec(as.tensor(x))
>
> Eric
>
>
> On Sun, Aug 6, 2023 at 5:05?AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >
> > Or just dim(x) <- NULL.
> > (as matrices in base R are just vectors with a dim attribute stored in
> > column major order)
> >
> > ergo:
> >
> > > x
> >  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
> > > x<- 1:20  ## a vector
> > > is.matrix(x)
> > [1] FALSE
> > > dim(x) <- c(5,4)
> > > is.matrix(x)
> > [1] TRUE
> > > attributes(x)
> > $dim
> > [1] 5 4
> >
> > > ## in painful and unnecessary detail as dim() should be used instead
> > > attr(x, "dim") <- NULL
> > > is.matrix(x)
> > [1] FALSE
> > > x
> >  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
> >
> > ## well, you get it...
> >
> > -- Bert
> >
> > On Sat, Aug 5, 2023 at 5:21?PM Iris Simmons <ikwsimmo at gmail.com> wrote:
> > >
> > > You could also do
> > >
> > > dim(x) <- c(length(x), 1)
> > >
> > > On Sat, Aug 5, 2023, 20:12 Steven Yen <styen at ntu.edu.tw> wrote:
> > >
> > > > I wish to stack columns of a matrix into one column. The following
> > > > matrix command does it. Any other ways? Thanks.
> > > >
> > > >  > x<-matrix(1:20,5,4)
> > > >  > x
> > > >       [,1] [,2] [,3] [,4]
> > > > [1,]    1    6   11   16
> > > > [2,]    2    7   12   17
> > > > [3,]    3    8   13   18
> > > > [4,]    4    9   14   19
> > > > [5,]    5   10   15   20
> > > >
> > > >  > matrix(x,ncol=1)
> > > >        [,1]
> > > >   [1,]    1
> > > >   [2,]    2
> > > >   [3,]    3
> > > >   [4,]    4
> > > >   [5,]    5
> > > >   [6,]    6
> > > >   [7,]    7
> > > >   [8,]    8
> > > >   [9,]    9
> > > > [10,]   10
> > > > [11,]   11
> > > > [12,]   12
> > > > [13,]   13
> > > > [14,]   14
> > > > [15,]   15
> > > > [16,]   16
> > > > [17,]   17
> > > > [18,]   18
> > > > [19,]   19
> > > > [20,]   20
> > > >  >
> > > >
> > > > ______________________________________________
> > > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > > PLEASE do read the posting guide
> > > > http://www.R-project.org/posting-guide.html
> > > > and provide commented, minimal, self-contained, reproducible code.
> > > >
> > >
> > >         [[alternative HTML version deleted]]
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From @vi@e@gross m@iii@g oii gm@ii@com  Sun Aug  6 19:36:01 2023
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Sun, 6 Aug 2023 13:36:01 -0400
Subject: [R] Stacking matrix columns
In-Reply-To: <91833fc8-646f-45cd-a067-71b947a52aae@gmail.com>
References: <4f0449c3-3a7b-6537-4ba2-a6a1ae78c806@ntu.edu.tw>
 <91833fc8-646f-45cd-a067-71b947a52aae@gmail.com>
Message-ID: <005501d9c88c$78490bd0$68db2370$@gmail.com>

Based on a private communication, it sounds like Steven is asking the question again because he wants a different solution that may be the way this might be done in another language. I think he wants to use loops explicitly and I suspect this may be along the lines of a homework problem for him.

R has loops and if you loop over some variable moving "col" from 1 to the number of columns, then if your matrix is called "mat" you can use mat[,col] to grab a whole column at a time and concatenate the results gradually into one longer vector.

If you want a more loopy solution, simply reserve a vector big enough to hold an M by N matric (size is M*N) and loop over both "row" and "col" and keep adding mat[row,col] to your growing vector.

As stated, this is not the way many people think in R, especially those of us who know a matrix is just a vector with a bonus.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Steven Yen
Sent: Saturday, August 5, 2023 8:08 PM
To: R-help Mailing List <r-help at r-project.org>
Subject: [R] Stacking matrix columns

I wish to stack columns of a matrix into one column. The following 
matrix command does it. Any other ways? Thanks.

 > x<-matrix(1:20,5,4)
 > x
      [,1] [,2] [,3] [,4]
[1,]    1    6   11   16
[2,]    2    7   12   17
[3,]    3    8   13   18
[4,]    4    9   14   19
[5,]    5   10   15   20

 > matrix(x,ncol=1)
       [,1]
  [1,]    1
  [2,]    2
  [3,]    3
  [4,]    4
  [5,]    5
  [6,]    6
  [7,]    7
  [8,]    8
  [9,]    9
[10,]   10
[11,]   11
[12,]   12
[13,]   13
[14,]   14
[15,]   15
[16,]   16
[17,]   17
[18,]   18
[19,]   19
[20,]   20
 >

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Mon Aug  7 01:36:40 2023
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Mon, 7 Aug 2023 00:36:40 +0100
Subject: [R] Stacking matrix columns
In-Reply-To: <CADNULg8AOWx44dLaa1CQy=WPxvGzSNh-LmTK3PGCgT436U7bhg@mail.gmail.com>
References: <c5408792-2ca1-9116-a694-455617277520@ntu.edu.tw>
 <CADNULg8AOWx44dLaa1CQy=WPxvGzSNh-LmTK3PGCgT436U7bhg@mail.gmail.com>
Message-ID: <eee64398-c355-1bf7-c7a3-42e2fdf3b4ba@sapo.pt>

?s 01:15 de 06/08/2023, Iris Simmons escreveu:
> You could also do
> 
> dim(x) <- c(length(x), 1)
> 
> On Sat, Aug 5, 2023, 20:12 Steven Yen <styen at ntu.edu.tw> wrote:
> 
>> I wish to stack columns of a matrix into one column. The following
>> matrix command does it. Any other ways? Thanks.
>>
>>   > x<-matrix(1:20,5,4)
>>   > x
>>        [,1] [,2] [,3] [,4]
>> [1,]    1    6   11   16
>> [2,]    2    7   12   17
>> [3,]    3    8   13   18
>> [4,]    4    9   14   19
>> [5,]    5   10   15   20
>>
>>   > matrix(x,ncol=1)
>>         [,1]
>>    [1,]    1
>>    [2,]    2
>>    [3,]    3
>>    [4,]    4
>>    [5,]    5
>>    [6,]    6
>>    [7,]    7
>>    [8,]    8
>>    [9,]    9
>> [10,]   10
>> [11,]   11
>> [12,]   12
>> [13,]   13
>> [14,]   14
>> [15,]   15
>> [16,]   16
>> [17,]   17
>> [18,]   18
>> [19,]   19
>> [20,]   20
>>   >
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Yet another solution.


t(t(c(x)))

or

x |> c() |> t() |> t()


At first I liked it but it's the slowest of the three, OP's, Iris' (the 
fastest).

Hope this helps,

Rui Barradas


From tebert @end|ng |rom u||@edu  Mon Aug  7 05:06:14 2023
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Mon, 7 Aug 2023 03:06:14 +0000
Subject: [R] Stacking matrix columns
In-Reply-To: <eee64398-c355-1bf7-c7a3-42e2fdf3b4ba@sapo.pt>
References: <c5408792-2ca1-9116-a694-455617277520@ntu.edu.tw>
 <CADNULg8AOWx44dLaa1CQy=WPxvGzSNh-LmTK3PGCgT436U7bhg@mail.gmail.com>
 <eee64398-c355-1bf7-c7a3-42e2fdf3b4ba@sapo.pt>
Message-ID: <CH3PR22MB4514EFEA2E16C30B9D851D5FCF0CA@CH3PR22MB4514.namprd22.prod.outlook.com>

You could use a for loop in a brute force approach.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Rui Barradas
Sent: Sunday, August 6, 2023 7:37 PM
To: Iris Simmons <ikwsimmo at gmail.com>; Steven Yen <styen at ntu.edu.tw>
Cc: R-help Mailing List <r-help at r-project.org>
Subject: Re: [R] Stacking matrix columns

[External Email]

?s 01:15 de 06/08/2023, Iris Simmons escreveu:
> You could also do
>
> dim(x) <- c(length(x), 1)
>
> On Sat, Aug 5, 2023, 20:12 Steven Yen <styen at ntu.edu.tw> wrote:
>
>> I wish to stack columns of a matrix into one column. The following
>> matrix command does it. Any other ways? Thanks.
>>
>>   > x<-matrix(1:20,5,4)
>>   > x
>>        [,1] [,2] [,3] [,4]
>> [1,]    1    6   11   16
>> [2,]    2    7   12   17
>> [3,]    3    8   13   18
>> [4,]    4    9   14   19
>> [5,]    5   10   15   20
>>
>>   > matrix(x,ncol=1)
>>         [,1]
>>    [1,]    1
>>    [2,]    2
>>    [3,]    3
>>    [4,]    4
>>    [5,]    5
>>    [6,]    6
>>    [7,]    7
>>    [8,]    8
>>    [9,]    9
>> [10,]   10
>> [11,]   11
>> [12,]   12
>> [13,]   13
>> [14,]   14
>> [15,]   15
>> [16,]   16
>> [17,]   17
>> [18,]   18
>> [19,]   19
>> [20,]   20
>>   >
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://sta/
>> t.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&data=05%7C01%7Ctebert%40ufl.e
>> du%7C0777cc9a4f7b4d06730008db96d60c04%7C0d4da0f84a314d76ace60a62331e1
>> b84%7C0%7C0%7C638269618308876684%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4w
>> LjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7
>> C&sdata=SuBbb9Zv2Zodb1p2Urk4a8yl%2FsGNfxUDxB7MqFlaTZc%3D&reserved=0
>> PLEASE do read the posting guide
>> http://www/.
>> r-project.org%2Fposting-guide.html&data=05%7C01%7Ctebert%40ufl.edu%7C
>> 0777cc9a4f7b4d06730008db96d60c04%7C0d4da0f84a314d76ace60a62331e1b84%7
>> C0%7C0%7C638269618308876684%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwM
>> DAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sda
>> ta=usT0%2FPcAyZZsp7IorVV31xXBqlMvH6tO3758UmKja44%3D&reserved=0
>> and provide commented, minimal, self-contained, reproducible code.
>>
>
>       [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat/
> .ethz.ch%2Fmailman%2Flistinfo%2Fr-help&data=05%7C01%7Ctebert%40ufl.edu
> %7C0777cc9a4f7b4d06730008db96d60c04%7C0d4da0f84a314d76ace60a62331e1b84
> %7C0%7C0%7C638269618308876684%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAw
> MDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sda
> ta=SuBbb9Zv2Zodb1p2Urk4a8yl%2FsGNfxUDxB7MqFlaTZc%3D&reserved=0
> PLEASE do read the posting guide
> http://www.r/
> -project.org%2Fposting-guide.html&data=05%7C01%7Ctebert%40ufl.edu%7C07
> 77cc9a4f7b4d06730008db96d60c04%7C0d4da0f84a314d76ace60a62331e1b84%7C0%
> 7C0%7C638269618308876684%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiL
> CJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=us
> T0%2FPcAyZZsp7IorVV31xXBqlMvH6tO3758UmKja44%3D&reserved=0
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Yet another solution.


t(t(c(x)))

or

x |> c() |> t() |> t()


At first I liked it but it's the slowest of the three, OP's, Iris' (the fastest).

Hope this helps,

Rui Barradas

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.r-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From @vi@e@gross m@iii@g oii gm@ii@com  Mon Aug  7 07:28:07 2023
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Mon, 7 Aug 2023 01:28:07 -0400
Subject: [R] Stacking matrix columns
In-Reply-To: <CH3PR22MB4514EFEA2E16C30B9D851D5FCF0CA@CH3PR22MB4514.namprd22.prod.outlook.com>
References: <c5408792-2ca1-9116-a694-455617277520@ntu.edu.tw>
 <CADNULg8AOWx44dLaa1CQy=WPxvGzSNh-LmTK3PGCgT436U7bhg@mail.gmail.com>
 <eee64398-c355-1bf7-c7a3-42e2fdf3b4ba@sapo.pt>
 <CH3PR22MB4514EFEA2E16C30B9D851D5FCF0CA@CH3PR22MB4514.namprd22.prod.outlook.com>
Message-ID: <011e01d9c8ef$f30c0350$d92409f0$@gmail.com>

This topic is getting almost funny as there are an indefinite ever-sillier
set of ways to perform the action and even more if you include packages like
purr.

If mymat is a matrix, several variants work such as:

> mymat
     [,1] [,2] [,3] [,4]
[1,]    1    4    7   10
[2,]    2    5    8   11
[3,]    3    6    9   12
> unlist(as.list(mymat))
 [1]  1  2  3  4  5  6  7  8  9 10 11 12
  1   2   3   4   5   6   7   8   9  10  11  12 
> as.vector(unlist(as.data.frame(mymat)))
 [1]  1  2  3  4  5  6  7  8  9 10 11 12

But as noted repeatedly, since underneath it all, mymat is a vector with a
dim attribute, the trivial solution is to set that to NULL or make it 1-D so
the internal algorithm works.

Still, if brute force programming as is done in earlier languages is
important to someone, and you do not want to do it in a language like C,
this would work too.


You could use a for loop in a brute force approach. Here is an example of a
function that I think does what you want and accepts not just matrices (2D
only, no arrays) of any kind but also data.frame or tibble objects as well
as row or column vectors..

mat2vec <- function(mat) {
  # Accept a matrix of any type and return it as
  # a vector stacked by columns.
  
  # Do it the dumb way for illustration.
  
  # If fed a data.frame or tibble, convert it to a matrix first.
  # And handle row or column vectors
  if (is.data.frame(mat)) mat <- as.matrix(mat)
  if (is.vector(mat)) mat <- as.matrix(mat)
  
  # Calculate the rows and columns and the typeof
  # to initialize a vector to hold the result.
  rows <- dim(mat)[1L]
  cols <- dim(mat)[2L]
  type <- typeof(mat)
  result <- vector(length=rows*cols, mode=type)
  
  index <- 1
  
  # Double loop to laboriously copy the items to the result
  
  for (col in 1:cols) {
    for (row in 1:rows) {
      result[index] <- mat[row, col]
      index <- index + 1
    } # end inner loop on rows
  } # end outer loop on cols
  
  return (result)
} # end function daffynition mat2vec

Checking if it works on many cases:

> mymat
     [,1] [,2] [,3] [,4]
[1,]    1    4    7   10
[2,]    2    5    8   11
[3,]    3    6    9   12
> mat2vec(mymat)
 [1]  1  2  3  4  5  6  7  8  9 10 11 12

> mydf
  V1 V2 V3 V4
1  1  4  7 10
2  2  5  8 11
3  3  6  9 12
> mat2vec(mydf)
 [1]  1  2  3  4  5  6  7  8  9 10 11 12

> mytib
# A tibble: 3 ? 4
     V1    V2    V3    V4
  <int> <int> <int> <int>
1     1     4     7    10
2     2     5     8    11
3     3     6     9    12
> mat2vec(mytib)
 [1]  1  2  3  4  5  6  7  8  9 10 11 12

> myboolmat <- mymat <= 5
> myboolmat
     [,1]  [,2]  [,3]  [,4]
[1,] TRUE  TRUE FALSE FALSE
[2,] TRUE  TRUE FALSE FALSE
[3,] TRUE FALSE FALSE FALSE
> mat2vec(myboolmat)
 [1]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE

> mypi <- pi * mymat
> mat2vec(mypi)
 [1]  3.141593  6.283185  9.424778 12.566371 15.707963 18.849556 21.991149
25.132741 28.274334 31.415927
[11] 34.557519 37.699112

> myletters
     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
[1,] "A"  "E"  "I"  "M"  "Q"  "U"  "Y"  "c"  "g"  "k"   "o"   "s"   "w"  
[2,] "B"  "F"  "J"  "N"  "R"  "V"  "Z"  "d"  "h"  "l"   "p"   "t"   "x"  
[3,] "C"  "G"  "K"  "O"  "S"  "W"  "a"  "e"  "i"  "m"   "q"   "u"   "y"  
[4,] "D"  "H"  "L"  "P"  "T"  "X"  "b"  "f"  "j"  "n"   "r"   "v"   "z"  
> mat2vec(myletters)
 [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L" "M" "N" "O" "P" "Q" "R"
"S" "T" "U" "V" "W" "X" "Y" "Z" "a"
[28] "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n" "o" "p" "q" "r" "s"
"t" "u" "v" "w" "x" "y" "z"

> myNA <- matrix(c(NA, Inf, 0), 4, 6)
> myNA
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]   NA  Inf    0   NA  Inf    0
[2,]  Inf    0   NA  Inf    0   NA
[3,]    0   NA  Inf    0   NA  Inf
[4,]   NA  Inf    0   NA  Inf    0
> mat2vec(myNA)
 [1]  NA Inf   0  NA Inf   0  NA Inf   0  NA Inf   0  NA Inf   0
[16]  NA Inf   0  NA Inf   0  NA Inf   0

> myvec <- 1:8
> mat2vec(myvec)
[1] 1 2 3 4 5 6 7 8
> mat2vec(t(myvec))
[1] 1 2 3 4 5 6 7 8

> mylist <- list("lions", "tigers", "bears")
> mylist
[[1]]
[1] "lions"

[[2]]
[1] "tigers"

[[3]]
[1] "bears"

> mat2vec(mylist)
[1] "lions"  "tigers" "bears" 

> myohmy <- list("lions", 1, "tigers", 2, "bears", 3, list("oh", "my"))
> myohmy
[[1]]
[1] "lions"

[[2]]
[1] 1

[[3]]
[1] "tigers"

[[4]]
[1] 2

[[5]]
[1] "bears"

[[6]]
[1] 3

[[7]]
[[7]][[1]]
[1] "oh"

[[7]][[2]]
[1] "my"

> mat2vec(myohmy)
[1] "lions"  "1"      "tigers" "2"      "bears"  "3"      "oh"     "my"

Is it bulletproof? Nope. I could make sure it is not any other type or not a
type that cannot be coerced into something like a matrix, or perhaps is of
higher dimensionality.

But as noted, if you already have a valid matrix object, there is a trivial
way to get it by row.


-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Ebert,Timothy Aaron
Sent: Sunday, August 6, 2023 11:06 PM
To: Rui Barradas <ruipbarradas at sapo.pt>; Iris Simmons <ikwsimmo at gmail.com>;
Steven Yen <styen at ntu.edu.tw>
Cc: R-help Mailing List <r-help at r-project.org>
Subject: Re: [R] Stacking matrix columns



-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Rui Barradas
Sent: Sunday, August 6, 2023 7:37 PM
To: Iris Simmons <ikwsimmo at gmail.com>; Steven Yen <styen at ntu.edu.tw>
Cc: R-help Mailing List <r-help at r-project.org>
Subject: Re: [R] Stacking matrix columns

[External Email]

?s 01:15 de 06/08/2023, Iris Simmons escreveu:
> You could also do
>
> dim(x) <- c(length(x), 1)
>
> On Sat, Aug 5, 2023, 20:12 Steven Yen <styen at ntu.edu.tw> wrote:
>
>> I wish to stack columns of a matrix into one column. The following
>> matrix command does it. Any other ways? Thanks.
>>
>>   > x<-matrix(1:20,5,4)
>>   > x
>>        [,1] [,2] [,3] [,4]
>> [1,]    1    6   11   16
>> [2,]    2    7   12   17
>> [3,]    3    8   13   18
>> [4,]    4    9   14   19
>> [5,]    5   10   15   20
>>
>>   > matrix(x,ncol=1)
>>         [,1]
>>    [1,]    1
>>    [2,]    2
>>    [3,]    3
>>    [4,]    4
>>    [5,]    5
>>    [6,]    6
>>    [7,]    7
>>    [8,]    8
>>    [9,]    9
>> [10,]   10
>> [11,]   11
>> [12,]   12
>> [13,]   13
>> [14,]   14
>> [15,]   15
>> [16,]   16
>> [17,]   17
>> [18,]   18
>> [19,]   19
>> [20,]   20
>>   >
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://sta/
>> t.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&data=05%7C01%7Ctebert%40ufl.e
>> du%7C0777cc9a4f7b4d06730008db96d60c04%7C0d4da0f84a314d76ace60a62331e1
>> b84%7C0%7C0%7C638269618308876684%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4w
>> LjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7
>> C&sdata=SuBbb9Zv2Zodb1p2Urk4a8yl%2FsGNfxUDxB7MqFlaTZc%3D&reserved=0
>> PLEASE do read the posting guide
>> http://www/.
>> r-project.org%2Fposting-guide.html&data=05%7C01%7Ctebert%40ufl.edu%7C
>> 0777cc9a4f7b4d06730008db96d60c04%7C0d4da0f84a314d76ace60a62331e1b84%7
>> C0%7C0%7C638269618308876684%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwM
>> DAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sda
>> ta=usT0%2FPcAyZZsp7IorVV31xXBqlMvH6tO3758UmKja44%3D&reserved=0
>> and provide commented, minimal, self-contained, reproducible code.
>>
>
>       [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat/
> .ethz.ch%2Fmailman%2Flistinfo%2Fr-help&data=05%7C01%7Ctebert%40ufl.edu
> %7C0777cc9a4f7b4d06730008db96d60c04%7C0d4da0f84a314d76ace60a62331e1b84
> %7C0%7C0%7C638269618308876684%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAw
> MDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sda
> ta=SuBbb9Zv2Zodb1p2Urk4a8yl%2FsGNfxUDxB7MqFlaTZc%3D&reserved=0
> PLEASE do read the posting guide
> http://www.r/
> -project.org%2Fposting-guide.html&data=05%7C01%7Ctebert%40ufl.edu%7C07
> 77cc9a4f7b4d06730008db96d60c04%7C0d4da0f84a314d76ace60a62331e1b84%7C0%
> 7C0%7C638269618308876684%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiL
> CJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=us
> T0%2FPcAyZZsp7IorVV31xXBqlMvH6tO3758UmKja44%3D&reserved=0
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Yet another solution.


t(t(c(x)))

or

x |> c() |> t() |> t()


At first I liked it but it's the slowest of the three, OP's, Iris' (the
fastest).

Hope this helps,

Rui Barradas

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.r-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From @te|@no@@o||@ @end|ng |rom reg|one@m@rche@|t  Mon Aug  7 18:41:49 2023
From: @te|@no@@o||@ @end|ng |rom reg|one@m@rche@|t (Stefano Sofia)
Date: Mon, 7 Aug 2023 16:41:49 +0000
Subject: [R] group consecutive dates in a row
Message-ID: <8a813abd71a3430ba64edc87d6046ec7@regione.marche.it>

Dear R users,

I have a data frame with a single column of POSIXct elements, like


mydf <- data.frame(data_POSIX=as.POSIXct(c("2012-02-05", "2012-02-06", "2012-02-07", "2012-02-13", "2012-02-21"), format = "%Y-%m-%d", tz="Etc/GMT-1"))


I need to transform it in a two-columns data frame where I can get rid of consecutive dates. It should appear like


data_POSIX_init data_POSIX_fin

2012-02-05 2012-02-07

2012-02-13 NA

2012-02-21 NA


I started with two "while cycles" and so on, but this is not an efficient way to do it.

Could you please give me an hint on how to proceed?


Thank you for your precious attention and help

Stefano


         (oo)
--oOO--( )--OOo--------------------------------------
Stefano Sofia PhD
Civil Protection - Marche Region - Italy
Meteo Section
Snow Section
Via del Colle Ameno 5
60126 Torrette di Ancona, Ancona (AN)
Uff: +39 071 806 7743
E-mail: stefano.sofia at regione.marche.it
---Oo---------oO----------------------------------------

________________________________

AVVISO IMPORTANTE: Questo messaggio di posta elettronica pu? contenere informazioni confidenziali, pertanto ? destinato solo a persone autorizzate alla ricezione. I messaggi di posta elettronica per i client di Regione Marche possono contenere informazioni confidenziali e con privilegi legali. Se non si ? il destinatario specificato, non leggere, copiare, inoltrare o archiviare questo messaggio. Se si ? ricevuto questo messaggio per errore, inoltrarlo al mittente ed eliminarlo completamente dal sistema del proprio computer. Ai sensi dell'art. 6 della DGR n. 1394/2008 si segnala che, in caso di necessit? ed urgenza, la risposta al presente messaggio di posta elettronica pu? essere visionata da persone estranee al destinatario.
IMPORTANT NOTICE: This e-mail message is intended to be received only by persons entitled to receive the confidential information it may contain. E-mail messages to clients of Regione Marche may contain information that is confidential and legally privileged. Please do not read, copy, forward, or store this message unless you are an intended recipient of it. If you have received this message in error, please forward it to the sender and delete it completely from your computer system.

--
Questo messaggio  stato analizzato da Libraesva ESG ed  risultato non infetto.
This message was scanned by Libraesva ESG and is believed to be clean.


	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Mon Aug  7 18:52:09 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Mon, 7 Aug 2023 12:52:09 -0400
Subject: [R] group consecutive dates in a row
In-Reply-To: <8a813abd71a3430ba64edc87d6046ec7@regione.marche.it>
References: <8a813abd71a3430ba64edc87d6046ec7@regione.marche.it>
Message-ID: <e92f14d7-64d8-09e1-9788-c7bde7f35f7b@gmail.com>

rle(as.numeric(diff(mydf$data_POSIX)))  should get you started, I think?

On 2023-08-07 12:41 p.m., Stefano Sofia wrote:
> Dear R users,
> 
> I have a data frame with a single column of POSIXct elements, like
> 
> 
> mydf <- data.frame(data_POSIX=as.POSIXct(c("2012-02-05", "2012-02-06", "2012-02-07", "2012-02-13", "2012-02-21"), format = "%Y-%m-%d", tz="Etc/GMT-1"))
> 
> 
> I need to transform it in a two-columns data frame where I can get rid of consecutive dates. It should appear like
> 
> 
> data_POSIX_init data_POSIX_fin
> 
> 2012-02-05 2012-02-07
> 
> 2012-02-13 NA
> 
> 2012-02-21 NA
> 
> 
> I started with two "while cycles" and so on, but this is not an efficient way to do it.
> 
> Could you please give me an hint on how to proceed?
> 
> 
> Thank you for your precious attention and help
> 
> Stefano
> 
> 
>           (oo)
> --oOO--( )--OOo--------------------------------------
> Stefano Sofia PhD
> Civil Protection - Marche Region - Italy
> Meteo Section
> Snow Section
> Via del Colle Ameno 5
> 60126 Torrette di Ancona, Ancona (AN)
> Uff: +39 071 806 7743
> E-mail: stefano.sofia at regione.marche.it
> ---Oo---------oO----------------------------------------
> 
> ________________________________
> 
> AVVISO IMPORTANTE: Questo messaggio di posta elettronica pu? contenere informazioni confidenziali, pertanto ? destinato solo a persone autorizzate alla ricezione. I messaggi di posta elettronica per i client di Regione Marche possono contenere informazioni confidenziali e con privilegi legali. Se non si ? il destinatario specificato, non leggere, copiare, inoltrare o archiviare questo messaggio. Se si ? ricevuto questo messaggio per errore, inoltrarlo al mittente ed eliminarlo completamente dal sistema del proprio computer. Ai sensi dell'art. 6 della DGR n. 1394/2008 si segnala che, in caso di necessit? ed urgenza, la risposta al presente messaggio di posta elettronica pu? essere visionata da persone estranee al destinatario.
> IMPORTANT NOTICE: This e-mail message is intended to be received only by persons entitled to receive the confidential information it may contain. E-mail messages to clients of Regione Marche may contain information that is confidential and legally privileged. Please do not read, copy, forward, or store this message unless you are an intended recipient of it. If you have received this message in error, please forward it to the sender and delete it completely from your computer system.
> 
> --
> Questo messaggio  stato analizzato da Libraesva ESG ed  risultato non infetto.
> This message was scanned by Libraesva ESG and is believed to be clean.
> 
> 
> 	[[alternative HTML version deleted]]
> 
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Mon Aug  7 19:47:38 2023
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 7 Aug 2023 10:47:38 -0700
Subject: [R] group consecutive dates in a row
In-Reply-To: <e92f14d7-64d8-09e1-9788-c7bde7f35f7b@gmail.com>
References: <8a813abd71a3430ba64edc87d6046ec7@regione.marche.it>
 <e92f14d7-64d8-09e1-9788-c7bde7f35f7b@gmail.com>
Message-ID: <CAGxFJbSzw3xh1Fk-n1L2+RHWLAq7ZUFF1ZobXWP3hjPEHJ7ZHQ@mail.gmail.com>

Here is another way to obtain the day differences that is the argument
of rle() . It is perhaps more reliable in that it uses methods for
class POSIXct rather than depending on the underlying class structure
and conversion via as.numeric. In theory, the methods won't change or
any changes will be documented, whereas class implementations are
allowed to be fluid and undocumented at the R user level (e.g. the
Help system) afaik. In this case, I don't think that would happen, so
I am merely being pedantic, but I hope I do not offend by making the
point.

But I also wanted to say that the OP could have (imo) looked up the
methodology as I describe below, rather than post here. Or perhaps he
did, but got stymied because he did not know about rle(), a somewhat
esoteric base R function. In which case, the search query "how to find
runs of identical values in an R vector" immediately yielded a hit on
rle(). So my message is: **DO** first try to use R's internal Help
before posting, especially for base R related tasks: it is really a
superb resource (again imo). *

OK, enough sermonizing. Here's what I did. Since the data are POSIXct
class, I went to ?POSIXct and browsed through it until I found
"difftime for time intervals" in the *See Also* section. Following
that link to ?difftime showed me this was what was needed, which is:

difftime(mydf[-1,1], mydf[-nrow(mydf), 1], units = "days")
Time differences in days
[1] 1 1 6 8

Cheers,
Bert

*... and I think it is likely that there are time series related
packages that also could be used, perhaps more immediately, to do what
was requested. But that would require a more diligent search. Though
with new LLM's and generative AI for Help systems becoming available,
the degree of diligence required is rapidly decreasing.


On Mon, Aug 7, 2023 at 9:52?AM Ben Bolker <bbolker at gmail.com> wrote:
>
> rle(as.numeric(diff(mydf$data_POSIX)))  should get you started, I think?
>
> On 2023-08-07 12:41 p.m., Stefano Sofia wrote:
> > Dear R users,
> >
> > I have a data frame with a single column of POSIXct elements, like
> >
> >
> > mydf <- data.frame(data_POSIX=as.POSIXct(c("2012-02-05", "2012-02-06", "2012-02-07", "2012-02-13", "2012-02-21"), format = "%Y-%m-%d", tz="Etc/GMT-1"))
> >
> >
> > I need to transform it in a two-columns data frame where I can get rid of consecutive dates. It should appear like
> >
> >
> > data_POSIX_init data_POSIX_fin
> >
> > 2012-02-05 2012-02-07
> >
> > 2012-02-13 NA
> >
> > 2012-02-21 NA
> >
> >
> > I started with two "while cycles" and so on, but this is not an efficient way to do it.
> >
> > Could you please give me an hint on how to proceed?
> >
> >
> > Thank you for your precious attention and help
> >
> > Stefano
> >
> >
> >           (oo)
> > --oOO--( )--OOo--------------------------------------
> > Stefano Sofia PhD
> > Civil Protection - Marche Region - Italy
> > Meteo Section
> > Snow Section
> > Via del Colle Ameno 5
> > 60126 Torrette di Ancona, Ancona (AN)
> > Uff: +39 071 806 7743
> > E-mail: stefano.sofia at regione.marche.it
> > ---Oo---------oO----------------------------------------
> >
> > ________________________________
> >
> > AVVISO IMPORTANTE: Questo messaggio di posta elettronica pu? contenere informazioni confidenziali, pertanto ? destinato solo a persone autorizzate alla ricezione. I messaggi di posta elettronica per i client di Regione Marche possono contenere informazioni confidenziali e con privilegi legali. Se non si ? il destinatario specificato, non leggere, copiare, inoltrare o archiviare questo messaggio. Se si ? ricevuto questo messaggio per errore, inoltrarlo al mittente ed eliminarlo completamente dal sistema del proprio computer. Ai sensi dell'art. 6 della DGR n. 1394/2008 si segnala che, in caso di necessit? ed urgenza, la risposta al presente messaggio di posta elettronica pu? essere visionata da persone estranee al destinatario.
> > IMPORTANT NOTICE: This e-mail message is intended to be received only by persons entitled to receive the confidential information it may contain. E-mail messages to clients of Regione Marche may contain information that is confidential and legally privileged. Please do not read, copy, forward, or store this message unless you are an intended recipient of it. If you have received this message in error, please forward it to the sender and delete it completely from your computer system.
> >
> > --
> > Questo messaggio  stato analizzato da Libraesva ESG ed  risultato non infetto.
> > This message was scanned by Libraesva ESG and is believed to be clean.
> >
> >
> >       [[alternative HTML version deleted]]
> >
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ggrothend|eck @end|ng |rom gm@||@com  Mon Aug  7 20:30:49 2023
From: ggrothend|eck @end|ng |rom gm@||@com (Gabor Grothendieck)
Date: Mon, 7 Aug 2023 14:30:49 -0400
Subject: [R] group consecutive dates in a row
In-Reply-To: <8a813abd71a3430ba64edc87d6046ec7@regione.marche.it>
References: <8a813abd71a3430ba64edc87d6046ec7@regione.marche.it>
Message-ID: <CAP01uR=Rc8aTzzXarp2D8RtBi1gToH8ZzVNUrr8DwrPfDv-H+Q@mail.gmail.com>

It is best to use Date, rather than POSIXct, class if there are no times.

Use the cumsum expression shown to group the dates and then summarize
each group.

We assume that the dates are already sorted in ascending order.

  library(dplyr)

  mydf <- data.frame(date = as.Date(c("2012-02-05", "2012-02-06",
"2012-02-07", "2012-02-13", "2012-02-21")))

  mydf %>%
    group_by(grp = cumsum(c(0, diff(date)) > 1)) %>%
    summarize(start = first(date), end = last(date)) %>%
    ungroup %>%
    select(-grp)
  ## # A tibble: 3 ? 2
  ##   start      end
  ##   <date>     <date>
  ## 1 2012-02-05 2012-02-07
  ## 2 2012-02-13 2012-02-13
  ## 3 2012-02-21 2012-02-21

or with only base R:

  smrz <- function(x) with(x, data.frame(start = min(date), end = max(date)))
  do.call("rbind", by(mydf, cumsum(c(0, diff(mydf$date)) > 1), smrz))
  ##        start        end
  ## 0 2012-02-05 2012-02-07
  ## 1 2012-02-13 2012-02-13
  ## 2 2012-02-21 2012-02-21


On Mon, Aug 7, 2023 at 12:42?PM Stefano Sofia
<stefano.sofia at regione.marche.it> wrote:
>
> Dear R users,
>
> I have a data frame with a single column of POSIXct elements, like
>
>
> mydf <- data.frame(data_POSIX=as.POSIXct(c("2012-02-05", "2012-02-06", "2012-02-07", "2012-02-13", "2012-02-21"), format = "%Y-%m-%d", tz="Etc/GMT-1"))
>
>
> I need to transform it in a two-columns data frame where I can get rid of consecutive dates. It should appear like
>
>
> data_POSIX_init data_POSIX_fin
>
> 2012-02-05 2012-02-07
>
> 2012-02-13 NA
>
> 2012-02-21 NA
>
>
> I started with two "while cycles" and so on, but this is not an efficient way to do it.
>
> Could you please give me an hint on how to proceed?
>
>
> Thank you for your precious attention and help
>
> Stefano
>
>
>          (oo)
> --oOO--( )--OOo--------------------------------------
> Stefano Sofia PhD
> Civil Protection - Marche Region - Italy
> Meteo Section
> Snow Section
> Via del Colle Ameno 5
> 60126 Torrette di Ancona, Ancona (AN)
> Uff: +39 071 806 7743
> E-mail: stefano.sofia at regione.marche.it
> ---Oo---------oO----------------------------------------
>
> ________________________________
>
> AVVISO IMPORTANTE: Questo messaggio di posta elettronica pu? contenere informazioni confidenziali, pertanto ? destinato solo a persone autorizzate alla ricezione. I messaggi di posta elettronica per i client di Regione Marche possono contenere informazioni confidenziali e con privilegi legali. Se non si ? il destinatario specificato, non leggere, copiare, inoltrare o archiviare questo messaggio. Se si ? ricevuto questo messaggio per errore, inoltrarlo al mittente ed eliminarlo completamente dal sistema del proprio computer. Ai sensi dell'art. 6 della DGR n. 1394/2008 si segnala che, in caso di necessit? ed urgenza, la risposta al presente messaggio di posta elettronica pu? essere visionata da persone estranee al destinatario.
> IMPORTANT NOTICE: This e-mail message is intended to be received only by persons entitled to receive the confidential information it may contain. E-mail messages to clients of Regione Marche may contain information that is confidential and legally privileged. Please do not read, copy, forward, or store this message unless you are an intended recipient of it. If you have received this message in error, please forward it to the sender and delete it completely from your computer system.
>
> --
> Questo messaggio  stato analizzato da Libraesva ESG ed  risultato non infetto.
> This message was scanned by Libraesva ESG and is believed to be clean.
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Tue Aug  8 04:31:48 2023
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Mon, 7 Aug 2023 22:31:48 -0400
Subject: [R] Merge with closest (not equal) time stamps
Message-ID: <IA1P223MB04997367CEB9FA4936AF5405FA0DA@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>


I have two dataframes, each with a column for timestamp.  I want to
merge the two dataframes such that each row from first dataframe
is matched with the row in the second dataframe with most recent but
preceding timestamp. Here is an example.

option.trades <- data.frame(timestamp = as.POSIXct(c("2023-08-07 10:23:22", "2023-08-07 10:25:33", "2023-08-07 10:28:41")), option.price = c(2.5, 2.7, 1.8))

stock.trades <- data.frame(timestamp = as.POSIXct(c("2023-08-07 10:23:21", "2023-08-07 10:23:34", "2023-08-07 10:24:57", "2023-08-07 10:28:37", "2023-08-07 10:29:01")), stock.price = c(102.2, 102.9, 103.1, 101.8, 101.7))

stock.trades <- stock.trades[order(stock.trades$timestamp),]

library(plyr)
mystock.prices <- ldply(option.trades$timestamp, function(tstamp) tail(subset(stock.trades, timestamp <= tstamp), 1))
names(mystock.prices)[1] <- "stock.timestamp"
myres <- cbind(option.trades, mystock.prices)

This method works. But for large dataframes, it is very slow.  Is there
a way to speed up the merge?

Thanks,
Naresh


From er|cjberger @end|ng |rom gm@||@com  Tue Aug  8 11:39:57 2023
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Tue, 8 Aug 2023 12:39:57 +0300
Subject: [R] Merge with closest (not equal) time stamps
In-Reply-To: <IA1P223MB04997367CEB9FA4936AF5405FA0DA@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
References: <IA1P223MB04997367CEB9FA4936AF5405FA0DA@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
Message-ID: <CAGgJW76gu5ZFeCs5V+C6yQNqCsOd1=j+Mq+_+JhVrBb8xU2r4Q@mail.gmail.com>

Hi Naresh,
Perhaps the below is faster than your approach

library(dplyr)
library(tidyr)
merge(option.trades, stock.trades, by="timestamp", all=TRUE) |>
  dplyr::arrange(timestamp) |>
  dplyr::mutate(stock.timestamp =
as.POSIXct(ifelse(is.na(option.price), timestamp, NA))) |>
  tidyr::fill(stock.price, stock.timestamp) |>
  dplyr::filter(!is.na(option.price)) |>
  dplyr::select(1,2,4,3) ->
  myres2

identical(myres, myres2)  ## TRUE


On Tue, Aug 8, 2023 at 5:32?AM Naresh Gurbuxani
<naresh_gurbuxani at hotmail.com> wrote:
>
>
> I have two dataframes, each with a column for timestamp.  I want to
> merge the two dataframes such that each row from first dataframe
> is matched with the row in the second dataframe with most recent but
> preceding timestamp. Here is an example.
>
> option.trades <- data.frame(timestamp = as.POSIXct(c("2023-08-07 10:23:22", "2023-08-07 10:25:33", "2023-08-07 10:28:41")), option.price = c(2.5, 2.7, 1.8))
>
> stock.trades <- data.frame(timestamp = as.POSIXct(c("2023-08-07 10:23:21", "2023-08-07 10:23:34", "2023-08-07 10:24:57", "2023-08-07 10:28:37", "2023-08-07 10:29:01")), stock.price = c(102.2, 102.9, 103.1, 101.8, 101.7))
>
> stock.trades <- stock.trades[order(stock.trades$timestamp),]
>
> library(plyr)
> mystock.prices <- ldply(option.trades$timestamp, function(tstamp) tail(subset(stock.trades, timestamp <= tstamp), 1))
> names(mystock.prices)[1] <- "stock.timestamp"
> myres <- cbind(option.trades, mystock.prices)
>
> This method works. But for large dataframes, it is very slow.  Is there
> a way to speed up the merge?
>
> Thanks,
> Naresh
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Tue Aug  8 13:12:32 2023
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Tue, 8 Aug 2023 07:12:32 -0400
Subject: [R] Merge with closest (not equal) time stamps
In-Reply-To: <CAGgJW76gu5ZFeCs5V+C6yQNqCsOd1=j+Mq+_+JhVrBb8xU2r4Q@mail.gmail.com>
References: <IA1P223MB04997367CEB9FA4936AF5405FA0DA@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
 <CAGgJW76gu5ZFeCs5V+C6yQNqCsOd1=j+Mq+_+JhVrBb8xU2r4Q@mail.gmail.com>
Message-ID: <IA1P223MB04997267CA7F5424DEE13496FA0DA@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>

I was able to adapt your solution using packages with which I am more familiar. 

myres2 <- merge(option.trades, stock.trades, by = "timestamp", all =
TRUE)

myres2[,"stock.timestamp"] <- ifelse(is.na(myres2$stock.price), NA,
myres2$timestamp)

myres2$stock.timestamp <- as.POSIXct(myres2$stock.timestamp, origin =
"1970-01-01")

library(zoo)
myres2$stock.price <- na.locf(myres2$stock.price)
myres2$stock.timestamp <- na.locf(myres2$stock.timestamp)
myres2 <- myres2[!is.na(myres2$option.price),]
row.names(myres2) <- NULL

all.equal(myres, myres2[,c(1, 2, 4, 3)]) # TRUE

This calculation is indeed faster.  

Thanks for your help,
Naresh

> On Aug 8, 2023, at 5:39 AM, Eric Berger <ericjberger at gmail.com> wrote:
> 
> Hi Naresh,
> Perhaps the below is faster than your approach
> 
> library(dplyr)
> library(tidyr)
> merge(option.trades, stock.trades, by="timestamp", all=TRUE) |>
>  dplyr::arrange(timestamp) |>
>  dplyr::mutate(stock.timestamp =
> as.POSIXct(ifelse(is.na(option.price), timestamp, NA))) |>
>  tidyr::fill(stock.price, stock.timestamp) |>
>  dplyr::filter(!is.na(option.price)) |>
>  dplyr::select(1,2,4,3) ->
>  myres2
> 
> identical(myres, myres2)  ## TRUE
> 
> 
> On Tue, Aug 8, 2023 at 5:32?AM Naresh Gurbuxani
> <naresh_gurbuxani at hotmail.com> wrote:
>> 
>> 
>> I have two dataframes, each with a column for timestamp.  I want to
>> merge the two dataframes such that each row from first dataframe
>> is matched with the row in the second dataframe with most recent but
>> preceding timestamp. Here is an example.
>> 
>> option.trades <- data.frame(timestamp = as.POSIXct(c("2023-08-07 10:23:22", "2023-08-07 10:25:33", "2023-08-07 10:28:41")), option.price = c(2.5, 2.7, 1.8))
>> 
>> stock.trades <- data.frame(timestamp = as.POSIXct(c("2023-08-07 10:23:21", "2023-08-07 10:23:34", "2023-08-07 10:24:57", "2023-08-07 10:28:37", "2023-08-07 10:29:01")), stock.price = c(102.2, 102.9, 103.1, 101.8, 101.7))
>> 
>> stock.trades <- stock.trades[order(stock.trades$timestamp),]
>> 
>> library(plyr)
>> mystock.prices <- ldply(option.trades$timestamp, function(tstamp) tail(subset(stock.trades, timestamp <= tstamp), 1))
>> names(mystock.prices)[1] <- "stock.timestamp"
>> myres <- cbind(option.trades, mystock.prices)
>> 
>> This method works. But for large dataframes, it is very slow.  Is there
>> a way to speed up the merge?
>> 
>> Thanks,
>> Naresh
>> 
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From e@ @end|ng |rom enr|co@chum@nn@net  Tue Aug  8 13:34:17 2023
From: e@ @end|ng |rom enr|co@chum@nn@net (Enrico Schumann)
Date: Tue, 08 Aug 2023 13:34:17 +0200
Subject: [R] Merge with closest (not equal) time stamps
In-Reply-To: <IA1P223MB04997367CEB9FA4936AF5405FA0DA@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
 (Naresh Gurbuxani's message of "Mon, 7 Aug 2023 22:31:48 -0400")
References: <IA1P223MB04997367CEB9FA4936AF5405FA0DA@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
Message-ID: <87fs4t7op2.fsf@enricoschumann.net>

On Mon, 07 Aug 2023, Naresh Gurbuxani writes:

> I have two dataframes, each with a column for timestamp.  I want to
> merge the two dataframes such that each row from first dataframe
> is matched with the row in the second dataframe with most recent but
> preceding timestamp. Here is an example.
>
> option.trades <- data.frame(timestamp = as.POSIXct(c("2023-08-07 10:23:22", "2023-08-07 10:25:33", "2023-08-07 10:28:41")), option.price = c(2.5, 2.7, 1.8))
>
> stock.trades <- data.frame(timestamp =
> as.POSIXct(c("2023-08-07 10:23:21", "2023-08-07
> 10:23:34", "2023-08-07 10:24:57", "2023-08-07
> 10:28:37", "2023-08-07 10:29:01")), stock.price =
> c(102.2, 102.9, 103.1, 101.8, 101.7))
>
> stock.trades <- stock.trades[order(stock.trades$timestamp),]
>
> library(plyr)
> mystock.prices <- ldply(option.trades$timestamp, function(tstamp) tail(subset(stock.trades, timestamp <= tstamp), 1))
> names(mystock.prices)[1] <- "stock.timestamp"
> myres <- cbind(option.trades, mystock.prices)
>
> This method works. But for large dataframes, it is very slow.  Is there
> a way to speed up the merge?
>
> Thanks,
> Naresh
>

If the timestamps are sorted (or you can sort them),
function ?findInterval might be helpful:

    i <- findInterval(option.trades$timestamp, stock.trades$timestamp)
    cbind(option.trades, stock.trades[i, ])
    ##             timestamp option.price           timestamp stock.price
    ## 1 2023-08-07 10:23:22          2.5 2023-08-07 10:23:21       102.2
    ## 3 2023-08-07 10:25:33          2.7 2023-08-07 10:24:57       103.1
    ## 4 2023-08-07 10:28:41          1.8 2023-08-07 10:28:37       101.8



-- 
Enrico Schumann
Lucerne, Switzerland
http://enricoschumann.net


From j@gu @end|ng |rom @@p@com  Tue Aug  8 12:39:15 2023
From: j@gu @end|ng |rom @@p@com (Gu, Jay)
Date: Tue, 8 Aug 2023 10:39:15 +0000
Subject: [R] R library highcharter function highchart() execute with
 exception the apparmor read denied for /etc/passwd and /etc/group
Message-ID: <GV1PR02MB853963D1CFD50119AEC92D6E810DA@GV1PR02MB8539.eurprd02.prod.outlook.com>

Dears,


I use the R library highcharter with ubuntu 18.04 and R 3.6.3. Recently, I upgraded to ubuntu 20.04 and R 4.3.1. And the version of library highcharter are both 0.9.4. Then I execute the function highchart() it always throw the exception that child process has died. And I checked the /var/log/kern.log and found below error:

Aug 7 08:37:50 ip-172-31-27-249 kernel: [2251703.494866] audit: type=1400 audit(1691397470.399:739): apparmor="DENIED" operation="open" profile="managedr-profile" name="/etc/passwd" pid=159930 comm="R" requested_mask="r" denied_mask="r" fsuid=1000 ouid=0
Aug 7 08:37:50 ip-172-31-27-249 kernel: [2251703.494871] audit: type=1400 audit(1691397470.399:740): apparmor="DENIED" operation="open" profile="managedr-profile" name="/etc/group" pid=159930 comm="R" requested_mask="r" denied_mask="r" fsuid=1000 ouid=0

If I add below two lines in my apparmor profile it will resolve this issue. But I don't like to expose these two files to end user as it has potential risk.
/etc/passwd r,
/etc/group r,

I'd like to know if there is any solution to fix it without giving the read access for these two files /etc/passwd and /etc/group in the apparmor profile as I did with ubuntu 18.04 and R 3.6.3. Thanks!
Best Regards!
Jay Gu


	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Tue Aug  8 16:57:13 2023
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 8 Aug 2023 07:57:13 -0700
Subject: [R] R library highcharter function highchart() execute with
 exception the apparmor read denied for /etc/passwd and /etc/group
In-Reply-To: <GV1PR02MB853963D1CFD50119AEC92D6E810DA@GV1PR02MB8539.eurprd02.prod.outlook.com>
References: <GV1PR02MB853963D1CFD50119AEC92D6E810DA@GV1PR02MB8539.eurprd02.prod.outlook.com>
Message-ID: <CAGxFJbSZ6h20o3fR=rKHp4+3wf-qfLeBxqC1JgcPOzrDv2YNow@mail.gmail.com>

If you don't get a satisfactory answer here in due course, you can try
contacting the package maintainer, who you can find via ?maintainer.

Cheers,
Bert

On Tue, Aug 8, 2023 at 7:50?AM Gu, Jay via R-help <r-help at r-project.org> wrote:
>
> Dears,
>
>
> I use the R library highcharter with ubuntu 18.04 and R 3.6.3. Recently, I upgraded to ubuntu 20.04 and R 4.3.1. And the version of library highcharter are both 0.9.4. Then I execute the function highchart() it always throw the exception that child process has died. And I checked the /var/log/kern.log and found below error:
>
> Aug 7 08:37:50 ip-172-31-27-249 kernel: [2251703.494866] audit: type=1400 audit(1691397470.399:739): apparmor="DENIED" operation="open" profile="managedr-profile" name="/etc/passwd" pid=159930 comm="R" requested_mask="r" denied_mask="r" fsuid=1000 ouid=0
> Aug 7 08:37:50 ip-172-31-27-249 kernel: [2251703.494871] audit: type=1400 audit(1691397470.399:740): apparmor="DENIED" operation="open" profile="managedr-profile" name="/etc/group" pid=159930 comm="R" requested_mask="r" denied_mask="r" fsuid=1000 ouid=0
>
> If I add below two lines in my apparmor profile it will resolve this issue. But I don't like to expose these two files to end user as it has potential risk.
> /etc/passwd r,
> /etc/group r,
>
> I'd like to know if there is any solution to fix it without giving the read access for these two files /etc/passwd and /etc/group in the apparmor profile as I did with ubuntu 18.04 and R 3.6.3. Thanks!
> Best Regards!
> Jay Gu
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kry|ov@r00t @end|ng |rom gm@||@com  Tue Aug  8 21:15:06 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Tue, 8 Aug 2023 22:15:06 +0300
Subject: [R] R library highcharter function highchart() execute with
 exception the apparmor read denied for /etc/passwd and /etc/group
In-Reply-To: <GV1PR02MB853963D1CFD50119AEC92D6E810DA@GV1PR02MB8539.eurprd02.prod.outlook.com>
References: <GV1PR02MB853963D1CFD50119AEC92D6E810DA@GV1PR02MB8539.eurprd02.prod.outlook.com>
Message-ID: <20230808221506.2898f2c2@Tarkus>

On Tue, 8 Aug 2023 10:39:15 +0000
"Gu, Jay via R-help" <r-help at r-project.org> wrote:

>  Then I execute the function highchart() it always throw the
> exception that child process has died. And I checked the
> /var/log/kern.log and found below error:
> 
> Aug 7 08:37:50 ip-172-31-27-249 kernel: [2251703.494866] audit:
> type=1400 audit(1691397470.399:739): apparmor="DENIED"
> operation="open" profile="managedr-profile" name="/etc/passwd"
> pid=159930 comm="R" requested_mask="r" denied_mask="r" fsuid=1000
> ouid=0

It's not that terrible to let a program access /etc/passwd. It does
contain the list of the users, which is a privacy risk, true, but at
least the passwords are safely hashed and hidden away in /etc/shadow.

Searching the CRAN mirror on GitHub for "/etc/passwd" gives quite a few
hits, and so does "getpwuid". There are likely other POSIX functions
that read /etc/passwd too. Any of highcharter's 68 dependencies could
be trying to read /etc/passwd directly or indirectly. (Could be fs,
could be some other package.)

If you run R -d gdb and let it crash, what does the backtrace say?

I think it's likely that the /etc/passwd access won't be easy to get
rid of, so if you don't want to give R access to it, you might want to
run it inside a container or a virtual machine.

-- 
Best regards,
Ivan


From kry|ov@r00t @end|ng |rom gm@||@com  Wed Aug  9 08:23:15 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Wed, 9 Aug 2023 09:23:15 +0300
Subject: [R] R library highcharter function highchart() execute with
 exception the apparmor read denied for /etc/passwd and /etc/group
In-Reply-To: <AS8PR02MB85411682C9BA7727539235F78112A@AS8PR02MB8541.eurprd02.prod.outlook.com>
References: <GV1PR02MB853963D1CFD50119AEC92D6E810DA@GV1PR02MB8539.eurprd02.prod.outlook.com>
 <20230808221506.2898f2c2@Tarkus>
 <AS8PR02MB85411682C9BA7727539235F78112A@AS8PR02MB8541.eurprd02.prod.outlook.com>
Message-ID: <20230809092315.7bd22548@Tarkus>

On Wed, 9 Aug 2023 01:13:40 +0000
"Gu, Jay" <j.gu at sap.com> wrote:

> I'm running the R within docker container.

In that case (depending on the way the container is set up, of course),
your /etc/passwd shouldn't even be a privacy concern. It's most likely
identical that in other containers running R. You can read it yourself
(either by getting a separate shell inside the container or by running
readLines("/etc/passwd")) and check for identifying information. There
should be no harm in letting an R package read it.

If you are curious to know which part is trying to access it, we still
need a backtrace at the point where AppArmor crashes the process,
either from a core file or from a live process. (Other techniques are
fine too, but setting conditional breakpoints on open() and openat() is
more involved.)

-- 
Best regards,
Ivan


From j@gu @end|ng |rom @@p@com  Wed Aug  9 03:13:40 2023
From: j@gu @end|ng |rom @@p@com (Gu, Jay)
Date: Wed, 9 Aug 2023 01:13:40 +0000
Subject: [R] R library highcharter function highchart() execute with
 exception the apparmor read denied for /etc/passwd and /etc/group
In-Reply-To: <20230808221506.2898f2c2@Tarkus>
References: <GV1PR02MB853963D1CFD50119AEC92D6E810DA@GV1PR02MB8539.eurprd02.prod.outlook.com>
 <20230808221506.2898f2c2@Tarkus>
Message-ID: <AS8PR02MB85411682C9BA7727539235F78112A@AS8PR02MB8541.eurprd02.prod.outlook.com>

Hi Ivan,

I'm running the R within docker container. Do you have any idea about it? Thanks!


Best Regards!
Jay Gu

-----Original Message-----
From: Ivan Krylov <krylov.r00t at gmail.com> 
Sent: Wednesday, August 9, 2023 3:15 AM
To: Gu, Jay via R-help <r-help at r-project.org>
Cc: Gu, Jay <j.gu at sap.com>
Subject: Re: [R] R library highcharter function highchart() execute with exception the apparmor read denied for /etc/passwd and /etc/group

[You don't often get email from krylov.r00t at gmail.com. Learn why this is important at https://aka.ms/LearnAboutSenderIdentification ]

On Tue, 8 Aug 2023 10:39:15 +0000
"Gu, Jay via R-help" <r-help at r-project.org> wrote:

>  Then I execute the function highchart() it always throw the
> exception that child process has died. And I checked the
> /var/log/kern.log and found below error:
>
> Aug 7 08:37:50 ip-172-31-27-249 kernel: [2251703.494866] audit:
> type=1400 audit(1691397470.399:739): apparmor="DENIED"
> operation="open" profile="managedr-profile" name="/etc/passwd"
> pid=159930 comm="R" requested_mask="r" denied_mask="r" fsuid=1000
> ouid=0

It's not that terrible to let a program access /etc/passwd. It does
contain the list of the users, which is a privacy risk, true, but at
least the passwords are safely hashed and hidden away in /etc/shadow.

Searching the CRAN mirror on GitHub for "/etc/passwd" gives quite a few
hits, and so does "getpwuid". There are likely other POSIX functions
that read /etc/passwd too. Any of highcharter's 68 dependencies could
be trying to read /etc/passwd directly or indirectly. (Could be fs,
could be some other package.)

If you run R -d gdb and let it crash, what does the backtrace say?

I think it's likely that the /etc/passwd access won't be easy to get
rid of, so if you don't want to give R access to it, you might want to
run it inside a container or a virtual machine.

--
Best regards,
Ivan


From h@w|ckh@m @end|ng |rom gm@||@com  Wed Aug  9 14:39:50 2023
From: h@w|ckh@m @end|ng |rom gm@||@com (Hadley Wickham)
Date: Wed, 9 Aug 2023 07:39:50 -0500
Subject: [R] Merge with closest (not equal) time stamps
In-Reply-To: <IA1P223MB04997367CEB9FA4936AF5405FA0DA@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
References: <IA1P223MB04997367CEB9FA4936AF5405FA0DA@IA1P223MB0499.NAMP223.PROD.OUTLOOK.COM>
Message-ID: <CABdHhvF8dbDdciF=y-0YPZiEdHxBb6TtN5Oni0=a2gvK7TSZgw@mail.gmail.com>

It sounds like you might want a rolling join, e.g.
https://dplyr.tidyverse.org/reference/join_by.html#rolling-joins.

(And data.table has similar functionality which inspired dplyr)

Hadley

On Mon, Aug 7, 2023 at 9:32?PM Naresh Gurbuxani
<naresh_gurbuxani at hotmail.com> wrote:
>
>
> I have two dataframes, each with a column for timestamp.  I want to
> merge the two dataframes such that each row from first dataframe
> is matched with the row in the second dataframe with most recent but
> preceding timestamp. Here is an example.
>
> option.trades <- data.frame(timestamp = as.POSIXct(c("2023-08-07 10:23:22", "2023-08-07 10:25:33", "2023-08-07 10:28:41")), option.price = c(2.5, 2.7, 1.8))
>
> stock.trades <- data.frame(timestamp = as.POSIXct(c("2023-08-07 10:23:21", "2023-08-07 10:23:34", "2023-08-07 10:24:57", "2023-08-07 10:28:37", "2023-08-07 10:29:01")), stock.price = c(102.2, 102.9, 103.1, 101.8, 101.7))
>
> stock.trades <- stock.trades[order(stock.trades$timestamp),]
>
> library(plyr)
> mystock.prices <- ldply(option.trades$timestamp, function(tstamp) tail(subset(stock.trades, timestamp <= tstamp), 1))
> names(mystock.prices)[1] <- "stock.timestamp"
> myres <- cbind(option.trades, mystock.prices)
>
> This method works. But for large dataframes, it is very slow.  Is there
> a way to speed up the merge?
>
> Thanks,
> Naresh
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
http://hadley.nz


From nov|y@nto @end|ng |rom omeg@re@e@rch@|d  Wed Aug  9 06:30:21 2023
From: nov|y@nto @end|ng |rom omeg@re@e@rch@|d (Andreas Noviyanto)
Date: Wed, 09 Aug 2023 04:30:21 +0000
Subject: [R] unused argument(s) (Header = 1) help!
In-Reply-To: <<65B70EC50BAE479B9AE0504F5088B6D4@Gandalf>>
References: <<65B70EC50BAE479B9AE0504F5088B6D4@Gandalf>>
Message-ID: <emc7fd90c7-4c99-493d-933b-b5565087fd68@bdf170ac.com>

Dear Daniel,

I was use this script to calculate replicateBE with R software, its 
worked. when i use the same script with similar data (xlsx) i got error 
messages like below, do you have any suggest? thanks anyway
my script:
library(replicateBE)
path.in  <- "Z:/Personil Omega"
path.out <-  path.in
method.A(path.in=path.in, path.out=path.out, file="lans",
          set="01", ext="xlsx", header=1, ola=TRUE)
method.A(path.in=path.in, path.out=path.out, file="lans",
     set="02", ext="xlsx", header=1)
ABE(path.in=path.in, path.out=path.out, file="lans",
     set="01", ext="xlsx", header=1)

ABE(path.in=path.in, path.out=path.out, file="lans",
     set="02", ext="xlsx", header=1)

result:
 > library(replicateBE)
 > path.in  <- "Z:/Personil Omega"
 > path.out <- path.in
 > method.A(path.in=path.in, path.out=path.out, file="lans",
+          set="01", ext="xlsx", header=1, ola=TRUE)
Error in method.A(path.in = path.in, path.out = path.out, file = "lans", 
  :
   unused argument (header = 1)
 > method.A(path.in=path.in, path.out=path.out, file="lans",
+     set="02", ext="xlsx", header=1)
Error in method.A(path.in = path.in, path.out = path.out, file = "lans", 
  :
   unused argument (header = 1)
 > ABE(path.in=path.in, path.out=path.out, file="lans",
+     set="01", ext="xlsx", header=1)
Error in ABE(path.in = path.in, path.out = path.out, file = "lans",  :
   unused argument (header = 1)
 > ABE(path.in=path.in, path.out=path.out, file="lans",
+     set="02", ext="xlsx", header=1)
Error in ABE(path.in = path.in, path.out = path.out, file = "lans",  :
   unused argument (header = 1)



Warm Regards,

Andreas

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Aug  9 18:26:52 2023
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 9 Aug 2023 17:26:52 +0100
Subject: [R] unused argument(s) (Header = 1) help!
In-Reply-To: <emc7fd90c7-4c99-493d-933b-b5565087fd68@bdf170ac.com>
References: <<65B70EC50BAE479B9AE0504F5088B6D4@Gandalf>
 <emc7fd90c7-4c99-493d-933b-b5565087fd68@bdf170ac.com>
Message-ID: <46b459ef-802c-fd1a-ecee-ebae4986316e@sapo.pt>

?s 05:30 de 09/08/2023, Andreas Noviyanto escreveu:
> Dear Daniel,
> 
> I was use this script to calculate replicateBE with R software, its
> worked. when i use the same script with similar data (xlsx) i got error
> messages like below, do you have any suggest? thanks anyway
> my script:
> library(replicateBE)
> path.in  <- "Z:/Personil Omega"
> path.out <-  path.in
> method.A(path.in=path.in, path.out=path.out, file="lans",
>            set="01", ext="xlsx", header=1, ola=TRUE)
> method.A(path.in=path.in, path.out=path.out, file="lans",
>       set="02", ext="xlsx", header=1)
> ABE(path.in=path.in, path.out=path.out, file="lans",
>       set="01", ext="xlsx", header=1)
> 
> ABE(path.in=path.in, path.out=path.out, file="lans",
>       set="02", ext="xlsx", header=1)
> 
> result:
>   > library(replicateBE)
>   > path.in  <- "Z:/Personil Omega"
>   > path.out <- path.in
>   > method.A(path.in=path.in, path.out=path.out, file="lans",
> +          set="01", ext="xlsx", header=1, ola=TRUE)
> Error in method.A(path.in = path.in, path.out = path.out, file = "lans",
>    :
>     unused argument (header = 1)
>   > method.A(path.in=path.in, path.out=path.out, file="lans",
> +     set="02", ext="xlsx", header=1)
> Error in method.A(path.in = path.in, path.out = path.out, file = "lans",
>    :
>     unused argument (header = 1)
>   > ABE(path.in=path.in, path.out=path.out, file="lans",
> +     set="01", ext="xlsx", header=1)
> Error in ABE(path.in = path.in, path.out = path.out, file = "lans",  :
>     unused argument (header = 1)
>   > ABE(path.in=path.in, path.out=path.out, file="lans",
> +     set="02", ext="xlsx", header=1)
> Error in ABE(path.in = path.in, path.out = path.out, file = "lans",  :
>     unused argument (header = 1)
> 
> 
> 
> Warm Regards,
> 
> Andreas
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

That error message means that there is no argument 'header' to function 
method.A.
Simply remove it and you should be fine.

Hope this helps,

Rui Barradas


From rb@er @end|ng |rom @t@u@edu  Thu Aug 10 17:22:18 2023
From: rb@er @end|ng |rom @t@u@edu (Robert Baer)
Date: Thu, 10 Aug 2023 10:22:18 -0500
Subject: [R] Technical Help Request for "Version Differences" (i.e.,
 CYTOFKIT package)
In-Reply-To: <146822026.2931556.1691133058051.JavaMail.zimbra@iyte.edu.tr>
References: <146822026.2931556.1691133058051.JavaMail.zimbra@iyte.edu.tr>
Message-ID: <d70bd2fc-a87a-da9e-bbe0-ee81dc460933@atsu.edu>

GIven that Cytofkit is removed from Bioconductor, and you seem new to 
everything, I would suggest like others already have that you install 
the most recent version of R for Windows 
https://cran.r-project.org/bin/windows/base/ and seek a more up-to-date 
package.

For flow cytometry, I would like to recommend the CytoExploreR package 
(https://dillonhammill.github.io/CytoExploreR/ which is built on top of 
the core flow cytometry packages produced by RGLab 
(https://cytoverse.org/) and available on Bioconductor 
https://bioconductor.org/packages/release/bioc/html/openCyto.html

God luck,

Rob

On 8/4/2023 2:10 AM, MURAT DELMAN via R-help wrote:
>
>
> Dear Ms./Mr.,
>
>
>
>
>
>
>
> If the email text and codes below are not properly displayed, you can download the attached Word file, which has exactly the same content.
>
>
>
> I am a cytometrist and microscopist at Izmir Institute of Technology, Integrated Research Center. I operate a cytometer and fluorescence microscope to acquire data from our researchers? samples and then give them analyzed data. I need to dive into bulk data to present all of the information in the sample. To do this, I have recently been trying to develop my skills in R, RStudio, and Cytofkit package for cytometry (flow, spectral, mass, imaging mass cytometry) data analysis. I am new in this area and must learn R for data analysis.
>
>
>
>
>
> May I request help from you or one of your assistants who is competent in R, RStudio, and R packages with the installation issues caused by ? version differences ? between R itself, R packages, and their dependencies? I really had to send this email to you anymore, because I could not run the package ?Cytofkit? and find a solution on the internet.
>
>
> It has been nearly 2 weeks since I have been trying to solve the errors and warnings. I am in a vicious circle and cannot move forward anymore. This is why I needed help from an expert competent in R programming.
>
>
>
> I tried to use the renv package, but I could not move forward because I am not competent in R.
>
>
>
>
> I explained the errors that I faced during the installation below.
>
>
>
> I have two computers, both operating Windows 10, 64-bit.
>
>
>
> I installed R 3.5. 2 on the desktop (Windows in English) and R 3.5. 0 on the laptop (Windows in Turkish).
>
>
>
> I know that you are very busy with your work, but may you (or your assistant) help me by informing me how to install consistent versions of R, RStudio, and packages/dependencies (for example, Cytofkit, ggplot2, Rtools, devtools, plyr, shiny, GUI)?
>
>
>
>
>
> I guess I will need exact web page links " in an orderly manner" to download the correct versions of everything.
>
>
>
> I would appreciate it if you could advise me or forward this email to one of your assistants or experts.
>
>
>
>
>
>
> I really appreciate any help you can provide.
>
>
>
>
>
>
> Kind Regards
>
>
>
>
>
>
> Please find the technical details below;
>
>
>
>
>
> I used the installation order listed below;
>
>
>
> I downloaded R 3.5.0 and R 3.5.2 using the link and directory below.
>
>
>
> Link: [ https://www.freestatistics.org/cran/ | https://www.freestatistics.org/cran/ ]
>
>
>
> Directory: Download R for Windows > install R for the first time > Previous releases > R 3.5.2 (December, 2018) or R 3.5.0
>
>
>
>
>
> I downloaded RStudio from the link below;
>
>
>
> [ https://posit.co/download/rstudio-desktop/ | https://posit.co/download/rstudio-desktop/ ]
>
>
>
>
>
>
> I downloaded packages via either [ https://cran.rstudio.com/bin/windows/contrib/r-devel/ | https://cran.rstudio.com/bin/windows/contrib/r-devel/ ] or the ?install function? tab in RStudio.
>
>
>
> Rtools : [ https://cran.r-project.org/bin/windows/Rtools/ | https://cran.r-project.org/bin/windows/Rtools/ ]
>
>
>
> Devtools : [ https://cran.r-project.org/web/packages/devtools/index.html | https://cran.r-project.org/web/packages/devtools/index.html ]
>
>
>
> ggplot2 : [ https://cran.r-project.org/web/packages/ggplot2/index.html | https://cran.r-project.org/web/packages/ggplot2/index.html ]
>
>
>
> [ https://ggplot2.tidyverse.org/ | https://ggplot2.tidyverse.org/ ]
>
>
>
> [ https://cran.r-project.org/web/packages/ggplot2/ggplot2.pdf | https://cran.r-project.org/web/packages/ggplot2/ggplot2.pdf ]
>
>
>
>
>
> plyr : [ https://cran.r-project.org/web/packages/plyr/index.html | https://cran.r-project.org/web/packages/plyr/index.html ]
>
>
>
> shiny : [ https://cran.r-project.org/web/packages/shiny/index.html | https://cran.r-project.org/web/packages/shiny/index.html ]
>
>
>
> [ https://shiny.posit.co/r/getstarted/shiny-basics/lesson1/index.html | https://shiny.posit.co/r/getstarted/shiny-basics/lesson1/index.html ]
>
>
>
> [ https://github.com/rstudio/shiny | https://github.com/rstudio/shiny ]
>
>
>
> cytofkit : [ https://github.com/JinmiaoChenLab/cytofkit | https://github.com/JinmiaoChenLab/cytofkit ]
>
>
>
> [ https://bioconductor.riken.jp/packages/3.3/bioc/html/cytofkit.html | https://bioconductor.riken.jp/packages/3.3/bioc/html/cytofkit.html ]
>
>
>
> [ https://journals.plos.org/ploscompbiol/article/file?id=10.1371/journal.pcbi.1005112&type=printable | https://journals.plos.org/ploscompbiol/article/file?id=10.1371/journal.pcbi.1005112&type=printable ]
>
>
>
>
>
>
> Below, I provide the errors and warnings that I faced for 2 weeks for both R versions;
>
>
>
>
>
> Please find the errors and warnings below;
>
>
>
>
>
>
> CYTOFKIT FOR R VERSION 3.5. 2
>
>
>
>
>
>
>
>
>
>> library(cytofkit)
> Loading required package: ggplot2
>
> Loading required package: plyr
>
> Error: package or namespace load failed for ?cytofkit?:
>
> package ?cytofkit? was installed by an R version with different internals; it needs to be reinstalled for use with this R version
>
>
>
> ERROR: this R is version 3.5.2, package 'cytofkit2' requires R >= 4.0.0
>
> In R CMD INSTALL
>
> Installation paths not writeable, unable to update packages
>
> path: C:/Program Files/R/R-3.5.2/library
>
> packages:
>
> boot, class, cluster, codetools, KernSmooth, Matrix, nlme, nnet, rpart, spatial, survival
>
> There were 23 warnings (use warnings() to see them)
>
>
>
>> warnings()
> Warning messages:
>
> 1: packages ?caTools?, ?umap? are not available (for R version 3.5.2)
>
> 2: In i.p(...) : installation of package ?DEoptimR? had non-zero exit status
>
> 3: In i.p(...) : installation of package ?mvtnorm? had non-zero exit status
>
> 4: In i.p(...) : installation of package ?XML? had non-zero exit status
>
> 5: In i.p(...) : installation of package ?fastmap? had non-zero exit status
>
> 6: In i.p(...) : installation of package ?sass? had non-zero exit status
>
> 7: In i.p(...) : installation of package ?jquerylib? had non-zero exit status
>
> 8: In i.p(...) : installation of package ?later? had non-zero exit status
>
> 9: In i.p(...) : installation of package ?fontawesome? had non-zero exit status
>
> 10: In i.p(...) : installation of package ?miniUI? had non-zero exit status
>
> 11: In i.p(...) : installation of package ?RcppTOML? had non-zero exit status
>
> 12: In i.p(...) : installation of package ?pcaPP? had non-zero exit status
>
> 13: In i.p(...) : installation of package ?robustbase? had non-zero exit status
>
> 14: In i.p(...) : installation of package ?cachem? had non-zero exit status
>
> 15: In i.p(...) : installation of package ?promises? had non-zero exit status
>
> 16: In i.p(...) : installation of package ?reticulate? had non-zero exit status
>
> 17: In i.p(...) : installation of package ?rrcov? had non-zero exit status
>
> 18: In i.p(...) : installation of package ?memoise? had non-zero exit status
>
> 19: In i.p(...) : installation of package ?httpuv? had non-zero exit status
>
> 20: In i.p(...) : installation of package ?bslib? had non-zero exit status
>
> 21: In i.p(...) : installation of package ?rmarkdown? had non-zero exit status
>
> 22: In i.p(...) : installation of package ?htmlwidgets? had non-zero exit status
>
> 23: In i.p(...) :
>
> installation of package ?C:/Users/murat-delman/AppData/Local/Temp/Rtmp8GGq71/file4d0c54c135b4/cytofkit2_0.99.80.tar.gz? had non-zero exit status
>
>
>> devtools::install_github("JinmiaoChenLab/cytofkit")
> Error in rbind(info, getNamespaceInfo(env, "S3methods")) :
>
> number of columns of matrices must match (see arg 2)
>
>
>
>
>
>
>
> INSTALLING GGPLOT2 FOR R VERSION 3.5. 0
>
>
>
>> library(cytofkit)
> Loading required package: ggplot2
>
> Warning: namespace ?cli? is not available and has been replaced
>
> by .GlobalEnv when processing object ?.Random.seed?
>
> Error: package or namespace load failed for ?ggplot2? in rbind(info, getNamespaceInfo(env, "S3methods")):
>
> number of columns of matrices must match (see arg 2)
>
> Error: package ?ggplot2? could not be loaded
>
> In addition: Warning message:
>
> package ?ggplot2? was built under R version 4.2.3
>
>
>
>> library(cytofkit)
> Error: package ?ggplot2? required by ?cytofkit? could not be found
>
>
>
>> install.packages("D:/Programlar/ggplotgui_1.0.0.zip", repos = NULL, type = "win.binary")
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> package ?ggplotgui? successfully unpacked and MD5 sums checked
>
>
>
>> install.packages("D:/Programlar/ggplot2/ggplot2_3.0.0.tar.gz", repos = NULL, type = "source")
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> * installing *source* package 'ggplot2' ...
>
> ** package 'ggplot2' successfully unpacked and MD5 sums checked
>
> ** R
>
> ** data
>
> *** moving datasets to lazyload DB
>
> ** inst
>
> ** byte-compile and prepare package for lazy loading
>
> Warning: namespace 'cli' is not available and has been replaced
>
> by .GlobalEnv when processing object 'txhousing'
>
> Error in rbind(info, getNamespaceInfo(env, "S3methods")) :
>
> number of columns of matrices must match (see arg 2)
>
> ERROR: lazy loading failed for package 'ggplot2'
>
> * removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2'
>
> In R CMD INSTALL
>
> Warning in install.packages :
>
> installation of package ?D:/Programlar/ggplot2/ggplot2_3.0.0.tar.gz? had non-zero exit status
>
>
>
>> packageurl <- " [ https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz | https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz ] "
>> install.packages(packageurl, repos=NULL, type="source")
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> trying URL ' [ https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz | https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz ] '
>
> Content type 'application/x-gzip' length 3031461 bytes (2.9 MB)
>
> downloaded 2.9 MB
>
>
>
> * installing *source* package 'ggplot2' ...
>
> ** package 'ggplot2' successfully unpacked and MD5 sums checked
>
> ** R
>
> ** data
>
> *** moving datasets to lazyload DB
>
> ** inst
>
> ** byte-compile and prepare package for lazy loading
>
> Warning: namespace 'cli' is not available and has been replaced
>
> by .GlobalEnv when processing object 'txhousing'
>
> Error in rbind(info, getNamespaceInfo(env, "S3methods")) :
>
> number of columns of matrices must match (see arg 2)
>
> ERROR: lazy loading failed for package 'ggplot2'
>
> * removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2'
>
> In R CMD INSTALL
>
> Warning in install.packages :
>
> installation of package ?C:/Users/murat/AppData/Local/Temp/RtmpI776iL/downloaded_packages/ggplot2_3.3.0.tar.gz? had non-zero exit status
>
>
>
>> install.packages("ggplot2")
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> Warning in install.packages :
>
> unable to access index for repository [ https://cran.rstudio.com/bin/windows/contrib/3.5 | https://cran.rstudio.com/bin/windows/contrib/3.5 ] :
>
> cannot open URL ' [ https://cran.rstudio.com/bin/windows/contrib/3.5/PACKAGES | https://cran.rstudio.com/bin/windows/contrib/3.5/PACKAGES ] '
>
> installing the source package ?ggplot2?
>
>
>
> trying URL ' [ https://cran.rstudio.com/src/contrib/ggplot2_3.4.2.tar.gz | https://cran.rstudio.com/src/contrib/ggplot2_3.4.2.tar.gz ] '
>
> Content type 'application/x-gzip' length 3153811 bytes (3.0 MB)
>
> downloaded 3.0 MB
>
>
>
> * installing *source* package 'ggplot2' ...
>
> ** package 'ggplot2' successfully unpacked and MD5 sums checked
>
> ** R
>
> ** data
>
> *** moving datasets to lazyload DB
>
> ** inst
>
> ** byte-compile and prepare package for lazy loading
>
> Warning: namespace 'cli' is not available and has been replaced
>
> by .GlobalEnv when processing object 'txhousing'
>
> Error in rbind(info, getNamespaceInfo(env, "S3methods")) :
>
> number of columns of matrices must match (see arg 2)
>
> ERROR: lazy loading failed for package 'ggplot2'
>
> * removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2'
>
> In R CMD INSTALL
>
> Warning in install.packages :
>
> installation of package ?ggplot2? had non-zero exit status
>
>
>
> The downloaded source packages are in
>
> ?C:\Users\murat\AppData\Local\Temp\RtmpI776iL\downloaded_packages?
>
>
>
>> packageurl <- " [ https://cran.r-project.org/web/packages/ggplot2/index.html | https://cran.r-project.org/web/packages/ggplot2/index.html ] "
>> install.packages(packageurl, repos=NULL, type="source")
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> trying URL ' [ https://cran.r-project.org/web/packages/ggplot2/index.html | https://cran.r-project.org/web/packages/ggplot2/index.html ] '
>
> Content type 'text/html' length 468435 bytes (457 KB)
>
> downloaded 457 KB
>
>
>
> Error in getOctD(x, offset, len) : invalid octal digit
>
> In R CMD INSTALL
>
> Warning in install.packages :
>
> installation of package ?C:/Users/murat/AppData/Local/Temp/RtmpI776iL/downloaded_packages/index.html? had non-zero exit status
>
>
>
>> packageurl <- " [ https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz | https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz ] "
>> install.packages(packageurl, repos=NULL, type="source")
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> trying URL ' [ https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz | https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.3.0.tar.gz ] '
>
> Content type 'application/x-gzip' length 3031461 bytes (2.9 MB)
>
> downloaded 2.9 MB
>
>
>
> * installing *source* package 'ggplot2' ...
>
> ** package 'ggplot2' successfully unpacked and MD5 sums checked
>
> ** R
>
> ** data
>
> *** moving datasets to lazyload DB
>
> ** inst
>
> ** byte-compile and prepare package for lazy loading
>
> Warning: namespace 'cli' is not available and has been replaced
>
> by .GlobalEnv when processing object 'txhousing'
>
> Error in rbind(info, getNamespaceInfo(env, "S3methods")) :
>
> number of columns of matrices must match (see arg 2)
>
> ERROR: lazy loading failed for package 'ggplot2'
>
> * removing 'C:/Users/murat/Documents/R/win-library/3.5/ggplot2'
>
> In R CMD INSTALL
>
> Warning in install.packages :
>
> installation of package ?C:/Users/murat/AppData/Local/Temp/Rtmp8sLmoj/downloaded_packages/ggplot2_3.3.0.tar.gz? had non-zero exit status
>
>
>
>> pak::pkg_install("tibble")
> Error in load_private_package("cli") :
>
> Cannot load cli from the private library
>
>
>
>> pak::pkg_install("tidyverse/tibble")
> Error in load_private_package("cli") :
>
> Cannot load cli from the private library
>
>
>
>> pkg_install("tibble")
> Error in pkg_install("tibble") : could not find function "pkg_install"
>
>
>
>> install.packages("D:/Programlar/ggplot2/ggplot2_3.4.2.zip", repos = NULL, type = "win.binary")
> Installing package into ?C:/Users/murat/Documents/R/win-library/3.5?
>
> (as ?lib? is unspecified)
>
> package ?ggplot2? successfully unpacked and MD5 sums checked
>
>
>
> Kind Regards
>
>
> Murat Delman, Ph.D.
> Izmir Institute of Technology
> Integrated Research Centers
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
__________________________________________________
Robert W. Baer, Ph.D.
Professor of Physiolgy
Kirksville College of Osteopathic Medicine
A.T. Still University of Heallth Sciences
800 W. Jefferson St.
Kirksville, MO 63501
P: 660-626-2322


  

              

The ATSU Mission
A.T. Still University of Health Sciences serves as a learning-centered university dedicated to preparing highly competent professionals through innovative academic programs with a commitment to continue its osteopathic heritage and focus on whole person healthcare, scholarship, community health, interprofessional education, diversity, and underserved populations.

Proud recipient of INSIGHT Into Diversity?s 2017-19 Higher Education Excellence in Diversity Awards.


From g@@@uu| @end|ng |rom gm@||@com  Fri Aug 11 04:25:08 2023
From: g@@@uu| @end|ng |rom gm@||@com (ani jaya)
Date: Fri, 11 Aug 2023 11:25:08 +0900
Subject: [R] 'apply' for 0 or 1 element member.
Message-ID: <CAHXS41y6Bd5iNAinjLrfmTfub1wpGky=E=QJ76-Sn_1-FwL1-Q@mail.gmail.com>

Hello,

I try to calculate the mean of an array with a condition. My array is
B=c(181,101,420) in dimensions. And I want to find a specific member
in 3rd dimension (time monthly) based on a condition of another data
frame, A =c(420). My final array would be C=c(181,101,12) which 12 is
a monthly mean based on the condition of A.

what I tried is below but doesn't work.

#find the index with a condition larger than 0.5
index<-which(A>=0.5)
#convert the index to monthly
index1<-index%%12
#change 0 to 12 (Jan=1, Feb=2, and so on..)
index1[index1==0]<-12

for (i in 1:12){
dummy<-index[which(index1==i)]
C[,,i]<-apply(B[,,dummy],c(1,2), mean,na.rm=T)
}

The problem is when there is a month that doesnt meet the condition,
it will return 0 element.

apply(B[,,1],c(1,2), mean,na.rm=T) also produce an error.

Any solution and turnaround would be appreciated.

Thank you

Ani Jaya


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Aug 11 05:35:41 2023
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 10 Aug 2023 20:35:41 -0700
Subject: [R] 'apply' for 0 or 1 element member.
In-Reply-To: <CAHXS41y6Bd5iNAinjLrfmTfub1wpGky=E=QJ76-Sn_1-FwL1-Q@mail.gmail.com>
References: <CAHXS41y6Bd5iNAinjLrfmTfub1wpGky=E=QJ76-Sn_1-FwL1-Q@mail.gmail.com>
Message-ID: <CA94FAD4-DAE2-4AC6-834B-E2941AB7DCA8@dcn.davis.ca.us>

Define

mean0na <- function(x) {
  x[ 0 == x ] <- NA
  mean( x, na.rm = TRUE )
}

and then use that instead of mean.

On August 10, 2023 7:25:08 PM PDT, ani jaya <gaaauul at gmail.com> wrote:
>Hello,
>
>I try to calculate the mean of an array with a condition. My array is
>B=c(181,101,420) in dimensions. And I want to find a specific member
>in 3rd dimension (time monthly) based on a condition of another data
>frame, A =c(420). My final array would be C=c(181,101,12) which 12 is
>a monthly mean based on the condition of A.
>
>what I tried is below but doesn't work.
>
>#find the index with a condition larger than 0.5
>index<-which(A>=0.5)
>#convert the index to monthly
>index1<-index%%12
>#change 0 to 12 (Jan=1, Feb=2, and so on..)
>index1[index1==0]<-12
>
>for (i in 1:12){
>dummy<-index[which(index1==i)]
>C[,,i]<-apply(B[,,dummy],c(1,2), mean,na.rm=T)
>}
>
>The problem is when there is a month that doesnt meet the condition,
>it will return 0 element.
>
>apply(B[,,1],c(1,2), mean,na.rm=T) also produce an error.
>
>Any solution and turnaround would be appreciated.
>
>Thank you
>
>Ani Jaya
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From @|gbert @end|ng |rom w|w|@hu-ber||n@de  Fri Aug 11 09:20:03 2023
From: @|gbert @end|ng |rom w|w|@hu-ber||n@de (Sigbert Klinke)
Date: Fri, 11 Aug 2023 09:20:03 +0200
Subject: [R] Use generic functions, e.g. print, without UseMethod?
Message-ID: <cd97d12e-271b-5789-1c07-2ece4051268a@wiwi.hu-berlin.de>

Hello,

I have defined a function 'equations(...)' which returns an object with 
class 'equations'. I also defined a function 'print.equations' which 
prints the object. But I did not use 'equations <- function(x, ...) 
UseMethod("equations"). Two questions:

1.) Is this a sensible approach?
2.) If yes, are there any pitfalls I could run in later?

Thanks

Sigbert

-- 
https://hu.berlin/sk
https://www.stat.de/faqs
https://hu.berlin/mmstat
https://hu.berlin/mmstat-ar


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Aug 11 09:42:22 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 11 Aug 2023 10:42:22 +0300
Subject: [R] Use generic functions, e.g. print, without UseMethod?
In-Reply-To: <cd97d12e-271b-5789-1c07-2ece4051268a@wiwi.hu-berlin.de>
References: <cd97d12e-271b-5789-1c07-2ece4051268a@wiwi.hu-berlin.de>
Message-ID: <20230811104222.04b7525b@Tarkus>

On Fri, 11 Aug 2023 09:20:03 +0200
Sigbert Klinke <sigbert at wiwi.hu-berlin.de> wrote:

> I have defined a function 'equations(...)' which returns an object
> with class 'equations'.

> But I did not use 'equations <- function(x, ...)
> UseMethod("equations"). Two questions:
> 
> 1.) Is this a sensible approach?

Quite. If there is little reason for your constructor to be generic
(i.e. there is only one way to construct "equations" objects), it can
stay an ordinary R function. lm() works the same way, for example, and
so do many statistical tests and contributed model functions.

> 2.) If yes, are there any pitfalls I could run in later?

If it later turns out that you need S3 dispatch on the constructor too,
you will need to take care to design its formals to avoid breaking
compatibility with the old code. Ideally, the generic should take (x,
...), with the first argument determining the method that will be
called. If that would conflict with the already-existing code, the
generic can have a different signature and give a different object=
argument to UseMethod(), but the methods will have to follow the
signature of the generic.

-- 
Best regards,
Ivan


From chr|@ho|d @end|ng |rom p@yctc@org  Fri Aug 11 09:54:22 2023
From: chr|@ho|d @end|ng |rom p@yctc@org (Chris Evans)
Date: Fri, 11 Aug 2023 09:54:22 +0200
Subject: [R] Puzzled by results from base::rank()
Message-ID: <1513a704-2159-ab88-9e4c-94f63ac4a6ca@psyctc.org>

I understand that the default ties.method is "average".? Here is what I 
get, expanding a bit on the help page example. Running R 4.3.1 on Ubuntu 
22.04.2.

 > x2 <- c(3, 1, 4, 1, 5, 9, 2, 6, 5, 3, 5)
 > rank(x2)
 ?[1]? 4.5? 1.5? 6.0? 1.5? 8.0 11.0? 3.0 10.0? 8.0? 4.5? 8.0

OK so the ties, each of with two members, are ranked to their mean.

So now I turn one tie from a twin to a triplet:

 > x3 <- c(x2, 3)
 > rank(x3)
 ?[1]? 5.0? 1.5? 7.0? 1.5? 9.0 12.0? 3.0 11.0? 9.0? 5.0? 9.0? 5.0
 > sprintf("%4.3f", rank(x3))
 ?[1] "5.000"? "1.500"? "7.000"? "1.500"? "9.000"? "12.000" "3.000"? 
"11.000"
 ?[9] "9.000"? "5.000"? "9.000"? "5.000"

The doublet is still given the mean of the values but the triplet is 
rounded up.? What am I missing here?!

TIA,

Chris

-- 
Chris Evans (he/him)
Visiting Professor, UDLA, Quito, Ecuador & Honorary Professor, 
University of Roehampton, London, UK.
Work web site: https://www.psyctc.org/psyctc/
CORE site: http://www.coresystemtrust.org.uk/
Personal site: https://www.psyctc.org/pelerinage2016/


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Fri Aug 11 09:56:50 2023
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Fri, 11 Aug 2023 08:56:50 +0100
Subject: [R] Use generic functions, e.g. print, without UseMethod?
In-Reply-To: <cd97d12e-271b-5789-1c07-2ece4051268a@wiwi.hu-berlin.de>
References: <cd97d12e-271b-5789-1c07-2ece4051268a@wiwi.hu-berlin.de>
Message-ID: <76ab0428-2305-6f74-94b9-bd6e63feb087@sapo.pt>

?s 08:20 de 11/08/2023, Sigbert Klinke escreveu:
> Hello,
> 
> I have defined a function 'equations(...)' which returns an object with 
> class 'equations'. I also defined a function 'print.equations' which 
> prints the object. But I did not use 'equations <- function(x, ...) 
> UseMethod("equations"). Two questions:
> 
> 1.) Is this a sensible approach?
> 2.) If yes, are there any pitfalls I could run in later?
> 
> Thanks
> 
> Sigbert
> 
Hello,

You have to ask yourself what kind of objects are you passing to 
'equations(...)'?
Do you need to have

'equations.double(...)'
'equations.character(...)'
'equations.formula(...)'
'equations.matrix(...)'
[...]

specifically written for objects of class

numeric
character
formula
matrix
[...]

respectively?
These methods would act on the respective class, process those objects 
somewhat differently because they are of different classes and output an 
object of class "equation".
(If so, it is recommended to write a 'equations.default(...)' too.)

Methods such as print.equation or summary.equation are written when you 
want your new class to have functionality your new class' users are 
familiar with.

If, for instance, autoprint is on as it frequently is, users can see 
their "equation" by typing its name at a prompt. print.equation would 
display the "equation" in a way relevant to that new class.

But this does not mean that the function that *creates* the object needs 
to be generic, you only need a new generic to have methods processing 
inputs of different classes in ways specific to those classes.

Hope this helps,

Rui Barradas


From gerr|t@e|chner @end|ng |rom m@th@un|-g|e@@en@de  Fri Aug 11 10:31:46 2023
From: gerr|t@e|chner @end|ng |rom m@th@un|-g|e@@en@de (Gerrit Eichner)
Date: Fri, 11 Aug 2023 10:31:46 +0200
Subject: [R] Puzzled by results from base::rank()
In-Reply-To: <1513a704-2159-ab88-9e4c-94f63ac4a6ca@psyctc.org>
References: <1513a704-2159-ab88-9e4c-94f63ac4a6ca@psyctc.org>
Message-ID: <e202f9b3-221a-390f-6d8b-b002cc5478a6@math.uni-giessen.de>

Dear Chris,

the members of the triplet would be ranked 4, 5 and 6 (in your example), 
so the *mean of their ranks* is correctly 5.

For any set of k tied values the ranks of its elements are averaged (and 
assigned to each of its k members).

  Hth  --  Gerrit

---------------------------------------------------------------------
Dr. Gerrit Eichner                   Mathematical Institute, Room 215
gerrit.eichner at math.uni-giessen.de   Justus-Liebig-University Giessen
Tel: +49-(0)641-99-32104          Arndtstr. 2, 35392 Giessen, Germany
http://www.uni-giessen.de/eichner
---------------------------------------------------------------------

Am 11.08.2023 um 09:54 schrieb Chris Evans via R-help:
> I understand that the default ties.method is "average".? Here is what I 
> get, expanding a bit on the help page example. Running R 4.3.1 on Ubuntu 
> 22.04.2.
> 
>  > x2 <- c(3, 1, 4, 1, 5, 9, 2, 6, 5, 3, 5)
>  > rank(x2)
>  ?[1]? 4.5? 1.5? 6.0? 1.5? 8.0 11.0? 3.0 10.0? 8.0? 4.5? 8.0
> 
> OK so the ties, each of with two members, are ranked to their mean.
> 
> So now I turn one tie from a twin to a triplet:
> 
>  > x3 <- c(x2, 3)
>  > rank(x3)
>  ?[1]? 5.0? 1.5? 7.0? 1.5? 9.0 12.0? 3.0 11.0? 9.0? 5.0? 9.0? 5.0
>  > sprintf("%4.3f", rank(x3))
>  ?[1] "5.000"? "1.500"? "7.000"? "1.500"? "9.000"? "12.000" "3.000" 
> "11.000"
>  ?[9] "9.000"? "5.000"? "9.000"? "5.000"
> 
> The doublet is still given the mean of the values but the triplet is 
> rounded up.? What am I missing here?!
> 
> TIA,
> 
> Chris
>


From tebert @end|ng |rom u||@edu  Fri Aug 11 14:32:06 2023
From: tebert @end|ng |rom u||@edu (Ebert,Timothy Aaron)
Date: Fri, 11 Aug 2023 12:32:06 +0000
Subject: [R] Puzzled by results from base::rank()
In-Reply-To: <e202f9b3-221a-390f-6d8b-b002cc5478a6@math.uni-giessen.de>
References: <1513a704-2159-ab88-9e4c-94f63ac4a6ca@psyctc.org>
 <e202f9b3-221a-390f-6d8b-b002cc5478a6@math.uni-giessen.de>
Message-ID: <CH3PR22MB45141DF1633B3622544E6005CF10A@CH3PR22MB4514.namprd22.prod.outlook.com>

I have entered values into Excel, and sorted them. I am assuming you are asking why the value 3 in x2 is ranked 4.5 versus in x5 it has a rank of 5.
X2 looks like this
Value   Rank    Order
1       1.5     1
1       1.5     2
2       3       3
3       4.5     4
3       4.5     5
4       6       6
5       8       7
5       8       8
5       8       9
6       10      10
9       11      11

The average of 4 and 5 is 4.5.

For x3 we have:

Value   Rank    Order
1       1.5     1
1       1.5     2
2       3       3
3       5       4
3       5       5
3       5       6
4       7       7
5       9       8
5       9       9
5       9       10
6       11      11
9       12      12

The ranks of the threes are 4, 5, and 6 and the average is 5.
For any set of values adding one value that is the same as an existing value will always increase the rank of that value. It has not been rounded up, though it may look that way in the example. If you add another 3 to the data the rank will increase to 5.5, and adding another three will give a rank of 6. Each additional 3 will boost the rank by 0.5.

You can get a different result if you change a value. If there is a mistake in the data and I discover that the second 1 in x2 should be a 3, then the rank for 3 is 4 and it looks like I have rounded down. If the mistake happened for a value greater than 3 then it would again look like I had rounded up. However, the appearance of "rounding" is an illusion easily seen through if you expand your example to generalize the outcome.



Tim

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Gerrit Eichner
Sent: Friday, August 11, 2023 4:32 AM
To: r-help at r-project.org
Subject: Re: [R] Puzzled by results from base::rank()

[External Email]

Dear Chris,

the members of the triplet would be ranked 4, 5 and 6 (in your example), so the *mean of their ranks* is correctly 5.

For any set of k tied values the ranks of its elements are averaged (and assigned to each of its k members).

  Hth  --  Gerrit

---------------------------------------------------------------------
Dr. Gerrit Eichner                   Mathematical Institute, Room 215
gerrit.eichner at math.uni-giessen.de   Justus-Liebig-University Giessen
Tel: +49-(0)641-99-32104          Arndtstr. 2, 35392 Giessen, Germany
http://www.uni-giessen.de/eichner
---------------------------------------------------------------------

Am 11.08.2023 um 09:54 schrieb Chris Evans via R-help:
> I understand that the default ties.method is "average".  Here is what
> I get, expanding a bit on the help page example. Running R 4.3.1 on
> Ubuntu 22.04.2.
>
>  > x2 <- c(3, 1, 4, 1, 5, 9, 2, 6, 5, 3, 5)  > rank(x2)
>   [1]  4.5  1.5  6.0  1.5  8.0 11.0  3.0 10.0  8.0  4.5  8.0
>
> OK so the ties, each of with two members, are ranked to their mean.
>
> So now I turn one tie from a twin to a triplet:
>
>  > x3 <- c(x2, 3)
>  > rank(x3)
>   [1]  5.0  1.5  7.0  1.5  9.0 12.0  3.0 11.0  9.0  5.0  9.0  5.0  >
> sprintf("%4.3f", rank(x3))
>   [1] "5.000"  "1.500"  "7.000"  "1.500"  "9.000"  "12.000" "3.000"
> "11.000"
>   [9] "9.000"  "5.000"  "9.000"  "5.000"
>
> The doublet is still given the mean of the values but the triplet is
> rounded up.  What am I missing here?!
>
> TIA,
>
> Chris
>

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.r-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From @te|@no@@o||@ @end|ng |rom reg|one@m@rche@|t  Fri Aug 11 15:36:14 2023
From: @te|@no@@o||@ @end|ng |rom reg|one@m@rche@|t (Stefano Sofia)
Date: Fri, 11 Aug 2023 13:36:14 +0000
Subject: [R] group consecutive dates in a row
In-Reply-To: <CAP01uR=Rc8aTzzXarp2D8RtBi1gToH8ZzVNUrr8DwrPfDv-H+Q@mail.gmail.com>
References: <8a813abd71a3430ba64edc87d6046ec7@regione.marche.it>,
 <CAP01uR=Rc8aTzzXarp2D8RtBi1gToH8ZzVNUrr8DwrPfDv-H+Q@mail.gmail.com>
Message-ID: <fe5afb542b13417cbd624312feaf0475@regione.marche.it>

Thank you for your hints.

All of them have been useful, and you solved my problem.

I understood the role of rle, but I think that for my task its use is not fundamental.


I will put more attention on looking for the existing documentation.

Thank you again

Stefano


         (oo)
--oOO--( )--OOo--------------------------------------
Stefano Sofia PhD
Civil Protection - Marche Region - Italy
Meteo Section
Snow Section
Via del Colle Ameno 5
60126 Torrette di Ancona, Ancona (AN)
Uff: +39 071 806 7743
E-mail: stefano.sofia at regione.marche.it
---Oo---------oO----------------------------------------


________________________________
Da: Gabor Grothendieck <ggrothendieck at gmail.com>
Inviato: luned? 7 agosto 2023 20:30
A: Stefano Sofia
Cc: r-help at R-project.org
Oggetto: Re: [R] group consecutive dates in a row

It is best to use Date, rather than POSIXct, class if there are no times.

Use the cumsum expression shown to group the dates and then summarize
each group.

We assume that the dates are already sorted in ascending order.

  library(dplyr)

  mydf <- data.frame(date = as.Date(c("2012-02-05", "2012-02-06",
"2012-02-07", "2012-02-13", "2012-02-21")))

  mydf %>%
    group_by(grp = cumsum(c(0, diff(date)) > 1)) %>%
    summarize(start = first(date), end = last(date)) %>%
    ungroup %>%
    select(-grp)
  ## # A tibble: 3 ? 2
  ##   start      end
  ##   <date>     <date>
  ## 1 2012-02-05 2012-02-07
  ## 2 2012-02-13 2012-02-13
  ## 3 2012-02-21 2012-02-21

or with only base R:

  smrz <- function(x) with(x, data.frame(start = min(date), end = max(date)))
  do.call("rbind", by(mydf, cumsum(c(0, diff(mydf$date)) > 1), smrz))
  ##        start        end
  ## 0 2012-02-05 2012-02-07
  ## 1 2012-02-13 2012-02-13
  ## 2 2012-02-21 2012-02-21


On Mon, Aug 7, 2023 at 12:42?PM Stefano Sofia
<stefano.sofia at regione.marche.it> wrote:
>
> Dear R users,
>
> I have a data frame with a single column of POSIXct elements, like
>
>
> mydf <- data.frame(data_POSIX=as.POSIXct(c("2012-02-05", "2012-02-06", "2012-02-07", "2012-02-13", "2012-02-21"), format = "%Y-%m-%d", tz="Etc/GMT-1"))
>
>
> I need to transform it in a two-columns data frame where I can get rid of consecutive dates. It should appear like
>
>
> data_POSIX_init data_POSIX_fin
>
> 2012-02-05 2012-02-07
>
> 2012-02-13 NA
>
> 2012-02-21 NA
>
>
> I started with two "while cycles" and so on, but this is not an efficient way to do it.
>
> Could you please give me an hint on how to proceed?
>
>
> Thank you for your precious attention and help
>
> Stefano
>
>
>          (oo)
> --oOO--( )--OOo--------------------------------------
> Stefano Sofia PhD
> Civil Protection - Marche Region - Italy
> Meteo Section
> Snow Section
> Via del Colle Ameno 5
> 60126 Torrette di Ancona, Ancona (AN)
> Uff: +39 071 806 7743
> E-mail: stefano.sofia at regione.marche.it
> ---Oo---------oO----------------------------------------
>
> ________________________________
>
> AVVISO IMPORTANTE: Questo messaggio di posta elettronica pu? contenere informazioni confidenziali, pertanto ? destinato solo a persone autorizzate alla ricezione. I messaggi di posta elettronica per i client di Regione Marche possono contenere informazioni confidenziali e con privilegi legali. Se non si ? il destinatario specificato, non leggere, copiare, inoltrare o archiviare questo messaggio. Se si ? ricevuto questo messaggio per errore, inoltrarlo al mittente ed eliminarlo completamente dal sistema del proprio computer. Ai sensi dell'art. 6 della DGR n. 1394/2008 si segnala che, in caso di necessit? ed urgenza, la risposta al presente messaggio di posta elettronica pu? essere visionata da persone estranee al destinatario.
> IMPORTANT NOTICE: This e-mail message is intended to be received only by persons entitled to receive the confidential information it may contain. E-mail messages to clients of Regione Marche may contain information that is confidential and legally privileged. Please do not read, copy, forward, or store this message unless you are an intended recipient of it. If you have received this message in error, please forward it to the sender and delete it completely from your computer system.
>
> --
> Questo messaggio  stato analizzato da Libraesva ESG ed  risultato non infetto.
> This message was scanned by Libraesva ESG and is believed to be clean.
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>  https://urlsand.esvalabs.com/?u=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&e=a1c37615&h=997ca565&f=y&p=y
> PLEASE do read the posting guide  https://urlsand.esvalabs.com/?u=http%3A%2F%2Fwww.R-project.org%2Fposting-guide.html&e=a1c37615&h=5a0f7b62&f=y&p=y
> and provide commented, minimal, self-contained, reproducible code.



--
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com

--

Questo messaggio  stato analizzato con Libraesva ESG ed  risultato non infetto.


________________________________

AVVISO IMPORTANTE: Questo messaggio di posta elettronica pu? contenere informazioni confidenziali, pertanto ? destinato solo a persone autorizzate alla ricezione. I messaggi di posta elettronica per i client di Regione Marche possono contenere informazioni confidenziali e con privilegi legali. Se non si ? il destinatario specificato, non leggere, copiare, inoltrare o archiviare questo messaggio. Se si ? ricevuto questo messaggio per errore, inoltrarlo al mittente ed eliminarlo completamente dal sistema del proprio computer. Ai sensi dell?art. 6 della DGR n. 1394/2008 si segnala che, in caso di necessit? ed urgenza, la risposta al presente messaggio di posta elettronica pu? essere visionata da persone estranee al destinatario.
IMPORTANT NOTICE: This e-mail message is intended to be received only by persons entitled to receive the confidential information it may contain. E-mail messages to clients of Regione Marche may contain information that is confidential and legally privileged. Please do not read, copy, forward, or store this message unless you are an intended recipient of it. If you have received this message in error, please forward it to the sender and delete it completely from your computer system.

--
Questo messaggio  stato analizzato da Libraesva ESG ed  risultato non infetto.
This message was scanned by Libraesva ESG and is believed to be clean.


	[[alternative HTML version deleted]]


From jc@chop| @end|ng |rom hotm@||@com  Fri Aug 11 12:20:27 2023
From: jc@chop| @end|ng |rom hotm@||@com (James C Schopf)
Date: Fri, 11 Aug 2023 10:20:27 +0000
Subject: [R] Different TFIDF settings in test set prevent testing model
Message-ID: <DM4PR12MB5391AF04D8988BAB28F976CEC710A@DM4PR12MB5391.namprd12.prod.outlook.com>

Hello, I'd be very grateful for your help.

I randomly separated a .csv file with 1287 documents 75%/25% into 2 csv files, one for training an algorithm and the other for testing the algorithm.  I applied similar preprocessing, including TFIDF transformation, to both sets, but R won't let me make predictions on the test set due to a different TFIDF matrix.
I get the error message:

Error: variable 'text_tfidf' was fitted with type "nmatrix.67503" but type "nmatrix.27118" was supplied

I'd greatly appreciate a suggestion to overcome this problem.
Thanks!


Here's my R codes:

> library(tidyverse)
> library(tidytext)
> library(caret)
> library(kernlab)
> library(tokenizers)
> library(tm)
> library(e1071)

***LOAD TRAINING SET/959 rows with text in column1 and yes/no in column2 (labelled M2)
> url <- "D:/test/M2_75.csv"
> d <- read_csv(url)
***CREATE TEXT CORPUS FROM TEXT COLUMN
> train_text_corpus <- Corpus(VectorSource(d$Text))
***DEFINE TOKENS FOR EACH DOCUMENT IN CORPUS AND COMBINE THEM
> tokenize_document <- function(doc) {
+     doc_tokens <- unlist(tokenize_words(doc))
+     doc_bigrams <- unlist(tokenize_ngrams(doc, n = 2))
+     doc_trigrams <- unlist(tokenize_ngrams(doc, n = 3))
+     all_tokens <- c(doc_tokens, doc_bigrams, doc_trigrams)
+     return(all_tokens)
+ }
***APPLY TOKENS TO DOCUMENTS
> all_train_tokens <- lapply(train_text_corpus, tokenize_document)
***CREATE A DTM FROM THE TOKENS
> train_text_dtm <- DocumentTermMatrix(Corpus(VectorSource(all_train_tokens)))
***TRANSFORM THE DTM INTO A TF-IDF MATRIX
> train_text_tfidf <- weightTfIdf(train_text_dtm)
***CREATE A NEW DATA FRAME WITH M2 COLUMN FROM ORIGINAL DATA
> trainData <- data.frame(M2 = d$M2)
***ADD NEW TFIDF transformed TEXT COLUMN NEXT TO DATA FRAME
> trainData$text_tfidf <- I(as.matrix(train_text_tfidf))
***DEFINE THE ML MODEL
> ctrl <- trainControl(method = "repeatedcv", number = 5, repeats = 2, classProbs = TRUE)
***TRAIN SVM
> model_svmRadial <- train(M2 ~ ., data = trainData, method = "svmRadial", trControl = ctrl)
***SAVE SVM
> saveRDS(model_svmRadial, file = "D:/SML/model_M23_svmRadial_UP.RDS")

R code on my test set, which didn't work at last step:

***LOAD TEST SET/ 309 rows with text in column1 and yes/no in column2 (labelled M2)
> url <- "D:/test/M2_25.csv"
> d <- read_csv(url)
***CREATE TEXT CORPUS FROM TEXT COLUMN
> test_text_corpus <- Corpus(VectorSource(d$Text))
***DEFINE TOKENS FOR EACH DOCUMENT IN CORPUS AND COMBINE THEM
> tokenize_document <- function(doc) {
     doc_tokens <- unlist(tokenize_words(doc))
     doc_bigrams <- unlist(tokenize_ngrams(doc, n = 2))
     doc_trigrams <- unlist(tokenize_ngrams(doc, n = 3))
     all_tokens <- c(doc_tokens, doc_bigrams, doc_trigrams)
     return(all_tokens)
 }
***APPLY TOKEN TO DOCUMENTS
> all_test_tokens <- lapply(test_text_corpus, tokenize_document)
***CREATE A DTM FROM THE TOKENS
> test_text_dtm <- DocumentTermMatrix(Corpus(VectorSource(all_test_tokens)))
***TRANSFORM THE DTM INTO A TF-IDF MATRIX
> test_text_tfidf <- weightTfIdf(test_text_dtm)
***CREATE A NEW DATA WITH M2 COLUMN FROM ORIGINAL TEST DATA
> testData <- data.frame(M2 = d$M2)
***ADD NEW TFIDF transformed TEXT COLUMN NEXT TO TEST DATA
> testData$text_tfidf <- I(as.matrix(test_text_tfidf))
***LOAD OLD MODEL
model_svmRadial <- readRDS("D:/SML/model_M2_75_svmRadial.RDS")
 ***MAKE PREDICTIONS
predictions <- predict(model_svmRadial, newdata = testData)

This last line produces the error message:

Error: variable 'text_tfidf' was fitted with type "nmatrix.67503" but type "nmatrix.27118" was supplied

Please help.  Thanks!








	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Fri Aug 11 17:09:28 2023
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 11 Aug 2023 08:09:28 -0700
Subject: [R] Different TFIDF settings in test set prevent testing model
In-Reply-To: <DM4PR12MB5391AF04D8988BAB28F976CEC710A@DM4PR12MB5391.namprd12.prod.outlook.com>
References: <DM4PR12MB5391AF04D8988BAB28F976CEC710A@DM4PR12MB5391.namprd12.prod.outlook.com>
Message-ID: <CAGxFJbQ__S2+f+N_cgK0p7ZWLkEOV2Ams+9dkSGhtBeMuvARKA@mail.gmail.com>

I know nothing about tf, etc., but can you not simply read in the whole
file into R and then randomly split using R? The training and test sets
would simply be defined by a single random sample of subscripts which is
either chosen or not.

e.g. (simplified example -- you would be subsetting the rows of your full
dataset):

> x<- 1:10
> samp <- sort(sample(x,5))
> x[samp] ## training
[1] 3 4 6 7 8
> x[-samp] ## test
[1]  1  2  5  9 10

Apologies if my ignorance means this can't work.

Cheers,
Bert


On Fri, Aug 11, 2023 at 7:17?AM James C Schopf <jcschopf at hotmail.com> wrote:

> Hello, I'd be very grateful for your help.
>
> I randomly separated a .csv file with 1287 documents 75%/25% into 2 csv
> files, one for training an algorithm and the other for testing the
> algorithm.  I applied similar preprocessing, including TFIDF
> transformation, to both sets, but R won't let me make predictions on the
> test set due to a different TFIDF matrix.
> I get the error message:
>
> Error: variable 'text_tfidf' was fitted with type "nmatrix.67503" but type
> "nmatrix.27118" was supplied
>
> I'd greatly appreciate a suggestion to overcome this problem.
> Thanks!
>
>
> Here's my R codes:
>
> > library(tidyverse)
> > library(tidytext)
> > library(caret)
> > library(kernlab)
> > library(tokenizers)
> > library(tm)
> > library(e1071)
>
> ***LOAD TRAINING SET/959 rows with text in column1 and yes/no in column2
> (labelled M2)
> > url <- "D:/test/M2_75.csv"
> > d <- read_csv(url)
> ***CREATE TEXT CORPUS FROM TEXT COLUMN
> > train_text_corpus <- Corpus(VectorSource(d$Text))
> ***DEFINE TOKENS FOR EACH DOCUMENT IN CORPUS AND COMBINE THEM
> > tokenize_document <- function(doc) {
> +     doc_tokens <- unlist(tokenize_words(doc))
> +     doc_bigrams <- unlist(tokenize_ngrams(doc, n = 2))
> +     doc_trigrams <- unlist(tokenize_ngrams(doc, n = 3))
> +     all_tokens <- c(doc_tokens, doc_bigrams, doc_trigrams)
> +     return(all_tokens)
> + }
> ***APPLY TOKENS TO DOCUMENTS
> > all_train_tokens <- lapply(train_text_corpus, tokenize_document)
> ***CREATE A DTM FROM THE TOKENS
> > train_text_dtm <-
> DocumentTermMatrix(Corpus(VectorSource(all_train_tokens)))
> ***TRANSFORM THE DTM INTO A TF-IDF MATRIX
> > train_text_tfidf <- weightTfIdf(train_text_dtm)
> ***CREATE A NEW DATA FRAME WITH M2 COLUMN FROM ORIGINAL DATA
> > trainData <- data.frame(M2 = d$M2)
> ***ADD NEW TFIDF transformed TEXT COLUMN NEXT TO DATA FRAME
> > trainData$text_tfidf <- I(as.matrix(train_text_tfidf))
> ***DEFINE THE ML MODEL
> > ctrl <- trainControl(method = "repeatedcv", number = 5, repeats = 2,
> classProbs = TRUE)
> ***TRAIN SVM
> > model_svmRadial <- train(M2 ~ ., data = trainData, method = "svmRadial",
> trControl = ctrl)
> ***SAVE SVM
> > saveRDS(model_svmRadial, file = "D:/SML/model_M23_svmRadial_UP.RDS")
>
> R code on my test set, which didn't work at last step:
>
> ***LOAD TEST SET/ 309 rows with text in column1 and yes/no in column2
> (labelled M2)
> > url <- "D:/test/M2_25.csv"
> > d <- read_csv(url)
> ***CREATE TEXT CORPUS FROM TEXT COLUMN
> > test_text_corpus <- Corpus(VectorSource(d$Text))
> ***DEFINE TOKENS FOR EACH DOCUMENT IN CORPUS AND COMBINE THEM
> > tokenize_document <- function(doc) {
>      doc_tokens <- unlist(tokenize_words(doc))
>      doc_bigrams <- unlist(tokenize_ngrams(doc, n = 2))
>      doc_trigrams <- unlist(tokenize_ngrams(doc, n = 3))
>      all_tokens <- c(doc_tokens, doc_bigrams, doc_trigrams)
>      return(all_tokens)
>  }
> ***APPLY TOKEN TO DOCUMENTS
> > all_test_tokens <- lapply(test_text_corpus, tokenize_document)
> ***CREATE A DTM FROM THE TOKENS
> > test_text_dtm <-
> DocumentTermMatrix(Corpus(VectorSource(all_test_tokens)))
> ***TRANSFORM THE DTM INTO A TF-IDF MATRIX
> > test_text_tfidf <- weightTfIdf(test_text_dtm)
> ***CREATE A NEW DATA WITH M2 COLUMN FROM ORIGINAL TEST DATA
> > testData <- data.frame(M2 = d$M2)
> ***ADD NEW TFIDF transformed TEXT COLUMN NEXT TO TEST DATA
> > testData$text_tfidf <- I(as.matrix(test_text_tfidf))
> ***LOAD OLD MODEL
> model_svmRadial <- readRDS("D:/SML/model_M2_75_svmRadial.RDS")
>  ***MAKE PREDICTIONS
> predictions <- predict(model_svmRadial, newdata = testData)
>
> This last line produces the error message:
>
> Error: variable 'text_tfidf' was fitted with type "nmatrix.67503" but type
> "nmatrix.27118" was supplied
>
> Please help.  Thanks!
>
>
>
>
>
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Aug 11 17:49:35 2023
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 11 Aug 2023 18:49:35 +0300
Subject: [R] Different TFIDF settings in test set prevent testing model
In-Reply-To: <DM4PR12MB5391AF04D8988BAB28F976CEC710A@DM4PR12MB5391.namprd12.prod.outlook.com>
References: <DM4PR12MB5391AF04D8988BAB28F976CEC710A@DM4PR12MB5391.namprd12.prod.outlook.com>
Message-ID: <20230811184935.1f69c5c0@arachnoid>

? Fri, 11 Aug 2023 10:20:27 +0000
James C Schopf <jcschopf at hotmail.com> ?????:

> > train_text_dtm <-
> > DocumentTermMatrix(Corpus(VectorSource(all_train_tokens)))  

> > test_text_dtm <-
> > DocumentTermMatrix(Corpus(VectorSource(all_test_tokens)))

I understand the need to prepare the test dataset separately
(e.g. in order to be able to work with text that don't exist at the
time when model is trained), but since the model has no representation
for tokens it (well, the tokeniser) hasn't seen during the training
process, you have to ensure that test_text_dtm references exactly the
same tokens as train_text_dtm, in the same order of the columns.

Also, it probably makes sense to reuse the term frequency learned on
the training document set; otherwise you may be importance-weighting
different tokens than ones your SVM has learned as important if your
test set has a significantly different distribution from that of the
training set.

Bert is probably right: with the API given by the tm package, it's
seems easiest to tokenise and weight document-term matrices first, then
split them into the train and test subsets. It may be worth asking the
maintainer about applying previously "learned" transformations to new
corpora.

-- 
Best regards,
Ivan


From jc@chop| @end|ng |rom hotm@||@com  Sat Aug 12 01:25:58 2023
From: jc@chop| @end|ng |rom hotm@||@com (James C Schopf)
Date: Fri, 11 Aug 2023 23:25:58 +0000
Subject: [R] Different TFIDF settings in test set prevent testing model
In-Reply-To: <20230811184935.1f69c5c0@arachnoid>
References: <DM4PR12MB5391AF04D8988BAB28F976CEC710A@DM4PR12MB5391.namprd12.prod.outlook.com>
 <20230811184935.1f69c5c0@arachnoid>
Message-ID: <DM4PR12MB539122CB5664520DBAA48344C710A@DM4PR12MB5391.namprd12.prod.outlook.com>

Thank you Bert and Ivan,

I was building the SVM model in hopes of applying it to future cases and hoped that the model would be able to deal with new words it hadn't encountered during training.   But I tried Bert's suggestion by converting all of the data to tokens, creating a DTM, transforming the whole thing with TFI DF, and then separating it 75%/25%.  But when I began to train the SVM on the training data, R said it needed 26GB for a vector and crashed. I tried again, it crashed again.    I don't know why this would happen.  I'd just trained 4 SVM models using my previous method without any memory trouble on my 8GB CPU.    I unsuccessfully tried to remove the new words from the new test data. Should I try that?  Is there a way to stop my system from crashing with the new method?

Thank you for any ideas.

Here is the code I used when I separated the data after converting to tokens and applying TFI DF:

url <- "D:/test/M2.csv"
data <- read_csv(url)
text_corpus <- Corpus(VectorSource(data$Text))
tokenize_document <- function(doc) {
doc_tokens <- unlist(tokenize_words(doc))
doc_bigrams <- unlist(tokenize_ngrams(doc, n = 2))
doc_trigrams <- unlist(tokenize_ngrams(doc, n = 3))
all_tokens <- c(doc_tokens, doc_bigrams, doc_trigrams)
return(all_tokens)
}
all_tokens <- lapply(text_corpus, tokenize_document)
text_dtm <- DocumentTermMatrix(Corpus(VectorSource(all_tokens)))
text_tfidf <- weightTfIdf(text_dtm)
processed_data <- data.frame(M2 = data$M2, text_tfidf = as.matrix(text_tfidf))
indexes <- createDataPartition(processed_data$M2, p = 0.75, list = FALSE)
trainData <- processed_data[indexes,]
testData <- processed_data[-indexes,]
ctrl <- trainControl(method = "repeatedcv", number = 5, repeats = 2, classProbs = TRUE)
model_svmRadial <- train(M2 ~ ., data = trainData, method = "svmRadial", trControl = ctrl)






________________________________
From: Ivan Krylov <krylov.r00t at gmail.com>
Sent: Saturday, August 12, 2023 12:49 AM
To: James C Schopf <jcschopf at hotmail.com>
Cc: r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] Different TFIDF settings in test set prevent testing model

? Fri, 11 Aug 2023 10:20:27 +0000
James C Schopf <jcschopf at hotmail.com> ?????:

> > train_text_dtm <-
> > DocumentTermMatrix(Corpus(VectorSource(all_train_tokens)))

> > test_text_dtm <-
> > DocumentTermMatrix(Corpus(VectorSource(all_test_tokens)))

I understand the need to prepare the test dataset separately
(e.g. in order to be able to work with text that don't exist at the
time when model is trained), but since the model has no representation
for tokens it (well, the tokeniser) hasn't seen during the training
process, you have to ensure that test_text_dtm references exactly the
same tokens as train_text_dtm, in the same order of the columns.

Also, it probably makes sense to reuse the term frequency learned on
the training document set; otherwise you may be importance-weighting
different tokens than ones your SVM has learned as important if your
test set has a significantly different distribution from that of the
training set.

Bert is probably right: with the API given by the tm package, it's
seems easiest to tokenise and weight document-term matrices first, then
split them into the train and test subsets. It may be worth asking the
maintainer about applying previously "learned" transformations to new
corpora.

--
Best regards,
Ivan

	[[alternative HTML version deleted]]


From tg@77m @end|ng |rom y@hoo@com  Sat Aug 12 06:17:42 2023
From: tg@77m @end|ng |rom y@hoo@com (Thomas Subia)
Date: Sat, 12 Aug 2023 04:17:42 +0000 (UTC)
Subject: [R] geom_smooth
References: <1136721510.3518437.1691813862437.ref@mail.yahoo.com>
Message-ID: <1136721510.3518437.1691813862437@mail.yahoo.com>

Colleagues,

Here is my reproducible code for a graph using geom_smooth
set.seed(55)
scatter_data <- tibble(x_var = runif(100, min = 0, max = 25)
?????????????????????? ,y_var = log2(x_var) + rnorm(100))

library(ggplot2)
library(cowplot)

ggplot(scatter_data,aes(x=x_var,y=y_var))+
? geom_point()+
? geom_smooth(se=TRUE,fill="blue",color="black",linetype="dashed")+
? theme_cowplot()

I'd like to add a black boundary around the shaded area. I suspect this can be done with geom_ribbon but I cannot figure this out. Some advice would be welcome.

Thanks!

Thomas Subia


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Aug 12 07:11:58 2023
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 12 Aug 2023 06:11:58 +0100
Subject: [R] geom_smooth
In-Reply-To: <1136721510.3518437.1691813862437@mail.yahoo.com>
References: <1136721510.3518437.1691813862437.ref@mail.yahoo.com>
 <1136721510.3518437.1691813862437@mail.yahoo.com>
Message-ID: <83f7dd9e-b5f7-954b-593a-71f33d0ea148@sapo.pt>

?s 05:17 de 12/08/2023, Thomas Subia via R-help escreveu:
> Colleagues,
> 
> Here is my reproducible code for a graph using geom_smooth
> set.seed(55)
> scatter_data <- tibble(x_var = runif(100, min = 0, max = 25)
>  ?????????????????????? ,y_var = log2(x_var) + rnorm(100))
> 
> library(ggplot2)
> library(cowplot)
> 
> ggplot(scatter_data,aes(x=x_var,y=y_var))+
>  ? geom_point()+
>  ? geom_smooth(se=TRUE,fill="blue",color="black",linetype="dashed")+
>  ? theme_cowplot()
> 
> I'd like to add a black boundary around the shaded area. I suspect this can be done with geom_ribbon but I cannot figure this out. Some advice would be welcome.
> 
> Thanks!
> 
> Thomas Subia
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Here is a solution. You ,ust access the computed variables, which you 
can with ?ggplot_build.
Then pass them in the data argument.



p <- ggplot(scatter_data,aes(x=x_var,y=y_var)) +
   geom_point()+
   geom_smooth(se=TRUE,fill="blue",color="black",linetype="dashed")+
   theme_cowplot()

# this is a data.frame, relevant columns are x,  ymin and ymax
fit <- ggplot_build(p)$data[[2]]

p +
   geom_line(data = fit, aes(x, ymin), linetype = "dashed", linewidth = 1) +
   geom_line(data = fit, aes(x, ymax), linetype = "dashed", linewidth = 1)


Hope this helps,

Rui Barradas


From berw|n@tur|@ch @end|ng |rom gm@||@com  Sat Aug 12 08:08:29 2023
From: berw|n@tur|@ch @end|ng |rom gm@||@com (Berwin A Turlach)
Date: Sat, 12 Aug 2023 14:08:29 +0800
Subject: [R] geom_smooth
In-Reply-To: <1136721510.3518437.1691813862437@mail.yahoo.com>
References: <1136721510.3518437.1691813862437.ref@mail.yahoo.com>
 <1136721510.3518437.1691813862437@mail.yahoo.com>
Message-ID: <20230812140829.507fa247@absentia>

G'day Thomas,

On Sat, 12 Aug 2023 04:17:42 +0000 (UTC)
Thomas Subia via R-help <r-help at r-project.org> wrote:

> Here is my reproducible code for a graph using geom_smooth

The call "library(tidyverse)" was missing. :)

> I'd like to add a black boundary around the shaded area. I suspect
> this can be done with geom_ribbon but I cannot figure this out. Some
> advice would be welcome.

This works for me:

ggplot(scatter_data,aes(x=x_var,y=y_var,))+
  geom_point()+
  geom_smooth(se=TRUE,fill="blue",color="black",linetype="dashed") +
  geom_ribbon(stat="smooth", aes(ymin=after_stat(ymin), ymax=after_stat(ymax)), fill=NA, color="black")+
  theme_cowplot()

Cheers,
	
	Berwin


From po|c1410 @end|ng |rom gm@||@com  Sat Aug 12 08:22:40 2023
From: po|c1410 @end|ng |rom gm@||@com (CALUM POLWART)
Date: Sat, 12 Aug 2023 07:22:40 +0100
Subject: [R] geom_smooth
In-Reply-To: <83f7dd9e-b5f7-954b-593a-71f33d0ea148@sapo.pt>
References: <1136721510.3518437.1691813862437.ref@mail.yahoo.com>
 <1136721510.3518437.1691813862437@mail.yahoo.com>
 <83f7dd9e-b5f7-954b-593a-71f33d0ea148@sapo.pt>
Message-ID: <CA+etgPmr=3mibyEdTZy+BxRkaFN+poEZvVW6YWHBM7mUzjTSuw@mail.gmail.com>

+ geom_ribbon(stat = "smooth",
              se = TRUE,
              alpha = 0, # or, use fill = NA
              colour = "black",
              linetype = "dotted")

Does that work?



On Sat, 12 Aug 2023, 06:12 Rui Barradas, <ruipbarradas at sapo.pt> wrote:

> ?s 05:17 de 12/08/2023, Thomas Subia via R-help escreveu:
> > Colleagues,
> >
> > Here is my reproducible code for a graph using geom_smooth
> > set.seed(55)
> > scatter_data <- tibble(x_var = runif(100, min = 0, max = 25)
> >                         ,y_var = log2(x_var) + rnorm(100))
> >
> > library(ggplot2)
> > library(cowplot)
> >
> > ggplot(scatter_data,aes(x=x_var,y=y_var))+
> >    geom_point()+
> >    geom_smooth(se=TRUE,fill="blue",color="black",linetype="dashed")+
> >    theme_cowplot()
> >
> > I'd like to add a black boundary around the shaded area. I suspect this
> can be done with geom_ribbon but I cannot figure this out. Some advice
> would be welcome.
> >
> > Thanks!
> >
> > Thomas Subia
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> Hello,
>
> Here is a solution. You ,ust access the computed variables, which you
> can with ?ggplot_build.
> Then pass them in the data argument.
>
>
>
> p <- ggplot(scatter_data,aes(x=x_var,y=y_var)) +
>    geom_point()+
>    geom_smooth(se=TRUE,fill="blue",color="black",linetype="dashed")+
>    theme_cowplot()
>
> # this is a data.frame, relevant columns are x,  ymin and ymax
> fit <- ggplot_build(p)$data[[2]]
>
> p +
>    geom_line(data = fit, aes(x, ymin), linetype = "dashed", linewidth = 1)
> +
>    geom_line(data = fit, aes(x, ymax), linetype = "dashed", linewidth = 1)
>
>
> Hope this helps,
>
> Rui Barradas
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @k@h@y_e4 @end|ng |rom hotm@||@com  Sun Aug 13 00:00:35 2023
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Sat, 12 Aug 2023 22:00:35 +0000
Subject: [R] time series transformation....
Message-ID: <PU4P216MB156857160E17C21ED8A70255C811A@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

dear members,
                         I have a heteroscedastic time series which I want to transform to make it homoscedastic by a box cox transformation. I am using Otexts by RJ hyndman and George Athanopolous as my textbook. They discuss transformation and also say the fpp3 and the fable package automatically back transforms the point forecast. they also discuss the process which I find to be very cumbersome. Is there any R package which automatically back transforms the point forecast when I use xts objects ( RJH and GA use tsibble objects) with arfima/arima in the forecast package?

THanking you,
Yours sincerely,
AKSHAY M KULKARNI

	[[alternative HTML version deleted]]


From tg@77m @end|ng |rom y@hoo@com  Sun Aug 13 02:39:58 2023
From: tg@77m @end|ng |rom y@hoo@com (Thomas Subia)
Date: Sun, 13 Aug 2023 00:39:58 +0000 (UTC)
Subject: [R] geom_smooth
In-Reply-To: <20230812140829.507fa247@absentia>
References: <1136721510.3518437.1691813862437.ref@mail.yahoo.com>
 <1136721510.3518437.1691813862437@mail.yahoo.com>
 <20230812140829.507fa247@absentia>
Message-ID: <56646704.3744523.1691887198974@mail.yahoo.com>

Colleagues,

Your suggestions are elegant and greatly appreciated.

Thomas Subia






On Friday, August 11, 2023 at 11:08:42 PM PDT, Berwin A Turlach <berwin.turlach at gmail.com> wrote: 





G'day Thomas,

On Sat, 12 Aug 2023 04:17:42 +0000 (UTC)
Thomas Subia via R-help <r-help at r-project.org> wrote:

> Here is my reproducible code for a graph using geom_smooth

The call "library(tidyverse)" was missing. :)

> I'd like to add a black boundary around the shaded area. I suspect
> this can be done with geom_ribbon but I cannot figure this out. Some
> advice would be welcome.

This works for me:

ggplot(scatter_data,aes(x=x_var,y=y_var,))+
? geom_point()+
? geom_smooth(se=TRUE,fill="blue",color="black",linetype="dashed") +
? geom_ribbon(stat="smooth", aes(ymin=after_stat(ymin), ymax=after_stat(ymax)), fill=NA, color="black")+

? theme_cowplot()


Cheers,
??? 
??? Berwin


From er|cjberger @end|ng |rom gm@||@com  Sun Aug 13 07:04:20 2023
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Sun, 13 Aug 2023 08:04:20 +0300
Subject: [R] time series transformation....
In-Reply-To: <PU4P216MB156857160E17C21ED8A70255C811A@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
References: <PU4P216MB156857160E17C21ED8A70255C811A@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
Message-ID: <CAGgJW74sjKfD-VtK2kqHCS0wQ6gj6uiUB61BKajwObkDkeNw1Q@mail.gmail.com>

Hi Akshay,
The forecast package will do the BoxCox transform and automatically
backtransform the forecasts.
The package also handles xts objects.
For example, modifying the example from the help page of
forecast::forecast for Arima

> dt <- as.Date("2023-01-01") + 1:length(WWWusage)
> a <- xts(WWWusage, order.by=dt)
> fit1 <- Arima(a, c(3,1,0))
> fit2 <- Arima(a, lambda=0.5, c(3,1,0))  ## applies the Box-Cox transform with lambda=0.5
> par(mfrow=c(1,2))
> plot(forecast(fit1))
> plot(forecast(fit2))

HTH,
Eric

p.s. RJH is the author/maintainer of the forecast package


On Sun, Aug 13, 2023 at 1:01?AM akshay kulkarni <akshay_e4 at hotmail.com> wrote:
>
> dear members,
>                          I have a heteroscedastic time series which I want to transform to make it homoscedastic by a box cox transformation. I am using Otexts by RJ hyndman and George Athanopolous as my textbook. They discuss transformation and also say the fpp3 and the fable package automatically back transforms the point forecast. they also discuss the process which I find to be very cumbersome. Is there any R package which automatically back transforms the point forecast when I use xts objects ( RJH and GA use tsibble objects) with arfima/arima in the forecast package?
>
> THanking you,
> Yours sincerely,
> AKSHAY M KULKARNI
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Sun Aug 13 19:49:58 2023
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sun, 13 Aug 2023 10:49:58 -0700
Subject: [R] OFF TOPIC: chatGPT glibly produces a lot of wrong answers?
Message-ID: <CAGxFJbSzN=Q6GvQXK-VvKMu4Op897Lt5y3-V=9B-D5_xKVcYVA@mail.gmail.com>

**OFF TOPIC** but perhaps of interest to some on this list. I apologize in
advance to those who may be offended.

The byline:
********************************
"ChatGPT's odds of getting code questions correct are worse than a coin flip

But its suggestions are so annoyingly plausible"
*************************************
from here:
https://www.theregister.com/2023/08/07/chatgpt_stack_overflow_ai/

Hmm... Perhaps not surprising. Sounds like some expert consultants I've
met. ?

Just for amusement. I am ignorant about this and have no strongly held
views,

Cheers to all,
Bert

	[[alternative HTML version deleted]]


From @erv|ce @end|ng |rom @hd@w@on@com  Sun Aug 13 20:11:47 2023
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Sun, 13 Aug 2023 14:11:47 -0400
Subject: [R] OFF TOPIC: chatGPT glibly produces a lot of wrong answers?
In-Reply-To: <CAGxFJbSzN=Q6GvQXK-VvKMu4Op897Lt5y3-V=9B-D5_xKVcYVA@mail.gmail.com>
References: <CAGxFJbSzN=Q6GvQXK-VvKMu4Op897Lt5y3-V=9B-D5_xKVcYVA@mail.gmail.com>
Message-ID: <01dbcfeb-2e2b-9679-533c-c8c2cdbd6313@shdawson.com>

Thanks.

https://www.wsj.com/articles/with-ai-hackers-can-simply-talk-computers-into-misbehaving-ad488686?mod=hp_lead_pos10

Ever heard of AI prompt injection?


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com


On 8/13/23 13:49, Bert Gunter wrote:
> **OFF TOPIC** but perhaps of interest to some on this list. I apologize in
> advance to those who may be offended.
>
> The byline:
> ********************************
> "ChatGPT's odds of getting code questions correct are worse than a coin flip
>
> But its suggestions are so annoyingly plausible"
> *************************************
> from here:
> https://www.theregister.com/2023/08/07/chatgpt_stack_overflow_ai/
>
> Hmm... Perhaps not surprising. Sounds like some expert consultants I've
> met. ?
>
> Just for amusement. I am ignorant about this and have no strongly held
> views,
>
> Cheers to all,
> Bert
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From hwborcher@ @end|ng |rom gm@||@com  Sun Aug 13 21:28:19 2023
From: hwborcher@ @end|ng |rom gm@||@com (Hans W)
Date: Sun, 13 Aug 2023 21:28:19 +0200
Subject: [R] Noisy objective functions
Message-ID: <CAML4n3NEdWX8841d=i-0bPURvgkpjs2cMBeX2WcVyu0=U09A8A@mail.gmail.com>

While working on 'random walk' applications, I got interested in
optimizing noisy objective functions. As an (artificial) example, the
following is the Rosenbrock function, where Gaussian noise of standard
deviation `sd = 0.01` is added to the function value.

    fn <- function(x)
              (1+rnorm(1, sd=0.01)) * adagio::fnRosenbrock(x)

To smooth out the noise, define another function `fnk(x, k = 1)` that
calls `fn` k times and returns the mean value of those k function
applications.

    fnk <- function(x, k = 1) {     # fnk(x) same as fn(x)
        rv = 0.0
        for (i in 1:k) rv <- rv + fn(x)
        return(rv/n)
    }

When we apply several optimization solvers to this noisy and smoothed
noise functions we get for instance the following results:
(Starting point is always `rep(0.1, 5)`, maximal number of iterations 5000,
 relative tolerance 1e-12, and the optimization is successful if the
function value at the minimum is below 1e-06.)

      k   nmk       anms neldermead     ucminf optim_BFGS
     ---------------------------------------------------
      1  0.21       0.32       0.13       0.00       0.00
      3  0.52       0.63       0.50       0.00       0.00
     10  0.81       0.91       0.87       0.00       0.00

Solvers: nmk = dfoptim::nmk, anms = pracma::anms [both Nelder-Mead codes]
         neldermead = nloptr::neldermead,
         ucminf = ucminf::ucminf, optim_BFGS = optim with method "BFGS"

Read the table as follows: `nmk` will be successful in 21% of the
trials, while for example `optim` will never come close to the true
minimum.

I think it is reasonable to assume that gradient-based methods do
poorly with noisy objectives, though I did not expect to see them fail
so clearly. On the other hand, Nelder-Mead implementations do quite
well if there is not too much noise.

In real-world applications, it will often not be possible to do the
same measurement several times. That is, we will then have to live
with `k = 1`. In my applications with long 'random walks', doing the
calculations several times in a row will really need some time.

QUESTION: What could be other approaches to minimize noisy functions?

I looked through some "Stochastic Programming" tutorials and did not
find them very helpful in this situation. Of course, I might have
looked into these works too superficially.


From bbo|ker @end|ng |rom gm@||@com  Sun Aug 13 21:39:43 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 13 Aug 2023 15:39:43 -0400
Subject: [R] Noisy objective functions
In-Reply-To: <CAML4n3NEdWX8841d=i-0bPURvgkpjs2cMBeX2WcVyu0=U09A8A@mail.gmail.com>
References: <CAML4n3NEdWX8841d=i-0bPURvgkpjs2cMBeX2WcVyu0=U09A8A@mail.gmail.com>
Message-ID: <8bd79c25-db39-0430-aa9d-57b8f009da0b@gmail.com>

   This is a huge topic.

   Differential evolution (DEoptim package) would be one good starting 
point; there is a simulated annealing method built into optim() (method 
= "SANN") but it usually requires significant tuning.

   Also genetic algorithms.

   You could look at the NLopt list of algorithms 
https://nlopt.readthedocs.io/en/latest/NLopt_Algorithms/ , focusing on 
the options for derivative-free global optimization , and then use them 
via the nloptr package.

   Good luck ...

On 2023-08-13 3:28 p.m., Hans W wrote:
> While working on 'random walk' applications, I got interested in
> optimizing noisy objective functions. As an (artificial) example, the
> following is the Rosenbrock function, where Gaussian noise of standard
> deviation `sd = 0.01` is added to the function value.
> 
>      fn <- function(x)
>                (1+rnorm(1, sd=0.01)) * adagio::fnRosenbrock(x)
> 
> To smooth out the noise, define another function `fnk(x, k = 1)` that
> calls `fn` k times and returns the mean value of those k function
> applications.
> 
>      fnk <- function(x, k = 1) {     # fnk(x) same as fn(x)
>          rv = 0.0
>          for (i in 1:k) rv <- rv + fn(x)
>          return(rv/n)
>      }
> 
> When we apply several optimization solvers to this noisy and smoothed
> noise functions we get for instance the following results:
> (Starting point is always `rep(0.1, 5)`, maximal number of iterations 5000,
>   relative tolerance 1e-12, and the optimization is successful if the
> function value at the minimum is below 1e-06.)
> 
>        k   nmk       anms neldermead     ucminf optim_BFGS
>       ---------------------------------------------------
>        1  0.21       0.32       0.13       0.00       0.00
>        3  0.52       0.63       0.50       0.00       0.00
>       10  0.81       0.91       0.87       0.00       0.00
> 
> Solvers: nmk = dfoptim::nmk, anms = pracma::anms [both Nelder-Mead codes]
>           neldermead = nloptr::neldermead,
>           ucminf = ucminf::ucminf, optim_BFGS = optim with method "BFGS"
> 
> Read the table as follows: `nmk` will be successful in 21% of the
> trials, while for example `optim` will never come close to the true
> minimum.
> 
> I think it is reasonable to assume that gradient-based methods do
> poorly with noisy objectives, though I did not expect to see them fail
> so clearly. On the other hand, Nelder-Mead implementations do quite
> well if there is not too much noise.
> 
> In real-world applications, it will often not be possible to do the
> same measurement several times. That is, we will then have to live
> with `k = 1`. In my applications with long 'random walks', doing the
> calculations several times in a row will really need some time.
> 
> QUESTION: What could be other approaches to minimize noisy functions?
> 
> I looked through some "Stochastic Programming" tutorials and did not
> find them very helpful in this situation. Of course, I might have
> looked into these works too superficially.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From po|c1410 @end|ng |rom gm@||@com  Sun Aug 13 21:46:39 2023
From: po|c1410 @end|ng |rom gm@||@com (CALUM POLWART)
Date: Sun, 13 Aug 2023 20:46:39 +0100
Subject: [R] OFF TOPIC: chatGPT glibly produces a lot of wrong answers?
In-Reply-To: <CAGxFJbSzN=Q6GvQXK-VvKMu4Op897Lt5y3-V=9B-D5_xKVcYVA@mail.gmail.com>
References: <CAGxFJbSzN=Q6GvQXK-VvKMu4Op897Lt5y3-V=9B-D5_xKVcYVA@mail.gmail.com>
Message-ID: <CA+etgP=5rB-MSsmPOunjy=xbv9uNgiObjWa+ku4MPSdpxOrHQg@mail.gmail.com>

It does often behave better if you say to it "that doesn't seem to be
working" and perhaps some error message

It is afterall a language tool. Its function is to provide text that seems
real.

If you ask it a science question and ask it to provide references in
Vancouver format, it can format the references perfectly. They will be from
real authors (often who have published in the general field), they will be
in real journals for the field. But the title is entirely false but
plausible.

Expect many a scammer to get caught out...

On Sun, 13 Aug 2023, 18:50 Bert Gunter, <bgunter.4567 at gmail.com> wrote:

> **OFF TOPIC** but perhaps of interest to some on this list. I apologize in
> advance to those who may be offended.
>
> The byline:
> ********************************
> "ChatGPT's odds of getting code questions correct are worse than a coin
> flip
>
> But its suggestions are so annoyingly plausible"
> *************************************
> from here:
> https://www.theregister.com/2023/08/07/chatgpt_stack_overflow_ai/
>
> Hmm... Perhaps not surprising. Sounds like some expert consultants I've
> met. ?
>
> Just for amusement. I am ignorant about this and have no strongly held
> views,
>
> Cheers to all,
> Bert
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From hwborcher@ @end|ng |rom gm@||@com  Sun Aug 13 22:31:44 2023
From: hwborcher@ @end|ng |rom gm@||@com (Hans W)
Date: Sun, 13 Aug 2023 22:31:44 +0200
Subject: [R] Noisy objective functions
In-Reply-To: <CAML4n3NEdWX8841d=i-0bPURvgkpjs2cMBeX2WcVyu0=U09A8A@mail.gmail.com>
References: <CAML4n3NEdWX8841d=i-0bPURvgkpjs2cMBeX2WcVyu0=U09A8A@mail.gmail.com>
Message-ID: <CAML4n3MLCZbstjZZr7qTq5jR6P5V0dj5OVa1TM_wjKqSnhtC8Q@mail.gmail.com>

Thanks, Ben.

For certain reasons, I would *not* like to apply global optimization solvers,
e.g., for reasons of higher dimensions and longer running times.
I was hoping for suggestions from the "Stochastic Programming" side.

And please, never suggest `optim` with method "SANN".
See the Optimization cheatsheet I wrote with John Nash:

    "NOTE: CG (John is the author!) and SANN are NOT recommended."
    https://github.com/hwborchers/CheatSheets/blob/main/Base%20R%20Optim%20Cheatsheet.pdf

Hans W.

On Sun, 13 Aug 2023 at 21:28, Hans W <hwborchers at gmail.com> wrote:
>
> While working on 'random walk' applications, I got interested in
> optimizing noisy objective functions. As an (artificial) example, the
> following is the Rosenbrock function, where Gaussian noise of standard
> deviation `sd = 0.01` is added to the function value.
>
>     fn <- function(x)
>               (1+rnorm(1, sd=0.01)) * adagio::fnRosenbrock(x)
>
> To smooth out the noise, define another function `fnk(x, k = 1)` that
> calls `fn` k times and returns the mean value of those k function
> applications.
>
>     fnk <- function(x, k = 1) {     # fnk(x) same as fn(x)
>         rv = 0.0
>         for (i in 1:k) rv <- rv + fn(x)
>         return(rv/n)
>     }
>
> When we apply several optimization solvers to this noisy and smoothed
> noise functions we get for instance the following results:
> (Starting point is always `rep(0.1, 5)`, maximal number of iterations 5000,
>  relative tolerance 1e-12, and the optimization is successful if the
> function value at the minimum is below 1e-06.)
>
>       k   nmk       anms neldermead     ucminf optim_BFGS
>      ---------------------------------------------------
>       1  0.21       0.32       0.13       0.00       0.00
>       3  0.52       0.63       0.50       0.00       0.00
>      10  0.81       0.91       0.87       0.00       0.00
>
> Solvers: nmk = dfoptim::nmk, anms = pracma::anms [both Nelder-Mead codes]
>          neldermead = nloptr::neldermead,
>          ucminf = ucminf::ucminf, optim_BFGS = optim with method "BFGS"
>
> Read the table as follows: `nmk` will be successful in 21% of the
> trials, while for example `optim` will never come close to the true
> minimum.
>
> I think it is reasonable to assume that gradient-based methods do
> poorly with noisy objectives, though I did not expect to see them fail
> so clearly. On the other hand, Nelder-Mead implementations do quite
> well if there is not too much noise.
>
> In real-world applications, it will often not be possible to do the
> same measurement several times. That is, we will then have to live
> with `k = 1`. In my applications with long 'random walks', doing the
> calculations several times in a row will really need some time.
>
> QUESTION: What could be other approaches to minimize noisy functions?
>
> I looked through some "Stochastic Programming" tutorials and did not
> find them very helpful in this situation. Of course, I might have
> looked into these works too superficially.


From drj|m|emon @end|ng |rom gm@||@com  Mon Aug 14 02:00:13 2023
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Mon, 14 Aug 2023 10:00:13 +1000
Subject: [R] OFF TOPIC: chatGPT glibly produces a lot of wrong answers?
In-Reply-To: <CAGxFJbSzN=Q6GvQXK-VvKMu4Op897Lt5y3-V=9B-D5_xKVcYVA@mail.gmail.com>
References: <CAGxFJbSzN=Q6GvQXK-VvKMu4Op897Lt5y3-V=9B-D5_xKVcYVA@mail.gmail.com>
Message-ID: <CA+8X3fV=iBXdGZ+3m4VQPtf6BWqv9kkSzj+r4Jh_ZHQvUfPQVA@mail.gmail.com>

Hi Bert,
The article notes that chatGPT often gets the concept wrong, rather
than the facts. I think this can be traced to the one who poses the
question. I have often encountered requests for help that did not ask
for what was really wanted. I was recently asked if I could
graphically concatenate years of derived quantities that were based on
an aggregation of daily cycles. You get an average daily cycle for
each year, but this doesn't necessarily connect to the average daily
cycle for the next year. It didn't work, but it was a case of YKWIM
(You Know What I Mean). In this failure of communication, the
questioner frames the question in a way that may be figured out by a
human, but is not logically consistent. It is the basis for some very
funny scenes in Douglas Adams' "Hitchhiker" series, but can be
intensely frustrating to both parties in real life.

Jim

On Mon, Aug 14, 2023 at 3:50?AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> **OFF TOPIC** but perhaps of interest to some on this list. I apologize in
> advance to those who may be offended.
>
> The byline:
> ********************************
> "ChatGPT's odds of getting code questions correct are worse than a coin flip
>
> But its suggestions are so annoyingly plausible"
> *************************************
> from here:
> https://www.theregister.com/2023/08/07/chatgpt_stack_overflow_ai/
>
> Hmm... Perhaps not surprising. Sounds like some expert consultants I've
> met. ?
>
> Just for amusement. I am ignorant about this and have no strongly held
> views,
>
> Cheers to all,
> Bert
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From pro|jcn@@h @end|ng |rom gm@||@com  Mon Aug 14 02:04:07 2023
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Sun, 13 Aug 2023 20:04:07 -0400
Subject: [R] Noisy objective functions
In-Reply-To: <CAML4n3NEdWX8841d=i-0bPURvgkpjs2cMBeX2WcVyu0=U09A8A@mail.gmail.com>
References: <CAML4n3NEdWX8841d=i-0bPURvgkpjs2cMBeX2WcVyu0=U09A8A@mail.gmail.com>
Message-ID: <8ff2a05b-6361-36be-7b46-bc75b326a872@gmail.com>

More to provide another perspective, I'll give the citation of some work
with Harry Joe and myself from over 2 decades ago.

@Article{,
   author  = {Joe, Harry and Nash, John C.},
   title   = {Numerical optimization and surface estimation with imprecise function evaluations},
   journal = {Statistics and Computing},
   year    = {2003},
   volume  = {13},
   pages   = {277--286},
}

Essentially this fits a quadratic approximately by regression, assuming the returned
objective is imprecise. It is NOT good for high dimension, of course, and is bedeviled
by needing to have some idea of the scale of the imprecision i.e., the noise
amplitude. However, it does work for some applications. Harry had some success with
Monte Carlo evaluation of multidimensional integrals optimizing crude quadratures.
That is, multiple crude quadrature could be more efficient than single precise quadrature.
However, this approach is not one that can be blindly applied. There are all sorts
of issues about what point cloud to keep as the "fit model, move to model minimum,
add points, delete points" process evolves.


JN

On 2023-08-13 15:28, Hans W wrote:
> While working on 'random walk' applications, I got interested in
> optimizing noisy objective functions. As an (artificial) example, the
> following is the Rosenbrock function, where Gaussian noise of standard
> deviation `sd = 0.01` is added to the function value.
> 
>      fn <- function(x)
>                (1+rnorm(1, sd=0.01)) * adagio::fnRosenbrock(x)
> 
> To smooth out the noise, define another function `fnk(x, k = 1)` that
> calls `fn` k times and returns the mean value of those k function
> applications.
> 
>      fnk <- function(x, k = 1) {     # fnk(x) same as fn(x)
>          rv = 0.0
>          for (i in 1:k) rv <- rv + fn(x)
>          return(rv/n)
>      }
> 
> When we apply several optimization solvers to this noisy and smoothed
> noise functions we get for instance the following results:
> (Starting point is always `rep(0.1, 5)`, maximal number of iterations 5000,
>   relative tolerance 1e-12, and the optimization is successful if the
> function value at the minimum is below 1e-06.)
> 
>        k   nmk       anms neldermead     ucminf optim_BFGS
>       ---------------------------------------------------
>        1  0.21       0.32       0.13       0.00       0.00
>        3  0.52       0.63       0.50       0.00       0.00
>       10  0.81       0.91       0.87       0.00       0.00
> 
> Solvers: nmk = dfoptim::nmk, anms = pracma::anms [both Nelder-Mead codes]
>           neldermead = nloptr::neldermead,
>           ucminf = ucminf::ucminf, optim_BFGS = optim with method "BFGS"
> 
> Read the table as follows: `nmk` will be successful in 21% of the
> trials, while for example `optim` will never come close to the true
> minimum.
> 
> I think it is reasonable to assume that gradient-based methods do
> poorly with noisy objectives, though I did not expect to see them fail
> so clearly. On the other hand, Nelder-Mead implementations do quite
> well if there is not too much noise.
> 
> In real-world applications, it will often not be possible to do the
> same measurement several times. That is, we will then have to live
> with `k = 1`. In my applications with long 'random walks', doing the
> calculations several times in a row will really need some time.
> 
> QUESTION: What could be other approaches to minimize noisy functions?
> 
> I looked through some "Stochastic Programming" tutorials and did not
> find them very helpful in this situation. Of course, I might have
> looked into these works too superficially.
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


